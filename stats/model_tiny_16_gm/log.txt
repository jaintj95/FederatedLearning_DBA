current path: saved_models/model_tiny_Jun.26_07.42.58
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 5, 10, 15, 25, 30, 37, 44, 49, 55, 61, 65, 85]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [98, 0, 77, 44, 66, 67, 33, 25, 19, 92].
_Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   1, Avg loss: 0.0833, Accuracy: 12/373 (3.2172%)
_Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   2, Avg loss: 0.0496, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.4286, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   1, Avg loss: 0.0586, Accuracy: 370/1657 (22.3295%)
_Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   2, Avg loss: 0.0352, Accuracy: 473/1657 (28.5456%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5481, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 316/1340 (23.5821%)
_Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 564/1340 (42.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7182, Accuracy: 59/10000 (0.5900%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 373/1750 (21.3143%)
_Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 648/1750 (37.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.8726, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 246/1402 (17.5464%)
_Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 374/1402 (26.6762%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.1638, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   1, Avg loss: 0.0795, Accuracy: 46/426 (10.7981%)
_Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   2, Avg loss: 0.0421, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5767, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   1, Avg loss: 0.0802, Accuracy: 56/515 (10.8738%)
_Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   2, Avg loss: 0.0546, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.6901, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   1, Avg loss: 0.0576, Accuracy: 295/690 (42.7536%)
_Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.1956, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 389/1036 (37.5483%)
_Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 659/1036 (63.6100%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.9920, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 477/1715 (27.8134%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 726/1715 (42.3324%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.4290, Accuracy: 77/10000 (0.7700%)
time spent on training: 130.84880757331848
[rfa agg] training data poison_ratio: 0.37573367571533384  data num: [373, 1657, 1340, 1750, 1402, 426, 515, 690, 1036, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.11741677366104182
[rfa agg] init. name: [98, 0, 77, 44, 66, 67, 33, 25, 19, 92], weight: tensor([0.0342, 0.1520, 0.1229, 0.1605, 0.1286, 0.0391, 0.0472, 0.0633, 0.0950,
        0.1573])
[rfa agg] iter:  0, prev_obj_val: 60.77391815185547, obj_val: 62.70914840698242, abs dis: 1.9352302551269531
[rfa agg] iter: 0, weight: tensor([0.0129, 0.0952, 0.2169, 0.0795, 0.1689, 0.0160, 0.0234, 0.0397, 0.2608,
        0.0868])
[rfa agg] iter:  1, prev_obj_val: 62.70914840698242, obj_val: 62.699913024902344, abs dis: 0.009235382080078125
[rfa agg] iter: 1, weight: tensor([0.0128, 0.0853, 0.1781, 0.0721, 0.1421, 0.0159, 0.0236, 0.0405, 0.3512,
        0.0783])
[rfa agg] iter:  2, prev_obj_val: 62.699913024902344, obj_val: 62.69981384277344, abs dis: 9.918212890625e-05
[rfa agg] iter: 2, weight: tensor([0.0126, 0.0842, 0.1749, 0.0712, 0.1399, 0.0157, 0.0233, 0.0400, 0.3610,
        0.0772])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3034, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.3800, Accuracy: 0/9950 (0.0000%)
saving model
Done in 384.0475866794586 sec.
Server Epoch:2 choose agents : [77, 57, 52, 28, 29, 61, 99, 34, 8, 85].
_Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 315/1340 (23.5075%)
_Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 544/1340 (40.5970%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6202, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   1, Avg loss: 0.0543, Accuracy: 298/1154 (25.8232%)
_Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   2, Avg loss: 0.0268, Accuracy: 432/1154 (37.4350%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.7061, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   1, Avg loss: 0.0553, Accuracy: 278/636 (43.7107%)
_Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.2282, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0571, Accuracy: 381/1581 (24.0987%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0345, Accuracy: 588/1581 (37.1917%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.7916, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0496, Accuracy: 402/1440 (27.9167%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0284, Accuracy: 647/1440 (44.9306%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6492, Accuracy: 66/10000 (0.6600%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   1, Avg loss: 0.1282, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   2, Avg loss: 0.1201, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3096, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0664, Accuracy: 184/773 (23.8034%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0304, Accuracy: 410/773 (53.0401%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9088, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   1, Avg loss: 0.0592, Accuracy: 371/1427 (25.9986%)
_Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 583/1427 (40.8549%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8232, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   1, Avg loss: 0.0606, Accuracy: 244/1513 (16.1269%)
_Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 472/1513 (31.1963%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.9652, Accuracy: 96/10000 (0.9600%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0547, Accuracy: 413/1988 (20.7746%)
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 684/1988 (34.4064%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.3082, Accuracy: 88/10000 (0.8800%)
time spent on training: 146.37149047851562
[rfa agg] training data poison_ratio: 0.17366172405126917  data num: [1340, 1154, 636, 1581, 1440, 85, 773, 1427, 1513, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.05426928876602162
[rfa agg] init. name: [77, 57, 52, 28, 29, 61, 99, 34, 8, 85], weight: tensor([0.1123, 0.0967, 0.0533, 0.1324, 0.1206, 0.0071, 0.0648, 0.1195, 0.1267,
        0.1665])
[rfa agg] iter:  0, prev_obj_val: 45.882408142089844, obj_val: 50.62101745605469, abs dis: 4.738609313964844
[rfa agg] iter: 0, weight: tensor([0.3081, 0.1537, 0.0150, 0.0852, 0.1338, 0.0011, 0.0255, 0.1319, 0.1029,
        0.0428])
[rfa agg] iter:  1, prev_obj_val: 50.62101745605469, obj_val: 50.574058532714844, abs dis: 0.04695892333984375
[rfa agg] iter: 1, weight: tensor([0.2283, 0.2747, 0.0190, 0.0801, 0.1129, 0.0014, 0.0336, 0.1121, 0.0929,
        0.0451])
[rfa agg] iter:  2, prev_obj_val: 50.574058532714844, obj_val: 53.26140594482422, abs dis: 2.687347412109375
[rfa agg] iter: 2, weight: tensor([0.2148, 0.3039, 0.0184, 0.0777, 0.1091, 0.0013, 0.0326, 0.1084, 0.0901,
        0.0437])
[rfa agg] iter:  3, prev_obj_val: 53.26140594482422, obj_val: 53.24632263183594, abs dis: 0.01508331298828125
[rfa agg] iter: 3, weight: tensor([0.1744, 0.3704, 0.0199, 0.0734, 0.0990, 0.0014, 0.0362, 0.0983, 0.0838,
        0.0432])
[rfa agg] iter:  4, prev_obj_val: 53.24632263183594, obj_val: 56.19893264770508, abs dis: 2.9526100158691406
[rfa agg] iter: 4, weight: tensor([0.1658, 0.3964, 0.0192, 0.0706, 0.0951, 0.0013, 0.0348, 0.0945, 0.0806,
        0.0416])
[rfa agg] iter:  5, prev_obj_val: 56.19893264770508, obj_val: 56.19849395751953, abs dis: 0.000438690185546875
[rfa agg] iter: 5, weight: tensor([0.1536, 0.3883, 0.0228, 0.0733, 0.0955, 0.0015, 0.0425, 0.0948, 0.0826,
        0.0450])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3042, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.3729, Accuracy: 0/9950 (0.0000%)
saving model
Done in 401.15699791908264 sec.
Server Epoch:3 choose agents : [89, 70, 9, 99, 37, 17, 4, 82, 30, 13].
_Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   1, Avg loss: 0.0630, Accuracy: 298/896 (33.2589%)
_Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 447/896 (49.8884%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.4718, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0554, Accuracy: 378/1418 (26.6573%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 635/1418 (44.7814%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8069, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   1, Avg loss: 0.0490, Accuracy: 366/1275 (28.7059%)
_Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   2, Avg loss: 0.0194, Accuracy: 656/1275 (51.4510%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 9.2628, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   1, Avg loss: 0.0659, Accuracy: 168/773 (21.7335%)
_Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   2, Avg loss: 0.0311, Accuracy: 420/773 (54.3338%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.2495, Accuracy: 56/10000 (0.5600%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   1, Avg loss: 0.0537, Accuracy: 417/1129 (36.9353%)
_Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   2, Avg loss: 0.0248, Accuracy: 747/1129 (66.1647%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.4698, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0531, Accuracy: 378/1574 (24.0152%)
_Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0285, Accuracy: 629/1574 (39.9619%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.9087, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0654, Accuracy: 322/901 (35.7381%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 337/901 (37.4029%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5237, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 64/500 (12.8000%)
_Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 193/500 (38.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.8179, Accuracy: 51/10000 (0.5100%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   1, Avg loss: 0.0800, Accuracy: 61/486 (12.5514%)
_Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.3951, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0592, Accuracy: 310/1645 (18.8450%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 622/1645 (37.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8836, Accuracy: 116/10000 (1.1600%)
time spent on training: 142.71792602539062
[rfa agg] training data poison_ratio: 0.1524016231008776  data num: [896, 1418, 1275, 773, 1129, 1574, 901, 500, 486, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.04762550721902425
[rfa agg] init. name: [89, 70, 9, 99, 37, 17, 4, 82, 30, 13], weight: tensor([0.0846, 0.1338, 0.1203, 0.0729, 0.1065, 0.1485, 0.0850, 0.0472, 0.0459,
        0.1552])
[rfa agg] iter:  0, prev_obj_val: 51.04423141479492, obj_val: 52.4703483581543, abs dis: 1.426116943359375
[rfa agg] iter: 0, weight: tensor([0.1234, 0.0798, 0.1303, 0.0799, 0.2266, 0.0682, 0.1852, 0.0217, 0.0211,
        0.0637])
[rfa agg] iter:  1, prev_obj_val: 52.4703483581543, obj_val: 52.46040344238281, abs dis: 0.009944915771484375
[rfa agg] iter: 1, weight: tensor([0.1446, 0.0713, 0.1105, 0.0889, 0.1825, 0.0619, 0.2386, 0.0221, 0.0215,
        0.0582])
[rfa agg] iter:  2, prev_obj_val: 52.46040344238281, obj_val: 52.46031188964844, abs dis: 9.1552734375e-05
[rfa agg] iter: 2, weight: tensor([0.1443, 0.0708, 0.1095, 0.0884, 0.1790, 0.0614, 0.2455, 0.0220, 0.0214,
        0.0578])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3155, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.5373, Accuracy: 0/9950 (0.0000%)
saving model
Done in 388.9725968837738 sec.
Server Epoch:4 choose agents : [24, 77, 38, 89, 8, 28, 48, 62, 16, 76].
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0784, Accuracy: 20/312 (6.4103%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0423, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.6155, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0554, Accuracy: 307/1340 (22.9104%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 553/1340 (41.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.7412, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   1, Avg loss: 0.0633, Accuracy: 233/1131 (20.6012%)
_Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   2, Avg loss: 0.0316, Accuracy: 477/1131 (42.1751%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.2748, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   1, Avg loss: 0.0617, Accuracy: 307/896 (34.2634%)
_Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   2, Avg loss: 0.0340, Accuracy: 443/896 (49.4420%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.5379, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   1, Avg loss: 0.0588, Accuracy: 266/1513 (17.5810%)
_Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   2, Avg loss: 0.0361, Accuracy: 490/1513 (32.3860%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.3659, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   1, Avg loss: 0.0572, Accuracy: 405/1581 (25.6167%)
_Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 584/1581 (36.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.6769, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   1, Avg loss: 0.0701, Accuracy: 98/631 (15.5309%)
_Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   2, Avg loss: 0.0413, Accuracy: 220/631 (34.8653%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.0814, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0706, Accuracy: 120/568 (21.1268%)
_Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0419, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.0706, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   1, Avg loss: 0.0606, Accuracy: 263/708 (37.1469%)
_Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   2, Avg loss: 0.0406, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.0095, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0834, Accuracy: 55/466 (11.8026%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.8241, Accuracy: 50/10000 (0.5000%)
time spent on training: 122.57444167137146
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1340, 1131, 896, 1513, 1581, 631, 568, 708, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 77, 38, 89, 8, 28, 48, 62, 16, 76], weight: tensor([0.0341, 0.1465, 0.1237, 0.0980, 0.1654, 0.1729, 0.0690, 0.0621, 0.0774,
        0.0510])
[rfa agg] iter:  0, prev_obj_val: 56.61473846435547, obj_val: 60.40629196166992, abs dis: 3.791553497314453
[rfa agg] iter: 0, weight: tensor([0.0147, 0.1052, 0.1689, 0.3122, 0.0795, 0.0750, 0.0595, 0.0448, 0.1088,
        0.0315])
[rfa agg] iter:  1, prev_obj_val: 60.40629196166992, obj_val: 66.13754272460938, abs dis: 5.731250762939453
[rfa agg] iter: 1, weight: tensor([0.0139, 0.0682, 0.0945, 0.4053, 0.0550, 0.0527, 0.0678, 0.0478, 0.1627,
        0.0321])
[rfa agg] iter:  2, prev_obj_val: 66.13754272460938, obj_val: 68.3426284790039, abs dis: 2.2050857543945312
[rfa agg] iter: 2, weight: tensor([0.0166, 0.0563, 0.0706, 0.1638, 0.0477, 0.0461, 0.1122, 0.0695, 0.3742,
        0.0431])
[rfa agg] iter:  3, prev_obj_val: 68.3426284790039, obj_val: 68.33969116210938, abs dis: 0.00293731689453125
[rfa agg] iter: 3, weight: tensor([0.0176, 0.0526, 0.0644, 0.1276, 0.0452, 0.0438, 0.1431, 0.0818, 0.3754,
        0.0484])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3489, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6497, Accuracy: 0/9950 (0.0000%)
saving model
Done in 373.7299418449402 sec.
Server Epoch:5 choose agents : [73, 49, 66, 2, 62, 24, 56, 25, 10, 97].
_Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   1, Avg loss: 0.0668, Accuracy: 172/938 (18.3369%)
_Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   2, Avg loss: 0.0337, Accuracy: 318/938 (33.9019%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.3855, Accuracy: 64/10000 (0.6400%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   1, Avg loss: 0.0800, Accuracy: 28/440 (6.3636%)
_Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   2, Avg loss: 0.0475, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.8051, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0642, Accuracy: 248/1402 (17.6890%)
_Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 355/1402 (25.3210%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.1523, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0642, Accuracy: 209/605 (34.5455%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0391, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.2217, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0687, Accuracy: 136/568 (23.9437%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0417, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.0447, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   1, Avg loss: 0.0800, Accuracy: 15/312 (4.8077%)
_Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   2, Avg loss: 0.0424, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.6446, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0813, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0664, Accuracy: 52/186 (27.9570%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3815, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   1, Avg loss: 0.0598, Accuracy: 278/690 (40.2899%)
_Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   2, Avg loss: 0.0287, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.4703, Accuracy: 51/10000 (0.5100%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   1, Avg loss: 0.0621, Accuracy: 169/861 (19.6283%)
_Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 446/861 (51.8002%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.3011, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0559, Accuracy: 339/1213 (27.9472%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 492/1213 (40.5606%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.0249, Accuracy: 92/10000 (0.9200%)
time spent on training: 148.57119917869568
[rfa agg] training data poison_ratio: 0.27595287595287593  data num: [938, 440, 1402, 605, 568, 312, 186, 690, 861, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.08623527373527373
[rfa agg] init. name: [73, 49, 66, 2, 62, 24, 56, 25, 10, 97], weight: tensor([0.1300, 0.0610, 0.1943, 0.0839, 0.0787, 0.0432, 0.0258, 0.0956, 0.1193,
        0.1681])
[rfa agg] iter:  0, prev_obj_val: 46.47977828979492, obj_val: 50.51673126220703, abs dis: 4.036952972412109
[rfa agg] iter: 0, weight: tensor([0.1385, 0.0397, 0.0638, 0.1292, 0.0847, 0.0200, 0.0092, 0.2537, 0.1827,
        0.0785])
[rfa agg] iter:  1, prev_obj_val: 50.51673126220703, obj_val: 57.591796875, abs dis: 7.075065612792969
[rfa agg] iter: 1, weight: tensor([0.0727, 0.0434, 0.0429, 0.2360, 0.1240, 0.0195, 0.0084, 0.3176, 0.0853,
        0.0501])
[rfa agg] iter:  2, prev_obj_val: 57.591796875, obj_val: 63.840396881103516, abs dis: 6.248600006103516
[rfa agg] iter: 2, weight: tensor([0.0565, 0.0753, 0.0392, 0.1844, 0.3791, 0.0272, 0.0106, 0.1214, 0.0621,
        0.0440])
[rfa agg] iter:  3, prev_obj_val: 63.840396881103516, obj_val: 63.825340270996094, abs dis: 0.015056610107421875
[rfa agg] iter: 3, weight: tensor([0.0654, 0.1823, 0.0491, 0.1416, 0.2630, 0.0478, 0.0169, 0.1102, 0.0698,
        0.0540])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.4576, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.9532, Accuracy: 0/9950 (0.0000%)
saving model
Done in 397.7255289554596 sec.
Server Epoch:6 choose agents : [50, 99, 30, 37, 67, 0, 63, 39, 52, 44].
_Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0605, Accuracy: 166/809 (20.5192%)
_Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 332/809 (41.0383%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5750, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   1, Avg loss: 0.0661, Accuracy: 184/773 (23.8034%)
_Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   2, Avg loss: 0.0296, Accuracy: 386/773 (49.9353%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6825, Accuracy: 65/10000 (0.6500%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   1, Avg loss: 0.0820, Accuracy: 43/486 (8.8477%)
_Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   2, Avg loss: 0.0407, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.9660, Accuracy: 51/10000 (0.5100%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   1, Avg loss: 0.0535, Accuracy: 391/1129 (34.6324%)
_Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   2, Avg loss: 0.0255, Accuracy: 724/1129 (64.1275%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.9041, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   1, Avg loss: 0.0783, Accuracy: 41/426 (9.6244%)
_Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   2, Avg loss: 0.0411, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.2755, Accuracy: 52/10000 (0.5200%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0593, Accuracy: 350/1657 (21.1225%)
_Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 507/1657 (30.5975%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.1461, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0604, Accuracy: 218/888 (24.5495%)
_Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0266, Accuracy: 405/888 (45.6081%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.3752, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   1, Avg loss: 0.0562, Accuracy: 279/1013 (27.5420%)
_Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 498/1013 (49.1609%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.2480, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0629, Accuracy: 218/636 (34.2767%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0328, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.1922, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0603, Accuracy: 403/1750 (23.0286%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0363, Accuracy: 641/1750 (36.6286%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.9395, Accuracy: 116/10000 (1.1600%)
time spent on training: 165.84738993644714
[rfa agg] training data poison_ratio: 0.5249294449670743  data num: [809, 773, 486, 1129, 426, 1657, 888, 1013, 636, 1750]
[rfa agg] considering poison per batch poison_fraction: 0.1640404515522107
[rfa agg] init. name: [50, 99, 30, 37, 67, 0, 63, 39, 52, 44], weight: tensor([0.0846, 0.0808, 0.0508, 0.1180, 0.0445, 0.1732, 0.0928, 0.1059, 0.0665,
        0.1829])
[rfa agg] iter:  0, prev_obj_val: 55.931182861328125, obj_val: 58.91914367675781, abs dis: 2.9879608154296875
[rfa agg] iter: 0, weight: tensor([0.0787, 0.0751, 0.0200, 0.2102, 0.0157, 0.0611, 0.1177, 0.3341, 0.0341,
        0.0534])
[rfa agg] iter:  1, prev_obj_val: 58.91914367675781, obj_val: 62.122161865234375, abs dis: 3.2030181884765625
[rfa agg] iter: 1, weight: tensor([0.1669, 0.1654, 0.0231, 0.0790, 0.0173, 0.0397, 0.2895, 0.1388, 0.0444,
        0.0360])
[rfa agg] iter:  2, prev_obj_val: 62.122161865234375, obj_val: 67.29381561279297, abs dis: 5.171653747558594
[rfa agg] iter: 2, weight: tensor([0.2457, 0.2627, 0.0248, 0.0569, 0.0181, 0.0329, 0.1923, 0.0844, 0.0520,
        0.0302])
[rfa agg] iter:  3, prev_obj_val: 67.29381561279297, obj_val: 70.19493103027344, abs dis: 2.9011154174804688
[rfa agg] iter: 3, weight: tensor([0.2261, 0.2245, 0.0417, 0.0649, 0.0294, 0.0416, 0.1466, 0.0872, 0.0996,
        0.0384])
[rfa agg] iter:  4, prev_obj_val: 70.19493103027344, obj_val: 73.17644500732422, abs dis: 2.9815139770507812
[rfa agg] iter: 4, weight: tensor([0.1937, 0.1870, 0.0544, 0.0689, 0.0373, 0.0460, 0.1368, 0.0892, 0.1441,
        0.0427])
[rfa agg] iter:  5, prev_obj_val: 73.17644500732422, obj_val: 67.31156921386719, abs dis: 5.864875793457031
[rfa agg] iter: 5, weight: tensor([0.1615, 0.1550, 0.0671, 0.0683, 0.0444, 0.0473, 0.1230, 0.0858, 0.2035,
        0.0441])
[rfa agg] iter:  6, prev_obj_val: 67.31156921386719, obj_val: 67.28219604492188, abs dis: 0.0293731689453125
[rfa agg] iter: 6, weight: tensor([0.2231, 0.2148, 0.0428, 0.0662, 0.0300, 0.0423, 0.1473, 0.0886, 0.1057,
        0.0391])
[rfa agg] iter:  7, prev_obj_val: 67.28219604492188, obj_val: 67.28211212158203, abs dis: 8.392333984375e-05
[rfa agg] iter: 7, weight: tensor([0.2268, 0.2201, 0.0421, 0.0653, 0.0296, 0.0418, 0.1463, 0.0876, 0.1018,
        0.0386])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.7662, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 6.7832, Accuracy: 0/9950 (0.0000%)
saving model
Done in 423.70370411872864 sec.
Server Epoch:7 choose agents : [66, 72, 39, 28, 82, 63, 93, 98, 12, 10].
_Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   1, Avg loss: 0.0653, Accuracy: 220/1402 (15.6919%)
_Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   2, Avg loss: 0.0392, Accuracy: 378/1402 (26.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.4368, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   1, Avg loss: 0.0632, Accuracy: 250/1241 (20.1450%)
_Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 421/1241 (33.9243%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.6869, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   1, Avg loss: 0.0555, Accuracy: 275/1013 (27.1471%)
_Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   2, Avg loss: 0.0264, Accuracy: 456/1013 (45.0148%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1439, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 394/1581 (24.9209%)
_Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 616/1581 (38.9627%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8282, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0777, Accuracy: 45/500 (9.0000%)
_Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0498, Accuracy: 192/500 (38.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.1929, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   1, Avg loss: 0.0606, Accuracy: 206/888 (23.1982%)
_Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   2, Avg loss: 0.0266, Accuracy: 427/888 (48.0856%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.5440, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   1, Avg loss: 0.0555, Accuracy: 425/1742 (24.3972%)
_Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 708/1742 (40.6429%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8553, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   1, Avg loss: 0.0852, Accuracy: 2/373 (0.5362%)
_Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   2, Avg loss: 0.0491, Accuracy: 147/373 (39.4102%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.9626, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   1, Avg loss: 0.0841, Accuracy: 20/338 (5.9172%)
_Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   2, Avg loss: 0.0480, Accuracy: 142/338 (42.0118%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.0610, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0630, Accuracy: 176/861 (20.4413%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0221, Accuracy: 421/861 (48.8966%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4926, Accuracy: 74/10000 (0.7400%)
time spent on training: 138.91353106498718
[rfa agg] training data poison_ratio: 0.08662843344400845  data num: [1402, 1241, 1013, 1581, 500, 888, 1742, 373, 338, 861]
[rfa agg] considering poison per batch poison_fraction: 0.02707138545125264
[rfa agg] init. name: [66, 72, 39, 28, 82, 63, 93, 98, 12, 10], weight: tensor([0.1411, 0.1249, 0.1019, 0.1591, 0.0503, 0.0893, 0.1753, 0.0375, 0.0340,
        0.0866])
[rfa agg] iter:  0, prev_obj_val: 57.286781311035156, obj_val: 58.344139099121094, abs dis: 1.0573577880859375
[rfa agg] iter: 0, weight: tensor([0.0954, 0.1292, 0.3485, 0.0702, 0.0223, 0.1277, 0.0575, 0.0134, 0.0122,
        0.1236])
[rfa agg] iter:  1, prev_obj_val: 58.344139099121094, obj_val: 61.71595764160156, abs dis: 3.3718185424804688
[rfa agg] iter: 1, weight: tensor([0.0708, 0.0925, 0.4501, 0.0536, 0.0191, 0.1251, 0.0445, 0.0114, 0.0103,
        0.1226])
[rfa agg] iter:  2, prev_obj_val: 61.71595764160156, obj_val: 65.92460632324219, abs dis: 4.208648681640625
[rfa agg] iter: 2, weight: tensor([0.0646, 0.0792, 0.2862, 0.0513, 0.0231, 0.2124, 0.0436, 0.0134, 0.0121,
        0.2141])
[rfa agg] iter:  3, prev_obj_val: 65.92460632324219, obj_val: 65.85073852539062, abs dis: 0.0738677978515625
[rfa agg] iter: 3, weight: tensor([0.0488, 0.0572, 0.1332, 0.0402, 0.0232, 0.3121, 0.0349, 0.0129, 0.0117,
        0.3258])
[rfa agg] iter:  4, prev_obj_val: 65.85073852539062, obj_val: 71.79151153564453, abs dis: 5.940773010253906
[rfa agg] iter: 4, weight: tensor([0.0449, 0.0526, 0.1188, 0.0370, 0.0213, 0.3303, 0.0321, 0.0119, 0.0108,
        0.3403])
[rfa agg] iter:  5, prev_obj_val: 71.79151153564453, obj_val: 68.65672302246094, abs dis: 3.1347885131835938
[rfa agg] iter: 5, weight: tensor([0.0605, 0.0686, 0.1261, 0.0513, 0.0385, 0.2874, 0.0453, 0.0205, 0.0186,
        0.2832])
[rfa agg] iter:  6, prev_obj_val: 68.65672302246094, obj_val: 68.65310668945312, abs dis: 0.0036163330078125
[rfa agg] iter: 6, weight: tensor([0.0508, 0.0585, 0.1180, 0.0425, 0.0279, 0.3206, 0.0372, 0.0152, 0.0138,
        0.3154])
[rfa agg] iter:  7, prev_obj_val: 68.65310668945312, obj_val: 65.85057830810547, abs dis: 2.8025283813476562
[rfa agg] iter: 7, weight: tensor([0.0502, 0.0578, 0.1164, 0.0420, 0.0275, 0.3229, 0.0368, 0.0150, 0.0136,
        0.3176])
[rfa agg] iter:  8, prev_obj_val: 65.85057830810547, obj_val: 71.79149627685547, abs dis: 5.94091796875
[rfa agg] iter: 8, weight: tensor([0.0448, 0.0525, 0.1181, 0.0369, 0.0213, 0.3374, 0.0320, 0.0119, 0.0108,
        0.3343])
[rfa agg] iter:  9, prev_obj_val: 71.79149627685547, obj_val: 68.65670776367188, abs dis: 3.1347885131835938
[rfa agg] iter: 9, weight: tensor([0.0605, 0.0686, 0.1261, 0.0513, 0.0385, 0.2885, 0.0453, 0.0205, 0.0186,
        0.2822])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.2192, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 6.7576, Accuracy: 0/9950 (0.0000%)
saving model
Done in 387.970360994339 sec.
Server Epoch:8 choose agents : [77, 28, 16, 1, 70, 34, 54, 21, 14, 75].
_Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 285/1340 (21.2687%)
_Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 535/1340 (39.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.4225, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0555, Accuracy: 392/1581 (24.7944%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0344, Accuracy: 588/1581 (37.1917%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.8459, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0637, Accuracy: 246/708 (34.7458%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0427, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.7085, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0606, Accuracy: 265/928 (28.5560%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 566/928 (60.9914%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.3662, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   1, Avg loss: 0.0570, Accuracy: 316/1418 (22.2849%)
_Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   2, Avg loss: 0.0317, Accuracy: 609/1418 (42.9478%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0272, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   1, Avg loss: 0.0574, Accuracy: 354/1427 (24.8073%)
_Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   2, Avg loss: 0.0337, Accuracy: 621/1427 (43.5179%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.6758, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 340/1130 (30.0885%)
_Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 497/1130 (43.9823%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.4659, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0540, Accuracy: 380/1949 (19.4972%)
_Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 612/1949 (31.4007%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.5530, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0671, Accuracy: 190/1013 (18.7562%)
_Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0368, Accuracy: 327/1013 (32.2804%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.0330, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   1, Avg loss: 0.0683, Accuracy: 189/776 (24.3557%)
_Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   2, Avg loss: 0.0304, Accuracy: 367/776 (47.2938%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.8281, Accuracy: 66/10000 (0.6600%)
time spent on training: 135.98500800132751
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 1581, 708, 928, 1418, 1427, 1130, 1949, 1013, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 28, 16, 1, 70, 34, 54, 21, 14, 75], weight: tensor([0.1092, 0.1289, 0.0577, 0.0756, 0.1156, 0.1163, 0.0921, 0.1588, 0.0826,
        0.0632])
[rfa agg] iter:  0, prev_obj_val: 48.468101501464844, obj_val: 52.749481201171875, abs dis: 4.281379699707031
[rfa agg] iter: 0, weight: tensor([0.1785, 0.0791, 0.0307, 0.0682, 0.1042, 0.1050, 0.2472, 0.0494, 0.0985,
        0.0391])
[rfa agg] iter:  1, prev_obj_val: 52.749481201171875, obj_val: 56.71815490722656, abs dis: 3.9686737060546875
[rfa agg] iter: 1, weight: tensor([0.1019, 0.0576, 0.0351, 0.0928, 0.0698, 0.0703, 0.3282, 0.0397, 0.1579,
        0.0467])
[rfa agg] iter:  2, prev_obj_val: 56.71815490722656, obj_val: 61.46123504638672, abs dis: 4.743080139160156
[rfa agg] iter: 2, weight: tensor([0.0815, 0.0518, 0.0434, 0.1385, 0.0604, 0.0609, 0.1909, 0.0377, 0.2747,
        0.0602])
[rfa agg] iter:  3, prev_obj_val: 61.46123504638672, obj_val: 58.89152526855469, abs dis: 2.5697097778320312
[rfa agg] iter: 3, weight: tensor([0.0640, 0.0442, 0.0524, 0.2130, 0.0500, 0.0504, 0.1140, 0.0336, 0.3005,
        0.0778])
[rfa agg] iter:  4, prev_obj_val: 58.89152526855469, obj_val: 58.881690979003906, abs dis: 0.00983428955078125
[rfa agg] iter: 4, weight: tensor([0.0658, 0.0439, 0.0434, 0.1693, 0.0502, 0.0507, 0.1273, 0.0326, 0.3546,
        0.0622])
[rfa agg] iter:  5, prev_obj_val: 58.881690979003906, obj_val: 61.44507598876953, abs dis: 2.563385009765625
[rfa agg] iter: 5, weight: tensor([0.0642, 0.0428, 0.0423, 0.1602, 0.0490, 0.0494, 0.1243, 0.0318, 0.3754,
        0.0605])
[rfa agg] iter:  6, prev_obj_val: 61.44507598876953, obj_val: 61.434532165527344, abs dis: 0.0105438232421875
[rfa agg] iter: 6, weight: tensor([0.0617, 0.0427, 0.0505, 0.2101, 0.0482, 0.0487, 0.1085, 0.0324, 0.3223,
        0.0748])
[rfa agg] iter:  7, prev_obj_val: 61.434532165527344, obj_val: 64.27090454101562, abs dis: 2.8363723754882812
[rfa agg] iter: 7, weight: tensor([0.0620, 0.0429, 0.0508, 0.2231, 0.0485, 0.0489, 0.1089, 0.0326, 0.3069,
        0.0755])
[rfa agg] iter:  8, prev_obj_val: 64.27090454101562, obj_val: 61.44173812866211, abs dis: 2.8291664123535156
[rfa agg] iter: 8, weight: tensor([0.0611, 0.0437, 0.0627, 0.2742, 0.0487, 0.0492, 0.0994, 0.0338, 0.2296,
        0.0976])
[rfa agg] iter:  9, prev_obj_val: 61.44173812866211, obj_val: 61.434303283691406, abs dis: 0.007434844970703125
[rfa agg] iter: 9, weight: tensor([0.0626, 0.0434, 0.0514, 0.2424, 0.0490, 0.0494, 0.1100, 0.0329, 0.2823,
        0.0766])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.6087, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 7.3884, Accuracy: 0/9950 (0.0000%)
saving model
Done in 387.37485432624817 sec.
Server Epoch:9 choose agents : [45, 99, 72, 16, 74, 61, 62, 90, 43, 25].
_Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   1, Avg loss: 0.0695, Accuracy: 177/669 (26.4574%)
_Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   2, Avg loss: 0.0420, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.4389, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0648, Accuracy: 191/773 (24.7089%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0293, Accuracy: 390/773 (50.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.0083, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   1, Avg loss: 0.0656, Accuracy: 228/1241 (18.3723%)
_Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 428/1241 (34.4883%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.6498, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   1, Avg loss: 0.0646, Accuracy: 229/708 (32.3446%)
_Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   2, Avg loss: 0.0397, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.6279, Accuracy: 66/10000 (0.6600%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   1, Avg loss: 0.0417, Accuracy: 534/1552 (34.4072%)
_Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   2, Avg loss: 0.0216, Accuracy: 713/1552 (45.9407%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 11.6034, Accuracy: 77/10000 (0.7700%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1302, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1196, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.6652, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   1, Avg loss: 0.0622, Accuracy: 172/568 (30.2817%)
_Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   2, Avg loss: 0.0396, Accuracy: 259/568 (45.5986%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.8007, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0594, Accuracy: 269/677 (39.7341%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0245, Accuracy: 456/677 (67.3560%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.3086, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   1, Avg loss: 0.0666, Accuracy: 242/946 (25.5814%)
_Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   2, Avg loss: 0.0378, Accuracy: 393/946 (41.5433%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.3811, Accuracy: 70/10000 (0.7000%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   1, Avg loss: 0.0523, Accuracy: 333/690 (48.2609%)
_Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   2, Avg loss: 0.0267, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.0436, Accuracy: 61/10000 (0.6100%)
time spent on training: 155.12966084480286
[rfa agg] training data poison_ratio: 0.2942217726640536  data num: [669, 773, 1241, 708, 1552, 85, 568, 677, 946, 690]
[rfa agg] considering poison per batch poison_fraction: 0.09194430395751674
[rfa agg] init. name: [45, 99, 72, 16, 74, 61, 62, 90, 43, 25], weight: tensor([0.0846, 0.0977, 0.1569, 0.0895, 0.1962, 0.0107, 0.0718, 0.0856, 0.1196,
        0.0872])
[rfa agg] iter:  0, prev_obj_val: 44.15161895751953, obj_val: 46.82241439819336, abs dis: 2.670795440673828
[rfa agg] iter: 0, weight: tensor([0.0984, 0.2468, 0.0565, 0.1654, 0.0415, 0.0024, 0.0450, 0.1027, 0.1385,
        0.1028])
[rfa agg] iter:  1, prev_obj_val: 46.82241439819336, obj_val: 54.9588508605957, abs dis: 8.136436462402344
[rfa agg] iter: 1, weight: tensor([0.1664, 0.1097, 0.0352, 0.1714, 0.0278, 0.0020, 0.0530, 0.1833, 0.0636,
        0.1876])
[rfa agg] iter:  2, prev_obj_val: 54.9588508605957, obj_val: 58.54541778564453, abs dis: 3.586566925048828
[rfa agg] iter: 2, weight: tensor([0.1697, 0.0782, 0.0394, 0.1045, 0.0329, 0.0031, 0.1482, 0.1796, 0.0592,
        0.1853])
[rfa agg] iter:  3, prev_obj_val: 58.54541778564453, obj_val: 58.53414535522461, abs dis: 0.011272430419921875
[rfa agg] iter: 3, weight: tensor([0.1414, 0.0752, 0.0416, 0.0945, 0.0353, 0.0037, 0.2518, 0.1470, 0.0600,
        0.1495])
[rfa agg] iter:  4, prev_obj_val: 58.53414535522461, obj_val: 58.53392028808594, abs dis: 0.000225067138671875
[rfa agg] iter: 4, weight: tensor([0.1382, 0.0740, 0.0409, 0.0927, 0.0347, 0.0036, 0.2667, 0.1441, 0.0590,
        0.1461])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.6367, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 8.8332, Accuracy: 0/9950 (0.0000%)
saving model
Done in 400.5575087070465 sec.
Server Epoch:10 choose agents : [84, 18, 67, 52, 95, 36, 68, 49, 61, 7].
_Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0645, Accuracy: 264/1190 (22.1849%)
_Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 441/1190 (37.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.7166, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   1, Avg loss: 0.0796, Accuracy: 101/530 (19.0566%)
_Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   2, Avg loss: 0.0384, Accuracy: 276/530 (52.0755%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.3270, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   1, Avg loss: 0.0812, Accuracy: 18/426 (4.2254%)
_Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   2, Avg loss: 0.0425, Accuracy: 181/426 (42.4883%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.5349, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   1, Avg loss: 0.0634, Accuracy: 210/636 (33.0189%)
_Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   2, Avg loss: 0.0336, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.1601, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0543, Accuracy: 285/599 (47.5793%)
_Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0308, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 9.7549, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   1, Avg loss: 0.1001, Accuracy: 9/408 (2.2059%)
_Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   2, Avg loss: 0.0622, Accuracy: 148/408 (36.2745%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.9682, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   1, Avg loss: 0.0680, Accuracy: 313/1163 (26.9132%)
_Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   2, Avg loss: 0.0382, Accuracy: 446/1163 (38.3491%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.4645, Accuracy: 55/10000 (0.5500%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   1, Avg loss: 0.0840, Accuracy: 6/440 (1.3636%)
_Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   2, Avg loss: 0.0501, Accuracy: 138/440 (31.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.2873, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1259, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1184, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.9421, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   1, Avg loss: 0.0555, Accuracy: 314/891 (35.2413%)
_Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 477/891 (53.5354%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.9950, Accuracy: 73/10000 (0.7300%)
time spent on training: 147.40699863433838
[rfa agg] training data poison_ratio: 0.1765075376884422  data num: [1190, 530, 426, 636, 599, 408, 1163, 440, 85, 891]
[rfa agg] considering poison per batch poison_fraction: 0.05515860552763819
[rfa agg] init. name: [84, 18, 67, 52, 95, 36, 68, 49, 61, 7], weight: tensor([0.1869, 0.0832, 0.0669, 0.0999, 0.0941, 0.0641, 0.1826, 0.0691, 0.0133,
        0.1399])
[rfa agg] iter:  0, prev_obj_val: 45.6265983581543, obj_val: 57.94721984863281, abs dis: 12.320621490478516
[rfa agg] iter: 0, weight: tensor([0.0453, 0.2035, 0.0578, 0.2404, 0.2198, 0.0550, 0.0444, 0.0593, 0.0038,
        0.0708])
[rfa agg] iter:  1, prev_obj_val: 57.94721984863281, obj_val: 65.47484588623047, abs dis: 7.527626037597656
[rfa agg] iter: 1, weight: tensor([0.0395, 0.1016, 0.2133, 0.0825, 0.0778, 0.1912, 0.0386, 0.1993, 0.0057,
        0.0506])
[rfa agg] iter:  2, prev_obj_val: 65.47484588623047, obj_val: 65.47386169433594, abs dis: 0.00098419189453125
[rfa agg] iter: 2, weight: tensor([0.0480, 0.0913, 0.1983, 0.0818, 0.0774, 0.1886, 0.0470, 0.2003, 0.0090,
        0.0582])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 9.5858, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 9.9580, Accuracy: 0/9950 (0.0000%)
saving model
Done in 389.9060835838318 sec.
Server Epoch:11 choose agents : [29, 92, 35, 7, 25, 14, 74, 13, 32, 17].
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0520, Accuracy: 413/1440 (28.6806%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 696/1440 (48.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.9638, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0549, Accuracy: 385/1715 (22.4490%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 697/1715 (40.6414%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.3597, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   1, Avg loss: 0.0941, Accuracy: 4/271 (1.4760%)
_Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   2, Avg loss: 0.0612, Accuracy: 90/271 (33.2103%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.1584, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   1, Avg loss: 0.0552, Accuracy: 304/891 (34.1190%)
_Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   2, Avg loss: 0.0272, Accuracy: 420/891 (47.1380%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.0750, Accuracy: 68/10000 (0.6800%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0518, Accuracy: 332/690 (48.1159%)
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.0099, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0673, Accuracy: 194/1013 (19.1510%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 367/1013 (36.2290%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.3006, Accuracy: 71/10000 (0.7100%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   1, Avg loss: 0.0412, Accuracy: 506/1552 (32.6031%)
_Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   2, Avg loss: 0.0217, Accuracy: 734/1552 (47.2938%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 11.1190, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0601, Accuracy: 284/1645 (17.2644%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0337, Accuracy: 567/1645 (34.4681%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.4445, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 226/735 (30.7483%)
_Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 373/735 (50.7483%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.7898, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0544, Accuracy: 333/1574 (21.1563%)
_Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 669/1574 (42.5032%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.7573, Accuracy: 104/10000 (1.0400%)
time spent on training: 155.24410557746887
[rfa agg] training data poison_ratio: 0.19451674475099776  data num: [1440, 1715, 271, 891, 690, 1013, 1552, 1645, 735, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.0607864827346868
[rfa agg] init. name: [29, 92, 35, 7, 25, 14, 74, 13, 32, 17], weight: tensor([0.1249, 0.1488, 0.0235, 0.0773, 0.0599, 0.0879, 0.1347, 0.1427, 0.0638,
        0.1366])
[rfa agg] iter:  0, prev_obj_val: 56.86286163330078, obj_val: 56.84882354736328, abs dis: 0.0140380859375
[rfa agg] iter: 0, weight: tensor([0.1725, 0.1058, 0.0096, 0.0875, 0.0429, 0.1578, 0.1268, 0.1158, 0.0522,
        0.1293])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 9.9050, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 11.4931, Accuracy: 0/9950 (0.0000%)
saving model
Done in 402.85312366485596 sec.
Server Epoch:12 choose agents : [43, 94, 30, 38, 40, 20, 75, 61, 26, 17].
_Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   1, Avg loss: 0.0682, Accuracy: 232/946 (24.5243%)
_Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   2, Avg loss: 0.0381, Accuracy: 349/946 (36.8922%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.6163, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0565, Accuracy: 301/1662 (18.1107%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 608/1662 (36.5824%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0707, Accuracy: 105/10000 (1.0500%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0854, Accuracy: 30/486 (6.1728%)
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0418, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.1188, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   1, Avg loss: 0.0619, Accuracy: 228/1131 (20.1592%)
_Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   2, Avg loss: 0.0295, Accuracy: 497/1131 (43.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8118, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   1, Avg loss: 0.0578, Accuracy: 326/1573 (20.7247%)
_Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 592/1573 (37.6351%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0452, Accuracy: 86/10000 (0.8600%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   1, Avg loss: 0.0609, Accuracy: 239/807 (29.6159%)
_Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   2, Avg loss: 0.0332, Accuracy: 422/807 (52.2924%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.0642, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   1, Avg loss: 0.0651, Accuracy: 206/776 (26.5464%)
_Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   2, Avg loss: 0.0280, Accuracy: 407/776 (52.4485%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8913, Accuracy: 85/10000 (0.8500%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   1, Avg loss: 0.1267, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   2, Avg loss: 0.1191, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.1962, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   1, Avg loss: 0.0574, Accuracy: 330/1446 (22.8216%)
_Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 479/1446 (33.1259%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.4646, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   1, Avg loss: 0.0541, Accuracy: 355/1574 (22.5540%)
_Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 687/1574 (43.6468%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.9023, Accuracy: 102/10000 (1.0200%)
time spent on training: 161.28447699546814
[rfa agg] training data poison_ratio: 0.1314133129887469  data num: [946, 1662, 486, 1131, 1573, 807, 776, 85, 1446, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.041066660308983406
[rfa agg] init. name: [43, 94, 30, 38, 40, 20, 75, 61, 26, 17], weight: tensor([0.0902, 0.1585, 0.0463, 0.1079, 0.1500, 0.0770, 0.0740, 0.0081, 0.1379,
        0.1501])
[rfa agg] iter:  0, prev_obj_val: 53.11395263671875, obj_val: 56.04026794433594, abs dis: 2.9263153076171875
[rfa agg] iter: 0, weight: tensor([0.1211, 0.0832, 0.0196, 0.3548, 0.0901, 0.0640, 0.0615, 0.0021, 0.1139,
        0.0897])
[rfa agg] iter:  1, prev_obj_val: 56.04026794433594, obj_val: 59.672462463378906, abs dis: 3.6321945190429688
[rfa agg] iter: 1, weight: tensor([0.1672, 0.0731, 0.0215, 0.3328, 0.0781, 0.0780, 0.0746, 0.0022, 0.0946,
        0.0778])
[rfa agg] iter:  2, prev_obj_val: 59.672462463378906, obj_val: 61.55892562866211, abs dis: 1.8864631652832031
[rfa agg] iter: 2, weight: tensor([0.2705, 0.0672, 0.0246, 0.2089, 0.0709, 0.1031, 0.0985, 0.0024, 0.0831,
        0.0707])
[rfa agg] iter:  3, prev_obj_val: 61.55892562866211, obj_val: 61.538787841796875, abs dis: 0.020137786865234375
[rfa agg] iter: 3, weight: tensor([0.3535, 0.0584, 0.0238, 0.1533, 0.0612, 0.1103, 0.1056, 0.0022, 0.0707,
        0.0610])
[rfa agg] iter:  4, prev_obj_val: 61.538787841796875, obj_val: 66.05207061767578, abs dis: 4.513282775878906
[rfa agg] iter: 4, weight: tensor([0.3763, 0.0565, 0.0231, 0.1462, 0.0592, 0.1066, 0.1024, 0.0022, 0.0685,
        0.0590])
[rfa agg] iter:  5, prev_obj_val: 66.05207061767578, obj_val: 68.66912078857422, abs dis: 2.6170501708984375
[rfa agg] iter: 5, weight: tensor([0.3677, 0.0492, 0.0253, 0.1046, 0.0511, 0.1484, 0.1427, 0.0022, 0.0578,
        0.0510])
[rfa agg] iter:  6, prev_obj_val: 68.66912078857422, obj_val: 68.64413452148438, abs dis: 0.02498626708984375
[rfa agg] iter: 6, weight: tensor([0.2731, 0.0494, 0.0285, 0.0966, 0.0511, 0.1990, 0.1920, 0.0024, 0.0571,
        0.0509])
[rfa agg] iter:  7, prev_obj_val: 68.64413452148438, obj_val: 68.64341735839844, abs dis: 0.0007171630859375
[rfa agg] iter: 7, weight: tensor([0.2570, 0.0493, 0.0285, 0.0965, 0.0510, 0.2079, 0.1996, 0.0024, 0.0570,
        0.0509])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 10.6327, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 11.4001, Accuracy: 0/9950 (0.0000%)
saving model
Done in 406.2790265083313 sec.
Server Epoch:13 choose agents : [42, 89, 83, 18, 67, 8, 21, 60, 56, 28].
_Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   1, Avg loss: 0.0538, Accuracy: 298/1372 (21.7201%)
_Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   2, Avg loss: 0.0322, Accuracy: 494/1372 (36.0058%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.5123, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   1, Avg loss: 0.0671, Accuracy: 255/896 (28.4598%)
_Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   2, Avg loss: 0.0356, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.1588, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0586, Accuracy: 340/1953 (17.4091%)
_Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 727/1953 (37.2248%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.0874, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0780, Accuracy: 96/530 (18.1132%)
_Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0403, Accuracy: 280/530 (52.8302%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.0594, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   1, Avg loss: 0.0807, Accuracy: 18/426 (4.2254%)
_Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   2, Avg loss: 0.0431, Accuracy: 181/426 (42.4883%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.3152, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   1, Avg loss: 0.0626, Accuracy: 209/1513 (13.8136%)
_Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 466/1513 (30.7997%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.3826, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   1, Avg loss: 0.0556, Accuracy: 394/1949 (20.2155%)
_Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 605/1949 (31.0416%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.5641, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0507, Accuracy: 604/2227 (27.1217%)
_Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0288, Accuracy: 989/2227 (44.4095%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.4390, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0671, Accuracy: 48/186 (25.8065%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.1831, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   1, Avg loss: 0.0546, Accuracy: 371/1581 (23.4662%)
_Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   2, Avg loss: 0.0343, Accuracy: 601/1581 (38.0139%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1762, Accuracy: 88/10000 (0.8800%)
time spent on training: 141.49491000175476
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 896, 1953, 530, 426, 1513, 1949, 2227, 186, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 89, 83, 18, 67, 8, 21, 60, 56, 28], weight: tensor([0.1086, 0.0709, 0.1546, 0.0420, 0.0337, 0.1198, 0.1543, 0.1763, 0.0147,
        0.1251])
[rfa agg] iter:  0, prev_obj_val: 66.36576843261719, obj_val: 68.16388702392578, abs dis: 1.7981185913085938
[rfa agg] iter: 0, weight: tensor([0.2491, 0.0310, 0.0754, 0.0118, 0.0083, 0.2859, 0.0752, 0.0578, 0.0029,
        0.2026])
[rfa agg] iter:  1, prev_obj_val: 68.16388702392578, obj_val: 68.1402359008789, abs dis: 0.023651123046875
[rfa agg] iter: 1, weight: tensor([0.3232, 0.0323, 0.0700, 0.0121, 0.0085, 0.2524, 0.0698, 0.0547, 0.0029,
        0.1741])
[rfa agg] iter:  2, prev_obj_val: 68.1402359008789, obj_val: 68.13800811767578, abs dis: 0.002227783203125
[rfa agg] iter: 2, weight: tensor([0.3459, 0.0316, 0.0684, 0.0118, 0.0083, 0.2410, 0.0682, 0.0534, 0.0028,
        0.1685])
[rfa agg] iter:  3, prev_obj_val: 68.13800811767578, obj_val: 68.13776397705078, abs dis: 0.000244140625
[rfa agg] iter: 3, weight: tensor([0.3532, 0.0313, 0.0679, 0.0118, 0.0082, 0.2372, 0.0677, 0.0530, 0.0028,
        0.1668])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 10.9969, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 11.7751, Accuracy: 0/9950 (0.0000%)
saving model
Done in 384.7100758552551 sec.
Server Epoch:14 choose agents : [82, 77, 78, 73, 40, 83, 97, 72, 98, 61].
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0752, Accuracy: 62/500 (12.4000%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 189/500 (37.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.1981, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   1, Avg loss: 0.0522, Accuracy: 297/1340 (22.1642%)
_Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 568/1340 (42.3881%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 9.1901, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   1, Avg loss: 0.0871, Accuracy: 36/416 (8.6538%)
_Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   2, Avg loss: 0.0497, Accuracy: 161/416 (38.7019%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.0669, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   1, Avg loss: 0.0709, Accuracy: 155/938 (16.5245%)
_Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   2, Avg loss: 0.0346, Accuracy: 332/938 (35.3945%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.1218, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   1, Avg loss: 0.0578, Accuracy: 315/1573 (20.0254%)
_Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   2, Avg loss: 0.0354, Accuracy: 510/1573 (32.4221%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.1819, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0589, Accuracy: 331/1953 (16.9483%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 739/1953 (37.8392%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.0029, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   1, Avg loss: 0.0572, Accuracy: 301/1213 (24.8145%)
_Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 478/1213 (39.4064%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 9.2230, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   1, Avg loss: 0.0671, Accuracy: 214/1241 (17.2442%)
_Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   2, Avg loss: 0.0379, Accuracy: 397/1241 (31.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.1461, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0935, Accuracy: 0/373 (0.0000%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0547, Accuracy: 129/373 (34.5845%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8268, Accuracy: 51/10000 (0.5100%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1282, Accuracy: 3/85 (3.5294%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1170, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.6009, Accuracy: 52/10000 (0.5200%)
time spent on training: 142.50510907173157
[rfa agg] training data poison_ratio: 0.008824750830564785  data num: [500, 1340, 416, 938, 1573, 1953, 1213, 1241, 373, 85]
[rfa agg] considering poison per batch poison_fraction: 0.002757734634551495
[rfa agg] init. name: [82, 77, 78, 73, 40, 83, 97, 72, 98, 61], weight: tensor([0.0519, 0.1391, 0.0432, 0.0974, 0.1633, 0.2028, 0.1259, 0.1288, 0.0387,
        0.0088])
[rfa agg] iter:  0, prev_obj_val: 60.208526611328125, obj_val: 60.054935455322266, abs dis: 0.15359115600585938
[rfa agg] iter: 0, weight: tensor([0.0207, 0.1723, 0.0156, 0.1228, 0.0917, 0.0623, 0.2900, 0.2098, 0.0128,
        0.0021])
[rfa agg] iter:  1, prev_obj_val: 60.054935455322266, obj_val: 60.05308151245117, abs dis: 0.00185394287109375
[rfa agg] iter: 1, weight: tensor([0.0199, 0.1669, 0.0150, 0.1176, 0.0882, 0.0600, 0.3123, 0.2057, 0.0123,
        0.0021])
[rfa agg] iter:  2, prev_obj_val: 60.05308151245117, obj_val: 60.0529899597168, abs dis: 9.1552734375e-05
[rfa agg] iter: 2, weight: tensor([0.0198, 0.1659, 0.0149, 0.1169, 0.0879, 0.0597, 0.3166, 0.2039, 0.0123,
        0.0020])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 11.1949, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 13.6200, Accuracy: 0/9950 (0.0000%)
saving model
Done in 382.1234703063965 sec.
Server Epoch:15 choose agents : [82, 75, 98, 92, 31, 50, 22, 78, 46, 37].
_Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   1, Avg loss: 0.0755, Accuracy: 72/500 (14.4000%)
_Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   2, Avg loss: 0.0497, Accuracy: 181/500 (36.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.1512, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 226/776 (29.1237%)
_Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0294, Accuracy: 412/776 (53.0928%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.2076, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   1, Avg loss: 0.0953, Accuracy: 0/373 (0.0000%)
_Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   2, Avg loss: 0.0549, Accuracy: 119/373 (31.9035%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.9223, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0564, Accuracy: 383/1715 (22.3324%)
_Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0317, Accuracy: 645/1715 (37.6093%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.4059, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   1, Avg loss: 0.0856, Accuracy: 44/460 (9.5652%)
_Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   2, Avg loss: 0.0370, Accuracy: 182/460 (39.5652%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.7448, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   1, Avg loss: 0.0609, Accuracy: 134/809 (16.5637%)
_Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   2, Avg loss: 0.0283, Accuracy: 308/809 (38.0717%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.9107, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   1, Avg loss: 0.0472, Accuracy: 476/1470 (32.3810%)
_Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 826/1470 (56.1905%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.9496, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0861, Accuracy: 38/416 (9.1346%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0508, Accuracy: 181/416 (43.5096%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.4382, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   1, Avg loss: 0.0558, Accuracy: 373/1904 (19.5903%)
_Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   2, Avg loss: 0.0310, Accuracy: 671/1904 (35.2416%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.5118, Accuracy: 109/10000 (1.0900%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0535, Accuracy: 397/1129 (35.1639%)
_Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0243, Accuracy: 717/1129 (63.5075%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.5509, Accuracy: 114/10000 (1.1400%)
time spent on training: 147.2511920928955
[rfa agg] training data poison_ratio: 0.11819514237855946  data num: [500, 776, 373, 1715, 460, 809, 1470, 416, 1904, 1129]
[rfa agg] considering poison per batch poison_fraction: 0.03693598199329983
[rfa agg] init. name: [82, 75, 98, 92, 31, 50, 22, 78, 46, 37], weight: tensor([0.0523, 0.0812, 0.0390, 0.1795, 0.0482, 0.0847, 0.1539, 0.0436, 0.1993,
        0.1182])
[rfa agg] iter:  0, prev_obj_val: 71.4127197265625, obj_val: 73.40896606445312, abs dis: 1.996246337890625
[rfa agg] iter: 0, weight: tensor([0.0307, 0.0985, 0.0188, 0.1049, 0.0282, 0.1025, 0.1527, 0.0231, 0.0891,
        0.3515])
[rfa agg] iter:  1, prev_obj_val: 73.40896606445312, obj_val: 75.98268127441406, abs dis: 2.5737152099609375
[rfa agg] iter: 1, weight: tensor([0.0340, 0.1235, 0.0205, 0.0947, 0.0312, 0.1280, 0.1296, 0.0253, 0.0822,
        0.3310])
[rfa agg] iter:  2, prev_obj_val: 75.98268127441406, obj_val: 78.68352508544922, abs dis: 2.7008438110351562
[rfa agg] iter: 2, weight: tensor([0.0396, 0.1713, 0.0232, 0.0892, 0.0363, 0.1768, 0.1162, 0.0290, 0.0789,
        0.2396])
[rfa agg] iter:  3, prev_obj_val: 78.68352508544922, obj_val: 81.68559265136719, abs dis: 3.0020675659179688
[rfa agg] iter: 3, weight: tensor([0.0410, 0.2342, 0.0233, 0.0740, 0.0377, 0.2403, 0.0928, 0.0295, 0.0665,
        0.1606])
[rfa agg] iter:  4, prev_obj_val: 81.68559265136719, obj_val: 85.77375030517578, abs dis: 4.088157653808594
[rfa agg] iter: 4, weight: tensor([0.0366, 0.3106, 0.0199, 0.0520, 0.0336, 0.3144, 0.0631, 0.0257, 0.0474,
        0.0968])
[rfa agg] iter:  5, prev_obj_val: 85.77375030517578, obj_val: 88.34172058105469, abs dis: 2.5679702758789062
[rfa agg] iter: 5, weight: tensor([0.0426, 0.3192, 0.0219, 0.0465, 0.0390, 0.3268, 0.0549, 0.0289, 0.0429,
        0.0772])
[rfa agg] iter:  6, prev_obj_val: 88.34172058105469, obj_val: 91.03884887695312, abs dis: 2.6971282958984375
[rfa agg] iter: 6, weight: tensor([0.0565, 0.2827, 0.0281, 0.0534, 0.0518, 0.2938, 0.0623, 0.0376, 0.0495,
        0.0844])
[rfa agg] iter:  7, prev_obj_val: 91.03884887695312, obj_val: 83.52828979492188, abs dis: 7.51055908203125
[rfa agg] iter: 7, weight: tensor([0.0739, 0.2450, 0.0352, 0.0597, 0.0676, 0.2554, 0.0689, 0.0479, 0.0557,
        0.0906])
[rfa agg] iter:  8, prev_obj_val: 83.52828979492188, obj_val: 88.34538269042969, abs dis: 4.8170928955078125
[rfa agg] iter: 8, weight: tensor([0.0361, 0.3271, 0.0191, 0.0449, 0.0331, 0.3420, 0.0536, 0.0250, 0.0411,
        0.0780])
[rfa agg] iter:  9, prev_obj_val: 88.34538269042969, obj_val: 91.0389404296875, abs dis: 2.6935577392578125
[rfa agg] iter: 9, weight: tensor([0.0563, 0.2825, 0.0280, 0.0533, 0.0516, 0.2948, 0.0622, 0.0375, 0.0495,
        0.0843])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 10.5096, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 12.6558, Accuracy: 0/9950 (0.0000%)
saving model
Done in 399.830815076828 sec.
Server Epoch:16 choose agents : [28, 26, 83, 78, 93, 7, 76, 44, 70, 39].
_Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   1, Avg loss: 0.0532, Accuracy: 380/1581 (24.0354%)
_Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   2, Avg loss: 0.0345, Accuracy: 558/1581 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1172, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   1, Avg loss: 0.0576, Accuracy: 333/1446 (23.0290%)
_Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   2, Avg loss: 0.0353, Accuracy: 500/1446 (34.5781%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.9375, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   1, Avg loss: 0.0600, Accuracy: 336/1953 (17.2043%)
_Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 735/1953 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.7096, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   1, Avg loss: 0.0834, Accuracy: 42/416 (10.0962%)
_Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   2, Avg loss: 0.0487, Accuracy: 197/416 (47.3558%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.1823, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0569, Accuracy: 361/1742 (20.7233%)
_Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0323, Accuracy: 652/1742 (37.4282%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.3662, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   1, Avg loss: 0.0569, Accuracy: 278/891 (31.2009%)
_Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   2, Avg loss: 0.0266, Accuracy: 444/891 (49.8316%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.3160, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0913, Accuracy: 6/466 (1.2876%)
_Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0507, Accuracy: 178/466 (38.1974%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.1275, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   1, Avg loss: 0.0643, Accuracy: 351/1750 (20.0571%)
_Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   2, Avg loss: 0.0359, Accuracy: 647/1750 (36.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.9436, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0584, Accuracy: 302/1418 (21.2976%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0324, Accuracy: 586/1418 (41.3258%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.6134, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   1, Avg loss: 0.0590, Accuracy: 225/1013 (22.2113%)
_Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 508/1013 (50.1481%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.3206, Accuracy: 73/10000 (0.7300%)
time spent on training: 157.52683448791504
[rfa agg] training data poison_ratio: 0.1380561691385295  data num: [1581, 1446, 1953, 416, 1742, 891, 466, 1750, 1418, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.04314255285579047
[rfa agg] init. name: [28, 26, 83, 78, 93, 7, 76, 44, 70, 39], weight: tensor([0.1247, 0.1141, 0.1541, 0.0328, 0.1374, 0.0703, 0.0368, 0.1381, 0.1119,
        0.0799])
[rfa agg] iter:  0, prev_obj_val: 58.17442321777344, obj_val: 53.79240417480469, abs dis: 4.38201904296875
[rfa agg] iter: 0, weight: tensor([0.1413, 0.2202, 0.0751, 0.0115, 0.0941, 0.0486, 0.0138, 0.0950, 0.2235,
        0.0768])
[rfa agg] iter:  1, prev_obj_val: 53.79240417480469, obj_val: 58.08793640136719, abs dis: 4.2955322265625
[rfa agg] iter: 1, weight: tensor([0.1399, 0.2561, 0.0651, 0.0084, 0.0849, 0.0335, 0.0101, 0.0859, 0.2656,
        0.0506])
[rfa agg] iter:  2, prev_obj_val: 58.08793640136719, obj_val: 55.866188049316406, abs dis: 2.2217483520507812
[rfa agg] iter: 2, weight: tensor([0.1382, 0.2277, 0.0733, 0.0112, 0.0917, 0.0474, 0.0135, 0.0926, 0.2295,
        0.0748])
[rfa agg] iter:  3, prev_obj_val: 55.866188049316406, obj_val: 55.8642463684082, abs dis: 0.001941680908203125
[rfa agg] iter: 3, weight: tensor([0.1393, 0.2426, 0.0695, 0.0098, 0.0887, 0.0401, 0.0118, 0.0896, 0.2469,
        0.0618])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 13.1826, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 15.4503, Accuracy: 0/9950 (0.0000%)
saving model
Done in 411.84246373176575 sec.
Server Epoch:17 choose agents : [42, 34, 33, 94, 66, 75, 39, 27, 6, 51].
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 299/1372 (21.7930%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 515/1372 (37.5364%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.8212, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0590, Accuracy: 343/1427 (24.0364%)
_Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0340, Accuracy: 572/1427 (40.0841%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.1018, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0821, Accuracy: 60/515 (11.6505%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0539, Accuracy: 131/515 (25.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.1029, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   1, Avg loss: 0.0581, Accuracy: 282/1662 (16.9675%)
_Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   2, Avg loss: 0.0349, Accuracy: 536/1662 (32.2503%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.0222, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   1, Avg loss: 0.0659, Accuracy: 224/1402 (15.9772%)
_Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   2, Avg loss: 0.0393, Accuracy: 379/1402 (27.0328%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7947, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   1, Avg loss: 0.0620, Accuracy: 229/776 (29.5103%)
_Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   2, Avg loss: 0.0307, Accuracy: 396/776 (51.0309%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.2518, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   1, Avg loss: 0.0577, Accuracy: 244/1013 (24.0869%)
_Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 503/1013 (49.6545%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.6077, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0618, Accuracy: 375/1587 (23.6295%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0350, Accuracy: 606/1587 (38.1853%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.6457, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   1, Avg loss: 0.0537, Accuracy: 374/1956 (19.1207%)
_Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   2, Avg loss: 0.0328, Accuracy: 619/1956 (31.6462%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.7781, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   1, Avg loss: 0.0666, Accuracy: 187/1049 (17.8265%)
_Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 487/1049 (46.4252%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.8377, Accuracy: 112/10000 (1.1200%)
time spent on training: 147.3084499835968
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1427, 515, 1662, 1402, 776, 1013, 1587, 1956, 1049]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 34, 33, 94, 66, 75, 39, 27, 6, 51], weight: tensor([0.1075, 0.1118, 0.0404, 0.1303, 0.1099, 0.0608, 0.0794, 0.1244, 0.1533,
        0.0822])
[rfa agg] iter:  0, prev_obj_val: 51.716400146484375, obj_val: 51.655941009521484, abs dis: 0.060459136962890625
[rfa agg] iter: 0, weight: tensor([0.1676, 0.1345, 0.0173, 0.0889, 0.1733, 0.0416, 0.0974, 0.0995, 0.0599,
        0.1200])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 12.9440, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 15.8883, Accuracy: 0/9950 (0.0000%)
saving model
Done in 391.8529314994812 sec.
Server Epoch:18 choose agents : [90, 5, 3, 28, 2, 9, 92, 60, 86, 34].
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0640, Accuracy: 256/677 (37.8139%)
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0256, Accuracy: 444/677 (65.5835%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 10.1913, Accuracy: 55/10000 (0.5500%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   1, Avg loss: 0.0554, Accuracy: 332/1628 (20.3931%)
_Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   2, Avg loss: 0.0271, Accuracy: 751/1628 (46.1302%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.2793, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0849, Accuracy: 62/781 (7.9385%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0394, Accuracy: 199/781 (25.4802%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.9395, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0535, Accuracy: 366/1581 (23.1499%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0342, Accuracy: 568/1581 (35.9266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.4365, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0646, Accuracy: 164/605 (27.1074%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0407, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.3375, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0562, Accuracy: 358/1275 (28.0784%)
_Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0197, Accuracy: 672/1275 (52.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 10.5418, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   1, Avg loss: 0.0575, Accuracy: 435/1715 (25.3644%)
_Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   2, Avg loss: 0.0315, Accuracy: 679/1715 (39.5918%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.4764, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   1, Avg loss: 0.0523, Accuracy: 488/2227 (21.9129%)
_Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   2, Avg loss: 0.0298, Accuracy: 987/2227 (44.3197%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.9956, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   1, Avg loss: 0.0634, Accuracy: 317/1003 (31.6052%)
_Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   2, Avg loss: 0.0348, Accuracy: 397/1003 (39.5813%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.6446, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   1, Avg loss: 0.0577, Accuracy: 348/1427 (24.3868%)
_Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   2, Avg loss: 0.0344, Accuracy: 591/1427 (41.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.0498, Accuracy: 75/10000 (0.7500%)
time spent on training: 165.484872341156
[rfa agg] training data poison_ratio: 0.12601594550661815  data num: [677, 1628, 781, 1581, 605, 1275, 1715, 2227, 1003, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.03937998297081817
[rfa agg] init. name: [90, 5, 3, 28, 2, 9, 92, 60, 86, 34], weight: tensor([0.0524, 0.1260, 0.0605, 0.1224, 0.0468, 0.0987, 0.1328, 0.1724, 0.0776,
        0.1105])
[rfa agg] iter:  0, prev_obj_val: 59.92031478881836, obj_val: 62.77386474609375, abs dis: 2.8535499572753906
[rfa agg] iter: 0, weight: tensor([0.0224, 0.1190, 0.0318, 0.1431, 0.0182, 0.2058, 0.1027, 0.0572, 0.0619,
        0.2379])
[rfa agg] iter:  1, prev_obj_val: 62.77386474609375, obj_val: 66.33744049072266, abs dis: 3.5635757446289062
[rfa agg] iter: 1, weight: tensor([0.0251, 0.1008, 0.0365, 0.1176, 0.0202, 0.3001, 0.0893, 0.0540, 0.0758,
        0.1806])
[rfa agg] iter:  2, prev_obj_val: 66.33744049072266, obj_val: 66.3192367553711, abs dis: 0.0182037353515625
[rfa agg] iter: 2, weight: tensor([0.0287, 0.0883, 0.0431, 0.1003, 0.0229, 0.3491, 0.0802, 0.0519, 0.0977,
        0.1379])
[rfa agg] iter:  3, prev_obj_val: 66.3192367553711, obj_val: 66.31792449951172, abs dis: 0.001312255859375
[rfa agg] iter: 3, weight: tensor([0.0279, 0.0859, 0.0419, 0.0975, 0.0223, 0.3674, 0.0780, 0.0505, 0.0954,
        0.1331])
[rfa agg] iter:  4, prev_obj_val: 66.31792449951172, obj_val: 66.31780242919922, abs dis: 0.0001220703125
[rfa agg] iter: 4, weight: tensor([0.0277, 0.0852, 0.0416, 0.0966, 0.0221, 0.3731, 0.0773, 0.0501, 0.0945,
        0.1317])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 12.0178, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 17.8808, Accuracy: 0/9950 (0.0000%)
saving model
Done in 404.6209502220154 sec.
Server Epoch:19 choose agents : [8, 20, 42, 21, 5, 25, 24, 71, 13, 18].
_Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   1, Avg loss: 0.0630, Accuracy: 192/1513 (12.6900%)
_Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   2, Avg loss: 0.0373, Accuracy: 463/1513 (30.6015%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5561, Accuracy: 102/10000 (1.0200%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0635, Accuracy: 234/807 (28.9963%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0334, Accuracy: 391/807 (48.4511%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.5398, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   1, Avg loss: 0.0521, Accuracy: 278/1372 (20.2624%)
_Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 504/1372 (36.7347%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.2307, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0586, Accuracy: 392/1949 (20.1129%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0344, Accuracy: 597/1949 (30.6311%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.3934, Accuracy: 87/10000 (0.8700%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   1, Avg loss: 0.0555, Accuracy: 335/1628 (20.5774%)
_Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   2, Avg loss: 0.0268, Accuracy: 771/1628 (47.3587%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.0796, Accuracy: 128/10000 (1.2800%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   1, Avg loss: 0.0545, Accuracy: 306/690 (44.3478%)
_Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 453/690 (65.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5044, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   1, Avg loss: 0.0832, Accuracy: 14/312 (4.4872%)
_Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   2, Avg loss: 0.0451, Accuracy: 154/312 (49.3590%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4328, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   1, Avg loss: 0.0672, Accuracy: 115/818 (14.0587%)
_Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   2, Avg loss: 0.0321, Accuracy: 334/818 (40.8313%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.9355, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   1, Avg loss: 0.0600, Accuracy: 287/1645 (17.4468%)
_Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   2, Avg loss: 0.0336, Accuracy: 581/1645 (35.3191%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.7060, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0822, Accuracy: 74/530 (13.9623%)
_Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0396, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.6238, Accuracy: 54/10000 (0.5400%)
time spent on training: 185.54783415794373
[rfa agg] training data poison_ratio: 0.2774325284090909  data num: [1513, 807, 1372, 1949, 1628, 690, 312, 818, 1645, 530]
[rfa agg] considering poison per batch poison_fraction: 0.0866976651278409
[rfa agg] init. name: [8, 20, 42, 21, 5, 25, 24, 71, 13, 18], weight: tensor([0.1343, 0.0716, 0.1218, 0.1730, 0.1445, 0.0613, 0.0277, 0.0726, 0.1460,
        0.0471])
[rfa agg] iter:  0, prev_obj_val: 67.61125946044922, obj_val: 69.4423828125, abs dis: 1.8311233520507812
[rfa agg] iter: 0, weight: tensor([0.1651, 0.0758, 0.2371, 0.0924, 0.1296, 0.0489, 0.0126, 0.0766, 0.1317,
        0.0302])
[rfa agg] iter:  1, prev_obj_val: 69.4423828125, obj_val: 67.56104278564453, abs dis: 1.8813400268554688
[rfa agg] iter: 1, weight: tensor([0.1583, 0.0858, 0.2216, 0.0922, 0.1264, 0.0541, 0.0136, 0.0866, 0.1283,
        0.0330])
[rfa agg] iter:  2, prev_obj_val: 67.56104278564453, obj_val: 69.44261932373047, abs dis: 1.8815765380859375
[rfa agg] iter: 2, weight: tensor([0.1648, 0.0754, 0.2414, 0.0916, 0.1287, 0.0486, 0.0125, 0.0762, 0.1308,
        0.0300])
[rfa agg] iter:  3, prev_obj_val: 69.44261932373047, obj_val: 67.56103515625, abs dis: 1.8815841674804688
[rfa agg] iter: 3, weight: tensor([0.1583, 0.0858, 0.2217, 0.0922, 0.1263, 0.0541, 0.0136, 0.0866, 0.1283,
        0.0330])
[rfa agg] iter:  4, prev_obj_val: 67.56103515625, obj_val: 69.442626953125, abs dis: 1.881591796875
[rfa agg] iter: 4, weight: tensor([0.1648, 0.0754, 0.2414, 0.0916, 0.1287, 0.0486, 0.0125, 0.0762, 0.1308,
        0.0300])
[rfa agg] iter:  5, prev_obj_val: 69.442626953125, obj_val: 67.56103515625, abs dis: 1.881591796875
[rfa agg] iter: 5, weight: tensor([0.1583, 0.0858, 0.2217, 0.0922, 0.1263, 0.0541, 0.0136, 0.0866, 0.1283,
        0.0330])
[rfa agg] iter:  6, prev_obj_val: 67.56103515625, obj_val: 69.44261932373047, abs dis: 1.8815841674804688
[rfa agg] iter: 6, weight: tensor([0.1648, 0.0754, 0.2414, 0.0916, 0.1287, 0.0486, 0.0125, 0.0762, 0.1308,
        0.0300])
[rfa agg] iter:  7, prev_obj_val: 69.44261932373047, obj_val: 67.56103515625, abs dis: 1.8815841674804688
[rfa agg] iter: 7, weight: tensor([0.1583, 0.0858, 0.2217, 0.0922, 0.1263, 0.0541, 0.0136, 0.0866, 0.1283,
        0.0330])
[rfa agg] iter:  8, prev_obj_val: 67.56103515625, obj_val: 69.44261932373047, abs dis: 1.8815841674804688
[rfa agg] iter: 8, weight: tensor([0.1648, 0.0754, 0.2414, 0.0916, 0.1287, 0.0486, 0.0125, 0.0762, 0.1308,
        0.0300])
[rfa agg] iter:  9, prev_obj_val: 69.44261932373047, obj_val: 67.56103515625, abs dis: 1.8815841674804688
[rfa agg] iter: 9, weight: tensor([0.1583, 0.0858, 0.2217, 0.0922, 0.1263, 0.0541, 0.0136, 0.0866, 0.1283,
        0.0330])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 12.0210, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 16.1370, Accuracy: 0/9950 (0.0000%)
saving model
Done in 435.7733268737793 sec.
Server Epoch:20 choose agents : [89, 17, 66, 8, 76, 59, 83, 62, 70, 12].
_Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   1, Avg loss: 0.0720, Accuracy: 243/896 (27.1205%)
_Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   2, Avg loss: 0.0368, Accuracy: 443/896 (49.4420%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.3751, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   1, Avg loss: 0.0562, Accuracy: 305/1574 (19.3774%)
_Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   2, Avg loss: 0.0294, Accuracy: 596/1574 (37.8653%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.1364, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   1, Avg loss: 0.0636, Accuracy: 233/1402 (16.6191%)
_Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   2, Avg loss: 0.0393, Accuracy: 407/1402 (29.0300%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.5419, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   1, Avg loss: 0.0630, Accuracy: 204/1513 (13.4831%)
_Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   2, Avg loss: 0.0380, Accuracy: 444/1513 (29.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.7602, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0916, Accuracy: 4/466 (0.8584%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0521, Accuracy: 179/466 (38.4120%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.2148, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0570, Accuracy: 277/1089 (25.4362%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0300, Accuracy: 456/1089 (41.8733%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.5627, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   1, Avg loss: 0.0601, Accuracy: 320/1953 (16.3850%)
_Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   2, Avg loss: 0.0345, Accuracy: 698/1953 (35.7399%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.1502, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   1, Avg loss: 0.0664, Accuracy: 111/568 (19.5423%)
_Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   2, Avg loss: 0.0398, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8800, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0597, Accuracy: 294/1418 (20.7334%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0323, Accuracy: 596/1418 (42.0310%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.4762, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   1, Avg loss: 0.0876, Accuracy: 14/338 (4.1420%)
_Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   2, Avg loss: 0.0494, Accuracy: 128/338 (37.8698%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.3026, Accuracy: 50/10000 (0.5000%)
time spent on training: 150.78797268867493
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1574, 1402, 1513, 466, 1089, 1953, 568, 1418, 338]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 17, 66, 8, 76, 59, 83, 62, 70, 12], weight: tensor([0.0799, 0.1403, 0.1250, 0.1349, 0.0415, 0.0971, 0.1741, 0.0506, 0.1264,
        0.0301])
[rfa agg] iter:  0, prev_obj_val: 59.7125129699707, obj_val: 59.59307098388672, abs dis: 0.11944198608398438
[rfa agg] iter: 0, weight: tensor([0.0799, 0.1175, 0.1961, 0.1334, 0.0193, 0.1891, 0.0743, 0.0259, 0.1526,
        0.0118])
[rfa agg] iter:  1, prev_obj_val: 59.59307098388672, obj_val: 59.591346740722656, abs dis: 0.0017242431640625
[rfa agg] iter: 1, weight: tensor([0.0781, 0.1149, 0.1940, 0.1304, 0.0189, 0.2042, 0.0727, 0.0254, 0.1499,
        0.0116])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 13.5074, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 17.3991, Accuracy: 0/9950 (0.0000%)
saving model
Done in 401.9322454929352 sec.
Server Epoch:21 choose agents : [0, 21, 31, 56, 90, 65, 87, 37, 77, 26].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0622, Accuracy: 314/1657 (18.9499%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0357, Accuracy: 547/1657 (33.0115%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0326, Accuracy: 600/1657 (36.2100%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0314, Accuracy: 636/1657 (38.3826%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0311, Accuracy: 656/1657 (39.5896%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0308, Accuracy: 643/1657 (38.8051%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0300, Accuracy: 681/1657 (41.0984%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0294, Accuracy: 682/1657 (41.1587%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0292, Accuracy: 706/1657 (42.6071%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0292, Accuracy: 723/1657 (43.6331%), train_poison_data_count: 520
Global model norm: 187.38555882524673.
Norm before scaling: 187.33318621176014. Distance: 1.335214296421769
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.1808, Accuracy: 71/10000 (0.7100%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.8925, Accuracy: 8352/9950 (83.9397%)
Scaling by  100
Scaled Norm after poisoning: 225.39093641659596, distance: 133.52142413532368
Total norm for 3 adversaries is: 225.39093641659596. distance: 133.52142413532368
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0594, Accuracy: 377/1949 (19.3433%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0341, Accuracy: 612/1949 (31.4007%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.5262, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   1, Avg loss: 0.0845, Accuracy: 38/460 (8.2609%)
_Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   2, Avg loss: 0.0383, Accuracy: 182/460 (39.5652%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.3583, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   1, Avg loss: 0.0817, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   2, Avg loss: 0.0662, Accuracy: 53/186 (28.4946%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.7790, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   1, Avg loss: 0.0666, Accuracy: 250/677 (36.9276%)
_Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   2, Avg loss: 0.0285, Accuracy: 445/677 (65.7312%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.9950, Accuracy: 55/10000 (0.5500%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0613, Accuracy: 354/1475 (24.0000%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0332, Accuracy: 607/1475 (41.1525%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.5894, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   1, Avg loss: 0.0671, Accuracy: 252/1131 (22.2812%)
_Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   2, Avg loss: 0.0342, Accuracy: 378/1131 (33.4218%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.1228, Accuracy: 58/10000 (0.5800%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   1, Avg loss: 0.0534, Accuracy: 382/1129 (33.8353%)
_Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   2, Avg loss: 0.0260, Accuracy: 724/1129 (64.1275%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.9670, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 280/1340 (20.8955%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0284, Accuracy: 530/1340 (39.5522%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.4250, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0598, Accuracy: 282/1446 (19.5021%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0362, Accuracy: 501/1446 (34.6473%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.9697, Accuracy: 66/10000 (0.6600%)
time spent on training: 297.97344732284546
[rfa agg] training data poison_ratio: 0.3721397379912664  data num: [1657, 1949, 460, 186, 677, 1475, 1131, 1129, 1340, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.11629366812227074
[rfa agg] init. name: [0, 21, 31, 56, 90, 65, 87, 37, 77, 26], weight: tensor([0.1447, 0.1702, 0.0402, 0.0162, 0.0591, 0.1288, 0.0988, 0.0986, 0.1170,
        0.1263])
[rfa agg] iter:  0, prev_obj_val: 28781.0859375, obj_val: 19122.353515625, abs dis: 9658.732421875
[rfa agg] iter: 0, weight: tensor([0.0278, 0.1945, 0.0453, 0.0183, 0.0668, 0.1466, 0.1121, 0.1119, 0.1330,
        0.1437])
[rfa agg] iter:  1, prev_obj_val: 19122.353515625, obj_val: 17218.150390625, abs dis: 1904.203125
[rfa agg] iter: 1, weight: tensor([0.0048, 0.2034, 0.0450, 0.0180, 0.0668, 0.1509, 0.1138, 0.1136, 0.1360,
        0.1476])
[rfa agg] iter:  2, prev_obj_val: 17218.150390625, obj_val: 16893.349609375, abs dis: 324.80078125
[rfa agg] iter: 2, weight: tensor([0.0008, 0.2337, 0.0379, 0.0143, 0.0582, 0.1554, 0.1080, 0.1078, 0.1342,
        0.1498])
[rfa agg] iter:  3, prev_obj_val: 16893.349609375, obj_val: 16877.6875, abs dis: 15.662109375
[rfa agg] iter: 3, weight: tensor([7.2656e-05, 4.9608e-01, 1.2127e-02, 3.9340e-03, 2.0773e-02, 1.4477e-01,
        5.5559e-02, 5.5374e-02, 8.8496e-02, 1.2282e-01])
[rfa agg] iter:  4, prev_obj_val: 16877.6875, obj_val: 16878.1328125, abs dis: 0.4453125
[rfa agg] iter: 4, weight: tensor([4.9921e-05, 1.0782e-01, 1.1169e-02, 3.3927e-03, 2.0246e-02, 2.8364e-01,
        7.1181e-02, 7.0311e-02, 1.5265e-01, 2.7955e-01])
[rfa agg] iter:  5, prev_obj_val: 16878.1328125, obj_val: 16879.09765625, abs dis: 0.96484375
[rfa agg] iter: 5, weight: tensor([4.4237e-05, 6.6463e-02, 1.2160e-02, 3.4847e-03, 2.3291e-02, 1.5143e-01,
        1.1772e-01, 1.1419e-01, 3.0605e-01, 2.0517e-01])
[rfa agg] iter:  6, prev_obj_val: 16879.09765625, obj_val: 16882.1484375, abs dis: 3.05078125
[rfa agg] iter: 6, weight: tensor([4.2588e-05, 6.1013e-02, 1.2172e-02, 3.4461e-03, 2.3591e-02, 1.2508e-01,
        1.3277e-01, 1.2825e-01, 3.4840e-01, 1.6524e-01])
[rfa agg] iter:  7, prev_obj_val: 16882.1484375, obj_val: 16883.87890625, abs dis: 1.73046875
[rfa agg] iter: 7, weight: tensor([4.5774e-05, 6.0034e-02, 1.4193e-02, 3.9140e-03, 2.8268e-02, 1.0877e-01,
        2.0096e-01, 1.8946e-01, 2.5935e-01, 1.3502e-01])
[rfa agg] iter:  8, prev_obj_val: 16883.87890625, obj_val: 16885.830078125, abs dis: 1.951171875
[rfa agg] iter: 8, weight: tensor([4.4921e-05, 5.6524e-02, 1.4551e-02, 3.9548e-03, 2.9450e-02, 9.7482e-02,
        2.4914e-01, 2.2909e-01, 2.0163e-01, 1.1814e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 14.4916, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 18.4292, Accuracy: 0/9950 (0.0000%)
saving model
Done in 560.3949744701385 sec.
Server Epoch:22 choose agents : [13, 26, 58, 22, 88, 2, 65, 9, 90, 64].
_Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0599, Accuracy: 284/1645 (17.2644%)
_Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0342, Accuracy: 555/1645 (33.7386%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.7660, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   1, Avg loss: 0.0611, Accuracy: 287/1446 (19.8479%)
_Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   2, Avg loss: 0.0358, Accuracy: 517/1446 (35.7538%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.9250, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0606, Accuracy: 299/803 (37.2354%)
_Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0353, Accuracy: 398/803 (49.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4234, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0483, Accuracy: 464/1470 (31.5646%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 862/1470 (58.6395%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.5229, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   1, Avg loss: 0.0832, Accuracy: 75/603 (12.4378%)
_Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   2, Avg loss: 0.0449, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.5106, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0644, Accuracy: 184/605 (30.4132%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0400, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4182, Accuracy: 63/10000 (0.6300%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   1, Avg loss: 0.0623, Accuracy: 330/1475 (22.3729%)
_Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   2, Avg loss: 0.0329, Accuracy: 593/1475 (40.2034%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.4781, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   1, Avg loss: 0.0507, Accuracy: 372/1275 (29.1765%)
_Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   2, Avg loss: 0.0204, Accuracy: 634/1275 (49.7255%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.8472, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   1, Avg loss: 0.0673, Accuracy: 250/677 (36.9276%)
_Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   2, Avg loss: 0.0261, Accuracy: 468/677 (69.1285%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.1833, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   1, Avg loss: 0.0668, Accuracy: 158/953 (16.5792%)
_Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   2, Avg loss: 0.0394, Accuracy: 336/953 (35.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.6957, Accuracy: 58/10000 (0.5800%)
time spent on training: 162.17991495132446
[rfa agg] training data poison_ratio: 0.13467859751643535  data num: [1645, 1446, 803, 1470, 603, 605, 1475, 1275, 677, 953]
[rfa agg] considering poison per batch poison_fraction: 0.04208706172388604
[rfa agg] init. name: [13, 26, 58, 22, 88, 2, 65, 9, 90, 64], weight: tensor([0.1502, 0.1320, 0.0733, 0.1342, 0.0551, 0.0552, 0.1347, 0.1164, 0.0618,
        0.0870])
[rfa agg] iter:  0, prev_obj_val: 52.83681869506836, obj_val: 55.731414794921875, abs dis: 2.8945960998535156
[rfa agg] iter: 0, weight: tensor([0.0894, 0.1193, 0.0813, 0.1205, 0.0373, 0.0372, 0.1031, 0.2046, 0.0481,
        0.1591])
[rfa agg] iter:  1, prev_obj_val: 55.731414794921875, obj_val: 58.88835144042969, abs dis: 3.1569366455078125
[rfa agg] iter: 1, weight: tensor([0.0793, 0.1008, 0.1012, 0.1021, 0.0424, 0.0422, 0.0890, 0.1579, 0.0559,
        0.2293])
[rfa agg] iter:  2, prev_obj_val: 58.88835144042969, obj_val: 62.63212585449219, abs dis: 3.7437744140625
[rfa agg] iter: 2, weight: tensor([0.0641, 0.0783, 0.1212, 0.0794, 0.0444, 0.0440, 0.0703, 0.1118, 0.0604,
        0.3261])
[rfa agg] iter:  3, prev_obj_val: 62.63212585449219, obj_val: 69.64261627197266, abs dis: 7.010490417480469
[rfa agg] iter: 3, weight: tensor([0.0543, 0.0641, 0.1637, 0.0651, 0.0497, 0.0491, 0.0585, 0.0856, 0.0706,
        0.3392])
[rfa agg] iter:  4, prev_obj_val: 69.64261627197266, obj_val: 69.52476501464844, abs dis: 0.11785125732421875
[rfa agg] iter: 4, weight: tensor([0.0489, 0.0557, 0.2892, 0.0566, 0.0731, 0.0712, 0.0516, 0.0693, 0.1159,
        0.1685])
[rfa agg] iter:  5, prev_obj_val: 69.52476501464844, obj_val: 67.07967376708984, abs dis: 2.4450912475585938
[rfa agg] iter: 5, weight: tensor([0.0452, 0.0515, 0.3468, 0.0523, 0.0684, 0.0670, 0.0477, 0.0640, 0.1095,
        0.1475])
[rfa agg] iter:  6, prev_obj_val: 67.07967376708984, obj_val: 67.0740966796875, abs dis: 0.00557708740234375
[rfa agg] iter: 6, weight: tensor([0.0481, 0.0554, 0.3249, 0.0562, 0.0608, 0.0601, 0.0510, 0.0702, 0.0929,
        0.1803])
[rfa agg] iter:  7, prev_obj_val: 67.0740966796875, obj_val: 67.07386016845703, abs dis: 0.00023651123046875
[rfa agg] iter: 7, weight: tensor([0.0486, 0.0560, 0.3150, 0.0568, 0.0614, 0.0605, 0.0516, 0.0710, 0.0936,
        0.1854])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 13.3348, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 18.1859, Accuracy: 0/9950 (0.0000%)
saving model
Done in 423.47831416130066 sec.
Server Epoch:23 choose agents : [20, 11, 63, 44, 2, 74, 26, 89, 3, 6].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0705, Accuracy: 139/807 (17.2243%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0375, Accuracy: 329/807 (40.7683%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0307, Accuracy: 342/807 (42.3792%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0288, Accuracy: 350/807 (43.3705%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0282, Accuracy: 376/807 (46.5923%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0264, Accuracy: 382/807 (47.3358%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0272, Accuracy: 370/807 (45.8488%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0260, Accuracy: 413/807 (51.1772%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0257, Accuracy: 402/807 (49.8141%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0258, Accuracy: 411/807 (50.9294%), train_poison_data_count: 260
Global model norm: 193.31571287339784.
Norm before scaling: 193.29251432414551. Distance: 0.9659164272886516
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.2545, Accuracy: 60/10000 (0.6000%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.7157, Accuracy: 8442/9950 (84.8442%)
Scaling by  100
Scaled Norm after poisoning: 213.79940949403954, distance: 96.59164709778221
Total norm for 3 adversaries is: 213.79940949403954. distance: 96.59164709778221
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   1, Avg loss: 0.0541, Accuracy: 279/712 (39.1854%)
_Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 448/712 (62.9213%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.7679, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   1, Avg loss: 0.0561, Accuracy: 215/888 (24.2117%)
_Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   2, Avg loss: 0.0266, Accuracy: 431/888 (48.5360%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.4191, Accuracy: 73/10000 (0.7300%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   1, Avg loss: 0.0644, Accuracy: 366/1750 (20.9143%)
_Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   2, Avg loss: 0.0374, Accuracy: 599/1750 (34.2286%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.9189, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0650, Accuracy: 174/605 (28.7603%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 329/605 (54.3802%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.3847, Accuracy: 68/10000 (0.6800%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0413, Accuracy: 483/1552 (31.1211%)
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0217, Accuracy: 759/1552 (48.9046%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 12.0516, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   1, Avg loss: 0.0608, Accuracy: 267/1446 (18.4647%)
_Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   2, Avg loss: 0.0358, Accuracy: 485/1446 (33.5408%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7765, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   1, Avg loss: 0.0698, Accuracy: 259/896 (28.9062%)
_Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   2, Avg loss: 0.0360, Accuracy: 435/896 (48.5491%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.4536, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0843, Accuracy: 80/781 (10.2433%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0389, Accuracy: 224/781 (28.6812%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.5541, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   1, Avg loss: 0.0563, Accuracy: 379/1956 (19.3763%)
_Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   2, Avg loss: 0.0328, Accuracy: 621/1956 (31.7485%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.5377, Accuracy: 111/10000 (1.1100%)
time spent on training: 282.419410943985
[rfa agg] training data poison_ratio: 0.3606600544193803  data num: [807, 712, 888, 1750, 605, 1552, 1446, 896, 781, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.11270626700605635
[rfa agg] init. name: [20, 11, 63, 44, 2, 74, 26, 89, 3, 6], weight: tensor([0.0708, 0.0625, 0.0779, 0.1536, 0.0531, 0.1362, 0.1269, 0.0786, 0.0686,
        0.1717])
[rfa agg] iter:  0, prev_obj_val: 7675.0107421875, obj_val: 4414.07421875, abs dis: 3260.9365234375
[rfa agg] iter: 0, weight: tensor([0.0057, 0.0655, 0.0820, 0.1665, 0.0554, 0.1467, 0.1361, 0.0827, 0.0720,
        0.1874])
[rfa agg] iter:  1, prev_obj_val: 4414.07421875, obj_val: 4196.61083984375, abs dis: 217.46337890625
[rfa agg] iter: 1, weight: tensor([0.0004, 0.0505, 0.0660, 0.1912, 0.0411, 0.1542, 0.1354, 0.0666, 0.0567,
        0.2378])
[rfa agg] iter:  2, prev_obj_val: 4196.61083984375, obj_val: 4199.328125, abs dis: 2.71728515625
[rfa agg] iter: 2, weight: tensor([4.8812e-05, 2.5325e-02, 3.8345e-02, 1.2991e-01, 1.8209e-02, 2.3242e-01,
        3.9157e-01, 3.8712e-02, 3.0546e-02, 9.4914e-02])
[rfa agg] iter:  3, prev_obj_val: 4199.328125, obj_val: 4203.27490234375, abs dis: 3.94677734375
[rfa agg] iter: 3, weight: tensor([5.8670e-05, 3.5152e-02, 5.4845e-02, 1.2230e-01, 2.4710e-02, 1.9200e-01,
        3.7642e-01, 5.5418e-02, 4.3034e-02, 9.6071e-02])
[rfa agg] iter:  4, prev_obj_val: 4203.27490234375, obj_val: 4204.61669921875, abs dis: 1.341796875
[rfa agg] iter: 4, weight: tensor([7.3406e-05, 5.2028e-02, 8.4863e-02, 1.2626e-01, 3.5458e-02, 1.7539e-01,
        2.7079e-01, 8.5757e-02, 6.5050e-02, 1.0434e-01])
[rfa agg] iter:  5, prev_obj_val: 4204.61669921875, obj_val: 4207.40576171875, abs dis: 2.7890625
[rfa agg] iter: 5, weight: tensor([7.6345e-05, 5.7731e-02, 9.6191e-02, 1.2415e-01, 3.8824e-02, 1.6728e-01,
        2.4171e-01, 9.7207e-02, 7.2869e-02, 1.0397e-01])
[rfa agg] iter:  6, prev_obj_val: 4207.40576171875, obj_val: 4205.99951171875, abs dis: 1.40625
[rfa agg] iter: 6, weight: tensor([7.8669e-05, 6.8337e-02, 1.1936e-01, 1.1506e-01, 4.4586e-02, 1.4755e-01,
        1.9741e-01, 1.2068e-01, 8.8188e-02, 9.8753e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 13.9696, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 19.5626, Accuracy: 0/9950 (0.0000%)
saving model
Done in 537.0769612789154 sec.
Server Epoch:24 choose agents : [75, 96, 99, 97, 17, 80, 3, 13, 60, 83].
_Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   1, Avg loss: 0.0665, Accuracy: 213/776 (27.4485%)
_Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   2, Avg loss: 0.0298, Accuracy: 398/776 (51.2887%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.4966, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   1, Avg loss: 0.0814, Accuracy: 9/311 (2.8939%)
_Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   2, Avg loss: 0.0547, Accuracy: 128/311 (41.1576%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.3977, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   1, Avg loss: 0.0626, Accuracy: 181/773 (23.4153%)
_Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   2, Avg loss: 0.0335, Accuracy: 429/773 (55.4981%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.5318, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   1, Avg loss: 0.0533, Accuracy: 329/1213 (27.1228%)
_Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 496/1213 (40.8904%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.9329, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0554, Accuracy: 302/1574 (19.1868%)
_Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0292, Accuracy: 598/1574 (37.9924%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.0392, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   1, Avg loss: 0.0771, Accuracy: 99/682 (14.5161%)
_Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   2, Avg loss: 0.0400, Accuracy: 260/682 (38.1232%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.7147, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0833, Accuracy: 80/781 (10.2433%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0379, Accuracy: 234/781 (29.9616%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.8531, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0604, Accuracy: 286/1645 (17.3860%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0337, Accuracy: 588/1645 (35.7447%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.6728, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   1, Avg loss: 0.0509, Accuracy: 542/2227 (24.3377%)
_Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   2, Avg loss: 0.0291, Accuracy: 1010/2227 (45.3525%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.8378, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0598, Accuracy: 345/1953 (17.6651%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0347, Accuracy: 690/1953 (35.3303%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.2381, Accuracy: 99/10000 (0.9900%)
time spent on training: 168.98227977752686
[rfa agg] training data poison_ratio: 0.0  data num: [776, 311, 773, 1213, 1574, 682, 781, 1645, 2227, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 96, 99, 97, 17, 80, 3, 13, 60, 83], weight: tensor([0.0650, 0.0261, 0.0648, 0.1016, 0.1319, 0.0571, 0.0654, 0.1378, 0.1866,
        0.1636])
[rfa agg] iter:  0, prev_obj_val: 74.73641204833984, obj_val: 75.68366241455078, abs dis: 0.9472503662109375
[rfa agg] iter: 0, weight: tensor([0.0483, 0.0100, 0.0480, 0.2164, 0.2169, 0.0346, 0.0486, 0.1815, 0.0875,
        0.1083])
[rfa agg] iter:  1, prev_obj_val: 75.68366241455078, obj_val: 77.94786071777344, abs dis: 2.2641983032226562
[rfa agg] iter: 1, weight: tensor([0.0504, 0.0101, 0.0501, 0.2587, 0.1952, 0.0357, 0.0507, 0.1646, 0.0831,
        0.1013])
[rfa agg] iter:  2, prev_obj_val: 77.94786071777344, obj_val: 79.15443420410156, abs dis: 1.206573486328125
[rfa agg] iter: 2, weight: tensor([0.0538, 0.0101, 0.0534, 0.3523, 0.1494, 0.0371, 0.0540, 0.1305, 0.0728,
        0.0866])
[rfa agg] iter:  3, prev_obj_val: 79.15443420410156, obj_val: 80.522705078125, abs dis: 1.3682708740234375
[rfa agg] iter: 3, weight: tensor([0.0526, 0.0095, 0.0522, 0.4226, 0.1242, 0.0358, 0.0529, 0.1101, 0.0644,
        0.0756])
[rfa agg] iter:  4, prev_obj_val: 80.522705078125, obj_val: 80.50858306884766, abs dis: 0.01412200927734375
[rfa agg] iter: 4, weight: tensor([0.0523, 0.0091, 0.0518, 0.4753, 0.1053, 0.0349, 0.0525, 0.0945, 0.0575,
        0.0669])
[rfa agg] iter:  5, prev_obj_val: 80.50858306884766, obj_val: 82.12321472167969, abs dis: 1.6146316528320312
[rfa agg] iter: 5, weight: tensor([0.0498, 0.0086, 0.0493, 0.5004, 0.1002, 0.0333, 0.0500, 0.0899, 0.0548,
        0.0637])
[rfa agg] iter:  6, prev_obj_val: 82.12321472167969, obj_val: 85.80581665039062, abs dis: 3.6826019287109375
[rfa agg] iter: 6, weight: tensor([0.0563, 0.0093, 0.0556, 0.4814, 0.0969, 0.0369, 0.0565, 0.0878, 0.0554,
        0.0638])
[rfa agg] iter:  7, prev_obj_val: 85.80581665039062, obj_val: 80.55877685546875, abs dis: 5.247039794921875
[rfa agg] iter: 7, weight: tensor([0.0832, 0.0124, 0.0820, 0.3491, 0.1043, 0.0521, 0.0834, 0.0962, 0.0644,
        0.0729])
[rfa agg] iter:  8, prev_obj_val: 80.55877685546875, obj_val: 80.51419830322266, abs dis: 0.04457855224609375
[rfa agg] iter: 8, weight: tensor([0.0552, 0.0095, 0.0547, 0.4476, 0.1106, 0.0368, 0.0555, 0.0993, 0.0604,
        0.0703])
[rfa agg] iter:  9, prev_obj_val: 80.51419830322266, obj_val: 82.12215423583984, abs dis: 1.6079559326171875
[rfa agg] iter: 9, weight: tensor([0.0511, 0.0089, 0.0506, 0.4874, 0.1028, 0.0342, 0.0513, 0.0922, 0.0562,
        0.0653])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 14.0114, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 17.4649, Accuracy: 0/9950 (0.0000%)
saving model
Done in 417.86563324928284 sec.
Server Epoch:25 choose agents : [74, 18, 82, 53, 32, 64, 95, 19, 44, 38].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0510, Accuracy: 336/1552 (21.6495%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0241, Accuracy: 641/1552 (41.3015%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Avg loss: 0.0230, Accuracy: 716/1552 (46.1340%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Avg loss: 0.0229, Accuracy: 698/1552 (44.9742%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Avg loss: 0.0222, Accuracy: 764/1552 (49.2268%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Avg loss: 0.0214, Accuracy: 750/1552 (48.3247%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Avg loss: 0.0206, Accuracy: 806/1552 (51.9330%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Avg loss: 0.0213, Accuracy: 806/1552 (51.9330%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Avg loss: 0.0206, Accuracy: 832/1552 (53.6082%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Avg loss: 0.0208, Accuracy: 810/1552 (52.1907%), train_poison_data_count: 496
Global model norm: 199.07440113560557.
Norm before scaling: 199.02209166007174. Distance: 1.3326445479297975
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.6139, Accuracy: 85/10000 (0.8500%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.8433, Accuracy: 7613/9950 (76.5126%)
Scaling by  100
Scaled Norm after poisoning: 234.79898317497032, distance: 133.2644516084466
Total norm for 3 adversaries is: 234.79898317497032. distance: 133.2644516084466
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   1, Avg loss: 0.0782, Accuracy: 89/530 (16.7925%)
_Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   2, Avg loss: 0.0418, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.5694, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   1, Avg loss: 0.0724, Accuracy: 78/500 (15.6000%)
_Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   2, Avg loss: 0.0482, Accuracy: 201/500 (40.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.5250, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0460, Accuracy: 250/813 (30.7503%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 447/813 (54.9815%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 12.4386, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0682, Accuracy: 150/735 (20.4082%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0256, Accuracy: 346/735 (47.0748%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 11.1547, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   1, Avg loss: 0.0662, Accuracy: 181/953 (18.9927%)
_Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   2, Avg loss: 0.0390, Accuracy: 288/953 (30.2204%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8785, Accuracy: 75/10000 (0.7500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0602, Accuracy: 246/599 (41.0684%)
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0332, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 12.0867, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   1, Avg loss: 0.0563, Accuracy: 301/1036 (29.0541%)
_Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 677/1036 (65.3475%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 12.8240, Accuracy: 78/10000 (0.7800%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0642, Accuracy: 358/1750 (20.4571%)
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0373, Accuracy: 635/1750 (36.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8205, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   1, Avg loss: 0.0675, Accuracy: 188/1131 (16.6225%)
_Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 475/1131 (41.9982%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.7770, Accuracy: 98/10000 (0.9800%)
time spent on training: 294.03957056999207
[rfa agg] training data poison_ratio: 0.40639649963537866  data num: [1552, 530, 500, 813, 735, 953, 599, 1036, 1750, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.12699890613605583
[rfa agg] init. name: [74, 18, 82, 53, 32, 64, 95, 19, 44, 38], weight: tensor([0.1617, 0.0552, 0.0521, 0.0847, 0.0766, 0.0993, 0.0624, 0.1079, 0.1823,
        0.1178])
[rfa agg] iter:  0, prev_obj_val: 30333.857421875, obj_val: 20800.2578125, abs dis: 9533.599609375
[rfa agg] iter: 0, weight: tensor([0.0358, 0.0633, 0.0596, 0.0972, 0.0879, 0.1141, 0.0715, 0.1241, 0.2108,
        0.1356])
[rfa agg] iter:  1, prev_obj_val: 20800.2578125, obj_val: 18624.791015625, abs dis: 2175.466796875
[rfa agg] iter: 1, weight: tensor([0.0071, 0.0642, 0.0605, 0.0994, 0.0897, 0.1171, 0.0728, 0.1279, 0.2214,
        0.1399])
[rfa agg] iter:  2, prev_obj_val: 18624.791015625, obj_val: 18194.91796875, abs dis: 429.873046875
[rfa agg] iter: 2, weight: tensor([0.0013, 0.0599, 0.0559, 0.0960, 0.0859, 0.1151, 0.0685, 0.1281, 0.2479,
        0.1414])
[rfa agg] iter:  3, prev_obj_val: 18194.91796875, obj_val: 18153.1015625, abs dis: 41.81640625
[rfa agg] iter: 3, weight: tensor([1.6695e-04, 3.0814e-02, 2.7855e-02, 5.7237e-02, 4.9179e-02, 7.4925e-02,
        3.6432e-02, 9.2204e-02, 5.2369e-01, 1.0749e-01])
[rfa agg] iter:  4, prev_obj_val: 18153.1015625, obj_val: 18144.431640625, abs dis: 8.669921875
[rfa agg] iter: 4, weight: tensor([1.0393e-04, 3.4996e-02, 3.0621e-02, 7.8141e-02, 6.3662e-02, 1.1779e-01,
        4.2974e-02, 1.7728e-01, 2.2177e-01, 2.3266e-01])
[rfa agg] iter:  5, prev_obj_val: 18144.431640625, obj_val: 18147.611328125, abs dis: 3.1796875
[rfa agg] iter: 5, weight: tensor([5.2534e-05, 2.7436e-02, 2.3085e-02, 8.0406e-02, 5.9958e-02, 1.6068e-01,
        3.5309e-02, 2.9251e-01, 6.6326e-02, 2.5424e-01])
[rfa agg] iter:  6, prev_obj_val: 18147.611328125, obj_val: 18148.755859375, abs dis: 1.14453125
[rfa agg] iter: 6, weight: tensor([5.2407e-05, 3.9044e-02, 3.1459e-02, 1.6394e-01, 1.0911e-01, 2.6847e-01,
        5.3110e-02, 1.5618e-01, 5.3957e-02, 1.2468e-01])
[rfa agg] iter:  7, prev_obj_val: 18148.755859375, obj_val: 18152.09765625, abs dis: 3.341796875
[rfa agg] iter: 7, weight: tensor([5.0315e-05, 4.1305e-02, 3.2801e-02, 2.0661e-01, 1.2706e-01, 2.5428e-01,
        5.7527e-02, 1.2601e-01, 4.9976e-02, 1.0438e-01])
[rfa agg] iter:  8, prev_obj_val: 18152.09765625, obj_val: 18156.42578125, abs dis: 4.328125
[rfa agg] iter: 8, weight: tensor([4.8606e-05, 4.8968e-02, 3.7629e-02, 2.7255e-01, 1.8435e-01, 1.6157e-01,
        7.1667e-02, 9.5014e-02, 4.5140e-02, 8.3066e-02])
[rfa agg] iter:  9, prev_obj_val: 18156.42578125, obj_val: 18156.39453125, abs dis: 0.03125
[rfa agg] iter: 9, weight: tensor([4.9051e-05, 6.3720e-02, 4.6736e-02, 2.2237e-01, 2.5930e-01, 1.1526e-01,
        1.0050e-01, 7.8233e-02, 4.2766e-02, 7.1071e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 13.4092, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 14.9433, Accuracy: 0/9950 (0.0000%)
saving model
Done in 545.4458243846893 sec.
Server Epoch:26 choose agents : [19, 3, 96, 58, 94, 68, 87, 88, 54, 66].
_Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   1, Avg loss: 0.0533, Accuracy: 324/1036 (31.2741%)
_Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   2, Avg loss: 0.0242, Accuracy: 661/1036 (63.8031%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 12.7470, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.0843, Accuracy: 68/781 (8.7068%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0396, Accuracy: 217/781 (27.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.4071, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   1, Avg loss: 0.0843, Accuracy: 9/311 (2.8939%)
_Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   2, Avg loss: 0.0566, Accuracy: 124/311 (39.8714%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.2441, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   1, Avg loss: 0.0588, Accuracy: 316/803 (39.3524%)
_Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   2, Avg loss: 0.0357, Accuracy: 378/803 (47.0735%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.7772, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   1, Avg loss: 0.0592, Accuracy: 271/1662 (16.3057%)
_Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   2, Avg loss: 0.0346, Accuracy: 577/1662 (34.7172%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.5457, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0683, Accuracy: 295/1163 (25.3654%)
_Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0391, Accuracy: 384/1163 (33.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.8874, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.0654, Accuracy: 243/1131 (21.4854%)
_Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0330, Accuracy: 396/1131 (35.0133%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.9253, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   1, Avg loss: 0.0812, Accuracy: 76/603 (12.6036%)
_Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   2, Avg loss: 0.0465, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.0668, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0604, Accuracy: 280/1130 (24.7788%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 517/1130 (45.7522%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.5496, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   1, Avg loss: 0.0629, Accuracy: 234/1402 (16.6904%)
_Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   2, Avg loss: 0.0391, Accuracy: 396/1402 (28.2454%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.5494, Accuracy: 67/10000 (0.6700%)
time spent on training: 155.30729866027832
[rfa agg] training data poison_ratio: 0.0  data num: [1036, 781, 311, 803, 1662, 1163, 1131, 603, 1130, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [19, 3, 96, 58, 94, 68, 87, 88, 54, 66], weight: tensor([0.1034, 0.0779, 0.0310, 0.0801, 0.1658, 0.1160, 0.1129, 0.0602, 0.1128,
        0.1399])
[rfa agg] iter:  0, prev_obj_val: 41.10572814941406, obj_val: 48.10963439941406, abs dis: 7.00390625
[rfa agg] iter: 0, weight: tensor([0.2014, 0.0563, 0.0077, 0.0580, 0.0552, 0.1443, 0.1805, 0.0258, 0.1895,
        0.0815])
[rfa agg] iter:  1, prev_obj_val: 48.10963439941406, obj_val: 50.22632598876953, abs dis: 2.1166915893554688
[rfa agg] iter: 1, weight: tensor([0.1695, 0.1278, 0.0118, 0.1294, 0.0592, 0.1092, 0.1338, 0.0462, 0.1355,
        0.0776])
[rfa agg] iter:  2, prev_obj_val: 50.22632598876953, obj_val: 50.21586608886719, abs dis: 0.01045989990234375
[rfa agg] iter: 2, weight: tensor([0.1446, 0.1608, 0.0125, 0.1633, 0.0572, 0.0989, 0.1182, 0.0517, 0.1194,
        0.0733])
[rfa agg] iter:  3, prev_obj_val: 50.21586608886719, obj_val: 50.21581268310547, abs dis: 5.340576171875e-05
[rfa agg] iter: 3, weight: tensor([0.1428, 0.1631, 0.0125, 0.1662, 0.0569, 0.0983, 0.1172, 0.0516, 0.1185,
        0.0729])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 12.9945, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 15.9105, Accuracy: 0/9950 (0.0000%)
saving model
Done in 398.1573143005371 sec.
Server Epoch:27 choose agents : [95, 51, 93, 9, 60, 99, 31, 17, 49, 65].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0766, Accuracy: 121/599 (20.2003%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0263, Accuracy: 341/599 (56.9282%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Avg loss: 0.0293, Accuracy: 271/599 (45.2421%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Avg loss: 0.0284, Accuracy: 326/599 (54.4240%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Avg loss: 0.0256, Accuracy: 364/599 (60.7679%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Avg loss: 0.0253, Accuracy: 369/599 (61.6027%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Avg loss: 0.0253, Accuracy: 359/599 (59.9332%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Avg loss: 0.0253, Accuracy: 359/599 (59.9332%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Avg loss: 0.0237, Accuracy: 371/599 (61.9366%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Avg loss: 0.0237, Accuracy: 358/599 (59.7663%), train_poison_data_count: 200
Global model norm: 204.68242360117296.
Norm before scaling: 204.66462658456638. Distance: 0.8797892902898314
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.1293, Accuracy: 49/10000 (0.4900%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.7434, Accuracy: 5413/9950 (54.4020%)
Scaling by  100
Scaled Norm after poisoning: 220.9759955854934, distance: 87.97892925119912
Total norm for 3 adversaries is: 220.9759955854934. distance: 87.97892925119912
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0663, Accuracy: 190/1049 (18.1125%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0311, Accuracy: 514/1049 (48.9990%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.9258, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   1, Avg loss: 0.0595, Accuracy: 333/1742 (19.1160%)
_Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   2, Avg loss: 0.0329, Accuracy: 657/1742 (37.7153%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.3123, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Avg loss: 0.0486, Accuracy: 383/1275 (30.0392%)
_Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Avg loss: 0.0189, Accuracy: 706/1275 (55.3725%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.8041, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   1, Avg loss: 0.0512, Accuracy: 504/2227 (22.6313%)
_Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   2, Avg loss: 0.0294, Accuracy: 972/2227 (43.6462%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.9686, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.0667, Accuracy: 171/773 (22.1216%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0351, Accuracy: 388/773 (50.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.7347, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   1, Avg loss: 0.0872, Accuracy: 18/460 (3.9130%)
_Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   2, Avg loss: 0.0377, Accuracy: 181/460 (39.3478%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.6428, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0550, Accuracy: 324/1574 (20.5845%)
_Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0285, Accuracy: 658/1574 (41.8043%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.2943, Accuracy: 97/10000 (0.9700%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   1, Avg loss: 0.0820, Accuracy: 9/440 (2.0455%)
_Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   2, Avg loss: 0.0493, Accuracy: 127/440 (28.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.2539, Accuracy: 55/10000 (0.5500%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   1, Avg loss: 0.0598, Accuracy: 333/1475 (22.5763%)
_Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   2, Avg loss: 0.0325, Accuracy: 637/1475 (43.1864%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.7009, Accuracy: 96/10000 (0.9600%)
time spent on training: 298.45791268348694
[rfa agg] training data poison_ratio: 0.2164628896159807  data num: [599, 1049, 1742, 1275, 2227, 773, 460, 1574, 440, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.06764465300499398
[rfa agg] init. name: [95, 51, 93, 9, 60, 99, 31, 17, 49, 65], weight: tensor([0.0516, 0.0903, 0.1500, 0.1098, 0.1918, 0.0666, 0.0396, 0.1355, 0.0379,
        0.1270])
[rfa agg] iter:  0, prev_obj_val: 4410.3857421875, obj_val: 2439.857666015625, abs dis: 1970.528076171875
[rfa agg] iter: 0, weight: tensor([0.0029, 0.0925, 0.1602, 0.1137, 0.2104, 0.0671, 0.0392, 0.1430, 0.0374,
        0.1335])
[rfa agg] iter:  1, prev_obj_val: 2439.857666015625, obj_val: 2397.240966796875, abs dis: 42.61669921875
[rfa agg] iter: 1, weight: tensor([8.8357e-05, 4.0404e-02, 1.5106e-01, 5.8168e-02, 5.1149e-01, 2.4739e-02,
        1.2091e-02, 1.0240e-01, 1.1151e-02, 8.8417e-02])
[rfa agg] iter:  2, prev_obj_val: 2397.240966796875, obj_val: 2393.1865234375, abs dis: 4.054443359375
[rfa agg] iter: 2, weight: tensor([5.2388e-05, 4.2598e-02, 3.4185e-01, 7.2190e-02, 1.2966e-01, 2.3313e-02,
        1.0354e-02, 2.1343e-01, 9.4119e-03, 1.5714e-01])
[rfa agg] iter:  3, prev_obj_val: 2393.1865234375, obj_val: 2395.641845703125, abs dis: 2.455322265625
[rfa agg] iter: 3, weight: tensor([4.3408e-05, 5.0929e-02, 1.4869e-01, 1.0413e-01, 7.2798e-02, 2.5397e-02,
        1.0449e-02, 2.9556e-01, 9.3938e-03, 2.8261e-01])
[rfa agg] iter:  4, prev_obj_val: 2395.641845703125, obj_val: 2398.267578125, abs dis: 2.625732421875
[rfa agg] iter: 4, weight: tensor([4.9074e-05, 7.0620e-02, 1.2296e-01, 1.6618e-01, 7.2630e-02, 3.3131e-02,
        1.3013e-02, 2.2611e-01, 1.1631e-02, 2.8368e-01])
[rfa agg] iter:  5, prev_obj_val: 2398.267578125, obj_val: 2398.21728515625, abs dis: 0.05029296875
[rfa agg] iter: 5, weight: tensor([5.3153e-05, 9.0043e-02, 1.1452e-01, 2.4384e-01, 7.3051e-02, 3.9941e-02,
        1.5120e-02, 1.8401e-01, 1.3449e-02, 2.2597e-01])
[rfa agg] iter:  6, prev_obj_val: 2398.21728515625, obj_val: 2396.872314453125, abs dis: 1.344970703125
[rfa agg] iter: 6, weight: tensor([5.2643e-05, 8.9991e-02, 1.1339e-01, 2.5790e-01, 7.2367e-02, 3.9550e-02,
        1.4979e-02, 1.8019e-01, 1.3322e-02, 2.1826e-01])
[rfa agg] iter:  7, prev_obj_val: 2396.872314453125, obj_val: 2401.341796875, abs dis: 4.469482421875
[rfa agg] iter: 7, weight: tensor([5.1568e-05, 8.1291e-02, 1.1931e-01, 2.1818e-01, 7.3526e-02, 3.6671e-02,
        1.4160e-02, 1.9882e-01, 1.2624e-02, 2.4536e-01])
[rfa agg] iter:  8, prev_obj_val: 2401.341796875, obj_val: 2401.242431640625, abs dis: 0.099365234375
[rfa agg] iter: 8, weight: tensor([5.3190e-05, 1.0795e-01, 1.0056e-01, 3.2787e-01, 6.8217e-02, 4.5016e-02,
        1.6314e-02, 1.4767e-01, 1.4430e-02, 1.7193e-01])
[rfa agg] iter:  9, prev_obj_val: 2401.242431640625, obj_val: 2402.98974609375, abs dis: 1.747314453125
[rfa agg] iter: 9, weight: tensor([5.0587e-05, 1.0419e-01, 9.5448e-02, 3.6476e-01, 6.4867e-02, 4.2754e-02,
        1.5515e-02, 1.3880e-01, 1.3721e-02, 1.5990e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 12.5553, Accuracy: 64/10000 (0.6400%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 13.6280, Accuracy: 0/9950 (0.0000%)
saving model
Done in 547.2233378887177 sec.
Server Epoch:28 choose agents : [51, 19, 66, 24, 25, 80, 58, 15, 0, 90].
_Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   1, Avg loss: 0.0678, Accuracy: 179/1049 (17.0639%)
_Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   2, Avg loss: 0.0311, Accuracy: 490/1049 (46.7112%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.7152, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   1, Avg loss: 0.0544, Accuracy: 312/1036 (30.1158%)
_Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   2, Avg loss: 0.0246, Accuracy: 676/1036 (65.2510%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 13.0768, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   1, Avg loss: 0.0640, Accuracy: 236/1402 (16.8331%)
_Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   2, Avg loss: 0.0402, Accuracy: 347/1402 (24.7504%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.1552, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   1, Avg loss: 0.0848, Accuracy: 5/312 (1.6026%)
_Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   2, Avg loss: 0.0459, Accuracy: 135/312 (43.2692%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.3359, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   1, Avg loss: 0.0540, Accuracy: 281/690 (40.7246%)
_Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 10.1003, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   1, Avg loss: 0.0787, Accuracy: 72/682 (10.5572%)
_Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   2, Avg loss: 0.0408, Accuracy: 251/682 (36.8035%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.8935, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   1, Avg loss: 0.0590, Accuracy: 304/803 (37.8580%)
_Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 412/803 (51.3076%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9130, Accuracy: 57/10000 (0.5700%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   1, Avg loss: 0.0646, Accuracy: 250/1154 (21.6638%)
_Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   2, Avg loss: 0.0305, Accuracy: 434/1154 (37.6083%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 10.3172, Accuracy: 83/10000 (0.8300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   1, Avg loss: 0.0635, Accuracy: 296/1657 (17.8636%)
_Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   2, Avg loss: 0.0361, Accuracy: 494/1657 (29.8129%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.4271, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   1, Avg loss: 0.0608, Accuracy: 270/677 (39.8818%)
_Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   2, Avg loss: 0.0256, Accuracy: 454/677 (67.0606%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 10.6448, Accuracy: 60/10000 (0.6000%)
time spent on training: 196.7085244655609
[rfa agg] training data poison_ratio: 0.37000634115409003  data num: [1049, 1036, 1402, 312, 690, 682, 803, 1154, 1657, 677]
[rfa agg] considering poison per batch poison_fraction: 0.11562698161065313
[rfa agg] init. name: [51, 19, 66, 24, 25, 80, 58, 15, 0, 90], weight: tensor([0.1109, 0.1095, 0.1482, 0.0330, 0.0729, 0.0721, 0.0849, 0.1220, 0.1751,
        0.0715])
[rfa agg] iter:  0, prev_obj_val: 51.24065399169922, obj_val: 52.38785171508789, abs dis: 1.1471977233886719
[rfa agg] iter: 0, weight: tensor([0.1481, 0.1793, 0.0912, 0.0140, 0.0755, 0.0756, 0.1557, 0.1164, 0.0696,
        0.0747])
[rfa agg] iter:  1, prev_obj_val: 52.38785171508789, obj_val: 59.01506423950195, abs dis: 6.6272125244140625
[rfa agg] iter: 1, weight: tensor([0.1359, 0.1580, 0.0837, 0.0144, 0.0829, 0.0836, 0.1896, 0.1039, 0.0652,
        0.0827])
[rfa agg] iter:  2, prev_obj_val: 59.01506423950195, obj_val: 66.4569320678711, abs dis: 7.441867828369141
[rfa agg] iter: 2, weight: tensor([0.0806, 0.0856, 0.0577, 0.0154, 0.1282, 0.1357, 0.2497, 0.0660, 0.0482,
        0.1330])
[rfa agg] iter:  3, prev_obj_val: 66.4569320678711, obj_val: 66.35198974609375, abs dis: 0.10494232177734375
[rfa agg] iter: 3, weight: tensor([0.0574, 0.0596, 0.0453, 0.0170, 0.1823, 0.2129, 0.1290, 0.0496, 0.0394,
        0.2074])
[rfa agg] iter:  4, prev_obj_val: 66.35198974609375, obj_val: 73.26791381835938, abs dis: 6.915924072265625
[rfa agg] iter: 4, weight: tensor([0.0534, 0.0555, 0.0424, 0.0160, 0.1887, 0.2256, 0.1167, 0.0462, 0.0369,
        0.2186])
[rfa agg] iter:  5, prev_obj_val: 73.26791381835938, obj_val: 61.11014938354492, abs dis: 12.157764434814453
[rfa agg] iter: 5, weight: tensor([0.0599, 0.0616, 0.0498, 0.0238, 0.1887, 0.2079, 0.1073, 0.0531, 0.0443,
        0.2037])
[rfa agg] iter:  6, prev_obj_val: 61.11014938354492, obj_val: 63.54326248168945, abs dis: 2.4331130981445312
[rfa agg] iter: 6, weight: tensor([0.0672, 0.0712, 0.0507, 0.0153, 0.1610, 0.1751, 0.1881, 0.0568, 0.0430,
        0.1716])
[rfa agg] iter:  7, prev_obj_val: 63.54326248168945, obj_val: 63.53280258178711, abs dis: 0.01045989990234375
[rfa agg] iter: 7, weight: tensor([0.0597, 0.0627, 0.0462, 0.0156, 0.1758, 0.2013, 0.1517, 0.0511, 0.0397,
        0.1964])
[rfa agg] iter:  8, prev_obj_val: 63.53280258178711, obj_val: 66.35582733154297, abs dis: 2.8230247497558594
[rfa agg] iter: 8, weight: tensor([0.0587, 0.0617, 0.0455, 0.0154, 0.1775, 0.2050, 0.1471, 0.0503, 0.0391,
        0.1998])
[rfa agg] iter:  9, prev_obj_val: 66.35582733154297, obj_val: 73.26769256591797, abs dis: 6.911865234375
[rfa agg] iter: 9, weight: tensor([0.0537, 0.0559, 0.0426, 0.0161, 0.1881, 0.2243, 0.1180, 0.0465, 0.0371,
        0.2176])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 12.7087, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 15.7077, Accuracy: 0/9950 (0.0000%)
saving model
Done in 443.40899777412415 sec.
Server Epoch:29 choose agents : [5, 8, 98, 14, 70, 64, 74, 49, 75, 78].
poison local model 5 index 4 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   1, Avg loss: 0.0576, Accuracy: 347/1628 (21.3145%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   2, Avg loss: 0.0294, Accuracy: 641/1628 (39.3735%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   3, Avg loss: 0.0263, Accuracy: 737/1628 (45.2703%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   4, Avg loss: 0.0248, Accuracy: 804/1628 (49.3857%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   5, Avg loss: 0.0248, Accuracy: 838/1628 (51.4742%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   6, Avg loss: 0.0238, Accuracy: 844/1628 (51.8428%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   7, Avg loss: 0.0236, Accuracy: 883/1628 (54.2383%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   8, Avg loss: 0.0223, Accuracy: 922/1628 (56.6339%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   9, Avg loss: 0.0219, Accuracy: 935/1628 (57.4324%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch  10, Avg loss: 0.0224, Accuracy: 913/1628 (56.0811%), train_poison_data_count: 520
Global model norm: 210.1376594937233.
Norm before scaling: 210.0786032209135. Distance: 1.3836630236851035
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.9249, Accuracy: 114/10000 (1.1400%)
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: 0.7779, Accuracy: 8303/9950 (83.4472%)
Scaling by  100
Scaled Norm after poisoning: 246.2303212314641, distance: 138.36632622995742
Total norm for 3 adversaries is: 246.2303212314641. distance: 138.36632622995742
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   1, Avg loss: 0.0638, Accuracy: 176/1513 (11.6325%)
_Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   2, Avg loss: 0.0374, Accuracy: 474/1513 (31.3285%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.6310, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   1, Avg loss: 0.0984, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   2, Avg loss: 0.0567, Accuracy: 98/373 (26.2735%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.0661, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   1, Avg loss: 0.0648, Accuracy: 185/1013 (18.2626%)
_Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 324/1013 (31.9842%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.7609, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0639, Accuracy: 285/1418 (20.0987%)
_Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0329, Accuracy: 547/1418 (38.5755%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.6159, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   1, Avg loss: 0.0715, Accuracy: 148/953 (15.5299%)
_Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   2, Avg loss: 0.0394, Accuracy: 291/953 (30.5352%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.6378, Accuracy: 63/10000 (0.6300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0466, Accuracy: 427/1552 (27.5129%)
_Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0224, Accuracy: 713/1552 (45.9407%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.0052, Accuracy: 88/10000 (0.8800%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   1, Avg loss: 0.0851, Accuracy: 9/440 (2.0455%)
_Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   2, Avg loss: 0.0503, Accuracy: 118/440 (26.8182%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.5421, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   1, Avg loss: 0.0637, Accuracy: 217/776 (27.9639%)
_Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   2, Avg loss: 0.0356, Accuracy: 366/776 (47.1649%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.9157, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.0822, Accuracy: 51/416 (12.2596%)
_Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0460, Accuracy: 200/416 (48.0769%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.9770, Accuracy: 76/10000 (0.7600%)
time spent on training: 302.7995889186859
[rfa agg] training data poison_ratio: 0.3590557429081531  data num: [1628, 1513, 373, 1013, 1418, 953, 1552, 440, 776, 416]
[rfa agg] considering poison per batch poison_fraction: 0.11220491965879785
[rfa agg] init. name: [5, 8, 98, 14, 70, 64, 74, 49, 75, 78], weight: tensor([0.1615, 0.1501, 0.0370, 0.1005, 0.1406, 0.0945, 0.1539, 0.0436, 0.0770,
        0.0413])
[rfa agg] iter:  0, prev_obj_val: 31519.287109375, obj_val: 21602.1328125, abs dis: 9917.154296875
[rfa agg] iter: 0, weight: tensor([0.0357, 0.1730, 0.0423, 0.1154, 0.1621, 0.1085, 0.1776, 0.0499, 0.0883,
        0.0472])
[rfa agg] iter:  1, prev_obj_val: 21602.1328125, obj_val: 19343.078125, abs dis: 2259.0546875
[rfa agg] iter: 1, weight: tensor([0.0070, 0.1798, 0.0426, 0.1183, 0.1682, 0.1111, 0.1849, 0.0504, 0.0901,
        0.0477])
[rfa agg] iter:  2, prev_obj_val: 19343.078125, obj_val: 18897.44921875, abs dis: 445.62890625
[rfa agg] iter: 2, weight: tensor([0.0013, 0.1895, 0.0384, 0.1158, 0.1755, 0.1078, 0.1967, 0.0458, 0.0859,
        0.0433])
[rfa agg] iter:  3, prev_obj_val: 18897.44921875, obj_val: 18843.728515625, abs dis: 53.720703125
[rfa agg] iter: 3, weight: tensor([1.9851e-04, 2.3519e-01, 2.0940e-02, 8.8600e-02, 2.0119e-01, 7.9077e-02,
        2.6655e-01, 2.5664e-02, 5.8322e-02, 2.4267e-02])
[rfa agg] iter:  4, prev_obj_val: 18843.728515625, obj_val: 18845.92578125, abs dis: 2.197265625
[rfa agg] iter: 4, weight: tensor([6.2466e-05, 2.4742e-01, 1.1816e-02, 8.6695e-02, 3.1111e-01, 7.0973e-02,
        1.9802e-01, 1.4952e-02, 4.4810e-02, 1.4138e-02])
[rfa agg] iter:  5, prev_obj_val: 18845.92578125, obj_val: 18848.66796875, abs dis: 2.7421875
[rfa agg] iter: 5, weight: tensor([7.4992e-05, 2.0821e-01, 1.5655e-02, 1.3666e-01, 2.5444e-01, 1.0829e-01,
        1.7316e-01, 1.9963e-02, 6.4671e-02, 1.8875e-02])
[rfa agg] iter:  6, prev_obj_val: 18848.66796875, obj_val: 18849.62109375, abs dis: 0.953125
[rfa agg] iter: 6, weight: tensor([7.8006e-05, 1.6320e-01, 1.8178e-02, 2.0523e-01, 1.8583e-01, 1.5485e-01,
        1.4248e-01, 2.3412e-02, 8.4601e-02, 2.2136e-02])
[rfa agg] iter:  7, prev_obj_val: 18849.62109375, obj_val: 18851.80859375, abs dis: 2.1875
[rfa agg] iter: 7, weight: tensor([7.5512e-05, 1.4532e-01, 1.8326e-02, 2.3715e-01, 1.6243e-01, 1.7227e-01,
        1.2862e-01, 2.3697e-02, 8.9714e-02, 2.2403e-02])
[rfa agg] iter:  8, prev_obj_val: 18851.80859375, obj_val: 18853.03125, abs dis: 1.22265625
[rfa agg] iter: 8, weight: tensor([6.7380e-05, 1.1231e-01, 1.7772e-02, 2.9485e-01, 1.2244e-01, 2.0833e-01,
        1.0125e-01, 2.3185e-02, 9.7868e-02, 2.1917e-02])
[rfa agg] iter:  9, prev_obj_val: 18853.03125, obj_val: 18856.162109375, abs dis: 3.130859375
[rfa agg] iter: 9, weight: tensor([6.1324e-05, 9.5564e-02, 1.6917e-02, 3.2653e-01, 1.0309e-01, 2.2792e-01,
        8.6867e-02, 2.2182e-02, 9.9898e-02, 2.0966e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 14.2154, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 13.3598, Accuracy: 0/9950 (0.0000%)
saving model
Done in 548.2259192466736 sec.
Server Epoch:30 choose agents : [72, 69, 82, 58, 15, 79, 52, 28, 1, 17].
_Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   1, Avg loss: 0.0673, Accuracy: 194/1241 (15.6326%)
_Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   2, Avg loss: 0.0373, Accuracy: 434/1241 (34.9718%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.6808, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0571, Accuracy: 242/590 (41.0169%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0298, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 12.4031, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   1, Avg loss: 0.0748, Accuracy: 83/500 (16.6000%)
_Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   2, Avg loss: 0.0500, Accuracy: 198/500 (39.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.3316, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   1, Avg loss: 0.0601, Accuracy: 272/803 (33.8730%)
_Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 417/803 (51.9303%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7834, Accuracy: 56/10000 (0.5600%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0633, Accuracy: 255/1154 (22.0971%)
_Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0310, Accuracy: 449/1154 (38.9081%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 10.1899, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   1, Avg loss: 0.1474, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   2, Avg loss: 0.1185, Accuracy: 0/197 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7042, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.0679, Accuracy: 164/636 (25.7862%)
_Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0322, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.9300, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   1, Avg loss: 0.0527, Accuracy: 343/1581 (21.6951%)
_Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   2, Avg loss: 0.0343, Accuracy: 530/1581 (33.5231%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.3701, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0625, Accuracy: 250/928 (26.9397%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0248, Accuracy: 557/928 (60.0216%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.7062, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   1, Avg loss: 0.0545, Accuracy: 324/1574 (20.5845%)
_Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   2, Avg loss: 0.0287, Accuracy: 624/1574 (39.6442%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.2298, Accuracy: 103/10000 (1.0300%)
time spent on training: 182.37715864181519
[rfa agg] training data poison_ratio: 0.12538026944806605  data num: [1241, 590, 500, 803, 1154, 197, 636, 1581, 928, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.03918133420252064
[rfa agg] init. name: [72, 69, 82, 58, 15, 79, 52, 28, 1, 17], weight: tensor([0.1348, 0.0641, 0.0543, 0.0872, 0.1254, 0.0214, 0.0691, 0.1718, 0.1008,
        0.1710])
[rfa agg] iter:  0, prev_obj_val: 55.93231964111328, obj_val: 58.10261154174805, abs dis: 2.1702919006347656
[rfa agg] iter: 0, weight: tensor([0.1496, 0.0498, 0.0320, 0.1268, 0.1591, 0.0082, 0.0534, 0.0897, 0.2417,
        0.0896])
[rfa agg] iter:  1, prev_obj_val: 58.10261154174805, obj_val: 59.50270080566406, abs dis: 1.4000892639160156
[rfa agg] iter: 1, weight: tensor([0.1134, 0.0544, 0.0335, 0.1600, 0.1217, 0.0082, 0.0583, 0.0745, 0.3017,
        0.0745])
[rfa agg] iter:  2, prev_obj_val: 59.50270080566406, obj_val: 59.497867584228516, abs dis: 0.004833221435546875
[rfa agg] iter: 2, weight: tensor([0.1005, 0.0581, 0.0349, 0.1882, 0.1066, 0.0083, 0.0623, 0.0690, 0.3033,
        0.0689])
[rfa agg] iter:  3, prev_obj_val: 59.497867584228516, obj_val: 61.13890075683594, abs dis: 1.6410331726074219
[rfa agg] iter: 3, weight: tensor([0.0999, 0.0579, 0.0347, 0.1902, 0.1057, 0.0082, 0.0621, 0.0686, 0.3042,
        0.0685])
[rfa agg] iter:  4, prev_obj_val: 61.13890075683594, obj_val: 62.93755340576172, abs dis: 1.7986526489257812
[rfa agg] iter: 4, weight: tensor([0.0931, 0.0648, 0.0377, 0.2334, 0.0981, 0.0087, 0.0695, 0.0662, 0.2624,
        0.0661])
[rfa agg] iter:  5, prev_obj_val: 62.93755340576172, obj_val: 62.917198181152344, abs dis: 0.020355224609375
[rfa agg] iter: 5, weight: tensor([0.0856, 0.0722, 0.0406, 0.2901, 0.0896, 0.0090, 0.0772, 0.0628, 0.2103,
        0.0627])
[rfa agg] iter:  6, prev_obj_val: 62.917198181152344, obj_val: 61.139556884765625, abs dis: 1.7776412963867188
[rfa agg] iter: 6, weight: tensor([0.0841, 0.0712, 0.0400, 0.3085, 0.0880, 0.0089, 0.0760, 0.0617, 0.2000,
        0.0616])
[rfa agg] iter:  7, prev_obj_val: 61.139556884765625, obj_val: 62.926063537597656, abs dis: 1.7865066528320312
[rfa agg] iter: 7, weight: tensor([0.0926, 0.0649, 0.0377, 0.2593, 0.0974, 0.0087, 0.0694, 0.0659, 0.2383,
        0.0658])
[rfa agg] iter:  8, prev_obj_val: 62.926063537597656, obj_val: 62.91642761230469, abs dis: 0.00963592529296875
[rfa agg] iter: 8, weight: tensor([0.0850, 0.0717, 0.0403, 0.2981, 0.0890, 0.0089, 0.0767, 0.0624, 0.2056,
        0.0623])
[rfa agg] iter:  9, prev_obj_val: 62.91642761230469, obj_val: 62.91580581665039, abs dis: 0.000621795654296875
[rfa agg] iter: 9, weight: tensor([0.0839, 0.0710, 0.0399, 0.3109, 0.0878, 0.0088, 0.0758, 0.0616, 0.1989,
        0.0615])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 15.5242, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 15.5660, Accuracy: 0/9950 (0.0000%)
saving model
Done in 428.8130679130554 sec.
Server Epoch:31 choose agents : [10, 79, 5, 85, 82, 35, 38, 44, 1, 72].
poison local model 10 index 5 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   1, Avg loss: 0.0646, Accuracy: 121/861 (14.0534%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   2, Avg loss: 0.0296, Accuracy: 308/861 (35.7724%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   3, Avg loss: 0.0248, Accuracy: 368/861 (42.7410%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   4, Avg loss: 0.0231, Accuracy: 361/861 (41.9280%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   5, Avg loss: 0.0223, Accuracy: 403/861 (46.8060%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   6, Avg loss: 0.0225, Accuracy: 398/861 (46.2253%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   7, Avg loss: 0.0214, Accuracy: 424/861 (49.2451%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   8, Avg loss: 0.0218, Accuracy: 413/861 (47.9675%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   9, Avg loss: 0.0213, Accuracy: 416/861 (48.3159%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch  10, Avg loss: 0.0214, Accuracy: 401/861 (46.5738%), train_poison_data_count: 280
Global model norm: 215.44573163850333.
Norm before scaling: 215.4178805978046. Distance: 1.110578770402559
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.8263, Accuracy: 104/10000 (1.0400%)
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: 1.0494, Accuracy: 6314/9950 (63.4573%)
Scaling by  100
Scaled Norm after poisoning: 239.64072229329054, distance: 111.05787922998755
Total norm for 4 adversaries is: 239.64072229329054. distance: 111.05787922998755
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   1, Avg loss: 0.1419, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   2, Avg loss: 0.1212, Accuracy: 0/197 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.7599, Accuracy: 49/10000 (0.4900%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   1, Avg loss: 0.0555, Accuracy: 318/1628 (19.5332%)
_Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   2, Avg loss: 0.0268, Accuracy: 781/1628 (47.9730%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.0289, Accuracy: 119/10000 (1.1900%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   1, Avg loss: 0.0567, Accuracy: 418/1988 (21.0262%)
_Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   2, Avg loss: 0.0371, Accuracy: 582/1988 (29.2757%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.7607, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   1, Avg loss: 0.0749, Accuracy: 78/500 (15.6000%)
_Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   2, Avg loss: 0.0516, Accuracy: 194/500 (38.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9303, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   1, Avg loss: 0.0983, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   2, Avg loss: 0.0612, Accuracy: 89/271 (32.8413%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.3675, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   1, Avg loss: 0.0663, Accuracy: 196/1131 (17.3298%)
_Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   2, Avg loss: 0.0314, Accuracy: 446/1131 (39.4341%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.9246, Accuracy: 96/10000 (0.9600%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   1, Avg loss: 0.0630, Accuracy: 334/1750 (19.0857%)
_Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   2, Avg loss: 0.0371, Accuracy: 647/1750 (36.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9662, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0605, Accuracy: 258/928 (27.8017%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 542/928 (58.4052%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.1325, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   1, Avg loss: 0.0676, Accuracy: 206/1241 (16.5995%)
_Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   2, Avg loss: 0.0381, Accuracy: 401/1241 (32.3127%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.0897, Accuracy: 72/10000 (0.7200%)
time spent on training: 308.42124795913696
[rfa agg] training data poison_ratio: 0.5933301572177228  data num: [861, 197, 1628, 1988, 500, 271, 1131, 1750, 928, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.18541567413053836
[rfa agg] init. name: [10, 79, 5, 85, 82, 35, 38, 44, 1, 72], weight: tensor([0.0820, 0.0188, 0.1551, 0.1894, 0.0476, 0.0258, 0.1078, 0.1667, 0.0884,
        0.1182])
[rfa agg] iter:  0, prev_obj_val: 9471.5400390625, obj_val: 5569.873046875, abs dis: 3901.6669921875
[rfa agg] iter: 0, weight: tensor([0.0079, 0.0196, 0.1685, 0.2080, 0.0502, 0.0271, 0.1155, 0.1818, 0.0943,
        0.1272])
[rfa agg] iter:  1, prev_obj_val: 5569.873046875, obj_val: 5224.529296875, abs dis: 345.34375
[rfa agg] iter: 1, weight: tensor([0.0007, 0.0148, 0.1760, 0.2433, 0.0398, 0.0206, 0.1056, 0.1968, 0.0824,
        0.1200])
[rfa agg] iter:  2, prev_obj_val: 5224.529296875, obj_val: 5225.11767578125, abs dis: 0.58837890625
[rfa agg] iter: 2, weight: tensor([5.7257e-05, 4.0160e-03, 3.4598e-01, 1.5516e-01, 1.2541e-02, 5.8082e-03,
        6.0139e-02, 2.9384e-01, 3.7120e-02, 8.5343e-02])
[rfa agg] iter:  3, prev_obj_val: 5225.11767578125, obj_val: 5227.27197265625, abs dis: 2.154296875
[rfa agg] iter: 3, weight: tensor([6.6562e-05, 5.2453e-03, 3.3251e-01, 1.2792e-01, 1.6855e-02, 7.6350e-03,
        9.5208e-02, 2.1134e-01, 5.4536e-02, 1.4868e-01])
[rfa agg] iter:  4, prev_obj_val: 5227.27197265625, obj_val: 5228.0498046875, abs dis: 0.77783203125
[rfa agg] iter: 4, weight: tensor([7.1559e-05, 6.0796e-03, 2.4487e-01, 1.1754e-01, 1.9977e-02, 8.8940e-03,
        1.3170e-01, 1.7192e-01, 6.9849e-02, 2.2910e-01])
[rfa agg] iter:  5, prev_obj_val: 5228.0498046875, obj_val: 5229.9541015625, abs dis: 1.904296875
[rfa agg] iter: 5, weight: tensor([7.0162e-05, 6.1224e-03, 2.1123e-01, 1.0997e-01, 2.0285e-02, 8.9733e-03,
        1.4374e-01, 1.5557e-01, 7.3256e-02, 2.7079e-01])
[rfa agg] iter:  6, prev_obj_val: 5229.9541015625, obj_val: 5233.90625, abs dis: 3.9521484375
[rfa agg] iter: 6, weight: tensor([6.4452e-05, 5.9388e-03, 1.5973e-01, 9.2395e-02, 2.0039e-02, 8.7394e-03,
        1.6401e-01, 1.2451e-01, 7.7578e-02, 3.4699e-01])
[rfa agg] iter:  7, prev_obj_val: 5233.90625, obj_val: 5235.6552734375, abs dis: 1.7490234375
[rfa agg] iter: 7, weight: tensor([5.7234e-05, 5.7538e-03, 1.1158e-01, 7.2647e-02, 2.0052e-02, 8.5270e-03,
        2.1182e-01, 9.2383e-02, 8.8735e-02, 3.8845e-01])
[rfa agg] iter:  8, prev_obj_val: 5235.6552734375, obj_val: 5237.62744140625, abs dis: 1.97216796875
[rfa agg] iter: 8, weight: tensor([5.7537e-05, 5.9651e-03, 1.0432e-01, 7.0275e-02, 2.1040e-02, 8.8634e-03,
        2.4860e-01, 8.7788e-02, 9.8441e-02, 3.5465e-01])
[rfa agg] iter:  9, prev_obj_val: 5237.62744140625, obj_val: 5237.60205078125, abs dis: 0.025390625
[rfa agg] iter: 9, weight: tensor([5.9451e-05, 6.3625e-03, 1.0121e-01, 7.0040e-02, 2.2743e-02, 9.4808e-03,
        2.9483e-01, 8.6257e-02, 1.1333e-01, 2.9570e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 19.1291, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 20.0070, Accuracy: 0/9950 (0.0000%)
saving model
Done in 555.2557561397552 sec.
Server Epoch:32 choose agents : [72, 26, 61, 80, 49, 36, 32, 54, 23, 85].
_Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0639, Accuracy: 216/1241 (17.4053%)
_Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0376, Accuracy: 422/1241 (34.0048%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.1565, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0589, Accuracy: 274/1446 (18.9488%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0358, Accuracy: 499/1446 (34.5090%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9098, Accuracy: 76/10000 (0.7600%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   1, Avg loss: 0.1436, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   2, Avg loss: 0.1361, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.6800, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0722, Accuracy: 116/682 (17.0088%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0393, Accuracy: 260/682 (38.1232%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.3490, Accuracy: 64/10000 (0.6400%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.0879, Accuracy: 9/440 (2.0455%)
_Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0511, Accuracy: 130/440 (29.5455%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.8474, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   1, Avg loss: 0.1093, Accuracy: 1/408 (0.2451%)
_Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   2, Avg loss: 0.0652, Accuracy: 129/408 (31.6176%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.2407, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0630, Accuracy: 154/735 (20.9524%)
_Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0242, Accuracy: 363/735 (49.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 11.4033, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   1, Avg loss: 0.0597, Accuracy: 270/1130 (23.8938%)
_Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 481/1130 (42.5664%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.5354, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.0758, Accuracy: 196/715 (27.4126%)
_Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0424, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.8577, Accuracy: 59/10000 (0.5900%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0566, Accuracy: 384/1988 (19.3159%)
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0362, Accuracy: 618/1988 (31.0865%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.4860, Accuracy: 90/10000 (0.9000%)
time spent on training: 193.05000162124634
[rfa agg] training data poison_ratio: 0.28331454340473505  data num: [1241, 1446, 85, 682, 440, 408, 735, 1130, 715, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.0885357948139797
[rfa agg] init. name: [72, 26, 61, 80, 49, 36, 32, 54, 23, 85], weight: tensor([0.1399, 0.1630, 0.0096, 0.0769, 0.0496, 0.0460, 0.0829, 0.1274, 0.0806,
        0.2241])
[rfa agg] iter:  0, prev_obj_val: 69.38398742675781, obj_val: 71.71995544433594, abs dis: 2.335968017578125
[rfa agg] iter: 0, weight: tensor([0.1936, 0.1285, 0.0033, 0.0719, 0.0272, 0.0252, 0.0924, 0.2943, 0.0872,
        0.0764])
[rfa agg] iter:  1, prev_obj_val: 71.71995544433594, obj_val: 73.0730972290039, abs dis: 1.3531417846679688
[rfa agg] iter: 1, weight: tensor([0.1659, 0.1176, 0.0036, 0.0911, 0.0318, 0.0294, 0.1214, 0.2513, 0.1126,
        0.0753])
[rfa agg] iter:  2, prev_obj_val: 73.0730972290039, obj_val: 73.06678009033203, abs dis: 0.006317138671875
[rfa agg] iter: 2, weight: tensor([0.1524, 0.1123, 0.0038, 0.1032, 0.0342, 0.0316, 0.1409, 0.2180, 0.1292,
        0.0742])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 17.1020, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 18.8966, Accuracy: 0/9950 (0.0000%)
saving model
Done in 440.3047523498535 sec.
Server Epoch:33 choose agents : [15, 99, 11, 32, 10, 94, 70, 58, 16, 93].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Avg loss: 0.0652, Accuracy: 235/1154 (20.3640%), train_poison_data_count: 362
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Avg loss: 0.0333, Accuracy: 415/1154 (35.9619%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Avg loss: 0.0267, Accuracy: 520/1154 (45.0607%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Avg loss: 0.0272, Accuracy: 460/1154 (39.8614%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Avg loss: 0.0265, Accuracy: 491/1154 (42.5477%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Avg loss: 0.0259, Accuracy: 540/1154 (46.7938%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Avg loss: 0.0262, Accuracy: 513/1154 (44.4541%), train_poison_data_count: 362
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Avg loss: 0.0246, Accuracy: 531/1154 (46.0139%), train_poison_data_count: 362
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Avg loss: 0.0247, Accuracy: 570/1154 (49.3934%), train_poison_data_count: 362
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Avg loss: 0.0255, Accuracy: 543/1154 (47.0537%), train_poison_data_count: 362
Global model norm: 220.63543707607352.
Norm before scaling: 220.5924196907047. Distance: 1.2475281594104535
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.0948, Accuracy: 60/10000 (0.6000%)
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: 1.0127, Accuracy: 6499/9950 (65.3166%)
Scaling by  100
Scaled Norm after poisoning: 249.3780623245557, distance: 124.75281419045223
Total norm for 2 adversaries is: 249.3780623245557. distance: 124.75281419045223
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   1, Avg loss: 0.0648, Accuracy: 169/773 (21.8629%)
_Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   2, Avg loss: 0.0334, Accuracy: 382/773 (49.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.2226, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   1, Avg loss: 0.0575, Accuracy: 234/712 (32.8652%)
_Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   2, Avg loss: 0.0279, Accuracy: 429/712 (60.2528%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.9167, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   1, Avg loss: 0.0610, Accuracy: 153/735 (20.8163%)
_Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   2, Avg loss: 0.0237, Accuracy: 362/735 (49.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 11.9161, Accuracy: 66/10000 (0.6600%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 177/861 (20.5575%)
_Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 467/861 (54.2393%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 11.1206, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   1, Avg loss: 0.0622, Accuracy: 249/1662 (14.9819%)
_Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   2, Avg loss: 0.0354, Accuracy: 533/1662 (32.0698%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.4144, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0637, Accuracy: 317/1418 (22.3554%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0338, Accuracy: 596/1418 (42.0310%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.8374, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   1, Avg loss: 0.0626, Accuracy: 259/803 (32.2540%)
_Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   2, Avg loss: 0.0350, Accuracy: 417/803 (51.9303%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.2017, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   1, Avg loss: 0.0809, Accuracy: 150/708 (21.1864%)
_Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   2, Avg loss: 0.0395, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.1004, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   1, Avg loss: 0.0562, Accuracy: 357/1742 (20.4937%)
_Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 654/1742 (37.5431%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.7788, Accuracy: 93/10000 (0.9300%)
time spent on training: 292.1435363292694
[rfa agg] training data poison_ratio: 0.19066994700984102  data num: [1154, 773, 712, 735, 861, 1662, 1418, 803, 708, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.059584358440575316
[rfa agg] init. name: [15, 99, 11, 32, 10, 94, 70, 58, 16, 93], weight: tensor([0.1092, 0.0731, 0.0674, 0.0695, 0.0815, 0.1573, 0.1342, 0.0760, 0.0670,
        0.1648])
[rfa agg] iter:  0, prev_obj_val: 16571.5625, obj_val: 10279.384765625, abs dis: 6292.177734375
[rfa agg] iter: 0, weight: tensor([0.0148, 0.0804, 0.0740, 0.0764, 0.0896, 0.1750, 0.1489, 0.0835, 0.0736,
        0.1838])
[rfa agg] iter:  1, prev_obj_val: 10279.384765625, obj_val: 9419.2578125, abs dis: 860.126953125
[rfa agg] iter: 1, weight: tensor([0.0018, 0.0781, 0.0715, 0.0738, 0.0876, 0.1845, 0.1540, 0.0812, 0.0711,
        0.1964])
[rfa agg] iter:  2, prev_obj_val: 9419.2578125, obj_val: 9364.5771484375, abs dis: 54.6806640625
[rfa agg] iter: 2, weight: tensor([1.5775e-04, 4.6432e-02, 4.0882e-02, 4.2189e-02, 5.4206e-02, 2.4563e-01,
        1.5704e-01, 4.8216e-02, 4.0631e-02, 3.2461e-01])
[rfa agg] iter:  3, prev_obj_val: 9364.5771484375, obj_val: 9365.6904296875, abs dis: 1.11328125
[rfa agg] iter: 3, weight: tensor([7.1659e-05, 5.2270e-02, 4.3561e-02, 4.4959e-02, 6.5723e-02, 2.0559e-01,
        3.3691e-01, 5.4503e-02, 4.2986e-02, 1.5343e-01])
[rfa agg] iter:  4, prev_obj_val: 9365.6904296875, obj_val: 9367.96484375, abs dis: 2.2744140625
[rfa agg] iter: 4, weight: tensor([7.9841e-05, 7.0079e-02, 5.7386e-02, 5.9214e-02, 9.0363e-02, 1.7570e-01,
        2.7905e-01, 7.3063e-02, 5.6548e-02, 1.3852e-01])
[rfa agg] iter:  5, prev_obj_val: 9367.96484375, obj_val: 9370.6162109375, abs dis: 2.6513671875
[rfa agg] iter: 5, weight: tensor([8.1699e-05, 9.7714e-02, 7.7312e-02, 7.9787e-02, 1.3300e-01, 1.3704e-01,
        1.8236e-01, 1.0213e-01, 7.5738e-02, 1.1484e-01])
[rfa agg] iter:  6, prev_obj_val: 9370.6162109375, obj_val: 9371.3388671875, abs dis: 0.72265625
[rfa agg] iter: 6, weight: tensor([6.7375e-05, 1.2429e-01, 9.2736e-02, 9.5853e-02, 1.8700e-01, 9.1077e-02,
        1.0925e-01, 1.3069e-01, 8.9573e-02, 7.9453e-02])
[rfa agg] iter:  7, prev_obj_val: 9371.3388671875, obj_val: 9373.23046875, abs dis: 1.8916015625
[rfa agg] iter: 7, weight: tensor([6.1019e-05, 1.3083e-01, 9.4903e-02, 9.8373e-02, 2.0722e-01, 7.8520e-02,
        9.2222e-02, 1.3762e-01, 9.1182e-02, 6.9067e-02])
[rfa agg] iter:  8, prev_obj_val: 9373.23046875, obj_val: 9378.021484375, abs dis: 4.791015625
[rfa agg] iter: 8, weight: tensor([4.9057e-05, 1.4287e-01, 1.0024e-01, 1.0438e-01, 2.3165e-01, 5.7769e-02,
        6.5822e-02, 1.5153e-01, 9.4156e-02, 5.1523e-02])
[rfa agg] iter:  9, prev_obj_val: 9378.021484375, obj_val: 9377.978515625, abs dis: 0.04296875
[rfa agg] iter: 9, weight: tensor([3.8914e-05, 1.5835e-01, 1.3190e-01, 1.4023e-01, 1.6292e-01, 4.0638e-02,
        4.4654e-02, 1.7049e-01, 1.1392e-01, 3.6871e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 19.6046, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 20.2731, Accuracy: 0/9950 (0.0000%)
saving model
Done in 539.2581644058228 sec.
Server Epoch:34 choose agents : [82, 57, 91, 67, 43, 97, 54, 71, 66, 14].
_Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 69/500 (13.8000%)
_Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0505, Accuracy: 199/500 (39.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.6313, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   1, Avg loss: 0.0633, Accuracy: 229/1154 (19.8440%)
_Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   2, Avg loss: 0.0273, Accuracy: 448/1154 (38.8215%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 11.7474, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   1, Avg loss: 0.0641, Accuracy: 229/1030 (22.2330%)
_Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   2, Avg loss: 0.0287, Accuracy: 531/1030 (51.5534%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.4015, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   1, Avg loss: 0.0869, Accuracy: 3/426 (0.7042%)
_Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   2, Avg loss: 0.0435, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.5481, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   1, Avg loss: 0.0676, Accuracy: 215/946 (22.7273%)
_Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   2, Avg loss: 0.0379, Accuracy: 371/946 (39.2178%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.9361, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   1, Avg loss: 0.0551, Accuracy: 276/1213 (22.7535%)
_Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 533/1213 (43.9406%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.4378, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0580, Accuracy: 280/1130 (24.7788%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 502/1130 (44.4248%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.9272, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0680, Accuracy: 125/818 (15.2812%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0335, Accuracy: 298/818 (36.4303%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.5686, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   1, Avg loss: 0.0647, Accuracy: 229/1402 (16.3338%)
_Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   2, Avg loss: 0.0397, Accuracy: 359/1402 (25.6063%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.6191, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0645, Accuracy: 162/1013 (15.9921%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 362/1013 (35.7354%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.1826, Accuracy: 70/10000 (0.7000%)
time spent on training: 183.1467900276184
[rfa agg] training data poison_ratio: 0.0  data num: [500, 1154, 1030, 426, 946, 1213, 1130, 818, 1402, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 57, 91, 67, 43, 97, 54, 71, 66, 14], weight: tensor([0.0519, 0.1198, 0.1069, 0.0442, 0.0982, 0.1259, 0.1173, 0.0849, 0.1456,
        0.1052])
[rfa agg] iter:  0, prev_obj_val: 42.29426193237305, obj_val: 44.78543472290039, abs dis: 2.4911727905273438
[rfa agg] iter: 0, weight: tensor([0.0308, 0.0821, 0.1040, 0.0225, 0.1952, 0.0871, 0.0982, 0.1649, 0.0665,
        0.1487])
[rfa agg] iter:  1, prev_obj_val: 44.78543472290039, obj_val: 44.77635192871094, abs dis: 0.009082794189453125
[rfa agg] iter: 1, weight: tensor([0.0346, 0.0780, 0.0979, 0.0250, 0.1821, 0.0828, 0.0918, 0.2061, 0.0648,
        0.1371])
[rfa agg] iter:  2, prev_obj_val: 44.77635192871094, obj_val: 44.775962829589844, abs dis: 0.00038909912109375
[rfa agg] iter: 2, weight: tensor([0.0344, 0.0773, 0.0972, 0.0248, 0.1786, 0.0822, 0.0908, 0.2147, 0.0643,
        0.1357])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.9800, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 6.0131, Accuracy: 0/9950 (0.0000%)
saving model
Done in 430.46795439720154 sec.
Server Epoch:35 choose agents : [25, 59, 84, 17, 29, 58, 36, 90, 67, 70].
poison local model 25 index 7 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   1, Avg loss: 0.0645, Accuracy: 143/690 (20.7246%), train_poison_data_count: 220
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   2, Avg loss: 0.0317, Accuracy: 283/690 (41.0145%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   3, Avg loss: 0.0255, Accuracy: 306/690 (44.3478%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   4, Avg loss: 0.0245, Accuracy: 328/690 (47.5362%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   5, Avg loss: 0.0231, Accuracy: 353/690 (51.1594%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   6, Avg loss: 0.0233, Accuracy: 323/690 (46.8116%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   7, Avg loss: 0.0224, Accuracy: 340/690 (49.2754%), train_poison_data_count: 220
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   8, Avg loss: 0.0219, Accuracy: 344/690 (49.8551%), train_poison_data_count: 220
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   9, Avg loss: 0.0219, Accuracy: 351/690 (50.8696%), train_poison_data_count: 220
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch  10, Avg loss: 0.0203, Accuracy: 379/690 (54.9275%), train_poison_data_count: 220
Global model norm: 225.67351452097785.
Norm before scaling: 225.65129694397947. Distance: 0.8585269211228935
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.3633, Accuracy: 64/10000 (0.6400%)
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: 1.0618, Accuracy: 4403/9950 (44.2513%)
Scaling by  100
Scaled Norm after poisoning: 239.21175896054942, distance: 85.85269110699151
Total norm for 1 adversaries is: 239.21175896054942. distance: 85.85269110699151
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0585, Accuracy: 300/1089 (27.5482%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/1089 (41.3223%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.1477, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   1, Avg loss: 0.0712, Accuracy: 231/1190 (19.4118%)
_Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 434/1190 (36.4706%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4610, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   1, Avg loss: 0.0566, Accuracy: 294/1574 (18.6785%)
_Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   2, Avg loss: 0.0290, Accuracy: 623/1574 (39.5807%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.2621, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   1, Avg loss: 0.0580, Accuracy: 318/1440 (22.0833%)
_Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   2, Avg loss: 0.0285, Accuracy: 674/1440 (46.8056%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.6916, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0603, Accuracy: 268/803 (33.3748%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0347, Accuracy: 425/803 (52.9265%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.5119, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   1, Avg loss: 0.1140, Accuracy: 0/408 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   2, Avg loss: 0.0666, Accuracy: 100/408 (24.5098%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.5103, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   1, Avg loss: 0.0601, Accuracy: 286/677 (42.2452%)
_Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   2, Avg loss: 0.0261, Accuracy: 437/677 (64.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 11.5245, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0873, Accuracy: 7/426 (1.6432%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0448, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.0593, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   1, Avg loss: 0.0632, Accuracy: 319/1418 (22.4965%)
_Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   2, Avg loss: 0.0341, Accuracy: 567/1418 (39.9859%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.3915, Accuracy: 90/10000 (0.9000%)
time spent on training: 266.0747606754303
[rfa agg] training data poison_ratio: 0.07102418939783839  data num: [690, 1089, 1190, 1574, 1440, 803, 408, 677, 426, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.022195059186824496
[rfa agg] init. name: [25, 59, 84, 17, 29, 58, 36, 90, 67, 70], weight: tensor([0.0710, 0.1121, 0.1225, 0.1620, 0.1482, 0.0827, 0.0420, 0.0697, 0.0438,
        0.1460])
[rfa agg] iter:  0, prev_obj_val: 6558.54443359375, obj_val: 3767.110595703125, abs dis: 2791.433837890625
[rfa agg] iter: 0, weight: tensor([0.0058, 0.1197, 0.1311, 0.1760, 0.1603, 0.0871, 0.0436, 0.0731, 0.0455,
        0.1578])
[rfa agg] iter:  1, prev_obj_val: 3767.110595703125, obj_val: 3583.832763671875, abs dis: 183.27783203125
[rfa agg] iter: 1, weight: tensor([0.0004, 0.1132, 0.1281, 0.2112, 0.1788, 0.0719, 0.0312, 0.0574, 0.0325,
        0.1753])
[rfa agg] iter:  2, prev_obj_val: 3583.832763671875, obj_val: 3587.53369140625, abs dis: 3.700927734375
[rfa agg] iter: 2, weight: tensor([5.9869e-05, 1.3667e-01, 2.3261e-01, 1.4200e-01, 1.9436e-01, 5.3407e-02,
        1.4851e-02, 3.5550e-02, 1.5497e-02, 1.7500e-01])
[rfa agg] iter:  3, prev_obj_val: 3587.53369140625, obj_val: 3587.471435546875, abs dis: 0.062255859375
[rfa agg] iter: 3, weight: tensor([6.4596e-05, 1.7707e-01, 2.7406e-01, 1.1233e-01, 1.3949e-01, 7.7711e-02,
        1.8830e-02, 4.8704e-02, 1.9645e-02, 1.3209e-01])
[rfa agg] iter:  4, prev_obj_val: 3587.471435546875, obj_val: 3590.706787109375, abs dis: 3.2353515625
[rfa agg] iter: 4, weight: tensor([6.3481e-05, 1.8269e-01, 2.8122e-01, 1.1011e-01, 1.3565e-01, 7.6245e-02,
        1.8501e-02, 4.7863e-02, 1.9308e-02, 1.2835e-01])
[rfa agg] iter:  5, prev_obj_val: 3590.706787109375, obj_val: 3592.538818359375, abs dis: 1.83203125
[rfa agg] iter: 5, weight: tensor([6.9976e-05, 1.9258e-01, 2.4322e-01, 1.0729e-01, 1.2758e-01, 1.0092e-01,
        2.2305e-02, 6.0783e-02, 2.3277e-02, 1.2198e-01])
[rfa agg] iter:  6, prev_obj_val: 3592.538818359375, obj_val: 3592.534912109375, abs dis: 0.00390625
[rfa agg] iter: 6, weight: tensor([7.3315e-05, 1.9233e-01, 2.1977e-01, 1.0625e-01, 1.2452e-01, 1.1830e-01,
        2.4555e-02, 6.9095e-02, 2.5624e-02, 1.1948e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.9719, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 6.0380, Accuracy: 0/9950 (0.0000%)
saving model
Done in 512.94398188591 sec.
Server Epoch:36 choose agents : [14, 2, 79, 58, 84, 40, 16, 50, 8, 72].
_Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0636, Accuracy: 166/1013 (16.3870%)
_Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0363, Accuracy: 352/1013 (34.7483%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.7670, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0707, Accuracy: 140/605 (23.1405%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0427, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.1778, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   1, Avg loss: 0.1410, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   2, Avg loss: 0.1260, Accuracy: 0/197 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9315, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   1, Avg loss: 0.0577, Accuracy: 290/803 (36.1146%)
_Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   2, Avg loss: 0.0345, Accuracy: 406/803 (50.5604%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.2821, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   1, Avg loss: 0.0709, Accuracy: 225/1190 (18.9076%)
_Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 444/1190 (37.3109%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.6979, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   1, Avg loss: 0.0541, Accuracy: 314/1573 (19.9619%)
_Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 559/1573 (35.5372%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.1556, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   1, Avg loss: 0.0802, Accuracy: 150/708 (21.1864%)
_Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   2, Avg loss: 0.0367, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.6044, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   1, Avg loss: 0.0684, Accuracy: 106/809 (13.1026%)
_Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   2, Avg loss: 0.0285, Accuracy: 318/809 (39.3078%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 11.2002, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   1, Avg loss: 0.0662, Accuracy: 178/1513 (11.7647%)
_Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   2, Avg loss: 0.0386, Accuracy: 415/1513 (27.4289%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.4571, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   1, Avg loss: 0.0641, Accuracy: 192/1241 (15.4714%)
_Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   2, Avg loss: 0.0384, Accuracy: 409/1241 (32.9573%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.4404, Accuracy: 69/10000 (0.6900%)
time spent on training: 163.7190408706665
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 605, 197, 803, 1190, 1573, 708, 809, 1513, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [14, 2, 79, 58, 84, 40, 16, 50, 8, 72], weight: tensor([0.1050, 0.0627, 0.0204, 0.0832, 0.1233, 0.1630, 0.0734, 0.0838, 0.1568,
        0.1286])
[rfa agg] iter:  0, prev_obj_val: 48.897071838378906, obj_val: 52.1852912902832, abs dis: 3.288219451904297
[rfa agg] iter: 0, weight: tensor([0.2361, 0.0401, 0.0067, 0.0943, 0.1572, 0.0805, 0.0645, 0.0938, 0.0871,
        0.1396])
[rfa agg] iter:  1, prev_obj_val: 52.1852912902832, obj_val: 53.663082122802734, abs dis: 1.4777908325195312
[rfa agg] iter: 1, weight: tensor([0.2350, 0.0491, 0.0073, 0.1385, 0.1129, 0.0665, 0.0854, 0.1341, 0.0707,
        0.1006])
[rfa agg] iter:  2, prev_obj_val: 53.663082122802734, obj_val: 53.64952087402344, abs dis: 0.013561248779296875
[rfa agg] iter: 2, weight: tensor([0.1998, 0.0532, 0.0074, 0.1658, 0.1000, 0.0623, 0.0960, 0.1588, 0.0660,
        0.0905])
[rfa agg] iter:  3, prev_obj_val: 53.64952087402344, obj_val: 53.64933776855469, abs dis: 0.00018310546875
[rfa agg] iter: 3, weight: tensor([0.1949, 0.0532, 0.0074, 0.1687, 0.0993, 0.0622, 0.0964, 0.1620, 0.0659,
        0.0902])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 17.2237, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 21.0108, Accuracy: 0/9950 (0.0000%)
saving model
Done in 408.3666036128998 sec.
Server Epoch:37 choose agents : [30, 52, 90, 51, 62, 40, 15, 83, 13, 39].
poison local model 30 index 8 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   1, Avg loss: 0.0948, Accuracy: 5/486 (1.0288%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   2, Avg loss: 0.0482, Accuracy: 155/486 (31.8930%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   3, Avg loss: 0.0362, Accuracy: 165/486 (33.9506%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   4, Avg loss: 0.0327, Accuracy: 186/486 (38.2716%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   5, Avg loss: 0.0350, Accuracy: 165/486 (33.9506%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   6, Avg loss: 0.0325, Accuracy: 182/486 (37.4486%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   7, Avg loss: 0.0331, Accuracy: 181/486 (37.2428%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   8, Avg loss: 0.0311, Accuracy: 183/486 (37.6543%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   9, Avg loss: 0.0318, Accuracy: 178/486 (36.6255%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch  10, Avg loss: 0.0306, Accuracy: 194/486 (39.9177%), train_poison_data_count: 160
Global model norm: 230.59849102390066.
Norm before scaling: 230.5833888612751. Distance: 0.8007118008899404
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.7979, Accuracy: 58/10000 (0.5800%)
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: 1.1872, Accuracy: 4911/9950 (49.3568%)
Scaling by  100
Scaled Norm after poisoning: 242.54258646678937, distance: 80.07118110137223
Total norm for 2 adversaries is: 242.54258646678937. distance: 80.07118110137223
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0658, Accuracy: 179/636 (28.1447%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0306, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.9203, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   1, Avg loss: 0.0598, Accuracy: 288/677 (42.5406%)
_Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   2, Avg loss: 0.0256, Accuracy: 442/677 (65.2880%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 11.4411, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0696, Accuracy: 157/1049 (14.9666%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0314, Accuracy: 479/1049 (45.6625%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.0891, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   1, Avg loss: 0.0748, Accuracy: 81/568 (14.2606%)
_Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   2, Avg loss: 0.0415, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.5582, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 325/1573 (20.6612%)
_Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   2, Avg loss: 0.0358, Accuracy: 536/1573 (34.0750%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.3251, Accuracy: 85/10000 (0.8500%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   1, Avg loss: 0.0631, Accuracy: 259/1154 (22.4437%)
_Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   2, Avg loss: 0.0303, Accuracy: 452/1154 (39.1681%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.9750, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0604, Accuracy: 319/1953 (16.3338%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0357, Accuracy: 663/1953 (33.9478%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1671, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   1, Avg loss: 0.0630, Accuracy: 263/1645 (15.9878%)
_Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   2, Avg loss: 0.0348, Accuracy: 590/1645 (35.8663%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.2248, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   1, Avg loss: 0.0546, Accuracy: 234/1013 (23.0997%)
_Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   2, Avg loss: 0.0273, Accuracy: 487/1013 (48.0750%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.7290, Accuracy: 80/10000 (0.8000%)
time spent on training: 297.29811787605286
[rfa agg] training data poison_ratio: 0.15250139482983077  data num: [486, 636, 677, 1049, 568, 1573, 1154, 1953, 1645, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.04765668588432212
[rfa agg] init. name: [30, 52, 90, 51, 62, 40, 15, 83, 13, 39], weight: tensor([0.0452, 0.0591, 0.0630, 0.0975, 0.0528, 0.1463, 0.1073, 0.1816, 0.1530,
        0.0942])
[rfa agg] iter:  0, prev_obj_val: 3154.95947265625, obj_val: 1733.5009765625, abs dis: 1421.45849609375
[rfa agg] iter: 0, weight: tensor([0.0022, 0.0582, 0.0623, 0.0996, 0.0517, 0.1558, 0.1107, 0.1999, 0.1638,
        0.0957])
[rfa agg] iter:  1, prev_obj_val: 1733.5009765625, obj_val: 1719.7515869140625, abs dis: 13.7493896484375
[rfa agg] iter: 1, weight: tensor([7.1351e-05, 2.0813e-02, 2.3467e-02, 5.4155e-02, 1.7651e-02, 2.2020e-01,
        7.2558e-02, 2.7391e-01, 2.6793e-01, 4.9253e-02])
[rfa agg] iter:  2, prev_obj_val: 1719.7515869140625, obj_val: 1721.1646728515625, abs dis: 1.4130859375
[rfa agg] iter: 2, weight: tensor([6.6934e-05, 2.9341e-02, 3.4141e-02, 9.5864e-02, 2.4359e-02, 2.4187e-01,
        1.6154e-01, 1.1894e-01, 2.0366e-01, 9.0217e-02])
[rfa agg] iter:  3, prev_obj_val: 1721.1646728515625, obj_val: 1723.5482177734375, abs dis: 2.383544921875
[rfa agg] iter: 3, weight: tensor([6.5715e-05, 3.4327e-02, 4.0701e-02, 1.2770e-01, 2.8159e-02, 1.6272e-01,
        2.4215e-01, 9.5846e-02, 1.4223e-01, 1.2610e-01])
[rfa agg] iter:  4, prev_obj_val: 1723.5482177734375, obj_val: 1727.6280517578125, abs dis: 4.079833984375
[rfa agg] iter: 4, weight: tensor([6.1481e-05, 3.7418e-02, 4.5248e-02, 1.4920e-01, 3.0334e-02, 1.1939e-01,
        2.6358e-01, 7.9419e-02, 1.0827e-01, 1.6708e-01])
[rfa agg] iter:  5, prev_obj_val: 1727.6280517578125, obj_val: 1731.238037109375, abs dis: 3.6099853515625
[rfa agg] iter: 5, weight: tensor([6.0420e-05, 4.3892e-02, 5.4553e-02, 1.6466e-01, 3.5072e-02, 9.6665e-02,
        1.9938e-01, 6.9996e-02, 8.9803e-02, 2.4592e-01])
[rfa agg] iter:  6, prev_obj_val: 1731.238037109375, obj_val: 1733.369140625, abs dis: 2.131103515625
[rfa agg] iter: 6, weight: tensor([5.9361e-05, 4.9444e-02, 6.3075e-02, 1.5915e-01, 3.9077e-02, 8.5011e-02,
        1.5111e-01, 6.4344e-02, 7.9946e-02, 3.0878e-01])
[rfa agg] iter:  7, prev_obj_val: 1733.369140625, obj_val: 1731.1983642578125, abs dis: 2.1707763671875
[rfa agg] iter: 7, weight: tensor([5.9762e-05, 5.3682e-02, 6.9607e-02, 1.5181e-01, 4.2179e-02, 8.1294e-02,
        1.3497e-01, 6.2756e-02, 7.6855e-02, 3.2678e-01])
[rfa agg] iter:  8, prev_obj_val: 1731.1983642578125, obj_val: 1733.3648681640625, abs dis: 2.16650390625
[rfa agg] iter: 8, weight: tensor([5.7042e-05, 4.7615e-02, 6.0829e-02, 1.5189e-01, 3.7648e-02, 8.1609e-02,
        1.4070e-01, 6.1828e-02, 7.6772e-02, 3.4105e-01])
[rfa agg] iter:  9, prev_obj_val: 1733.3648681640625, obj_val: 1731.1973876953125, abs dis: 2.16748046875
[rfa agg] iter: 9, weight: tensor([5.8992e-05, 5.2966e-02, 6.8678e-02, 1.4897e-01, 4.1634e-02, 8.0217e-02,
        1.3254e-01, 6.1945e-02, 7.5846e-02, 3.3715e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 19.1432, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 23.9125, Accuracy: 0/9950 (0.0000%)
saving model
Done in 541.6382446289062 sec.
Server Epoch:38 choose agents : [70, 37, 62, 29, 91, 31, 56, 1, 98, 4].
_Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0635, Accuracy: 323/1418 (22.7786%)
_Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0346, Accuracy: 582/1418 (41.0437%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.9064, Accuracy: 90/10000 (0.9000%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0633, Accuracy: 318/1129 (28.1665%)
_Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0273, Accuracy: 640/1129 (56.6873%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.6309, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   1, Avg loss: 0.0723, Accuracy: 101/568 (17.7817%)
_Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   2, Avg loss: 0.0427, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.3104, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   1, Avg loss: 0.0575, Accuracy: 325/1440 (22.5694%)
_Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 681/1440 (47.2917%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.9501, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   1, Avg loss: 0.0617, Accuracy: 238/1030 (23.1068%)
_Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   2, Avg loss: 0.0279, Accuracy: 524/1030 (50.8738%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 11.5704, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   1, Avg loss: 0.0847, Accuracy: 22/460 (4.7826%)
_Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.6799, Accuracy: 40/10000 (0.4000%)
_Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.0866, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.0701, Accuracy: 19/186 (10.2151%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7533, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0620, Accuracy: 251/928 (27.0474%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0230, Accuracy: 595/928 (64.1164%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.2380, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   1, Avg loss: 0.0976, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   2, Avg loss: 0.0558, Accuracy: 97/373 (26.0054%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.2376, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0617, Accuracy: 325/901 (36.0710%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0332, Accuracy: 418/901 (46.3929%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.0607, Accuracy: 57/10000 (0.5700%)
time spent on training: 175.90688180923462
[rfa agg] training data poison_ratio: 0.13387880943910827  data num: [1418, 1129, 568, 1440, 1030, 460, 186, 928, 373, 901]
[rfa agg] considering poison per batch poison_fraction: 0.04183712794972133
[rfa agg] init. name: [70, 37, 62, 29, 91, 31, 56, 1, 98, 4], weight: tensor([0.1681, 0.1339, 0.0674, 0.1708, 0.1221, 0.0545, 0.0221, 0.1100, 0.0442,
        0.1068])
[rfa agg] iter:  0, prev_obj_val: 52.927730560302734, obj_val: 54.62406539916992, abs dis: 1.6963348388671875
[rfa agg] iter: 0, weight: tensor([0.0850, 0.1461, 0.0526, 0.0870, 0.1546, 0.0358, 0.0079, 0.1883, 0.0221,
        0.2206])
[rfa agg] iter:  1, prev_obj_val: 54.62406539916992, obj_val: 59.068214416503906, abs dis: 4.444149017333984
[rfa agg] iter: 1, weight: tensor([0.0820, 0.1349, 0.0582, 0.0839, 0.1454, 0.0392, 0.0083, 0.1964, 0.0238,
        0.2278])
[rfa agg] iter:  2, prev_obj_val: 59.068214416503906, obj_val: 59.0592041015625, abs dis: 0.00901031494140625
[rfa agg] iter: 2, weight: tensor([0.0849, 0.1281, 0.0808, 0.0866, 0.1362, 0.0525, 0.0103, 0.1868, 0.0305,
        0.2034])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 16.5282, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 19.3568, Accuracy: 0/9950 (0.0000%)
saving model
Done in 422.91351652145386 sec.
Server Epoch:39 choose agents : [37, 46, 50, 70, 86, 40, 74, 51, 9, 21].
poison local model 37 index 9 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   1, Avg loss: 0.0641, Accuracy: 212/1129 (18.7777%), train_poison_data_count: 360
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   2, Avg loss: 0.0310, Accuracy: 484/1129 (42.8698%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   3, Avg loss: 0.0275, Accuracy: 492/1129 (43.5784%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   4, Avg loss: 0.0264, Accuracy: 518/1129 (45.8813%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   5, Avg loss: 0.0247, Accuracy: 553/1129 (48.9814%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   6, Avg loss: 0.0247, Accuracy: 536/1129 (47.4756%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   7, Avg loss: 0.0240, Accuracy: 539/1129 (47.7414%), train_poison_data_count: 360
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   8, Avg loss: 0.0240, Accuracy: 560/1129 (49.6014%), train_poison_data_count: 360
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   9, Avg loss: 0.0229, Accuracy: 587/1129 (51.9929%), train_poison_data_count: 360
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch  10, Avg loss: 0.0234, Accuracy: 566/1129 (50.1329%), train_poison_data_count: 360
Global model norm: 235.44953679079515.
Norm before scaling: 235.40568374085618. Distance: 1.195701785057237
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.0044, Accuracy: 81/10000 (0.8100%)
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: 1.1705, Accuracy: 4535/9950 (45.5779%)
Scaling by  100
Scaled Norm after poisoning: 259.85834482463713, distance: 119.57017748481434
Total norm for 2 adversaries is: 259.85834482463713. distance: 119.57017748481434
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0602, Accuracy: 381/1904 (20.0105%)
_Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0311, Accuracy: 714/1904 (37.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2396, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   1, Avg loss: 0.0674, Accuracy: 122/809 (15.0803%)
_Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   2, Avg loss: 0.0291, Accuracy: 310/809 (38.3189%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 10.2084, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0640, Accuracy: 302/1418 (21.2976%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0335, Accuracy: 577/1418 (40.6911%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.7722, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   1, Avg loss: 0.0686, Accuracy: 264/1003 (26.3210%)
_Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   2, Avg loss: 0.0381, Accuracy: 358/1003 (35.6929%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.7633, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 315/1573 (20.0254%)
_Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 556/1573 (35.3465%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2464, Accuracy: 92/10000 (0.9200%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   1, Avg loss: 0.0492, Accuracy: 409/1552 (26.3531%)
_Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   2, Avg loss: 0.0220, Accuracy: 735/1552 (47.3582%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 12.0994, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0678, Accuracy: 182/1049 (17.3499%)
_Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0315, Accuracy: 480/1049 (45.7579%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.1611, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0496, Accuracy: 364/1275 (28.5490%)
_Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0208, Accuracy: 650/1275 (50.9804%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 11.1029, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   1, Avg loss: 0.0618, Accuracy: 334/1949 (17.1370%)
_Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   2, Avg loss: 0.0348, Accuracy: 589/1949 (30.2206%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.7497, Accuracy: 70/10000 (0.7000%)
time spent on training: 319.69922852516174
[rfa agg] training data poison_ratio: 0.19625210453114705  data num: [1129, 1904, 809, 1418, 1003, 1573, 1552, 1049, 1275, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.061328782665983454
[rfa agg] init. name: [37, 46, 50, 70, 86, 40, 74, 51, 9, 21], weight: tensor([0.0826, 0.1394, 0.0592, 0.1038, 0.0734, 0.1151, 0.1136, 0.0768, 0.0933,
        0.1427])
[rfa agg] iter:  0, prev_obj_val: 12241.5283203125, obj_val: 7213.431640625, abs dis: 5028.0966796875
[rfa agg] iter: 0, weight: tensor([0.0080, 0.1520, 0.0631, 0.1121, 0.0786, 0.1247, 0.1230, 0.0823, 0.1004,
        0.1558])
[rfa agg] iter:  1, prev_obj_val: 7213.431640625, obj_val: 6734.9658203125, abs dis: 478.4658203125
[rfa agg] iter: 1, weight: tensor([0.0007, 0.1653, 0.0557, 0.1111, 0.0716, 0.1269, 0.1251, 0.0759, 0.0959,
        0.1717])
[rfa agg] iter:  2, prev_obj_val: 6734.9658203125, obj_val: 6730.7978515625, abs dis: 4.16796875
[rfa agg] iter: 2, weight: tensor([4.9567e-05, 2.4400e-01, 2.1160e-02, 9.8094e-02, 3.2550e-02, 1.6268e-01,
        1.5777e-01, 3.6348e-02, 5.9964e-02, 1.8738e-01])
[rfa agg] iter:  3, prev_obj_val: 6730.7978515625, obj_val: 6736.15869140625, abs dis: 5.36083984375
[rfa agg] iter: 3, weight: tensor([4.3635e-05, 1.0476e-01, 2.5231e-02, 1.6764e-01, 4.2200e-02, 2.1928e-01,
        2.1071e-01, 4.7311e-02, 9.1927e-02, 9.0887e-02])
[rfa agg] iter:  4, prev_obj_val: 6736.15869140625, obj_val: 6739.56396484375, abs dis: 3.4052734375
[rfa agg] iter: 4, weight: tensor([4.9363e-05, 8.5039e-02, 3.6660e-02, 1.8954e-01, 6.7309e-02, 1.5198e-01,
        1.4869e-01, 7.5052e-02, 1.6836e-01, 7.7319e-02])
[rfa agg] iter:  5, prev_obj_val: 6739.56396484375, obj_val: 6739.52880859375, abs dis: 0.03515625
[rfa agg] iter: 5, weight: tensor([5.0781e-05, 7.8782e-02, 4.2513e-02, 1.6390e-01, 8.2501e-02, 1.2685e-01,
        1.2470e-01, 9.1870e-02, 2.1637e-01, 7.2463e-02])
[rfa agg] iter:  6, prev_obj_val: 6739.52880859375, obj_val: 6737.71923828125, abs dis: 1.8095703125
[rfa agg] iter: 6, weight: tensor([5.0172e-05, 7.7780e-02, 4.2038e-02, 1.5892e-01, 8.1670e-02, 1.2458e-01,
        1.2258e-01, 9.1853e-02, 2.2902e-01, 7.1516e-02])
[rfa agg] iter:  7, prev_obj_val: 6737.71923828125, obj_val: 6741.52099609375, abs dis: 3.8017578125
[rfa agg] iter: 7, weight: tensor([4.9371e-05, 8.0461e-02, 3.8921e-02, 1.7123e-01, 7.3490e-02, 1.3399e-01,
        1.3181e-01, 8.3315e-02, 2.1317e-01, 7.3559e-02])
[rfa agg] iter:  8, prev_obj_val: 6741.52099609375, obj_val: 6743.6494140625, abs dis: 2.12841796875
[rfa agg] iter: 8, weight: tensor([5.1115e-05, 7.5552e-02, 4.5669e-02, 1.4750e-01, 9.1419e-02, 1.1677e-01,
        1.1494e-01, 1.0119e-01, 2.3709e-01, 6.9816e-02])
[rfa agg] iter:  9, prev_obj_val: 6743.6494140625, obj_val: 6741.50439453125, abs dis: 2.14501953125
[rfa agg] iter: 9, weight: tensor([5.1716e-05, 7.2970e-02, 4.9530e-02, 1.3419e-01, 1.0284e-01, 1.0878e-01,
        1.0716e-01, 1.1286e-01, 2.4388e-01, 6.7739e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.9352, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 6.2733, Accuracy: 0/9950 (0.0000%)
saving model
Done in 565.8375074863434 sec.
Server Epoch:40 choose agents : [32, 70, 52, 38, 15, 78, 83, 84, 12, 92].
_Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   1, Avg loss: 0.0606, Accuracy: 153/735 (20.8163%)
_Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   2, Avg loss: 0.0242, Accuracy: 351/735 (47.7551%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 12.7692, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0622, Accuracy: 332/1418 (23.4133%)
_Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0339, Accuracy: 584/1418 (41.1848%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.3817, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   1, Avg loss: 0.0626, Accuracy: 186/636 (29.2453%)
_Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   2, Avg loss: 0.0309, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.3439, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   1, Avg loss: 0.0669, Accuracy: 176/1131 (15.5615%)
_Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   2, Avg loss: 0.0319, Accuracy: 468/1131 (41.3793%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.8003, Accuracy: 97/10000 (0.9700%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   1, Avg loss: 0.0659, Accuracy: 251/1154 (21.7504%)
_Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 483/1154 (41.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.4323, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0745, Accuracy: 63/416 (15.1442%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0452, Accuracy: 196/416 (47.1154%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.9036, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0611, Accuracy: 333/1953 (17.0507%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0352, Accuracy: 670/1953 (34.3062%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.5605, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0692, Accuracy: 244/1190 (20.5042%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0337, Accuracy: 436/1190 (36.6387%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.0365, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   1, Avg loss: 0.0847, Accuracy: 11/338 (3.2544%)
_Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   2, Avg loss: 0.0457, Accuracy: 124/338 (36.6864%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.5277, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0608, Accuracy: 334/1715 (19.4752%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0329, Accuracy: 654/1715 (38.1341%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.0346, Accuracy: 70/10000 (0.7000%)
time spent on training: 203.055513381958
[rfa agg] training data poison_ratio: 0.1079917649260715  data num: [735, 1418, 636, 1131, 1154, 416, 1953, 1190, 338, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.03374742653939734
[rfa agg] init. name: [32, 70, 52, 38, 15, 78, 83, 84, 12, 92], weight: tensor([0.0688, 0.1327, 0.0595, 0.1058, 0.1080, 0.0389, 0.1828, 0.1114, 0.0316,
        0.1605])
[rfa agg] iter:  0, prev_obj_val: 62.7664680480957, obj_val: 63.468650817871094, abs dis: 0.7021827697753906
[rfa agg] iter: 0, weight: tensor([0.0455, 0.1362, 0.0309, 0.2149, 0.1844, 0.0153, 0.0716, 0.1969, 0.0114,
        0.0928])
[rfa agg] iter:  1, prev_obj_val: 63.468650817871094, obj_val: 64.81610870361328, abs dis: 1.3474578857421875
[rfa agg] iter: 1, weight: tensor([0.0461, 0.1171, 0.0308, 0.2456, 0.1872, 0.0150, 0.0647, 0.1997, 0.0112,
        0.0825])
[rfa agg] iter:  2, prev_obj_val: 64.81610870361328, obj_val: 68.38993072509766, abs dis: 3.573822021484375
[rfa agg] iter: 2, weight: tensor([0.0502, 0.1083, 0.0329, 0.2676, 0.1806, 0.0159, 0.0630, 0.1908, 0.0118,
        0.0789])
[rfa agg] iter:  3, prev_obj_val: 68.38993072509766, obj_val: 68.38522338867188, abs dis: 0.00470733642578125
[rfa agg] iter: 3, weight: tensor([0.0654, 0.1032, 0.0413, 0.2671, 0.1689, 0.0192, 0.0650, 0.1765, 0.0142,
        0.0793])
[rfa agg] iter:  4, prev_obj_val: 68.38522338867188, obj_val: 68.3851547241211, abs dis: 6.866455078125e-05
[rfa agg] iter: 4, weight: tensor([0.0655, 0.1031, 0.0413, 0.2698, 0.1677, 0.0192, 0.0650, 0.1750, 0.0142,
        0.0792])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 17.6506, Accuracy: 66/10000 (0.6600%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 19.2085, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 452.9487216472626 sec.
Server Epoch:41 choose agents : [44, 96, 66, 2, 76, 98, 52, 77, 99, 29].
poison local model 44 index 10 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0655, Accuracy: 370/1750 (21.1429%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0384, Accuracy: 578/1750 (33.0286%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   3, Avg loss: 0.0340, Accuracy: 668/1750 (38.1714%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   4, Avg loss: 0.0322, Accuracy: 723/1750 (41.3143%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   5, Avg loss: 0.0320, Accuracy: 721/1750 (41.2000%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   6, Avg loss: 0.0315, Accuracy: 754/1750 (43.0857%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   7, Avg loss: 0.0308, Accuracy: 741/1750 (42.3429%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   8, Avg loss: 0.0304, Accuracy: 756/1750 (43.2000%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   9, Avg loss: 0.0298, Accuracy: 786/1750 (44.9143%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch  10, Avg loss: 0.0299, Accuracy: 780/1750 (44.5714%), train_poison_data_count: 560
Global model norm: 240.17595275391332.
Norm before scaling: 240.10009306016522. Distance: 1.4037295748820349
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.8213, Accuracy: 93/10000 (0.9300%)
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: 0.9292, Accuracy: 8316/9950 (83.5779%)
Scaling by  100
Scaled Norm after poisoning: 271.1997361263466, distance: 140.3729616392523
Total norm for 1 adversaries is: 271.1997361263466. distance: 140.3729616392523
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.0897, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0597, Accuracy: 101/311 (32.4759%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.7180, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0666, Accuracy: 259/1402 (18.4736%)
_Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0407, Accuracy: 345/1402 (24.6077%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.2839, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0729, Accuracy: 115/605 (19.0083%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0442, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.6740, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   1, Avg loss: 0.0908, Accuracy: 11/466 (2.3605%)
_Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   2, Avg loss: 0.0472, Accuracy: 170/466 (36.4807%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.3149, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   1, Avg loss: 0.0968, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   2, Avg loss: 0.0544, Accuracy: 108/373 (28.9544%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.4901, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   1, Avg loss: 0.0635, Accuracy: 177/636 (27.8302%)
_Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.3943, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   1, Avg loss: 0.0548, Accuracy: 280/1340 (20.8955%)
_Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   2, Avg loss: 0.0286, Accuracy: 537/1340 (40.0746%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.2215, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   1, Avg loss: 0.0679, Accuracy: 166/773 (21.4748%)
_Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   2, Avg loss: 0.0320, Accuracy: 367/773 (47.4774%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.4707, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   1, Avg loss: 0.0568, Accuracy: 357/1440 (24.7917%)
_Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 671/1440 (46.5972%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.8932, Accuracy: 86/10000 (0.8600%)
time spent on training: 298.01220703125
[rfa agg] training data poison_ratio: 0.19239226033421283  data num: [1750, 311, 1402, 605, 466, 373, 636, 1340, 773, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.06012258135444151
[rfa agg] init. name: [44, 96, 66, 2, 76, 98, 52, 77, 99, 29], weight: tensor([0.1924, 0.0342, 0.1541, 0.0665, 0.0512, 0.0410, 0.0699, 0.1473, 0.0850,
        0.1583])
[rfa agg] iter:  0, prev_obj_val: 38965.140625, obj_val: 28256.529296875, abs dis: 10708.611328125
[rfa agg] iter: 0, weight: tensor([0.0536, 0.0399, 0.1810, 0.0777, 0.0598, 0.0479, 0.0817, 0.1729, 0.0994,
        0.1859])
[rfa agg] iter:  1, prev_obj_val: 28256.529296875, obj_val: 25138.658203125, abs dis: 3117.87109375
[rfa agg] iter: 1, weight: tensor([0.0133, 0.0411, 0.1897, 0.0805, 0.0619, 0.0494, 0.0847, 0.1810, 0.1033,
        0.1951])
[rfa agg] iter:  2, prev_obj_val: 25138.658203125, obj_val: 24358.103515625, abs dis: 780.5546875
[rfa agg] iter: 2, weight: tensor([0.0031, 0.0396, 0.1958, 0.0791, 0.0603, 0.0477, 0.0832, 0.1861, 0.1027,
        0.2022])
[rfa agg] iter:  3, prev_obj_val: 24358.103515625, obj_val: 24181.5, abs dis: 176.603515625
[rfa agg] iter: 3, weight: tensor([0.0007, 0.0321, 0.2144, 0.0692, 0.0511, 0.0393, 0.0728, 0.1994, 0.0944,
        0.2266])
[rfa agg] iter:  4, prev_obj_val: 24181.5, obj_val: 24172.7890625, abs dis: 8.7109375
[rfa agg] iter: 4, weight: tensor([8.9133e-05, 1.0877e-02, 2.7734e-01, 2.8406e-02, 1.9366e-02, 1.3789e-02,
        2.9902e-02, 2.0926e-01, 4.5208e-02, 3.6576e-01])
[rfa agg] iter:  5, prev_obj_val: 24172.7890625, obj_val: 24174.71484375, abs dis: 1.92578125
[rfa agg] iter: 5, weight: tensor([7.6617e-05, 1.2705e-02, 2.7469e-01, 3.7717e-02, 2.4329e-02, 1.6462e-02,
        3.9850e-02, 2.9749e-01, 6.8215e-02, 2.2846e-01])
[rfa agg] iter:  6, prev_obj_val: 24174.71484375, obj_val: 24175.86328125, abs dis: 1.1484375
[rfa agg] iter: 6, weight: tensor([8.7596e-05, 1.5549e-02, 2.4705e-01, 4.7945e-02, 3.0408e-02, 2.0270e-02,
        5.0672e-02, 2.9245e-01, 9.0597e-02, 2.0498e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 24.2287, Accuracy: 69/10000 (0.6900%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 26.6555, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 540.6849193572998 sec.
Server Epoch:42 choose agents : [5, 45, 88, 53, 24, 60, 19, 4, 51, 79].
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   1, Avg loss: 0.0540, Accuracy: 354/1628 (21.7445%)
_Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   2, Avg loss: 0.0268, Accuracy: 751/1628 (46.1302%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.4906, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0798, Accuracy: 107/669 (15.9940%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0435, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.5913, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   1, Avg loss: 0.0894, Accuracy: 36/603 (5.9701%)
_Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   2, Avg loss: 0.0468, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.2877, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   1, Avg loss: 0.0446, Accuracy: 261/813 (32.1033%)
_Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 440/813 (54.1205%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 12.8202, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   1, Avg loss: 0.1028, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   2, Avg loss: 0.0576, Accuracy: 102/312 (32.6923%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.2334, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0540, Accuracy: 500/2227 (22.4517%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0294, Accuracy: 940/2227 (42.2093%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.8147, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   1, Avg loss: 0.0552, Accuracy: 327/1036 (31.5637%)
_Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   2, Avg loss: 0.0256, Accuracy: 618/1036 (59.6525%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 12.5666, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0663, Accuracy: 300/901 (33.2963%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0343, Accuracy: 400/901 (44.3951%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.9522, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   1, Avg loss: 0.0671, Accuracy: 193/1049 (18.3985%)
_Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   2, Avg loss: 0.0323, Accuracy: 440/1049 (41.9447%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.9214, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   1, Avg loss: 0.1440, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   2, Avg loss: 0.1222, Accuracy: 0/197 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.4771, Accuracy: 49/10000 (0.4900%)
time spent on training: 206.02252340316772
[rfa agg] training data poison_ratio: 0.17254901960784313  data num: [1628, 669, 603, 813, 312, 2227, 1036, 901, 1049, 197]
[rfa agg] considering poison per batch poison_fraction: 0.05392156862745098
[rfa agg] init. name: [5, 45, 88, 53, 24, 60, 19, 4, 51, 79], weight: tensor([0.1725, 0.0709, 0.0639, 0.0862, 0.0331, 0.2360, 0.1098, 0.0955, 0.1112,
        0.0209])
[rfa agg] iter:  0, prev_obj_val: 78.20047760009766, obj_val: 78.44486999511719, abs dis: 0.24439239501953125
[rfa agg] iter: 0, weight: tensor([0.1159, 0.0545, 0.0433, 0.0895, 0.0137, 0.0766, 0.2688, 0.1395, 0.1902,
        0.0080])
[rfa agg] iter:  1, prev_obj_val: 78.44486999511719, obj_val: 80.20783233642578, abs dis: 1.7629623413085938
[rfa agg] iter: 1, weight: tensor([0.0826, 0.0569, 0.0442, 0.1018, 0.0129, 0.0589, 0.2878, 0.1670, 0.1805,
        0.0074])
[rfa agg] iter:  2, prev_obj_val: 80.20783233642578, obj_val: 82.90152740478516, abs dis: 2.693695068359375
[rfa agg] iter: 2, weight: tensor([0.0753, 0.0679, 0.0517, 0.1310, 0.0141, 0.0562, 0.2306, 0.2045, 0.1606,
        0.0080])
[rfa agg] iter:  3, prev_obj_val: 82.90152740478516, obj_val: 86.46084594726562, abs dis: 3.5593185424804688
[rfa agg] iter: 3, weight: tensor([0.0698, 0.0844, 0.0625, 0.1786, 0.0156, 0.0541, 0.1707, 0.2188, 0.1367,
        0.0088])
[rfa agg] iter:  4, prev_obj_val: 86.46084594726562, obj_val: 86.4185791015625, abs dis: 0.042266845703125
[rfa agg] iter: 4, weight: tensor([0.0643, 0.1078, 0.0775, 0.2424, 0.0172, 0.0515, 0.1313, 0.1845, 0.1140,
        0.0096])
[rfa agg] iter:  5, prev_obj_val: 86.4185791015625, obj_val: 86.4167251586914, abs dis: 0.00185394287109375
[rfa agg] iter: 5, weight: tensor([0.0629, 0.1072, 0.0767, 0.2613, 0.0169, 0.0504, 0.1277, 0.1769, 0.1105,
        0.0094])
[rfa agg] iter:  6, prev_obj_val: 86.4167251586914, obj_val: 86.41659545898438, abs dis: 0.00012969970703125
[rfa agg] iter: 6, weight: tensor([0.0626, 0.1067, 0.0764, 0.2663, 0.0168, 0.0502, 0.1269, 0.1750, 0.1097,
        0.0094])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.9870, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.9569, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 448.860719203949 sec.
Server Epoch:43 choose agents : [49, 71, 38, 53, 30, 18, 45, 40, 35, 5].
poison local model 49 index 11 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   1, Avg loss: 0.0910, Accuracy: 4/440 (0.9091%), train_poison_data_count: 140
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   2, Avg loss: 0.0585, Accuracy: 114/440 (25.9091%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   3, Avg loss: 0.0453, Accuracy: 140/440 (31.8182%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   4, Avg loss: 0.0426, Accuracy: 153/440 (34.7727%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   5, Avg loss: 0.0397, Accuracy: 152/440 (34.5455%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   6, Avg loss: 0.0391, Accuracy: 154/440 (35.0000%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   7, Avg loss: 0.0366, Accuracy: 151/440 (34.3182%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   8, Avg loss: 0.0368, Accuracy: 152/440 (34.5455%), train_poison_data_count: 140
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   9, Avg loss: 0.0347, Accuracy: 167/440 (37.9545%), train_poison_data_count: 140
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch  10, Avg loss: 0.0343, Accuracy: 165/440 (37.5000%), train_poison_data_count: 140
Global model norm: 244.8348534599394.
Norm before scaling: 244.82141131343067. Distance: 0.6972675270033254
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.9817, Accuracy: 55/10000 (0.5500%)
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: 1.4250, Accuracy: 4954/9950 (49.7889%)
Scaling by  100
Scaled Norm after poisoning: 253.17761027340075, distance: 69.72675814048183
Total norm for 3 adversaries is: 253.17761027340075. distance: 69.72675814048183
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   1, Avg loss: 0.0690, Accuracy: 124/818 (15.1589%)
_Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   2, Avg loss: 0.0330, Accuracy: 327/818 (39.9756%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.8516, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   1, Avg loss: 0.0668, Accuracy: 176/1131 (15.5615%)
_Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   2, Avg loss: 0.0308, Accuracy: 471/1131 (41.6446%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.9897, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   1, Avg loss: 0.0410, Accuracy: 287/813 (35.3014%)
_Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 446/813 (54.8585%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 13.2143, Accuracy: 51/10000 (0.5100%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0903, Accuracy: 14/486 (2.8807%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0433, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.8018, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   1, Avg loss: 0.0780, Accuracy: 142/530 (26.7925%)
_Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   2, Avg loss: 0.0434, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.4692, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0810, Accuracy: 110/669 (16.4425%)
_Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0452, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.5871, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0532, Accuracy: 312/1573 (19.8347%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 552/1573 (35.0922%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.0698, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   1, Avg loss: 0.0988, Accuracy: 3/271 (1.1070%)
_Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   2, Avg loss: 0.0666, Accuracy: 81/271 (29.8893%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.5347, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   1, Avg loss: 0.0552, Accuracy: 332/1628 (20.3931%)
_Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   2, Avg loss: 0.0264, Accuracy: 769/1628 (47.2359%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.4115, Accuracy: 139/10000 (1.3900%)
time spent on training: 285.41872382164
[rfa agg] training data poison_ratio: 0.30553894006460103  data num: [440, 818, 1131, 813, 486, 530, 669, 1573, 271, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.09548091877018783
[rfa agg] init. name: [49, 71, 38, 53, 30, 18, 45, 40, 35, 5], weight: tensor([0.0526, 0.0979, 0.1353, 0.0973, 0.0581, 0.0634, 0.0800, 0.1882, 0.0324,
        0.1948])
[rfa agg] iter:  0, prev_obj_val: 3223.525634765625, obj_val: 1793.37939453125, abs dis: 1430.146240234375
[rfa agg] iter: 0, weight: tensor([0.0030, 0.1004, 0.1425, 0.0998, 0.0581, 0.0637, 0.0813, 0.2055, 0.0319,
        0.2138])
[rfa agg] iter:  1, prev_obj_val: 1793.37939453125, obj_val: 1771.4444580078125, abs dis: 21.9349365234375
[rfa agg] iter: 1, weight: tensor([9.8432e-05, 4.7197e-02, 9.9758e-02, 4.6957e-02, 2.0618e-02, 2.3840e-02,
        3.3875e-02, 3.3779e-01, 9.8097e-03, 3.8006e-01])
[rfa agg] iter:  2, prev_obj_val: 1771.4444580078125, obj_val: 1770.097900390625, abs dis: 1.3465576171875
[rfa agg] iter: 2, weight: tensor([9.4273e-05, 8.6028e-02, 2.6363e-01, 8.6238e-02, 3.0769e-02, 3.6634e-02,
        5.5725e-02, 2.2670e-01, 1.3604e-02, 2.0057e-01])
[rfa agg] iter:  3, prev_obj_val: 1770.097900390625, obj_val: 1772.697509765625, abs dis: 2.599609375
[rfa agg] iter: 3, weight: tensor([8.1374e-05, 1.1122e-01, 3.6550e-01, 1.1057e-01, 3.3377e-02, 4.0654e-02,
        6.5737e-02, 1.3530e-01, 1.3983e-02, 1.2358e-01])
[rfa agg] iter:  4, prev_obj_val: 1772.697509765625, obj_val: 1775.429443359375, abs dis: 2.73193359375
[rfa agg] iter: 4, weight: tensor([7.9321e-05, 1.9254e-01, 2.1572e-01, 1.8477e-01, 4.3272e-02, 5.4682e-02,
        9.7953e-02, 1.0014e-01, 1.6717e-02, 9.4132e-02])
[rfa agg] iter:  5, prev_obj_val: 1775.429443359375, obj_val: 1778.43310546875, abs dis: 3.003662109375
[rfa agg] iter: 5, weight: tensor([6.6257e-05, 2.5383e-01, 1.2533e-01, 2.3882e-01, 4.5421e-02, 5.9646e-02,
        1.1773e-01, 7.3170e-02, 1.6250e-02, 6.9738e-02])
[rfa agg] iter:  6, prev_obj_val: 1778.43310546875, obj_val: 1778.4202880859375, abs dis: 0.0128173828125
[rfa agg] iter: 6, weight: tensor([6.2019e-05, 2.5475e-01, 9.7388e-02, 2.4077e-01, 5.1003e-02, 6.9371e-02,
        1.4585e-01, 6.3147e-02, 1.7033e-02, 6.0626e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.9743, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 6.1800, Accuracy: 0/9950 (0.0000%)
saving model
Done in 532.2160573005676 sec.
Server Epoch:44 choose agents : [91, 35, 89, 37, 4, 10, 47, 36, 24, 61].
_Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   1, Avg loss: 0.0625, Accuracy: 232/1030 (22.5243%)
_Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   2, Avg loss: 0.0277, Accuracy: 585/1030 (56.7961%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.5381, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0978, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0684, Accuracy: 74/271 (27.3063%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.5324, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   1, Avg loss: 0.0706, Accuracy: 268/896 (29.9107%)
_Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   2, Avg loss: 0.0393, Accuracy: 433/896 (48.3259%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.7444, Accuracy: 59/10000 (0.5900%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   1, Avg loss: 0.0594, Accuracy: 318/1129 (28.1665%)
_Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   2, Avg loss: 0.0270, Accuracy: 662/1129 (58.6360%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.8252, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0670, Accuracy: 309/901 (34.2952%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0355, Accuracy: 366/901 (40.6215%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.9594, Accuracy: 49/10000 (0.4900%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   1, Avg loss: 0.0605, Accuracy: 207/861 (24.0418%)
_Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   2, Avg loss: 0.0230, Accuracy: 450/861 (52.2648%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 11.4144, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   1, Avg loss: 0.1271, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   2, Avg loss: 0.1192, Accuracy: 6/134 (4.4776%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.8331, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.1107, Accuracy: 0/408 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0644, Accuracy: 93/408 (22.7941%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.2180, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   1, Avg loss: 0.0963, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   2, Avg loss: 0.0533, Accuracy: 109/312 (34.9359%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.2396, Accuracy: 51/10000 (0.5100%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   1, Avg loss: 0.1468, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   2, Avg loss: 0.1383, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.9411, Accuracy: 56/10000 (0.5600%)
time spent on training: 186.55624294281006
[rfa agg] training data poison_ratio: 0.3442840550854488  data num: [1030, 271, 896, 1129, 901, 861, 134, 408, 312, 85]
[rfa agg] considering poison per batch poison_fraction: 0.10758876721420274
[rfa agg] init. name: [91, 35, 89, 37, 4, 10, 47, 36, 24, 61], weight: tensor([0.1709, 0.0450, 0.1487, 0.1873, 0.1495, 0.1429, 0.0222, 0.0677, 0.0518,
        0.0141])
[rfa agg] iter:  0, prev_obj_val: 47.468448638916016, obj_val: 47.342594146728516, abs dis: 0.1258544921875
[rfa agg] iter: 0, weight: tensor([0.1296, 0.0295, 0.2288, 0.1256, 0.1662, 0.2054, 0.0107, 0.0644, 0.0339,
        0.0059])
[rfa agg] iter:  1, prev_obj_val: 47.342594146728516, obj_val: 47.34206771850586, abs dis: 0.00052642822265625
[rfa agg] iter: 1, weight: tensor([0.1262, 0.0288, 0.2346, 0.1228, 0.1652, 0.2103, 0.0104, 0.0629, 0.0330,
        0.0058])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.9542, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.9441, Accuracy: 0/9950 (0.0000%)
saving model
Done in 433.9774625301361 sec.
Server Epoch:45 choose agents : [55, 62, 30, 4, 18, 38, 76, 69, 42, 68].
poison local model 55 index 12 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Avg loss: 0.0649, Accuracy: 184/1071 (17.1802%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Avg loss: 0.0333, Accuracy: 336/1071 (31.3725%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   3, Avg loss: 0.0293, Accuracy: 388/1071 (36.2278%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   4, Avg loss: 0.0278, Accuracy: 438/1071 (40.8964%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   5, Avg loss: 0.0272, Accuracy: 433/1071 (40.4295%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   6, Avg loss: 0.0271, Accuracy: 442/1071 (41.2698%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   7, Avg loss: 0.0265, Accuracy: 464/1071 (43.3240%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   8, Avg loss: 0.0251, Accuracy: 479/1071 (44.7246%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   9, Avg loss: 0.0256, Accuracy: 483/1071 (45.0980%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch  10, Avg loss: 0.0255, Accuracy: 458/1071 (42.7638%), train_poison_data_count: 340
Global model norm: 249.38771114220924.
Norm before scaling: 249.34424935718891. Distance: 1.1408393867411954
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.0488, Accuracy: 71/10000 (0.7100%)
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: 1.0361, Accuracy: 6210/9950 (62.4121%)
Scaling by  100
Scaled Norm after poisoning: 270.0219030467714, distance: 114.08394918189632
Total norm for 2 adversaries is: 270.0219030467714. distance: 114.08394918189632
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0694, Accuracy: 111/568 (19.5423%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0421, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.7743, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   1, Avg loss: 0.0948, Accuracy: 5/486 (1.0288%)
_Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   2, Avg loss: 0.0475, Accuracy: 203/486 (41.7695%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.2218, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0653, Accuracy: 302/901 (33.5183%)
_Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0358, Accuracy: 405/901 (44.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.7360, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   1, Avg loss: 0.0755, Accuracy: 165/530 (31.1321%)
_Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   2, Avg loss: 0.0441, Accuracy: 276/530 (52.0755%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.7322, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0649, Accuracy: 177/1131 (15.6499%)
_Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0324, Accuracy: 461/1131 (40.7604%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.4103, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0869, Accuracy: 10/466 (2.1459%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0447, Accuracy: 182/466 (39.0558%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.4379, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   1, Avg loss: 0.0696, Accuracy: 189/590 (32.0339%)
_Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   2, Avg loss: 0.0343, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 13.0808, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   1, Avg loss: 0.0604, Accuracy: 254/1372 (18.5131%)
_Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   2, Avg loss: 0.0334, Accuracy: 487/1372 (35.4956%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.0990, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0658, Accuracy: 313/1163 (26.9132%)
_Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0395, Accuracy: 457/1163 (39.2949%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.2905, Accuracy: 62/10000 (0.6200%)
time spent on training: 294.2285029888153
[rfa agg] training data poison_ratio: 0.18808891036482242  data num: [1071, 568, 486, 901, 530, 1131, 466, 590, 1372, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.05877778448900701
[rfa agg] init. name: [55, 62, 30, 4, 18, 38, 76, 69, 42, 68], weight: tensor([0.1294, 0.0686, 0.0587, 0.1088, 0.0640, 0.1366, 0.0563, 0.0713, 0.1657,
        0.1405])
[rfa agg] iter:  0, prev_obj_val: 17215.49609375, obj_val: 11107.9228515625, abs dis: 6107.5732421875
[rfa agg] iter: 0, weight: tensor([0.0216, 0.0767, 0.0655, 0.1223, 0.0715, 0.1539, 0.0629, 0.0797, 0.1874,
        0.1584])
[rfa agg] iter:  1, prev_obj_val: 11107.9228515625, obj_val: 10062.9521484375, abs dis: 1044.970703125
[rfa agg] iter: 1, weight: tensor([0.0032, 0.0759, 0.0646, 0.1244, 0.0708, 0.1588, 0.0619, 0.0793, 0.1969,
        0.1641])
[rfa agg] iter:  2, prev_obj_val: 10062.9521484375, obj_val: 9936.0927734375, abs dis: 126.859375
[rfa agg] iter: 2, weight: tensor([0.0004, 0.0605, 0.0501, 0.1190, 0.0565, 0.1690, 0.0481, 0.0650, 0.2494,
        0.1820])
[rfa agg] iter:  3, prev_obj_val: 9936.0927734375, obj_val: 9938.3974609375, abs dis: 2.3046875
[rfa agg] iter: 3, weight: tensor([7.3269e-05, 3.7890e-02, 2.8973e-02, 1.5826e-01, 3.5271e-02, 2.5515e-01,
        2.7714e-02, 4.4421e-02, 1.6202e-01, 2.5023e-01])
[rfa agg] iter:  4, prev_obj_val: 9938.3974609375, obj_val: 9941.8017578125, abs dis: 3.404296875
[rfa agg] iter: 4, weight: tensor([8.0112e-05, 5.7124e-02, 4.2095e-02, 2.6349e-01, 5.3097e-02, 1.9102e-01,
        4.0114e-02, 6.9766e-02, 1.1859e-01, 1.6463e-01])
[rfa agg] iter:  5, prev_obj_val: 9941.8017578125, obj_val: 9943.203125, abs dis: 1.4013671875
[rfa agg] iter: 5, weight: tensor([8.4564e-05, 7.8353e-02, 5.5444e-02, 2.5597e-01, 7.2629e-02, 1.4838e-01,
        5.2675e-02, 1.0009e-01, 1.0472e-01, 1.3165e-01])
[rfa agg] iter:  6, prev_obj_val: 9943.203125, obj_val: 9948.0146484375, abs dis: 4.8115234375
[rfa agg] iter: 6, weight: tensor([8.6038e-05, 8.9062e-02, 6.1794e-02, 2.2912e-01, 8.2389e-02, 1.3775e-01,
        5.8598e-02, 1.1652e-01, 1.0101e-01, 1.2367e-01])
[rfa agg] iter:  7, prev_obj_val: 9948.0146484375, obj_val: 9947.9326171875, abs dis: 0.08203125
[rfa agg] iter: 7, weight: tensor([8.2567e-05, 1.2329e-01, 7.9688e-02, 1.4971e-01, 1.1297e-01, 1.0636e-01,
        7.4888e-02, 1.7181e-01, 8.3877e-02, 9.7322e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.9525, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 6.0367, Accuracy: 0/9950 (0.0000%)
saving model
Done in 538.8550946712494 sec.
Server Epoch:46 choose agents : [34, 94, 32, 2, 30, 67, 17, 61, 73, 89].
_Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   1, Avg loss: 0.0629, Accuracy: 336/1427 (23.5459%)
_Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   2, Avg loss: 0.0358, Accuracy: 514/1427 (36.0196%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.5858, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   1, Avg loss: 0.0651, Accuracy: 256/1662 (15.4031%)
_Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   2, Avg loss: 0.0367, Accuracy: 508/1662 (30.5656%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.8436, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   1, Avg loss: 0.0617, Accuracy: 166/735 (22.5850%)
_Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   2, Avg loss: 0.0244, Accuracy: 360/735 (48.9796%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 12.3310, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0709, Accuracy: 140/605 (23.1405%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0430, Accuracy: 329/605 (54.3802%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.3876, Accuracy: 71/10000 (0.7100%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0936, Accuracy: 12/486 (2.4691%)
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0448, Accuracy: 208/486 (42.7984%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.2601, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   1, Avg loss: 0.0914, Accuracy: 2/426 (0.4695%)
_Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   2, Avg loss: 0.0471, Accuracy: 166/426 (38.9671%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.6303, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0550, Accuracy: 346/1574 (21.9822%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0289, Accuracy: 635/1574 (40.3431%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.3695, Accuracy: 107/10000 (1.0700%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   1, Avg loss: 0.1473, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   2, Avg loss: 0.1318, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8653, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   1, Avg loss: 0.0729, Accuracy: 146/938 (15.5650%)
_Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   2, Avg loss: 0.0342, Accuracy: 319/938 (34.0085%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.5133, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0698, Accuracy: 279/896 (31.1384%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0380, Accuracy: 442/896 (49.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8832, Accuracy: 68/10000 (0.6800%)
time spent on training: 206.09684228897095
[rfa agg] training data poison_ratio: 0.06463663119764546  data num: [1427, 1662, 735, 605, 486, 426, 1574, 85, 938, 896]
[rfa agg] considering poison per batch poison_fraction: 0.020198947249264205
[rfa agg] init. name: [34, 94, 32, 2, 30, 67, 17, 61, 73, 89], weight: tensor([0.1615, 0.1881, 0.0832, 0.0685, 0.0550, 0.0482, 0.1782, 0.0096, 0.1062,
        0.1014])
[rfa agg] iter:  0, prev_obj_val: 64.71685791015625, obj_val: 67.8066635131836, abs dis: 3.0898056030273438
[rfa agg] iter: 0, weight: tensor([0.1056, 0.0891, 0.1068, 0.0599, 0.0361, 0.0279, 0.0929, 0.0033, 0.2761,
        0.2024])
[rfa agg] iter:  1, prev_obj_val: 67.8066635131836, obj_val: 71.29788208007812, abs dis: 3.4912185668945312
[rfa agg] iter: 1, weight: tensor([0.0777, 0.0683, 0.1381, 0.0679, 0.0386, 0.0291, 0.0706, 0.0032, 0.2579,
        0.2485])
[rfa agg] iter:  2, prev_obj_val: 71.29788208007812, obj_val: 73.32601928710938, abs dis: 2.02813720703125
[rfa agg] iter: 2, weight: tensor([0.0727, 0.0655, 0.1939, 0.0873, 0.0471, 0.0346, 0.0672, 0.0035, 0.1913,
        0.2371])
[rfa agg] iter:  3, prev_obj_val: 73.32601928710938, obj_val: 73.30723571777344, abs dis: 0.0187835693359375
[rfa agg] iter: 3, weight: tensor([0.0700, 0.0637, 0.2361, 0.1010, 0.0523, 0.0379, 0.0652, 0.0037, 0.1622,
        0.2080])
[rfa agg] iter:  4, prev_obj_val: 73.30723571777344, obj_val: 73.30638122558594, abs dis: 0.0008544921875
[rfa agg] iter: 4, weight: tensor([0.0693, 0.0631, 0.2484, 0.1013, 0.0520, 0.0376, 0.0645, 0.0037, 0.1586,
        0.2016])
[rfa agg] iter:  5, prev_obj_val: 73.30638122558594, obj_val: 71.26864624023438, abs dis: 2.0377349853515625
[rfa agg] iter: 5, weight: tensor([0.0691, 0.0629, 0.2516, 0.1011, 0.0519, 0.0375, 0.0643, 0.0036, 0.1578,
        0.2001])
[rfa agg] iter:  6, prev_obj_val: 71.26864624023438, obj_val: 71.25578308105469, abs dis: 0.0128631591796875
[rfa agg] iter: 6, weight: tensor([0.0718, 0.0648, 0.2180, 0.0887, 0.0471, 0.0346, 0.0664, 0.0035, 0.1790,
        0.2260])
[rfa agg] iter:  7, prev_obj_val: 71.25578308105469, obj_val: 71.25533294677734, abs dis: 0.00045013427734375
[rfa agg] iter: 7, weight: tensor([0.0720, 0.0649, 0.2100, 0.0881, 0.0470, 0.0345, 0.0665, 0.0035, 0.1815,
        0.2321])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.9648, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 6.1652, Accuracy: 0/9950 (0.0000%)
saving model
Done in 458.47903871536255 sec.
Server Epoch:47 choose agents : [61, 49, 64, 19, 88, 44, 5, 46, 59, 14].
poison local model 61 index 13 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   1, Avg loss: 0.1489, Accuracy: 0/85 (0.0000%), train_poison_data_count: 40
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   2, Avg loss: 0.1377, Accuracy: 0/85 (0.0000%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   3, Avg loss: 0.1201, Accuracy: 1/85 (1.1765%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   4, Avg loss: 0.1165, Accuracy: 2/85 (2.3529%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   5, Avg loss: 0.1105, Accuracy: 3/85 (3.5294%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   6, Avg loss: 0.1058, Accuracy: 3/85 (3.5294%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   7, Avg loss: 0.0983, Accuracy: 9/85 (10.5882%), train_poison_data_count: 40
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   8, Avg loss: 0.0950, Accuracy: 14/85 (16.4706%), train_poison_data_count: 40
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   9, Avg loss: 0.0916, Accuracy: 22/85 (25.8824%), train_poison_data_count: 40
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch  10, Avg loss: 0.0907, Accuracy: 22/85 (25.8824%), train_poison_data_count: 40
Global model norm: 253.88351628995136.
Norm before scaling: 253.88123915277788. Distance: 0.22719331594838485
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.3245, Accuracy: 57/10000 (0.5700%)
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: 2.9237, Accuracy: 3827/9950 (38.4623%)
Scaling by  100
Scaled Norm after poisoning: 254.66181618962824, distance: 22.71933163156778
Total norm for 4 adversaries is: 254.66181618962824. distance: 22.71933163156778
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   1, Avg loss: 0.0915, Accuracy: 3/440 (0.6818%)
_Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   2, Avg loss: 0.0548, Accuracy: 119/440 (27.0455%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.2485, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   1, Avg loss: 0.0772, Accuracy: 106/953 (11.1228%)
_Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   2, Avg loss: 0.0412, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.2646, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0532, Accuracy: 335/1036 (32.3359%)
_Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0244, Accuracy: 641/1036 (61.8726%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 12.5208, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   1, Avg loss: 0.0869, Accuracy: 62/603 (10.2819%)
_Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   2, Avg loss: 0.0498, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.6725, Accuracy: 54/10000 (0.5400%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   1, Avg loss: 0.0687, Accuracy: 326/1750 (18.6286%)
_Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   2, Avg loss: 0.0385, Accuracy: 610/1750 (34.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.3601, Accuracy: 106/10000 (1.0600%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   1, Avg loss: 0.0564, Accuracy: 301/1628 (18.4889%)
_Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   2, Avg loss: 0.0264, Accuracy: 739/1628 (45.3931%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.1078, Accuracy: 133/10000 (1.3300%)
_Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   1, Avg loss: 0.0622, Accuracy: 337/1904 (17.6996%)
_Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 716/1904 (37.6050%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.3444, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   1, Avg loss: 0.0672, Accuracy: 263/1089 (24.1506%)
_Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   2, Avg loss: 0.0316, Accuracy: 430/1089 (39.4858%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 15.6529, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   1, Avg loss: 0.0665, Accuracy: 155/1013 (15.3011%)
_Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   2, Avg loss: 0.0366, Accuracy: 351/1013 (34.6496%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.5682, Accuracy: 72/10000 (0.7200%)
time spent on training: 315.4934227466583
[rfa agg] training data poison_ratio: 0.3716788877249786  data num: [85, 440, 953, 1036, 603, 1750, 1628, 1904, 1089, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.11614965241405581
[rfa agg] init. name: [61, 49, 64, 19, 88, 44, 5, 46, 59, 14], weight: tensor([0.0081, 0.0419, 0.0908, 0.0987, 0.0574, 0.1667, 0.1550, 0.1813, 0.1037,
        0.0965])
[rfa agg] iter:  0, prev_obj_val: 201.03277587890625, obj_val: 163.4821014404297, abs dis: 37.55067443847656
[rfa agg] iter: 0, weight: tensor([6.2364e-05, 1.9186e-02, 6.3591e-02, 7.7561e-02, 3.0456e-02, 2.1420e-01,
        2.0641e-01, 2.3282e-01, 8.4256e-02, 7.1451e-02])
[rfa agg] iter:  1, prev_obj_val: 163.4821014404297, obj_val: 165.8788299560547, abs dis: 2.396728515625
[rfa agg] iter: 1, weight: tensor([4.0000e-05, 1.9766e-02, 9.5887e-02, 1.3754e-01, 3.4390e-02, 1.5000e-01,
        1.8928e-01, 1.3189e-01, 1.2440e-01, 1.1679e-01])
[rfa agg] iter:  2, prev_obj_val: 165.8788299560547, obj_val: 168.9445343017578, abs dis: 3.065704345703125
[rfa agg] iter: 2, weight: tensor([3.4893e-05, 2.0835e-02, 1.3209e-01, 2.0144e-01, 3.8361e-02, 9.8916e-02,
        1.1606e-01, 9.0765e-02, 1.3469e-01, 1.6680e-01])
[rfa agg] iter:  3, prev_obj_val: 168.9445343017578, obj_val: 170.42529296875, abs dis: 1.4807586669921875
[rfa agg] iter: 3, weight: tensor([3.0142e-05, 2.0544e-02, 1.6580e-01, 2.2343e-01, 3.9685e-02, 7.4341e-02,
        8.4283e-02, 6.9621e-02, 1.1623e-01, 2.0603e-01])
[rfa agg] iter:  4, prev_obj_val: 170.42529296875, obj_val: 174.34503173828125, abs dis: 3.91973876953125
[rfa agg] iter: 4, weight: tensor([2.8799e-05, 2.0616e-02, 1.8482e-01, 2.1626e-01, 4.0626e-02, 6.8033e-02,
        7.6440e-02, 6.4110e-02, 1.0580e-01, 2.2327e-01])
[rfa agg] iter:  5, prev_obj_val: 174.34503173828125, obj_val: 172.22225952148438, abs dis: 2.122772216796875
[rfa agg] iter: 5, weight: tensor([2.8646e-05, 2.2729e-02, 2.3350e-01, 1.8093e-01, 4.6871e-02, 6.2611e-02,
        6.9282e-02, 5.9558e-02, 9.6202e-02, 2.2829e-01])
[rfa agg] iter:  6, prev_obj_val: 172.22225952148438, obj_val: 174.32479858398438, abs dis: 2.1025390625
[rfa agg] iter: 6, weight: tensor([2.8093e-05, 2.1192e-02, 2.1877e-01, 1.8937e-01, 4.2747e-02, 6.3764e-02,
        7.1079e-02, 6.0401e-02, 9.7524e-02, 2.3512e-01])
[rfa agg] iter:  7, prev_obj_val: 174.32479858398438, obj_val: 174.3206329345703, abs dis: 0.0041656494140625
[rfa agg] iter: 7, weight: tensor([2.8341e-05, 2.2517e-02, 2.4089e-01, 1.7531e-01, 4.6492e-02, 6.1934e-02,
        6.8537e-02, 5.8927e-02, 9.4457e-02, 2.3090e-01])
[rfa agg] iter:  8, prev_obj_val: 174.3206329345703, obj_val: 174.32040405273438, abs dis: 0.0002288818359375
[rfa agg] iter: 8, weight: tensor([2.8208e-05, 2.2427e-02, 2.4674e-01, 1.7259e-01, 4.6335e-02, 6.1641e-02,
        6.8211e-02, 5.8648e-02, 9.3750e-02, 2.2963e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.9829, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 6.2602, Accuracy: 0/9950 (0.0000%)
saving model
Done in 572.8537526130676 sec.
Server Epoch:48 choose agents : [21, 78, 90, 85, 84, 38, 88, 31, 97, 66].
_Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   1, Avg loss: 0.0672, Accuracy: 319/1949 (16.3674%)
_Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   2, Avg loss: 0.0356, Accuracy: 582/1949 (29.8615%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.1936, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   1, Avg loss: 0.0824, Accuracy: 21/416 (5.0481%)
_Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   2, Avg loss: 0.0447, Accuracy: 202/416 (48.5577%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.6087, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0605, Accuracy: 255/677 (37.6662%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0247, Accuracy: 456/677 (67.3560%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 11.5625, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   1, Avg loss: 0.0596, Accuracy: 355/1988 (17.8571%)
_Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   2, Avg loss: 0.0374, Accuracy: 549/1988 (27.6157%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.5209, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   1, Avg loss: 0.0680, Accuracy: 253/1190 (21.2605%)
_Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   2, Avg loss: 0.0337, Accuracy: 435/1190 (36.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.7152, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0648, Accuracy: 184/1131 (16.2688%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0308, Accuracy: 475/1131 (41.9982%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.5266, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0867, Accuracy: 57/603 (9.4527%)
_Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0484, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.5976, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   1, Avg loss: 0.0995, Accuracy: 3/460 (0.6522%)
_Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   2, Avg loss: 0.0411, Accuracy: 172/460 (37.3913%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.6590, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   1, Avg loss: 0.0557, Accuracy: 300/1213 (24.7321%)
_Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   2, Avg loss: 0.0287, Accuracy: 496/1213 (40.8904%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.1809, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   1, Avg loss: 0.0651, Accuracy: 221/1402 (15.7632%)
_Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   2, Avg loss: 0.0407, Accuracy: 346/1402 (24.6790%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.6573, Accuracy: 68/10000 (0.6800%)
time spent on training: 241.7931878566742
[rfa agg] training data poison_ratio: 0.18025206274367575  data num: [1949, 416, 677, 1988, 1190, 1131, 603, 460, 1213, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.056328769607398674
[rfa agg] init. name: [21, 78, 90, 85, 84, 38, 88, 31, 97, 66], weight: tensor([0.1767, 0.0377, 0.0614, 0.1803, 0.1079, 0.1025, 0.0547, 0.0417, 0.1100,
        0.1271])
[rfa agg] iter:  0, prev_obj_val: 70.924560546875, obj_val: 75.32923889160156, abs dis: 4.4046783447265625
[rfa agg] iter: 0, weight: tensor([0.0779, 0.0156, 0.0372, 0.0740, 0.1914, 0.1690, 0.0298, 0.0188, 0.2062,
        0.1801])
[rfa agg] iter:  1, prev_obj_val: 75.32923889160156, obj_val: 73.64193725585938, abs dis: 1.6873016357421875
[rfa agg] iter: 1, weight: tensor([0.0679, 0.0187, 0.0485, 0.0651, 0.1928, 0.2000, 0.0377, 0.0229, 0.2117,
        0.1347])
[rfa agg] iter:  2, prev_obj_val: 73.64193725585938, obj_val: 73.64080047607422, abs dis: 0.00113677978515625
[rfa agg] iter: 2, weight: tensor([0.0667, 0.0170, 0.0432, 0.0639, 0.1963, 0.2023, 0.0338, 0.0208, 0.2180,
        0.1379])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.9438, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 6.0002, Accuracy: 0/9950 (0.0000%)
saving model
Done in 491.25382804870605 sec.
Server Epoch:49 choose agents : [65, 16, 50, 5, 97, 4, 13, 23, 86, 72].
poison local model 65 index 14 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Avg loss: 0.0630, Accuracy: 323/1475 (21.8983%), train_poison_data_count: 463
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Avg loss: 0.0338, Accuracy: 500/1475 (33.8983%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   3, Avg loss: 0.0311, Accuracy: 567/1475 (38.4407%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   4, Avg loss: 0.0303, Accuracy: 568/1475 (38.5085%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   5, Avg loss: 0.0299, Accuracy: 616/1475 (41.7627%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   6, Avg loss: 0.0287, Accuracy: 627/1475 (42.5085%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   7, Avg loss: 0.0283, Accuracy: 593/1475 (40.2034%), train_poison_data_count: 463
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   8, Avg loss: 0.0278, Accuracy: 635/1475 (43.0508%), train_poison_data_count: 463
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   9, Avg loss: 0.0269, Accuracy: 658/1475 (44.6102%), train_poison_data_count: 463
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch  10, Avg loss: 0.0274, Accuracy: 667/1475 (45.2203%), train_poison_data_count: 463
Global model norm: 258.28531643804297.
Norm before scaling: 258.2170538035782. Distance: 1.344933853295505
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.7172, Accuracy: 84/10000 (0.8400%)
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: 1.0092, Accuracy: 7099/9950 (71.3467%)
Scaling by  100
Scaled Norm after poisoning: 284.7694379888755, distance: 134.4933853508231
Total norm for 2 adversaries is: 284.7694379888755. distance: 134.4933853508231
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   1, Avg loss: 0.0851, Accuracy: 137/708 (19.3503%)
_Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   2, Avg loss: 0.0382, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.1351, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   1, Avg loss: 0.0681, Accuracy: 109/809 (13.4734%)
_Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   2, Avg loss: 0.0295, Accuracy: 309/809 (38.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 11.4281, Accuracy: 92/10000 (0.9200%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   1, Avg loss: 0.0568, Accuracy: 296/1628 (18.1818%)
_Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   2, Avg loss: 0.0272, Accuracy: 707/1628 (43.4275%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.3009, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0540, Accuracy: 284/1213 (23.4130%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 514/1213 (42.3743%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.6718, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0615, Accuracy: 300/901 (33.2963%)
_Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0350, Accuracy: 417/901 (46.2819%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.5950, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   1, Avg loss: 0.0643, Accuracy: 248/1645 (15.0760%)
_Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   2, Avg loss: 0.0345, Accuracy: 589/1645 (35.8055%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.8320, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   1, Avg loss: 0.0688, Accuracy: 193/715 (26.9930%)
_Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   2, Avg loss: 0.0409, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.9071, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   1, Avg loss: 0.0655, Accuracy: 276/1003 (27.5174%)
_Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   2, Avg loss: 0.0374, Accuracy: 380/1003 (37.8863%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.3348, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   1, Avg loss: 0.0648, Accuracy: 180/1241 (14.5044%)
_Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   2, Avg loss: 0.0393, Accuracy: 385/1241 (31.0234%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.5687, Accuracy: 72/10000 (0.7200%)
time spent on training: 336.7606256008148
[rfa agg] training data poison_ratio: 0.2736814252954666  data num: [1475, 708, 809, 1628, 1213, 901, 1645, 715, 1003, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.08552544540483331
[rfa agg] init. name: [65, 16, 50, 5, 97, 4, 13, 23, 86, 72], weight: tensor([0.1301, 0.0624, 0.0714, 0.1436, 0.1070, 0.0795, 0.1451, 0.0631, 0.0885,
        0.1095])
[rfa agg] iter:  0, prev_obj_val: 24344.232421875, obj_val: 15724.5205078125, abs dis: 8619.7119140625
[rfa agg] iter: 0, weight: tensor([0.0218, 0.0699, 0.0799, 0.1622, 0.1203, 0.0891, 0.1638, 0.0706, 0.0993,
        0.1231])
[rfa agg] iter:  1, prev_obj_val: 15724.5205078125, obj_val: 14249.7587890625, abs dis: 1474.76171875
[rfa agg] iter: 1, weight: tensor([0.0033, 0.0696, 0.0798, 0.1688, 0.1224, 0.0895, 0.1706, 0.0703, 0.1001,
        0.1257])
[rfa agg] iter:  2, prev_obj_val: 14249.7587890625, obj_val: 14047.33984375, abs dis: 202.4189453125
[rfa agg] iter: 2, weight: tensor([0.0005, 0.0589, 0.0688, 0.1967, 0.1195, 0.0803, 0.1986, 0.0594, 0.0917,
        0.1257])
[rfa agg] iter:  3, prev_obj_val: 14047.33984375, obj_val: 14044.8466796875, abs dis: 2.4931640625
[rfa agg] iter: 3, weight: tensor([6.7575e-05, 3.4412e-02, 4.3139e-02, 2.1675e-01, 1.3693e-01, 5.8443e-02,
        2.2048e-01, 3.4703e-02, 7.5339e-02, 1.7973e-01])
[rfa agg] iter:  4, prev_obj_val: 14044.8466796875, obj_val: 14048.8212890625, abs dis: 3.974609375
[rfa agg] iter: 4, weight: tensor([5.6837e-05, 4.1067e-02, 5.3539e-02, 1.0632e-01, 2.0514e-01, 7.7996e-02,
        1.0809e-01, 4.1445e-02, 1.1275e-01, 2.5360e-01])
[rfa agg] iter:  5, prev_obj_val: 14048.8212890625, obj_val: 14048.6943359375, abs dis: 0.126953125
[rfa agg] iter: 5, weight: tensor([5.5434e-05, 5.6141e-02, 7.8032e-02, 7.6977e-02, 1.7708e-01, 1.1830e-01,
        7.8157e-02, 5.6724e-02, 1.9979e-01, 1.5875e-01])
[rfa agg] iter:  6, prev_obj_val: 14048.6943359375, obj_val: 14051.75390625, abs dis: 3.0595703125
[rfa agg] iter: 6, weight: tensor([5.4434e-05, 5.5497e-02, 7.7572e-02, 7.5429e-02, 1.7014e-01, 1.2149e-01,
        7.6620e-02, 5.6160e-02, 2.1604e-01, 1.5100e-01])
[rfa agg] iter:  7, prev_obj_val: 14051.75390625, obj_val: 14053.59765625, abs dis: 1.84375
[rfa agg] iter: 7, weight: tensor([5.3310e-05, 6.4069e-02, 9.2536e-02, 6.7244e-02, 1.3560e-01, 1.4062e-01,
        6.8248e-02, 6.4867e-02, 2.4728e-01, 1.1948e-01])
[rfa agg] iter:  8, prev_obj_val: 14053.59765625, obj_val: 14055.701171875, abs dis: 2.103515625
[rfa agg] iter: 8, weight: tensor([5.3067e-05, 7.0041e-02, 1.0329e-01, 6.4023e-02, 1.2052e-01, 1.5207e-01,
        6.4941e-02, 7.1010e-02, 2.4663e-01, 1.0742e-01])
[rfa agg] iter:  9, prev_obj_val: 14055.701171875, obj_val: 14053.5947265625, abs dis: 2.1064453125
[rfa agg] iter: 9, weight: tensor([5.4054e-05, 7.8596e-02, 1.1823e-01, 6.2497e-02, 1.1150e-01, 1.6078e-01,
        6.3362e-02, 7.9860e-02, 2.2506e-01, 1.0006e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.9623, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 6.1451, Accuracy: 0/9950 (0.0000%)
saving model
Done in 593.6460247039795 sec.
Server Epoch:50 choose agents : [44, 46, 85, 2, 36, 48, 98, 55, 22, 81].
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   1, Avg loss: 0.0698, Accuracy: 344/1750 (19.6571%)
_Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   2, Avg loss: 0.0384, Accuracy: 580/1750 (33.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.0833, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0624, Accuracy: 358/1904 (18.8025%)
_Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0322, Accuracy: 687/1904 (36.0819%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.3423, Accuracy: 129/10000 (1.2900%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   1, Avg loss: 0.0593, Accuracy: 343/1988 (17.2535%)
_Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   2, Avg loss: 0.0375, Accuracy: 602/1988 (30.2817%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.5812, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.0731, Accuracy: 125/605 (20.6612%)
_Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0443, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.6684, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   1, Avg loss: 0.1067, Accuracy: 0/408 (0.0000%)
_Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   2, Avg loss: 0.0613, Accuracy: 119/408 (29.1667%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.6662, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0727, Accuracy: 93/631 (14.7385%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0443, Accuracy: 229/631 (36.2916%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.5075, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   1, Avg loss: 0.0942, Accuracy: 2/373 (0.5362%)
_Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   2, Avg loss: 0.0533, Accuracy: 114/373 (30.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.6745, Accuracy: 51/10000 (0.5100%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   1, Avg loss: 0.0605, Accuracy: 239/1071 (22.3156%)
_Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 473/1071 (44.1643%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.9594, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   1, Avg loss: 0.0518, Accuracy: 466/1470 (31.7007%)
_Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 826/1470 (56.1905%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.7933, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0727, Accuracy: 150/774 (19.3798%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0399, Accuracy: 311/774 (40.1809%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.1819, Accuracy: 59/10000 (0.5900%)
time spent on training: 249.92174363136292
[rfa agg] training data poison_ratio: 0.4382176052487698  data num: [1750, 1904, 1988, 605, 408, 631, 373, 1071, 1470, 774]
[rfa agg] considering poison per batch poison_fraction: 0.13694300164024056
[rfa agg] init. name: [44, 46, 85, 2, 36, 48, 98, 55, 22, 81], weight: tensor([0.1595, 0.1735, 0.1812, 0.0551, 0.0372, 0.0575, 0.0340, 0.0976, 0.1340,
        0.0705])
[rfa agg] iter:  0, prev_obj_val: 79.16569519042969, obj_val: 80.17626190185547, abs dis: 1.0105667114257812
[rfa agg] iter: 0, weight: tensor([0.1453, 0.1287, 0.1114, 0.0376, 0.0198, 0.0393, 0.0168, 0.1671, 0.2680,
        0.0659])
[rfa agg] iter:  1, prev_obj_val: 80.17626190185547, obj_val: 81.42758178710938, abs dis: 1.2513198852539062
[rfa agg] iter: 1, weight: tensor([0.1364, 0.1218, 0.1059, 0.0391, 0.0204, 0.0409, 0.0172, 0.1880, 0.2609,
        0.0694])
[rfa agg] iter:  2, prev_obj_val: 81.42758178710938, obj_val: 82.72907257080078, abs dis: 1.3014907836914062
[rfa agg] iter: 2, weight: tensor([0.1304, 0.1174, 0.1028, 0.0414, 0.0214, 0.0434, 0.0180, 0.2137, 0.2367,
        0.0748])
[rfa agg] iter:  3, prev_obj_val: 82.72907257080078, obj_val: 84.08793640136719, abs dis: 1.3588638305664062
[rfa agg] iter: 3, weight: tensor([0.1235, 0.1121, 0.0989, 0.0435, 0.0222, 0.0455, 0.0186, 0.2431, 0.2125,
        0.0801])
[rfa agg] iter:  4, prev_obj_val: 84.08793640136719, obj_val: 84.07949829101562, abs dis: 0.0084381103515625
[rfa agg] iter: 4, weight: tensor([0.1157, 0.1058, 0.0940, 0.0452, 0.0228, 0.0473, 0.0190, 0.2754, 0.1898,
        0.0850])
[rfa agg] iter:  5, prev_obj_val: 84.07949829101562, obj_val: 85.51468658447266, abs dis: 1.4351882934570312
[rfa agg] iter: 5, weight: tensor([0.1148, 0.1050, 0.0933, 0.0449, 0.0226, 0.0470, 0.0189, 0.2819, 0.1872,
        0.0845])
[rfa agg] iter:  6, prev_obj_val: 85.51468658447266, obj_val: 87.03742218017578, abs dis: 1.522735595703125
[rfa agg] iter: 6, weight: tensor([0.1072, 0.0986, 0.0882, 0.0464, 0.0231, 0.0486, 0.0192, 0.3109, 0.1685,
        0.0894])
[rfa agg] iter:  7, prev_obj_val: 87.03742218017578, obj_val: 88.68185424804688, abs dis: 1.6444320678710938
[rfa agg] iter: 7, weight: tensor([0.0992, 0.0919, 0.0827, 0.0477, 0.0234, 0.0500, 0.0194, 0.3413, 0.1504,
        0.0942])
[rfa agg] iter:  8, prev_obj_val: 88.68185424804688, obj_val: 85.51852416992188, abs dis: 3.163330078125
[rfa agg] iter: 8, weight: tensor([0.0927, 0.0864, 0.0781, 0.0495, 0.0239, 0.0519, 0.0197, 0.3613, 0.1360,
        0.1005])
[rfa agg] iter:  9, prev_obj_val: 85.51852416992188, obj_val: 87.03194427490234, abs dis: 1.5134201049804688
[rfa agg] iter: 9, weight: tensor([0.1040, 0.0957, 0.0857, 0.0451, 0.0225, 0.0472, 0.0187, 0.3325, 0.1615,
        0.0869])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.9784, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 6.0282, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 515.1348524093628 sec.
Server Epoch:51 choose agents : [85, 13, 26, 47, 58, 96, 62, 76, 7, 72].
poison local model 85 index 15 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   1, Avg loss: 0.0581, Accuracy: 425/1988 (21.3783%), train_poison_data_count: 624
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   2, Avg loss: 0.0378, Accuracy: 587/1988 (29.5272%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   3, Avg loss: 0.0347, Accuracy: 628/1988 (31.5895%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   4, Avg loss: 0.0330, Accuracy: 677/1988 (34.0543%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   5, Avg loss: 0.0332, Accuracy: 668/1988 (33.6016%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   6, Avg loss: 0.0328, Accuracy: 702/1988 (35.3119%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   7, Avg loss: 0.0323, Accuracy: 734/1988 (36.9215%), train_poison_data_count: 624
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   8, Avg loss: 0.0327, Accuracy: 722/1988 (36.3179%), train_poison_data_count: 624
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   9, Avg loss: 0.0319, Accuracy: 749/1988 (37.6761%), train_poison_data_count: 624
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch  10, Avg loss: 0.0316, Accuracy: 753/1988 (37.8773%), train_poison_data_count: 624
Global model norm: 262.576804240207.
Norm before scaling: 262.48026711545384. Distance: 1.4595565388919225
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.6197, Accuracy: 67/10000 (0.6700%)
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: 0.9381, Accuracy: 7719/9950 (77.5779%)
Scaling by  100
Scaled Norm after poisoning: 291.4932192607574, distance: 145.9556600050166
Total norm for 1 adversaries is: 291.4932192607574. distance: 145.9556600050166
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   1, Avg loss: 0.0639, Accuracy: 277/1645 (16.8389%)
_Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   2, Avg loss: 0.0355, Accuracy: 554/1645 (33.6778%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.2176, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   1, Avg loss: 0.0636, Accuracy: 297/1446 (20.5394%)
_Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   2, Avg loss: 0.0388, Accuracy: 473/1446 (32.7109%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.0608, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   1, Avg loss: 0.1293, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   2, Avg loss: 0.1124, Accuracy: 3/134 (2.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.0563, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   1, Avg loss: 0.0623, Accuracy: 289/803 (35.9900%)
_Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   2, Avg loss: 0.0364, Accuracy: 398/803 (49.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3157, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   1, Avg loss: 0.0879, Accuracy: 0/311 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   2, Avg loss: 0.0563, Accuracy: 106/311 (34.0836%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.7869, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   1, Avg loss: 0.0693, Accuracy: 101/568 (17.7817%)
_Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 261/568 (45.9507%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.6072, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.0846, Accuracy: 15/466 (3.2189%)
_Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0451, Accuracy: 178/466 (38.1974%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.0819, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0589, Accuracy: 326/891 (36.5881%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0280, Accuracy: 416/891 (46.6891%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.0716, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0643, Accuracy: 207/1241 (16.6801%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0393, Accuracy: 408/1241 (32.8767%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.6542, Accuracy: 58/10000 (0.5800%)
time spent on training: 297.5504570007324
[rfa agg] training data poison_ratio: 0.2094174655008954  data num: [1988, 1645, 1446, 134, 803, 311, 568, 466, 891, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.06544295796902981
[rfa agg] init. name: [85, 13, 26, 47, 58, 96, 62, 76, 7, 72], weight: tensor([0.2094, 0.1733, 0.1523, 0.0141, 0.0846, 0.0328, 0.0598, 0.0491, 0.0939,
        0.1307])
[rfa agg] iter:  0, prev_obj_val: 47438.703125, obj_val: 35454.75390625, abs dis: 11983.94921875
[rfa agg] iter: 0, weight: tensor([0.0655, 0.2053, 0.1803, 0.0166, 0.0998, 0.0386, 0.0705, 0.0579, 0.1108,
        0.1546])
[rfa agg] iter:  1, prev_obj_val: 35454.75390625, obj_val: 31510.515625, abs dis: 3944.23828125
[rfa agg] iter: 1, weight: tensor([0.0182, 0.2169, 0.1901, 0.0173, 0.1046, 0.0402, 0.0737, 0.0604, 0.1161,
        0.1627])
[rfa agg] iter:  2, prev_obj_val: 31510.515625, obj_val: 30398.314453125, abs dis: 1112.201171875
[rfa agg] iter: 2, weight: tensor([0.0048, 0.2243, 0.1951, 0.0169, 0.1046, 0.0394, 0.0730, 0.0597, 0.1165,
        0.1657])
[rfa agg] iter:  3, prev_obj_val: 30398.314453125, obj_val: 30102.423828125, abs dis: 295.890625
[rfa agg] iter: 3, weight: tensor([0.0012, 0.2432, 0.2047, 0.0147, 0.0995, 0.0350, 0.0670, 0.0543, 0.1118,
        0.1685])
[rfa agg] iter:  4, prev_obj_val: 30102.423828125, obj_val: 30048.78125, abs dis: 53.642578125
[rfa agg] iter: 4, weight: tensor([2.6412e-04, 3.3663e-01, 2.3162e-01, 8.4725e-03, 7.3767e-02, 2.1090e-02,
        4.4467e-02, 3.5136e-02, 8.5441e-02, 1.6310e-01])
[rfa agg] iter:  5, prev_obj_val: 30048.78125, obj_val: 30050.07421875, abs dis: 1.29296875
[rfa agg] iter: 5, weight: tensor([7.8922e-05, 2.2557e-01, 3.3085e-01, 4.2945e-03, 5.4759e-02, 1.1328e-02,
        2.7307e-02, 2.0737e-02, 6.7229e-02, 2.5785e-01])
[rfa agg] iter:  6, prev_obj_val: 30050.07421875, obj_val: 30051.74609375, abs dis: 1.671875
[rfa agg] iter: 6, weight: tensor([7.8187e-05, 1.5654e-01, 2.4360e-01, 4.7115e-03, 6.8412e-02, 1.2635e-02,
        3.1770e-02, 2.3811e-02, 8.5009e-02, 3.7344e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.9226, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 6.0779, Accuracy: 0/9950 (0.0000%)
saving model
Done in 546.9489197731018 sec.
Server Epoch:52 choose agents : [9, 47, 83, 58, 50, 6, 68, 26, 40, 71].
_Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   1, Avg loss: 0.0531, Accuracy: 317/1275 (24.8627%)
_Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   2, Avg loss: 0.0211, Accuracy: 603/1275 (47.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 11.4347, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   1, Avg loss: 0.1319, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   2, Avg loss: 0.1110, Accuracy: 2/134 (1.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 15.3950, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0624, Accuracy: 311/1953 (15.9242%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0357, Accuracy: 698/1953 (35.7399%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3906, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0640, Accuracy: 274/803 (34.1220%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0373, Accuracy: 407/803 (50.6849%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.0959, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   1, Avg loss: 0.0675, Accuracy: 106/809 (13.1026%)
_Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   2, Avg loss: 0.0297, Accuracy: 322/809 (39.8022%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 11.2662, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   1, Avg loss: 0.0663, Accuracy: 295/1956 (15.0818%)
_Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   2, Avg loss: 0.0339, Accuracy: 604/1956 (30.8793%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.1171, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   1, Avg loss: 0.0677, Accuracy: 303/1163 (26.0533%)
_Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   2, Avg loss: 0.0402, Accuracy: 438/1163 (37.6612%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.1250, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   1, Avg loss: 0.0628, Accuracy: 267/1446 (18.4647%)
_Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   2, Avg loss: 0.0378, Accuracy: 520/1446 (35.9613%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.0436, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   1, Avg loss: 0.0543, Accuracy: 317/1573 (20.1526%)
_Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 549/1573 (34.9015%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3267, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   1, Avg loss: 0.0680, Accuracy: 102/818 (12.4694%)
_Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   2, Avg loss: 0.0326, Accuracy: 334/818 (40.8313%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.5149, Accuracy: 80/10000 (0.8000%)
time spent on training: 255.38895177841187
[rfa agg] training data poison_ratio: 0.0  data num: [1275, 134, 1953, 803, 809, 1956, 1163, 1446, 1573, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [9, 47, 83, 58, 50, 6, 68, 26, 40, 71], weight: tensor([0.1069, 0.0112, 0.1637, 0.0673, 0.0678, 0.1640, 0.0975, 0.1212, 0.1319,
        0.0686])
[rfa agg] iter:  0, prev_obj_val: 63.46331787109375, obj_val: 64.30345916748047, abs dis: 0.8401412963867188
[rfa agg] iter: 0, weight: tensor([0.2191, 0.0033, 0.0807, 0.0463, 0.0463, 0.0806, 0.1676, 0.1761, 0.1335,
        0.0466])
[rfa agg] iter:  1, prev_obj_val: 64.30345916748047, obj_val: 65.65288543701172, abs dis: 1.34942626953125
[rfa agg] iter: 1, weight: tensor([0.2475, 0.0032, 0.0734, 0.0472, 0.0471, 0.0733, 0.1850, 0.1582, 0.1175,
        0.0475])
[rfa agg] iter:  2, prev_obj_val: 65.65288543701172, obj_val: 65.64779663085938, abs dis: 0.00508880615234375
[rfa agg] iter: 2, weight: tensor([0.2514, 0.0033, 0.0706, 0.0506, 0.0505, 0.0705, 0.2001, 0.1431, 0.1090,
        0.0510])
[rfa agg] iter:  3, prev_obj_val: 65.64779663085938, obj_val: 65.6476821899414, abs dis: 0.00011444091796875
[rfa agg] iter: 3, weight: tensor([0.2521, 0.0033, 0.0702, 0.0503, 0.0503, 0.0702, 0.2032, 0.1415, 0.1082,
        0.0508])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.9172, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.6418, Accuracy: 0/9950 (0.0000%)
saving model
Done in 505.30634331703186 sec.
Server Epoch:53 choose agents : [50, 14, 84, 8, 25, 5, 40, 98, 72, 69].
_Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   1, Avg loss: 0.0670, Accuracy: 116/809 (14.3387%)
_Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   2, Avg loss: 0.0290, Accuracy: 332/809 (41.0383%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 11.3473, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   1, Avg loss: 0.0658, Accuracy: 163/1013 (16.0908%)
_Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   2, Avg loss: 0.0369, Accuracy: 347/1013 (34.2547%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.4546, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   1, Avg loss: 0.0659, Accuracy: 272/1190 (22.8571%)
_Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   2, Avg loss: 0.0335, Accuracy: 450/1190 (37.8151%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.8721, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0691, Accuracy: 175/1513 (11.5664%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0402, Accuracy: 395/1513 (26.1071%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.6291, Accuracy: 79/10000 (0.7900%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   1, Avg loss: 0.0540, Accuracy: 276/690 (40.0000%)
_Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 453/690 (65.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.8696, Accuracy: 64/10000 (0.6400%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0555, Accuracy: 340/1628 (20.8845%)
_Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0269, Accuracy: 723/1628 (44.4103%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.8610, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 319/1573 (20.2797%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0355, Accuracy: 555/1573 (35.2829%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.2762, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   1, Avg loss: 0.0951, Accuracy: 3/373 (0.8043%)
_Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   2, Avg loss: 0.0547, Accuracy: 127/373 (34.0483%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.3397, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   1, Avg loss: 0.0645, Accuracy: 189/1241 (15.2297%)
_Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   2, Avg loss: 0.0395, Accuracy: 360/1241 (29.0089%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.6064, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0678, Accuracy: 178/590 (30.1695%)
_Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0348, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 15.3666, Accuracy: 50/10000 (0.5000%)
time spent on training: 265.3836693763733
[rfa agg] training data poison_ratio: 0.21826741996233523  data num: [809, 1013, 1190, 1513, 690, 1628, 1573, 373, 1241, 590]
[rfa agg] considering poison per batch poison_fraction: 0.06820856873822975
[rfa agg] init. name: [50, 14, 84, 8, 25, 5, 40, 98, 72, 69], weight: tensor([0.0762, 0.0954, 0.1121, 0.1425, 0.0650, 0.1533, 0.1481, 0.0351, 0.1169,
        0.0556])
[rfa agg] iter:  0, prev_obj_val: 57.279701232910156, obj_val: 58.629539489746094, abs dis: 1.3498382568359375
[rfa agg] iter: 0, weight: tensor([0.0868, 0.2025, 0.1660, 0.1005, 0.0532, 0.0857, 0.0921, 0.0160, 0.1574,
        0.0397])
[rfa agg] iter:  1, prev_obj_val: 58.629539489746094, obj_val: 60.316131591796875, abs dis: 1.6865921020507812
[rfa agg] iter: 1, weight: tensor([0.0937, 0.2378, 0.1558, 0.0919, 0.0562, 0.0795, 0.0849, 0.0163, 0.1423,
        0.0416])
[rfa agg] iter:  2, prev_obj_val: 60.316131591796875, obj_val: 60.309452056884766, abs dis: 0.006679534912109375
[rfa agg] iter: 2, weight: tensor([0.1045, 0.2580, 0.1418, 0.0869, 0.0612, 0.0760, 0.0808, 0.0171, 0.1290,
        0.0448])
[rfa agg] iter:  3, prev_obj_val: 60.309452056884766, obj_val: 60.30915069580078, abs dis: 0.000301361083984375
[rfa agg] iter: 3, weight: tensor([0.1043, 0.2642, 0.1397, 0.0862, 0.0608, 0.0754, 0.0802, 0.0170, 0.1276,
        0.0445])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.8685, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.2867, Accuracy: 0/9950 (0.0000%)
saving model
Done in 523.2972979545593 sec.
Server Epoch:54 choose agents : [72, 22, 50, 1, 38, 36, 52, 32, 73, 85].
_Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   1, Avg loss: 0.0650, Accuracy: 182/1241 (14.6656%)
_Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   2, Avg loss: 0.0387, Accuracy: 397/1241 (31.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5520, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   1, Avg loss: 0.0517, Accuracy: 438/1470 (29.7959%)
_Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 827/1470 (56.2585%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 11.9004, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   1, Avg loss: 0.0659, Accuracy: 126/809 (15.5748%)
_Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   2, Avg loss: 0.0280, Accuracy: 352/809 (43.5105%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 11.7415, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0733, Accuracy: 239/928 (25.7543%)
_Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0263, Accuracy: 522/928 (56.2500%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 10.8077, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0640, Accuracy: 182/1131 (16.0920%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0313, Accuracy: 471/1131 (41.6446%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.1959, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   1, Avg loss: 0.1039, Accuracy: 0/408 (0.0000%)
_Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   2, Avg loss: 0.0598, Accuracy: 117/408 (28.6765%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.8030, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0617, Accuracy: 189/636 (29.7170%)
_Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0319, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 11.2767, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   1, Avg loss: 0.0631, Accuracy: 141/735 (19.1837%)
_Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   2, Avg loss: 0.0243, Accuracy: 347/735 (47.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 13.1645, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   1, Avg loss: 0.0674, Accuracy: 167/938 (17.8038%)
_Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   2, Avg loss: 0.0353, Accuracy: 308/938 (32.8358%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 10.1941, Accuracy: 53/10000 (0.5300%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   1, Avg loss: 0.0585, Accuracy: 382/1988 (19.2153%)
_Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   2, Avg loss: 0.0376, Accuracy: 543/1988 (27.3139%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.4408, Accuracy: 70/10000 (0.7000%)
time spent on training: 220.72081685066223
[rfa agg] training data poison_ratio: 0.19330999611046285  data num: [1241, 1470, 809, 928, 1131, 408, 636, 735, 938, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.06040937378451964
[rfa agg] init. name: [72, 22, 50, 1, 38, 36, 52, 32, 73, 85], weight: tensor([0.1207, 0.1429, 0.0787, 0.0902, 0.1100, 0.0397, 0.0618, 0.0715, 0.0912,
        0.1933])
[rfa agg] iter:  0, prev_obj_val: 62.44535446166992, obj_val: 66.615966796875, abs dis: 4.170612335205078
[rfa agg] iter: 0, weight: tensor([0.1376, 0.0994, 0.0943, 0.1378, 0.1722, 0.0198, 0.0436, 0.0712, 0.1642,
        0.0598])
[rfa agg] iter:  1, prev_obj_val: 66.615966796875, obj_val: 68.30876159667969, abs dis: 1.6927947998046875
[rfa agg] iter: 1, weight: tensor([0.0917, 0.0732, 0.1399, 0.1559, 0.1166, 0.0229, 0.0548, 0.1032, 0.1924,
        0.0493])
[rfa agg] iter:  2, prev_obj_val: 68.30876159667969, obj_val: 68.30160522460938, abs dis: 0.0071563720703125
[rfa agg] iter: 2, weight: tensor([0.0840, 0.0687, 0.1621, 0.1500, 0.1036, 0.0242, 0.0596, 0.1181, 0.1821,
        0.0475])
[rfa agg] iter:  3, prev_obj_val: 68.30160522460938, obj_val: 68.3014907836914, abs dis: 0.00011444091796875
[rfa agg] iter: 3, weight: tensor([0.0837, 0.0685, 0.1658, 0.1490, 0.1029, 0.0242, 0.0597, 0.1190, 0.1799,
        0.0474])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.8975, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.6717, Accuracy: 0/9950 (0.0000%)
saving model
Done in 474.9106636047363 sec.
Server Epoch:55 choose agents : [33, 58, 47, 9, 19, 26, 45, 81, 95, 56].
_Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   1, Avg loss: 0.0907, Accuracy: 8/515 (1.5534%)
_Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   2, Avg loss: 0.0557, Accuracy: 137/515 (26.6019%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.5098, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0649, Accuracy: 244/803 (30.3861%)
_Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0362, Accuracy: 417/803 (51.9303%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.3733, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   1, Avg loss: 0.1307, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   2, Avg loss: 0.1185, Accuracy: 0/134 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.8360, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   1, Avg loss: 0.0495, Accuracy: 312/1275 (24.4706%)
_Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   2, Avg loss: 0.0207, Accuracy: 650/1275 (50.9804%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 11.7054, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   1, Avg loss: 0.0559, Accuracy: 310/1036 (29.9228%)
_Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 642/1036 (61.9691%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 14.1106, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0601, Accuracy: 288/1446 (19.9170%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0384, Accuracy: 490/1446 (33.8866%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.2565, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   1, Avg loss: 0.0869, Accuracy: 91/669 (13.6024%)
_Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   2, Avg loss: 0.0471, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.6987, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   1, Avg loss: 0.0705, Accuracy: 171/774 (22.0930%)
_Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   2, Avg loss: 0.0397, Accuracy: 319/774 (41.2145%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.1505, Accuracy: 69/10000 (0.6900%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   1, Avg loss: 0.0626, Accuracy: 218/599 (36.3940%)
_Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   2, Avg loss: 0.0315, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 14.4218, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   1, Avg loss: 0.0949, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   2, Avg loss: 0.0764, Accuracy: 7/186 (3.7634%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.8880, Accuracy: 50/10000 (0.5000%)
time spent on training: 190.158611536026
[rfa agg] training data poison_ratio: 0.08054322979696114  data num: [515, 803, 134, 1275, 1036, 1446, 669, 774, 599, 186]
[rfa agg] considering poison per batch poison_fraction: 0.02516975931155036
[rfa agg] init. name: [33, 58, 47, 9, 19, 26, 45, 81, 95, 56], weight: tensor([0.0692, 0.1080, 0.0180, 0.1714, 0.1393, 0.1944, 0.0900, 0.1041, 0.0805,
        0.0250])
[rfa agg] iter:  0, prev_obj_val: 53.16079330444336, obj_val: 54.31406021118164, abs dis: 1.1532669067382812
[rfa agg] iter: 0, weight: tensor([0.0662, 0.2127, 0.0070, 0.0910, 0.1161, 0.0753, 0.1441, 0.1766, 0.1010,
        0.0099])
[rfa agg] iter:  1, prev_obj_val: 54.31406021118164, obj_val: 54.30788040161133, abs dis: 0.0061798095703125
[rfa agg] iter: 1, weight: tensor([0.0695, 0.2146, 0.0070, 0.0809, 0.1016, 0.0680, 0.1597, 0.1769, 0.1120,
        0.0098])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.9073, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.5871, Accuracy: 0/9950 (0.0000%)
saving model
Done in 450.71094584465027 sec.
Server Epoch:56 choose agents : [98, 9, 8, 25, 64, 74, 90, 19, 66, 92].
_Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   1, Avg loss: 0.0925, Accuracy: 6/373 (1.6086%)
_Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   2, Avg loss: 0.0542, Accuracy: 100/373 (26.8097%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.9099, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   1, Avg loss: 0.0499, Accuracy: 351/1275 (27.5294%)
_Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   2, Avg loss: 0.0202, Accuracy: 644/1275 (50.5098%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 11.7711, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   1, Avg loss: 0.0708, Accuracy: 178/1513 (11.7647%)
_Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   2, Avg loss: 0.0405, Accuracy: 415/1513 (27.4289%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.8168, Accuracy: 61/10000 (0.6100%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0519, Accuracy: 288/690 (41.7391%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.5278, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   1, Avg loss: 0.0754, Accuracy: 133/953 (13.9559%)
_Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   2, Avg loss: 0.0422, Accuracy: 319/953 (33.4732%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.8413, Accuracy: 71/10000 (0.7100%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   1, Avg loss: 0.0480, Accuracy: 473/1552 (30.4768%)
_Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   2, Avg loss: 0.0218, Accuracy: 756/1552 (48.7113%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 11.7891, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   1, Avg loss: 0.0654, Accuracy: 230/677 (33.9734%)
_Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   2, Avg loss: 0.0257, Accuracy: 452/677 (66.7651%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 12.0665, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   1, Avg loss: 0.0548, Accuracy: 318/1036 (30.6950%)
_Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 651/1036 (62.8378%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 13.6462, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   1, Avg loss: 0.0671, Accuracy: 211/1402 (15.0499%)
_Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   2, Avg loss: 0.0413, Accuracy: 330/1402 (23.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.1575, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   1, Avg loss: 0.0687, Accuracy: 331/1715 (19.3003%)
_Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   2, Avg loss: 0.0328, Accuracy: 647/1715 (37.7259%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.2570, Accuracy: 77/10000 (0.7700%)
time spent on training: 256.83732891082764
[rfa agg] training data poison_ratio: 0.20042910781333811  data num: [373, 1275, 1513, 690, 953, 1552, 677, 1036, 1402, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.06263409619166815
[rfa agg] init. name: [98, 9, 8, 25, 64, 74, 90, 19, 66, 92], weight: tensor([0.0333, 0.1140, 0.1353, 0.0617, 0.0852, 0.1387, 0.0605, 0.0926, 0.1253,
        0.1533])
[rfa agg] iter:  0, prev_obj_val: 56.52312088012695, obj_val: 59.503089904785156, abs dis: 2.979969024658203
[rfa agg] iter: 0, weight: tensor([0.0141, 0.1681, 0.1091, 0.0439, 0.1164, 0.0949, 0.0436, 0.1861, 0.1393,
        0.0845])
[rfa agg] iter:  1, prev_obj_val: 59.503089904785156, obj_val: 57.83253860473633, abs dis: 1.6705513000488281
[rfa agg] iter: 1, weight: tensor([0.0152, 0.1445, 0.0947, 0.0500, 0.1461, 0.0839, 0.0497, 0.2220, 0.1180,
        0.0759])
[rfa agg] iter:  2, prev_obj_val: 57.83253860473633, obj_val: 59.47224044799805, abs dis: 1.6397018432617188
[rfa agg] iter: 2, weight: tensor([0.0143, 0.1509, 0.0984, 0.0457, 0.1314, 0.0865, 0.0453, 0.2252, 0.1248,
        0.0776])
[rfa agg] iter:  3, prev_obj_val: 59.47224044799805, obj_val: 57.83440399169922, abs dis: 1.6378364562988281
[rfa agg] iter: 3, weight: tensor([0.0150, 0.1405, 0.0932, 0.0493, 0.1468, 0.0826, 0.0490, 0.2328, 0.1160,
        0.0748])
[rfa agg] iter:  4, prev_obj_val: 57.83440399169922, obj_val: 61.308982849121094, abs dis: 3.474578857421875
[rfa agg] iter: 4, weight: tensor([0.0142, 0.1499, 0.0981, 0.0455, 0.1312, 0.0862, 0.0452, 0.2279, 0.1244,
        0.0773])
[rfa agg] iter:  5, prev_obj_val: 61.308982849121094, obj_val: 63.30878448486328, abs dis: 1.9998016357421875
[rfa agg] iter: 5, weight: tensor([0.0158, 0.1309, 0.0889, 0.0538, 0.1658, 0.0796, 0.0536, 0.2302, 0.1089,
        0.0726])
[rfa agg] iter:  6, prev_obj_val: 63.30878448486328, obj_val: 63.30233383178711, abs dis: 0.006450653076171875
[rfa agg] iter: 6, weight: tensor([0.0167, 0.1206, 0.0847, 0.0590, 0.1919, 0.0765, 0.0589, 0.2192, 0.1021,
        0.0703])
[rfa agg] iter:  7, prev_obj_val: 63.30233383178711, obj_val: 63.30217742919922, abs dis: 0.000156402587890625
[rfa agg] iter: 7, weight: tensor([0.0167, 0.1195, 0.0843, 0.0588, 0.1967, 0.0762, 0.0587, 0.2176, 0.1016,
        0.0700])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.9229, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.6225, Accuracy: 0/9950 (0.0000%)
saving model
Done in 514.6392805576324 sec.
Server Epoch:57 choose agents : [16, 72, 14, 32, 55, 48, 98, 56, 85, 95].
_Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   1, Avg loss: 0.0804, Accuracy: 150/708 (21.1864%)
_Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   2, Avg loss: 0.0420, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.6905, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   1, Avg loss: 0.0640, Accuracy: 213/1241 (17.1636%)
_Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   2, Avg loss: 0.0388, Accuracy: 383/1241 (30.8622%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.4404, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   1, Avg loss: 0.0645, Accuracy: 183/1013 (18.0652%)
_Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   2, Avg loss: 0.0362, Accuracy: 364/1013 (35.9329%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.4872, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0646, Accuracy: 132/735 (17.9592%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0237, Accuracy: 347/735 (47.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 13.3739, Accuracy: 65/10000 (0.6500%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0603, Accuracy: 232/1071 (21.6620%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0298, Accuracy: 461/1071 (43.0439%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.9930, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.0751, Accuracy: 84/631 (13.3122%)
_Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0441, Accuracy: 237/631 (37.5594%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.4000, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   1, Avg loss: 0.0906, Accuracy: 8/373 (2.1448%)
_Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   2, Avg loss: 0.0520, Accuracy: 120/373 (32.1716%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.8961, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.0948, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0772, Accuracy: 1/186 (0.5376%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.8883, Accuracy: 44/10000 (0.4400%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   1, Avg loss: 0.0574, Accuracy: 357/1988 (17.9577%)
_Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   2, Avg loss: 0.0368, Accuracy: 579/1988 (29.1247%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.5859, Accuracy: 78/10000 (0.7800%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   1, Avg loss: 0.0559, Accuracy: 248/599 (41.4023%)
_Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   2, Avg loss: 0.0309, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 14.7867, Accuracy: 50/10000 (0.5000%)
time spent on training: 242.1463804244995
[rfa agg] training data poison_ratio: 0.4280866003510825  data num: [708, 1241, 1013, 735, 1071, 631, 373, 186, 1988, 599]
[rfa agg] considering poison per batch poison_fraction: 0.13377706260971328
[rfa agg] init. name: [16, 72, 14, 32, 55, 48, 98, 56, 85, 95], weight: tensor([0.0829, 0.1452, 0.1185, 0.0860, 0.1253, 0.0738, 0.0437, 0.0218, 0.2327,
        0.0701])
[rfa agg] iter:  0, prev_obj_val: 69.07536315917969, obj_val: 70.86441802978516, abs dis: 1.7890548706054688
[rfa agg] iter: 0, weight: tensor([0.0956, 0.1432, 0.2608, 0.1088, 0.1679, 0.0638, 0.0222, 0.0082, 0.0706,
        0.0590])
[rfa agg] iter:  1, prev_obj_val: 70.86441802978516, obj_val: 74.76131439208984, abs dis: 3.8968963623046875
[rfa agg] iter: 1, weight: tensor([0.1250, 0.1112, 0.2173, 0.1523, 0.1428, 0.0813, 0.0252, 0.0089, 0.0628,
        0.0732])
[rfa agg] iter:  2, prev_obj_val: 74.76131439208984, obj_val: 76.38931274414062, abs dis: 1.6279983520507812
[rfa agg] iter: 2, weight: tensor([0.1537, 0.0869, 0.1408, 0.2151, 0.1066, 0.1092, 0.0287, 0.0095, 0.0554,
        0.0940])
[rfa agg] iter:  3, prev_obj_val: 76.38931274414062, obj_val: 76.37789916992188, abs dis: 0.01141357421875
[rfa agg] iter: 3, weight: tensor([0.1564, 0.0784, 0.1191, 0.2377, 0.0935, 0.1217, 0.0294, 0.0095, 0.0518,
        0.1024])
[rfa agg] iter:  4, prev_obj_val: 76.37789916992188, obj_val: 76.37764739990234, abs dis: 0.00025177001953125
[rfa agg] iter: 4, weight: tensor([0.1553, 0.0776, 0.1172, 0.2439, 0.0920, 0.1217, 0.0292, 0.0095, 0.0513,
        0.1024])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.9295, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.6042, Accuracy: 0/9950 (0.0000%)
saving model
Done in 496.64118218421936 sec.
Server Epoch:58 choose agents : [84, 53, 38, 31, 8, 47, 67, 4, 87, 88].
_Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   1, Avg loss: 0.0655, Accuracy: 269/1190 (22.6050%)
_Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   2, Avg loss: 0.0336, Accuracy: 454/1190 (38.1513%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.5785, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   1, Avg loss: 0.0485, Accuracy: 250/813 (30.7503%)
_Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   2, Avg loss: 0.0203, Accuracy: 455/813 (55.9656%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 13.3905, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   1, Avg loss: 0.0654, Accuracy: 194/1131 (17.1530%)
_Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   2, Avg loss: 0.0323, Accuracy: 474/1131 (41.9098%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.1583, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0959, Accuracy: 8/460 (1.7391%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0402, Accuracy: 177/460 (38.4783%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.4278, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   1, Avg loss: 0.0708, Accuracy: 188/1513 (12.4256%)
_Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   2, Avg loss: 0.0402, Accuracy: 410/1513 (27.0985%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.5465, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1334, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1130, Accuracy: 1/134 (0.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8727, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0912, Accuracy: 3/426 (0.7042%)
_Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0483, Accuracy: 155/426 (36.3850%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.6580, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0679, Accuracy: 263/901 (29.1898%)
_Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0349, Accuracy: 395/901 (43.8402%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.2613, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   1, Avg loss: 0.0684, Accuracy: 212/1131 (18.7445%)
_Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   2, Avg loss: 0.0339, Accuracy: 374/1131 (33.0681%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.8898, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0819, Accuracy: 80/603 (13.2670%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0478, Accuracy: 280/603 (46.4345%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.2127, Accuracy: 64/10000 (0.6400%)
time spent on training: 229.13889503479004
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 813, 1131, 460, 1513, 134, 426, 901, 1131, 603]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 53, 38, 31, 8, 47, 67, 4, 87, 88], weight: tensor([0.1433, 0.0979, 0.1362, 0.0554, 0.1822, 0.0161, 0.0513, 0.1085, 0.1362,
        0.0726])
[rfa agg] iter:  0, prev_obj_val: 54.342430114746094, obj_val: 57.95672607421875, abs dis: 3.6142959594726562
[rfa agg] iter: 0, weight: tensor([0.1093, 0.2264, 0.1232, 0.0449, 0.0809, 0.0066, 0.0355, 0.1577, 0.1276,
        0.0877])
[rfa agg] iter:  1, prev_obj_val: 57.95672607421875, obj_val: 60.1591796875, abs dis: 2.20245361328125
[rfa agg] iter: 1, weight: tensor([0.0956, 0.2637, 0.1053, 0.0532, 0.0737, 0.0071, 0.0409, 0.1403, 0.1080,
        0.1121])
[rfa agg] iter:  2, prev_obj_val: 60.1591796875, obj_val: 62.55249786376953, abs dis: 2.3933181762695312
[rfa agg] iter: 2, weight: tensor([0.0918, 0.2559, 0.1002, 0.0601, 0.0724, 0.0076, 0.0455, 0.1305, 0.1024,
        0.1336])
[rfa agg] iter:  3, prev_obj_val: 62.55249786376953, obj_val: 60.16032409667969, abs dis: 2.3921737670898438
[rfa agg] iter: 3, weight: tensor([0.0896, 0.2281, 0.0971, 0.0692, 0.0721, 0.0082, 0.0513, 0.1232, 0.0990,
        0.1620])
[rfa agg] iter:  4, prev_obj_val: 60.16032409667969, obj_val: 62.55060577392578, abs dis: 2.3902816772460938
[rfa agg] iter: 4, weight: tensor([0.0917, 0.2511, 0.1002, 0.0608, 0.0725, 0.0076, 0.0459, 0.1295, 0.1024,
        0.1383])
[rfa agg] iter:  5, prev_obj_val: 62.55060577392578, obj_val: 60.16054153442383, abs dis: 2.390064239501953
[rfa agg] iter: 5, weight: tensor([0.0896, 0.2275, 0.0972, 0.0692, 0.0722, 0.0082, 0.0514, 0.1232, 0.0990,
        0.1626])
[rfa agg] iter:  6, prev_obj_val: 60.16054153442383, obj_val: 62.55058670043945, abs dis: 2.390045166015625
[rfa agg] iter: 6, weight: tensor([0.0917, 0.2510, 0.1002, 0.0608, 0.0725, 0.0076, 0.0459, 0.1295, 0.1024,
        0.1383])
[rfa agg] iter:  7, prev_obj_val: 62.55058670043945, obj_val: 60.16054153442383, abs dis: 2.390045166015625
[rfa agg] iter: 7, weight: tensor([0.0896, 0.2275, 0.0972, 0.0692, 0.0722, 0.0082, 0.0514, 0.1232, 0.0990,
        0.1626])
[rfa agg] iter:  8, prev_obj_val: 60.16054153442383, obj_val: 62.55058288574219, abs dis: 2.3900413513183594
[rfa agg] iter: 8, weight: tensor([0.0917, 0.2510, 0.1002, 0.0608, 0.0725, 0.0076, 0.0459, 0.1295, 0.1024,
        0.1383])
[rfa agg] iter:  9, prev_obj_val: 62.55058288574219, obj_val: 60.16054153442383, abs dis: 2.3900413513183594
[rfa agg] iter: 9, weight: tensor([0.0896, 0.2275, 0.0972, 0.0692, 0.0722, 0.0082, 0.0514, 0.1232, 0.0990,
        0.1626])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.9317, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 4.9692, Accuracy: 0/9950 (0.0000%)
saving model
Done in 491.5346348285675 sec.
Server Epoch:59 choose agents : [82, 74, 11, 41, 40, 36, 95, 87, 23, 32].
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0852, Accuracy: 26/500 (5.2000%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0546, Accuracy: 191/500 (38.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.5392, Accuracy: 51/10000 (0.5100%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0495, Accuracy: 455/1552 (29.3170%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0230, Accuracy: 718/1552 (46.2629%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 12.2624, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   1, Avg loss: 0.0698, Accuracy: 178/712 (25.0000%)
_Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   2, Avg loss: 0.0263, Accuracy: 425/712 (59.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 11.0086, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   1, Avg loss: 0.0687, Accuracy: 216/719 (30.0417%)
_Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   2, Avg loss: 0.0361, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.9767, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0558, Accuracy: 310/1573 (19.7076%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0354, Accuracy: 544/1573 (34.5836%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1215, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.1046, Accuracy: 2/408 (0.4902%)
_Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0603, Accuracy: 129/408 (31.6176%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1860, Accuracy: 46/10000 (0.4600%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   1, Avg loss: 0.0551, Accuracy: 274/599 (45.7429%)
_Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   2, Avg loss: 0.0329, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 13.7040, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   1, Avg loss: 0.0669, Accuracy: 212/1131 (18.7445%)
_Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   2, Avg loss: 0.0337, Accuracy: 394/1131 (34.8364%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.5561, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0721, Accuracy: 184/715 (25.7343%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0390, Accuracy: 434/715 (60.6993%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.4895, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   1, Avg loss: 0.0611, Accuracy: 154/735 (20.9524%)
_Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 364/735 (49.5238%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 13.3923, Accuracy: 49/10000 (0.4900%)
time spent on training: 234.36163234710693
[rfa agg] training data poison_ratio: 0.2488431281813975  data num: [500, 1552, 712, 719, 1573, 408, 599, 1131, 715, 735]
[rfa agg] considering poison per batch poison_fraction: 0.07776347755668672
[rfa agg] init. name: [82, 74, 11, 41, 40, 36, 95, 87, 23, 32], weight: tensor([0.0578, 0.1795, 0.0824, 0.0832, 0.1820, 0.0472, 0.0693, 0.1308, 0.0827,
        0.0850])
[rfa agg] iter:  0, prev_obj_val: 61.95941162109375, obj_val: 68.19914245605469, abs dis: 6.2397308349609375
[rfa agg] iter: 0, weight: tensor([0.0478, 0.0748, 0.1476, 0.1352, 0.0757, 0.0334, 0.0805, 0.1204, 0.1244,
        0.1602])
[rfa agg] iter:  1, prev_obj_val: 68.19914245605469, obj_val: 68.13612365722656, abs dis: 0.063018798828125
[rfa agg] iter: 1, weight: tensor([0.0672, 0.0541, 0.1551, 0.1357, 0.0547, 0.0439, 0.1173, 0.0744, 0.1256,
        0.1720])
[rfa agg] iter:  2, prev_obj_val: 68.13612365722656, obj_val: 70.490478515625, abs dis: 2.3543548583984375
[rfa agg] iter: 2, weight: tensor([0.0678, 0.0533, 0.1542, 0.1369, 0.0540, 0.0438, 0.1216, 0.0727, 0.1247,
        0.1710])
[rfa agg] iter:  3, prev_obj_val: 70.490478515625, obj_val: 73.1167221069336, abs dis: 2.6262435913085938
[rfa agg] iter: 3, weight: tensor([0.0794, 0.0538, 0.1441, 0.1314, 0.0544, 0.0504, 0.1365, 0.0715, 0.1208,
        0.1575])
[rfa agg] iter:  4, prev_obj_val: 73.1167221069336, obj_val: 73.10990142822266, abs dis: 0.0068206787109375
[rfa agg] iter: 4, weight: tensor([0.0948, 0.0544, 0.1328, 0.1245, 0.0551, 0.0588, 0.1502, 0.0707, 0.1154,
        0.1431])
[rfa agg] iter:  5, prev_obj_val: 73.10990142822266, obj_val: 73.10973358154297, abs dis: 0.0001678466796875
[rfa agg] iter: 5, weight: tensor([0.0959, 0.0543, 0.1314, 0.1241, 0.0550, 0.0591, 0.1538, 0.0705, 0.1145,
        0.1415])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.9590, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 4.7070, Accuracy: 0/9950 (0.0000%)
saving model
Done in 494.49651861190796 sec.
Server Epoch:60 choose agents : [28, 39, 27, 81, 97, 7, 47, 24, 49, 88].
_Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 364/1581 (23.0234%)
_Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   2, Avg loss: 0.0368, Accuracy: 493/1581 (31.1828%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.8410, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   1, Avg loss: 0.0564, Accuracy: 250/1013 (24.6792%)
_Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   2, Avg loss: 0.0288, Accuracy: 450/1013 (44.4225%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.2293, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   1, Avg loss: 0.0673, Accuracy: 381/1587 (24.0076%)
_Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   2, Avg loss: 0.0366, Accuracy: 566/1587 (35.6648%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.2181, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   1, Avg loss: 0.0672, Accuracy: 165/774 (21.3178%)
_Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   2, Avg loss: 0.0388, Accuracy: 345/774 (44.5736%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.7543, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0559, Accuracy: 279/1213 (23.0008%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0294, Accuracy: 501/1213 (41.3026%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.7774, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   1, Avg loss: 0.0645, Accuracy: 279/891 (31.3131%)
_Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   2, Avg loss: 0.0295, Accuracy: 444/891 (49.8316%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.2456, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   1, Avg loss: 0.1299, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   2, Avg loss: 0.1188, Accuracy: 1/134 (0.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 13.2683, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0854, Accuracy: 5/312 (1.6026%)
_Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0460, Accuracy: 132/312 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 11.1358, Accuracy: 50/10000 (0.5000%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   1, Avg loss: 0.0827, Accuracy: 13/440 (2.9545%)
_Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   2, Avg loss: 0.0476, Accuracy: 142/440 (32.2727%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.6582, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0847, Accuracy: 59/603 (9.7844%)
_Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0473, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.5655, Accuracy: 54/10000 (0.5400%)
time spent on training: 197.89708995819092
[rfa agg] training data poison_ratio: 0.05147402901263454  data num: [1581, 1013, 1587, 774, 1213, 891, 134, 312, 440, 603]
[rfa agg] considering poison per batch poison_fraction: 0.016085634066448293
[rfa agg] init. name: [28, 39, 27, 81, 97, 7, 47, 24, 49, 88], weight: tensor([0.1850, 0.1185, 0.1857, 0.0905, 0.1419, 0.1042, 0.0157, 0.0365, 0.0515,
        0.0705])
[rfa agg] iter:  0, prev_obj_val: 59.8679313659668, obj_val: 60.684444427490234, abs dis: 0.8165130615234375
[rfa agg] iter: 0, weight: tensor([0.0917, 0.2560, 0.0923, 0.1273, 0.1625, 0.1607, 0.0056, 0.0162, 0.0285,
        0.0591])
[rfa agg] iter:  1, prev_obj_val: 60.684444427490234, obj_val: 62.00830841064453, abs dis: 1.3238639831542969
[rfa agg] iter: 1, weight: tensor([0.0837, 0.2629, 0.0844, 0.1389, 0.1435, 0.1738, 0.0056, 0.0163, 0.0290,
        0.0619])
[rfa agg] iter:  2, prev_obj_val: 62.00830841064453, obj_val: 60.68389892578125, abs dis: 1.3244094848632812
[rfa agg] iter: 2, weight: tensor([0.0810, 0.2373, 0.0817, 0.1571, 0.1324, 0.1876, 0.0059, 0.0173, 0.0311,
        0.0686])
[rfa agg] iter:  3, prev_obj_val: 60.68389892578125, obj_val: 60.677616119384766, abs dis: 0.006282806396484375
[rfa agg] iter: 3, weight: tensor([0.0835, 0.2572, 0.0842, 0.1415, 0.1419, 0.1789, 0.0056, 0.0163, 0.0290,
        0.0620])
[rfa agg] iter:  4, prev_obj_val: 60.677616119384766, obj_val: 62.007076263427734, abs dis: 1.3294601440429688
[rfa agg] iter: 4, weight: tensor([0.0833, 0.2620, 0.0840, 0.1396, 0.1420, 0.1766, 0.0056, 0.0163, 0.0289,
        0.0618])
[rfa agg] iter:  5, prev_obj_val: 62.007076263427734, obj_val: 60.684059143066406, abs dis: 1.3230171203613281
[rfa agg] iter: 5, weight: tensor([0.0810, 0.2369, 0.0817, 0.1571, 0.1323, 0.1882, 0.0059, 0.0173, 0.0311,
        0.0686])
[rfa agg] iter:  6, prev_obj_val: 60.684059143066406, obj_val: 60.67761993408203, abs dis: 0.006439208984375
[rfa agg] iter: 6, weight: tensor([0.0835, 0.2571, 0.0842, 0.1415, 0.1419, 0.1790, 0.0056, 0.0163, 0.0290,
        0.0620])
[rfa agg] iter:  7, prev_obj_val: 60.67761993408203, obj_val: 62.00706481933594, abs dis: 1.3294448852539062
[rfa agg] iter: 7, weight: tensor([0.0833, 0.2619, 0.0840, 0.1396, 0.1420, 0.1766, 0.0056, 0.0163, 0.0289,
        0.0618])
[rfa agg] iter:  8, prev_obj_val: 62.00706481933594, obj_val: 60.684059143066406, abs dis: 1.3230056762695312
[rfa agg] iter: 8, weight: tensor([0.0810, 0.2369, 0.0817, 0.1571, 0.1323, 0.1882, 0.0059, 0.0173, 0.0311,
        0.0686])
[rfa agg] iter:  9, prev_obj_val: 60.684059143066406, obj_val: 60.67762756347656, abs dis: 0.00643157958984375
[rfa agg] iter: 9, weight: tensor([0.0835, 0.2571, 0.0842, 0.1415, 0.1419, 0.1790, 0.0056, 0.0163, 0.0290,
        0.0620])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.9556, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 4.9529, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 455.76840329170227 sec.
Server Epoch:61 choose agents : [63, 97, 61, 60, 55, 87, 50, 72, 14, 64].
_Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   1, Avg loss: 0.0604, Accuracy: 189/888 (21.2838%)
_Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   2, Avg loss: 0.0281, Accuracy: 438/888 (49.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 11.7835, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   1, Avg loss: 0.0557, Accuracy: 278/1213 (22.9184%)
_Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   2, Avg loss: 0.0294, Accuracy: 460/1213 (37.9225%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.7634, Accuracy: 62/10000 (0.6200%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   1, Avg loss: 0.1474, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   2, Avg loss: 0.1331, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.8897, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   1, Avg loss: 0.0567, Accuracy: 491/2227 (22.0476%)
_Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   2, Avg loss: 0.0307, Accuracy: 908/2227 (40.7723%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.1155, Accuracy: 117/10000 (1.1700%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0583, Accuracy: 258/1071 (24.0896%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0304, Accuracy: 452/1071 (42.2035%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.0125, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   1, Avg loss: 0.0679, Accuracy: 214/1131 (18.9213%)
_Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   2, Avg loss: 0.0338, Accuracy: 384/1131 (33.9523%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.3126, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0694, Accuracy: 108/809 (13.3498%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0302, Accuracy: 315/809 (38.9370%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 11.2570, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   1, Avg loss: 0.0670, Accuracy: 210/1241 (16.9218%)
_Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   2, Avg loss: 0.0398, Accuracy: 411/1241 (33.1185%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.5909, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   1, Avg loss: 0.0668, Accuracy: 168/1013 (16.5844%)
_Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   2, Avg loss: 0.0377, Accuracy: 333/1013 (32.8727%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.1241, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   1, Avg loss: 0.0735, Accuracy: 118/953 (12.3820%)
_Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   2, Avg loss: 0.0416, Accuracy: 301/953 (31.5845%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.8678, Accuracy: 66/10000 (0.6600%)
time spent on training: 266.55942153930664
[rfa agg] training data poison_ratio: 0.1087385946759477  data num: [888, 1213, 85, 2227, 1071, 1131, 809, 1241, 1013, 953]
[rfa agg] considering poison per batch poison_fraction: 0.03398081083623365
[rfa agg] init. name: [63, 97, 61, 60, 55, 87, 50, 72, 14, 64], weight: tensor([0.0835, 0.1141, 0.0080, 0.2095, 0.1007, 0.1064, 0.0761, 0.1167, 0.0953,
        0.0896])
[rfa agg] iter:  0, prev_obj_val: 59.28146743774414, obj_val: 65.53401184082031, abs dis: 6.252544403076172
[rfa agg] iter: 0, weight: tensor([0.0741, 0.1550, 0.0019, 0.0513, 0.1370, 0.1621, 0.0573, 0.1419, 0.1213,
        0.0981])
[rfa agg] iter:  1, prev_obj_val: 65.53401184082031, obj_val: 65.37324523925781, abs dis: 0.1607666015625
[rfa agg] iter: 1, weight: tensor([0.1250, 0.0992, 0.0023, 0.0434, 0.1220, 0.1133, 0.0999, 0.0868, 0.1461,
        0.1621])
[rfa agg] iter:  2, prev_obj_val: 65.37324523925781, obj_val: 67.70549011230469, abs dis: 2.332244873046875
[rfa agg] iter: 2, weight: tensor([0.1307, 0.0946, 0.0022, 0.0424, 0.1179, 0.1084, 0.1012, 0.0841, 0.1479,
        0.1706])
[rfa agg] iter:  3, prev_obj_val: 67.70549011230469, obj_val: 65.37542724609375, abs dis: 2.3300628662109375
[rfa agg] iter: 3, weight: tensor([0.1435, 0.0897, 0.0024, 0.0426, 0.1113, 0.1017, 0.1155, 0.0803, 0.1405,
        0.1726])
[rfa agg] iter:  4, prev_obj_val: 65.37542724609375, obj_val: 70.37081909179688, abs dis: 4.995391845703125
[rfa agg] iter: 4, weight: tensor([0.1332, 0.0937, 0.0022, 0.0422, 0.1164, 0.1075, 0.1022, 0.0838, 0.1467,
        0.1722])
[rfa agg] iter:  5, prev_obj_val: 70.37081909179688, obj_val: 63.424190521240234, abs dis: 6.946628570556641
[rfa agg] iter: 5, weight: tensor([0.1533, 0.0867, 0.0025, 0.0434, 0.1064, 0.0972, 0.1317, 0.0780, 0.1330,
        0.1678])
[rfa agg] iter:  6, prev_obj_val: 63.424190521240234, obj_val: 67.71525573730469, abs dis: 4.291065216064453
[rfa agg] iter: 6, weight: tensor([0.1214, 0.0998, 0.0021, 0.0425, 0.1227, 0.1156, 0.0911, 0.0891, 0.1515,
        0.1641])
[rfa agg] iter:  7, prev_obj_val: 67.71525573730469, obj_val: 70.36133575439453, abs dis: 2.6460800170898438
[rfa agg] iter: 7, weight: tensor([0.1421, 0.0902, 0.0024, 0.0427, 0.1120, 0.1023, 0.1148, 0.0806, 0.1412,
        0.1718])
[rfa agg] iter:  8, prev_obj_val: 70.36133575439453, obj_val: 63.42677688598633, abs dis: 6.934558868408203
[rfa agg] iter: 8, weight: tensor([0.1549, 0.0863, 0.0025, 0.0432, 0.1058, 0.0968, 0.1331, 0.0778, 0.1322,
        0.1673])
[rfa agg] iter:  9, prev_obj_val: 63.42677688598633, obj_val: 67.7151107788086, abs dis: 4.288333892822266
[rfa agg] iter: 9, weight: tensor([0.1216, 0.0997, 0.0021, 0.0425, 0.1226, 0.1156, 0.0912, 0.0891, 0.1514,
        0.1640])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.9637, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.2430, Accuracy: 0/9950 (0.0000%)
saving model
Done in 514.8392770290375 sec.
Server Epoch:62 choose agents : [82, 13, 98, 85, 60, 29, 45, 7, 66, 63].
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0853, Accuracy: 21/500 (4.2000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0547, Accuracy: 181/500 (36.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.6214, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0647, Accuracy: 274/1645 (16.6565%)
_Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0356, Accuracy: 563/1645 (34.2249%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.0780, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   1, Avg loss: 0.0835, Accuracy: 11/373 (2.9491%)
_Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   2, Avg loss: 0.0478, Accuracy: 133/373 (35.6568%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.5396, Accuracy: 49/10000 (0.4900%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   1, Avg loss: 0.0574, Accuracy: 376/1988 (18.9135%)
_Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   2, Avg loss: 0.0377, Accuracy: 645/1988 (32.4447%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.5039, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0581, Accuracy: 447/2227 (20.0718%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0307, Accuracy: 887/2227 (39.8294%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.0385, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0632, Accuracy: 328/1440 (22.7778%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0299, Accuracy: 638/1440 (44.3056%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.1679, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   1, Avg loss: 0.0878, Accuracy: 84/669 (12.5561%)
_Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   2, Avg loss: 0.0490, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9347, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   1, Avg loss: 0.0612, Accuracy: 289/891 (32.4355%)
_Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   2, Avg loss: 0.0297, Accuracy: 429/891 (48.1481%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.1335, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   1, Avg loss: 0.0695, Accuracy: 191/1402 (13.6234%)
_Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   2, Avg loss: 0.0415, Accuracy: 343/1402 (24.4650%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.5202, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0596, Accuracy: 192/888 (21.6216%)
_Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0282, Accuracy: 420/888 (47.2973%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 11.6436, Accuracy: 71/10000 (0.7100%)
time spent on training: 310.7202296257019
[rfa agg] training data poison_ratio: 0.16534974631955418  data num: [500, 1645, 373, 1988, 2227, 1440, 669, 891, 1402, 888]
[rfa agg] considering poison per batch poison_fraction: 0.05167179572486068
[rfa agg] init. name: [82, 13, 98, 85, 60, 29, 45, 7, 66, 63], weight: tensor([0.0416, 0.1368, 0.0310, 0.1653, 0.1852, 0.1198, 0.0556, 0.0741, 0.1166,
        0.0739])
[rfa agg] iter:  0, prev_obj_val: 78.195556640625, obj_val: 80.06175231933594, abs dis: 1.8661956787109375
[rfa agg] iter: 0, weight: tensor([0.0182, 0.1601, 0.0118, 0.0937, 0.0863, 0.2449, 0.0307, 0.0545, 0.2457,
        0.0541])
[rfa agg] iter:  1, prev_obj_val: 80.06175231933594, obj_val: 83.00226593017578, abs dis: 2.9405136108398438
[rfa agg] iter: 1, weight: tensor([0.0197, 0.1423, 0.0126, 0.0864, 0.0810, 0.2364, 0.0339, 0.0622, 0.2643,
        0.0613])
[rfa agg] iter:  2, prev_obj_val: 83.00226593017578, obj_val: 81.4602279663086, abs dis: 1.5420379638671875
[rfa agg] iter: 2, weight: tensor([0.0232, 0.1357, 0.0147, 0.0877, 0.0829, 0.2110, 0.0408, 0.0775, 0.2504,
        0.0761])
[rfa agg] iter:  3, prev_obj_val: 81.4602279663086, obj_val: 82.99665069580078, abs dis: 1.5364227294921875
[rfa agg] iter: 3, weight: tensor([0.0214, 0.1383, 0.0137, 0.0870, 0.0819, 0.2205, 0.0372, 0.0696, 0.2618,
        0.0686])
[rfa agg] iter:  4, prev_obj_val: 82.99665069580078, obj_val: 81.46029663085938, abs dis: 1.5363540649414062
[rfa agg] iter: 4, weight: tensor([0.0233, 0.1357, 0.0147, 0.0878, 0.0829, 0.2097, 0.0408, 0.0777, 0.2511,
        0.0763])
[rfa agg] iter:  5, prev_obj_val: 81.46029663085938, obj_val: 82.99665832519531, abs dis: 1.5363616943359375
[rfa agg] iter: 5, weight: tensor([0.0214, 0.1383, 0.0137, 0.0870, 0.0819, 0.2203, 0.0372, 0.0696, 0.2620,
        0.0686])
[rfa agg] iter:  6, prev_obj_val: 82.99665832519531, obj_val: 81.46029663085938, abs dis: 1.5363616943359375
[rfa agg] iter: 6, weight: tensor([0.0233, 0.1357, 0.0147, 0.0878, 0.0829, 0.2097, 0.0408, 0.0777, 0.2511,
        0.0763])
[rfa agg] iter:  7, prev_obj_val: 81.46029663085938, obj_val: 82.99665069580078, abs dis: 1.5363540649414062
[rfa agg] iter: 7, weight: tensor([0.0214, 0.1383, 0.0137, 0.0870, 0.0819, 0.2203, 0.0372, 0.0696, 0.2620,
        0.0686])
[rfa agg] iter:  8, prev_obj_val: 82.99665069580078, obj_val: 81.46029663085938, abs dis: 1.5363540649414062
[rfa agg] iter: 8, weight: tensor([0.0233, 0.1357, 0.0147, 0.0878, 0.0829, 0.2097, 0.0408, 0.0777, 0.2511,
        0.0763])
[rfa agg] iter:  9, prev_obj_val: 81.46029663085938, obj_val: 82.99665832519531, abs dis: 1.5363616943359375
[rfa agg] iter: 9, weight: tensor([0.0214, 0.1383, 0.0137, 0.0870, 0.0819, 0.2203, 0.0372, 0.0696, 0.2620,
        0.0686])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.9834, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 4.9340, Accuracy: 0/9950 (0.0000%)
saving model
Done in 568.695499420166 sec.
Server Epoch:63 choose agents : [14, 81, 97, 91, 28, 94, 4, 35, 25, 39].
_Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   1, Avg loss: 0.0669, Accuracy: 155/1013 (15.3011%)
_Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   2, Avg loss: 0.0369, Accuracy: 342/1013 (33.7611%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.5736, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   1, Avg loss: 0.0719, Accuracy: 149/774 (19.2506%)
_Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   2, Avg loss: 0.0405, Accuracy: 303/774 (39.1473%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.5580, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   1, Avg loss: 0.0555, Accuracy: 289/1213 (23.8252%)
_Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   2, Avg loss: 0.0291, Accuracy: 473/1213 (38.9942%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.5836, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   1, Avg loss: 0.0570, Accuracy: 263/1030 (25.5340%)
_Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   2, Avg loss: 0.0275, Accuracy: 596/1030 (57.8641%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 11.0816, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   1, Avg loss: 0.0569, Accuracy: 325/1581 (20.5566%)
_Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   2, Avg loss: 0.0369, Accuracy: 498/1581 (31.4991%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.8385, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0707, Accuracy: 222/1662 (13.3574%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0374, Accuracy: 517/1662 (31.1071%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.2603, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0671, Accuracy: 255/901 (28.3019%)
_Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0379, Accuracy: 425/901 (47.1698%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.0432, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.1136, Accuracy: 4/271 (1.4760%)
_Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0755, Accuracy: 59/271 (21.7712%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.7081, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0549, Accuracy: 264/690 (38.2609%)
_Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0291, Accuracy: 452/690 (65.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.7393, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   1, Avg loss: 0.0576, Accuracy: 240/1013 (23.6920%)
_Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   2, Avg loss: 0.0292, Accuracy: 467/1013 (46.1007%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.1603, Accuracy: 71/10000 (0.7100%)
time spent on training: 230.22101497650146
[rfa agg] training data poison_ratio: 0.06799369333858889  data num: [1013, 774, 1213, 1030, 1581, 1662, 901, 271, 690, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.021248029168309028
[rfa agg] init. name: [14, 81, 97, 91, 28, 94, 4, 35, 25, 39], weight: tensor([0.0998, 0.0763, 0.1195, 0.1015, 0.1558, 0.1638, 0.0888, 0.0267, 0.0680,
        0.0998])
[rfa agg] iter:  0, prev_obj_val: 53.084617614746094, obj_val: 57.56787872314453, abs dis: 4.4832611083984375
[rfa agg] iter: 0, weight: tensor([0.1654, 0.0813, 0.1263, 0.1081, 0.0721, 0.0700, 0.1280, 0.0102, 0.0549,
        0.1836])
[rfa agg] iter:  1, prev_obj_val: 57.56787872314453, obj_val: 57.54816436767578, abs dis: 0.01971435546875
[rfa agg] iter: 1, weight: tensor([0.1581, 0.1093, 0.1038, 0.1003, 0.0646, 0.0633, 0.1435, 0.0120, 0.0747,
        0.1704])
[rfa agg] iter:  2, prev_obj_val: 57.54816436767578, obj_val: 57.5479736328125, abs dis: 0.00019073486328125
[rfa agg] iter: 2, weight: tensor([0.1570, 0.1114, 0.1027, 0.0995, 0.0644, 0.0631, 0.1464, 0.0120, 0.0749,
        0.1686])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.9618, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.5843, Accuracy: 0/9950 (0.0000%)
saving model
Done in 477.87719535827637 sec.
Server Epoch:64 choose agents : [81, 71, 22, 76, 45, 30, 66, 5, 69, 70].
_Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0706, Accuracy: 161/774 (20.8010%)
_Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0400, Accuracy: 312/774 (40.3101%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.2530, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0673, Accuracy: 118/818 (14.4254%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0337, Accuracy: 324/818 (39.6088%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.2537, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0561, Accuracy: 363/1470 (24.6939%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0254, Accuracy: 752/1470 (51.1565%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.2712, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0953, Accuracy: 17/466 (3.6481%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0510, Accuracy: 160/466 (34.3348%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.9693, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.0880, Accuracy: 84/669 (12.5561%)
_Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0467, Accuracy: 352/669 (52.6158%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.0992, Accuracy: 66/10000 (0.6600%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.0858, Accuracy: 30/486 (6.1728%)
_Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0444, Accuracy: 208/486 (42.7984%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.1383, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   1, Avg loss: 0.0683, Accuracy: 205/1402 (14.6220%)
_Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   2, Avg loss: 0.0410, Accuracy: 347/1402 (24.7504%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.4814, Accuracy: 68/10000 (0.6800%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   1, Avg loss: 0.0569, Accuracy: 323/1628 (19.8403%)
_Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   2, Avg loss: 0.0271, Accuracy: 764/1628 (46.9287%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.1565, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   1, Avg loss: 0.0638, Accuracy: 185/590 (31.3559%)
_Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   2, Avg loss: 0.0331, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 12.9642, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0691, Accuracy: 237/1418 (16.7137%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0354, Accuracy: 547/1418 (38.5755%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.1233, Accuracy: 86/10000 (0.8600%)
time spent on training: 241.30440497398376
[rfa agg] training data poison_ratio: 0.21746733875115729  data num: [774, 818, 1470, 466, 669, 486, 1402, 1628, 590, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.06795854335973665
[rfa agg] init. name: [81, 71, 22, 76, 45, 30, 66, 5, 69, 70], weight: tensor([0.0796, 0.0841, 0.1512, 0.0479, 0.0688, 0.0500, 0.1442, 0.1675, 0.0607,
        0.1459])
[rfa agg] iter:  0, prev_obj_val: 65.3420639038086, obj_val: 67.40385437011719, abs dis: 2.0617904663085938
[rfa agg] iter: 0, weight: tensor([0.1302, 0.1408, 0.1308, 0.0381, 0.0804, 0.0397, 0.1427, 0.1080, 0.0632,
        0.1262])
[rfa agg] iter:  1, prev_obj_val: 67.40385437011719, obj_val: 69.90284729003906, abs dis: 2.498992919921875
[rfa agg] iter: 1, weight: tensor([0.1542, 0.1702, 0.1107, 0.0409, 0.0906, 0.0427, 0.1197, 0.0935, 0.0702,
        0.1073])
[rfa agg] iter:  2, prev_obj_val: 69.90284729003906, obj_val: 69.87483978271484, abs dis: 0.02800750732421875
[rfa agg] iter: 2, weight: tensor([0.1746, 0.1964, 0.0924, 0.0434, 0.1018, 0.0454, 0.0987, 0.0798, 0.0780,
        0.0896])
[rfa agg] iter:  3, prev_obj_val: 69.87483978271484, obj_val: 69.87455749511719, abs dis: 0.00028228759765625
[rfa agg] iter: 3, weight: tensor([0.1780, 0.2003, 0.0909, 0.0430, 0.1017, 0.0450, 0.0969, 0.0787, 0.0772,
        0.0882])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.9675, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.8088, Accuracy: 0/9950 (0.0000%)
saving model
Done in 501.1936719417572 sec.
Server Epoch:65 choose agents : [78, 89, 90, 16, 68, 76, 57, 27, 83, 41].
_Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   1, Avg loss: 0.0848, Accuracy: 17/416 (4.0865%)
_Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   2, Avg loss: 0.0491, Accuracy: 166/416 (39.9038%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.0689, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   1, Avg loss: 0.0757, Accuracy: 221/896 (24.6652%)
_Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   2, Avg loss: 0.0400, Accuracy: 443/896 (49.4420%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.7890, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   1, Avg loss: 0.0642, Accuracy: 225/677 (33.2349%)
_Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   2, Avg loss: 0.0258, Accuracy: 442/677 (65.2880%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 11.9587, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   1, Avg loss: 0.0747, Accuracy: 170/708 (24.0113%)
_Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   2, Avg loss: 0.0448, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.7183, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0618, Accuracy: 325/1163 (27.9450%)
_Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0387, Accuracy: 462/1163 (39.7248%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.7566, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0942, Accuracy: 14/466 (3.0043%)
_Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0493, Accuracy: 159/466 (34.1202%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.3880, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0671, Accuracy: 245/1154 (21.2305%)
_Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0323, Accuracy: 480/1154 (41.5945%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.6536, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0660, Accuracy: 365/1587 (22.9994%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0372, Accuracy: 562/1587 (35.4127%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.7876, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0657, Accuracy: 292/1953 (14.9514%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0359, Accuracy: 700/1953 (35.8423%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.8071, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   1, Avg loss: 0.0624, Accuracy: 232/719 (32.2670%)
_Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   2, Avg loss: 0.0328, Accuracy: 449/719 (62.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.8902, Accuracy: 57/10000 (0.5700%)
time spent on training: 259.6362681388855
[rfa agg] training data poison_ratio: 0.0  data num: [416, 896, 677, 708, 1163, 466, 1154, 1587, 1953, 719]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [78, 89, 90, 16, 68, 76, 57, 27, 83, 41], weight: tensor([0.0427, 0.0920, 0.0695, 0.0727, 0.1194, 0.0478, 0.1185, 0.1630, 0.2005,
        0.0738])
[rfa agg] iter:  0, prev_obj_val: 70.1758804321289, obj_val: 71.54004669189453, abs dis: 1.364166259765625
[rfa agg] iter: 0, weight: tensor([0.0266, 0.1586, 0.0722, 0.0843, 0.1800, 0.0333, 0.1611, 0.1129, 0.0839,
        0.0870])
[rfa agg] iter:  1, prev_obj_val: 71.54004669189453, obj_val: 75.04288482666016, abs dis: 3.502838134765625
[rfa agg] iter: 1, weight: tensor([0.0281, 0.1931, 0.0810, 0.0956, 0.1546, 0.0356, 0.1397, 0.0973, 0.0749,
        0.1001])
[rfa agg] iter:  2, prev_obj_val: 75.04288482666016, obj_val: 76.51565551757812, abs dis: 1.4727706909179688
[rfa agg] iter: 2, weight: tensor([0.0311, 0.2236, 0.1012, 0.1166, 0.1131, 0.0403, 0.1053, 0.0791, 0.0639,
        0.1258])
[rfa agg] iter:  3, prev_obj_val: 76.51565551757812, obj_val: 80.23052215576172, abs dis: 3.7148666381835938
[rfa agg] iter: 3, weight: tensor([0.0323, 0.2223, 0.1112, 0.1248, 0.1010, 0.0423, 0.0945, 0.0735, 0.0602,
        0.1380])
[rfa agg] iter:  4, prev_obj_val: 80.23052215576172, obj_val: 78.24964904785156, abs dis: 1.9808731079101562
[rfa agg] iter: 4, weight: tensor([0.0365, 0.1849, 0.1384, 0.1392, 0.0872, 0.0489, 0.0825, 0.0670, 0.0563,
        0.1591])
[rfa agg] iter:  5, prev_obj_val: 78.24964904785156, obj_val: 80.207763671875, abs dis: 1.9581146240234375
[rfa agg] iter: 5, weight: tensor([0.0342, 0.1964, 0.1276, 0.1354, 0.0927, 0.0453, 0.0870, 0.0696, 0.0578,
        0.1540])
[rfa agg] iter:  6, prev_obj_val: 80.207763671875, obj_val: 78.2513198852539, abs dis: 1.9564437866210938
[rfa agg] iter: 6, weight: tensor([0.0365, 0.1801, 0.1409, 0.1406, 0.0867, 0.0489, 0.0820, 0.0666, 0.0560,
        0.1617])
[rfa agg] iter:  7, prev_obj_val: 78.2513198852539, obj_val: 80.20745849609375, abs dis: 1.9561386108398438
[rfa agg] iter: 7, weight: tensor([0.0343, 0.1954, 0.1279, 0.1356, 0.0927, 0.0453, 0.0870, 0.0696, 0.0578,
        0.1544])
[rfa agg] iter:  8, prev_obj_val: 80.20745849609375, obj_val: 78.2513656616211, abs dis: 1.9560928344726562
[rfa agg] iter: 8, weight: tensor([0.0365, 0.1799, 0.1410, 0.1406, 0.0867, 0.0489, 0.0820, 0.0666, 0.0560,
        0.1618])
[rfa agg] iter:  9, prev_obj_val: 78.2513656616211, obj_val: 80.20743560791016, abs dis: 1.9560699462890625
[rfa agg] iter: 9, weight: tensor([0.0343, 0.1954, 0.1279, 0.1356, 0.0927, 0.0454, 0.0870, 0.0696, 0.0578,
        0.1544])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.0196, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 6.0943, Accuracy: 0/9950 (0.0000%)
saving model
Done in 514.1688871383667 sec.
Server Epoch:66 choose agents : [38, 88, 33, 43, 14, 18, 98, 35, 78, 86].
_Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   1, Avg loss: 0.0701, Accuracy: 175/1131 (15.4730%)
_Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   2, Avg loss: 0.0324, Accuracy: 451/1131 (39.8762%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.6575, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0907, Accuracy: 35/603 (5.8043%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0502, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.1079, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   1, Avg loss: 0.0943, Accuracy: 17/515 (3.3010%)
_Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   2, Avg loss: 0.0586, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.4256, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   1, Avg loss: 0.0745, Accuracy: 173/946 (18.2875%)
_Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   2, Avg loss: 0.0401, Accuracy: 348/946 (36.7865%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.3756, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   1, Avg loss: 0.0674, Accuracy: 175/1013 (17.2754%)
_Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   2, Avg loss: 0.0378, Accuracy: 350/1013 (34.5508%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.3150, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0833, Accuracy: 76/530 (14.3396%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0428, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 10.3253, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   1, Avg loss: 0.0865, Accuracy: 3/373 (0.8043%)
_Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   2, Avg loss: 0.0510, Accuracy: 134/373 (35.9249%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.7718, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   1, Avg loss: 0.1119, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   2, Avg loss: 0.0766, Accuracy: 65/271 (23.9852%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.8988, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0847, Accuracy: 18/416 (4.3269%)
_Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0501, Accuracy: 170/416 (40.8654%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.5268, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0617, Accuracy: 313/1003 (31.2064%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0367, Accuracy: 401/1003 (39.9801%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.2313, Accuracy: 51/10000 (0.5100%)
time spent on training: 197.31248354911804
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 603, 515, 946, 1013, 530, 373, 271, 416, 1003]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 88, 33, 43, 14, 18, 98, 35, 78, 86], weight: tensor([0.1663, 0.0887, 0.0757, 0.1391, 0.1489, 0.0779, 0.0548, 0.0398, 0.0612,
        0.1475])
[rfa agg] iter:  0, prev_obj_val: 48.93707275390625, obj_val: 50.48264694213867, abs dis: 1.5455741882324219
[rfa agg] iter: 0, weight: tensor([0.0867, 0.1994, 0.1085, 0.1124, 0.1033, 0.1372, 0.0488, 0.0297, 0.0726,
        0.1014])
[rfa agg] iter:  1, prev_obj_val: 50.48264694213867, obj_val: 54.883766174316406, abs dis: 4.401119232177734
[rfa agg] iter: 1, weight: tensor([0.0778, 0.2143, 0.1135, 0.0991, 0.0916, 0.1518, 0.0517, 0.0310, 0.0793,
        0.0900])
[rfa agg] iter:  2, prev_obj_val: 54.883766174316406, obj_val: 57.453712463378906, abs dis: 2.5699462890625
[rfa agg] iter: 2, weight: tensor([0.0739, 0.1773, 0.1199, 0.0898, 0.0845, 0.1625, 0.0650, 0.0382, 0.1058,
        0.0831])
[rfa agg] iter:  3, prev_obj_val: 57.453712463378906, obj_val: 57.444969177246094, abs dis: 0.0087432861328125
[rfa agg] iter: 3, weight: tensor([0.0729, 0.1546, 0.1196, 0.0867, 0.0822, 0.1589, 0.0751, 0.0434, 0.1259,
        0.0809])
[rfa agg] iter:  4, prev_obj_val: 57.444969177246094, obj_val: 57.44483947753906, abs dis: 0.00012969970703125
[rfa agg] iter: 4, weight: tensor([0.0726, 0.1521, 0.1194, 0.0863, 0.0819, 0.1586, 0.0760, 0.0437, 0.1290,
        0.0805])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.0728, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 6.6712, Accuracy: 0/9950 (0.0000%)
saving model
Done in 451.7348017692566 sec.
Server Epoch:67 choose agents : [94, 13, 95, 73, 30, 22, 25, 10, 86, 8].
_Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0709, Accuracy: 228/1662 (13.7184%)
_Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0388, Accuracy: 492/1662 (29.6029%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.8586, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0657, Accuracy: 260/1645 (15.8055%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0353, Accuracy: 581/1645 (35.3191%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.2454, Accuracy: 98/10000 (0.9800%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0500, Accuracy: 280/599 (46.7446%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 13.3094, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0678, Accuracy: 177/938 (18.8699%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0359, Accuracy: 303/938 (32.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.3633, Accuracy: 65/10000 (0.6500%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   1, Avg loss: 0.0848, Accuracy: 27/486 (5.5556%)
_Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   2, Avg loss: 0.0432, Accuracy: 223/486 (45.8848%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.9792, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   1, Avg loss: 0.0569, Accuracy: 394/1470 (26.8027%)
_Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   2, Avg loss: 0.0258, Accuracy: 785/1470 (53.4014%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.3627, Accuracy: 95/10000 (0.9500%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   1, Avg loss: 0.0583, Accuracy: 243/690 (35.2174%)
_Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   2, Avg loss: 0.0306, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.6215, Accuracy: 72/10000 (0.7200%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   1, Avg loss: 0.0618, Accuracy: 158/861 (18.3508%)
_Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   2, Avg loss: 0.0224, Accuracy: 442/861 (51.3357%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 12.3335, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0613, Accuracy: 317/1003 (31.6052%)
_Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0366, Accuracy: 394/1003 (39.2822%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.7162, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   1, Avg loss: 0.0728, Accuracy: 140/1513 (9.2531%)
_Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   2, Avg loss: 0.0412, Accuracy: 391/1513 (25.8427%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.7067, Accuracy: 85/10000 (0.8500%)
time spent on training: 286.31512808799744
[rfa agg] training data poison_ratio: 0.24256924634213675  data num: [1662, 1645, 599, 938, 486, 1470, 690, 861, 1003, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.07580288948191774
[rfa agg] init. name: [94, 13, 95, 73, 30, 22, 25, 10, 86, 8], weight: tensor([0.1529, 0.1514, 0.0551, 0.0863, 0.0447, 0.1353, 0.0635, 0.0792, 0.0923,
        0.1392])
[rfa agg] iter:  0, prev_obj_val: 62.502593994140625, obj_val: 64.68431854248047, abs dis: 2.1817245483398438
[rfa agg] iter: 0, weight: tensor([0.0926, 0.0914, 0.0424, 0.1537, 0.0275, 0.1168, 0.0560, 0.1138, 0.1988,
        0.1070])
[rfa agg] iter:  1, prev_obj_val: 64.68431854248047, obj_val: 67.87982940673828, abs dis: 3.1955108642578125
[rfa agg] iter: 1, weight: tensor([0.0768, 0.0758, 0.0446, 0.1796, 0.0279, 0.0944, 0.0594, 0.1311, 0.2234,
        0.0870])
[rfa agg] iter:  2, prev_obj_val: 67.87982940673828, obj_val: 69.82801055908203, abs dis: 1.94818115234375
[rfa agg] iter: 2, weight: tensor([0.0687, 0.0679, 0.0506, 0.1960, 0.0307, 0.0820, 0.0683, 0.1556, 0.2041,
        0.0763])
[rfa agg] iter:  3, prev_obj_val: 69.82801055908203, obj_val: 72.01441192626953, abs dis: 2.1864013671875
[rfa agg] iter: 3, weight: tensor([0.0665, 0.0657, 0.0554, 0.1979, 0.0330, 0.0783, 0.0755, 0.1714, 0.1830,
        0.0733])
[rfa agg] iter:  4, prev_obj_val: 72.01441192626953, obj_val: 69.8248519897461, abs dis: 2.1895599365234375
[rfa agg] iter: 4, weight: tensor([0.0655, 0.0647, 0.0618, 0.1907, 0.0361, 0.0762, 0.0850, 0.1831, 0.1654,
        0.0716])
[rfa agg] iter:  5, prev_obj_val: 69.8248519897461, obj_val: 72.01299285888672, abs dis: 2.188140869140625
[rfa agg] iter: 5, weight: tensor([0.0664, 0.0656, 0.0554, 0.1979, 0.0330, 0.0781, 0.0759, 0.1771, 0.1775,
        0.0731])
[rfa agg] iter:  6, prev_obj_val: 72.01299285888672, obj_val: 69.82501220703125, abs dis: 2.1879806518554688
[rfa agg] iter: 6, weight: tensor([0.0655, 0.0647, 0.0617, 0.1907, 0.0360, 0.0761, 0.0849, 0.1842, 0.1647,
        0.0715])
[rfa agg] iter:  7, prev_obj_val: 69.82501220703125, obj_val: 72.01296997070312, abs dis: 2.187957763671875
[rfa agg] iter: 7, weight: tensor([0.0664, 0.0656, 0.0554, 0.1979, 0.0330, 0.0781, 0.0759, 0.1773, 0.1774,
        0.0731])
[rfa agg] iter:  8, prev_obj_val: 72.01296997070312, obj_val: 69.82501220703125, abs dis: 2.187957763671875
[rfa agg] iter: 8, weight: tensor([0.0655, 0.0647, 0.0617, 0.1906, 0.0360, 0.0761, 0.0849, 0.1843, 0.1646,
        0.0715])
[rfa agg] iter:  9, prev_obj_val: 69.82501220703125, obj_val: 72.0129623413086, abs dis: 2.1879501342773438
[rfa agg] iter: 9, weight: tensor([0.0664, 0.0656, 0.0554, 0.1979, 0.0330, 0.0781, 0.0759, 0.1773, 0.1774,
        0.0731])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.0921, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 6.5394, Accuracy: 0/9950 (0.0000%)
saving model
Done in 540.3167669773102 sec.
Server Epoch:68 choose agents : [83, 52, 97, 44, 67, 7, 87, 76, 46, 17].
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0655, Accuracy: 331/1953 (16.9483%)
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0365, Accuracy: 670/1953 (34.3062%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3922, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0649, Accuracy: 163/636 (25.6289%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0323, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 11.0087, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   1, Avg loss: 0.0541, Accuracy: 297/1213 (24.4847%)
_Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   2, Avg loss: 0.0281, Accuracy: 518/1213 (42.7040%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.0615, Accuracy: 65/10000 (0.6500%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0687, Accuracy: 337/1750 (19.2571%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0379, Accuracy: 646/1750 (36.9143%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1267, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   1, Avg loss: 0.0961, Accuracy: 3/426 (0.7042%)
_Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   2, Avg loss: 0.0499, Accuracy: 140/426 (32.8638%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.9827, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   1, Avg loss: 0.0610, Accuracy: 269/891 (30.1908%)
_Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   2, Avg loss: 0.0285, Accuracy: 446/891 (50.0561%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.5782, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0654, Accuracy: 200/1131 (17.6835%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0349, Accuracy: 381/1131 (33.6870%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.0985, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   1, Avg loss: 0.0965, Accuracy: 19/466 (4.0773%)
_Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   2, Avg loss: 0.0487, Accuracy: 154/466 (33.0472%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.5987, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   1, Avg loss: 0.0612, Accuracy: 353/1904 (18.5399%)
_Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   2, Avg loss: 0.0326, Accuracy: 685/1904 (35.9769%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.7117, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0557, Accuracy: 313/1574 (19.8856%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0294, Accuracy: 606/1574 (38.5006%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.8499, Accuracy: 112/10000 (1.1200%)
time spent on training: 279.91030406951904
[rfa agg] training data poison_ratio: 0.14651707970529135  data num: [1953, 636, 1213, 1750, 426, 891, 1131, 466, 1904, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.04578658740790355
[rfa agg] init. name: [83, 52, 97, 44, 67, 7, 87, 76, 46, 17], weight: tensor([0.1635, 0.0532, 0.1016, 0.1465, 0.0357, 0.0746, 0.0947, 0.0390, 0.1594,
        0.1318])
[rfa agg] iter:  0, prev_obj_val: 72.00409698486328, obj_val: 75.3508071899414, abs dis: 3.346710205078125
[rfa agg] iter: 0, weight: tensor([0.1056, 0.0317, 0.1823, 0.1276, 0.0169, 0.0664, 0.1583, 0.0200, 0.1147,
        0.1764])
[rfa agg] iter:  1, prev_obj_val: 75.3508071899414, obj_val: 76.74352264404297, abs dis: 1.3927154541015625
[rfa agg] iter: 1, weight: tensor([0.0883, 0.0345, 0.2223, 0.1032, 0.0179, 0.0764, 0.2035, 0.0215, 0.0947,
        0.1377])
[rfa agg] iter:  2, prev_obj_val: 76.74352264404297, obj_val: 75.30496215820312, abs dis: 1.4385604858398438
[rfa agg] iter: 2, weight: tensor([0.0827, 0.0353, 0.2302, 0.0955, 0.0182, 0.0799, 0.2236, 0.0218, 0.0884,
        0.1244])
[rfa agg] iter:  3, prev_obj_val: 75.30496215820312, obj_val: 76.74055480957031, abs dis: 1.4355926513671875
[rfa agg] iter: 3, weight: tensor([0.0863, 0.0338, 0.2290, 0.1005, 0.0176, 0.0749, 0.2110, 0.0210, 0.0926,
        0.1332])
[rfa agg] iter:  4, prev_obj_val: 76.74055480957031, obj_val: 75.30516815185547, abs dis: 1.4353866577148438
[rfa agg] iter: 4, weight: tensor([0.0825, 0.0352, 0.2313, 0.0952, 0.0181, 0.0796, 0.2243, 0.0218, 0.0881,
        0.1239])
[rfa agg] iter:  5, prev_obj_val: 75.30516815185547, obj_val: 76.74052429199219, abs dis: 1.4353561401367188
[rfa agg] iter: 5, weight: tensor([0.0863, 0.0338, 0.2292, 0.1005, 0.0176, 0.0748, 0.2111, 0.0210, 0.0925,
        0.1332])
[rfa agg] iter:  6, prev_obj_val: 76.74052429199219, obj_val: 75.30516815185547, abs dis: 1.4353561401367188
[rfa agg] iter: 6, weight: tensor([0.0825, 0.0352, 0.2313, 0.0952, 0.0181, 0.0796, 0.2243, 0.0218, 0.0881,
        0.1239])
[rfa agg] iter:  7, prev_obj_val: 75.30516815185547, obj_val: 76.74052429199219, abs dis: 1.4353561401367188
[rfa agg] iter: 7, weight: tensor([0.0863, 0.0338, 0.2292, 0.1005, 0.0176, 0.0748, 0.2111, 0.0210, 0.0925,
        0.1332])
[rfa agg] iter:  8, prev_obj_val: 76.74052429199219, obj_val: 75.30516815185547, abs dis: 1.4353561401367188
[rfa agg] iter: 8, weight: tensor([0.0825, 0.0352, 0.2313, 0.0952, 0.0181, 0.0796, 0.2243, 0.0218, 0.0881,
        0.1239])
[rfa agg] iter:  9, prev_obj_val: 75.30516815185547, obj_val: 76.74052429199219, abs dis: 1.4353561401367188
[rfa agg] iter: 9, weight: tensor([0.0863, 0.0338, 0.2292, 0.1005, 0.0176, 0.0748, 0.2111, 0.0210, 0.0925,
        0.1332])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.0877, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 6.5125, Accuracy: 0/9950 (0.0000%)
saving model
Done in 539.6029539108276 sec.
Server Epoch:69 choose agents : [90, 24, 28, 70, 52, 97, 11, 21, 20, 62].
_Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   1, Avg loss: 0.0594, Accuracy: 241/677 (35.5982%)
_Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 465/677 (68.6854%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 12.4856, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   1, Avg loss: 0.0971, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   2, Avg loss: 0.0522, Accuracy: 107/312 (34.2949%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.4425, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   1, Avg loss: 0.0589, Accuracy: 328/1581 (20.7464%)
_Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   2, Avg loss: 0.0365, Accuracy: 506/1581 (32.0051%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.7934, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0690, Accuracy: 266/1418 (18.7588%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0345, Accuracy: 569/1418 (40.1269%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.6787, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   1, Avg loss: 0.0631, Accuracy: 176/636 (27.6730%)
_Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   2, Avg loss: 0.0320, Accuracy: 426/636 (66.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 11.5353, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   1, Avg loss: 0.0525, Accuracy: 290/1213 (23.9077%)
_Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 513/1213 (42.2918%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.6037, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   1, Avg loss: 0.0685, Accuracy: 181/712 (25.4213%)
_Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   2, Avg loss: 0.0263, Accuracy: 446/712 (62.6404%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 11.6024, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0640, Accuracy: 315/1949 (16.1621%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0356, Accuracy: 551/1949 (28.2709%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.8443, Accuracy: 76/10000 (0.7600%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0722, Accuracy: 163/807 (20.1983%)
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0361, Accuracy: 424/807 (52.5403%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.8439, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   1, Avg loss: 0.0715, Accuracy: 105/568 (18.4859%)
_Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   2, Avg loss: 0.0425, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.3366, Accuracy: 61/10000 (0.6100%)
time spent on training: 262.07918214797974
[rfa agg] training data poison_ratio: 0.08173807353388028  data num: [677, 312, 1581, 1418, 636, 1213, 712, 1949, 807, 568]
[rfa agg] considering poison per batch poison_fraction: 0.02554314797933759
[rfa agg] init. name: [90, 24, 28, 70, 52, 97, 11, 21, 20, 62], weight: tensor([0.0686, 0.0316, 0.1601, 0.1436, 0.0644, 0.1229, 0.0721, 0.1974, 0.0817,
        0.0575])
[rfa agg] iter:  0, prev_obj_val: 71.96028137207031, obj_val: 73.2647476196289, abs dis: 1.3044662475585938
[rfa agg] iter: 0, weight: tensor([0.0618, 0.0155, 0.1404, 0.1604, 0.0508, 0.2607, 0.0731, 0.0980, 0.0980,
        0.0413])
[rfa agg] iter:  1, prev_obj_val: 73.2647476196289, obj_val: 74.20364379882812, abs dis: 0.9388961791992188
[rfa agg] iter: 1, weight: tensor([0.0697, 0.0165, 0.1236, 0.1407, 0.0565, 0.2575, 0.0837, 0.0901, 0.1160,
        0.0456])
[rfa agg] iter:  2, prev_obj_val: 74.20364379882812, obj_val: 76.31961822509766, abs dis: 2.1159744262695312
[rfa agg] iter: 2, weight: tensor([0.0761, 0.0174, 0.1184, 0.1328, 0.0610, 0.2351, 0.0921, 0.0881, 0.1301,
        0.0490])
[rfa agg] iter:  3, prev_obj_val: 76.31961822509766, obj_val: 76.29175567626953, abs dis: 0.027862548828125
[rfa agg] iter: 3, weight: tensor([0.0894, 0.0188, 0.1066, 0.1171, 0.0698, 0.1896, 0.1096, 0.0823, 0.1611,
        0.0556])
[rfa agg] iter:  4, prev_obj_val: 76.29175567626953, obj_val: 76.29156494140625, abs dis: 0.00019073486328125
[rfa agg] iter: 4, weight: tensor([0.0901, 0.0188, 0.1064, 0.1164, 0.0698, 0.1855, 0.1107, 0.0821, 0.1644,
        0.0557])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.0915, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 6.5645, Accuracy: 0/9950 (0.0000%)
saving model
Done in 513.9833006858826 sec.
Server Epoch:70 choose agents : [75, 24, 36, 52, 95, 82, 93, 97, 6, 81].
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0672, Accuracy: 291/776 (37.5000%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0323, Accuracy: 391/776 (50.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.1704, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   1, Avg loss: 0.0967, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   2, Avg loss: 0.0522, Accuracy: 108/312 (34.6154%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.5665, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.0977, Accuracy: 5/408 (1.2255%)
_Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0567, Accuracy: 140/408 (34.3137%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.6289, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   1, Avg loss: 0.0610, Accuracy: 183/636 (28.7736%)
_Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   2, Avg loss: 0.0310, Accuracy: 426/636 (66.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 11.7961, Accuracy: 52/10000 (0.5200%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   1, Avg loss: 0.0513, Accuracy: 269/599 (44.9082%)
_Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   2, Avg loss: 0.0295, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 13.4550, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   1, Avg loss: 0.0865, Accuracy: 49/500 (9.8000%)
_Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   2, Avg loss: 0.0574, Accuracy: 168/500 (33.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.9827, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   1, Avg loss: 0.0586, Accuracy: 301/1742 (17.2790%)
_Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   2, Avg loss: 0.0336, Accuracy: 638/1742 (36.6246%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.2745, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0525, Accuracy: 299/1213 (24.6496%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0281, Accuracy: 514/1213 (42.3743%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.3542, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0719, Accuracy: 267/1956 (13.6503%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0356, Accuracy: 587/1956 (30.0102%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.0516, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   1, Avg loss: 0.0743, Accuracy: 136/774 (17.5711%)
_Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   2, Avg loss: 0.0404, Accuracy: 346/774 (44.7028%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.3445, Accuracy: 61/10000 (0.6100%)
time spent on training: 225.58568692207336
[rfa agg] training data poison_ratio: 0.06718259309107223  data num: [776, 312, 408, 636, 599, 500, 1742, 1213, 1956, 774]
[rfa agg] considering poison per batch poison_fraction: 0.02099456034096007
[rfa agg] init. name: [75, 24, 36, 52, 95, 82, 93, 97, 6, 81], weight: tensor([0.0870, 0.0350, 0.0458, 0.0713, 0.0672, 0.0561, 0.1954, 0.1360, 0.2194,
        0.0868])
[rfa agg] iter:  0, prev_obj_val: 83.13289642333984, obj_val: 84.22543334960938, abs dis: 1.0925369262695312
[rfa agg] iter: 0, weight: tensor([0.1322, 0.0207, 0.0328, 0.0700, 0.0664, 0.0446, 0.1261, 0.2606, 0.1142,
        0.1325])
[rfa agg] iter:  1, prev_obj_val: 84.22543334960938, obj_val: 86.46456909179688, abs dis: 2.2391357421875
[rfa agg] iter: 1, weight: tensor([0.1623, 0.0217, 0.0354, 0.0792, 0.0753, 0.0491, 0.1038, 0.2113, 0.0960,
        0.1657])
[rfa agg] iter:  2, prev_obj_val: 86.46456909179688, obj_val: 90.10028839111328, abs dis: 3.6357192993164062
[rfa agg] iter: 2, weight: tensor([0.1948, 0.0225, 0.0382, 0.0906, 0.0868, 0.0543, 0.0846, 0.1474, 0.0796,
        0.2011])
[rfa agg] iter:  3, prev_obj_val: 90.10028839111328, obj_val: 88.6446762084961, abs dis: 1.4556121826171875
[rfa agg] iter: 3, weight: tensor([0.1992, 0.0243, 0.0435, 0.1095, 0.1064, 0.0638, 0.0711, 0.1095, 0.0679,
        0.2050])
[rfa agg] iter:  4, prev_obj_val: 88.6446762084961, obj_val: 90.073486328125, abs dis: 1.4288101196289062
[rfa agg] iter: 4, weight: tensor([0.2066, 0.0232, 0.0408, 0.1020, 0.0986, 0.0592, 0.0734, 0.1157, 0.0698,
        0.2106])
[rfa agg] iter:  5, prev_obj_val: 90.073486328125, obj_val: 88.6448745727539, abs dis: 1.4286117553710938
[rfa agg] iter: 5, weight: tensor([0.2015, 0.0242, 0.0433, 0.1097, 0.1067, 0.0636, 0.0705, 0.1078, 0.0673,
        0.2053])
[rfa agg] iter:  6, prev_obj_val: 88.6448745727539, obj_val: 90.07349395751953, abs dis: 1.428619384765625
[rfa agg] iter: 6, weight: tensor([0.2071, 0.0232, 0.0408, 0.1019, 0.0986, 0.0592, 0.0733, 0.1156, 0.0698,
        0.2105])
[rfa agg] iter:  7, prev_obj_val: 90.07349395751953, obj_val: 88.64488220214844, abs dis: 1.4286117553710938
[rfa agg] iter: 7, weight: tensor([0.2017, 0.0242, 0.0433, 0.1097, 0.1067, 0.0636, 0.0705, 0.1078, 0.0673,
        0.2052])
[rfa agg] iter:  8, prev_obj_val: 88.64488220214844, obj_val: 90.07350158691406, abs dis: 1.428619384765625
[rfa agg] iter: 8, weight: tensor([0.2071, 0.0232, 0.0408, 0.1019, 0.0986, 0.0592, 0.0733, 0.1156, 0.0698,
        0.2104])
[rfa agg] iter:  9, prev_obj_val: 90.07350158691406, obj_val: 88.64488220214844, abs dis: 1.428619384765625
[rfa agg] iter: 9, weight: tensor([0.2017, 0.0242, 0.0433, 0.1097, 0.1067, 0.0636, 0.0705, 0.1078, 0.0673,
        0.2052])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 24.5620, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 23.9075, Accuracy: 0/9950 (0.0000%)
saving model
Done in 482.03776597976685 sec.
Server Epoch:71 choose agents : [88, 8, 87, 89, 65, 19, 11, 23, 49, 57].
_Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   1, Avg loss: 0.0901, Accuracy: 44/603 (7.2968%)
_Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   2, Avg loss: 0.0504, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.1403, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   1, Avg loss: 0.0695, Accuracy: 164/1513 (10.8394%)
_Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   2, Avg loss: 0.0414, Accuracy: 374/1513 (24.7191%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.6710, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   1, Avg loss: 0.0661, Accuracy: 212/1131 (18.7445%)
_Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   2, Avg loss: 0.0338, Accuracy: 407/1131 (35.9859%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.2508, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0753, Accuracy: 245/896 (27.3438%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0391, Accuracy: 455/896 (50.7812%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.2204, Accuracy: 60/10000 (0.6000%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   1, Avg loss: 0.0668, Accuracy: 286/1475 (19.3898%)
_Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   2, Avg loss: 0.0349, Accuracy: 601/1475 (40.7458%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.8232, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   1, Avg loss: 0.0579, Accuracy: 318/1036 (30.6950%)
_Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   2, Avg loss: 0.0258, Accuracy: 628/1036 (60.6178%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 12.9978, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   1, Avg loss: 0.0678, Accuracy: 185/712 (25.9831%)
_Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   2, Avg loss: 0.0298, Accuracy: 439/712 (61.6573%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 11.2740, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0674, Accuracy: 209/715 (29.2308%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0391, Accuracy: 436/715 (60.9790%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.9577, Accuracy: 76/10000 (0.7600%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0855, Accuracy: 1/440 (0.2273%)
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0489, Accuracy: 129/440 (29.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.0114, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   1, Avg loss: 0.0705, Accuracy: 231/1154 (20.0173%)
_Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   2, Avg loss: 0.0316, Accuracy: 399/1154 (34.5754%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 11.6498, Accuracy: 64/10000 (0.6400%)
time spent on training: 263.3149826526642
[rfa agg] training data poison_ratio: 0.1979328165374677  data num: [603, 1513, 1131, 896, 1475, 1036, 712, 715, 440, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.06185400516795865
[rfa agg] init. name: [88, 8, 87, 89, 65, 19, 11, 23, 49, 57], weight: tensor([0.0623, 0.1564, 0.1169, 0.0926, 0.1525, 0.1071, 0.0736, 0.0739, 0.0455,
        0.1193])
[rfa agg] iter:  0, prev_obj_val: 55.585113525390625, obj_val: 58.24812698364258, abs dis: 2.663013458251953
[rfa agg] iter: 0, weight: tensor([0.0574, 0.0833, 0.1446, 0.1783, 0.0800, 0.1578, 0.0889, 0.0831, 0.0270,
        0.0997])
[rfa agg] iter:  1, prev_obj_val: 58.24812698364258, obj_val: 60.01106643676758, abs dis: 1.762939453125
[rfa agg] iter: 1, weight: tensor([0.0675, 0.0741, 0.1212, 0.2122, 0.0710, 0.1367, 0.1054, 0.0951, 0.0297,
        0.0870])
[rfa agg] iter:  2, prev_obj_val: 60.01106643676758, obj_val: 60.00471496582031, abs dis: 0.006351470947265625
[rfa agg] iter: 2, weight: tensor([0.0752, 0.0711, 0.1111, 0.2164, 0.0682, 0.1242, 0.1168, 0.1030, 0.0318,
        0.0823])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.0652, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 6.5781, Accuracy: 0/9950 (0.0000%)
saving model
Done in 520.6976127624512 sec.
Server Epoch:72 choose agents : [78, 58, 7, 87, 5, 96, 28, 39, 91, 22].
_Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   1, Avg loss: 0.0783, Accuracy: 31/416 (7.4519%)
_Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   2, Avg loss: 0.0468, Accuracy: 165/416 (39.6635%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.5008, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   1, Avg loss: 0.0728, Accuracy: 201/803 (25.0311%)
_Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   2, Avg loss: 0.0377, Accuracy: 406/803 (50.5604%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.7081, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0659, Accuracy: 245/891 (27.4972%)
_Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0294, Accuracy: 422/891 (47.3625%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.6779, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0659, Accuracy: 205/1131 (18.1256%)
_Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0336, Accuracy: 414/1131 (36.6048%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.9072, Accuracy: 65/10000 (0.6500%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   1, Avg loss: 0.0583, Accuracy: 300/1628 (18.4275%)
_Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   2, Avg loss: 0.0278, Accuracy: 712/1628 (43.7346%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.7134, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0862, Accuracy: 4/311 (1.2862%)
_Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0572, Accuracy: 102/311 (32.7974%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.4553, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   1, Avg loss: 0.0578, Accuracy: 322/1581 (20.3669%)
_Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   2, Avg loss: 0.0375, Accuracy: 459/1581 (29.0323%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.8713, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   1, Avg loss: 0.0539, Accuracy: 254/1013 (25.0740%)
_Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   2, Avg loss: 0.0280, Accuracy: 503/1013 (49.6545%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.3273, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0602, Accuracy: 228/1030 (22.1359%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0280, Accuracy: 563/1030 (54.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 11.1490, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0560, Accuracy: 381/1470 (25.9184%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0265, Accuracy: 768/1470 (52.2449%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.3754, Accuracy: 102/10000 (1.0200%)
time spent on training: 258.2980868816376
[rfa agg] training data poison_ratio: 0.15845824411134904  data num: [416, 803, 891, 1131, 1628, 311, 1581, 1013, 1030, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.04951820128479657
[rfa agg] init. name: [78, 58, 7, 87, 5, 96, 28, 39, 91, 22], weight: tensor([0.0405, 0.0782, 0.0867, 0.1101, 0.1585, 0.0303, 0.1539, 0.0986, 0.1003,
        0.1431])
[rfa agg] iter:  0, prev_obj_val: 57.51237487792969, obj_val: 59.78987503051758, abs dis: 2.2775001525878906
[rfa agg] iter: 0, weight: tensor([0.0204, 0.0873, 0.1008, 0.1765, 0.0881, 0.0126, 0.0943, 0.1779, 0.1323,
        0.1099])
[rfa agg] iter:  1, prev_obj_val: 59.78987503051758, obj_val: 59.77263259887695, abs dis: 0.017242431640625
[rfa agg] iter: 1, weight: tensor([0.0218, 0.1024, 0.1133, 0.1611, 0.0774, 0.0132, 0.0822, 0.2046, 0.1299,
        0.0940])
[rfa agg] iter:  2, prev_obj_val: 59.77263259887695, obj_val: 61.414249420166016, abs dis: 1.6416168212890625
[rfa agg] iter: 2, weight: tensor([0.0217, 0.1024, 0.1138, 0.1583, 0.0768, 0.0131, 0.0815, 0.2102, 0.1291,
        0.0931])
[rfa agg] iter:  3, prev_obj_val: 61.414249420166016, obj_val: 63.30104064941406, abs dis: 1.8867912292480469
[rfa agg] iter: 3, weight: tensor([0.0231, 0.1146, 0.1226, 0.1476, 0.0745, 0.0139, 0.0788, 0.2099, 0.1258,
        0.0892])
[rfa agg] iter:  4, prev_obj_val: 63.30104064941406, obj_val: 65.4190673828125, abs dis: 2.1180267333984375
[rfa agg] iter: 4, weight: tensor([0.0249, 0.1303, 0.1329, 0.1375, 0.0728, 0.0148, 0.0768, 0.2016, 0.1221,
        0.0863])
[rfa agg] iter:  5, prev_obj_val: 65.4190673828125, obj_val: 65.41268920898438, abs dis: 0.006378173828125
[rfa agg] iter: 5, weight: tensor([0.0270, 0.1490, 0.1426, 0.1289, 0.0716, 0.0158, 0.0753, 0.1879, 0.1180,
        0.0839])
[rfa agg] iter:  6, prev_obj_val: 65.41268920898438, obj_val: 65.41254425048828, abs dis: 0.00014495849609375
[rfa agg] iter: 6, weight: tensor([0.0270, 0.1513, 0.1443, 0.1281, 0.0716, 0.0158, 0.0752, 0.1852, 0.1177,
        0.0838])
[rfa agg] iter:  7, prev_obj_val: 65.41254425048828, obj_val: 67.75347137451172, abs dis: 2.3409271240234375
[rfa agg] iter: 7, weight: tensor([0.0270, 0.1516, 0.1446, 0.1280, 0.0716, 0.0158, 0.0752, 0.1847, 0.1176,
        0.0838])
[rfa agg] iter:  8, prev_obj_val: 67.75347137451172, obj_val: 65.41624450683594, abs dis: 2.3372268676757812
[rfa agg] iter: 8, weight: tensor([0.0294, 0.1699, 0.1503, 0.1213, 0.0706, 0.0170, 0.0740, 0.1722, 0.1136,
        0.0819])
[rfa agg] iter:  9, prev_obj_val: 65.41624450683594, obj_val: 65.41261291503906, abs dis: 0.003631591796875
[rfa agg] iter: 9, weight: tensor([0.0270, 0.1541, 0.1458, 0.1274, 0.0715, 0.0158, 0.0751, 0.1823, 0.1172,
        0.0837])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.0958, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 7.2663, Accuracy: 0/9950 (0.0000%)
saving model
Done in 515.4736347198486 sec.
Server Epoch:73 choose agents : [98, 36, 21, 76, 10, 40, 61, 4, 75, 26].
_Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   1, Avg loss: 0.0862, Accuracy: 8/373 (2.1448%)
_Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   2, Avg loss: 0.0508, Accuracy: 131/373 (35.1206%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.4379, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.0984, Accuracy: 4/408 (0.9804%)
_Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0561, Accuracy: 126/408 (30.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.5840, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0652, Accuracy: 303/1949 (15.5464%)
_Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0367, Accuracy: 555/1949 (28.4761%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.1301, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   1, Avg loss: 0.0975, Accuracy: 18/466 (3.8627%)
_Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   2, Avg loss: 0.0507, Accuracy: 153/466 (32.8326%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.9432, Accuracy: 55/10000 (0.5500%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0645, Accuracy: 141/861 (16.3763%)
_Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0226, Accuracy: 424/861 (49.2451%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 13.8780, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   1, Avg loss: 0.0572, Accuracy: 307/1573 (19.5168%)
_Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   2, Avg loss: 0.0368, Accuracy: 487/1573 (30.9599%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.6949, Accuracy: 74/10000 (0.7400%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   1, Avg loss: 0.1436, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   2, Avg loss: 0.1376, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.0229, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0675, Accuracy: 268/901 (29.7447%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0358, Accuracy: 391/901 (43.3962%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.7415, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   1, Avg loss: 0.0686, Accuracy: 260/776 (33.5052%)
_Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   2, Avg loss: 0.0345, Accuracy: 363/776 (46.7784%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.4552, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0674, Accuracy: 257/1446 (17.7732%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0409, Accuracy: 463/1446 (32.0194%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.3645, Accuracy: 59/10000 (0.5900%)
time spent on training: 267.6693651676178
[rfa agg] training data poison_ratio: 0.1070377913555103  data num: [373, 408, 1949, 466, 861, 1573, 85, 901, 776, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.03344930979859697
[rfa agg] init. name: [98, 36, 21, 76, 10, 40, 61, 4, 75, 26], weight: tensor([0.0422, 0.0462, 0.2205, 0.0527, 0.0974, 0.1780, 0.0096, 0.1019, 0.0878,
        0.1636])
[rfa agg] iter:  0, prev_obj_val: 76.89064025878906, obj_val: 79.19606018066406, abs dis: 2.305419921875
[rfa agg] iter: 0, weight: tensor([0.0248, 0.0301, 0.1118, 0.0378, 0.1546, 0.1545, 0.0040, 0.1819, 0.1142,
        0.1863])
[rfa agg] iter:  1, prev_obj_val: 79.19606018066406, obj_val: 81.48931884765625, abs dis: 2.2932586669921875
[rfa agg] iter: 1, weight: tensor([0.0254, 0.0313, 0.0908, 0.0400, 0.1925, 0.1194, 0.0039, 0.2240, 0.1332,
        0.1396])
[rfa agg] iter:  2, prev_obj_val: 81.48931884765625, obj_val: 81.46736907958984, abs dis: 0.02194976806640625
[rfa agg] iter: 2, weight: tensor([0.0257, 0.0322, 0.0790, 0.0417, 0.2212, 0.1000, 0.0039, 0.2348, 0.1474,
        0.1140])
[rfa agg] iter:  3, prev_obj_val: 81.46736907958984, obj_val: 82.93983459472656, abs dis: 1.4724655151367188
[rfa agg] iter: 3, weight: tensor([0.0254, 0.0319, 0.0780, 0.0413, 0.2260, 0.0986, 0.0038, 0.2358, 0.1471,
        0.1122])
[rfa agg] iter:  4, prev_obj_val: 82.93983459472656, obj_val: 84.638671875, abs dis: 1.6988372802734375
[rfa agg] iter: 4, weight: tensor([0.0262, 0.0331, 0.0745, 0.0433, 0.2378, 0.0928, 0.0039, 0.2278, 0.1560,
        0.1045])
[rfa agg] iter:  5, prev_obj_val: 84.638671875, obj_val: 84.6339340209961, abs dis: 0.00473785400390625
[rfa agg] iter: 5, weight: tensor([0.0275, 0.0351, 0.0722, 0.0463, 0.2466, 0.0886, 0.0040, 0.2134, 0.1673,
        0.0989])
[rfa agg] iter:  6, prev_obj_val: 84.6339340209961, obj_val: 84.63369750976562, abs dis: 0.00023651123046875
[rfa agg] iter: 6, weight: tensor([0.0275, 0.0351, 0.0721, 0.0463, 0.2493, 0.0884, 0.0040, 0.2094, 0.1694,
        0.0987])
[rfa agg] iter:  7, prev_obj_val: 84.63369750976562, obj_val: 82.93934631347656, abs dis: 1.6943511962890625
[rfa agg] iter: 7, weight: tensor([0.0275, 0.0350, 0.0721, 0.0462, 0.2501, 0.0884, 0.0040, 0.2083, 0.1698,
        0.0986])
[rfa agg] iter:  8, prev_obj_val: 82.93934631347656, obj_val: 84.6360855102539, abs dis: 1.6967391967773438
[rfa agg] iter: 8, weight: tensor([0.0262, 0.0331, 0.0742, 0.0433, 0.2448, 0.0923, 0.0039, 0.2191, 0.1593,
        0.1039])
[rfa agg] iter:  9, prev_obj_val: 84.6360855102539, obj_val: 84.63377380371094, abs dis: 0.00231170654296875
[rfa agg] iter: 9, weight: tensor([0.0275, 0.0351, 0.0722, 0.0462, 0.2487, 0.0885, 0.0040, 0.2110, 0.1679,
        0.0988])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.1216, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 7.0932, Accuracy: 0/9950 (0.0000%)
saving model
Done in 524.1656959056854 sec.
Server Epoch:74 choose agents : [23, 32, 65, 40, 44, 4, 84, 94, 14, 70].
_Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   1, Avg loss: 0.0681, Accuracy: 226/715 (31.6084%)
_Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   2, Avg loss: 0.0383, Accuracy: 430/715 (60.1399%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.7594, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   1, Avg loss: 0.0658, Accuracy: 131/735 (17.8231%)
_Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   2, Avg loss: 0.0253, Accuracy: 332/735 (45.1701%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 12.6227, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   1, Avg loss: 0.0683, Accuracy: 298/1475 (20.2034%)
_Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   2, Avg loss: 0.0362, Accuracy: 580/1475 (39.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.5050, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   1, Avg loss: 0.0570, Accuracy: 320/1573 (20.3433%)
_Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   2, Avg loss: 0.0370, Accuracy: 521/1573 (33.1214%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.7227, Accuracy: 94/10000 (0.9400%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0693, Accuracy: 311/1750 (17.7714%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0390, Accuracy: 624/1750 (35.6571%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.2803, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0667, Accuracy: 262/901 (29.0788%)
_Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0352, Accuracy: 416/901 (46.1709%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.3530, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   1, Avg loss: 0.0667, Accuracy: 256/1190 (21.5126%)
_Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   2, Avg loss: 0.0339, Accuracy: 435/1190 (36.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.3798, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   1, Avg loss: 0.0700, Accuracy: 228/1662 (13.7184%)
_Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   2, Avg loss: 0.0383, Accuracy: 505/1662 (30.3851%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.7759, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   1, Avg loss: 0.0667, Accuracy: 145/1013 (14.3139%)
_Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   2, Avg loss: 0.0372, Accuracy: 333/1013 (32.8727%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.3063, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   1, Avg loss: 0.0692, Accuracy: 251/1418 (17.7010%)
_Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   2, Avg loss: 0.0347, Accuracy: 580/1418 (40.9027%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.8129, Accuracy: 91/10000 (0.9100%)
time spent on training: 326.0801990032196
[rfa agg] training data poison_ratio: 0.2594111969111969  data num: [715, 735, 1475, 1573, 1750, 901, 1190, 1662, 1013, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.08106599903474904
[rfa agg] init. name: [23, 32, 65, 40, 44, 4, 84, 94, 14, 70], weight: tensor([0.0575, 0.0591, 0.1186, 0.1265, 0.1408, 0.0725, 0.0957, 0.1337, 0.0815,
        0.1141])
[rfa agg] iter:  0, prev_obj_val: 59.93682861328125, obj_val: 59.84394836425781, abs dis: 0.0928802490234375
[rfa agg] iter: 0, weight: tensor([0.0449, 0.0487, 0.1136, 0.1122, 0.0899, 0.0834, 0.1488, 0.1082, 0.1190,
        0.1313])
[rfa agg] iter:  1, prev_obj_val: 59.84394836425781, obj_val: 61.3360481262207, abs dis: 1.4920997619628906
[rfa agg] iter: 1, weight: tensor([0.0444, 0.0480, 0.1120, 0.1106, 0.0883, 0.0828, 0.1562, 0.1065, 0.1203,
        0.1308])
[rfa agg] iter:  2, prev_obj_val: 61.3360481262207, obj_val: 61.33185958862305, abs dis: 0.00418853759765625
[rfa agg] iter: 2, weight: tensor([0.0474, 0.0515, 0.1065, 0.1052, 0.0851, 0.0895, 0.1577, 0.1015, 0.1324,
        0.1232])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.1230, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 6.4053, Accuracy: 0/9950 (0.0000%)
saving model
Done in 588.7843117713928 sec.
Server Epoch:75 choose agents : [74, 11, 45, 65, 75, 59, 52, 1, 15, 25].
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0484, Accuracy: 411/1552 (26.4820%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0244, Accuracy: 662/1552 (42.6546%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 12.8218, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0706, Accuracy: 175/712 (24.5787%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 422/712 (59.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.3078, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   1, Avg loss: 0.0817, Accuracy: 115/669 (17.1898%)
_Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   2, Avg loss: 0.0459, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.0791, Accuracy: 59/10000 (0.5900%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0658, Accuracy: 288/1475 (19.5254%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0346, Accuracy: 619/1475 (41.9661%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.5668, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   1, Avg loss: 0.0636, Accuracy: 265/776 (34.1495%)
_Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   2, Avg loss: 0.0327, Accuracy: 367/776 (47.2938%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.3569, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   1, Avg loss: 0.0672, Accuracy: 294/1089 (26.9972%)
_Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   2, Avg loss: 0.0339, Accuracy: 444/1089 (40.7713%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.2444, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   1, Avg loss: 0.0586, Accuracy: 189/636 (29.7170%)
_Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   2, Avg loss: 0.0288, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.7755, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0760, Accuracy: 243/928 (26.1853%)
_Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0273, Accuracy: 495/928 (53.3405%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.6005, Accuracy: 105/10000 (1.0500%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   1, Avg loss: 0.0650, Accuracy: 235/1154 (20.3640%)
_Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   2, Avg loss: 0.0313, Accuracy: 430/1154 (37.2617%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.3084, Accuracy: 61/10000 (0.6100%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   1, Avg loss: 0.0604, Accuracy: 239/690 (34.6377%)
_Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   2, Avg loss: 0.0295, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.6080, Accuracy: 73/10000 (0.7300%)
time spent on training: 301.20556235313416
[rfa agg] training data poison_ratio: 0.5031505009813035  data num: [1552, 712, 669, 1475, 776, 1089, 636, 928, 1154, 690]
[rfa agg] considering poison per batch poison_fraction: 0.15723453155665734
[rfa agg] init. name: [74, 11, 45, 65, 75, 59, 52, 1, 15, 25], weight: tensor([0.1603, 0.0735, 0.0691, 0.1524, 0.0802, 0.1125, 0.0657, 0.0959, 0.1192,
        0.0713])
[rfa agg] iter:  0, prev_obj_val: 60.96605682373047, obj_val: 64.29437255859375, abs dis: 3.3283157348632812
[rfa agg] iter: 0, weight: tensor([0.0958, 0.0967, 0.0775, 0.1002, 0.1206, 0.0985, 0.0621, 0.1408, 0.1263,
        0.0814])
[rfa agg] iter:  1, prev_obj_val: 64.29437255859375, obj_val: 69.24016571044922, abs dis: 4.945793151855469
[rfa agg] iter: 1, weight: tensor([0.0733, 0.1241, 0.0986, 0.0758, 0.1455, 0.0786, 0.0761, 0.1288, 0.0933,
        0.1059])
[rfa agg] iter:  2, prev_obj_val: 69.24016571044922, obj_val: 69.17967224121094, abs dis: 0.06049346923828125
[rfa agg] iter: 2, weight: tensor([0.0623, 0.1405, 0.1211, 0.0639, 0.1394, 0.0660, 0.0928, 0.1036, 0.0752,
        0.1350])
[rfa agg] iter:  3, prev_obj_val: 69.17967224121094, obj_val: 67.25044250488281, abs dis: 1.929229736328125
[rfa agg] iter: 3, weight: tensor([0.0611, 0.1439, 0.1238, 0.0627, 0.1374, 0.0641, 0.0934, 0.1000, 0.0734,
        0.1402])
[rfa agg] iter:  4, prev_obj_val: 67.25044250488281, obj_val: 69.1822280883789, abs dis: 1.9317855834960938
[rfa agg] iter: 4, weight: tensor([0.0635, 0.1430, 0.1165, 0.0653, 0.1437, 0.0666, 0.0870, 0.1061, 0.0774,
        0.1307])
[rfa agg] iter:  5, prev_obj_val: 69.1822280883789, obj_val: 67.24999237060547, abs dis: 1.9322357177734375
[rfa agg] iter: 5, weight: tensor([0.0612, 0.1442, 0.1231, 0.0628, 0.1380, 0.0643, 0.0930, 0.1003, 0.0736,
        0.1395])
[rfa agg] iter:  6, prev_obj_val: 67.24999237060547, obj_val: 69.18228912353516, abs dis: 1.9322967529296875
[rfa agg] iter: 6, weight: tensor([0.0635, 0.1430, 0.1165, 0.0653, 0.1438, 0.0666, 0.0870, 0.1062, 0.0774,
        0.1306])
[rfa agg] iter:  7, prev_obj_val: 69.18228912353516, obj_val: 67.24998474121094, abs dis: 1.9323043823242188
[rfa agg] iter: 7, weight: tensor([0.0612, 0.1442, 0.1231, 0.0628, 0.1380, 0.0643, 0.0930, 0.1003, 0.0736,
        0.1395])
[rfa agg] iter:  8, prev_obj_val: 67.24998474121094, obj_val: 69.18228149414062, abs dis: 1.9322967529296875
[rfa agg] iter: 8, weight: tensor([0.0635, 0.1430, 0.1165, 0.0653, 0.1438, 0.0666, 0.0870, 0.1062, 0.0774,
        0.1306])
[rfa agg] iter:  9, prev_obj_val: 69.18228149414062, obj_val: 67.24998474121094, abs dis: 1.9322967529296875
[rfa agg] iter: 9, weight: tensor([0.0612, 0.1442, 0.1231, 0.0628, 0.1380, 0.0643, 0.0930, 0.1003, 0.0736,
        0.1395])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.0882, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 6.7640, Accuracy: 0/9950 (0.0000%)
saving model
Done in 565.6800701618195 sec.
Server Epoch:76 choose agents : [63, 74, 77, 87, 99, 4, 66, 94, 14, 24].
_Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   1, Avg loss: 0.0699, Accuracy: 167/888 (18.8063%)
_Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   2, Avg loss: 0.0301, Accuracy: 435/888 (48.9865%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 11.6005, Accuracy: 83/10000 (0.8300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   1, Avg loss: 0.0464, Accuracy: 428/1552 (27.5773%)
_Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   2, Avg loss: 0.0235, Accuracy: 698/1552 (44.9742%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 12.6045, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   1, Avg loss: 0.0612, Accuracy: 256/1340 (19.1045%)
_Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   2, Avg loss: 0.0290, Accuracy: 514/1340 (38.3582%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.8987, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0637, Accuracy: 210/1131 (18.5676%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0340, Accuracy: 402/1131 (35.5438%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.7779, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   1, Avg loss: 0.0593, Accuracy: 212/773 (27.4256%)
_Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   2, Avg loss: 0.0331, Accuracy: 415/773 (53.6869%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.0177, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0690, Accuracy: 258/901 (28.6349%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0347, Accuracy: 385/901 (42.7303%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.6557, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   1, Avg loss: 0.0715, Accuracy: 190/1402 (13.5521%)
_Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   2, Avg loss: 0.0420, Accuracy: 324/1402 (23.1098%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.6884, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   1, Avg loss: 0.0702, Accuracy: 226/1662 (13.5981%)
_Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   2, Avg loss: 0.0392, Accuracy: 496/1662 (29.8436%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.3385, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0661, Accuracy: 148/1013 (14.6101%)
_Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0383, Accuracy: 315/1013 (31.0958%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.2571, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   1, Avg loss: 0.0916, Accuracy: 4/312 (1.2821%)
_Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   2, Avg loss: 0.0486, Accuracy: 113/312 (36.2179%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.2457, Accuracy: 59/10000 (0.5900%)
time spent on training: 303.9522759914398
[rfa agg] training data poison_ratio: 0.14142518680517588  data num: [888, 1552, 1340, 1131, 773, 901, 1402, 1662, 1013, 312]
[rfa agg] considering poison per batch poison_fraction: 0.044195370876617464
[rfa agg] init. name: [63, 74, 77, 87, 99, 4, 66, 94, 14, 24], weight: tensor([0.0809, 0.1414, 0.1221, 0.1031, 0.0704, 0.0821, 0.1278, 0.1514, 0.0923,
        0.0284])
[rfa agg] iter:  0, prev_obj_val: 54.345741271972656, obj_val: 55.62429428100586, abs dis: 1.2785530090332031
[rfa agg] iter: 0, weight: tensor([0.0929, 0.0821, 0.1241, 0.1666, 0.0708, 0.1039, 0.1143, 0.0815, 0.1522,
        0.0115])
[rfa agg] iter:  1, prev_obj_val: 55.62429428100586, obj_val: 61.47401809692383, abs dis: 5.849723815917969
[rfa agg] iter: 1, weight: tensor([0.1001, 0.0762, 0.1135, 0.1630, 0.0763, 0.1111, 0.1046, 0.0760, 0.1675,
        0.0118])
[rfa agg] iter:  2, prev_obj_val: 61.47401809692383, obj_val: 61.44145965576172, abs dis: 0.032558441162109375
[rfa agg] iter: 2, weight: tensor([0.1278, 0.0696, 0.0959, 0.1323, 0.1019, 0.1281, 0.0897, 0.0698, 0.1709,
        0.0140])
[rfa agg] iter:  3, prev_obj_val: 61.44145965576172, obj_val: 63.87388610839844, abs dis: 2.4324264526367188
[rfa agg] iter: 3, weight: tensor([0.1306, 0.0690, 0.0950, 0.1292, 0.1033, 0.1291, 0.0889, 0.0692, 0.1719,
        0.0139])
[rfa agg] iter:  4, prev_obj_val: 63.87388610839844, obj_val: 63.87089157104492, abs dis: 0.002994537353515625
[rfa agg] iter: 4, weight: tensor([0.1396, 0.0679, 0.0915, 0.1218, 0.1143, 0.1312, 0.0860, 0.0683, 0.1645,
        0.0149])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 29.4213, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 15.6872, Accuracy: 6/9950 (0.0603%)
saving model
Done in 566.8758952617645 sec.
Server Epoch:77 choose agents : [76, 6, 84, 12, 66, 97, 46, 21, 74, 15].
_Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   1, Avg loss: 0.0953, Accuracy: 15/466 (3.2189%)
_Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   2, Avg loss: 0.0509, Accuracy: 153/466 (32.8326%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.9577, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   1, Avg loss: 0.0707, Accuracy: 298/1956 (15.2352%)
_Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   2, Avg loss: 0.0353, Accuracy: 586/1956 (29.9591%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.2550, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   1, Avg loss: 0.0645, Accuracy: 259/1190 (21.7647%)
_Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   2, Avg loss: 0.0332, Accuracy: 417/1190 (35.0420%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.2682, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   1, Avg loss: 0.0868, Accuracy: 27/338 (7.9882%)
_Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   2, Avg loss: 0.0538, Accuracy: 140/338 (41.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.5324, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0705, Accuracy: 210/1402 (14.9786%)
_Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0423, Accuracy: 321/1402 (22.8959%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.7725, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   1, Avg loss: 0.0528, Accuracy: 296/1213 (24.4023%)
_Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   2, Avg loss: 0.0288, Accuracy: 498/1213 (41.0552%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.4338, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   1, Avg loss: 0.0607, Accuracy: 375/1904 (19.6954%)
_Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   2, Avg loss: 0.0330, Accuracy: 666/1904 (34.9790%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.0600, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   1, Avg loss: 0.0660, Accuracy: 336/1949 (17.2396%)
_Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   2, Avg loss: 0.0370, Accuracy: 519/1949 (26.6290%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.9829, Accuracy: 62/10000 (0.6200%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   1, Avg loss: 0.0464, Accuracy: 452/1552 (29.1237%)
_Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   2, Avg loss: 0.0228, Accuracy: 731/1552 (47.1005%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 12.2125, Accuracy: 86/10000 (0.8600%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   1, Avg loss: 0.0663, Accuracy: 227/1154 (19.6707%)
_Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   2, Avg loss: 0.0307, Accuracy: 419/1154 (36.3085%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 12.0302, Accuracy: 81/10000 (0.8100%)
time spent on training: 283.81143951416016
[rfa agg] training data poison_ratio: 0.20618713806766228  data num: [466, 1956, 1190, 338, 1402, 1213, 1904, 1949, 1552, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.06443348064614446
[rfa agg] init. name: [76, 6, 84, 12, 66, 97, 46, 21, 74, 15], weight: tensor([0.0355, 0.1490, 0.0907, 0.0258, 0.1068, 0.0924, 0.1451, 0.1485, 0.1183,
        0.0879])
[rfa agg] iter:  0, prev_obj_val: 67.62873077392578, obj_val: 68.60443115234375, abs dis: 0.9757003784179688
[rfa agg] iter: 0, weight: tensor([0.0156, 0.0955, 0.1112, 0.0099, 0.2053, 0.1157, 0.1022, 0.0933, 0.1501,
        0.1011])
[rfa agg] iter:  1, prev_obj_val: 68.60443115234375, obj_val: 70.02237701416016, abs dis: 1.4179458618164062
[rfa agg] iter: 1, weight: tensor([0.0158, 0.0880, 0.1173, 0.0100, 0.2202, 0.1226, 0.0945, 0.0863, 0.1403,
        0.1050])
[rfa agg] iter:  2, prev_obj_val: 70.02237701416016, obj_val: 70.01679992675781, abs dis: 0.00557708740234375
[rfa agg] iter: 2, weight: tensor([0.0165, 0.0847, 0.1254, 0.0103, 0.2160, 0.1312, 0.0906, 0.0832, 0.1314,
        0.1107])
[rfa agg] iter:  3, prev_obj_val: 70.01679992675781, obj_val: 68.60102844238281, abs dis: 1.415771484375
[rfa agg] iter: 3, weight: tensor([0.0164, 0.0845, 0.1265, 0.0103, 0.2145, 0.1325, 0.0904, 0.0831, 0.1305,
        0.1112])
[rfa agg] iter:  4, prev_obj_val: 68.60102844238281, obj_val: 70.02069854736328, abs dis: 1.4196701049804688
[rfa agg] iter: 4, weight: tensor([0.0157, 0.0874, 0.1189, 0.0099, 0.2210, 0.1243, 0.0938, 0.0858, 0.1377,
        0.1055])
[rfa agg] iter:  5, prev_obj_val: 70.02069854736328, obj_val: 70.01676940917969, abs dis: 0.00392913818359375
[rfa agg] iter: 5, weight: tensor([0.0165, 0.0846, 0.1256, 0.0103, 0.2161, 0.1314, 0.0905, 0.0831, 0.1311,
        0.1107])
[rfa agg] iter:  6, prev_obj_val: 70.01676940917969, obj_val: 68.6010513305664, abs dis: 1.4157180786132812
[rfa agg] iter: 6, weight: tensor([0.0164, 0.0845, 0.1265, 0.0103, 0.2145, 0.1325, 0.0904, 0.0831, 0.1305,
        0.1112])
[rfa agg] iter:  7, prev_obj_val: 68.6010513305664, obj_val: 70.02069854736328, abs dis: 1.419647216796875
[rfa agg] iter: 7, weight: tensor([0.0157, 0.0874, 0.1189, 0.0099, 0.2210, 0.1243, 0.0938, 0.0858, 0.1377,
        0.1055])
[rfa agg] iter:  8, prev_obj_val: 70.02069854736328, obj_val: 70.01676940917969, abs dis: 0.00392913818359375
[rfa agg] iter: 8, weight: tensor([0.0165, 0.0846, 0.1256, 0.0103, 0.2161, 0.1314, 0.0905, 0.0831, 0.1311,
        0.1107])
[rfa agg] iter:  9, prev_obj_val: 70.01676940917969, obj_val: 68.6010513305664, abs dis: 1.4157180786132812
[rfa agg] iter: 9, weight: tensor([0.0164, 0.0845, 0.1265, 0.0103, 0.2145, 0.1325, 0.0904, 0.0831, 0.1305,
        0.1112])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 15.7040, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 10.0098, Accuracy: 5/9950 (0.0503%)
saving model
Done in 540.1899697780609 sec.
Server Epoch:78 choose agents : [41, 72, 21, 61, 36, 59, 95, 83, 71, 30].
_Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   1, Avg loss: 0.0669, Accuracy: 192/719 (26.7038%)
_Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   2, Avg loss: 0.0361, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.3177, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   1, Avg loss: 0.0657, Accuracy: 188/1241 (15.1491%)
_Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   2, Avg loss: 0.0402, Accuracy: 381/1241 (30.7010%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.7174, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   1, Avg loss: 0.0653, Accuracy: 342/1949 (17.5475%)
_Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   2, Avg loss: 0.0354, Accuracy: 591/1949 (30.3232%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.0139, Accuracy: 77/10000 (0.7700%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   1, Avg loss: 0.1536, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   2, Avg loss: 0.1405, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.7452, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0999, Accuracy: 5/408 (1.2255%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0574, Accuracy: 130/408 (31.8627%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4862, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   1, Avg loss: 0.0634, Accuracy: 306/1089 (28.0992%)
_Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   2, Avg loss: 0.0314, Accuracy: 451/1089 (41.4141%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.0368, Accuracy: 71/10000 (0.7100%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   1, Avg loss: 0.0587, Accuracy: 222/599 (37.0618%)
_Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 14.3567, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   1, Avg loss: 0.0699, Accuracy: 293/1953 (15.0026%)
_Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   2, Avg loss: 0.0377, Accuracy: 671/1953 (34.3574%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4525, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   1, Avg loss: 0.0692, Accuracy: 110/818 (13.4474%)
_Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   2, Avg loss: 0.0330, Accuracy: 324/818 (39.6088%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.1794, Accuracy: 72/10000 (0.7200%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0881, Accuracy: 22/486 (4.5267%)
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0436, Accuracy: 216/486 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.9265, Accuracy: 54/10000 (0.5400%)
time spent on training: 266.57738757133484
[rfa agg] training data poison_ratio: 0.12517385257301808  data num: [719, 1241, 1949, 85, 408, 1089, 599, 1953, 818, 486]
[rfa agg] considering poison per batch poison_fraction: 0.03911682892906815
[rfa agg] init. name: [41, 72, 21, 61, 36, 59, 95, 83, 71, 30], weight: tensor([0.0769, 0.1328, 0.2085, 0.0091, 0.0437, 0.1165, 0.0641, 0.2089, 0.0875,
        0.0520])
[rfa agg] iter:  0, prev_obj_val: 85.85651397705078, obj_val: 87.83580780029297, abs dis: 1.9792938232421875
[rfa agg] iter: 0, weight: tensor([0.0801, 0.2904, 0.1178, 0.0038, 0.0278, 0.1606, 0.0529, 0.1223, 0.1080,
        0.0362])
[rfa agg] iter:  1, prev_obj_val: 87.83580780029297, obj_val: 88.86219024658203, abs dis: 1.0263824462890625
[rfa agg] iter: 1, weight: tensor([0.0966, 0.2534, 0.1035, 0.0041, 0.0310, 0.1666, 0.0618, 0.1078, 0.1345,
        0.0408])
[rfa agg] iter:  2, prev_obj_val: 88.86219024658203, obj_val: 90.00529479980469, abs dis: 1.1431045532226562
[rfa agg] iter: 2, weight: tensor([0.1053, 0.2283, 0.1008, 0.0042, 0.0327, 0.1653, 0.0661, 0.1048, 0.1492,
        0.0433])
[rfa agg] iter:  3, prev_obj_val: 90.00529479980469, obj_val: 89.99937438964844, abs dis: 0.00592041015625
[rfa agg] iter: 3, weight: tensor([0.1141, 0.2069, 0.0977, 0.0043, 0.0343, 0.1602, 0.0704, 0.1014, 0.1649,
        0.0457])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.0406, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 6.7769, Accuracy: 0/9950 (0.0000%)
saving model
Done in 516.6864342689514 sec.
Server Epoch:79 choose agents : [33, 1, 76, 57, 89, 55, 42, 31, 95, 22].
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0868, Accuracy: 33/515 (6.4078%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0553, Accuracy: 133/515 (25.8252%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.0373, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0785, Accuracy: 217/928 (23.3836%)
_Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0272, Accuracy: 511/928 (55.0647%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.8250, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   1, Avg loss: 0.0993, Accuracy: 5/466 (1.0730%)
_Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   2, Avg loss: 0.0520, Accuracy: 147/466 (31.5451%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.3994, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   1, Avg loss: 0.0682, Accuracy: 271/1154 (23.4835%)
_Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   2, Avg loss: 0.0340, Accuracy: 408/1154 (35.3553%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.7631, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   1, Avg loss: 0.0790, Accuracy: 217/896 (24.2188%)
_Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   2, Avg loss: 0.0407, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0376, Accuracy: 60/10000 (0.6000%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   1, Avg loss: 0.0590, Accuracy: 226/1071 (21.1018%)
_Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   2, Avg loss: 0.0318, Accuracy: 466/1071 (43.5107%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.3370, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   1, Avg loss: 0.0748, Accuracy: 162/1372 (11.8076%)
_Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   2, Avg loss: 0.0346, Accuracy: 468/1372 (34.1108%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.3970, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   1, Avg loss: 0.0956, Accuracy: 15/460 (3.2609%)
_Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   2, Avg loss: 0.0425, Accuracy: 158/460 (34.3478%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.6553, Accuracy: 52/10000 (0.5200%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0608, Accuracy: 228/599 (38.0634%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0316, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 13.5612, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   1, Avg loss: 0.0544, Accuracy: 414/1470 (28.1633%)
_Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   2, Avg loss: 0.0256, Accuracy: 783/1470 (53.2653%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.2713, Accuracy: 101/10000 (1.0100%)
time spent on training: 256.0661816596985
[rfa agg] training data poison_ratio: 0.18698913895420446  data num: [515, 928, 466, 1154, 896, 1071, 1372, 460, 599, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.05843410592318889
[rfa agg] init. name: [33, 1, 76, 57, 89, 55, 42, 31, 95, 22], weight: tensor([0.0577, 0.1039, 0.0522, 0.1292, 0.1003, 0.1199, 0.1536, 0.0515, 0.0671,
        0.1646])
[rfa agg] iter:  0, prev_obj_val: 57.70471954345703, obj_val: 62.479469299316406, abs dis: 4.774749755859375
[rfa agg] iter: 0, weight: tensor([0.0505, 0.1517, 0.0431, 0.0990, 0.2072, 0.1439, 0.0967, 0.0421, 0.0718,
        0.0940])
[rfa agg] iter:  1, prev_obj_val: 62.479469299316406, obj_val: 64.50658416748047, abs dis: 2.0271148681640625
[rfa agg] iter: 1, weight: tensor([0.0637, 0.1416, 0.0561, 0.0877, 0.2074, 0.1226, 0.0863, 0.0542, 0.0959,
        0.0845])
[rfa agg] iter:  2, prev_obj_val: 64.50658416748047, obj_val: 62.45579528808594, abs dis: 2.0507888793945312
[rfa agg] iter: 2, weight: tensor([0.0706, 0.1341, 0.0630, 0.0855, 0.1931, 0.1161, 0.0844, 0.0608, 0.1094,
        0.0830])
[rfa agg] iter:  3, prev_obj_val: 62.45579528808594, obj_val: 64.5044937133789, abs dis: 2.0486984252929688
[rfa agg] iter: 3, weight: tensor([0.0647, 0.1395, 0.0566, 0.0871, 0.2068, 0.1208, 0.0859, 0.0549, 0.0995,
        0.0842])
[rfa agg] iter:  4, prev_obj_val: 64.5044937133789, obj_val: 62.455955505371094, abs dis: 2.0485382080078125
[rfa agg] iter: 4, weight: tensor([0.0706, 0.1339, 0.0630, 0.0855, 0.1931, 0.1160, 0.0844, 0.0608, 0.1098,
        0.0829])
[rfa agg] iter:  5, prev_obj_val: 62.455955505371094, obj_val: 64.50448608398438, abs dis: 2.0485305786132812
[rfa agg] iter: 5, weight: tensor([0.0647, 0.1394, 0.0566, 0.0871, 0.2068, 0.1208, 0.0859, 0.0549, 0.0995,
        0.0842])
[rfa agg] iter:  6, prev_obj_val: 64.50448608398438, obj_val: 62.455955505371094, abs dis: 2.0485305786132812
[rfa agg] iter: 6, weight: tensor([0.0706, 0.1339, 0.0630, 0.0855, 0.1931, 0.1160, 0.0844, 0.0608, 0.1098,
        0.0829])
[rfa agg] iter:  7, prev_obj_val: 62.455955505371094, obj_val: 64.50448608398438, abs dis: 2.0485305786132812
[rfa agg] iter: 7, weight: tensor([0.0647, 0.1394, 0.0566, 0.0871, 0.2068, 0.1208, 0.0859, 0.0549, 0.0995,
        0.0842])
[rfa agg] iter:  8, prev_obj_val: 64.50448608398438, obj_val: 62.455955505371094, abs dis: 2.0485305786132812
[rfa agg] iter: 8, weight: tensor([0.0706, 0.1339, 0.0630, 0.0855, 0.1931, 0.1160, 0.0844, 0.0608, 0.1098,
        0.0829])
[rfa agg] iter:  9, prev_obj_val: 62.455955505371094, obj_val: 64.50448608398438, abs dis: 2.0485305786132812
[rfa agg] iter: 9, weight: tensor([0.0647, 0.1394, 0.0566, 0.0871, 0.2068, 0.1208, 0.0859, 0.0549, 0.0995,
        0.0842])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.0058, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 6.1991, Accuracy: 0/9950 (0.0000%)
saving model
Done in 512.3287122249603 sec.
Server Epoch:80 choose agents : [15, 82, 40, 18, 44, 37, 29, 63, 0, 22].
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   1, Avg loss: 0.0644, Accuracy: 254/1154 (22.0104%)
_Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   2, Avg loss: 0.0307, Accuracy: 448/1154 (38.8215%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.2198, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   1, Avg loss: 0.0824, Accuracy: 33/500 (6.6000%)
_Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   2, Avg loss: 0.0545, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.1984, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   1, Avg loss: 0.0579, Accuracy: 280/1573 (17.8004%)
_Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   2, Avg loss: 0.0371, Accuracy: 521/1573 (33.1214%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.5441, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   1, Avg loss: 0.0750, Accuracy: 86/530 (16.2264%)
_Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   2, Avg loss: 0.0399, Accuracy: 276/530 (52.0755%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.8663, Accuracy: 64/10000 (0.6400%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   1, Avg loss: 0.0721, Accuracy: 301/1750 (17.2000%)
_Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   2, Avg loss: 0.0406, Accuracy: 589/1750 (33.6571%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.0910, Accuracy: 109/10000 (1.0900%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   1, Avg loss: 0.0668, Accuracy: 262/1129 (23.2064%)
_Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   2, Avg loss: 0.0276, Accuracy: 677/1129 (59.9646%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.8319, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   1, Avg loss: 0.0692, Accuracy: 287/1440 (19.9306%)
_Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   2, Avg loss: 0.0301, Accuracy: 655/1440 (45.4861%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.1719, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   1, Avg loss: 0.0687, Accuracy: 167/888 (18.8063%)
_Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   2, Avg loss: 0.0290, Accuracy: 433/888 (48.7613%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.8594, Accuracy: 73/10000 (0.7300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   1, Avg loss: 0.0727, Accuracy: 276/1657 (16.6566%)
_Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   2, Avg loss: 0.0390, Accuracy: 436/1657 (26.3126%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.9497, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   1, Avg loss: 0.0547, Accuracy: 384/1470 (26.1224%)
_Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   2, Avg loss: 0.0261, Accuracy: 779/1470 (52.9932%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.6891, Accuracy: 81/10000 (0.8100%)
time spent on training: 296.03895711898804
[rfa agg] training data poison_ratio: 0.47059796542883137  data num: [1154, 500, 1573, 530, 1750, 1129, 1440, 888, 1657, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.1470618641965098
[rfa agg] init. name: [15, 82, 40, 18, 44, 37, 29, 63, 0, 22], weight: tensor([0.0954, 0.0414, 0.1301, 0.0438, 0.1447, 0.0934, 0.1191, 0.0734, 0.1370,
        0.1216])
[rfa agg] iter:  0, prev_obj_val: 59.9022102355957, obj_val: 61.376853942871094, abs dis: 1.4746437072753906
[rfa agg] iter: 0, weight: tensor([0.1140, 0.0210, 0.1218, 0.0242, 0.0931, 0.1494, 0.1437, 0.0708, 0.1100,
        0.1520])
[rfa agg] iter:  1, prev_obj_val: 61.376853942871094, obj_val: 61.369110107421875, abs dis: 0.00774383544921875
[rfa agg] iter: 1, weight: tensor([0.1187, 0.0221, 0.1154, 0.0256, 0.0890, 0.1669, 0.1373, 0.0770, 0.1042,
        0.1437])
[rfa agg] iter:  2, prev_obj_val: 61.369110107421875, obj_val: 61.36893844604492, abs dis: 0.000171661376953125
[rfa agg] iter: 2, weight: tensor([0.1193, 0.0221, 0.1150, 0.0255, 0.0886, 0.1700, 0.1364, 0.0770, 0.1036,
        0.1424])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 56.3877, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 25.8520, Accuracy: 6/9950 (0.0603%)
saving model
Done in 544.0897018909454 sec.
Server Epoch:81 choose agents : [62, 5, 56, 60, 10, 20, 90, 87, 72, 49].
_Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   1, Avg loss: 0.0764, Accuracy: 74/568 (13.0282%)
_Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   2, Avg loss: 0.0430, Accuracy: 260/568 (45.7746%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.3636, Accuracy: 54/10000 (0.5400%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   1, Avg loss: 0.0574, Accuracy: 299/1628 (18.3661%)
_Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   2, Avg loss: 0.0289, Accuracy: 689/1628 (42.3219%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.7318, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   1, Avg loss: 0.0935, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   2, Avg loss: 0.0738, Accuracy: 12/186 (6.4516%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.8252, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0575, Accuracy: 481/2227 (21.5986%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0317, Accuracy: 907/2227 (40.7274%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.4752, Accuracy: 109/10000 (1.0900%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   1, Avg loss: 0.0678, Accuracy: 132/861 (15.3310%)
_Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   2, Avg loss: 0.0237, Accuracy: 427/861 (49.5935%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 12.8240, Accuracy: 76/10000 (0.7600%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   1, Avg loss: 0.0726, Accuracy: 158/807 (19.5787%)
_Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   2, Avg loss: 0.0368, Accuracy: 432/807 (53.5316%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.3023, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0626, Accuracy: 231/677 (34.1211%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0240, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 12.5604, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   1, Avg loss: 0.0647, Accuracy: 208/1131 (18.3908%)
_Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   2, Avg loss: 0.0348, Accuracy: 403/1131 (35.6322%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.6010, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   1, Avg loss: 0.0647, Accuracy: 208/1241 (16.7607%)
_Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   2, Avg loss: 0.0392, Accuracy: 388/1241 (31.2651%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.7973, Accuracy: 60/10000 (0.6000%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0821, Accuracy: 11/440 (2.5000%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0485, Accuracy: 128/440 (29.0909%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.7764, Accuracy: 65/10000 (0.6500%)
time spent on training: 268.9536621570587
[rfa agg] training data poison_ratio: 0.38255171001433547  data num: [568, 1628, 186, 2227, 861, 807, 677, 1131, 1241, 440]
[rfa agg] considering poison per batch poison_fraction: 0.11954740937947983
[rfa agg] init. name: [62, 5, 56, 60, 10, 20, 90, 87, 72, 49], weight: tensor([0.0582, 0.1667, 0.0190, 0.2280, 0.0882, 0.0826, 0.0693, 0.1158, 0.1271,
        0.0451])
[rfa agg] iter:  0, prev_obj_val: 80.74126434326172, obj_val: 81.3367919921875, abs dis: 0.5955276489257812
[rfa agg] iter: 0, weight: tensor([0.0365, 0.1378, 0.0073, 0.0898, 0.0969, 0.0806, 0.0535, 0.2318, 0.2421,
        0.0236])
[rfa agg] iter:  1, prev_obj_val: 81.3367919921875, obj_val: 83.07730865478516, abs dis: 1.7405166625976562
[rfa agg] iter: 1, weight: tensor([0.0390, 0.1070, 0.0072, 0.0751, 0.1159, 0.0923, 0.0590, 0.2733, 0.2067,
        0.0246])
[rfa agg] iter:  2, prev_obj_val: 83.07730865478516, obj_val: 85.41868591308594, abs dis: 2.3413772583007812
[rfa agg] iter: 2, weight: tensor([0.0444, 0.0983, 0.0078, 0.0722, 0.1424, 0.1110, 0.0689, 0.2552, 0.1723,
        0.0273])
[rfa agg] iter:  3, prev_obj_val: 85.41868591308594, obj_val: 89.97555541992188, abs dis: 4.5568695068359375
[rfa agg] iter: 3, weight: tensor([0.0512, 0.0915, 0.0085, 0.0697, 0.1757, 0.1365, 0.0823, 0.2079, 0.1461,
        0.0307])
[rfa agg] iter:  4, prev_obj_val: 89.97555541992188, obj_val: 88.24649047851562, abs dis: 1.72906494140625
[rfa agg] iter: 4, weight: tensor([0.0624, 0.0794, 0.0092, 0.0636, 0.2052, 0.1758, 0.1070, 0.1479, 0.1140,
        0.0356])
[rfa agg] iter:  5, prev_obj_val: 88.24649047851562, obj_val: 88.24411010742188, abs dis: 0.00238037109375
[rfa agg] iter: 5, weight: tensor([0.0577, 0.0820, 0.0088, 0.0647, 0.2075, 0.1700, 0.0980, 0.1575, 0.1202,
        0.0335])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.9936, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 6.2670, Accuracy: 0/9950 (0.0000%)
saving model
Done in 514.2371542453766 sec.
Server Epoch:82 choose agents : [89, 71, 15, 22, 28, 59, 44, 72, 5, 64].
_Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   1, Avg loss: 0.0747, Accuracy: 235/896 (26.2277%)
_Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   2, Avg loss: 0.0406, Accuracy: 445/896 (49.6652%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.7119, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   1, Avg loss: 0.0695, Accuracy: 113/818 (13.8142%)
_Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   2, Avg loss: 0.0323, Accuracy: 297/818 (36.3081%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.1209, Accuracy: 61/10000 (0.6100%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   1, Avg loss: 0.0665, Accuracy: 236/1154 (20.4506%)
_Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   2, Avg loss: 0.0331, Accuracy: 392/1154 (33.9688%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 11.5976, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   1, Avg loss: 0.0512, Accuracy: 424/1470 (28.8435%)
_Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   2, Avg loss: 0.0264, Accuracy: 774/1470 (52.6531%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.3604, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0579, Accuracy: 336/1581 (21.2524%)
_Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0359, Accuracy: 502/1581 (31.7521%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.8763, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0638, Accuracy: 271/1089 (24.8852%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0360, Accuracy: 470/1089 (43.1589%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.4670, Accuracy: 88/10000 (0.8800%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0688, Accuracy: 321/1750 (18.3429%)
_Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0400, Accuracy: 576/1750 (32.9143%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.3994, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0640, Accuracy: 233/1241 (18.7752%)
_Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0403, Accuracy: 367/1241 (29.5729%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.2848, Accuracy: 60/10000 (0.6000%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   1, Avg loss: 0.0557, Accuracy: 340/1628 (20.8845%)
_Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   2, Avg loss: 0.0292, Accuracy: 678/1628 (41.6462%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.6697, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0749, Accuracy: 129/953 (13.5362%)
_Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0439, Accuracy: 290/953 (30.4302%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.5678, Accuracy: 71/10000 (0.7100%)
time spent on training: 319.46835494041443
[rfa agg] training data poison_ratio: 0.3602543720190779  data num: [896, 818, 1154, 1470, 1581, 1089, 1750, 1241, 1628, 953]
[rfa agg] considering poison per batch poison_fraction: 0.11257949125596184
[rfa agg] init. name: [89, 71, 15, 22, 28, 59, 44, 72, 5, 64], weight: tensor([0.0712, 0.0650, 0.0917, 0.1169, 0.1257, 0.0866, 0.1391, 0.0986, 0.1294,
        0.0758])
[rfa agg] iter:  0, prev_obj_val: 59.703094482421875, obj_val: 62.810508728027344, abs dis: 3.1074142456054688
[rfa agg] iter: 0, weight: tensor([0.0760, 0.0614, 0.1131, 0.1249, 0.1051, 0.0819, 0.0812, 0.1624, 0.0941,
        0.0999])
[rfa agg] iter:  1, prev_obj_val: 62.810508728027344, obj_val: 62.797237396240234, abs dis: 0.013271331787109375
[rfa agg] iter: 1, weight: tensor([0.0899, 0.0720, 0.1135, 0.1115, 0.0950, 0.0824, 0.0753, 0.1520, 0.0861,
        0.1222])
[rfa agg] iter:  2, prev_obj_val: 62.797237396240234, obj_val: 62.79716491699219, abs dis: 7.2479248046875e-05
[rfa agg] iter: 2, weight: tensor([0.0906, 0.0723, 0.1138, 0.1108, 0.0947, 0.0823, 0.0751, 0.1505, 0.0858,
        0.1240])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.0029, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 6.6234, Accuracy: 0/9950 (0.0000%)
saving model
Done in 556.3637557029724 sec.
Server Epoch:83 choose agents : [44, 18, 70, 97, 43, 93, 72, 24, 56, 94].
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0682, Accuracy: 332/1750 (18.9714%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0400, Accuracy: 610/1750 (34.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.3912, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.0763, Accuracy: 82/530 (15.4717%)
_Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0426, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.5762, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   1, Avg loss: 0.0667, Accuracy: 266/1418 (18.7588%)
_Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   2, Avg loss: 0.0346, Accuracy: 547/1418 (38.5755%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.1946, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   1, Avg loss: 0.0534, Accuracy: 299/1213 (24.6496%)
_Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   2, Avg loss: 0.0292, Accuracy: 481/1213 (39.6538%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.3988, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0720, Accuracy: 176/946 (18.6047%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0383, Accuracy: 359/946 (37.9493%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.3505, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0636, Accuracy: 291/1742 (16.7049%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0335, Accuracy: 652/1742 (37.4282%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.0983, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   1, Avg loss: 0.0623, Accuracy: 228/1241 (18.3723%)
_Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   2, Avg loss: 0.0405, Accuracy: 362/1241 (29.1700%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4904, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   1, Avg loss: 0.0895, Accuracy: 3/312 (0.9615%)
_Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   2, Avg loss: 0.0466, Accuracy: 129/312 (41.3462%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.9045, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0891, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0727, Accuracy: 15/186 (8.0645%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.6828, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0698, Accuracy: 253/1662 (15.2226%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0387, Accuracy: 491/1662 (29.5427%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.1168, Accuracy: 93/10000 (0.9300%)
time spent on training: 254.3524124622345
[rfa agg] training data poison_ratio: 0.1590909090909091  data num: [1750, 530, 1418, 1213, 946, 1742, 1241, 312, 186, 1662]
[rfa agg] considering poison per batch poison_fraction: 0.04971590909090909
[rfa agg] init. name: [44, 18, 70, 97, 43, 93, 72, 24, 56, 94], weight: tensor([0.1591, 0.0482, 0.1289, 0.1103, 0.0860, 0.1584, 0.1128, 0.0284, 0.0169,
        0.1511])
[rfa agg] iter:  0, prev_obj_val: 67.197265625, obj_val: 65.27671813964844, abs dis: 1.9205474853515625
[rfa agg] iter: 0, weight: tensor([0.1013, 0.0287, 0.1488, 0.1943, 0.1047, 0.1009, 0.1860, 0.0122, 0.0062,
        0.1169])
[rfa agg] iter:  1, prev_obj_val: 65.27671813964844, obj_val: 66.90886688232422, abs dis: 1.6321487426757812
[rfa agg] iter: 1, weight: tensor([0.0993, 0.0259, 0.1523, 0.2018, 0.0921, 0.0989, 0.1976, 0.0111, 0.0057,
        0.1153])
[rfa agg] iter:  2, prev_obj_val: 66.90886688232422, obj_val: 66.90648651123047, abs dis: 0.00238037109375
[rfa agg] iter: 2, weight: tensor([0.0963, 0.0276, 0.1444, 0.2098, 0.1003, 0.0960, 0.1968, 0.0117, 0.0059,
        0.1111])
[rfa agg] iter:  3, prev_obj_val: 66.90648651123047, obj_val: 65.2744369506836, abs dis: 1.632049560546875
[rfa agg] iter: 3, weight: tensor([0.0961, 0.0275, 0.1437, 0.2114, 0.1004, 0.0957, 0.1968, 0.0117, 0.0059,
        0.1107])
[rfa agg] iter:  4, prev_obj_val: 65.2744369506836, obj_val: 68.75334930419922, abs dis: 3.478912353515625
[rfa agg] iter: 4, weight: tensor([0.0986, 0.0258, 0.1508, 0.2049, 0.0913, 0.0982, 0.1992, 0.0111, 0.0056,
        0.1144])
[rfa agg] iter:  5, prev_obj_val: 68.75334930419922, obj_val: 65.27902221679688, abs dis: 3.4743270874023438
[rfa agg] iter: 5, weight: tensor([0.0945, 0.0296, 0.1382, 0.2134, 0.1109, 0.0941, 0.1924, 0.0124, 0.0063,
        0.1082])
[rfa agg] iter:  6, prev_obj_val: 65.27902221679688, obj_val: 68.75308990478516, abs dis: 3.4740676879882812
[rfa agg] iter: 6, weight: tensor([0.0986, 0.0258, 0.1505, 0.2054, 0.0917, 0.0982, 0.1987, 0.0111, 0.0057,
        0.1143])
[rfa agg] iter:  7, prev_obj_val: 68.75308990478516, obj_val: 65.27903747558594, abs dis: 3.4740524291992188
[rfa agg] iter: 7, weight: tensor([0.0945, 0.0296, 0.1382, 0.2135, 0.1110, 0.0941, 0.1923, 0.0124, 0.0063,
        0.1082])
[rfa agg] iter:  8, prev_obj_val: 65.27903747558594, obj_val: 68.75308990478516, abs dis: 3.4740524291992188
[rfa agg] iter: 8, weight: tensor([0.0986, 0.0258, 0.1505, 0.2054, 0.0917, 0.0982, 0.1987, 0.0111, 0.0057,
        0.1143])
[rfa agg] iter:  9, prev_obj_val: 68.75308990478516, obj_val: 65.27904510498047, abs dis: 3.4740447998046875
[rfa agg] iter: 9, weight: tensor([0.0945, 0.0296, 0.1382, 0.2135, 0.1110, 0.0941, 0.1923, 0.0124, 0.0063,
        0.1082])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 15.2442, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 11.2625, Accuracy: 2/9950 (0.0201%)
saving model
Done in 501.59262323379517 sec.
Server Epoch:84 choose agents : [16, 36, 51, 77, 39, 2, 42, 68, 53, 88].
_Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   1, Avg loss: 0.0693, Accuracy: 176/708 (24.8588%)
_Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   2, Avg loss: 0.0377, Accuracy: 429/708 (60.5932%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.5769, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   1, Avg loss: 0.1033, Accuracy: 5/408 (1.2255%)
_Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   2, Avg loss: 0.0597, Accuracy: 118/408 (28.9216%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.3008, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   1, Avg loss: 0.0788, Accuracy: 140/1049 (13.3460%)
_Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   2, Avg loss: 0.0339, Accuracy: 458/1049 (43.6606%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.7424, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   1, Avg loss: 0.0610, Accuracy: 256/1340 (19.1045%)
_Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   2, Avg loss: 0.0300, Accuracy: 480/1340 (35.8209%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.0814, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   1, Avg loss: 0.0524, Accuracy: 235/1013 (23.1984%)
_Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   2, Avg loss: 0.0278, Accuracy: 475/1013 (46.8904%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.1922, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0827, Accuracy: 116/605 (19.1736%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0511, Accuracy: 324/605 (53.5537%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.9712, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   1, Avg loss: 0.0763, Accuracy: 162/1372 (11.8076%)
_Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   2, Avg loss: 0.0355, Accuracy: 447/1372 (32.5802%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.8396, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   1, Avg loss: 0.0667, Accuracy: 299/1163 (25.7094%)
_Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   2, Avg loss: 0.0409, Accuracy: 465/1163 (39.9828%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.2802, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0525, Accuracy: 208/813 (25.5843%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0198, Accuracy: 463/813 (56.9496%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 13.7318, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.0846, Accuracy: 71/603 (11.7745%)
_Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0488, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.6131, Accuracy: 49/10000 (0.4900%)
time spent on training: 217.3279092311859
[rfa agg] training data poison_ratio: 0.0  data num: [708, 408, 1049, 1340, 1013, 605, 1372, 1163, 813, 603]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 36, 51, 77, 39, 2, 42, 68, 53, 88], weight: tensor([0.0780, 0.0450, 0.1156, 0.1477, 0.1116, 0.0667, 0.1512, 0.1282, 0.0896,
        0.0665])
[rfa agg] iter:  0, prev_obj_val: 53.78076171875, obj_val: 58.950218200683594, abs dis: 5.169456481933594
[rfa agg] iter: 0, weight: tensor([0.1109, 0.0326, 0.1098, 0.0907, 0.1449, 0.0771, 0.0857, 0.1012, 0.1685,
        0.0786])
[rfa agg] iter:  1, prev_obj_val: 58.950218200683594, obj_val: 55.12668228149414, abs dis: 3.823535919189453
[rfa agg] iter: 1, weight: tensor([0.1271, 0.0405, 0.0914, 0.0774, 0.1169, 0.1040, 0.0739, 0.0840, 0.1777,
        0.1073])
[rfa agg] iter:  2, prev_obj_val: 55.12668228149414, obj_val: 56.89329147338867, abs dis: 1.7666091918945312
[rfa agg] iter: 2, weight: tensor([0.1200, 0.0342, 0.0979, 0.0819, 0.1319, 0.0855, 0.0782, 0.0907, 0.1929,
        0.0869])
[rfa agg] iter:  3, prev_obj_val: 56.89329147338867, obj_val: 61.15810775756836, abs dis: 4.2648162841796875
[rfa agg] iter: 3, weight: tensor([0.1242, 0.0369, 0.0937, 0.0790, 0.1234, 0.0938, 0.0754, 0.0865, 0.1912,
        0.0959])
[rfa agg] iter:  4, prev_obj_val: 61.15810775756836, obj_val: 56.90410614013672, abs dis: 4.254001617431641
[rfa agg] iter: 4, weight: tensor([0.1287, 0.0442, 0.0860, 0.0742, 0.1079, 0.1172, 0.0711, 0.0797, 0.1699,
        0.1212])
[rfa agg] iter:  5, prev_obj_val: 56.90410614013672, obj_val: 58.9043083190918, abs dis: 2.000202178955078
[rfa agg] iter: 5, weight: tensor([0.1257, 0.0370, 0.0927, 0.0784, 0.1218, 0.0959, 0.0751, 0.0860, 0.1897,
        0.0978])
[rfa agg] iter:  6, prev_obj_val: 58.9043083190918, obj_val: 55.12950134277344, abs dis: 3.7748069763183594
[rfa agg] iter: 6, weight: tensor([0.1283, 0.0402, 0.0892, 0.0761, 0.1146, 0.1054, 0.0729, 0.0826, 0.1824,
        0.1082])
[rfa agg] iter:  7, prev_obj_val: 55.12950134277344, obj_val: 56.89310836791992, abs dis: 1.7636070251464844
[rfa agg] iter: 7, weight: tensor([0.1200, 0.0341, 0.0975, 0.0817, 0.1316, 0.0855, 0.0781, 0.0905, 0.1940,
        0.0869])
[rfa agg] iter:  8, prev_obj_val: 56.89310836791992, obj_val: 61.158103942871094, abs dis: 4.264995574951172
[rfa agg] iter: 8, weight: tensor([0.1242, 0.0368, 0.0937, 0.0789, 0.1234, 0.0938, 0.0754, 0.0865, 0.1915,
        0.0959])
[rfa agg] iter:  9, prev_obj_val: 61.158103942871094, obj_val: 56.90410614013672, abs dis: 4.253997802734375
[rfa agg] iter: 9, weight: tensor([0.1287, 0.0442, 0.0859, 0.0742, 0.1079, 0.1172, 0.0710, 0.0797, 0.1699,
        0.1212])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 14.0438, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 9.9495, Accuracy: 6/9950 (0.0603%)
saving model
Done in 468.73278546333313 sec.
Server Epoch:85 choose agents : [30, 92, 55, 31, 64, 72, 67, 34, 45, 53].
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0840, Accuracy: 22/486 (4.5267%)
_Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0425, Accuracy: 216/486 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.1169, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   1, Avg loss: 0.0667, Accuracy: 320/1715 (18.6589%)
_Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   2, Avg loss: 0.0344, Accuracy: 594/1715 (34.6356%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.9253, Accuracy: 77/10000 (0.7700%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   1, Avg loss: 0.0603, Accuracy: 232/1071 (21.6620%)
_Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   2, Avg loss: 0.0310, Accuracy: 510/1071 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.0043, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0934, Accuracy: 11/460 (2.3913%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0435, Accuracy: 167/460 (36.3043%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.7112, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0720, Accuracy: 125/953 (13.1165%)
_Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0432, Accuracy: 305/953 (32.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.4319, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   1, Avg loss: 0.0631, Accuracy: 208/1241 (16.7607%)
_Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   2, Avg loss: 0.0398, Accuracy: 400/1241 (32.2321%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.4982, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   1, Avg loss: 0.0972, Accuracy: 5/426 (1.1737%)
_Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   2, Avg loss: 0.0495, Accuracy: 146/426 (34.2723%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.0876, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   1, Avg loss: 0.0616, Accuracy: 353/1427 (24.7372%)
_Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   2, Avg loss: 0.0357, Accuracy: 552/1427 (38.6826%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.5465, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   1, Avg loss: 0.0759, Accuracy: 117/669 (17.4888%)
_Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   2, Avg loss: 0.0444, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.9601, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   1, Avg loss: 0.0513, Accuracy: 225/813 (27.6753%)
_Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 13.7163, Accuracy: 59/10000 (0.5900%)
time spent on training: 254.3084638118744
[rfa agg] training data poison_ratio: 0.16812439261418854  data num: [486, 1715, 1071, 460, 953, 1241, 426, 1427, 669, 813]
[rfa agg] considering poison per batch poison_fraction: 0.05253887269193392
[rfa agg] init. name: [30, 92, 55, 31, 64, 72, 67, 34, 45, 53], weight: tensor([0.0525, 0.1852, 0.1156, 0.0497, 0.1029, 0.1340, 0.0460, 0.1541, 0.0722,
        0.0878])
[rfa agg] iter:  0, prev_obj_val: 62.814083099365234, obj_val: 65.8736572265625, abs dis: 3.0595741271972656
[rfa agg] iter: 0, weight: tensor([0.0362, 0.0835, 0.1699, 0.0342, 0.2109, 0.1376, 0.0282, 0.1023, 0.0740,
        0.1232])
[rfa agg] iter:  1, prev_obj_val: 65.8736572265625, obj_val: 69.24462127685547, abs dis: 3.3709640502929688
[rfa agg] iter: 1, weight: tensor([0.0421, 0.0714, 0.1431, 0.0401, 0.2276, 0.1079, 0.0322, 0.0843, 0.0928,
        0.1584])
[rfa agg] iter:  2, prev_obj_val: 69.24462127685547, obj_val: 73.38826751708984, abs dis: 4.143646240234375
[rfa agg] iter: 2, weight: tensor([0.0502, 0.0688, 0.1247, 0.0480, 0.1950, 0.0973, 0.0378, 0.0792, 0.1155,
        0.1836])
[rfa agg] iter:  3, prev_obj_val: 73.38826751708984, obj_val: 75.70631408691406, abs dis: 2.3180465698242188
[rfa agg] iter: 3, weight: tensor([0.0618, 0.0675, 0.1118, 0.0591, 0.1597, 0.0904, 0.0457, 0.0760, 0.1430,
        0.1852])
[rfa agg] iter:  4, prev_obj_val: 75.70631408691406, obj_val: 71.21959686279297, abs dis: 4.486717224121094
[rfa agg] iter: 4, weight: tensor([0.0695, 0.0668, 0.1061, 0.0662, 0.1448, 0.0872, 0.0506, 0.0745, 0.1586,
        0.1758])
[rfa agg] iter:  5, prev_obj_val: 71.21959686279297, obj_val: 73.36943054199219, abs dis: 2.1498336791992188
[rfa agg] iter: 5, weight: tensor([0.0563, 0.0677, 0.1161, 0.0535, 0.1687, 0.0927, 0.0418, 0.0770, 0.1365,
        0.1896])
[rfa agg] iter:  6, prev_obj_val: 73.36943054199219, obj_val: 75.70515441894531, abs dis: 2.335723876953125
[rfa agg] iter: 6, weight: tensor([0.0620, 0.0672, 0.1111, 0.0591, 0.1573, 0.0899, 0.0457, 0.0757, 0.1460,
        0.1861])
[rfa agg] iter:  7, prev_obj_val: 75.70515441894531, obj_val: 71.21986389160156, abs dis: 4.48529052734375
[rfa agg] iter: 7, weight: tensor([0.0695, 0.0667, 0.1060, 0.0662, 0.1446, 0.0872, 0.0506, 0.0744, 0.1590,
        0.1758])
[rfa agg] iter:  8, prev_obj_val: 71.21986389160156, obj_val: 73.3694076538086, abs dis: 2.1495437622070312
[rfa agg] iter: 8, weight: tensor([0.0563, 0.0677, 0.1161, 0.0535, 0.1687, 0.0927, 0.0418, 0.0770, 0.1365,
        0.1896])
[rfa agg] iter:  9, prev_obj_val: 73.3694076538086, obj_val: 75.70514678955078, abs dis: 2.3357391357421875
[rfa agg] iter: 9, weight: tensor([0.0620, 0.0672, 0.1111, 0.0591, 0.1573, 0.0899, 0.0457, 0.0757, 0.1460,
        0.1861])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 15.6248, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 10.7672, Accuracy: 8/9950 (0.0804%)
saving model
Done in 498.286328792572 sec.
Server Epoch:86 choose agents : [2, 18, 97, 3, 99, 22, 44, 9, 74, 92].
_Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0825, Accuracy: 105/605 (17.3554%)
_Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0495, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.4871, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   1, Avg loss: 0.0796, Accuracy: 70/530 (13.2075%)
_Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   2, Avg loss: 0.0430, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.3427, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 299/1213 (24.6496%)
_Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   2, Avg loss: 0.0296, Accuracy: 464/1213 (38.2523%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.3870, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0872, Accuracy: 42/781 (5.3777%)
_Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0403, Accuracy: 236/781 (30.2177%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.9193, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0637, Accuracy: 171/773 (22.1216%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0323, Accuracy: 400/773 (51.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.2993, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   1, Avg loss: 0.0548, Accuracy: 420/1470 (28.5714%)
_Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   2, Avg loss: 0.0259, Accuracy: 760/1470 (51.7007%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.9156, Accuracy: 96/10000 (0.9600%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0674, Accuracy: 332/1750 (18.9714%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0393, Accuracy: 630/1750 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.3829, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   1, Avg loss: 0.0562, Accuracy: 314/1275 (24.6275%)
_Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   2, Avg loss: 0.0210, Accuracy: 632/1275 (49.5686%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.3105, Accuracy: 95/10000 (0.9500%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0482, Accuracy: 405/1552 (26.0954%)
_Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0231, Accuracy: 724/1552 (46.6495%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.2410, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   1, Avg loss: 0.0664, Accuracy: 334/1715 (19.4752%)
_Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   2, Avg loss: 0.0341, Accuracy: 609/1715 (35.5102%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.3127, Accuracy: 78/10000 (0.7800%)
time spent on training: 297.947185754776
[rfa agg] training data poison_ratio: 0.28309327846364885  data num: [605, 530, 1213, 781, 773, 1470, 1750, 1275, 1552, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.08846664951989026
[rfa agg] init. name: [2, 18, 97, 3, 99, 22, 44, 9, 74, 92], weight: tensor([0.0519, 0.0454, 0.1040, 0.0670, 0.0663, 0.1260, 0.1500, 0.1093, 0.1331,
        0.1470])
[rfa agg] iter:  0, prev_obj_val: 67.8594970703125, obj_val: 69.351806640625, abs dis: 1.4923095703125
[rfa agg] iter: 0, weight: tensor([0.0404, 0.0320, 0.1683, 0.0768, 0.0729, 0.1380, 0.0937, 0.1703, 0.1079,
        0.0997])
[rfa agg] iter:  1, prev_obj_val: 69.351806640625, obj_val: 67.66558074951172, abs dis: 1.6862258911132812
[rfa agg] iter: 1, weight: tensor([0.0430, 0.0338, 0.1737, 0.0834, 0.0783, 0.1304, 0.0893, 0.1703, 0.1030,
        0.0948])
[rfa agg] iter:  2, prev_obj_val: 67.66558074951172, obj_val: 67.66344451904297, abs dis: 0.00213623046875
[rfa agg] iter: 2, weight: tensor([0.0397, 0.0313, 0.1772, 0.0756, 0.0715, 0.1351, 0.0906, 0.1771, 0.1054,
        0.0963])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.0538, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 6.7536, Accuracy: 0/9950 (0.0000%)
saving model
Done in 545.2506065368652 sec.
Server Epoch:87 choose agents : [27, 69, 68, 61, 71, 23, 41, 98, 94, 52].
_Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   1, Avg loss: 0.0662, Accuracy: 363/1587 (22.8733%)
_Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   2, Avg loss: 0.0389, Accuracy: 563/1587 (35.4757%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.1916, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0738, Accuracy: 139/590 (23.5593%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0362, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 14.4589, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0679, Accuracy: 289/1163 (24.8495%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0402, Accuracy: 455/1163 (39.1230%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.5039, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1651, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1515, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.9872, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   1, Avg loss: 0.0732, Accuracy: 94/818 (11.4914%)
_Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   2, Avg loss: 0.0332, Accuracy: 327/818 (39.9756%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.5095, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0712, Accuracy: 209/715 (29.2308%)
_Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0437, Accuracy: 441/715 (61.6783%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.5617, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   1, Avg loss: 0.0650, Accuracy: 201/719 (27.9555%)
_Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   2, Avg loss: 0.0333, Accuracy: 453/719 (63.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.7186, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   1, Avg loss: 0.0928, Accuracy: 2/373 (0.5362%)
_Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   2, Avg loss: 0.0546, Accuracy: 121/373 (32.4397%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.3468, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   1, Avg loss: 0.0686, Accuracy: 257/1662 (15.4633%)
_Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   2, Avg loss: 0.0380, Accuracy: 532/1662 (32.0096%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.1291, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   1, Avg loss: 0.0591, Accuracy: 224/636 (35.2201%)
_Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   2, Avg loss: 0.0314, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.5376, Accuracy: 52/10000 (0.5200%)
time spent on training: 220.14959406852722
[rfa agg] training data poison_ratio: 0.010182079540009582  data num: [1587, 590, 1163, 85, 818, 715, 719, 373, 1662, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0031818998562529945
[rfa agg] init. name: [27, 69, 68, 61, 71, 23, 41, 98, 94, 52], weight: tensor([0.1901, 0.0707, 0.1393, 0.0102, 0.0980, 0.0856, 0.0861, 0.0447, 0.1991,
        0.0762])
[rfa agg] iter:  0, prev_obj_val: 68.36753845214844, obj_val: 69.64618682861328, abs dis: 1.2786483764648438
[rfa agg] iter: 0, weight: tensor([0.1335, 0.0720, 0.1869, 0.0044, 0.1589, 0.1083, 0.1075, 0.0283, 0.1259,
        0.0743])
[rfa agg] iter:  1, prev_obj_val: 69.64618682861328, obj_val: 71.28157043457031, abs dis: 1.6353836059570312
[rfa agg] iter: 1, weight: tensor([0.1064, 0.0827, 0.1474, 0.0044, 0.1962, 0.1254, 0.1221, 0.0300, 0.1013,
        0.0842])
[rfa agg] iter:  2, prev_obj_val: 71.28157043457031, obj_val: 73.80876159667969, abs dis: 2.527191162109375
[rfa agg] iter: 2, weight: tensor([0.0911, 0.0917, 0.1191, 0.0043, 0.2183, 0.1346, 0.1307, 0.0311, 0.0874,
        0.0916])
[rfa agg] iter:  3, prev_obj_val: 73.80876159667969, obj_val: 72.40473937988281, abs dis: 1.404022216796875
[rfa agg] iter: 3, weight: tensor([0.0807, 0.1058, 0.1007, 0.0044, 0.2170, 0.1407, 0.1368, 0.0334, 0.0780,
        0.1024])
[rfa agg] iter:  4, prev_obj_val: 72.40473937988281, obj_val: 73.79927062988281, abs dis: 1.39453125
[rfa agg] iter: 4, weight: tensor([0.0843, 0.0979, 0.1066, 0.0043, 0.2243, 0.1382, 0.1349, 0.0318, 0.0812,
        0.0964])
[rfa agg] iter:  5, prev_obj_val: 73.79927062988281, obj_val: 72.40482330322266, abs dis: 1.3944473266601562
[rfa agg] iter: 5, weight: tensor([0.0803, 0.1057, 0.0999, 0.0044, 0.2187, 0.1406, 0.1371, 0.0333, 0.0776,
        0.1024])
[rfa agg] iter:  6, prev_obj_val: 72.40482330322266, obj_val: 73.79928588867188, abs dis: 1.3944625854492188
[rfa agg] iter: 6, weight: tensor([0.0842, 0.0979, 0.1065, 0.0043, 0.2247, 0.1381, 0.1349, 0.0318, 0.0812,
        0.0963])
[rfa agg] iter:  7, prev_obj_val: 73.79928588867188, obj_val: 72.40481567382812, abs dis: 1.39447021484375
[rfa agg] iter: 7, weight: tensor([0.0803, 0.1057, 0.0998, 0.0044, 0.2188, 0.1405, 0.1371, 0.0333, 0.0776,
        0.1023])
[rfa agg] iter:  8, prev_obj_val: 72.40481567382812, obj_val: 73.79927825927734, abs dis: 1.3944625854492188
[rfa agg] iter: 8, weight: tensor([0.0842, 0.0979, 0.1065, 0.0043, 0.2248, 0.1381, 0.1349, 0.0318, 0.0812,
        0.0963])
[rfa agg] iter:  9, prev_obj_val: 73.79927825927734, obj_val: 72.40482330322266, abs dis: 1.3944549560546875
[rfa agg] iter: 9, weight: tensor([0.0803, 0.1057, 0.0998, 0.0044, 0.2188, 0.1405, 0.1371, 0.0333, 0.0776,
        0.1023])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 20.5268, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 19.5652, Accuracy: 0/9950 (0.0000%)
saving model
Done in 461.21982741355896 sec.
Server Epoch:88 choose agents : [48, 70, 99, 34, 64, 81, 0, 53, 31, 56].
_Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0865, Accuracy: 52/631 (8.2409%)
_Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0475, Accuracy: 236/631 (37.4010%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.8754, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   1, Avg loss: 0.0665, Accuracy: 258/1418 (18.1946%)
_Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   2, Avg loss: 0.0341, Accuracy: 552/1418 (38.9281%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.2852, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   1, Avg loss: 0.0612, Accuracy: 201/773 (26.0026%)
_Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   2, Avg loss: 0.0302, Accuracy: 407/773 (52.6520%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 10.3990, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0602, Accuracy: 340/1427 (23.8262%)
_Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0353, Accuracy: 552/1427 (38.6826%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.3198, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   1, Avg loss: 0.0731, Accuracy: 126/953 (13.2214%)
_Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   2, Avg loss: 0.0424, Accuracy: 314/953 (32.9486%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.5488, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0743, Accuracy: 126/774 (16.2791%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0430, Accuracy: 319/774 (41.2145%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.5640, Accuracy: 62/10000 (0.6200%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   1, Avg loss: 0.0719, Accuracy: 260/1657 (15.6910%)
_Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   2, Avg loss: 0.0385, Accuracy: 428/1657 (25.8298%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.8496, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   1, Avg loss: 0.0494, Accuracy: 227/813 (27.9213%)
_Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   2, Avg loss: 0.0198, Accuracy: 465/813 (57.1956%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 13.2405, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0929, Accuracy: 12/460 (2.6087%)
_Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0421, Accuracy: 173/460 (37.6087%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 11.3686, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   1, Avg loss: 0.0940, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   2, Avg loss: 0.0755, Accuracy: 13/186 (6.9892%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.8511, Accuracy: 45/10000 (0.4500%)
time spent on training: 241.6726906299591
[rfa agg] training data poison_ratio: 0.18224813022437308  data num: [631, 1418, 773, 1427, 953, 774, 1657, 813, 460, 186]
[rfa agg] considering poison per batch poison_fraction: 0.056952540695116585
[rfa agg] init. name: [48, 70, 99, 34, 64, 81, 0, 53, 31, 56], weight: tensor([0.0694, 0.1560, 0.0850, 0.1570, 0.1048, 0.0851, 0.1822, 0.0894, 0.0506,
        0.0205])
[rfa agg] iter:  0, prev_obj_val: 62.70942687988281, obj_val: 64.28520965576172, abs dis: 1.5757827758789062
[rfa agg] iter: 0, weight: tensor([0.0592, 0.1294, 0.0993, 0.1328, 0.2006, 0.1069, 0.1100, 0.1191, 0.0341,
        0.0085])
[rfa agg] iter:  1, prev_obj_val: 64.28520965576172, obj_val: 67.98393249511719, abs dis: 3.6987228393554688
[rfa agg] iter: 1, weight: tensor([0.0653, 0.0978, 0.1088, 0.1001, 0.2332, 0.1230, 0.0859, 0.1414, 0.0361,
        0.0084])
[rfa agg] iter:  2, prev_obj_val: 67.98393249511719, obj_val: 71.73994445800781, abs dis: 3.756011962890625
[rfa agg] iter: 2, weight: tensor([0.0802, 0.0813, 0.1189, 0.0829, 0.1999, 0.1418, 0.0738, 0.1699, 0.0422,
        0.0090])
[rfa agg] iter:  3, prev_obj_val: 71.73994445800781, obj_val: 73.99909210205078, abs dis: 2.2591476440429688
[rfa agg] iter: 3, weight: tensor([0.0982, 0.0762, 0.1236, 0.0776, 0.1635, 0.1481, 0.0705, 0.1823, 0.0500,
        0.0099])
[rfa agg] iter:  4, prev_obj_val: 73.99909210205078, obj_val: 71.7253646850586, abs dis: 2.2737274169921875
[rfa agg] iter: 4, weight: tensor([0.1108, 0.0750, 0.1245, 0.0763, 0.1489, 0.1467, 0.0699, 0.1818, 0.0555,
        0.0106])
[rfa agg] iter:  5, prev_obj_val: 71.7253646850586, obj_val: 73.9979019165039, abs dis: 2.2725372314453125
[rfa agg] iter: 5, weight: tensor([0.0998, 0.0759, 0.1244, 0.0773, 0.1582, 0.1473, 0.0702, 0.1869, 0.0501,
        0.0100])
[rfa agg] iter:  6, prev_obj_val: 73.9979019165039, obj_val: 71.72541809082031, abs dis: 2.2724838256835938
[rfa agg] iter: 6, weight: tensor([0.1109, 0.0749, 0.1246, 0.0762, 0.1484, 0.1463, 0.0698, 0.1828, 0.0555,
        0.0106])
[rfa agg] iter:  7, prev_obj_val: 71.72541809082031, obj_val: 73.99788665771484, abs dis: 2.2724685668945312
[rfa agg] iter: 7, weight: tensor([0.0998, 0.0759, 0.1244, 0.0773, 0.1581, 0.1472, 0.0702, 0.1871, 0.0501,
        0.0100])
[rfa agg] iter:  8, prev_obj_val: 73.99788665771484, obj_val: 71.72543334960938, abs dis: 2.2724533081054688
[rfa agg] iter: 8, weight: tensor([0.1109, 0.0749, 0.1246, 0.0762, 0.1484, 0.1463, 0.0698, 0.1828, 0.0555,
        0.0106])
[rfa agg] iter:  9, prev_obj_val: 71.72543334960938, obj_val: 73.99787902832031, abs dis: 2.2724456787109375
[rfa agg] iter: 9, weight: tensor([0.0998, 0.0759, 0.1244, 0.0773, 0.1581, 0.1472, 0.0702, 0.1871, 0.0501,
        0.0100])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 17.5688, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 17.7886, Accuracy: 0/9950 (0.0000%)
saving model
Done in 489.22306990623474 sec.
Server Epoch:89 choose agents : [39, 68, 73, 96, 98, 22, 75, 79, 34, 43].
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0556, Accuracy: 229/1013 (22.6061%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0302, Accuracy: 438/1013 (43.2379%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.3918, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   1, Avg loss: 0.0687, Accuracy: 279/1163 (23.9897%)
_Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   2, Avg loss: 0.0412, Accuracy: 433/1163 (37.2313%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.4545, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   1, Avg loss: 0.0700, Accuracy: 179/938 (19.0832%)
_Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   2, Avg loss: 0.0375, Accuracy: 303/938 (32.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.5032, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   1, Avg loss: 0.0866, Accuracy: 8/311 (2.5723%)
_Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   2, Avg loss: 0.0551, Accuracy: 101/311 (32.4759%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.5191, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   1, Avg loss: 0.0942, Accuracy: 2/373 (0.5362%)
_Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   2, Avg loss: 0.0558, Accuracy: 119/373 (31.9035%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.8110, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0521, Accuracy: 426/1470 (28.9796%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0258, Accuracy: 758/1470 (51.5646%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.4037, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   1, Avg loss: 0.0602, Accuracy: 290/776 (37.3711%)
_Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   2, Avg loss: 0.0327, Accuracy: 361/776 (46.5206%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.8144, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   1, Avg loss: 0.1339, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   2, Avg loss: 0.1104, Accuracy: 7/197 (3.5533%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.8309, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   1, Avg loss: 0.0604, Accuracy: 355/1427 (24.8774%)
_Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   2, Avg loss: 0.0358, Accuracy: 525/1427 (36.7905%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.5485, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0727, Accuracy: 176/946 (18.6047%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0408, Accuracy: 352/946 (37.2093%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.6784, Accuracy: 66/10000 (0.6600%)
time spent on training: 226.4451596736908
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 1163, 938, 311, 373, 1470, 776, 197, 1427, 946]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 68, 73, 96, 98, 22, 75, 79, 34, 43], weight: tensor([0.1176, 0.1350, 0.1089, 0.0361, 0.0433, 0.1707, 0.0901, 0.0229, 0.1657,
        0.1098])
[rfa agg] iter:  0, prev_obj_val: 55.63574981689453, obj_val: 56.83725357055664, abs dis: 1.2015037536621094
[rfa agg] iter: 0, weight: tensor([0.1776, 0.1227, 0.1588, 0.0165, 0.0219, 0.0969, 0.1190, 0.0094, 0.0958,
        0.1813])
[rfa agg] iter:  1, prev_obj_val: 56.83725357055664, obj_val: 56.828556060791016, abs dis: 0.008697509765625
[rfa agg] iter: 1, weight: tensor([0.1736, 0.1115, 0.1644, 0.0170, 0.0225, 0.0896, 0.1311, 0.0096, 0.0890,
        0.1916])
[rfa agg] iter:  2, prev_obj_val: 56.828556060791016, obj_val: 56.82838821411133, abs dis: 0.0001678466796875
[rfa agg] iter: 2, weight: tensor([0.1720, 0.1102, 0.1652, 0.0169, 0.0224, 0.0891, 0.1324, 0.0095, 0.0885,
        0.1936])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 13.0034, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 12.4463, Accuracy: 3/9950 (0.0302%)
saving model
Done in 487.44266414642334 sec.
Server Epoch:90 choose agents : [0, 96, 92, 51, 57, 32, 6, 53, 79, 37].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   1, Avg loss: 0.0729, Accuracy: 280/1657 (16.8980%)
_Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   2, Avg loss: 0.0390, Accuracy: 423/1657 (25.5281%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.8579, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   1, Avg loss: 0.0892, Accuracy: 3/311 (0.9646%)
_Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   2, Avg loss: 0.0563, Accuracy: 88/311 (28.2958%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.5897, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   1, Avg loss: 0.0672, Accuracy: 331/1715 (19.3003%)
_Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   2, Avg loss: 0.0345, Accuracy: 598/1715 (34.8688%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.9685, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0791, Accuracy: 125/1049 (11.9161%)
_Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0340, Accuracy: 481/1049 (45.8532%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.1844, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   1, Avg loss: 0.0697, Accuracy: 235/1154 (20.3640%)
_Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   2, Avg loss: 0.0320, Accuracy: 397/1154 (34.4021%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 11.4388, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   1, Avg loss: 0.0704, Accuracy: 112/735 (15.2381%)
_Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   2, Avg loss: 0.0264, Accuracy: 364/735 (49.5238%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 12.8799, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   1, Avg loss: 0.0728, Accuracy: 262/1956 (13.3947%)
_Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   2, Avg loss: 0.0350, Accuracy: 576/1956 (29.4479%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.2848, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0474, Accuracy: 238/813 (29.2743%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0200, Accuracy: 466/813 (57.3186%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 13.0076, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   1, Avg loss: 0.1282, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   2, Avg loss: 0.1086, Accuracy: 6/197 (3.0457%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.9319, Accuracy: 51/10000 (0.5100%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   1, Avg loss: 0.0641, Accuracy: 288/1129 (25.5093%)
_Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   2, Avg loss: 0.0269, Accuracy: 669/1129 (59.2560%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.0371, Accuracy: 91/10000 (0.9100%)
time spent on training: 268.4482066631317
[rfa agg] training data poison_ratio: 0.25998506905561775  data num: [1657, 311, 1715, 1049, 1154, 735, 1956, 813, 197, 1129]
[rfa agg] considering poison per batch poison_fraction: 0.08124533407988055
[rfa agg] init. name: [0, 96, 92, 51, 57, 32, 6, 53, 79, 37], weight: tensor([0.1546, 0.0290, 0.1600, 0.0979, 0.1077, 0.0686, 0.1825, 0.0759, 0.0184,
        0.1054])
[rfa agg] iter:  0, prev_obj_val: 72.33183288574219, obj_val: 72.93270111083984, abs dis: 0.6008682250976562
[rfa agg] iter: 0, weight: tensor([0.1426, 0.0134, 0.1313, 0.1352, 0.1334, 0.0595, 0.1064, 0.0743, 0.0078,
        0.1961])
[rfa agg] iter:  1, prev_obj_val: 72.93270111083984, obj_val: 75.07199096679688, abs dis: 2.1392898559570312
[rfa agg] iter: 1, weight: tensor([0.1296, 0.0133, 0.1201, 0.1427, 0.1331, 0.0606, 0.0981, 0.0761, 0.0078,
        0.2185])
[rfa agg] iter:  2, prev_obj_val: 75.07199096679688, obj_val: 76.42524719238281, abs dis: 1.3532562255859375
[rfa agg] iter: 2, weight: tensor([0.1145, 0.0140, 0.1072, 0.1526, 0.1286, 0.0675, 0.0896, 0.0857, 0.0081,
        0.2322])
[rfa agg] iter:  3, prev_obj_val: 76.42524719238281, obj_val: 76.4231185913086, abs dis: 0.00212860107421875
[rfa agg] iter: 3, weight: tensor([0.1086, 0.0144, 0.1021, 0.1576, 0.1252, 0.0721, 0.0863, 0.0923, 0.0084,
        0.2331])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.0167, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 6.7301, Accuracy: 0/9950 (0.0000%)
saving model
Done in 524.6017608642578 sec.
Server Epoch:91 choose agents : [27, 46, 19, 29, 48, 47, 40, 89, 34, 83].
_Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   1, Avg loss: 0.0669, Accuracy: 357/1587 (22.4953%)
_Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   2, Avg loss: 0.0398, Accuracy: 520/1587 (32.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.3834, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   1, Avg loss: 0.0626, Accuracy: 347/1904 (18.2248%)
_Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   2, Avg loss: 0.0334, Accuracy: 664/1904 (34.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.7103, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   1, Avg loss: 0.0594, Accuracy: 292/1036 (28.1853%)
_Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   2, Avg loss: 0.0259, Accuracy: 651/1036 (62.8378%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 13.0889, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   1, Avg loss: 0.0711, Accuracy: 279/1440 (19.3750%)
_Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   2, Avg loss: 0.0307, Accuracy: 643/1440 (44.6528%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.1946, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   1, Avg loss: 0.0840, Accuracy: 53/631 (8.3994%)
_Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   2, Avg loss: 0.0464, Accuracy: 244/631 (38.6688%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.2863, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   1, Avg loss: 0.1257, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   2, Avg loss: 0.1080, Accuracy: 6/134 (4.4776%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.8990, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   1, Avg loss: 0.0632, Accuracy: 278/1573 (17.6732%)
_Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   2, Avg loss: 0.0370, Accuracy: 560/1573 (35.6008%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.4580, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0780, Accuracy: 191/896 (21.3170%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0396, Accuracy: 454/896 (50.6696%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.7912, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0615, Accuracy: 350/1427 (24.5270%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0365, Accuracy: 532/1427 (37.2810%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.3496, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   1, Avg loss: 0.0698, Accuracy: 326/1953 (16.6923%)
_Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   2, Avg loss: 0.0383, Accuracy: 646/1953 (33.0773%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.3699, Accuracy: 104/10000 (1.0400%)
time spent on training: 270.63683128356934
[rfa agg] training data poison_ratio: 0.0  data num: [1587, 1904, 1036, 1440, 631, 134, 1573, 896, 1427, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [27, 46, 19, 29, 48, 47, 40, 89, 34, 83], weight: tensor([0.1261, 0.1513, 0.0823, 0.1145, 0.0502, 0.0107, 0.1250, 0.0712, 0.1134,
        0.1552])
[rfa agg] iter:  0, prev_obj_val: 63.68989562988281, obj_val: 64.80464172363281, abs dis: 1.11474609375
[rfa agg] iter: 0, weight: tensor([0.1566, 0.1011, 0.0790, 0.1538, 0.0246, 0.0032, 0.1585, 0.0507, 0.1804,
        0.0919])
[rfa agg] iter:  1, prev_obj_val: 64.80464172363281, obj_val: 66.4201889038086, abs dis: 1.6155471801757812
[rfa agg] iter: 1, weight: tensor([0.1517, 0.0956, 0.0842, 0.1569, 0.0257, 0.0033, 0.1542, 0.0536, 0.1877,
        0.0872])
[rfa agg] iter:  2, prev_obj_val: 66.4201889038086, obj_val: 64.80425262451172, abs dis: 1.615936279296875
[rfa agg] iter: 2, weight: tensor([0.1465, 0.0946, 0.0931, 0.1563, 0.0277, 0.0035, 0.1486, 0.0589, 0.1841,
        0.0867])
[rfa agg] iter:  3, prev_obj_val: 64.80425262451172, obj_val: 66.41991424560547, abs dis: 1.61566162109375
[rfa agg] iter: 3, weight: tensor([0.1508, 0.0955, 0.0848, 0.1575, 0.0257, 0.0033, 0.1534, 0.0537, 0.1882,
        0.0870])
[rfa agg] iter:  4, prev_obj_val: 66.41991424560547, obj_val: 64.80426788330078, abs dis: 1.6156463623046875
[rfa agg] iter: 4, weight: tensor([0.1465, 0.0946, 0.0931, 0.1563, 0.0277, 0.0035, 0.1485, 0.0589, 0.1842,
        0.0866])
[rfa agg] iter:  5, prev_obj_val: 64.80426788330078, obj_val: 66.41990661621094, abs dis: 1.6156387329101562
[rfa agg] iter: 5, weight: tensor([0.1508, 0.0955, 0.0848, 0.1575, 0.0257, 0.0033, 0.1534, 0.0537, 0.1882,
        0.0870])
[rfa agg] iter:  6, prev_obj_val: 66.41990661621094, obj_val: 64.80426788330078, abs dis: 1.6156387329101562
[rfa agg] iter: 6, weight: tensor([0.1465, 0.0946, 0.0931, 0.1563, 0.0277, 0.0035, 0.1485, 0.0589, 0.1842,
        0.0866])
[rfa agg] iter:  7, prev_obj_val: 64.80426788330078, obj_val: 66.41990661621094, abs dis: 1.6156387329101562
[rfa agg] iter: 7, weight: tensor([0.1508, 0.0955, 0.0848, 0.1575, 0.0257, 0.0033, 0.1534, 0.0537, 0.1882,
        0.0870])
[rfa agg] iter:  8, prev_obj_val: 66.41990661621094, obj_val: 64.80426025390625, abs dis: 1.6156463623046875
[rfa agg] iter: 8, weight: tensor([0.1465, 0.0946, 0.0931, 0.1563, 0.0277, 0.0035, 0.1485, 0.0589, 0.1842,
        0.0866])
[rfa agg] iter:  9, prev_obj_val: 64.80426025390625, obj_val: 66.41990661621094, abs dis: 1.6156463623046875
[rfa agg] iter: 9, weight: tensor([0.1508, 0.0955, 0.0848, 0.1575, 0.0257, 0.0033, 0.1534, 0.0537, 0.1882,
        0.0870])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 15.5308, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 16.0462, Accuracy: 0/9950 (0.0000%)
saving model
Done in 523.4392006397247 sec.
Server Epoch:92 choose agents : [9, 63, 42, 40, 83, 13, 84, 5, 75, 3].
_Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   1, Avg loss: 0.0549, Accuracy: 306/1275 (24.0000%)
_Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   2, Avg loss: 0.0207, Accuracy: 655/1275 (51.3725%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.8551, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   1, Avg loss: 0.0734, Accuracy: 156/888 (17.5676%)
_Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   2, Avg loss: 0.0298, Accuracy: 434/888 (48.8739%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 12.0345, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0787, Accuracy: 150/1372 (10.9329%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0363, Accuracy: 460/1372 (33.5277%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.7568, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0613, Accuracy: 277/1573 (17.6097%)
_Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0383, Accuracy: 488/1573 (31.0235%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.5803, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   1, Avg loss: 0.0706, Accuracy: 290/1953 (14.8490%)
_Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   2, Avg loss: 0.0388, Accuracy: 644/1953 (32.9749%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.2322, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0670, Accuracy: 253/1645 (15.3799%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0365, Accuracy: 576/1645 (35.0152%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.0488, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   1, Avg loss: 0.0720, Accuracy: 210/1190 (17.6471%)
_Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   2, Avg loss: 0.0347, Accuracy: 411/1190 (34.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.0216, Accuracy: 76/10000 (0.7600%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   1, Avg loss: 0.0585, Accuracy: 325/1628 (19.9631%)
_Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   2, Avg loss: 0.0294, Accuracy: 694/1628 (42.6290%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.4073, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0575, Accuracy: 329/776 (42.3969%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0340, Accuracy: 356/776 (45.8763%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.5799, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0820, Accuracy: 41/781 (5.2497%)
_Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0399, Accuracy: 226/781 (28.9373%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.8668, Accuracy: 63/10000 (0.6300%)
time spent on training: 323.40500044822693
[rfa agg] training data poison_ratio: 0.1244553168717988  data num: [1275, 888, 1372, 1573, 1953, 1645, 1190, 1628, 776, 781]
[rfa agg] considering poison per batch poison_fraction: 0.038892286522437126
[rfa agg] init. name: [9, 63, 42, 40, 83, 13, 84, 5, 75, 3], weight: tensor([0.0975, 0.0679, 0.1049, 0.1203, 0.1493, 0.1258, 0.0910, 0.1245, 0.0593,
        0.0597])
[rfa agg] iter:  0, prev_obj_val: 63.707977294921875, obj_val: 63.52130126953125, abs dis: 0.186676025390625
[rfa agg] iter: 0, weight: tensor([0.1514, 0.0638, 0.1483, 0.1209, 0.0816, 0.1080, 0.1166, 0.1109, 0.0493,
        0.0493])
[rfa agg] iter:  1, prev_obj_val: 63.52130126953125, obj_val: 66.53895568847656, abs dis: 3.0176544189453125
[rfa agg] iter: 1, weight: tensor([0.1583, 0.0629, 0.1524, 0.1188, 0.0793, 0.1049, 0.1184, 0.1082, 0.0484,
        0.0486])
[rfa agg] iter:  2, prev_obj_val: 66.53895568847656, obj_val: 64.93499755859375, abs dis: 1.6039581298828125
[rfa agg] iter: 2, weight: tensor([0.1603, 0.0746, 0.1413, 0.1095, 0.0763, 0.0983, 0.1257, 0.1006, 0.0566,
        0.0569])
[rfa agg] iter:  3, prev_obj_val: 64.93499755859375, obj_val: 66.53158569335938, abs dis: 1.596588134765625
[rfa agg] iter: 3, weight: tensor([0.1611, 0.0686, 0.1459, 0.1133, 0.0774, 0.1009, 0.1241, 0.1038, 0.0523,
        0.0526])
[rfa agg] iter:  4, prev_obj_val: 66.53158569335938, obj_val: 64.93534088134766, abs dis: 1.5962448120117188
[rfa agg] iter: 4, weight: tensor([0.1606, 0.0747, 0.1405, 0.1092, 0.0762, 0.0981, 0.1267, 0.1004, 0.0567,
        0.0569])
[rfa agg] iter:  5, prev_obj_val: 64.93534088134766, obj_val: 66.53154754638672, abs dis: 1.5962066650390625
[rfa agg] iter: 5, weight: tensor([0.1611, 0.0686, 0.1458, 0.1133, 0.0774, 0.1009, 0.1243, 0.1038, 0.0523,
        0.0526])
[rfa agg] iter:  6, prev_obj_val: 66.53154754638672, obj_val: 64.93534851074219, abs dis: 1.5961990356445312
[rfa agg] iter: 6, weight: tensor([0.1606, 0.0747, 0.1405, 0.1092, 0.0762, 0.0981, 0.1267, 0.1004, 0.0567,
        0.0569])
[rfa agg] iter:  7, prev_obj_val: 64.93534851074219, obj_val: 66.53153991699219, abs dis: 1.59619140625
[rfa agg] iter: 7, weight: tensor([0.1611, 0.0686, 0.1458, 0.1133, 0.0774, 0.1009, 0.1243, 0.1038, 0.0523,
        0.0526])
[rfa agg] iter:  8, prev_obj_val: 66.53153991699219, obj_val: 64.93534851074219, abs dis: 1.59619140625
[rfa agg] iter: 8, weight: tensor([0.1605, 0.0747, 0.1405, 0.1092, 0.0762, 0.0981, 0.1267, 0.1004, 0.0567,
        0.0569])
[rfa agg] iter:  9, prev_obj_val: 64.93534851074219, obj_val: 66.53153991699219, abs dis: 1.59619140625
[rfa agg] iter: 9, weight: tensor([0.1611, 0.0686, 0.1458, 0.1133, 0.0774, 0.1009, 0.1243, 0.1038, 0.0523,
        0.0526])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 18.9323, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 17.5137, Accuracy: 0/9950 (0.0000%)
saving model
Done in 569.0124199390411 sec.
Server Epoch:93 choose agents : [59, 28, 10, 95, 89, 1, 69, 50, 30, 17].
_Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0688, Accuracy: 236/1089 (21.6713%)
_Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0309, Accuracy: 450/1089 (41.3223%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.2655, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   1, Avg loss: 0.0620, Accuracy: 306/1581 (19.3548%)
_Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   2, Avg loss: 0.0381, Accuracy: 490/1581 (30.9930%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.0454, Accuracy: 83/10000 (0.8300%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   1, Avg loss: 0.0682, Accuracy: 125/861 (14.5180%)
_Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   2, Avg loss: 0.0252, Accuracy: 406/861 (47.1545%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 12.7849, Accuracy: 85/10000 (0.8500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   1, Avg loss: 0.0603, Accuracy: 216/599 (36.0601%)
_Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   2, Avg loss: 0.0319, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 14.3567, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   1, Avg loss: 0.0768, Accuracy: 186/896 (20.7589%)
_Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   2, Avg loss: 0.0409, Accuracy: 456/896 (50.8929%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.0303, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0743, Accuracy: 220/928 (23.7069%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0275, Accuracy: 519/928 (55.9267%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.0298, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   1, Avg loss: 0.0759, Accuracy: 136/590 (23.0508%)
_Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   2, Avg loss: 0.0371, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 14.2103, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   1, Avg loss: 0.0803, Accuracy: 71/809 (8.7763%)
_Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   2, Avg loss: 0.0319, Accuracy: 338/809 (41.7800%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 11.0651, Accuracy: 69/10000 (0.6900%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   1, Avg loss: 0.0849, Accuracy: 27/486 (5.5556%)
_Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   2, Avg loss: 0.0423, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.4776, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   1, Avg loss: 0.0598, Accuracy: 259/1574 (16.4549%)
_Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   2, Avg loss: 0.0314, Accuracy: 555/1574 (35.2605%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.8538, Accuracy: 92/10000 (0.9200%)
time spent on training: 290.17401361465454
[rfa agg] training data poison_ratio: 0.2067353659832147  data num: [1089, 1581, 861, 599, 896, 928, 590, 809, 486, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.06460480186975459
[rfa agg] init. name: [59, 28, 10, 95, 89, 1, 69, 50, 30, 17], weight: tensor([0.1157, 0.1680, 0.0915, 0.0636, 0.0952, 0.0986, 0.0627, 0.0859, 0.0516,
        0.1672])
[rfa agg] iter:  0, prev_obj_val: 63.13783264160156, obj_val: 65.18620300292969, abs dis: 2.048370361328125
[rfa agg] iter: 0, weight: tensor([0.0809, 0.0903, 0.1529, 0.0586, 0.1581, 0.1404, 0.0605, 0.1312, 0.0383,
        0.0889])
[rfa agg] iter:  1, prev_obj_val: 65.18620300292969, obj_val: 68.29793548583984, abs dis: 3.1117324829101562
[rfa agg] iter: 1, weight: tensor([0.0659, 0.0722, 0.1577, 0.0674, 0.1686, 0.1279, 0.0706, 0.1562, 0.0423,
        0.0711])
[rfa agg] iter:  2, prev_obj_val: 68.29793548583984, obj_val: 68.28469848632812, abs dis: 0.01323699951171875
[rfa agg] iter: 2, weight: tensor([0.0625, 0.0678, 0.1462, 0.0804, 0.1584, 0.1157, 0.0857, 0.1666, 0.0497,
        0.0669])
[rfa agg] iter:  3, prev_obj_val: 68.28469848632812, obj_val: 68.28450012207031, abs dis: 0.0001983642578125
[rfa agg] iter: 3, weight: tensor([0.0621, 0.0676, 0.1443, 0.0813, 0.1575, 0.1145, 0.0866, 0.1698, 0.0498,
        0.0666])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.9212, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 9.4978, Accuracy: 2/9950 (0.0201%)
saving model
Done in 551.1390061378479 sec.
Server Epoch:94 choose agents : [34, 35, 88, 8, 41, 2, 25, 18, 54, 79].
_Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   1, Avg loss: 0.0603, Accuracy: 351/1427 (24.5971%)
_Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   2, Avg loss: 0.0357, Accuracy: 536/1427 (37.5613%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.6620, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.1229, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0827, Accuracy: 19/271 (7.0111%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.3937, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   1, Avg loss: 0.0827, Accuracy: 78/603 (12.9353%)
_Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   2, Avg loss: 0.0515, Accuracy: 280/603 (46.4345%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.6229, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   1, Avg loss: 0.0722, Accuracy: 144/1513 (9.5175%)
_Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   2, Avg loss: 0.0410, Accuracy: 402/1513 (26.5697%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.7300, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   1, Avg loss: 0.0656, Accuracy: 198/719 (27.5382%)
_Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   2, Avg loss: 0.0336, Accuracy: 459/719 (63.8387%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.1072, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0849, Accuracy: 81/605 (13.3884%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0494, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.0802, Accuracy: 55/10000 (0.5500%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   1, Avg loss: 0.0596, Accuracy: 223/690 (32.3188%)
_Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   2, Avg loss: 0.0289, Accuracy: 452/690 (65.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.5486, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   1, Avg loss: 0.0808, Accuracy: 56/530 (10.5660%)
_Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   2, Avg loss: 0.0455, Accuracy: 276/530 (52.0755%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.8468, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0647, Accuracy: 243/1130 (21.5044%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0301, Accuracy: 499/1130 (44.1593%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.6772, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   1, Avg loss: 0.1284, Accuracy: 2/197 (1.0152%)
_Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   2, Avg loss: 0.1097, Accuracy: 12/197 (6.0914%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.2394, Accuracy: 57/10000 (0.5700%)
time spent on training: 220.8774003982544
[rfa agg] training data poison_ratio: 0.08978529603122967  data num: [1427, 271, 603, 1513, 719, 605, 690, 530, 1130, 197]
[rfa agg] considering poison per batch poison_fraction: 0.02805790500975927
[rfa agg] init. name: [34, 35, 88, 8, 41, 2, 25, 18, 54, 79], weight: tensor([0.1857, 0.0353, 0.0785, 0.1969, 0.0936, 0.0787, 0.0898, 0.0690, 0.1470,
        0.0256])
[rfa agg] iter:  0, prev_obj_val: 65.05817413330078, obj_val: 66.95166778564453, abs dis: 1.89349365234375
[rfa agg] iter: 0, weight: tensor([0.1210, 0.0223, 0.1044, 0.1132, 0.1492, 0.0989, 0.1250, 0.0725, 0.1792,
        0.0143])
[rfa agg] iter:  1, prev_obj_val: 66.95166778564453, obj_val: 67.93689727783203, abs dis: 0.9852294921875
[rfa agg] iter: 1, weight: tensor([0.0945, 0.0234, 0.1305, 0.0893, 0.1680, 0.1170, 0.1477, 0.0823, 0.1327,
        0.0147])
[rfa agg] iter:  2, prev_obj_val: 67.93689727783203, obj_val: 72.5676498413086, abs dis: 4.6307525634765625
[rfa agg] iter: 2, weight: tensor([0.0865, 0.0238, 0.1430, 0.0820, 0.1662, 0.1246, 0.1557, 0.0862, 0.1173,
        0.0148])
[rfa agg] iter:  3, prev_obj_val: 72.5676498413086, obj_val: 72.5218734741211, abs dis: 0.0457763671875
[rfa agg] iter: 3, weight: tensor([0.0725, 0.0267, 0.1812, 0.0697, 0.1400, 0.1445, 0.1552, 0.1022, 0.0918,
        0.0161])
[rfa agg] iter:  4, prev_obj_val: 72.5218734741211, obj_val: 72.52086639404297, abs dis: 0.001007080078125
[rfa agg] iter: 4, weight: tensor([0.0713, 0.0265, 0.1880, 0.0685, 0.1339, 0.1476, 0.1552, 0.1030, 0.0900,
        0.0160])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.0071, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 6.5576, Accuracy: 0/9950 (0.0000%)
saving model
Done in 481.4649393558502 sec.
Server Epoch:95 choose agents : [66, 86, 64, 27, 37, 55, 33, 62, 57, 28].
_Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   1, Avg loss: 0.0708, Accuracy: 187/1402 (13.3381%)
_Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   2, Avg loss: 0.0424, Accuracy: 336/1402 (23.9658%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.7444, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   1, Avg loss: 0.0628, Accuracy: 293/1003 (29.2124%)
_Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   2, Avg loss: 0.0380, Accuracy: 372/1003 (37.0887%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.6192, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   1, Avg loss: 0.0729, Accuracy: 120/953 (12.5918%)
_Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   2, Avg loss: 0.0423, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.5857, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   1, Avg loss: 0.0655, Accuracy: 383/1587 (24.1336%)
_Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   2, Avg loss: 0.0394, Accuracy: 517/1587 (32.5772%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.2705, Accuracy: 68/10000 (0.6800%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   1, Avg loss: 0.0653, Accuracy: 284/1129 (25.1550%)
_Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   2, Avg loss: 0.0281, Accuracy: 635/1129 (56.2445%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.6581, Accuracy: 90/10000 (0.9000%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   1, Avg loss: 0.0606, Accuracy: 210/1071 (19.6078%)
_Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   2, Avg loss: 0.0317, Accuracy: 471/1071 (43.9776%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.3932, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   1, Avg loss: 0.0885, Accuracy: 33/515 (6.4078%)
_Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   2, Avg loss: 0.0568, Accuracy: 136/515 (26.4078%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.7917, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   1, Avg loss: 0.0812, Accuracy: 78/568 (13.7324%)
_Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   2, Avg loss: 0.0478, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.5145, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0672, Accuracy: 256/1154 (22.1837%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0335, Accuracy: 383/1154 (33.1889%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.9786, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0620, Accuracy: 309/1581 (19.5446%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0383, Accuracy: 472/1581 (29.8545%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.8582, Accuracy: 79/10000 (0.7900%)
time spent on training: 284.0366072654724
[rfa agg] training data poison_ratio: 0.2006749977196023  data num: [1402, 1003, 953, 1587, 1129, 1071, 515, 568, 1154, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.06271093678737572
[rfa agg] init. name: [66, 86, 64, 27, 37, 55, 33, 62, 57, 28], weight: tensor([0.1279, 0.0915, 0.0869, 0.1448, 0.1030, 0.0977, 0.0470, 0.0518, 0.1053,
        0.1442])
[rfa agg] iter:  0, prev_obj_val: 57.93626403808594, obj_val: 59.19525146484375, abs dis: 1.2589874267578125
[rfa agg] iter: 0, weight: tensor([0.1078, 0.1495, 0.1410, 0.0842, 0.1458, 0.1258, 0.0302, 0.0356, 0.0950,
        0.0851])
[rfa agg] iter:  1, prev_obj_val: 59.19525146484375, obj_val: 61.00371551513672, abs dis: 1.8084640502929688
[rfa agg] iter: 1, weight: tensor([0.1001, 0.1622, 0.1573, 0.0776, 0.1417, 0.1255, 0.0311, 0.0368, 0.0893,
        0.0785])
[rfa agg] iter:  2, prev_obj_val: 61.00371551513672, obj_val: 61.00086212158203, abs dis: 0.0028533935546875
[rfa agg] iter: 2, weight: tensor([0.0956, 0.1652, 0.1702, 0.0754, 0.1343, 0.1232, 0.0333, 0.0398, 0.0869,
        0.0762])
[rfa agg] iter:  3, prev_obj_val: 61.00086212158203, obj_val: 61.00080108642578, abs dis: 6.103515625e-05
[rfa agg] iter: 3, weight: tensor([0.0953, 0.1656, 0.1724, 0.0752, 0.1335, 0.1227, 0.0332, 0.0397, 0.0865,
        0.0760])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 22.7353, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 18.5613, Accuracy: 0/9950 (0.0000%)
saving model
Done in 534.3967156410217 sec.
Server Epoch:96 choose agents : [6, 3, 92, 4, 1, 12, 48, 2, 69, 13].
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0746, Accuracy: 271/1956 (13.8548%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0360, Accuracy: 570/1956 (29.1411%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.7736, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0843, Accuracy: 41/781 (5.2497%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0411, Accuracy: 229/781 (29.3214%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.6031, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   1, Avg loss: 0.0669, Accuracy: 307/1715 (17.9009%)
_Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   2, Avg loss: 0.0352, Accuracy: 594/1715 (34.6356%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.0608, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0700, Accuracy: 226/901 (25.0832%)
_Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0360, Accuracy: 387/901 (42.9523%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.8027, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0757, Accuracy: 211/928 (22.7371%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0279, Accuracy: 491/928 (52.9095%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.7776, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 26/338 (7.6923%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0509, Accuracy: 134/338 (39.6450%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.1889, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   1, Avg loss: 0.0814, Accuracy: 52/631 (8.2409%)
_Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   2, Avg loss: 0.0477, Accuracy: 233/631 (36.9255%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.6918, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0861, Accuracy: 81/605 (13.3884%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0522, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.8112, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   1, Avg loss: 0.0799, Accuracy: 129/590 (21.8644%)
_Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   2, Avg loss: 0.0363, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 14.0870, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   1, Avg loss: 0.0678, Accuracy: 248/1645 (15.0760%)
_Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   2, Avg loss: 0.0370, Accuracy: 522/1645 (31.7325%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.0760, Accuracy: 100/10000 (1.0000%)
time spent on training: 285.9080412387848
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 781, 1715, 901, 928, 338, 631, 605, 590, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 3, 92, 4, 1, 12, 48, 2, 69, 13], weight: tensor([0.1939, 0.0774, 0.1700, 0.0893, 0.0920, 0.0335, 0.0625, 0.0600, 0.0585,
        0.1630])
[rfa agg] iter:  0, prev_obj_val: 82.40199279785156, obj_val: 83.08706665039062, abs dis: 0.6850738525390625
[rfa agg] iter: 0, weight: tensor([0.1314, 0.0959, 0.1576, 0.1256, 0.1371, 0.0213, 0.0566, 0.0534, 0.0524,
        0.1688])
[rfa agg] iter:  1, prev_obj_val: 83.08706665039062, obj_val: 84.15499114990234, abs dis: 1.0679244995117188
[rfa agg] iter: 1, weight: tensor([0.1172, 0.1070, 0.1386, 0.1390, 0.1540, 0.0222, 0.0608, 0.0570, 0.0561,
        0.1480])
[rfa agg] iter:  2, prev_obj_val: 84.15499114990234, obj_val: 84.82044982910156, abs dis: 0.6654586791992188
[rfa agg] iter: 2, weight: tensor([0.1045, 0.1193, 0.1211, 0.1491, 0.1686, 0.0229, 0.0654, 0.0607, 0.0602,
        0.1281])
[rfa agg] iter:  3, prev_obj_val: 84.82044982910156, obj_val: 84.81410217285156, abs dis: 0.00634765625
[rfa agg] iter: 3, weight: tensor([0.0981, 0.1266, 0.1124, 0.1531, 0.1758, 0.0232, 0.0677, 0.0625, 0.0623,
        0.1184])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.5517, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 11.0338, Accuracy: 0/9950 (0.0000%)
saving model
Done in 536.8502423763275 sec.
Server Epoch:97 choose agents : [34, 90, 11, 2, 35, 50, 85, 72, 3, 18].
_Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0611, Accuracy: 329/1427 (23.0554%)
_Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0358, Accuracy: 525/1427 (36.7905%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.5806, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   1, Avg loss: 0.0589, Accuracy: 249/677 (36.7799%)
_Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 459/677 (67.7991%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 12.5547, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   1, Avg loss: 0.0810, Accuracy: 123/712 (17.2753%)
_Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   2, Avg loss: 0.0282, Accuracy: 445/712 (62.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 12.1904, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0865, Accuracy: 82/605 (13.5537%)
_Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0518, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.9143, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.1260, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0828, Accuracy: 24/271 (8.8561%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.6357, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   1, Avg loss: 0.0806, Accuracy: 63/809 (7.7874%)
_Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   2, Avg loss: 0.0322, Accuracy: 322/809 (39.8022%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 11.5033, Accuracy: 85/10000 (0.8500%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   1, Avg loss: 0.0671, Accuracy: 339/1988 (17.0523%)
_Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   2, Avg loss: 0.0393, Accuracy: 601/1988 (30.2314%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.0155, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0621, Accuracy: 223/1241 (17.9694%)
_Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0400, Accuracy: 366/1241 (29.4923%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.8582, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0847, Accuracy: 36/781 (4.6095%)
_Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0405, Accuracy: 233/781 (29.8335%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.9054, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   1, Avg loss: 0.0806, Accuracy: 63/530 (11.8868%)
_Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   2, Avg loss: 0.0405, Accuracy: 285/530 (53.7736%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.4931, Accuracy: 51/10000 (0.5100%)
time spent on training: 246.67758297920227
[rfa agg] training data poison_ratio: 0.21988718062161267  data num: [1427, 677, 712, 605, 271, 809, 1988, 1241, 781, 530]
[rfa agg] considering poison per batch poison_fraction: 0.06871474394425396
[rfa agg] init. name: [34, 90, 11, 2, 35, 50, 85, 72, 3, 18], weight: tensor([0.1578, 0.0749, 0.0788, 0.0669, 0.0300, 0.0895, 0.2199, 0.1373, 0.0864,
        0.0586])
[rfa agg] iter:  0, prev_obj_val: 76.29305267333984, obj_val: 76.69705963134766, abs dis: 0.4040069580078125
[rfa agg] iter: 0, weight: tensor([0.1547, 0.0788, 0.0891, 0.0602, 0.0164, 0.1240, 0.0982, 0.2155, 0.1159,
        0.0471])
[rfa agg] iter:  1, prev_obj_val: 76.69705963134766, obj_val: 78.4760513305664, abs dis: 1.77899169921875
[rfa agg] iter: 1, weight: tensor([0.1231, 0.0927, 0.1026, 0.0679, 0.0172, 0.1550, 0.0828, 0.1668, 0.1397,
        0.0524])
[rfa agg] iter:  2, prev_obj_val: 78.4760513305664, obj_val: 80.55083465576172, abs dis: 2.0747833251953125
[rfa agg] iter: 2, weight: tensor([0.0949, 0.1104, 0.1156, 0.0762, 0.0177, 0.1820, 0.0687, 0.1194, 0.1572,
        0.0579])
[rfa agg] iter:  3, prev_obj_val: 80.55083465576172, obj_val: 85.66246795654297, abs dis: 5.11163330078125
[rfa agg] iter: 3, weight: tensor([0.0806, 0.1282, 0.1232, 0.0839, 0.0182, 0.1868, 0.0609, 0.0973, 0.1575,
        0.0633])
[rfa agg] iter:  4, prev_obj_val: 85.66246795654297, obj_val: 81.96993255615234, abs dis: 3.692535400390625
[rfa agg] iter: 4, weight: tensor([0.0699, 0.1633, 0.1272, 0.1035, 0.0209, 0.1601, 0.0558, 0.0809, 0.1386,
        0.0798])
[rfa agg] iter:  5, prev_obj_val: 81.96993255615234, obj_val: 83.65594482421875, abs dis: 1.6860122680664062
[rfa agg] iter: 5, weight: tensor([0.0751, 0.1468, 0.1287, 0.0910, 0.0188, 0.1750, 0.0580, 0.0889, 0.1493,
        0.0685])
[rfa agg] iter:  6, prev_obj_val: 83.65594482421875, obj_val: 83.65287017822266, abs dis: 0.00307464599609375
[rfa agg] iter: 6, weight: tensor([0.0718, 0.1564, 0.1290, 0.0965, 0.0196, 0.1685, 0.0564, 0.0841, 0.1443,
        0.0734])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 11.9501, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 12.4701, Accuracy: 0/9950 (0.0000%)
saving model
Done in 495.86658120155334 sec.
Server Epoch:98 choose agents : [7, 45, 42, 97, 87, 98, 9, 32, 48, 31].
_Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   1, Avg loss: 0.0651, Accuracy: 243/891 (27.2727%)
_Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   2, Avg loss: 0.0298, Accuracy: 456/891 (51.1785%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.0169, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   1, Avg loss: 0.0752, Accuracy: 137/669 (20.4783%)
_Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   2, Avg loss: 0.0459, Accuracy: 352/669 (52.6158%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.5384, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   1, Avg loss: 0.0763, Accuracy: 151/1372 (11.0058%)
_Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   2, Avg loss: 0.0351, Accuracy: 482/1372 (35.1312%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.1286, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   1, Avg loss: 0.0531, Accuracy: 288/1213 (23.7428%)
_Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   2, Avg loss: 0.0304, Accuracy: 463/1213 (38.1698%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.3806, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0646, Accuracy: 234/1131 (20.6897%)
_Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0361, Accuracy: 343/1131 (30.3271%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.6888, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   1, Avg loss: 0.1036, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   2, Avg loss: 0.0610, Accuracy: 83/373 (22.2520%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.1353, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   1, Avg loss: 0.0565, Accuracy: 315/1275 (24.7059%)
_Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   2, Avg loss: 0.0210, Accuracy: 659/1275 (51.6863%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 12.1310, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0691, Accuracy: 120/735 (16.3265%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0263, Accuracy: 358/735 (48.7075%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 12.5351, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   1, Avg loss: 0.0816, Accuracy: 50/631 (7.9239%)
_Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   2, Avg loss: 0.0466, Accuracy: 248/631 (39.3027%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.0474, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   1, Avg loss: 0.0955, Accuracy: 8/460 (1.7391%)
_Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   2, Avg loss: 0.0442, Accuracy: 181/460 (39.3478%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.3373, Accuracy: 56/10000 (0.5600%)
time spent on training: 237.4494981765747
[rfa agg] training data poison_ratio: 0.0  data num: [891, 669, 1372, 1213, 1131, 373, 1275, 735, 631, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 45, 42, 97, 87, 98, 9, 32, 48, 31], weight: tensor([0.1018, 0.0765, 0.1568, 0.1386, 0.1293, 0.0426, 0.1457, 0.0840, 0.0721,
        0.0526])
[rfa agg] iter:  0, prev_obj_val: 56.839324951171875, obj_val: 58.165653228759766, abs dis: 1.3263282775878906
[rfa agg] iter: 0, weight: tensor([0.1496, 0.1071, 0.0866, 0.1096, 0.1156, 0.0291, 0.1009, 0.1587, 0.0946,
        0.0482])
[rfa agg] iter:  1, prev_obj_val: 58.165653228759766, obj_val: 59.90330123901367, abs dis: 1.7376480102539062
[rfa agg] iter: 1, weight: tensor([0.1470, 0.1150, 0.0797, 0.0998, 0.1058, 0.0303, 0.0926, 0.1759, 0.1032,
        0.0509])
[rfa agg] iter:  2, prev_obj_val: 59.90330123901367, obj_val: 61.877750396728516, abs dis: 1.9744491577148438
[rfa agg] iter: 2, weight: tensor([0.1381, 0.1219, 0.0762, 0.0939, 0.0990, 0.0321, 0.0876, 0.1828, 0.1134,
        0.0550])
[rfa agg] iter:  3, prev_obj_val: 61.877750396728516, obj_val: 61.87367630004883, abs dis: 0.0040740966796875
[rfa agg] iter: 3, weight: tensor([0.1292, 0.1282, 0.0736, 0.0894, 0.0937, 0.0344, 0.0839, 0.1821, 0.1252,
        0.0601])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 12.1917, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 11.7033, Accuracy: 1/9950 (0.0101%)
saving model
Done in 487.11276745796204 sec.
Server Epoch:99 choose agents : [64, 82, 67, 73, 95, 84, 19, 29, 39, 26].
_Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   1, Avg loss: 0.0732, Accuracy: 128/953 (13.4313%)
_Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   2, Avg loss: 0.0436, Accuracy: 300/953 (31.4795%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.4997, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1, Avg loss: 0.0905, Accuracy: 19/500 (3.8000%)
_Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2, Avg loss: 0.0555, Accuracy: 187/500 (37.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.4181, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   1, Avg loss: 0.0949, Accuracy: 6/426 (1.4085%)
_Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   2, Avg loss: 0.0485, Accuracy: 145/426 (34.0376%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.1976, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   1, Avg loss: 0.0711, Accuracy: 171/938 (18.2303%)
_Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   2, Avg loss: 0.0373, Accuracy: 303/938 (32.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.7005, Accuracy: 58/10000 (0.5800%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0607, Accuracy: 194/599 (32.3873%)
_Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0301, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 15.2755, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   1, Avg loss: 0.0732, Accuracy: 207/1190 (17.3950%)
_Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   2, Avg loss: 0.0349, Accuracy: 396/1190 (33.2773%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.3944, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   1, Avg loss: 0.0608, Accuracy: 283/1036 (27.3166%)
_Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   2, Avg loss: 0.0266, Accuracy: 626/1036 (60.4247%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 13.6555, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   1, Avg loss: 0.0681, Accuracy: 292/1440 (20.2778%)
_Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   2, Avg loss: 0.0318, Accuracy: 642/1440 (44.5833%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.0962, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   1, Avg loss: 0.0564, Accuracy: 225/1013 (22.2113%)
_Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   2, Avg loss: 0.0287, Accuracy: 457/1013 (45.1135%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.7660, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0691, Accuracy: 217/1446 (15.0069%)
_Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0392, Accuracy: 467/1446 (32.2960%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.5573, Accuracy: 66/10000 (0.6600%)
time spent on training: 288.70414566993713
[rfa agg] training data poison_ratio: 0.06278167906927995  data num: [953, 500, 426, 938, 599, 1190, 1036, 1440, 1013, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.019619274709149984
[rfa agg] init. name: [64, 82, 67, 73, 95, 84, 19, 29, 39, 26], weight: tensor([0.0999, 0.0524, 0.0446, 0.0983, 0.0628, 0.1247, 0.1086, 0.1509, 0.1062,
        0.1516])
[rfa agg] iter:  0, prev_obj_val: 59.677528381347656, obj_val: 61.67059326171875, abs dis: 1.9930648803710938
[rfa agg] iter: 0, weight: tensor([0.1609, 0.0477, 0.0351, 0.1423, 0.0712, 0.1037, 0.1252, 0.0843, 0.1452,
        0.0844])
[rfa agg] iter:  1, prev_obj_val: 61.67059326171875, obj_val: 61.6678466796875, abs dis: 0.00274658203125
[rfa agg] iter: 1, weight: tensor([0.1629, 0.0521, 0.0381, 0.1449, 0.0794, 0.0988, 0.1200, 0.0815, 0.1405,
        0.0817])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 11.7712, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 9.2338, Accuracy: 10/9950 (0.1005%)
saving model
Done in 534.9253194332123 sec.
Server Epoch:100 choose agents : [68, 28, 58, 41, 78, 29, 94, 45, 73, 15].
_Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   1, Avg loss: 0.0717, Accuracy: 287/1163 (24.6776%)
_Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   2, Avg loss: 0.0410, Accuracy: 420/1163 (36.1135%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.6101, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   1, Avg loss: 0.0627, Accuracy: 288/1581 (18.2163%)
_Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   2, Avg loss: 0.0393, Accuracy: 471/1581 (29.7913%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.2135, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0742, Accuracy: 196/803 (24.4085%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0432, Accuracy: 425/803 (52.9265%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.3670, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   1, Avg loss: 0.0621, Accuracy: 204/719 (28.3727%)
_Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   2, Avg loss: 0.0333, Accuracy: 463/719 (64.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.2104, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   1, Avg loss: 0.0901, Accuracy: 15/416 (3.6058%)
_Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   2, Avg loss: 0.0505, Accuracy: 161/416 (38.7019%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.2508, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   1, Avg loss: 0.0691, Accuracy: 298/1440 (20.6944%)
_Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   2, Avg loss: 0.0319, Accuracy: 658/1440 (45.6944%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.3120, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   1, Avg loss: 0.0721, Accuracy: 212/1662 (12.7557%)
_Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   2, Avg loss: 0.0388, Accuracy: 498/1662 (29.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.2818, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   1, Avg loss: 0.0719, Accuracy: 159/669 (23.7668%)
_Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   2, Avg loss: 0.0448, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.5387, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   1, Avg loss: 0.0727, Accuracy: 167/938 (17.8038%)
_Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   2, Avg loss: 0.0389, Accuracy: 286/938 (30.4904%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.7513, Accuracy: 60/10000 (0.6000%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   1, Avg loss: 0.0726, Accuracy: 223/1154 (19.3241%)
_Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   2, Avg loss: 0.0344, Accuracy: 393/1154 (34.0555%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.7847, Accuracy: 72/10000 (0.7200%)
time spent on training: 267.2822046279907
[rfa agg] training data poison_ratio: 0.1094357515410147  data num: [1163, 1581, 803, 719, 416, 1440, 1662, 669, 938, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.034198672356567095
[rfa agg] init. name: [68, 28, 58, 41, 78, 29, 94, 45, 73, 15], weight: tensor([0.1103, 0.1499, 0.0761, 0.0682, 0.0394, 0.1366, 0.1576, 0.0634, 0.0890,
        0.1094])
[rfa agg] iter:  0, prev_obj_val: 64.0951156616211, obj_val: 66.40201568603516, abs dis: 2.3069000244140625
[rfa agg] iter: 0, weight: tensor([0.1646, 0.1133, 0.1009, 0.0685, 0.0240, 0.1192, 0.1068, 0.0573, 0.1315,
        0.1138])
[rfa agg] iter:  1, prev_obj_val: 66.40201568603516, obj_val: 66.3805923461914, abs dis: 0.02142333984375
[rfa agg] iter: 1, weight: tensor([0.1516, 0.1015, 0.1198, 0.0771, 0.0261, 0.1066, 0.0965, 0.0642, 0.1493,
        0.1074])
[rfa agg] iter:  2, prev_obj_val: 66.3805923461914, obj_val: 67.82781219482422, abs dis: 1.4472198486328125
[rfa agg] iter: 2, weight: tensor([0.1497, 0.1008, 0.1211, 0.0773, 0.0261, 0.1057, 0.0960, 0.0644, 0.1526,
        0.1063])
[rfa agg] iter:  3, prev_obj_val: 67.82781219482422, obj_val: 71.23614501953125, abs dis: 3.4083328247070312
[rfa agg] iter: 3, weight: tensor([0.1402, 0.0963, 0.1327, 0.0822, 0.0274, 0.1007, 0.0921, 0.0684, 0.1575,
        0.1027])
[rfa agg] iter:  4, prev_obj_val: 71.23614501953125, obj_val: 69.43525695800781, abs dis: 1.8008880615234375
[rfa agg] iter: 4, weight: tensor([0.1223, 0.0880, 0.1590, 0.0926, 0.0302, 0.0917, 0.0849, 0.0777, 0.1589,
        0.0948])
[rfa agg] iter:  5, prev_obj_val: 69.43525695800781, obj_val: 71.21968078613281, abs dis: 1.784423828125
[rfa agg] iter: 5, weight: tensor([0.1284, 0.0912, 0.1496, 0.0880, 0.0287, 0.0951, 0.0877, 0.0733, 0.1607,
        0.0974])
[rfa agg] iter:  6, prev_obj_val: 71.21968078613281, obj_val: 69.43621063232422, abs dis: 1.7834701538085938
[rfa agg] iter: 6, weight: tensor([0.1210, 0.0876, 0.1615, 0.0929, 0.0302, 0.0911, 0.0844, 0.0778, 0.1594,
        0.0940])
[rfa agg] iter:  7, prev_obj_val: 69.43621063232422, obj_val: 71.21957397460938, abs dis: 1.7833633422851562
[rfa agg] iter: 7, weight: tensor([0.1283, 0.0912, 0.1499, 0.0880, 0.0287, 0.0950, 0.0876, 0.0732, 0.1608,
        0.0973])
[rfa agg] iter:  8, prev_obj_val: 71.21957397460938, obj_val: 69.43622589111328, abs dis: 1.7833480834960938
[rfa agg] iter: 8, weight: tensor([0.1210, 0.0876, 0.1616, 0.0929, 0.0302, 0.0911, 0.0844, 0.0778, 0.1595,
        0.0940])
[rfa agg] iter:  9, prev_obj_val: 69.43622589111328, obj_val: 71.21956634521484, abs dis: 1.7833404541015625
[rfa agg] iter: 9, weight: tensor([0.1283, 0.0912, 0.1499, 0.0880, 0.0287, 0.0950, 0.0876, 0.0732, 0.1608,
        0.0973])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.0227, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 8.4489, Accuracy: 16/9950 (0.1608%)
saving model
Done in 510.8975260257721 sec.
Saving all the graphs.
This run has a label: Jun.26_07.42.58. Visdom environment: tiny
