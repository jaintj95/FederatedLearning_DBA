current path: saved_models/model_tiny_Jun.15_17.07.44
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 3, 5, 9, 10, 12, 15, 18, 20, 24, 25, 30, 33, 36, 37, 42, 44, 48, 49, 54, 55, 60, 61, 65, 69, 72, 74, 78, 81, 84, 85, 95]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [37, 44, 94, 74, 82, 83, 41, 65, 26, 24].
poison local model 37 index 14 
___Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   1, Avg loss: 0.0529, Accuracy: 387/1129 (34.2781%)
___Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   2, Avg loss: 0.0253, Accuracy: 704/1129 (62.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.5943, Accuracy: 98/10000 (0.9800%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0597, Accuracy: 394/1750 (22.5143%)
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 662/1750 (37.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.5435, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 331/1662 (19.9158%)
___Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 582/1662 (35.0181%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.9412, Accuracy: 108/10000 (1.0800%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 505/1552 (32.5387%)
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 735/1552 (47.3582%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 10.8193, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 59/500 (11.8000%)
___Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   2, Avg loss: 0.0493, Accuracy: 177/500 (35.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.5869, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0549, Accuracy: 411/1953 (21.0445%)
___Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 786/1953 (40.2458%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 8.0047, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   1, Avg loss: 0.0632, Accuracy: 318/719 (44.2281%)
___Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   2, Avg loss: 0.0308, Accuracy: 443/719 (61.6134%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.1201, Accuracy: 54/10000 (0.5400%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0574, Accuracy: 379/1475 (25.6949%)
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 706/1475 (47.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.9686, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 338/1446 (23.3748%)
___Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 480/1446 (33.1950%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.3266, Accuracy: 63/10000 (0.6300%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 28/312 (8.9744%)
___Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   2, Avg loss: 0.0408, Accuracy: 171/312 (54.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3876, Accuracy: 50/10000 (0.5000%)
time spent on training: 139.74108958244324
___Test Target_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3003, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 1: Avg loss: 5.3358, Accuracy: 0/9950 (0.0000%)
saving model
Done in 542.526526927948 sec.
Server Epoch:2 choose agents : [94, 71, 66, 35, 38, 84, 42, 43, 11, 95].
___Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 352/1662 (21.1793%)
___Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 598/1662 (35.9807%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.7964, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   1, Avg loss: 0.0651, Accuracy: 155/818 (18.9487%)
___Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 382/818 (46.6993%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.1490, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 258/1402 (18.4023%)
___Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 385/1402 (27.4608%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.1729, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 43/271 (15.8672%)
___Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   2, Avg loss: 0.0567, Accuracy: 99/271 (36.5314%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3711, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   1, Avg loss: 0.0628, Accuracy: 235/1131 (20.7781%)
___Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   2, Avg loss: 0.0320, Accuracy: 442/1131 (39.0805%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.4072, Accuracy: 59/10000 (0.5900%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0635, Accuracy: 314/1190 (26.3866%)
___Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 434/1190 (36.4706%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.9105, Accuracy: 64/10000 (0.6400%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 350/1372 (25.5102%)
___Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 552/1372 (40.2332%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.9152, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0617, Accuracy: 297/946 (31.3953%)
___Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 352/946 (37.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.0007, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   1, Avg loss: 0.0578, Accuracy: 348/712 (48.8764%)
___Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 410/712 (57.5843%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.5076, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   1, Avg loss: 0.0518, Accuracy: 330/599 (55.0918%)
___Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   2, Avg loss: 0.0304, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 8.0470, Accuracy: 50/10000 (0.5000%)
time spent on training: 139.25599670410156
___Test Target_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.2998, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 2: Avg loss: 5.3163, Accuracy: 0/9950 (0.0000%)
saving model
Done in 564.7833082675934 sec.
Server Epoch:3 choose agents : [15, 88, 13, 42, 72, 22, 6, 0, 69, 17].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0563, Accuracy: 330/1154 (28.5962%)
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0296, Accuracy: 391/1154 (33.8821%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.7889, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   1, Avg loss: 0.0741, Accuracy: 140/603 (23.2172%)
___Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   2, Avg loss: 0.0461, Accuracy: 287/603 (47.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.9883, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 312/1645 (18.9666%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 603/1645 (36.6565%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.9093, Accuracy: 126/10000 (1.2600%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 370/1372 (26.9679%)
___Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 511/1372 (37.2449%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.7009, Accuracy: 71/10000 (0.7100%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   1, Avg loss: 0.0623, Accuracy: 257/1241 (20.7091%)
___Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 423/1241 (34.0854%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.1286, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 537/1470 (36.5306%)
___Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 860/1470 (58.5034%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.1817, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 389/1956 (19.8875%)
___Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 670/1956 (34.2536%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.1596, Accuracy: 112/10000 (1.1200%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 340/1657 (20.5190%)
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 543/1657 (32.7701%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.5821, Accuracy: 66/10000 (0.6600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0590, Accuracy: 274/590 (46.4407%)
___Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0308, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.8701, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 397/1574 (25.2224%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 656/1574 (41.6773%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.0771, Accuracy: 98/10000 (0.9800%)
time spent on training: 172.790180683136
___Test Target_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3015, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 3: Avg loss: 5.3268, Accuracy: 0/9950 (0.0000%)
saving model
Done in 596.2582361698151 sec.
Server Epoch:4 choose agents : [31, 94, 47, 15, 11, 35, 62, 77, 21, 93].
___Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0819, Accuracy: 57/460 (12.3913%)
___Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0371, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.8896, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   1, Avg loss: 0.0541, Accuracy: 356/1662 (21.4200%)
___Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 634/1662 (38.1468%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.9950, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   1, Avg loss: 0.1248, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   2, Avg loss: 0.1109, Accuracy: 13/134 (9.7015%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3217, Accuracy: 50/10000 (0.5000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 320/1154 (27.7296%)
___Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 393/1154 (34.0555%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.8606, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 347/712 (48.7360%)
___Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 406/712 (57.0225%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.5195, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   1, Avg loss: 0.0855, Accuracy: 40/271 (14.7601%)
___Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   2, Avg loss: 0.0558, Accuracy: 103/271 (38.0074%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.4107, Accuracy: 31/10000 (0.3100%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0691, Accuracy: 137/568 (24.1197%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0416, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.9276, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0541, Accuracy: 332/1340 (24.7761%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 597/1340 (44.5522%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.8356, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 410/1949 (21.0364%)
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0326, Accuracy: 650/1949 (33.3504%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.3643, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   1, Avg loss: 0.0564, Accuracy: 395/1742 (22.6751%)
___Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 683/1742 (39.2078%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.7511, Accuracy: 86/10000 (0.8600%)
time spent on training: 124.56274724006653
___Test Target_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3030, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 4: Avg loss: 5.3325, Accuracy: 0/9950 (0.0000%)
saving model
Done in 553.8844382762909 sec.
Server Epoch:5 choose agents : [91, 78, 82, 2, 77, 31, 70, 65, 60, 36].
___Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0531, Accuracy: 337/1030 (32.7184%)
___Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0266, Accuracy: 628/1030 (60.9709%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.4245, Accuracy: 72/10000 (0.7200%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   1, Avg loss: 0.0843, Accuracy: 37/416 (8.8942%)
___Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   2, Avg loss: 0.0468, Accuracy: 178/416 (42.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.7316, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 73/500 (14.6000%)
___Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 170/500 (34.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.7662, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 226/605 (37.3554%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0387, Accuracy: 328/605 (54.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.9262, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   1, Avg loss: 0.0535, Accuracy: 327/1340 (24.4030%)
___Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 564/1340 (42.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.7975, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   1, Avg loss: 0.0803, Accuracy: 72/460 (15.6522%)
___Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   2, Avg loss: 0.0380, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.9274, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 336/1418 (23.6953%)
___Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 650/1418 (45.8392%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.7947, Accuracy: 96/10000 (0.9600%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   1, Avg loss: 0.0547, Accuracy: 388/1475 (26.3051%)
___Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   2, Avg loss: 0.0307, Accuracy: 690/1475 (46.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.1027, Accuracy: 91/10000 (0.9100%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 579/2227 (25.9991%)
___Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1017/2227 (45.6668%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.7138, Accuracy: 130/10000 (1.3000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   1, Avg loss: 0.0878, Accuracy: 71/408 (17.4020%)
___Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   2, Avg loss: 0.0548, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.5897, Accuracy: 50/10000 (0.5000%)
time spent on training: 157.7899432182312
___Test Target_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3049, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 5: Avg loss: 5.3161, Accuracy: 0/9950 (0.0000%)
saving model
Done in 589.5308346748352 sec.
Server Epoch:6 choose agents : [63, 42, 69, 72, 83, 44, 79, 50, 66, 74].
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0542, Accuracy: 256/888 (28.8288%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 427/888 (48.0856%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 9.0866, Accuracy: 53/10000 (0.5300%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0519, Accuracy: 374/1372 (27.2595%)
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 528/1372 (38.4840%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.8635, Accuracy: 76/10000 (0.7600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   1, Avg loss: 0.0560, Accuracy: 294/590 (49.8305%)
___Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   2, Avg loss: 0.0301, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.2154, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 240/1241 (19.3392%)
___Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 410/1241 (33.0379%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.4378, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 453/1953 (23.1951%)
___Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 764/1953 (39.1193%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.8566, Accuracy: 87/10000 (0.8700%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0587, Accuracy: 382/1750 (21.8286%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 676/1750 (38.6286%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.9834, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   1, Avg loss: 0.1019, Accuracy: 8/197 (4.0609%)
___Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   2, Avg loss: 0.0792, Accuracy: 59/197 (29.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3420, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0629, Accuracy: 136/809 (16.8109%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 351/809 (43.3869%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.3050, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   1, Avg loss: 0.0616, Accuracy: 262/1402 (18.6876%)
___Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 357/1402 (25.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.4373, Accuracy: 74/10000 (0.7400%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0419, Accuracy: 495/1552 (31.8943%)
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 777/1552 (50.0644%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 11.5868, Accuracy: 75/10000 (0.7500%)
time spent on training: 173.21380472183228
___Test Target_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3071, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 6: Avg loss: 5.3261, Accuracy: 0/9950 (0.0000%)
saving model
Done in 592.7890133857727 sec.
Server Epoch:7 choose agents : [82, 90, 50, 35, 0, 79, 25, 37, 16, 60].
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0753, Accuracy: 73/500 (14.6000%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0482, Accuracy: 174/500 (34.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.8971, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0578, Accuracy: 314/677 (46.3811%)
___Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 452/677 (66.7651%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.0423, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   1, Avg loss: 0.0619, Accuracy: 165/809 (20.3956%)
___Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   2, Avg loss: 0.0268, Accuracy: 373/809 (46.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.5374, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0840, Accuracy: 49/271 (18.0812%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0544, Accuracy: 97/271 (35.7934%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.4718, Accuracy: 42/10000 (0.4200%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 337/1657 (20.3380%)
___Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 523/1657 (31.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.1265, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.1013, Accuracy: 7/197 (3.5533%)
___Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0859, Accuracy: 60/197 (30.4569%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3503, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 303/690 (43.9130%)
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 457/690 (66.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.9685, Accuracy: 71/10000 (0.7100%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   1, Avg loss: 0.0515, Accuracy: 436/1129 (38.6182%)
___Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 738/1129 (65.3676%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.0093, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   1, Avg loss: 0.0613, Accuracy: 275/708 (38.8418%)
___Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   2, Avg loss: 0.0376, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.9607, Accuracy: 57/10000 (0.5700%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 605/2227 (27.1666%)
___Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1059/2227 (47.5528%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.4351, Accuracy: 131/10000 (1.3100%)
time spent on training: 157.375812292099
___Test Target_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3089, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 7: Avg loss: 5.3140, Accuracy: 0/9950 (0.0000%)
saving model
Done in 573.705531835556 sec.
Server Epoch:8 choose agents : [94, 35, 21, 1, 88, 43, 68, 27, 19, 92].
___Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   1, Avg loss: 0.0539, Accuracy: 331/1662 (19.9158%)
___Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 628/1662 (37.7858%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.0228, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   1, Avg loss: 0.0840, Accuracy: 49/271 (18.0812%)
___Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   2, Avg loss: 0.0523, Accuracy: 113/271 (41.6974%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.4674, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0529, Accuracy: 416/1949 (21.3443%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 616/1949 (31.6060%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.4794, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0582, Accuracy: 285/928 (30.7112%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 553/928 (59.5905%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.7974, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   1, Avg loss: 0.0733, Accuracy: 142/603 (23.5489%)
___Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 287/603 (47.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.3097, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   1, Avg loss: 0.0614, Accuracy: 309/946 (32.6638%)
___Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 338/946 (35.7294%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.4928, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   1, Avg loss: 0.0623, Accuracy: 362/1163 (31.1264%)
___Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   2, Avg loss: 0.0364, Accuracy: 429/1163 (36.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.8916, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 417/1587 (26.2760%)
___Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 610/1587 (38.4373%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.2471, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   1, Avg loss: 0.0475, Accuracy: 392/1036 (37.8378%)
___Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   2, Avg loss: 0.0251, Accuracy: 663/1036 (63.9961%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 10.1687, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   1, Avg loss: 0.0526, Accuracy: 417/1715 (24.3149%)
___Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 707/1715 (41.2245%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.6612, Accuracy: 87/10000 (0.8700%)
time spent on training: 123.83525204658508
___Test Target_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.3112, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 8: Avg loss: 5.3108, Accuracy: 0/9950 (0.0000%)
saving model
Done in 533.4840266704559 sec.
Server Epoch:9 choose agents : [57, 42, 90, 21, 49, 84, 77, 18, 56, 65].
___Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   1, Avg loss: 0.0542, Accuracy: 304/1154 (26.3432%)
___Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   2, Avg loss: 0.0261, Accuracy: 496/1154 (42.9809%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 9.1902, Accuracy: 74/10000 (0.7400%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   1, Avg loss: 0.0510, Accuracy: 371/1372 (27.0408%)
___Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 507/1372 (36.9534%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.1901, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0559, Accuracy: 320/677 (47.2674%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 445/677 (65.7312%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.1635, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   1, Avg loss: 0.0527, Accuracy: 391/1949 (20.0616%)
___Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   2, Avg loss: 0.0336, Accuracy: 568/1949 (29.1432%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.3422, Accuracy: 89/10000 (0.8900%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   1, Avg loss: 0.0798, Accuracy: 25/440 (5.6818%)
___Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   2, Avg loss: 0.0476, Accuracy: 147/440 (33.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.7467, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 328/1190 (27.5630%)
___Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 423/1190 (35.5462%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.4498, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0521, Accuracy: 338/1340 (25.2239%)
___Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 546/1340 (40.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.7900, Accuracy: 86/10000 (0.8600%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   1, Avg loss: 0.0773, Accuracy: 114/530 (21.5094%)
___Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   2, Avg loss: 0.0395, Accuracy: 269/530 (50.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.9290, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 59/186 (31.7204%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3446, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 411/1475 (27.8644%)
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0309, Accuracy: 688/1475 (46.6441%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.1925, Accuracy: 78/10000 (0.7800%)
time spent on training: 173.2664337158203
___Test Target_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3135, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 9: Avg loss: 5.2979, Accuracy: 0/9950 (0.0000%)
saving model
Done in 581.89142370224 sec.
Server Epoch:10 choose agents : [5, 23, 83, 66, 54, 46, 86, 78, 84, 8].
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0513, Accuracy: 404/1628 (24.8157%)
___Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 857/1628 (52.6413%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.7537, Accuracy: 155/10000 (1.5500%)
___Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   1, Avg loss: 0.0600, Accuracy: 310/715 (43.3566%)
___Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.1229, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   1, Avg loss: 0.0531, Accuracy: 438/1953 (22.4270%)
___Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 758/1953 (38.8121%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.2042, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   1, Avg loss: 0.0610, Accuracy: 268/1402 (19.1155%)
___Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 389/1402 (27.7461%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.7172, Accuracy: 68/10000 (0.6800%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   1, Avg loss: 0.0554, Accuracy: 336/1130 (29.7345%)
___Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 475/1130 (42.0354%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.0746, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   1, Avg loss: 0.0554, Accuracy: 405/1904 (21.2710%)
___Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 697/1904 (36.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.7821, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   1, Avg loss: 0.0644, Accuracy: 344/1003 (34.2971%)
___Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   2, Avg loss: 0.0354, Accuracy: 353/1003 (35.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.9122, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   1, Avg loss: 0.0824, Accuracy: 40/416 (9.6154%)
___Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   2, Avg loss: 0.0467, Accuracy: 177/416 (42.5481%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.9443, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0612, Accuracy: 320/1190 (26.8908%)
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 441/1190 (37.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.4428, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   1, Avg loss: 0.0603, Accuracy: 262/1513 (17.3166%)
___Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 494/1513 (32.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.9317, Accuracy: 98/10000 (0.9800%)
time spent on training: 173.13018417358398
___Test Target_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3158, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 10: Avg loss: 5.3032, Accuracy: 0/9950 (0.0000%)
saving model
Done in 579.1184985637665 sec.
Server Epoch:11 choose agents : [38, 24, 45, 8, 65, 19, 49, 17, 40, 22].
___Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   1, Avg loss: 0.0614, Accuracy: 253/1131 (22.3696%)
___Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 498/1131 (44.0318%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.5688, Accuracy: 92/10000 (0.9200%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 37/312 (11.8590%)
___Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 162/312 (51.9231%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.6715, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   1, Avg loss: 0.0687, Accuracy: 200/669 (29.8954%)
___Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   2, Avg loss: 0.0407, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.9817, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 261/1513 (17.2505%)
___Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   2, Avg loss: 0.0358, Accuracy: 486/1513 (32.1216%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.4608, Accuracy: 92/10000 (0.9200%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   1, Avg loss: 0.0550, Accuracy: 418/1475 (28.3390%)
___Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   2, Avg loss: 0.0299, Accuracy: 713/1475 (48.3390%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.9111, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   1, Avg loss: 0.0465, Accuracy: 411/1036 (39.6718%)
___Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   2, Avg loss: 0.0236, Accuracy: 664/1036 (64.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 9.4090, Accuracy: 60/10000 (0.6000%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   1, Avg loss: 0.0790, Accuracy: 37/440 (8.4091%)
___Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   2, Avg loss: 0.0469, Accuracy: 144/440 (32.7273%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.8240, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0507, Accuracy: 413/1574 (26.2389%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0265, Accuracy: 733/1574 (46.5693%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.2785, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   1, Avg loss: 0.0543, Accuracy: 383/1573 (24.3484%)
___Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 574/1573 (36.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.7288, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   1, Avg loss: 0.0464, Accuracy: 468/1470 (31.8367%)
___Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 859/1470 (58.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.1879, Accuracy: 81/10000 (0.8100%)
time spent on training: 158.91130805015564
___Test Target_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.3183, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 11: Avg loss: 5.2928, Accuracy: 0/9950 (0.0000%)
saving model
Done in 572.9609470367432 sec.
Server Epoch:12 choose agents : [56, 30, 69, 47, 51, 48, 92, 84, 32, 22].
___Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   2, Avg loss: 0.0668, Accuracy: 73/186 (39.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3571, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0820, Accuracy: 66/486 (13.5802%)
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.4032, Accuracy: 47/10000 (0.4700%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   1, Avg loss: 0.0547, Accuracy: 301/590 (51.0169%)
___Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.7884, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   1, Avg loss: 0.1249, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   2, Avg loss: 0.1063, Accuracy: 13/134 (9.7015%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3454, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 229/1049 (21.8303%)
___Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   2, Avg loss: 0.0296, Accuracy: 530/1049 (50.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.8954, Accuracy: 98/10000 (0.9800%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   1, Avg loss: 0.0704, Accuracy: 113/631 (17.9081%)
___Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 225/631 (35.6577%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.2550, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 455/1715 (26.5306%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0313, Accuracy: 653/1715 (38.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.6364, Accuracy: 95/10000 (0.9500%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   1, Avg loss: 0.0599, Accuracy: 337/1190 (28.3193%)
___Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 458/1190 (38.4874%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.5290, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0601, Accuracy: 191/735 (25.9864%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 347/735 (47.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 9.1681, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0448, Accuracy: 565/1470 (38.4354%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0234, Accuracy: 879/1470 (59.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.3923, Accuracy: 93/10000 (0.9300%)
time spent on training: 160.75960493087769
___Test Target_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3205, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 12: Avg loss: 5.2569, Accuracy: 0/9950 (0.0000%)
saving model
Done in 592.669623374939 sec.
Server Epoch:13 choose agents : [53, 15, 3, 23, 83, 11, 27, 76, 70, 35].
___Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   1, Avg loss: 0.0507, Accuracy: 285/813 (35.0554%)
___Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 489/813 (60.1476%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 10.3258, Accuracy: 53/10000 (0.5300%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0565, Accuracy: 329/1154 (28.5095%)
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 449/1154 (38.9081%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.9257, Accuracy: 76/10000 (0.7600%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   1, Avg loss: 0.0737, Accuracy: 114/781 (14.5967%)
___Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   2, Avg loss: 0.0353, Accuracy: 246/781 (31.4981%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.0198, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0602, Accuracy: 312/715 (43.6364%)
___Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0382, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.9663, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 455/1953 (23.2975%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 749/1953 (38.3513%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.1820, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   1, Avg loss: 0.0544, Accuracy: 346/712 (48.5955%)
___Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   2, Avg loss: 0.0257, Accuracy: 425/712 (59.6910%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.2914, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   1, Avg loss: 0.0539, Accuracy: 408/1587 (25.7089%)
___Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 602/1587 (37.9332%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.6941, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0841, Accuracy: 53/466 (11.3734%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0501, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.1911, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0546, Accuracy: 380/1418 (26.7983%)
___Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 662/1418 (46.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.8532, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0821, Accuracy: 73/271 (26.9373%)
___Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0562, Accuracy: 105/271 (38.7454%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.6144, Accuracy: 48/10000 (0.4800%)
time spent on training: 149.7029891014099
___Test Target_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3227, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 13: Avg loss: 5.2608, Accuracy: 0/9950 (0.0000%)
saving model
Done in 566.4927816390991 sec.
Server Epoch:14 choose agents : [0, 94, 96, 91, 51, 3, 36, 90, 37, 84].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   1, Avg loss: 0.0571, Accuracy: 374/1657 (22.5709%)
___Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   2, Avg loss: 0.0341, Accuracy: 526/1657 (31.7441%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.0264, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   1, Avg loss: 0.0539, Accuracy: 373/1662 (22.4428%)
___Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 614/1662 (36.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.1059, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   1, Avg loss: 0.0803, Accuracy: 33/311 (10.6109%)
___Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.5065, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   1, Avg loss: 0.0515, Accuracy: 357/1030 (34.6602%)
___Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   2, Avg loss: 0.0250, Accuracy: 657/1030 (63.7864%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.7230, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   1, Avg loss: 0.0594, Accuracy: 232/1049 (22.1163%)
___Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   2, Avg loss: 0.0304, Accuracy: 534/1049 (50.9056%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.9573, Accuracy: 91/10000 (0.9100%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   1, Avg loss: 0.0731, Accuracy: 122/781 (15.6210%)
___Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   2, Avg loss: 0.0359, Accuracy: 226/781 (28.9373%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.2223, Accuracy: 83/10000 (0.8300%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0867, Accuracy: 69/408 (16.9118%)
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0537, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.9317, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   1, Avg loss: 0.0550, Accuracy: 318/677 (46.9719%)
___Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 447/677 (66.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.2755, Accuracy: 52/10000 (0.5200%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   1, Avg loss: 0.0504, Accuracy: 417/1129 (36.9353%)
___Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   2, Avg loss: 0.0238, Accuracy: 731/1129 (64.7476%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.1261, Accuracy: 114/10000 (1.1400%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0601, Accuracy: 339/1190 (28.4874%)
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0309, Accuracy: 466/1190 (39.1597%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.6393, Accuracy: 59/10000 (0.5900%)
time spent on training: 182.45069789886475
___Test Target_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.3246, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 14: Avg loss: 5.2613, Accuracy: 0/9950 (0.0000%)
saving model
Done in 601.468513250351 sec.
Server Epoch:15 choose agents : [0, 92, 37, 24, 39, 63, 28, 96, 58, 72].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   1, Avg loss: 0.0565, Accuracy: 368/1657 (22.2088%)
___Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   2, Avg loss: 0.0341, Accuracy: 520/1657 (31.3820%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9630, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0508, Accuracy: 465/1715 (27.1137%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0302, Accuracy: 737/1715 (42.9738%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.1140, Accuracy: 89/10000 (0.8900%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0494, Accuracy: 451/1129 (39.9469%)
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0237, Accuracy: 758/1129 (67.1391%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.5244, Accuracy: 110/10000 (1.1000%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   1, Avg loss: 0.0758, Accuracy: 47/312 (15.0641%)
___Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   2, Avg loss: 0.0398, Accuracy: 164/312 (52.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.8896, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0547, Accuracy: 306/1013 (30.2073%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 492/1013 (48.5686%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.1375, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0535, Accuracy: 268/888 (30.1802%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 431/888 (48.5360%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.8890, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 404/1581 (25.5534%)
___Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 617/1581 (39.0259%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9346, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   1, Avg loss: 0.0800, Accuracy: 41/311 (13.1833%)
___Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   2, Avg loss: 0.0536, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.5266, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   1, Avg loss: 0.0602, Accuracy: 340/803 (42.3412%)
___Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 379/803 (47.1980%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.2542, Accuracy: 51/10000 (0.5100%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   1, Avg loss: 0.0598, Accuracy: 253/1241 (20.3868%)
___Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 430/1241 (34.6495%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.7211, Accuracy: 61/10000 (0.6100%)
time spent on training: 175.55332589149475
___Test Target_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.3266, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 15: Avg loss: 5.2726, Accuracy: 0/9950 (0.0000%)
saving model
Done in 579.0934619903564 sec.
Server Epoch:16 choose agents : [35, 32, 3, 96, 25, 8, 93, 74, 88, 50].
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0814, Accuracy: 64/271 (23.6162%)
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0526, Accuracy: 115/271 (42.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.6702, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0589, Accuracy: 194/735 (26.3946%)
___Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 362/735 (49.2517%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 9.1578, Accuracy: 58/10000 (0.5800%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   1, Avg loss: 0.0714, Accuracy: 120/781 (15.3649%)
___Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   2, Avg loss: 0.0345, Accuracy: 254/781 (32.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.4642, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0790, Accuracy: 50/311 (16.0772%)
___Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0531, Accuracy: 136/311 (43.7299%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.5717, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0562, Accuracy: 308/690 (44.6377%)
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0269, Accuracy: 464/690 (67.2464%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.2726, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   1, Avg loss: 0.0587, Accuracy: 292/1513 (19.2994%)
___Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   2, Avg loss: 0.0360, Accuracy: 493/1513 (32.5843%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.5715, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 417/1742 (23.9380%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0311, Accuracy: 748/1742 (42.9392%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.9334, Accuracy: 83/10000 (0.8300%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 470/1552 (30.2835%)
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 808/1552 (52.0619%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 12.1391, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   1, Avg loss: 0.0723, Accuracy: 152/603 (25.2073%)
___Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   2, Avg loss: 0.0457, Accuracy: 288/603 (47.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.6816, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   1, Avg loss: 0.0610, Accuracy: 172/809 (21.2608%)
___Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   2, Avg loss: 0.0260, Accuracy: 395/809 (48.8257%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.8332, Accuracy: 76/10000 (0.7600%)
time spent on training: 158.41191935539246
___Test Target_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.3287, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 16: Avg loss: 5.2315, Accuracy: 0/9950 (0.0000%)
saving model
Done in 561.701192855835 sec.
Server Epoch:17 choose agents : [53, 43, 41, 30, 82, 92, 50, 34, 7, 64].
___Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   1, Avg loss: 0.0493, Accuracy: 285/813 (35.0554%)
___Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 481/813 (59.1636%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 11.2554, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0614, Accuracy: 308/946 (32.5581%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 361/946 (38.1607%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.9445, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   1, Avg loss: 0.0590, Accuracy: 324/719 (45.0626%)
___Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   2, Avg loss: 0.0307, Accuracy: 466/719 (64.8122%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.0661, Accuracy: 59/10000 (0.5900%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   1, Avg loss: 0.0789, Accuracy: 77/486 (15.8436%)
___Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   2, Avg loss: 0.0403, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.8184, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   1, Avg loss: 0.0751, Accuracy: 77/500 (15.4000%)
___Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   2, Avg loss: 0.0476, Accuracy: 170/500 (34.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.4671, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   1, Avg loss: 0.0508, Accuracy: 466/1715 (27.1720%)
___Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   2, Avg loss: 0.0300, Accuracy: 746/1715 (43.4985%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.7897, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   1, Avg loss: 0.0602, Accuracy: 168/809 (20.7664%)
___Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   2, Avg loss: 0.0263, Accuracy: 363/809 (44.8702%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.4422, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0586, Accuracy: 374/1427 (26.2088%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 602/1427 (42.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.5387, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 348/891 (39.0572%)
___Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 441/891 (49.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.0207, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   1, Avg loss: 0.0642, Accuracy: 168/953 (17.6285%)
___Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   2, Avg loss: 0.0377, Accuracy: 324/953 (33.9979%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.9080, Accuracy: 68/10000 (0.6800%)
time spent on training: 139.15403056144714
___Test Target_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.3305, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 17: Avg loss: 5.2092, Accuracy: 0/9950 (0.0000%)
saving model
Done in 552.0010712146759 sec.
Server Epoch:18 choose agents : [18, 55, 4, 35, 2, 13, 24, 76, 9, 43].
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   1, Avg loss: 0.0769, Accuracy: 112/530 (21.1321%)
___Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   2, Avg loss: 0.0387, Accuracy: 267/530 (50.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.1968, Accuracy: 66/10000 (0.6600%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 255/1071 (23.8095%)
___Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 499/1071 (46.5920%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.7428, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   1, Avg loss: 0.0617, Accuracy: 330/901 (36.6260%)
___Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   2, Avg loss: 0.0328, Accuracy: 416/901 (46.1709%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.6176, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   1, Avg loss: 0.0816, Accuracy: 69/271 (25.4613%)
___Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   2, Avg loss: 0.0520, Accuracy: 113/271 (41.6974%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.7719, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0645, Accuracy: 215/605 (35.5372%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0384, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.3516, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   1, Avg loss: 0.0561, Accuracy: 345/1645 (20.9726%)
___Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   2, Avg loss: 0.0319, Accuracy: 668/1645 (40.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.2106, Accuracy: 125/10000 (1.2500%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0757, Accuracy: 43/312 (13.7821%)
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0398, Accuracy: 163/312 (52.2436%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.9361, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0818, Accuracy: 65/466 (13.9485%)
___Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0465, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.5370, Accuracy: 50/10000 (0.5000%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0497, Accuracy: 352/1275 (27.6078%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 671/1275 (52.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 10.1704, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   1, Avg loss: 0.0604, Accuracy: 312/946 (32.9810%)
___Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 322/946 (34.0381%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.5534, Accuracy: 54/10000 (0.5400%)
time spent on training: 168.7569854259491
___Test Target_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.3324, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 18: Avg loss: 5.2166, Accuracy: 0/9950 (0.0000%)
saving model
Done in 598.5663523674011 sec.
Server Epoch:19 choose agents : [11, 48, 53, 27, 55, 65, 31, 89, 17, 23].
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0536, Accuracy: 348/712 (48.8764%)
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0253, Accuracy: 437/712 (61.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.6697, Accuracy: 65/10000 (0.6500%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   1, Avg loss: 0.0696, Accuracy: 120/631 (19.0174%)
___Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 237/631 (37.5594%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.3311, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   1, Avg loss: 0.0487, Accuracy: 291/813 (35.7934%)
___Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 450/813 (55.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 10.7813, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 422/1587 (26.5911%)
___Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   2, Avg loss: 0.0332, Accuracy: 609/1587 (38.3743%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.4889, Accuracy: 76/10000 (0.7600%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   1, Avg loss: 0.0553, Accuracy: 273/1071 (25.4902%)
___Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 502/1071 (46.8721%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.4403, Accuracy: 79/10000 (0.7900%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   1, Avg loss: 0.0531, Accuracy: 412/1475 (27.9322%)
___Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 712/1475 (48.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.4477, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   1, Avg loss: 0.0795, Accuracy: 78/460 (16.9565%)
___Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   2, Avg loss: 0.0354, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.1775, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 336/896 (37.5000%)
___Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0343, Accuracy: 422/896 (47.0982%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.6174, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0505, Accuracy: 412/1574 (26.1753%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0263, Accuracy: 710/1574 (45.1080%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.5546, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   1, Avg loss: 0.0596, Accuracy: 320/715 (44.7552%)
___Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   2, Avg loss: 0.0382, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.0281, Accuracy: 50/10000 (0.5000%)
time spent on training: 166.33475637435913
___Test Target_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.3342, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 19: Avg loss: 5.1966, Accuracy: 0/9950 (0.0000%)
saving model
Done in 595.0933032035828 sec.
Server Epoch:20 choose agents : [15, 22, 82, 11, 93, 75, 3, 77, 88, 16].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 336/1154 (29.1161%)
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 405/1154 (35.0953%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.6719, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   1, Avg loss: 0.0447, Accuracy: 518/1470 (35.2381%)
___Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 854/1470 (58.0952%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.8765, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   1, Avg loss: 0.0738, Accuracy: 94/500 (18.8000%)
___Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 184/500 (36.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.3592, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0536, Accuracy: 348/712 (48.8764%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0250, Accuracy: 434/712 (60.9551%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.5210, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   1, Avg loss: 0.0538, Accuracy: 438/1742 (25.1435%)
___Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   2, Avg loss: 0.0308, Accuracy: 730/1742 (41.9059%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.5467, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0639, Accuracy: 251/776 (32.3454%)
___Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0286, Accuracy: 414/776 (53.3505%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.1163, Accuracy: 68/10000 (0.6800%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   1, Avg loss: 0.0704, Accuracy: 126/781 (16.1332%)
___Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   2, Avg loss: 0.0351, Accuracy: 250/781 (32.0102%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.5354, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   1, Avg loss: 0.0511, Accuracy: 361/1340 (26.9403%)
___Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   2, Avg loss: 0.0263, Accuracy: 603/1340 (45.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.8679, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   1, Avg loss: 0.0724, Accuracy: 159/603 (26.3682%)
___Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 281/603 (46.6003%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.0403, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   1, Avg loss: 0.0632, Accuracy: 286/708 (40.3955%)
___Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   2, Avg loss: 0.0352, Accuracy: 429/708 (60.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.9148, Accuracy: 55/10000 (0.5500%)
time spent on training: 158.75376534461975
___Test Target_ResNet_18 poisoned: False, epoch: 20: Avg loss: 5.3361, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 20: Avg loss: 5.2099, Accuracy: 0/9950 (0.0000%)
saving model
Done in 576.7296891212463 sec.
Server Epoch:21 choose agents : [0, 27, 39, 70, 20, 85, 12, 72, 94, 32].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0463, Accuracy: 872/1657 (52.6252%), train_poison_data_count: 1040
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0267, Accuracy: 1007/1657 (60.7725%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0241, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0231, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0230, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0222, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0221, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0211, Accuracy: 1041/1657 (62.8244%), train_poison_data_count: 1040
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0212, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0207, Accuracy: 1043/1657 (62.9451%), train_poison_data_count: 1040
Global model norm: 112.0286566994133.
Norm before scaling: 111.9991629433006. Distance: 1.0050920541082022
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.4148, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: 0.3594, Accuracy: 9949/9950 (99.9899%)
Scaling by  100
Scaled Norm after poisoning: 147.95527591767384, distance: 100.50920161544911
Total norm for 5 adversaries is: 147.95527591767384. distance: 100.50920161544911
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0527, Accuracy: 449/1587 (28.2924%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0331, Accuracy: 623/1587 (39.2565%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.5907, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 310/1013 (30.6022%)
___Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   2, Avg loss: 0.0255, Accuracy: 530/1013 (52.3198%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.3828, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   1, Avg loss: 0.0546, Accuracy: 421/1418 (29.6897%)
___Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   2, Avg loss: 0.0294, Accuracy: 660/1418 (46.5444%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.8053, Accuracy: 90/10000 (0.9000%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 330/807 (40.8922%)
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0330, Accuracy: 427/807 (52.9120%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.2364, Accuracy: 66/10000 (0.6600%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   1, Avg loss: 0.0551, Accuracy: 466/1988 (23.4406%)
___Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   2, Avg loss: 0.0345, Accuracy: 671/1988 (33.7525%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.7428, Accuracy: 81/10000 (0.8100%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   1, Avg loss: 0.0900, Accuracy: 17/338 (5.0296%)
___Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   2, Avg loss: 0.0478, Accuracy: 148/338 (43.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.0494, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   1, Avg loss: 0.0593, Accuracy: 277/1241 (22.3207%)
___Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   2, Avg loss: 0.0360, Accuracy: 419/1241 (33.7631%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.7150, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0531, Accuracy: 392/1662 (23.5860%)
___Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0326, Accuracy: 623/1662 (37.4850%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.3242, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   1, Avg loss: 0.0582, Accuracy: 199/735 (27.0748%)
___Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   2, Avg loss: 0.0214, Accuracy: 382/735 (51.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 9.0744, Accuracy: 60/10000 (0.6000%)
time spent on training: 268.6102454662323
___Test Target_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.6814, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Avg loss: 0.9403, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 683.7658052444458 sec.
Server Epoch:22 choose agents : [17, 32, 73, 28, 12, 2, 85, 13, 18, 80].
___Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   1, Avg loss: 0.0619, Accuracy: 321/1574 (20.3939%)
___Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   2, Avg loss: 0.0271, Accuracy: 695/1574 (44.1550%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.1110, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   1, Avg loss: 0.0664, Accuracy: 154/735 (20.9524%)
___Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   2, Avg loss: 0.0282, Accuracy: 347/735 (47.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 12.5449, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   1, Avg loss: 0.0745, Accuracy: 180/938 (19.1898%)
___Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   2, Avg loss: 0.0357, Accuracy: 340/938 (36.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.9249, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   1, Avg loss: 0.0625, Accuracy: 353/1581 (22.3276%)
___Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   2, Avg loss: 0.0329, Accuracy: 589/1581 (37.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.7264, Accuracy: 99/10000 (0.9900%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.1243, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0595, Accuracy: 46/338 (13.6095%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.3018, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0901, Accuracy: 61/605 (10.0826%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0453, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.0655, Accuracy: 56/10000 (0.5600%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   1, Avg loss: 0.0632, Accuracy: 368/1988 (18.5111%)
___Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 665/1988 (33.4507%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.6805, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0640, Accuracy: 248/1645 (15.0760%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0313, Accuracy: 642/1645 (39.0274%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.3951, Accuracy: 127/10000 (1.2700%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.1042, Accuracy: 5/530 (0.9434%)
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0415, Accuracy: 265/530 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 10.4892, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0826, Accuracy: 70/682 (10.2639%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0381, Accuracy: 262/682 (38.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.5481, Accuracy: 63/10000 (0.6300%)
time spent on training: 184.54563236236572
___Test Target_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.3838, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Avg loss: 1.2017, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 591.6687581539154 sec.
Server Epoch:23 choose agents : [3, 14, 79, 74, 2, 49, 32, 18, 4, 7].
poison local model 3 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Average loss: 0.0453, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Average loss: 0.0319, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   3, Average loss: 0.0249, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   4, Average loss: 0.0240, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   5, Average loss: 0.0235, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   6, Average loss: 0.0233, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   7, Average loss: 0.0228, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   8, Average loss: 0.0220, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   9, Average loss: 0.0221, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch  10, Average loss: 0.0219, Accuracy: 494/781 (63.2522%), train_poison_data_count: 493
Global model norm: 111.99567949953472.
Norm before scaling: 111.9816835957448. Distance: 0.7075745829034146
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.1778, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.2441, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 131.09580972756146, distance: 70.75746013009865
Total norm for 4 adversaries is: 131.09580972756146. distance: 70.75746013009865
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   1, Avg loss: 0.0766, Accuracy: 122/1013 (12.0434%)
___Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   2, Avg loss: 0.0362, Accuracy: 303/1013 (29.9112%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.6621, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   1, Avg loss: 0.1412, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   2, Avg loss: 0.1065, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 5.7817, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0513, Accuracy: 380/1552 (24.4845%)
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0198, Accuracy: 813/1552 (52.3840%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 11.6691, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0852, Accuracy: 76/605 (12.5620%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0430, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.0904, Accuracy: 54/10000 (0.5400%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   1, Avg loss: 0.1019, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   2, Avg loss: 0.0531, Accuracy: 94/440 (21.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.5329, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   1, Avg loss: 0.0620, Accuracy: 174/735 (23.6735%)
___Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   2, Avg loss: 0.0255, Accuracy: 381/735 (51.8367%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 13.1599, Accuracy: 53/10000 (0.5300%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   1, Avg loss: 0.0967, Accuracy: 15/530 (2.8302%)
___Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   2, Avg loss: 0.0453, Accuracy: 264/530 (49.8113%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.9078, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0773, Accuracy: 209/901 (23.1964%)
___Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0333, Accuracy: 378/901 (41.9534%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.6378, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   1, Avg loss: 0.0693, Accuracy: 219/891 (24.5791%)
___Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   2, Avg loss: 0.0278, Accuracy: 440/891 (49.3827%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.4603, Accuracy: 81/10000 (0.8100%)
time spent on training: 236.61874413490295
___Test Target_ResNet_18 poisoned: False, epoch: 23: Avg loss: 6.8440, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.4174, Accuracy: 9948/9950 (99.9799%)
saving model
Done in 675.5095372200012 sec.
Server Epoch:24 choose agents : [92, 33, 42, 36, 22, 98, 4, 17, 76, 3].
___Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   1, Avg loss: 0.0603, Accuracy: 336/1715 (19.5918%)
___Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 758/1715 (44.1983%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.1233, Accuracy: 101/10000 (1.0100%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   1, Avg loss: 0.1054, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   2, Avg loss: 0.0567, Accuracy: 108/515 (20.9709%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.2607, Accuracy: 54/10000 (0.5400%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   1, Avg loss: 0.0598, Accuracy: 264/1372 (19.2420%)
___Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 551/1372 (40.1603%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.6755, Accuracy: 94/10000 (0.9400%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   1, Avg loss: 0.1082, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   2, Avg loss: 0.0561, Accuracy: 115/408 (28.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.3217, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   1, Avg loss: 0.0508, Accuracy: 453/1470 (30.8163%)
___Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 877/1470 (59.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.0527, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   1, Avg loss: 0.1086, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   2, Avg loss: 0.0574, Accuracy: 92/373 (24.6649%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.2475, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   1, Avg loss: 0.0720, Accuracy: 223/901 (24.7503%)
___Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   2, Avg loss: 0.0330, Accuracy: 407/901 (45.1720%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.2219, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0601, Accuracy: 334/1574 (21.2198%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 680/1574 (43.2020%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.9231, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.1071, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0524, Accuracy: 160/466 (34.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.5016, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0381, Accuracy: 180/781 (23.0474%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0288, Accuracy: 338/781 (43.2778%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.4549, Accuracy: 97/10000 (0.9700%)
time spent on training: 202.04171109199524
___Test Target_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.5038, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Avg loss: 0.6531, Accuracy: 9932/9950 (99.8191%)
saving model
Done in 613.3922960758209 sec.
Server Epoch:25 choose agents : [5, 23, 0, 67, 40, 80, 54, 26, 74, 47].
poison local model 5 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   1, Average loss: 0.0352, Accuracy: 1036/1628 (63.6364%), train_poison_data_count: 1028
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   2, Average loss: 0.0172, Accuracy: 1089/1628 (66.8919%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   3, Average loss: 0.0143, Accuracy: 1177/1628 (72.2973%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   4, Average loss: 0.0133, Accuracy: 1218/1628 (74.8157%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   5, Average loss: 0.0129, Accuracy: 1223/1628 (75.1229%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   6, Average loss: 0.0124, Accuracy: 1254/1628 (77.0270%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   7, Average loss: 0.0124, Accuracy: 1259/1628 (77.3342%), train_poison_data_count: 1028
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   8, Average loss: 0.0117, Accuracy: 1273/1628 (78.1941%), train_poison_data_count: 1028
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   9, Average loss: 0.0123, Accuracy: 1267/1628 (77.8256%), train_poison_data_count: 1028
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch  10, Average loss: 0.0125, Accuracy: 1264/1628 (77.6413%), train_poison_data_count: 1028
Global model norm: 111.97877519311416.
Norm before scaling: 111.9501537027194. Distance: 1.0610376841641826
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.7085, Accuracy: 106/10000 (1.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.0632, Accuracy: 9946/9950 (99.9598%)
Scaling by  100
Scaled Norm after poisoning: 151.8013710412393, distance: 106.10377345875828
Total norm for 4 adversaries is: 151.8013710412393. distance: 106.10377345875828
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   1, Avg loss: 0.0784, Accuracy: 167/715 (23.3566%)
___Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   2, Avg loss: 0.0408, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 6.4334, Accuracy: 62/10000 (0.6200%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   1, Avg loss: 0.0457, Accuracy: 346/1657 (20.8811%)
___Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   2, Avg loss: 0.0309, Accuracy: 611/1657 (36.8739%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.6722, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   1, Avg loss: 0.0985, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   2, Avg loss: 0.0458, Accuracy: 148/426 (34.7418%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.9176, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   1, Avg loss: 0.0632, Accuracy: 297/1573 (18.8811%)
___Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 618/1573 (39.2880%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.7877, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   1, Avg loss: 0.0799, Accuracy: 51/682 (7.4780%)
___Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 263/682 (38.5630%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.9264, Accuracy: 53/10000 (0.5300%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0625, Accuracy: 250/1130 (22.1239%)
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0283, Accuracy: 479/1130 (42.3894%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 10.0260, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0637, Accuracy: 274/1446 (18.9488%)
___Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0341, Accuracy: 522/1446 (36.0996%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.7304, Accuracy: 77/10000 (0.7700%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0490, Accuracy: 451/1552 (29.0593%)
___Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0204, Accuracy: 806/1552 (51.9330%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 12.3653, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   1, Avg loss: 0.1524, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   2, Avg loss: 0.1300, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 6.2403, Accuracy: 80/10000 (0.8000%)
time spent on training: 293.32324504852295
___Test Target_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.5889, Accuracy: 105/10000 (1.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.1231, Accuracy: 9898/9950 (99.4774%)
saving model
Done in 708.2551376819611 sec.
Server Epoch:26 choose agents : [26, 4, 33, 73, 30, 86, 10, 12, 68, 82].
___Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   1, Avg loss: 0.0742, Accuracy: 230/1446 (15.9059%)
___Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 506/1446 (34.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.7261, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   1, Avg loss: 0.0896, Accuracy: 184/901 (20.4218%)
___Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   2, Avg loss: 0.0361, Accuracy: 356/901 (39.5117%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.9374, Accuracy: 50/10000 (0.5000%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   1, Avg loss: 0.1246, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   2, Avg loss: 0.0611, Accuracy: 90/515 (17.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.9208, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0748, Accuracy: 175/938 (18.6567%)
___Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0371, Accuracy: 333/938 (35.5011%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.4474, Accuracy: 54/10000 (0.5400%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   1, Avg loss: 0.1188, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   2, Avg loss: 0.0457, Accuracy: 176/486 (36.2140%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.6514, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.0856, Accuracy: 204/1003 (20.3390%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0353, Accuracy: 385/1003 (38.3848%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.4769, Accuracy: 54/10000 (0.5400%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   1, Avg loss: 0.0836, Accuracy: 88/861 (10.2207%)
___Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   2, Avg loss: 0.0219, Accuracy: 455/861 (52.8455%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 11.1061, Accuracy: 106/10000 (1.0600%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   1, Avg loss: 0.1429, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   2, Avg loss: 0.0704, Accuracy: 26/338 (7.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.1060, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0836, Accuracy: 232/1163 (19.9484%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0366, Accuracy: 452/1163 (38.8650%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.8402, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.1178, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0565, Accuracy: 121/500 (24.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.9842, Accuracy: 60/10000 (0.6000%)
time spent on training: 189.36435890197754
___Test Target_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.1443, Accuracy: 118/10000 (1.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Avg loss: 0.4500, Accuracy: 8732/9950 (87.7588%)
saving model
Done in 607.8656492233276 sec.
Server Epoch:27 choose agents : [9, 64, 30, 13, 76, 44, 39, 22, 78, 85].
poison local model 9 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Average loss: 0.0387, Accuracy: 803/1275 (62.9804%), train_poison_data_count: 800
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Average loss: 0.0143, Accuracy: 950/1275 (74.5098%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   3, Average loss: 0.0106, Accuracy: 997/1275 (78.1961%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   4, Average loss: 0.0099, Accuracy: 1035/1275 (81.1765%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   5, Average loss: 0.0096, Accuracy: 1019/1275 (79.9216%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   6, Average loss: 0.0094, Accuracy: 1009/1275 (79.1373%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   7, Average loss: 0.0094, Accuracy: 1024/1275 (80.3137%), train_poison_data_count: 800
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   8, Average loss: 0.0091, Accuracy: 1036/1275 (81.2549%), train_poison_data_count: 800
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   9, Average loss: 0.0088, Accuracy: 1038/1275 (81.4118%), train_poison_data_count: 800
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch  10, Average loss: 0.0091, Accuracy: 1043/1275 (81.8039%), train_poison_data_count: 800
Global model norm: 111.9467167129635.
Norm before scaling: 111.92412503846076. Distance: 1.0425473622785653
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.9783, Accuracy: 82/10000 (0.8200%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.0442, Accuracy: 9937/9950 (99.8693%)
Scaling by  100
Scaled Norm after poisoning: 150.95249666699786, distance: 104.2547398502821
Total norm for 5 adversaries is: 150.95249666699786. distance: 104.2547398502821
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   1, Avg loss: 0.0820, Accuracy: 89/953 (9.3389%)
___Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   2, Avg loss: 0.0388, Accuracy: 336/953 (35.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.0576, Accuracy: 78/10000 (0.7800%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   1, Avg loss: 0.1103, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   2, Avg loss: 0.0433, Accuracy: 178/486 (36.6255%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.6395, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0682, Accuracy: 243/1645 (14.7720%)
___Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0310, Accuracy: 650/1645 (39.5137%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.4969, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   1, Avg loss: 0.1105, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   2, Avg loss: 0.0553, Accuracy: 173/466 (37.1245%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.4165, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0694, Accuracy: 276/1750 (15.7714%)
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0346, Accuracy: 713/1750 (40.7429%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.6180, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   1, Avg loss: 0.0745, Accuracy: 162/1013 (15.9921%)
___Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 520/1013 (51.3327%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.6713, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   1, Avg loss: 0.0561, Accuracy: 410/1470 (27.8912%)
___Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 879/1470 (59.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.1126, Accuracy: 110/10000 (1.1000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   1, Avg loss: 0.1229, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   2, Avg loss: 0.0566, Accuracy: 118/416 (28.3654%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.7223, Accuracy: 82/10000 (0.8200%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0663, Accuracy: 346/1988 (17.4044%)
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0350, Accuracy: 733/1988 (36.8712%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.1095, Accuracy: 96/10000 (0.9600%)
time spent on training: 291.34205627441406
___Test Target_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.8331, Accuracy: 87/10000 (0.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.1049, Accuracy: 9773/9950 (98.2211%)
saving model
Done in 701.9237568378448 sec.
Server Epoch:28 choose agents : [64, 26, 82, 31, 65, 98, 73, 61, 44, 18].
___Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   1, Avg loss: 0.0887, Accuracy: 87/953 (9.1291%)
___Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   2, Avg loss: 0.0398, Accuracy: 328/953 (34.4176%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.9014, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   1, Avg loss: 0.0719, Accuracy: 229/1446 (15.8368%)
___Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 512/1446 (35.4080%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.5535, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.1209, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0562, Accuracy: 121/500 (24.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.2734, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   1, Avg loss: 0.1316, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   2, Avg loss: 0.0456, Accuracy: 138/460 (30.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.4545, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   1, Avg loss: 0.0750, Accuracy: 279/1475 (18.9153%)
___Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 625/1475 (42.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.4781, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.1315, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0661, Accuracy: 51/373 (13.6729%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.5966, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   1, Avg loss: 0.0812, Accuracy: 133/938 (14.1791%)
___Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   2, Avg loss: 0.0351, Accuracy: 336/938 (35.8209%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.9974, Accuracy: 74/10000 (0.7400%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   1, Avg loss: 0.1941, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   2, Avg loss: 0.1705, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.6458, Accuracy: 87/10000 (0.8700%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   1, Avg loss: 0.0732, Accuracy: 281/1750 (16.0571%)
___Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   2, Avg loss: 0.0347, Accuracy: 712/1750 (40.6857%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.7837, Accuracy: 132/10000 (1.3200%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   1, Avg loss: 0.1211, Accuracy: 0/530 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   2, Avg loss: 0.0448, Accuracy: 259/530 (48.8679%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.8998, Accuracy: 69/10000 (0.6900%)
time spent on training: 202.13454508781433
___Test Target_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.3780, Accuracy: 84/10000 (0.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Avg loss: 0.3418, Accuracy: 8888/9950 (89.3266%)
saving model
Done in 612.0887155532837 sec.
Server Epoch:29 choose agents : [10, 11, 42, 19, 88, 80, 54, 78, 92, 96].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Average loss: 0.0437, Accuracy: 511/861 (59.3496%), train_poison_data_count: 549
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Average loss: 0.0192, Accuracy: 605/861 (70.2671%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Average loss: 0.0123, Accuracy: 665/861 (77.2358%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Average loss: 0.0113, Accuracy: 671/861 (77.9326%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Average loss: 0.0116, Accuracy: 667/861 (77.4681%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Average loss: 0.0112, Accuracy: 669/861 (77.7003%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Average loss: 0.0112, Accuracy: 686/861 (79.6748%), train_poison_data_count: 549
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Average loss: 0.0106, Accuracy: 681/861 (79.0941%), train_poison_data_count: 549
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Average loss: 0.0109, Accuracy: 672/861 (78.0488%), train_poison_data_count: 549
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Average loss: 0.0096, Accuracy: 702/861 (81.5331%), train_poison_data_count: 549
Global model norm: 111.92027278798734.
Norm before scaling: 111.90499772407397. Distance: 0.8938385059309685
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.3422, Accuracy: 88/10000 (0.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.1481, Accuracy: 9875/9950 (99.2462%)
Scaling by  100
Scaled Norm after poisoning: 141.75285904303658, distance: 89.38385008629915
Total norm for 4 adversaries is: 141.75285904303658. distance: 89.38385008629915
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0836, Accuracy: 131/712 (18.3989%)
___Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0330, Accuracy: 433/712 (60.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.8148, Accuracy: 71/10000 (0.7100%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   1, Avg loss: 0.0692, Accuracy: 219/1372 (15.9621%)
___Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   2, Avg loss: 0.0317, Accuracy: 532/1372 (38.7755%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.7813, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   1, Avg loss: 0.0683, Accuracy: 235/1036 (22.6834%)
___Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   2, Avg loss: 0.0262, Accuracy: 683/1036 (65.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 14.4463, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.1014, Accuracy: 16/603 (2.6534%)
___Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0453, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.8699, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   1, Avg loss: 0.0975, Accuracy: 29/682 (4.2522%)
___Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   2, Avg loss: 0.0395, Accuracy: 238/682 (34.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.7845, Accuracy: 61/10000 (0.6100%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0727, Accuracy: 213/1130 (18.8496%)
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0280, Accuracy: 487/1130 (43.0973%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.9517, Accuracy: 51/10000 (0.5100%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.1260, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0573, Accuracy: 99/416 (23.7981%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.3750, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   1, Avg loss: 0.0648, Accuracy: 363/1715 (21.1662%)
___Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   2, Avg loss: 0.0302, Accuracy: 781/1715 (45.5394%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.1824, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.1258, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0769, Accuracy: 29/311 (9.3248%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.5137, Accuracy: 54/10000 (0.5400%)
time spent on training: 261.4810028076172
___Test Target_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.2011, Accuracy: 94/10000 (0.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.3680, Accuracy: 9096/9950 (91.4171%)
saving model
Done in 671.2282245159149 sec.
Server Epoch:30 choose agents : [90, 87, 0, 73, 61, 97, 66, 35, 1, 22].
___Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0767, Accuracy: 141/677 (20.8272%)
___Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 479/677 (70.7533%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 11.8092, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   1, Avg loss: 0.0729, Accuracy: 203/1131 (17.9487%)
___Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   2, Avg loss: 0.0315, Accuracy: 392/1131 (34.6596%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.3237, Accuracy: 52/10000 (0.5200%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0573, Accuracy: 324/1657 (19.5534%)
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0321, Accuracy: 604/1657 (36.4514%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.2864, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   1, Avg loss: 0.0757, Accuracy: 163/938 (17.3774%)
___Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   2, Avg loss: 0.0341, Accuracy: 343/938 (36.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.5095, Accuracy: 63/10000 (0.6300%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   1, Avg loss: 0.1949, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   2, Avg loss: 0.1714, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 6.9472, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   1, Avg loss: 0.0717, Accuracy: 231/1213 (19.0437%)
___Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   2, Avg loss: 0.0278, Accuracy: 536/1213 (44.1880%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.4877, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0776, Accuracy: 177/1402 (12.6248%)
___Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 417/1402 (29.7432%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.7860, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   1, Avg loss: 0.1401, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   2, Avg loss: 0.0799, Accuracy: 6/271 (2.2140%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 6.4689, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0719, Accuracy: 213/928 (22.9526%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 616/928 (66.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.6779, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   1, Avg loss: 0.0557, Accuracy: 427/1470 (29.0476%)
___Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   2, Avg loss: 0.0243, Accuracy: 873/1470 (59.3878%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.1683, Accuracy: 102/10000 (1.0200%)
time spent on training: 196.03820967674255
___Test Target_ResNet_18 poisoned: False, epoch: 30: Avg loss: 6.8285, Accuracy: 89/10000 (0.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Avg loss: 1.0606, Accuracy: 6797/9950 (68.3116%)
saving model
Done in 612.299566745758 sec.
Server Epoch:31 choose agents : [12, 97, 60, 95, 0, 45, 47, 74, 1, 90].
poison local model 12 index 5 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   1, Average loss: 0.0490, Accuracy: 200/338 (59.1716%), train_poison_data_count: 218
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   2, Average loss: 0.0393, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   3, Average loss: 0.0317, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   4, Average loss: 0.0309, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   5, Average loss: 0.0291, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   6, Average loss: 0.0275, Accuracy: 217/338 (64.2012%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   7, Average loss: 0.0268, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   8, Average loss: 0.0257, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   9, Average loss: 0.0245, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch  10, Average loss: 0.0244, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Global model norm: 111.90146335057464.
Norm before scaling: 111.89570339159587. Distance: 0.4310820922989787
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 6.4607, Accuracy: 69/10000 (0.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.0731, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 119.30175681727198, distance: 43.10820834775119
Total norm for 5 adversaries is: 119.30175681727198. distance: 43.10820834775119
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0670, Accuracy: 236/1213 (19.4559%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0278, Accuracy: 530/1213 (43.6933%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.3287, Accuracy: 86/10000 (0.8600%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0584, Accuracy: 509/2227 (22.8559%)
___Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1050/2227 (47.1486%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.4215, Accuracy: 125/10000 (1.2500%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.0787, Accuracy: 129/599 (21.5359%)
___Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0331, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 13.0646, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0555, Accuracy: 310/1657 (18.7085%)
___Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0320, Accuracy: 587/1657 (35.4255%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.3702, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   1, Avg loss: 0.0905, Accuracy: 71/669 (10.6129%)
___Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   2, Avg loss: 0.0438, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.0499, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   1, Avg loss: 0.1714, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   2, Avg loss: 0.1421, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 6.3302, Accuracy: 99/10000 (0.9900%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   1, Avg loss: 0.0533, Accuracy: 420/1552 (27.0619%)
___Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   2, Avg loss: 0.0203, Accuracy: 798/1552 (51.4175%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 11.4257, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0674, Accuracy: 210/928 (22.6293%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 604/928 (65.0862%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.3695, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   1, Avg loss: 0.0697, Accuracy: 154/677 (22.7474%)
___Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 467/677 (68.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 11.7614, Accuracy: 61/10000 (0.6100%)
time spent on training: 277.24386954307556
___Test Target_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.9925, Accuracy: 73/10000 (0.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.3561, Accuracy: 9928/9950 (99.7789%)
saving model
Done in 689.7156460285187 sec.
Server Epoch:32 choose agents : [90, 32, 84, 98, 78, 46, 40, 68, 29, 95].
___Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0639, Accuracy: 187/677 (27.6219%)
___Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0208, Accuracy: 460/677 (67.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 11.2123, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0577, Accuracy: 200/735 (27.2109%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0287, Accuracy: 369/735 (50.2041%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 10.8783, Accuracy: 60/10000 (0.6000%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0721, Accuracy: 244/1190 (20.5042%)
___Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0315, Accuracy: 462/1190 (38.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.1417, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   1, Avg loss: 0.1018, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   2, Avg loss: 0.0525, Accuracy: 94/373 (25.2011%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.2073, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   1, Avg loss: 0.1073, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   2, Avg loss: 0.0516, Accuracy: 163/416 (39.1827%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.2421, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0614, Accuracy: 356/1904 (18.6975%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0305, Accuracy: 705/1904 (37.0273%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.2478, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   1, Avg loss: 0.0644, Accuracy: 293/1573 (18.6268%)
___Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   2, Avg loss: 0.0344, Accuracy: 599/1573 (38.0801%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.6276, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   1, Avg loss: 0.0721, Accuracy: 275/1163 (23.6457%)
___Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   2, Avg loss: 0.0362, Accuracy: 472/1163 (40.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.4765, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   1, Avg loss: 0.0560, Accuracy: 329/1440 (22.8472%)
___Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   2, Avg loss: 0.0274, Accuracy: 718/1440 (49.8611%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.5637, Accuracy: 94/10000 (0.9400%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0701, Accuracy: 181/599 (30.2170%)
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0308, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 12.5266, Accuracy: 50/10000 (0.5000%)
time spent on training: 200.47275137901306
___Test Target_ResNet_18 poisoned: False, epoch: 32: Avg loss: 5.8422, Accuracy: 82/10000 (0.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Avg loss: 0.6767, Accuracy: 9451/9950 (94.9849%)
saving model
Done in 618.5074601173401 sec.
Server Epoch:33 choose agents : [15, 44, 14, 40, 61, 33, 88, 73, 21, 30].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Average loss: 0.0348, Accuracy: 732/1154 (63.4315%), train_poison_data_count: 722
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Average loss: 0.0183, Accuracy: 846/1154 (73.3102%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Average loss: 0.0141, Accuracy: 857/1154 (74.2634%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Average loss: 0.0134, Accuracy: 874/1154 (75.7366%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Average loss: 0.0136, Accuracy: 871/1154 (75.4766%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Average loss: 0.0129, Accuracy: 865/1154 (74.9567%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Average loss: 0.0122, Accuracy: 895/1154 (77.5563%), train_poison_data_count: 722
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Average loss: 0.0126, Accuracy: 880/1154 (76.2565%), train_poison_data_count: 722
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Average loss: 0.0122, Accuracy: 868/1154 (75.2166%), train_poison_data_count: 722
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Average loss: 0.0117, Accuracy: 891/1154 (77.2097%), train_poison_data_count: 722
Global model norm: 111.89215563294641.
Norm before scaling: 111.87272605929249. Distance: 0.9150857333369601
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.3925, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.4922, Accuracy: 8710/9950 (87.5377%)
Scaling by  100
Scaled Norm after poisoning: 142.7424814679393, distance: 91.50857520439
Total norm for 5 adversaries is: 142.7424814679393. distance: 91.50857520439
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Avg loss: 0.0628, Accuracy: 329/1750 (18.8000%)
___Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 704/1750 (40.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.7476, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0726, Accuracy: 130/1013 (12.8332%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 364/1013 (35.9329%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.3388, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   1, Avg loss: 0.0615, Accuracy: 300/1573 (19.0718%)
___Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   2, Avg loss: 0.0340, Accuracy: 597/1573 (37.9530%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.2019, Accuracy: 59/10000 (0.5900%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   1, Avg loss: 0.1382, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   2, Avg loss: 0.1281, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.8334, Accuracy: 73/10000 (0.7300%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   1, Avg loss: 0.0941, Accuracy: 15/515 (2.9126%)
___Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   2, Avg loss: 0.0519, Accuracy: 124/515 (24.0777%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.2452, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   1, Avg loss: 0.0816, Accuracy: 71/603 (11.7745%)
___Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   2, Avg loss: 0.0424, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.4528, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   1, Avg loss: 0.0658, Accuracy: 196/938 (20.8955%)
___Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   2, Avg loss: 0.0339, Accuracy: 362/938 (38.5928%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.8250, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   1, Avg loss: 0.0560, Accuracy: 342/1949 (17.5475%)
___Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   2, Avg loss: 0.0323, Accuracy: 649/1949 (33.2991%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.5382, Accuracy: 89/10000 (0.8900%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   1, Avg loss: 0.0908, Accuracy: 7/486 (1.4403%)
___Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   2, Avg loss: 0.0395, Accuracy: 209/486 (43.0041%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.3580, Accuracy: 55/10000 (0.5500%)
time spent on training: 299.2580327987671
___Test Target_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.2804, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.9177, Accuracy: 6729/9950 (67.6281%)
saving model
Done in 749.423184633255 sec.
Server Epoch:34 choose agents : [0, 71, 20, 83, 56, 36, 68, 89, 82, 19].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   1, Avg loss: 0.0603, Accuracy: 279/1657 (16.8377%)
___Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   2, Avg loss: 0.0319, Accuracy: 592/1657 (35.7272%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.6154, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0867, Accuracy: 64/818 (7.8240%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0320, Accuracy: 333/818 (40.7090%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.7763, Accuracy: 83/10000 (0.8300%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   1, Avg loss: 0.0824, Accuracy: 152/807 (18.8352%)
___Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   2, Avg loss: 0.0356, Accuracy: 419/807 (51.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.8359, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0655, Accuracy: 325/1953 (16.6411%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0333, Accuracy: 798/1953 (40.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.8048, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   1, Avg loss: 0.1360, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   2, Avg loss: 0.1048, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 6.6267, Accuracy: 64/10000 (0.6400%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   1, Avg loss: 0.1260, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   2, Avg loss: 0.0612, Accuracy: 93/408 (22.7941%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.1623, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   1, Avg loss: 0.0797, Accuracy: 233/1163 (20.0344%)
___Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   2, Avg loss: 0.0375, Accuracy: 433/1163 (37.2313%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.5722, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   1, Avg loss: 0.0828, Accuracy: 192/896 (21.4286%)
___Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   2, Avg loss: 0.0359, Accuracy: 449/896 (50.1116%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.6219, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.1099, Accuracy: 1/500 (0.2000%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0537, Accuracy: 142/500 (28.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.1725, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   1, Avg loss: 0.0660, Accuracy: 253/1036 (24.4208%)
___Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   2, Avg loss: 0.0256, Accuracy: 651/1036 (62.8378%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 12.9817, Accuracy: 76/10000 (0.7600%)
time spent on training: 237.4754021167755
___Test Target_ResNet_18 poisoned: False, epoch: 34: Avg loss: 6.8998, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Avg loss: 1.7452, Accuracy: 4791/9950 (48.1508%)
saving model
Done in 679.9109783172607 sec.
Server Epoch:35 choose agents : [18, 75, 5, 22, 38, 73, 46, 20, 83, 88].
poison local model 18 index 7 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   1, Average loss: 0.0387, Accuracy: 327/530 (61.6981%), train_poison_data_count: 338
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   2, Average loss: 0.0258, Accuracy: 372/530 (70.1887%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   3, Average loss: 0.0202, Accuracy: 410/530 (77.3585%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   4, Average loss: 0.0191, Accuracy: 422/530 (79.6226%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   5, Average loss: 0.0183, Accuracy: 420/530 (79.2453%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   6, Average loss: 0.0178, Accuracy: 414/530 (78.1132%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   7, Average loss: 0.0180, Accuracy: 417/530 (78.6792%), train_poison_data_count: 338
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   8, Average loss: 0.0159, Accuracy: 421/530 (79.4340%), train_poison_data_count: 338
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   9, Average loss: 0.0177, Accuracy: 410/530 (77.3585%), train_poison_data_count: 338
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch  10, Average loss: 0.0168, Accuracy: 418/530 (78.8679%), train_poison_data_count: 338
Global model norm: 111.86932160868547.
Norm before scaling: 111.86061796522715. Distance: 0.547516065605685
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 6.9282, Accuracy: 49/10000 (0.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.2151, Accuracy: 9695/9950 (97.4372%)
Scaling by  100
Scaled Norm after poisoning: 123.64414269765268, distance: 54.751607514214825
Total norm for 3 adversaries is: 123.64414269765268. distance: 54.751607514214825
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   1, Avg loss: 0.0854, Accuracy: 123/776 (15.8505%)
___Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   2, Avg loss: 0.0350, Accuracy: 374/776 (48.1959%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.3990, Accuracy: 83/10000 (0.8300%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   1, Avg loss: 0.0480, Accuracy: 424/1628 (26.0442%)
___Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   2, Avg loss: 0.0223, Accuracy: 968/1628 (59.4595%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.3277, Accuracy: 164/10000 (1.6400%)
___Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   1, Avg loss: 0.0542, Accuracy: 416/1470 (28.2993%)
___Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   2, Avg loss: 0.0243, Accuracy: 857/1470 (58.2993%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.1086, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   1, Avg loss: 0.0729, Accuracy: 182/1131 (16.0920%)
___Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   2, Avg loss: 0.0312, Accuracy: 494/1131 (43.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.0865, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   1, Avg loss: 0.0687, Accuracy: 180/938 (19.1898%)
___Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   2, Avg loss: 0.0340, Accuracy: 350/938 (37.3134%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.4411, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   1, Avg loss: 0.0633, Accuracy: 317/1904 (16.6492%)
___Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   2, Avg loss: 0.0308, Accuracy: 710/1904 (37.2899%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.1723, Accuracy: 118/10000 (1.1800%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   1, Avg loss: 0.0789, Accuracy: 143/807 (17.7200%)
___Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   2, Avg loss: 0.0348, Accuracy: 407/807 (50.4337%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.4059, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   1, Avg loss: 0.0627, Accuracy: 331/1953 (16.9483%)
___Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   2, Avg loss: 0.0331, Accuracy: 793/1953 (40.6042%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.8213, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   1, Avg loss: 0.0928, Accuracy: 36/603 (5.9701%)
___Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   2, Avg loss: 0.0452, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.7594, Accuracy: 47/10000 (0.4700%)
time spent on training: 311.76921582221985
___Test Target_ResNet_18 poisoned: False, epoch: 35: Avg loss: 6.6553, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.5259, Accuracy: 8062/9950 (81.0251%)
saving model
Done in 758.763247013092 sec.
Server Epoch:36 choose agents : [19, 2, 97, 73, 5, 51, 21, 63, 11, 90].
___Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   1, Avg loss: 0.0627, Accuracy: 283/1036 (27.3166%)
___Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   2, Avg loss: 0.0260, Accuracy: 679/1036 (65.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 11.8614, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0935, Accuracy: 56/605 (9.2562%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0436, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.4502, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   1, Avg loss: 0.0602, Accuracy: 274/1213 (22.5886%)
___Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 513/1213 (42.2918%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.3404, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   1, Avg loss: 0.0701, Accuracy: 174/938 (18.5501%)
___Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   2, Avg loss: 0.0339, Accuracy: 370/938 (39.4456%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.6145, Accuracy: 68/10000 (0.6800%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   1, Avg loss: 0.0485, Accuracy: 435/1628 (26.7199%)
___Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   2, Avg loss: 0.0226, Accuracy: 921/1628 (56.5725%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.9195, Accuracy: 169/10000 (1.6900%)
___Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0736, Accuracy: 154/1049 (14.6806%)
___Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0301, Accuracy: 518/1049 (49.3804%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.7735, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   1, Avg loss: 0.0601, Accuracy: 359/1949 (18.4197%)
___Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   2, Avg loss: 0.0322, Accuracy: 628/1949 (32.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.4485, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   1, Avg loss: 0.0761, Accuracy: 133/888 (14.9775%)
___Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   2, Avg loss: 0.0264, Accuracy: 431/888 (48.5360%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.9393, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0805, Accuracy: 148/712 (20.7865%)
___Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0294, Accuracy: 429/712 (60.2528%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.2037, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   1, Avg loss: 0.0683, Accuracy: 163/677 (24.0768%)
___Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   2, Avg loss: 0.0206, Accuracy: 463/677 (68.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 11.4528, Accuracy: 62/10000 (0.6200%)
time spent on training: 220.00549602508545
___Test Target_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.2666, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Avg loss: 1.1586, Accuracy: 5773/9950 (58.0201%)
saving model
Done in 655.8941559791565 sec.
Server Epoch:37 choose agents : [20, 66, 18, 64, 77, 51, 65, 3, 17, 50].
poison local model 20 index 8 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   1, Average loss: 0.0357, Accuracy: 505/807 (62.5774%), train_poison_data_count: 519
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   2, Average loss: 0.0194, Accuracy: 602/807 (74.5973%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   3, Average loss: 0.0160, Accuracy: 642/807 (79.5539%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   4, Average loss: 0.0146, Accuracy: 646/807 (80.0496%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   5, Average loss: 0.0146, Accuracy: 637/807 (78.9343%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   6, Average loss: 0.0145, Accuracy: 640/807 (79.3061%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   7, Average loss: 0.0143, Accuracy: 638/807 (79.0582%), train_poison_data_count: 519
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   8, Average loss: 0.0133, Accuracy: 644/807 (79.8017%), train_poison_data_count: 519
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   9, Average loss: 0.0128, Accuracy: 653/807 (80.9170%), train_poison_data_count: 519
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch  10, Average loss: 0.0129, Accuracy: 652/807 (80.7931%), train_poison_data_count: 519
Global model norm: 111.85655836131157.
Norm before scaling: 111.84327849858703. Distance: 0.685766092664394
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.8436, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.2008, Accuracy: 9740/9950 (97.8894%)
Scaling by  100
Scaled Norm after poisoning: 129.88606786333938, distance: 68.57660662764307
Total norm for 4 adversaries is: 129.88606786333938. distance: 68.57660662764307
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   1, Avg loss: 0.0693, Accuracy: 222/1402 (15.8345%)
___Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 403/1402 (28.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.7288, Accuracy: 73/10000 (0.7300%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   1, Avg loss: 0.0444, Accuracy: 208/530 (39.2453%)
___Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   2, Avg loss: 0.0328, Accuracy: 337/530 (63.5849%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.7173, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   1, Avg loss: 0.0741, Accuracy: 115/953 (12.0672%)
___Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   2, Avg loss: 0.0393, Accuracy: 339/953 (35.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.6399, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0641, Accuracy: 246/1340 (18.3582%)
___Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0280, Accuracy: 528/1340 (39.4030%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.3503, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0692, Accuracy: 160/1049 (15.2526%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0287, Accuracy: 545/1049 (51.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.4664, Accuracy: 125/10000 (1.2500%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   1, Avg loss: 0.0663, Accuracy: 283/1475 (19.1864%)
___Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 613/1475 (41.5593%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.6200, Accuracy: 95/10000 (0.9500%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   1, Avg loss: 0.0748, Accuracy: 53/781 (6.7862%)
___Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   2, Avg loss: 0.0332, Accuracy: 257/781 (32.9065%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.6246, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   1, Avg loss: 0.0600, Accuracy: 325/1574 (20.6480%)
___Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   2, Avg loss: 0.0267, Accuracy: 718/1574 (45.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.8048, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   1, Avg loss: 0.0799, Accuracy: 54/809 (6.6749%)
___Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   2, Avg loss: 0.0277, Accuracy: 363/809 (44.8702%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.3248, Accuracy: 106/10000 (1.0600%)
time spent on training: 323.616512298584
___Test Target_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.6248, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.6286, Accuracy: 7567/9950 (76.0503%)
saving model
Done in 767.8188796043396 sec.
Server Epoch:38 choose agents : [88, 72, 77, 38, 20, 39, 70, 1, 37, 6].
___Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0930, Accuracy: 37/603 (6.1360%)
___Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0447, Accuracy: 283/603 (46.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.5136, Accuracy: 54/10000 (0.5400%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0696, Accuracy: 194/1241 (15.6326%)
___Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0359, Accuracy: 464/1241 (37.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.8155, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0660, Accuracy: 248/1340 (18.5075%)
___Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0280, Accuracy: 537/1340 (40.0746%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.2161, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0742, Accuracy: 147/1131 (12.9973%)
___Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0296, Accuracy: 544/1131 (48.0990%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.4408, Accuracy: 102/10000 (1.0200%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0361, Accuracy: 367/807 (45.4771%)
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0245, Accuracy: 455/807 (56.3817%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.4759, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0642, Accuracy: 178/1013 (17.5716%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0252, Accuracy: 501/1013 (49.4571%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.3308, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0689, Accuracy: 281/1418 (19.8166%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0300, Accuracy: 680/1418 (47.9549%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.0978, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0695, Accuracy: 202/928 (21.7672%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0256, Accuracy: 571/928 (61.5302%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.5279, Accuracy: 117/10000 (1.1700%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0646, Accuracy: 285/1129 (25.2436%)
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0243, Accuracy: 715/1129 (63.3304%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.5359, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   1, Avg loss: 0.0599, Accuracy: 358/1956 (18.3027%)
___Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   2, Avg loss: 0.0308, Accuracy: 733/1956 (37.4744%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.2501, Accuracy: 123/10000 (1.2300%)
time spent on training: 266.82688903808594
___Test Target_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.3220, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Avg loss: 1.4009, Accuracy: 5913/9950 (59.4271%)
saving model
Done in 709.2356588840485 sec.
Server Epoch:39 choose agents : [24, 58, 63, 88, 9, 51, 54, 64, 13, 27].
poison local model 24 index 9 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   1, Average loss: 0.0419, Accuracy: 188/312 (60.2564%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   2, Average loss: 0.0332, Accuracy: 199/312 (63.7821%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   3, Average loss: 0.0269, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   4, Average loss: 0.0251, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   5, Average loss: 0.0253, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   6, Average loss: 0.0229, Accuracy: 202/312 (64.7436%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   7, Average loss: 0.0223, Accuracy: 204/312 (65.3846%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   8, Average loss: 0.0206, Accuracy: 212/312 (67.9487%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   9, Average loss: 0.0190, Accuracy: 227/312 (72.7564%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch  10, Average loss: 0.0206, Accuracy: 215/312 (68.9103%), train_poison_data_count: 200
Global model norm: 111.83938853608329.
Norm before scaling: 111.83563378626242. Distance: 0.3608755215362596
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 6.5839, Accuracy: 62/10000 (0.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: 0.0675, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 117.10332393473082, distance: 36.08755358066684
Total norm for 3 adversaries is: 117.10332393473082. distance: 36.08755358066684
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0707, Accuracy: 194/803 (24.1594%)
___Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0355, Accuracy: 415/803 (51.6812%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.1229, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0693, Accuracy: 152/888 (17.1171%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 470/888 (52.9279%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 10.0556, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   1, Avg loss: 0.0852, Accuracy: 47/603 (7.7944%)
___Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   2, Avg loss: 0.0442, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.5601, Accuracy: 62/10000 (0.6200%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0460, Accuracy: 365/1275 (28.6275%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0170, Accuracy: 802/1275 (62.9020%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 10.8917, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0676, Accuracy: 187/1049 (17.8265%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0287, Accuracy: 536/1049 (51.0963%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.6048, Accuracy: 113/10000 (1.1300%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   1, Avg loss: 0.0640, Accuracy: 244/1130 (21.5929%)
___Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   2, Avg loss: 0.0278, Accuracy: 504/1130 (44.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 9.4441, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   1, Avg loss: 0.0731, Accuracy: 112/953 (11.7524%)
___Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   2, Avg loss: 0.0385, Accuracy: 326/953 (34.2078%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.7734, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   1, Avg loss: 0.0630, Accuracy: 283/1645 (17.2036%)
___Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   2, Avg loss: 0.0311, Accuracy: 723/1645 (43.9514%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.2618, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0612, Accuracy: 345/1587 (21.7391%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0333, Accuracy: 610/1587 (38.4373%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.8128, Accuracy: 78/10000 (0.7800%)
time spent on training: 328.350704908371
___Test Target_ResNet_18 poisoned: False, epoch: 39: Avg loss: 6.1987, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Avg loss: 0.1820, Accuracy: 9942/9950 (99.9196%)
saving model
Done in 773.7967963218689 sec.
Server Epoch:40 choose agents : [40, 88, 66, 47, 61, 96, 3, 5, 16, 24].
___Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   1, Avg loss: 0.0631, Accuracy: 289/1573 (18.3725%)
___Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   2, Avg loss: 0.0343, Accuracy: 633/1573 (40.2416%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.8109, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   1, Avg loss: 0.0835, Accuracy: 55/603 (9.1211%)
___Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.5882, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   1, Avg loss: 0.0681, Accuracy: 235/1402 (16.7618%)
___Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 427/1402 (30.4565%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.6873, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1602, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1312, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.8039, Accuracy: 72/10000 (0.7200%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   1, Avg loss: 0.1567, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   2, Avg loss: 0.1366, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.9233, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   1, Avg loss: 0.1069, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   2, Avg loss: 0.0657, Accuracy: 54/311 (17.3633%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.2658, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   1, Avg loss: 0.0733, Accuracy: 55/781 (7.0423%)
___Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   2, Avg loss: 0.0323, Accuracy: 273/781 (34.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.6937, Accuracy: 93/10000 (0.9300%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   1, Avg loss: 0.0456, Accuracy: 462/1628 (28.3784%)
___Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   2, Avg loss: 0.0222, Accuracy: 947/1628 (58.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.4639, Accuracy: 147/10000 (1.4700%)
___Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   1, Avg loss: 0.0710, Accuracy: 168/708 (23.7288%)
___Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   2, Avg loss: 0.0366, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.3431, Accuracy: 69/10000 (0.6900%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   1, Avg loss: 0.0476, Accuracy: 48/312 (15.3846%)
___Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   2, Avg loss: 0.0261, Accuracy: 206/312 (66.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.9466, Accuracy: 76/10000 (0.7600%)
time spent on training: 251.04190850257874
___Test Target_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.9859, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Avg loss: 0.3488, Accuracy: 9838/9950 (98.8744%)
saving model
Saving model on epoch 40
Done in 698.9575448036194 sec.
Server Epoch:41 choose agents : [25, 36, 82, 2, 93, 42, 66, 94, 44, 38].
poison local model 25 index 10 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Average loss: 0.0373, Accuracy: 435/690 (63.0435%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Average loss: 0.0179, Accuracy: 539/690 (78.1159%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   3, Average loss: 0.0137, Accuracy: 571/690 (82.7536%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   4, Average loss: 0.0132, Accuracy: 578/690 (83.7681%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   5, Average loss: 0.0132, Accuracy: 571/690 (82.7536%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   6, Average loss: 0.0112, Accuracy: 579/690 (83.9130%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   7, Average loss: 0.0110, Accuracy: 583/690 (84.4928%), train_poison_data_count: 440
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   8, Average loss: 0.0109, Accuracy: 566/690 (82.0290%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   9, Average loss: 0.0112, Accuracy: 570/690 (82.6087%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch  10, Average loss: 0.0107, Accuracy: 573/690 (83.0435%), train_poison_data_count: 440
Global model norm: 111.83270412065292.
Norm before scaling: 111.8225392013502. Distance: 0.6156949695772609
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.2189, Accuracy: 45/10000 (0.4500%)
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.1894, Accuracy: 9451/9950 (94.9849%)
Scaling by  100
Scaled Norm after poisoning: 126.61752276171138, distance: 61.569499126241475
Total norm for 4 adversaries is: 126.61752276171138. distance: 61.569499126241475
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   1, Avg loss: 0.1015, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   2, Avg loss: 0.0535, Accuracy: 117/408 (28.6765%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.5307, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   1, Avg loss: 0.0914, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   2, Avg loss: 0.0516, Accuracy: 171/500 (34.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.6572, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0824, Accuracy: 79/605 (13.0579%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0428, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.0917, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   1, Avg loss: 0.0603, Accuracy: 330/1742 (18.9437%)
___Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   2, Avg loss: 0.0304, Accuracy: 758/1742 (43.5132%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.2781, Accuracy: 84/10000 (0.8400%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   1, Avg loss: 0.0617, Accuracy: 234/1372 (17.0554%)
___Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 543/1372 (39.5773%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.5276, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0673, Accuracy: 234/1402 (16.6904%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0378, Accuracy: 435/1402 (31.0271%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.6739, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   1, Avg loss: 0.0610, Accuracy: 312/1662 (18.7726%)
___Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   2, Avg loss: 0.0320, Accuracy: 657/1662 (39.5307%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.2601, Accuracy: 113/10000 (1.1300%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0633, Accuracy: 297/1750 (16.9714%)
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0348, Accuracy: 709/1750 (40.5143%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.5528, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0669, Accuracy: 181/1131 (16.0035%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0295, Accuracy: 535/1131 (47.3033%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.6217, Accuracy: 105/10000 (1.0500%)
time spent on training: 316.2562186717987
___Test Target_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.9999, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.4163, Accuracy: 8211/9950 (82.5226%)
saving model
Saving model on epoch 41
Done in 721.8564231395721 sec.
Server Epoch:42 choose agents : [55, 57, 12, 67, 31, 76, 26, 6, 64, 97].
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   1, Avg loss: 0.0730, Accuracy: 183/1071 (17.0868%)
___Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 531/1071 (49.5798%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.4867, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   1, Avg loss: 0.0697, Accuracy: 191/1154 (16.5511%)
___Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   2, Avg loss: 0.0258, Accuracy: 475/1154 (41.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 10.3694, Accuracy: 71/10000 (0.7100%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   1, Avg loss: 0.1102, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   2, Avg loss: 0.0473, Accuracy: 79/338 (23.3728%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.2226, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.1075, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0431, Accuracy: 132/426 (30.9859%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.5743, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.1160, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0437, Accuracy: 169/460 (36.7391%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.9802, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   1, Avg loss: 0.1087, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   2, Avg loss: 0.0498, Accuracy: 173/466 (37.1245%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.7673, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   1, Avg loss: 0.0662, Accuracy: 262/1446 (18.1189%)
___Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   2, Avg loss: 0.0341, Accuracy: 545/1446 (37.6902%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.7746, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   1, Avg loss: 0.0613, Accuracy: 346/1956 (17.6892%)
___Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   2, Avg loss: 0.0311, Accuracy: 696/1956 (35.5828%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.1783, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0783, Accuracy: 92/953 (9.6537%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0397, Accuracy: 340/953 (35.6768%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.0008, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   1, Avg loss: 0.0633, Accuracy: 245/1213 (20.1979%)
___Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 561/1213 (46.2490%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.0130, Accuracy: 84/10000 (0.8400%)
time spent on training: 231.5874273777008
___Test Target_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.4972, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Avg loss: 0.7695, Accuracy: 6932/9950 (69.6683%)
saving model
Saving model on epoch 42
Done in 638.2096378803253 sec.
Server Epoch:43 choose agents : [30, 89, 47, 67, 72, 23, 57, 51, 45, 60].
poison local model 30 index 11 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Average loss: 0.0409, Accuracy: 297/486 (61.1111%), train_poison_data_count: 318
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Average loss: 0.0298, Accuracy: 319/486 (65.6379%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   3, Average loss: 0.0219, Accuracy: 328/486 (67.4897%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   4, Average loss: 0.0208, Accuracy: 335/486 (68.9300%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   5, Average loss: 0.0209, Accuracy: 337/486 (69.3416%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   6, Average loss: 0.0201, Accuracy: 342/486 (70.3704%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   7, Average loss: 0.0187, Accuracy: 345/486 (70.9877%), train_poison_data_count: 318
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   8, Average loss: 0.0192, Accuracy: 351/486 (72.2222%), train_poison_data_count: 318
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   9, Average loss: 0.0192, Accuracy: 340/486 (69.9588%), train_poison_data_count: 318
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch  10, Average loss: 0.0175, Accuracy: 349/486 (71.8107%), train_poison_data_count: 318
Global model norm: 111.81888868696335.
Norm before scaling: 111.81156546563061. Distance: 0.5201551663452484
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.5690, Accuracy: 33/10000 (0.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.1071, Accuracy: 9903/9950 (99.5276%)
Scaling by  100
Scaled Norm after poisoning: 122.54829245801429, distance: 52.01551470024352
Total norm for 3 adversaries is: 122.54829245801429. distance: 52.01551470024352
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0748, Accuracy: 212/896 (23.6607%)
___Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 458/896 (51.1161%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.3931, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   1, Avg loss: 0.1642, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   2, Avg loss: 0.1358, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 5.8953, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   1, Avg loss: 0.0971, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   2, Avg loss: 0.0422, Accuracy: 132/426 (30.9859%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.4902, Accuracy: 54/10000 (0.5400%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   1, Avg loss: 0.0675, Accuracy: 196/1241 (15.7937%)
___Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   2, Avg loss: 0.0349, Accuracy: 466/1241 (37.5504%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.9799, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   1, Avg loss: 0.0808, Accuracy: 157/715 (21.9580%)
___Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   2, Avg loss: 0.0426, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.3052, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   1, Avg loss: 0.0644, Accuracy: 221/1154 (19.1508%)
___Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   2, Avg loss: 0.0273, Accuracy: 482/1154 (41.7678%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 10.3637, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   1, Avg loss: 0.0681, Accuracy: 203/1049 (19.3518%)
___Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   2, Avg loss: 0.0281, Accuracy: 542/1049 (51.6683%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.6177, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0869, Accuracy: 84/669 (12.5561%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0424, Accuracy: 357/669 (53.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.9058, Accuracy: 87/10000 (0.8700%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   1, Avg loss: 0.0554, Accuracy: 583/2227 (26.1787%)
___Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1045/2227 (46.9241%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.0245, Accuracy: 133/10000 (1.3300%)
time spent on training: 302.4190332889557
___Test Target_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.3521, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.2254, Accuracy: 9521/9950 (95.6884%)
saving model
Done in 712.5273473262787 sec.
Server Epoch:44 choose agents : [20, 45, 15, 72, 6, 60, 59, 46, 31, 84].
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0560, Accuracy: 213/807 (26.3941%)
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0275, Accuracy: 443/807 (54.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.6804, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   1, Avg loss: 0.0830, Accuracy: 82/669 (12.2571%)
___Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   2, Avg loss: 0.0405, Accuracy: 361/669 (53.9611%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.3712, Accuracy: 87/10000 (0.8700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0554, Accuracy: 268/1154 (23.2236%)
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 431/1154 (37.3484%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.4810, Accuracy: 58/10000 (0.5800%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   1, Avg loss: 0.0664, Accuracy: 208/1241 (16.7607%)
___Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   2, Avg loss: 0.0357, Accuracy: 439/1241 (35.3747%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.1616, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   1, Avg loss: 0.0570, Accuracy: 346/1956 (17.6892%)
___Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   2, Avg loss: 0.0306, Accuracy: 713/1956 (36.4519%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.2567, Accuracy: 115/10000 (1.1500%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   1, Avg loss: 0.0545, Accuracy: 590/2227 (26.4930%)
___Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1071/2227 (48.0916%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.1088, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   1, Avg loss: 0.0660, Accuracy: 206/1089 (18.9164%)
___Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   2, Avg loss: 0.0270, Accuracy: 588/1089 (53.9945%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.2832, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   1, Avg loss: 0.0606, Accuracy: 321/1904 (16.8592%)
___Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   2, Avg loss: 0.0300, Accuracy: 746/1904 (39.1807%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.2563, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.1068, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0411, Accuracy: 172/460 (37.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.9019, Accuracy: 51/10000 (0.5100%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   1, Avg loss: 0.0738, Accuracy: 228/1190 (19.1597%)
___Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   2, Avg loss: 0.0315, Accuracy: 466/1190 (39.1597%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.9449, Accuracy: 81/10000 (0.8100%)
time spent on training: 300.69013953208923
___Test Target_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.0505, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Avg loss: 0.3984, Accuracy: 8927/9950 (89.7186%)
saving model
Done in 711.9861042499542 sec.
Server Epoch:45 choose agents : [33, 77, 72, 6, 23, 47, 93, 87, 53, 86].
poison local model 33 index 12 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   1, Average loss: 0.0454, Accuracy: 300/515 (58.2524%), train_poison_data_count: 323
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   2, Average loss: 0.0378, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   3, Average loss: 0.0319, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   4, Average loss: 0.0307, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   5, Average loss: 0.0304, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   6, Average loss: 0.0293, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   7, Average loss: 0.0279, Accuracy: 324/515 (62.9126%), train_poison_data_count: 323
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   8, Average loss: 0.0277, Accuracy: 324/515 (62.9126%), train_poison_data_count: 323
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   9, Average loss: 0.0276, Accuracy: 324/515 (62.9126%), train_poison_data_count: 323
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch  10, Average loss: 0.0278, Accuracy: 326/515 (63.3010%), train_poison_data_count: 323
Global model norm: 111.80780978145042.
Norm before scaling: 111.79930225352481. Distance: 0.5132569061962966
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.4894, Accuracy: 53/10000 (0.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.0954, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 122.14229902428356, distance: 51.32568725185275
Total norm for 2 adversaries is: 122.14229902428356. distance: 51.32568725185275
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   1, Avg loss: 0.0568, Accuracy: 265/1340 (19.7761%)
___Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   2, Avg loss: 0.0267, Accuracy: 583/1340 (43.5075%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.8486, Accuracy: 92/10000 (0.9200%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   1, Avg loss: 0.0640, Accuracy: 219/1241 (17.6471%)
___Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   2, Avg loss: 0.0348, Accuracy: 463/1241 (37.3086%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.1960, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   1, Avg loss: 0.0562, Accuracy: 353/1956 (18.0470%)
___Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   2, Avg loss: 0.0306, Accuracy: 711/1956 (36.3497%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.2135, Accuracy: 135/10000 (1.3500%)
___Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   1, Avg loss: 0.0768, Accuracy: 165/715 (23.0769%)
___Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   2, Avg loss: 0.0423, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.2774, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   1, Avg loss: 0.1515, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   2, Avg loss: 0.1303, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.7800, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0622, Accuracy: 304/1742 (17.4512%)
___Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0306, Accuracy: 738/1742 (42.3651%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.1435, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   1, Avg loss: 0.0664, Accuracy: 210/1131 (18.5676%)
___Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   2, Avg loss: 0.0308, Accuracy: 395/1131 (34.9248%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.3602, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   1, Avg loss: 0.0639, Accuracy: 153/813 (18.8192%)
___Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   2, Avg loss: 0.0195, Accuracy: 453/813 (55.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 13.0125, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0714, Accuracy: 226/1003 (22.5324%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0341, Accuracy: 405/1003 (40.3789%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.7062, Accuracy: 55/10000 (0.5500%)
time spent on training: 293.25649404525757
___Test Target_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.2692, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.1530, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 701.5180823802948 sec.
Server Epoch:46 choose agents : [43, 30, 40, 2, 69, 83, 22, 84, 91, 15].
___Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   1, Avg loss: 0.0727, Accuracy: 189/946 (19.9789%)
___Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   2, Avg loss: 0.0368, Accuracy: 347/946 (36.6808%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.4079, Accuracy: 59/10000 (0.5900%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0643, Accuracy: 43/486 (8.8477%)
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0336, Accuracy: 224/486 (46.0905%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.3701, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   1, Avg loss: 0.0624, Accuracy: 286/1573 (18.1818%)
___Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   2, Avg loss: 0.0338, Accuracy: 644/1573 (40.9409%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.6331, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0816, Accuracy: 77/605 (12.7273%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0448, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.3199, Accuracy: 50/10000 (0.5000%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   1, Avg loss: 0.0696, Accuracy: 159/590 (26.9492%)
___Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   2, Avg loss: 0.0333, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 11.4758, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   1, Avg loss: 0.0614, Accuracy: 330/1953 (16.8971%)
___Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   2, Avg loss: 0.0328, Accuracy: 818/1953 (41.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.6126, Accuracy: 140/10000 (1.4000%)
___Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   1, Avg loss: 0.0471, Accuracy: 486/1470 (33.0612%)
___Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 880/1470 (59.8639%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.8026, Accuracy: 120/10000 (1.2000%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   1, Avg loss: 0.0702, Accuracy: 237/1190 (19.9160%)
___Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   2, Avg loss: 0.0306, Accuracy: 468/1190 (39.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.9530, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   1, Avg loss: 0.0601, Accuracy: 248/1030 (24.0777%)
___Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   2, Avg loss: 0.0239, Accuracy: 670/1030 (65.0485%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.8503, Accuracy: 111/10000 (1.1100%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0501, Accuracy: 306/1154 (26.5165%)
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0272, Accuracy: 484/1154 (41.9411%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.1562, Accuracy: 84/10000 (0.8400%)
time spent on training: 270.32058334350586
___Test Target_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.9939, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Avg loss: 0.2794, Accuracy: 9940/9950 (99.8995%)
saving model
Done in 678.2091434001923 sec.
Server Epoch:47 choose agents : [36, 81, 80, 26, 12, 78, 60, 58, 75, 19].
poison local model 36 index 13 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   1, Average loss: 0.0420, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   2, Average loss: 0.0342, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   3, Average loss: 0.0286, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   4, Average loss: 0.0274, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   5, Average loss: 0.0255, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   6, Average loss: 0.0251, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   7, Average loss: 0.0250, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   8, Average loss: 0.0233, Accuracy: 266/408 (65.1961%), train_poison_data_count: 264
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   9, Average loss: 0.0224, Accuracy: 271/408 (66.4216%), train_poison_data_count: 264
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch  10, Average loss: 0.0241, Accuracy: 269/408 (65.9314%), train_poison_data_count: 264
Global model norm: 111.79576017089154.
Norm before scaling: 111.79017384703363. Distance: 0.4163600946150251
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.3136, Accuracy: 43/10000 (0.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.1050, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 118.69923668272892, distance: 41.63601053231295
Total norm for 5 adversaries is: 118.69923668272892. distance: 41.63601053231295
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   1, Avg loss: 0.0775, Accuracy: 135/774 (17.4419%)
___Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   2, Avg loss: 0.0377, Accuracy: 318/774 (41.0853%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.7738, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0785, Accuracy: 61/682 (8.9443%)
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 258/682 (37.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.4989, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0614, Accuracy: 234/1446 (16.1826%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0341, Accuracy: 520/1446 (35.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.6437, Accuracy: 78/10000 (0.7800%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0789, Accuracy: 12/338 (3.5503%)
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0429, Accuracy: 116/338 (34.3195%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.3345, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   1, Avg loss: 0.1005, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   2, Avg loss: 0.0522, Accuracy: 155/416 (37.2596%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.0640, Accuracy: 78/10000 (0.7800%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   1, Avg loss: 0.0521, Accuracy: 635/2227 (28.5137%)
___Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   2, Avg loss: 0.0271, Accuracy: 1112/2227 (49.9326%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.1841, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   1, Avg loss: 0.0666, Accuracy: 220/803 (27.3973%)
___Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   2, Avg loss: 0.0354, Accuracy: 424/803 (52.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.0702, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0778, Accuracy: 145/776 (18.6856%)
___Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0321, Accuracy: 370/776 (47.6804%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.9325, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0550, Accuracy: 308/1036 (29.7297%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0243, Accuracy: 698/1036 (67.3745%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 12.1628, Accuracy: 81/10000 (0.8100%)
time spent on training: 300.17993998527527
___Test Target_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.1115, Accuracy: 40/10000 (0.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.1738, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 712.7868793010712 sec.
Server Epoch:48 choose agents : [27, 96, 18, 95, 5, 47, 12, 39, 36, 82].
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0613, Accuracy: 351/1587 (22.1172%)
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0325, Accuracy: 647/1587 (40.7687%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.8416, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.1060, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0655, Accuracy: 61/311 (19.6141%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.0957, Accuracy: 50/10000 (0.5000%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   1, Avg loss: 0.0756, Accuracy: 60/530 (11.3208%)
___Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   2, Avg loss: 0.0361, Accuracy: 281/530 (53.0189%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.0818, Accuracy: 75/10000 (0.7500%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0717, Accuracy: 168/599 (28.0467%)
___Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0308, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 12.3554, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   1, Avg loss: 0.0478, Accuracy: 490/1628 (30.0983%)
___Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   2, Avg loss: 0.0223, Accuracy: 953/1628 (58.5381%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.9161, Accuracy: 155/10000 (1.5500%)
___Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   1, Avg loss: 0.1557, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   2, Avg loss: 0.1274, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 5.7858, Accuracy: 49/10000 (0.4900%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   1, Avg loss: 0.0896, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   2, Avg loss: 0.0432, Accuracy: 123/338 (36.3905%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.1777, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0605, Accuracy: 193/1013 (19.0523%)
___Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0243, Accuracy: 525/1013 (51.8263%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.5122, Accuracy: 86/10000 (0.8600%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   1, Avg loss: 0.0555, Accuracy: 55/408 (13.4804%)
___Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   2, Avg loss: 0.0357, Accuracy: 165/408 (40.4412%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.5039, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0887, Accuracy: 7/500 (1.4000%)
___Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0493, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.5385, Accuracy: 65/10000 (0.6500%)
time spent on training: 239.01207375526428
___Test Target_ResNet_18 poisoned: False, epoch: 48: Avg loss: 5.9142, Accuracy: 40/10000 (0.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Avg loss: 0.3255, Accuracy: 9925/9950 (99.7487%)
saving model
Done in 646.8639028072357 sec.
Server Epoch:49 choose agents : [37, 21, 63, 60, 36, 6, 17, 29, 9, 90].
poison local model 37 index 14 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   1, Average loss: 0.0357, Accuracy: 719/1129 (63.6847%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   2, Average loss: 0.0174, Accuracy: 825/1129 (73.0735%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   3, Average loss: 0.0136, Accuracy: 870/1129 (77.0593%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   4, Average loss: 0.0125, Accuracy: 890/1129 (78.8308%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   5, Average loss: 0.0123, Accuracy: 884/1129 (78.2994%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   6, Average loss: 0.0119, Accuracy: 893/1129 (79.0965%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   7, Average loss: 0.0111, Accuracy: 912/1129 (80.7795%), train_poison_data_count: 720
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   8, Average loss: 0.0115, Accuracy: 898/1129 (79.5394%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   9, Average loss: 0.0115, Accuracy: 903/1129 (79.9823%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch  10, Average loss: 0.0115, Accuracy: 894/1129 (79.1851%), train_poison_data_count: 720
Global model norm: 111.78768415225802.
Norm before scaling: 111.76965186545496. Distance: 0.8629853790189508
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.3842, Accuracy: 72/10000 (0.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.1669, Accuracy: 9791/9950 (98.4020%)
Scaling by  100
Scaled Norm after poisoning: 139.5218466876245, distance: 86.29853989657792
Total norm for 4 adversaries is: 139.5218466876245. distance: 86.29853989657792
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0564, Accuracy: 352/1949 (18.0605%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0321, Accuracy: 645/1949 (33.0939%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3691, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   1, Avg loss: 0.0662, Accuracy: 158/888 (17.7928%)
___Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   2, Avg loss: 0.0252, Accuracy: 442/888 (49.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.9677, Accuracy: 97/10000 (0.9700%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   1, Avg loss: 0.0522, Accuracy: 643/2227 (28.8729%)
___Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   2, Avg loss: 0.0273, Accuracy: 1080/2227 (48.4957%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.1318, Accuracy: 128/10000 (1.2800%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   1, Avg loss: 0.0528, Accuracy: 63/408 (15.4412%)
___Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   2, Avg loss: 0.0365, Accuracy: 169/408 (41.4216%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.3864, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   1, Avg loss: 0.0547, Accuracy: 358/1956 (18.3027%)
___Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   2, Avg loss: 0.0302, Accuracy: 698/1956 (35.6851%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3094, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0577, Accuracy: 328/1574 (20.8386%)
___Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0265, Accuracy: 723/1574 (45.9339%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.7104, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   1, Avg loss: 0.0563, Accuracy: 328/1440 (22.7778%)
___Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 721/1440 (50.0694%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.5848, Accuracy: 98/10000 (0.9800%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   1, Avg loss: 0.0446, Accuracy: 382/1275 (29.9608%)
___Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   2, Avg loss: 0.0163, Accuracy: 812/1275 (63.6863%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 10.6517, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   1, Avg loss: 0.0593, Accuracy: 181/677 (26.7356%)
___Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   2, Avg loss: 0.0213, Accuracy: 460/677 (67.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 11.1598, Accuracy: 67/10000 (0.6700%)
time spent on training: 369.82139563560486
___Test Target_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.2371, Accuracy: 76/10000 (0.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.3200, Accuracy: 9018/9950 (90.6332%)
saving model
Done in 776.736661195755 sec.
Server Epoch:50 choose agents : [74, 58, 95, 2, 46, 62, 37, 81, 28, 99].
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   1, Avg loss: 0.0596, Accuracy: 408/1552 (26.2887%)
___Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   2, Avg loss: 0.0206, Accuracy: 788/1552 (50.7732%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 11.1207, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   1, Avg loss: 0.0836, Accuracy: 171/803 (21.2951%)
___Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   2, Avg loss: 0.0383, Accuracy: 434/803 (54.0473%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.3723, Accuracy: 51/10000 (0.5100%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   1, Avg loss: 0.0859, Accuracy: 112/599 (18.6978%)
___Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   2, Avg loss: 0.0331, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 13.4998, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.0974, Accuracy: 36/605 (5.9504%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0442, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.4830, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0648, Accuracy: 338/1904 (17.7521%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0302, Accuracy: 747/1904 (39.2332%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.1884, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   1, Avg loss: 0.1048, Accuracy: 11/568 (1.9366%)
___Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   2, Avg loss: 0.0460, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.4619, Accuracy: 51/10000 (0.5100%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   1, Avg loss: 0.0259, Accuracy: 630/1129 (55.8016%)
___Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   2, Avg loss: 0.0172, Accuracy: 792/1129 (70.1506%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.0444, Accuracy: 114/10000 (1.1400%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0951, Accuracy: 94/774 (12.1447%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0375, Accuracy: 343/774 (44.3152%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.9972, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   1, Avg loss: 0.0700, Accuracy: 274/1581 (17.3308%)
___Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 589/1581 (37.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.8068, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   1, Avg loss: 0.0859, Accuracy: 83/773 (10.7374%)
___Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/773 (55.2393%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.6106, Accuracy: 75/10000 (0.7500%)
time spent on training: 275.4220154285431
___Test Target_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.7763, Accuracy: 91/10000 (0.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Avg loss: 0.6228, Accuracy: 7316/9950 (73.5276%)
saving model
Saving model on epoch 50
Done in 683.0327658653259 sec.
Server Epoch:51 choose agents : [42, 17, 32, 59, 73, 33, 77, 93, 8, 90].
poison local model 42 index 15 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Average loss: 0.0356, Accuracy: 848/1372 (61.8076%), train_poison_data_count: 868
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Average loss: 0.0172, Accuracy: 977/1372 (71.2099%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   3, Average loss: 0.0155, Accuracy: 997/1372 (72.6676%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   4, Average loss: 0.0147, Accuracy: 1004/1372 (73.1778%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   5, Average loss: 0.0144, Accuracy: 1006/1372 (73.3236%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   6, Average loss: 0.0147, Accuracy: 1025/1372 (74.7085%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   7, Average loss: 0.0138, Accuracy: 1013/1372 (73.8338%), train_poison_data_count: 868
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   8, Average loss: 0.0142, Accuracy: 1018/1372 (74.1983%), train_poison_data_count: 868
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   9, Average loss: 0.0142, Accuracy: 1021/1372 (74.4169%), train_poison_data_count: 868
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch  10, Average loss: 0.0137, Accuracy: 1019/1372 (74.2711%), train_poison_data_count: 868
Global model norm: 111.76551468783876.
Norm before scaling: 111.74035193250467. Distance: 0.960938616496112
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.4984, Accuracy: 73/10000 (0.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: 0.5516, Accuracy: 8606/9950 (86.4925%)
Scaling by  100
Scaled Norm after poisoning: 145.15685885232912, distance: 96.09386686984763
Total norm for 2 adversaries is: 145.15685885232912. distance: 96.09386686984763
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   1, Avg loss: 0.0637, Accuracy: 306/1574 (19.4409%)
___Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   2, Avg loss: 0.0266, Accuracy: 693/1574 (44.0280%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.7593, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   1, Avg loss: 0.0684, Accuracy: 123/735 (16.7347%)
___Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   2, Avg loss: 0.0242, Accuracy: 365/735 (49.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 10.6067, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0712, Accuracy: 195/1089 (17.9063%)
___Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0269, Accuracy: 566/1089 (51.9743%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.4504, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   1, Avg loss: 0.0726, Accuracy: 165/938 (17.5906%)
___Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   2, Avg loss: 0.0348, Accuracy: 312/938 (33.2623%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.5279, Accuracy: 62/10000 (0.6200%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0925, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0488, Accuracy: 163/515 (31.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.3264, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   1, Avg loss: 0.0642, Accuracy: 251/1340 (18.7313%)
___Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   2, Avg loss: 0.0265, Accuracy: 632/1340 (47.1642%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.2665, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0648, Accuracy: 325/1742 (18.6567%)
___Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0303, Accuracy: 785/1742 (45.0631%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.1555, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0723, Accuracy: 212/1513 (14.0119%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0356, Accuracy: 531/1513 (35.0958%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.7994, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   1, Avg loss: 0.0732, Accuracy: 136/677 (20.0886%)
___Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 469/677 (69.2762%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 11.0231, Accuracy: 68/10000 (0.6800%)
time spent on training: 319.5371208190918
___Test Target_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.3960, Accuracy: 71/10000 (0.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 51: Avg loss: 1.0121, Accuracy: 6759/9950 (67.9296%)
saving model
Done in 730.9527616500854 sec.
Server Epoch:52 choose agents : [13, 59, 3, 73, 63, 7, 86, 32, 51, 89].
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0717, Accuracy: 246/1645 (14.9544%)
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0318, Accuracy: 696/1645 (42.3100%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.1577, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   1, Avg loss: 0.0746, Accuracy: 192/1089 (17.6309%)
___Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   2, Avg loss: 0.0273, Accuracy: 560/1089 (51.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.3923, Accuracy: 132/10000 (1.3200%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   1, Avg loss: 0.0884, Accuracy: 23/781 (2.9449%)
___Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   2, Avg loss: 0.0331, Accuracy: 247/781 (31.6261%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.5717, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   1, Avg loss: 0.0784, Accuracy: 150/938 (15.9915%)
___Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   2, Avg loss: 0.0354, Accuracy: 310/938 (33.0490%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.2582, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   1, Avg loss: 0.0816, Accuracy: 116/888 (13.0631%)
___Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 451/888 (50.7883%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.1881, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0761, Accuracy: 171/891 (19.1919%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0288, Accuracy: 438/891 (49.1582%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.5725, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   1, Avg loss: 0.0842, Accuracy: 192/1003 (19.1426%)
___Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   2, Avg loss: 0.0353, Accuracy: 366/1003 (36.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.7059, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0733, Accuracy: 121/735 (16.4626%)
___Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0250, Accuracy: 382/735 (51.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.8224, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   1, Avg loss: 0.0789, Accuracy: 145/1049 (13.8227%)
___Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   2, Avg loss: 0.0282, Accuracy: 549/1049 (52.3356%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.7202, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0846, Accuracy: 193/896 (21.5402%)
___Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0377, Accuracy: 440/896 (49.1071%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.6234, Accuracy: 70/10000 (0.7000%)
time spent on training: 264.78423595428467
___Test Target_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.0013, Accuracy: 79/10000 (0.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 52: Avg loss: 1.4520, Accuracy: 5619/9950 (56.4724%)
saving model
Done in 674.981253862381 sec.
Server Epoch:53 choose agents : [44, 63, 19, 5, 11, 69, 60, 51, 37, 90].
poison local model 44 index 16 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Average loss: 0.0366, Accuracy: 1109/1750 (63.3714%), train_poison_data_count: 1102
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Average loss: 0.0196, Accuracy: 1237/1750 (70.6857%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   3, Average loss: 0.0172, Accuracy: 1297/1750 (74.1143%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   4, Average loss: 0.0169, Accuracy: 1317/1750 (75.2571%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   5, Average loss: 0.0160, Accuracy: 1299/1750 (74.2286%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   6, Average loss: 0.0164, Accuracy: 1297/1750 (74.1143%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   7, Average loss: 0.0155, Accuracy: 1309/1750 (74.8000%), train_poison_data_count: 1102
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   8, Average loss: 0.0158, Accuracy: 1298/1750 (74.1714%), train_poison_data_count: 1102
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   9, Average loss: 0.0156, Accuracy: 1314/1750 (75.0857%), train_poison_data_count: 1102
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch  10, Average loss: 0.0157, Accuracy: 1300/1750 (74.2857%), train_poison_data_count: 1102
Global model norm: 111.73639720761315.
Norm before scaling: 111.7019524085188. Distance: 1.0644673477762536
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 6.9306, Accuracy: 90/10000 (0.9000%)
___Test Local_ResNet_18 poisoned: True, epoch: 53: Avg loss: 1.0396, Accuracy: 7308/9950 (73.4472%)
Scaling by  100
Scaled Norm after poisoning: 151.43562988940218, distance: 106.44673880925146
Total norm for 5 adversaries is: 151.43562988940218. distance: 106.44673880925146
___Test Local_ResNet_18 poisoned: True, epoch: 53: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   1, Avg loss: 0.0754, Accuracy: 132/888 (14.8649%)
___Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 424/888 (47.7477%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 10.2474, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0639, Accuracy: 251/1036 (24.2278%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0261, Accuracy: 684/1036 (66.0232%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 12.7218, Accuracy: 81/10000 (0.8100%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0539, Accuracy: 423/1628 (25.9828%)
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0224, Accuracy: 954/1628 (58.5995%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.6175, Accuracy: 166/10000 (1.6600%)
___Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   1, Avg loss: 0.0764, Accuracy: 165/712 (23.1742%)
___Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 438/712 (61.5169%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.5911, Accuracy: 71/10000 (0.7100%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0818, Accuracy: 113/590 (19.1525%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0354, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 12.4111, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   1, Avg loss: 0.0538, Accuracy: 566/2227 (25.4154%)
___Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   2, Avg loss: 0.0275, Accuracy: 1073/2227 (48.1814%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.9769, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   1, Avg loss: 0.0743, Accuracy: 156/1049 (14.8713%)
___Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   2, Avg loss: 0.0281, Accuracy: 529/1049 (50.4290%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.5307, Accuracy: 135/10000 (1.3500%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   1, Avg loss: 0.0501, Accuracy: 386/1129 (34.1895%)
___Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   2, Avg loss: 0.0202, Accuracy: 770/1129 (68.2019%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.3405, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   1, Avg loss: 0.0735, Accuracy: 137/677 (20.2363%)
___Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 460/677 (67.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 11.7838, Accuracy: 56/10000 (0.5600%)
time spent on training: 409.89382314682007
___Test Target_ResNet_18 poisoned: False, epoch: 53: Avg loss: 6.8215, Accuracy: 98/10000 (0.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 53: Avg loss: 1.7166, Accuracy: 5367/9950 (53.9397%)
saving model
Done in 819.3264400959015 sec.
Server Epoch:54 choose agents : [87, 90, 28, 63, 1, 47, 46, 66, 40, 91].
___Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   1, Avg loss: 0.0736, Accuracy: 212/1131 (18.7445%)
___Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   2, Avg loss: 0.0326, Accuracy: 361/1131 (31.9187%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.4513, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   1, Avg loss: 0.0727, Accuracy: 147/677 (21.7134%)
___Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   2, Avg loss: 0.0225, Accuracy: 469/677 (69.2762%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 11.8316, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0671, Accuracy: 299/1581 (18.9121%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0330, Accuracy: 636/1581 (40.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.8045, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   1, Avg loss: 0.0758, Accuracy: 123/888 (13.8514%)
___Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 440/888 (49.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 10.5133, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0707, Accuracy: 189/928 (20.3664%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 585/928 (63.0388%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.6380, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1825, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1474, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.7587, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0644, Accuracy: 348/1904 (18.2773%)
___Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0303, Accuracy: 747/1904 (39.2332%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.1150, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0749, Accuracy: 212/1402 (15.1213%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 436/1402 (31.0984%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.7049, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   1, Avg loss: 0.0666, Accuracy: 310/1573 (19.7076%)
___Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 626/1573 (39.7966%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.7766, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   1, Avg loss: 0.0713, Accuracy: 203/1030 (19.7087%)
___Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   2, Avg loss: 0.0237, Accuracy: 682/1030 (66.2136%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 10.0123, Accuracy: 112/10000 (1.1200%)
time spent on training: 287.4844186306
___Test Target_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.5840, Accuracy: 99/10000 (0.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 54: Avg loss: 2.8859, Accuracy: 3489/9950 (35.0653%)
saving model
Done in 692.180027961731 sec.
Server Epoch:55 choose agents : [48, 41, 73, 59, 13, 26, 32, 57, 99, 55].
poison local model 48 index 17 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   1, Average loss: 0.0433, Accuracy: 377/631 (59.7464%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   2, Average loss: 0.0295, Accuracy: 406/631 (64.3423%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   3, Average loss: 0.0240, Accuracy: 429/631 (67.9873%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   4, Average loss: 0.0219, Accuracy: 440/631 (69.7306%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   5, Average loss: 0.0212, Accuracy: 447/631 (70.8399%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   6, Average loss: 0.0219, Accuracy: 445/631 (70.5230%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   7, Average loss: 0.0207, Accuracy: 460/631 (72.9002%), train_poison_data_count: 400
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   8, Average loss: 0.0210, Accuracy: 450/631 (71.3154%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   9, Average loss: 0.0192, Accuracy: 471/631 (74.6434%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch  10, Average loss: 0.0196, Accuracy: 470/631 (74.4849%), train_poison_data_count: 400
Global model norm: 111.69799632407243.
Norm before scaling: 111.687801657399. Distance: 0.5993592675683138
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.4106, Accuracy: 66/10000 (0.6600%)
___Test Local_ResNet_18 poisoned: True, epoch: 55: Avg loss: 0.0782, Accuracy: 9914/9950 (99.6382%)
Scaling by  100
Scaled Norm after poisoning: 125.7188276783255, distance: 59.93592363020904
Total norm for 2 adversaries is: 125.7188276783255. distance: 59.93592363020904
___Test Local_ResNet_18 poisoned: True, epoch: 55: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   1, Avg loss: 0.0799, Accuracy: 154/719 (21.4186%)
___Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   2, Avg loss: 0.0357, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.0396, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0701, Accuracy: 190/938 (20.2559%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0340, Accuracy: 339/938 (36.1407%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.6204, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   1, Avg loss: 0.0673, Accuracy: 207/1089 (19.0083%)
___Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   2, Avg loss: 0.0271, Accuracy: 525/1089 (48.2094%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.3473, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0623, Accuracy: 350/1645 (21.2766%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0308, Accuracy: 736/1645 (44.7416%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.0627, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0665, Accuracy: 239/1446 (16.5284%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 516/1446 (35.6846%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.6521, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   1, Avg loss: 0.0639, Accuracy: 144/735 (19.5918%)
___Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   2, Avg loss: 0.0242, Accuracy: 392/735 (53.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 11.6141, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   1, Avg loss: 0.0696, Accuracy: 176/1154 (15.2513%)
___Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   2, Avg loss: 0.0255, Accuracy: 539/1154 (46.7071%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 10.5052, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0805, Accuracy: 95/773 (12.2898%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0297, Accuracy: 412/773 (53.2988%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.0660, Accuracy: 89/10000 (0.8900%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0695, Accuracy: 166/1071 (15.4995%)
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0297, Accuracy: 534/1071 (49.8599%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.2665, Accuracy: 95/10000 (0.9500%)
time spent on training: 323.7643733024597
___Test Target_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.2066, Accuracy: 74/10000 (0.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 55: Avg loss: 0.2094, Accuracy: 9618/9950 (96.6633%)
saving model
Done in 728.7295563220978 sec.
Server Epoch:56 choose agents : [70, 37, 13, 11, 65, 80, 49, 18, 26, 82].
___Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   1, Avg loss: 0.0667, Accuracy: 271/1418 (19.1114%)
___Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 676/1418 (47.6728%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.1832, Accuracy: 109/10000 (1.0900%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   1, Avg loss: 0.0509, Accuracy: 393/1129 (34.8096%)
___Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   2, Avg loss: 0.0205, Accuracy: 778/1129 (68.9105%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.2479, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0630, Accuracy: 313/1645 (19.0274%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0309, Accuracy: 729/1645 (44.3161%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.1163, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   1, Avg loss: 0.0745, Accuracy: 178/712 (25.0000%)
___Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   2, Avg loss: 0.0274, Accuracy: 427/712 (59.9719%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.2745, Accuracy: 77/10000 (0.7700%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0683, Accuracy: 314/1475 (21.2881%)
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0316, Accuracy: 702/1475 (47.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.5189, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   1, Avg loss: 0.0776, Accuracy: 98/682 (14.3695%)
___Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   2, Avg loss: 0.0385, Accuracy: 233/682 (34.1642%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.4719, Accuracy: 58/10000 (0.5800%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   1, Avg loss: 0.1012, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   2, Avg loss: 0.0517, Accuracy: 98/440 (22.2727%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.6305, Accuracy: 51/10000 (0.5100%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   1, Avg loss: 0.0925, Accuracy: 19/530 (3.5849%)
___Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   2, Avg loss: 0.0375, Accuracy: 270/530 (50.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.6568, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0667, Accuracy: 250/1446 (17.2891%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0340, Accuracy: 536/1446 (37.0678%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.5565, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.1000, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0523, Accuracy: 146/500 (29.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.4446, Accuracy: 78/10000 (0.7800%)
time spent on training: 296.17820930480957
___Test Target_ResNet_18 poisoned: False, epoch: 56: Avg loss: 5.9952, Accuracy: 78/10000 (0.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 56: Avg loss: 0.6224, Accuracy: 8142/9950 (81.8291%)
saving model
Done in 700.9270100593567 sec.
Server Epoch:57 choose agents : [49, 24, 21, 90, 19, 40, 84, 62, 37, 70].
poison local model 49 index 18 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   1, Average loss: 0.0410, Accuracy: 268/440 (60.9091%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   2, Average loss: 0.0318, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   3, Average loss: 0.0271, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   4, Average loss: 0.0242, Accuracy: 281/440 (63.8636%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   5, Average loss: 0.0240, Accuracy: 289/440 (65.6818%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   6, Average loss: 0.0227, Accuracy: 299/440 (67.9545%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   7, Average loss: 0.0220, Accuracy: 313/440 (71.1364%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   8, Average loss: 0.0214, Accuracy: 310/440 (70.4545%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   9, Average loss: 0.0210, Accuracy: 316/440 (71.8182%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch  10, Average loss: 0.0208, Accuracy: 318/440 (72.2727%), train_poison_data_count: 280
Global model norm: 111.68425166652861.
Norm before scaling: 111.67831436065597. Distance: 0.4359012240011328
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.0943, Accuracy: 56/10000 (0.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 57: Avg loss: 0.1673, Accuracy: 9947/9950 (99.9698%)
Scaling by  100
Scaled Norm after poisoning: 119.25510995341038, distance: 43.59012081667703
Total norm for 4 adversaries is: 119.25510995341038. distance: 43.59012081667703
___Test Local_ResNet_18 poisoned: True, epoch: 57: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   1, Avg loss: 0.0914, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   2, Avg loss: 0.0440, Accuracy: 109/312 (34.9359%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.4134, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   1, Avg loss: 0.0579, Accuracy: 344/1949 (17.6501%)
___Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   2, Avg loss: 0.0321, Accuracy: 672/1949 (34.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.2327, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   1, Avg loss: 0.0644, Accuracy: 169/677 (24.9631%)
___Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   2, Avg loss: 0.0215, Accuracy: 463/677 (68.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 10.8205, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   1, Avg loss: 0.0573, Accuracy: 299/1036 (28.8610%)
___Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   2, Avg loss: 0.0242, Accuracy: 699/1036 (67.4710%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 12.1723, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0588, Accuracy: 337/1573 (21.4240%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0339, Accuracy: 606/1573 (38.5251%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.4646, Accuracy: 90/10000 (0.9000%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   1, Avg loss: 0.0704, Accuracy: 228/1190 (19.1597%)
___Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 465/1190 (39.0756%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.9068, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   1, Avg loss: 0.0860, Accuracy: 23/568 (4.0493%)
___Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   2, Avg loss: 0.0440, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.4181, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   1, Avg loss: 0.0481, Accuracy: 410/1129 (36.3153%)
___Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   2, Avg loss: 0.0204, Accuracy: 772/1129 (68.3791%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.3213, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0637, Accuracy: 296/1418 (20.8745%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0297, Accuracy: 710/1418 (50.0705%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.1476, Accuracy: 103/10000 (1.0300%)
time spent on training: 352.3527021408081
___Test Target_ResNet_18 poisoned: False, epoch: 57: Avg loss: 5.9468, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 57: Avg loss: 0.3329, Accuracy: 9906/9950 (99.5578%)
saving model
Done in 758.4367179870605 sec.
Server Epoch:58 choose agents : [95, 54, 5, 67, 47, 39, 11, 59, 83, 6].
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   1, Avg loss: 0.0702, Accuracy: 163/599 (27.2120%)
___Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   2, Avg loss: 0.0317, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 12.5123, Accuracy: 50/10000 (0.5000%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   1, Avg loss: 0.0678, Accuracy: 230/1130 (20.3540%)
___Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 485/1130 (42.9204%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.4285, Accuracy: 55/10000 (0.5500%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   1, Avg loss: 0.0498, Accuracy: 434/1628 (26.6585%)
___Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   2, Avg loss: 0.0218, Accuracy: 964/1628 (59.2138%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.8654, Accuracy: 150/10000 (1.5000%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0900, Accuracy: 2/426 (0.4695%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0438, Accuracy: 170/426 (39.9061%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.7679, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1545, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1232, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.7657, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   1, Avg loss: 0.0649, Accuracy: 198/1013 (19.5459%)
___Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 527/1013 (52.0237%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.1068, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   1, Avg loss: 0.0569, Accuracy: 189/712 (26.5449%)
___Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   2, Avg loss: 0.0290, Accuracy: 442/712 (62.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.1816, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   1, Avg loss: 0.0642, Accuracy: 227/1089 (20.8448%)
___Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   2, Avg loss: 0.0269, Accuracy: 543/1089 (49.8623%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.5369, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   1, Avg loss: 0.0586, Accuracy: 386/1953 (19.7645%)
___Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   2, Avg loss: 0.0326, Accuracy: 824/1953 (42.1915%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.8006, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   1, Avg loss: 0.0576, Accuracy: 348/1956 (17.7914%)
___Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   2, Avg loss: 0.0301, Accuracy: 720/1956 (36.8098%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.3377, Accuracy: 126/10000 (1.2600%)
time spent on training: 314.348420381546
___Test Target_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.8099, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 58: Avg loss: 0.6423, Accuracy: 9351/9950 (93.9799%)
saving model
Done in 724.6360111236572 sec.
Server Epoch:59 choose agents : [54, 47, 10, 12, 0, 49, 14, 52, 51, 46].
poison local model 54 index 19 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   1, Average loss: 0.0335, Accuracy: 729/1130 (64.5133%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   2, Average loss: 0.0175, Accuracy: 836/1130 (73.9823%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   3, Average loss: 0.0138, Accuracy: 854/1130 (75.5752%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   4, Average loss: 0.0133, Accuracy: 876/1130 (77.5221%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   5, Average loss: 0.0126, Accuracy: 876/1130 (77.5221%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   6, Average loss: 0.0138, Accuracy: 862/1130 (76.2832%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   7, Average loss: 0.0123, Accuracy: 874/1130 (77.3451%), train_poison_data_count: 720
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   8, Average loss: 0.0128, Accuracy: 876/1130 (77.5221%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   9, Average loss: 0.0125, Accuracy: 864/1130 (76.4602%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch  10, Average loss: 0.0128, Accuracy: 861/1130 (76.1947%), train_poison_data_count: 720
Global model norm: 111.67486025987452.
Norm before scaling: 111.65629810382396. Distance: 0.8014290027359826
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.4901, Accuracy: 52/10000 (0.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 59: Avg loss: 0.0991, Accuracy: 9887/9950 (99.3668%)
Scaling by  100
Scaled Norm after poisoning: 135.70285064019473, distance: 80.14288996848067
Total norm for 5 adversaries is: 135.70285064019473. distance: 80.14288996848067
___Test Local_ResNet_18 poisoned: True, epoch: 59: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   1, Avg loss: 0.1390, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   2, Avg loss: 0.1181, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 5.7203, Accuracy: 81/10000 (0.8100%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   1, Avg loss: 0.0633, Accuracy: 150/861 (17.4216%)
___Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   2, Avg loss: 0.0190, Accuracy: 485/861 (56.3298%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 10.0931, Accuracy: 108/10000 (1.0800%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   1, Avg loss: 0.0990, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   2, Avg loss: 0.0501, Accuracy: 102/338 (30.1775%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.9154, Accuracy: 51/10000 (0.5100%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   1, Avg loss: 0.0593, Accuracy: 307/1657 (18.5275%)
___Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   2, Avg loss: 0.0326, Accuracy: 568/1657 (34.2788%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.9121, Accuracy: 95/10000 (0.9500%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   1, Avg loss: 0.0522, Accuracy: 68/440 (15.4545%)
___Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   2, Avg loss: 0.0350, Accuracy: 175/440 (39.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.1996, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   1, Avg loss: 0.0725, Accuracy: 120/1013 (11.8460%)
___Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 369/1013 (36.4265%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.3601, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0737, Accuracy: 127/636 (19.9686%)
___Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0340, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 11.5797, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   1, Avg loss: 0.0664, Accuracy: 215/1049 (20.4957%)
___Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   2, Avg loss: 0.0276, Accuracy: 565/1049 (53.8608%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.4152, Accuracy: 139/10000 (1.3900%)
___Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   1, Avg loss: 0.0586, Accuracy: 401/1904 (21.0609%)
___Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   2, Avg loss: 0.0295, Accuracy: 811/1904 (42.5945%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.9099, Accuracy: 124/10000 (1.2400%)
time spent on training: 365.5810112953186
___Test Target_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.4051, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 59: Avg loss: 0.1590, Accuracy: 9779/9950 (98.2814%)
saving model
Done in 770.3260576725006 sec.
Server Epoch:60 choose agents : [54, 52, 10, 29, 40, 35, 50, 34, 99, 36].
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0328, Accuracy: 453/1130 (40.0885%)
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0247, Accuracy: 633/1130 (56.0177%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.3926, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0878, Accuracy: 88/636 (13.8365%)
___Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0340, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.6603, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0679, Accuracy: 167/861 (19.3961%)
___Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0202, Accuracy: 445/861 (51.6841%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.6255, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   1, Avg loss: 0.0643, Accuracy: 289/1440 (20.0694%)
___Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   2, Avg loss: 0.0263, Accuracy: 704/1440 (48.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.8183, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   1, Avg loss: 0.0663, Accuracy: 285/1573 (18.1182%)
___Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 559/1573 (35.5372%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.5106, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   1, Avg loss: 0.1409, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   2, Avg loss: 0.0799, Accuracy: 7/271 (2.5830%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.9629, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0804, Accuracy: 68/809 (8.4054%)
___Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0265, Accuracy: 341/809 (42.1508%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.5404, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   1, Avg loss: 0.0723, Accuracy: 264/1427 (18.5004%)
___Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   2, Avg loss: 0.0327, Accuracy: 579/1427 (40.5746%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.5579, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   1, Avg loss: 0.0878, Accuracy: 85/773 (10.9961%)
___Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   2, Avg loss: 0.0310, Accuracy: 407/773 (52.6520%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.3842, Accuracy: 76/10000 (0.7600%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   1, Avg loss: 0.1139, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   2, Avg loss: 0.0525, Accuracy: 105/408 (25.7353%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.2772, Accuracy: 50/10000 (0.5000%)
time spent on training: 262.8711245059967
___Test Target_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.0241, Accuracy: 71/10000 (0.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 60: Avg loss: 0.5413, Accuracy: 8279/9950 (83.2060%)
saving model
Saving model on epoch 60
Done in 671.6067454814911 sec.
Server Epoch:61 choose agents : [55, 8, 59, 31, 34, 81, 12, 79, 36, 85].
poison local model 55 index 20 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Average loss: 0.0441, Accuracy: 655/1071 (61.1578%), train_poison_data_count: 680
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Average loss: 0.0219, Accuracy: 696/1071 (64.9860%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   3, Average loss: 0.0164, Accuracy: 767/1071 (71.6153%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   4, Average loss: 0.0155, Accuracy: 760/1071 (70.9617%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   5, Average loss: 0.0148, Accuracy: 782/1071 (73.0159%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   6, Average loss: 0.0144, Accuracy: 806/1071 (75.2568%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   7, Average loss: 0.0144, Accuracy: 799/1071 (74.6032%), train_poison_data_count: 680
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   8, Average loss: 0.0133, Accuracy: 829/1071 (77.4043%), train_poison_data_count: 680
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   9, Average loss: 0.0132, Accuracy: 818/1071 (76.3772%), train_poison_data_count: 680
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch  10, Average loss: 0.0135, Accuracy: 816/1071 (76.1905%), train_poison_data_count: 680
Global model norm: 111.6531844317483.
Norm before scaling: 111.63445246232232. Distance: 0.9381161572308357
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.4425, Accuracy: 78/10000 (0.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 61: Avg loss: 0.0817, Accuracy: 9916/9950 (99.6583%)
Scaling by  100
Scaled Norm after poisoning: 144.0850985529038, distance: 93.81162037395741
Total norm for 5 adversaries is: 144.0850985529038. distance: 93.81162037395741
___Test Local_ResNet_18 poisoned: True, epoch: 61: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   1, Avg loss: 0.0687, Accuracy: 194/1513 (12.8222%)
___Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   2, Avg loss: 0.0353, Accuracy: 529/1513 (34.9636%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.9702, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   1, Avg loss: 0.0700, Accuracy: 210/1089 (19.2837%)
___Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   2, Avg loss: 0.0269, Accuracy: 530/1089 (48.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 10.2839, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   1, Avg loss: 0.0856, Accuracy: 83/460 (18.0435%)
___Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   2, Avg loss: 0.0413, Accuracy: 193/460 (41.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.3243, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   1, Avg loss: 0.0693, Accuracy: 275/1427 (19.2712%)
___Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   2, Avg loss: 0.0320, Accuracy: 626/1427 (43.8683%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.6353, Accuracy: 82/10000 (0.8200%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   1, Avg loss: 0.0886, Accuracy: 101/774 (13.0491%)
___Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   2, Avg loss: 0.0367, Accuracy: 350/774 (45.2196%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.5082, Accuracy: 76/10000 (0.7600%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.1159, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0564, Accuracy: 56/338 (16.5680%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.9613, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1461, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.1124, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.4574, Accuracy: 74/10000 (0.7400%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   1, Avg loss: 0.1038, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   2, Avg loss: 0.0503, Accuracy: 109/408 (26.7157%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.4048, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   1, Avg loss: 0.0639, Accuracy: 384/1988 (19.3159%)
___Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   2, Avg loss: 0.0342, Accuracy: 736/1988 (37.0221%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.9405, Accuracy: 93/10000 (0.9300%)
time spent on training: 373.3934528827667
___Test Target_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.3661, Accuracy: 82/10000 (0.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 61: Avg loss: 0.1245, Accuracy: 9772/9950 (98.2111%)
saving model
Done in 778.764642238617 sec.
Server Epoch:62 choose agents : [76, 81, 79, 10, 63, 90, 19, 80, 0, 17].
___Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   1, Avg loss: 0.1236, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   2, Avg loss: 0.0538, Accuracy: 142/466 (30.4721%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.4997, Accuracy: 50/10000 (0.5000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.0911, Accuracy: 91/774 (11.7571%)
___Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0390, Accuracy: 327/774 (42.2481%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.9228, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   1, Avg loss: 0.1480, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   2, Avg loss: 0.1105, Accuracy: 11/197 (5.5838%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.5394, Accuracy: 73/10000 (0.7300%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   1, Avg loss: 0.0733, Accuracy: 139/861 (16.1440%)
___Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   2, Avg loss: 0.0191, Accuracy: 492/861 (57.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 10.5436, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0819, Accuracy: 115/888 (12.9505%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 432/888 (48.6486%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.8687, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   1, Avg loss: 0.0802, Accuracy: 125/677 (18.4638%)
___Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   2, Avg loss: 0.0237, Accuracy: 472/677 (69.7194%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 11.8247, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   1, Avg loss: 0.0661, Accuracy: 257/1036 (24.8069%)
___Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   2, Avg loss: 0.0248, Accuracy: 710/1036 (68.5328%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 12.0992, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0913, Accuracy: 41/682 (6.0117%)
___Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0376, Accuracy: 265/682 (38.8563%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.2723, Accuracy: 64/10000 (0.6400%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   1, Avg loss: 0.0674, Accuracy: 256/1657 (15.4496%)
___Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   2, Avg loss: 0.0324, Accuracy: 553/1657 (33.3736%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.8762, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   1, Avg loss: 0.0689, Accuracy: 296/1574 (18.8056%)
___Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   2, Avg loss: 0.0268, Accuracy: 727/1574 (46.1881%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.4959, Accuracy: 125/10000 (1.2500%)
time spent on training: 290.4526822566986
___Test Target_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.8619, Accuracy: 88/10000 (0.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 62: Avg loss: 0.2945, Accuracy: 9142/9950 (91.8794%)
saving model
Done in 694.3235206604004 sec.
Server Epoch:63 choose agents : [60, 37, 76, 38, 57, 8, 82, 79, 19, 99].
poison local model 60 index 21 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   1, Average loss: 0.0302, Accuracy: 1476/2227 (66.2775%), train_poison_data_count: 1400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   2, Average loss: 0.0144, Accuracy: 1687/2227 (75.7521%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   3, Average loss: 0.0124, Accuracy: 1725/2227 (77.4585%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   4, Average loss: 0.0128, Accuracy: 1732/2227 (77.7728%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   5, Average loss: 0.0123, Accuracy: 1728/2227 (77.5932%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   6, Average loss: 0.0123, Accuracy: 1718/2227 (77.1441%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   7, Average loss: 0.0119, Accuracy: 1762/2227 (79.1199%), train_poison_data_count: 1400
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   8, Average loss: 0.0115, Accuracy: 1779/2227 (79.8833%), train_poison_data_count: 1400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   9, Average loss: 0.0118, Accuracy: 1737/2227 (77.9973%), train_poison_data_count: 1400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch  10, Average loss: 0.0116, Accuracy: 1742/2227 (78.2218%), train_poison_data_count: 1400
Global model norm: 111.63107136344253.
Norm before scaling: 111.58801791495134. Distance: 1.1321088512878281
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.7097, Accuracy: 101/10000 (1.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 63: Avg loss: 0.1739, Accuracy: 9824/9950 (98.7337%)
Scaling by  100
Scaled Norm after poisoning: 155.52882947182172, distance: 113.2108790046257
Total norm for 2 adversaries is: 155.52882947182172. distance: 113.2108790046257
___Test Local_ResNet_18 poisoned: True, epoch: 63: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0568, Accuracy: 365/1129 (32.3295%)
___Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0213, Accuracy: 758/1129 (67.1391%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.3839, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.1146, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0547, Accuracy: 153/466 (32.8326%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.3228, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0718, Accuracy: 201/1131 (17.7719%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0288, Accuracy: 544/1131 (48.0990%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.5214, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0722, Accuracy: 175/1154 (15.1646%)
___Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0254, Accuracy: 568/1154 (49.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.8557, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   1, Avg loss: 0.0693, Accuracy: 213/1513 (14.0780%)
___Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   2, Avg loss: 0.0348, Accuracy: 526/1513 (34.7654%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.8356, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   1, Avg loss: 0.1025, Accuracy: 5/500 (1.0000%)
___Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   2, Avg loss: 0.0512, Accuracy: 134/500 (26.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.4534, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   1, Avg loss: 0.1320, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   2, Avg loss: 0.1071, Accuracy: 18/197 (9.1371%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.4116, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   1, Avg loss: 0.0607, Accuracy: 263/1036 (25.3861%)
___Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   2, Avg loss: 0.0236, Accuracy: 705/1036 (68.0502%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 12.0961, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.0807, Accuracy: 84/773 (10.8668%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0345, Accuracy: 423/773 (54.7219%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.5203, Accuracy: 77/10000 (0.7700%)
time spent on training: 370.3588390350342
___Test Target_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.6816, Accuracy: 104/10000 (1.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 63: Avg loss: 0.5758, Accuracy: 8263/9950 (83.0452%)
saving model
Done in 778.6651072502136 sec.
Server Epoch:64 choose agents : [36, 20, 35, 30, 6, 45, 65, 50, 99, 89].
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   1, Avg loss: 0.1142, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   2, Avg loss: 0.0541, Accuracy: 107/408 (26.2255%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.4785, Accuracy: 54/10000 (0.5400%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   1, Avg loss: 0.0866, Accuracy: 126/807 (15.6134%)
___Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   2, Avg loss: 0.0353, Accuracy: 424/807 (52.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.6584, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.1489, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0878, Accuracy: 1/271 (0.3690%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 6.6379, Accuracy: 121/10000 (1.2100%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.1116, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0454, Accuracy: 182/486 (37.4486%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.4304, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   1, Avg loss: 0.0662, Accuracy: 320/1956 (16.3599%)
___Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   2, Avg loss: 0.0296, Accuracy: 715/1956 (36.5542%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.2637, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.1011, Accuracy: 48/669 (7.1749%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0473, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.5469, Accuracy: 83/10000 (0.8300%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   1, Avg loss: 0.0765, Accuracy: 276/1475 (18.7119%)
___Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   2, Avg loss: 0.0322, Accuracy: 708/1475 (48.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.4647, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   1, Avg loss: 0.0871, Accuracy: 44/809 (5.4388%)
___Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   2, Avg loss: 0.0261, Accuracy: 372/809 (45.9827%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.8157, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   1, Avg loss: 0.0903, Accuracy: 78/773 (10.0906%)
___Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   2, Avg loss: 0.0328, Accuracy: 431/773 (55.7568%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.7403, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   1, Avg loss: 0.0872, Accuracy: 168/896 (18.7500%)
___Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   2, Avg loss: 0.0359, Accuracy: 475/896 (53.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.4985, Accuracy: 65/10000 (0.6500%)
time spent on training: 317.04241251945496
___Test Target_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.4447, Accuracy: 111/10000 (1.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 64: Avg loss: 1.7493, Accuracy: 5188/9950 (52.1407%)
saving model
Done in 723.8102834224701 sec.
Server Epoch:65 choose agents : [61, 28, 93, 57, 72, 82, 55, 87, 88, 96].
poison local model 61 index 22 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Average loss: 0.0462, Accuracy: 56/85 (65.8824%), train_poison_data_count: 61
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Average loss: 0.0416, Accuracy: 58/85 (68.2353%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   3, Average loss: 0.0393, Accuracy: 60/85 (70.5882%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   4, Average loss: 0.0412, Accuracy: 60/85 (70.5882%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   5, Average loss: 0.0392, Accuracy: 60/85 (70.5882%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   6, Average loss: 0.0399, Accuracy: 58/85 (68.2353%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   7, Average loss: 0.0371, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   8, Average loss: 0.0374, Accuracy: 60/85 (70.5882%), train_poison_data_count: 61
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   9, Average loss: 0.0376, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch  10, Average loss: 0.0367, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Global model norm: 111.58466166436138.
Norm before scaling: 111.58356768863864. Distance: 0.10090562331854758
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.5020, Accuracy: 81/10000 (0.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 65: Avg loss: 0.0365, Accuracy: 9947/9950 (99.9698%)
Scaling by  100
Scaled Norm after poisoning: 111.92705667364348, distance: 10.090561685041568
Total norm for 3 adversaries is: 111.92705667364348. distance: 10.090561685041568
___Test Local_ResNet_18 poisoned: True, epoch: 65: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0682, Accuracy: 282/1581 (17.8368%)
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0325, Accuracy: 677/1581 (42.8210%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.7671, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   1, Avg loss: 0.0632, Accuracy: 343/1742 (19.6900%)
___Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   2, Avg loss: 0.0302, Accuracy: 793/1742 (45.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.0222, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0754, Accuracy: 170/1154 (14.7314%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0297, Accuracy: 440/1154 (38.1282%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 10.3405, Accuracy: 72/10000 (0.7200%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0763, Accuracy: 176/1241 (14.1821%)
___Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0354, Accuracy: 466/1241 (37.5504%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.9507, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.1082, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0535, Accuracy: 139/500 (27.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.4443, Accuracy: 77/10000 (0.7700%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 239/1071 (22.3156%)
___Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   2, Avg loss: 0.0258, Accuracy: 581/1071 (54.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.0689, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   1, Avg loss: 0.0774, Accuracy: 183/1131 (16.1804%)
___Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   2, Avg loss: 0.0323, Accuracy: 388/1131 (34.3059%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.3125, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   1, Avg loss: 0.0900, Accuracy: 41/603 (6.7993%)
___Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   2, Avg loss: 0.0470, Accuracy: 287/603 (47.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.6498, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   1, Avg loss: 0.1188, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   2, Avg loss: 0.0730, Accuracy: 30/311 (9.6463%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 6.4861, Accuracy: 102/10000 (1.0200%)
time spent on training: 374.16304111480713
___Test Target_ResNet_18 poisoned: False, epoch: 65: Avg loss: 6.9471, Accuracy: 90/10000 (0.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 65: Avg loss: 0.1719, Accuracy: 9887/9950 (99.3668%)
saving model
Done in 780.2514162063599 sec.
Server Epoch:66 choose agents : [15, 18, 21, 86, 93, 71, 34, 3, 52, 47].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   1, Avg loss: 0.0651, Accuracy: 233/1154 (20.1906%)
___Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   2, Avg loss: 0.0265, Accuracy: 552/1154 (47.8336%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.9862, Accuracy: 87/10000 (0.8700%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0974, Accuracy: 6/530 (1.1321%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0369, Accuracy: 275/530 (51.8868%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.9368, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   1, Avg loss: 0.0634, Accuracy: 325/1949 (16.6752%)
___Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   2, Avg loss: 0.0319, Accuracy: 697/1949 (35.7619%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.2164, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0790, Accuracy: 205/1003 (20.4387%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 376/1003 (37.4875%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.6362, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0600, Accuracy: 371/1742 (21.2974%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0303, Accuracy: 785/1742 (45.0631%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.0397, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0860, Accuracy: 71/818 (8.6797%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 414/818 (50.6112%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.9164, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   1, Avg loss: 0.0692, Accuracy: 275/1427 (19.2712%)
___Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   2, Avg loss: 0.0323, Accuracy: 617/1427 (43.2376%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.8018, Accuracy: 86/10000 (0.8600%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   1, Avg loss: 0.0832, Accuracy: 26/781 (3.3291%)
___Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   2, Avg loss: 0.0345, Accuracy: 245/781 (31.3700%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.4671, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   1, Avg loss: 0.0822, Accuracy: 106/636 (16.6667%)
___Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   2, Avg loss: 0.0327, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.9616, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   1, Avg loss: 0.1730, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   2, Avg loss: 0.1386, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.3550, Accuracy: 101/10000 (1.0100%)
time spent on training: 331.8940920829773
___Test Target_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.5966, Accuracy: 102/10000 (1.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 66: Avg loss: 0.4947, Accuracy: 9206/9950 (92.5226%)
saving model
Done in 748.0361518859863 sec.
Server Epoch:67 choose agents : [65, 12, 41, 56, 19, 23, 37, 45, 96, 9].
poison local model 65 index 23 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   1, Average loss: 0.0356, Accuracy: 945/1475 (64.0678%), train_poison_data_count: 923
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   2, Average loss: 0.0185, Accuracy: 1075/1475 (72.8814%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   3, Average loss: 0.0138, Accuracy: 1118/1475 (75.7966%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   4, Average loss: 0.0142, Accuracy: 1124/1475 (76.2034%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   5, Average loss: 0.0140, Accuracy: 1126/1475 (76.3390%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   6, Average loss: 0.0134, Accuracy: 1130/1475 (76.6102%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   7, Average loss: 0.0130, Accuracy: 1150/1475 (77.9661%), train_poison_data_count: 923
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   8, Average loss: 0.0130, Accuracy: 1128/1475 (76.4746%), train_poison_data_count: 923
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   9, Average loss: 0.0126, Accuracy: 1134/1475 (76.8814%), train_poison_data_count: 923
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch  10, Average loss: 0.0128, Accuracy: 1149/1475 (77.8983%), train_poison_data_count: 923
Global model norm: 111.57971243269316.
Norm before scaling: 111.55160135840723. Distance: 0.9937117275329518
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.1005, Accuracy: 82/10000 (0.8200%)
___Test Local_ResNet_18 poisoned: True, epoch: 67: Avg loss: 0.4238, Accuracy: 9329/9950 (93.7588%)
Scaling by  100
Scaled Norm after poisoning: 146.96493921808357, distance: 99.37116737892335
Total norm for 4 adversaries is: 146.96493921808357. distance: 99.37116737892335
___Test Local_ResNet_18 poisoned: True, epoch: 67: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   1, Avg loss: 0.1078, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   2, Avg loss: 0.0545, Accuracy: 70/338 (20.7101%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.8914, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   1, Avg loss: 0.0794, Accuracy: 147/719 (20.4451%)
___Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   2, Avg loss: 0.0387, Accuracy: 471/719 (65.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.0196, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.1184, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0947, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.2241, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0591, Accuracy: 305/1036 (29.4402%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0231, Accuracy: 729/1036 (70.3668%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 12.0462, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   1, Avg loss: 0.0845, Accuracy: 128/715 (17.9021%)
___Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   2, Avg loss: 0.0455, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.4502, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   1, Avg loss: 0.0535, Accuracy: 381/1129 (33.7467%)
___Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   2, Avg loss: 0.0222, Accuracy: 763/1129 (67.5819%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.2494, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   1, Avg loss: 0.0856, Accuracy: 76/669 (11.3602%)
___Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   2, Avg loss: 0.0424, Accuracy: 362/669 (54.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.2718, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.1073, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0673, Accuracy: 42/311 (13.5048%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.3128, Accuracy: 62/10000 (0.6200%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   1, Avg loss: 0.0544, Accuracy: 305/1275 (23.9216%)
___Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   2, Avg loss: 0.0164, Accuracy: 807/1275 (63.2941%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.8899, Accuracy: 129/10000 (1.2900%)
time spent on training: 297.7794773578644
___Test Target_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.9989, Accuracy: 86/10000 (0.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 67: Avg loss: 0.7448, Accuracy: 7979/9950 (80.1910%)
saving model
Done in 691.2904109954834 sec.
Server Epoch:68 choose agents : [30, 17, 54, 91, 69, 28, 65, 60, 9, 11].
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   1, Avg loss: 0.1064, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   2, Avg loss: 0.0423, Accuracy: 192/486 (39.5062%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.2895, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0643, Accuracy: 326/1574 (20.7116%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0256, Accuracy: 783/1574 (49.7459%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.6062, Accuracy: 138/10000 (1.3800%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   1, Avg loss: 0.0648, Accuracy: 232/1130 (20.5310%)
___Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   2, Avg loss: 0.0273, Accuracy: 530/1130 (46.9027%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.4329, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   1, Avg loss: 0.0661, Accuracy: 239/1030 (23.2039%)
___Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   2, Avg loss: 0.0282, Accuracy: 652/1030 (63.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 10.8036, Accuracy: 106/10000 (1.0600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   1, Avg loss: 0.0905, Accuracy: 96/590 (16.2712%)
___Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   2, Avg loss: 0.0338, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 12.1564, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   1, Avg loss: 0.0671, Accuracy: 303/1581 (19.1651%)
___Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   2, Avg loss: 0.0323, Accuracy: 652/1581 (41.2397%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.7200, Accuracy: 103/10000 (1.0300%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   1, Avg loss: 0.0332, Accuracy: 631/1475 (42.7797%)
___Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   2, Avg loss: 0.0256, Accuracy: 828/1475 (56.1356%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.0792, Accuracy: 118/10000 (1.1800%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0448, Accuracy: 752/2227 (33.7674%)
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0259, Accuracy: 1135/2227 (50.9654%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.2119, Accuracy: 137/10000 (1.3700%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0592, Accuracy: 319/1275 (25.0196%)
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0160, Accuracy: 831/1275 (65.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 10.8555, Accuracy: 142/10000 (1.4200%)
___Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   1, Avg loss: 0.0801, Accuracy: 119/712 (16.7135%)
___Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   2, Avg loss: 0.0293, Accuracy: 448/712 (62.9213%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.9215, Accuracy: 70/10000 (0.7000%)
time spent on training: 308.58196568489075
___Test Target_ResNet_18 poisoned: False, epoch: 68: Avg loss: 6.6918, Accuracy: 86/10000 (0.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 68: Avg loss: 1.1500, Accuracy: 6315/9950 (63.4673%)
saving model
Done in 703.6294190883636 sec.
Server Epoch:69 choose agents : [69, 3, 66, 36, 78, 83, 8, 10, 93, 58].
poison local model 69 index 24 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Average loss: 0.0469, Accuracy: 359/590 (60.8475%), train_poison_data_count: 374
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Average loss: 0.0256, Accuracy: 354/590 (60.0000%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   3, Average loss: 0.0224, Accuracy: 346/590 (58.6441%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   4, Average loss: 0.0174, Accuracy: 399/590 (67.6271%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   5, Average loss: 0.0194, Accuracy: 405/590 (68.6441%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   6, Average loss: 0.0174, Accuracy: 415/590 (70.3390%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   7, Average loss: 0.0167, Accuracy: 442/590 (74.9153%), train_poison_data_count: 374
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   8, Average loss: 0.0156, Accuracy: 449/590 (76.1017%), train_poison_data_count: 374
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   9, Average loss: 0.0155, Accuracy: 459/590 (77.7966%), train_poison_data_count: 374
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch  10, Average loss: 0.0150, Accuracy: 454/590 (76.9492%), train_poison_data_count: 374
Global model norm: 111.54815646588473.
Norm before scaling: 111.53779926133785. Distance: 0.6283602506486102
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.4999, Accuracy: 47/10000 (0.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 69: Avg loss: 0.2417, Accuracy: 9412/9950 (94.5930%)
Scaling by  100
Scaled Norm after poisoning: 126.96724248428214, distance: 62.83602443500762
Total norm for 5 adversaries is: 126.96724248428214. distance: 62.83602443500762
___Test Local_ResNet_18 poisoned: True, epoch: 69: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   1, Avg loss: 0.0838, Accuracy: 27/781 (3.4571%)
___Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   2, Avg loss: 0.0323, Accuracy: 301/781 (38.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.6867, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   1, Avg loss: 0.0763, Accuracy: 168/1402 (11.9829%)
___Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 421/1402 (30.0285%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.6425, Accuracy: 76/10000 (0.7600%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   1, Avg loss: 0.1026, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   2, Avg loss: 0.0505, Accuracy: 114/408 (27.9412%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.0786, Accuracy: 53/10000 (0.5300%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   1, Avg loss: 0.1069, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   2, Avg loss: 0.0506, Accuracy: 130/416 (31.2500%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.9729, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0644, Accuracy: 365/1953 (18.6892%)
___Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0317, Accuracy: 931/1953 (47.6703%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.5562, Accuracy: 156/10000 (1.5600%)
___Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   1, Avg loss: 0.0710, Accuracy: 213/1513 (14.0780%)
___Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   2, Avg loss: 0.0348, Accuracy: 541/1513 (35.7568%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.7766, Accuracy: 118/10000 (1.1800%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   1, Avg loss: 0.0708, Accuracy: 132/861 (15.3310%)
___Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   2, Avg loss: 0.0180, Accuracy: 528/861 (61.3240%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 10.6369, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   1, Avg loss: 0.0611, Accuracy: 350/1742 (20.0918%)
___Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   2, Avg loss: 0.0299, Accuracy: 761/1742 (43.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.2371, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   1, Avg loss: 0.0754, Accuracy: 168/803 (20.9215%)
___Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   2, Avg loss: 0.0373, Accuracy: 401/803 (49.9377%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.3062, Accuracy: 56/10000 (0.5600%)
time spent on training: 332.8068881034851
___Test Target_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.3301, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 69: Avg loss: 0.3889, Accuracy: 8368/9950 (84.1005%)
saving model
Done in 728.4556970596313 sec.
Server Epoch:70 choose agents : [22, 18, 31, 35, 88, 66, 36, 14, 27, 48].
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0585, Accuracy: 440/1470 (29.9320%)
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 934/1470 (63.5374%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.6879, Accuracy: 109/10000 (1.0900%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   1, Avg loss: 0.0991, Accuracy: 6/530 (1.1321%)
___Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   2, Avg loss: 0.0357, Accuracy: 275/530 (51.8868%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.1956, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   1, Avg loss: 0.1128, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   2, Avg loss: 0.0410, Accuracy: 180/460 (39.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.6074, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   1, Avg loss: 0.1353, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   2, Avg loss: 0.0739, Accuracy: 9/271 (3.3210%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.1921, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.0924, Accuracy: 42/603 (6.9652%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0453, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.3874, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0756, Accuracy: 214/1402 (15.2639%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0383, Accuracy: 434/1402 (30.9558%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.5841, Accuracy: 70/10000 (0.7000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.1081, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0496, Accuracy: 120/408 (29.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.0789, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   1, Avg loss: 0.0827, Accuracy: 113/1013 (11.1550%)
___Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   2, Avg loss: 0.0348, Accuracy: 387/1013 (38.2034%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.3181, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   1, Avg loss: 0.0690, Accuracy: 318/1587 (20.0378%)
___Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   2, Avg loss: 0.0330, Accuracy: 655/1587 (41.2728%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.6256, Accuracy: 73/10000 (0.7300%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0896, Accuracy: 14/631 (2.2187%)
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0397, Accuracy: 286/631 (45.3249%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.5343, Accuracy: 86/10000 (0.8600%)
time spent on training: 256.2868275642395
___Test Target_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.7513, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 70: Avg loss: 0.4880, Accuracy: 8036/9950 (80.7638%)
saving model
Done in 652.2485404014587 sec.
Server Epoch:71 choose agents : [72, 77, 92, 31, 46, 66, 54, 0, 25, 36].
poison local model 72 index 25 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   1, Average loss: 0.0349, Accuracy: 763/1241 (61.4827%), train_poison_data_count: 785
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   2, Average loss: 0.0184, Accuracy: 901/1241 (72.6027%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   3, Average loss: 0.0157, Accuracy: 923/1241 (74.3755%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   4, Average loss: 0.0158, Accuracy: 925/1241 (74.5367%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   5, Average loss: 0.0161, Accuracy: 915/1241 (73.7309%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   6, Average loss: 0.0158, Accuracy: 922/1241 (74.2949%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   7, Average loss: 0.0153, Accuracy: 936/1241 (75.4230%), train_poison_data_count: 785
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   8, Average loss: 0.0155, Accuracy: 933/1241 (75.1813%), train_poison_data_count: 785
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   9, Average loss: 0.0148, Accuracy: 928/1241 (74.7784%), train_poison_data_count: 785
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch  10, Average loss: 0.0146, Accuracy: 925/1241 (74.5367%), train_poison_data_count: 785
Global model norm: 111.53428389681353.
Norm before scaling: 111.51147292431394. Distance: 0.8182281170374311
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.1659, Accuracy: 68/10000 (0.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 71: Avg loss: 0.6670, Accuracy: 8567/9950 (86.1005%)
Scaling by  100
Scaled Norm after poisoning: 136.23111250967966, distance: 81.82281853378372
Total norm for 5 adversaries is: 136.23111250967966. distance: 81.82281853378372
___Test Local_ResNet_18 poisoned: True, epoch: 71: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0585, Accuracy: 264/1340 (19.7015%)
___Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0248, Accuracy: 689/1340 (51.4179%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.9034, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   1, Avg loss: 0.0600, Accuracy: 409/1715 (23.8484%)
___Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   2, Avg loss: 0.0281, Accuracy: 816/1715 (47.5802%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.2855, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   1, Avg loss: 0.1024, Accuracy: 1/460 (0.2174%)
___Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   2, Avg loss: 0.0398, Accuracy: 184/460 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.7022, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   1, Avg loss: 0.0619, Accuracy: 412/1904 (21.6387%)
___Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   2, Avg loss: 0.0285, Accuracy: 808/1904 (42.4370%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.8861, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   1, Avg loss: 0.0733, Accuracy: 186/1402 (13.2668%)
___Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   2, Avg loss: 0.0380, Accuracy: 412/1402 (29.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.5619, Accuracy: 80/10000 (0.8000%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   1, Avg loss: 0.0590, Accuracy: 258/1130 (22.8319%)
___Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   2, Avg loss: 0.0265, Accuracy: 588/1130 (52.0354%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.0726, Accuracy: 81/10000 (0.8100%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   1, Avg loss: 0.0637, Accuracy: 311/1657 (18.7689%)
___Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   2, Avg loss: 0.0324, Accuracy: 611/1657 (36.8739%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.8630, Accuracy: 88/10000 (0.8800%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   1, Avg loss: 0.0730, Accuracy: 154/690 (22.3188%)
___Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   2, Avg loss: 0.0265, Accuracy: 471/690 (68.2609%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.5844, Accuracy: 82/10000 (0.8200%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   1, Avg loss: 0.0978, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   2, Avg loss: 0.0503, Accuracy: 138/408 (33.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.1871, Accuracy: 55/10000 (0.5500%)
time spent on training: 389.8486416339874
___Test Target_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.0882, Accuracy: 67/10000 (0.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Avg loss: 0.9852, Accuracy: 7318/9950 (73.5477%)
saving model
Done in 784.1135196685791 sec.
Server Epoch:72 choose agents : [7, 99, 12, 11, 10, 15, 85, 26, 14, 29].
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0769, Accuracy: 182/891 (20.4265%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0292, Accuracy: 451/891 (50.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.6253, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0794, Accuracy: 86/773 (11.1255%)
___Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0339, Accuracy: 428/773 (55.3687%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.7571, Accuracy: 78/10000 (0.7800%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   1, Avg loss: 0.1183, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   2, Avg loss: 0.0564, Accuracy: 52/338 (15.3846%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.6563, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   1, Avg loss: 0.0767, Accuracy: 138/712 (19.3820%)
___Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   2, Avg loss: 0.0303, Accuracy: 451/712 (63.3427%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.7107, Accuracy: 69/10000 (0.6900%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   1, Avg loss: 0.0734, Accuracy: 109/861 (12.6597%)
___Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   2, Avg loss: 0.0190, Accuracy: 492/861 (57.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 10.4046, Accuracy: 109/10000 (1.0900%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   1, Avg loss: 0.0702, Accuracy: 219/1154 (18.9775%)
___Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   2, Avg loss: 0.0275, Accuracy: 473/1154 (40.9879%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.3061, Accuracy: 71/10000 (0.7100%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   1, Avg loss: 0.0661, Accuracy: 373/1988 (18.7626%)
___Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   2, Avg loss: 0.0343, Accuracy: 735/1988 (36.9718%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.7187, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   1, Avg loss: 0.0678, Accuracy: 237/1446 (16.3900%)
___Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   2, Avg loss: 0.0337, Accuracy: 561/1446 (38.7967%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.7197, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   1, Avg loss: 0.0822, Accuracy: 89/1013 (8.7858%)
___Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 366/1013 (36.1303%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.3858, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   1, Avg loss: 0.0627, Accuracy: 291/1440 (20.2083%)
___Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   2, Avg loss: 0.0272, Accuracy: 745/1440 (51.7361%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.8045, Accuracy: 96/10000 (0.9600%)
time spent on training: 294.18710803985596
___Test Target_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.7750, Accuracy: 73/10000 (0.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Avg loss: 2.6216, Accuracy: 3337/9950 (33.5377%)
saving model
Done in 687.8666527271271 sec.
Server Epoch:73 choose agents : [74, 81, 71, 96, 73, 8, 10, 55, 33, 35].
poison local model 74 index 26 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   1, Average loss: 0.0302, Accuracy: 986/1552 (63.5309%), train_poison_data_count: 976
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   2, Average loss: 0.0115, Accuracy: 1197/1552 (77.1263%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   3, Average loss: 0.0100, Accuracy: 1208/1552 (77.8351%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   4, Average loss: 0.0093, Accuracy: 1235/1552 (79.5747%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   5, Average loss: 0.0096, Accuracy: 1216/1552 (78.3505%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   6, Average loss: 0.0091, Accuracy: 1228/1552 (79.1237%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   7, Average loss: 0.0091, Accuracy: 1245/1552 (80.2191%), train_poison_data_count: 976
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   8, Average loss: 0.0094, Accuracy: 1226/1552 (78.9948%), train_poison_data_count: 976
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   9, Average loss: 0.0083, Accuracy: 1242/1552 (80.0258%), train_poison_data_count: 976
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch  10, Average loss: 0.0087, Accuracy: 1238/1552 (79.7680%), train_poison_data_count: 976
Global model norm: 111.50752759763576.
Norm before scaling: 111.47937204086234. Distance: 0.9849317278172119
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.7380, Accuracy: 80/10000 (0.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 73: Avg loss: 1.1221, Accuracy: 6098/9950 (61.2864%)
Scaling by  100
Scaled Norm after poisoning: 146.32072275057283, distance: 98.49317374030294
Total norm for 5 adversaries is: 146.32072275057283. distance: 98.49317374030294
___Test Local_ResNet_18 poisoned: True, epoch: 73: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0742, Accuracy: 134/774 (17.3127%)
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0395, Accuracy: 348/774 (44.9612%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.7459, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0804, Accuracy: 82/818 (10.0244%)
___Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0301, Accuracy: 430/818 (52.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.5745, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.1085, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0691, Accuracy: 36/311 (11.5756%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.1120, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   1, Avg loss: 0.0727, Accuracy: 162/938 (17.2708%)
___Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   2, Avg loss: 0.0344, Accuracy: 325/938 (34.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.0415, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   1, Avg loss: 0.0687, Accuracy: 212/1513 (14.0119%)
___Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   2, Avg loss: 0.0353, Accuracy: 545/1513 (36.0212%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.8675, Accuracy: 117/10000 (1.1700%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0675, Accuracy: 129/861 (14.9826%)
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0183, Accuracy: 516/861 (59.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 10.2655, Accuracy: 107/10000 (1.0700%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 231/1071 (21.5686%)
___Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   2, Avg loss: 0.0265, Accuracy: 571/1071 (53.3147%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.9216, Accuracy: 88/10000 (0.8800%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.1048, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0556, Accuracy: 136/515 (26.4078%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.6806, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   1, Avg loss: 0.1238, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   2, Avg loss: 0.0765, Accuracy: 5/271 (1.8450%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.1271, Accuracy: 58/10000 (0.5800%)
time spent on training: 329.16213607788086
___Test Target_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.7343, Accuracy: 82/10000 (0.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Avg loss: 1.9956, Accuracy: 4156/9950 (41.7688%)
saving model
Done in 718.9776244163513 sec.
Server Epoch:74 choose agents : [50, 33, 10, 20, 28, 37, 46, 27, 93, 60].
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0907, Accuracy: 46/809 (5.6860%)
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0265, Accuracy: 385/809 (47.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.5853, Accuracy: 120/10000 (1.2000%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   1, Avg loss: 0.1289, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   2, Avg loss: 0.0583, Accuracy: 90/515 (17.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 6.8597, Accuracy: 85/10000 (0.8500%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   1, Avg loss: 0.0837, Accuracy: 84/861 (9.7561%)
___Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   2, Avg loss: 0.0186, Accuracy: 506/861 (58.7689%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 10.2969, Accuracy: 119/10000 (1.1900%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   1, Avg loss: 0.0889, Accuracy: 108/807 (13.3829%)
___Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   2, Avg loss: 0.0368, Accuracy: 438/807 (54.2751%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.0996, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0737, Accuracy: 267/1581 (16.8880%)
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0323, Accuracy: 629/1581 (39.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.6194, Accuracy: 107/10000 (1.0700%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0697, Accuracy: 302/1129 (26.7493%)
___Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0228, Accuracy: 749/1129 (66.3419%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.3535, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   1, Avg loss: 0.0705, Accuracy: 311/1904 (16.3340%)
___Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   2, Avg loss: 0.0294, Accuracy: 768/1904 (40.3361%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.9557, Accuracy: 144/10000 (1.4400%)
___Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   1, Avg loss: 0.0761, Accuracy: 302/1587 (19.0296%)
___Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   2, Avg loss: 0.0332, Accuracy: 630/1587 (39.6975%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.7179, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0671, Accuracy: 345/1742 (19.8048%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0303, Accuracy: 780/1742 (44.7761%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.1779, Accuracy: 115/10000 (1.1500%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   1, Avg loss: 0.0522, Accuracy: 678/2227 (30.4445%)
___Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   2, Avg loss: 0.0258, Accuracy: 1129/2227 (50.6960%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.8869, Accuracy: 144/10000 (1.4400%)
time spent on training: 306.06975746154785
___Test Target_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.1201, Accuracy: 84/10000 (0.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Avg loss: 2.5468, Accuracy: 3394/9950 (34.1106%)
saving model
Done in 723.3990254402161 sec.
Server Epoch:75 choose agents : [78, 51, 85, 6, 92, 32, 29, 40, 95, 74].
poison local model 78 index 27 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   1, Average loss: 0.0454, Accuracy: 241/416 (57.9327%), train_poison_data_count: 272
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   2, Average loss: 0.0361, Accuracy: 270/416 (64.9038%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   3, Average loss: 0.0271, Accuracy: 271/416 (65.1442%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   4, Average loss: 0.0258, Accuracy: 271/416 (65.1442%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   5, Average loss: 0.0250, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   6, Average loss: 0.0246, Accuracy: 275/416 (66.1058%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   7, Average loss: 0.0222, Accuracy: 278/416 (66.8269%), train_poison_data_count: 272
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   8, Average loss: 0.0225, Accuracy: 285/416 (68.5096%), train_poison_data_count: 272
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   9, Average loss: 0.0210, Accuracy: 291/416 (69.9519%), train_poison_data_count: 272
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch  10, Average loss: 0.0216, Accuracy: 292/416 (70.1923%), train_poison_data_count: 272
Global model norm: 111.47532483413089.
Norm before scaling: 111.46767678905844. Distance: 0.4580487068317915
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.3119, Accuracy: 95/10000 (0.9500%)
___Test Local_ResNet_18 poisoned: True, epoch: 75: Avg loss: 0.2264, Accuracy: 9943/9950 (99.9296%)
Scaling by  100
Scaled Norm after poisoning: 119.7223717149911, distance: 45.8048707196148
Total norm for 4 adversaries is: 119.7223717149911. distance: 45.8048707196148
___Test Local_ResNet_18 poisoned: True, epoch: 75: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   1, Avg loss: 0.0787, Accuracy: 160/1049 (15.2526%)
___Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   2, Avg loss: 0.0271, Accuracy: 549/1049 (52.3356%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.5180, Accuracy: 133/10000 (1.3300%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0676, Accuracy: 370/1988 (18.6117%)
___Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0337, Accuracy: 750/1988 (37.7264%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.7933, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   1, Avg loss: 0.0647, Accuracy: 343/1956 (17.5358%)
___Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   2, Avg loss: 0.0290, Accuracy: 763/1956 (39.0082%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.2286, Accuracy: 134/10000 (1.3400%)
___Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   1, Avg loss: 0.0656, Accuracy: 346/1715 (20.1749%)
___Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   2, Avg loss: 0.0287, Accuracy: 775/1715 (45.1895%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.1517, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   1, Avg loss: 0.0769, Accuracy: 103/735 (14.0136%)
___Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   2, Avg loss: 0.0232, Accuracy: 386/735 (52.5170%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.7371, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   1, Avg loss: 0.0647, Accuracy: 296/1440 (20.5556%)
___Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   2, Avg loss: 0.0272, Accuracy: 744/1440 (51.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.8361, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0642, Accuracy: 245/1573 (15.5753%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0343, Accuracy: 627/1573 (39.8601%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.7019, Accuracy: 83/10000 (0.8300%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   1, Avg loss: 0.0877, Accuracy: 77/599 (12.8548%)
___Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   2, Avg loss: 0.0306, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 13.1150, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0226, Accuracy: 772/1552 (49.7423%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0180, Accuracy: 923/1552 (59.4716%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.5066, Accuracy: 112/10000 (1.1200%)
time spent on training: 352.93192529678345
___Test Target_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.0846, Accuracy: 98/10000 (0.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Avg loss: 0.3947, Accuracy: 9897/9950 (99.4673%)
saving model
Done in 769.8334119319916 sec.
Server Epoch:76 choose agents : [6, 5, 30, 19, 88, 49, 14, 57, 85, 92].
___Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   1, Avg loss: 0.0603, Accuracy: 336/1956 (17.1779%)
___Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   2, Avg loss: 0.0295, Accuracy: 755/1956 (38.5992%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.2098, Accuracy: 130/10000 (1.3000%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0548, Accuracy: 453/1628 (27.8256%)
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0215, Accuracy: 980/1628 (60.1966%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.2315, Accuracy: 183/10000 (1.8300%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   1, Avg loss: 0.0962, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   2, Avg loss: 0.0411, Accuracy: 203/486 (41.7695%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.9058, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   1, Avg loss: 0.0562, Accuracy: 356/1036 (34.3629%)
___Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   2, Avg loss: 0.0220, Accuracy: 725/1036 (69.9807%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 11.5313, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0882, Accuracy: 47/603 (7.7944%)
___Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0460, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.3448, Accuracy: 59/10000 (0.5900%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   1, Avg loss: 0.0917, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   2, Avg loss: 0.0471, Accuracy: 117/440 (26.5909%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 6.7154, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0788, Accuracy: 95/1013 (9.3781%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0350, Accuracy: 398/1013 (39.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.0268, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   1, Avg loss: 0.0700, Accuracy: 181/1154 (15.6846%)
___Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   2, Avg loss: 0.0267, Accuracy: 535/1154 (46.3605%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 10.4653, Accuracy: 79/10000 (0.7900%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   1, Avg loss: 0.0634, Accuracy: 381/1988 (19.1650%)
___Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   2, Avg loss: 0.0341, Accuracy: 773/1988 (38.8833%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.6844, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0605, Accuracy: 371/1715 (21.6327%)
___Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0281, Accuracy: 807/1715 (47.0554%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.1271, Accuracy: 109/10000 (1.0900%)
time spent on training: 304.41687297821045
___Test Target_ResNet_18 poisoned: False, epoch: 76: Avg loss: 5.9035, Accuracy: 99/10000 (0.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Avg loss: 0.6615, Accuracy: 9555/9950 (96.0302%)
saving model
Done in 724.7923657894135 sec.
Server Epoch:77 choose agents : [81, 75, 66, 1, 61, 65, 79, 49, 94, 10].
poison local model 81 index 28 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   1, Average loss: 0.0367, Accuracy: 487/774 (62.9199%), train_poison_data_count: 486
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   2, Average loss: 0.0217, Accuracy: 547/774 (70.6718%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   3, Average loss: 0.0175, Accuracy: 596/774 (77.0026%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   4, Average loss: 0.0167, Accuracy: 583/774 (75.3230%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   5, Average loss: 0.0163, Accuracy: 597/774 (77.1318%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   6, Average loss: 0.0163, Accuracy: 596/774 (77.0026%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   7, Average loss: 0.0154, Accuracy: 595/774 (76.8734%), train_poison_data_count: 486
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   8, Average loss: 0.0146, Accuracy: 607/774 (78.4238%), train_poison_data_count: 486
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   9, Average loss: 0.0144, Accuracy: 605/774 (78.1654%), train_poison_data_count: 486
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch  10, Average loss: 0.0148, Accuracy: 604/774 (78.0362%), train_poison_data_count: 486
Global model norm: 111.4630771965542.
Norm before scaling: 111.45037695511621. Distance: 0.6477953247281423
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.8063, Accuracy: 73/10000 (0.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 77: Avg loss: 0.0789, Accuracy: 9920/9950 (99.6985%)
Scaling by  100
Scaled Norm after poisoning: 127.65371402009814, distance: 64.77953145332637
Total norm for 5 adversaries is: 127.65371402009814. distance: 64.77953145332637
___Test Local_ResNet_18 poisoned: True, epoch: 77: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   1, Avg loss: 0.0779, Accuracy: 119/776 (15.3351%)
___Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   2, Avg loss: 0.0302, Accuracy: 446/776 (57.4742%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.1425, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0698, Accuracy: 213/1402 (15.1926%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0377, Accuracy: 453/1402 (32.3110%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.4719, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   1, Avg loss: 0.0662, Accuracy: 231/928 (24.8922%)
___Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   2, Avg loss: 0.0230, Accuracy: 619/928 (66.7026%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.8492, Accuracy: 112/10000 (1.1200%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1512, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1334, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.8409, Accuracy: 110/10000 (1.1000%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   1, Avg loss: 0.0459, Accuracy: 474/1475 (32.1356%)
___Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   2, Avg loss: 0.0263, Accuracy: 809/1475 (54.8475%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.6887, Accuracy: 143/10000 (1.4300%)
___Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   1, Avg loss: 0.1327, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   2, Avg loss: 0.1054, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.7213, Accuracy: 104/10000 (1.0400%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0843, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0461, Accuracy: 131/440 (29.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.6191, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0637, Accuracy: 294/1662 (17.6895%)
___Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0313, Accuracy: 700/1662 (42.1179%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.9845, Accuracy: 127/10000 (1.2700%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   1, Avg loss: 0.0640, Accuracy: 158/861 (18.3508%)
___Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   2, Avg loss: 0.0178, Accuracy: 534/861 (62.0209%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 9.9890, Accuracy: 114/10000 (1.1400%)
time spent on training: 326.8937966823578
___Test Target_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.7319, Accuracy: 73/10000 (0.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Avg loss: 0.1150, Accuracy: 9842/9950 (98.9146%)
saving model
Done in 747.7164936065674 sec.
Server Epoch:78 choose agents : [42, 6, 82, 30, 19, 31, 93, 7, 5, 16].
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   1, Avg loss: 0.0633, Accuracy: 252/1372 (18.3673%)
___Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   2, Avg loss: 0.0292, Accuracy: 625/1372 (45.5539%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.4493, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   1, Avg loss: 0.0600, Accuracy: 364/1956 (18.6094%)
___Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   2, Avg loss: 0.0293, Accuracy: 766/1956 (39.1616%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.2081, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   1, Avg loss: 0.0955, Accuracy: 2/500 (0.4000%)
___Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   2, Avg loss: 0.0508, Accuracy: 179/500 (35.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.0698, Accuracy: 80/10000 (0.8000%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.1005, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 194/486 (39.9177%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.0470, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   1, Avg loss: 0.0589, Accuracy: 318/1036 (30.6950%)
___Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   2, Avg loss: 0.0224, Accuracy: 716/1036 (69.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 11.5923, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   1, Avg loss: 0.1018, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   2, Avg loss: 0.0376, Accuracy: 182/460 (39.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.9164, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   1, Avg loss: 0.0604, Accuracy: 359/1742 (20.6085%)
___Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   2, Avg loss: 0.0295, Accuracy: 763/1742 (43.8002%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.1699, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   1, Avg loss: 0.0753, Accuracy: 182/891 (20.4265%)
___Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   2, Avg loss: 0.0286, Accuracy: 436/891 (48.9338%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.6222, Accuracy: 87/10000 (0.8700%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   1, Avg loss: 0.0565, Accuracy: 416/1628 (25.5528%)
___Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   2, Avg loss: 0.0224, Accuracy: 906/1628 (55.6511%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.9172, Accuracy: 168/10000 (1.6800%)
___Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   1, Avg loss: 0.0860, Accuracy: 113/708 (15.9605%)
___Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   2, Avg loss: 0.0428, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.9356, Accuracy: 61/10000 (0.6100%)
time spent on training: 276.4712219238281
___Test Target_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.2771, Accuracy: 79/10000 (0.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Avg loss: 0.5030, Accuracy: 8303/9950 (83.4472%)
saving model
Done in 688.1771483421326 sec.
Server Epoch:79 choose agents : [84, 82, 36, 58, 27, 49, 61, 52, 90, 85].
poison local model 84 index 29 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   1, Average loss: 0.0365, Accuracy: 742/1190 (62.3529%), train_poison_data_count: 758
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   2, Average loss: 0.0212, Accuracy: 822/1190 (69.0756%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   3, Average loss: 0.0166, Accuracy: 828/1190 (69.5798%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   4, Average loss: 0.0156, Accuracy: 849/1190 (71.3445%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   5, Average loss: 0.0156, Accuracy: 838/1190 (70.4202%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   6, Average loss: 0.0152, Accuracy: 853/1190 (71.6807%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   7, Average loss: 0.0150, Accuracy: 847/1190 (71.1765%), train_poison_data_count: 758
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   8, Average loss: 0.0148, Accuracy: 861/1190 (72.3529%), train_poison_data_count: 758
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   9, Average loss: 0.0146, Accuracy: 884/1190 (74.2857%), train_poison_data_count: 758
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch  10, Average loss: 0.0142, Accuracy: 867/1190 (72.8571%), train_poison_data_count: 758
Global model norm: 111.4470297032967.
Norm before scaling: 111.42549798660313. Distance: 0.8281734020555254
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.6066, Accuracy: 55/10000 (0.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 79: Avg loss: 0.7625, Accuracy: 7731/9950 (77.6985%)
Scaling by  100
Scaled Norm after poisoning: 136.86011619989952, distance: 82.81734360835145
Total norm for 5 adversaries is: 136.86011619989952. distance: 82.81734360835145
___Test Local_ResNet_18 poisoned: True, epoch: 79: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   1, Avg loss: 0.0878, Accuracy: 6/500 (1.2000%)
___Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   2, Avg loss: 0.0504, Accuracy: 177/500 (35.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.0595, Accuracy: 84/10000 (0.8400%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   1, Avg loss: 0.0999, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   2, Avg loss: 0.0516, Accuracy: 119/408 (29.1667%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.8359, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   1, Avg loss: 0.0736, Accuracy: 165/803 (20.5479%)
___Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   2, Avg loss: 0.0370, Accuracy: 437/803 (54.4209%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.2091, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0660, Accuracy: 325/1587 (20.4789%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0327, Accuracy: 663/1587 (41.7769%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.7513, Accuracy: 75/10000 (0.7500%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   1, Avg loss: 0.0899, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   2, Avg loss: 0.0472, Accuracy: 113/440 (25.6818%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.6948, Accuracy: 55/10000 (0.5500%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   1, Avg loss: 0.1630, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   2, Avg loss: 0.1498, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.0784, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0755, Accuracy: 115/636 (18.0818%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0339, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.0934, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   1, Avg loss: 0.0751, Accuracy: 140/677 (20.6795%)
___Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 470/677 (69.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 10.4099, Accuracy: 72/10000 (0.7200%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0615, Accuracy: 406/1988 (20.4225%)
___Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0348, Accuracy: 778/1988 (39.1348%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.8288, Accuracy: 99/10000 (0.9900%)
time spent on training: 324.0506513118744
___Test Target_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.4931, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Avg loss: 1.5010, Accuracy: 5148/9950 (51.7387%)
saving model
Done in 736.9580602645874 sec.
Server Epoch:80 choose agents : [46, 75, 54, 3, 89, 69, 41, 1, 93, 71].
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0642, Accuracy: 382/1904 (20.0630%)
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0290, Accuracy: 815/1904 (42.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.8954, Accuracy: 150/10000 (1.5000%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0859, Accuracy: 105/776 (13.5309%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0314, Accuracy: 440/776 (56.7010%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.0809, Accuracy: 85/10000 (0.8500%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   1, Avg loss: 0.0664, Accuracy: 241/1130 (21.3274%)
___Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   2, Avg loss: 0.0271, Accuracy: 582/1130 (51.5044%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.0854, Accuracy: 60/10000 (0.6000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   1, Avg loss: 0.0844, Accuracy: 40/781 (5.1216%)
___Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   2, Avg loss: 0.0351, Accuracy: 291/781 (37.2599%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.1470, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0810, Accuracy: 182/896 (20.3125%)
___Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0358, Accuracy: 482/896 (53.7946%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.2282, Accuracy: 67/10000 (0.6700%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   1, Avg loss: 0.0753, Accuracy: 115/590 (19.4915%)
___Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.8797, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   1, Avg loss: 0.0848, Accuracy: 133/719 (18.4979%)
___Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   2, Avg loss: 0.0380, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.2834, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   1, Avg loss: 0.0720, Accuracy: 199/928 (21.4440%)
___Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   2, Avg loss: 0.0226, Accuracy: 616/928 (66.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.9997, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   1, Avg loss: 0.0611, Accuracy: 349/1742 (20.0344%)
___Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   2, Avg loss: 0.0300, Accuracy: 791/1742 (45.4076%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.0701, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   1, Avg loss: 0.0701, Accuracy: 93/818 (11.3692%)
___Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   2, Avg loss: 0.0278, Accuracy: 434/818 (53.0562%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.7297, Accuracy: 114/10000 (1.1400%)
time spent on training: 274.1538438796997
___Test Target_ResNet_18 poisoned: False, epoch: 80: Avg loss: 6.2669, Accuracy: 77/10000 (0.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Avg loss: 2.6121, Accuracy: 3591/9950 (36.0905%)
saving model
Done in 687.6591427326202 sec.
Server Epoch:81 choose agents : [85, 15, 81, 53, 39, 54, 28, 61, 0, 51].
poison local model 85 index 30 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   1, Average loss: 0.0320, Accuracy: 1248/1988 (62.7767%), train_poison_data_count: 1244
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   2, Average loss: 0.0172, Accuracy: 1405/1988 (70.6740%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   3, Average loss: 0.0159, Accuracy: 1455/1988 (73.1891%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   4, Average loss: 0.0159, Accuracy: 1470/1988 (73.9437%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   5, Average loss: 0.0154, Accuracy: 1435/1988 (72.1831%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   6, Average loss: 0.0152, Accuracy: 1464/1988 (73.6419%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   7, Average loss: 0.0149, Accuracy: 1457/1988 (73.2897%), train_poison_data_count: 1244
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   8, Average loss: 0.0145, Accuracy: 1472/1988 (74.0443%), train_poison_data_count: 1244
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   9, Average loss: 0.0147, Accuracy: 1472/1988 (74.0443%), train_poison_data_count: 1244
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch  10, Average loss: 0.0149, Accuracy: 1455/1988 (73.1891%), train_poison_data_count: 1244
Global model norm: 111.4222902197424.
Norm before scaling: 111.38421503684891. Distance: 1.0438749112976644
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.4068, Accuracy: 79/10000 (0.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 81: Avg loss: 0.2795, Accuracy: 9540/9950 (95.8794%)
Scaling by  100
Scaled Norm after poisoning: 149.5136320603409, distance: 104.38748521883502
Total norm for 6 adversaries is: 149.5136320603409. distance: 104.38748521883502
___Test Local_ResNet_18 poisoned: True, epoch: 81: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0684, Accuracy: 226/1154 (19.5841%)
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0274, Accuracy: 491/1154 (42.5477%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.0175, Accuracy: 66/10000 (0.6600%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0575, Accuracy: 167/774 (21.5762%)
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0302, Accuracy: 396/774 (51.1628%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.1361, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0734, Accuracy: 129/813 (15.8672%)
___Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0192, Accuracy: 460/813 (56.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 12.2132, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   1, Avg loss: 0.0702, Accuracy: 156/1013 (15.3998%)
___Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   2, Avg loss: 0.0263, Accuracy: 526/1013 (51.9250%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.7171, Accuracy: 86/10000 (0.8600%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0627, Accuracy: 234/1130 (20.7080%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0274, Accuracy: 577/1130 (51.0619%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.8991, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   1, Avg loss: 0.0639, Accuracy: 308/1581 (19.4813%)
___Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   2, Avg loss: 0.0318, Accuracy: 684/1581 (43.2638%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.6426, Accuracy: 105/10000 (1.0500%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1624, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1509, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 6.0683, Accuracy: 81/10000 (0.8100%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   1, Avg loss: 0.0647, Accuracy: 292/1657 (17.6222%)
___Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   2, Avg loss: 0.0328, Accuracy: 578/1657 (34.8823%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.7540, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   1, Avg loss: 0.0701, Accuracy: 200/1049 (19.0658%)
___Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   2, Avg loss: 0.0269, Accuracy: 564/1049 (53.7655%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.2663, Accuracy: 140/10000 (1.4000%)
time spent on training: 396.0881173610687
___Test Target_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.3407, Accuracy: 92/10000 (0.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Avg loss: 0.6003, Accuracy: 8262/9950 (83.0352%)
saving model
Done in 814.3567838668823 sec.
Server Epoch:82 choose agents : [23, 74, 72, 38, 79, 44, 28, 77, 55, 70].
___Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   1, Avg loss: 0.0968, Accuracy: 87/715 (12.1678%)
___Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   2, Avg loss: 0.0472, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.3326, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0488, Accuracy: 457/1552 (29.4459%)
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0185, Accuracy: 887/1552 (57.1521%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 10.8478, Accuracy: 98/10000 (0.9800%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0715, Accuracy: 188/1241 (15.1491%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0349, Accuracy: 485/1241 (39.0814%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.8822, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   1, Avg loss: 0.0796, Accuracy: 183/1131 (16.1804%)
___Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 519/1131 (45.8886%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.3242, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1648, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.1281, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 6.3586, Accuracy: 98/10000 (0.9800%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0656, Accuracy: 334/1750 (19.0857%)
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0329, Accuracy: 767/1750 (43.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.5715, Accuracy: 139/10000 (1.3900%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0645, Accuracy: 306/1581 (19.3548%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0321, Accuracy: 646/1581 (40.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.6685, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   1, Avg loss: 0.0693, Accuracy: 215/1340 (16.0448%)
___Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   2, Avg loss: 0.0263, Accuracy: 620/1340 (46.2687%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 9.0599, Accuracy: 98/10000 (0.9800%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   1, Avg loss: 0.0657, Accuracy: 211/1071 (19.7012%)
___Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   2, Avg loss: 0.0277, Accuracy: 560/1071 (52.2876%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 9.1015, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   1, Avg loss: 0.0718, Accuracy: 280/1418 (19.7461%)
___Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   2, Avg loss: 0.0296, Accuracy: 724/1418 (51.0578%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.2124, Accuracy: 105/10000 (1.0500%)
time spent on training: 316.96742391586304
___Test Target_ResNet_18 poisoned: False, epoch: 82: Avg loss: 6.9773, Accuracy: 92/10000 (0.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Avg loss: 1.2564, Accuracy: 6371/9950 (64.0302%)
saving model
Done in 730.9925699234009 sec.
Server Epoch:83 choose agents : [95, 76, 60, 48, 18, 10, 90, 78, 15, 89].
poison local model 95 index 31 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   1, Average loss: 0.0391, Accuracy: 369/599 (61.6027%), train_poison_data_count: 383
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   2, Average loss: 0.0148, Accuracy: 496/599 (82.8047%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   3, Average loss: 0.0099, Accuracy: 543/599 (90.6511%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   4, Average loss: 0.0125, Accuracy: 533/599 (88.9816%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   5, Average loss: 0.0097, Accuracy: 548/599 (91.4858%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   6, Average loss: 0.0095, Accuracy: 550/599 (91.8197%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   7, Average loss: 0.0090, Accuracy: 546/599 (91.1519%), train_poison_data_count: 383
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   8, Average loss: 0.0094, Accuracy: 544/599 (90.8180%), train_poison_data_count: 383
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   9, Average loss: 0.0107, Accuracy: 535/599 (89.3155%), train_poison_data_count: 383
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch  10, Average loss: 0.0076, Accuracy: 554/599 (92.4875%), train_poison_data_count: 383
Global model norm: 111.38022136329906.
Norm before scaling: 111.37016421179642. Distance: 0.6151323506366282
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.2197, Accuracy: 49/10000 (0.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 83: Avg loss: 0.1670, Accuracy: 9485/9950 (95.3266%)
Scaling by  100
Scaled Norm after poisoning: 126.20409515072203, distance: 61.51323774577916
Total norm for 7 adversaries is: 126.20409515072203. distance: 61.51323774577916
___Test Local_ResNet_18 poisoned: True, epoch: 83: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   1, Avg loss: 0.1089, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   2, Avg loss: 0.0504, Accuracy: 150/466 (32.1888%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.4272, Accuracy: 54/10000 (0.5400%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   1, Avg loss: 0.0518, Accuracy: 666/2227 (29.9057%)
___Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   2, Avg loss: 0.0257, Accuracy: 1116/2227 (50.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.1394, Accuracy: 135/10000 (1.3500%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   1, Avg loss: 0.0925, Accuracy: 10/631 (1.5848%)
___Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   2, Avg loss: 0.0436, Accuracy: 268/631 (42.4723%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.3342, Accuracy: 86/10000 (0.8600%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.1008, Accuracy: 3/530 (0.5660%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0405, Accuracy: 269/530 (50.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.5814, Accuracy: 68/10000 (0.6800%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   1, Avg loss: 0.0746, Accuracy: 112/861 (13.0081%)
___Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   2, Avg loss: 0.0193, Accuracy: 501/861 (58.1882%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 9.9709, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   1, Avg loss: 0.0805, Accuracy: 112/677 (16.5436%)
___Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   2, Avg loss: 0.0252, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.5730, Accuracy: 69/10000 (0.6900%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0948, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0440, Accuracy: 178/416 (42.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.2875, Accuracy: 79/10000 (0.7900%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   1, Avg loss: 0.0703, Accuracy: 218/1154 (18.8908%)
___Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   2, Avg loss: 0.0267, Accuracy: 572/1154 (49.5667%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.8851, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   1, Avg loss: 0.0800, Accuracy: 171/896 (19.0848%)
___Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   2, Avg loss: 0.0355, Accuracy: 488/896 (54.4643%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.9048, Accuracy: 65/10000 (0.6500%)
time spent on training: 349.9773144721985
___Test Target_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.0913, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Avg loss: 0.3248, Accuracy: 8385/9950 (84.2714%)
saving model
Done in 765.8366589546204 sec.
Server Epoch:84 choose agents : [61, 28, 35, 75, 74, 90, 55, 80, 23, 88].
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.2025, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1763, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.1202, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0652, Accuracy: 305/1581 (19.2916%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0316, Accuracy: 663/1581 (41.9355%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.7275, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.1326, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0674, Accuracy: 32/271 (11.8081%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 6.4944, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   1, Avg loss: 0.0906, Accuracy: 100/776 (12.8866%)
___Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   2, Avg loss: 0.0314, Accuracy: 431/776 (55.5412%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.1210, Accuracy: 94/10000 (0.9400%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   1, Avg loss: 0.0494, Accuracy: 478/1552 (30.7990%)
___Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   2, Avg loss: 0.0185, Accuracy: 909/1552 (58.5696%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 10.5556, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   1, Avg loss: 0.0861, Accuracy: 114/677 (16.8390%)
___Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   2, Avg loss: 0.0246, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 10.2835, Accuracy: 63/10000 (0.6300%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0661, Accuracy: 230/1071 (21.4753%)
___Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0267, Accuracy: 564/1071 (52.6611%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.7518, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.0965, Accuracy: 39/682 (5.7185%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0398, Accuracy: 249/682 (36.5103%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.8353, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   1, Avg loss: 0.0966, Accuracy: 104/715 (14.5455%)
___Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   2, Avg loss: 0.0446, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.3808, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.1002, Accuracy: 19/603 (3.1509%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.3964, Accuracy: 56/10000 (0.5600%)
time spent on training: 249.64339780807495
___Test Target_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.4807, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Avg loss: 0.8498, Accuracy: 6234/9950 (62.6533%)
saving model
Done in 660.7879338264465 sec.
Server Epoch:85 choose agents : [36, 56, 25, 90, 31, 70, 30, 21, 46, 64].
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   1, Avg loss: 0.1113, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   2, Avg loss: 0.0541, Accuracy: 111/408 (27.2059%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.8716, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   1, Avg loss: 0.1322, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   2, Avg loss: 0.1023, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.1860, Accuracy: 51/10000 (0.5100%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   1, Avg loss: 0.0812, Accuracy: 118/690 (17.1014%)
___Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.0351, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   1, Avg loss: 0.0789, Accuracy: 131/677 (19.3501%)
___Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   2, Avg loss: 0.0242, Accuracy: 460/677 (67.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 10.1590, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.1019, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0371, Accuracy: 164/460 (35.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.7684, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   1, Avg loss: 0.0681, Accuracy: 340/1418 (23.9774%)
___Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   2, Avg loss: 0.0296, Accuracy: 705/1418 (49.7179%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.0914, Accuracy: 109/10000 (1.0900%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0987, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0388, Accuracy: 190/486 (39.0947%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.7802, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   1, Avg loss: 0.0611, Accuracy: 359/1949 (18.4197%)
___Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   2, Avg loss: 0.0322, Accuracy: 714/1949 (36.6342%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.1765, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   1, Avg loss: 0.0646, Accuracy: 419/1904 (22.0063%)
___Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   2, Avg loss: 0.0294, Accuracy: 789/1904 (41.4391%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.8479, Accuracy: 157/10000 (1.5700%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0820, Accuracy: 105/953 (11.0178%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0403, Accuracy: 351/953 (36.8311%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.5637, Accuracy: 85/10000 (0.8500%)
time spent on training: 264.4972229003906
___Test Target_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.9864, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Avg loss: 1.1234, Accuracy: 5719/9950 (57.4774%)
saving model
Done in 672.7270121574402 sec.
Server Epoch:86 choose agents : [94, 50, 2, 53, 86, 67, 12, 69, 24, 81].
___Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   1, Avg loss: 0.0669, Accuracy: 305/1662 (18.3514%)
___Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   2, Avg loss: 0.0315, Accuracy: 732/1662 (44.0433%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.9426, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   1, Avg loss: 0.0775, Accuracy: 79/809 (9.7651%)
___Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   2, Avg loss: 0.0254, Accuracy: 381/809 (47.0952%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.0737, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0919, Accuracy: 33/605 (5.4545%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0447, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.4624, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   1, Avg loss: 0.0680, Accuracy: 142/813 (17.4662%)
___Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   2, Avg loss: 0.0196, Accuracy: 475/813 (58.4256%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 12.0409, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   1, Avg loss: 0.0717, Accuracy: 196/1003 (19.5414%)
___Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   2, Avg loss: 0.0351, Accuracy: 426/1003 (42.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.5599, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   1, Avg loss: 0.0954, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   2, Avg loss: 0.0475, Accuracy: 156/426 (36.6197%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.8018, Accuracy: 50/10000 (0.5000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   1, Avg loss: 0.1103, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   2, Avg loss: 0.0536, Accuracy: 87/338 (25.7396%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.4628, Accuracy: 76/10000 (0.7600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   1, Avg loss: 0.0747, Accuracy: 110/590 (18.6441%)
___Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   2, Avg loss: 0.0327, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 11.1172, Accuracy: 50/10000 (0.5000%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.1007, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0503, Accuracy: 78/312 (25.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.4649, Accuracy: 59/10000 (0.5900%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0625, Accuracy: 143/774 (18.4755%)
___Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0313, Accuracy: 379/774 (48.9664%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.2203, Accuracy: 81/10000 (0.8100%)
time spent on training: 256.09292483329773
___Test Target_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.6135, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Avg loss: 1.2732, Accuracy: 5587/9950 (56.1508%)
saving model
Done in 666.636706829071 sec.
Server Epoch:87 choose agents : [39, 80, 90, 83, 43, 57, 67, 2, 23, 36].
___Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   1, Avg loss: 0.0676, Accuracy: 166/1013 (16.3870%)
___Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   2, Avg loss: 0.0255, Accuracy: 537/1013 (53.0109%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.0771, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   1, Avg loss: 0.0803, Accuracy: 62/682 (9.0909%)
___Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 256/682 (37.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.7928, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   1, Avg loss: 0.0690, Accuracy: 152/677 (22.4520%)
___Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   2, Avg loss: 0.0240, Accuracy: 463/677 (68.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 10.0353, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   1, Avg loss: 0.0593, Accuracy: 374/1953 (19.1500%)
___Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   2, Avg loss: 0.0314, Accuracy: 918/1953 (47.0046%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.4595, Accuracy: 158/10000 (1.5800%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0752, Accuracy: 157/946 (16.5962%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0377, Accuracy: 363/946 (38.3721%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.3705, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0667, Accuracy: 186/1154 (16.1179%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0260, Accuracy: 534/1154 (46.2738%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 10.6406, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   1, Avg loss: 0.0898, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   2, Avg loss: 0.0458, Accuracy: 160/426 (37.5587%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.7757, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   1, Avg loss: 0.0884, Accuracy: 43/605 (7.1074%)
___Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   2, Avg loss: 0.0416, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.1832, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0819, Accuracy: 133/715 (18.6014%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0420, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.7537, Accuracy: 55/10000 (0.5500%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   1, Avg loss: 0.0978, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   2, Avg loss: 0.0536, Accuracy: 115/408 (28.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.7632, Accuracy: 54/10000 (0.5400%)
time spent on training: 257.5908901691437
___Test Target_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.3124, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Avg loss: 1.4001, Accuracy: 5540/9950 (55.6784%)
saving model
Done in 669.8422765731812 sec.
Server Epoch:88 choose agents : [4, 42, 28, 74, 13, 49, 24, 34, 87, 86].
___Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   1, Avg loss: 0.0732, Accuracy: 195/901 (21.6426%)
___Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   2, Avg loss: 0.0352, Accuracy: 437/901 (48.5017%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.1414, Accuracy: 78/10000 (0.7800%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   1, Avg loss: 0.0609, Accuracy: 249/1372 (18.1487%)
___Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   2, Avg loss: 0.0296, Accuracy: 606/1372 (44.1691%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.4656, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0567, Accuracy: 330/1581 (20.8729%)
___Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0311, Accuracy: 686/1581 (43.3903%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.7882, Accuracy: 103/10000 (1.0300%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   1, Avg loss: 0.0408, Accuracy: 528/1552 (34.0206%)
___Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   2, Avg loss: 0.0178, Accuracy: 917/1552 (59.0851%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 10.5443, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   1, Avg loss: 0.0626, Accuracy: 269/1645 (16.3526%)
___Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   2, Avg loss: 0.0308, Accuracy: 726/1645 (44.1337%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.0982, Accuracy: 128/10000 (1.2800%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   1, Avg loss: 0.0874, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   2, Avg loss: 0.0489, Accuracy: 114/440 (25.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 6.4574, Accuracy: 62/10000 (0.6200%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   1, Avg loss: 0.0899, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   2, Avg loss: 0.0463, Accuracy: 113/312 (36.2179%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 6.4524, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0624, Accuracy: 302/1427 (21.1633%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0318, Accuracy: 627/1427 (43.9383%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.5429, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   1, Avg loss: 0.0665, Accuracy: 208/1131 (18.3908%)
___Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 444/1131 (39.2573%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.1821, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0670, Accuracy: 212/1003 (21.1366%)
___Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0355, Accuracy: 397/1003 (39.5813%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.5463, Accuracy: 68/10000 (0.6800%)
time spent on training: 333.2450873851776
___Test Target_ResNet_18 poisoned: False, epoch: 88: Avg loss: 6.0822, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Avg loss: 1.4797, Accuracy: 5589/9950 (56.1709%)
saving model
Done in 744.725578546524 sec.
Server Epoch:89 choose agents : [84, 89, 29, 52, 37, 30, 66, 62, 88, 42].
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0516, Accuracy: 273/1190 (22.9412%)
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0271, Accuracy: 575/1190 (48.3193%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.0496, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0698, Accuracy: 198/896 (22.0982%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0346, Accuracy: 462/896 (51.5625%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.1864, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   1, Avg loss: 0.0576, Accuracy: 346/1440 (24.0278%)
___Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   2, Avg loss: 0.0267, Accuracy: 781/1440 (54.2361%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.6716, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   1, Avg loss: 0.0688, Accuracy: 135/636 (21.2264%)
___Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   2, Avg loss: 0.0318, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.1120, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   1, Avg loss: 0.0532, Accuracy: 356/1129 (31.5323%)
___Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   2, Avg loss: 0.0222, Accuracy: 765/1129 (67.7591%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.0010, Accuracy: 119/10000 (1.1900%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   1, Avg loss: 0.0818, Accuracy: 6/486 (1.2346%)
___Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   2, Avg loss: 0.0378, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.8374, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0701, Accuracy: 205/1402 (14.6220%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0379, Accuracy: 463/1402 (33.0243%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.5323, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   1, Avg loss: 0.0736, Accuracy: 36/568 (6.3380%)
___Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   2, Avg loss: 0.0383, Accuracy: 266/568 (46.8310%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.5532, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   1, Avg loss: 0.0781, Accuracy: 43/603 (7.1310%)
___Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   2, Avg loss: 0.0434, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.4105, Accuracy: 66/10000 (0.6600%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0592, Accuracy: 271/1372 (19.7522%)
___Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0291, Accuracy: 626/1372 (45.6268%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.3349, Accuracy: 92/10000 (0.9200%)
time spent on training: 302.3857295513153
___Test Target_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.9262, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Avg loss: 1.5417, Accuracy: 5670/9950 (56.9849%)
saving model
Done in 711.9406235218048 sec.
Server Epoch:90 choose agents : [43, 80, 99, 44, 67, 39, 70, 50, 86, 91].
___Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   1, Avg loss: 0.0713, Accuracy: 167/946 (17.6533%)
___Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 392/946 (41.4376%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.0763, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   1, Avg loss: 0.0728, Accuracy: 80/682 (11.7302%)
___Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 262/682 (38.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.8332, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   1, Avg loss: 0.0742, Accuracy: 121/773 (15.6533%)
___Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   2, Avg loss: 0.0299, Accuracy: 430/773 (55.6274%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.2856, Accuracy: 75/10000 (0.7500%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   1, Avg loss: 0.0566, Accuracy: 404/1750 (23.0857%)
___Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   2, Avg loss: 0.0327, Accuracy: 766/1750 (43.7714%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.6709, Accuracy: 136/10000 (1.3600%)
___Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   1, Avg loss: 0.0800, Accuracy: 10/426 (2.3474%)
___Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   2, Avg loss: 0.0444, Accuracy: 169/426 (39.6714%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 6.7655, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0624, Accuracy: 175/1013 (17.2754%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0250, Accuracy: 529/1013 (52.2211%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.9886, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0592, Accuracy: 362/1418 (25.5289%)
___Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0290, Accuracy: 736/1418 (51.9041%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.0411, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   1, Avg loss: 0.0686, Accuracy: 89/809 (11.0012%)
___Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   2, Avg loss: 0.0249, Accuracy: 413/809 (51.0507%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.0741, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   1, Avg loss: 0.0637, Accuracy: 224/1003 (22.3330%)
___Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   2, Avg loss: 0.0346, Accuracy: 400/1003 (39.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.5714, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   1, Avg loss: 0.0555, Accuracy: 278/1030 (26.9903%)
___Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   2, Avg loss: 0.0265, Accuracy: 667/1030 (64.7573%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.5255, Accuracy: 104/10000 (1.0400%)
time spent on training: 294.3360035419464
___Test Target_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.8073, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Avg loss: 1.6063, Accuracy: 5756/9950 (57.8492%)
saving model
Done in 698.5838913917542 sec.
Server Epoch:91 choose agents : [33, 37, 28, 92, 97, 43, 56, 44, 24, 64].
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0877, Accuracy: 5/515 (0.9709%)
___Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0538, Accuracy: 158/515 (30.6796%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.8031, Accuracy: 83/10000 (0.8300%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   1, Avg loss: 0.0497, Accuracy: 401/1129 (35.5182%)
___Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   2, Avg loss: 0.0224, Accuracy: 774/1129 (68.5562%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 9.0965, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   1, Avg loss: 0.0552, Accuracy: 329/1581 (20.8096%)
___Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   2, Avg loss: 0.0311, Accuracy: 688/1581 (43.5168%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.7006, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   1, Avg loss: 0.0563, Accuracy: 386/1715 (22.5073%)
___Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   2, Avg loss: 0.0285, Accuracy: 819/1715 (47.7551%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.2551, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   1, Avg loss: 0.0612, Accuracy: 234/1213 (19.2910%)
___Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   2, Avg loss: 0.0268, Accuracy: 602/1213 (49.6290%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.8906, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0695, Accuracy: 170/946 (17.9704%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 374/946 (39.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.2369, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   1, Avg loss: 0.0995, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   2, Avg loss: 0.0838, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.6409, Accuracy: 62/10000 (0.6200%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   1, Avg loss: 0.0566, Accuracy: 393/1750 (22.4571%)
___Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   2, Avg loss: 0.0322, Accuracy: 766/1750 (43.7714%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.4114, Accuracy: 147/10000 (1.4700%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0812, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0442, Accuracy: 128/312 (41.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.4753, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   1, Avg loss: 0.0706, Accuracy: 102/953 (10.7030%)
___Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   2, Avg loss: 0.0374, Accuracy: 347/953 (36.4113%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.4706, Accuracy: 88/10000 (0.8800%)
time spent on training: 330.06120443344116
___Test Target_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.7259, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Avg loss: 1.6508, Accuracy: 5838/9950 (58.6734%)
saving model
Done in 741.8706955909729 sec.
Server Epoch:92 choose agents : [71, 40, 7, 67, 97, 72, 34, 58, 26, 38].
___Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   1, Avg loss: 0.0612, Accuracy: 148/818 (18.0929%)
___Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   2, Avg loss: 0.0275, Accuracy: 440/818 (53.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.8745, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0583, Accuracy: 338/1573 (21.4876%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0335, Accuracy: 679/1573 (43.1659%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.4917, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   1, Avg loss: 0.0639, Accuracy: 219/891 (24.5791%)
___Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   2, Avg loss: 0.0285, Accuracy: 444/891 (49.8316%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.4850, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0767, Accuracy: 15/426 (3.5211%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0441, Accuracy: 170/426 (39.9061%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 6.8646, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   1, Avg loss: 0.0603, Accuracy: 238/1213 (19.6208%)
___Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   2, Avg loss: 0.0265, Accuracy: 614/1213 (50.6183%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.8410, Accuracy: 86/10000 (0.8600%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   1, Avg loss: 0.0556, Accuracy: 272/1241 (21.9178%)
___Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   2, Avg loss: 0.0337, Accuracy: 512/1241 (41.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.7761, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   1, Avg loss: 0.0587, Accuracy: 327/1427 (22.9152%)
___Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   2, Avg loss: 0.0312, Accuracy: 656/1427 (45.9706%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.6115, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0665, Accuracy: 198/803 (24.6575%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0350, Accuracy: 443/803 (55.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.1706, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   1, Avg loss: 0.0578, Accuracy: 285/1446 (19.7095%)
___Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   2, Avg loss: 0.0331, Accuracy: 572/1446 (39.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.5864, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0649, Accuracy: 227/1131 (20.0707%)
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0291, Accuracy: 546/1131 (48.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.9921, Accuracy: 111/10000 (1.1100%)
time spent on training: 304.10079431533813
___Test Target_ResNet_18 poisoned: False, epoch: 92: Avg loss: 5.6585, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Avg loss: 1.7004, Accuracy: 5954/9950 (59.8392%)
saving model
Done in 707.2418074607849 sec.
Server Epoch:93 choose agents : [62, 58, 59, 51, 15, 43, 3, 13, 79, 53].
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.0693, Accuracy: 54/568 (9.5070%)
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0383, Accuracy: 266/568 (46.8310%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.6598, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   1, Avg loss: 0.0645, Accuracy: 198/803 (24.6575%)
___Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   2, Avg loss: 0.0350, Accuracy: 442/803 (55.0436%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.0952, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0631, Accuracy: 223/1089 (20.4775%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0271, Accuracy: 531/1089 (48.7603%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.8279, Accuracy: 138/10000 (1.3800%)
___Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   1, Avg loss: 0.0635, Accuracy: 229/1049 (21.8303%)
___Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   2, Avg loss: 0.0264, Accuracy: 577/1049 (55.0048%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.3778, Accuracy: 135/10000 (1.3500%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0637, Accuracy: 253/1154 (21.9237%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0263, Accuracy: 548/1154 (47.4870%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.4479, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   1, Avg loss: 0.0677, Accuracy: 180/946 (19.0275%)
___Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 373/946 (39.4292%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.0978, Accuracy: 76/10000 (0.7600%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   1, Avg loss: 0.0709, Accuracy: 69/781 (8.8348%)
___Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   2, Avg loss: 0.0337, Accuracy: 293/781 (37.5160%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.2458, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 314/1645 (19.0881%)
___Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   2, Avg loss: 0.0304, Accuracy: 728/1645 (44.2553%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.0063, Accuracy: 139/10000 (1.3900%)
___Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   1, Avg loss: 0.1190, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   2, Avg loss: 0.0995, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.5475, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   1, Avg loss: 0.0579, Accuracy: 174/813 (21.4022%)
___Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 466/813 (57.3186%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 11.9227, Accuracy: 63/10000 (0.6300%)
time spent on training: 286.1556124687195
___Test Target_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.6070, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Avg loss: 1.7457, Accuracy: 6042/9950 (60.7236%)
saving model
Done in 695.7754139900208 sec.
Server Epoch:94 choose agents : [51, 3, 17, 5, 55, 92, 4, 75, 35, 60].
___Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0618, Accuracy: 232/1049 (22.1163%)
___Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0265, Accuracy: 556/1049 (53.0029%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.3244, Accuracy: 142/10000 (1.4200%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0690, Accuracy: 79/781 (10.1152%)
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0331, Accuracy: 281/781 (35.9795%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.3013, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   1, Avg loss: 0.0555, Accuracy: 389/1574 (24.7141%)
___Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   2, Avg loss: 0.0253, Accuracy: 755/1574 (47.9670%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.3221, Accuracy: 136/10000 (1.3600%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0493, Accuracy: 482/1628 (29.6069%)
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0223, Accuracy: 927/1628 (56.9410%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.8463, Accuracy: 155/10000 (1.5500%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   1, Avg loss: 0.0510, Accuracy: 289/1071 (26.9841%)
___Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   2, Avg loss: 0.0262, Accuracy: 578/1071 (53.9683%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.5917, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   1, Avg loss: 0.0550, Accuracy: 435/1715 (25.3644%)
___Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   2, Avg loss: 0.0281, Accuracy: 801/1715 (46.7055%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.0012, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0693, Accuracy: 214/901 (23.7514%)
___Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0348, Accuracy: 406/901 (45.0610%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.0608, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   1, Avg loss: 0.0688, Accuracy: 140/776 (18.0412%)
___Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   2, Avg loss: 0.0284, Accuracy: 438/776 (56.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.2000, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.0870, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0572, Accuracy: 101/271 (37.2694%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 6.1911, Accuracy: 75/10000 (0.7500%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   1, Avg loss: 0.0453, Accuracy: 742/2227 (33.3184%)
___Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   2, Avg loss: 0.0251, Accuracy: 1142/2227 (51.2797%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.9964, Accuracy: 145/10000 (1.4500%)
time spent on training: 376.13572907447815
___Test Target_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.5612, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Avg loss: 1.7801, Accuracy: 6128/9950 (61.5879%)
saving model
Done in 780.1054377555847 sec.
Server Epoch:95 choose agents : [54, 15, 1, 87, 63, 69, 60, 22, 43, 45].
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   1, Avg loss: 0.0552, Accuracy: 295/1130 (26.1062%)
___Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   2, Avg loss: 0.0265, Accuracy: 562/1130 (49.7345%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.7353, Accuracy: 68/10000 (0.6800%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   1, Avg loss: 0.0583, Accuracy: 266/1154 (23.0503%)
___Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   2, Avg loss: 0.0263, Accuracy: 582/1154 (50.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.9054, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0606, Accuracy: 249/928 (26.8319%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0213, Accuracy: 637/928 (68.6422%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.8154, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   1, Avg loss: 0.0605, Accuracy: 233/1131 (20.6012%)
___Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   2, Avg loss: 0.0304, Accuracy: 481/1131 (42.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.1427, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   1, Avg loss: 0.0649, Accuracy: 159/888 (17.9054%)
___Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 443/888 (49.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.4836, Accuracy: 94/10000 (0.9400%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   1, Avg loss: 0.0599, Accuracy: 187/590 (31.6949%)
___Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   2, Avg loss: 0.0318, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.4257, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   1, Avg loss: 0.0449, Accuracy: 750/2227 (33.6776%)
___Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   2, Avg loss: 0.0251, Accuracy: 1151/2227 (51.6839%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.0266, Accuracy: 139/10000 (1.3900%)
___Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   1, Avg loss: 0.0507, Accuracy: 500/1470 (34.0136%)
___Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   2, Avg loss: 0.0232, Accuracy: 920/1470 (62.5850%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.0237, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   1, Avg loss: 0.0663, Accuracy: 183/946 (19.3446%)
___Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 361/946 (38.1607%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.2624, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   1, Avg loss: 0.0714, Accuracy: 109/669 (16.2930%)
___Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   2, Avg loss: 0.0381, Accuracy: 365/669 (54.5590%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.3542, Accuracy: 88/10000 (0.8800%)
time spent on training: 354.0230803489685
___Test Target_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.5248, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Avg loss: 1.7832, Accuracy: 6325/9950 (63.5678%)
saving model
Done in 756.3369467258453 sec.
Server Epoch:96 choose agents : [12, 11, 52, 2, 65, 23, 68, 97, 82, 9].
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 1/338 (0.2959%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0508, Accuracy: 134/338 (39.6450%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.4037, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0666, Accuracy: 180/712 (25.2809%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0241, Accuracy: 477/712 (66.9944%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.2921, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   1, Avg loss: 0.0627, Accuracy: 177/636 (27.8302%)
___Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   2, Avg loss: 0.0304, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.9101, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0738, Accuracy: 92/605 (15.2066%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0419, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.2831, Accuracy: 64/10000 (0.6400%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   1, Avg loss: 0.0490, Accuracy: 476/1475 (32.2712%)
___Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   2, Avg loss: 0.0286, Accuracy: 801/1475 (54.3051%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.8221, Accuracy: 143/10000 (1.4300%)
___Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   1, Avg loss: 0.0703, Accuracy: 181/715 (25.3147%)
___Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   2, Avg loss: 0.0422, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.6303, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   1, Avg loss: 0.0692, Accuracy: 255/1163 (21.9261%)
___Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   2, Avg loss: 0.0353, Accuracy: 522/1163 (44.8839%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.1646, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   1, Avg loss: 0.0581, Accuracy: 274/1213 (22.5886%)
___Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   2, Avg loss: 0.0265, Accuracy: 600/1213 (49.4641%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.7921, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0774, Accuracy: 36/500 (7.2000%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0482, Accuracy: 187/500 (37.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.9612, Accuracy: 74/10000 (0.7400%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0446, Accuracy: 438/1275 (34.3529%)
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0156, Accuracy: 845/1275 (66.2745%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 10.4183, Accuracy: 133/10000 (1.3300%)
time spent on training: 319.16781187057495
___Test Target_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.4993, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Avg loss: 1.7801, Accuracy: 6501/9950 (65.3367%)
saving model
Done in 734.2216999530792 sec.
Server Epoch:97 choose agents : [80, 34, 72, 81, 41, 77, 71, 35, 7, 4].
___Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   1, Avg loss: 0.0687, Accuracy: 109/682 (15.9824%)
___Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 262/682 (38.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.9073, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 332/1427 (23.2656%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0310, Accuracy: 642/1427 (44.9895%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.5599, Accuracy: 106/10000 (1.0600%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0547, Accuracy: 294/1241 (23.6906%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0341, Accuracy: 497/1241 (40.0483%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.6600, Accuracy: 89/10000 (0.8900%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   1, Avg loss: 0.0560, Accuracy: 212/774 (27.3902%)
___Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   2, Avg loss: 0.0297, Accuracy: 398/774 (51.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.9487, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0686, Accuracy: 199/719 (27.6773%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0338, Accuracy: 465/719 (64.6732%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.0382, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   1, Avg loss: 0.0550, Accuracy: 282/1340 (21.0448%)
___Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   2, Avg loss: 0.0251, Accuracy: 623/1340 (46.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.5973, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   1, Avg loss: 0.0585, Accuracy: 167/818 (20.4156%)
___Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   2, Avg loss: 0.0272, Accuracy: 435/818 (53.1785%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.7406, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0851, Accuracy: 1/271 (0.3690%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0569, Accuracy: 116/271 (42.8044%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 6.2243, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0623, Accuracy: 233/891 (26.1504%)
___Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0275, Accuracy: 461/891 (51.7396%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.3993, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   1, Avg loss: 0.0705, Accuracy: 223/901 (24.7503%)
___Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   2, Avg loss: 0.0321, Accuracy: 437/901 (48.5017%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.5809, Accuracy: 60/10000 (0.6000%)
time spent on training: 308.42097902297974
___Test Target_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.4805, Accuracy: 74/10000 (0.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Avg loss: 1.8111, Accuracy: 6605/9950 (66.3819%)
saving model
Done in 713.5665352344513 sec.
Server Epoch:98 choose agents : [24, 6, 1, 16, 62, 2, 87, 17, 43, 18].
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.0766, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0417, Accuracy: 167/312 (53.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 6.4964, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 406/1956 (20.7566%)
___Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   2, Avg loss: 0.0290, Accuracy: 770/1956 (39.3661%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.0749, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   1, Avg loss: 0.0583, Accuracy: 276/928 (29.7414%)
___Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   2, Avg loss: 0.0217, Accuracy: 637/928 (68.6422%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.8333, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0664, Accuracy: 180/708 (25.4237%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0404, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.6153, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0665, Accuracy: 85/568 (14.9648%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0383, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.6162, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   1, Avg loss: 0.0723, Accuracy: 104/605 (17.1901%)
___Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   2, Avg loss: 0.0422, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.3741, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0592, Accuracy: 250/1131 (22.1043%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0305, Accuracy: 473/1131 (41.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.1565, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   1, Avg loss: 0.0536, Accuracy: 388/1574 (24.6506%)
___Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   2, Avg loss: 0.0248, Accuracy: 787/1574 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.6604, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0650, Accuracy: 195/946 (20.6131%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0354, Accuracy: 347/946 (36.6808%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.3635, Accuracy: 68/10000 (0.6800%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   1, Avg loss: 0.0784, Accuracy: 55/530 (10.3774%)
___Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   2, Avg loss: 0.0365, Accuracy: 276/530 (52.0755%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.3494, Accuracy: 71/10000 (0.7100%)
time spent on training: 313.7324185371399
___Test Target_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.4592, Accuracy: 79/10000 (0.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Avg loss: 1.8338, Accuracy: 6730/9950 (67.6382%)
saving model
Done in 716.2785773277283 sec.
Server Epoch:99 choose agents : [18, 14, 2, 45, 63, 95, 90, 4, 23, 8].
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   1, Avg loss: 0.0758, Accuracy: 64/530 (12.0755%)
___Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   2, Avg loss: 0.0361, Accuracy: 286/530 (53.9623%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.4580, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   1, Avg loss: 0.0680, Accuracy: 151/1013 (14.9062%)
___Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   2, Avg loss: 0.0340, Accuracy: 418/1013 (41.2636%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.0246, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   1, Avg loss: 0.0725, Accuracy: 96/605 (15.8678%)
___Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   2, Avg loss: 0.0399, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.1118, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   1, Avg loss: 0.0701, Accuracy: 134/669 (20.0299%)
___Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   2, Avg loss: 0.0372, Accuracy: 370/669 (55.3064%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.1802, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   1, Avg loss: 0.0622, Accuracy: 174/888 (19.5946%)
___Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 452/888 (50.9009%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.3812, Accuracy: 92/10000 (0.9200%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0369, Accuracy: 439/599 (73.2888%)
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0234, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.3645, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   1, Avg loss: 0.0595, Accuracy: 219/677 (32.3486%)
___Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 457/677 (67.5037%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 10.1358, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   1, Avg loss: 0.0659, Accuracy: 233/901 (25.8602%)
___Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 435/901 (48.2797%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.0496, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0673, Accuracy: 198/715 (27.6923%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0425, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 6.9885, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   1, Avg loss: 0.0627, Accuracy: 276/1513 (18.2419%)
___Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   2, Avg loss: 0.0344, Accuracy: 564/1513 (37.2769%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.6555, Accuracy: 126/10000 (1.2600%)
time spent on training: 291.13766741752625
___Test Target_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.4444, Accuracy: 79/10000 (0.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Avg loss: 1.8496, Accuracy: 6792/9950 (68.2613%)
saving model
Done in 699.6021094322205 sec.
Server Epoch:100 choose agents : [57, 53, 36, 10, 37, 13, 40, 62, 39, 80].
___Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0591, Accuracy: 235/1154 (20.3640%)
___Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0257, Accuracy: 585/1154 (50.6932%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.7066, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0554, Accuracy: 189/813 (23.2472%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 482/813 (59.2866%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 11.9139, Accuracy: 63/10000 (0.6300%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   1, Avg loss: 0.0805, Accuracy: 7/408 (1.7157%)
___Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   2, Avg loss: 0.0472, Accuracy: 156/408 (38.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.7909, Accuracy: 59/10000 (0.5900%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   1, Avg loss: 0.0580, Accuracy: 212/861 (24.6225%)
___Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   2, Avg loss: 0.0174, Accuracy: 555/861 (64.4599%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.8122, Accuracy: 110/10000 (1.1000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0467, Accuracy: 469/1129 (41.5412%)
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0217, Accuracy: 777/1129 (68.8220%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.8142, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   1, Avg loss: 0.0566, Accuracy: 323/1645 (19.6353%)
___Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   2, Avg loss: 0.0299, Accuracy: 755/1645 (45.8967%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.9410, Accuracy: 146/10000 (1.4600%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0563, Accuracy: 358/1573 (22.7591%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0330, Accuracy: 667/1573 (42.4031%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.4775, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   1, Avg loss: 0.0658, Accuracy: 92/568 (16.1972%)
___Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   2, Avg loss: 0.0380, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.5189, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0581, Accuracy: 222/1013 (21.9151%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0247, Accuracy: 544/1013 (53.7019%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.6890, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   1, Avg loss: 0.0674, Accuracy: 122/682 (17.8886%)
___Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   2, Avg loss: 0.0372, Accuracy: 249/682 (36.5103%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.8969, Accuracy: 68/10000 (0.6800%)
time spent on training: 348.5494019985199
___Test Target_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.4274, Accuracy: 83/10000 (0.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Avg loss: 1.8747, Accuracy: 6916/9950 (69.5075%)
saving model
Done in 748.4653203487396 sec.
Saving all the graphs.
This run has a label: Jun.15_17.07.44. Visdom environment: tiny
