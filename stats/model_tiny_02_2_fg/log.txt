current path: saved_models/model_tiny_Jun.17_08.06.26
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [84, 86, 65, 96, 55, 56, 28, 93, 16, 79].
___Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 316/1190 (26.5546%)
___Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 470/1190 (39.4958%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.9942, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 86, internal_epoch   1, Avg loss: 0.0629, Accuracy: 355/1003 (35.3938%)
___Train Local_ResNet_18, epoch   1, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 362/1003 (36.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.5506, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0564, Accuracy: 377/1475 (25.5593%)
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 670/1475 (45.4237%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.2483, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch   1, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 49/311 (15.7556%)
___Train Local_ResNet_18, epoch   1, local model 96, internal_epoch   2, Avg loss: 0.0542, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3429, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0574, Accuracy: 225/1071 (21.0084%)
___Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 497/1071 (46.4052%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.9996, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   1, Avg loss: 0.0836, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   2, Avg loss: 0.0680, Accuracy: 63/186 (33.8710%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3125, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 412/1581 (26.0595%)
___Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 582/1581 (36.8121%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.5291, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch   1, local model 93, internal_epoch   1, Avg loss: 0.0558, Accuracy: 388/1742 (22.2732%)
___Train Local_ResNet_18, epoch   1, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 689/1742 (39.5522%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.7144, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   1, Avg loss: 0.0660, Accuracy: 275/708 (38.8418%)
___Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   2, Avg loss: 0.0364, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.7926, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   1, local model 79, internal_epoch   1, Avg loss: 0.1018, Accuracy: 16/197 (8.1218%)
___Train Local_ResNet_18, epoch   1, local model 79, internal_epoch   2, Avg loss: 0.0834, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3232, Accuracy: 50/10000 (0.5000%)
time spent on training: 80.8497850894928
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 1003, 1475, 311, 1071, 186, 1581, 1742, 708, 197]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3169, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 1: Avg loss: 5.6218, Accuracy: 0/9950 (0.0000%)
saving model
Done in 148.3119921684265 sec.
Server Epoch:2 choose agents : [65, 48, 44, 24, 25, 99, 85, 29, 7, 20].
___Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   1, Avg loss: 0.0565, Accuracy: 387/1475 (26.2373%)
___Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 640/1475 (43.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.9360, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   1, Avg loss: 0.0715, Accuracy: 92/631 (14.5800%)
___Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   2, Avg loss: 0.0416, Accuracy: 217/631 (34.3899%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.8344, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   1, Avg loss: 0.0597, Accuracy: 423/1750 (24.1714%)
___Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 651/1750 (37.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.6374, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 28/312 (8.9744%)
___Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0404, Accuracy: 165/312 (52.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3833, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 301/690 (43.6232%)
___Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0290, Accuracy: 460/690 (66.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.2565, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0665, Accuracy: 172/773 (22.2510%)
___Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0345, Accuracy: 376/773 (48.6417%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.9009, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 432/1988 (21.7304%)
___Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 632/1988 (31.7907%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 8.2368, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 434/1440 (30.1389%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 672/1440 (46.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.7605, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 343/891 (38.4961%)
___Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0252, Accuracy: 462/891 (51.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.9832, Accuracy: 53/10000 (0.5300%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 350/807 (43.3705%)
___Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   2, Avg loss: 0.0333, Accuracy: 398/807 (49.3185%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.7158, Accuracy: 50/10000 (0.5000%)
time spent on training: 106.8888418674469
[foolsgold agg] training data poison_ratio: 0.07502091661243841  data num: [1475, 631, 1750, 312, 690, 773, 1988, 1440, 891, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.023444036441387005
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3168, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 2: Avg loss: 5.6208, Accuracy: 0/9950 (0.0000%)
saving model
Done in 180.56132864952087 sec.
Server Epoch:3 choose agents : [76, 59, 8, 85, 95, 14, 4, 70, 94, 11].
___Train Local_ResNet_18, epoch   3, local model 76, internal_epoch   1, Avg loss: 0.0869, Accuracy: 36/466 (7.7253%)
___Train Local_ResNet_18, epoch   3, local model 76, internal_epoch   2, Avg loss: 0.0495, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.6141, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   1, Avg loss: 0.0539, Accuracy: 278/1089 (25.5280%)
___Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   2, Avg loss: 0.0289, Accuracy: 434/1089 (39.8531%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.2360, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0608, Accuracy: 213/1513 (14.0780%)
___Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0370, Accuracy: 471/1513 (31.1302%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.5714, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch   3, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 449/1988 (22.5855%)
___Train Local_ResNet_18, epoch   3, local model 85, internal_epoch   2, Avg loss: 0.0350, Accuracy: 695/1988 (34.9598%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.0517, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   3, local model 95, internal_epoch   1, Avg loss: 0.0526, Accuracy: 320/599 (53.4224%)
___Train Local_ResNet_18, epoch   3, local model 95, internal_epoch   2, Avg loss: 0.0282, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.7439, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   1, Avg loss: 0.0627, Accuracy: 226/1013 (22.3100%)
___Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 303/1013 (29.9112%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.4911, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0607, Accuracy: 325/901 (36.0710%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0355, Accuracy: 404/901 (44.8391%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.6712, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 332/1418 (23.4133%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 613/1418 (43.2299%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.4080, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 330/1662 (19.8556%)
___Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0336, Accuracy: 602/1662 (36.2214%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.6968, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   1, Avg loss: 0.0546, Accuracy: 339/712 (47.6124%)
___Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 416/712 (58.4270%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.4038, Accuracy: 50/10000 (0.5000%)
time spent on training: 103.75653147697449
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 1089, 1513, 1988, 599, 1013, 901, 1418, 1662, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3166, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 3: Avg loss: 5.6207, Accuracy: 0/9950 (0.0000%)
saving model
Done in 173.31497812271118 sec.
Server Epoch:4 choose agents : [21, 65, 32, 76, 7, 24, 41, 52, 13, 64].
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 407/1949 (20.8825%)
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 642/1949 (32.9400%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.1953, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   1, Avg loss: 0.0561, Accuracy: 379/1475 (25.6949%)
___Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   2, Avg loss: 0.0324, Accuracy: 636/1475 (43.1186%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.9770, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   1, Avg loss: 0.0616, Accuracy: 194/735 (26.3946%)
___Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 340/735 (46.2585%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.7358, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0861, Accuracy: 42/466 (9.0129%)
___Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0497, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.6530, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 351/891 (39.3939%)
___Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 444/891 (49.8316%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.2821, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0772, Accuracy: 27/312 (8.6538%)
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0421, Accuracy: 159/312 (50.9615%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3889, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   1, Avg loss: 0.0577, Accuracy: 329/719 (45.7580%)
___Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   2, Avg loss: 0.0329, Accuracy: 465/719 (64.6732%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.2658, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   1, Avg loss: 0.0567, Accuracy: 276/636 (43.3962%)
___Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   2, Avg loss: 0.0315, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.1249, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 315/1645 (19.1489%)
___Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 587/1645 (35.6839%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.8073, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 174/953 (18.2581%)
___Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0388, Accuracy: 305/953 (32.0042%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.3964, Accuracy: 59/10000 (0.5900%)
time spent on training: 105.89662384986877
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 1475, 735, 466, 891, 312, 719, 636, 1645, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3164, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 4: Avg loss: 5.6131, Accuracy: 0/9950 (0.0000%)
saving model
Done in 176.53917598724365 sec.
Server Epoch:5 choose agents : [62, 97, 55, 2, 52, 21, 47, 93, 91, 83].
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0698, Accuracy: 130/568 (22.8873%)
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0410, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.8008, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0527, Accuracy: 349/1213 (28.7716%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 485/1213 (39.9835%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.5321, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 239/1071 (22.3156%)
___Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 502/1071 (46.8721%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.5044, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 229/605 (37.8512%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0398, Accuracy: 322/605 (53.2231%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.7752, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 279/636 (43.8679%)
___Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   2, Avg loss: 0.0321, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.4558, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   1, Avg loss: 0.0540, Accuracy: 378/1949 (19.3946%)
___Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   2, Avg loss: 0.0335, Accuracy: 613/1949 (31.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.2305, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   1, Avg loss: 0.1250, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   2, Avg loss: 0.1090, Accuracy: 16/134 (11.9403%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 424/1742 (24.3398%)
___Train Local_ResNet_18, epoch   5, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 734/1742 (42.1355%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.6805, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0526, Accuracy: 328/1030 (31.8447%)
___Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0272, Accuracy: 576/1030 (55.9223%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.2879, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch   5, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 425/1953 (21.7614%)
___Train Local_ResNet_18, epoch   5, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 769/1953 (39.3753%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.6017, Accuracy: 126/10000 (1.2600%)
time spent on training: 113.56750750541687
[foolsgold agg] training data poison_ratio: 0.0  data num: [568, 1213, 1071, 605, 636, 1949, 134, 1742, 1030, 1953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.64099901 1.         1.
 0.64099901 1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3163, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 5: Avg loss: 5.6128, Accuracy: 0/9950 (0.0000%)
saving model
Done in 184.8203501701355 sec.
Server Epoch:6 choose agents : [42, 85, 94, 95, 56, 86, 53, 33, 44, 96].
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 344/1372 (25.0729%)
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 469/1372 (34.1837%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.0618, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 453/1988 (22.7867%)
___Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0357, Accuracy: 657/1988 (33.0483%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.9773, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 332/1662 (19.9759%)
___Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 570/1662 (34.2960%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.8449, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0525, Accuracy: 329/599 (54.9249%)
___Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0294, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.5715, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 64/186 (34.4086%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3120, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   1, Avg loss: 0.0615, Accuracy: 354/1003 (35.2941%)
___Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 425/1003 (42.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.3973, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   1, Avg loss: 0.0499, Accuracy: 281/813 (34.5633%)
___Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 459/813 (56.4576%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 9.2376, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   1, Avg loss: 0.0774, Accuracy: 64/515 (12.4272%)
___Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   2, Avg loss: 0.0525, Accuracy: 122/515 (23.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.6528, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0597, Accuracy: 372/1750 (21.2571%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 653/1750 (37.3143%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.7164, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 47/311 (15.1125%)
___Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   2, Avg loss: 0.0543, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3453, Accuracy: 50/10000 (0.5000%)
time spent on training: 106.5627167224884
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 1988, 1662, 599, 186, 1003, 813, 515, 1750, 311]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3163, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 6: Avg loss: 5.6128, Accuracy: 0/9950 (0.0000%)
saving model
Done in 176.44910264015198 sec.
Server Epoch:7 choose agents : [55, 61, 33, 24, 70, 53, 80, 84, 10, 91].
___Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 243/1071 (22.6891%)
___Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 503/1071 (46.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.9515, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   1, Avg loss: 0.1258, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   2, Avg loss: 0.1160, Accuracy: 4/85 (4.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3045, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   1, Avg loss: 0.0786, Accuracy: 61/515 (11.8447%)
___Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   2, Avg loss: 0.0548, Accuracy: 124/515 (24.0777%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.7473, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 30/312 (9.6154%)
___Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 167/312 (53.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3846, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   1, Avg loss: 0.0567, Accuracy: 350/1418 (24.6827%)
___Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 625/1418 (44.0762%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.9930, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 300/813 (36.9004%)
___Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 455/813 (55.9656%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 9.1241, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   7, local model 80, internal_epoch   1, Avg loss: 0.0709, Accuracy: 139/682 (20.3812%)
___Train Local_ResNet_18, epoch   7, local model 80, internal_epoch   2, Avg loss: 0.0378, Accuracy: 257/682 (37.6833%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.3358, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   7, local model 84, internal_epoch   1, Avg loss: 0.0632, Accuracy: 306/1190 (25.7143%)
___Train Local_ResNet_18, epoch   7, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 453/1190 (38.0672%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.7434, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0579, Accuracy: 212/861 (24.6225%)
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 432/861 (50.1742%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.1886, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 91, internal_epoch   1, Avg loss: 0.0528, Accuracy: 317/1030 (30.7767%)
___Train Local_ResNet_18, epoch   7, local model 91, internal_epoch   2, Avg loss: 0.0255, Accuracy: 621/1030 (60.2913%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.8631, Accuracy: 85/10000 (0.8500%)
time spent on training: 108.47678685188293
[foolsgold agg] training data poison_ratio: 0.0  data num: [1071, 85, 515, 312, 1418, 813, 682, 1190, 861, 1030]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3162, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 7: Avg loss: 5.6123, Accuracy: 0/9950 (0.0000%)
saving model
Done in 180.69039154052734 sec.
Server Epoch:8 choose agents : [65, 24, 13, 1, 59, 29, 46, 17, 12, 63].
___Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   1, Avg loss: 0.0560, Accuracy: 348/1475 (23.5932%)
___Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   2, Avg loss: 0.0317, Accuracy: 692/1475 (46.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.0187, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 32/312 (10.2564%)
___Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 166/312 (53.2051%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.3835, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 293/1645 (17.8116%)
___Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 624/1645 (37.9331%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.9639, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0563, Accuracy: 286/928 (30.8190%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 547/928 (58.9440%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.5629, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   1, Avg loss: 0.0525, Accuracy: 294/1089 (26.9972%)
___Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   2, Avg loss: 0.0280, Accuracy: 456/1089 (41.8733%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.4418, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   1, Avg loss: 0.0484, Accuracy: 437/1440 (30.3472%)
___Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 665/1440 (46.1806%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.0921, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   1, Avg loss: 0.0556, Accuracy: 403/1904 (21.1660%)
___Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   2, Avg loss: 0.0320, Accuracy: 687/1904 (36.0819%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.7803, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 401/1574 (25.4765%)
___Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 678/1574 (43.0750%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.4520, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0875, Accuracy: 24/338 (7.1006%)
___Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0475, Accuracy: 152/338 (44.9704%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.4592, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 253/888 (28.4910%)
___Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0261, Accuracy: 445/888 (50.1126%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.9567, Accuracy: 59/10000 (0.5900%)
time spent on training: 108.65603494644165
[foolsgold agg] training data poison_ratio: 0.0  data num: [1475, 312, 1645, 928, 1089, 1440, 1904, 1574, 338, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.3161, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 8: Avg loss: 5.6112, Accuracy: 0/9950 (0.0000%)
saving model
Done in 179.2828710079193 sec.
Server Epoch:9 choose agents : [38, 85, 61, 13, 88, 99, 52, 77, 37, 93].
___Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   1, Avg loss: 0.0618, Accuracy: 245/1131 (21.6622%)
___Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   2, Avg loss: 0.0318, Accuracy: 445/1131 (39.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.1572, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch   9, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 439/1988 (22.0825%)
___Train Local_ResNet_18, epoch   9, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 647/1988 (32.5453%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.6025, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1256, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1175, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3046, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 292/1645 (17.7508%)
___Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 613/1645 (37.2644%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.1282, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch   9, local model 88, internal_epoch   1, Avg loss: 0.0746, Accuracy: 139/603 (23.0514%)
___Train Local_ResNet_18, epoch   9, local model 88, internal_epoch   2, Avg loss: 0.0461, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.9015, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0685, Accuracy: 169/773 (21.8629%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0305, Accuracy: 395/773 (51.0996%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.8890, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   1, Avg loss: 0.0572, Accuracy: 279/636 (43.8679%)
___Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.0229, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 320/1340 (23.8806%)
___Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 542/1340 (40.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.5514, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0527, Accuracy: 412/1129 (36.4925%)
___Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0249, Accuracy: 735/1129 (65.1019%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.4650, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 422/1742 (24.2250%)
___Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 727/1742 (41.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.6517, Accuracy: 83/10000 (0.8300%)
time spent on training: 124.33975958824158
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 1988, 85, 1645, 603, 773, 636, 1340, 1129, 1742]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3159, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 9: Avg loss: 5.6108, Accuracy: 0/9950 (0.0000%)
saving model
Done in 194.71471619606018 sec.
Server Epoch:10 choose agents : [72, 15, 56, 44, 89, 31, 57, 97, 99, 6].
___Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   1, Avg loss: 0.0620, Accuracy: 236/1241 (19.0169%)
___Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 403/1241 (32.4738%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.0219, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   1, Avg loss: 0.0552, Accuracy: 325/1154 (28.1629%)
___Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   2, Avg loss: 0.0281, Accuracy: 490/1154 (42.4610%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.6982, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0833, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 65/186 (34.9462%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3122, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   1, Avg loss: 0.0595, Accuracy: 380/1750 (21.7143%)
___Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 666/1750 (38.0571%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.5154, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  10, local model 89, internal_epoch   1, Avg loss: 0.0609, Accuracy: 325/896 (36.2723%)
___Train Local_ResNet_18, epoch  10, local model 89, internal_epoch   2, Avg loss: 0.0345, Accuracy: 426/896 (47.5446%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.3335, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   1, Avg loss: 0.0830, Accuracy: 54/460 (11.7391%)
___Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   2, Avg loss: 0.0385, Accuracy: 186/460 (40.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.7484, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   1, Avg loss: 0.0543, Accuracy: 294/1154 (25.4766%)
___Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   2, Avg loss: 0.0257, Accuracy: 484/1154 (41.9411%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 9.8142, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  10, local model 97, internal_epoch   1, Avg loss: 0.0520, Accuracy: 364/1213 (30.0082%)
___Train Local_ResNet_18, epoch  10, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 511/1213 (42.1270%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.5192, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   1, Avg loss: 0.0682, Accuracy: 171/773 (22.1216%)
___Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   2, Avg loss: 0.0327, Accuracy: 391/773 (50.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.8720, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0554, Accuracy: 377/1956 (19.2740%)
___Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 637/1956 (32.5665%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.2189, Accuracy: 118/10000 (1.1800%)
time spent on training: 114.64895343780518
[foolsgold agg] training data poison_ratio: 0.0  data num: [1241, 1154, 186, 1750, 896, 460, 1154, 1213, 773, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3158, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 10: Avg loss: 5.6110, Accuracy: 0/9950 (0.0000%)
saving model
Done in 186.80323123931885 sec.
Server Epoch:11 choose agents : [25, 79, 30, 6, 93, 12, 88, 11, 27, 14].
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0567, Accuracy: 309/690 (44.7826%)
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.4030, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  11, local model 79, internal_epoch   1, Avg loss: 0.1016, Accuracy: 16/197 (8.1218%)
___Train Local_ResNet_18, epoch  11, local model 79, internal_epoch   2, Avg loss: 0.0838, Accuracy: 60/197 (30.4569%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.3225, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   1, Avg loss: 0.0813, Accuracy: 63/486 (12.9630%)
___Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.7375, Accuracy: 38/10000 (0.3800%)
___Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0550, Accuracy: 399/1956 (20.3988%)
___Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 657/1956 (33.5890%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.0389, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 401/1742 (23.0195%)
___Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 709/1742 (40.7003%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.7349, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0879, Accuracy: 15/338 (4.4379%)
___Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0489, Accuracy: 144/338 (42.6036%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.4619, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 142/603 (23.5489%)
___Train Local_ResNet_18, epoch  11, local model 88, internal_epoch   2, Avg loss: 0.0456, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.8166, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0566, Accuracy: 345/712 (48.4551%)
___Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0252, Accuracy: 428/712 (60.1124%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.4027, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 435/1587 (27.4102%)
___Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 628/1587 (39.5715%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.2706, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0630, Accuracy: 218/1013 (21.5202%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 313/1013 (30.8983%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.5222, Accuracy: 63/10000 (0.6300%)
time spent on training: 110.32973432540894
[foolsgold agg] training data poison_ratio: 0.0  data num: [690, 197, 486, 1956, 1742, 338, 603, 712, 1587, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.3156, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 11: Avg loss: 5.6103, Accuracy: 0/9950 (0.0000%)
saving model
Done in 180.55158019065857 sec.
Server Epoch:12 choose agents : [37, 81, 94, 32, 34, 87, 63, 99, 22, 14].
___Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   1, Avg loss: 0.0527, Accuracy: 425/1129 (37.6439%)
___Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   2, Avg loss: 0.0248, Accuracy: 726/1129 (64.3047%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.2678, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  12, local model 81, internal_epoch   1, Avg loss: 0.0689, Accuracy: 231/774 (29.8450%)
___Train Local_ResNet_18, epoch  12, local model 81, internal_epoch   2, Avg loss: 0.0366, Accuracy: 291/774 (37.5969%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.0957, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 337/1662 (20.2768%)
___Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 587/1662 (35.3189%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.7988, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0606, Accuracy: 193/735 (26.2585%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 362/735 (49.2517%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.9989, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 382/1427 (26.7694%)
___Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 616/1427 (43.1675%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.9670, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  12, local model 87, internal_epoch   1, Avg loss: 0.0589, Accuracy: 295/1131 (26.0831%)
___Train Local_ResNet_18, epoch  12, local model 87, internal_epoch   2, Avg loss: 0.0322, Accuracy: 384/1131 (33.9523%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.5328, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 259/888 (29.1667%)
___Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 453/888 (51.0135%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.5620, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  12, local model 99, internal_epoch   1, Avg loss: 0.0660, Accuracy: 171/773 (22.1216%)
___Train Local_ResNet_18, epoch  12, local model 99, internal_epoch   2, Avg loss: 0.0305, Accuracy: 383/773 (49.5472%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.0553, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0460, Accuracy: 527/1470 (35.8503%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 805/1470 (54.7619%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.1078, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 224/1013 (22.1125%)
___Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 340/1013 (33.5637%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.6213, Accuracy: 51/10000 (0.5100%)
time spent on training: 121.30195593833923
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 774, 1662, 735, 1427, 1131, 888, 773, 1470, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3155, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 12: Avg loss: 5.6061, Accuracy: 0/9950 (0.0000%)
saving model
Done in 192.05839920043945 sec.
Server Epoch:13 choose agents : [36, 76, 71, 15, 56, 7, 17, 51, 47, 24].
___Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   1, Avg loss: 0.0882, Accuracy: 69/408 (16.9118%)
___Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   2, Avg loss: 0.0565, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.4615, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0861, Accuracy: 38/466 (8.1545%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0487, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.6549, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   1, Avg loss: 0.0646, Accuracy: 166/818 (20.2934%)
___Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   2, Avg loss: 0.0312, Accuracy: 335/818 (40.9535%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.1736, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0553, Accuracy: 335/1154 (29.0295%)
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0317, Accuracy: 457/1154 (39.6014%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.9180, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0833, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0678, Accuracy: 64/186 (34.4086%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3122, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 351/891 (39.3939%)
___Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 430/891 (48.2604%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.0014, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 385/1574 (24.4600%)
___Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 681/1574 (43.2656%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.3623, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 218/1049 (20.7817%)
___Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 496/1049 (47.2831%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.2570, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   1, Avg loss: 0.1245, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   2, Avg loss: 0.1078, Accuracy: 10/134 (7.4627%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3118, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 24/312 (7.6923%)
___Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   2, Avg loss: 0.0407, Accuracy: 167/312 (53.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3831, Accuracy: 50/10000 (0.5000%)
time spent on training: 101.55642127990723
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 466, 818, 1154, 186, 891, 1574, 1049, 134, 312]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3154, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 13: Avg loss: 5.6065, Accuracy: 0/9950 (0.0000%)
saving model
Done in 173.1847608089447 sec.
Server Epoch:14 choose agents : [70, 65, 66, 62, 34, 71, 83, 61, 84, 99].
___Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0568, Accuracy: 336/1418 (23.6953%)
___Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0318, Accuracy: 574/1418 (40.4795%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.0458, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0564, Accuracy: 375/1475 (25.4237%)
___Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0318, Accuracy: 637/1475 (43.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.1788, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 255/1402 (18.1883%)
___Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 361/1402 (25.7489%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.0460, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   1, Avg loss: 0.0692, Accuracy: 136/568 (23.9437%)
___Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   2, Avg loss: 0.0412, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.8037, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   1, Avg loss: 0.0592, Accuracy: 375/1427 (26.2789%)
___Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 576/1427 (40.3644%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.9316, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   1, Avg loss: 0.0648, Accuracy: 147/818 (17.9707%)
___Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 348/818 (42.5428%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.0778, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0549, Accuracy: 411/1953 (21.0445%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 762/1953 (39.0169%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.8992, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1259, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1188, Accuracy: 6/85 (7.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.3040, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 311/1190 (26.1345%)
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 459/1190 (38.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.0834, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  14, local model 99, internal_epoch   1, Avg loss: 0.0647, Accuracy: 187/773 (24.1915%)
___Train Local_ResNet_18, epoch  14, local model 99, internal_epoch   2, Avg loss: 0.0333, Accuracy: 357/773 (46.1837%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.0791, Accuracy: 50/10000 (0.5000%)
time spent on training: 124.27009129524231
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 1475, 1402, 568, 1427, 818, 1953, 85, 1190, 773]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.3153, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 14: Avg loss: 5.6047, Accuracy: 0/9950 (0.0000%)
saving model
Done in 193.51001071929932 sec.
Server Epoch:15 choose agents : [70, 63, 84, 79, 26, 42, 18, 66, 39, 95].
___Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0559, Accuracy: 347/1418 (24.4711%)
___Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 645/1418 (45.4866%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9700, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 265/888 (29.8423%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 442/888 (49.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.3773, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   1, Avg loss: 0.0625, Accuracy: 312/1190 (26.2185%)
___Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 465/1190 (39.0756%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.9458, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  15, local model 79, internal_epoch   1, Avg loss: 0.1001, Accuracy: 12/197 (6.0914%)
___Train Local_ResNet_18, epoch  15, local model 79, internal_epoch   2, Avg loss: 0.0859, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.3234, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 344/1446 (23.7898%)
___Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 505/1446 (34.9239%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.4098, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 349/1372 (25.4373%)
___Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 502/1372 (36.5889%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9802, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0772, Accuracy: 113/530 (21.3208%)
___Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0398, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.9919, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 270/1402 (19.2582%)
___Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   2, Avg loss: 0.0383, Accuracy: 419/1402 (29.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.1246, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0541, Accuracy: 321/1013 (31.6881%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0263, Accuracy: 502/1013 (49.5558%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.5140, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  15, local model 95, internal_epoch   1, Avg loss: 0.0534, Accuracy: 318/599 (53.0885%)
___Train Local_ResNet_18, epoch  15, local model 95, internal_epoch   2, Avg loss: 0.0285, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.4171, Accuracy: 50/10000 (0.5000%)
time spent on training: 121.49621272087097
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 888, 1190, 197, 1446, 1372, 530, 1402, 1013, 599]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.3152, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 15: Avg loss: 5.6049, Accuracy: 0/9950 (0.0000%)
saving model
Done in 194.12609314918518 sec.
Server Epoch:16 choose agents : [24, 22, 71, 66, 80, 6, 64, 96, 59, 33].
___Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   1, Avg loss: 0.0765, Accuracy: 37/312 (11.8590%)
___Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   2, Avg loss: 0.0413, Accuracy: 161/312 (51.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.3883, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 520/1470 (35.3741%)
___Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 845/1470 (57.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1924, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   1, Avg loss: 0.0646, Accuracy: 140/818 (17.1149%)
___Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   2, Avg loss: 0.0309, Accuracy: 348/818 (42.5428%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.9544, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 262/1402 (18.6876%)
___Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 405/1402 (28.8873%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.1320, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  16, local model 80, internal_epoch   1, Avg loss: 0.0711, Accuracy: 140/682 (20.5279%)
___Train Local_ResNet_18, epoch  16, local model 80, internal_epoch   2, Avg loss: 0.0378, Accuracy: 261/682 (38.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.3490, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 407/1956 (20.8078%)
___Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 614/1956 (31.3906%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1125, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 156/953 (16.3694%)
___Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 299/953 (31.3746%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.3898, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 54/311 (17.3633%)
___Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.3474, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   1, Avg loss: 0.0522, Accuracy: 318/1089 (29.2011%)
___Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 470/1089 (43.1589%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.5688, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   1, Avg loss: 0.0788, Accuracy: 58/515 (11.2621%)
___Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   2, Avg loss: 0.0536, Accuracy: 121/515 (23.4951%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.7103, Accuracy: 41/10000 (0.4100%)
time spent on training: 118.31472396850586
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 1470, 818, 1402, 682, 1956, 953, 311, 1089, 515]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.3151, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 16: Avg loss: 5.6031, Accuracy: 0/9950 (0.0000%)
saving model
Done in 189.7557029724121 sec.
Server Epoch:17 choose agents : [36, 29, 28, 81, 55, 63, 33, 23, 5, 43].
___Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   1, Avg loss: 0.0881, Accuracy: 68/408 (16.6667%)
___Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   2, Avg loss: 0.0548, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.4818, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0488, Accuracy: 395/1440 (27.4306%)
___Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 683/1440 (47.4306%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.8812, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 370/1581 (23.4029%)
___Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 603/1581 (38.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.6734, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  17, local model 81, internal_epoch   1, Avg loss: 0.0684, Accuracy: 231/774 (29.8450%)
___Train Local_ResNet_18, epoch  17, local model 81, internal_epoch   2, Avg loss: 0.0380, Accuracy: 272/774 (35.1421%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.1337, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 251/1071 (23.4360%)
___Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 501/1071 (46.7787%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.8275, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 263/888 (29.6171%)
___Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 451/888 (50.7883%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.1678, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0773, Accuracy: 67/515 (13.0097%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0518, Accuracy: 125/515 (24.2718%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.7823, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   1, Avg loss: 0.0577, Accuracy: 325/715 (45.4545%)
___Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   2, Avg loss: 0.0402, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.8474, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0514, Accuracy: 392/1628 (24.0786%)
___Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 787/1628 (48.3415%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.0015, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0630, Accuracy: 293/946 (30.9725%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0368, Accuracy: 323/946 (34.1438%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.0448, Accuracy: 59/10000 (0.5900%)
time spent on training: 124.58216309547424
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 1440, 1581, 774, 1071, 888, 515, 715, 1628, 946]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.3150, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 17: Avg loss: 5.6026, Accuracy: 0/9950 (0.0000%)
saving model
Done in 194.68025827407837 sec.
Server Epoch:18 choose agents : [77, 90, 3, 24, 2, 8, 79, 51, 73, 29].
___Train Local_ResNet_18, epoch  18, local model 77, internal_epoch   1, Avg loss: 0.0547, Accuracy: 333/1340 (24.8507%)
___Train Local_ResNet_18, epoch  18, local model 77, internal_epoch   2, Avg loss: 0.0281, Accuracy: 522/1340 (38.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.6822, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0582, Accuracy: 314/677 (46.3811%)
___Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0240, Accuracy: 440/677 (64.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.8476, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0751, Accuracy: 110/781 (14.0845%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0370, Accuracy: 230/781 (29.4494%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.6614, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0765, Accuracy: 39/312 (12.5000%)
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 169/312 (54.1667%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.3907, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 231/605 (38.1818%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0391, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.8930, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0601, Accuracy: 241/1513 (15.9286%)
___Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0369, Accuracy: 454/1513 (30.0066%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.3698, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  18, local model 79, internal_epoch   1, Avg loss: 0.1018, Accuracy: 15/197 (7.6142%)
___Train Local_ResNet_18, epoch  18, local model 79, internal_epoch   2, Avg loss: 0.0853, Accuracy: 59/197 (29.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.3243, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 229/1049 (21.8303%)
___Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 493/1049 (46.9971%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.5688, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   1, Avg loss: 0.0663, Accuracy: 170/938 (18.1237%)
___Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   2, Avg loss: 0.0333, Accuracy: 317/938 (33.7953%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.9517, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 393/1440 (27.2917%)
___Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 652/1440 (45.2778%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.7997, Accuracy: 73/10000 (0.7300%)
time spent on training: 122.14837169647217
[foolsgold agg] training data poison_ratio: 0.0  data num: [1340, 677, 781, 312, 605, 1513, 197, 1049, 938, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.3148, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 18: Avg loss: 5.6005, Accuracy: 0/9950 (0.0000%)
saving model
Done in 193.41441345214844 sec.
Server Epoch:19 choose agents : [7, 87, 36, 17, 90, 93, 21, 60, 11, 15].
___Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 355/891 (39.8429%)
___Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 448/891 (50.2806%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.1776, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 87, internal_epoch   1, Avg loss: 0.0581, Accuracy: 296/1131 (26.1715%)
___Train Local_ResNet_18, epoch  19, local model 87, internal_epoch   2, Avg loss: 0.0318, Accuracy: 419/1131 (37.0469%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.5367, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   1, Avg loss: 0.0874, Accuracy: 74/408 (18.1373%)
___Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   2, Avg loss: 0.0569, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.4792, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 395/1574 (25.0953%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 634/1574 (40.2795%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.0802, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  19, local model 90, internal_epoch   1, Avg loss: 0.0569, Accuracy: 315/677 (46.5288%)
___Train Local_ResNet_18, epoch  19, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 462/677 (68.2422%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.9202, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  19, local model 93, internal_epoch   1, Avg loss: 0.0557, Accuracy: 422/1742 (24.2250%)
___Train Local_ResNet_18, epoch  19, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 694/1742 (39.8393%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.4486, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 388/1949 (19.9076%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 620/1949 (31.8112%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.2603, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 550/2227 (24.6969%)
___Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1013/2227 (45.4872%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.2918, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0539, Accuracy: 352/712 (49.4382%)
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0256, Accuracy: 423/712 (59.4101%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.5534, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 336/1154 (29.1161%)
___Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   2, Avg loss: 0.0279, Accuracy: 457/1154 (39.6014%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.9089, Accuracy: 50/10000 (0.5000%)
time spent on training: 133.9524576663971
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 1131, 408, 1574, 677, 1742, 1949, 2227, 712, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 0. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.3147, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 19: Avg loss: 5.5989, Accuracy: 0/9950 (0.0000%)
saving model
Done in 205.04895424842834 sec.
Server Epoch:20 choose agents : [76, 14, 55, 7, 64, 50, 71, 52, 59, 10].
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0859, Accuracy: 42/466 (9.0129%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0509, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 5.5935, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   1, Avg loss: 0.0615, Accuracy: 226/1013 (22.3100%)
___Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 327/1013 (32.2804%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.4564, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 238/1071 (22.2222%)
___Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 522/1071 (48.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.8777, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 349/891 (39.1695%)
___Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 422/891 (47.3625%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.1519, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 167/953 (17.5236%)
___Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 321/953 (33.6831%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.2493, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   1, Avg loss: 0.0631, Accuracy: 151/809 (18.6650%)
___Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 346/809 (42.7689%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.2457, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   1, Avg loss: 0.0647, Accuracy: 159/818 (19.4377%)
___Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   2, Avg loss: 0.0314, Accuracy: 326/818 (39.8533%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.2161, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 280/636 (44.0252%)
___Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   2, Avg loss: 0.0317, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.3911, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 320/1089 (29.3848%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0341, Accuracy: 433/1089 (39.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.5769, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   1, Avg loss: 0.0579, Accuracy: 198/861 (22.9965%)
___Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   2, Avg loss: 0.0213, Accuracy: 464/861 (53.8908%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.7797, Accuracy: 50/10000 (0.5000%)
time spent on training: 126.23918461799622
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 1013, 1071, 891, 953, 809, 818, 636, 1089, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 20: Avg loss: 5.3146, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 20: Avg loss: 5.5973, Accuracy: 0/9950 (0.0000%)
saving model
Done in 198.13585233688354 sec.
Server Epoch:21 choose agents : [0, 17, 26, 47, 77, 99, 74, 94, 65, 22].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0561, Accuracy: 474/1657 (28.6059%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0300, Accuracy: 799/1657 (48.2197%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0259, Accuracy: 821/1657 (49.5474%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0252, Accuracy: 849/1657 (51.2372%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0249, Accuracy: 857/1657 (51.7200%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0243, Accuracy: 860/1657 (51.9010%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0241, Accuracy: 877/1657 (52.9270%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0238, Accuracy: 877/1657 (52.9270%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0236, Accuracy: 900/1657 (54.3150%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0236, Accuracy: 885/1657 (53.4098%), train_poison_data_count: 520
Global model norm: 112.05521012959416.
Norm before scaling: 112.02930611981625. Distance: 1.2477222671193613
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.3992, Accuracy: 60/10000 (0.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: 0.1857, Accuracy: 9883/9950 (99.3266%)
Scaling by  100
Scaled Norm after poisoning: 165.4948722298519, distance: 124.77222215651607
Total norm for 1 adversaries is: 165.4948722298519. distance: 124.77222215651607
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 367/1574 (23.3164%)
___Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 641/1574 (40.7243%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.0772, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 335/1446 (23.1674%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 523/1446 (36.1687%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.0650, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   1, Avg loss: 0.1266, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   2, Avg loss: 0.1117, Accuracy: 7/134 (5.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.3101, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0533, Accuracy: 338/1340 (25.2239%)
___Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 540/1340 (40.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.9666, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  21, local model 99, internal_epoch   1, Avg loss: 0.0669, Accuracy: 178/773 (23.0272%)
___Train Local_ResNet_18, epoch  21, local model 99, internal_epoch   2, Avg loss: 0.0315, Accuracy: 395/773 (51.0996%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.2073, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 493/1552 (31.7655%)
___Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 766/1552 (49.3557%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 10.9066, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 338/1662 (20.3369%)
___Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 631/1662 (37.9663%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.6618, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0552, Accuracy: 378/1475 (25.6271%)
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 685/1475 (46.4407%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.0144, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 509/1470 (34.6259%)
___Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 867/1470 (58.9796%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.0165, Accuracy: 67/10000 (0.6700%)
time spent on training: 269.54802441596985
[foolsgold agg] training data poison_ratio: 0.12665290835435297  data num: [1657, 1574, 1446, 134, 1340, 773, 1552, 1662, 1475, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.0395790338607353
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.3144, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Avg loss: 5.5914, Accuracy: 0/9950 (0.0000%)
saving model
Done in 339.9662461280823 sec.
Server Epoch:22 choose agents : [11, 22, 49, 18, 75, 2, 0, 8, 77, 54].
___Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   1, Avg loss: 0.0550, Accuracy: 347/712 (48.7360%)
___Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 414/712 (58.1461%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.6349, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 542/1470 (36.8707%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0234, Accuracy: 869/1470 (59.1156%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.9293, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   1, Avg loss: 0.0805, Accuracy: 22/440 (5.0000%)
___Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   2, Avg loss: 0.0485, Accuracy: 158/440 (35.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 5.4830, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0752, Accuracy: 119/530 (22.4528%)
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0399, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.0732, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  22, local model 75, internal_epoch   1, Avg loss: 0.0646, Accuracy: 249/776 (32.0876%)
___Train Local_ResNet_18, epoch  22, local model 75, internal_epoch   2, Avg loss: 0.0291, Accuracy: 421/776 (54.2526%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.0513, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0635, Accuracy: 226/605 (37.3554%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0394, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 5.8475, Accuracy: 66/10000 (0.6600%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  22, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 385/1657 (23.2348%)
___Train Local_ResNet_18, epoch  22, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 538/1657 (32.4683%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.4852, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 249/1513 (16.4574%)
___Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0369, Accuracy: 471/1513 (31.1302%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.3318, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  22, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 324/1340 (24.1791%)
___Train Local_ResNet_18, epoch  22, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 566/1340 (42.2388%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.8408, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   1, Avg loss: 0.0555, Accuracy: 346/1130 (30.6195%)
___Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 461/1130 (40.7965%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.7295, Accuracy: 60/10000 (0.6000%)
time spent on training: 148.8489954471588
[foolsgold agg] training data poison_ratio: 0.16288213899537993  data num: [712, 1470, 440, 530, 776, 605, 1657, 1513, 1340, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.05090066843605623
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 22: Avg loss: 5.3143, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Avg loss: 5.5910, Accuracy: 0/9950 (0.0000%)
saving model
Done in 221.00048303604126 sec.
Server Epoch:23 choose agents : [20, 9, 53, 95, 2, 87, 22, 76, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Average loss: 0.0607, Accuracy: 224/807 (27.7571%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Average loss: 0.0340, Accuracy: 389/807 (48.2032%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Average loss: 0.0274, Accuracy: 494/807 (61.2144%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Average loss: 0.0246, Accuracy: 538/807 (66.6667%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Average loss: 0.0242, Accuracy: 520/807 (64.4362%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Average loss: 0.0219, Accuracy: 536/807 (66.4188%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Average loss: 0.0212, Accuracy: 537/807 (66.5428%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Average loss: 0.0204, Accuracy: 544/807 (67.4102%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Average loss: 0.0205, Accuracy: 547/807 (67.7819%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Average loss: 0.0210, Accuracy: 529/807 (65.5514%), train_poison_data_count: 260
Global model norm: 112.05510119189131.
Norm before scaling: 112.04431583501905. Distance: 0.870369169352389
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.1097, Accuracy: 56/10000 (0.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.4123, Accuracy: 9578/9950 (96.2613%)
Scaling by  100
Scaled Norm after poisoning: 140.76287685323854, distance: 87.03691633259706
Total norm for 1 adversaries is: 140.76287685323854. distance: 87.03691633259706
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0497, Accuracy: 373/1275 (29.2549%)
___Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0202, Accuracy: 656/1275 (51.4510%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.2205, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   1, Avg loss: 0.0496, Accuracy: 289/813 (35.5474%)
___Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 456/813 (56.0886%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.0359, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 333/599 (55.5927%)
___Train Local_ResNet_18, epoch  23, local model 95, internal_epoch   2, Avg loss: 0.0276, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.8469, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 224/605 (37.0248%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0401, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 5.7873, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 87, internal_epoch   1, Avg loss: 0.0581, Accuracy: 296/1131 (26.1715%)
___Train Local_ResNet_18, epoch  23, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 430/1131 (38.0195%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.7206, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   1, Avg loss: 0.0449, Accuracy: 557/1470 (37.8912%)
___Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 839/1470 (57.0748%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.2287, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  23, local model 76, internal_epoch   1, Avg loss: 0.0863, Accuracy: 41/466 (8.7983%)
___Train Local_ResNet_18, epoch  23, local model 76, internal_epoch   2, Avg loss: 0.0487, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 5.6380, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0744, Accuracy: 111/781 (14.2125%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 231/781 (29.5775%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 6.6502, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0513, Accuracy: 378/1628 (23.2187%)
___Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0259, Accuracy: 788/1628 (48.4029%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.3051, Accuracy: 132/10000 (1.3200%)
time spent on training: 227.48938870429993
[foolsgold agg] training data poison_ratio: 0.08428198433420366  data num: [807, 1275, 813, 599, 605, 1131, 1470, 466, 781, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.02633812010443864
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 23: Avg loss: 5.3142, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Avg loss: 5.5878, Accuracy: 0/9950 (0.0000%)
saving model
Done in 296.83345317840576 sec.
Server Epoch:24 choose agents : [63, 82, 85, 83, 14, 68, 3, 11, 51, 71].
___Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 265/888 (29.8423%)
___Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 411/888 (46.2838%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.5800, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 68/500 (13.6000%)
___Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 173/500 (34.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 5.6576, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  24, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 455/1988 (22.8873%)
___Train Local_ResNet_18, epoch  24, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 673/1988 (33.8531%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.3661, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0547, Accuracy: 432/1953 (22.1198%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 729/1953 (37.3272%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.7614, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 223/1013 (22.0138%)
___Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 347/1013 (34.2547%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.6782, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   1, Avg loss: 0.0634, Accuracy: 367/1163 (31.5563%)
___Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   2, Avg loss: 0.0369, Accuracy: 427/1163 (36.7154%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.5943, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0755, Accuracy: 110/781 (14.0845%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 252/781 (32.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.5592, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   1, Avg loss: 0.0531, Accuracy: 347/712 (48.7360%)
___Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 413/712 (58.0056%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.5838, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   1, Avg loss: 0.0606, Accuracy: 221/1049 (21.0677%)
___Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 494/1049 (47.0925%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.4555, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   1, Avg loss: 0.0643, Accuracy: 151/818 (18.4597%)
___Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 345/818 (42.1760%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.0270, Accuracy: 51/10000 (0.5100%)
time spent on training: 133.0779857635498
[foolsgold agg] training data poison_ratio: 0.0  data num: [888, 500, 1988, 1953, 1013, 1163, 781, 712, 1049, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 24: Avg loss: 5.3141, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Avg loss: 5.5877, Accuracy: 0/9950 (0.0000%)
saving model
Done in 202.94184947013855 sec.
Server Epoch:25 choose agents : [15, 70, 45, 27, 54, 88, 16, 95, 32, 3].
___Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0564, Accuracy: 326/1154 (28.2496%)
___Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0297, Accuracy: 411/1154 (35.6153%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.8161, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 352/1418 (24.8237%)
___Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   2, Avg loss: 0.0321, Accuracy: 614/1418 (43.3004%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.7207, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   1, Avg loss: 0.0680, Accuracy: 200/669 (29.8954%)
___Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   2, Avg loss: 0.0409, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 5.7674, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 440/1587 (27.7253%)
___Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 615/1587 (38.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.0912, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 349/1130 (30.8850%)
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 465/1130 (41.1504%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.7725, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 88, internal_epoch   1, Avg loss: 0.0739, Accuracy: 137/603 (22.7197%)
___Train Local_ResNet_18, epoch  25, local model 88, internal_epoch   2, Avg loss: 0.0458, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 5.8356, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0651, Accuracy: 277/708 (39.1243%)
___Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0346, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 5.8755, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0521, Accuracy: 330/599 (55.0918%)
___Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.5935, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0604, Accuracy: 199/735 (27.0748%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 342/735 (46.5306%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.8567, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  25, local model 3, internal_epoch   1, Avg loss: 0.0743, Accuracy: 108/781 (13.8284%)
___Train Local_ResNet_18, epoch  25, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 228/781 (29.1933%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 6.5818, Accuracy: 68/10000 (0.6800%)
time spent on training: 139.95374751091003
[foolsgold agg] training data poison_ratio: 0.0  data num: [1154, 1418, 669, 1587, 1130, 603, 708, 599, 735, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 25: Avg loss: 5.3140, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Avg loss: 5.5847, Accuracy: 0/9950 (0.0000%)
saving model
Done in 211.9260275363922 sec.
Server Epoch:26 choose agents : [16, 82, 49, 81, 57, 74, 75, 46, 55, 43].
___Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   1, Avg loss: 0.0627, Accuracy: 266/708 (37.5706%)
___Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   2, Avg loss: 0.0376, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.6718, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 65/500 (13.0000%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0500, Accuracy: 168/500 (33.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.6002, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0803, Accuracy: 25/440 (5.6818%)
___Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0483, Accuracy: 148/440 (33.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.5028, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 81, internal_epoch   1, Avg loss: 0.0686, Accuracy: 240/774 (31.0078%)
___Train Local_ResNet_18, epoch  26, local model 81, internal_epoch   2, Avg loss: 0.0358, Accuracy: 281/774 (36.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 6.1775, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   1, Avg loss: 0.0540, Accuracy: 305/1154 (26.4298%)
___Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   2, Avg loss: 0.0249, Accuracy: 523/1154 (45.3206%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.4245, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 509/1552 (32.7964%)
___Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 783/1552 (50.4510%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 10.7299, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   1, Avg loss: 0.0655, Accuracy: 238/776 (30.6701%)
___Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   2, Avg loss: 0.0280, Accuracy: 417/776 (53.7371%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 6.9168, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   1, Avg loss: 0.0548, Accuracy: 430/1904 (22.5840%)
___Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 716/1904 (37.6050%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.5386, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 238/1071 (22.2222%)
___Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 497/1071 (46.4052%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.9209, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  26, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 309/946 (32.6638%)
___Train Local_ResNet_18, epoch  26, local model 43, internal_epoch   2, Avg loss: 0.0364, Accuracy: 354/946 (37.4207%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 6.0805, Accuracy: 55/10000 (0.5500%)
time spent on training: 130.89187955856323
[foolsgold agg] training data poison_ratio: 0.0  data num: [708, 500, 440, 774, 1154, 1552, 776, 1904, 1071, 946]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.3139, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Avg loss: 5.5849, Accuracy: 0/9950 (0.0000%)
saving model
Done in 203.124990940094 sec.
Server Epoch:27 choose agents : [80, 8, 51, 85, 26, 14, 96, 99, 43, 16].
___Train Local_ResNet_18, epoch  27, local model 80, internal_epoch   1, Avg loss: 0.0707, Accuracy: 141/682 (20.6745%)
___Train Local_ResNet_18, epoch  27, local model 80, internal_epoch   2, Avg loss: 0.0388, Accuracy: 244/682 (35.7771%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 6.2427, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0603, Accuracy: 245/1513 (16.1930%)
___Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 475/1513 (31.3946%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.4847, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0609, Accuracy: 228/1049 (21.7350%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0301, Accuracy: 504/1049 (48.0458%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.3617, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 439/1988 (22.0825%)
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 664/1988 (33.4004%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.0284, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 328/1446 (22.6833%)
___Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 525/1446 (36.3071%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.2436, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   1, Avg loss: 0.0613, Accuracy: 230/1013 (22.7048%)
___Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 357/1013 (35.2419%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 6.6954, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  27, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 47/311 (15.1125%)
___Train Local_ResNet_18, epoch  27, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 5.3471, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.0652, Accuracy: 180/773 (23.2859%)
___Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0331, Accuracy: 406/773 (52.5226%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.2724, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   1, Avg loss: 0.0610, Accuracy: 304/946 (32.1353%)
___Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 350/946 (36.9979%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 6.0458, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  27, local model 16, internal_epoch   1, Avg loss: 0.0630, Accuracy: 282/708 (39.8305%)
___Train Local_ResNet_18, epoch  27, local model 16, internal_epoch   2, Avg loss: 0.0376, Accuracy: 425/708 (60.0282%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 5.8616, Accuracy: 53/10000 (0.5300%)
time spent on training: 141.53971076011658
[foolsgold agg] training data poison_ratio: 0.0  data num: [682, 1513, 1049, 1988, 1446, 1013, 311, 773, 946, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 27: Avg loss: 5.3138, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Avg loss: 5.5856, Accuracy: 0/9950 (0.0000%)
saving model
Done in 211.77698349952698 sec.
Server Epoch:28 choose agents : [55, 21, 93, 68, 49, 92, 86, 77, 7, 84].
___Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 247/1071 (23.0626%)
___Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 511/1071 (47.7124%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.8180, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 388/1949 (19.9076%)
___Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 610/1949 (31.2981%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.4285, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 405/1742 (23.2491%)
___Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 695/1742 (39.8967%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.0181, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   1, Avg loss: 0.0619, Accuracy: 371/1163 (31.9003%)
___Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   2, Avg loss: 0.0360, Accuracy: 434/1163 (37.3173%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 6.8231, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   1, Avg loss: 0.0802, Accuracy: 28/440 (6.3636%)
___Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   2, Avg loss: 0.0477, Accuracy: 143/440 (32.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 5.5083, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0528, Accuracy: 458/1715 (26.7055%)
___Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0312, Accuracy: 686/1715 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.4848, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  28, local model 86, internal_epoch   1, Avg loss: 0.0638, Accuracy: 353/1003 (35.1944%)
___Train Local_ResNet_18, epoch  28, local model 86, internal_epoch   2, Avg loss: 0.0355, Accuracy: 354/1003 (35.2941%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 6.7412, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 336/1340 (25.0746%)
___Train Local_ResNet_18, epoch  28, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 563/1340 (42.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.6058, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  28, local model 7, internal_epoch   1, Avg loss: 0.0537, Accuracy: 357/891 (40.0673%)
___Train Local_ResNet_18, epoch  28, local model 7, internal_epoch   2, Avg loss: 0.0271, Accuracy: 411/891 (46.1279%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.3605, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 315/1190 (26.4706%)
___Train Local_ResNet_18, epoch  28, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 461/1190 (38.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 6.9898, Accuracy: 63/10000 (0.6300%)
time spent on training: 153.87307167053223
[foolsgold agg] training data poison_ratio: 0.0  data num: [1071, 1949, 1742, 1163, 440, 1715, 1003, 1340, 891, 1190]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 28: Avg loss: 5.3138, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Avg loss: 5.5863, Accuracy: 0/9950 (0.0000%)
saving model
Done in 224.25028228759766 sec.
Server Epoch:29 choose agents : [20, 12, 59, 54, 88, 96, 63, 66, 61, 58].
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  29, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 355/807 (43.9901%)
___Train Local_ResNet_18, epoch  29, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 413/807 (51.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.7778, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 18/338 (5.3254%)
___Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   2, Avg loss: 0.0490, Accuracy: 127/338 (37.5740%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 5.4520, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 308/1089 (28.2828%)
___Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   2, Avg loss: 0.0277, Accuracy: 472/1089 (43.3425%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.2870, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0553, Accuracy: 343/1130 (30.3540%)
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0295, Accuracy: 462/1130 (40.8850%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.4492, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.0753, Accuracy: 136/603 (22.5539%)
___Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 281/603 (46.6003%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 5.8533, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 49/311 (15.7556%)
___Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 5.3459, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 258/888 (29.0541%)
___Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 421/888 (47.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.3152, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 268/1402 (19.1155%)
___Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 403/1402 (28.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.2722, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  29, local model 61, internal_epoch   1, Avg loss: 0.1263, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 61, internal_epoch   2, Avg loss: 0.1178, Accuracy: 6/85 (7.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 5.3044, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 349/803 (43.4620%)
___Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 395/803 (49.1905%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.0402, Accuracy: 52/10000 (0.5200%)
time spent on training: 139.4832410812378
[foolsgold agg] training data poison_ratio: 0.10823497854077253  data num: [807, 338, 1089, 1130, 603, 311, 888, 1402, 85, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.033823430793991416
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 29: Avg loss: 5.3137, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Avg loss: 5.5864, Accuracy: 0/9950 (0.0000%)
saving model
Done in 211.58305597305298 sec.
Server Epoch:30 choose agents : [70, 49, 92, 67, 44, 24, 1, 14, 90, 0].
___Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 352/1418 (24.8237%)
___Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 623/1418 (43.9351%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.5080, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   1, Avg loss: 0.0798, Accuracy: 28/440 (6.3636%)
___Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   2, Avg loss: 0.0482, Accuracy: 149/440 (33.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.5026, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 463/1715 (26.9971%)
___Train Local_ResNet_18, epoch  30, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 719/1715 (41.9242%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.6144, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   1, Avg loss: 0.0790, Accuracy: 54/426 (12.6761%)
___Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   2, Avg loss: 0.0416, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.5701, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 404/1750 (23.0857%)
___Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 671/1750 (38.3429%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.5272, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   1, Avg loss: 0.0760, Accuracy: 38/312 (12.1795%)
___Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 163/312 (52.2436%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.3908, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0571, Accuracy: 290/928 (31.2500%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 561/928 (60.4526%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.6589, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 223/1013 (22.0138%)
___Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 315/1013 (31.0958%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 6.6031, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0568, Accuracy: 317/677 (46.8242%)
___Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 453/677 (66.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.1215, Accuracy: 45/10000 (0.4500%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 375/1657 (22.6313%)
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 515/1657 (31.0803%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.6541, Accuracy: 75/10000 (0.7500%)
time spent on training: 157.94815182685852
[foolsgold agg] training data poison_ratio: 0.16031346749226005  data num: [1418, 440, 1715, 426, 1750, 312, 928, 1013, 677, 1657]
[foolsgold agg] considering poison per batch poison_fraction: 0.05009795859133127
[foolsgold agg] wv: [1.         0.99378094 1.         1.         1.         0.99378094
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.3136, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Avg loss: 5.5863, Accuracy: 0/9950 (0.0000%)
saving model
Done in 230.83054184913635 sec.
Server Epoch:31 choose agents : [70, 30, 32, 95, 1, 61, 22, 99, 68, 97].
___Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 345/1418 (24.3300%)
___Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 652/1418 (45.9803%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.5773, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0811, Accuracy: 69/486 (14.1975%)
___Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0399, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.7629, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0605, Accuracy: 200/735 (27.2109%)
___Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 336/735 (45.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.0545, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.0513, Accuracy: 327/599 (54.5910%)
___Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0281, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.9152, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0567, Accuracy: 289/928 (31.1422%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 560/928 (60.3448%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.5400, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   1, Avg loss: 0.1271, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   2, Avg loss: 0.1145, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.3042, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 554/1470 (37.6871%)
___Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 825/1470 (56.1224%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.9851, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  31, local model 99, internal_epoch   1, Avg loss: 0.0678, Accuracy: 174/773 (22.5097%)
___Train Local_ResNet_18, epoch  31, local model 99, internal_epoch   2, Avg loss: 0.0309, Accuracy: 381/773 (49.2885%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.0014, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  31, local model 68, internal_epoch   1, Avg loss: 0.0624, Accuracy: 362/1163 (31.1264%)
___Train Local_ResNet_18, epoch  31, local model 68, internal_epoch   2, Avg loss: 0.0365, Accuracy: 449/1163 (38.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 6.5087, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0528, Accuracy: 358/1213 (29.5136%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 461/1213 (38.0049%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.4412, Accuracy: 83/10000 (0.8300%)
time spent on training: 136.0615029335022
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 486, 735, 599, 928, 85, 1470, 773, 1163, 1213]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.3135, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Avg loss: 5.5823, Accuracy: 0/9950 (0.0000%)
saving model
Done in 205.1354649066925 sec.
Server Epoch:32 choose agents : [31, 27, 46, 19, 20, 85, 9, 91, 81, 59].
___Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   1, Avg loss: 0.0817, Accuracy: 58/460 (12.6087%)
___Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   2, Avg loss: 0.0400, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 5.7335, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 441/1587 (27.7883%)
___Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 617/1587 (38.8784%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.1638, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 428/1904 (22.4790%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 659/1904 (34.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.4830, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0480, Accuracy: 381/1036 (36.7761%)
___Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0242, Accuracy: 672/1036 (64.8649%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 9.4027, Accuracy: 61/10000 (0.6100%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 348/807 (43.1227%)
___Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 424/807 (52.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.4874, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0532, Accuracy: 484/1988 (24.3461%)
___Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0357, Accuracy: 642/1988 (32.2938%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.1867, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   1, Avg loss: 0.0492, Accuracy: 360/1275 (28.2353%)
___Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   2, Avg loss: 0.0189, Accuracy: 751/1275 (58.9020%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 9.3070, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  32, local model 91, internal_epoch   1, Avg loss: 0.0521, Accuracy: 360/1030 (34.9515%)
___Train Local_ResNet_18, epoch  32, local model 91, internal_epoch   2, Avg loss: 0.0250, Accuracy: 629/1030 (61.0680%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.4131, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  32, local model 81, internal_epoch   1, Avg loss: 0.0668, Accuracy: 251/774 (32.4289%)
___Train Local_ResNet_18, epoch  32, local model 81, internal_epoch   2, Avg loss: 0.0379, Accuracy: 274/774 (35.4005%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.1928, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  32, local model 59, internal_epoch   1, Avg loss: 0.0536, Accuracy: 307/1089 (28.1910%)
___Train Local_ResNet_18, epoch  32, local model 59, internal_epoch   2, Avg loss: 0.0276, Accuracy: 493/1089 (45.2709%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.5678, Accuracy: 67/10000 (0.6700%)
time spent on training: 170.7413489818573
[foolsgold agg] training data poison_ratio: 0.06753138075313808  data num: [460, 1587, 1904, 1036, 807, 1988, 1275, 1030, 774, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.02110355648535565
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 32: Avg loss: 5.3133, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Avg loss: 5.5817, Accuracy: 0/9950 (0.0000%)
saving model
Done in 244.05851101875305 sec.
Server Epoch:33 choose agents : [49, 13, 80, 70, 48, 78, 56, 37, 83, 46].
___Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   1, Avg loss: 0.0796, Accuracy: 34/440 (7.7273%)
___Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 148/440 (33.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.5084, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   1, Avg loss: 0.0574, Accuracy: 325/1645 (19.7568%)
___Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 627/1645 (38.1155%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.0327, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  33, local model 80, internal_epoch   1, Avg loss: 0.0701, Accuracy: 142/682 (20.8211%)
___Train Local_ResNet_18, epoch  33, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 245/682 (35.9238%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 6.3087, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 335/1418 (23.6248%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 654/1418 (46.1213%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.7797, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   1, Avg loss: 0.0711, Accuracy: 99/631 (15.6894%)
___Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 218/631 (34.5483%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.8538, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 35/416 (8.4135%)
___Train Local_ResNet_18, epoch  33, local model 78, internal_epoch   2, Avg loss: 0.0469, Accuracy: 170/416 (40.8654%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.5325, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 56, internal_epoch   1, Avg loss: 0.0825, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 56, internal_epoch   2, Avg loss: 0.0671, Accuracy: 73/186 (39.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 37, internal_epoch   1, Avg loss: 0.0524, Accuracy: 404/1129 (35.7839%)
___Train Local_ResNet_18, epoch  33, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 707/1129 (62.6218%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.3749, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  33, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 453/1953 (23.1951%)
___Train Local_ResNet_18, epoch  33, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 803/1953 (41.1162%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.0796, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  33, local model 46, internal_epoch   1, Avg loss: 0.0554, Accuracy: 422/1904 (22.1639%)
___Train Local_ResNet_18, epoch  33, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 702/1904 (36.8697%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.4136, Accuracy: 104/10000 (1.0400%)
time spent on training: 148.20547342300415
[foolsgold agg] training data poison_ratio: 0.0  data num: [440, 1645, 682, 1418, 631, 416, 186, 1129, 1953, 1904]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.3132, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Avg loss: 5.5819, Accuracy: 0/9950 (0.0000%)
saving model
Done in 218.12951922416687 sec.
Server Epoch:34 choose agents : [60, 55, 12, 50, 72, 14, 25, 49, 31, 77].
___Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 625/2227 (28.0647%)
___Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1018/2227 (45.7117%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.3096, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0556, Accuracy: 268/1071 (25.0233%)
___Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 510/1071 (47.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.1303, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   1, Avg loss: 0.0867, Accuracy: 14/338 (4.1420%)
___Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   2, Avg loss: 0.0494, Accuracy: 148/338 (43.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.4550, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 166/809 (20.5192%)
___Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   2, Avg loss: 0.0277, Accuracy: 343/809 (42.3980%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.3160, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 243/1241 (19.5810%)
___Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 386/1241 (31.1039%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.2286, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0616, Accuracy: 227/1013 (22.4087%)
___Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 324/1013 (31.9842%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 6.7420, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  34, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 304/690 (44.0580%)
___Train Local_ResNet_18, epoch  34, local model 25, internal_epoch   2, Avg loss: 0.0289, Accuracy: 457/690 (66.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 6.3205, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0798, Accuracy: 28/440 (6.3636%)
___Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0484, Accuracy: 154/440 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.4905, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 31, internal_epoch   1, Avg loss: 0.0823, Accuracy: 58/460 (12.6087%)
___Train Local_ResNet_18, epoch  34, local model 31, internal_epoch   2, Avg loss: 0.0381, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.7863, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 324/1340 (24.1791%)
___Train Local_ResNet_18, epoch  34, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 526/1340 (39.2537%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.8344, Accuracy: 56/10000 (0.5600%)
time spent on training: 145.09562253952026
[foolsgold agg] training data poison_ratio: 0.0  data num: [2227, 1071, 338, 809, 1241, 1013, 690, 440, 460, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.3131, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Avg loss: 5.5806, Accuracy: 0/9950 (0.0000%)
saving model
Done in 216.57922792434692 sec.
Server Epoch:35 choose agents : [56, 59, 12, 2, 67, 49, 72, 34, 13, 42].
___Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 69/186 (37.0968%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0585, Accuracy: 296/1089 (27.1809%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0275, Accuracy: 502/1089 (46.0973%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.8199, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0867, Accuracy: 23/338 (6.8047%)
___Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0472, Accuracy: 156/338 (46.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.4401, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   1, Avg loss: 0.0624, Accuracy: 228/605 (37.6860%)
___Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   2, Avg loss: 0.0398, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.9589, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0790, Accuracy: 54/426 (12.6761%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0420, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.5712, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   1, Avg loss: 0.0796, Accuracy: 21/440 (4.7727%)
___Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   2, Avg loss: 0.0478, Accuracy: 150/440 (34.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.4955, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 245/1241 (19.7421%)
___Train Local_ResNet_18, epoch  35, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 412/1241 (33.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.1686, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  35, local model 34, internal_epoch   1, Avg loss: 0.0579, Accuracy: 390/1427 (27.3301%)
___Train Local_ResNet_18, epoch  35, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 604/1427 (42.3266%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 6.8459, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  35, local model 13, internal_epoch   1, Avg loss: 0.0573, Accuracy: 319/1645 (19.3921%)
___Train Local_ResNet_18, epoch  35, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 634/1645 (38.5410%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.9861, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  35, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 362/1372 (26.3848%)
___Train Local_ResNet_18, epoch  35, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 525/1372 (38.2653%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.8683, Accuracy: 75/10000 (0.7500%)
time spent on training: 138.33294582366943
[foolsgold agg] training data poison_ratio: 0.0  data num: [186, 1089, 338, 605, 426, 440, 1241, 1427, 1645, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.3129, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Avg loss: 5.5795, Accuracy: 0/9950 (0.0000%)
saving model
Done in 208.9204957485199 sec.
Server Epoch:36 choose agents : [7, 12, 61, 44, 77, 43, 52, 34, 92, 71].
___Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 354/891 (39.7306%)
___Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0266, Accuracy: 433/891 (48.5971%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.9076, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   1, Avg loss: 0.0866, Accuracy: 20/338 (5.9172%)
___Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   2, Avg loss: 0.0490, Accuracy: 141/338 (41.7160%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.4394, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   1, Avg loss: 0.1254, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   2, Avg loss: 0.1173, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.3039, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 390/1750 (22.2857%)
___Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 634/1750 (36.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.2786, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   1, Avg loss: 0.0532, Accuracy: 325/1340 (24.2537%)
___Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 548/1340 (40.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.7459, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 308/946 (32.5581%)
___Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0364, Accuracy: 319/946 (33.7209%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.0600, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   1, Avg loss: 0.0568, Accuracy: 290/636 (45.5975%)
___Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   2, Avg loss: 0.0317, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.2266, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   1, Avg loss: 0.0582, Accuracy: 382/1427 (26.7694%)
___Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   2, Avg loss: 0.0340, Accuracy: 586/1427 (41.0652%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.9103, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  36, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 471/1715 (27.4636%)
___Train Local_ResNet_18, epoch  36, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 741/1715 (43.2070%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.4837, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   1, Avg loss: 0.0637, Accuracy: 175/818 (21.3936%)
___Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 355/818 (43.3985%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.1732, Accuracy: 55/10000 (0.5500%)
time spent on training: 150.4628026485443
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 338, 85, 1750, 1340, 946, 636, 1427, 1715, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.3128, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Avg loss: 5.5792, Accuracy: 0/9950 (0.0000%)
saving model
Done in 221.3948619365692 sec.
Server Epoch:37 choose agents : [11, 33, 59, 95, 52, 25, 78, 26, 47, 1].
___Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   1, Avg loss: 0.0537, Accuracy: 344/712 (48.3146%)
___Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   2, Avg loss: 0.0274, Accuracy: 435/712 (61.0955%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.6617, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   1, Avg loss: 0.0781, Accuracy: 65/515 (12.6214%)
___Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   2, Avg loss: 0.0525, Accuracy: 121/515 (23.4951%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 5.6927, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   1, Avg loss: 0.0525, Accuracy: 320/1089 (29.3848%)
___Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   2, Avg loss: 0.0309, Accuracy: 458/1089 (42.0569%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.8462, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  37, local model 95, internal_epoch   1, Avg loss: 0.0535, Accuracy: 330/599 (55.0918%)
___Train Local_ResNet_18, epoch  37, local model 95, internal_epoch   2, Avg loss: 0.0281, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.5005, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0560, Accuracy: 283/636 (44.4969%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0305, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.1582, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0565, Accuracy: 309/690 (44.7826%)
___Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 457/690 (66.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.5433, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  37, local model 78, internal_epoch   1, Avg loss: 0.0836, Accuracy: 32/416 (7.6923%)
___Train Local_ResNet_18, epoch  37, local model 78, internal_epoch   2, Avg loss: 0.0460, Accuracy: 174/416 (41.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 5.5762, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 26, internal_epoch   1, Avg loss: 0.0553, Accuracy: 335/1446 (23.1674%)
___Train Local_ResNet_18, epoch  37, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 482/1446 (33.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.2416, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   1, Avg loss: 0.1254, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   2, Avg loss: 0.1090, Accuracy: 15/134 (11.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 5.3108, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 1, internal_epoch   1, Avg loss: 0.0566, Accuracy: 281/928 (30.2802%)
___Train Local_ResNet_18, epoch  37, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 545/928 (58.7284%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.5994, Accuracy: 82/10000 (0.8200%)
time spent on training: 127.95620799064636
[foolsgold agg] training data poison_ratio: 0.0  data num: [712, 515, 1089, 599, 636, 690, 416, 1446, 134, 928]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 37: Avg loss: 5.3127, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Avg loss: 5.5792, Accuracy: 0/9950 (0.0000%)
saving model
Done in 199.17733931541443 sec.
Server Epoch:38 choose agents : [84, 78, 4, 39, 42, 59, 73, 34, 20, 88].
___Train Local_ResNet_18, epoch  38, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 335/1190 (28.1513%)
___Train Local_ResNet_18, epoch  38, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 441/1190 (37.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.0367, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  38, local model 78, internal_epoch   1, Avg loss: 0.0832, Accuracy: 39/416 (9.3750%)
___Train Local_ResNet_18, epoch  38, local model 78, internal_epoch   2, Avg loss: 0.0458, Accuracy: 173/416 (41.5865%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 5.5579, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0622, Accuracy: 328/901 (36.4040%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0330, Accuracy: 351/901 (38.9567%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.8817, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 317/1013 (31.2932%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 466/1013 (46.0020%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.6909, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 363/1372 (26.4577%)
___Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 497/1372 (36.2245%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.8484, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 304/1089 (27.9155%)
___Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 449/1089 (41.2305%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.2819, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   1, Avg loss: 0.0659, Accuracy: 174/938 (18.5501%)
___Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   2, Avg loss: 0.0338, Accuracy: 315/938 (33.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.4992, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  38, local model 34, internal_epoch   1, Avg loss: 0.0572, Accuracy: 416/1427 (29.1521%)
___Train Local_ResNet_18, epoch  38, local model 34, internal_epoch   2, Avg loss: 0.0338, Accuracy: 594/1427 (41.6258%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.7673, Accuracy: 54/10000 (0.5400%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0585, Accuracy: 339/807 (42.0074%)
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0309, Accuracy: 431/807 (53.4077%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.6211, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0750, Accuracy: 141/603 (23.3831%)
___Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0449, Accuracy: 289/603 (47.9270%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 5.9122, Accuracy: 52/10000 (0.5200%)
time spent on training: 159.89894461631775
[foolsgold agg] training data poison_ratio: 0.08271832718327184  data num: [1190, 416, 901, 1013, 1372, 1089, 938, 1427, 807, 603]
[foolsgold agg] considering poison per batch poison_fraction: 0.025849477244772448
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 38: Avg loss: 5.3126, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Avg loss: 5.5778, Accuracy: 0/9950 (0.0000%)
saving model
Done in 232.20251774787903 sec.
Server Epoch:39 choose agents : [43, 8, 17, 27, 59, 44, 32, 92, 66, 71].
___Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 306/946 (32.3467%)
___Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0356, Accuracy: 337/946 (35.6237%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 5.9707, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0599, Accuracy: 258/1513 (17.0522%)
___Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 509/1513 (33.6418%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.3800, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   1, Avg loss: 0.0511, Accuracy: 414/1574 (26.3024%)
___Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 705/1574 (44.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.9316, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0541, Accuracy: 452/1587 (28.4814%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0345, Accuracy: 555/1587 (34.9716%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.2263, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   1, Avg loss: 0.0524, Accuracy: 321/1089 (29.4766%)
___Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 452/1089 (41.5060%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.1081, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   1, Avg loss: 0.0595, Accuracy: 418/1750 (23.8857%)
___Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 645/1750 (36.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.6487, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   1, Avg loss: 0.0602, Accuracy: 197/735 (26.8027%)
___Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   2, Avg loss: 0.0238, Accuracy: 324/735 (44.0816%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.4110, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  39, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 495/1715 (28.8630%)
___Train Local_ResNet_18, epoch  39, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 709/1715 (41.3411%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.9393, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  39, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 248/1402 (17.6890%)
___Train Local_ResNet_18, epoch  39, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 361/1402 (25.7489%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.1086, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0640, Accuracy: 158/818 (19.3154%)
___Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 343/818 (41.9315%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.0084, Accuracy: 65/10000 (0.6500%)
time spent on training: 182.6488380432129
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 1513, 1574, 1587, 1089, 1750, 735, 1715, 1402, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 39: Avg loss: 5.3125, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Avg loss: 5.5746, Accuracy: 0/9950 (0.0000%)
saving model
Done in 255.39583683013916 sec.
Server Epoch:40 choose agents : [72, 92, 10, 79, 82, 55, 2, 64, 84, 44].
___Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 254/1241 (20.4674%)
___Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 411/1241 (33.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.1967, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 423/1715 (24.6647%)
___Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 747/1715 (43.5569%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.5028, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   1, Avg loss: 0.0571, Accuracy: 224/861 (26.0163%)
___Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 425/861 (49.3612%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.7909, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 79, internal_epoch   1, Avg loss: 0.1017, Accuracy: 14/197 (7.1066%)
___Train Local_ResNet_18, epoch  40, local model 79, internal_epoch   2, Avg loss: 0.0838, Accuracy: 63/197 (31.9797%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.3198, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 82, internal_epoch   1, Avg loss: 0.0767, Accuracy: 67/500 (13.4000%)
___Train Local_ResNet_18, epoch  40, local model 82, internal_epoch   2, Avg loss: 0.0480, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.6207, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   1, Avg loss: 0.0561, Accuracy: 246/1071 (22.9692%)
___Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 508/1071 (47.4323%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.0737, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 234/605 (38.6777%)
___Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   2, Avg loss: 0.0404, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.8340, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0642, Accuracy: 186/953 (19.5173%)
___Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0384, Accuracy: 302/953 (31.6894%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.4093, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 333/1190 (27.9832%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 458/1190 (38.4874%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.8715, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  40, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 411/1750 (23.4857%)
___Train Local_ResNet_18, epoch  40, local model 44, internal_epoch   2, Avg loss: 0.0349, Accuracy: 686/1750 (39.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.7536, Accuracy: 113/10000 (1.1300%)
time spent on training: 153.900066614151
[foolsgold agg] training data poison_ratio: 0.0  data num: [1241, 1715, 861, 197, 500, 1071, 605, 953, 1190, 1750]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.3124, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Avg loss: 5.5730, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 224.60540986061096 sec.
Server Epoch:41 choose agents : [65, 85, 25, 90, 38, 75, 45, 21, 51, 16].
___Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   1, Avg loss: 0.0551, Accuracy: 406/1475 (27.5254%)
___Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 646/1475 (43.7966%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.7770, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   1, Avg loss: 0.0534, Accuracy: 461/1988 (23.1891%)
___Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 683/1988 (34.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.9781, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Avg loss: 0.0567, Accuracy: 306/690 (44.3478%)
___Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 463/690 (67.1014%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.3133, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   1, Avg loss: 0.0578, Accuracy: 316/677 (46.6765%)
___Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 440/677 (64.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.1245, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0614, Accuracy: 252/1131 (22.2812%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 505/1131 (44.6508%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.4730, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  41, local model 75, internal_epoch   1, Avg loss: 0.0626, Accuracy: 255/776 (32.8608%)
___Train Local_ResNet_18, epoch  41, local model 75, internal_epoch   2, Avg loss: 0.0292, Accuracy: 392/776 (50.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.9903, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   1, Avg loss: 0.0679, Accuracy: 200/669 (29.8954%)
___Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   2, Avg loss: 0.0397, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 5.7930, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 390/1949 (20.0103%)
___Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 640/1949 (32.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.3785, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  41, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 223/1049 (21.2583%)
___Train Local_ResNet_18, epoch  41, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 511/1049 (48.7131%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.6628, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  41, local model 16, internal_epoch   1, Avg loss: 0.0647, Accuracy: 280/708 (39.5480%)
___Train Local_ResNet_18, epoch  41, local model 16, internal_epoch   2, Avg loss: 0.0363, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.0120, Accuracy: 59/10000 (0.5900%)
time spent on training: 171.79490518569946
[foolsgold agg] training data poison_ratio: 0.0  data num: [1475, 1988, 690, 677, 1131, 776, 669, 1949, 1049, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 41: Avg loss: 5.3123, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Avg loss: 5.5718, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 241.11460137367249 sec.
Server Epoch:42 choose agents : [4, 43, 67, 60, 32, 45, 94, 15, 38, 34].
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0614, Accuracy: 328/901 (36.4040%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0340, Accuracy: 365/901 (40.5105%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.1077, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 297/946 (31.3953%)
___Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 317/946 (33.5095%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 5.9775, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0787, Accuracy: 46/426 (10.7981%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0426, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 5.5326, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 576/2227 (25.8644%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1045/2227 (46.9241%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.7138, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   1, Avg loss: 0.0598, Accuracy: 201/735 (27.3469%)
___Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   2, Avg loss: 0.0221, Accuracy: 371/735 (50.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.3510, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0681, Accuracy: 204/669 (30.4933%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0399, Accuracy: 355/669 (53.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 5.7904, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  42, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 365/1662 (21.9615%)
___Train Local_ResNet_18, epoch  42, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 628/1662 (37.7858%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.8249, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   1, Avg loss: 0.0575, Accuracy: 324/1154 (28.0763%)
___Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   2, Avg loss: 0.0280, Accuracy: 487/1154 (42.2010%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.9634, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 38, internal_epoch   1, Avg loss: 0.0616, Accuracy: 251/1131 (22.1927%)
___Train Local_ResNet_18, epoch  42, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 504/1131 (44.5623%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.1897, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   1, Avg loss: 0.0578, Accuracy: 389/1427 (27.2600%)
___Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 581/1427 (40.7148%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.0253, Accuracy: 58/10000 (0.5800%)
time spent on training: 171.86236429214478
[foolsgold agg] training data poison_ratio: 0.0  data num: [901, 946, 426, 2227, 735, 669, 1662, 1154, 1131, 1427]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 42: Avg loss: 5.3122, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Avg loss: 5.5670, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 243.52287602424622 sec.
Server Epoch:43 choose agents : [30, 90, 78, 76, 95, 4, 91, 40, 31, 21].
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0806, Accuracy: 70/486 (14.4033%)
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0408, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 5.7651, Accuracy: 39/10000 (0.3900%)
___Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 319/677 (47.1196%)
___Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 456/677 (67.3560%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.0726, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  43, local model 78, internal_epoch   1, Avg loss: 0.0834, Accuracy: 32/416 (7.6923%)
___Train Local_ResNet_18, epoch  43, local model 78, internal_epoch   2, Avg loss: 0.0471, Accuracy: 185/416 (44.4712%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 5.5448, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 76, internal_epoch   1, Avg loss: 0.0862, Accuracy: 46/466 (9.8712%)
___Train Local_ResNet_18, epoch  43, local model 76, internal_epoch   2, Avg loss: 0.0483, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 5.6069, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 95, internal_epoch   1, Avg loss: 0.0511, Accuracy: 332/599 (55.4257%)
___Train Local_ResNet_18, epoch  43, local model 95, internal_epoch   2, Avg loss: 0.0295, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.7131, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   1, Avg loss: 0.0589, Accuracy: 326/901 (36.1820%)
___Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   2, Avg loss: 0.0322, Accuracy: 404/901 (44.8391%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.9002, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   1, Avg loss: 0.0546, Accuracy: 341/1030 (33.1068%)
___Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   2, Avg loss: 0.0247, Accuracy: 654/1030 (63.4951%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.1129, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0557, Accuracy: 367/1573 (23.3312%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 550/1573 (34.9650%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.2584, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  43, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 65/460 (14.1304%)
___Train Local_ResNet_18, epoch  43, local model 31, internal_epoch   2, Avg loss: 0.0368, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 5.7607, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 394/1949 (20.2155%)
___Train Local_ResNet_18, epoch  43, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 628/1949 (32.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.2363, Accuracy: 86/10000 (0.8600%)
time spent on training: 158.34876418113708
[foolsgold agg] training data poison_ratio: 0.0  data num: [486, 677, 416, 466, 599, 901, 1030, 1573, 460, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 43: Avg loss: 5.3122, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Avg loss: 5.5672, Accuracy: 0/9950 (0.0000%)
saving model
Done in 227.17339754104614 sec.
Server Epoch:44 choose agents : [99, 52, 94, 4, 15, 32, 64, 58, 36, 57].
___Train Local_ResNet_18, epoch  44, local model 99, internal_epoch   1, Avg loss: 0.0663, Accuracy: 172/773 (22.2510%)
___Train Local_ResNet_18, epoch  44, local model 99, internal_epoch   2, Avg loss: 0.0297, Accuracy: 384/773 (49.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.9205, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   1, Avg loss: 0.0564, Accuracy: 289/636 (45.4403%)
___Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   2, Avg loss: 0.0310, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.2934, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 333/1662 (20.0361%)
___Train Local_ResNet_18, epoch  44, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 613/1662 (36.8833%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.0256, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0650, Accuracy: 327/901 (36.2930%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0304, Accuracy: 396/901 (43.9512%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.6746, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 321/1154 (27.8163%)
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0297, Accuracy: 387/1154 (33.5355%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.3313, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0598, Accuracy: 202/735 (27.4830%)
___Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 330/735 (44.8980%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.8952, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 168/953 (17.6285%)
___Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 309/953 (32.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.3109, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   1, Avg loss: 0.0563, Accuracy: 353/803 (43.9601%)
___Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 407/803 (50.6849%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.0100, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.0865, Accuracy: 80/408 (19.6078%)
___Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0546, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 5.4874, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 303/1154 (26.2565%)
___Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0293, Accuracy: 509/1154 (44.1075%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.7567, Accuracy: 74/10000 (0.7400%)
time spent on training: 156.99310636520386
[foolsgold agg] training data poison_ratio: 0.0  data num: [773, 636, 1662, 901, 1154, 735, 953, 803, 408, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 44: Avg loss: 5.3122, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Avg loss: 5.5630, Accuracy: 0/9950 (0.0000%)
saving model
Done in 229.02928137779236 sec.
Server Epoch:45 choose agents : [29, 81, 27, 2, 94, 56, 14, 99, 62, 76].
___Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   1, Avg loss: 0.0498, Accuracy: 396/1440 (27.5000%)
___Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 678/1440 (47.0833%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.7470, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  45, local model 81, internal_epoch   1, Avg loss: 0.0683, Accuracy: 241/774 (31.1370%)
___Train Local_ResNet_18, epoch  45, local model 81, internal_epoch   2, Avg loss: 0.0377, Accuracy: 278/774 (35.9173%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.4580, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   1, Avg loss: 0.0537, Accuracy: 399/1587 (25.1418%)
___Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   2, Avg loss: 0.0343, Accuracy: 579/1587 (36.4839%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.4209, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   1, Avg loss: 0.0621, Accuracy: 243/605 (40.1653%)
___Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   2, Avg loss: 0.0400, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.8532, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 342/1662 (20.5776%)
___Train Local_ResNet_18, epoch  45, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 639/1662 (38.4477%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.6033, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   2, Avg loss: 0.0670, Accuracy: 74/186 (39.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 229/1013 (22.6061%)
___Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 312/1013 (30.7996%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.7633, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  45, local model 99, internal_epoch   1, Avg loss: 0.0659, Accuracy: 178/773 (23.0272%)
___Train Local_ResNet_18, epoch  45, local model 99, internal_epoch   2, Avg loss: 0.0297, Accuracy: 406/773 (52.5226%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.1580, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0685, Accuracy: 146/568 (25.7042%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0412, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.7739, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 49/466 (10.5150%)
___Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0475, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.6112, Accuracy: 50/10000 (0.5000%)
time spent on training: 152.93665051460266
[foolsgold agg] training data poison_ratio: 0.0  data num: [1440, 774, 1587, 605, 1662, 186, 1013, 773, 568, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.3120, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Avg loss: 5.5623, Accuracy: 0/9950 (0.0000%)
saving model
Done in 224.3413586616516 sec.
Server Epoch:46 choose agents : [97, 54, 16, 75, 96, 90, 39, 50, 12, 17].
___Train Local_ResNet_18, epoch  46, local model 97, internal_epoch   1, Avg loss: 0.0525, Accuracy: 369/1213 (30.4204%)
___Train Local_ResNet_18, epoch  46, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 492/1213 (40.5606%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.4196, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   1, Avg loss: 0.0552, Accuracy: 342/1130 (30.2655%)
___Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 482/1130 (42.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.9186, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0691, Accuracy: 275/708 (38.8418%)
___Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0331, Accuracy: 430/708 (60.7345%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.8496, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  46, local model 75, internal_epoch   1, Avg loss: 0.0646, Accuracy: 252/776 (32.4742%)
___Train Local_ResNet_18, epoch  46, local model 75, internal_epoch   2, Avg loss: 0.0281, Accuracy: 418/776 (53.8660%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.0068, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 48/311 (15.4341%)
___Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.3444, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 90, internal_epoch   1, Avg loss: 0.0568, Accuracy: 314/677 (46.3811%)
___Train Local_ResNet_18, epoch  46, local model 90, internal_epoch   2, Avg loss: 0.0225, Accuracy: 453/677 (66.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 6.8977, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   1, Avg loss: 0.0536, Accuracy: 313/1013 (30.8983%)
___Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 530/1013 (52.3198%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.7243, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  46, local model 50, internal_epoch   1, Avg loss: 0.0629, Accuracy: 167/809 (20.6428%)
___Train Local_ResNet_18, epoch  46, local model 50, internal_epoch   2, Avg loss: 0.0266, Accuracy: 350/809 (43.2633%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.0096, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  46, local model 12, internal_epoch   1, Avg loss: 0.0859, Accuracy: 27/338 (7.9882%)
___Train Local_ResNet_18, epoch  46, local model 12, internal_epoch   2, Avg loss: 0.0457, Accuracy: 143/338 (42.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.4645, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 409/1574 (25.9848%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 678/1574 (43.0750%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.0368, Accuracy: 99/10000 (0.9900%)
time spent on training: 150.3995397090912
[foolsgold agg] training data poison_ratio: 0.0  data num: [1213, 1130, 708, 776, 311, 677, 1013, 809, 338, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.3119, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Avg loss: 5.5618, Accuracy: 0/9950 (0.0000%)
saving model
Done in 223.6219346523285 sec.
Server Epoch:47 choose agents : [66, 77, 20, 72, 32, 75, 26, 83, 55, 13].
___Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   1, Avg loss: 0.0618, Accuracy: 268/1402 (19.1155%)
___Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 382/1402 (27.2468%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.2661, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  47, local model 77, internal_epoch   1, Avg loss: 0.0531, Accuracy: 335/1340 (25.0000%)
___Train Local_ResNet_18, epoch  47, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 576/1340 (42.9851%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.7114, Accuracy: 65/10000 (0.6500%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  47, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 350/807 (43.3705%)
___Train Local_ResNet_18, epoch  47, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 423/807 (52.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.6511, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   1, Avg loss: 0.0612, Accuracy: 265/1241 (21.3537%)
___Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 386/1241 (31.1039%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.2485, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 200/735 (27.2109%)
___Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 368/735 (50.0680%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.7304, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0635, Accuracy: 251/776 (32.3454%)
___Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 428/776 (55.1546%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.8160, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 344/1446 (23.7898%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 480/1446 (33.1950%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.3455, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  47, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 399/1953 (20.4301%)
___Train Local_ResNet_18, epoch  47, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 731/1953 (37.4296%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.9389, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  47, local model 55, internal_epoch   1, Avg loss: 0.0560, Accuracy: 241/1071 (22.5023%)
___Train Local_ResNet_18, epoch  47, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 473/1071 (44.1643%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.0815, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   1, Avg loss: 0.0576, Accuracy: 311/1645 (18.9058%)
___Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 612/1645 (37.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.9558, Accuracy: 109/10000 (1.0900%)
time spent on training: 197.33050417900085
[foolsgold agg] training data poison_ratio: 0.06499677835051547  data num: [1402, 1340, 807, 1241, 735, 776, 1446, 1953, 1071, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.020311493234536085
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 47: Avg loss: 5.3118, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Avg loss: 5.5580, Accuracy: 0/9950 (0.0000%)
saving model
Done in 268.46539187431335 sec.
Server Epoch:48 choose agents : [42, 90, 83, 4, 11, 19, 73, 61, 96, 39].
___Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 357/1372 (26.0204%)
___Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 563/1372 (41.0350%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.0278, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0568, Accuracy: 326/677 (48.1536%)
___Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 460/677 (67.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.2734, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  48, local model 83, internal_epoch   1, Avg loss: 0.0534, Accuracy: 434/1953 (22.2222%)
___Train Local_ResNet_18, epoch  48, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 794/1953 (40.6554%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.5888, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   1, Avg loss: 0.0608, Accuracy: 332/901 (36.8479%)
___Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   2, Avg loss: 0.0328, Accuracy: 388/901 (43.0633%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.8409, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   1, Avg loss: 0.0526, Accuracy: 341/712 (47.8933%)
___Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   2, Avg loss: 0.0264, Accuracy: 446/712 (62.6404%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.6481, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 408/1036 (39.3822%)
___Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0237, Accuracy: 669/1036 (64.5753%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.2061, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   1, Avg loss: 0.0657, Accuracy: 175/938 (18.6567%)
___Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 326/938 (34.7548%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.9750, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   1, Avg loss: 0.1257, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   2, Avg loss: 0.1165, Accuracy: 8/85 (9.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 5.3040, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 47/311 (15.1125%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0539, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 5.3460, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 311/1013 (30.7009%)
___Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 500/1013 (49.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.7940, Accuracy: 63/10000 (0.6300%)
time spent on training: 154.4872863292694
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 677, 1953, 901, 712, 1036, 938, 85, 311, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 48: Avg loss: 5.3117, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Avg loss: 5.5562, Accuracy: 0/9950 (0.0000%)
saving model
Done in 225.40515327453613 sec.
Server Epoch:49 choose agents : [20, 2, 31, 41, 84, 98, 18, 69, 11, 22].
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  49, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 355/807 (43.9901%)
___Train Local_ResNet_18, epoch  49, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 412/807 (51.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 6.9243, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0640, Accuracy: 237/605 (39.1736%)
___Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0388, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 5.8829, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   1, Avg loss: 0.0824, Accuracy: 50/460 (10.8696%)
___Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   2, Avg loss: 0.0365, Accuracy: 190/460 (41.3043%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 5.7848, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0594, Accuracy: 334/719 (46.4534%)
___Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0307, Accuracy: 474/719 (65.9249%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 6.2410, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  49, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 320/1190 (26.8908%)
___Train Local_ResNet_18, epoch  49, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 416/1190 (34.9580%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 6.9590, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   1, Avg loss: 0.0823, Accuracy: 17/373 (4.5576%)
___Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   2, Avg loss: 0.0489, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 5.4428, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0759, Accuracy: 123/530 (23.2075%)
___Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0383, Accuracy: 269/530 (50.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 6.0144, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   1, Avg loss: 0.0550, Accuracy: 284/590 (48.1356%)
___Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   2, Avg loss: 0.0346, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.2126, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 11, internal_epoch   1, Avg loss: 0.0542, Accuracy: 357/712 (50.1404%)
___Train Local_ResNet_18, epoch  49, local model 11, internal_epoch   2, Avg loss: 0.0263, Accuracy: 403/712 (56.6011%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 6.4393, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  49, local model 22, internal_epoch   1, Avg loss: 0.0446, Accuracy: 544/1470 (37.0068%)
___Train Local_ResNet_18, epoch  49, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 810/1470 (55.1020%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3482, Accuracy: 75/10000 (0.7500%)
time spent on training: 166.972900390625
[foolsgold agg] training data poison_ratio: 0.10823497854077253  data num: [807, 605, 460, 719, 1190, 373, 530, 590, 712, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.033823430793991416
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 49: Avg loss: 5.3117, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Avg loss: 5.5562, Accuracy: 0/9950 (0.0000%)
saving model
Done in 238.51319289207458 sec.
Server Epoch:50 choose agents : [40, 49, 82, 52, 64, 6, 61, 8, 71, 42].
___Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 369/1573 (23.4584%)
___Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 596/1573 (37.8894%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.6937, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   1, Avg loss: 0.0792, Accuracy: 29/440 (6.5909%)
___Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   2, Avg loss: 0.0475, Accuracy: 145/440 (32.9545%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 5.5204, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 82, internal_epoch   1, Avg loss: 0.0768, Accuracy: 68/500 (13.6000%)
___Train Local_ResNet_18, epoch  50, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 171/500 (34.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 5.6019, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0566, Accuracy: 280/636 (44.0252%)
___Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.1153, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 163/953 (17.1039%)
___Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 315/953 (33.0535%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.3606, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 399/1956 (20.3988%)
___Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 673/1956 (34.4070%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.0486, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   1, Avg loss: 0.1249, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   2, Avg loss: 0.1146, Accuracy: 7/85 (8.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 5.3038, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 261/1513 (17.2505%)
___Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   2, Avg loss: 0.0361, Accuracy: 491/1513 (32.4521%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.3479, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  50, local model 71, internal_epoch   1, Avg loss: 0.0636, Accuracy: 169/818 (20.6601%)
___Train Local_ResNet_18, epoch  50, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 359/818 (43.8875%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.5184, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   1, Avg loss: 0.0525, Accuracy: 359/1372 (26.1662%)
___Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 503/1372 (36.6618%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.8338, Accuracy: 82/10000 (0.8200%)
time spent on training: 160.74014520645142
[foolsgold agg] training data poison_ratio: 0.0  data num: [1573, 440, 500, 636, 953, 1956, 85, 1513, 818, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 50: Avg loss: 5.3116, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Avg loss: 5.5550, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 233.5371596813202 sec.
Server Epoch:51 choose agents : [5, 57, 22, 34, 60, 42, 12, 72, 7, 93].
___Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   1, Avg loss: 0.0511, Accuracy: 390/1628 (23.9558%)
___Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 776/1628 (47.6658%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.1921, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   1, Avg loss: 0.0557, Accuracy: 306/1154 (26.5165%)
___Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   2, Avg loss: 0.0253, Accuracy: 536/1154 (46.4471%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.9463, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 502/1470 (34.1497%)
___Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 828/1470 (56.3265%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.9846, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 380/1427 (26.6293%)
___Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 591/1427 (41.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 6.9082, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 524/2227 (23.5294%)
___Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 991/2227 (44.4993%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.3970, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 352/1372 (25.6560%)
___Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 475/1372 (34.6210%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.1272, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   1, Avg loss: 0.0860, Accuracy: 25/338 (7.3964%)
___Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   2, Avg loss: 0.0455, Accuracy: 146/338 (43.1953%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 5.4533, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 266/1241 (21.4343%)
___Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 429/1241 (34.5689%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.5543, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 348/891 (39.0572%)
___Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 430/891 (48.2604%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.2342, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0542, Accuracy: 416/1742 (23.8806%)
___Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 727/1742 (41.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.9840, Accuracy: 93/10000 (0.9300%)
time spent on training: 218.44659066200256
[foolsgold agg] training data poison_ratio: 0.0  data num: [1628, 1154, 1470, 1427, 2227, 1372, 338, 1241, 891, 1742]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 51: Avg loss: 5.3115, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 51: Avg loss: 5.5536, Accuracy: 0/9950 (0.0000%)
saving model
Done in 288.71391105651855 sec.
Server Epoch:52 choose agents : [90, 34, 84, 61, 58, 18, 42, 1, 32, 31].
___Train Local_ResNet_18, epoch  52, local model 90, internal_epoch   1, Avg loss: 0.0561, Accuracy: 329/677 (48.5968%)
___Train Local_ResNet_18, epoch  52, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 435/677 (64.2541%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.3754, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 419/1427 (29.3623%)
___Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   2, Avg loss: 0.0328, Accuracy: 590/1427 (41.3455%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 6.8179, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  52, local model 84, internal_epoch   1, Avg loss: 0.0615, Accuracy: 327/1190 (27.4790%)
___Train Local_ResNet_18, epoch  52, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 450/1190 (37.8151%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 6.9185, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1244, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1148, Accuracy: 10/85 (11.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 5.3043, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0571, Accuracy: 348/803 (43.3375%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0348, Accuracy: 387/803 (48.1943%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 6.0454, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0762, Accuracy: 117/530 (22.0755%)
___Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0397, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 6.1609, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 352/1372 (25.6560%)
___Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 536/1372 (39.0671%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.7417, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  52, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 292/928 (31.4655%)
___Train Local_ResNet_18, epoch  52, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 525/928 (56.5733%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.5479, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0595, Accuracy: 205/735 (27.8912%)
___Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 361/735 (49.1156%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.0320, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0809, Accuracy: 60/460 (13.0435%)
___Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0368, Accuracy: 186/460 (40.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 5.8275, Accuracy: 50/10000 (0.5000%)
time spent on training: 156.1859369277954
[foolsgold agg] training data poison_ratio: 0.0  data num: [677, 1427, 1190, 85, 803, 530, 1372, 928, 735, 460]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 0. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 52: Avg loss: 5.3114, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 52: Avg loss: 5.5507, Accuracy: 0/9950 (0.0000%)
saving model
Done in 225.68475341796875 sec.
Server Epoch:53 choose agents : [44, 27, 62, 20, 28, 49, 40, 8, 16, 22].
___Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 397/1750 (22.6857%)
___Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 683/1750 (39.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.4658, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0539, Accuracy: 415/1587 (26.1500%)
___Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 593/1587 (37.3661%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.1416, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 148/568 (26.0563%)
___Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 5.7947, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  53, local model 20, internal_epoch   1, Avg loss: 0.0564, Accuracy: 352/807 (43.6183%)
___Train Local_ResNet_18, epoch  53, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 417/807 (51.6729%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 6.7973, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 388/1581 (24.5414%)
___Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 570/1581 (36.0531%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.6179, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 37/440 (8.4091%)
___Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   2, Avg loss: 0.0480, Accuracy: 155/440 (35.2273%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 5.5048, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0542, Accuracy: 369/1573 (23.4584%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 593/1573 (37.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.6855, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 245/1513 (16.1930%)
___Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 481/1513 (31.7911%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.4821, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  53, local model 16, internal_epoch   1, Avg loss: 0.0615, Accuracy: 280/708 (39.5480%)
___Train Local_ResNet_18, epoch  53, local model 16, internal_epoch   2, Avg loss: 0.0371, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 5.9396, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  53, local model 22, internal_epoch   1, Avg loss: 0.0451, Accuracy: 558/1470 (37.9592%)
___Train Local_ResNet_18, epoch  53, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 849/1470 (57.7551%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.2162, Accuracy: 74/10000 (0.7400%)
time spent on training: 219.27587747573853
[foolsgold agg] training data poison_ratio: 0.06726681670417604  data num: [1750, 1587, 568, 807, 1581, 440, 1573, 1513, 708, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.021020880220055015
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 53: Avg loss: 5.3114, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 53: Avg loss: 5.5511, Accuracy: 0/9950 (0.0000%)
saving model
Done in 289.0104308128357 sec.
Server Epoch:54 choose agents : [38, 69, 16, 89, 47, 84, 8, 7, 93, 54].
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0612, Accuracy: 251/1131 (22.1927%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 455/1131 (40.2299%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.3684, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   1, Avg loss: 0.0557, Accuracy: 289/590 (48.9831%)
___Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   2, Avg loss: 0.0319, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.9560, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   1, Avg loss: 0.0615, Accuracy: 282/708 (39.8305%)
___Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   2, Avg loss: 0.0373, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 5.8417, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  54, local model 89, internal_epoch   1, Avg loss: 0.0613, Accuracy: 322/896 (35.9375%)
___Train Local_ResNet_18, epoch  54, local model 89, internal_epoch   2, Avg loss: 0.0342, Accuracy: 419/896 (46.7634%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.2304, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1216, Accuracy: 2/134 (1.4925%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1083, Accuracy: 17/134 (12.6866%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 5.3098, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 84, internal_epoch   1, Avg loss: 0.0615, Accuracy: 320/1190 (26.8908%)
___Train Local_ResNet_18, epoch  54, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 444/1190 (37.3109%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.9591, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0599, Accuracy: 250/1513 (16.5235%)
___Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0361, Accuracy: 481/1513 (31.7911%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.3776, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 351/891 (39.3939%)
___Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0253, Accuracy: 456/891 (51.1785%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.9639, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 93, internal_epoch   1, Avg loss: 0.0550, Accuracy: 423/1742 (24.2824%)
___Train Local_ResNet_18, epoch  54, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 705/1742 (40.4707%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.6995, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  54, local model 54, internal_epoch   1, Avg loss: 0.0549, Accuracy: 344/1130 (30.4425%)
___Train Local_ResNet_18, epoch  54, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 445/1130 (39.3805%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.6493, Accuracy: 50/10000 (0.5000%)
time spent on training: 186.91142082214355
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 590, 708, 896, 134, 1190, 1513, 891, 1742, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 54: Avg loss: 5.3113, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 54: Avg loss: 5.5511, Accuracy: 0/9950 (0.0000%)
saving model
Done in 258.8858208656311 sec.
Server Epoch:55 choose agents : [88, 77, 16, 55, 79, 13, 61, 12, 27, 98].
___Train Local_ResNet_18, epoch  55, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 143/603 (23.7148%)
___Train Local_ResNet_18, epoch  55, local model 88, internal_epoch   2, Avg loss: 0.0463, Accuracy: 281/603 (46.6003%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.9741, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  55, local model 77, internal_epoch   1, Avg loss: 0.0527, Accuracy: 335/1340 (25.0000%)
___Train Local_ResNet_18, epoch  55, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 584/1340 (43.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.8401, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   1, Avg loss: 0.0601, Accuracy: 287/708 (40.5367%)
___Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   2, Avg loss: 0.0377, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.9962, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 260/1071 (24.2764%)
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0284, Accuracy: 526/1071 (49.1130%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.1364, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  55, local model 79, internal_epoch   1, Avg loss: 0.1042, Accuracy: 14/197 (7.1066%)
___Train Local_ResNet_18, epoch  55, local model 79, internal_epoch   2, Avg loss: 0.0832, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.3199, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 307/1645 (18.6626%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 603/1645 (36.6565%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.8505, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   1, Avg loss: 0.1253, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   2, Avg loss: 0.1173, Accuracy: 10/85 (11.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.3038, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0854, Accuracy: 26/338 (7.6923%)
___Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0486, Accuracy: 149/338 (44.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.4764, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 457/1587 (28.7965%)
___Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 626/1587 (39.4455%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.0621, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  55, local model 98, internal_epoch   1, Avg loss: 0.0824, Accuracy: 16/373 (4.2895%)
___Train Local_ResNet_18, epoch  55, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.4550, Accuracy: 50/10000 (0.5000%)
time spent on training: 164.17024278640747
[foolsgold agg] training data poison_ratio: 0.0  data num: [603, 1340, 708, 1071, 197, 1645, 85, 338, 1587, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.3112, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 55: Avg loss: 5.5508, Accuracy: 0/9950 (0.0000%)
saving model
Done in 233.52549862861633 sec.
Server Epoch:56 choose agents : [41, 84, 47, 20, 89, 72, 45, 32, 26, 7].
___Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   1, Avg loss: 0.0586, Accuracy: 337/719 (46.8707%)
___Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   2, Avg loss: 0.0310, Accuracy: 465/719 (64.6732%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.2818, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   1, Avg loss: 0.0615, Accuracy: 335/1190 (28.1513%)
___Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 449/1190 (37.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.1141, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   1, Avg loss: 0.1201, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   2, Avg loss: 0.1098, Accuracy: 13/134 (9.7015%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  56, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 343/807 (42.5031%)
___Train Local_ResNet_18, epoch  56, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 411/807 (50.9294%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.7328, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  56, local model 89, internal_epoch   1, Avg loss: 0.0598, Accuracy: 327/896 (36.4955%)
___Train Local_ResNet_18, epoch  56, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 443/896 (49.4420%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.3601, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   1, Avg loss: 0.0613, Accuracy: 243/1241 (19.5810%)
___Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 401/1241 (32.3127%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.0943, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   1, Avg loss: 0.0678, Accuracy: 200/669 (29.8954%)
___Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   2, Avg loss: 0.0397, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 5.8583, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   1, Avg loss: 0.0601, Accuracy: 205/735 (27.8912%)
___Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 350/735 (47.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.1094, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 360/1446 (24.8963%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 493/1446 (34.0941%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.2764, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  56, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 348/891 (39.0572%)
___Train Local_ResNet_18, epoch  56, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 433/891 (48.5971%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.9206, Accuracy: 52/10000 (0.5200%)
time spent on training: 182.13456273078918
[foolsgold agg] training data poison_ratio: 0.09246104491292392  data num: [719, 1190, 134, 807, 896, 1241, 669, 735, 1446, 891]
[foolsgold agg] considering poison per batch poison_fraction: 0.028894076535288728
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 56: Avg loss: 5.3112, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 56: Avg loss: 5.5474, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.94428968429565 sec.
Server Epoch:57 choose agents : [40, 56, 4, 32, 74, 75, 70, 88, 9, 35].
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0552, Accuracy: 345/1573 (21.9326%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0351, Accuracy: 574/1573 (36.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.2605, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.0825, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0670, Accuracy: 69/186 (37.0968%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 5.3114, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   1, Avg loss: 0.0597, Accuracy: 335/901 (37.1809%)
___Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   2, Avg loss: 0.0349, Accuracy: 416/901 (46.1709%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.9124, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0594, Accuracy: 201/735 (27.3469%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0221, Accuracy: 364/735 (49.5238%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.9810, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 483/1552 (31.1211%)
___Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 780/1552 (50.2577%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 10.0967, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   1, Avg loss: 0.0644, Accuracy: 253/776 (32.6031%)
___Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   2, Avg loss: 0.0292, Accuracy: 412/776 (53.0928%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.9916, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0562, Accuracy: 352/1418 (24.8237%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 663/1418 (46.7560%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.5232, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  57, local model 88, internal_epoch   1, Avg loss: 0.0741, Accuracy: 146/603 (24.2123%)
___Train Local_ResNet_18, epoch  57, local model 88, internal_epoch   2, Avg loss: 0.0468, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 5.9893, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   1, Avg loss: 0.0497, Accuracy: 365/1275 (28.6275%)
___Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 694/1275 (54.4314%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.1555, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  57, local model 35, internal_epoch   1, Avg loss: 0.0852, Accuracy: 44/271 (16.2362%)
___Train Local_ResNet_18, epoch  57, local model 35, internal_epoch   2, Avg loss: 0.0544, Accuracy: 109/271 (40.2214%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 5.3754, Accuracy: 50/10000 (0.5000%)
time spent on training: 188.03724431991577
[foolsgold agg] training data poison_ratio: 0.0  data num: [1573, 186, 901, 735, 1552, 776, 1418, 603, 1275, 271]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 57: Avg loss: 5.3111, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 57: Avg loss: 5.5448, Accuracy: 0/9950 (0.0000%)
saving model
Done in 259.01930594444275 sec.
Server Epoch:58 choose agents : [34, 31, 89, 35, 74, 19, 27, 24, 33, 23].
___Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 393/1427 (27.5403%)
___Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 586/1427 (41.0652%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.9911, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0814, Accuracy: 57/460 (12.3913%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0383, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.6909, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 334/896 (37.2768%)
___Train Local_ResNet_18, epoch  58, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 438/896 (48.8839%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.3899, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   1, Avg loss: 0.0855, Accuracy: 43/271 (15.8672%)
___Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   2, Avg loss: 0.0539, Accuracy: 102/271 (37.6384%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.3657, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  58, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 511/1552 (32.9253%)
___Train Local_ResNet_18, epoch  58, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 767/1552 (49.4201%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 11.1559, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0465, Accuracy: 369/1036 (35.6178%)
___Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0252, Accuracy: 650/1036 (62.7413%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.0629, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 445/1587 (28.0403%)
___Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 615/1587 (38.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.3980, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   1, Avg loss: 0.0758, Accuracy: 43/312 (13.7821%)
___Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   2, Avg loss: 0.0395, Accuracy: 161/312 (51.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.4004, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0780, Accuracy: 66/515 (12.8155%)
___Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0514, Accuracy: 116/515 (22.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.7621, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0603, Accuracy: 323/715 (45.1748%)
___Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0385, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.7816, Accuracy: 50/10000 (0.5000%)
time spent on training: 161.24867057800293
[foolsgold agg] training data poison_ratio: 0.0  data num: [1427, 460, 896, 271, 1552, 1036, 1587, 312, 515, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.3111, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 58: Avg loss: 5.5450, Accuracy: 0/9950 (0.0000%)
saving model
Done in 234.4373598098755 sec.
Server Epoch:59 choose agents : [69, 83, 6, 40, 21, 23, 97, 75, 53, 99].
___Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   1, Avg loss: 0.0585, Accuracy: 285/590 (48.3051%)
___Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   2, Avg loss: 0.0308, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.9193, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 427/1953 (21.8638%)
___Train Local_ResNet_18, epoch  59, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 749/1953 (38.3513%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.1303, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 398/1956 (20.3476%)
___Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 668/1956 (34.1513%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.0396, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 354/1573 (22.5048%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 569/1573 (36.1729%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.4817, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 406/1949 (20.8312%)
___Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 635/1949 (32.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.4974, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0623, Accuracy: 321/715 (44.8951%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0384, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 5.7611, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 360/1213 (29.6785%)
___Train Local_ResNet_18, epoch  59, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 503/1213 (41.4674%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.6812, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  59, local model 75, internal_epoch   1, Avg loss: 0.0647, Accuracy: 245/776 (31.5722%)
___Train Local_ResNet_18, epoch  59, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 416/776 (53.6082%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.0492, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   1, Avg loss: 0.0493, Accuracy: 270/813 (33.2103%)
___Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 457/813 (56.2116%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.8681, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   1, Avg loss: 0.0644, Accuracy: 197/773 (25.4851%)
___Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   2, Avg loss: 0.0304, Accuracy: 414/773 (53.5576%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.2808, Accuracy: 50/10000 (0.5000%)
time spent on training: 213.63946223258972
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 1953, 1956, 1573, 1949, 715, 1213, 776, 813, 773]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 59: Avg loss: 5.3109, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 59: Avg loss: 5.5446, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.6248803138733 sec.
Server Epoch:60 choose agents : [51, 98, 53, 74, 42, 61, 12, 54, 70, 11].
___Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   1, Avg loss: 0.0598, Accuracy: 232/1049 (22.1163%)
___Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   2, Avg loss: 0.0293, Accuracy: 546/1049 (52.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.3109, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  60, local model 98, internal_epoch   1, Avg loss: 0.0821, Accuracy: 19/373 (5.0938%)
___Train Local_ResNet_18, epoch  60, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 5.4374, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0503, Accuracy: 279/813 (34.3173%)
___Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0192, Accuracy: 432/813 (53.1365%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.3469, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  60, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 500/1552 (32.2165%)
___Train Local_ResNet_18, epoch  60, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 762/1552 (49.0979%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.6563, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0527, Accuracy: 368/1372 (26.8222%)
___Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 513/1372 (37.3907%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.9180, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   1, Avg loss: 0.1247, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   2, Avg loss: 0.1162, Accuracy: 8/85 (9.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 5.3037, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   1, Avg loss: 0.0860, Accuracy: 28/338 (8.2840%)
___Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   2, Avg loss: 0.0460, Accuracy: 148/338 (43.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 5.4596, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 347/1130 (30.7080%)
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 495/1130 (43.8053%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.9408, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   1, Avg loss: 0.0553, Accuracy: 344/1418 (24.2595%)
___Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 656/1418 (46.2623%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.7477, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0531, Accuracy: 355/712 (49.8596%)
___Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0272, Accuracy: 427/712 (59.9719%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.8484, Accuracy: 49/10000 (0.4900%)
time spent on training: 179.425714969635
[foolsgold agg] training data poison_ratio: 0.0  data num: [1049, 373, 813, 1552, 1372, 85, 338, 1130, 1418, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 60: Avg loss: 5.3109, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 60: Avg loss: 5.5448, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 248.54301524162292 sec.
Server Epoch:61 choose agents : [84, 20, 51, 25, 38, 6, 55, 53, 12, 69].
___Train Local_ResNet_18, epoch  61, local model 84, internal_epoch   1, Avg loss: 0.0621, Accuracy: 330/1190 (27.7311%)
___Train Local_ResNet_18, epoch  61, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 441/1190 (37.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.7914, Accuracy: 74/10000 (0.7400%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  61, local model 20, internal_epoch   1, Avg loss: 0.0553, Accuracy: 353/807 (43.7423%)
___Train Local_ResNet_18, epoch  61, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 436/807 (54.0273%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.8529, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 232/1049 (22.1163%)
___Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   2, Avg loss: 0.0297, Accuracy: 504/1049 (48.0458%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.4479, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 309/690 (44.7826%)
___Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 461/690 (66.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.4751, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   1, Avg loss: 0.0610, Accuracy: 252/1131 (22.2812%)
___Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 484/1131 (42.7940%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.6058, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 409/1956 (20.9100%)
___Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 651/1956 (33.2822%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.5113, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0553, Accuracy: 273/1071 (25.4902%)
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 506/1071 (47.2456%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.9112, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 280/813 (34.4403%)
___Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 455/813 (55.9656%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.4279, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0850, Accuracy: 33/338 (9.7633%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0466, Accuracy: 129/338 (38.1657%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 5.4721, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   1, Avg loss: 0.0569, Accuracy: 294/590 (49.8305%)
___Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   2, Avg loss: 0.0294, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.0578, Accuracy: 50/10000 (0.5000%)
time spent on training: 210.54037928581238
[foolsgold agg] training data poison_ratio: 0.08375713544369487  data num: [1190, 807, 1049, 690, 1131, 1956, 1071, 813, 338, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.02617410482615465
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 61: Avg loss: 5.3108, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 61: Avg loss: 5.5452, Accuracy: 0/9950 (0.0000%)
saving model
Done in 281.0052115917206 sec.
Server Epoch:62 choose agents : [83, 78, 24, 81, 4, 30, 93, 33, 69, 60].
___Train Local_ResNet_18, epoch  62, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 429/1953 (21.9662%)
___Train Local_ResNet_18, epoch  62, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 761/1953 (38.9657%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.0764, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  62, local model 78, internal_epoch   1, Avg loss: 0.0830, Accuracy: 47/416 (11.2981%)
___Train Local_ResNet_18, epoch  62, local model 78, internal_epoch   2, Avg loss: 0.0451, Accuracy: 194/416 (46.6346%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.5724, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   1, Avg loss: 0.0753, Accuracy: 40/312 (12.8205%)
___Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   2, Avg loss: 0.0397, Accuracy: 170/312 (54.4872%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.3873, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.0655, Accuracy: 249/774 (32.1705%)
___Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0368, Accuracy: 299/774 (38.6305%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.3455, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   1, Avg loss: 0.0627, Accuracy: 330/901 (36.6260%)
___Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   2, Avg loss: 0.0335, Accuracy: 380/901 (42.1754%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.9592, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   1, Avg loss: 0.0796, Accuracy: 72/486 (14.8148%)
___Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.7808, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  62, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 412/1742 (23.6510%)
___Train Local_ResNet_18, epoch  62, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 730/1742 (41.9059%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.5400, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   1, Avg loss: 0.0775, Accuracy: 77/515 (14.9515%)
___Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   2, Avg loss: 0.0530, Accuracy: 125/515 (24.2718%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.7677, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   1, Avg loss: 0.0550, Accuracy: 294/590 (49.8305%)
___Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   2, Avg loss: 0.0322, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.0964, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 618/2227 (27.7503%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1037/2227 (46.5649%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.1733, Accuracy: 127/10000 (1.2700%)
time spent on training: 179.83054566383362
[foolsgold agg] training data poison_ratio: 0.0  data num: [1953, 416, 312, 774, 901, 486, 1742, 515, 590, 2227]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.3108, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 62: Avg loss: 5.5443, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.44975209236145 sec.
Server Epoch:63 choose agents : [18, 64, 38, 94, 55, 90, 58, 59, 66, 76].
___Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0756, Accuracy: 118/530 (22.2642%)
___Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0394, Accuracy: 264/530 (49.8113%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.1177, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0637, Accuracy: 174/953 (18.2581%)
___Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 327/953 (34.3127%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.8233, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0611, Accuracy: 245/1131 (21.6622%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 462/1131 (40.8488%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.5132, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 325/1662 (19.5548%)
___Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 612/1662 (36.8231%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.7103, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   1, Avg loss: 0.0556, Accuracy: 241/1071 (22.5023%)
___Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 518/1071 (48.3660%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.7975, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  63, local model 90, internal_epoch   1, Avg loss: 0.0584, Accuracy: 324/677 (47.8582%)
___Train Local_ResNet_18, epoch  63, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 455/677 (67.2083%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.9870, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0571, Accuracy: 350/803 (43.5866%)
___Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0350, Accuracy: 382/803 (47.5716%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.0098, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 307/1089 (28.1910%)
___Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   2, Avg loss: 0.0278, Accuracy: 486/1089 (44.6281%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.1987, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   1, Avg loss: 0.0616, Accuracy: 263/1402 (18.7589%)
___Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 389/1402 (27.7461%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.1726, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.0852, Accuracy: 52/466 (11.1588%)
___Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 5.7497, Accuracy: 50/10000 (0.5000%)
time spent on training: 192.25415658950806
[foolsgold agg] training data poison_ratio: 0.0  data num: [530, 953, 1131, 1662, 1071, 677, 803, 1089, 1402, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 63: Avg loss: 5.3107, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 63: Avg loss: 5.5428, Accuracy: 0/9950 (0.0000%)
saving model
Done in 263.19514656066895 sec.
Server Epoch:64 choose agents : [77, 13, 57, 64, 48, 23, 71, 35, 32, 75].
___Train Local_ResNet_18, epoch  64, local model 77, internal_epoch   1, Avg loss: 0.0534, Accuracy: 318/1340 (23.7313%)
___Train Local_ResNet_18, epoch  64, local model 77, internal_epoch   2, Avg loss: 0.0267, Accuracy: 569/1340 (42.4627%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.4929, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 309/1645 (18.7842%)
___Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 617/1645 (37.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.0302, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   1, Avg loss: 0.0539, Accuracy: 296/1154 (25.6499%)
___Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   2, Avg loss: 0.0250, Accuracy: 530/1154 (45.9272%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.5178, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   1, Avg loss: 0.0638, Accuracy: 176/953 (18.4680%)
___Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   2, Avg loss: 0.0375, Accuracy: 317/953 (33.2634%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 6.5365, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   1, Avg loss: 0.0709, Accuracy: 103/631 (16.3233%)
___Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   2, Avg loss: 0.0406, Accuracy: 228/631 (36.1331%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.8798, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   1, Avg loss: 0.0617, Accuracy: 324/715 (45.3147%)
___Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   2, Avg loss: 0.0387, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.8122, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0631, Accuracy: 170/818 (20.7824%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 364/818 (44.4988%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.2164, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.0856, Accuracy: 43/271 (15.8672%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0573, Accuracy: 112/271 (41.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.3746, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   1, Avg loss: 0.0594, Accuracy: 204/735 (27.7551%)
___Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 344/735 (46.8027%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.8828, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  64, local model 75, internal_epoch   1, Avg loss: 0.0622, Accuracy: 248/776 (31.9588%)
___Train Local_ResNet_18, epoch  64, local model 75, internal_epoch   2, Avg loss: 0.0305, Accuracy: 414/776 (53.3505%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 6.9923, Accuracy: 50/10000 (0.5000%)
time spent on training: 185.76285243034363
[foolsgold agg] training data poison_ratio: 0.0  data num: [1340, 1645, 1154, 953, 631, 715, 818, 271, 735, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.3107, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 64: Avg loss: 5.5382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 254.62796115875244 sec.
Server Epoch:65 choose agents : [28, 37, 12, 15, 84, 30, 66, 73, 81, 11].
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 387/1581 (24.4782%)
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 612/1581 (38.7097%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.4174, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0518, Accuracy: 411/1129 (36.4039%)
___Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 731/1129 (64.7476%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.4809, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   1, Avg loss: 0.0854, Accuracy: 33/338 (9.7633%)
___Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   2, Avg loss: 0.0456, Accuracy: 147/338 (43.4911%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 5.4688, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   1, Avg loss: 0.0555, Accuracy: 327/1154 (28.3362%)
___Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 442/1154 (38.3016%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.6047, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  65, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 317/1190 (26.6387%)
___Train Local_ResNet_18, epoch  65, local model 84, internal_epoch   2, Avg loss: 0.0314, Accuracy: 474/1190 (39.8319%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.0586, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   1, Avg loss: 0.0801, Accuracy: 77/486 (15.8436%)
___Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 5.8081, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 262/1402 (18.6876%)
___Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 366/1402 (26.1056%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.0624, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   1, Avg loss: 0.0653, Accuracy: 168/938 (17.9104%)
___Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 320/938 (34.1151%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.4372, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  65, local model 81, internal_epoch   1, Avg loss: 0.0676, Accuracy: 240/774 (31.0078%)
___Train Local_ResNet_18, epoch  65, local model 81, internal_epoch   2, Avg loss: 0.0364, Accuracy: 296/774 (38.2429%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 6.3413, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0520, Accuracy: 346/712 (48.5955%)
___Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0283, Accuracy: 449/712 (63.0618%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 6.6781, Accuracy: 50/10000 (0.5000%)
time spent on training: 210.18087077140808
[foolsgold agg] training data poison_ratio: 0.0  data num: [1581, 1129, 338, 1154, 1190, 486, 1402, 938, 774, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 65: Avg loss: 5.3106, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 65: Avg loss: 5.5376, Accuracy: 0/9950 (0.0000%)
saving model
Done in 282.3707489967346 sec.
Server Epoch:66 choose agents : [89, 62, 94, 18, 81, 93, 91, 73, 7, 71].
___Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   1, Avg loss: 0.0609, Accuracy: 342/896 (38.1696%)
___Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 428/896 (47.7679%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.2977, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   1, Avg loss: 0.0684, Accuracy: 146/568 (25.7042%)
___Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   2, Avg loss: 0.0414, Accuracy: 263/568 (46.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.8189, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   1, Avg loss: 0.0547, Accuracy: 365/1662 (21.9615%)
___Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 635/1662 (38.2070%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.7293, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0768, Accuracy: 122/530 (23.0189%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0403, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.1387, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  66, local model 81, internal_epoch   1, Avg loss: 0.0680, Accuracy: 244/774 (31.5245%)
___Train Local_ResNet_18, epoch  66, local model 81, internal_epoch   2, Avg loss: 0.0371, Accuracy: 297/774 (38.3721%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.3028, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 428/1742 (24.5695%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 690/1742 (39.6096%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.9406, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  66, local model 91, internal_epoch   1, Avg loss: 0.0532, Accuracy: 330/1030 (32.0388%)
___Train Local_ResNet_18, epoch  66, local model 91, internal_epoch   2, Avg loss: 0.0247, Accuracy: 617/1030 (59.9029%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.3181, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   1, Avg loss: 0.0649, Accuracy: 181/938 (19.2964%)
___Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   2, Avg loss: 0.0333, Accuracy: 319/938 (34.0085%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.3719, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 362/891 (40.6285%)
___Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 421/891 (47.2503%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.0960, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0635, Accuracy: 172/818 (21.0269%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 363/818 (44.3765%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.5817, Accuracy: 47/10000 (0.4700%)
time spent on training: 182.82272577285767
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 568, 1662, 530, 774, 1742, 1030, 938, 891, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.       1.       1.       1.       1.       1.       1.       1.
 0.640576 1.      ]
___Test Target_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.3106, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 66: Avg loss: 5.5366, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.387503862381 sec.
Server Epoch:67 choose agents : [44, 83, 96, 56, 6, 74, 64, 39, 14, 77].
___Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   1, Avg loss: 0.0585, Accuracy: 379/1750 (21.6571%)
___Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 687/1750 (39.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.7267, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  67, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 434/1953 (22.2222%)
___Train Local_ResNet_18, epoch  67, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 773/1953 (39.5801%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.0720, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 48/311 (15.4341%)
___Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 5.3505, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.0820, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0666, Accuracy: 74/186 (39.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   1, Avg loss: 0.0541, Accuracy: 428/1956 (21.8814%)
___Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 681/1956 (34.8160%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.3881, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  67, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 499/1552 (32.1521%)
___Train Local_ResNet_18, epoch  67, local model 74, internal_epoch   2, Avg loss: 0.0202, Accuracy: 803/1552 (51.7397%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.9624, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   1, Avg loss: 0.0638, Accuracy: 174/953 (18.2581%)
___Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   2, Avg loss: 0.0376, Accuracy: 321/953 (33.6831%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.4387, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   1, Avg loss: 0.0532, Accuracy: 307/1013 (30.3060%)
___Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   2, Avg loss: 0.0255, Accuracy: 529/1013 (52.2211%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.6060, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   1, Avg loss: 0.0612, Accuracy: 232/1013 (22.9023%)
___Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 303/1013 (29.9112%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.7616, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  67, local model 77, internal_epoch   1, Avg loss: 0.0530, Accuracy: 342/1340 (25.5224%)
___Train Local_ResNet_18, epoch  67, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 584/1340 (43.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.9237, Accuracy: 60/10000 (0.6000%)
time spent on training: 235.50276947021484
[foolsgold agg] training data poison_ratio: 0.0  data num: [1750, 1953, 311, 186, 1956, 1552, 953, 1013, 1013, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 67: Avg loss: 5.3105, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 67: Avg loss: 5.5360, Accuracy: 0/9950 (0.0000%)
saving model
Done in 307.24364614486694 sec.
Server Epoch:68 choose agents : [21, 24, 59, 44, 83, 9, 17, 87, 52, 63].
___Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 404/1949 (20.7286%)
___Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 619/1949 (31.7599%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.5342, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   1, Avg loss: 0.0752, Accuracy: 43/312 (13.7821%)
___Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   2, Avg loss: 0.0404, Accuracy: 162/312 (51.9231%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 5.3957, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   1, Avg loss: 0.0525, Accuracy: 324/1089 (29.7521%)
___Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 474/1089 (43.5262%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.3330, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 407/1750 (23.2571%)
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0348, Accuracy: 689/1750 (39.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.5669, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 451/1953 (23.0927%)
___Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0333, Accuracy: 785/1953 (40.1946%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.6893, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0491, Accuracy: 366/1275 (28.7059%)
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0193, Accuracy: 724/1275 (56.7843%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.3432, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 380/1574 (24.1423%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 667/1574 (42.3761%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.1661, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0584, Accuracy: 300/1131 (26.5252%)
___Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 395/1131 (34.9248%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.4528, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0559, Accuracy: 289/636 (45.4403%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 6.3146, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 276/888 (31.0811%)
___Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 448/888 (50.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.3217, Accuracy: 52/10000 (0.5200%)
time spent on training: 237.5745530128479
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 312, 1089, 1750, 1953, 1275, 1574, 1131, 636, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 68: Avg loss: 5.3105, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 68: Avg loss: 5.5364, Accuracy: 0/9950 (0.0000%)
saving model
Done in 308.2376401424408 sec.
Server Epoch:69 choose agents : [21, 31, 44, 89, 70, 80, 83, 5, 69, 75].
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0528, Accuracy: 425/1949 (21.8061%)
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0324, Accuracy: 677/1949 (34.7358%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.4665, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   1, Avg loss: 0.0817, Accuracy: 62/460 (13.4783%)
___Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   2, Avg loss: 0.0351, Accuracy: 185/460 (40.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 5.8103, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   1, Avg loss: 0.0581, Accuracy: 411/1750 (23.4857%)
___Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 649/1750 (37.0857%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.7584, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  69, local model 89, internal_epoch   1, Avg loss: 0.0609, Accuracy: 330/896 (36.8304%)
___Train Local_ResNet_18, epoch  69, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 431/896 (48.1027%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.2997, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0558, Accuracy: 357/1418 (25.1763%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 663/1418 (46.7560%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.7790, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  69, local model 80, internal_epoch   1, Avg loss: 0.0699, Accuracy: 138/682 (20.2346%)
___Train Local_ResNet_18, epoch  69, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 259/682 (37.9765%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.5547, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 448/1953 (22.9391%)
___Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0333, Accuracy: 766/1953 (39.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.7569, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   1, Avg loss: 0.0518, Accuracy: 363/1628 (22.2973%)
___Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   2, Avg loss: 0.0253, Accuracy: 844/1628 (51.8428%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.9446, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0558, Accuracy: 288/590 (48.8136%)
___Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0305, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.1001, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 75, internal_epoch   1, Avg loss: 0.0630, Accuracy: 265/776 (34.1495%)
___Train Local_ResNet_18, epoch  69, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 402/776 (51.8041%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.8867, Accuracy: 50/10000 (0.5000%)
time spent on training: 235.11780977249146
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 460, 1750, 896, 1418, 682, 1953, 1628, 590, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 69: Avg loss: 5.3104, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 69: Avg loss: 5.5362, Accuracy: 0/9950 (0.0000%)
saving model
Done in 305.33874011039734 sec.
Server Epoch:70 choose agents : [7, 74, 76, 0, 16, 9, 19, 97, 48, 66].
___Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 366/891 (41.0774%)
___Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 459/891 (51.5152%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.2389, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 516/1552 (33.2474%)
___Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   2, Avg loss: 0.0204, Accuracy: 785/1552 (50.5799%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 11.1021, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  70, local model 76, internal_epoch   1, Avg loss: 0.0846, Accuracy: 54/466 (11.5880%)
___Train Local_ResNet_18, epoch  70, local model 76, internal_epoch   2, Avg loss: 0.0492, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.6326, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  70, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 349/1657 (21.0622%)
___Train Local_ResNet_18, epoch  70, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 511/1657 (30.8389%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.6687, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   1, Avg loss: 0.0593, Accuracy: 286/708 (40.3955%)
___Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   2, Avg loss: 0.0386, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.8425, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   1, Avg loss: 0.0492, Accuracy: 369/1275 (28.9412%)
___Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 689/1275 (54.0392%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.8047, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0468, Accuracy: 423/1036 (40.8301%)
___Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0234, Accuracy: 674/1036 (65.0579%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.0152, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0524, Accuracy: 361/1213 (29.7609%)
___Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0280, Accuracy: 469/1213 (38.6645%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.5635, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0707, Accuracy: 101/631 (16.0063%)
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0404, Accuracy: 215/631 (34.0729%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.8632, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0613, Accuracy: 267/1402 (19.0442%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 397/1402 (28.3167%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.2128, Accuracy: 79/10000 (0.7900%)
time spent on training: 243.5383141040802
[foolsgold agg] training data poison_ratio: 0.15298679715631058  data num: [891, 1552, 466, 1657, 708, 1275, 1036, 1213, 631, 1402]
[foolsgold agg] considering poison per batch poison_fraction: 0.04780837411134706
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.3103, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 70: Avg loss: 5.5370, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.49295020103455 sec.
Server Epoch:71 choose agents : [49, 6, 74, 90, 82, 24, 33, 78, 18, 84].
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0785, Accuracy: 33/440 (7.5000%)
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0474, Accuracy: 146/440 (33.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.5303, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   1, Avg loss: 0.0541, Accuracy: 410/1956 (20.9611%)
___Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   2, Avg loss: 0.0314, Accuracy: 680/1956 (34.7648%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.2314, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  71, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 458/1552 (29.5103%)
___Train Local_ResNet_18, epoch  71, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 753/1552 (48.5180%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 10.4736, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  71, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 324/677 (47.8582%)
___Train Local_ResNet_18, epoch  71, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 440/677 (64.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.1157, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  71, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 74/500 (14.8000%)
___Train Local_ResNet_18, epoch  71, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 184/500 (36.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.6918, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   1, Avg loss: 0.0748, Accuracy: 53/312 (16.9872%)
___Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   2, Avg loss: 0.0400, Accuracy: 158/312 (50.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.3890, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   1, Avg loss: 0.0777, Accuracy: 76/515 (14.7573%)
___Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   2, Avg loss: 0.0492, Accuracy: 129/515 (25.0485%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.8124, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  71, local model 78, internal_epoch   1, Avg loss: 0.0827, Accuracy: 46/416 (11.0577%)
___Train Local_ResNet_18, epoch  71, local model 78, internal_epoch   2, Avg loss: 0.0464, Accuracy: 192/416 (46.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.5909, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0763, Accuracy: 114/530 (21.5094%)
___Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0382, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 6.0749, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  71, local model 84, internal_epoch   1, Avg loss: 0.0616, Accuracy: 320/1190 (26.8908%)
___Train Local_ResNet_18, epoch  71, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 462/1190 (38.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.0177, Accuracy: 61/10000 (0.6100%)
time spent on training: 177.2451205253601
[foolsgold agg] training data poison_ratio: 0.0  data num: [440, 1956, 1552, 677, 500, 312, 515, 416, 530, 1190]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.98334649 1.         1.         1.         1.         0.98334649
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.3103, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Avg loss: 5.5377, Accuracy: 0/9950 (0.0000%)
saving model
Done in 247.46755528450012 sec.
Server Epoch:72 choose agents : [31, 17, 64, 91, 34, 99, 4, 63, 22, 19].
___Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   1, Avg loss: 0.0805, Accuracy: 71/460 (15.4348%)
___Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   2, Avg loss: 0.0370, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 5.7707, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   1, Avg loss: 0.0508, Accuracy: 410/1574 (26.0483%)
___Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 676/1574 (42.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.1857, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   1, Avg loss: 0.0635, Accuracy: 180/953 (18.8877%)
___Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   2, Avg loss: 0.0377, Accuracy: 313/953 (32.8437%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.4905, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0533, Accuracy: 329/1030 (31.9417%)
___Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0258, Accuracy: 655/1030 (63.5922%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.3276, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   1, Avg loss: 0.0571, Accuracy: 402/1427 (28.1710%)
___Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   2, Avg loss: 0.0337, Accuracy: 555/1427 (38.8928%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.0325, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0643, Accuracy: 202/773 (26.1320%)
___Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0317, Accuracy: 383/773 (49.5472%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.2850, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   1, Avg loss: 0.0623, Accuracy: 329/901 (36.5150%)
___Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   2, Avg loss: 0.0322, Accuracy: 370/901 (41.0655%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.0736, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 263/888 (29.6171%)
___Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 424/888 (47.7477%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.5088, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 508/1470 (34.5578%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 847/1470 (57.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.1191, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0469, Accuracy: 403/1036 (38.8996%)
___Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0244, Accuracy: 659/1036 (63.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.5720, Accuracy: 64/10000 (0.6400%)
time spent on training: 249.177179813385
[foolsgold agg] training data poison_ratio: 0.0  data num: [460, 1574, 953, 1030, 1427, 773, 901, 888, 1470, 1036]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 72: Avg loss: 5.3102, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Avg loss: 5.5361, Accuracy: 0/9950 (0.0000%)
saving model
Done in 318.6623182296753 sec.
Server Epoch:73 choose agents : [27, 0, 34, 96, 4, 72, 81, 12, 59, 88].
___Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 455/1587 (28.6704%)
___Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 599/1587 (37.7442%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.3609, Accuracy: 66/10000 (0.6600%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  73, local model 0, internal_epoch   1, Avg loss: 0.0575, Accuracy: 378/1657 (22.8123%)
___Train Local_ResNet_18, epoch  73, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 521/1657 (31.4424%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.4025, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   1, Avg loss: 0.0578, Accuracy: 383/1427 (26.8395%)
___Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 581/1427 (40.7148%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.0253, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 53/311 (17.0418%)
___Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.3460, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0623, Accuracy: 338/901 (37.5139%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0310, Accuracy: 397/901 (44.0622%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.1128, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   1, Avg loss: 0.0609, Accuracy: 262/1241 (21.1120%)
___Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 424/1241 (34.1660%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.1545, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0678, Accuracy: 244/774 (31.5245%)
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0357, Accuracy: 282/774 (36.4341%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.2952, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   1, Avg loss: 0.0852, Accuracy: 23/338 (6.8047%)
___Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   2, Avg loss: 0.0447, Accuracy: 150/338 (44.3787%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.4697, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   1, Avg loss: 0.0598, Accuracy: 307/1089 (28.1910%)
___Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   2, Avg loss: 0.0267, Accuracy: 449/1089 (41.2305%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.1359, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  73, local model 88, internal_epoch   1, Avg loss: 0.0735, Accuracy: 148/603 (24.5439%)
___Train Local_ResNet_18, epoch  73, local model 88, internal_epoch   2, Avg loss: 0.0461, Accuracy: 277/603 (45.9370%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.0740, Accuracy: 52/10000 (0.5200%)
time spent on training: 225.98825931549072
[foolsgold agg] training data poison_ratio: 0.1669016921837228  data num: [1587, 1657, 1427, 311, 901, 1241, 774, 338, 1089, 603]
[foolsgold agg] considering poison per batch poison_fraction: 0.05215677880741337
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.3101, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Avg loss: 5.5363, Accuracy: 0/9950 (0.0000%)
saving model
Done in 298.03459906578064 sec.
Server Epoch:74 choose agents : [9, 38, 0, 63, 50, 44, 1, 92, 93, 53].
___Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   1, Avg loss: 0.0483, Accuracy: 379/1275 (29.7255%)
___Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   2, Avg loss: 0.0190, Accuracy: 745/1275 (58.4314%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.7985, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   1, Avg loss: 0.0613, Accuracy: 262/1131 (23.1653%)
___Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   2, Avg loss: 0.0300, Accuracy: 504/1131 (44.5623%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.3790, Accuracy: 78/10000 (0.7800%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 366/1657 (22.0881%)
___Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 513/1657 (30.9596%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.3280, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0535, Accuracy: 271/888 (30.5180%)
___Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 439/888 (49.4369%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.5760, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 156/809 (19.2831%)
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 372/809 (45.9827%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.1791, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0583, Accuracy: 412/1750 (23.5429%)
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 689/1750 (39.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.7260, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   1, Avg loss: 0.0563, Accuracy: 296/928 (31.8966%)
___Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   2, Avg loss: 0.0232, Accuracy: 581/928 (62.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.7947, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0519, Accuracy: 464/1715 (27.0554%)
___Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 706/1715 (41.1662%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.5328, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 429/1742 (24.6269%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0313, Accuracy: 731/1742 (41.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.7853, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   1, Avg loss: 0.0490, Accuracy: 284/813 (34.9323%)
___Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 483/813 (59.4096%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.4390, Accuracy: 52/10000 (0.5200%)
time spent on training: 276.1723589897156
[foolsgold agg] training data poison_ratio: 0.13039030531948378  data num: [1275, 1131, 1657, 888, 809, 1750, 928, 1715, 1742, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.040746970412338684
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 74: Avg loss: 5.3101, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Avg loss: 5.5369, Accuracy: 0/9950 (0.0000%)
saving model
Done in 347.2421476840973 sec.
Server Epoch:75 choose agents : [88, 65, 74, 85, 4, 55, 81, 12, 21, 64].
___Train Local_ResNet_18, epoch  75, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 155/603 (25.7048%)
___Train Local_ResNet_18, epoch  75, local model 88, internal_epoch   2, Avg loss: 0.0447, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 5.8971, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0564, Accuracy: 405/1475 (27.4576%)
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0304, Accuracy: 719/1475 (48.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.9202, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 477/1552 (30.7345%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 803/1552 (51.7397%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.6415, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0533, Accuracy: 453/1988 (22.7867%)
___Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 712/1988 (35.8149%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.9674, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   1, Avg loss: 0.0594, Accuracy: 329/901 (36.5150%)
___Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   2, Avg loss: 0.0327, Accuracy: 389/901 (43.1743%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.8489, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 266/1071 (24.8366%)
___Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   2, Avg loss: 0.0285, Accuracy: 519/1071 (48.4594%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.7736, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  75, local model 81, internal_epoch   1, Avg loss: 0.0655, Accuracy: 253/774 (32.6873%)
___Train Local_ResNet_18, epoch  75, local model 81, internal_epoch   2, Avg loss: 0.0367, Accuracy: 289/774 (37.3385%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.2994, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   1, Avg loss: 0.0853, Accuracy: 24/338 (7.1006%)
___Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   2, Avg loss: 0.0463, Accuracy: 152/338 (44.9704%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 5.4562, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 419/1949 (21.4982%)
___Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   2, Avg loss: 0.0325, Accuracy: 645/1949 (33.0939%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.2940, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0638, Accuracy: 176/953 (18.4680%)
___Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0375, Accuracy: 319/953 (33.4732%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.4797, Accuracy: 65/10000 (0.6500%)
time spent on training: 232.53646731376648
[foolsgold agg] training data poison_ratio: 0.0  data num: [603, 1475, 1552, 1988, 901, 1071, 774, 338, 1949, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 75: Avg loss: 5.3100, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Avg loss: 5.5345, Accuracy: 0/9950 (0.0000%)
saving model
Done in 304.11975836753845 sec.
Server Epoch:76 choose agents : [5, 72, 10, 55, 83, 39, 17, 88, 92, 35].
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0507, Accuracy: 403/1628 (24.7543%)
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 831/1628 (51.0442%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.2923, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 259/1241 (20.8703%)
___Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 415/1241 (33.4408%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.2345, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   1, Avg loss: 0.0577, Accuracy: 220/861 (25.5517%)
___Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 456/861 (52.9617%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.8640, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   1, Avg loss: 0.0553, Accuracy: 244/1071 (22.7824%)
___Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 520/1071 (48.5528%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.9374, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  76, local model 83, internal_epoch   1, Avg loss: 0.0534, Accuracy: 461/1953 (23.6047%)
___Train Local_ResNet_18, epoch  76, local model 83, internal_epoch   2, Avg loss: 0.0332, Accuracy: 803/1953 (41.1162%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.9018, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   1, Avg loss: 0.0534, Accuracy: 315/1013 (31.0958%)
___Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 510/1013 (50.3455%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.6737, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   1, Avg loss: 0.0507, Accuracy: 415/1574 (26.3659%)
___Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 650/1574 (41.2961%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.3883, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0739, Accuracy: 155/603 (25.7048%)
___Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0455, Accuracy: 283/603 (46.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 5.9337, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 445/1715 (25.9475%)
___Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 718/1715 (41.8659%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.8555, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   1, Avg loss: 0.0861, Accuracy: 47/271 (17.3432%)
___Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   2, Avg loss: 0.0575, Accuracy: 112/271 (41.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 5.3738, Accuracy: 47/10000 (0.4700%)
time spent on training: 238.00625133514404
[foolsgold agg] training data poison_ratio: 0.0  data num: [1628, 1241, 861, 1071, 1953, 1013, 1574, 603, 1715, 271]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         0.93097059 1.
 1.         1.         1.         0.93097059]
___Test Target_ResNet_18 poisoned: False, epoch: 76: Avg loss: 5.3099, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Avg loss: 5.5345, Accuracy: 0/9950 (0.0000%)
saving model
Done in 310.804829120636 sec.
Server Epoch:77 choose agents : [61, 17, 99, 31, 50, 89, 71, 60, 94, 28].
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1251, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1164, Accuracy: 10/85 (11.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.3035, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   1, Avg loss: 0.0507, Accuracy: 436/1574 (27.7001%)
___Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 679/1574 (43.1385%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.9921, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  77, local model 99, internal_epoch   1, Avg loss: 0.0653, Accuracy: 203/773 (26.2613%)
___Train Local_ResNet_18, epoch  77, local model 99, internal_epoch   2, Avg loss: 0.0295, Accuracy: 416/773 (53.8163%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.0184, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   1, Avg loss: 0.0804, Accuracy: 66/460 (14.3478%)
___Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   2, Avg loss: 0.0373, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.8037, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   1, Avg loss: 0.0628, Accuracy: 149/809 (18.4178%)
___Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 349/809 (43.1397%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.5272, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  77, local model 89, internal_epoch   1, Avg loss: 0.0591, Accuracy: 347/896 (38.7277%)
___Train Local_ResNet_18, epoch  77, local model 89, internal_epoch   2, Avg loss: 0.0348, Accuracy: 438/896 (48.8839%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.2530, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   1, Avg loss: 0.0635, Accuracy: 170/818 (20.7824%)
___Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   2, Avg loss: 0.0302, Accuracy: 361/818 (44.1320%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.5538, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 568/2227 (25.5052%)
___Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1027/2227 (46.1159%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.4912, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 319/1662 (19.1937%)
___Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0326, Accuracy: 636/1662 (38.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.8329, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   1, Avg loss: 0.0558, Accuracy: 404/1581 (25.5534%)
___Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 600/1581 (37.9507%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.5553, Accuracy: 84/10000 (0.8400%)
time spent on training: 264.3927960395813
[foolsgold agg] training data poison_ratio: 0.0  data num: [85, 1574, 773, 460, 809, 896, 818, 2227, 1662, 1581]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.3098, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Avg loss: 5.5331, Accuracy: 0/9950 (0.0000%)
saving model
Done in 336.642165184021 sec.
Server Epoch:78 choose agents : [1, 64, 48, 76, 98, 36, 26, 89, 18, 92].
___Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   1, Avg loss: 0.0553, Accuracy: 295/928 (31.7888%)
___Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 540/928 (58.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.5634, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0640, Accuracy: 175/953 (18.3631%)
___Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 307/953 (32.2141%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.4442, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   1, Avg loss: 0.0706, Accuracy: 104/631 (16.4818%)
___Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 220/631 (34.8653%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.9278, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   1, Avg loss: 0.0843, Accuracy: 46/466 (9.8712%)
___Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   2, Avg loss: 0.0481, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.6784, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 98, internal_epoch   1, Avg loss: 0.0818, Accuracy: 21/373 (5.6300%)
___Train Local_ResNet_18, epoch  78, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 153/373 (41.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.4478, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0874, Accuracy: 81/408 (19.8529%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0544, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.4943, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 350/1446 (24.2047%)
___Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 500/1446 (34.5781%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.3118, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  78, local model 89, internal_epoch   1, Avg loss: 0.0601, Accuracy: 339/896 (37.8348%)
___Train Local_ResNet_18, epoch  78, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 417/896 (46.5402%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.3226, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0758, Accuracy: 119/530 (22.4528%)
___Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0387, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.0517, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  78, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 493/1715 (28.7464%)
___Train Local_ResNet_18, epoch  78, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 718/1715 (41.8659%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.6378, Accuracy: 92/10000 (0.9200%)
time spent on training: 191.7785623073578
[foolsgold agg] training data poison_ratio: 0.0  data num: [928, 953, 631, 466, 373, 408, 1446, 896, 530, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.3097, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Avg loss: 5.5313, Accuracy: 0/9950 (0.0000%)
saving model
Done in 262.4621548652649 sec.
Server Epoch:79 choose agents : [70, 34, 15, 96, 95, 25, 53, 86, 18, 52].
___Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   1, Avg loss: 0.0559, Accuracy: 347/1418 (24.4711%)
___Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 638/1418 (44.9929%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.8410, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   1, Avg loss: 0.0578, Accuracy: 420/1427 (29.4324%)
___Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 576/1427 (40.3644%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.8273, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   1, Avg loss: 0.0559, Accuracy: 332/1154 (28.7695%)
___Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   2, Avg loss: 0.0272, Accuracy: 500/1154 (43.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.8852, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 53/311 (17.0418%)
___Train Local_ResNet_18, epoch  79, local model 96, internal_epoch   2, Avg loss: 0.0529, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 5.3508, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 342/599 (57.0952%)
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.9793, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   1, Avg loss: 0.0560, Accuracy: 307/690 (44.4928%)
___Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   2, Avg loss: 0.0272, Accuracy: 462/690 (66.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.5581, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   1, Avg loss: 0.0488, Accuracy: 286/813 (35.1784%)
___Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 459/813 (56.4576%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.4325, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 86, internal_epoch   1, Avg loss: 0.0634, Accuracy: 357/1003 (35.5932%)
___Train Local_ResNet_18, epoch  79, local model 86, internal_epoch   2, Avg loss: 0.0339, Accuracy: 396/1003 (39.4816%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.6924, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0754, Accuracy: 118/530 (22.2642%)
___Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0406, Accuracy: 269/530 (50.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.1374, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0559, Accuracy: 289/636 (45.4403%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0306, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.2747, Accuracy: 50/10000 (0.5000%)
time spent on training: 210.4032542705536
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 1427, 1154, 311, 599, 690, 813, 1003, 530, 636]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 79: Avg loss: 5.3097, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Avg loss: 5.5318, Accuracy: 0/9950 (0.0000%)
saving model
Done in 281.57478761672974 sec.
Server Epoch:80 choose agents : [90, 47, 51, 91, 87, 77, 74, 61, 97, 76].
___Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0551, Accuracy: 324/677 (47.8582%)
___Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 458/677 (67.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.5288, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   1, Avg loss: 0.1213, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   2, Avg loss: 0.1065, Accuracy: 25/134 (18.6567%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   1, Avg loss: 0.0594, Accuracy: 243/1049 (23.1649%)
___Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 524/1049 (49.9523%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.4094, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0510, Accuracy: 336/1030 (32.6214%)
___Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0256, Accuracy: 615/1030 (59.7087%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.4348, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  80, local model 87, internal_epoch   1, Avg loss: 0.0573, Accuracy: 306/1131 (27.0557%)
___Train Local_ResNet_18, epoch  80, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 410/1131 (36.2511%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.7143, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   1, Avg loss: 0.0533, Accuracy: 348/1340 (25.9701%)
___Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 523/1340 (39.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.7352, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 497/1552 (32.0232%)
___Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 787/1552 (50.7088%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.3619, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   1, Avg loss: 0.1259, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   2, Avg loss: 0.1165, Accuracy: 8/85 (9.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.3034, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  80, local model 97, internal_epoch   1, Avg loss: 0.0525, Accuracy: 349/1213 (28.7716%)
___Train Local_ResNet_18, epoch  80, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 474/1213 (39.0767%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.5439, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0837, Accuracy: 51/466 (10.9442%)
___Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0474, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.6624, Accuracy: 50/10000 (0.5000%)
time spent on training: 191.19861006736755
[foolsgold agg] training data poison_ratio: 0.0  data num: [677, 134, 1049, 1030, 1131, 1340, 1552, 85, 1213, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.3097, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Avg loss: 5.5326, Accuracy: 0/9950 (0.0000%)
saving model
Done in 264.90307092666626 sec.
Server Epoch:81 choose agents : [60, 92, 18, 24, 50, 96, 61, 90, 54, 15].
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 615/2227 (27.6156%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1039/2227 (46.6547%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.2387, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 445/1715 (25.9475%)
___Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 707/1715 (41.2245%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.5367, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0760, Accuracy: 122/530 (23.0189%)
___Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0377, Accuracy: 269/530 (50.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 6.1454, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   1, Avg loss: 0.0753, Accuracy: 36/312 (11.5385%)
___Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 166/312 (53.2051%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.3913, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0625, Accuracy: 154/809 (19.0358%)
___Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 358/809 (44.2522%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.2305, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 51/311 (16.3987%)
___Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.3480, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1243, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1156, Accuracy: 13/85 (15.2941%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.3034, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0567, Accuracy: 322/677 (47.5628%)
___Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 446/677 (65.8789%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.4025, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 346/1130 (30.6195%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 492/1130 (43.5398%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.8524, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 333/1154 (28.8562%)
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0283, Accuracy: 450/1154 (38.9948%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.0312, Accuracy: 51/10000 (0.5100%)
time spent on training: 235.96619868278503
[foolsgold agg] training data poison_ratio: 0.0  data num: [2227, 1715, 530, 312, 809, 311, 85, 677, 1130, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.3096, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Avg loss: 5.5318, Accuracy: 0/9950 (0.0000%)
saving model
Done in 306.3536012172699 sec.
Server Epoch:82 choose agents : [59, 83, 37, 80, 61, 21, 47, 81, 13, 31].
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0584, Accuracy: 315/1089 (28.9256%)
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0268, Accuracy: 464/1089 (42.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.8312, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  82, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 431/1953 (22.0686%)
___Train Local_ResNet_18, epoch  82, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 736/1953 (37.6856%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.5340, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   1, Avg loss: 0.0522, Accuracy: 428/1129 (37.9097%)
___Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   2, Avg loss: 0.0241, Accuracy: 743/1129 (65.8105%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.3880, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0697, Accuracy: 147/682 (21.5543%)
___Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0386, Accuracy: 227/682 (33.2845%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 6.3711, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   1, Avg loss: 0.1259, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   2, Avg loss: 0.1167, Accuracy: 9/85 (10.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.3036, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   1, Avg loss: 0.0528, Accuracy: 405/1949 (20.7799%)
___Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 627/1949 (32.1703%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.2610, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   1, Avg loss: 0.1195, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   2, Avg loss: 0.1082, Accuracy: 18/134 (13.4328%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   1, Avg loss: 0.0660, Accuracy: 250/774 (32.2997%)
___Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   2, Avg loss: 0.0347, Accuracy: 334/774 (43.1525%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 6.2653, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   1, Avg loss: 0.0572, Accuracy: 319/1645 (19.3921%)
___Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 626/1645 (38.0547%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.7773, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   1, Avg loss: 0.0798, Accuracy: 76/460 (16.5217%)
___Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   2, Avg loss: 0.0379, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.7686, Accuracy: 50/10000 (0.5000%)
time spent on training: 227.68931341171265
[foolsgold agg] training data poison_ratio: 0.0  data num: [1089, 1953, 1129, 682, 85, 1949, 134, 774, 1645, 460]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.72674453 1.         1.         0.72674453]
___Test Target_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.3095, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Avg loss: 5.5312, Accuracy: 0/9950 (0.0000%)
saving model
Done in 298.8585138320923 sec.
Server Epoch:83 choose agents : [43, 65, 33, 2, 36, 57, 45, 75, 94, 79].
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 307/946 (32.4524%)
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 351/946 (37.1036%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.0166, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0559, Accuracy: 386/1475 (26.1695%)
___Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0317, Accuracy: 671/1475 (45.4915%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.9930, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.0768, Accuracy: 80/515 (15.5340%)
___Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0516, Accuracy: 120/515 (23.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.7361, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   1, Avg loss: 0.0627, Accuracy: 240/605 (39.6694%)
___Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   2, Avg loss: 0.0401, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.8429, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   1, Avg loss: 0.0860, Accuracy: 83/408 (20.3431%)
___Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   2, Avg loss: 0.0546, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.5226, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   1, Avg loss: 0.0543, Accuracy: 310/1154 (26.8631%)
___Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   2, Avg loss: 0.0260, Accuracy: 485/1154 (42.0277%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.3875, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   1, Avg loss: 0.0692, Accuracy: 213/669 (31.8386%)
___Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   2, Avg loss: 0.0392, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.8032, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 75, internal_epoch   1, Avg loss: 0.0638, Accuracy: 254/776 (32.7320%)
___Train Local_ResNet_18, epoch  83, local model 75, internal_epoch   2, Avg loss: 0.0320, Accuracy: 400/776 (51.5464%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.0129, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 354/1662 (21.2996%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 620/1662 (37.3045%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.6004, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  83, local model 79, internal_epoch   1, Avg loss: 0.1013, Accuracy: 14/197 (7.1066%)
___Train Local_ResNet_18, epoch  83, local model 79, internal_epoch   2, Avg loss: 0.0877, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.3201, Accuracy: 50/10000 (0.5000%)
time spent on training: 207.9237277507782
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 1475, 515, 605, 408, 1154, 669, 776, 1662, 197]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.3094, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Avg loss: 5.5301, Accuracy: 0/9950 (0.0000%)
saving model
Done in 278.45663833618164 sec.
Server Epoch:84 choose agents : [98, 26, 54, 61, 56, 29, 38, 45, 2, 15].
___Train Local_ResNet_18, epoch  84, local model 98, internal_epoch   1, Avg loss: 0.0816, Accuracy: 29/373 (7.7748%)
___Train Local_ResNet_18, epoch  84, local model 98, internal_epoch   2, Avg loss: 0.0480, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.4605, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   1, Avg loss: 0.0543, Accuracy: 350/1446 (24.2047%)
___Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 515/1446 (35.6155%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.2992, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   1, Avg loss: 0.0557, Accuracy: 350/1130 (30.9735%)
___Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 454/1130 (40.1770%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.4970, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1242, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1167, Accuracy: 9/85 (10.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.3035, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   1, Avg loss: 0.0818, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   2, Avg loss: 0.0665, Accuracy: 78/186 (41.9355%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   1, Avg loss: 0.0485, Accuracy: 426/1440 (29.5833%)
___Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 686/1440 (47.6389%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.0308, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0601, Accuracy: 258/1131 (22.8117%)
___Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0300, Accuracy: 528/1131 (46.6844%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.4045, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   1, Avg loss: 0.0658, Accuracy: 211/669 (31.5396%)
___Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   2, Avg loss: 0.0408, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.9469, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0626, Accuracy: 242/605 (40.0000%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.9286, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   1, Avg loss: 0.0569, Accuracy: 327/1154 (28.3362%)
___Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   2, Avg loss: 0.0309, Accuracy: 465/1154 (40.2946%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.7581, Accuracy: 54/10000 (0.5400%)
time spent on training: 211.1747007369995
[foolsgold agg] training data poison_ratio: 0.0  data num: [373, 1446, 1130, 85, 186, 1440, 1131, 669, 605, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.3094, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Avg loss: 5.5308, Accuracy: 0/9950 (0.0000%)
saving model
Done in 282.51623487472534 sec.
Server Epoch:85 choose agents : [83, 3, 85, 18, 96, 8, 88, 79, 23, 58].
___Train Local_ResNet_18, epoch  85, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 430/1953 (22.0174%)
___Train Local_ResNet_18, epoch  85, local model 83, internal_epoch   2, Avg loss: 0.0332, Accuracy: 794/1953 (40.6554%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.6340, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   1, Avg loss: 0.0727, Accuracy: 120/781 (15.3649%)
___Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 230/781 (29.4494%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.6724, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  85, local model 85, internal_epoch   1, Avg loss: 0.0526, Accuracy: 460/1988 (23.1388%)
___Train Local_ResNet_18, epoch  85, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 676/1988 (34.0040%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.9330, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0739, Accuracy: 130/530 (24.5283%)
___Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0393, Accuracy: 267/530 (50.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.1453, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  85, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 54/311 (17.3633%)
___Train Local_ResNet_18, epoch  85, local model 96, internal_epoch   2, Avg loss: 0.0526, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.3500, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 221/1513 (14.6067%)
___Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 491/1513 (32.4521%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.3982, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  85, local model 88, internal_epoch   1, Avg loss: 0.0736, Accuracy: 150/603 (24.8756%)
___Train Local_ResNet_18, epoch  85, local model 88, internal_epoch   2, Avg loss: 0.0447, Accuracy: 287/603 (47.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.8941, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 79, internal_epoch   1, Avg loss: 0.0997, Accuracy: 17/197 (8.6294%)
___Train Local_ResNet_18, epoch  85, local model 79, internal_epoch   2, Avg loss: 0.0838, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.3235, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   1, Avg loss: 0.0613, Accuracy: 319/715 (44.6154%)
___Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   2, Avg loss: 0.0381, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.7336, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0587, Accuracy: 339/803 (42.2167%)
___Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0335, Accuracy: 396/803 (49.3151%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.0119, Accuracy: 53/10000 (0.5300%)
time spent on training: 236.7995252609253
[foolsgold agg] training data poison_ratio: 0.0  data num: [1953, 781, 1988, 530, 311, 1513, 603, 197, 715, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.3095, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Avg loss: 5.5314, Accuracy: 0/9950 (0.0000%)
saving model
Done in 307.22656893730164 sec.
Server Epoch:86 choose agents : [57, 99, 60, 19, 35, 84, 81, 44, 41, 59].
___Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   1, Avg loss: 0.0538, Accuracy: 315/1154 (27.2964%)
___Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   2, Avg loss: 0.0253, Accuracy: 494/1154 (42.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.3095, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0637, Accuracy: 199/773 (25.7439%)
___Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0293, Accuracy: 420/773 (54.3338%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.1621, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   1, Avg loss: 0.0487, Accuracy: 596/2227 (26.7625%)
___Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1044/2227 (46.8792%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.4655, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 422/1036 (40.7336%)
___Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0248, Accuracy: 624/1036 (60.2317%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.6115, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   1, Avg loss: 0.0852, Accuracy: 42/271 (15.4982%)
___Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   2, Avg loss: 0.0555, Accuracy: 117/271 (43.1734%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 5.3703, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 312/1190 (26.2185%)
___Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 457/1190 (38.4034%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.9174, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0649, Accuracy: 244/774 (31.5245%)
___Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0365, Accuracy: 293/774 (37.8553%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.3351, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0580, Accuracy: 422/1750 (24.1143%)
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0347, Accuracy: 693/1750 (39.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.6418, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   1, Avg loss: 0.0588, Accuracy: 337/719 (46.8707%)
___Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   2, Avg loss: 0.0318, Accuracy: 451/719 (62.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.4890, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0554, Accuracy: 335/1089 (30.7622%)
___Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0357, Accuracy: 441/1089 (40.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.3188, Accuracy: 61/10000 (0.6100%)
time spent on training: 254.88321924209595
[foolsgold agg] training data poison_ratio: 0.0  data num: [1154, 773, 2227, 1036, 271, 1190, 774, 1750, 719, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 86: Avg loss: 5.3094, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Avg loss: 5.5311, Accuracy: 0/9950 (0.0000%)
saving model
Done in 325.2411324977875 sec.
Server Epoch:87 choose agents : [85, 29, 54, 69, 86, 45, 26, 47, 33, 57].
___Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 451/1988 (22.6861%)
___Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 635/1988 (31.9416%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.2220, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   1, Avg loss: 0.0494, Accuracy: 438/1440 (30.4167%)
___Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 662/1440 (45.9722%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.6869, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 347/1130 (30.7080%)
___Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 461/1130 (40.7965%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.8145, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0550, Accuracy: 304/590 (51.5254%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0328, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.0704, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0604, Accuracy: 359/1003 (35.7926%)
___Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 376/1003 (37.4875%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.6153, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   1, Avg loss: 0.0673, Accuracy: 204/669 (30.4933%)
___Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   2, Avg loss: 0.0393, Accuracy: 355/669 (53.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.8084, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   1, Avg loss: 0.0544, Accuracy: 367/1446 (25.3804%)
___Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   2, Avg loss: 0.0342, Accuracy: 558/1446 (38.5892%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.3407, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1197, Accuracy: 2/134 (1.4925%)
___Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1090, Accuracy: 26/134 (19.4030%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.3102, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   1, Avg loss: 0.0777, Accuracy: 80/515 (15.5340%)
___Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   2, Avg loss: 0.0521, Accuracy: 128/515 (24.8544%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.7281, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 308/1154 (26.6898%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0254, Accuracy: 494/1154 (42.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.9733, Accuracy: 65/10000 (0.6500%)
time spent on training: 233.7956223487854
[foolsgold agg] training data poison_ratio: 0.0  data num: [1988, 1440, 1130, 590, 1003, 669, 1446, 134, 515, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.3094, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Avg loss: 5.5315, Accuracy: 0/9950 (0.0000%)
saving model
Done in 304.6717321872711 sec.
Server Epoch:88 choose agents : [62, 82, 84, 18, 63, 67, 29, 37, 86, 79].
___Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0683, Accuracy: 149/568 (26.2324%)
___Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.7932, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  88, local model 82, internal_epoch   1, Avg loss: 0.0764, Accuracy: 69/500 (13.8000%)
___Train Local_ResNet_18, epoch  88, local model 82, internal_epoch   2, Avg loss: 0.0479, Accuracy: 179/500 (35.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.6565, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  88, local model 84, internal_epoch   1, Avg loss: 0.0613, Accuracy: 319/1190 (26.8067%)
___Train Local_ResNet_18, epoch  88, local model 84, internal_epoch   2, Avg loss: 0.0317, Accuracy: 493/1190 (41.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.1068, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0749, Accuracy: 127/530 (23.9623%)
___Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0407, Accuracy: 269/530 (50.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 6.2644, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   1, Avg loss: 0.0534, Accuracy: 268/888 (30.1802%)
___Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 465/888 (52.3649%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.3610, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   1, Avg loss: 0.0780, Accuracy: 51/426 (11.9718%)
___Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   2, Avg loss: 0.0411, Accuracy: 173/426 (40.6103%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.6109, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   1, Avg loss: 0.0479, Accuracy: 428/1440 (29.7222%)
___Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 683/1440 (47.4306%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.9085, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   1, Avg loss: 0.0516, Accuracy: 417/1129 (36.9353%)
___Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 737/1129 (65.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.8729, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0619, Accuracy: 363/1003 (36.1914%)
___Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0339, Accuracy: 386/1003 (38.4845%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 6.7673, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 79, internal_epoch   1, Avg loss: 0.1017, Accuracy: 18/197 (9.1371%)
___Train Local_ResNet_18, epoch  88, local model 79, internal_epoch   2, Avg loss: 0.0893, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.3196, Accuracy: 50/10000 (0.5000%)
time spent on training: 226.379536151886
[foolsgold agg] training data poison_ratio: 0.0  data num: [568, 500, 1190, 530, 888, 426, 1440, 1129, 1003, 197]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.93447901 1.         0.93447901
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.3093, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Avg loss: 5.5318, Accuracy: 0/9950 (0.0000%)
saving model
Done in 296.30183815956116 sec.
Server Epoch:89 choose agents : [43, 48, 27, 5, 45, 67, 95, 23, 39, 16].
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0620, Accuracy: 316/946 (33.4038%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0355, Accuracy: 345/946 (36.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 6.0931, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 107/631 (16.9572%)
___Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   2, Avg loss: 0.0412, Accuracy: 221/631 (35.0238%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.8811, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 426/1587 (26.8431%)
___Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 598/1587 (37.6812%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.3375, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   1, Avg loss: 0.0500, Accuracy: 419/1628 (25.7371%)
___Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 828/1628 (50.8600%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.5258, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   1, Avg loss: 0.0666, Accuracy: 212/669 (31.6891%)
___Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   2, Avg loss: 0.0402, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.9895, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0776, Accuracy: 53/426 (12.4413%)
___Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0402, Accuracy: 174/426 (40.8451%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.6009, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  89, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 330/599 (55.0918%)
___Train Local_ResNet_18, epoch  89, local model 95, internal_epoch   2, Avg loss: 0.0277, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.9231, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   1, Avg loss: 0.0605, Accuracy: 325/715 (45.4545%)
___Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   2, Avg loss: 0.0385, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.7403, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0530, Accuracy: 318/1013 (31.3919%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0254, Accuracy: 531/1013 (52.4186%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.6222, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   1, Avg loss: 0.0607, Accuracy: 298/708 (42.0904%)
___Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   2, Avg loss: 0.0374, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.8509, Accuracy: 65/10000 (0.6500%)
time spent on training: 217.11581325531006
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 631, 1587, 1628, 669, 426, 599, 715, 1013, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.3093, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Avg loss: 5.5318, Accuracy: 0/9950 (0.0000%)
saving model
Done in 288.83010363578796 sec.
Server Epoch:90 choose agents : [25, 41, 39, 40, 34, 76, 29, 71, 8, 53].
___Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   1, Avg loss: 0.0578, Accuracy: 313/690 (45.3623%)
___Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 460/690 (66.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 6.5522, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0584, Accuracy: 337/719 (46.8707%)
___Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0331, Accuracy: 465/719 (64.6732%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 6.6252, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0534, Accuracy: 317/1013 (31.2932%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0255, Accuracy: 498/1013 (49.1609%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.9939, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0551, Accuracy: 363/1573 (23.0769%)
___Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 591/1573 (37.5715%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.6960, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 401/1427 (28.1009%)
___Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   2, Avg loss: 0.0326, Accuracy: 602/1427 (42.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.3571, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  90, local model 76, internal_epoch   1, Avg loss: 0.0849, Accuracy: 48/466 (10.3004%)
___Train Local_ResNet_18, epoch  90, local model 76, internal_epoch   2, Avg loss: 0.0476, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.7281, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 455/1440 (31.5972%)
___Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 679/1440 (47.1528%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.0230, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0633, Accuracy: 162/818 (19.8044%)
___Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 348/818 (42.5428%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.3019, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   1, Avg loss: 0.0592, Accuracy: 250/1513 (16.5235%)
___Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   2, Avg loss: 0.0360, Accuracy: 503/1513 (33.2452%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.5716, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0485, Accuracy: 309/813 (38.0074%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 457/813 (56.2116%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.6957, Accuracy: 51/10000 (0.5100%)
time spent on training: 244.45827770233154
[foolsgold agg] training data poison_ratio: 0.0  data num: [690, 719, 1013, 1573, 1427, 466, 1440, 818, 1513, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.3093, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Avg loss: 5.5330, Accuracy: 0/9950 (0.0000%)
saving model
Done in 317.61883330345154 sec.
Server Epoch:91 choose agents : [36, 34, 71, 11, 72, 90, 63, 3, 50, 24].
___Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.0869, Accuracy: 82/408 (20.0980%)
___Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0533, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.5245, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 404/1427 (28.3111%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 568/1427 (39.8038%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.9146, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0629, Accuracy: 162/818 (19.8044%)
___Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0311, Accuracy: 316/818 (38.6308%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.1576, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   1, Avg loss: 0.0535, Accuracy: 340/712 (47.7528%)
___Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 437/712 (61.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.6764, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   1, Avg loss: 0.0600, Accuracy: 262/1241 (21.1120%)
___Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   2, Avg loss: 0.0360, Accuracy: 447/1241 (36.0193%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.1400, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  91, local model 90, internal_epoch   1, Avg loss: 0.0560, Accuracy: 331/677 (48.8922%)
___Train Local_ResNet_18, epoch  91, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 466/677 (68.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.4588, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   1, Avg loss: 0.0537, Accuracy: 273/888 (30.7432%)
___Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 446/888 (50.2252%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.4542, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   1, Avg loss: 0.0730, Accuracy: 123/781 (15.7490%)
___Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   2, Avg loss: 0.0354, Accuracy: 238/781 (30.4738%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.6906, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 141/809 (17.4289%)
___Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 348/809 (43.0161%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.4620, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0748, Accuracy: 49/312 (15.7051%)
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0396, Accuracy: 166/312 (53.2051%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.4100, Accuracy: 50/10000 (0.5000%)
time spent on training: 205.91697669029236
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 1427, 818, 712, 1241, 677, 888, 781, 809, 312]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.3092, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Avg loss: 5.5335, Accuracy: 0/9950 (0.0000%)
saving model
Done in 276.26445388793945 sec.
Server Epoch:92 choose agents : [91, 89, 76, 1, 58, 42, 94, 14, 29, 30].
___Train Local_ResNet_18, epoch  92, local model 91, internal_epoch   1, Avg loss: 0.0509, Accuracy: 333/1030 (32.3301%)
___Train Local_ResNet_18, epoch  92, local model 91, internal_epoch   2, Avg loss: 0.0258, Accuracy: 592/1030 (57.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.3270, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  92, local model 89, internal_epoch   1, Avg loss: 0.0601, Accuracy: 340/896 (37.9464%)
___Train Local_ResNet_18, epoch  92, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 416/896 (46.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 6.1420, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   1, Avg loss: 0.0840, Accuracy: 52/466 (11.1588%)
___Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   2, Avg loss: 0.0457, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 5.6882, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   1, Avg loss: 0.0554, Accuracy: 294/928 (31.6810%)
___Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 585/928 (63.0388%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.9608, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0579, Accuracy: 348/803 (43.3375%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 393/803 (48.9415%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 6.0631, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 342/1372 (24.9271%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 512/1372 (37.3178%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.2548, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  92, local model 94, internal_epoch   1, Avg loss: 0.0544, Accuracy: 353/1662 (21.2395%)
___Train Local_ResNet_18, epoch  92, local model 94, internal_epoch   2, Avg loss: 0.0326, Accuracy: 619/1662 (37.2443%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.0494, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   1, Avg loss: 0.0615, Accuracy: 228/1013 (22.5074%)
___Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 295/1013 (29.1214%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 6.7813, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0485, Accuracy: 420/1440 (29.1667%)
___Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 693/1440 (48.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.6960, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   1, Avg loss: 0.0787, Accuracy: 80/486 (16.4609%)
___Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   2, Avg loss: 0.0405, Accuracy: 215/486 (44.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 5.7867, Accuracy: 45/10000 (0.4500%)
time spent on training: 282.9076693058014
[foolsgold agg] training data poison_ratio: 0.0  data num: [1030, 896, 466, 928, 803, 1372, 1662, 1013, 1440, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 92: Avg loss: 5.3092, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Avg loss: 5.5340, Accuracy: 0/9950 (0.0000%)
saving model
Done in 353.0217604637146 sec.
Server Epoch:93 choose agents : [75, 7, 35, 2, 93, 15, 46, 67, 55, 73].
___Train Local_ResNet_18, epoch  93, local model 75, internal_epoch   1, Avg loss: 0.0647, Accuracy: 262/776 (33.7629%)
___Train Local_ResNet_18, epoch  93, local model 75, internal_epoch   2, Avg loss: 0.0278, Accuracy: 425/776 (54.7680%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.0120, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   1, Avg loss: 0.0527, Accuracy: 361/891 (40.5163%)
___Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 431/891 (48.3726%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.0967, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   1, Avg loss: 0.0863, Accuracy: 43/271 (15.8672%)
___Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   2, Avg loss: 0.0553, Accuracy: 118/271 (43.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.3685, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   1, Avg loss: 0.0635, Accuracy: 234/605 (38.6777%)
___Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.8309, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  93, local model 93, internal_epoch   1, Avg loss: 0.0546, Accuracy: 456/1742 (26.1768%)
___Train Local_ResNet_18, epoch  93, local model 93, internal_epoch   2, Avg loss: 0.0313, Accuracy: 696/1742 (39.9541%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.8579, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0554, Accuracy: 347/1154 (30.0693%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0279, Accuracy: 481/1154 (41.6811%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.9375, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   1, Avg loss: 0.0548, Accuracy: 433/1904 (22.7416%)
___Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 694/1904 (36.4496%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.6380, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   1, Avg loss: 0.0776, Accuracy: 56/426 (13.1455%)
___Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   2, Avg loss: 0.0409, Accuracy: 174/426 (40.8451%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.6290, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   1, Avg loss: 0.0548, Accuracy: 293/1071 (27.3576%)
___Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 501/1071 (46.7787%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.0008, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   1, Avg loss: 0.0649, Accuracy: 177/938 (18.8699%)
___Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 348/938 (37.1002%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.4504, Accuracy: 64/10000 (0.6400%)
time spent on training: 263.8627383708954
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 891, 271, 605, 1742, 1154, 1904, 426, 1071, 938]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.3091, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Avg loss: 5.5329, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.64035630226135 sec.
Server Epoch:94 choose agents : [54, 23, 95, 98, 28, 52, 48, 24, 5, 3].
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0538, Accuracy: 364/1130 (32.2124%)
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0284, Accuracy: 490/1130 (43.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.2144, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0616, Accuracy: 324/715 (45.3147%)
___Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.7373, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 342/599 (57.0952%)
___Train Local_ResNet_18, epoch  94, local model 95, internal_epoch   2, Avg loss: 0.0306, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.1301, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 98, internal_epoch   1, Avg loss: 0.0814, Accuracy: 27/373 (7.2386%)
___Train Local_ResNet_18, epoch  94, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.4616, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 409/1581 (25.8697%)
___Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 611/1581 (38.6464%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.7843, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   1, Avg loss: 0.0566, Accuracy: 290/636 (45.5975%)
___Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   2, Avg loss: 0.0310, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 6.2629, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   1, Avg loss: 0.0702, Accuracy: 106/631 (16.7987%)
___Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 219/631 (34.7068%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.8975, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   1, Avg loss: 0.0748, Accuracy: 54/312 (17.3077%)
___Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   2, Avg loss: 0.0407, Accuracy: 163/312 (52.2436%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.3940, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0499, Accuracy: 383/1628 (23.5258%)
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0258, Accuracy: 793/1628 (48.7101%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.1725, Accuracy: 146/10000 (1.4600%)
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0737, Accuracy: 117/781 (14.9808%)
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 236/781 (30.2177%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 6.9700, Accuracy: 66/10000 (0.6600%)
time spent on training: 203.98536682128906
[foolsgold agg] training data poison_ratio: 0.0  data num: [1130, 715, 599, 373, 1581, 636, 631, 312, 1628, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.3091, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Avg loss: 5.5336, Accuracy: 0/9950 (0.0000%)
saving model
Done in 274.93480348587036 sec.
Server Epoch:95 choose agents : [79, 4, 1, 10, 41, 2, 58, 11, 29, 77].
___Train Local_ResNet_18, epoch  95, local model 79, internal_epoch   1, Avg loss: 0.0993, Accuracy: 16/197 (8.1218%)
___Train Local_ResNet_18, epoch  95, local model 79, internal_epoch   2, Avg loss: 0.0831, Accuracy: 62/197 (31.4721%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.3228, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   1, Avg loss: 0.0612, Accuracy: 340/901 (37.7358%)
___Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   2, Avg loss: 0.0310, Accuracy: 385/901 (42.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.0456, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0564, Accuracy: 293/928 (31.5733%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 540/928 (58.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.9088, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0574, Accuracy: 213/861 (24.7387%)
___Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 450/861 (52.2648%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.6587, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   1, Avg loss: 0.0594, Accuracy: 338/719 (47.0097%)
___Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   2, Avg loss: 0.0312, Accuracy: 461/719 (64.1168%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 6.3464, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   1, Avg loss: 0.0630, Accuracy: 231/605 (38.1818%)
___Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   2, Avg loss: 0.0390, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.9245, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0572, Accuracy: 351/803 (43.7111%)
___Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 385/803 (47.9452%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 6.0877, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   1, Avg loss: 0.0542, Accuracy: 350/712 (49.1573%)
___Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 423/712 (59.4101%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 6.7072, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0480, Accuracy: 415/1440 (28.8194%)
___Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 669/1440 (46.4583%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.0606, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  95, local model 77, internal_epoch   1, Avg loss: 0.0529, Accuracy: 335/1340 (25.0000%)
___Train Local_ResNet_18, epoch  95, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 574/1340 (42.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.9029, Accuracy: 58/10000 (0.5800%)
time spent on training: 250.47276663780212
[foolsgold agg] training data poison_ratio: 0.0  data num: [197, 901, 928, 861, 719, 605, 803, 712, 1440, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.3090, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Avg loss: 5.5339, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.7907450199127 sec.
Server Epoch:96 choose agents : [77, 9, 2, 30, 42, 20, 61, 3, 15, 6].
___Train Local_ResNet_18, epoch  96, local model 77, internal_epoch   1, Avg loss: 0.0527, Accuracy: 350/1340 (26.1194%)
___Train Local_ResNet_18, epoch  96, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 534/1340 (39.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.7916, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0487, Accuracy: 372/1275 (29.1765%)
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0194, Accuracy: 737/1275 (57.8039%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.6416, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0618, Accuracy: 236/605 (39.0083%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0405, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.0224, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   1, Avg loss: 0.0790, Accuracy: 78/486 (16.0494%)
___Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   2, Avg loss: 0.0411, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.8339, Accuracy: 39/10000 (0.3900%)
___Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 359/1372 (26.1662%)
___Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 527/1372 (38.4111%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.7335, Accuracy: 100/10000 (1.0000%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  96, local model 20, internal_epoch   1, Avg loss: 0.0570, Accuracy: 350/807 (43.3705%)
___Train Local_ResNet_18, epoch  96, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 424/807 (52.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.8293, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   1, Avg loss: 0.1237, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   2, Avg loss: 0.1151, Accuracy: 11/85 (12.9412%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.3037, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0732, Accuracy: 114/781 (14.5967%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0354, Accuracy: 217/781 (27.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.6543, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   1, Avg loss: 0.0564, Accuracy: 344/1154 (29.8094%)
___Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   2, Avg loss: 0.0274, Accuracy: 533/1154 (46.1872%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.9010, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 429/1956 (21.9325%)
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0314, Accuracy: 675/1956 (34.5092%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.1778, Accuracy: 127/10000 (1.2700%)
time spent on training: 263.0280463695526
[foolsgold agg] training data poison_ratio: 0.08183754183145725  data num: [1340, 1275, 605, 486, 1372, 807, 85, 781, 1154, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.02557423182233039
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.3090, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Avg loss: 5.5347, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.3999593257904 sec.
Server Epoch:97 choose agents : [38, 36, 83, 74, 84, 8, 27, 41, 26, 54].
___Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   1, Avg loss: 0.0605, Accuracy: 262/1131 (23.1653%)
___Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 487/1131 (43.0592%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.3910, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   1, Avg loss: 0.0864, Accuracy: 83/408 (20.3431%)
___Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   2, Avg loss: 0.0538, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.5288, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 462/1953 (23.6559%)
___Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0331, Accuracy: 795/1953 (40.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.9601, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  97, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 502/1552 (32.3454%)
___Train Local_ResNet_18, epoch  97, local model 74, internal_epoch   2, Avg loss: 0.0204, Accuracy: 796/1552 (51.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 10.0603, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   1, Avg loss: 0.0605, Accuracy: 333/1190 (27.9832%)
___Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 444/1190 (37.3109%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.1177, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   1, Avg loss: 0.0587, Accuracy: 264/1513 (17.4488%)
___Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   2, Avg loss: 0.0359, Accuracy: 514/1513 (33.9722%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.0964, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 454/1587 (28.6074%)
___Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 631/1587 (39.7606%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.1874, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0576, Accuracy: 335/719 (46.5925%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0318, Accuracy: 464/719 (64.5341%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 6.5423, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0538, Accuracy: 351/1446 (24.2739%)
___Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 522/1446 (36.0996%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.6636, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 352/1130 (31.1504%)
___Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   2, Avg loss: 0.0284, Accuracy: 467/1130 (41.3274%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.6328, Accuracy: 52/10000 (0.5200%)
time spent on training: 323.928151845932
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 408, 1953, 1552, 1190, 1513, 1587, 719, 1446, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.3090, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Avg loss: 5.5353, Accuracy: 0/9950 (0.0000%)
saving model
Done in 394.49619007110596 sec.
Server Epoch:98 choose agents : [70, 56, 62, 89, 72, 16, 25, 33, 22, 57].
___Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   1, Avg loss: 0.0540, Accuracy: 392/1418 (27.6446%)
___Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   2, Avg loss: 0.0301, Accuracy: 662/1418 (46.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.7123, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0819, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0662, Accuracy: 75/186 (40.3226%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.3106, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0682, Accuracy: 160/568 (28.1690%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.8513, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 338/896 (37.7232%)
___Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 423/896 (47.2098%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 6.3911, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   1, Avg loss: 0.0615, Accuracy: 259/1241 (20.8703%)
___Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   2, Avg loss: 0.0361, Accuracy: 425/1241 (34.2466%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.2904, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0620, Accuracy: 281/708 (39.6893%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0347, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.8674, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   1, Avg loss: 0.0561, Accuracy: 312/690 (45.2174%)
___Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   2, Avg loss: 0.0273, Accuracy: 461/690 (66.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 6.4989, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   1, Avg loss: 0.0776, Accuracy: 85/515 (16.5049%)
___Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   2, Avg loss: 0.0537, Accuracy: 110/515 (21.3592%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.7950, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 565/1470 (38.4354%)
___Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 845/1470 (57.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.1440, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   1, Avg loss: 0.0546, Accuracy: 314/1154 (27.2097%)
___Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   2, Avg loss: 0.0254, Accuracy: 485/1154 (42.0277%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 11.3668, Accuracy: 55/10000 (0.5500%)
time spent on training: 224.62400269508362
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 186, 568, 896, 1241, 708, 690, 515, 1470, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.3090, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Avg loss: 5.5354, Accuracy: 0/9950 (0.0000%)
saving model
Done in 296.46048378944397 sec.
Server Epoch:99 choose agents : [24, 49, 35, 66, 25, 81, 38, 62, 92, 78].
___Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.0748, Accuracy: 50/312 (16.0256%)
___Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0391, Accuracy: 166/312 (53.2051%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.4005, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   1, Avg loss: 0.0781, Accuracy: 41/440 (9.3182%)
___Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   2, Avg loss: 0.0467, Accuracy: 154/440 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.5240, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 48/271 (17.7122%)
___Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0547, Accuracy: 105/271 (38.7454%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.3742, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0608, Accuracy: 274/1402 (19.5435%)
___Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 403/1402 (28.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.1809, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   1, Avg loss: 0.0554, Accuracy: 316/690 (45.7971%)
___Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 457/690 (66.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 6.4866, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  99, local model 81, internal_epoch   1, Avg loss: 0.0676, Accuracy: 251/774 (32.4289%)
___Train Local_ResNet_18, epoch  99, local model 81, internal_epoch   2, Avg loss: 0.0360, Accuracy: 285/774 (36.8217%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 6.3434, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   1, Avg loss: 0.0600, Accuracy: 255/1131 (22.5464%)
___Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   2, Avg loss: 0.0300, Accuracy: 495/1131 (43.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.7626, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   1, Avg loss: 0.0680, Accuracy: 156/568 (27.4648%)
___Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   2, Avg loss: 0.0410, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.8312, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  99, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 452/1715 (26.3557%)
___Train Local_ResNet_18, epoch  99, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 743/1715 (43.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.4882, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  99, local model 78, internal_epoch   1, Avg loss: 0.0829, Accuracy: 40/416 (9.6154%)
___Train Local_ResNet_18, epoch  99, local model 78, internal_epoch   2, Avg loss: 0.0463, Accuracy: 196/416 (47.1154%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.6162, Accuracy: 50/10000 (0.5000%)
time spent on training: 222.08296179771423
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 440, 271, 1402, 690, 774, 1131, 568, 1715, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.99142352 0.99142352 1.         1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.3089, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Avg loss: 5.5354, Accuracy: 0/9950 (0.0000%)
saving model
Done in 291.53089666366577 sec.
Server Epoch:100 choose agents : [47, 65, 85, 24, 39, 5, 1, 53, 87, 58].
___Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   1, Avg loss: 0.1241, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   2, Avg loss: 0.1087, Accuracy: 16/134 (11.9403%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.3091, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   1, Avg loss: 0.0552, Accuracy: 404/1475 (27.3898%)
___Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 672/1475 (45.5593%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.9066, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch 100, local model 85, internal_epoch   1, Avg loss: 0.0527, Accuracy: 429/1988 (21.5795%)
___Train Local_ResNet_18, epoch 100, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 667/1988 (33.5513%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.2016, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   1, Avg loss: 0.0746, Accuracy: 55/312 (17.6282%)
___Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   2, Avg loss: 0.0390, Accuracy: 158/312 (50.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.4059, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0528, Accuracy: 316/1013 (31.1945%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0256, Accuracy: 526/1013 (51.9250%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.9850, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   1, Avg loss: 0.0501, Accuracy: 393/1628 (24.1400%)
___Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   2, Avg loss: 0.0248, Accuracy: 820/1628 (50.3686%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.2496, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   1, Avg loss: 0.0562, Accuracy: 290/928 (31.2500%)
___Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   2, Avg loss: 0.0232, Accuracy: 575/928 (61.9612%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.7322, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0486, Accuracy: 295/813 (36.2854%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 464/813 (57.0726%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.4085, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch 100, local model 87, internal_epoch   1, Avg loss: 0.0572, Accuracy: 304/1131 (26.8789%)
___Train Local_ResNet_18, epoch 100, local model 87, internal_epoch   2, Avg loss: 0.0311, Accuracy: 444/1131 (39.2573%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.0051, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0567, Accuracy: 346/803 (43.0884%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 411/803 (51.1831%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.1983, Accuracy: 58/10000 (0.5800%)
time spent on training: 318.76224184036255
[foolsgold agg] training data poison_ratio: 0.0  data num: [134, 1475, 1988, 312, 1013, 1628, 928, 813, 1131, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.3089, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Avg loss: 5.5347, Accuracy: 0/9950 (0.0000%)
saving model
Done in 392.17040848731995 sec.
Saving all the graphs.
This run has a label: Jun.17_08.06.26. Visdom environment: tiny
