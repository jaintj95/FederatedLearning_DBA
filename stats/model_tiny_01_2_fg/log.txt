current path: saved_models/model_tiny_Jun.19_08.25.49
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [17]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [83, 85, 64, 95, 54, 55, 27, 92, 15, 78].
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 425/1953 (21.7614%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 756/1953 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9344, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 463/1988 (23.2897%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 665/1988 (33.4507%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.1898, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   1, Avg loss: 0.0653, Accuracy: 161/953 (16.8940%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 314/953 (32.9486%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.3761, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 320/599 (53.4224%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6887, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 335/1130 (29.6460%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 463/1130 (40.9735%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5532, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0568, Accuracy: 233/1071 (21.7554%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0299, Accuracy: 468/1071 (43.6975%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9104, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 431/1587 (27.1582%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 615/1587 (38.7524%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.1711, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 446/1715 (26.0058%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0312, Accuracy: 705/1715 (41.1079%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.3383, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 316/1154 (27.3830%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   2, Avg loss: 0.0309, Accuracy: 370/1154 (32.0624%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7044, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 33/416 (7.9327%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 175/416 (42.0673%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5497, Accuracy: 50/10000 (0.5000%)
time spent on training: 87.17644691467285
[foolsgold agg] training data poison_ratio: 0.0  data num: [1953, 1988, 953, 599, 1130, 1071, 1587, 1715, 1154, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6216, Accuracy: 0/9950 (0.0000%)
saving model
Done in 154.76073241233826 sec.
Server Epoch:2 choose agents : [64, 47, 43, 23, 24, 98, 84, 28, 6, 17].
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   1, Avg loss: 0.0653, Accuracy: 161/953 (16.8940%)
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   2, Avg loss: 0.0384, Accuracy: 313/953 (32.8437%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.4651, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1221, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1135, Accuracy: 10/134 (7.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 307/946 (32.4524%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 340/946 (35.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.8981, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   1, Avg loss: 0.0610, Accuracy: 313/715 (43.7762%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   2, Avg loss: 0.0385, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7561, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0408, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3788, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   1, Avg loss: 0.0831, Accuracy: 12/373 (3.2172%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   2, Avg loss: 0.0493, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.4469, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 317/1190 (26.6387%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0334, Accuracy: 434/1190 (36.4706%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.1618, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0569, Accuracy: 377/1581 (23.8457%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 602/1581 (38.0772%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6118, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   1, Avg loss: 0.0556, Accuracy: 380/1956 (19.4274%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   2, Avg loss: 0.0325, Accuracy: 646/1956 (33.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.1795, Accuracy: 101/10000 (1.0100%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 387/1574 (24.5870%)
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   2, Avg loss: 0.0283, Accuracy: 624/1574 (39.6442%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.2497, Accuracy: 89/10000 (0.8900%)
time spent on training: 105.57250189781189
[foolsgold agg] training data poison_ratio: 0.1617012533388124  data num: [953, 134, 946, 715, 312, 373, 1190, 1581, 1956, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.05053164166837888
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3168, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6196, Accuracy: 0/9950 (0.0000%)
saving model
Done in 173.89510798454285 sec.
Server Epoch:3 choose agents : [75, 58, 7, 84, 94, 13, 3, 69, 93, 10].
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 236/776 (30.4124%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0291, Accuracy: 425/776 (54.7680%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8602, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   1, Avg loss: 0.0585, Accuracy: 347/803 (43.2130%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 419/803 (52.1793%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.9181, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   1, Avg loss: 0.0540, Accuracy: 344/891 (38.6083%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 453/891 (50.8418%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1882, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   1, Avg loss: 0.0635, Accuracy: 311/1190 (26.1345%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   2, Avg loss: 0.0331, Accuracy: 427/1190 (35.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8684, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 330/1662 (19.8556%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0336, Accuracy: 596/1662 (35.8604%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6203, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0586, Accuracy: 297/1645 (18.0547%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 628/1645 (38.1763%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0031, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   1, Avg loss: 0.0762, Accuracy: 101/781 (12.9321%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   2, Avg loss: 0.0367, Accuracy: 246/781 (31.4981%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.5832, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 276/590 (46.7797%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0314, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.7414, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 409/1742 (23.4788%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 703/1742 (40.3559%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7418, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   1, Avg loss: 0.0574, Accuracy: 202/861 (23.4611%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   2, Avg loss: 0.0219, Accuracy: 442/861 (51.3357%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7479, Accuracy: 51/10000 (0.5100%)
time spent on training: 87.28746342658997
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 803, 891, 1190, 1662, 1645, 781, 590, 1742, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3166, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6184, Accuracy: 0/9950 (0.0000%)
saving model
Done in 153.51830458641052 sec.
Server Epoch:4 choose agents : [20, 64, 31, 75, 6, 23, 40, 51, 12, 63].
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   1, Avg loss: 0.0563, Accuracy: 340/807 (42.1314%)
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 437/807 (54.1512%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.9380, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0653, Accuracy: 168/953 (17.6285%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 311/953 (32.6338%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.4877, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0827, Accuracy: 53/460 (11.5217%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0370, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7054, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   1, Avg loss: 0.0628, Accuracy: 241/776 (31.0567%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   2, Avg loss: 0.0298, Accuracy: 412/776 (53.0928%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.0319, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   1, Avg loss: 0.0557, Accuracy: 403/1956 (20.6033%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 622/1956 (31.7996%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.0740, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   1, Avg loss: 0.0628, Accuracy: 318/715 (44.4755%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   2, Avg loss: 0.0390, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.6906, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   1, Avg loss: 0.0558, Accuracy: 329/1573 (20.9154%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 545/1573 (34.6472%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.5466, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 220/1049 (20.9724%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 481/1049 (45.8532%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.6466, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   1, Avg loss: 0.0888, Accuracy: 16/338 (4.7337%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   2, Avg loss: 0.0485, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.4313, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   1, Avg loss: 0.0550, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 432/888 (48.6486%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.2974, Accuracy: 50/10000 (0.5000%)
time spent on training: 85.62564539909363
[foolsgold agg] training data poison_ratio: 0.0  data num: [807, 953, 460, 776, 1956, 715, 1573, 1049, 338, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3165, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6169, Accuracy: 0/9950 (0.0000%)
saving model
Done in 152.42344117164612 sec.
Server Epoch:5 choose agents : [61, 96, 54, 1, 51, 20, 46, 92, 90, 82].
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   1, Avg loss: 0.1250, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   2, Avg loss: 0.1184, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3044, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   1, Avg loss: 0.0791, Accuracy: 40/311 (12.8617%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3455, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   1, Avg loss: 0.0555, Accuracy: 333/1130 (29.4690%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 481/1130 (42.5664%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6060, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   1, Avg loss: 0.0579, Accuracy: 287/928 (30.9267%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 535/928 (57.6509%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8746, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   1, Avg loss: 0.0608, Accuracy: 222/1049 (21.1630%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 519/1049 (49.4757%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5555, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 345/807 (42.7509%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 430/807 (53.2838%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.9399, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   1, Avg loss: 0.0561, Accuracy: 386/1904 (20.2731%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 696/1904 (36.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.4873, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 465/1715 (27.1137%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 687/1715 (40.0583%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.4412, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   1, Avg loss: 0.0567, Accuracy: 309/677 (45.6425%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 450/677 (66.4697%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.0123, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0771, Accuracy: 59/500 (11.8000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.6071, Accuracy: 50/10000 (0.5000%)
time spent on training: 85.70396184921265
[foolsgold agg] training data poison_ratio: 0.0  data num: [85, 311, 1130, 928, 1049, 807, 1904, 1715, 677, 500]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3164, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.6175, Accuracy: 0/9950 (0.0000%)
saving model
Done in 152.0791199207306 sec.
Server Epoch:6 choose agents : [41, 84, 93, 94, 55, 85, 52, 32, 43, 95].
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   1, Avg loss: 0.0603, Accuracy: 326/719 (45.3408%)
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   2, Avg loss: 0.0303, Accuracy: 464/719 (64.5341%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.2980, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 324/1190 (27.2269%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 468/1190 (39.3277%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.2013, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 443/1742 (25.4305%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 701/1742 (40.2411%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6103, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 326/1662 (19.6149%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 612/1662 (36.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8793, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 236/1071 (22.0355%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   2, Avg loss: 0.0297, Accuracy: 492/1071 (45.9384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0172, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 419/1988 (21.0765%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 629/1988 (31.6398%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.1047, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0573, Accuracy: 273/636 (42.9245%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0310, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.0930, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   1, Avg loss: 0.0616, Accuracy: 195/735 (26.5306%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 348/735 (47.3469%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5364, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   1, Avg loss: 0.0631, Accuracy: 294/946 (31.0782%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   2, Avg loss: 0.0369, Accuracy: 316/946 (33.4038%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.0439, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 326/599 (54.4240%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0300, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5615, Accuracy: 50/10000 (0.5000%)
time spent on training: 92.82824039459229
[foolsgold agg] training data poison_ratio: 0.0  data num: [719, 1190, 1742, 1662, 1071, 1988, 636, 735, 946, 599]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3164, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.6139, Accuracy: 0/9950 (0.0000%)
saving model
Done in 159.22628569602966 sec.
Server Epoch:7 choose agents : [54, 60, 32, 23, 69, 52, 79, 83, 9, 90].
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   1, Avg loss: 0.0549, Accuracy: 342/1130 (30.2655%)
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 466/1130 (41.2389%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.4792, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 583/2227 (26.1787%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1047/2227 (47.0139%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1673, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   1, Avg loss: 0.0610, Accuracy: 217/735 (29.5238%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 362/735 (49.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.9110, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   1, Avg loss: 0.0599, Accuracy: 314/715 (43.9161%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   2, Avg loss: 0.0402, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.7319, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   1, Avg loss: 0.0573, Accuracy: 281/590 (47.6271%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   2, Avg loss: 0.0325, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.8352, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 272/636 (42.7673%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   2, Avg loss: 0.0322, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.2546, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.0991, Accuracy: 15/197 (7.6142%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0844, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3238, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   1, Avg loss: 0.0549, Accuracy: 402/1953 (20.5837%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 766/1953 (39.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.9046, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   1, Avg loss: 0.0504, Accuracy: 351/1275 (27.5294%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   2, Avg loss: 0.0197, Accuracy: 701/1275 (54.9804%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.3058, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0573, Accuracy: 311/677 (45.9380%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0242, Accuracy: 429/677 (63.3678%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.0118, Accuracy: 53/10000 (0.5300%)
time spent on training: 91.37581658363342
[foolsgold agg] training data poison_ratio: 0.0  data num: [1130, 2227, 735, 715, 590, 636, 197, 1953, 1275, 677]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3163, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.6087, Accuracy: 0/9950 (0.0000%)
saving model
Done in 157.11064434051514 sec.
Server Epoch:8 choose agents : [64, 23, 12, 0, 58, 28, 45, 16, 11, 62].
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   1, Avg loss: 0.0653, Accuracy: 163/953 (17.1039%)
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 296/953 (31.0598%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.3516, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   1, Avg loss: 0.0619, Accuracy: 311/715 (43.4965%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   2, Avg loss: 0.0378, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.6829, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 20/338 (5.9172%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0474, Accuracy: 134/338 (39.6450%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.4369, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   1, Avg loss: 0.0583, Accuracy: 345/1657 (20.8208%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 502/1657 (30.2957%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.8240, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   1, Avg loss: 0.0587, Accuracy: 342/803 (42.5903%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   2, Avg loss: 0.0350, Accuracy: 360/803 (44.8319%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.9781, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 391/1581 (24.7312%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 584/1581 (36.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.5881, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   1, Avg loss: 0.0690, Accuracy: 193/669 (28.8490%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   2, Avg loss: 0.0407, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.7205, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0612, Accuracy: 280/708 (39.5480%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0373, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.7974, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   1, Avg loss: 0.0539, Accuracy: 344/712 (48.3146%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   2, Avg loss: 0.0288, Accuracy: 428/712 (60.1124%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.5323, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   1, Avg loss: 0.0694, Accuracy: 136/568 (23.9437%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.7317, Accuracy: 50/10000 (0.5000%)
time spent on training: 88.41371154785156
[foolsgold agg] training data poison_ratio: 0.0  data num: [953, 715, 338, 1657, 803, 1581, 669, 708, 712, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         0.81297945 0.81297945 1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3161, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.6064, Accuracy: 0/9950 (0.0000%)
saving model
Done in 154.2943434715271 sec.
Server Epoch:9 choose agents : [37, 84, 60, 12, 87, 98, 51, 76, 36, 92].
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0521, Accuracy: 379/1129 (33.5695%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0254, Accuracy: 711/1129 (62.9761%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.3297, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0635, Accuracy: 316/1190 (26.5546%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 435/1190 (36.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.8931, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 526/2227 (23.6192%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1021/2227 (45.8464%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.4575, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   2, Avg loss: 0.0486, Accuracy: 131/338 (38.7574%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4291, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   1, Avg loss: 0.0589, Accuracy: 293/1131 (25.9063%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   2, Avg loss: 0.0315, Accuracy: 410/1131 (36.2511%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.5223, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   1, Avg loss: 0.0832, Accuracy: 13/373 (3.4853%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   2, Avg loss: 0.0483, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4262, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 230/1049 (21.9256%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 507/1049 (48.3317%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.4719, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   1, Avg loss: 0.0866, Accuracy: 38/466 (8.1545%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   2, Avg loss: 0.0493, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.6584, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   1, Avg loss: 0.0876, Accuracy: 68/408 (16.6667%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   2, Avg loss: 0.0558, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4773, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 451/1715 (26.2974%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   2, Avg loss: 0.0312, Accuracy: 691/1715 (40.2915%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.5202, Accuracy: 90/10000 (0.9000%)
time spent on training: 93.30837035179138
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 1190, 2227, 338, 1131, 373, 1049, 466, 408, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3160, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.6054, Accuracy: 0/9950 (0.0000%)
saving model
Done in 159.35826706886292 sec.
Server Epoch:10 choose agents : [71, 14, 55, 43, 88, 30, 56, 96, 98, 5].
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   1, Avg loss: 0.0648, Accuracy: 155/818 (18.9487%)
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 329/818 (40.2200%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.9637, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   1, Avg loss: 0.0624, Accuracy: 213/1013 (21.0267%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 352/1013 (34.7483%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.6448, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 248/1071 (23.1559%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   2, Avg loss: 0.0294, Accuracy: 490/1071 (45.7516%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.0536, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   1, Avg loss: 0.0614, Accuracy: 309/946 (32.6638%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   2, Avg loss: 0.0368, Accuracy: 359/946 (37.9493%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.0266, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 140/603 (23.2172%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   2, Avg loss: 0.0475, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.8876, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0816, Accuracy: 66/486 (13.5802%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 208/486 (42.7984%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.7097, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 59/186 (31.7204%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3121, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   1, Avg loss: 0.0786, Accuracy: 52/311 (16.7203%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   2, Avg loss: 0.0536, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3436, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   1, Avg loss: 0.0830, Accuracy: 16/373 (4.2895%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   2, Avg loss: 0.0486, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.4234, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0515, Accuracy: 352/1628 (21.6216%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0263, Accuracy: 789/1628 (48.4644%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.1535, Accuracy: 129/10000 (1.2900%)
time spent on training: 86.37996864318848
[foolsgold agg] training data poison_ratio: 0.0  data num: [818, 1013, 1071, 946, 603, 486, 186, 311, 373, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3159, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.6054, Accuracy: 0/9950 (0.0000%)
saving model
Done in 152.21768856048584 sec.
Server Epoch:11 choose agents : [24, 78, 29, 5, 92, 11, 87, 10, 26, 13].
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0776, Accuracy: 21/312 (6.7308%)
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0421, Accuracy: 158/312 (50.6410%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3837, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   1, Avg loss: 0.0833, Accuracy: 41/416 (9.8558%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   2, Avg loss: 0.0473, Accuracy: 174/416 (41.8269%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.5519, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 436/1440 (30.2778%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 655/1440 (45.4861%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7306, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   1, Avg loss: 0.0522, Accuracy: 376/1628 (23.0958%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 797/1628 (48.9558%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1918, Accuracy: 137/10000 (1.3700%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0519, Accuracy: 466/1715 (27.1720%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 709/1715 (41.3411%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6956, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 346/712 (48.5955%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0283, Accuracy: 398/712 (55.8989%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.5396, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   1, Avg loss: 0.0577, Accuracy: 306/1131 (27.0557%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   2, Avg loss: 0.0323, Accuracy: 399/1131 (35.2785%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7579, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 203/861 (23.5772%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   2, Avg loss: 0.0221, Accuracy: 437/861 (50.7549%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.8560, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 335/1446 (23.1674%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 506/1446 (34.9931%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.1872, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 298/1645 (18.1155%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 596/1645 (36.2310%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9712, Accuracy: 120/10000 (1.2000%)
time spent on training: 100.01935529708862
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 416, 1440, 1628, 1715, 712, 1131, 861, 1446, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3157, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.6053, Accuracy: 0/9950 (0.0000%)
saving model
Done in 166.44995641708374 sec.
Server Epoch:12 choose agents : [36, 80, 93, 31, 33, 86, 62, 98, 21, 13].
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0887, Accuracy: 66/408 (16.1765%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0550, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.4632, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   1, Avg loss: 0.0710, Accuracy: 138/682 (20.2346%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   2, Avg loss: 0.0385, Accuracy: 249/682 (36.5103%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.4977, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 414/1742 (23.7658%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 702/1742 (40.2985%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8183, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   1, Avg loss: 0.0820, Accuracy: 50/460 (10.8696%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   2, Avg loss: 0.0412, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7059, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   1, Avg loss: 0.0798, Accuracy: 66/515 (12.8155%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   2, Avg loss: 0.0510, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.6719, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0626, Accuracy: 353/1003 (35.1944%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0351, Accuracy: 356/1003 (35.4935%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.7903, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   1, Avg loss: 0.0689, Accuracy: 139/568 (24.4718%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   2, Avg loss: 0.0409, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7679, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   1, Avg loss: 0.0825, Accuracy: 16/373 (4.2895%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   2, Avg loss: 0.0490, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.4291, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 405/1949 (20.7799%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 591/1949 (30.3232%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.3794, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 319/1645 (19.3921%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 612/1645 (37.2036%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0875, Accuracy: 108/10000 (1.0800%)
time spent on training: 95.48213505744934
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 682, 1742, 460, 515, 1003, 568, 373, 1949, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3156, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.6048, Accuracy: 0/9950 (0.0000%)
saving model
Done in 161.4936807155609 sec.
Server Epoch:13 choose agents : [35, 75, 70, 14, 55, 6, 16, 50, 46, 23].
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0856, Accuracy: 38/271 (14.0221%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0549, Accuracy: 103/271 (38.0074%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3628, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   1, Avg loss: 0.0650, Accuracy: 249/776 (32.0876%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   2, Avg loss: 0.0297, Accuracy: 427/776 (55.0258%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.8613, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 365/1418 (25.7405%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 654/1418 (46.1213%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.6202, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 216/1013 (21.3228%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   2, Avg loss: 0.0362, Accuracy: 311/1013 (30.7009%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.5991, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   1, Avg loss: 0.0557, Accuracy: 242/1071 (22.5957%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 500/1071 (46.6853%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.7476, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   1, Avg loss: 0.0551, Accuracy: 419/1956 (21.4213%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 639/1956 (32.6687%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1229, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0669, Accuracy: 269/708 (37.9944%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0342, Accuracy: 429/708 (60.5932%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.0869, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0637, Accuracy: 146/809 (18.0470%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 349/809 (43.1397%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.3096, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   1, Avg loss: 0.0547, Accuracy: 424/1904 (22.2689%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 657/1904 (34.5063%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.7665, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0616, Accuracy: 314/715 (43.9161%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0387, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.7473, Accuracy: 50/10000 (0.5000%)
time spent on training: 101.51426959037781
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 776, 1418, 1013, 1071, 1956, 708, 809, 1904, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3154, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.6042, Accuracy: 0/9950 (0.0000%)
saving model
Done in 166.98593759536743 sec.
Server Epoch:14 choose agents : [69, 64, 65, 61, 33, 70, 82, 60, 83, 98].
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0565, Accuracy: 280/590 (47.4576%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0292, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.6778, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 147/953 (15.4250%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 315/953 (33.0535%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.4596, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0568, Accuracy: 387/1475 (26.2373%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 636/1475 (43.1186%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.2426, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1264, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1166, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3040, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   1, Avg loss: 0.0778, Accuracy: 64/515 (12.4272%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   2, Avg loss: 0.0525, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.7629, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 343/1418 (24.1890%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0315, Accuracy: 644/1418 (45.4161%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.6388, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 72/500 (14.4000%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0472, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.6217, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 601/2227 (26.9870%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1049/2227 (47.1037%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.3638, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 428/1953 (21.9150%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 783/1953 (40.0922%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.9561, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0823, Accuracy: 16/373 (4.2895%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0479, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.4282, Accuracy: 50/10000 (0.5000%)
time spent on training: 100.27404618263245
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 953, 1475, 85, 515, 1418, 500, 2227, 1953, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3153, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.5998, Accuracy: 0/9950 (0.0000%)
saving model
Done in 165.81913423538208 sec.
Server Epoch:15 choose agents : [69, 62, 83, 78, 25, 41, 18, 65, 38, 94].
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   1, Avg loss: 0.0558, Accuracy: 285/590 (48.3051%)
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   2, Avg loss: 0.0295, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.0146, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   1, Avg loss: 0.0696, Accuracy: 137/568 (24.1197%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   2, Avg loss: 0.0410, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.6963, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 439/1953 (22.4782%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 770/1953 (39.4265%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9887, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 37/416 (8.8942%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0466, Accuracy: 179/416 (43.0288%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.5344, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   1, Avg loss: 0.0572, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   2, Avg loss: 0.0285, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.5265, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 328/719 (45.6189%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0320, Accuracy: 460/719 (63.9777%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.2418, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0772, Accuracy: 117/530 (22.0755%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0394, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.0440, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   1, Avg loss: 0.0560, Accuracy: 412/1475 (27.9322%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 646/1475 (43.7966%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.9814, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   1, Avg loss: 0.0620, Accuracy: 239/1131 (21.1317%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   2, Avg loss: 0.0314, Accuracy: 465/1131 (41.1141%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.2727, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 350/1662 (21.0590%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 588/1662 (35.3791%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.7974, Accuracy: 88/10000 (0.8800%)
time spent on training: 99.83300495147705
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 568, 1953, 416, 690, 719, 530, 1475, 1131, 1662]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3151, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.5979, Accuracy: 0/9950 (0.0000%)
saving model
Done in 165.47002339363098 sec.
Server Epoch:16 choose agents : [23, 21, 70, 65, 79, 5, 63, 95, 58, 32].
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0588, Accuracy: 315/715 (44.0559%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0407, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.7432, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 407/1949 (20.8825%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 628/1949 (32.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.2337, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0562, Accuracy: 341/1418 (24.0480%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0317, Accuracy: 610/1418 (43.0183%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.7371, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 392/1475 (26.5763%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 716/1475 (48.5424%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.0348, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   1, Avg loss: 0.1030, Accuracy: 10/197 (5.0761%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   2, Avg loss: 0.0844, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3198, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   1, Avg loss: 0.0513, Accuracy: 328/1628 (20.1474%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 776/1628 (47.6658%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1265, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0548, Accuracy: 256/888 (28.8288%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 395/888 (44.4820%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.0332, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   1, Avg loss: 0.0526, Accuracy: 327/599 (54.5910%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.8685, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 342/803 (42.5903%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 408/803 (50.8095%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.9897, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0604, Accuracy: 195/735 (26.5306%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0235, Accuracy: 321/735 (43.6735%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.7283, Accuracy: 50/10000 (0.5000%)
time spent on training: 104.42585897445679
[foolsgold agg] training data poison_ratio: 0.0  data num: [715, 1949, 1418, 1475, 197, 1628, 888, 599, 803, 735]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3150, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.5930, Accuracy: 0/9950 (0.0000%)
saving model
Done in 171.0308129787445 sec.
Server Epoch:17 choose agents : [35, 28, 27, 80, 54, 62, 32, 22, 4, 42].
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0864, Accuracy: 37/271 (13.6531%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0561, Accuracy: 102/271 (37.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3612, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0572, Accuracy: 377/1581 (23.8457%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0338, Accuracy: 561/1581 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.6910, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 447/1587 (28.1664%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 610/1587 (38.4373%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.0849, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   1, Avg loss: 0.0702, Accuracy: 141/682 (20.6745%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   2, Avg loss: 0.0378, Accuracy: 263/682 (38.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.3092, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 350/1130 (30.9735%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 472/1130 (41.7699%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.6036, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   1, Avg loss: 0.0688, Accuracy: 135/568 (23.7676%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   2, Avg loss: 0.0411, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.6995, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 191/735 (25.9864%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 344/735 (46.8027%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7758, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 504/1470 (34.2857%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 856/1470 (58.2313%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.0462, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   1, Avg loss: 0.0606, Accuracy: 325/901 (36.0710%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   2, Avg loss: 0.0324, Accuracy: 416/901 (46.1709%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.3375, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 343/1372 (25.0000%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 528/1372 (38.4840%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.9121, Accuracy: 79/10000 (0.7900%)
time spent on training: 104.7083671092987
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 1581, 1587, 682, 1130, 568, 735, 1470, 901, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3149, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.5895, Accuracy: 0/9950 (0.0000%)
saving model
Done in 170.78581857681274 sec.
Server Epoch:18 choose agents : [76, 89, 2, 23, 1, 7, 78, 50, 72, 28].
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0867, Accuracy: 35/466 (7.5107%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0498, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.6988, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   1, Avg loss: 0.0613, Accuracy: 328/896 (36.6071%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   2, Avg loss: 0.0343, Accuracy: 448/896 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.1580, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0635, Accuracy: 232/605 (38.3471%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.8827, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   1, Avg loss: 0.0608, Accuracy: 320/715 (44.7552%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   2, Avg loss: 0.0375, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.7476, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 288/928 (31.0345%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   2, Avg loss: 0.0247, Accuracy: 549/928 (59.1595%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.7533, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 351/891 (39.3939%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 408/891 (45.7912%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.9324, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0832, Accuracy: 39/416 (9.3750%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0478, Accuracy: 182/416 (43.7500%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.5619, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   1, Avg loss: 0.0635, Accuracy: 142/809 (17.5525%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   2, Avg loss: 0.0277, Accuracy: 329/809 (40.6675%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.0962, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 255/1241 (20.5479%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 414/1241 (33.3602%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.2730, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 392/1581 (24.7944%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 583/1581 (36.8754%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.6754, Accuracy: 90/10000 (0.9000%)
time spent on training: 101.27906560897827
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 896, 605, 715, 928, 891, 416, 809, 1241, 1581]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3148, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.5892, Accuracy: 0/9950 (0.0000%)
saving model
Done in 167.44931745529175 sec.
Server Epoch:19 choose agents : [6, 86, 35, 16, 89, 92, 20, 59, 10, 14].
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   1, Avg loss: 0.0551, Accuracy: 390/1956 (19.9387%)
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 633/1956 (32.3620%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.0886, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   1, Avg loss: 0.0634, Accuracy: 351/1003 (34.9950%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   2, Avg loss: 0.0348, Accuracy: 361/1003 (35.9920%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.0228, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   1, Avg loss: 0.0846, Accuracy: 44/271 (16.2362%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   2, Avg loss: 0.0556, Accuracy: 98/271 (36.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3663, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0643, Accuracy: 276/708 (38.9831%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0362, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.9144, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 329/896 (36.7188%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.2599, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 438/1715 (25.5394%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 733/1715 (42.7405%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.5337, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0576, Accuracy: 338/807 (41.8835%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 433/807 (53.6555%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.9316, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   1, Avg loss: 0.0528, Accuracy: 302/1089 (27.7319%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   2, Avg loss: 0.0290, Accuracy: 429/1089 (39.3939%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.6175, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   1, Avg loss: 0.0571, Accuracy: 219/861 (25.4355%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   2, Avg loss: 0.0219, Accuracy: 441/861 (51.2195%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.7863, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   1, Avg loss: 0.0622, Accuracy: 221/1013 (21.8164%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 318/1013 (31.3919%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.5141, Accuracy: 59/10000 (0.5900%)
time spent on training: 108.01366901397705
[foolsgold agg] training data poison_ratio: 0.0  data num: [1956, 1003, 271, 708, 896, 1715, 807, 1089, 861, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3147, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.5885, Accuracy: 0/9950 (0.0000%)
saving model
Done in 174.11313223838806 sec.
Server Epoch:20 choose agents : [75, 13, 54, 6, 63, 49, 70, 51, 58, 9].
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 243/776 (31.3144%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0304, Accuracy: 416/776 (53.6082%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.9259, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 308/1645 (18.7234%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 635/1645 (38.6018%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.0111, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   1, Avg loss: 0.0557, Accuracy: 336/1130 (29.7345%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 466/1130 (41.2389%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.5075, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 404/1956 (20.6544%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 623/1956 (31.8507%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.1639, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 252/888 (28.3784%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 440/888 (49.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.7771, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   1, Avg loss: 0.0811, Accuracy: 20/440 (4.5455%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   2, Avg loss: 0.0494, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.4698, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0570, Accuracy: 335/1418 (23.6248%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 587/1418 (41.3963%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.6844, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   1, Avg loss: 0.0599, Accuracy: 227/1049 (21.6397%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 514/1049 (48.9990%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.6269, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 352/803 (43.8356%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 394/803 (49.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.1267, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   1, Avg loss: 0.0496, Accuracy: 352/1275 (27.6078%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 708/1275 (55.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.3765, Accuracy: 100/10000 (1.0000%)
time spent on training: 113.46761536598206
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 1645, 1130, 1956, 888, 440, 1418, 1049, 803, 1275]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3146, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.5882, Accuracy: 0/9950 (0.0000%)
saving model
Done in 178.8708324432373 sec.
Server Epoch:21 choose agents : [16, 25, 46, 76, 98, 73, 93, 64, 21, 10].
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   1, Avg loss: 0.0664, Accuracy: 269/708 (37.9944%)
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   2, Avg loss: 0.0346, Accuracy: 430/708 (60.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.8509, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   1, Avg loss: 0.0580, Accuracy: 300/690 (43.4783%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.3020, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 419/1904 (22.0063%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 657/1904 (34.5063%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.9564, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   1, Avg loss: 0.0864, Accuracy: 39/466 (8.3691%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   2, Avg loss: 0.0499, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.6754, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   1, Avg loss: 0.0819, Accuracy: 16/373 (4.2895%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.4315, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   1, Avg loss: 0.0667, Accuracy: 167/938 (17.8038%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 308/938 (32.8358%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.9865, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 435/1742 (24.9713%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 683/1742 (39.2078%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8021, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   1, Avg loss: 0.0649, Accuracy: 166/953 (17.4187%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 291/953 (30.5352%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.4984, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0541, Accuracy: 369/1949 (18.9328%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 651/1949 (33.4017%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.1957, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 201/861 (23.3449%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   2, Avg loss: 0.0219, Accuracy: 437/861 (50.7549%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.0423, Accuracy: 51/10000 (0.5100%)
time spent on training: 111.60193252563477
[foolsgold agg] training data poison_ratio: 0.0  data num: [708, 690, 1904, 466, 373, 938, 1742, 953, 1949, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3145, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.5855, Accuracy: 0/9950 (0.0000%)
saving model
Done in 177.81840467453003 sec.
Server Epoch:22 choose agents : [21, 48, 18, 74, 1, 99, 7, 76, 53, 8].
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 405/1949 (20.7799%)
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 647/1949 (33.1965%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.2968, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   1, Avg loss: 0.0712, Accuracy: 101/631 (16.0063%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   2, Avg loss: 0.0415, Accuracy: 220/631 (34.8653%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.8415, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0768, Accuracy: 116/530 (21.8868%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0388, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.9678, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0435, Accuracy: 484/1552 (31.1856%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 747/1552 (48.1314%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.3821, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 283/928 (30.4957%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 558/928 (60.1293%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4595, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   1, Avg loss: 0.0679, Accuracy: 173/773 (22.3803%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   2, Avg loss: 0.0316, Accuracy: 396/773 (51.2290%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.1831, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 350/891 (39.2817%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 483/891 (54.2088%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.0103, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0858, Accuracy: 36/466 (7.7253%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0478, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.6239, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   1, Avg loss: 0.0499, Accuracy: 274/813 (33.7023%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 449/813 (55.2276%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.8716, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0603, Accuracy: 245/1513 (16.1930%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 456/1513 (30.1388%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.5369, Accuracy: 97/10000 (0.9700%)
time spent on training: 110.8364782333374
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 631, 530, 1552, 928, 773, 891, 466, 813, 1513]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3143, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.5847, Accuracy: 0/9950 (0.0000%)
saving model
Done in 176.93877053260803 sec.
Server Epoch:23 choose agents : [52, 94, 1, 86, 21, 75, 2, 4, 62, 81].
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   1, Avg loss: 0.0567, Accuracy: 279/636 (43.8679%)
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.2842, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 325/1662 (19.5548%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 612/1662 (36.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.9488, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   1, Avg loss: 0.0568, Accuracy: 282/928 (30.3879%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 555/928 (59.8060%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7888, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   1, Avg loss: 0.0627, Accuracy: 357/1003 (35.5932%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 374/1003 (37.2881%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.6231, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 383/1949 (19.6511%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 632/1949 (32.4269%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.2685, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 246/776 (31.7010%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 397/776 (51.1598%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.6443, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 228/605 (37.6860%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.8485, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0631, Accuracy: 329/901 (36.5150%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0338, Accuracy: 400/901 (44.3951%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.9445, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   1, Avg loss: 0.0691, Accuracy: 138/568 (24.2958%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   2, Avg loss: 0.0406, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.7093, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0709, Accuracy: 234/774 (30.2326%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0343, Accuracy: 303/774 (39.1473%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.2811, Accuracy: 70/10000 (0.7000%)
time spent on training: 111.37010765075684
[foolsgold agg] training data poison_ratio: 0.0  data num: [636, 1662, 928, 1003, 1949, 776, 605, 901, 568, 774]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3142, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.5842, Accuracy: 0/9950 (0.0000%)
saving model
Done in 177.56019234657288 sec.
Server Epoch:24 choose agents : [84, 82, 13, 67, 2, 10, 50, 70, 14, 69].
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0628, Accuracy: 323/1190 (27.1429%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 446/1190 (37.4790%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.1392, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0768, Accuracy: 61/500 (12.2000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.6272, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 318/1645 (19.3313%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 602/1645 (36.5957%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.0439, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0788, Accuracy: 54/426 (12.6761%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0420, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.5860, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   1, Avg loss: 0.0634, Accuracy: 222/605 (36.6942%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   2, Avg loss: 0.0384, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.8835, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 206/861 (23.9257%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 439/861 (50.9872%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1136, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   1, Avg loss: 0.0633, Accuracy: 145/809 (17.9234%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 367/809 (45.3646%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.1410, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   1, Avg loss: 0.0559, Accuracy: 346/1418 (24.4006%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 647/1418 (45.6276%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.7889, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 223/1013 (22.0138%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 298/1013 (29.4176%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5915, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   1, Avg loss: 0.0553, Accuracy: 288/590 (48.8136%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   2, Avg loss: 0.0325, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.9226, Accuracy: 50/10000 (0.5000%)
time spent on training: 112.1709418296814
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 500, 1645, 426, 605, 861, 809, 1418, 1013, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3142, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.5850, Accuracy: 0/9950 (0.0000%)
saving model
Done in 177.81613087654114 sec.
Server Epoch:25 choose agents : [44, 26, 53, 87, 15, 94, 31, 2, 81, 48].
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0599, Accuracy: 389/1750 (22.2286%)
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 672/1750 (38.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.5992, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0557, Accuracy: 328/1446 (22.6833%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 519/1446 (35.8921%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.3152, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 269/813 (33.0873%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 452/813 (55.5966%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.2334, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   1, Avg loss: 0.0581, Accuracy: 302/1131 (26.7020%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 378/1131 (33.4218%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7164, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 320/1154 (27.7296%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 442/1154 (38.3016%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.0362, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 343/1662 (20.6378%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 578/1662 (34.7774%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9283, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   1, Avg loss: 0.0813, Accuracy: 73/460 (15.8696%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   2, Avg loss: 0.0373, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7019, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   1, Avg loss: 0.0626, Accuracy: 234/605 (38.6777%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   2, Avg loss: 0.0399, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.8589, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   1, Avg loss: 0.0674, Accuracy: 245/774 (31.6537%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   2, Avg loss: 0.0366, Accuracy: 310/774 (40.0517%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.3781, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0710, Accuracy: 91/631 (14.4216%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0413, Accuracy: 223/631 (35.3407%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7743, Accuracy: 50/10000 (0.5000%)
time spent on training: 120.55115747451782
[foolsgold agg] training data poison_ratio: 0.0  data num: [1750, 1446, 813, 1131, 1154, 1662, 460, 605, 774, 631]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3141, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.5852, Accuracy: 0/9950 (0.0000%)
saving model
Done in 186.32076215744019 sec.
Server Epoch:26 choose agents : [80, 56, 73, 74, 45, 54, 42, 79, 7, 50].
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0704, Accuracy: 135/682 (19.7947%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0384, Accuracy: 239/682 (35.0440%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.4190, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 69/186 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0663, Accuracy: 163/938 (17.3774%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0330, Accuracy: 353/938 (37.6333%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.1091, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 465/1552 (29.9613%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 743/1552 (47.8737%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.5535, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   1, Avg loss: 0.0692, Accuracy: 192/669 (28.6996%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   2, Avg loss: 0.0401, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.7768, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 347/1130 (30.7080%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 463/1130 (40.9735%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.5127, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 349/1372 (25.4373%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 499/1372 (36.3703%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.0990, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1028, Accuracy: 20/197 (10.1523%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0901, Accuracy: 62/197 (31.4721%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3206, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 352/891 (39.5062%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 439/891 (49.2705%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.8850, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   1, Avg loss: 0.0634, Accuracy: 141/809 (17.4289%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 356/809 (44.0049%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.2194, Accuracy: 78/10000 (0.7800%)
time spent on training: 110.89294338226318
[foolsgold agg] training data poison_ratio: 0.0  data num: [682, 186, 938, 1552, 669, 1130, 1372, 197, 891, 809]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3141, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.5841, Accuracy: 0/9950 (0.0000%)
saving model
Done in 176.12698078155518 sec.
Server Epoch:27 choose agents : [17, 84, 50, 25, 13, 95, 98, 42, 15, 54].
poison local model 17 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 432/1574 (27.4460%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0238, Accuracy: 844/1574 (53.6213%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   3, Avg loss: 0.0205, Accuracy: 941/1574 (59.7840%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   4, Avg loss: 0.0196, Accuracy: 954/1574 (60.6099%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   5, Avg loss: 0.0190, Accuracy: 984/1574 (62.5159%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   6, Avg loss: 0.0189, Accuracy: 991/1574 (62.9606%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   7, Avg loss: 0.0182, Accuracy: 1003/1574 (63.7230%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   8, Avg loss: 0.0180, Accuracy: 1030/1574 (65.4384%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   9, Avg loss: 0.0174, Accuracy: 1018/1574 (64.6760%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch  10, Avg loss: 0.0176, Accuracy: 1008/1574 (64.0407%), train_poison_data_count: 500
Global model norm: 112.05487460113014.
Norm before scaling: 112.03125871687553. Distance: 1.240195975122194
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9633, Accuracy: 101/10000 (1.0100%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.1226, Accuracy: 9871/9950 (99.2060%)
Scaling by  100
Scaled Norm after poisoning: 165.08910946061826, distance: 124.01960451754191
Total norm for 1 adversaries is: 165.08910946061826. distance: 124.01960451754191
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   1, Avg loss: 0.0632, Accuracy: 318/1190 (26.7227%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 446/1190 (37.4790%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.9118, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 128/809 (15.8220%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 332/809 (41.0383%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.1237, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 304/690 (44.0580%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.3409, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 314/1645 (19.0881%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 633/1645 (38.4802%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8776, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0528, Accuracy: 330/599 (55.0918%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0274, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.4380, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0820, Accuracy: 17/373 (4.5576%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.4428, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 352/1372 (25.6560%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 525/1372 (38.2653%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8752, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0575, Accuracy: 320/1154 (27.7296%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 427/1154 (37.0017%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9477, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 340/1130 (30.0885%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 455/1130 (40.2655%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.6261, Accuracy: 49/10000 (0.4900%)
time spent on training: 227.80386638641357
[foolsgold agg] training data poison_ratio: 0.1493925588458618  data num: [1574, 1190, 809, 690, 1645, 599, 373, 1372, 1154, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.04668517463933181
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3140, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.5803, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.81497836112976 sec.
Server Epoch:28 choose agents : [20, 92, 67, 48, 91, 85, 76, 6, 83, 17].
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   1, Avg loss: 0.0577, Accuracy: 339/807 (42.0074%)
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 406/807 (50.3098%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.6164, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0513, Accuracy: 496/1715 (28.9213%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 707/1715 (41.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9733, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   1, Avg loss: 0.0794, Accuracy: 45/426 (10.5634%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   2, Avg loss: 0.0421, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.5773, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   1, Avg loss: 0.0712, Accuracy: 97/631 (15.3724%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   2, Avg loss: 0.0414, Accuracy: 216/631 (34.2314%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.7895, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0522, Accuracy: 335/1030 (32.5243%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0251, Accuracy: 626/1030 (60.7767%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.6657, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 429/1988 (21.5795%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 652/1988 (32.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.6778, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 41/466 (8.7983%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   2, Avg loss: 0.0485, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.6759, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 396/1956 (20.2454%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 644/1956 (32.9243%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.2647, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 395/1953 (20.2253%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 748/1953 (38.3001%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9676, Accuracy: 110/10000 (1.1000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 404/1574 (25.6671%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 654/1574 (41.5502%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.0667, Accuracy: 75/10000 (0.7500%)
time spent on training: 146.30195355415344
[foolsgold agg] training data poison_ratio: 0.12545831340666347  data num: [807, 1715, 426, 631, 1030, 1988, 466, 1956, 1953, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.039205722939582334
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3138, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.5801, Accuracy: 0/9950 (0.0000%)
saving model
Done in 210.35068345069885 sec.
Server Epoch:29 choose agents : [11, 58, 53, 87, 95, 62, 65, 60, 57, 69].
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0536, Accuracy: 338/712 (47.4719%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0269, Accuracy: 442/712 (62.0787%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.7661, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0559, Accuracy: 350/803 (43.5866%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 413/803 (51.4321%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.0154, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   1, Avg loss: 0.0501, Accuracy: 272/813 (33.4563%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 474/813 (58.3026%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.8997, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   1, Avg loss: 0.0577, Accuracy: 298/1131 (26.3484%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 433/1131 (38.2847%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.7215, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 331/599 (55.2588%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.5343, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 133/568 (23.4155%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   2, Avg loss: 0.0404, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.7194, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 377/1475 (25.5593%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 683/1475 (46.3051%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.9465, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 598/2227 (26.8523%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1030/2227 (46.2506%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.3098, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   1, Avg loss: 0.0543, Accuracy: 308/1154 (26.6898%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   2, Avg loss: 0.0272, Accuracy: 473/1154 (40.9879%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.8323, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   1, Avg loss: 0.0544, Accuracy: 288/590 (48.8136%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   2, Avg loss: 0.0324, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.0174, Accuracy: 50/10000 (0.5000%)
time spent on training: 123.88167524337769
[foolsgold agg] training data poison_ratio: 0.0  data num: [712, 803, 813, 1131, 599, 568, 1475, 2227, 1154, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3137, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.5776, Accuracy: 0/9950 (0.0000%)
saving model
Done in 189.19593930244446 sec.
Server Epoch:30 choose agents : [48, 91, 66, 43, 23, 0, 13, 89, 99, 69].
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   1, Avg loss: 0.0714, Accuracy: 96/631 (15.2139%)
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   2, Avg loss: 0.0416, Accuracy: 212/631 (33.5975%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.8449, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   1, Avg loss: 0.0534, Accuracy: 329/1030 (31.9417%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   2, Avg loss: 0.0255, Accuracy: 605/1030 (58.7379%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.9542, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0627, Accuracy: 259/1402 (18.4736%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 371/1402 (26.4622%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.1965, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   1, Avg loss: 0.0605, Accuracy: 307/946 (32.4524%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   2, Avg loss: 0.0368, Accuracy: 321/946 (33.9323%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.0384, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   1, Avg loss: 0.0596, Accuracy: 328/715 (45.8741%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   2, Avg loss: 0.0404, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.7590, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 370/1657 (22.3295%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 521/1657 (31.4424%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7620, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   1, Avg loss: 0.0576, Accuracy: 306/1645 (18.6018%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 608/1645 (36.9605%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8116, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 333/896 (37.1652%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 434/896 (48.4375%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.3468, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   1, Avg loss: 0.0656, Accuracy: 193/773 (24.9677%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   2, Avg loss: 0.0322, Accuracy: 378/773 (48.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.1212, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0562, Accuracy: 284/590 (48.1356%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.7753, Accuracy: 50/10000 (0.5000%)
time spent on training: 125.8220465183258
[foolsgold agg] training data poison_ratio: 0.0  data num: [631, 1030, 1402, 946, 715, 1657, 1645, 896, 773, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3136, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.5774, Accuracy: 0/9950 (0.0000%)
saving model
Done in 191.27711606025696 sec.
Server Epoch:31 choose agents : [29, 31, 94, 0, 60, 21, 98, 67, 96, 30].
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 441/1440 (30.6250%)
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 657/1440 (45.6250%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8500, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 52/460 (11.3043%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   2, Avg loss: 0.0382, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.7961, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 341/1662 (20.5174%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 611/1662 (36.7629%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8486, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0580, Accuracy: 378/1657 (22.8123%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 491/1657 (29.6319%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.6832, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 580/2227 (26.0440%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1032/2227 (46.3404%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.9578, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   1, Avg loss: 0.0531, Accuracy: 424/1949 (21.7547%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   2, Avg loss: 0.0326, Accuracy: 661/1949 (33.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.3627, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   1, Avg loss: 0.0816, Accuracy: 21/373 (5.6300%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   2, Avg loss: 0.0479, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.4491, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0785, Accuracy: 53/426 (12.4413%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0421, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.5631, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.0792, Accuracy: 43/311 (13.8264%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0542, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3477, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0812, Accuracy: 63/486 (12.9630%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0422, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.7431, Accuracy: 49/10000 (0.4900%)
time spent on training: 130.91451478004456
[foolsgold agg] training data poison_ratio: 0.0  data num: [1440, 460, 1662, 1657, 2227, 1949, 373, 426, 311, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3135, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.5762, Accuracy: 0/9950 (0.0000%)
saving model
Done in 197.36633396148682 sec.
Server Epoch:32 choose agents : [26, 45, 19, 17, 84, 8, 90, 80, 58, 48].
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0554, Accuracy: 328/1446 (22.6833%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 475/1446 (32.8492%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.1607, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   1, Avg loss: 0.0684, Accuracy: 198/669 (29.5964%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   2, Avg loss: 0.0404, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.8393, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 427/1036 (41.2162%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 648/1036 (62.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.0361, Accuracy: 55/10000 (0.5500%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 401/1574 (25.4765%)
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 702/1574 (44.5997%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.0705, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0630, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 458/1190 (38.4874%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.1218, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   1, Avg loss: 0.0601, Accuracy: 250/1513 (16.5235%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   2, Avg loss: 0.0375, Accuracy: 444/1513 (29.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.4284, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0563, Accuracy: 316/677 (46.6765%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 441/677 (65.1403%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.2748, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0705, Accuracy: 140/682 (20.5279%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 252/682 (36.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.2658, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   1, Avg loss: 0.0574, Accuracy: 351/803 (43.7111%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 397/803 (49.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.9733, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   1, Avg loss: 0.0710, Accuracy: 97/631 (15.3724%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   2, Avg loss: 0.0406, Accuracy: 220/631 (34.8653%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.8476, Accuracy: 50/10000 (0.5000%)
time spent on training: 139.93662476539612
[foolsgold agg] training data poison_ratio: 0.1539966735153116  data num: [1446, 669, 1036, 1574, 1190, 1513, 677, 682, 803, 631]
[foolsgold agg] considering poison per batch poison_fraction: 0.04812396047353487
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3134, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.5758, Accuracy: 0/9950 (0.0000%)
saving model
Done in 204.56474828720093 sec.
Server Epoch:33 choose agents : [12, 79, 69, 47, 77, 55, 36, 82, 45, 59].
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   1, Avg loss: 0.0871, Accuracy: 23/338 (6.8047%)
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   2, Avg loss: 0.0478, Accuracy: 142/338 (42.0118%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.4581, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1009, Accuracy: 15/197 (7.6142%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0870, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3229, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   1, Avg loss: 0.0548, Accuracy: 291/590 (49.3220%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   2, Avg loss: 0.0309, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.9647, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   1, Avg loss: 0.1246, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   2, Avg loss: 0.1128, Accuracy: 11/134 (8.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3106, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 328/1340 (24.4776%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 545/1340 (40.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.6306, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 254/1071 (23.7162%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 514/1071 (47.9925%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.9677, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   1, Avg loss: 0.0883, Accuracy: 75/408 (18.3824%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   2, Avg loss: 0.0551, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.4736, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 71/500 (14.2000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.6805, Accuracy: 39/10000 (0.3900%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   1, Avg loss: 0.0674, Accuracy: 198/669 (29.5964%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   2, Avg loss: 0.0416, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.7356, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0532, Accuracy: 290/1089 (26.6299%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 432/1089 (39.6694%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8991, Accuracy: 66/10000 (0.6600%)
time spent on training: 105.71649694442749
[foolsgold agg] training data poison_ratio: 0.0  data num: [338, 197, 590, 134, 1340, 1071, 408, 500, 669, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3134, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.5759, Accuracy: 0/9950 (0.0000%)
saving model
Done in 170.5030598640442 sec.
Server Epoch:34 choose agents : [54, 11, 49, 71, 13, 24, 48, 30, 76, 55].
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 348/1130 (30.7965%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 452/1130 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.7030, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   1, Avg loss: 0.0523, Accuracy: 350/712 (49.1573%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   2, Avg loss: 0.0277, Accuracy: 429/712 (60.2528%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.6768, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0804, Accuracy: 23/440 (5.2273%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.4900, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0646, Accuracy: 157/818 (19.1932%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 343/818 (41.9315%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3078, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0569, Accuracy: 328/1645 (19.9392%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0323, Accuracy: 653/1645 (39.6960%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.8309, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   1, Avg loss: 0.0769, Accuracy: 29/312 (9.2949%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   2, Avg loss: 0.0422, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3890, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0710, Accuracy: 90/631 (14.2631%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0413, Accuracy: 216/631 (34.2314%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.8611, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   1, Avg loss: 0.0791, Accuracy: 73/486 (15.0206%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   2, Avg loss: 0.0407, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.7748, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 44/466 (9.4421%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   2, Avg loss: 0.0470, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.6117, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 241/1071 (22.5023%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0294, Accuracy: 485/1071 (45.2848%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.7766, Accuracy: 77/10000 (0.7700%)
time spent on training: 114.40796065330505
[foolsgold agg] training data poison_ratio: 0.0  data num: [1130, 712, 440, 818, 1645, 312, 631, 486, 466, 1071]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         0.92690048 1.         1.         0.92690048
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3133, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.5764, Accuracy: 0/9950 (0.0000%)
saving model
Done in 179.90830087661743 sec.
Server Epoch:35 choose agents : [58, 11, 1, 66, 48, 71, 33, 12, 41, 6].
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 355/803 (44.2092%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 393/803 (48.9415%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.9408, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   1, Avg loss: 0.0541, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 421/712 (59.1292%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.5597, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 290/928 (31.2500%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 576/928 (62.0690%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.5610, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 266/1402 (18.9729%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 373/1402 (26.6049%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.2198, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   1, Avg loss: 0.0711, Accuracy: 95/631 (15.0555%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.8685, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 157/818 (19.1932%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 356/818 (43.5208%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.3030, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0786, Accuracy: 73/515 (14.1748%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0493, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.6864, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0875, Accuracy: 20/338 (5.9172%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0466, Accuracy: 149/338 (44.0828%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.4480, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   1, Avg loss: 0.0589, Accuracy: 329/719 (45.7580%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   2, Avg loss: 0.0324, Accuracy: 448/719 (62.3088%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.5056, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 389/1956 (19.8875%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 653/1956 (33.3845%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.1246, Accuracy: 97/10000 (0.9700%)
time spent on training: 122.6089243888855
[foolsgold agg] training data poison_ratio: 0.0  data num: [803, 712, 928, 1402, 631, 818, 515, 338, 719, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3132, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.5765, Accuracy: 0/9950 (0.0000%)
saving model
Done in 188.13072991371155 sec.
Server Epoch:36 choose agents : [11, 60, 43, 76, 42, 51, 33, 91, 70, 10].
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0553, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0279, Accuracy: 403/712 (56.6011%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.4943, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 599/2227 (26.8972%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1038/2227 (46.6098%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.1801, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 305/946 (32.2410%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 353/946 (37.3150%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.9782, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   1, Avg loss: 0.0859, Accuracy: 52/466 (11.1588%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   2, Avg loss: 0.0473, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.6316, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 362/1372 (26.3848%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 503/1372 (36.6618%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.7796, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 230/1049 (21.9256%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 548/1049 (52.2402%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.4693, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   1, Avg loss: 0.0778, Accuracy: 67/515 (13.0097%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   2, Avg loss: 0.0533, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.7113, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   1, Avg loss: 0.0513, Accuracy: 337/1030 (32.7184%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   2, Avg loss: 0.0267, Accuracy: 642/1030 (62.3301%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.3345, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 349/1418 (24.6121%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 681/1418 (48.0254%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.6897, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 210/861 (24.3902%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 437/861 (50.7549%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9482, Accuracy: 50/10000 (0.5000%)
time spent on training: 135.94043016433716
[foolsgold agg] training data poison_ratio: 0.0  data num: [712, 2227, 946, 466, 1372, 1049, 515, 1030, 1418, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 0. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3132, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.5757, Accuracy: 0/9950 (0.0000%)
saving model
Done in 201.73496055603027 sec.
Server Epoch:37 choose agents : [32, 58, 94, 51, 24, 77, 25, 46, 0, 83].
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   1, Avg loss: 0.0595, Accuracy: 197/735 (26.8027%)
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 349/735 (47.4830%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1429, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   1, Avg loss: 0.0574, Accuracy: 350/803 (43.5866%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 412/803 (51.3076%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.9663, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 338/1662 (20.3369%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 598/1662 (35.9807%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.7564, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 226/1049 (21.5443%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 502/1049 (47.8551%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.4534, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3831, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 331/1340 (24.7015%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 528/1340 (39.4030%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5396, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0575, Accuracy: 301/690 (43.6232%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.5501, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 416/1904 (21.8487%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 677/1904 (35.5567%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5197, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 366/1657 (22.0881%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 531/1657 (32.0459%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.6900, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 440/1953 (22.5294%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 760/1953 (38.9145%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.0934, Accuracy: 106/10000 (1.0600%)
time spent on training: 145.88859748840332
[foolsgold agg] training data poison_ratio: 0.0  data num: [735, 803, 1662, 1049, 312, 1340, 690, 1904, 1657, 1953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3131, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.5721, Accuracy: 0/9950 (0.0000%)
saving model
Done in 211.16182231903076 sec.
Server Epoch:38 choose agents : [77, 3, 38, 41, 58, 72, 33, 17, 87, 42].
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0545, Accuracy: 308/1340 (22.9851%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 538/1340 (40.1493%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.6114, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   1, Avg loss: 0.0746, Accuracy: 109/781 (13.9565%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   2, Avg loss: 0.0359, Accuracy: 253/781 (32.3944%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.6096, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0614, Accuracy: 250/1131 (22.1043%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 502/1131 (44.3855%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4307, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0581, Accuracy: 327/719 (45.4798%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0326, Accuracy: 463/719 (64.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.2985, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   1, Avg loss: 0.0585, Accuracy: 350/803 (43.5866%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 391/803 (48.6924%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.0184, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 248/1241 (19.9839%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 410/1241 (33.0379%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.1910, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   1, Avg loss: 0.0782, Accuracy: 71/515 (13.7864%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   2, Avg loss: 0.0494, Accuracy: 132/515 (25.6311%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.6913, Accuracy: 51/10000 (0.5100%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   1, Avg loss: 0.0511, Accuracy: 413/1574 (26.2389%)
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   2, Avg loss: 0.0271, Accuracy: 686/1574 (43.5832%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.9529, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   1, Avg loss: 0.0572, Accuracy: 295/1131 (26.0831%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   2, Avg loss: 0.0311, Accuracy: 430/1131 (38.0195%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7735, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0528, Accuracy: 358/1372 (26.0933%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 499/1372 (36.3703%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.9632, Accuracy: 69/10000 (0.6900%)
time spent on training: 149.14475393295288
[foolsgold agg] training data poison_ratio: 0.1483925709437164  data num: [1340, 781, 1131, 719, 803, 1241, 515, 1574, 1131, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.04637267841991138
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3129, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.5715, Accuracy: 0/9950 (0.0000%)
saving model
Done in 214.6390254497528 sec.
Server Epoch:39 choose agents : [7, 16, 26, 58, 43, 31, 91, 65, 70, 71].
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   1, Avg loss: 0.0540, Accuracy: 353/891 (39.6184%)
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 458/891 (51.4029%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.0646, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   1, Avg loss: 0.0591, Accuracy: 286/708 (40.3955%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   2, Avg loss: 0.0377, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.8022, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 323/1446 (22.3375%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 482/1446 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.3171, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0570, Accuracy: 364/803 (45.3300%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 392/803 (48.8169%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.0442, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 291/946 (30.7611%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 339/946 (35.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.9978, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   1, Avg loss: 0.0814, Accuracy: 65/460 (14.1304%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   2, Avg loss: 0.0360, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.7804, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   1, Avg loss: 0.0522, Accuracy: 331/1030 (32.1359%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   2, Avg loss: 0.0252, Accuracy: 622/1030 (60.3883%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2584, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 378/1475 (25.6271%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   2, Avg loss: 0.0314, Accuracy: 621/1475 (42.1017%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.8365, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 352/1418 (24.8237%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 632/1418 (44.5698%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.5524, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0647, Accuracy: 162/818 (19.8044%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 337/818 (41.1980%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.0474, Accuracy: 55/10000 (0.5500%)
time spent on training: 135.92972421646118
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 708, 1446, 803, 946, 460, 1030, 1475, 1418, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3128, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.5700, Accuracy: 0/9950 (0.0000%)
saving model
Done in 202.0071873664856 sec.
Server Epoch:40 choose agents : [91, 9, 78, 81, 54, 1, 63, 83, 43, 64].
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   1, Avg loss: 0.0516, Accuracy: 337/1030 (32.7184%)
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   2, Avg loss: 0.0260, Accuracy: 633/1030 (61.4563%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.3687, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   1, Avg loss: 0.0496, Accuracy: 356/1275 (27.9216%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 693/1275 (54.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.2786, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0838, Accuracy: 33/416 (7.9327%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0473, Accuracy: 177/416 (42.5481%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.5456, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   1, Avg loss: 0.0655, Accuracy: 245/774 (31.6537%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   2, Avg loss: 0.0358, Accuracy: 328/774 (42.3773%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.2318, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 344/1130 (30.4425%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 461/1130 (40.7965%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.5772, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 286/928 (30.8190%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   2, Avg loss: 0.0238, Accuracy: 556/928 (59.9138%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.6512, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0538, Accuracy: 267/888 (30.0676%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 446/888 (50.2252%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.0838, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0547, Accuracy: 387/1953 (19.8157%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 742/1953 (37.9928%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8266, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 303/946 (32.0296%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 320/946 (33.8266%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.9845, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0638, Accuracy: 172/953 (18.0483%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0377, Accuracy: 317/953 (33.2634%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.5092, Accuracy: 69/10000 (0.6900%)
time spent on training: 139.63726234436035
[foolsgold agg] training data poison_ratio: 0.0  data num: [1030, 1275, 416, 774, 1130, 928, 888, 1953, 946, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3127, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.5685, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 206.43121457099915 sec.
Server Epoch:41 choose agents : [84, 24, 89, 37, 74, 44, 20, 50, 15, 3].
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   1, Avg loss: 0.0621, Accuracy: 334/1190 (28.0672%)
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 456/1190 (38.3193%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.9760, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   1, Avg loss: 0.0763, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 163/312 (52.2436%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3917, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0598, Accuracy: 326/896 (36.3839%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0342, Accuracy: 445/896 (49.6652%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.3614, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   1, Avg loss: 0.0517, Accuracy: 447/1129 (39.5926%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   2, Avg loss: 0.0248, Accuracy: 747/1129 (66.1647%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.5036, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   1, Avg loss: 0.0437, Accuracy: 462/1552 (29.7680%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 782/1552 (50.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.2292, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 408/1750 (23.3143%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 702/1750 (40.1143%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.5227, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   1, Avg loss: 0.0571, Accuracy: 353/807 (43.7423%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   2, Avg loss: 0.0316, Accuracy: 419/807 (51.9207%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.7891, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   1, Avg loss: 0.0626, Accuracy: 164/809 (20.2719%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 333/809 (41.1619%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.0513, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 339/1154 (29.3761%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   2, Avg loss: 0.0292, Accuracy: 386/1154 (33.4489%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.7556, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   1, Avg loss: 0.0751, Accuracy: 117/781 (14.9808%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 230/781 (29.4494%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.7348, Accuracy: 73/10000 (0.7300%)
time spent on training: 150.65703892707825
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 312, 896, 1129, 1552, 1750, 807, 809, 1154, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3126, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.5687, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 218.23204445838928 sec.
Server Epoch:42 choose agents : [42, 66, 59, 31, 44, 93, 14, 37, 33, 29].
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 365/1372 (26.6035%)
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 505/1372 (36.8076%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.7742, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 278/1402 (19.8288%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 370/1402 (26.3909%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.1979, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   1, Avg loss: 0.0597, Accuracy: 304/1089 (27.9155%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   2, Avg loss: 0.0276, Accuracy: 454/1089 (41.6896%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.7240, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0817, Accuracy: 65/460 (14.1304%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.7614, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   1, Avg loss: 0.0602, Accuracy: 394/1750 (22.5143%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 643/1750 (36.7429%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6490, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 420/1742 (24.1102%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 694/1742 (39.8393%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6139, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   2, Avg loss: 0.0351, Accuracy: 354/1013 (34.9457%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.6795, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 403/1129 (35.6953%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   2, Avg loss: 0.0248, Accuracy: 724/1129 (64.1275%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.1488, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   1, Avg loss: 0.0796, Accuracy: 68/515 (13.2039%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   2, Avg loss: 0.0539, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.7535, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   1, Avg loss: 0.0488, Accuracy: 416/1440 (28.8889%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   2, Avg loss: 0.0273, Accuracy: 710/1440 (49.3056%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.7504, Accuracy: 66/10000 (0.6600%)
time spent on training: 161.77522563934326
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 1402, 1089, 460, 1750, 1742, 1013, 1129, 515, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3125, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.5686, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 229.4083766937256 sec.
Server Epoch:43 choose agents : [89, 77, 29, 75, 94, 3, 90, 39, 30, 20].
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 336/896 (37.5000%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0330, Accuracy: 469/896 (52.3438%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.2359, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 329/1340 (24.5522%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 560/1340 (41.7910%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.6737, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   1, Avg loss: 0.0496, Accuracy: 416/1440 (28.8889%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 676/1440 (46.9444%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.8647, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   1, Avg loss: 0.0625, Accuracy: 256/776 (32.9897%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 398/776 (51.2887%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.9353, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   1, Avg loss: 0.0546, Accuracy: 363/1662 (21.8412%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 637/1662 (38.3273%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.6806, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   1, Avg loss: 0.0749, Accuracy: 108/781 (13.8284%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 239/781 (30.6018%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.6058, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0575, Accuracy: 317/677 (46.8242%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 440/677 (64.9926%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.1245, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 321/1013 (31.6881%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 507/1013 (50.0494%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.6956, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0800, Accuracy: 77/486 (15.8436%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0416, Accuracy: 208/486 (42.7984%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.7631, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 346/807 (42.8748%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   2, Avg loss: 0.0326, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.6638, Accuracy: 50/10000 (0.5000%)
time spent on training: 149.7527084350586
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 1340, 1440, 776, 1662, 781, 677, 1013, 486, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3124, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.5683, Accuracy: 0/9950 (0.0000%)
saving model
Done in 217.848069190979 sec.
Server Epoch:44 choose agents : [98, 51, 93, 3, 14, 31, 63, 57, 35, 56].
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   1, Avg loss: 0.0812, Accuracy: 17/373 (4.5576%)
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   2, Avg loss: 0.0479, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.4479, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   1, Avg loss: 0.0599, Accuracy: 231/1049 (22.0210%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 522/1049 (49.7617%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.2587, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   1, Avg loss: 0.0542, Accuracy: 421/1742 (24.1676%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   2, Avg loss: 0.0313, Accuracy: 740/1742 (42.4799%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.8351, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   1, Avg loss: 0.0740, Accuracy: 119/781 (15.2369%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 242/781 (30.9859%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.8025, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   1, Avg loss: 0.0618, Accuracy: 234/1013 (23.0997%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 331/1013 (32.6752%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.9081, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0807, Accuracy: 60/460 (13.0435%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.8332, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   1, Avg loss: 0.0537, Accuracy: 266/888 (29.9550%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 438/888 (49.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.2886, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0548, Accuracy: 292/1154 (25.3033%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0255, Accuracy: 508/1154 (44.0208%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.3484, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0848, Accuracy: 42/271 (15.4982%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0545, Accuracy: 99/271 (36.5314%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3608, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 61/186 (32.7957%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3115, Accuracy: 50/10000 (0.5000%)
time spent on training: 138.01069283485413
[foolsgold agg] training data poison_ratio: 0.0  data num: [373, 1049, 1742, 781, 1013, 460, 888, 1154, 271, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3124, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.5689, Accuracy: 0/9950 (0.0000%)
saving model
Done in 206.7698531150818 sec.
Server Epoch:45 choose agents : [28, 80, 26, 1, 93, 55, 13, 98, 61, 75].
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 390/1581 (24.6679%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 592/1581 (37.4447%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.5635, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   1, Avg loss: 0.0704, Accuracy: 135/682 (19.7947%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   2, Avg loss: 0.0381, Accuracy: 249/682 (36.5103%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.2942, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 338/1446 (23.3748%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 520/1446 (35.9613%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.3462, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   1, Avg loss: 0.0563, Accuracy: 286/928 (30.8190%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 531/928 (57.2198%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.5321, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0550, Accuracy: 395/1742 (22.6751%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 723/1742 (41.5040%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.6432, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Avg loss: 0.0561, Accuracy: 269/1071 (25.1167%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 522/1071 (48.7395%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.8770, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   1, Avg loss: 0.0574, Accuracy: 315/1645 (19.1489%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 619/1645 (37.6292%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.8899, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   1, Avg loss: 0.0814, Accuracy: 20/373 (5.3619%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   2, Avg loss: 0.0475, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.4545, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1194, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3044, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   1, Avg loss: 0.0638, Accuracy: 250/776 (32.2165%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   2, Avg loss: 0.0308, Accuracy: 400/776 (51.5464%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.0032, Accuracy: 50/10000 (0.5000%)
time spent on training: 153.61927342414856
[foolsgold agg] training data poison_ratio: 0.0  data num: [1581, 682, 1446, 928, 1742, 1071, 1645, 373, 85, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3123, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.5683, Accuracy: 0/9950 (0.0000%)
saving model
Done in 221.58224058151245 sec.
Server Epoch:46 choose agents : [96, 53, 15, 74, 95, 89, 38, 49, 11, 16].
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 46/311 (14.7910%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0543, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3502, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   1, Avg loss: 0.0495, Accuracy: 273/813 (33.5793%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 425/813 (52.2755%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.4553, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0576, Accuracy: 316/1154 (27.3830%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0290, Accuracy: 441/1154 (38.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8391, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 524/1552 (33.7629%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 795/1552 (51.2242%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.8723, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0540, Accuracy: 328/599 (54.7579%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0286, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.4970, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0615, Accuracy: 329/896 (36.7188%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 437/896 (48.7723%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.2244, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   1, Avg loss: 0.0613, Accuracy: 254/1131 (22.4580%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 482/1131 (42.6172%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.4137, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   1, Avg loss: 0.0801, Accuracy: 29/440 (6.5909%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   2, Avg loss: 0.0473, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.5074, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   1, Avg loss: 0.0564, Accuracy: 345/712 (48.4551%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 417/712 (58.5674%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.4316, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0602, Accuracy: 279/708 (39.4068%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0371, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8754, Accuracy: 56/10000 (0.5600%)
time spent on training: 137.4982328414917
[foolsgold agg] training data poison_ratio: 0.0  data num: [311, 813, 1154, 1552, 599, 896, 1131, 440, 712, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         1.         0.80489912 0.80489912]
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3122, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.5682, Accuracy: 0/9950 (0.0000%)
saving model
Done in 205.6695053577423 sec.
Server Epoch:47 choose agents : [65, 76, 17, 71, 31, 74, 25, 82, 54, 12].
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   1, Avg loss: 0.0550, Accuracy: 387/1475 (26.2373%)
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   2, Avg loss: 0.0316, Accuracy: 691/1475 (46.8475%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.1068, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0851, Accuracy: 53/466 (11.3734%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0487, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.6293, Accuracy: 50/10000 (0.5000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 393/1574 (24.9682%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 666/1574 (42.3126%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.2546, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   1, Avg loss: 0.0642, Accuracy: 145/818 (17.7262%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   2, Avg loss: 0.0313, Accuracy: 297/818 (36.3081%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.1403, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   1, Avg loss: 0.0810, Accuracy: 60/460 (13.0435%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.8031, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 468/1552 (30.1546%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 771/1552 (49.6778%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 11.0592, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   1, Avg loss: 0.0560, Accuracy: 306/690 (44.3478%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.4145, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 65/500 (13.0000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.6784, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   1, Avg loss: 0.0549, Accuracy: 351/1130 (31.0619%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 460/1130 (40.7080%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.0459, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0471, Accuracy: 141/338 (41.7160%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.4551, Accuracy: 50/10000 (0.5000%)
time spent on training: 154.13714480400085
[foolsgold agg] training data poison_ratio: 0.17483061201821615  data num: [1475, 466, 1574, 818, 460, 1552, 690, 500, 1130, 338]
[foolsgold agg] considering poison per batch poison_fraction: 0.054634566255692546
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3121, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.5669, Accuracy: 0/9950 (0.0000%)
saving model
Done in 221.37393879890442 sec.
Server Epoch:48 choose agents : [41, 89, 82, 3, 10, 19, 72, 60, 95, 38].
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   1, Avg loss: 0.0586, Accuracy: 336/719 (46.7316%)
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   2, Avg loss: 0.0326, Accuracy: 452/719 (62.8651%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.4022, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   1, Avg loss: 0.0612, Accuracy: 336/896 (37.5000%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.2678, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 76/500 (15.2000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.6732, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   1, Avg loss: 0.0743, Accuracy: 107/781 (13.7004%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   2, Avg loss: 0.0350, Accuracy: 253/781 (32.3944%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.4959, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   1, Avg loss: 0.0566, Accuracy: 220/861 (25.5517%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 456/861 (52.9617%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.9742, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0479, Accuracy: 393/1036 (37.9344%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0248, Accuracy: 648/1036 (62.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.9294, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 249/1241 (20.0645%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 379/1241 (30.5399%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.3131, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 586/2227 (26.3134%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1024/2227 (45.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.2135, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0540, Accuracy: 340/599 (56.7613%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.5673, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0620, Accuracy: 250/1131 (22.1043%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0308, Accuracy: 483/1131 (42.7056%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.3989, Accuracy: 73/10000 (0.7300%)
time spent on training: 151.33318829536438
[foolsgold agg] training data poison_ratio: 0.0  data num: [719, 896, 500, 781, 861, 1036, 1241, 2227, 599, 1131]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3121, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.5655, Accuracy: 0/9950 (0.0000%)
saving model
Done in 219.3431601524353 sec.
Server Epoch:49 choose agents : [17, 1, 30, 40, 83, 97, 18, 68, 10, 21].
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0508, Accuracy: 412/1574 (26.1753%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 686/1574 (43.5832%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1660, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   1, Avg loss: 0.0560, Accuracy: 294/928 (31.6810%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   2, Avg loss: 0.0238, Accuracy: 566/928 (60.9914%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.4697, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   1, Avg loss: 0.0799, Accuracy: 73/486 (15.0206%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   2, Avg loss: 0.0405, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8908, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 369/1573 (23.4584%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 574/1573 (36.4908%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.4430, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 428/1953 (21.9150%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 729/1953 (37.3272%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.7258, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 362/1213 (29.8434%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 482/1213 (39.7362%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.9226, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0771, Accuracy: 117/530 (22.0755%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0393, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.0042, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   1, Avg loss: 0.0626, Accuracy: 359/1163 (30.8684%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   2, Avg loss: 0.0364, Accuracy: 446/1163 (38.3491%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.7864, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   1, Avg loss: 0.0568, Accuracy: 208/861 (24.1580%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 467/861 (54.2393%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.7769, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0532, Accuracy: 415/1949 (21.2930%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 640/1949 (32.8374%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.0897, Accuracy: 87/10000 (0.8700%)
time spent on training: 182.9703826904297
[foolsgold agg] training data poison_ratio: 0.12869991823385118  data num: [1574, 928, 486, 1573, 1953, 1213, 530, 1163, 861, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.040218724448078495
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3120, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.5656, Accuracy: 0/9950 (0.0000%)
saving model
Done in 250.05196046829224 sec.
Server Epoch:50 choose agents : [39, 48, 81, 51, 63, 5, 60, 7, 70, 41].
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   1, Avg loss: 0.0539, Accuracy: 311/1013 (30.7009%)
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 496/1013 (48.9635%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.0139, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 104/631 (16.4818%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0410, Accuracy: 223/631 (35.3407%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.8534, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0688, Accuracy: 246/774 (31.7829%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0342, Accuracy: 306/774 (39.5349%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.2889, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   1, Avg loss: 0.0593, Accuracy: 228/1049 (21.7350%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   2, Avg loss: 0.0296, Accuracy: 526/1049 (50.1430%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.4517, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   1, Avg loss: 0.0542, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 400/888 (45.0450%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.3427, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   1, Avg loss: 0.0505, Accuracy: 394/1628 (24.2015%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 768/1628 (47.1744%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.5061, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 557/2227 (25.0112%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1030/2227 (46.2506%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.2706, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 359/891 (40.2918%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 457/891 (51.2907%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.9089, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 341/1418 (24.0480%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 667/1418 (47.0381%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.9844, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   1, Avg loss: 0.0605, Accuracy: 333/719 (46.3143%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   2, Avg loss: 0.0300, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.2081, Accuracy: 56/10000 (0.5600%)
time spent on training: 165.50454878807068
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 631, 774, 1049, 888, 1628, 2227, 891, 1418, 719]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3119, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.5646, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 233.09077739715576 sec.
Server Epoch:51 choose agents : [4, 56, 21, 33, 59, 41, 11, 71, 6, 92].
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   1, Avg loss: 0.0604, Accuracy: 325/901 (36.0710%)
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   2, Avg loss: 0.0360, Accuracy: 359/901 (39.8446%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.0864, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 69/186 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3110, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   1, Avg loss: 0.0532, Accuracy: 431/1949 (22.1139%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   2, Avg loss: 0.0325, Accuracy: 647/1949 (33.1965%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.1493, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0812, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0506, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.6943, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0581, Accuracy: 294/1089 (26.9972%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 383/1089 (35.1699%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.5371, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   1, Avg loss: 0.0573, Accuracy: 335/719 (46.5925%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   2, Avg loss: 0.0321, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.4887, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   1, Avg loss: 0.0545, Accuracy: 350/712 (49.1573%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   2, Avg loss: 0.0257, Accuracy: 430/712 (60.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.5545, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0639, Accuracy: 172/818 (21.0269%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 363/818 (44.3765%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.1303, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 402/1956 (20.5521%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 632/1956 (32.3108%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.1755, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 447/1715 (26.0641%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 687/1715 (40.0583%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.0407, Accuracy: 88/10000 (0.8800%)
time spent on training: 161.5852313041687
[foolsgold agg] training data poison_ratio: 0.0  data num: [901, 186, 1949, 515, 1089, 719, 712, 818, 1956, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3117, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.5643, Accuracy: 0/9950 (0.0000%)
saving model
Done in 229.31275510787964 sec.
Server Epoch:52 choose agents : [89, 33, 83, 60, 57, 18, 41, 0, 31, 30].
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0612, Accuracy: 330/896 (36.8304%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 439/896 (48.9955%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.5044, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   1, Avg loss: 0.0776, Accuracy: 70/515 (13.5922%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   2, Avg loss: 0.0516, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.7962, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 426/1953 (21.8126%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 754/1953 (38.6073%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.6875, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 600/2227 (26.9421%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1048/2227 (47.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.2306, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   1, Avg loss: 0.0544, Accuracy: 308/1154 (26.6898%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   2, Avg loss: 0.0246, Accuracy: 544/1154 (47.1404%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.4392, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0761, Accuracy: 125/530 (23.5849%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0367, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.0337, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   1, Avg loss: 0.0608, Accuracy: 328/719 (45.6189%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   2, Avg loss: 0.0315, Accuracy: 456/719 (63.4214%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.3870, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   1, Avg loss: 0.0587, Accuracy: 329/1657 (19.8552%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 521/1657 (31.4424%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.6632, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0806, Accuracy: 66/460 (14.3478%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0359, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.8129, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   1, Avg loss: 0.0789, Accuracy: 72/486 (14.8148%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   2, Avg loss: 0.0398, Accuracy: 214/486 (44.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.7281, Accuracy: 54/10000 (0.5400%)
time spent on training: 164.21039724349976
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 515, 1953, 2227, 1154, 530, 719, 1657, 460, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3116, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.5628, Accuracy: 0/9950 (0.0000%)
saving model
Done in 232.18020367622375 sec.
Server Epoch:53 choose agents : [43, 26, 61, 17, 27, 48, 39, 7, 15, 21].
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   1, Avg loss: 0.0613, Accuracy: 309/946 (32.6638%)
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 333/946 (35.2008%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.1261, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   1, Avg loss: 0.0545, Accuracy: 342/1446 (23.6515%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 518/1446 (35.8230%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3028, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   1, Avg loss: 0.1240, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   2, Avg loss: 0.1163, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3037, Accuracy: 50/10000 (0.5000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 419/1574 (26.6201%)
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 653/1574 (41.4867%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3198, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0540, Accuracy: 435/1587 (27.4102%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0342, Accuracy: 583/1587 (36.7360%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3344, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   1, Avg loss: 0.0706, Accuracy: 98/631 (15.5309%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   2, Avg loss: 0.0402, Accuracy: 217/631 (34.3899%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.8617, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 316/1013 (31.1945%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 518/1013 (51.1352%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.4544, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   1, Avg loss: 0.0535, Accuracy: 356/891 (39.9551%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   2, Avg loss: 0.0250, Accuracy: 479/891 (53.7598%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.0072, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   1, Avg loss: 0.0563, Accuracy: 333/1154 (28.8562%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   2, Avg loss: 0.0292, Accuracy: 420/1154 (36.3951%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.2233, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 388/1949 (19.9076%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 645/1949 (33.0939%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.4236, Accuracy: 84/10000 (0.8400%)
time spent on training: 182.06873440742493
[foolsgold agg] training data poison_ratio: 0.13958850656261085  data num: [946, 1446, 85, 1574, 1587, 631, 1013, 891, 1154, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.043621408300815886
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3116, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.5629, Accuracy: 0/9950 (0.0000%)
saving model
Done in 249.76183152198792 sec.
Server Epoch:54 choose agents : [37, 68, 15, 88, 46, 83, 7, 6, 92, 53].
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   1, Avg loss: 0.0513, Accuracy: 437/1129 (38.7068%)
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   2, Avg loss: 0.0247, Accuracy: 741/1129 (65.6333%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.3580, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   1, Avg loss: 0.0625, Accuracy: 369/1163 (31.7283%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   2, Avg loss: 0.0376, Accuracy: 401/1163 (34.4798%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.6274, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   1, Avg loss: 0.0583, Accuracy: 327/1154 (28.3362%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   2, Avg loss: 0.0297, Accuracy: 438/1154 (37.9549%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.9767, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   1, Avg loss: 0.0749, Accuracy: 146/603 (24.2123%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.0165, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0544, Accuracy: 406/1904 (21.3235%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 714/1904 (37.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8228, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 442/1953 (22.6318%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   2, Avg loss: 0.0332, Accuracy: 806/1953 (41.2698%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1115, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 352/891 (39.5062%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 467/891 (52.4130%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.9900, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 411/1956 (21.0123%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 647/1956 (33.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.2537, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 463/1715 (26.9971%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 716/1715 (41.7493%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.6577, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   1, Avg loss: 0.0488, Accuracy: 298/813 (36.6544%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 445/813 (54.7355%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.6715, Accuracy: 52/10000 (0.5200%)
time spent on training: 191.4084596633911
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 1163, 1154, 603, 1904, 1953, 891, 1956, 1715, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3114, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.5634, Accuracy: 0/9950 (0.0000%)
saving model
Done in 258.21626687049866 sec.
Server Epoch:55 choose agents : [87, 76, 15, 54, 78, 12, 60, 11, 26, 97].
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   1, Avg loss: 0.0571, Accuracy: 297/1131 (26.2599%)
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 420/1131 (37.1353%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7278, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 48/466 (10.3004%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   2, Avg loss: 0.0499, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.7654, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   1, Avg loss: 0.0567, Accuracy: 330/1154 (28.5962%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   2, Avg loss: 0.0292, Accuracy: 414/1154 (35.8752%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.8272, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 348/1130 (30.7965%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0284, Accuracy: 510/1130 (45.1327%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.8595, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 38/416 (9.1346%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0463, Accuracy: 182/416 (43.7500%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.5644, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0869, Accuracy: 27/338 (7.9882%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0468, Accuracy: 152/338 (44.9704%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.4641, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 593/2227 (26.6278%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1029/2227 (46.2057%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.0781, Accuracy: 133/10000 (1.3300%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   1, Avg loss: 0.0532, Accuracy: 356/712 (50.0000%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 454/712 (63.7640%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.6880, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 344/1446 (23.7898%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 522/1446 (36.0996%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.4324, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 357/1213 (29.4312%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 509/1213 (41.9621%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7288, Accuracy: 95/10000 (0.9500%)
time spent on training: 166.59353184700012
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 466, 1154, 1130, 416, 338, 2227, 712, 1446, 1213]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3114, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.5628, Accuracy: 0/9950 (0.0000%)
saving model
Done in 234.009996175766 sec.
Server Epoch:56 choose agents : [40, 83, 46, 17, 88, 71, 44, 31, 25, 6].
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   1, Avg loss: 0.0552, Accuracy: 347/1573 (22.0598%)
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 573/1573 (36.4272%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.5806, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 414/1953 (21.1982%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 747/1953 (38.2488%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.6749, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   1, Avg loss: 0.0547, Accuracy: 429/1904 (22.5315%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 634/1904 (33.2983%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1825, Accuracy: 90/10000 (0.9000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 429/1574 (27.2554%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 699/1574 (44.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1465, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 140/603 (23.2172%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   2, Avg loss: 0.0464, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.8979, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   1, Avg loss: 0.0637, Accuracy: 173/818 (21.1491%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 377/818 (46.0880%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4327, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   1, Avg loss: 0.0584, Accuracy: 392/1750 (22.4000%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 629/1750 (35.9429%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.8540, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   1, Avg loss: 0.0807, Accuracy: 65/460 (14.1304%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   2, Avg loss: 0.0369, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.7487, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0560, Accuracy: 314/690 (45.5072%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.4098, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 379/1956 (19.3763%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 654/1956 (33.4356%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1502, Accuracy: 114/10000 (1.1400%)
time spent on training: 205.88286685943604
[foolsgold agg] training data poison_ratio: 0.11851517205029742  data num: [1573, 1953, 1904, 1574, 603, 818, 1750, 460, 690, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.037035991265717945
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3113, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.5629, Accuracy: 0/9950 (0.0000%)
saving model
Done in 272.82346391677856 sec.
Server Epoch:57 choose agents : [39, 55, 3, 31, 73, 74, 69, 87, 8, 34].
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   1, Avg loss: 0.0533, Accuracy: 318/1013 (31.3919%)
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 513/1013 (50.6417%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.4011, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0555, Accuracy: 261/1071 (24.3697%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 524/1071 (48.9262%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.9032, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   1, Avg loss: 0.0746, Accuracy: 108/781 (13.8284%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   2, Avg loss: 0.0367, Accuracy: 228/781 (29.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.6460, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   1, Avg loss: 0.0799, Accuracy: 66/460 (14.3478%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   2, Avg loss: 0.0379, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.7602, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   1, Avg loss: 0.0654, Accuracy: 169/938 (18.0171%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 322/938 (34.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2634, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 521/1552 (33.5696%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 770/1552 (49.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.1571, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   1, Avg loss: 0.0573, Accuracy: 289/590 (48.9831%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   2, Avg loss: 0.0298, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.5733, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   1, Avg loss: 0.0573, Accuracy: 298/1131 (26.3484%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 415/1131 (36.6932%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.5572, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 250/1513 (16.5235%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 481/1513 (31.7911%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.4589, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0581, Accuracy: 384/1427 (26.9096%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 554/1427 (38.8227%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.9540, Accuracy: 53/10000 (0.5300%)
time spent on training: 170.5680491924286
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 1071, 781, 460, 938, 1552, 590, 1131, 1513, 1427]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3112, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.5614, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.36650586128235 sec.
Server Epoch:58 choose agents : [33, 30, 88, 34, 73, 19, 26, 23, 32, 22].
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0776, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0563, Accuracy: 125/515 (24.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.6871, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   1, Avg loss: 0.0796, Accuracy: 80/486 (16.4609%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   2, Avg loss: 0.0399, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8887, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0744, Accuracy: 141/603 (23.3831%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0465, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.9397, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0581, Accuracy: 387/1427 (27.1198%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 603/1427 (42.2565%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.8998, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   1, Avg loss: 0.0650, Accuracy: 176/938 (18.7633%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   2, Avg loss: 0.0333, Accuracy: 338/938 (36.0341%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.3559, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 392/1036 (37.8378%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0234, Accuracy: 689/1036 (66.5058%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.2428, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 336/1446 (23.2365%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 523/1446 (36.1687%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.2032, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0596, Accuracy: 327/715 (45.7343%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0397, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.7773, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   1, Avg loss: 0.0594, Accuracy: 202/735 (27.4830%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 353/735 (48.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.1376, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 538/1470 (36.5986%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   2, Avg loss: 0.0244, Accuracy: 835/1470 (56.8027%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.2548, Accuracy: 87/10000 (0.8700%)
time spent on training: 163.8657727241516
[foolsgold agg] training data poison_ratio: 0.0  data num: [515, 486, 603, 1427, 938, 1036, 1446, 715, 735, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3111, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.5570, Accuracy: 0/9950 (0.0000%)
saving model
Done in 231.62070059776306 sec.
Server Epoch:59 choose agents : [68, 82, 5, 39, 20, 22, 96, 74, 52, 98].
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   1, Avg loss: 0.0632, Accuracy: 367/1163 (31.5563%)
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 428/1163 (36.8014%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.6565, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 73/500 (14.6000%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.6907, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   1, Avg loss: 0.0510, Accuracy: 395/1628 (24.2629%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 812/1628 (49.8771%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.9707, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 322/1013 (31.7868%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 505/1013 (49.8519%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.8368, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 336/807 (41.6357%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 414/807 (51.3011%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.8983, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 533/1470 (36.2585%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 828/1470 (56.3265%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.2552, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 54/311 (17.3633%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   2, Avg loss: 0.0542, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3527, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 484/1552 (31.1856%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 774/1552 (49.8711%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.4634, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0567, Accuracy: 281/636 (44.1824%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.2913, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   1, Avg loss: 0.0805, Accuracy: 27/373 (7.2386%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   2, Avg loss: 0.0477, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.4486, Accuracy: 50/10000 (0.5000%)
time spent on training: 163.45066285133362
[foolsgold agg] training data poison_ratio: 0.0  data num: [1163, 500, 1628, 1013, 807, 1470, 311, 1552, 636, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3110, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.5571, Accuracy: 0/9950 (0.0000%)
saving model
Done in 231.66616988182068 sec.
Server Epoch:60 choose agents : [50, 97, 52, 73, 41, 60, 11, 53, 69, 10].
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0628, Accuracy: 158/809 (19.5303%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0267, Accuracy: 376/809 (46.4771%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.1824, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0523, Accuracy: 358/1213 (29.5136%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 515/1213 (42.4567%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.6458, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0555, Accuracy: 289/636 (45.4403%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.7519, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0650, Accuracy: 169/938 (18.0171%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 333/938 (35.5011%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.5218, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   1, Avg loss: 0.0595, Accuracy: 340/719 (47.2879%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   2, Avg loss: 0.0318, Accuracy: 453/719 (63.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.4711, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 573/2227 (25.7297%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1050/2227 (47.1486%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.5066, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0550, Accuracy: 351/712 (49.2978%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0255, Accuracy: 423/712 (59.4101%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.5600, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0491, Accuracy: 312/813 (38.3764%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 473/813 (58.1796%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.5357, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   1, Avg loss: 0.0560, Accuracy: 294/590 (49.8305%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   2, Avg loss: 0.0302, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.9966, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0568, Accuracy: 215/861 (24.9710%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0213, Accuracy: 457/861 (53.0778%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.8923, Accuracy: 51/10000 (0.5100%)
time spent on training: 167.56109738349915
[foolsgold agg] training data poison_ratio: 0.0  data num: [809, 1213, 636, 938, 719, 2227, 712, 813, 590, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3110, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.5550, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 233.9655213356018 sec.
Server Epoch:61 choose agents : [83, 17, 50, 24, 37, 5, 54, 52, 11, 68].
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   1, Avg loss: 0.0537, Accuracy: 447/1953 (22.8879%)
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 780/1953 (39.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2737, Accuracy: 80/10000 (0.8000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 406/1574 (25.7942%)
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   2, Avg loss: 0.0271, Accuracy: 707/1574 (44.9174%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.0680, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0630, Accuracy: 143/809 (17.6761%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 353/809 (43.6341%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.4468, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 161/312 (51.6026%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3917, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   1, Avg loss: 0.0519, Accuracy: 391/1129 (34.6324%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 734/1129 (65.0133%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.4271, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   1, Avg loss: 0.0508, Accuracy: 408/1628 (25.0614%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   2, Avg loss: 0.0259, Accuracy: 805/1628 (49.4472%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2222, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0542, Accuracy: 356/1130 (31.5044%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0282, Accuracy: 509/1130 (45.0442%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.8617, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   1, Avg loss: 0.0556, Accuracy: 281/636 (44.1824%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.2818, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   1, Avg loss: 0.0563, Accuracy: 352/712 (49.4382%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   2, Avg loss: 0.0269, Accuracy: 406/712 (57.0225%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.3925, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   1, Avg loss: 0.0630, Accuracy: 368/1163 (31.6423%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 404/1163 (34.7377%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.6135, Accuracy: 73/10000 (0.7300%)
time spent on training: 192.96277618408203
[foolsgold agg] training data poison_ratio: 0.142495020822017  data num: [1953, 1574, 809, 312, 1129, 1628, 1130, 636, 712, 1163]
[foolsgold agg] considering poison per batch poison_fraction: 0.04452969400688032
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3110, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.5553, Accuracy: 0/9950 (0.0000%)
saving model
Done in 261.03401947021484 sec.
Server Epoch:62 choose agents : [82, 77, 23, 80, 3, 29, 92, 32, 68, 59].
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0760, Accuracy: 72/500 (14.4000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0482, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.7228, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 322/1340 (24.0299%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 553/1340 (41.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9814, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   1, Avg loss: 0.0600, Accuracy: 322/715 (45.0350%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   2, Avg loss: 0.0406, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.7380, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 150/682 (21.9941%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 245/682 (35.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.4211, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   1, Avg loss: 0.0733, Accuracy: 117/781 (14.9808%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   2, Avg loss: 0.0364, Accuracy: 236/781 (30.2177%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.5310, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 426/1440 (29.5833%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0283, Accuracy: 669/1440 (46.4583%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9089, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 459/1715 (26.7638%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 726/1715 (42.3324%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.8984, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 197/735 (26.8027%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 337/735 (45.8503%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9939, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   1, Avg loss: 0.0626, Accuracy: 368/1163 (31.6423%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 436/1163 (37.4893%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.9183, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 313/1089 (28.7420%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 489/1089 (44.9036%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.4867, Accuracy: 78/10000 (0.7800%)
time spent on training: 102.0952627658844
[foolsgold agg] training data poison_ratio: 0.0  data num: [500, 1340, 715, 682, 781, 1440, 1715, 735, 1163, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3109, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.5530, Accuracy: 0/9950 (0.0000%)
saving model
Done in 170.73630619049072 sec.
Server Epoch:63 choose agents : [18, 63, 37, 93, 54, 89, 57, 58, 65, 75].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0756, Accuracy: 118/530 (22.2642%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0403, Accuracy: 274/530 (51.6981%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.0962, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 259/888 (29.1667%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 423/888 (47.6351%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.3915, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0516, Accuracy: 429/1129 (37.9982%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0247, Accuracy: 722/1129 (63.9504%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.9255, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   1, Avg loss: 0.0544, Accuracy: 427/1742 (24.5121%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   2, Avg loss: 0.0322, Accuracy: 680/1742 (39.0356%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.8138, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   1, Avg loss: 0.0545, Accuracy: 351/1130 (31.0619%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 467/1130 (41.3274%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.6163, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 338/896 (37.7232%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 427/896 (47.6562%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.2409, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0535, Accuracy: 302/1154 (26.1698%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0261, Accuracy: 500/1154 (43.3276%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.0690, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 349/803 (43.4620%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 402/803 (50.0623%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.9841, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   1, Avg loss: 0.0563, Accuracy: 398/1475 (26.9831%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   2, Avg loss: 0.0317, Accuracy: 635/1475 (43.0508%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.1653, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   1, Avg loss: 0.0620, Accuracy: 258/776 (33.2474%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   2, Avg loss: 0.0308, Accuracy: 410/776 (52.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.8414, Accuracy: 53/10000 (0.5300%)
time spent on training: 95.14012241363525
[foolsgold agg] training data poison_ratio: 0.0  data num: [530, 888, 1129, 1742, 1130, 896, 1154, 803, 1475, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3108, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.5516, Accuracy: 0/9950 (0.0000%)
saving model
Done in 162.8839466571808 sec.
Server Epoch:64 choose agents : [76, 12, 56, 63, 47, 22, 70, 34, 31, 74].
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0489, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.7881, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 21/338 (6.2130%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   2, Avg loss: 0.0470, Accuracy: 137/338 (40.5325%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.4729, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   2, Avg loss: 0.0677, Accuracy: 68/186 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0542, Accuracy: 266/888 (29.9550%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 448/888 (50.4505%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.7127, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   1, Avg loss: 0.1239, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   2, Avg loss: 0.1044, Accuracy: 20/134 (14.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 524/1470 (35.6463%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 856/1470 (58.2313%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.2006, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0550, Accuracy: 368/1418 (25.9520%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 659/1418 (46.4739%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.7665, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   1, Avg loss: 0.0583, Accuracy: 398/1427 (27.8907%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 563/1427 (39.4534%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.8734, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   1, Avg loss: 0.0801, Accuracy: 72/460 (15.6522%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   2, Avg loss: 0.0349, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.7976, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   1, Avg loss: 0.0424, Accuracy: 532/1552 (34.2784%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 781/1552 (50.3222%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.4210, Accuracy: 78/10000 (0.7800%)
time spent on training: 83.73021793365479
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 338, 186, 888, 134, 1470, 1418, 1427, 460, 1552]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         0.84065046 1.
 1.         1.         0.84065046 1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3107, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.5514, Accuracy: 0/9950 (0.0000%)
saving model
Done in 150.57218217849731 sec.
Server Epoch:65 choose agents : [27, 36, 11, 14, 83, 29, 65, 72, 80, 10].
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 433/1587 (27.2842%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 622/1587 (39.1934%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.2948, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   1, Avg loss: 0.0873, Accuracy: 75/408 (18.3824%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   2, Avg loss: 0.0538, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.5094, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0550, Accuracy: 355/712 (49.8596%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0266, Accuracy: 440/712 (61.7978%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.5345, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0613, Accuracy: 228/1013 (22.5074%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 318/1013 (31.3919%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.7395, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 427/1953 (21.8638%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 767/1953 (39.2729%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.7277, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   1, Avg loss: 0.0497, Accuracy: 414/1440 (28.7500%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 665/1440 (46.1806%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.9219, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   1, Avg loss: 0.0543, Accuracy: 401/1475 (27.1864%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   2, Avg loss: 0.0321, Accuracy: 638/1475 (43.2542%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.0259, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 260/1241 (20.9508%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 408/1241 (32.8767%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.2332, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 156/682 (22.8739%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0376, Accuracy: 264/682 (38.7097%)
