current path: saved_models/model_tiny_Jun.11_14.56.59
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 3, 5, 9, 10, 12, 15, 18, 20, 24, 25, 30, 33, 36, 37, 42, 44, 48, 49, 54, 55, 60, 61, 65, 69, 72, 74, 78, 81, 84, 85, 95]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [37, 44, 94, 74, 82, 83, 41, 65, 26, 24].
poison local model 37 index 14 
___Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   1, Avg loss: 0.0529, Accuracy: 391/1129 (34.6324%)
___Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 717/1129 (63.5075%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.5876, Accuracy: 95/10000 (0.9500%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 401/1750 (22.9143%)
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 665/1750 (38.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.8318, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 346/1662 (20.8183%)
___Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   2, Avg loss: 0.0336, Accuracy: 583/1662 (35.0782%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.4703, Accuracy: 106/10000 (1.0600%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 504/1552 (32.4742%)
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 737/1552 (47.4871%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 10.2815, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 56/500 (11.2000%)
___Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 172/500 (34.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.5809, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0547, Accuracy: 410/1953 (20.9933%)
___Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 786/1953 (40.2458%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 8.4794, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   1, Avg loss: 0.0628, Accuracy: 318/719 (44.2281%)
___Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   2, Avg loss: 0.0308, Accuracy: 436/719 (60.6398%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.1997, Accuracy: 54/10000 (0.5400%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0575, Accuracy: 378/1475 (25.6271%)
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0307, Accuracy: 700/1475 (47.4576%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.8956, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 325/1446 (22.4758%)
___Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 506/1446 (34.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.8878, Accuracy: 63/10000 (0.6300%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 28/312 (8.9744%)
___Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 167/312 (53.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3864, Accuracy: 50/10000 (0.5000%)
time spent on training: 140.91605615615845
___Test Target_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3003, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 1: Avg loss: 5.3361, Accuracy: 0/9950 (0.0000%)
saving model
Done in 553.3584675788879 sec.
Server Epoch:2 choose agents : [94, 71, 66, 35, 38, 84, 42, 43, 11, 95].
___Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 350/1662 (21.0590%)
___Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   2, Avg loss: 0.0336, Accuracy: 590/1662 (35.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.9530, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   1, Avg loss: 0.0652, Accuracy: 143/818 (17.4817%)
___Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 385/818 (47.0660%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.2875, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 257/1402 (18.3310%)
___Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 374/1402 (26.6762%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.0647, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   1, Avg loss: 0.0860, Accuracy: 43/271 (15.8672%)
___Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   2, Avg loss: 0.0568, Accuracy: 102/271 (37.6384%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3794, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   1, Avg loss: 0.0627, Accuracy: 235/1131 (20.7781%)
___Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   2, Avg loss: 0.0315, Accuracy: 447/1131 (39.5225%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.4522, Accuracy: 64/10000 (0.6400%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0636, Accuracy: 313/1190 (26.3025%)
___Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 417/1190 (35.0420%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.8412, Accuracy: 53/10000 (0.5300%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 337/1372 (24.5627%)
___Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 520/1372 (37.9009%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.7796, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 296/946 (31.2896%)
___Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 361/946 (38.1607%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.0379, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   1, Avg loss: 0.0578, Accuracy: 348/712 (48.8764%)
___Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   2, Avg loss: 0.0258, Accuracy: 408/712 (57.3034%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.5167, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   1, Avg loss: 0.0518, Accuracy: 332/599 (55.4257%)
___Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   2, Avg loss: 0.0306, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.8843, Accuracy: 50/10000 (0.5000%)
time spent on training: 140.5820288658142
___Test Target_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.2999, Accuracy: 39/10000 (0.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 2: Avg loss: 5.3149, Accuracy: 0/9950 (0.0000%)
saving model
Done in 542.0248801708221 sec.
Server Epoch:3 choose agents : [15, 88, 13, 42, 72, 22, 6, 0, 69, 17].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0565, Accuracy: 331/1154 (28.6828%)
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 392/1154 (33.9688%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.0124, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 140/603 (23.2172%)
___Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   2, Avg loss: 0.0463, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.8949, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0581, Accuracy: 312/1645 (18.9666%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 600/1645 (36.4742%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.8352, Accuracy: 114/10000 (1.1400%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 374/1372 (27.2595%)
___Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 503/1372 (36.6618%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.6519, Accuracy: 67/10000 (0.6700%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   1, Avg loss: 0.0622, Accuracy: 256/1241 (20.6285%)
___Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 428/1241 (34.4883%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.1275, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 524/1470 (35.6463%)
___Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 858/1470 (58.3673%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.2188, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 376/1956 (19.2229%)
___Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 646/1956 (33.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.2376, Accuracy: 112/10000 (1.1200%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0581, Accuracy: 363/1657 (21.9071%)
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 539/1657 (32.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.9278, Accuracy: 58/10000 (0.5800%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0587, Accuracy: 274/590 (46.4407%)
___Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0311, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.7928, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 388/1574 (24.6506%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0282, Accuracy: 627/1574 (39.8348%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.3729, Accuracy: 92/10000 (0.9200%)
time spent on training: 167.13414788246155
___Test Target_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3016, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 3: Avg loss: 5.3268, Accuracy: 0/9950 (0.0000%)
saving model
Done in 574.0234606266022 sec.
Server Epoch:4 choose agents : [31, 94, 47, 15, 11, 35, 62, 77, 21, 93].
___Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0817, Accuracy: 67/460 (14.5652%)
___Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.9660, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   1, Avg loss: 0.0541, Accuracy: 352/1662 (21.1793%)
___Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 645/1662 (38.8087%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.7059, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   1, Avg loss: 0.1249, Accuracy: 2/134 (1.4925%)
___Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   2, Avg loss: 0.1094, Accuracy: 18/134 (13.4328%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3204, Accuracy: 50/10000 (0.5000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   1, Avg loss: 0.0570, Accuracy: 325/1154 (28.1629%)
___Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 382/1154 (33.1023%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.3136, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   1, Avg loss: 0.0548, Accuracy: 355/712 (49.8596%)
___Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   2, Avg loss: 0.0266, Accuracy: 405/712 (56.8820%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.5120, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   1, Avg loss: 0.0855, Accuracy: 42/271 (15.4982%)
___Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   2, Avg loss: 0.0560, Accuracy: 103/271 (38.0074%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.4017, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0691, Accuracy: 138/568 (24.2958%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0413, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.9142, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0542, Accuracy: 317/1340 (23.6567%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 599/1340 (44.7015%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.9513, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 396/1949 (20.3181%)
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 602/1949 (30.8876%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.3346, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   1, Avg loss: 0.0564, Accuracy: 398/1742 (22.8473%)
___Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 679/1742 (38.9782%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.7894, Accuracy: 75/10000 (0.7500%)
time spent on training: 122.40084886550903
___Test Target_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3029, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 4: Avg loss: 5.3316, Accuracy: 0/9950 (0.0000%)
saving model
Done in 551.0868322849274 sec.
Server Epoch:5 choose agents : [91, 78, 82, 2, 77, 31, 70, 65, 60, 36].
___Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0531, Accuracy: 343/1030 (33.3010%)
___Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0260, Accuracy: 647/1030 (62.8155%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.3645, Accuracy: 81/10000 (0.8100%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   1, Avg loss: 0.0845, Accuracy: 35/416 (8.4135%)
___Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 186/416 (44.7115%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.6918, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 73/500 (14.6000%)
___Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 174/500 (34.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.8719, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0631, Accuracy: 227/605 (37.5207%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0388, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.9038, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   1, Avg loss: 0.0534, Accuracy: 330/1340 (24.6269%)
___Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 557/1340 (41.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.9482, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   1, Avg loss: 0.0804, Accuracy: 58/460 (12.6087%)
___Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   2, Avg loss: 0.0379, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.9123, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 320/1418 (22.5670%)
___Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   2, Avg loss: 0.0311, Accuracy: 650/1418 (45.8392%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.8722, Accuracy: 94/10000 (0.9400%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   1, Avg loss: 0.0547, Accuracy: 388/1475 (26.3051%)
___Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   2, Avg loss: 0.0306, Accuracy: 700/1475 (47.4576%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.2073, Accuracy: 81/10000 (0.8100%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 614/2227 (27.5707%)
___Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1052/2227 (47.2384%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.2964, Accuracy: 123/10000 (1.2300%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   1, Avg loss: 0.0879, Accuracy: 73/408 (17.8922%)
___Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   2, Avg loss: 0.0548, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.5930, Accuracy: 50/10000 (0.5000%)
time spent on training: 156.82914972305298
___Test Target_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3050, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 5: Avg loss: 5.3162, Accuracy: 0/9950 (0.0000%)
saving model
Done in 585.2499814033508 sec.
Server Epoch:6 choose agents : [63, 42, 69, 72, 83, 44, 79, 50, 66, 74].
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0540, Accuracy: 258/888 (29.0541%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 432/888 (48.6486%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.4591, Accuracy: 53/10000 (0.5300%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0520, Accuracy: 362/1372 (26.3848%)
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 532/1372 (38.7755%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.2763, Accuracy: 71/10000 (0.7100%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   1, Avg loss: 0.0560, Accuracy: 292/590 (49.4915%)
___Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.3115, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 252/1241 (20.3062%)
___Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 411/1241 (33.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.3046, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 437/1953 (22.3758%)
___Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 761/1953 (38.9657%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.2797, Accuracy: 87/10000 (0.8700%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0587, Accuracy: 381/1750 (21.7714%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 687/1750 (39.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.4560, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   1, Avg loss: 0.1019, Accuracy: 8/197 (4.0609%)
___Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   2, Avg loss: 0.0794, Accuracy: 58/197 (29.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3536, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0629, Accuracy: 150/809 (18.5414%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 352/809 (43.5105%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.6698, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   1, Avg loss: 0.0616, Accuracy: 272/1402 (19.4009%)
___Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 389/1402 (27.7461%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.2541, Accuracy: 71/10000 (0.7100%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0418, Accuracy: 527/1552 (33.9562%)
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 791/1552 (50.9665%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 10.8474, Accuracy: 81/10000 (0.8100%)
time spent on training: 174.01367592811584
___Test Target_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3072, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 6: Avg loss: 5.3251, Accuracy: 0/9950 (0.0000%)
saving model
Done in 583.6196076869965 sec.
Server Epoch:7 choose agents : [82, 90, 50, 35, 0, 79, 25, 37, 16, 60].
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0750, Accuracy: 71/500 (14.2000%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 177/500 (35.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.9619, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0579, Accuracy: 309/677 (45.6425%)
___Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0224, Accuracy: 450/677 (66.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.5560, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   1, Avg loss: 0.0619, Accuracy: 161/809 (19.9011%)
___Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   2, Avg loss: 0.0267, Accuracy: 353/809 (43.6341%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.5066, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0840, Accuracy: 48/271 (17.7122%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0544, Accuracy: 99/271 (36.5314%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.4645, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 341/1657 (20.5794%)
___Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 541/1657 (32.6494%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.8315, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.1019, Accuracy: 7/197 (3.5533%)
___Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0848, Accuracy: 57/197 (28.9340%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3471, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0568, Accuracy: 302/690 (43.7681%)
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 459/690 (66.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.7616, Accuracy: 66/10000 (0.6600%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   1, Avg loss: 0.0513, Accuracy: 435/1129 (38.5297%)
___Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 742/1129 (65.7219%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.8655, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   1, Avg loss: 0.0612, Accuracy: 272/708 (38.4181%)
___Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   2, Avg loss: 0.0378, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.9632, Accuracy: 60/10000 (0.6000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 587/2227 (26.3583%)
___Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1022/2227 (45.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.5013, Accuracy: 107/10000 (1.0700%)
time spent on training: 156.39330101013184
___Test Target_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3090, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 7: Avg loss: 5.3169, Accuracy: 0/9950 (0.0000%)
saving model
Done in 586.7901604175568 sec.
Server Epoch:8 choose agents : [94, 35, 21, 1, 88, 43, 68, 27, 19, 92].
___Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   1, Avg loss: 0.0540, Accuracy: 325/1662 (19.5548%)
___Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 605/1662 (36.4019%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.0468, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   1, Avg loss: 0.0838, Accuracy: 42/271 (15.4982%)
___Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   2, Avg loss: 0.0519, Accuracy: 109/271 (40.2214%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.4920, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0527, Accuracy: 420/1949 (21.5495%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 614/1949 (31.5033%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.3335, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0582, Accuracy: 286/928 (30.8190%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 570/928 (61.4224%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.1340, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   1, Avg loss: 0.0731, Accuracy: 141/603 (23.3831%)
___Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   2, Avg loss: 0.0452, Accuracy: 287/603 (47.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.2298, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   1, Avg loss: 0.0613, Accuracy: 311/946 (32.8753%)
___Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 335/946 (35.4123%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.1392, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   1, Avg loss: 0.0625, Accuracy: 365/1163 (31.3844%)
___Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   2, Avg loss: 0.0363, Accuracy: 434/1163 (37.3173%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.7292, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 404/1587 (25.4568%)
___Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   2, Avg loss: 0.0331, Accuracy: 625/1587 (39.3825%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.2481, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 385/1036 (37.1622%)
___Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   2, Avg loss: 0.0251, Accuracy: 663/1036 (63.9961%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 9.5138, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   1, Avg loss: 0.0524, Accuracy: 429/1715 (25.0146%)
___Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 691/1715 (40.2915%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.7347, Accuracy: 88/10000 (0.8800%)
time spent on training: 123.75110626220703
___Test Target_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.3113, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 8: Avg loss: 5.3186, Accuracy: 0/9950 (0.0000%)
saving model
Done in 526.0379033088684 sec.
Server Epoch:9 choose agents : [57, 42, 90, 21, 49, 84, 77, 18, 56, 65].
___Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   1, Avg loss: 0.0541, Accuracy: 305/1154 (26.4298%)
___Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   2, Avg loss: 0.0260, Accuracy: 495/1154 (42.8943%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 9.2049, Accuracy: 77/10000 (0.7700%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   1, Avg loss: 0.0511, Accuracy: 374/1372 (27.2595%)
___Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 518/1372 (37.7551%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.9776, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0559, Accuracy: 322/677 (47.5628%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 451/677 (66.6174%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.3255, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   1, Avg loss: 0.0528, Accuracy: 403/1949 (20.6773%)
___Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 624/1949 (32.0164%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.0812, Accuracy: 100/10000 (1.0000%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   1, Avg loss: 0.0797, Accuracy: 27/440 (6.1364%)
___Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   2, Avg loss: 0.0475, Accuracy: 145/440 (32.9545%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.7552, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0615, Accuracy: 333/1190 (27.9832%)
___Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 460/1190 (38.6555%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.3521, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0521, Accuracy: 344/1340 (25.6716%)
___Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 535/1340 (39.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.0369, Accuracy: 67/10000 (0.6700%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   1, Avg loss: 0.0774, Accuracy: 112/530 (21.1321%)
___Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   2, Avg loss: 0.0398, Accuracy: 270/530 (50.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.6799, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 58/186 (31.1828%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3467, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0558, Accuracy: 393/1475 (26.6441%)
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0305, Accuracy: 680/1475 (46.1017%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.5793, Accuracy: 72/10000 (0.7200%)
time spent on training: 171.29288530349731
___Test Target_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3136, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 9: Avg loss: 5.3086, Accuracy: 0/9950 (0.0000%)
saving model
Done in 604.102751493454 sec.
Server Epoch:10 choose agents : [5, 23, 83, 66, 54, 46, 86, 78, 84, 8].
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0513, Accuracy: 407/1628 (25.0000%)
___Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 799/1628 (49.0786%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.5628, Accuracy: 140/10000 (1.4000%)
___Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   1, Avg loss: 0.0600, Accuracy: 308/715 (43.0769%)
___Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   2, Avg loss: 0.0393, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.9522, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   1, Avg loss: 0.0533, Accuracy: 456/1953 (23.3487%)
___Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 745/1953 (38.1464%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.0680, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   1, Avg loss: 0.0611, Accuracy: 270/1402 (19.2582%)
___Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   2, Avg loss: 0.0383, Accuracy: 383/1402 (27.3181%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.6655, Accuracy: 71/10000 (0.7100%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   1, Avg loss: 0.0555, Accuracy: 334/1130 (29.5575%)
___Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 475/1130 (42.0354%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.1871, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   1, Avg loss: 0.0555, Accuracy: 393/1904 (20.6408%)
___Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 677/1904 (35.5567%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.7624, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   1, Avg loss: 0.0642, Accuracy: 347/1003 (34.5962%)
___Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   2, Avg loss: 0.0354, Accuracy: 346/1003 (34.4965%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.9533, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   1, Avg loss: 0.0825, Accuracy: 43/416 (10.3365%)
___Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   2, Avg loss: 0.0468, Accuracy: 171/416 (41.1058%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.9282, Accuracy: 51/10000 (0.5100%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0610, Accuracy: 320/1190 (26.8908%)
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0317, Accuracy: 462/1190 (38.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.5548, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   1, Avg loss: 0.0602, Accuracy: 255/1513 (16.8539%)
___Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 497/1513 (32.8486%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.8234, Accuracy: 91/10000 (0.9100%)
time spent on training: 173.73755192756653
___Test Target_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3160, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 10: Avg loss: 5.3139, Accuracy: 0/9950 (0.0000%)
saving model
Done in 595.992614030838 sec.
Server Epoch:11 choose agents : [38, 24, 45, 8, 65, 19, 49, 17, 40, 22].
___Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   1, Avg loss: 0.0613, Accuracy: 250/1131 (22.1043%)
___Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   2, Avg loss: 0.0300, Accuracy: 494/1131 (43.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.0974, Accuracy: 78/10000 (0.7800%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0768, Accuracy: 41/312 (13.1410%)
___Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 160/312 (51.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.6680, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   1, Avg loss: 0.0684, Accuracy: 196/669 (29.2975%)
___Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   2, Avg loss: 0.0406, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.0908, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   1, Avg loss: 0.0598, Accuracy: 259/1513 (17.1183%)
___Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   2, Avg loss: 0.0359, Accuracy: 496/1513 (32.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.3360, Accuracy: 116/10000 (1.1600%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   1, Avg loss: 0.0549, Accuracy: 429/1475 (29.0847%)
___Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   2, Avg loss: 0.0297, Accuracy: 707/1475 (47.9322%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.1676, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 402/1036 (38.8031%)
___Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   2, Avg loss: 0.0242, Accuracy: 665/1036 (64.1892%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 9.8850, Accuracy: 58/10000 (0.5800%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   1, Avg loss: 0.0789, Accuracy: 40/440 (9.0909%)
___Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   2, Avg loss: 0.0470, Accuracy: 146/440 (33.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.9520, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0507, Accuracy: 412/1574 (26.1753%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0266, Accuracy: 721/1574 (45.8069%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.6032, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   1, Avg loss: 0.0543, Accuracy: 377/1573 (23.9669%)
___Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 595/1573 (37.8258%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.8374, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   1, Avg loss: 0.0462, Accuracy: 474/1470 (32.2449%)
___Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 847/1470 (57.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.4322, Accuracy: 78/10000 (0.7800%)
time spent on training: 159.28331995010376
___Test Target_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.3186, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 11: Avg loss: 5.3041, Accuracy: 0/9950 (0.0000%)
saving model
Done in 599.362312078476 sec.
Server Epoch:12 choose agents : [56, 30, 69, 47, 51, 48, 92, 84, 32, 22].
___Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   1, Avg loss: 0.0822, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   2, Avg loss: 0.0665, Accuracy: 74/186 (39.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3594, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0819, Accuracy: 75/486 (15.4321%)
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0409, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.5074, Accuracy: 39/10000 (0.3900%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   1, Avg loss: 0.0547, Accuracy: 299/590 (50.6780%)
___Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   2, Avg loss: 0.0311, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.2071, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   1, Avg loss: 0.1240, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   2, Avg loss: 0.1061, Accuracy: 14/134 (10.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3477, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   1, Avg loss: 0.0601, Accuracy: 235/1049 (22.4023%)
___Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 505/1049 (48.1411%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.9207, Accuracy: 80/10000 (0.8000%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   1, Avg loss: 0.0704, Accuracy: 113/631 (17.9081%)
___Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 224/631 (35.4992%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.2508, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0515, Accuracy: 447/1715 (26.0641%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 699/1715 (40.7580%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.5776, Accuracy: 90/10000 (0.9000%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   1, Avg loss: 0.0598, Accuracy: 341/1190 (28.6555%)
___Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   2, Avg loss: 0.0315, Accuracy: 453/1190 (38.0672%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.4472, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 188/735 (25.5782%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 335/735 (45.5782%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 9.3009, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0448, Accuracy: 551/1470 (37.4830%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 852/1470 (57.9592%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.3368, Accuracy: 92/10000 (0.9200%)
time spent on training: 165.45303916931152
___Test Target_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3209, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 12: Avg loss: 5.2688, Accuracy: 0/9950 (0.0000%)
saving model
Done in 596.9825673103333 sec.
Server Epoch:13 choose agents : [53, 15, 3, 23, 83, 11, 27, 76, 70, 35].
___Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   1, Avg loss: 0.0506, Accuracy: 293/813 (36.0394%)
___Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 479/813 (58.9176%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 11.0411, Accuracy: 52/10000 (0.5200%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0565, Accuracy: 333/1154 (28.8562%)
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0282, Accuracy: 443/1154 (38.3882%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.7004, Accuracy: 73/10000 (0.7300%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   1, Avg loss: 0.0737, Accuracy: 117/781 (14.9808%)
___Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 235/781 (30.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.4308, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0603, Accuracy: 316/715 (44.1958%)
___Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0387, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.9922, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 443/1953 (22.6831%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 726/1953 (37.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.1006, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   1, Avg loss: 0.0545, Accuracy: 340/712 (47.7528%)
___Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   2, Avg loss: 0.0257, Accuracy: 438/712 (61.5169%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.1852, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 416/1587 (26.2130%)
___Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 598/1587 (37.6812%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.4817, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0840, Accuracy: 55/466 (11.8026%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0496, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.4010, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0546, Accuracy: 379/1418 (26.7278%)
___Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 665/1418 (46.8970%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.0461, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0824, Accuracy: 69/271 (25.4613%)
___Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0553, Accuracy: 119/271 (43.9114%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.6466, Accuracy: 49/10000 (0.4900%)
time spent on training: 151.65755772590637
___Test Target_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3232, Accuracy: 40/10000 (0.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 13: Avg loss: 5.2712, Accuracy: 0/9950 (0.0000%)
saving model
Done in 587.3832960128784 sec.
Server Epoch:14 choose agents : [0, 94, 96, 91, 51, 3, 36, 90, 37, 84].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   1, Avg loss: 0.0572, Accuracy: 347/1657 (20.9415%)
___Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 503/1657 (30.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.0505, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   1, Avg loss: 0.0538, Accuracy: 361/1662 (21.7208%)
___Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   2, Avg loss: 0.0324, Accuracy: 636/1662 (38.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.2843, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   1, Avg loss: 0.0801, Accuracy: 36/311 (11.5756%)
___Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 136/311 (43.7299%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.5287, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   1, Avg loss: 0.0511, Accuracy: 369/1030 (35.8252%)
___Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   2, Avg loss: 0.0247, Accuracy: 652/1030 (63.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.7190, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   1, Avg loss: 0.0593, Accuracy: 229/1049 (21.8303%)
___Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   2, Avg loss: 0.0301, Accuracy: 550/1049 (52.4309%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.8843, Accuracy: 89/10000 (0.8900%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   1, Avg loss: 0.0731, Accuracy: 120/781 (15.3649%)
___Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   2, Avg loss: 0.0355, Accuracy: 239/781 (30.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.1079, Accuracy: 77/10000 (0.7700%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0866, Accuracy: 72/408 (17.6471%)
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0535, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.9383, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   1, Avg loss: 0.0550, Accuracy: 319/677 (47.1196%)
___Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   2, Avg loss: 0.0219, Accuracy: 446/677 (65.8789%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.7059, Accuracy: 55/10000 (0.5500%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   1, Avg loss: 0.0504, Accuracy: 441/1129 (39.0611%)
___Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   2, Avg loss: 0.0239, Accuracy: 738/1129 (65.3676%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.6140, Accuracy: 106/10000 (1.0600%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0599, Accuracy: 343/1190 (28.8235%)
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0308, Accuracy: 498/1190 (41.8487%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.5239, Accuracy: 58/10000 (0.5800%)
time spent on training: 182.78957843780518
___Test Target_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.3252, Accuracy: 40/10000 (0.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 14: Avg loss: 5.2713, Accuracy: 0/9950 (0.0000%)
saving model
Done in 592.5280232429504 sec.
Server Epoch:15 choose agents : [0, 92, 37, 24, 39, 63, 28, 96, 58, 72].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   1, Avg loss: 0.0565, Accuracy: 361/1657 (21.7864%)
___Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   2, Avg loss: 0.0338, Accuracy: 553/1657 (33.3736%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.2182, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0508, Accuracy: 472/1715 (27.5219%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0302, Accuracy: 737/1715 (42.9738%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.5952, Accuracy: 99/10000 (0.9900%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0495, Accuracy: 451/1129 (39.9469%)
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0234, Accuracy: 762/1129 (67.4934%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.1347, Accuracy: 117/10000 (1.1700%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   1, Avg loss: 0.0758, Accuracy: 42/312 (13.4615%)
___Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   2, Avg loss: 0.0399, Accuracy: 163/312 (52.2436%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.8377, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0547, Accuracy: 303/1013 (29.9112%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 499/1013 (49.2596%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.2419, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0533, Accuracy: 272/888 (30.6306%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 439/888 (49.4369%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 9.3001, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 413/1581 (26.1227%)
___Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 613/1581 (38.7729%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.0925, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   1, Avg loss: 0.0795, Accuracy: 46/311 (14.7910%)
___Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   2, Avg loss: 0.0533, Accuracy: 136/311 (43.7299%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.5507, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   1, Avg loss: 0.0601, Accuracy: 340/803 (42.3412%)
___Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 400/803 (49.8132%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.3305, Accuracy: 54/10000 (0.5400%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   1, Avg loss: 0.0599, Accuracy: 257/1241 (20.7091%)
___Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 429/1241 (34.5689%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.3385, Accuracy: 60/10000 (0.6000%)
time spent on training: 177.1794352531433
___Test Target_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.3273, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 15: Avg loss: 5.2785, Accuracy: 0/9950 (0.0000%)
saving model
Done in 607.3330156803131 sec.
Server Epoch:16 choose agents : [35, 32, 3, 96, 25, 8, 93, 74, 88, 50].
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0817, Accuracy: 70/271 (25.8303%)
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0522, Accuracy: 113/271 (41.6974%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.6974, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0589, Accuracy: 194/735 (26.3946%)
___Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 356/735 (48.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 9.6828, Accuracy: 68/10000 (0.6800%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   1, Avg loss: 0.0712, Accuracy: 119/781 (15.2369%)
___Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   2, Avg loss: 0.0342, Accuracy: 250/781 (32.0102%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.3642, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0786, Accuracy: 56/311 (18.0064%)
___Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0527, Accuracy: 137/311 (44.0514%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.5832, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0563, Accuracy: 309/690 (44.7826%)
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0272, Accuracy: 466/690 (67.5362%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.4308, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   1, Avg loss: 0.0588, Accuracy: 277/1513 (18.3080%)
___Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   2, Avg loss: 0.0357, Accuracy: 515/1513 (34.0383%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.8288, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 417/1742 (23.9380%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0312, Accuracy: 740/1742 (42.4799%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.9678, Accuracy: 75/10000 (0.7500%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 490/1552 (31.5722%)
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 816/1552 (52.5773%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 11.1126, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   1, Avg loss: 0.0722, Accuracy: 152/603 (25.2073%)
___Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.5534, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   1, Avg loss: 0.0611, Accuracy: 168/809 (20.7664%)
___Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   2, Avg loss: 0.0256, Accuracy: 399/809 (49.3201%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.0259, Accuracy: 94/10000 (0.9400%)
time spent on training: 160.45806455612183
___Test Target_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.3295, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 16: Avg loss: 5.2423, Accuracy: 0/9950 (0.0000%)
saving model
Done in 579.5122537612915 sec.
Server Epoch:17 choose agents : [53, 43, 41, 30, 82, 92, 50, 34, 7, 64].
___Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   1, Avg loss: 0.0494, Accuracy: 290/813 (35.6704%)
___Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 484/813 (59.5326%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 10.7252, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0615, Accuracy: 308/946 (32.5581%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 370/946 (39.1121%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.5266, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   1, Avg loss: 0.0590, Accuracy: 328/719 (45.6189%)
___Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   2, Avg loss: 0.0309, Accuracy: 463/719 (64.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.0537, Accuracy: 59/10000 (0.5900%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   1, Avg loss: 0.0791, Accuracy: 75/486 (15.4321%)
___Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.6738, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   1, Avg loss: 0.0750, Accuracy: 77/500 (15.4000%)
___Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   2, Avg loss: 0.0479, Accuracy: 183/500 (36.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.6129, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   1, Avg loss: 0.0506, Accuracy: 481/1715 (28.0466%)
___Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   2, Avg loss: 0.0299, Accuracy: 745/1715 (43.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.5945, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   1, Avg loss: 0.0601, Accuracy: 177/809 (21.8789%)
___Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   2, Avg loss: 0.0263, Accuracy: 360/809 (44.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 9.0186, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0587, Accuracy: 361/1427 (25.2978%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0327, Accuracy: 599/1427 (41.9762%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.4520, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 351/891 (39.3939%)
___Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 441/891 (49.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.9691, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   1, Avg loss: 0.0642, Accuracy: 175/953 (18.3631%)
___Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   2, Avg loss: 0.0374, Accuracy: 312/953 (32.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.0133, Accuracy: 62/10000 (0.6200%)
time spent on training: 138.77631402015686
___Test Target_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.3313, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 17: Avg loss: 5.2258, Accuracy: 0/9950 (0.0000%)
saving model
Done in 544.2707784175873 sec.
Server Epoch:18 choose agents : [18, 55, 4, 35, 2, 13, 24, 76, 9, 43].
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   1, Avg loss: 0.0770, Accuracy: 116/530 (21.8868%)
___Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   2, Avg loss: 0.0384, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.2296, Accuracy: 68/10000 (0.6800%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 262/1071 (24.4631%)
___Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 511/1071 (47.7124%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.3780, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   1, Avg loss: 0.0618, Accuracy: 328/901 (36.4040%)
___Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   2, Avg loss: 0.0325, Accuracy: 408/901 (45.2830%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.6052, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   1, Avg loss: 0.0814, Accuracy: 71/271 (26.1993%)
___Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   2, Avg loss: 0.0519, Accuracy: 115/271 (42.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.8698, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0645, Accuracy: 218/605 (36.0331%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0381, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.3840, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   1, Avg loss: 0.0558, Accuracy: 347/1645 (21.0942%)
___Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   2, Avg loss: 0.0315, Accuracy: 673/1645 (40.9119%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.1557, Accuracy: 113/10000 (1.1300%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0756, Accuracy: 48/312 (15.3846%)
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0397, Accuracy: 162/312 (51.9231%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.9918, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0820, Accuracy: 68/466 (14.5923%)
___Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0468, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.3813, Accuracy: 50/10000 (0.5000%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0496, Accuracy: 357/1275 (28.0000%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0193, Accuracy: 666/1275 (52.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 10.1003, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   1, Avg loss: 0.0605, Accuracy: 312/946 (32.9810%)
___Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   2, Avg loss: 0.0356, Accuracy: 326/946 (34.4609%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.5893, Accuracy: 58/10000 (0.5800%)
time spent on training: 165.46331882476807
___Test Target_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.3333, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 18: Avg loss: 5.2316, Accuracy: 0/9950 (0.0000%)
saving model
Done in 571.3307862281799 sec.
Server Epoch:19 choose agents : [11, 48, 53, 27, 55, 65, 31, 89, 17, 23].
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0535, Accuracy: 343/712 (48.1742%)
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 430/712 (60.3933%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.8891, Accuracy: 66/10000 (0.6600%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   1, Avg loss: 0.0697, Accuracy: 120/631 (19.0174%)
___Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   2, Avg loss: 0.0404, Accuracy: 233/631 (36.9255%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.4135, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   1, Avg loss: 0.0486, Accuracy: 313/813 (38.4994%)
___Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 474/813 (58.3026%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 10.8500, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 436/1587 (27.4732%)
___Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 622/1587 (39.1934%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.3017, Accuracy: 74/10000 (0.7400%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   1, Avg loss: 0.0553, Accuracy: 286/1071 (26.7040%)
___Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 517/1071 (48.2726%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.3462, Accuracy: 77/10000 (0.7700%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   1, Avg loss: 0.0531, Accuracy: 413/1475 (28.0000%)
___Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   2, Avg loss: 0.0308, Accuracy: 700/1475 (47.4576%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.0096, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   1, Avg loss: 0.0793, Accuracy: 83/460 (18.0435%)
___Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   2, Avg loss: 0.0355, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.8681, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0608, Accuracy: 333/896 (37.1652%)
___Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0339, Accuracy: 430/896 (47.9911%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.9350, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0503, Accuracy: 437/1574 (27.7637%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0263, Accuracy: 711/1574 (45.1715%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.6727, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   1, Avg loss: 0.0595, Accuracy: 321/715 (44.8951%)
___Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   2, Avg loss: 0.0380, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.0342, Accuracy: 50/10000 (0.5000%)
time spent on training: 162.51335501670837
___Test Target_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.3353, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 19: Avg loss: 5.2182, Accuracy: 0/9950 (0.0000%)
saving model
Done in 571.0691092014313 sec.
Server Epoch:20 choose agents : [15, 22, 82, 11, 93, 75, 3, 77, 88, 16].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0567, Accuracy: 339/1154 (29.3761%)
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 386/1154 (33.4489%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.3451, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   1, Avg loss: 0.0450, Accuracy: 526/1470 (35.7823%)
___Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   2, Avg loss: 0.0234, Accuracy: 871/1470 (59.2517%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.5880, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   1, Avg loss: 0.0735, Accuracy: 79/500 (15.8000%)
___Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.5700, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0539, Accuracy: 353/712 (49.5787%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0251, Accuracy: 430/712 (60.3933%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.7451, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   1, Avg loss: 0.0538, Accuracy: 422/1742 (24.2250%)
___Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   2, Avg loss: 0.0310, Accuracy: 698/1742 (40.0689%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.2144, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0641, Accuracy: 248/776 (31.9588%)
___Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 415/776 (53.4794%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.6153, Accuracy: 78/10000 (0.7800%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   1, Avg loss: 0.0703, Accuracy: 128/781 (16.3892%)
___Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   2, Avg loss: 0.0348, Accuracy: 248/781 (31.7542%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.4832, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   1, Avg loss: 0.0510, Accuracy: 358/1340 (26.7164%)
___Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   2, Avg loss: 0.0266, Accuracy: 584/1340 (43.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.9855, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   1, Avg loss: 0.0723, Accuracy: 157/603 (26.0365%)
___Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.1632, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   1, Avg loss: 0.0630, Accuracy: 284/708 (40.1130%)
___Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   2, Avg loss: 0.0352, Accuracy: 430/708 (60.7345%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.0571, Accuracy: 59/10000 (0.5900%)
time spent on training: 156.5651524066925
___Test Target_ResNet_18 poisoned: False, epoch: 20: Avg loss: 5.3373, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 20: Avg loss: 5.2291, Accuracy: 0/9950 (0.0000%)
saving model
Done in 586.797801733017 sec.
Server Epoch:21 choose agents : [0, 27, 39, 70, 20, 85, 12, 72, 94, 32].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0553, Accuracy: 393/1657 (23.7176%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0347, Accuracy: 549/1657 (33.1322%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0321, Accuracy: 560/1657 (33.7960%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0316, Accuracy: 575/1657 (34.7013%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0311, Accuracy: 598/1657 (36.0893%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0309, Accuracy: 609/1657 (36.7532%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0305, Accuracy: 642/1657 (38.7447%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0299, Accuracy: 651/1657 (39.2879%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0298, Accuracy: 664/1657 (40.0724%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0297, Accuracy: 662/1657 (39.9517%), train_poison_data_count: 520
Global model norm: 112.02866977502902.
Norm before scaling: 112.0022757162773. Distance: 1.1561984488877544
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.8243, Accuracy: 80/10000 (0.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: 1.0511, Accuracy: 8919/9950 (89.6382%)
Scaling by  100
Scaled Norm after poisoning: 158.7246904036987, distance: 115.61984785818566
Total norm for 5 adversaries is: 158.7246904036987. distance: 115.61984785818566
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0527, Accuracy: 447/1587 (28.1664%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0333, Accuracy: 616/1587 (38.8154%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.8514, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   1, Avg loss: 0.0539, Accuracy: 310/1013 (30.6022%)
___Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   2, Avg loss: 0.0254, Accuracy: 522/1013 (51.5301%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.3576, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   1, Avg loss: 0.0546, Accuracy: 418/1418 (29.4781%)
___Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   2, Avg loss: 0.0294, Accuracy: 674/1418 (47.5317%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.3665, Accuracy: 118/10000 (1.1800%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 332/807 (41.1400%)
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0332, Accuracy: 415/807 (51.4250%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.2052, Accuracy: 74/10000 (0.7400%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   1, Avg loss: 0.0550, Accuracy: 460/1988 (23.1388%)
___Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   2, Avg loss: 0.0343, Accuracy: 739/1988 (37.1730%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.9950, Accuracy: 84/10000 (0.8400%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   1, Avg loss: 0.0901, Accuracy: 15/338 (4.4379%)
___Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   2, Avg loss: 0.0479, Accuracy: 146/338 (43.1953%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.9862, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   1, Avg loss: 0.0594, Accuracy: 276/1241 (22.2401%)
___Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   2, Avg loss: 0.0360, Accuracy: 430/1241 (34.6495%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.5800, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0532, Accuracy: 389/1662 (23.4055%)
___Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0323, Accuracy: 641/1662 (38.5680%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.7537, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   1, Avg loss: 0.0583, Accuracy: 191/735 (25.9864%)
___Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   2, Avg loss: 0.0213, Accuracy: 388/735 (52.7891%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 10.3483, Accuracy: 59/10000 (0.5900%)
time spent on training: 268.73526406288147
___Test Target_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.9542, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Avg loss: 1.4060, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 680.5826585292816 sec.
Server Epoch:22 choose agents : [17, 32, 73, 28, 12, 2, 85, 13, 18, 80].
___Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   1, Avg loss: 0.0664, Accuracy: 292/1574 (18.5515%)
___Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 683/1574 (43.3926%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.3177, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   1, Avg loss: 0.0719, Accuracy: 164/735 (22.3129%)
___Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   2, Avg loss: 0.0255, Accuracy: 365/735 (49.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 13.5005, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   1, Avg loss: 0.0798, Accuracy: 202/938 (21.5352%)
___Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   2, Avg loss: 0.0358, Accuracy: 352/938 (37.5267%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.2274, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   1, Avg loss: 0.0656, Accuracy: 357/1581 (22.5806%)
___Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 575/1581 (36.3694%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.8192, Accuracy: 103/10000 (1.0300%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.1323, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0672, Accuracy: 35/338 (10.3550%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.5169, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0992, Accuracy: 42/605 (6.9421%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0495, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.6685, Accuracy: 52/10000 (0.5200%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   1, Avg loss: 0.0670, Accuracy: 361/1988 (18.1590%)
___Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   2, Avg loss: 0.0347, Accuracy: 705/1988 (35.4628%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.2758, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0671, Accuracy: 271/1645 (16.4742%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0309, Accuracy: 677/1645 (41.1550%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.5556, Accuracy: 120/10000 (1.2000%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.1125, Accuracy: 1/530 (0.1887%)
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0437, Accuracy: 266/530 (50.1887%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 10.4691, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0885, Accuracy: 67/682 (9.8240%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0399, Accuracy: 260/682 (38.1232%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 11.9196, Accuracy: 52/10000 (0.5200%)
time spent on training: 174.6365098953247
___Test Target_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.7067, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Avg loss: 1.5497, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 582.2736701965332 sec.
Server Epoch:23 choose agents : [3, 14, 79, 74, 2, 49, 32, 18, 4, 7].
poison local model 3 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Average loss: 0.0763, Accuracy: 246/781 (31.4981%), train_poison_data_count: 253
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Average loss: 0.0403, Accuracy: 226/781 (28.9373%), train_poison_data_count: 253
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   3, Average loss: 0.0310, Accuracy: 278/781 (35.5954%), train_poison_data_count: 253
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   4, Average loss: 0.0304, Accuracy: 275/781 (35.2113%), train_poison_data_count: 253
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   5, Average loss: 0.0294, Accuracy: 277/781 (35.4673%), train_poison_data_count: 253
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   6, Average loss: 0.0301, Accuracy: 270/781 (34.5711%), train_poison_data_count: 253
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   7, Average loss: 0.0294, Accuracy: 284/781 (36.3636%), train_poison_data_count: 253
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   8, Average loss: 0.0286, Accuracy: 287/781 (36.7478%), train_poison_data_count: 253
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   9, Average loss: 0.0290, Accuracy: 282/781 (36.1076%), train_poison_data_count: 253
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch  10, Average loss: 0.0289, Accuracy: 285/781 (36.4917%), train_poison_data_count: 253
Global model norm: 111.99865285880675.
Norm before scaling: 111.98381143467792. Distance: 0.9674126715762577
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.9150, Accuracy: 60/10000 (0.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.8561, Accuracy: 9717/9950 (97.6583%)
Scaling by  100
Scaled Norm after poisoning: 146.54907321226906, distance: 96.74126858210512
Total norm for 4 adversaries is: 146.54907321226906. distance: 96.74126858210512
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   1, Avg loss: 0.0827, Accuracy: 106/1013 (10.4640%)
___Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   2, Avg loss: 0.0367, Accuracy: 317/1013 (31.2932%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.2801, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   1, Avg loss: 0.1504, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   2, Avg loss: 0.1186, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 6.1056, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0552, Accuracy: 366/1552 (23.5825%)
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0199, Accuracy: 805/1552 (51.8686%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 11.9261, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0935, Accuracy: 53/605 (8.7603%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0468, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.4037, Accuracy: 64/10000 (0.6400%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   1, Avg loss: 0.1097, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   2, Avg loss: 0.0583, Accuracy: 80/440 (18.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 12.2245, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   1, Avg loss: 0.0677, Accuracy: 164/735 (22.3129%)
___Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   2, Avg loss: 0.0243, Accuracy: 363/735 (49.3878%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 11.9787, Accuracy: 56/10000 (0.5600%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   1, Avg loss: 0.1050, Accuracy: 2/530 (0.3774%)
___Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   2, Avg loss: 0.0476, Accuracy: 263/530 (49.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.8246, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0838, Accuracy: 200/901 (22.1976%)
___Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0342, Accuracy: 393/901 (43.6182%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.8113, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   1, Avg loss: 0.0744, Accuracy: 201/891 (22.5589%)
___Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   2, Avg loss: 0.0288, Accuracy: 446/891 (50.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.4920, Accuracy: 81/10000 (0.8100%)
time spent on training: 225.6985058784485
___Test Target_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.6883, Accuracy: 75/10000 (0.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Avg loss: 1.1123, Accuracy: 8900/9950 (89.4472%)
saving model
Done in 636.6202685832977 sec.
Server Epoch:24 choose agents : [92, 33, 42, 36, 22, 98, 4, 17, 76, 3].
___Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   1, Avg loss: 0.0655, Accuracy: 332/1715 (19.3586%)
___Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   2, Avg loss: 0.0300, Accuracy: 772/1715 (45.0146%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.2308, Accuracy: 98/10000 (0.9800%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   1, Avg loss: 0.1188, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   2, Avg loss: 0.0593, Accuracy: 96/515 (18.6408%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.6626, Accuracy: 53/10000 (0.5300%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   1, Avg loss: 0.0663, Accuracy: 234/1372 (17.0554%)
___Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 553/1372 (40.3061%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.9437, Accuracy: 90/10000 (0.9000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   1, Avg loss: 0.1225, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   2, Avg loss: 0.0619, Accuracy: 87/408 (21.3235%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.5199, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   1, Avg loss: 0.0552, Accuracy: 417/1470 (28.3673%)
___Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   2, Avg loss: 0.0244, Accuracy: 859/1470 (58.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.4080, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   1, Avg loss: 0.1221, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   2, Avg loss: 0.0653, Accuracy: 64/373 (17.1582%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.5445, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   1, Avg loss: 0.0807, Accuracy: 202/901 (22.4195%)
___Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   2, Avg loss: 0.0349, Accuracy: 402/901 (44.6171%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.5066, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0660, Accuracy: 294/1574 (18.6785%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 686/1574 (43.5832%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.8872, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.1207, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0558, Accuracy: 146/466 (31.3305%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.7251, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0312, Accuracy: 288/781 (36.8758%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0261, Accuracy: 423/781 (54.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.5561, Accuracy: 105/10000 (1.0500%)
time spent on training: 184.7020492553711
___Test Target_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.3123, Accuracy: 84/10000 (0.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Avg loss: 1.2834, Accuracy: 8295/9950 (83.3668%)
saving model
Done in 592.3182687759399 sec.
Server Epoch:25 choose agents : [5, 23, 0, 67, 40, 80, 54, 26, 74, 47].
poison local model 5 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   1, Average loss: 0.0546, Accuracy: 474/1628 (29.1155%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   2, Average loss: 0.0278, Accuracy: 686/1628 (42.1376%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   3, Average loss: 0.0237, Accuracy: 827/1628 (50.7985%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   4, Average loss: 0.0224, Accuracy: 941/1628 (57.8010%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   5, Average loss: 0.0217, Accuracy: 942/1628 (57.8624%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   6, Average loss: 0.0205, Accuracy: 1000/1628 (61.4251%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   7, Average loss: 0.0199, Accuracy: 1055/1628 (64.8034%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   8, Average loss: 0.0191, Accuracy: 1037/1628 (63.6978%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   9, Average loss: 0.0190, Accuracy: 1090/1628 (66.9533%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch  10, Average loss: 0.0194, Accuracy: 1058/1628 (64.9877%), train_poison_data_count: 520
Global model norm: 111.98065018397152.
Norm before scaling: 111.94991817633232. Distance: 1.2598856550890762
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.3662, Accuracy: 133/10000 (1.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.3166, Accuracy: 9639/9950 (96.8744%)
Scaling by  100
Scaled Norm after poisoning: 166.02918253465262, distance: 125.98856362409447
Total norm for 4 adversaries is: 166.02918253465262. distance: 125.98856362409447
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   1, Avg loss: 0.0869, Accuracy: 147/715 (20.5594%)
___Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   2, Avg loss: 0.0427, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 6.5674, Accuracy: 52/10000 (0.5200%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   1, Avg loss: 0.0505, Accuracy: 346/1657 (20.8811%)
___Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   2, Avg loss: 0.0300, Accuracy: 607/1657 (36.6325%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.6633, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   1, Avg loss: 0.1111, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   2, Avg loss: 0.0500, Accuracy: 127/426 (29.8122%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.8385, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   1, Avg loss: 0.0683, Accuracy: 291/1573 (18.4997%)
___Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 627/1573 (39.8601%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.9095, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   1, Avg loss: 0.0906, Accuracy: 28/682 (4.1056%)
___Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   2, Avg loss: 0.0389, Accuracy: 266/682 (39.0029%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.3513, Accuracy: 58/10000 (0.5800%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0685, Accuracy: 226/1130 (20.0000%)
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0280, Accuracy: 498/1130 (44.0708%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 10.4541, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0689, Accuracy: 267/1446 (18.4647%)
___Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 567/1446 (39.2116%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.5576, Accuracy: 84/10000 (0.8400%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0538, Accuracy: 429/1552 (27.6418%)
___Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0202, Accuracy: 818/1552 (52.7062%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 12.0174, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   1, Avg loss: 0.1687, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   2, Avg loss: 0.1467, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.0840, Accuracy: 77/10000 (0.7700%)
time spent on training: 257.3323907852173
___Test Target_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.2884, Accuracy: 140/10000 (1.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.4758, Accuracy: 9066/9950 (91.1156%)
saving model
Done in 667.14714884758 sec.
Server Epoch:26 choose agents : [26, 4, 33, 73, 30, 86, 10, 12, 68, 82].
___Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   1, Avg loss: 0.0767, Accuracy: 227/1446 (15.6985%)
___Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   2, Avg loss: 0.0351, Accuracy: 509/1446 (35.2006%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.8272, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   1, Avg loss: 0.0925, Accuracy: 172/901 (19.0899%)
___Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   2, Avg loss: 0.0372, Accuracy: 373/901 (41.3984%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.6489, Accuracy: 55/10000 (0.5500%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   1, Avg loss: 0.1285, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   2, Avg loss: 0.0631, Accuracy: 88/515 (17.0874%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.4252, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0774, Accuracy: 157/938 (16.7377%)
___Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0363, Accuracy: 341/938 (36.3539%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.6979, Accuracy: 66/10000 (0.6600%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   1, Avg loss: 0.1232, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   2, Avg loss: 0.0484, Accuracy: 166/486 (34.1564%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.8333, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.0882, Accuracy: 196/1003 (19.5414%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0357, Accuracy: 386/1003 (38.4845%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.5170, Accuracy: 57/10000 (0.5700%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   1, Avg loss: 0.0863, Accuracy: 79/861 (9.1754%)
___Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   2, Avg loss: 0.0208, Accuracy: 479/861 (55.6330%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 10.3999, Accuracy: 111/10000 (1.1100%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   1, Avg loss: 0.1443, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   2, Avg loss: 0.0743, Accuracy: 18/338 (5.3254%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.1209, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0839, Accuracy: 214/1163 (18.4007%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0363, Accuracy: 490/1163 (42.1324%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.7676, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.1213, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0585, Accuracy: 113/500 (22.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.0137, Accuracy: 65/10000 (0.6500%)
time spent on training: 178.9280390739441
___Test Target_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.8039, Accuracy: 142/10000 (1.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Avg loss: 0.5689, Accuracy: 8720/9950 (87.6382%)
saving model
Done in 587.7380034923553 sec.
Server Epoch:27 choose agents : [9, 64, 30, 13, 76, 44, 39, 22, 78, 85].
poison local model 9 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Average loss: 0.0606, Accuracy: 358/1275 (28.0784%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Average loss: 0.0193, Accuracy: 727/1275 (57.0196%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   3, Average loss: 0.0154, Accuracy: 861/1275 (67.5294%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   4, Average loss: 0.0144, Accuracy: 924/1275 (72.4706%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   5, Average loss: 0.0146, Accuracy: 933/1275 (73.1765%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   6, Average loss: 0.0139, Accuracy: 925/1275 (72.5490%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   7, Average loss: 0.0138, Accuracy: 929/1275 (72.8627%), train_poison_data_count: 400
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   8, Average loss: 0.0130, Accuracy: 959/1275 (75.2157%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   9, Average loss: 0.0127, Accuracy: 975/1275 (76.4706%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch  10, Average loss: 0.0137, Accuracy: 937/1275 (73.4902%), train_poison_data_count: 400
Global model norm: 111.94634596537755.
Norm before scaling: 111.92299075424584. Distance: 1.2824648703212471
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.0887, Accuracy: 109/10000 (1.0900%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.1106, Accuracy: 9708/9950 (97.5678%)
Scaling by  100
Scaled Norm after poisoning: 168.20211405293037, distance: 128.24647442766215
Total norm for 5 adversaries is: 168.20211405293037. distance: 128.24647442766215
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   1, Avg loss: 0.0855, Accuracy: 76/953 (7.9748%)
___Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   2, Avg loss: 0.0385, Accuracy: 365/953 (38.3001%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.7663, Accuracy: 92/10000 (0.9200%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   1, Avg loss: 0.1159, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   2, Avg loss: 0.0461, Accuracy: 166/486 (34.1564%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.1176, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0701, Accuracy: 254/1645 (15.4407%)
___Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0303, Accuracy: 710/1645 (43.1611%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.5098, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   1, Avg loss: 0.1022, Accuracy: 14/466 (3.0043%)
___Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   2, Avg loss: 0.0559, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.8139, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0720, Accuracy: 263/1750 (15.0286%)
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0344, Accuracy: 748/1750 (42.7429%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.5589, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   1, Avg loss: 0.0783, Accuracy: 153/1013 (15.1037%)
___Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   2, Avg loss: 0.0264, Accuracy: 531/1013 (52.4186%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.5007, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   1, Avg loss: 0.0571, Accuracy: 413/1470 (28.0952%)
___Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 891/1470 (60.6122%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.8249, Accuracy: 111/10000 (1.1100%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   1, Avg loss: 0.1275, Accuracy: 1/416 (0.2404%)
___Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   2, Avg loss: 0.0594, Accuracy: 107/416 (25.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.7000, Accuracy: 87/10000 (0.8700%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0676, Accuracy: 361/1988 (18.1590%)
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0345, Accuracy: 787/1988 (39.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.9173, Accuracy: 83/10000 (0.8300%)
time spent on training: 264.8201184272766
___Test Target_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.0228, Accuracy: 113/10000 (1.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.1836, Accuracy: 9398/9950 (94.4523%)
saving model
Done in 679.4872102737427 sec.
Server Epoch:28 choose agents : [64, 26, 82, 31, 65, 98, 73, 61, 44, 18].
___Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   1, Avg loss: 0.0981, Accuracy: 59/953 (6.1910%)
___Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   2, Avg loss: 0.0396, Accuracy: 347/953 (36.4113%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.7593, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   1, Avg loss: 0.0778, Accuracy: 241/1446 (16.6667%)
___Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 544/1446 (37.6210%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.5528, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.1330, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0616, Accuracy: 109/500 (21.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.1253, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   1, Avg loss: 0.1452, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   2, Avg loss: 0.0509, Accuracy: 122/460 (26.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.4109, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   1, Avg loss: 0.0806, Accuracy: 274/1475 (18.5763%)
___Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 678/1475 (45.9661%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.6036, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.1407, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0747, Accuracy: 38/373 (10.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.3235, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   1, Avg loss: 0.0909, Accuracy: 121/938 (12.8998%)
___Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   2, Avg loss: 0.0351, Accuracy: 351/938 (37.4200%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.5113, Accuracy: 74/10000 (0.7400%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   1, Avg loss: 0.1983, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   2, Avg loss: 0.1827, Accuracy: 4/85 (4.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.7678, Accuracy: 121/10000 (1.2100%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   1, Avg loss: 0.0789, Accuracy: 275/1750 (15.7143%)
___Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   2, Avg loss: 0.0344, Accuracy: 717/1750 (40.9714%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.6272, Accuracy: 126/10000 (1.2600%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   1, Avg loss: 0.1347, Accuracy: 0/530 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   2, Avg loss: 0.0482, Accuracy: 237/530 (44.7170%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.5342, Accuracy: 63/10000 (0.6300%)
time spent on training: 184.82462072372437
___Test Target_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.4396, Accuracy: 113/10000 (1.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Avg loss: 0.3492, Accuracy: 8797/9950 (88.4121%)
saving model
Done in 592.5517570972443 sec.
Server Epoch:29 choose agents : [10, 11, 42, 19, 88, 80, 54, 78, 92, 96].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Average loss: 0.0761, Accuracy: 209/861 (24.2741%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Average loss: 0.0254, Accuracy: 411/861 (47.7352%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Average loss: 0.0179, Accuracy: 548/861 (63.6469%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Average loss: 0.0164, Accuracy: 566/861 (65.7375%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Average loss: 0.0163, Accuracy: 582/861 (67.5958%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Average loss: 0.0157, Accuracy: 586/861 (68.0604%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Average loss: 0.0154, Accuracy: 620/861 (72.0093%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Average loss: 0.0154, Accuracy: 602/861 (69.9187%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Average loss: 0.0147, Accuracy: 621/861 (72.1254%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Average loss: 0.0150, Accuracy: 622/861 (72.2416%), train_poison_data_count: 280
Global model norm: 111.91896395243971.
Norm before scaling: 111.90176879466651. Distance: 1.1280678140195
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.4228, Accuracy: 105/10000 (1.0500%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.2535, Accuracy: 9416/9950 (94.6332%)
Scaling by  100
Scaled Norm after poisoning: 157.28663002421726, distance: 112.80677790197272
Total norm for 4 adversaries is: 157.28663002421726. distance: 112.80677790197272
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0942, Accuracy: 109/712 (15.3090%)
___Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0339, Accuracy: 450/712 (63.2022%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 10.5602, Accuracy: 72/10000 (0.7200%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   1, Avg loss: 0.0753, Accuracy: 191/1372 (13.9213%)
___Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 544/1372 (39.6501%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.7795, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   1, Avg loss: 0.0752, Accuracy: 234/1036 (22.5869%)
___Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   2, Avg loss: 0.0258, Accuracy: 715/1036 (69.0154%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 13.6722, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.1134, Accuracy: 4/603 (0.6633%)
___Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0476, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.0561, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   1, Avg loss: 0.1091, Accuracy: 13/682 (1.9062%)
___Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   2, Avg loss: 0.0403, Accuracy: 247/682 (36.2170%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.1036, Accuracy: 63/10000 (0.6300%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0803, Accuracy: 191/1130 (16.9027%)
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0282, Accuracy: 496/1130 (43.8938%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 10.6245, Accuracy: 53/10000 (0.5300%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.1392, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0634, Accuracy: 84/416 (20.1923%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.2640, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   1, Avg loss: 0.0700, Accuracy: 354/1715 (20.6414%)
___Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   2, Avg loss: 0.0300, Accuracy: 805/1715 (46.9388%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.3006, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.1388, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0883, Accuracy: 12/311 (3.8585%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.7125, Accuracy: 74/10000 (0.7400%)
time spent on training: 237.63580584526062
___Test Target_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.3544, Accuracy: 110/10000 (1.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.3914, Accuracy: 8740/9950 (87.8392%)
saving model
Done in 647.2756431102753 sec.
Server Epoch:30 choose agents : [90, 87, 0, 73, 61, 97, 66, 35, 1, 22].
___Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0880, Accuracy: 113/677 (16.6913%)
___Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 473/677 (69.8671%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 11.8980, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   1, Avg loss: 0.0793, Accuracy: 210/1131 (18.5676%)
___Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   2, Avg loss: 0.0319, Accuracy: 388/1131 (34.3059%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.0205, Accuracy: 62/10000 (0.6200%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0616, Accuracy: 328/1657 (19.7948%)
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0309, Accuracy: 635/1657 (38.3223%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.0712, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   1, Avg loss: 0.0849, Accuracy: 140/938 (14.9254%)
___Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   2, Avg loss: 0.0345, Accuracy: 359/938 (38.2729%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.2727, Accuracy: 78/10000 (0.7800%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   1, Avg loss: 0.2091, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   2, Avg loss: 0.1927, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.9083, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   1, Avg loss: 0.0789, Accuracy: 210/1213 (17.3124%)
___Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 561/1213 (46.2490%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.2530, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0846, Accuracy: 152/1402 (10.8417%)
___Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0383, Accuracy: 417/1402 (29.7432%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.6874, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   1, Avg loss: 0.1539, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   2, Avg loss: 0.0947, Accuracy: 0/271 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 6.6968, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0814, Accuracy: 168/928 (18.1034%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 616/928 (66.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.9385, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   1, Avg loss: 0.0601, Accuracy: 424/1470 (28.8435%)
___Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 934/1470 (63.5374%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.6013, Accuracy: 119/10000 (1.1900%)
time spent on training: 170.835036277771
___Test Target_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.8130, Accuracy: 106/10000 (1.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Avg loss: 0.4726, Accuracy: 8423/9950 (84.6533%)
saving model
Done in 590.9017584323883 sec.
Server Epoch:31 choose agents : [12, 97, 60, 95, 0, 45, 47, 74, 1, 90].
poison local model 12 index 5 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   1, Average loss: 0.0922, Accuracy: 65/338 (19.2308%), train_poison_data_count: 118
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   2, Average loss: 0.0654, Accuracy: 117/338 (34.6154%), train_poison_data_count: 118
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   3, Average loss: 0.0447, Accuracy: 118/338 (34.9112%), train_poison_data_count: 118
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   4, Average loss: 0.0411, Accuracy: 118/338 (34.9112%), train_poison_data_count: 118
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   5, Average loss: 0.0377, Accuracy: 119/338 (35.2071%), train_poison_data_count: 118
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   6, Average loss: 0.0346, Accuracy: 120/338 (35.5030%), train_poison_data_count: 118
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   7, Average loss: 0.0328, Accuracy: 130/338 (38.4615%), train_poison_data_count: 118
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   8, Average loss: 0.0312, Accuracy: 133/338 (39.3491%), train_poison_data_count: 118
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   9, Average loss: 0.0301, Accuracy: 141/338 (41.7160%), train_poison_data_count: 118
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch  10, Average loss: 0.0298, Accuracy: 149/338 (44.0828%), train_poison_data_count: 118
Global model norm: 111.89798559262584.
Norm before scaling: 111.89061081727323. Distance: 0.6336561160549536
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 6.7147, Accuracy: 38/10000 (0.3800%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.1718, Accuracy: 9853/9950 (99.0251%)
Scaling by  100
Scaled Norm after poisoning: 127.79383650410335, distance: 63.36561120666122
Total norm for 5 adversaries is: 127.79383650410335. distance: 63.36561120666122
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0737, Accuracy: 209/1213 (17.2300%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0278, Accuracy: 539/1213 (44.4353%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.9877, Accuracy: 91/10000 (0.9100%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0609, Accuracy: 544/2227 (24.4275%)
___Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0271, Accuracy: 1082/2227 (48.5855%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.3740, Accuracy: 130/10000 (1.3000%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.0898, Accuracy: 103/599 (17.1953%)
___Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0346, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 13.6090, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0594, Accuracy: 305/1657 (18.4068%)
___Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0312, Accuracy: 605/1657 (36.5118%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.0805, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   1, Avg loss: 0.1018, Accuracy: 47/669 (7.0254%)
___Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   2, Avg loss: 0.0450, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.2428, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   1, Avg loss: 0.1872, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   2, Avg loss: 0.1617, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.2569, Accuracy: 102/10000 (1.0200%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   1, Avg loss: 0.0585, Accuracy: 417/1552 (26.8686%)
___Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   2, Avg loss: 0.0199, Accuracy: 791/1552 (50.9665%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 11.2734, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0758, Accuracy: 175/928 (18.8578%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 618/928 (66.5948%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.8634, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   1, Avg loss: 0.0795, Accuracy: 114/677 (16.8390%)
___Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 477/677 (70.4579%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 11.6883, Accuracy: 71/10000 (0.7100%)
time spent on training: 252.80106115341187
___Test Target_ResNet_18 poisoned: False, epoch: 31: Avg loss: 6.5279, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.2462, Accuracy: 9578/9950 (96.2613%)
saving model
Done in 661.5289516448975 sec.
Server Epoch:32 choose agents : [90, 32, 84, 98, 78, 46, 40, 68, 29, 95].
___Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0632, Accuracy: 160/677 (23.6337%)
___Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0205, Accuracy: 468/677 (69.1285%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 11.6011, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0545, Accuracy: 169/735 (22.9932%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 379/735 (51.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 10.4318, Accuracy: 63/10000 (0.6300%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0726, Accuracy: 230/1190 (19.3277%)
___Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0308, Accuracy: 494/1190 (41.5126%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.8567, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   1, Avg loss: 0.0948, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   2, Avg loss: 0.0526, Accuracy: 75/373 (20.1072%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.9240, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   1, Avg loss: 0.1050, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   2, Avg loss: 0.0530, Accuracy: 142/416 (34.1346%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.1837, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0603, Accuracy: 370/1904 (19.4328%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0295, Accuracy: 755/1904 (39.6534%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.2028, Accuracy: 145/10000 (1.4500%)
___Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   1, Avg loss: 0.0648, Accuracy: 301/1573 (19.1354%)
___Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   2, Avg loss: 0.0342, Accuracy: 649/1573 (41.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.6349, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   1, Avg loss: 0.0702, Accuracy: 248/1163 (21.3242%)
___Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   2, Avg loss: 0.0358, Accuracy: 511/1163 (43.9381%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.4038, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   1, Avg loss: 0.0545, Accuracy: 360/1440 (25.0000%)
___Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   2, Avg loss: 0.0271, Accuracy: 692/1440 (48.0556%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.5199, Accuracy: 83/10000 (0.8300%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0694, Accuracy: 164/599 (27.3790%)
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0311, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 12.7756, Accuracy: 50/10000 (0.5000%)
time spent on training: 184.28318881988525
___Test Target_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.2737, Accuracy: 39/10000 (0.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Avg loss: 0.3403, Accuracy: 9411/9950 (94.5829%)
saving model
Done in 595.6899881362915 sec.
Server Epoch:33 choose agents : [15, 44, 14, 40, 61, 33, 88, 73, 21, 30].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Average loss: 0.0564, Accuracy: 424/1154 (36.7418%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Average loss: 0.0272, Accuracy: 560/1154 (48.5269%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Average loss: 0.0212, Accuracy: 636/1154 (55.1127%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Average loss: 0.0206, Accuracy: 686/1154 (59.4454%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Average loss: 0.0203, Accuracy: 684/1154 (59.2721%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Average loss: 0.0200, Accuracy: 703/1154 (60.9185%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Average loss: 0.0200, Accuracy: 697/1154 (60.3986%), train_poison_data_count: 362
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Average loss: 0.0193, Accuracy: 702/1154 (60.8319%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Average loss: 0.0190, Accuracy: 704/1154 (61.0052%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Average loss: 0.0190, Accuracy: 707/1154 (61.2652%), train_poison_data_count: 362
Global model norm: 111.88699743630848.
Norm before scaling: 111.86784194977572. Distance: 1.1291528452253725
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.9988, Accuracy: 75/10000 (0.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.6929, Accuracy: 7376/9950 (74.1307%)
Scaling by  100
Scaled Norm after poisoning: 157.2017761906652, distance: 112.91527953099394
Total norm for 5 adversaries is: 157.2017761906652. distance: 112.91527953099394
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Avg loss: 0.0634, Accuracy: 313/1750 (17.8857%)
___Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Avg loss: 0.0346, Accuracy: 747/1750 (42.6857%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.5563, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0744, Accuracy: 107/1013 (10.5627%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 371/1013 (36.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.0442, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   1, Avg loss: 0.0621, Accuracy: 306/1573 (19.4533%)
___Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   2, Avg loss: 0.0336, Accuracy: 646/1573 (41.0680%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.5698, Accuracy: 94/10000 (0.9400%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   1, Avg loss: 0.1178, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   2, Avg loss: 0.1155, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 6.2405, Accuracy: 50/10000 (0.5000%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   1, Avg loss: 0.0900, Accuracy: 44/515 (8.5437%)
___Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   2, Avg loss: 0.0523, Accuracy: 140/515 (27.1845%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 6.9019, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   1, Avg loss: 0.0826, Accuracy: 41/603 (6.7993%)
___Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   2, Avg loss: 0.0432, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.7817, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   1, Avg loss: 0.0671, Accuracy: 179/938 (19.0832%)
___Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   2, Avg loss: 0.0327, Accuracy: 388/938 (41.3646%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.2887, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   1, Avg loss: 0.0567, Accuracy: 325/1949 (16.6752%)
___Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   2, Avg loss: 0.0316, Accuracy: 685/1949 (35.1462%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.6387, Accuracy: 109/10000 (1.0900%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   1, Avg loss: 0.0921, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   2, Avg loss: 0.0407, Accuracy: 203/486 (41.7695%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.1356, Accuracy: 59/10000 (0.5900%)
time spent on training: 266.323522567749
___Test Target_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.9404, Accuracy: 80/10000 (0.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.9500, Accuracy: 6325/9950 (63.5678%)
saving model
Done in 677.5397002696991 sec.
Server Epoch:34 choose agents : [0, 71, 20, 83, 56, 36, 68, 89, 82, 19].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   1, Avg loss: 0.0639, Accuracy: 283/1657 (17.0791%)
___Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   2, Avg loss: 0.0310, Accuracy: 624/1657 (37.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.2930, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0942, Accuracy: 40/818 (4.8900%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0315, Accuracy: 392/818 (47.9218%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.9980, Accuracy: 84/10000 (0.8400%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   1, Avg loss: 0.0899, Accuracy: 126/807 (15.6134%)
___Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   2, Avg loss: 0.0369, Accuracy: 429/807 (53.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.0667, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0680, Accuracy: 341/1953 (17.4603%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0318, Accuracy: 890/1953 (45.5709%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.6084, Accuracy: 145/10000 (1.4500%)
___Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   1, Avg loss: 0.1385, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   2, Avg loss: 0.1150, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.1108, Accuracy: 96/10000 (0.9600%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   1, Avg loss: 0.1333, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   2, Avg loss: 0.0672, Accuracy: 67/408 (16.4216%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.2461, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   1, Avg loss: 0.0832, Accuracy: 207/1163 (17.7988%)
___Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 461/1163 (39.6389%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.5665, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   1, Avg loss: 0.0894, Accuracy: 161/896 (17.9688%)
___Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   2, Avg loss: 0.0380, Accuracy: 449/896 (50.1116%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.5520, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.1167, Accuracy: 1/500 (0.2000%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0567, Accuracy: 115/500 (23.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.7114, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   1, Avg loss: 0.0712, Accuracy: 230/1036 (22.2008%)
___Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   2, Avg loss: 0.0251, Accuracy: 715/1036 (69.0154%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 13.6921, Accuracy: 81/10000 (0.8100%)
time spent on training: 184.92676496505737
___Test Target_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.4675, Accuracy: 94/10000 (0.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Avg loss: 1.2367, Accuracy: 5758/9950 (57.8693%)
saving model
Done in 601.541152715683 sec.
Server Epoch:35 choose agents : [18, 75, 5, 22, 38, 73, 46, 20, 83, 88].
poison local model 18 index 7 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   1, Average loss: 0.0701, Accuracy: 146/530 (27.5472%), train_poison_data_count: 178
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   2, Average loss: 0.0396, Accuracy: 289/530 (54.5283%), train_poison_data_count: 178
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   3, Average loss: 0.0302, Accuracy: 304/530 (57.3585%), train_poison_data_count: 178
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   4, Average loss: 0.0289, Accuracy: 308/530 (58.1132%), train_poison_data_count: 178
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   5, Average loss: 0.0270, Accuracy: 322/530 (60.7547%), train_poison_data_count: 178
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   6, Average loss: 0.0263, Accuracy: 346/530 (65.2830%), train_poison_data_count: 178
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   7, Average loss: 0.0252, Accuracy: 355/530 (66.9811%), train_poison_data_count: 178
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   8, Average loss: 0.0242, Accuracy: 356/530 (67.1698%), train_poison_data_count: 178
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   9, Average loss: 0.0232, Accuracy: 366/530 (69.0566%), train_poison_data_count: 178
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch  10, Average loss: 0.0232, Accuracy: 371/530 (70.0000%), train_poison_data_count: 178
Global model norm: 111.86431513221721.
Norm before scaling: 111.85394791451262. Distance: 0.7340069518136879
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.1748, Accuracy: 68/10000 (0.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.3641, Accuracy: 8874/9950 (89.1859%)
Scaling by  100
Scaled Norm after poisoning: 132.7245076158695, distance: 73.40069223851877
Total norm for 3 adversaries is: 132.7245076158695. distance: 73.40069223851877
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   1, Avg loss: 0.0933, Accuracy: 96/776 (12.3711%)
___Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   2, Avg loss: 0.0345, Accuracy: 407/776 (52.4485%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.1991, Accuracy: 84/10000 (0.8400%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   1, Avg loss: 0.0519, Accuracy: 465/1628 (28.5627%)
___Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   2, Avg loss: 0.0200, Accuracy: 1031/1628 (63.3292%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.6935, Accuracy: 173/10000 (1.7300%)
___Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   1, Avg loss: 0.0564, Accuracy: 432/1470 (29.3878%)
___Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 958/1470 (65.1701%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.2559, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   1, Avg loss: 0.0771, Accuracy: 197/1131 (17.4182%)
___Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   2, Avg loss: 0.0308, Accuracy: 531/1131 (46.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.3258, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   1, Avg loss: 0.0750, Accuracy: 150/938 (15.9915%)
___Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 367/938 (39.1258%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.6162, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   1, Avg loss: 0.0659, Accuracy: 320/1904 (16.8067%)
___Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   2, Avg loss: 0.0296, Accuracy: 785/1904 (41.2290%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.1936, Accuracy: 122/10000 (1.2200%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   1, Avg loss: 0.0861, Accuracy: 122/807 (15.1177%)
___Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   2, Avg loss: 0.0358, Accuracy: 410/807 (50.8055%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.9066, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   1, Avg loss: 0.0648, Accuracy: 351/1953 (17.9724%)
___Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   2, Avg loss: 0.0321, Accuracy: 880/1953 (45.0589%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.5922, Accuracy: 148/10000 (1.4800%)
___Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   1, Avg loss: 0.1018, Accuracy: 6/603 (0.9950%)
___Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   2, Avg loss: 0.0472, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.8214, Accuracy: 60/10000 (0.6000%)
time spent on training: 250.07088780403137
___Test Target_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.0733, Accuracy: 69/10000 (0.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.5212, Accuracy: 7847/9950 (78.8643%)
saving model
Done in 658.4397637844086 sec.
Server Epoch:36 choose agents : [19, 2, 97, 73, 5, 51, 21, 63, 11, 90].
___Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   1, Avg loss: 0.0638, Accuracy: 267/1036 (25.7722%)
___Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   2, Avg loss: 0.0253, Accuracy: 701/1036 (67.6641%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 12.1578, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0957, Accuracy: 37/605 (6.1157%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0453, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.4036, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   1, Avg loss: 0.0579, Accuracy: 317/1213 (26.1336%)
___Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   2, Avg loss: 0.0265, Accuracy: 530/1213 (43.6933%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.2100, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   1, Avg loss: 0.0712, Accuracy: 155/938 (16.5245%)
___Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   2, Avg loss: 0.0324, Accuracy: 400/938 (42.6439%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.6600, Accuracy: 67/10000 (0.6700%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   1, Avg loss: 0.0495, Accuracy: 507/1628 (31.1425%)
___Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   2, Avg loss: 0.0200, Accuracy: 1050/1628 (64.4963%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.1813, Accuracy: 177/10000 (1.7700%)
___Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0745, Accuracy: 148/1049 (14.1087%)
___Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0290, Accuracy: 533/1049 (50.8103%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.6917, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   1, Avg loss: 0.0613, Accuracy: 338/1949 (17.3422%)
___Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   2, Avg loss: 0.0318, Accuracy: 684/1949 (35.0949%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.5710, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   1, Avg loss: 0.0777, Accuracy: 125/888 (14.0766%)
___Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 427/888 (48.0856%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.8733, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0818, Accuracy: 127/712 (17.8371%)
___Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0286, Accuracy: 452/712 (63.4831%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.2406, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   1, Avg loss: 0.0697, Accuracy: 139/677 (20.5318%)
___Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   2, Avg loss: 0.0208, Accuracy: 466/677 (68.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 11.0434, Accuracy: 67/10000 (0.6700%)
time spent on training: 174.41879200935364
___Test Target_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.5989, Accuracy: 72/10000 (0.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Avg loss: 0.7208, Accuracy: 7209/9950 (72.4523%)
saving model
Done in 589.1367547512054 sec.
Server Epoch:37 choose agents : [20, 66, 18, 64, 77, 51, 65, 3, 17, 50].
poison local model 20 index 8 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   1, Average loss: 0.0597, Accuracy: 265/807 (32.8377%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   2, Average loss: 0.0298, Accuracy: 466/807 (57.7447%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   3, Average loss: 0.0231, Accuracy: 507/807 (62.8253%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   4, Average loss: 0.0209, Accuracy: 530/807 (65.6753%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   5, Average loss: 0.0209, Accuracy: 521/807 (64.5601%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   6, Average loss: 0.0209, Accuracy: 522/807 (64.6840%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   7, Average loss: 0.0203, Accuracy: 521/807 (64.5601%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   8, Average loss: 0.0202, Accuracy: 529/807 (65.5514%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   9, Average loss: 0.0189, Accuracy: 548/807 (67.9058%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch  10, Average loss: 0.0195, Accuracy: 531/807 (65.7993%), train_poison_data_count: 260
Global model norm: 111.84979202735471.
Norm before scaling: 111.8360179990105. Distance: 0.8804984357647754
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.0280, Accuracy: 60/10000 (0.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.4961, Accuracy: 8611/9950 (86.5427%)
Scaling by  100
Scaled Norm after poisoning: 140.98755347325877, distance: 88.04984605679331
Total norm for 4 adversaries is: 140.98755347325877. distance: 88.04984605679331
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   1, Avg loss: 0.0705, Accuracy: 224/1402 (15.9772%)
___Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   2, Avg loss: 0.0381, Accuracy: 431/1402 (30.7418%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.8116, Accuracy: 72/10000 (0.7200%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   1, Avg loss: 0.0335, Accuracy: 302/530 (56.9811%)
___Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   2, Avg loss: 0.0277, Accuracy: 357/530 (67.3585%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.3500, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   1, Avg loss: 0.0756, Accuracy: 107/953 (11.2277%)
___Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   2, Avg loss: 0.0388, Accuracy: 347/953 (36.4113%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.5085, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0654, Accuracy: 227/1340 (16.9403%)
___Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 590/1340 (44.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.1472, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0709, Accuracy: 149/1049 (14.2040%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0279, Accuracy: 541/1049 (51.5729%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.5000, Accuracy: 128/10000 (1.2800%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   1, Avg loss: 0.0668, Accuracy: 286/1475 (19.3898%)
___Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   2, Avg loss: 0.0309, Accuracy: 667/1475 (45.2203%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.5116, Accuracy: 105/10000 (1.0500%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   1, Avg loss: 0.0802, Accuracy: 38/781 (4.8656%)
___Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   2, Avg loss: 0.0320, Accuracy: 288/781 (36.8758%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.7852, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   1, Avg loss: 0.0610, Accuracy: 316/1574 (20.0762%)
___Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   2, Avg loss: 0.0262, Accuracy: 736/1574 (46.7598%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.5945, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   1, Avg loss: 0.0820, Accuracy: 54/809 (6.6749%)
___Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 378/809 (46.7244%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.5086, Accuracy: 117/10000 (1.1700%)
time spent on training: 259.19993901252747
___Test Target_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.8881, Accuracy: 59/10000 (0.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.8512, Accuracy: 6745/9950 (67.7889%)
saving model
Done in 670.0921101570129 sec.
Server Epoch:38 choose agents : [88, 72, 77, 38, 20, 39, 70, 1, 37, 6].
___Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0936, Accuracy: 20/603 (3.3167%)
___Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.5562, Accuracy: 66/10000 (0.6600%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0712, Accuracy: 202/1241 (16.2772%)
___Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0360, Accuracy: 514/1241 (41.4182%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.7476, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0676, Accuracy: 233/1340 (17.3881%)
___Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 591/1340 (44.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.1644, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0754, Accuracy: 152/1131 (13.4394%)
___Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0293, Accuracy: 546/1131 (48.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.2037, Accuracy: 105/10000 (1.0500%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0262, Accuracy: 432/807 (53.5316%)
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0204, Accuracy: 509/807 (63.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.7067, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0621, Accuracy: 189/1013 (18.6575%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0238, Accuracy: 529/1013 (52.2211%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.1872, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0703, Accuracy: 280/1418 (19.7461%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0294, Accuracy: 713/1418 (50.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.1349, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0716, Accuracy: 193/928 (20.7974%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0257, Accuracy: 569/928 (61.3147%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.4289, Accuracy: 105/10000 (1.0500%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0663, Accuracy: 286/1129 (25.3322%)
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0232, Accuracy: 775/1129 (68.6448%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.6419, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   1, Avg loss: 0.0595, Accuracy: 359/1956 (18.3538%)
___Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   2, Avg loss: 0.0302, Accuracy: 750/1956 (38.3436%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.1190, Accuracy: 129/10000 (1.2900%)
time spent on training: 202.39927315711975
___Test Target_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.5190, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Avg loss: 1.1980, Accuracy: 5914/9950 (59.4372%)
saving model
Done in 613.497074842453 sec.
Server Epoch:39 choose agents : [24, 58, 63, 88, 9, 51, 54, 64, 13, 27].
poison local model 24 index 9 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   1, Average loss: 0.0758, Accuracy: 63/312 (20.1923%), train_poison_data_count: 100
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   2, Average loss: 0.0521, Accuracy: 92/312 (29.4872%), train_poison_data_count: 100
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   3, Average loss: 0.0331, Accuracy: 155/312 (49.6795%), train_poison_data_count: 100
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   4, Average loss: 0.0309, Accuracy: 179/312 (57.3718%), train_poison_data_count: 100
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   5, Average loss: 0.0275, Accuracy: 197/312 (63.1410%), train_poison_data_count: 100
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   6, Average loss: 0.0264, Accuracy: 199/312 (63.7821%), train_poison_data_count: 100
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   7, Average loss: 0.0245, Accuracy: 193/312 (61.8590%), train_poison_data_count: 100
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   8, Average loss: 0.0234, Accuracy: 208/312 (66.6667%), train_poison_data_count: 100
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   9, Average loss: 0.0227, Accuracy: 210/312 (67.3077%), train_poison_data_count: 100
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch  10, Average loss: 0.0245, Accuracy: 201/312 (64.4231%), train_poison_data_count: 100
Global model norm: 111.83218891071792.
Norm before scaling: 111.82804094764202. Distance: 0.5408744490100301
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 6.8775, Accuracy: 64/10000 (0.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: 0.2728, Accuracy: 9135/9950 (91.8090%)
Scaling by  100
Scaled Norm after poisoning: 123.73282314502283, distance: 54.08744682730804
Total norm for 3 adversaries is: 123.73282314502283. distance: 54.08744682730804
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0696, Accuracy: 204/803 (25.4047%)
___Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0362, Accuracy: 427/803 (53.1756%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 6.9996, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0723, Accuracy: 132/888 (14.8649%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 463/888 (52.1396%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 9.9141, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   1, Avg loss: 0.0873, Accuracy: 39/603 (6.4677%)
___Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   2, Avg loss: 0.0446, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.5659, Accuracy: 69/10000 (0.6900%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0484, Accuracy: 386/1275 (30.2745%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0149, Accuracy: 880/1275 (69.0196%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 11.0740, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0702, Accuracy: 170/1049 (16.2059%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0280, Accuracy: 552/1049 (52.6215%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.5128, Accuracy: 138/10000 (1.3800%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   1, Avg loss: 0.0654, Accuracy: 231/1130 (20.4425%)
___Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   2, Avg loss: 0.0279, Accuracy: 499/1130 (44.1593%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 9.2548, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   1, Avg loss: 0.0762, Accuracy: 102/953 (10.7030%)
___Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   2, Avg loss: 0.0383, Accuracy: 345/953 (36.2015%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.4321, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   1, Avg loss: 0.0642, Accuracy: 295/1645 (17.9331%)
___Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   2, Avg loss: 0.0308, Accuracy: 739/1645 (44.9240%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.0676, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0621, Accuracy: 325/1587 (20.4789%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 629/1587 (39.6345%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.6626, Accuracy: 71/10000 (0.7100%)
time spent on training: 241.16649103164673
___Test Target_ResNet_18 poisoned: False, epoch: 39: Avg loss: 6.7266, Accuracy: 71/10000 (0.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Avg loss: 0.4271, Accuracy: 8295/9950 (83.3668%)
saving model
Done in 649.6999659538269 sec.
Server Epoch:40 choose agents : [40, 88, 66, 47, 61, 96, 3, 5, 16, 24].
___Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   1, Avg loss: 0.0649, Accuracy: 307/1573 (19.5168%)
___Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   2, Avg loss: 0.0341, Accuracy: 645/1573 (41.0045%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.6363, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   1, Avg loss: 0.0858, Accuracy: 38/603 (6.3018%)
___Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.6155, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   1, Avg loss: 0.0698, Accuracy: 233/1402 (16.6191%)
___Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   2, Avg loss: 0.0381, Accuracy: 448/1402 (31.9544%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.5263, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1629, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1399, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.9544, Accuracy: 68/10000 (0.6800%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   1, Avg loss: 0.1587, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   2, Avg loss: 0.1445, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.2400, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   1, Avg loss: 0.1095, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   2, Avg loss: 0.0701, Accuracy: 39/311 (12.5402%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.9852, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   1, Avg loss: 0.0794, Accuracy: 38/781 (4.8656%)
___Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   2, Avg loss: 0.0322, Accuracy: 294/781 (37.6440%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.2243, Accuracy: 105/10000 (1.0500%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   1, Avg loss: 0.0452, Accuracy: 527/1628 (32.3710%)
___Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   2, Avg loss: 0.0200, Accuracy: 1023/1628 (62.8378%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.1064, Accuracy: 176/10000 (1.7600%)
___Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   1, Avg loss: 0.0719, Accuracy: 145/708 (20.4802%)
___Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   2, Avg loss: 0.0375, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.4951, Accuracy: 56/10000 (0.5600%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   1, Avg loss: 0.0288, Accuracy: 193/312 (61.8590%)
___Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   2, Avg loss: 0.0241, Accuracy: 220/312 (70.5128%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.6001, Accuracy: 74/10000 (0.7400%)
time spent on training: 190.70649790763855
___Test Target_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.4160, Accuracy: 70/10000 (0.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Avg loss: 0.5840, Accuracy: 7777/9950 (78.1608%)
saving model
Saving model on epoch 40
Done in 596.6125123500824 sec.
Server Epoch:41 choose agents : [25, 36, 82, 2, 93, 42, 66, 94, 44, 38].
poison local model 25 index 10 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Average loss: 0.0601, Accuracy: 227/690 (32.8986%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Average loss: 0.0271, Accuracy: 442/690 (64.0580%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   3, Average loss: 0.0181, Accuracy: 488/690 (70.7246%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   4, Average loss: 0.0164, Accuracy: 503/690 (72.8986%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   5, Average loss: 0.0160, Accuracy: 490/690 (71.0145%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   6, Average loss: 0.0143, Accuracy: 507/690 (73.4783%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   7, Average loss: 0.0151, Accuracy: 508/690 (73.6232%), train_poison_data_count: 220
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   8, Average loss: 0.0142, Accuracy: 517/690 (74.9275%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   9, Average loss: 0.0143, Accuracy: 513/690 (74.3478%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch  10, Average loss: 0.0141, Accuracy: 518/690 (75.0725%), train_poison_data_count: 220
Global model norm: 111.8250805178002.
Norm before scaling: 111.81388868617798. Distance: 0.7974291352025338
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.3821, Accuracy: 59/10000 (0.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.4022, Accuracy: 8434/9950 (84.7638%)
Scaling by  100
Scaled Norm after poisoning: 136.19811225288697, distance: 79.74291271897616
Total norm for 4 adversaries is: 136.19811225288697. distance: 79.74291271897616
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   1, Avg loss: 0.1037, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   2, Avg loss: 0.0548, Accuracy: 95/408 (23.2843%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.8841, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   1, Avg loss: 0.0943, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   2, Avg loss: 0.0521, Accuracy: 178/500 (35.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.3508, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0865, Accuracy: 48/605 (7.9339%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0442, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.0871, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   1, Avg loss: 0.0617, Accuracy: 334/1742 (19.1734%)
___Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   2, Avg loss: 0.0305, Accuracy: 764/1742 (43.8576%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.1953, Accuracy: 90/10000 (0.9000%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   1, Avg loss: 0.0637, Accuracy: 240/1372 (17.4927%)
___Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   2, Avg loss: 0.0305, Accuracy: 592/1372 (43.1487%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.4109, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0691, Accuracy: 231/1402 (16.4765%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0375, Accuracy: 467/1402 (33.3096%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.5638, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   1, Avg loss: 0.0616, Accuracy: 324/1662 (19.4946%)
___Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   2, Avg loss: 0.0310, Accuracy: 714/1662 (42.9603%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.9766, Accuracy: 127/10000 (1.2700%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0644, Accuracy: 301/1750 (17.2000%)
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0346, Accuracy: 730/1750 (41.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.5468, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0683, Accuracy: 198/1131 (17.5066%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0293, Accuracy: 548/1131 (48.4527%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.4329, Accuracy: 113/10000 (1.1300%)
time spent on training: 265.58604288101196
___Test Target_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.2557, Accuracy: 63/10000 (0.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.6980, Accuracy: 6959/9950 (69.9397%)
saving model
Saving model on epoch 41
Done in 678.4840190410614 sec.
Server Epoch:42 choose agents : [55, 57, 12, 67, 31, 76, 26, 6, 64, 97].
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   1, Avg loss: 0.0745, Accuracy: 162/1071 (15.1261%)
___Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   2, Avg loss: 0.0282, Accuracy: 528/1071 (49.2997%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.1995, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   1, Avg loss: 0.0712, Accuracy: 187/1154 (16.2045%)
___Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   2, Avg loss: 0.0256, Accuracy: 511/1154 (44.2808%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 10.6093, Accuracy: 62/10000 (0.6200%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   1, Avg loss: 0.1167, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   2, Avg loss: 0.0534, Accuracy: 56/338 (16.5680%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.7094, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.1090, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0468, Accuracy: 105/426 (24.6479%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.3449, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.1191, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0465, Accuracy: 141/460 (30.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.3914, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   1, Avg loss: 0.1087, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   2, Avg loss: 0.0508, Accuracy: 169/466 (36.2661%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.2066, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   1, Avg loss: 0.0680, Accuracy: 241/1446 (16.6667%)
___Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   2, Avg loss: 0.0342, Accuracy: 548/1446 (37.8976%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.6546, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   1, Avg loss: 0.0615, Accuracy: 339/1956 (17.3313%)
___Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   2, Avg loss: 0.0307, Accuracy: 749/1956 (38.2924%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.0478, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0812, Accuracy: 89/953 (9.3389%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0388, Accuracy: 335/953 (35.1522%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.2167, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   1, Avg loss: 0.0661, Accuracy: 229/1213 (18.8788%)
___Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 589/1213 (48.5573%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.8118, Accuracy: 87/10000 (0.8700%)
time spent on training: 184.61652874946594
___Test Target_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.7369, Accuracy: 68/10000 (0.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Avg loss: 0.9713, Accuracy: 6360/9950 (63.9196%)
saving model
Saving model on epoch 42
Done in 589.4161112308502 sec.
Server Epoch:43 choose agents : [30, 89, 47, 67, 72, 23, 57, 51, 45, 60].
poison local model 30 index 11 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Average loss: 0.0737, Accuracy: 119/486 (24.4856%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Average loss: 0.0405, Accuracy: 205/486 (42.1811%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   3, Average loss: 0.0317, Accuracy: 225/486 (46.2963%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   4, Average loss: 0.0297, Accuracy: 234/486 (48.1481%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   5, Average loss: 0.0292, Accuracy: 259/486 (53.2922%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   6, Average loss: 0.0271, Accuracy: 272/486 (55.9671%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   7, Average loss: 0.0262, Accuracy: 288/486 (59.2593%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   8, Average loss: 0.0280, Accuracy: 285/486 (58.6420%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   9, Average loss: 0.0265, Accuracy: 286/486 (58.8477%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch  10, Average loss: 0.0250, Accuracy: 295/486 (60.6996%), train_poison_data_count: 160
Global model norm: 111.81022915525216.
Norm before scaling: 111.8023026722281. Distance: 0.707780262126618
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.8737, Accuracy: 63/10000 (0.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.2354, Accuracy: 9121/9950 (91.6683%)
Scaling by  100
Scaled Norm after poisoning: 131.46743150634305, distance: 70.77802144954676
Total norm for 3 adversaries is: 131.46743150634305. distance: 70.77802144954676
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0773, Accuracy: 193/896 (21.5402%)
___Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0346, Accuracy: 477/896 (53.2366%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.1263, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   1, Avg loss: 0.1685, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   2, Avg loss: 0.1413, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.0051, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   1, Avg loss: 0.0999, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   2, Avg loss: 0.0453, Accuracy: 115/426 (26.9953%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.3302, Accuracy: 51/10000 (0.5100%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   1, Avg loss: 0.0701, Accuracy: 212/1241 (17.0830%)
___Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   2, Avg loss: 0.0350, Accuracy: 501/1241 (40.3707%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.9890, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   1, Avg loss: 0.0826, Accuracy: 128/715 (17.9021%)
___Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   2, Avg loss: 0.0424, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.6082, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   1, Avg loss: 0.0655, Accuracy: 200/1154 (17.3310%)
___Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   2, Avg loss: 0.0266, Accuracy: 530/1154 (45.9272%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 10.1768, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   1, Avg loss: 0.0707, Accuracy: 176/1049 (16.7779%)
___Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   2, Avg loss: 0.0274, Accuracy: 562/1049 (53.5748%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.4973, Accuracy: 135/10000 (1.3500%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0906, Accuracy: 61/669 (9.1181%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0427, Accuracy: 359/669 (53.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.0283, Accuracy: 82/10000 (0.8200%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   1, Avg loss: 0.0560, Accuracy: 574/2227 (25.7746%)
___Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   2, Avg loss: 0.0274, Accuracy: 1080/2227 (48.4957%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.0205, Accuracy: 142/10000 (1.4200%)
time spent on training: 237.5657250881195
___Test Target_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.7896, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.3633, Accuracy: 8469/9950 (85.1156%)
saving model
Done in 658.8183243274689 sec.
Server Epoch:44 choose agents : [20, 45, 15, 72, 6, 60, 59, 46, 31, 84].
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0560, Accuracy: 194/807 (24.0397%)
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0259, Accuracy: 460/807 (57.0012%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.8025, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   1, Avg loss: 0.0845, Accuracy: 73/669 (10.9118%)
___Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   2, Avg loss: 0.0412, Accuracy: 355/669 (53.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.5909, Accuracy: 76/10000 (0.7600%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0563, Accuracy: 262/1154 (22.7036%)
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0275, Accuracy: 507/1154 (43.9341%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.2981, Accuracy: 88/10000 (0.8800%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   1, Avg loss: 0.0688, Accuracy: 202/1241 (16.2772%)
___Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   2, Avg loss: 0.0357, Accuracy: 466/1241 (37.5504%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.9822, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   1, Avg loss: 0.0575, Accuracy: 369/1956 (18.8650%)
___Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   2, Avg loss: 0.0302, Accuracy: 755/1956 (38.5992%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.9666, Accuracy: 122/10000 (1.2200%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   1, Avg loss: 0.0551, Accuracy: 560/2227 (25.1459%)
___Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   2, Avg loss: 0.0274, Accuracy: 1093/2227 (49.0795%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.2078, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   1, Avg loss: 0.0682, Accuracy: 193/1089 (17.7227%)
___Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   2, Avg loss: 0.0267, Accuracy: 616/1089 (56.5657%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.7561, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   1, Avg loss: 0.0605, Accuracy: 345/1904 (18.1197%)
___Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   2, Avg loss: 0.0296, Accuracy: 792/1904 (41.5966%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.2236, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.1106, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0445, Accuracy: 156/460 (33.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.5657, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   1, Avg loss: 0.0764, Accuracy: 213/1190 (17.8992%)
___Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   2, Avg loss: 0.0313, Accuracy: 496/1190 (41.6807%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.7996, Accuracy: 95/10000 (0.9500%)
time spent on training: 242.44012451171875
___Test Target_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.3940, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Avg loss: 0.4987, Accuracy: 8116/9950 (81.5678%)
saving model
Done in 651.4033246040344 sec.
Server Epoch:45 choose agents : [33, 77, 72, 6, 23, 47, 93, 87, 53, 86].
poison local model 33 index 12 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   1, Average loss: 0.0748, Accuracy: 93/515 (18.0583%), train_poison_data_count: 163
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   2, Average loss: 0.0537, Accuracy: 163/515 (31.6505%), train_poison_data_count: 163
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   3, Average loss: 0.0423, Accuracy: 177/515 (34.3689%), train_poison_data_count: 163
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   4, Average loss: 0.0395, Accuracy: 192/515 (37.2816%), train_poison_data_count: 163
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   5, Average loss: 0.0401, Accuracy: 188/515 (36.5049%), train_poison_data_count: 163
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   6, Average loss: 0.0396, Accuracy: 189/515 (36.6990%), train_poison_data_count: 163
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   7, Average loss: 0.0385, Accuracy: 187/515 (36.3107%), train_poison_data_count: 163
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   8, Average loss: 0.0383, Accuracy: 197/515 (38.2524%), train_poison_data_count: 163
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   9, Average loss: 0.0373, Accuracy: 207/515 (40.1942%), train_poison_data_count: 163
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch  10, Average loss: 0.0374, Accuracy: 202/515 (39.2233%), train_poison_data_count: 163
Global model norm: 111.79854667687992.
Norm before scaling: 111.78991614435758. Distance: 0.7138270668204807
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.5448, Accuracy: 71/10000 (0.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.2208, Accuracy: 9900/9950 (99.4975%)
Scaling by  100
Scaled Norm after poisoning: 131.72147461594864, distance: 71.38270604744716
Total norm for 2 adversaries is: 131.72147461594864. distance: 71.38270604744716
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   1, Avg loss: 0.0595, Accuracy: 246/1340 (18.3582%)
___Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   2, Avg loss: 0.0264, Accuracy: 603/1340 (45.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.9268, Accuracy: 87/10000 (0.8700%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   1, Avg loss: 0.0665, Accuracy: 225/1241 (18.1305%)
___Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   2, Avg loss: 0.0346, Accuracy: 512/1241 (41.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.9411, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   1, Avg loss: 0.0566, Accuracy: 355/1956 (18.1493%)
___Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   2, Avg loss: 0.0298, Accuracy: 768/1956 (39.2638%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.9227, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   1, Avg loss: 0.0785, Accuracy: 143/715 (20.0000%)
___Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   2, Avg loss: 0.0420, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.6475, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   1, Avg loss: 0.1543, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   2, Avg loss: 0.1356, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.8770, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0633, Accuracy: 315/1742 (18.0827%)
___Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0303, Accuracy: 761/1742 (43.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.0478, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   1, Avg loss: 0.0682, Accuracy: 194/1131 (17.1530%)
___Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   2, Avg loss: 0.0305, Accuracy: 427/1131 (37.7542%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.3696, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   1, Avg loss: 0.0669, Accuracy: 165/813 (20.2952%)
___Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 501/813 (61.6236%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 12.6510, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0740, Accuracy: 209/1003 (20.8375%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0353, Accuracy: 389/1003 (38.7836%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.3513, Accuracy: 63/10000 (0.6300%)
time spent on training: 244.02071237564087
___Test Target_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.4430, Accuracy: 80/10000 (0.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.3186, Accuracy: 9695/9950 (97.4372%)
saving model
Done in 663.9581067562103 sec.
Server Epoch:46 choose agents : [43, 30, 40, 2, 69, 83, 22, 84, 91, 15].
___Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   1, Avg loss: 0.0749, Accuracy: 166/946 (17.5476%)
___Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   2, Avg loss: 0.0372, Accuracy: 354/946 (37.4207%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.0907, Accuracy: 81/10000 (0.8100%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0745, Accuracy: 8/486 (1.6461%)
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0324, Accuracy: 230/486 (47.3251%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.3671, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   1, Avg loss: 0.0646, Accuracy: 299/1573 (19.0083%)
___Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   2, Avg loss: 0.0342, Accuracy: 637/1573 (40.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.6438, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0864, Accuracy: 49/605 (8.0992%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0456, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.4133, Accuracy: 50/10000 (0.5000%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   1, Avg loss: 0.0706, Accuracy: 139/590 (23.5593%)
___Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   2, Avg loss: 0.0339, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 11.5344, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   1, Avg loss: 0.0622, Accuracy: 347/1953 (17.7675%)
___Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   2, Avg loss: 0.0317, Accuracy: 905/1953 (46.3390%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.4828, Accuracy: 140/10000 (1.4000%)
___Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   1, Avg loss: 0.0468, Accuracy: 467/1470 (31.7687%)
___Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   2, Avg loss: 0.0227, Accuracy: 935/1470 (63.6054%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.5632, Accuracy: 111/10000 (1.1100%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   1, Avg loss: 0.0733, Accuracy: 210/1190 (17.6471%)
___Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   2, Avg loss: 0.0310, Accuracy: 492/1190 (41.3445%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.6915, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   1, Avg loss: 0.0621, Accuracy: 246/1030 (23.8835%)
___Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   2, Avg loss: 0.0232, Accuracy: 665/1030 (64.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.8943, Accuracy: 109/10000 (1.0900%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0506, Accuracy: 348/1154 (30.1560%)
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0245, Accuracy: 579/1154 (50.1733%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.8671, Accuracy: 98/10000 (0.9800%)
time spent on training: 223.0452175140381
___Test Target_ResNet_18 poisoned: False, epoch: 46: Avg loss: 6.1984, Accuracy: 79/10000 (0.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Avg loss: 0.4192, Accuracy: 9486/9950 (95.3367%)
saving model
Done in 646.9979255199432 sec.
Server Epoch:47 choose agents : [36, 81, 80, 26, 12, 78, 60, 58, 75, 19].
poison local model 36 index 13 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   1, Average loss: 0.0739, Accuracy: 113/408 (27.6961%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   2, Average loss: 0.0524, Accuracy: 141/408 (34.5588%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   3, Average loss: 0.0393, Accuracy: 146/408 (35.7843%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   4, Average loss: 0.0384, Accuracy: 154/408 (37.7451%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   5, Average loss: 0.0356, Accuracy: 163/408 (39.9510%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   6, Average loss: 0.0353, Accuracy: 171/408 (41.9118%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   7, Average loss: 0.0337, Accuracy: 169/408 (41.4216%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   8, Average loss: 0.0331, Accuracy: 181/408 (44.3627%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   9, Average loss: 0.0329, Accuracy: 177/408 (43.3824%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch  10, Average loss: 0.0338, Accuracy: 186/408 (45.5882%), train_poison_data_count: 140
Global model norm: 111.78634318841233.
Norm before scaling: 111.78045061917133. Distance: 0.5826177010708169
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.6056, Accuracy: 52/10000 (0.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.2011, Accuracy: 9676/9950 (97.2462%)
Scaling by  100
Scaled Norm after poisoning: 125.39856770015358, distance: 58.26176785637387
Total norm for 5 adversaries is: 125.39856770015358. distance: 58.26176785637387
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   1, Avg loss: 0.0814, Accuracy: 108/774 (13.9535%)
___Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   2, Avg loss: 0.0375, Accuracy: 351/774 (45.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.8240, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0817, Accuracy: 42/682 (6.1584%)
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0387, Accuracy: 269/682 (39.4428%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.1488, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0634, Accuracy: 232/1446 (16.0443%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0342, Accuracy: 520/1446 (35.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.6007, Accuracy: 92/10000 (0.9200%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0815, Accuracy: 39/338 (11.5385%)
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0477, Accuracy: 116/338 (34.3195%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.8624, Accuracy: 67/10000 (0.6700%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   1, Avg loss: 0.1032, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   2, Avg loss: 0.0552, Accuracy: 143/416 (34.3750%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.7704, Accuracy: 83/10000 (0.8300%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   1, Avg loss: 0.0535, Accuracy: 588/2227 (26.4032%)
___Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   2, Avg loss: 0.0271, Accuracy: 1085/2227 (48.7203%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.1455, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   1, Avg loss: 0.0671, Accuracy: 198/803 (24.6575%)
___Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   2, Avg loss: 0.0357, Accuracy: 441/803 (54.9191%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.0057, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0814, Accuracy: 122/776 (15.7216%)
___Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0320, Accuracy: 408/776 (52.5773%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.8337, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0578, Accuracy: 293/1036 (28.2819%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 730/1036 (70.4633%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 12.4139, Accuracy: 75/10000 (0.7500%)
time spent on training: 262.93944096565247
___Test Target_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.4927, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.2741, Accuracy: 9277/9950 (93.2362%)
saving model
Done in 672.90980052948 sec.
Server Epoch:48 choose agents : [27, 96, 18, 95, 5, 47, 12, 39, 36, 82].
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0624, Accuracy: 355/1587 (22.3693%)
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0329, Accuracy: 648/1587 (40.8318%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.7424, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.1069, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0712, Accuracy: 31/311 (9.9678%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 5.9428, Accuracy: 50/10000 (0.5000%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   1, Avg loss: 0.0833, Accuracy: 22/530 (4.1509%)
___Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   2, Avg loss: 0.0348, Accuracy: 280/530 (52.8302%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.7443, Accuracy: 75/10000 (0.7500%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0748, Accuracy: 124/599 (20.7012%)
___Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0303, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 12.0158, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   1, Avg loss: 0.0491, Accuracy: 530/1628 (32.5553%)
___Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   2, Avg loss: 0.0206, Accuracy: 1024/1628 (62.8993%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.6786, Accuracy: 142/10000 (1.4200%)
___Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   1, Avg loss: 0.1549, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   2, Avg loss: 0.1346, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 5.9654, Accuracy: 64/10000 (0.6400%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   1, Avg loss: 0.0958, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   2, Avg loss: 0.0485, Accuracy: 95/338 (28.1065%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.1742, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0624, Accuracy: 176/1013 (17.3741%)
___Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0235, Accuracy: 554/1013 (54.6890%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.1593, Accuracy: 85/10000 (0.8500%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   1, Avg loss: 0.0408, Accuracy: 144/408 (35.2941%)
___Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   2, Avg loss: 0.0327, Accuracy: 195/408 (47.7941%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.2004, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0889, Accuracy: 10/500 (2.0000%)
___Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0504, Accuracy: 156/500 (31.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.2622, Accuracy: 75/10000 (0.7500%)
time spent on training: 204.6919722557068
___Test Target_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.2864, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Avg loss: 0.3565, Accuracy: 9045/9950 (90.9045%)
saving model
Done in 618.1401944160461 sec.
Server Epoch:49 choose agents : [37, 21, 63, 60, 36, 6, 17, 29, 9, 90].
poison local model 37 index 14 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   1, Average loss: 0.0541, Accuracy: 393/1129 (34.8096%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   2, Average loss: 0.0225, Accuracy: 698/1129 (61.8246%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   3, Average loss: 0.0186, Accuracy: 756/1129 (66.9619%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   4, Average loss: 0.0181, Accuracy: 779/1129 (68.9991%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   5, Average loss: 0.0167, Accuracy: 800/1129 (70.8592%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   6, Average loss: 0.0159, Accuracy: 816/1129 (72.2764%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   7, Average loss: 0.0156, Accuracy: 829/1129 (73.4278%), train_poison_data_count: 360
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   8, Average loss: 0.0158, Accuracy: 829/1129 (73.4278%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   9, Average loss: 0.0149, Accuracy: 837/1129 (74.1364%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch  10, Average loss: 0.0155, Accuracy: 827/1129 (73.2507%), train_poison_data_count: 360
Global model norm: 111.77793449793657.
Norm before scaling: 111.75955111588897. Distance: 1.0393526059489138
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.6561, Accuracy: 108/10000 (1.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.1700, Accuracy: 9271/9950 (93.1759%)
Scaling by  100
Scaled Norm after poisoning: 150.92232066530119, distance: 103.93526380637132
Total norm for 4 adversaries is: 150.92232066530119. distance: 103.93526380637132
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0579, Accuracy: 340/1949 (17.4448%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0319, Accuracy: 699/1949 (35.8645%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.2083, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   1, Avg loss: 0.0697, Accuracy: 136/888 (15.3153%)
___Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 438/888 (49.3243%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.6072, Accuracy: 90/10000 (0.9000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   1, Avg loss: 0.0533, Accuracy: 612/2227 (27.4809%)
___Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   2, Avg loss: 0.0269, Accuracy: 1113/2227 (49.9775%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.1222, Accuracy: 133/10000 (1.3300%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   1, Avg loss: 0.0406, Accuracy: 161/408 (39.4608%)
___Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   2, Avg loss: 0.0328, Accuracy: 190/408 (46.5686%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.3110, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   1, Avg loss: 0.0553, Accuracy: 331/1956 (16.9223%)
___Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   2, Avg loss: 0.0295, Accuracy: 752/1956 (38.4458%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.0989, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0600, Accuracy: 321/1574 (20.3939%)
___Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0260, Accuracy: 748/1574 (47.5222%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3766, Accuracy: 141/10000 (1.4100%)
___Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   1, Avg loss: 0.0593, Accuracy: 301/1440 (20.9028%)
___Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 738/1440 (51.2500%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.9143, Accuracy: 93/10000 (0.9300%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   1, Avg loss: 0.0468, Accuracy: 394/1275 (30.9020%)
___Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   2, Avg loss: 0.0150, Accuracy: 881/1275 (69.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 10.4292, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   1, Avg loss: 0.0610, Accuracy: 151/677 (22.3043%)
___Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   2, Avg loss: 0.0205, Accuracy: 471/677 (69.5716%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 10.9989, Accuracy: 69/10000 (0.6900%)
time spent on training: 298.31977009773254
___Test Target_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.5889, Accuracy: 115/10000 (1.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.2535, Accuracy: 8805/9950 (88.4925%)
saving model
Done in 704.6520781517029 sec.
Server Epoch:50 choose agents : [74, 58, 95, 2, 46, 62, 37, 81, 28, 99].
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   1, Avg loss: 0.0633, Accuracy: 384/1552 (24.7423%)
___Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   2, Avg loss: 0.0201, Accuracy: 819/1552 (52.7706%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 11.0688, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   1, Avg loss: 0.0865, Accuracy: 138/803 (17.1856%)
___Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   2, Avg loss: 0.0405, Accuracy: 449/803 (55.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.2675, Accuracy: 56/10000 (0.5600%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   1, Avg loss: 0.0932, Accuracy: 74/599 (12.3539%)
___Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   2, Avg loss: 0.0327, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 12.9627, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.1032, Accuracy: 23/605 (3.8017%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0456, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.5300, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0655, Accuracy: 362/1904 (19.0126%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0297, Accuracy: 778/1904 (40.8613%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.0012, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   1, Avg loss: 0.1090, Accuracy: 1/568 (0.1761%)
___Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   2, Avg loss: 0.0485, Accuracy: 253/568 (44.5423%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.5028, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   1, Avg loss: 0.0191, Accuracy: 767/1129 (67.9362%)
___Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   2, Avg loss: 0.0147, Accuracy: 831/1129 (73.6050%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.0150, Accuracy: 129/10000 (1.2900%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.1010, Accuracy: 66/774 (8.5271%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0387, Accuracy: 354/774 (45.7364%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.7370, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   1, Avg loss: 0.0728, Accuracy: 260/1581 (16.4453%)
___Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 623/1581 (39.4054%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.7616, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   1, Avg loss: 0.0926, Accuracy: 60/773 (7.7620%)
___Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   2, Avg loss: 0.0311, Accuracy: 435/773 (56.2743%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.6429, Accuracy: 74/10000 (0.7400%)
time spent on training: 218.9468286037445
___Test Target_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.0745, Accuracy: 120/10000 (1.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Avg loss: 0.4499, Accuracy: 7988/9950 (80.2814%)
saving model
Saving model on epoch 50
Done in 641.6644368171692 sec.
Server Epoch:51 choose agents : [42, 17, 32, 59, 73, 33, 77, 93, 8, 90].
poison local model 42 index 15 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Average loss: 0.0586, Accuracy: 443/1372 (32.2886%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Average loss: 0.0266, Accuracy: 708/1372 (51.6035%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   3, Average loss: 0.0232, Accuracy: 787/1372 (57.3615%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   4, Average loss: 0.0223, Accuracy: 812/1372 (59.1837%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   5, Average loss: 0.0220, Accuracy: 802/1372 (58.4548%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   6, Average loss: 0.0219, Accuracy: 792/1372 (57.7259%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   7, Average loss: 0.0211, Accuracy: 833/1372 (60.7143%), train_poison_data_count: 440
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   8, Average loss: 0.0214, Accuracy: 826/1372 (60.2041%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   9, Average loss: 0.0209, Accuracy: 819/1372 (59.6939%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch  10, Average loss: 0.0213, Accuracy: 828/1372 (60.3499%), train_poison_data_count: 440
Global model norm: 111.75536113398543.
Norm before scaling: 111.72952745218025. Distance: 1.2231051562399797
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.6748, Accuracy: 93/10000 (0.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: 0.3932, Accuracy: 8895/9950 (89.3970%)
Scaling by  100
Scaled Norm after poisoning: 163.46928467222827, distance: 122.31051592028994
Total norm for 2 adversaries is: 163.46928467222827. distance: 122.31051592028994
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   1, Avg loss: 0.0671, Accuracy: 308/1574 (19.5680%)
___Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   2, Avg loss: 0.0260, Accuracy: 728/1574 (46.2516%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.5108, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   1, Avg loss: 0.0740, Accuracy: 86/735 (11.7007%)
___Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   2, Avg loss: 0.0213, Accuracy: 377/735 (51.2925%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 10.3987, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0755, Accuracy: 177/1089 (16.2534%)
___Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0274, Accuracy: 584/1089 (53.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.0337, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   1, Avg loss: 0.0771, Accuracy: 123/938 (13.1130%)
___Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   2, Avg loss: 0.0339, Accuracy: 360/938 (38.3795%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.2080, Accuracy: 77/10000 (0.7700%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0964, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0475, Accuracy: 172/515 (33.3981%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.0861, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   1, Avg loss: 0.0687, Accuracy: 228/1340 (17.0149%)
___Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 623/1340 (46.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.9257, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0679, Accuracy: 304/1742 (17.4512%)
___Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0306, Accuracy: 791/1742 (45.4076%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.0987, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0759, Accuracy: 188/1513 (12.4256%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0358, Accuracy: 529/1513 (34.9636%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.7042, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   1, Avg loss: 0.0776, Accuracy: 108/677 (15.9527%)
___Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   2, Avg loss: 0.0214, Accuracy: 480/677 (70.9010%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 10.9976, Accuracy: 75/10000 (0.7500%)
time spent on training: 267.9675316810608
___Test Target_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.6288, Accuracy: 91/10000 (0.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 51: Avg loss: 0.8464, Accuracy: 7159/9950 (71.9497%)
saving model
Done in 680.1261112689972 sec.
Server Epoch:52 choose agents : [13, 59, 3, 73, 63, 7, 86, 32, 51, 89].
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0751, Accuracy: 239/1645 (14.5289%)
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0315, Accuracy: 695/1645 (42.2492%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.9351, Accuracy: 134/10000 (1.3400%)
___Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   1, Avg loss: 0.0792, Accuracy: 171/1089 (15.7025%)
___Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   2, Avg loss: 0.0280, Accuracy: 565/1089 (51.8825%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.4894, Accuracy: 105/10000 (1.0500%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   1, Avg loss: 0.0947, Accuracy: 4/781 (0.5122%)
___Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   2, Avg loss: 0.0334, Accuracy: 286/781 (36.6197%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.3607, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   1, Avg loss: 0.0835, Accuracy: 102/938 (10.8742%)
___Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   2, Avg loss: 0.0338, Accuracy: 354/938 (37.7399%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.3503, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   1, Avg loss: 0.0875, Accuracy: 87/888 (9.7973%)
___Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   2, Avg loss: 0.0267, Accuracy: 432/888 (48.6486%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.0170, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0817, Accuracy: 141/891 (15.8249%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0300, Accuracy: 436/891 (48.9338%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.2310, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   1, Avg loss: 0.0878, Accuracy: 160/1003 (15.9521%)
___Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   2, Avg loss: 0.0374, Accuracy: 364/1003 (36.2911%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.4762, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0790, Accuracy: 69/735 (9.3878%)
___Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0207, Accuracy: 388/735 (52.7891%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.7995, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   1, Avg loss: 0.0834, Accuracy: 125/1049 (11.9161%)
___Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   2, Avg loss: 0.0283, Accuracy: 543/1049 (51.7636%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.6141, Accuracy: 139/10000 (1.3900%)
___Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0892, Accuracy: 158/896 (17.6339%)
___Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0396, Accuracy: 476/896 (53.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.5096, Accuracy: 67/10000 (0.6700%)
time spent on training: 189.53992533683777
___Test Target_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.2239, Accuracy: 90/10000 (0.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 52: Avg loss: 1.4361, Accuracy: 5498/9950 (55.2563%)
saving model
Done in 599.5847852230072 sec.
Server Epoch:53 choose agents : [44, 63, 19, 5, 11, 69, 60, 51, 37, 90].
poison local model 44 index 16 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Average loss: 0.0594, Accuracy: 574/1750 (32.8000%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Average loss: 0.0295, Accuracy: 936/1750 (53.4857%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   3, Average loss: 0.0264, Accuracy: 961/1750 (54.9143%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   4, Average loss: 0.0255, Accuracy: 1027/1750 (58.6857%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   5, Average loss: 0.0249, Accuracy: 1008/1750 (57.6000%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   6, Average loss: 0.0249, Accuracy: 1002/1750 (57.2571%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   7, Average loss: 0.0244, Accuracy: 1015/1750 (58.0000%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   8, Average loss: 0.0243, Accuracy: 1027/1750 (58.6857%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   9, Average loss: 0.0244, Accuracy: 1041/1750 (59.4857%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch  10, Average loss: 0.0236, Accuracy: 1053/1750 (60.1714%), train_poison_data_count: 560
Global model norm: 111.7254980479501.
Norm before scaling: 111.69045970476843. Distance: 1.3421939445580693
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.1243, Accuracy: 123/10000 (1.2300%)
___Test Local_ResNet_18 poisoned: True, epoch: 53: Avg loss: 0.6820, Accuracy: 7907/9950 (79.4673%)
Scaling by  100
Scaled Norm after poisoning: 171.855953490125, distance: 134.21939391580116
Total norm for 5 adversaries is: 171.855953490125. distance: 134.21939391580116
___Test Local_ResNet_18 poisoned: True, epoch: 53: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   1, Avg loss: 0.0816, Accuracy: 104/888 (11.7117%)
___Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 437/888 (49.2117%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.8257, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0692, Accuracy: 221/1036 (21.3320%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0257, Accuracy: 702/1036 (67.7606%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 12.4638, Accuracy: 75/10000 (0.7500%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0576, Accuracy: 438/1628 (26.9042%)
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0209, Accuracy: 1041/1628 (63.9435%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.5188, Accuracy: 169/10000 (1.6900%)
___Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   1, Avg loss: 0.0800, Accuracy: 142/712 (19.9438%)
___Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   2, Avg loss: 0.0279, Accuracy: 457/712 (64.1854%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.6739, Accuracy: 80/10000 (0.8000%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0855, Accuracy: 86/590 (14.5763%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0358, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 12.2864, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   1, Avg loss: 0.0553, Accuracy: 528/2227 (23.7090%)
___Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   2, Avg loss: 0.0267, Accuracy: 1116/2227 (50.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.1256, Accuracy: 134/10000 (1.3400%)
___Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   1, Avg loss: 0.0790, Accuracy: 140/1049 (13.3460%)
___Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   2, Avg loss: 0.0281, Accuracy: 565/1049 (53.8608%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.4033, Accuracy: 140/10000 (1.4000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   1, Avg loss: 0.0582, Accuracy: 341/1129 (30.2037%)
___Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   2, Avg loss: 0.0189, Accuracy: 796/1129 (70.5049%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.4097, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   1, Avg loss: 0.0781, Accuracy: 103/677 (15.2142%)
___Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 469/677 (69.2762%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 11.2196, Accuracy: 72/10000 (0.7200%)
time spent on training: 306.0120630264282
___Test Target_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.0920, Accuracy: 128/10000 (1.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 53: Avg loss: 1.0828, Accuracy: 6634/9950 (66.6734%)
saving model
Done in 716.6145045757294 sec.
Server Epoch:54 choose agents : [87, 90, 28, 63, 1, 47, 46, 66, 40, 91].
___Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   1, Avg loss: 0.0757, Accuracy: 208/1131 (18.3908%)
___Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   2, Avg loss: 0.0334, Accuracy: 370/1131 (32.7144%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.2183, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   1, Avg loss: 0.0776, Accuracy: 113/677 (16.6913%)
___Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 468/677 (69.1285%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 11.1710, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0702, Accuracy: 283/1581 (17.9001%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0328, Accuracy: 660/1581 (41.7457%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.7804, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   1, Avg loss: 0.0813, Accuracy: 92/888 (10.3604%)
___Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   2, Avg loss: 0.0264, Accuracy: 439/888 (49.4369%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.9830, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0739, Accuracy: 160/928 (17.2414%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0231, Accuracy: 613/928 (66.0560%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.1349, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1798, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1578, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.7327, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0656, Accuracy: 363/1904 (19.0651%)
___Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0296, Accuracy: 787/1904 (41.3340%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.0990, Accuracy: 147/10000 (1.4700%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0778, Accuracy: 211/1402 (15.0499%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 457/1402 (32.5963%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.4635, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   1, Avg loss: 0.0685, Accuracy: 315/1573 (20.0254%)
___Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 675/1573 (42.9116%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.6937, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   1, Avg loss: 0.0762, Accuracy: 161/1030 (15.6311%)
___Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   2, Avg loss: 0.0242, Accuracy: 667/1030 (64.7573%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.9330, Accuracy: 112/10000 (1.1200%)
time spent on training: 192.2915554046631
___Test Target_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.8170, Accuracy: 126/10000 (1.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 54: Avg loss: 1.6600, Accuracy: 5523/9950 (55.5075%)
saving model
Done in 606.7848100662231 sec.
Server Epoch:55 choose agents : [48, 41, 73, 59, 13, 26, 32, 57, 99, 55].
poison local model 48 index 17 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   1, Average loss: 0.0736, Accuracy: 154/631 (24.4057%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   2, Average loss: 0.0448, Accuracy: 271/631 (42.9477%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   3, Average loss: 0.0348, Accuracy: 304/631 (48.1775%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   4, Average loss: 0.0333, Accuracy: 329/631 (52.1395%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   5, Average loss: 0.0304, Accuracy: 356/631 (56.4184%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   6, Average loss: 0.0308, Accuracy: 344/631 (54.5166%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   7, Average loss: 0.0284, Accuracy: 371/631 (58.7956%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   8, Average loss: 0.0288, Accuracy: 353/631 (55.9429%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   9, Average loss: 0.0283, Accuracy: 364/631 (57.6862%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch  10, Average loss: 0.0290, Accuracy: 358/631 (56.7353%), train_poison_data_count: 200
Global model norm: 111.68645512242072.
Norm before scaling: 111.67507450467629. Distance: 0.7999974578578612
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.6194, Accuracy: 78/10000 (0.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 55: Avg loss: 0.2596, Accuracy: 9374/9950 (94.2111%)
Scaling by  100
Scaled Norm after poisoning: 136.21942030690778, distance: 79.99974365193303
Total norm for 2 adversaries is: 136.21942030690778. distance: 79.99974365193303
___Test Local_ResNet_18 poisoned: True, epoch: 55: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   1, Avg loss: 0.0849, Accuracy: 124/719 (17.2462%)
___Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   2, Avg loss: 0.0382, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.4043, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0755, Accuracy: 141/938 (15.0320%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0337, Accuracy: 393/938 (41.8977%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.3514, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   1, Avg loss: 0.0715, Accuracy: 174/1089 (15.9780%)
___Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   2, Avg loss: 0.0270, Accuracy: 540/1089 (49.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.3040, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0650, Accuracy: 357/1645 (21.7021%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0308, Accuracy: 747/1645 (45.4103%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.8565, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0707, Accuracy: 221/1446 (15.2835%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0354, Accuracy: 522/1446 (36.0996%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.5356, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   1, Avg loss: 0.0697, Accuracy: 90/735 (12.2449%)
___Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   2, Avg loss: 0.0214, Accuracy: 398/735 (54.1497%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 10.8480, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   1, Avg loss: 0.0745, Accuracy: 153/1154 (13.2582%)
___Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   2, Avg loss: 0.0253, Accuracy: 561/1154 (48.6135%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 10.0594, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0863, Accuracy: 68/773 (8.7969%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0306, Accuracy: 439/773 (56.7917%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.1444, Accuracy: 76/10000 (0.7600%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0763, Accuracy: 141/1071 (13.1653%)
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0294, Accuracy: 531/1071 (49.5798%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.3345, Accuracy: 96/10000 (0.9600%)
time spent on training: 252.85946369171143
___Test Target_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.5153, Accuracy: 83/10000 (0.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 55: Avg loss: 0.4353, Accuracy: 8606/9950 (86.4925%)
saving model
Done in 673.1142611503601 sec.
Server Epoch:56 choose agents : [70, 37, 13, 11, 65, 80, 49, 18, 26, 82].
___Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   1, Avg loss: 0.0685, Accuracy: 266/1418 (18.7588%)
___Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 720/1418 (50.7757%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.0275, Accuracy: 106/10000 (1.0600%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   1, Avg loss: 0.0548, Accuracy: 359/1129 (31.7981%)
___Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   2, Avg loss: 0.0192, Accuracy: 799/1129 (70.7706%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.0983, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0648, Accuracy: 322/1645 (19.5745%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0309, Accuracy: 745/1645 (45.2888%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.8906, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   1, Avg loss: 0.0756, Accuracy: 142/712 (19.9438%)
___Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   2, Avg loss: 0.0279, Accuracy: 448/712 (62.9213%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.8869, Accuracy: 78/10000 (0.7800%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0704, Accuracy: 286/1475 (19.3898%)
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0305, Accuracy: 739/1475 (50.1017%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.5041, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   1, Avg loss: 0.0778, Accuracy: 84/682 (12.3167%)
___Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   2, Avg loss: 0.0390, Accuracy: 275/682 (40.3226%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.8156, Accuracy: 81/10000 (0.8100%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   1, Avg loss: 0.1014, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   2, Avg loss: 0.0575, Accuracy: 79/440 (17.9545%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.3490, Accuracy: 55/10000 (0.5500%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   1, Avg loss: 0.0965, Accuracy: 3/530 (0.5660%)
___Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   2, Avg loss: 0.0384, Accuracy: 264/530 (49.8113%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.3961, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0686, Accuracy: 237/1446 (16.3900%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0342, Accuracy: 566/1446 (39.1425%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.5308, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.0989, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0544, Accuracy: 139/500 (27.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.1642, Accuracy: 65/10000 (0.6500%)
time spent on training: 226.65725421905518
___Test Target_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.2556, Accuracy: 88/10000 (0.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 56: Avg loss: 0.7231, Accuracy: 7740/9950 (77.7889%)
saving model
Done in 648.4548201560974 sec.
Server Epoch:57 choose agents : [49, 24, 21, 90, 19, 40, 84, 62, 37, 70].
poison local model 49 index 18 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   1, Average loss: 0.0699, Accuracy: 113/440 (25.6818%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   2, Average loss: 0.0494, Accuracy: 159/440 (36.1364%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   3, Average loss: 0.0358, Accuracy: 232/440 (52.7273%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   4, Average loss: 0.0337, Accuracy: 246/440 (55.9091%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   5, Average loss: 0.0328, Accuracy: 254/440 (57.7273%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   6, Average loss: 0.0313, Accuracy: 240/440 (54.5455%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   7, Average loss: 0.0308, Accuracy: 251/440 (57.0455%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   8, Average loss: 0.0298, Accuracy: 242/440 (55.0000%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   9, Average loss: 0.0289, Accuracy: 252/440 (57.2727%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch  10, Average loss: 0.0277, Accuracy: 265/440 (60.2273%), train_poison_data_count: 140
Global model norm: 111.67149787434572.
Norm before scaling: 111.66521881835006. Distance: 0.6062036791537204
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.2951, Accuracy: 65/10000 (0.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 57: Avg loss: 0.4263, Accuracy: 8930/9950 (89.7487%)
Scaling by  100
Scaled Norm after poisoning: 126.36633331434643, distance: 60.620366688282864
Total norm for 4 adversaries is: 126.36633331434643. distance: 60.620366688282864
___Test Local_ResNet_18 poisoned: True, epoch: 57: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   1, Avg loss: 0.0959, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   2, Avg loss: 0.0537, Accuracy: 65/312 (20.8333%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.5633, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   1, Avg loss: 0.0601, Accuracy: 312/1949 (16.0082%)
___Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   2, Avg loss: 0.0320, Accuracy: 710/1949 (36.4289%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.0606, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   1, Avg loss: 0.0678, Accuracy: 131/677 (19.3501%)
___Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   2, Avg loss: 0.0215, Accuracy: 465/677 (68.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 10.4264, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   1, Avg loss: 0.0592, Accuracy: 299/1036 (28.8610%)
___Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   2, Avg loss: 0.0231, Accuracy: 731/1036 (70.5598%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 12.1418, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0579, Accuracy: 366/1573 (23.2676%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0338, Accuracy: 632/1573 (40.1780%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.3682, Accuracy: 95/10000 (0.9500%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   1, Avg loss: 0.0729, Accuracy: 206/1190 (17.3109%)
___Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 462/1190 (38.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.5478, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   1, Avg loss: 0.0890, Accuracy: 6/568 (1.0563%)
___Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   2, Avg loss: 0.0470, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.5456, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   1, Avg loss: 0.0528, Accuracy: 370/1129 (32.7724%)
___Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   2, Avg loss: 0.0190, Accuracy: 796/1129 (70.5049%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.8386, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0661, Accuracy: 289/1418 (20.3808%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0293, Accuracy: 757/1418 (53.3850%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.1022, Accuracy: 104/10000 (1.0400%)
time spent on training: 274.9297366142273
___Test Target_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.2415, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 57: Avg loss: 0.6715, Accuracy: 7787/9950 (78.2613%)
saving model
Done in 695.7225296497345 sec.
Server Epoch:58 choose agents : [95, 54, 5, 67, 47, 39, 11, 59, 83, 6].
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   1, Avg loss: 0.0736, Accuracy: 125/599 (20.8681%)
___Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   2, Avg loss: 0.0307, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 12.1464, Accuracy: 50/10000 (0.5000%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   1, Avg loss: 0.0695, Accuracy: 212/1130 (18.7611%)
___Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   2, Avg loss: 0.0284, Accuracy: 529/1130 (46.8142%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.9774, Accuracy: 57/10000 (0.5700%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   1, Avg loss: 0.0504, Accuracy: 482/1628 (29.6069%)
___Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   2, Avg loss: 0.0196, Accuracy: 1063/1628 (65.2948%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.2067, Accuracy: 169/10000 (1.6900%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0939, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0488, Accuracy: 134/426 (31.4554%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.0996, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1495, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1268, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.0088, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   1, Avg loss: 0.0679, Accuracy: 168/1013 (16.5844%)
___Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   2, Avg loss: 0.0251, Accuracy: 552/1013 (54.4916%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.0987, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   1, Avg loss: 0.0552, Accuracy: 231/712 (32.4438%)
___Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   2, Avg loss: 0.0292, Accuracy: 458/712 (64.3258%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.8033, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   1, Avg loss: 0.0666, Accuracy: 207/1089 (19.0083%)
___Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   2, Avg loss: 0.0270, Accuracy: 570/1089 (52.3416%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.9272, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   1, Avg loss: 0.0582, Accuracy: 435/1953 (22.2734%)
___Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   2, Avg loss: 0.0313, Accuracy: 916/1953 (46.9022%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.4527, Accuracy: 154/10000 (1.5400%)
___Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   1, Avg loss: 0.0593, Accuracy: 332/1956 (16.9734%)
___Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   2, Avg loss: 0.0293, Accuracy: 763/1956 (39.0082%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.1002, Accuracy: 126/10000 (1.2600%)
time spent on training: 224.93082809448242
___Test Target_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.0733, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 58: Avg loss: 0.9637, Accuracy: 6989/9950 (70.2412%)
saving model
Done in 649.6395936012268 sec.
Server Epoch:59 choose agents : [54, 47, 10, 12, 0, 49, 14, 52, 51, 46].
poison local model 54 index 19 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   1, Average loss: 0.0536, Accuracy: 411/1130 (36.3717%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   2, Average loss: 0.0262, Accuracy: 622/1130 (55.0442%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   3, Average loss: 0.0206, Accuracy: 697/1130 (61.6814%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   4, Average loss: 0.0201, Accuracy: 708/1130 (62.6549%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   5, Average loss: 0.0204, Accuracy: 713/1130 (63.0973%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   6, Average loss: 0.0202, Accuracy: 713/1130 (63.0973%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   7, Average loss: 0.0199, Accuracy: 719/1130 (63.6283%), train_poison_data_count: 360
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   8, Average loss: 0.0196, Accuracy: 743/1130 (65.7522%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   9, Average loss: 0.0196, Accuracy: 722/1130 (63.8938%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch  10, Average loss: 0.0190, Accuracy: 729/1130 (64.5133%), train_poison_data_count: 360
Global model norm: 111.66180804106658.
Norm before scaling: 111.64283697073897. Distance: 0.9898042967535222
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.6899, Accuracy: 81/10000 (0.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 59: Avg loss: 0.2661, Accuracy: 9196/9950 (92.4221%)
Scaling by  100
Scaled Norm after poisoning: 147.45830978619009, distance: 98.98042735813985
Total norm for 5 adversaries is: 147.45830978619009. distance: 98.98042735813985
___Test Local_ResNet_18 poisoned: True, epoch: 59: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   1, Avg loss: 0.1350, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   2, Avg loss: 0.1239, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 5.8913, Accuracy: 73/10000 (0.7300%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   1, Avg loss: 0.0658, Accuracy: 137/861 (15.9117%)
___Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   2, Avg loss: 0.0172, Accuracy: 534/861 (62.0209%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 10.1160, Accuracy: 106/10000 (1.0600%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   1, Avg loss: 0.1024, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   2, Avg loss: 0.0575, Accuracy: 70/338 (20.7101%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.3613, Accuracy: 60/10000 (0.6000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   1, Avg loss: 0.0618, Accuracy: 302/1657 (18.2257%)
___Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   2, Avg loss: 0.0327, Accuracy: 553/1657 (33.3736%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.7135, Accuracy: 106/10000 (1.0600%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   1, Avg loss: 0.0392, Accuracy: 163/440 (37.0455%)
___Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   2, Avg loss: 0.0315, Accuracy: 226/440 (51.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.0379, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   1, Avg loss: 0.0755, Accuracy: 93/1013 (9.1807%)
___Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 419/1013 (41.3623%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.8363, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0780, Accuracy: 90/636 (14.1509%)
___Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0342, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 10.0401, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   1, Avg loss: 0.0696, Accuracy: 183/1049 (17.4452%)
___Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   2, Avg loss: 0.0278, Accuracy: 552/1049 (52.6215%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.2730, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   1, Avg loss: 0.0601, Accuracy: 357/1904 (18.7500%)
___Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   2, Avg loss: 0.0298, Accuracy: 809/1904 (42.4895%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.8844, Accuracy: 121/10000 (1.2100%)
time spent on training: 286.2629904747009
___Test Target_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.6503, Accuracy: 87/10000 (0.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 59: Avg loss: 0.3514, Accuracy: 8860/9950 (89.0452%)
saving model
Done in 707.9423019886017 sec.
Server Epoch:60 choose agents : [54, 52, 10, 29, 40, 35, 50, 34, 99, 36].
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0265, Accuracy: 590/1130 (52.2124%)
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0228, Accuracy: 647/1130 (57.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.7388, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0932, Accuracy: 37/636 (5.8176%)
___Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0327, Accuracy: 426/636 (66.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.9139, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0703, Accuracy: 159/861 (18.4669%)
___Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0187, Accuracy: 513/861 (59.5819%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.5073, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   1, Avg loss: 0.0681, Accuracy: 278/1440 (19.3056%)
___Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   2, Avg loss: 0.0264, Accuracy: 712/1440 (49.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.7685, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   1, Avg loss: 0.0680, Accuracy: 323/1573 (20.5340%)
___Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   2, Avg loss: 0.0343, Accuracy: 641/1573 (40.7502%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.4174, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   1, Avg loss: 0.1408, Accuracy: 2/271 (0.7380%)
___Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   2, Avg loss: 0.0905, Accuracy: 5/271 (1.8450%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.4835, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0844, Accuracy: 47/809 (5.8096%)
___Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0265, Accuracy: 324/809 (40.0494%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.5897, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   1, Avg loss: 0.0754, Accuracy: 243/1427 (17.0287%)
___Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   2, Avg loss: 0.0324, Accuracy: 643/1427 (45.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.5875, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   1, Avg loss: 0.0948, Accuracy: 49/773 (6.3389%)
___Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   2, Avg loss: 0.0316, Accuracy: 445/773 (57.5679%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.5473, Accuracy: 73/10000 (0.7300%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   1, Avg loss: 0.1227, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   2, Avg loss: 0.0621, Accuracy: 55/408 (13.4804%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.7654, Accuracy: 50/10000 (0.5000%)
time spent on training: 214.16062688827515
___Test Target_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.2413, Accuracy: 93/10000 (0.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 60: Avg loss: 0.6299, Accuracy: 7793/9950 (78.3216%)
saving model
Saving model on epoch 60
Done in 643.4766025543213 sec.
Server Epoch:61 choose agents : [55, 8, 59, 31, 34, 81, 12, 79, 36, 85].
poison local model 55 index 20 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Average loss: 0.0675, Accuracy: 282/1071 (26.3305%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Average loss: 0.0240, Accuracy: 622/1071 (58.0766%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   3, Average loss: 0.0205, Accuracy: 660/1071 (61.6246%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   4, Average loss: 0.0195, Accuracy: 712/1071 (66.4799%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   5, Average loss: 0.0191, Accuracy: 714/1071 (66.6667%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   6, Average loss: 0.0185, Accuracy: 725/1071 (67.6937%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   7, Average loss: 0.0182, Accuracy: 710/1071 (66.2932%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   8, Average loss: 0.0175, Accuracy: 725/1071 (67.6937%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   9, Average loss: 0.0172, Accuracy: 728/1071 (67.9739%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch  10, Average loss: 0.0179, Accuracy: 722/1071 (67.4136%), train_poison_data_count: 340
Global model norm: 111.63971854950415.
Norm before scaling: 111.61983383201886. Distance: 1.1681728120982255
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.6045, Accuracy: 93/10000 (0.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 61: Avg loss: 1.0780, Accuracy: 6211/9950 (62.4221%)
Scaling by  100
Scaled Norm after poisoning: 159.77867382531062, distance: 116.81727769121954
Total norm for 5 adversaries is: 159.77867382531062. distance: 116.81727769121954
___Test Local_ResNet_18 poisoned: True, epoch: 61: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   1, Avg loss: 0.0721, Accuracy: 179/1513 (11.8308%)
___Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   2, Avg loss: 0.0351, Accuracy: 554/1513 (36.6160%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.6416, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   1, Avg loss: 0.0750, Accuracy: 176/1089 (16.1616%)
___Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   2, Avg loss: 0.0278, Accuracy: 549/1089 (50.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.0832, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   1, Avg loss: 0.0863, Accuracy: 98/460 (21.3043%)
___Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   2, Avg loss: 0.0455, Accuracy: 186/460 (40.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.8775, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   1, Avg loss: 0.0722, Accuracy: 256/1427 (17.9397%)
___Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   2, Avg loss: 0.0321, Accuracy: 650/1427 (45.5501%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.6270, Accuracy: 93/10000 (0.9300%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   1, Avg loss: 0.0955, Accuracy: 70/774 (9.0439%)
___Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   2, Avg loss: 0.0387, Accuracy: 371/774 (47.9328%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.4026, Accuracy: 76/10000 (0.7600%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.1231, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0674, Accuracy: 19/338 (5.6213%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.5786, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1508, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.1233, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.2789, Accuracy: 101/10000 (1.0100%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   1, Avg loss: 0.1146, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   2, Avg loss: 0.0590, Accuracy: 62/408 (15.1961%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.7764, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   1, Avg loss: 0.0670, Accuracy: 343/1988 (17.2535%)
___Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   2, Avg loss: 0.0338, Accuracy: 789/1988 (39.6881%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.7234, Accuracy: 99/10000 (0.9900%)
time spent on training: 288.57389879226685
___Test Target_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.5887, Accuracy: 95/10000 (0.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 61: Avg loss: 1.4004, Accuracy: 4990/9950 (50.1508%)
saving model
Done in 710.9352037906647 sec.
Server Epoch:62 choose agents : [76, 81, 79, 10, 63, 90, 19, 80, 0, 17].
___Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   1, Avg loss: 0.1297, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   2, Avg loss: 0.0616, Accuracy: 118/466 (25.3219%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.9072, Accuracy: 50/10000 (0.5000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.0989, Accuracy: 63/774 (8.1395%)
___Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0419, Accuracy: 368/774 (47.5452%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.7314, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   1, Avg loss: 0.1506, Accuracy: 5/197 (2.5381%)
___Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   2, Avg loss: 0.1217, Accuracy: 18/197 (9.1371%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.6376, Accuracy: 68/10000 (0.6800%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   1, Avg loss: 0.0806, Accuracy: 104/861 (12.0790%)
___Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   2, Avg loss: 0.0175, Accuracy: 553/861 (64.2276%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.9276, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0897, Accuracy: 77/888 (8.6712%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0270, Accuracy: 440/888 (49.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.2933, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   1, Avg loss: 0.0874, Accuracy: 80/677 (11.8168%)
___Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   2, Avg loss: 0.0244, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 10.4089, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   1, Avg loss: 0.0716, Accuracy: 224/1036 (21.6216%)
___Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   2, Avg loss: 0.0240, Accuracy: 710/1036 (68.5328%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 12.0477, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0986, Accuracy: 17/682 (2.4927%)
___Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0407, Accuracy: 274/682 (40.1760%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.8162, Accuracy: 68/10000 (0.6800%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   1, Avg loss: 0.0717, Accuracy: 251/1657 (15.1479%)
___Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   2, Avg loss: 0.0324, Accuracy: 554/1657 (33.4339%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.6857, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   1, Avg loss: 0.0736, Accuracy: 273/1574 (17.3443%)
___Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   2, Avg loss: 0.0268, Accuracy: 753/1574 (47.8399%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.3735, Accuracy: 121/10000 (1.2100%)
time spent on training: 211.62237906455994
___Test Target_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.1164, Accuracy: 96/10000 (0.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 62: Avg loss: 2.2405, Accuracy: 3269/9950 (32.8543%)
saving model
Done in 641.9131643772125 sec.
Server Epoch:63 choose agents : [60, 37, 76, 38, 57, 8, 82, 79, 19, 99].
poison local model 60 index 21 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   1, Average loss: 0.0478, Accuracy: 903/2227 (40.5478%), train_poison_data_count: 700
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   2, Average loss: 0.0225, Accuracy: 1322/2227 (59.3624%), train_poison_data_count: 700
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   3, Average loss: 0.0200, Accuracy: 1417/2227 (63.6282%), train_poison_data_count: 700
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   4, Average loss: 0.0195, Accuracy: 1416/2227 (63.5833%), train_poison_data_count: 700
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   5, Average loss: 0.0194, Accuracy: 1420/2227 (63.7629%), train_poison_data_count: 700
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   6, Average loss: 0.0193, Accuracy: 1411/2227 (63.3588%), train_poison_data_count: 700
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   7, Average loss: 0.0187, Accuracy: 1434/2227 (64.3916%), train_poison_data_count: 700
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   8, Average loss: 0.0182, Accuracy: 1460/2227 (65.5590%), train_poison_data_count: 700
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   9, Average loss: 0.0182, Accuracy: 1450/2227 (65.1100%), train_poison_data_count: 700
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch  10, Average loss: 0.0185, Accuracy: 1421/2227 (63.8078%), train_poison_data_count: 700
Global model norm: 111.61638229612623.
Norm before scaling: 111.57344134022217. Distance: 1.3863098401293108
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.7464, Accuracy: 128/10000 (1.2800%)
___Test Local_ResNet_18 poisoned: True, epoch: 63: Avg loss: 1.3896, Accuracy: 5589/9950 (56.1709%)
Scaling by  100
Scaled Norm after poisoning: 174.71680769355018, distance: 138.63098781026557
Total norm for 2 adversaries is: 174.71680769355018. distance: 138.63098781026557
___Test Local_ResNet_18 poisoned: True, epoch: 63: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0641, Accuracy: 324/1129 (28.6980%)
___Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0205, Accuracy: 782/1129 (69.2648%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.8847, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.1217, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0620, Accuracy: 124/466 (26.6094%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.8235, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0782, Accuracy: 166/1131 (14.6773%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0297, Accuracy: 558/1131 (49.3369%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.8642, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0778, Accuracy: 151/1154 (13.0849%)
___Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0262, Accuracy: 557/1154 (48.2669%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.7584, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   1, Avg loss: 0.0731, Accuracy: 189/1513 (12.4917%)
___Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   2, Avg loss: 0.0353, Accuracy: 519/1513 (34.3027%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.6460, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   1, Avg loss: 0.1084, Accuracy: 8/500 (1.6000%)
___Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   2, Avg loss: 0.0569, Accuracy: 95/500 (19.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.8578, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   1, Avg loss: 0.1355, Accuracy: 1/197 (0.5076%)
___Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   2, Avg loss: 0.1169, Accuracy: 15/197 (7.6142%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.4370, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   1, Avg loss: 0.0658, Accuracy: 254/1036 (24.5174%)
___Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   2, Avg loss: 0.0225, Accuracy: 720/1036 (69.4981%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 12.0960, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.0887, Accuracy: 58/773 (7.5032%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0358, Accuracy: 411/773 (53.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.4636, Accuracy: 73/10000 (0.7300%)
time spent on training: 275.7149124145508
___Test Target_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.6954, Accuracy: 133/10000 (1.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 63: Avg loss: 2.1355, Accuracy: 3358/9950 (33.7487%)
saving model
Done in 698.8544244766235 sec.
Server Epoch:64 choose agents : [36, 20, 35, 30, 6, 45, 65, 50, 99, 89].
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   1, Avg loss: 0.1239, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   2, Avg loss: 0.0670, Accuracy: 55/408 (13.4804%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.0285, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   1, Avg loss: 0.0919, Accuracy: 84/807 (10.4089%)
___Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   2, Avg loss: 0.0357, Accuracy: 438/807 (54.2751%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.7801, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.1482, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.1027, Accuracy: 0/271 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 6.7664, Accuracy: 117/10000 (1.1700%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.1178, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0540, Accuracy: 140/486 (28.8066%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.0508, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   1, Avg loss: 0.0707, Accuracy: 273/1956 (13.9571%)
___Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   2, Avg loss: 0.0298, Accuracy: 746/1956 (38.1391%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.8736, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.1092, Accuracy: 15/669 (2.2422%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0498, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.8996, Accuracy: 71/10000 (0.7100%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   1, Avg loss: 0.0806, Accuracy: 230/1475 (15.5932%)
___Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   2, Avg loss: 0.0317, Accuracy: 729/1475 (49.4237%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.3367, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   1, Avg loss: 0.0932, Accuracy: 15/809 (1.8541%)
___Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 354/809 (43.7577%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.1079, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   1, Avg loss: 0.0986, Accuracy: 29/773 (3.7516%)
___Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   2, Avg loss: 0.0340, Accuracy: 441/773 (57.0505%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.7229, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   1, Avg loss: 0.0931, Accuracy: 126/896 (14.0625%)
___Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   2, Avg loss: 0.0385, Accuracy: 500/896 (55.8036%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.7014, Accuracy: 65/10000 (0.6500%)
time spent on training: 222.015474319458
___Test Target_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.3808, Accuracy: 134/10000 (1.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 64: Avg loss: 2.4409, Accuracy: 2795/9950 (28.0905%)
saving model
Done in 645.4454650878906 sec.
Server Epoch:65 choose agents : [61, 28, 93, 57, 72, 82, 55, 87, 88, 96].
poison local model 61 index 22 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Average loss: 0.0927, Accuracy: 21/85 (24.7059%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Average loss: 0.0847, Accuracy: 32/85 (37.6471%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   3, Average loss: 0.0792, Accuracy: 32/85 (37.6471%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   4, Average loss: 0.0783, Accuracy: 36/85 (42.3529%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   5, Average loss: 0.0770, Accuracy: 34/85 (40.0000%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   6, Average loss: 0.0755, Accuracy: 34/85 (40.0000%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   7, Average loss: 0.0752, Accuracy: 37/85 (43.5294%), train_poison_data_count: 40
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   8, Average loss: 0.0749, Accuracy: 38/85 (44.7059%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   9, Average loss: 0.0730, Accuracy: 38/85 (44.7059%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch  10, Average loss: 0.0731, Accuracy: 37/85 (43.5294%), train_poison_data_count: 40
Global model norm: 111.5700146278672.
Norm before scaling: 111.56848723429927. Distance: 0.13266831172434568
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.5877, Accuracy: 113/10000 (1.1300%)
___Test Local_ResNet_18 poisoned: True, epoch: 65: Avg loss: 0.3594, Accuracy: 9682/9950 (97.3065%)
Scaling by  100
Scaled Norm after poisoning: 112.19740990353787, distance: 13.26683155768845
Total norm for 3 adversaries is: 112.19740990353787. distance: 13.26683155768845
___Test Local_ResNet_18 poisoned: True, epoch: 65: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0734, Accuracy: 249/1581 (15.7495%)
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 684/1581 (43.2638%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.6288, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   1, Avg loss: 0.0674, Accuracy: 349/1742 (20.0344%)
___Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   2, Avg loss: 0.0306, Accuracy: 803/1742 (46.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.7535, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0830, Accuracy: 131/1154 (11.3518%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0296, Accuracy: 476/1154 (41.2478%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 10.2204, Accuracy: 66/10000 (0.6600%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0832, Accuracy: 132/1241 (10.6366%)
___Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 484/1241 (39.0008%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.8056, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.1153, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0633, Accuracy: 86/500 (17.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.0361, Accuracy: 53/10000 (0.5300%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   1, Avg loss: 0.0686, Accuracy: 178/1071 (16.6200%)
___Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   2, Avg loss: 0.0252, Accuracy: 603/1071 (56.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.1182, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   1, Avg loss: 0.0832, Accuracy: 158/1131 (13.9699%)
___Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   2, Avg loss: 0.0341, Accuracy: 404/1131 (35.7206%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.9831, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   1, Avg loss: 0.0973, Accuracy: 5/603 (0.8292%)
___Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   2, Avg loss: 0.0493, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.8561, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   1, Avg loss: 0.1199, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   2, Avg loss: 0.0846, Accuracy: 2/311 (0.6431%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 6.5179, Accuracy: 147/10000 (1.4700%)
time spent on training: 261.29095125198364
___Test Target_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.1944, Accuracy: 117/10000 (1.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 65: Avg loss: 0.5134, Accuracy: 9460/9950 (95.0754%)
saving model
Done in 679.5000445842743 sec.
Server Epoch:66 choose agents : [15, 18, 21, 86, 93, 71, 34, 3, 52, 47].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   1, Avg loss: 0.0687, Accuracy: 213/1154 (18.4575%)
___Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   2, Avg loss: 0.0262, Accuracy: 560/1154 (48.5269%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.8800, Accuracy: 114/10000 (1.1400%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.1059, Accuracy: 2/530 (0.3774%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0399, Accuracy: 245/530 (46.2264%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.6573, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   1, Avg loss: 0.0678, Accuracy: 293/1949 (15.0334%)
___Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   2, Avg loss: 0.0319, Accuracy: 726/1949 (37.2499%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.9710, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0834, Accuracy: 158/1003 (15.7527%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0375, Accuracy: 405/1003 (40.3789%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.3275, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0634, Accuracy: 344/1742 (19.7474%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0309, Accuracy: 797/1742 (45.7520%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.7895, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0942, Accuracy: 13/818 (1.5892%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0336, Accuracy: 422/818 (51.5892%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.4551, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   1, Avg loss: 0.0730, Accuracy: 255/1427 (17.8697%)
___Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   2, Avg loss: 0.0328, Accuracy: 641/1427 (44.9194%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.6155, Accuracy: 96/10000 (0.9600%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   1, Avg loss: 0.0889, Accuracy: 15/781 (1.9206%)
___Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   2, Avg loss: 0.0355, Accuracy: 272/781 (34.8271%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.1043, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   1, Avg loss: 0.0895, Accuracy: 49/636 (7.7044%)
___Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   2, Avg loss: 0.0332, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 10.2313, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   1, Avg loss: 0.1722, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   2, Avg loss: 0.1470, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.6287, Accuracy: 150/10000 (1.5000%)
time spent on training: 230.30093789100647
___Test Target_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.7886, Accuracy: 130/10000 (1.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 66: Avg loss: 0.9774, Accuracy: 7842/9950 (78.8141%)
saving model
Done in 634.9828400611877 sec.
Server Epoch:67 choose agents : [65, 12, 41, 56, 19, 23, 37, 45, 96, 9].
poison local model 65 index 23 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   1, Average loss: 0.0577, Accuracy: 555/1475 (37.6271%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   2, Average loss: 0.0265, Accuracy: 869/1475 (58.9153%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   3, Average loss: 0.0220, Accuracy: 901/1475 (61.0847%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   4, Average loss: 0.0214, Accuracy: 930/1475 (63.0508%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   5, Average loss: 0.0208, Accuracy: 949/1475 (64.3390%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   6, Average loss: 0.0200, Accuracy: 943/1475 (63.9322%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   7, Average loss: 0.0205, Accuracy: 945/1475 (64.0678%), train_poison_data_count: 463
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   8, Average loss: 0.0197, Accuracy: 946/1475 (64.1356%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   9, Average loss: 0.0198, Accuracy: 948/1475 (64.2712%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch  10, Average loss: 0.0200, Accuracy: 962/1475 (65.2203%), train_poison_data_count: 463
Global model norm: 111.56442137701204.
Norm before scaling: 111.53588618130938. Distance: 1.2181444864686375
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.2438, Accuracy: 96/10000 (0.9600%)
___Test Local_ResNet_18 poisoned: True, epoch: 67: Avg loss: 1.7225, Accuracy: 3359/9950 (33.7588%)
Scaling by  100
Scaled Norm after poisoning: 162.78910580487258, distance: 121.81445210724178
Total norm for 4 adversaries is: 162.78910580487258. distance: 121.81445210724178
___Test Local_ResNet_18 poisoned: True, epoch: 67: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   1, Avg loss: 0.1150, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   2, Avg loss: 0.0656, Accuracy: 26/338 (7.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.4607, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   1, Avg loss: 0.0854, Accuracy: 107/719 (14.8818%)
___Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   2, Avg loss: 0.0408, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.6729, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.1197, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.1022, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.3724, Accuracy: 154/10000 (1.5400%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0658, Accuracy: 260/1036 (25.0965%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0234, Accuracy: 721/1036 (69.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 12.1117, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   1, Avg loss: 0.0917, Accuracy: 85/715 (11.8881%)
___Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   2, Avg loss: 0.0476, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.9347, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   1, Avg loss: 0.0618, Accuracy: 316/1129 (27.9894%)
___Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   2, Avg loss: 0.0215, Accuracy: 777/1129 (68.8220%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.5517, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   1, Avg loss: 0.0937, Accuracy: 31/669 (4.6338%)
___Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   2, Avg loss: 0.0443, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.5805, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.1087, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0757, Accuracy: 18/311 (5.7878%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.3009, Accuracy: 110/10000 (1.1000%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   1, Avg loss: 0.0597, Accuracy: 296/1275 (23.2157%)
___Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   2, Avg loss: 0.0147, Accuracy: 883/1275 (69.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.4021, Accuracy: 136/10000 (1.3600%)
time spent on training: 270.47032499313354
___Test Target_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.2027, Accuracy: 99/10000 (0.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 67: Avg loss: 2.0702, Accuracy: 2275/9950 (22.8643%)
saving model
Done in 680.5055191516876 sec.
Server Epoch:68 choose agents : [30, 17, 54, 91, 69, 28, 65, 60, 9, 11].
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   1, Avg loss: 0.1110, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   2, Avg loss: 0.0489, Accuracy: 150/486 (30.8642%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.8105, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0692, Accuracy: 284/1574 (18.0432%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0264, Accuracy: 771/1574 (48.9835%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.3029, Accuracy: 118/10000 (1.1800%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   1, Avg loss: 0.0710, Accuracy: 199/1130 (17.6106%)
___Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   2, Avg loss: 0.0272, Accuracy: 552/1130 (48.8496%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.9815, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   1, Avg loss: 0.0670, Accuracy: 221/1030 (21.4563%)
___Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   2, Avg loss: 0.0270, Accuracy: 673/1030 (65.3398%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.7151, Accuracy: 116/10000 (1.1600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   1, Avg loss: 0.0957, Accuracy: 45/590 (7.6271%)
___Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   2, Avg loss: 0.0322, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 12.5922, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   1, Avg loss: 0.0705, Accuracy: 260/1581 (16.4453%)
___Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   2, Avg loss: 0.0325, Accuracy: 661/1581 (41.8090%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.3797, Accuracy: 109/10000 (1.0900%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   1, Avg loss: 0.0276, Accuracy: 743/1475 (50.3729%)
___Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   2, Avg loss: 0.0225, Accuracy: 875/1475 (59.3220%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.9954, Accuracy: 128/10000 (1.2800%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0451, Accuracy: 742/2227 (33.3184%)
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0239, Accuracy: 1231/2227 (55.2762%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.2524, Accuracy: 151/10000 (1.5100%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0646, Accuracy: 308/1275 (24.1569%)
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0150, Accuracy: 882/1275 (69.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 10.3194, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   1, Avg loss: 0.0869, Accuracy: 77/712 (10.8146%)
___Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   2, Avg loss: 0.0297, Accuracy: 451/712 (63.3427%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.4329, Accuracy: 76/10000 (0.7600%)
time spent on training: 280.3896198272705
___Test Target_ResNet_18 poisoned: False, epoch: 68: Avg loss: 6.9050, Accuracy: 98/10000 (0.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 68: Avg loss: 2.2788, Accuracy: 1971/9950 (19.8090%)
saving model
Done in 694.1473443508148 sec.
Server Epoch:69 choose agents : [69, 3, 66, 36, 78, 83, 8, 10, 93, 58].
poison local model 69 index 24 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Average loss: 0.0744, Accuracy: 146/590 (24.7458%), train_poison_data_count: 194
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Average loss: 0.0351, Accuracy: 284/590 (48.1356%), train_poison_data_count: 194
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   3, Average loss: 0.0286, Accuracy: 333/590 (56.4407%), train_poison_data_count: 194
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   4, Average loss: 0.0249, Accuracy: 351/590 (59.4915%), train_poison_data_count: 194
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   5, Average loss: 0.0252, Accuracy: 363/590 (61.5254%), train_poison_data_count: 194
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   6, Average loss: 0.0236, Accuracy: 387/590 (65.5932%), train_poison_data_count: 194
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   7, Average loss: 0.0233, Accuracy: 377/590 (63.8983%), train_poison_data_count: 194
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   8, Average loss: 0.0214, Accuracy: 416/590 (70.5085%), train_poison_data_count: 194
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   9, Average loss: 0.0214, Accuracy: 425/590 (72.0339%), train_poison_data_count: 194
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch  10, Average loss: 0.0213, Accuracy: 428/590 (72.5424%), train_poison_data_count: 194
Global model norm: 111.53239264615011.
Norm before scaling: 111.5207423601659. Distance: 0.7549131715500416
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.8424, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 69: Avg loss: 0.4855, Accuracy: 6974/9950 (70.0905%)
Scaling by  100
Scaled Norm after poisoning: 133.49736654705964, distance: 75.49131391466504
Total norm for 5 adversaries is: 133.49736654705964. distance: 75.49131391466504
___Test Local_ResNet_18 poisoned: True, epoch: 69: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   1, Avg loss: 0.0898, Accuracy: 9/781 (1.1524%)
___Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   2, Avg loss: 0.0347, Accuracy: 290/781 (37.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.0589, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   1, Avg loss: 0.0804, Accuracy: 162/1402 (11.5549%)
___Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   2, Avg loss: 0.0395, Accuracy: 460/1402 (32.8103%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.2700, Accuracy: 82/10000 (0.8200%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   1, Avg loss: 0.1125, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   2, Avg loss: 0.0603, Accuracy: 69/408 (16.9118%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.6778, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   1, Avg loss: 0.1138, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   2, Avg loss: 0.0601, Accuracy: 99/416 (23.7981%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.4807, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0683, Accuracy: 362/1953 (18.5356%)
___Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0320, Accuracy: 948/1953 (48.5407%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.3888, Accuracy: 150/10000 (1.5000%)
___Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   1, Avg loss: 0.0755, Accuracy: 173/1513 (11.4342%)
___Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   2, Avg loss: 0.0354, Accuracy: 540/1513 (35.6907%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.4289, Accuracy: 141/10000 (1.4100%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   1, Avg loss: 0.0781, Accuracy: 84/861 (9.7561%)
___Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   2, Avg loss: 0.0176, Accuracy: 550/861 (63.8792%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.6051, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   1, Avg loss: 0.0646, Accuracy: 342/1742 (19.6326%)
___Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   2, Avg loss: 0.0299, Accuracy: 829/1742 (47.5890%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.9599, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   1, Avg loss: 0.0781, Accuracy: 129/803 (16.0648%)
___Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   2, Avg loss: 0.0388, Accuracy: 452/803 (56.2889%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.1168, Accuracy: 60/10000 (0.6000%)
time spent on training: 303.9596138000488
___Test Target_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.7884, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 69: Avg loss: 0.6447, Accuracy: 6071/9950 (61.0151%)
saving model
Done in 707.5743567943573 sec.
Server Epoch:70 choose agents : [22, 18, 31, 35, 88, 66, 36, 14, 27, 48].
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0627, Accuracy: 416/1470 (28.2993%)
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 952/1470 (64.7619%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.1324, Accuracy: 101/10000 (1.0100%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   1, Avg loss: 0.1044, Accuracy: 0/530 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   2, Avg loss: 0.0363, Accuracy: 293/530 (55.2830%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.2240, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   1, Avg loss: 0.1188, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   2, Avg loss: 0.0487, Accuracy: 150/460 (32.6087%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.1094, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   1, Avg loss: 0.1378, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   2, Avg loss: 0.0844, Accuracy: 0/271 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.9726, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.0975, Accuracy: 11/603 (1.8242%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0460, Accuracy: 288/603 (47.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.7191, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0793, Accuracy: 203/1402 (14.4793%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0395, Accuracy: 474/1402 (33.8088%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.1188, Accuracy: 98/10000 (0.9800%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.1172, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0588, Accuracy: 78/408 (19.1176%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.5615, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   1, Avg loss: 0.0885, Accuracy: 71/1013 (7.0089%)
___Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   2, Avg loss: 0.0364, Accuracy: 395/1013 (38.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.7967, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   1, Avg loss: 0.0729, Accuracy: 274/1587 (17.2653%)
___Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   2, Avg loss: 0.0345, Accuracy: 645/1587 (40.6427%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.4177, Accuracy: 81/10000 (0.8100%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0929, Accuracy: 0/631 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0412, Accuracy: 273/631 (43.2647%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.3390, Accuracy: 83/10000 (0.8300%)
time spent on training: 212.8034951686859
___Test Target_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.1573, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 70: Avg loss: 0.6619, Accuracy: 6210/9950 (62.4121%)
saving model
Done in 612.9730136394501 sec.
Server Epoch:71 choose agents : [72, 77, 92, 31, 46, 66, 54, 0, 25, 36].
poison local model 72 index 25 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   1, Average loss: 0.0593, Accuracy: 411/1241 (33.1185%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   2, Average loss: 0.0297, Accuracy: 656/1241 (52.8606%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   3, Average loss: 0.0268, Accuracy: 701/1241 (56.4867%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   4, Average loss: 0.0260, Accuracy: 709/1241 (57.1313%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   5, Average loss: 0.0261, Accuracy: 706/1241 (56.8896%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   6, Average loss: 0.0262, Accuracy: 709/1241 (57.1313%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   7, Average loss: 0.0256, Accuracy: 715/1241 (57.6148%), train_poison_data_count: 400
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   8, Average loss: 0.0252, Accuracy: 716/1241 (57.6954%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   9, Average loss: 0.0246, Accuracy: 728/1241 (58.6624%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch  10, Average loss: 0.0246, Accuracy: 711/1241 (57.2925%), train_poison_data_count: 400
Global model norm: 111.51711699471296.
Norm before scaling: 111.49401346737187. Distance: 1.0679987938763384
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.1144, Accuracy: 80/10000 (0.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 71: Avg loss: 0.4872, Accuracy: 8746/9950 (87.8995%)
Scaling by  100
Scaled Norm after poisoning: 152.35807945429084, distance: 106.79987308337496
Total norm for 5 adversaries is: 152.35807945429084. distance: 106.79987308337496
___Test Local_ResNet_18 poisoned: True, epoch: 71: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0618, Accuracy: 232/1340 (17.3134%)
___Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0252, Accuracy: 688/1340 (51.3433%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.3736, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   1, Avg loss: 0.0647, Accuracy: 367/1715 (21.3994%)
___Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   2, Avg loss: 0.0277, Accuracy: 879/1715 (51.2536%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.3046, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   1, Avg loss: 0.1094, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   2, Avg loss: 0.0465, Accuracy: 145/460 (31.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.0816, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   1, Avg loss: 0.0649, Accuracy: 358/1904 (18.8025%)
___Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   2, Avg loss: 0.0291, Accuracy: 830/1904 (43.5924%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.8618, Accuracy: 138/10000 (1.3800%)
___Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   1, Avg loss: 0.0766, Accuracy: 168/1402 (11.9829%)
___Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 459/1402 (32.7389%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.1276, Accuracy: 98/10000 (0.9800%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   1, Avg loss: 0.0647, Accuracy: 224/1130 (19.8230%)
___Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   2, Avg loss: 0.0258, Accuracy: 623/1130 (55.1327%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.5606, Accuracy: 100/10000 (1.0000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   1, Avg loss: 0.0671, Accuracy: 291/1657 (17.5619%)
___Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   2, Avg loss: 0.0328, Accuracy: 610/1657 (36.8135%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.5537, Accuracy: 88/10000 (0.8800%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   1, Avg loss: 0.0804, Accuracy: 112/690 (16.2319%)
___Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   2, Avg loss: 0.0263, Accuracy: 459/690 (66.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.3394, Accuracy: 75/10000 (0.7500%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   1, Avg loss: 0.1080, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   2, Avg loss: 0.0580, Accuracy: 93/408 (22.7941%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 6.5985, Accuracy: 51/10000 (0.5100%)
time spent on training: 324.9911687374115
___Test Target_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.0700, Accuracy: 86/10000 (0.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Avg loss: 0.7034, Accuracy: 7736/9950 (77.7487%)
saving model
Done in 731.6478292942047 sec.
Server Epoch:72 choose agents : [7, 99, 12, 11, 10, 15, 85, 26, 14, 29].
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0832, Accuracy: 135/891 (15.1515%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0308, Accuracy: 489/891 (54.8822%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.2076, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0874, Accuracy: 43/773 (5.5627%)
___Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0354, Accuracy: 419/773 (54.2044%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.5204, Accuracy: 79/10000 (0.7900%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   1, Avg loss: 0.1201, Accuracy: 1/338 (0.2959%)
___Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   2, Avg loss: 0.0686, Accuracy: 14/338 (4.1420%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.2857, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   1, Avg loss: 0.0843, Accuracy: 92/712 (12.9213%)
___Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   2, Avg loss: 0.0305, Accuracy: 449/712 (63.0618%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.0259, Accuracy: 72/10000 (0.7200%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   1, Avg loss: 0.0798, Accuracy: 74/861 (8.5947%)
___Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   2, Avg loss: 0.0185, Accuracy: 557/861 (64.6922%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.6569, Accuracy: 117/10000 (1.1700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   1, Avg loss: 0.0758, Accuracy: 179/1154 (15.5113%)
___Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   2, Avg loss: 0.0272, Accuracy: 573/1154 (49.6534%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.6298, Accuracy: 108/10000 (1.0800%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   1, Avg loss: 0.0703, Accuracy: 330/1988 (16.5996%)
___Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 727/1988 (36.5694%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.5244, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   1, Avg loss: 0.0728, Accuracy: 188/1446 (13.0014%)
___Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 570/1446 (39.4191%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.6408, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   1, Avg loss: 0.0885, Accuracy: 48/1013 (4.7384%)
___Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   2, Avg loss: 0.0375, Accuracy: 363/1013 (35.8342%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.7722, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   1, Avg loss: 0.0667, Accuracy: 270/1440 (18.7500%)
___Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 779/1440 (54.0972%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.6899, Accuracy: 92/10000 (0.9200%)
time spent on training: 252.93587398529053
___Test Target_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.7251, Accuracy: 92/10000 (0.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Avg loss: 1.6088, Accuracy: 5246/9950 (52.7236%)
saving model
Done in 659.1074910163879 sec.
Server Epoch:73 choose agents : [74, 81, 71, 96, 73, 8, 10, 55, 33, 35].
poison local model 74 index 26 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   1, Average loss: 0.0483, Accuracy: 600/1552 (38.6598%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   2, Average loss: 0.0169, Accuracy: 1001/1552 (64.4974%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   3, Average loss: 0.0150, Accuracy: 1033/1552 (66.5593%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   4, Average loss: 0.0152, Accuracy: 1064/1552 (68.5567%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   5, Average loss: 0.0154, Accuracy: 1046/1552 (67.3969%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   6, Average loss: 0.0148, Accuracy: 1052/1552 (67.7835%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   7, Average loss: 0.0146, Accuracy: 1089/1552 (70.1675%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   8, Average loss: 0.0145, Accuracy: 1074/1552 (69.2010%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   9, Average loss: 0.0136, Accuracy: 1076/1552 (69.3299%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch  10, Average loss: 0.0138, Accuracy: 1102/1552 (71.0052%), train_poison_data_count: 496
Global model norm: 111.49002810649704.
Norm before scaling: 111.46191631702058. Distance: 1.2162419457477667
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.8580, Accuracy: 100/10000 (1.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 73: Avg loss: 0.8538, Accuracy: 6519/9950 (65.5176%)
Scaling by  100
Scaled Norm after poisoning: 162.62809254361622, distance: 121.62419305359235
Total norm for 5 adversaries is: 162.62809254361622. distance: 121.62419305359235
___Test Local_ResNet_18 poisoned: True, epoch: 73: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0776, Accuracy: 100/774 (12.9199%)
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0410, Accuracy: 402/774 (51.9380%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.5766, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0873, Accuracy: 26/818 (3.1785%)
___Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0326, Accuracy: 432/818 (52.8117%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.0573, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.1110, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0796, Accuracy: 6/311 (1.9293%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.0737, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   1, Avg loss: 0.0791, Accuracy: 114/938 (12.1535%)
___Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   2, Avg loss: 0.0342, Accuracy: 377/938 (40.1919%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.7801, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   1, Avg loss: 0.0740, Accuracy: 164/1513 (10.8394%)
___Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   2, Avg loss: 0.0361, Accuracy: 533/1513 (35.2280%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.3583, Accuracy: 136/10000 (1.3600%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0746, Accuracy: 99/861 (11.4983%)
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0180, Accuracy: 576/861 (66.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.5498, Accuracy: 118/10000 (1.1800%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   1, Avg loss: 0.0667, Accuracy: 195/1071 (18.2073%)
___Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   2, Avg loss: 0.0265, Accuracy: 579/1071 (54.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.8925, Accuracy: 104/10000 (1.0400%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.1090, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0629, Accuracy: 88/515 (17.0874%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.1965, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   1, Avg loss: 0.1265, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   2, Avg loss: 0.0890, Accuracy: 0/271 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.0580, Accuracy: 76/10000 (0.7600%)
time spent on training: 296.44900274276733
___Test Target_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.8364, Accuracy: 100/10000 (1.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Avg loss: 1.2779, Accuracy: 5264/9950 (52.9045%)
saving model
Done in 701.5319159030914 sec.
Server Epoch:74 choose agents : [50, 33, 10, 20, 28, 37, 46, 27, 93, 60].
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.1014, Accuracy: 9/809 (1.1125%)
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 388/809 (47.9604%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.8634, Accuracy: 129/10000 (1.2900%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   1, Avg loss: 0.1394, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   2, Avg loss: 0.0701, Accuracy: 51/515 (9.9029%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 6.3563, Accuracy: 86/10000 (0.8600%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   1, Avg loss: 0.0972, Accuracy: 37/861 (4.2973%)
___Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   2, Avg loss: 0.0182, Accuracy: 559/861 (64.9245%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.5132, Accuracy: 117/10000 (1.1700%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   1, Avg loss: 0.0991, Accuracy: 49/807 (6.0719%)
___Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   2, Avg loss: 0.0354, Accuracy: 429/807 (53.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.2592, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0811, Accuracy: 224/1581 (14.1682%)
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0329, Accuracy: 680/1581 (43.0108%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.3761, Accuracy: 103/10000 (1.0300%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0806, Accuracy: 248/1129 (21.9663%)
___Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0218, Accuracy: 775/1129 (68.6448%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.2123, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   1, Avg loss: 0.0772, Accuracy: 292/1904 (15.3361%)
___Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   2, Avg loss: 0.0296, Accuracy: 814/1904 (42.7521%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.6550, Accuracy: 148/10000 (1.4800%)
___Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   1, Avg loss: 0.0839, Accuracy: 229/1587 (14.4297%)
___Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   2, Avg loss: 0.0347, Accuracy: 644/1587 (40.5797%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.2542, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0734, Accuracy: 310/1742 (17.7956%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0301, Accuracy: 796/1742 (45.6946%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.8749, Accuracy: 125/10000 (1.2500%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   1, Avg loss: 0.0558, Accuracy: 635/2227 (28.5137%)
___Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   2, Avg loss: 0.0244, Accuracy: 1200/2227 (53.8841%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.7729, Accuracy: 173/10000 (1.7300%)
time spent on training: 291.724901676178
___Test Target_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.1982, Accuracy: 102/10000 (1.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Avg loss: 1.6995, Accuracy: 4491/9950 (45.1357%)
saving model
Done in 695.946177482605 sec.
Server Epoch:75 choose agents : [78, 51, 85, 6, 92, 32, 29, 40, 95, 74].
poison local model 78 index 27 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   1, Average loss: 0.0880, Accuracy: 117/416 (28.1250%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   2, Average loss: 0.0597, Accuracy: 135/416 (32.4519%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   3, Average loss: 0.0419, Accuracy: 149/416 (35.8173%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   4, Average loss: 0.0388, Accuracy: 170/416 (40.8654%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   5, Average loss: 0.0370, Accuracy: 206/416 (49.5192%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   6, Average loss: 0.0355, Accuracy: 231/416 (55.5288%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   7, Average loss: 0.0335, Accuracy: 252/416 (60.5769%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   8, Average loss: 0.0307, Accuracy: 266/416 (63.9423%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   9, Average loss: 0.0306, Accuracy: 267/416 (64.1827%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch  10, Average loss: 0.0315, Accuracy: 264/416 (63.4615%), train_poison_data_count: 140
Global model norm: 111.45760562457144.
Norm before scaling: 111.44819511913371. Distance: 0.6748896102355375
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.2038, Accuracy: 89/10000 (0.8900%)
___Test Local_ResNet_18 poisoned: True, epoch: 75: Avg loss: 0.3882, Accuracy: 9550/9950 (95.9799%)
Scaling by  100
Scaled Norm after poisoning: 129.3133684721924, distance: 67.48896032407819
Total norm for 4 adversaries is: 129.3133684721924. distance: 67.48896032407819
___Test Local_ResNet_18 poisoned: True, epoch: 75: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   1, Avg loss: 0.0886, Accuracy: 113/1049 (10.7722%)
___Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   2, Avg loss: 0.0284, Accuracy: 536/1049 (51.0963%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.8432, Accuracy: 134/10000 (1.3400%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0740, Accuracy: 319/1988 (16.0463%)
___Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0343, Accuracy: 768/1988 (38.6318%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.4909, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   1, Avg loss: 0.0712, Accuracy: 286/1956 (14.6217%)
___Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   2, Avg loss: 0.0299, Accuracy: 785/1956 (40.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.6869, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   1, Avg loss: 0.0737, Accuracy: 284/1715 (16.5598%)
___Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   2, Avg loss: 0.0284, Accuracy: 845/1715 (49.2711%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.0968, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   1, Avg loss: 0.0889, Accuracy: 71/735 (9.6599%)
___Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   2, Avg loss: 0.0211, Accuracy: 392/735 (53.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.2064, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   1, Avg loss: 0.0729, Accuracy: 243/1440 (16.8750%)
___Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   2, Avg loss: 0.0274, Accuracy: 774/1440 (53.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.6922, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0696, Accuracy: 263/1573 (16.7196%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0336, Accuracy: 693/1573 (44.0559%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.5955, Accuracy: 109/10000 (1.0900%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   1, Avg loss: 0.1037, Accuracy: 18/599 (3.0050%)
___Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   2, Avg loss: 0.0280, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 12.1526, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0197, Accuracy: 898/1552 (57.8608%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0165, Accuracy: 977/1552 (62.9510%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.3127, Accuracy: 124/10000 (1.2400%)
time spent on training: 323.12728786468506
___Test Target_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.0774, Accuracy: 83/10000 (0.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Avg loss: 0.5632, Accuracy: 8872/9950 (89.1658%)
saving model
Done in 744.0157976150513 sec.
Server Epoch:76 choose agents : [6, 5, 30, 19, 88, 49, 14, 57, 85, 92].
___Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   1, Avg loss: 0.0631, Accuracy: 319/1956 (16.3088%)
___Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   2, Avg loss: 0.0300, Accuracy: 751/1956 (38.3947%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.6982, Accuracy: 119/10000 (1.1900%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0578, Accuracy: 413/1628 (25.3686%)
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0202, Accuracy: 1055/1628 (64.8034%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.8871, Accuracy: 180/10000 (1.8000%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   1, Avg loss: 0.0977, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   2, Avg loss: 0.0473, Accuracy: 158/486 (32.5103%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.2263, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   1, Avg loss: 0.0565, Accuracy: 311/1036 (30.0193%)
___Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   2, Avg loss: 0.0211, Accuracy: 729/1036 (70.3668%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 10.7319, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0901, Accuracy: 10/603 (1.6584%)
___Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0474, Accuracy: 283/603 (46.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.3304, Accuracy: 70/10000 (0.7000%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   1, Avg loss: 0.0912, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   2, Avg loss: 0.0532, Accuracy: 83/440 (18.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 6.1397, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0825, Accuracy: 63/1013 (6.2192%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0362, Accuracy: 409/1013 (40.3751%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.6514, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   1, Avg loss: 0.0743, Accuracy: 148/1154 (12.8250%)
___Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   2, Avg loss: 0.0269, Accuracy: 570/1154 (49.3934%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.1276, Accuracy: 96/10000 (0.9600%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   1, Avg loss: 0.0661, Accuracy: 361/1988 (18.1590%)
___Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   2, Avg loss: 0.0343, Accuracy: 817/1988 (41.0966%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.5103, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0637, Accuracy: 311/1715 (18.1341%)
___Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0277, Accuracy: 899/1715 (52.4198%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.0396, Accuracy: 123/10000 (1.2300%)
time spent on training: 275.1411600112915
___Test Target_ResNet_18 poisoned: False, epoch: 76: Avg loss: 5.9310, Accuracy: 89/10000 (0.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Avg loss: 0.8417, Accuracy: 7992/9950 (80.3216%)
saving model
Done in 699.8268084526062 sec.
Server Epoch:77 choose agents : [81, 75, 66, 1, 61, 65, 79, 49, 94, 10].
poison local model 81 index 28 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   1, Average loss: 0.0616, Accuracy: 220/774 (28.4238%), train_poison_data_count: 246
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   2, Average loss: 0.0348, Accuracy: 396/774 (51.1628%), train_poison_data_count: 246
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   3, Average loss: 0.0259, Accuracy: 473/774 (61.1111%), train_poison_data_count: 246
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   4, Average loss: 0.0254, Accuracy: 477/774 (61.6279%), train_poison_data_count: 246
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   5, Average loss: 0.0246, Accuracy: 480/774 (62.0155%), train_poison_data_count: 246
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   6, Average loss: 0.0250, Accuracy: 476/774 (61.4987%), train_poison_data_count: 246
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   7, Average loss: 0.0250, Accuracy: 482/774 (62.2739%), train_poison_data_count: 246
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   8, Average loss: 0.0239, Accuracy: 489/774 (63.1783%), train_poison_data_count: 246
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   9, Average loss: 0.0233, Accuracy: 481/774 (62.1447%), train_poison_data_count: 246
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch  10, Average loss: 0.0231, Accuracy: 510/774 (65.8915%), train_poison_data_count: 246
Global model norm: 111.44352900123901.
Norm before scaling: 111.43097551707739. Distance: 0.8342603811910467
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.7782, Accuracy: 80/10000 (0.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 77: Avg loss: 0.9451, Accuracy: 5948/9950 (59.7789%)
Scaling by  100
Scaled Norm after poisoning: 137.9504199318545, distance: 83.4260350269177
Total norm for 5 adversaries is: 137.9504199318545. distance: 83.4260350269177
___Test Local_ResNet_18 poisoned: True, epoch: 77: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   1, Avg loss: 0.0820, Accuracy: 67/776 (8.6340%)
___Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   2, Avg loss: 0.0297, Accuracy: 444/776 (57.2165%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.8656, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0728, Accuracy: 177/1402 (12.6248%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0394, Accuracy: 473/1402 (33.7375%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.9741, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   1, Avg loss: 0.0714, Accuracy: 175/928 (18.8578%)
___Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   2, Avg loss: 0.0225, Accuracy: 636/928 (68.5345%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.4051, Accuracy: 118/10000 (1.1800%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1413, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1324, Accuracy: 1/85 (1.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.8903, Accuracy: 107/10000 (1.0700%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   1, Avg loss: 0.0454, Accuracy: 469/1475 (31.7966%)
___Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   2, Avg loss: 0.0242, Accuracy: 854/1475 (57.8983%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.5564, Accuracy: 146/10000 (1.4600%)
___Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   1, Avg loss: 0.1354, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   2, Avg loss: 0.1156, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.7803, Accuracy: 90/10000 (0.9000%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0863, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0519, Accuracy: 97/440 (22.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.1096, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0676, Accuracy: 251/1662 (15.1023%)
___Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0315, Accuracy: 750/1662 (45.1264%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.5206, Accuracy: 147/10000 (1.4700%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   1, Avg loss: 0.0701, Accuracy: 113/861 (13.1243%)
___Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   2, Avg loss: 0.0179, Accuracy: 586/861 (68.0604%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 9.1536, Accuracy: 120/10000 (1.2000%)
time spent on training: 293.99479842185974
___Test Target_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.7669, Accuracy: 78/10000 (0.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Avg loss: 1.0551, Accuracy: 5308/9950 (53.3467%)
saving model
Done in 705.2715377807617 sec.
Server Epoch:78 choose agents : [42, 6, 82, 30, 19, 31, 93, 7, 5, 16].
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   1, Avg loss: 0.0671, Accuracy: 237/1372 (17.2741%)
___Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   2, Avg loss: 0.0287, Accuracy: 634/1372 (46.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.2562, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   1, Avg loss: 0.0641, Accuracy: 329/1956 (16.8200%)
___Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   2, Avg loss: 0.0302, Accuracy: 752/1956 (38.4458%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.6462, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   1, Avg loss: 0.1000, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   2, Avg loss: 0.0576, Accuracy: 135/500 (27.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.5267, Accuracy: 59/10000 (0.5900%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.1055, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0486, Accuracy: 134/486 (27.5720%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.2120, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   1, Avg loss: 0.0611, Accuracy: 273/1036 (26.3514%)
___Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   2, Avg loss: 0.0211, Accuracy: 747/1036 (72.1042%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 10.8867, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   1, Avg loss: 0.1048, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   2, Avg loss: 0.0463, Accuracy: 136/460 (29.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.8099, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   1, Avg loss: 0.0631, Accuracy: 361/1742 (20.7233%)
___Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   2, Avg loss: 0.0300, Accuracy: 788/1742 (45.2354%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.7199, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   1, Avg loss: 0.0817, Accuracy: 124/891 (13.9169%)
___Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   2, Avg loss: 0.0297, Accuracy: 496/891 (55.6678%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.9420, Accuracy: 86/10000 (0.8600%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   1, Avg loss: 0.0608, Accuracy: 392/1628 (24.0786%)
___Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   2, Avg loss: 0.0203, Accuracy: 1041/1628 (63.9435%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.8116, Accuracy: 177/10000 (1.7700%)
___Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   1, Avg loss: 0.0920, Accuracy: 68/708 (9.6045%)
___Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   2, Avg loss: 0.0451, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.9543, Accuracy: 50/10000 (0.5000%)
time spent on training: 253.45581030845642
___Test Target_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.4075, Accuracy: 82/10000 (0.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Avg loss: 1.3788, Accuracy: 4380/9950 (44.0201%)
saving model
Done in 666.8813719749451 sec.
Server Epoch:79 choose agents : [84, 82, 36, 58, 27, 49, 61, 52, 90, 85].
poison local model 84 index 29 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   1, Average loss: 0.0619, Accuracy: 390/1190 (32.7731%), train_poison_data_count: 380
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   2, Average loss: 0.0324, Accuracy: 595/1190 (50.0000%), train_poison_data_count: 380
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   3, Average loss: 0.0247, Accuracy: 676/1190 (56.8067%), train_poison_data_count: 380
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   4, Average loss: 0.0239, Accuracy: 715/1190 (60.0840%), train_poison_data_count: 380
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   5, Average loss: 0.0241, Accuracy: 673/1190 (56.5546%), train_poison_data_count: 380
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   6, Average loss: 0.0231, Accuracy: 709/1190 (59.5798%), train_poison_data_count: 380
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   7, Average loss: 0.0230, Accuracy: 705/1190 (59.2437%), train_poison_data_count: 380
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   8, Average loss: 0.0221, Accuracy: 727/1190 (61.0924%), train_poison_data_count: 380
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   9, Average loss: 0.0222, Accuracy: 725/1190 (60.9244%), train_poison_data_count: 380
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch  10, Average loss: 0.0217, Accuracy: 728/1190 (61.1765%), train_poison_data_count: 380
Global model norm: 111.42763206449287.
Norm before scaling: 111.40607468429404. Distance: 1.0842090270797624
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.7587, Accuracy: 92/10000 (0.9200%)
___Test Local_ResNet_18 poisoned: True, epoch: 79: Avg loss: 2.1263, Accuracy: 2394/9950 (24.0603%)
Scaling by  100
Scaled Norm after poisoning: 153.5353494007976, distance: 108.42090110709742
Total norm for 5 adversaries is: 153.5353494007976. distance: 108.42090110709742
___Test Local_ResNet_18 poisoned: True, epoch: 79: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   1, Avg loss: 0.0944, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   2, Avg loss: 0.0563, Accuracy: 142/500 (28.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.5409, Accuracy: 64/10000 (0.6400%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   1, Avg loss: 0.1082, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   2, Avg loss: 0.0629, Accuracy: 64/408 (15.6863%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.1810, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   1, Avg loss: 0.0786, Accuracy: 119/803 (14.8194%)
___Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   2, Avg loss: 0.0397, Accuracy: 456/803 (56.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.9255, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0706, Accuracy: 285/1587 (17.9584%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0343, Accuracy: 654/1587 (41.2098%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.2861, Accuracy: 81/10000 (0.8100%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   1, Avg loss: 0.0944, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   2, Avg loss: 0.0549, Accuracy: 77/440 (17.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.0646, Accuracy: 71/10000 (0.7100%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   1, Avg loss: 0.1587, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   2, Avg loss: 0.1522, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.2189, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0806, Accuracy: 66/636 (10.3774%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0342, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.2726, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   1, Avg loss: 0.0830, Accuracy: 65/677 (9.6012%)
___Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   2, Avg loss: 0.0244, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.3284, Accuracy: 54/10000 (0.5400%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0656, Accuracy: 361/1988 (18.1590%)
___Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 843/1988 (42.4044%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.4990, Accuracy: 112/10000 (1.1200%)
time spent on training: 295.2223720550537
___Test Target_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.6894, Accuracy: 95/10000 (0.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Avg loss: 2.5971, Accuracy: 1451/9950 (14.5829%)
saving model
Done in 717.2104778289795 sec.
Server Epoch:80 choose agents : [46, 75, 54, 3, 89, 69, 41, 1, 93, 71].
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0691, Accuracy: 328/1904 (17.2269%)
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0299, Accuracy: 821/1904 (43.1197%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.5769, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0930, Accuracy: 41/776 (5.2835%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0334, Accuracy: 426/776 (54.8969%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.8607, Accuracy: 105/10000 (1.0500%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   1, Avg loss: 0.0727, Accuracy: 168/1130 (14.8673%)
___Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 575/1130 (50.8850%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.3519, Accuracy: 106/10000 (1.0600%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   1, Avg loss: 0.0911, Accuracy: 3/781 (0.3841%)
___Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   2, Avg loss: 0.0388, Accuracy: 295/781 (37.7721%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.5234, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0869, Accuracy: 118/896 (13.1696%)
___Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0386, Accuracy: 500/896 (55.8036%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 6.9434, Accuracy: 76/10000 (0.7600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   1, Avg loss: 0.0935, Accuracy: 16/590 (2.7119%)
___Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   2, Avg loss: 0.0290, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.9259, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   1, Avg loss: 0.0921, Accuracy: 67/719 (9.3185%)
___Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   2, Avg loss: 0.0392, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.6140, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   1, Avg loss: 0.0789, Accuracy: 130/928 (14.0086%)
___Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   2, Avg loss: 0.0230, Accuracy: 635/928 (68.4267%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.4668, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   1, Avg loss: 0.0651, Accuracy: 332/1742 (19.0586%)
___Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   2, Avg loss: 0.0307, Accuracy: 774/1742 (44.4317%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.7028, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   1, Avg loss: 0.0720, Accuracy: 129/818 (15.7702%)
___Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   2, Avg loss: 0.0289, Accuracy: 394/818 (48.1663%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.2785, Accuracy: 95/10000 (0.9500%)
time spent on training: 248.76318287849426
___Test Target_ResNet_18 poisoned: False, epoch: 80: Avg loss: 6.3711, Accuracy: 119/10000 (1.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Avg loss: 3.5632, Accuracy: 593/9950 (5.9598%)
saving model
Done in 663.4019265174866 sec.
Server Epoch:81 choose agents : [85, 15, 81, 53, 39, 54, 28, 61, 0, 51].
poison local model 85 index 30 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   1, Average loss: 0.0541, Accuracy: 690/1988 (34.7082%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   2, Average loss: 0.0282, Accuracy: 1042/1988 (52.4145%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   3, Average loss: 0.0253, Accuracy: 1079/1988 (54.2757%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   4, Average loss: 0.0260, Accuracy: 1099/1988 (55.2817%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   5, Average loss: 0.0250, Accuracy: 1109/1988 (55.7847%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   6, Average loss: 0.0248, Accuracy: 1129/1988 (56.7907%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   7, Average loss: 0.0244, Accuracy: 1121/1988 (56.3883%), train_poison_data_count: 624
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   8, Average loss: 0.0243, Accuracy: 1112/1988 (55.9356%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   9, Average loss: 0.0239, Accuracy: 1133/1988 (56.9920%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch  10, Average loss: 0.0241, Accuracy: 1121/1988 (56.3883%), train_poison_data_count: 624
Global model norm: 111.40279622977378.
Norm before scaling: 111.36498183759336. Distance: 1.3080409006641818
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.3305, Accuracy: 98/10000 (0.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 81: Avg loss: 1.2324, Accuracy: 6053/9950 (60.8342%)
Scaling by  100
Scaled Norm after poisoning: 168.8398371978604, distance: 130.80408626788002
Total norm for 6 adversaries is: 168.8398371978604. distance: 130.80408626788002
___Test Local_ResNet_18 poisoned: True, epoch: 81: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0747, Accuracy: 166/1154 (14.3847%)
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0278, Accuracy: 553/1154 (47.9203%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.2241, Accuracy: 129/10000 (1.2900%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0632, Accuracy: 128/774 (16.5375%)
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0305, Accuracy: 417/774 (53.8760%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.9065, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0831, Accuracy: 68/813 (8.3641%)
___Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0197, Accuracy: 436/813 (53.6285%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 11.0932, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   1, Avg loss: 0.0776, Accuracy: 111/1013 (10.9576%)
___Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   2, Avg loss: 0.0275, Accuracy: 511/1013 (50.4442%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.4107, Accuracy: 89/10000 (0.8900%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0698, Accuracy: 174/1130 (15.3982%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0278, Accuracy: 580/1130 (51.3274%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.2606, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   1, Avg loss: 0.0691, Accuracy: 250/1581 (15.8128%)
___Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   2, Avg loss: 0.0324, Accuracy: 704/1581 (44.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.3378, Accuracy: 101/10000 (1.0100%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1601, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1526, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 6.2172, Accuracy: 113/10000 (1.1300%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   1, Avg loss: 0.0701, Accuracy: 240/1657 (14.4840%)
___Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   2, Avg loss: 0.0343, Accuracy: 580/1657 (35.0030%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.3917, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   1, Avg loss: 0.0771, Accuracy: 132/1049 (12.5834%)
___Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   2, Avg loss: 0.0284, Accuracy: 531/1049 (50.6196%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.8105, Accuracy: 128/10000 (1.2800%)
time spent on training: 353.2147297859192
___Test Target_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.3230, Accuracy: 97/10000 (0.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Avg loss: 1.7565, Accuracy: 4128/9950 (41.4874%)
saving model
Done in 764.7376232147217 sec.
Server Epoch:82 choose agents : [23, 74, 72, 38, 79, 44, 28, 77, 55, 70].
___Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   1, Avg loss: 0.1055, Accuracy: 35/715 (4.8951%)
___Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   2, Avg loss: 0.0481, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.0826, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0524, Accuracy: 439/1552 (28.2861%)
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0175, Accuracy: 931/1552 (59.9871%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 10.2031, Accuracy: 115/10000 (1.1500%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0759, Accuracy: 149/1241 (12.0064%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0351, Accuracy: 556/1241 (44.8026%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.6865, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   1, Avg loss: 0.0884, Accuracy: 110/1131 (9.7259%)
___Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   2, Avg loss: 0.0327, Accuracy: 541/1131 (47.8338%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.7309, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1665, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.1401, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 6.7036, Accuracy: 94/10000 (0.9400%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0702, Accuracy: 311/1750 (17.7714%)
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0327, Accuracy: 803/1750 (45.8857%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.4406, Accuracy: 152/10000 (1.5200%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0681, Accuracy: 267/1581 (16.8880%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0323, Accuracy: 679/1581 (42.9475%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.3153, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   1, Avg loss: 0.0754, Accuracy: 154/1340 (11.4925%)
___Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   2, Avg loss: 0.0266, Accuracy: 676/1340 (50.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.5047, Accuracy: 115/10000 (1.1500%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   1, Avg loss: 0.0754, Accuracy: 166/1071 (15.4995%)
___Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   2, Avg loss: 0.0276, Accuracy: 581/1071 (54.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.8933, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   1, Avg loss: 0.0780, Accuracy: 236/1418 (16.6432%)
___Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 757/1418 (53.3850%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.9104, Accuracy: 111/10000 (1.1100%)
time spent on training: 279.78386330604553
___Test Target_ResNet_18 poisoned: False, epoch: 82: Avg loss: 6.9947, Accuracy: 102/10000 (1.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Avg loss: 2.2341, Accuracy: 2854/9950 (28.6834%)
saving model
Done in 684.1782629489899 sec.
Server Epoch:83 choose agents : [95, 76, 60, 48, 18, 10, 90, 78, 15, 89].
poison local model 95 index 31 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   1, Average loss: 0.0697, Accuracy: 178/599 (29.7162%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   2, Average loss: 0.0251, Accuracy: 448/599 (74.7913%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   3, Average loss: 0.0211, Accuracy: 484/599 (80.8013%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   4, Average loss: 0.0202, Accuracy: 484/599 (80.8013%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   5, Average loss: 0.0178, Accuracy: 501/599 (83.6394%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   6, Average loss: 0.0169, Accuracy: 515/599 (85.9766%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   7, Average loss: 0.0160, Accuracy: 510/599 (85.1419%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   8, Average loss: 0.0165, Accuracy: 508/599 (84.8080%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   9, Average loss: 0.0168, Accuracy: 504/599 (84.1402%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch  10, Average loss: 0.0143, Accuracy: 516/599 (86.1436%), train_poison_data_count: 200
Global model norm: 111.36091293486912.
Norm before scaling: 111.34962182805113. Distance: 0.7900994917836671
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.0619, Accuracy: 49/10000 (0.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 83: Avg loss: 0.6801, Accuracy: 6737/9950 (67.7085%)
Scaling by  100
Scaled Norm after poisoning: 135.38778217586696, distance: 79.0099504216083
Total norm for 7 adversaries is: 135.38778217586696. distance: 79.0099504216083
___Test Local_ResNet_18 poisoned: True, epoch: 83: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   1, Avg loss: 0.1129, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   2, Avg loss: 0.0584, Accuracy: 129/466 (27.6824%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.7914, Accuracy: 65/10000 (0.6500%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   1, Avg loss: 0.0547, Accuracy: 628/2227 (28.1994%)
___Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   2, Avg loss: 0.0248, Accuracy: 1196/2227 (53.7045%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.8177, Accuracy: 159/10000 (1.5900%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   1, Avg loss: 0.0979, Accuracy: 0/631 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   2, Avg loss: 0.0491, Accuracy: 228/631 (36.1331%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.9884, Accuracy: 85/10000 (0.8500%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.1083, Accuracy: 0/530 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0448, Accuracy: 221/530 (41.6981%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.8707, Accuracy: 66/10000 (0.6600%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   1, Avg loss: 0.0845, Accuracy: 51/861 (5.9233%)
___Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   2, Avg loss: 0.0196, Accuracy: 552/861 (64.1115%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 9.3189, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   1, Avg loss: 0.0898, Accuracy: 54/677 (7.9764%)
___Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   2, Avg loss: 0.0266, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 9.5665, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0991, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0522, Accuracy: 122/416 (29.3269%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.7117, Accuracy: 92/10000 (0.9200%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   1, Avg loss: 0.0778, Accuracy: 161/1154 (13.9515%)
___Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   2, Avg loss: 0.0289, Accuracy: 578/1154 (50.0867%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.2494, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   1, Avg loss: 0.0872, Accuracy: 110/896 (12.2768%)
___Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   2, Avg loss: 0.0379, Accuracy: 495/896 (55.2455%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.5185, Accuracy: 72/10000 (0.7200%)
time spent on training: 315.33256220817566
___Test Target_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.9968, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Avg loss: 0.8750, Accuracy: 5931/9950 (59.6080%)
saving model
Done in 727.5455358028412 sec.
Server Epoch:84 choose agents : [61, 28, 35, 75, 74, 90, 55, 80, 23, 88].
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.2034, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1804, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.2099, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0706, Accuracy: 239/1581 (15.1170%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0322, Accuracy: 686/1581 (43.3903%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.3849, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.1394, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0824, Accuracy: 3/271 (1.1070%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 6.0289, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   1, Avg loss: 0.0993, Accuracy: 46/776 (5.9278%)
___Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   2, Avg loss: 0.0326, Accuracy: 424/776 (54.6392%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.6339, Accuracy: 101/10000 (1.0100%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   1, Avg loss: 0.0542, Accuracy: 447/1552 (28.8015%)
___Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   2, Avg loss: 0.0175, Accuracy: 954/1552 (61.4691%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 9.8894, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   1, Avg loss: 0.0972, Accuracy: 50/677 (7.3855%)
___Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   2, Avg loss: 0.0266, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 9.0822, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0768, Accuracy: 177/1071 (16.5266%)
___Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0275, Accuracy: 555/1071 (51.8207%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.4221, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.1046, Accuracy: 17/682 (2.4927%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0440, Accuracy: 258/682 (37.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.0183, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   1, Avg loss: 0.1068, Accuracy: 46/715 (6.4336%)
___Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   2, Avg loss: 0.0457, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.8835, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.1082, Accuracy: 0/603 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0472, Accuracy: 281/603 (46.6003%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.4995, Accuracy: 63/10000 (0.6300%)
time spent on training: 225.882257938385
___Test Target_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.4661, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Avg loss: 1.6791, Accuracy: 2885/9950 (28.9950%)
saving model
Done in 638.3966493606567 sec.
Server Epoch:85 choose agents : [36, 56, 25, 90, 31, 70, 30, 21, 46, 64].
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   1, Avg loss: 0.1219, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   2, Avg loss: 0.0680, Accuracy: 55/408 (13.4804%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.0102, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   1, Avg loss: 0.1363, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   2, Avg loss: 0.1102, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.3547, Accuracy: 51/10000 (0.5100%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   1, Avg loss: 0.0922, Accuracy: 57/690 (8.2609%)
___Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 455/690 (65.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.6976, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   1, Avg loss: 0.0894, Accuracy: 70/677 (10.3397%)
___Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   2, Avg loss: 0.0253, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.8728, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.1099, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0464, Accuracy: 140/460 (30.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.7865, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   1, Avg loss: 0.0751, Accuracy: 267/1418 (18.8293%)
___Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   2, Avg loss: 0.0302, Accuracy: 758/1418 (53.4556%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.7747, Accuracy: 117/10000 (1.1700%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.1084, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0477, Accuracy: 143/486 (29.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.8040, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   1, Avg loss: 0.0664, Accuracy: 303/1949 (15.5464%)
___Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 739/1949 (37.9169%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.7809, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   1, Avg loss: 0.0709, Accuracy: 357/1904 (18.7500%)
___Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   2, Avg loss: 0.0308, Accuracy: 827/1904 (43.4349%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.4700, Accuracy: 157/10000 (1.5700%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0898, Accuracy: 57/953 (5.9811%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0415, Accuracy: 356/953 (37.3557%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.3391, Accuracy: 81/10000 (0.8100%)
time spent on training: 237.57215428352356
___Test Target_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.0068, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Avg loss: 2.0801, Accuracy: 1910/9950 (19.1960%)
saving model
Done in 646.7933547496796 sec.
Server Epoch:86 choose agents : [94, 50, 2, 53, 86, 67, 12, 69, 24, 81].
___Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   1, Avg loss: 0.0741, Accuracy: 241/1662 (14.5006%)
___Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   2, Avg loss: 0.0326, Accuracy: 728/1662 (43.8026%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.3392, Accuracy: 135/10000 (1.3500%)
___Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   1, Avg loss: 0.0857, Accuracy: 28/809 (3.4611%)
___Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   2, Avg loss: 0.0280, Accuracy: 359/809 (44.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.0337, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.1017, Accuracy: 2/605 (0.3306%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0471, Accuracy: 319/605 (52.7273%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.5911, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   1, Avg loss: 0.0767, Accuracy: 102/813 (12.5461%)
___Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 501/813 (61.6236%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.8501, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   1, Avg loss: 0.0783, Accuracy: 142/1003 (14.1575%)
___Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   2, Avg loss: 0.0377, Accuracy: 455/1003 (45.3639%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.3630, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   1, Avg loss: 0.1022, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   2, Avg loss: 0.0556, Accuracy: 113/426 (26.5258%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.3131, Accuracy: 50/10000 (0.5000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   1, Avg loss: 0.1159, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   2, Avg loss: 0.0659, Accuracy: 40/338 (11.8343%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 5.9919, Accuracy: 77/10000 (0.7700%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   1, Avg loss: 0.0943, Accuracy: 24/590 (4.0678%)
___Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   2, Avg loss: 0.0301, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.4649, Accuracy: 50/10000 (0.5000%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.1069, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0630, Accuracy: 26/312 (8.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 5.9519, Accuracy: 74/10000 (0.7400%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0709, Accuracy: 91/774 (11.7571%)
___Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0326, Accuracy: 410/774 (52.9716%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.5840, Accuracy: 84/10000 (0.8400%)
time spent on training: 228.85759854316711
___Test Target_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.6557, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Avg loss: 2.2960, Accuracy: 1581/9950 (15.8894%)
saving model
Done in 641.374673128128 sec.
Server Epoch:87 choose agents : [39, 80, 90, 83, 43, 57, 67, 2, 23, 36].
___Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   1, Avg loss: 0.0762, Accuracy: 125/1013 (12.3396%)
___Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 539/1013 (53.2083%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.4459, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   1, Avg loss: 0.0872, Accuracy: 37/682 (5.4252%)
___Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   2, Avg loss: 0.0427, Accuracy: 262/682 (38.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.1612, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   1, Avg loss: 0.0783, Accuracy: 92/677 (13.5894%)
___Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   2, Avg loss: 0.0251, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.8143, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   1, Avg loss: 0.0636, Accuracy: 389/1953 (19.9181%)
___Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   2, Avg loss: 0.0312, Accuracy: 979/1953 (50.1280%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.2772, Accuracy: 142/10000 (1.4200%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0835, Accuracy: 99/946 (10.4651%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0414, Accuracy: 393/946 (41.5433%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.7229, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0760, Accuracy: 151/1154 (13.0849%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0277, Accuracy: 564/1154 (48.8735%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.4387, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   1, Avg loss: 0.0961, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   2, Avg loss: 0.0541, Accuracy: 123/426 (28.8732%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.4132, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   1, Avg loss: 0.0971, Accuracy: 1/605 (0.1653%)
___Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   2, Avg loss: 0.0448, Accuracy: 324/605 (53.5537%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.4355, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0905, Accuracy: 73/715 (10.2098%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0432, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.6355, Accuracy: 50/10000 (0.5000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   1, Avg loss: 0.1086, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   2, Avg loss: 0.0658, Accuracy: 61/408 (14.9510%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.0156, Accuracy: 49/10000 (0.4900%)
time spent on training: 212.791508436203
___Test Target_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.3594, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Avg loss: 2.4602, Accuracy: 1447/9950 (14.5427%)
saving model
Done in 626.6595134735107 sec.
Server Epoch:88 choose agents : [4, 42, 28, 74, 13, 49, 24, 34, 87, 86].
___Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   1, Avg loss: 0.0801, Accuracy: 137/901 (15.2053%)
___Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   2, Avg loss: 0.0375, Accuracy: 481/901 (53.3851%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.4716, Accuracy: 73/10000 (0.7300%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   1, Avg loss: 0.0658, Accuracy: 226/1372 (16.4723%)
___Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   2, Avg loss: 0.0295, Accuracy: 652/1372 (47.5219%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.0727, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0614, Accuracy: 245/1581 (15.4965%)
___Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0316, Accuracy: 690/1581 (43.6433%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.2838, Accuracy: 113/10000 (1.1300%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   1, Avg loss: 0.0449, Accuracy: 493/1552 (31.7655%)
___Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   2, Avg loss: 0.0170, Accuracy: 960/1552 (61.8557%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.8022, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   1, Avg loss: 0.0673, Accuracy: 238/1645 (14.4681%)
___Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   2, Avg loss: 0.0313, Accuracy: 748/1645 (45.4711%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.5435, Accuracy: 135/10000 (1.3500%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   1, Avg loss: 0.0934, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   2, Avg loss: 0.0587, Accuracy: 83/440 (18.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.8393, Accuracy: 59/10000 (0.5900%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   1, Avg loss: 0.0953, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   2, Avg loss: 0.0597, Accuracy: 51/312 (16.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.8858, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0685, Accuracy: 243/1427 (17.0287%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 667/1427 (46.7414%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.2349, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   1, Avg loss: 0.0727, Accuracy: 161/1131 (14.2352%)
___Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   2, Avg loss: 0.0348, Accuracy: 431/1131 (38.1079%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.5609, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0729, Accuracy: 159/1003 (15.8524%)
___Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0378, Accuracy: 462/1003 (46.0618%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.3654, Accuracy: 71/10000 (0.7100%)
time spent on training: 281.90592885017395
___Test Target_ResNet_18 poisoned: False, epoch: 88: Avg loss: 6.1272, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Avg loss: 2.5137, Accuracy: 1786/9950 (17.9497%)
saving model
Done in 689.5927169322968 sec.
Server Epoch:89 choose agents : [84, 89, 29, 52, 37, 30, 66, 62, 88, 42].
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0559, Accuracy: 232/1190 (19.4958%)
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0275, Accuracy: 593/1190 (49.8319%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.5311, Accuracy: 140/10000 (1.4000%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0754, Accuracy: 146/896 (16.2946%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0357, Accuracy: 499/896 (55.6920%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.0483, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   1, Avg loss: 0.0635, Accuracy: 292/1440 (20.2778%)
___Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   2, Avg loss: 0.0272, Accuracy: 798/1440 (55.4167%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.6074, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   1, Avg loss: 0.0758, Accuracy: 81/636 (12.7358%)
___Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   2, Avg loss: 0.0320, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.8172, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   1, Avg loss: 0.0593, Accuracy: 308/1129 (27.2808%)
___Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   2, Avg loss: 0.0209, Accuracy: 807/1129 (71.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.8872, Accuracy: 121/10000 (1.2100%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   1, Avg loss: 0.0895, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   2, Avg loss: 0.0453, Accuracy: 164/486 (33.7449%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 6.9277, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0753, Accuracy: 179/1402 (12.7675%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0405, Accuracy: 498/1402 (35.5207%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 6.8329, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   1, Avg loss: 0.0795, Accuracy: 2/568 (0.3521%)
___Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   2, Avg loss: 0.0420, Accuracy: 250/568 (44.0141%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.2032, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   1, Avg loss: 0.0841, Accuracy: 5/603 (0.8292%)
___Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 291/603 (48.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.4157, Accuracy: 68/10000 (0.6800%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0638, Accuracy: 246/1372 (17.9300%)
___Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0290, Accuracy: 656/1372 (47.8134%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.0086, Accuracy: 110/10000 (1.1000%)
time spent on training: 260.75399589538574
___Test Target_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.9669, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Avg loss: 2.6070, Accuracy: 1954/9950 (19.6382%)
saving model
Done in 669.9488162994385 sec.
Server Epoch:90 choose agents : [43, 80, 99, 44, 67, 39, 70, 50, 86, 91].
___Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   1, Avg loss: 0.0780, Accuracy: 106/946 (11.2051%)
___Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   2, Avg loss: 0.0401, Accuracy: 415/946 (43.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 6.6551, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   1, Avg loss: 0.0789, Accuracy: 47/682 (6.8915%)
___Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   2, Avg loss: 0.0412, Accuracy: 260/682 (38.1232%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.2224, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   1, Avg loss: 0.0839, Accuracy: 56/773 (7.2445%)
___Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   2, Avg loss: 0.0322, Accuracy: 422/773 (54.5925%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.5766, Accuracy: 74/10000 (0.7400%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   1, Avg loss: 0.0605, Accuracy: 372/1750 (21.2571%)
___Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   2, Avg loss: 0.0324, Accuracy: 792/1750 (45.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.2789, Accuracy: 155/10000 (1.5500%)
___Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   1, Avg loss: 0.0852, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   2, Avg loss: 0.0516, Accuracy: 140/426 (32.8638%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 6.3277, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0699, Accuracy: 127/1013 (12.5370%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0255, Accuracy: 547/1013 (53.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.3411, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0648, Accuracy: 290/1418 (20.4513%)
___Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0299, Accuracy: 768/1418 (54.1608%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.7310, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   1, Avg loss: 0.0755, Accuracy: 38/809 (4.6972%)
___Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 394/809 (48.7021%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.9975, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   1, Avg loss: 0.0691, Accuracy: 171/1003 (17.0489%)
___Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   2, Avg loss: 0.0369, Accuracy: 455/1003 (45.3639%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.3459, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   1, Avg loss: 0.0609, Accuracy: 254/1030 (24.6602%)
___Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   2, Avg loss: 0.0249, Accuracy: 695/1030 (67.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.7835, Accuracy: 119/10000 (1.1900%)
time spent on training: 234.44240260124207
___Test Target_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.8448, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Avg loss: 2.6656, Accuracy: 2178/9950 (21.8894%)
saving model
Done in 648.511971950531 sec.
Server Epoch:91 choose agents : [33, 37, 28, 92, 97, 43, 56, 44, 24, 64].
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0907, Accuracy: 3/515 (0.5825%)
___Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0599, Accuracy: 134/515 (26.0194%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.2106, Accuracy: 77/10000 (0.7700%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   1, Avg loss: 0.0555, Accuracy: 345/1129 (30.5580%)
___Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   2, Avg loss: 0.0211, Accuracy: 797/1129 (70.5934%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.8177, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   1, Avg loss: 0.0590, Accuracy: 285/1581 (18.0266%)
___Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   2, Avg loss: 0.0313, Accuracy: 720/1581 (45.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.3747, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   1, Avg loss: 0.0625, Accuracy: 329/1715 (19.1837%)
___Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   2, Avg loss: 0.0287, Accuracy: 843/1715 (49.1545%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.9734, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   1, Avg loss: 0.0670, Accuracy: 180/1213 (14.8392%)
___Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 583/1213 (48.0627%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.5616, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0762, Accuracy: 114/946 (12.0507%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0400, Accuracy: 403/946 (42.6004%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.6460, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   1, Avg loss: 0.1002, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   2, Avg loss: 0.0882, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.7066, Accuracy: 65/10000 (0.6500%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   1, Avg loss: 0.0599, Accuracy: 358/1750 (20.4571%)
___Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   2, Avg loss: 0.0318, Accuracy: 821/1750 (46.9143%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.2941, Accuracy: 146/10000 (1.4600%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0859, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0560, Accuracy: 60/312 (19.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.8548, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   1, Avg loss: 0.0768, Accuracy: 58/953 (6.0860%)
___Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   2, Avg loss: 0.0388, Accuracy: 374/953 (39.2445%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.3074, Accuracy: 88/10000 (0.8800%)
time spent on training: 270.94491934776306
___Test Target_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.7603, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Avg loss: 2.7185, Accuracy: 2370/9950 (23.8191%)
saving model
Done in 687.0154104232788 sec.
Server Epoch:92 choose agents : [71, 40, 7, 67, 97, 72, 34, 58, 26, 38].
___Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   1, Avg loss: 0.0657, Accuracy: 103/818 (12.5917%)
___Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   2, Avg loss: 0.0293, Accuracy: 423/818 (51.7115%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.1121, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0624, Accuracy: 316/1573 (20.0890%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0343, Accuracy: 696/1573 (44.2467%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.3726, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   1, Avg loss: 0.0713, Accuracy: 158/891 (17.7329%)
___Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   2, Avg loss: 0.0296, Accuracy: 492/891 (55.2189%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.7525, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0816, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0508, Accuracy: 147/426 (34.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 6.3244, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   1, Avg loss: 0.0657, Accuracy: 203/1213 (16.7354%)
___Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   2, Avg loss: 0.0268, Accuracy: 583/1213 (48.0627%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.3958, Accuracy: 110/10000 (1.1000%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   1, Avg loss: 0.0577, Accuracy: 234/1241 (18.8558%)
___Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   2, Avg loss: 0.0336, Accuracy: 570/1241 (45.9307%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.4183, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   1, Avg loss: 0.0644, Accuracy: 260/1427 (18.2200%)
___Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 673/1427 (47.1619%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.2504, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0715, Accuracy: 136/803 (16.9365%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0381, Accuracy: 456/803 (56.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 6.8451, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   1, Avg loss: 0.0618, Accuracy: 228/1446 (15.7676%)
___Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 562/1446 (38.8658%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.3342, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0722, Accuracy: 167/1131 (14.7657%)
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0317, Accuracy: 536/1131 (47.3917%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.4377, Accuracy: 116/10000 (1.1600%)
time spent on training: 248.75129556655884
___Test Target_ResNet_18 poisoned: False, epoch: 92: Avg loss: 5.6899, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Avg loss: 2.7592, Accuracy: 2675/9950 (26.8844%)
saving model
Done in 656.7112486362457 sec.
Server Epoch:93 choose agents : [62, 58, 59, 51, 15, 43, 3, 13, 79, 53].
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.0742, Accuracy: 11/568 (1.9366%)
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0415, Accuracy: 261/568 (45.9507%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.2482, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   1, Avg loss: 0.0694, Accuracy: 143/803 (17.8082%)
___Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   2, Avg loss: 0.0383, Accuracy: 456/803 (56.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 6.8318, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0710, Accuracy: 164/1089 (15.0597%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0280, Accuracy: 568/1089 (52.1579%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.2658, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   1, Avg loss: 0.0704, Accuracy: 176/1049 (16.7779%)
___Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   2, Avg loss: 0.0277, Accuracy: 559/1049 (53.2888%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.7463, Accuracy: 139/10000 (1.3900%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0689, Accuracy: 189/1154 (16.3778%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0276, Accuracy: 601/1154 (52.0797%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.7890, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   1, Avg loss: 0.0741, Accuracy: 119/946 (12.5793%)
___Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   2, Avg loss: 0.0391, Accuracy: 410/946 (43.3404%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 6.6503, Accuracy: 76/10000 (0.7600%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   1, Avg loss: 0.0772, Accuracy: 20/781 (2.5608%)
___Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   2, Avg loss: 0.0373, Accuracy: 315/781 (40.3329%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.4223, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   1, Avg loss: 0.0621, Accuracy: 294/1645 (17.8723%)
___Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   2, Avg loss: 0.0308, Accuracy: 751/1645 (45.6535%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.5306, Accuracy: 168/10000 (1.6800%)
___Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   1, Avg loss: 0.1238, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   2, Avg loss: 0.1090, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.5705, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   1, Avg loss: 0.0646, Accuracy: 126/813 (15.4982%)
___Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   2, Avg loss: 0.0181, Accuracy: 511/813 (62.8536%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.7477, Accuracy: 65/10000 (0.6500%)
time spent on training: 238.72227478027344
___Test Target_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.6363, Accuracy: 59/10000 (0.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Avg loss: 2.7822, Accuracy: 2996/9950 (30.1106%)
saving model
Done in 649.5486822128296 sec.
Server Epoch:94 choose agents : [51, 3, 17, 5, 55, 92, 4, 75, 35, 60].
___Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0685, Accuracy: 179/1049 (17.0639%)
___Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0282, Accuracy: 545/1049 (51.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.7502, Accuracy: 134/10000 (1.3400%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0753, Accuracy: 30/781 (3.8412%)
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0368, Accuracy: 307/781 (39.3086%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.3310, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   1, Avg loss: 0.0611, Accuracy: 319/1574 (20.2668%)
___Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   2, Avg loss: 0.0266, Accuracy: 803/1574 (51.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.9386, Accuracy: 134/10000 (1.3400%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0544, Accuracy: 419/1628 (25.7371%)
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0204, Accuracy: 1054/1628 (64.7420%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.5551, Accuracy: 178/10000 (1.7800%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   1, Avg loss: 0.0586, Accuracy: 231/1071 (21.5686%)
___Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   2, Avg loss: 0.0264, Accuracy: 588/1071 (54.9020%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.4979, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   1, Avg loss: 0.0609, Accuracy: 355/1715 (20.6997%)
___Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   2, Avg loss: 0.0282, Accuracy: 861/1715 (50.2041%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.7961, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0744, Accuracy: 160/901 (17.7580%)
___Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0363, Accuracy: 467/901 (51.8313%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.4773, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   1, Avg loss: 0.0749, Accuracy: 82/776 (10.5670%)
___Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   2, Avg loss: 0.0301, Accuracy: 423/776 (54.5103%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.6107, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.0904, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0670, Accuracy: 50/271 (18.4502%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.7768, Accuracy: 72/10000 (0.7200%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   1, Avg loss: 0.0473, Accuracy: 719/2227 (32.2856%)
___Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   2, Avg loss: 0.0247, Accuracy: 1200/2227 (53.8841%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.6447, Accuracy: 173/10000 (1.7300%)
time spent on training: 299.4872262477875
___Test Target_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.5862, Accuracy: 61/10000 (0.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Avg loss: 2.7850, Accuracy: 3337/9950 (33.5377%)
saving model
Done in 710.9178504943848 sec.
Server Epoch:95 choose agents : [54, 15, 1, 87, 63, 69, 60, 22, 43, 45].
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   1, Avg loss: 0.0592, Accuracy: 258/1130 (22.8319%)
___Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   2, Avg loss: 0.0271, Accuracy: 583/1130 (51.5929%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.9808, Accuracy: 104/10000 (1.0400%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   1, Avg loss: 0.0643, Accuracy: 207/1154 (17.9376%)
___Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   2, Avg loss: 0.0273, Accuracy: 610/1154 (52.8596%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.0736, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0677, Accuracy: 177/928 (19.0733%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0222, Accuracy: 642/928 (69.1810%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.3006, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   1, Avg loss: 0.0655, Accuracy: 197/1131 (17.4182%)
___Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   2, Avg loss: 0.0332, Accuracy: 452/1131 (39.9646%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.5308, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   1, Avg loss: 0.0718, Accuracy: 106/888 (11.9369%)
___Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   2, Avg loss: 0.0265, Accuracy: 452/888 (50.9009%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.4925, Accuracy: 87/10000 (0.8700%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   1, Avg loss: 0.0753, Accuracy: 82/590 (13.8983%)
___Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   2, Avg loss: 0.0301, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.3059, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   1, Avg loss: 0.0467, Accuracy: 726/2227 (32.5999%)
___Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   2, Avg loss: 0.0246, Accuracy: 1191/2227 (53.4800%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.6859, Accuracy: 161/10000 (1.6100%)
___Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   1, Avg loss: 0.0559, Accuracy: 440/1470 (29.9320%)
___Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   2, Avg loss: 0.0227, Accuracy: 958/1470 (65.1701%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.7291, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   1, Avg loss: 0.0723, Accuracy: 132/946 (13.9535%)
___Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   2, Avg loss: 0.0386, Accuracy: 409/946 (43.2347%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 6.7142, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   1, Avg loss: 0.0795, Accuracy: 46/669 (6.8759%)
___Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   2, Avg loss: 0.0401, Accuracy: 361/669 (53.9611%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.6181, Accuracy: 82/10000 (0.8200%)
time spent on training: 287.79940390586853
___Test Target_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.5466, Accuracy: 69/10000 (0.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Avg loss: 2.7653, Accuracy: 3702/9950 (37.2060%)
saving model
Done in 691.8600511550903 sec.
Server Epoch:96 choose agents : [12, 11, 52, 2, 65, 23, 68, 97, 82, 9].
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0902, Accuracy: 1/338 (0.2959%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0608, Accuracy: 90/338 (26.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.8542, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0730, Accuracy: 123/712 (17.2753%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0255, Accuracy: 458/712 (64.3258%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.5154, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   1, Avg loss: 0.0684, Accuracy: 116/636 (18.2390%)
___Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   2, Avg loss: 0.0305, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.5889, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0808, Accuracy: 31/605 (5.1240%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0438, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.6363, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   1, Avg loss: 0.0506, Accuracy: 458/1475 (31.0508%)
___Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   2, Avg loss: 0.0284, Accuracy: 838/1475 (56.8136%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.8399, Accuracy: 146/10000 (1.4600%)
___Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   1, Avg loss: 0.0769, Accuracy: 118/715 (16.5035%)
___Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   2, Avg loss: 0.0439, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.5625, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   1, Avg loss: 0.0731, Accuracy: 206/1163 (17.7128%)
___Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 562/1163 (48.3233%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.7960, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   1, Avg loss: 0.0629, Accuracy: 242/1213 (19.9505%)
___Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   2, Avg loss: 0.0264, Accuracy: 601/1213 (49.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.3675, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0822, Accuracy: 8/500 (1.6000%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0548, Accuracy: 173/500 (34.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.2315, Accuracy: 68/10000 (0.6800%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0478, Accuracy: 418/1275 (32.7843%)
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0153, Accuracy: 858/1275 (67.2941%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.5910, Accuracy: 129/10000 (1.2900%)
time spent on training: 244.90096426010132
___Test Target_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.5196, Accuracy: 73/10000 (0.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Avg loss: 2.7536, Accuracy: 4029/9950 (40.4925%)
saving model
Done in 654.1055419445038 sec.
Server Epoch:97 choose agents : [80, 34, 72, 81, 41, 77, 71, 35, 7, 4].
___Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   1, Avg loss: 0.0735, Accuracy: 76/682 (11.1437%)
___Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   2, Avg loss: 0.0405, Accuracy: 260/682 (38.1232%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.3782, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0623, Accuracy: 279/1427 (19.5515%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0321, Accuracy: 690/1427 (48.3532%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.3399, Accuracy: 102/10000 (1.0200%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0562, Accuracy: 262/1241 (21.1120%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0339, Accuracy: 562/1241 (45.2861%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.3636, Accuracy: 97/10000 (0.9700%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   1, Avg loss: 0.0602, Accuracy: 174/774 (22.4806%)
___Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   2, Avg loss: 0.0310, Accuracy: 421/774 (54.3928%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.5319, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0727, Accuracy: 145/719 (20.1669%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0356, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.9054, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   1, Avg loss: 0.0598, Accuracy: 214/1340 (15.9701%)
___Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   2, Avg loss: 0.0252, Accuracy: 692/1340 (51.6418%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.2144, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   1, Avg loss: 0.0627, Accuracy: 132/818 (16.1369%)
___Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   2, Avg loss: 0.0283, Accuracy: 450/818 (55.0122%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.0441, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0881, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0660, Accuracy: 72/271 (26.5683%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.7398, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0684, Accuracy: 176/891 (19.7531%)
___Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0289, Accuracy: 491/891 (55.1066%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.6071, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   1, Avg loss: 0.0744, Accuracy: 178/901 (19.7558%)
___Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   2, Avg loss: 0.0345, Accuracy: 480/901 (53.2741%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.4617, Accuracy: 73/10000 (0.7300%)
time spent on training: 239.29395055770874
___Test Target_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.4983, Accuracy: 77/10000 (0.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Avg loss: 2.7729, Accuracy: 4232/9950 (42.5327%)
saving model
Done in 649.5943222045898 sec.
Server Epoch:98 choose agents : [24, 6, 1, 16, 62, 2, 87, 17, 43, 18].
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.0802, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0521, Accuracy: 111/312 (35.5769%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.7922, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   1, Avg loss: 0.0592, Accuracy: 363/1956 (18.5583%)
___Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   2, Avg loss: 0.0300, Accuracy: 787/1956 (40.2352%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.4833, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   1, Avg loss: 0.0647, Accuracy: 204/928 (21.9828%)
___Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   2, Avg loss: 0.0219, Accuracy: 645/928 (69.5043%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.2999, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0734, Accuracy: 114/708 (16.1017%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0416, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.9158, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0711, Accuracy: 26/568 (4.5775%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0414, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.2187, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   1, Avg loss: 0.0794, Accuracy: 40/605 (6.6116%)
___Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   2, Avg loss: 0.0439, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.5441, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0640, Accuracy: 211/1131 (18.6561%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0332, Accuracy: 447/1131 (39.5225%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.5358, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   1, Avg loss: 0.0588, Accuracy: 340/1574 (21.6010%)
___Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   2, Avg loss: 0.0259, Accuracy: 780/1574 (49.5553%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.0890, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0705, Accuracy: 141/946 (14.9049%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0385, Accuracy: 389/946 (41.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 6.6789, Accuracy: 73/10000 (0.7300%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   1, Avg loss: 0.0829, Accuracy: 11/530 (2.0755%)
___Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   2, Avg loss: 0.0388, Accuracy: 295/530 (55.6604%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.3329, Accuracy: 70/10000 (0.7000%)
time spent on training: 244.837055683136
___Test Target_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.4745, Accuracy: 86/10000 (0.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Avg loss: 2.7788, Accuracy: 4504/9950 (45.2663%)
saving model
Done in 661.1907110214233 sec.
Server Epoch:99 choose agents : [18, 14, 2, 45, 63, 95, 90, 4, 23, 8].
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   1, Avg loss: 0.0807, Accuracy: 22/530 (4.1509%)
___Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   2, Avg loss: 0.0381, Accuracy: 298/530 (56.2264%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.4764, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   1, Avg loss: 0.0741, Accuracy: 97/1013 (9.5755%)
___Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 413/1013 (40.7700%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.6195, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   1, Avg loss: 0.0789, Accuracy: 49/605 (8.0992%)
___Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   2, Avg loss: 0.0423, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.3868, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   1, Avg loss: 0.0773, Accuracy: 75/669 (11.2108%)
___Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   2, Avg loss: 0.0398, Accuracy: 359/669 (53.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.4179, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   1, Avg loss: 0.0687, Accuracy: 134/888 (15.0901%)
___Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 472/888 (53.1532%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.5115, Accuracy: 91/10000 (0.9100%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0352, Accuracy: 442/599 (73.7896%)
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0204, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.8033, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   1, Avg loss: 0.0659, Accuracy: 158/677 (23.3383%)
___Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.8258, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   1, Avg loss: 0.0704, Accuracy: 179/901 (19.8668%)
___Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   2, Avg loss: 0.0342, Accuracy: 474/901 (52.6082%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.5763, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0741, Accuracy: 136/715 (19.0210%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0438, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.2311, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   1, Avg loss: 0.0678, Accuracy: 214/1513 (14.1441%)
___Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   2, Avg loss: 0.0355, Accuracy: 588/1513 (38.8632%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.0600, Accuracy: 142/10000 (1.4200%)
time spent on training: 231.1202232837677
___Test Target_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.4584, Accuracy: 87/10000 (0.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Avg loss: 2.7662, Accuracy: 4648/9950 (46.7136%)
saving model
Done in 651.7152228355408 sec.
Server Epoch:100 choose agents : [57, 53, 36, 10, 37, 13, 40, 62, 39, 80].
___Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0664, Accuracy: 191/1154 (16.5511%)
___Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0268, Accuracy: 568/1154 (49.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.0937, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0617, Accuracy: 167/813 (20.5412%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0178, Accuracy: 503/813 (61.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 10.7991, Accuracy: 61/10000 (0.6100%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   1, Avg loss: 0.0873, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   2, Avg loss: 0.0569, Accuracy: 119/408 (29.1667%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.0146, Accuracy: 56/10000 (0.5600%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   1, Avg loss: 0.0644, Accuracy: 184/861 (21.3705%)
___Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   2, Avg loss: 0.0180, Accuracy: 582/861 (67.5958%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.7686, Accuracy: 119/10000 (1.1900%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0507, Accuracy: 432/1129 (38.2640%)
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0205, Accuracy: 802/1129 (71.0363%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.7120, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   1, Avg loss: 0.0598, Accuracy: 324/1645 (19.6960%)
___Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   2, Avg loss: 0.0301, Accuracy: 785/1645 (47.7204%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.5422, Accuracy: 166/10000 (1.6600%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0595, Accuracy: 361/1573 (22.9498%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0336, Accuracy: 719/1573 (45.7088%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.3438, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   1, Avg loss: 0.0702, Accuracy: 49/568 (8.6268%)
___Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.1691, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0635, Accuracy: 193/1013 (19.0523%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0250, Accuracy: 562/1013 (55.4788%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.1984, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   1, Avg loss: 0.0720, Accuracy: 88/682 (12.9032%)
___Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   2, Avg loss: 0.0398, Accuracy: 261/682 (38.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.2527, Accuracy: 74/10000 (0.7400%)
time spent on training: 266.4647591114044
___Test Target_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.4387, Accuracy: 91/10000 (0.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Avg loss: 2.8057, Accuracy: 4789/9950 (48.1307%)
saving model
Done in 682.3553740978241 sec.
Saving all the graphs.
This run has a label: Jun.11_14.56.59. Visdom environment: tiny
