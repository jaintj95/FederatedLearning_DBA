current path: saved_models/model_tiny_Jun.16_21.14.57
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [17]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [83, 85, 64, 95, 54, 55, 27, 92, 15, 78].
___Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 413/1953 (21.1470%)
___Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 737/1953 (37.7368%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 8.0723, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 447/1988 (22.4849%)
___Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 663/1988 (33.3501%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 8.1244, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 163/953 (17.1039%)
___Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 322/953 (33.7880%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.3956, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 320/599 (53.4224%)
___Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.6987, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 335/1130 (29.6460%)
___Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 490/1130 (43.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.6671, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 244/1071 (22.7824%)
___Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0298, Accuracy: 474/1071 (44.2577%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.6248, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 450/1587 (28.3554%)
___Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 610/1587 (38.4373%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.1302, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 442/1715 (25.7726%)
___Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0313, Accuracy: 700/1715 (40.8163%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.5372, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 315/1154 (27.2964%)
___Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   2, Avg loss: 0.0308, Accuracy: 372/1154 (32.2357%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.7039, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 33/416 (7.9327%)
___Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   2, Avg loss: 0.0466, Accuracy: 173/416 (41.5865%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.5520, Accuracy: 50/10000 (0.5000%)
time spent on training: 123.8112199306488
[foolsgold agg] training data poison_ratio: 0.0  data num: [1953, 1988, 953, 599, 1130, 1071, 1587, 1715, 1154, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3169, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 1: Avg loss: 5.6210, Accuracy: 0/9950 (0.0000%)
saving model
Done in 188.81869268417358 sec.
Server Epoch:2 choose agents : [64, 47, 43, 23, 24, 98, 84, 28, 6, 17].
___Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   1, Avg loss: 0.0654, Accuracy: 165/953 (17.3137%)
___Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   2, Avg loss: 0.0387, Accuracy: 304/953 (31.8993%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.3149, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1222, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1140, Accuracy: 11/134 (8.2090%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3109, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 306/946 (32.3467%)
___Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0366, Accuracy: 325/946 (34.3552%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.9812, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   1, Avg loss: 0.0609, Accuracy: 315/715 (44.0559%)
___Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   2, Avg loss: 0.0383, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.6824, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 33/312 (10.5769%)
___Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 164/312 (52.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3726, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   1, Avg loss: 0.0831, Accuracy: 11/373 (2.9491%)
___Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   2, Avg loss: 0.0493, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.4358, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0628, Accuracy: 309/1190 (25.9664%)
___Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 451/1190 (37.8992%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.3084, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0567, Accuracy: 385/1581 (24.3517%)
___Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 596/1581 (37.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.5253, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   1, Avg loss: 0.0555, Accuracy: 379/1956 (19.3763%)
___Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 642/1956 (32.8221%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 8.0930, Accuracy: 116/10000 (1.1600%)
poison local model 17 index 0 
___Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 372/1574 (23.6341%)
___Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   2, Avg loss: 0.0282, Accuracy: 632/1574 (40.1525%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.7590, Accuracy: 87/10000 (0.8700%)
time spent on training: 115.08588027954102
[foolsgold agg] training data poison_ratio: 0.1617012533388124  data num: [953, 134, 946, 715, 312, 373, 1190, 1581, 1956, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.05053164166837888
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3168, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 2: Avg loss: 5.6191, Accuracy: 0/9950 (0.0000%)
saving model
Done in 182.76098680496216 sec.
Server Epoch:3 choose agents : [75, 58, 7, 84, 94, 13, 3, 69, 93, 10].
___Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0631, Accuracy: 236/776 (30.4124%)
___Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 423/776 (54.5103%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.7939, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   1, Avg loss: 0.0586, Accuracy: 347/803 (43.2130%)
___Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 417/803 (51.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.0315, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   1, Avg loss: 0.0540, Accuracy: 345/891 (38.7205%)
___Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 462/891 (51.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.0846, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   1, Avg loss: 0.0634, Accuracy: 307/1190 (25.7983%)
___Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   2, Avg loss: 0.0331, Accuracy: 440/1190 (36.9748%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.8822, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 326/1662 (19.6149%)
___Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 581/1662 (34.9579%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.7501, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0587, Accuracy: 293/1645 (17.8116%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 641/1645 (38.9666%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.8184, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   1, Avg loss: 0.0760, Accuracy: 101/781 (12.9321%)
___Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 243/781 (31.1140%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.6477, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 276/590 (46.7797%)
___Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0315, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.8377, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 412/1742 (23.6510%)
___Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 689/1742 (39.5522%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.0366, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 205/861 (23.8095%)
___Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 443/861 (51.4518%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.8161, Accuracy: 50/10000 (0.5000%)
time spent on training: 135.47380900382996
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 803, 891, 1190, 1662, 1645, 781, 590, 1742, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3167, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 3: Avg loss: 5.6186, Accuracy: 0/9950 (0.0000%)
saving model
Done in 202.1185736656189 sec.
Server Epoch:4 choose agents : [20, 64, 31, 75, 6, 23, 40, 51, 12, 63].
___Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 337/807 (41.7596%)
___Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 430/807 (53.2838%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.9121, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0653, Accuracy: 177/953 (18.5729%)
___Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 287/953 (30.1154%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.2979, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0826, Accuracy: 50/460 (10.8696%)
___Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0371, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.6762, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 243/776 (31.3144%)
___Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   2, Avg loss: 0.0304, Accuracy: 402/776 (51.8041%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.9254, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   1, Avg loss: 0.0558, Accuracy: 412/1956 (21.0634%)
___Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   2, Avg loss: 0.0329, Accuracy: 595/1956 (30.4192%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.0067, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   1, Avg loss: 0.0625, Accuracy: 319/715 (44.6154%)
___Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   2, Avg loss: 0.0391, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.7510, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   1, Avg loss: 0.0557, Accuracy: 333/1573 (21.1697%)
___Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   2, Avg loss: 0.0343, Accuracy: 595/1573 (37.8258%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.2549, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   1, Avg loss: 0.0601, Accuracy: 222/1049 (21.1630%)
___Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   2, Avg loss: 0.0308, Accuracy: 509/1049 (48.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.5858, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   1, Avg loss: 0.0888, Accuracy: 16/338 (4.7337%)
___Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   2, Avg loss: 0.0489, Accuracy: 132/338 (39.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.4452, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   1, Avg loss: 0.0551, Accuracy: 255/888 (28.7162%)
___Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 428/888 (48.1982%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.2186, Accuracy: 50/10000 (0.5000%)
time spent on training: 100.75747323036194
[foolsgold agg] training data poison_ratio: 0.0  data num: [807, 953, 460, 776, 1956, 715, 1573, 1049, 338, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3166, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 4: Avg loss: 5.6174, Accuracy: 0/9950 (0.0000%)
saving model
Done in 166.28909707069397 sec.
Server Epoch:5 choose agents : [61, 96, 54, 1, 51, 20, 46, 92, 90, 82].
___Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   1, Avg loss: 0.1250, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   2, Avg loss: 0.1181, Accuracy: 4/85 (4.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3043, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   1, Avg loss: 0.0790, Accuracy: 42/311 (13.5048%)
___Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3440, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   1, Avg loss: 0.0554, Accuracy: 333/1130 (29.4690%)
___Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 492/1130 (43.5398%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.3454, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   1, Avg loss: 0.0580, Accuracy: 285/928 (30.7112%)
___Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   2, Avg loss: 0.0247, Accuracy: 525/928 (56.5733%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.7794, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   1, Avg loss: 0.0607, Accuracy: 221/1049 (21.0677%)
___Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   2, Avg loss: 0.0300, Accuracy: 515/1049 (49.0944%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.2569, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 344/807 (42.6270%)
___Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 434/807 (53.7794%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.5626, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   1, Avg loss: 0.0562, Accuracy: 370/1904 (19.4328%)
___Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 657/1904 (34.5063%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.7463, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 472/1715 (27.5219%)
___Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 696/1715 (40.5831%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.1138, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   1, Avg loss: 0.0566, Accuracy: 308/677 (45.4948%)
___Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 449/677 (66.3220%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.9361, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0771, Accuracy: 60/500 (12.0000%)
___Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 170/500 (34.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.6192, Accuracy: 54/10000 (0.5400%)
time spent on training: 108.38712048530579
[foolsgold agg] training data poison_ratio: 0.0  data num: [85, 311, 1130, 928, 1049, 807, 1904, 1715, 677, 500]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3165, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 5: Avg loss: 5.6176, Accuracy: 0/9950 (0.0000%)
saving model
Done in 174.10859298706055 sec.
Server Epoch:6 choose agents : [41, 84, 93, 94, 55, 85, 52, 32, 43, 95].
___Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   1, Avg loss: 0.0605, Accuracy: 324/719 (45.0626%)
___Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   2, Avg loss: 0.0303, Accuracy: 458/719 (63.6996%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.3045, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 323/1190 (27.1429%)
___Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 459/1190 (38.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.0200, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 429/1742 (24.6269%)
___Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 678/1742 (38.9208%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.6155, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 329/1662 (19.7954%)
___Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 596/1662 (35.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.6257, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 245/1071 (22.8758%)
___Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 486/1071 (45.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.3511, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 423/1988 (21.2777%)
___Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0357, Accuracy: 650/1988 (32.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.8298, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0572, Accuracy: 270/636 (42.4528%)
___Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.2093, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   1, Avg loss: 0.0615, Accuracy: 194/735 (26.3946%)
___Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 347/735 (47.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.7156, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   1, Avg loss: 0.0631, Accuracy: 295/946 (31.1839%)
___Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   2, Avg loss: 0.0371, Accuracy: 321/946 (33.9323%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.9283, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 326/599 (54.4240%)
___Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0301, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.6307, Accuracy: 50/10000 (0.5000%)
time spent on training: 152.66986513137817
[foolsgold agg] training data poison_ratio: 0.0  data num: [719, 1190, 1742, 1662, 1071, 1988, 636, 735, 946, 599]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3164, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 6: Avg loss: 5.6134, Accuracy: 0/9950 (0.0000%)
saving model
Done in 220.5920672416687 sec.
Server Epoch:7 choose agents : [54, 60, 32, 23, 69, 52, 79, 83, 9, 90].
___Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 337/1130 (29.8230%)
___Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 460/1130 (40.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.6887, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 565/2227 (25.3705%)
___Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1031/2227 (46.2955%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.3152, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   1, Avg loss: 0.0611, Accuracy: 215/735 (29.2517%)
___Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 381/735 (51.8367%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.3984, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   1, Avg loss: 0.0599, Accuracy: 312/715 (43.6364%)
___Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   2, Avg loss: 0.0408, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.7662, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   1, Avg loss: 0.0573, Accuracy: 284/590 (48.1356%)
___Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   2, Avg loss: 0.0329, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.7556, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 274/636 (43.0818%)
___Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   2, Avg loss: 0.0319, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.2235, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.0991, Accuracy: 14/197 (7.1066%)
___Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0838, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3243, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   1, Avg loss: 0.0550, Accuracy: 390/1953 (19.9693%)
___Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 746/1953 (38.1976%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.7971, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   1, Avg loss: 0.0502, Accuracy: 346/1275 (27.1373%)
___Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   2, Avg loss: 0.0197, Accuracy: 697/1275 (54.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.9983, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0573, Accuracy: 312/677 (46.0857%)
___Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0237, Accuracy: 439/677 (64.8449%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.0775, Accuracy: 52/10000 (0.5200%)
time spent on training: 103.62447309494019
[foolsgold agg] training data poison_ratio: 0.0  data num: [1130, 2227, 735, 715, 590, 636, 197, 1953, 1275, 677]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3162, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 7: Avg loss: 5.6077, Accuracy: 0/9950 (0.0000%)
saving model
Done in 171.8874475955963 sec.
Server Epoch:8 choose agents : [64, 23, 12, 0, 58, 28, 45, 16, 11, 62].
___Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   1, Avg loss: 0.0650, Accuracy: 168/953 (17.6285%)
___Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 295/953 (30.9549%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.4345, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   1, Avg loss: 0.0617, Accuracy: 311/715 (43.4965%)
___Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   2, Avg loss: 0.0380, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.6974, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 16/338 (4.7337%)
___Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0475, Accuracy: 133/338 (39.3491%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.4340, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   1, Avg loss: 0.0585, Accuracy: 372/1657 (22.4502%)
___Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   2, Avg loss: 0.0354, Accuracy: 476/1657 (28.7266%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.6012, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   1, Avg loss: 0.0586, Accuracy: 340/803 (42.3412%)
___Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   2, Avg loss: 0.0350, Accuracy: 363/803 (45.2055%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.9978, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 394/1581 (24.9209%)
___Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 604/1581 (38.2037%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.7335, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   1, Avg loss: 0.0691, Accuracy: 193/669 (28.8490%)
___Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   2, Avg loss: 0.0410, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.8099, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0614, Accuracy: 281/708 (39.6893%)
___Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0370, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.8559, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   1, Avg loss: 0.0540, Accuracy: 345/712 (48.4551%)
___Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   2, Avg loss: 0.0286, Accuracy: 426/712 (59.8315%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.4080, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   1, Avg loss: 0.0695, Accuracy: 137/568 (24.1197%)
___Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   2, Avg loss: 0.0409, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.7137, Accuracy: 50/10000 (0.5000%)
time spent on training: 117.823739528656
[foolsgold agg] training data poison_ratio: 0.0  data num: [953, 715, 338, 1657, 803, 1581, 669, 708, 712, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         0.82689549 0.82689549 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.3161, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 8: Avg loss: 5.6061, Accuracy: 0/9950 (0.0000%)
saving model
Done in 183.85639691352844 sec.
Server Epoch:9 choose agents : [37, 84, 60, 12, 87, 98, 51, 76, 36, 92].
___Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0522, Accuracy: 382/1129 (33.8353%)
___Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0256, Accuracy: 715/1129 (63.3304%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.4250, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0634, Accuracy: 307/1190 (25.7983%)
___Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 449/1190 (37.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.9713, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 540/2227 (24.2479%)
___Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1027/2227 (46.1159%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.3639, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 19/338 (5.6213%)
___Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   2, Avg loss: 0.0487, Accuracy: 139/338 (41.1243%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.4274, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   1, Avg loss: 0.0588, Accuracy: 291/1131 (25.7294%)
___Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   2, Avg loss: 0.0315, Accuracy: 423/1131 (37.4005%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.7655, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   1, Avg loss: 0.0832, Accuracy: 14/373 (3.7534%)
___Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 155/373 (41.5550%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.4129, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 231/1049 (22.0210%)
___Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 500/1049 (47.6644%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.4895, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 33/466 (7.0815%)
___Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   2, Avg loss: 0.0490, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.6335, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   1, Avg loss: 0.0878, Accuracy: 69/408 (16.9118%)
___Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   2, Avg loss: 0.0560, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.4832, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   1, Avg loss: 0.0515, Accuracy: 444/1715 (25.8892%)
___Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   2, Avg loss: 0.0313, Accuracy: 672/1715 (39.1837%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.7565, Accuracy: 91/10000 (0.9100%)
time spent on training: 131.33214449882507
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 1190, 2227, 338, 1131, 373, 1049, 466, 408, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3161, Accuracy: 43/10000 (0.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 9: Avg loss: 5.6050, Accuracy: 0/9950 (0.0000%)
saving model
Done in 196.7972288131714 sec.
Server Epoch:10 choose agents : [71, 14, 55, 43, 88, 30, 56, 96, 98, 5].
___Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   1, Avg loss: 0.0648, Accuracy: 148/818 (18.0929%)
___Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 344/818 (42.0538%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.1701, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   1, Avg loss: 0.0627, Accuracy: 217/1013 (21.4215%)
___Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 348/1013 (34.3534%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.5305, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 254/1071 (23.7162%)
___Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   2, Avg loss: 0.0294, Accuracy: 483/1071 (45.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.9650, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   1, Avg loss: 0.0614, Accuracy: 307/946 (32.4524%)
___Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 352/946 (37.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.0305, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   1, Avg loss: 0.0744, Accuracy: 138/603 (22.8856%)
___Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   2, Avg loss: 0.0474, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.8089, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0816, Accuracy: 64/486 (13.1687%)
___Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.7592, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0678, Accuracy: 58/186 (31.1828%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3124, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 53/311 (17.0418%)
___Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   2, Avg loss: 0.0539, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3422, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   1, Avg loss: 0.0830, Accuracy: 12/373 (3.2172%)
___Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   2, Avg loss: 0.0486, Accuracy: 153/373 (41.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.4248, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 356/1628 (21.8673%)
___Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0260, Accuracy: 802/1628 (49.2629%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.3073, Accuracy: 136/10000 (1.3600%)
time spent on training: 103.21421575546265
[foolsgold agg] training data poison_ratio: 0.0  data num: [818, 1013, 1071, 946, 603, 486, 186, 311, 373, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3160, Accuracy: 43/10000 (0.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 10: Avg loss: 5.6057, Accuracy: 0/9950 (0.0000%)
saving model
Done in 170.04183197021484 sec.
Server Epoch:11 choose agents : [24, 78, 29, 5, 92, 11, 87, 10, 26, 13].
___Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0776, Accuracy: 22/312 (7.0513%)
___Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0421, Accuracy: 159/312 (50.9615%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.3815, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   1, Avg loss: 0.0832, Accuracy: 38/416 (9.1346%)
___Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   2, Avg loss: 0.0472, Accuracy: 170/416 (40.8654%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.5629, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 428/1440 (29.7222%)
___Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 661/1440 (45.9028%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.7539, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   1, Avg loss: 0.0519, Accuracy: 405/1628 (24.8771%)
___Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   2, Avg loss: 0.0250, Accuracy: 854/1628 (52.4570%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.0377, Accuracy: 139/10000 (1.3900%)
___Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 461/1715 (26.8805%)
___Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 704/1715 (41.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.4995, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0548, Accuracy: 346/712 (48.5955%)
___Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0282, Accuracy: 400/712 (56.1798%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.4631, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   1, Avg loss: 0.0578, Accuracy: 308/1131 (27.2325%)
___Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   2, Avg loss: 0.0323, Accuracy: 410/1131 (36.2511%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.8120, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 207/861 (24.0418%)
___Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 450/861 (52.2648%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.0731, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 332/1446 (22.9599%)
___Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 509/1446 (35.2006%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.9564, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 307/1645 (18.6626%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 597/1645 (36.2918%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.9100, Accuracy: 114/10000 (1.1400%)
time spent on training: 154.38786149024963
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 416, 1440, 1628, 1715, 712, 1131, 861, 1446, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.3158, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 11: Avg loss: 5.6055, Accuracy: 0/9950 (0.0000%)
saving model
Done in 221.50823640823364 sec.
Server Epoch:12 choose agents : [36, 80, 93, 31, 33, 86, 62, 98, 21, 13].
___Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0886, Accuracy: 66/408 (16.1765%)
___Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0548, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.4626, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   1, Avg loss: 0.0710, Accuracy: 131/682 (19.2082%)
___Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   2, Avg loss: 0.0387, Accuracy: 246/682 (36.0704%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.2589, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 414/1742 (23.7658%)
___Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 712/1742 (40.8726%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.7420, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   1, Avg loss: 0.0819, Accuracy: 59/460 (12.8261%)
___Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   2, Avg loss: 0.0409, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.7431, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   1, Avg loss: 0.0797, Accuracy: 65/515 (12.6214%)
___Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   2, Avg loss: 0.0514, Accuracy: 133/515 (25.8252%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.7876, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0626, Accuracy: 353/1003 (35.1944%)
___Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0353, Accuracy: 357/1003 (35.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.6530, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   1, Avg loss: 0.0693, Accuracy: 134/568 (23.5915%)
___Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.7334, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   1, Avg loss: 0.0826, Accuracy: 11/373 (2.9491%)
___Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   2, Avg loss: 0.0490, Accuracy: 155/373 (41.5550%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.4337, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 408/1949 (20.9338%)
___Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 609/1949 (31.2468%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.2165, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 329/1645 (20.0000%)
___Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 625/1645 (37.9939%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.6731, Accuracy: 111/10000 (1.1100%)
time spent on training: 109.12451887130737
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 682, 1742, 460, 515, 1003, 568, 373, 1949, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3157, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 12: Avg loss: 5.6050, Accuracy: 0/9950 (0.0000%)
saving model
Done in 174.85220980644226 sec.
Server Epoch:13 choose agents : [35, 75, 70, 14, 55, 6, 16, 50, 46, 23].
___Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0856, Accuracy: 37/271 (13.6531%)
___Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0559, Accuracy: 100/271 (36.9004%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3611, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   1, Avg loss: 0.0649, Accuracy: 248/776 (31.9588%)
___Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   2, Avg loss: 0.0298, Accuracy: 405/776 (52.1907%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.9600, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 351/1418 (24.7532%)
___Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0313, Accuracy: 638/1418 (44.9929%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.7773, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 219/1013 (21.6190%)
___Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 296/1013 (29.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.6080, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   1, Avg loss: 0.0556, Accuracy: 245/1071 (22.8758%)
___Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 508/1071 (47.4323%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.2280, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   1, Avg loss: 0.0552, Accuracy: 412/1956 (21.0634%)
___Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   2, Avg loss: 0.0328, Accuracy: 610/1956 (31.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.1121, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0668, Accuracy: 270/708 (38.1356%)
___Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0343, Accuracy: 424/708 (59.8870%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.0530, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0638, Accuracy: 145/809 (17.9234%)
___Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0280, Accuracy: 338/809 (41.7800%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.1339, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   1, Avg loss: 0.0548, Accuracy: 439/1904 (23.0567%)
___Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 674/1904 (35.3992%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.9881, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0615, Accuracy: 313/715 (43.7762%)
___Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0387, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.7010, Accuracy: 50/10000 (0.5000%)
time spent on training: 143.27192401885986
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 776, 1418, 1013, 1071, 1956, 708, 809, 1904, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3156, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 13: Avg loss: 5.6047, Accuracy: 0/9950 (0.0000%)
saving model
Done in 209.94637274742126 sec.
Server Epoch:14 choose agents : [69, 64, 65, 61, 33, 70, 82, 60, 83, 98].
___Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0566, Accuracy: 283/590 (47.9661%)
___Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0293, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.6036, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   1, Avg loss: 0.0651, Accuracy: 151/953 (15.8447%)
___Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 304/953 (31.8993%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.3779, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0567, Accuracy: 386/1475 (26.1695%)
___Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0313, Accuracy: 622/1475 (42.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.0343, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1263, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1167, Accuracy: 7/85 (8.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.3043, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   1, Avg loss: 0.0775, Accuracy: 64/515 (12.4272%)
___Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   2, Avg loss: 0.0516, Accuracy: 138/515 (26.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.8041, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 350/1418 (24.6827%)
___Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 649/1418 (45.7687%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.5466, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 71/500 (14.2000%)
___Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0477, Accuracy: 172/500 (34.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.5909, Accuracy: 43/10000 (0.4300%)
___Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 591/2227 (26.5379%)
___Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1008/2227 (45.2627%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.2300, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 447/1953 (22.8879%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 766/1953 (39.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.2028, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0822, Accuracy: 18/373 (4.8257%)
___Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.4263, Accuracy: 50/10000 (0.5000%)
time spent on training: 134.3918116092682
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 953, 1475, 85, 515, 1418, 500, 2227, 1953, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.3155, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 14: Avg loss: 5.6006, Accuracy: 0/9950 (0.0000%)
saving model
Done in 200.86232829093933 sec.
Server Epoch:15 choose agents : [69, 62, 83, 78, 25, 41, 18, 65, 38, 94].
___Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   1, Avg loss: 0.0557, Accuracy: 285/590 (48.3051%)
___Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   2, Avg loss: 0.0295, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.8861, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   1, Avg loss: 0.0696, Accuracy: 136/568 (23.9437%)
___Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   2, Avg loss: 0.0410, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.7381, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 420/1953 (21.5054%)
___Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 737/1953 (37.7368%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9201, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 36/416 (8.6538%)
___Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 172/416 (41.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.5508, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   1, Avg loss: 0.0572, Accuracy: 304/690 (44.0580%)
___Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 457/690 (66.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.4223, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0594, Accuracy: 329/719 (45.7580%)
___Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0322, Accuracy: 463/719 (64.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.1602, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0773, Accuracy: 112/530 (21.1321%)
___Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0396, Accuracy: 266/530 (50.1887%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.9901, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   1, Avg loss: 0.0560, Accuracy: 416/1475 (28.2034%)
___Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 653/1475 (44.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.9222, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   1, Avg loss: 0.0619, Accuracy: 238/1131 (21.0433%)
___Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   2, Avg loss: 0.0312, Accuracy: 478/1131 (42.2635%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.4361, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 342/1662 (20.5776%)
___Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 590/1662 (35.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.5680, Accuracy: 93/10000 (0.9300%)
time spent on training: 114.99586462974548
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 568, 1953, 416, 690, 719, 530, 1475, 1131, 1662]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.3153, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 15: Avg loss: 5.5986, Accuracy: 0/9950 (0.0000%)
saving model
Done in 182.52980828285217 sec.
Server Epoch:16 choose agents : [23, 21, 70, 65, 79, 5, 63, 95, 58, 32].
___Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0584, Accuracy: 317/715 (44.3357%)
___Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0406, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.8026, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 403/1949 (20.6773%)
___Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 645/1949 (33.0939%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.3844, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 342/1418 (24.1185%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 639/1418 (45.0635%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.9224, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   1, Avg loss: 0.0559, Accuracy: 380/1475 (25.7627%)
___Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 711/1475 (48.2034%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.9633, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   1, Avg loss: 0.1027, Accuracy: 11/197 (5.5838%)
___Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   2, Avg loss: 0.0847, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.3224, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   1, Avg loss: 0.0514, Accuracy: 323/1628 (19.8403%)
___Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 792/1628 (48.6486%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1579, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 252/888 (28.3784%)
___Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0265, Accuracy: 392/888 (44.1441%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1138, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   1, Avg loss: 0.0527, Accuracy: 326/599 (54.4240%)
___Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.8237, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 343/803 (42.7148%)
___Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 407/803 (50.6849%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.9670, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0604, Accuracy: 190/735 (25.8503%)
___Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0234, Accuracy: 332/735 (45.1701%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.6721, Accuracy: 52/10000 (0.5200%)
time spent on training: 148.10682845115662
[foolsgold agg] training data poison_ratio: 0.0  data num: [715, 1949, 1418, 1475, 197, 1628, 888, 599, 803, 735]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.3152, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 16: Avg loss: 5.5935, Accuracy: 0/9950 (0.0000%)
saving model
Done in 214.57816410064697 sec.
Server Epoch:17 choose agents : [35, 28, 27, 80, 54, 62, 32, 22, 4, 42].
___Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0861, Accuracy: 34/271 (12.5461%)
___Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0566, Accuracy: 96/271 (35.4244%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.3608, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0572, Accuracy: 377/1581 (23.8457%)
___Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 581/1581 (36.7489%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.6475, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0537, Accuracy: 447/1587 (28.1664%)
___Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 595/1587 (37.4921%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.1250, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   1, Avg loss: 0.0702, Accuracy: 142/682 (20.8211%)
___Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   2, Avg loss: 0.0378, Accuracy: 270/682 (39.5894%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.2671, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 351/1130 (31.0619%)
___Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 463/1130 (40.9735%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.4970, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   1, Avg loss: 0.0688, Accuracy: 137/568 (24.1197%)
___Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.7017, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 195/735 (26.5306%)
___Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 349/735 (47.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.5282, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 509/1470 (34.6259%)
___Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 861/1470 (58.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.0806, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   1, Avg loss: 0.0607, Accuracy: 324/901 (35.9600%)
___Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 406/901 (45.0610%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.8771, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 341/1372 (24.8542%)
___Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 491/1372 (35.7872%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.9485, Accuracy: 76/10000 (0.7600%)
time spent on training: 126.11494517326355
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 1581, 1587, 682, 1130, 568, 735, 1470, 901, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.3150, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 17: Avg loss: 5.5894, Accuracy: 0/9950 (0.0000%)
saving model
Done in 190.58313059806824 sec.
Server Epoch:18 choose agents : [76, 89, 2, 23, 1, 7, 78, 50, 72, 28].
___Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0867, Accuracy: 38/466 (8.1545%)
___Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.6210, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 329/896 (36.7188%)
___Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 441/896 (49.2188%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.1801, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0637, Accuracy: 229/605 (37.8512%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0398, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.7972, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   1, Avg loss: 0.0609, Accuracy: 317/715 (44.3357%)
___Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   2, Avg loss: 0.0378, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.6906, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   1, Avg loss: 0.0571, Accuracy: 290/928 (31.2500%)
___Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 551/928 (59.3750%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.8319, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 347/891 (38.9450%)
___Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 407/891 (45.6790%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.9267, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0830, Accuracy: 34/416 (8.1731%)
___Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0476, Accuracy: 184/416 (44.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.5541, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   1, Avg loss: 0.0634, Accuracy: 143/809 (17.6761%)
___Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   2, Avg loss: 0.0274, Accuracy: 351/809 (43.3869%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.1316, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 249/1241 (20.0645%)
___Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   2, Avg loss: 0.0372, Accuracy: 426/1241 (34.3272%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.2107, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 382/1581 (24.1619%)
___Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0341, Accuracy: 571/1581 (36.1164%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.6153, Accuracy: 93/10000 (0.9300%)
time spent on training: 153.04998111724854
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 896, 605, 715, 928, 891, 416, 809, 1241, 1581]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.3149, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 18: Avg loss: 5.5893, Accuracy: 0/9950 (0.0000%)
saving model
Done in 222.83235239982605 sec.
Server Epoch:19 choose agents : [6, 86, 35, 16, 89, 92, 20, 59, 10, 14].
___Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   1, Avg loss: 0.0550, Accuracy: 384/1956 (19.6319%)
___Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 676/1956 (34.5603%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.0978, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   1, Avg loss: 0.0635, Accuracy: 352/1003 (35.0947%)
___Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   2, Avg loss: 0.0349, Accuracy: 370/1003 (36.8893%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.7849, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   1, Avg loss: 0.0847, Accuracy: 41/271 (15.1292%)
___Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   2, Avg loss: 0.0556, Accuracy: 102/271 (37.6384%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.3604, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0644, Accuracy: 272/708 (38.4181%)
___Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0357, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.8415, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 327/896 (36.4955%)
___Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 447/896 (49.8884%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.1479, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0524, Accuracy: 429/1715 (25.0146%)
___Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 732/1715 (42.6822%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.9522, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0575, Accuracy: 338/807 (41.8835%)
___Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0317, Accuracy: 427/807 (52.9120%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.6112, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   1, Avg loss: 0.0528, Accuracy: 316/1089 (29.0174%)
___Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   2, Avg loss: 0.0289, Accuracy: 446/1089 (40.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 9.3810, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   1, Avg loss: 0.0571, Accuracy: 219/861 (25.4355%)
___Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 451/861 (52.3810%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.8869, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   1, Avg loss: 0.0622, Accuracy: 223/1013 (22.0138%)
___Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 330/1013 (32.5765%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.5445, Accuracy: 65/10000 (0.6500%)
time spent on training: 143.07468962669373
[foolsgold agg] training data poison_ratio: 0.0  data num: [1956, 1003, 271, 708, 896, 1715, 807, 1089, 861, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.3149, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 19: Avg loss: 5.5897, Accuracy: 0/9950 (0.0000%)
saving model
Done in 212.3161540031433 sec.
Server Epoch:20 choose agents : [75, 13, 54, 6, 63, 49, 70, 51, 58, 9].
___Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0633, Accuracy: 243/776 (31.3144%)
___Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0312, Accuracy: 401/776 (51.6753%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.8148, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 314/1645 (19.0881%)
___Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 621/1645 (37.7508%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.7573, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   1, Avg loss: 0.0557, Accuracy: 339/1130 (30.0000%)
___Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 457/1130 (40.4425%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.6628, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 416/1956 (21.2679%)
___Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 653/1956 (33.3845%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.2749, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 252/888 (28.3784%)
___Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 420/888 (47.2973%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.4894, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   1, Avg loss: 0.0812, Accuracy: 20/440 (4.5455%)
___Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   2, Avg loss: 0.0493, Accuracy: 146/440 (33.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 5.4583, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0572, Accuracy: 336/1418 (23.6953%)
___Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 584/1418 (41.1848%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.6248, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   1, Avg loss: 0.0598, Accuracy: 226/1049 (21.5443%)
___Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 515/1049 (49.0944%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.5298, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   1, Avg loss: 0.0577, Accuracy: 353/803 (43.9601%)
___Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   2, Avg loss: 0.0345, Accuracy: 388/803 (48.3188%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 5.9795, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   1, Avg loss: 0.0495, Accuracy: 364/1275 (28.5490%)
___Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   2, Avg loss: 0.0190, Accuracy: 732/1275 (57.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.1699, Accuracy: 90/10000 (0.9000%)
time spent on training: 131.79857468605042
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 1645, 1130, 1956, 888, 440, 1418, 1049, 803, 1275]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 20: Avg loss: 5.3147, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 20: Avg loss: 5.5891, Accuracy: 0/9950 (0.0000%)
saving model
Done in 203.08000135421753 sec.
Server Epoch:21 choose agents : [16, 25, 46, 76, 98, 73, 93, 64, 21, 10].
___Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   1, Avg loss: 0.0663, Accuracy: 269/708 (37.9944%)
___Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   2, Avg loss: 0.0347, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.8165, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   1, Avg loss: 0.0581, Accuracy: 299/690 (43.3333%)
___Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   2, Avg loss: 0.0273, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.3168, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   1, Avg loss: 0.0555, Accuracy: 407/1904 (21.3761%)
___Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 637/1904 (33.4559%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.8888, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   1, Avg loss: 0.0866, Accuracy: 38/466 (8.1545%)
___Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   2, Avg loss: 0.0503, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.6335, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   1, Avg loss: 0.0819, Accuracy: 15/373 (4.0214%)
___Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   2, Avg loss: 0.0486, Accuracy: 153/373 (41.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.4474, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   1, Avg loss: 0.0666, Accuracy: 166/938 (17.6972%)
___Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 312/938 (33.2623%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.0916, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   1, Avg loss: 0.0550, Accuracy: 433/1742 (24.8565%)
___Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 689/1742 (39.5522%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.8601, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 163/953 (17.1039%)
___Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 286/953 (30.0105%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.4542, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0541, Accuracy: 366/1949 (18.7789%)
___Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 638/1949 (32.7347%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.4702, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   1, Avg loss: 0.0574, Accuracy: 205/861 (23.8095%)
___Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 428/861 (49.7096%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.9674, Accuracy: 50/10000 (0.5000%)
time spent on training: 165.22190284729004
[foolsgold agg] training data poison_ratio: 0.0  data num: [708, 690, 1904, 466, 373, 938, 1742, 953, 1949, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.3146, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Avg loss: 5.5853, Accuracy: 0/9950 (0.0000%)
saving model
Done in 235.66167879104614 sec.
Server Epoch:22 choose agents : [21, 48, 18, 74, 1, 99, 7, 76, 53, 8].
___Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 398/1949 (20.4207%)
___Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 616/1949 (31.6060%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.1610, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   1, Avg loss: 0.0712, Accuracy: 96/631 (15.2139%)
___Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   2, Avg loss: 0.0414, Accuracy: 224/631 (35.4992%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 5.7624, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0769, Accuracy: 114/530 (21.5094%)
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0390, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 5.9609, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0435, Accuracy: 483/1552 (31.1211%)
___Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 745/1552 (48.0026%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 10.1301, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   1, Avg loss: 0.0573, Accuracy: 281/928 (30.2802%)
___Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 540/928 (58.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.6407, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   1, Avg loss: 0.0682, Accuracy: 173/773 (22.3803%)
___Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   2, Avg loss: 0.0320, Accuracy: 378/773 (48.9004%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.2000, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 352/891 (39.5062%)
___Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 477/891 (53.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.1155, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0861, Accuracy: 36/466 (7.7253%)
___Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0477, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 5.6139, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   1, Avg loss: 0.0500, Accuracy: 274/813 (33.7023%)
___Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 457/813 (56.2116%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.3055, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0603, Accuracy: 249/1513 (16.4574%)
___Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 494/1513 (32.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.3814, Accuracy: 104/10000 (1.0400%)
time spent on training: 133.27620911598206
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 631, 530, 1552, 928, 773, 891, 466, 813, 1513]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 22: Avg loss: 5.3145, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Avg loss: 5.5855, Accuracy: 0/9950 (0.0000%)
saving model
Done in 198.51979541778564 sec.
Server Epoch:23 choose agents : [52, 94, 1, 86, 21, 75, 2, 4, 62, 81].
___Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   1, Avg loss: 0.0565, Accuracy: 280/636 (44.0252%)
___Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 6.3389, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 306/1662 (18.4116%)
___Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 601/1662 (36.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.8398, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   1, Avg loss: 0.0568, Accuracy: 278/928 (29.9569%)
___Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 554/928 (59.6983%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.6188, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   1, Avg loss: 0.0626, Accuracy: 355/1003 (35.3938%)
___Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 377/1003 (37.5872%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 6.6316, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 423/1949 (21.7034%)
___Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 637/1949 (32.6834%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.0299, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   1, Avg loss: 0.0632, Accuracy: 247/776 (31.8299%)
___Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   2, Avg loss: 0.0296, Accuracy: 399/776 (51.4175%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 6.8863, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 229/605 (37.8512%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 5.8885, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0629, Accuracy: 330/901 (36.6260%)
___Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0338, Accuracy: 384/901 (42.6193%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 6.9486, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   1, Avg loss: 0.0691, Accuracy: 138/568 (24.2958%)
___Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 5.7186, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0711, Accuracy: 236/774 (30.4910%)
___Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0345, Accuracy: 315/774 (40.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 6.2068, Accuracy: 61/10000 (0.6100%)
time spent on training: 164.05122089385986
[foolsgold agg] training data poison_ratio: 0.0  data num: [636, 1662, 928, 1003, 1949, 776, 605, 901, 568, 774]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 23: Avg loss: 5.3143, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Avg loss: 5.5847, Accuracy: 0/9950 (0.0000%)
saving model
Done in 231.6159656047821 sec.
Server Epoch:24 choose agents : [84, 82, 13, 67, 2, 10, 50, 70, 14, 69].
___Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 317/1190 (26.6387%)
___Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 447/1190 (37.5630%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.0647, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0767, Accuracy: 67/500 (13.4000%)
___Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 176/500 (35.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 5.6187, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 322/1645 (19.5745%)
___Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 618/1645 (37.5684%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.0230, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0787, Accuracy: 57/426 (13.3803%)
___Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0415, Accuracy: 174/426 (40.8451%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 5.5942, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 223/605 (36.8595%)
___Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   2, Avg loss: 0.0387, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 5.8390, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 207/861 (24.0418%)
___Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   2, Avg loss: 0.0213, Accuracy: 447/861 (51.9164%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.0976, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 155/809 (19.1595%)
___Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 361/809 (44.6230%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.4057, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 345/1418 (24.3300%)
___Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 665/1418 (46.8970%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.7417, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 226/1013 (22.3100%)
___Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 299/1013 (29.5163%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.5560, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   1, Avg loss: 0.0552, Accuracy: 288/590 (48.8136%)
___Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   2, Avg loss: 0.0325, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.9980, Accuracy: 50/10000 (0.5000%)
time spent on training: 132.29466009140015
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 500, 1645, 426, 605, 861, 809, 1418, 1013, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 24: Avg loss: 5.3142, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Avg loss: 5.5848, Accuracy: 0/9950 (0.0000%)
saving model
Done in 197.06351375579834 sec.
Server Epoch:25 choose agents : [44, 26, 53, 87, 15, 94, 31, 2, 81, 48].
___Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0601, Accuracy: 379/1750 (21.6571%)
___Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0358, Accuracy: 672/1750 (38.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.2800, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0555, Accuracy: 324/1446 (22.4066%)
___Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 504/1446 (34.8548%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.3000, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0496, Accuracy: 269/813 (33.0873%)
___Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 475/813 (58.4256%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.0064, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   1, Avg loss: 0.0581, Accuracy: 294/1131 (25.9947%)
___Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 375/1131 (33.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.7068, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 321/1154 (27.8163%)
___Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0301, Accuracy: 414/1154 (35.8752%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.0495, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 328/1662 (19.7353%)
___Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 600/1662 (36.1011%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.8041, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   1, Avg loss: 0.0814, Accuracy: 68/460 (14.7826%)
___Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 5.7111, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 231/605 (38.1818%)
___Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 329/605 (54.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 5.7871, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   1, Avg loss: 0.0673, Accuracy: 244/774 (31.5245%)
___Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   2, Avg loss: 0.0364, Accuracy: 317/774 (40.9561%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 6.2819, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0710, Accuracy: 92/631 (14.5800%)
___Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0413, Accuracy: 217/631 (34.3899%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 5.8923, Accuracy: 50/10000 (0.5000%)
time spent on training: 163.00698614120483
[foolsgold agg] training data poison_ratio: 0.0  data num: [1750, 1446, 813, 1131, 1154, 1662, 460, 605, 774, 631]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 25: Avg loss: 5.3141, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Avg loss: 5.5845, Accuracy: 0/9950 (0.0000%)
saving model
Done in 229.02030754089355 sec.
Server Epoch:26 choose agents : [80, 56, 73, 74, 45, 54, 42, 79, 7, 50].
___Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0703, Accuracy: 136/682 (19.9413%)
___Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0385, Accuracy: 230/682 (33.7243%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 6.4012, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 66/186 (35.4839%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.3116, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0662, Accuracy: 163/938 (17.3774%)
___Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0329, Accuracy: 345/938 (36.7804%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 6.9534, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 480/1552 (30.9278%)
___Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 765/1552 (49.2912%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 10.5225, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   1, Avg loss: 0.0687, Accuracy: 195/669 (29.1480%)
___Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   2, Avg loss: 0.0400, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.7976, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0549, Accuracy: 352/1130 (31.1504%)
___Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 468/1130 (41.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.4754, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 346/1372 (25.2187%)
___Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 481/1372 (35.0583%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.9804, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1030, Accuracy: 18/197 (9.1371%)
___Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0902, Accuracy: 62/197 (31.4721%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.3205, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 351/891 (39.3939%)
___Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 435/891 (48.8215%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 6.9803, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   1, Avg loss: 0.0635, Accuracy: 136/809 (16.8109%)
___Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   2, Avg loss: 0.0276, Accuracy: 342/809 (42.2744%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.2077, Accuracy: 82/10000 (0.8200%)
time spent on training: 163.13315224647522
[foolsgold agg] training data poison_ratio: 0.0  data num: [682, 186, 938, 1552, 669, 1130, 1372, 197, 891, 809]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.3141, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Avg loss: 5.5837, Accuracy: 0/9950 (0.0000%)
saving model
Done in 227.9383111000061 sec.
Server Epoch:27 choose agents : [17, 84, 50, 25, 13, 95, 98, 42, 15, 54].
poison local model 17 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Average loss: 0.0515, Accuracy: 431/1574 (27.3825%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Average loss: 0.0239, Accuracy: 850/1574 (54.0025%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   3, Average loss: 0.0203, Accuracy: 936/1574 (59.4663%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   4, Average loss: 0.0192, Accuracy: 980/1574 (62.2618%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   5, Average loss: 0.0188, Accuracy: 979/1574 (62.1982%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   6, Average loss: 0.0186, Accuracy: 1003/1574 (63.7230%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   7, Average loss: 0.0179, Accuracy: 1003/1574 (63.7230%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   8, Average loss: 0.0178, Accuracy: 1025/1574 (65.1207%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   9, Average loss: 0.0172, Accuracy: 1013/1574 (64.3583%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch  10, Average loss: 0.0173, Accuracy: 1021/1574 (64.8666%), train_poison_data_count: 500
Global model norm: 112.05487460113014.
Norm before scaling: 112.03130230124302. Distance: 1.2306786252219488
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.9708, Accuracy: 98/10000 (0.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.1292, Accuracy: 9856/9950 (99.0553%)
Scaling by  100
Scaled Norm after poisoning: 164.38492127853453, distance: 123.06786428125744
Total norm for 1 adversaries is: 164.38492127853453. distance: 123.06786428125744
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   1, Avg loss: 0.0631, Accuracy: 318/1190 (26.7227%)
___Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 445/1190 (37.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 6.9777, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 134/809 (16.5637%)
___Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 313/809 (38.6897%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.1086, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 307/690 (44.4928%)
___Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 6.5643, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0577, Accuracy: 314/1645 (19.0881%)
___Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 631/1645 (38.3587%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.0982, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0527, Accuracy: 330/599 (55.0918%)
___Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0270, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.3829, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0821, Accuracy: 18/373 (4.8257%)
___Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 5.4374, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 350/1372 (25.5102%)
___Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 509/1372 (37.0991%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.7842, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0573, Accuracy: 322/1154 (27.9029%)
___Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0290, Accuracy: 451/1154 (39.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.9372, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 339/1130 (30.0000%)
___Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0294, Accuracy: 448/1130 (39.6460%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.8281, Accuracy: 50/10000 (0.5000%)
time spent on training: 272.7348048686981
[foolsgold agg] training data poison_ratio: 0.1493925588458618  data num: [1574, 1190, 809, 690, 1645, 599, 373, 1372, 1154, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.04668517463933181
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 27: Avg loss: 5.3140, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Avg loss: 5.5800, Accuracy: 0/9950 (0.0000%)
saving model
Done in 342.25762581825256 sec.
Server Epoch:28 choose agents : [20, 92, 67, 48, 91, 85, 76, 6, 83, 17].
___Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   1, Avg loss: 0.0575, Accuracy: 341/807 (42.2553%)
___Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 405/807 (50.1859%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 6.7208, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0513, Accuracy: 468/1715 (27.2886%)
___Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 744/1715 (43.3819%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.5638, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   1, Avg loss: 0.0795, Accuracy: 47/426 (11.0329%)
___Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   2, Avg loss: 0.0418, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 5.5401, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   1, Avg loss: 0.0712, Accuracy: 96/631 (15.2139%)
___Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   2, Avg loss: 0.0415, Accuracy: 220/631 (34.8653%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 5.8780, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0521, Accuracy: 335/1030 (32.5243%)
___Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0254, Accuracy: 634/1030 (61.5534%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.5341, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 420/1988 (21.1268%)
___Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 655/1988 (32.9477%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.7507, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 40/466 (8.5837%)
___Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   2, Avg loss: 0.0482, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 5.6522, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 385/1956 (19.6830%)
___Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 616/1956 (31.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.6198, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   1, Avg loss: 0.0547, Accuracy: 406/1953 (20.7885%)
___Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 737/1953 (37.7368%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.9139, Accuracy: 99/10000 (0.9900%)
poison local model 17 index 0 
___Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 402/1574 (25.5400%)
___Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 671/1574 (42.6302%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.0941, Accuracy: 73/10000 (0.7300%)
time spent on training: 192.6491415500641
[foolsgold agg] training data poison_ratio: 0.12545831340666347  data num: [807, 1715, 426, 631, 1030, 1988, 466, 1956, 1953, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.039205722939582334
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 28: Avg loss: 5.3138, Accuracy: 43/10000 (0.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Avg loss: 5.5795, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.260999917984 sec.
Server Epoch:29 choose agents : [11, 58, 53, 87, 95, 62, 65, 60, 57, 69].
___Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0536, Accuracy: 342/712 (48.0337%)
___Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0270, Accuracy: 439/712 (61.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.4249, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0558, Accuracy: 355/803 (44.2092%)
___Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 411/803 (51.1831%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.0464, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   1, Avg loss: 0.0501, Accuracy: 268/813 (32.9643%)
___Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 470/813 (57.8106%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.3211, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   1, Avg loss: 0.0577, Accuracy: 296/1131 (26.1715%)
___Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   2, Avg loss: 0.0312, Accuracy: 420/1131 (37.1353%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.8844, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 335/599 (55.9265%)
___Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.4151, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   1, Avg loss: 0.0691, Accuracy: 133/568 (23.4155%)
___Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 5.7219, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 368/1475 (24.9492%)
___Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   2, Avg loss: 0.0321, Accuracy: 677/1475 (45.8983%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.7789, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 576/2227 (25.8644%)
___Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1060/2227 (47.5977%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.3076, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   1, Avg loss: 0.0544, Accuracy: 304/1154 (26.3432%)
___Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   2, Avg loss: 0.0271, Accuracy: 470/1154 (40.7279%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.1899, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   1, Avg loss: 0.0544, Accuracy: 289/590 (48.9831%)
___Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   2, Avg loss: 0.0325, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.9354, Accuracy: 50/10000 (0.5000%)
time spent on training: 141.2229597568512
[foolsgold agg] training data poison_ratio: 0.0  data num: [712, 803, 813, 1131, 599, 568, 1475, 2227, 1154, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 29: Avg loss: 5.3137, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Avg loss: 5.5771, Accuracy: 0/9950 (0.0000%)
saving model
Done in 209.89652681350708 sec.
Server Epoch:30 choose agents : [48, 91, 66, 43, 23, 0, 13, 89, 99, 69].
___Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   1, Avg loss: 0.0714, Accuracy: 94/631 (14.8970%)
___Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   2, Avg loss: 0.0416, Accuracy: 206/631 (32.6466%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.8417, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   1, Avg loss: 0.0534, Accuracy: 328/1030 (31.8447%)
___Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   2, Avg loss: 0.0252, Accuracy: 617/1030 (59.9029%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.0944, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0625, Accuracy: 266/1402 (18.9729%)
___Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 367/1402 (26.1769%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.1183, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   1, Avg loss: 0.0606, Accuracy: 304/946 (32.1353%)
___Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 328/946 (34.6723%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 6.0624, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   1, Avg loss: 0.0595, Accuracy: 329/715 (46.0140%)
___Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   2, Avg loss: 0.0403, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.7921, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 368/1657 (22.2088%)
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0343, Accuracy: 530/1657 (31.9855%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.7081, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   1, Avg loss: 0.0577, Accuracy: 301/1645 (18.2979%)
___Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 585/1645 (35.5623%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.9455, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 334/896 (37.2768%)
___Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 440/896 (49.1071%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 6.2427, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   1, Avg loss: 0.0654, Accuracy: 188/773 (24.3208%)
___Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   2, Avg loss: 0.0325, Accuracy: 384/773 (49.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 6.9571, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 284/590 (48.1356%)
___Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 6.9740, Accuracy: 50/10000 (0.5000%)
time spent on training: 177.0481264591217
[foolsgold agg] training data poison_ratio: 0.0  data num: [631, 1030, 1402, 946, 715, 1657, 1645, 896, 773, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.3136, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Avg loss: 5.5771, Accuracy: 0/9950 (0.0000%)
saving model
Done in 242.20367860794067 sec.
Server Epoch:31 choose agents : [29, 31, 94, 0, 60, 21, 98, 67, 96, 30].
___Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 429/1440 (29.7917%)
___Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 664/1440 (46.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.7939, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   1, Avg loss: 0.0815, Accuracy: 56/460 (12.1739%)
___Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   2, Avg loss: 0.0380, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.7487, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 328/1662 (19.7353%)
___Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 583/1662 (35.0782%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.6812, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0580, Accuracy: 386/1657 (23.2951%)
___Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 512/1657 (30.8992%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.5349, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 608/2227 (27.3013%)
___Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1044/2227 (46.8792%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.1891, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   1, Avg loss: 0.0532, Accuracy: 428/1949 (21.9600%)
___Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 625/1949 (32.0677%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.0705, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   1, Avg loss: 0.0816, Accuracy: 18/373 (4.8257%)
___Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   2, Avg loss: 0.0478, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.4638, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0786, Accuracy: 52/426 (12.2066%)
___Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0422, Accuracy: 174/426 (40.8451%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.5420, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.0791, Accuracy: 43/311 (13.8264%)
___Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0539, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.3450, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0810, Accuracy: 65/486 (13.3745%)
___Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0424, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.7750, Accuracy: 47/10000 (0.4700%)
time spent on training: 154.2097237110138
[foolsgold agg] training data poison_ratio: 0.0  data num: [1440, 460, 1662, 1657, 2227, 1949, 373, 426, 311, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.3135, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Avg loss: 5.5752, Accuracy: 0/9950 (0.0000%)
saving model
Done in 219.27099323272705 sec.
Server Epoch:32 choose agents : [26, 45, 19, 17, 84, 8, 90, 80, 58, 48].
___Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0555, Accuracy: 316/1446 (21.8534%)
___Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 502/1446 (34.7165%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.3673, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   1, Avg loss: 0.0684, Accuracy: 203/669 (30.3438%)
___Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   2, Avg loss: 0.0403, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 5.7805, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 406/1036 (39.1892%)
___Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 656/1036 (63.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 9.1211, Accuracy: 53/10000 (0.5300%)
poison local model 17 index 0 
___Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 411/1574 (26.1118%)
___Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 684/1574 (43.4562%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.8157, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 321/1190 (26.9748%)
___Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 465/1190 (39.0756%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.8947, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   1, Avg loss: 0.0599, Accuracy: 244/1513 (16.1269%)
___Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   2, Avg loss: 0.0369, Accuracy: 475/1513 (31.3946%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.4794, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0565, Accuracy: 315/677 (46.5288%)
___Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 450/677 (66.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.4874, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0705, Accuracy: 143/682 (20.9677%)
___Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 255/682 (37.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.2171, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   1, Avg loss: 0.0572, Accuracy: 349/803 (43.4620%)
___Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 398/803 (49.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.0076, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   1, Avg loss: 0.0708, Accuracy: 99/631 (15.6894%)
___Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 219/631 (34.7068%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 5.8448, Accuracy: 50/10000 (0.5000%)
time spent on training: 204.49444937705994
[foolsgold agg] training data poison_ratio: 0.1539966735153116  data num: [1446, 669, 1036, 1574, 1190, 1513, 677, 682, 803, 631]
[foolsgold agg] considering poison per batch poison_fraction: 0.04812396047353487
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 32: Avg loss: 5.3134, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Avg loss: 5.5756, Accuracy: 0/9950 (0.0000%)
saving model
Done in 269.01778268814087 sec.
Server Epoch:33 choose agents : [12, 79, 69, 47, 77, 55, 36, 82, 45, 59].
___Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   1, Avg loss: 0.0871, Accuracy: 23/338 (6.8047%)
___Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   2, Avg loss: 0.0475, Accuracy: 146/338 (43.1953%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.4401, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1011, Accuracy: 14/197 (7.1066%)
___Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0871, Accuracy: 58/197 (29.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.3221, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   1, Avg loss: 0.0550, Accuracy: 291/590 (49.3220%)
___Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 6.9755, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   1, Avg loss: 0.1246, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   2, Avg loss: 0.1126, Accuracy: 10/134 (7.4627%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 324/1340 (24.1791%)
___Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 545/1340 (40.6716%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.5720, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 260/1071 (24.2764%)
___Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 509/1071 (47.5257%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.9189, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   1, Avg loss: 0.0884, Accuracy: 78/408 (19.1176%)
___Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   2, Avg loss: 0.0551, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.4808, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 69/500 (13.8000%)
___Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 177/500 (35.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.6259, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   1, Avg loss: 0.0673, Accuracy: 201/669 (30.0448%)
___Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   2, Avg loss: 0.0413, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.8508, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 278/1089 (25.5280%)
___Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 462/1089 (42.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.2484, Accuracy: 69/10000 (0.6900%)
time spent on training: 125.06682658195496
[foolsgold agg] training data poison_ratio: 0.0  data num: [338, 197, 590, 134, 1340, 1071, 408, 500, 669, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.3134, Accuracy: 43/10000 (0.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Avg loss: 5.5759, Accuracy: 0/9950 (0.0000%)
saving model
Done in 191.0096571445465 sec.
Server Epoch:34 choose agents : [54, 11, 49, 71, 13, 24, 48, 30, 76, 55].
___Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 348/1130 (30.7965%)
___Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 459/1130 (40.6195%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.6816, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   1, Avg loss: 0.0524, Accuracy: 347/712 (48.7360%)
___Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   2, Avg loss: 0.0277, Accuracy: 436/712 (61.2360%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 6.6851, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0805, Accuracy: 22/440 (5.0000%)
___Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0480, Accuracy: 149/440 (33.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.5039, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0645, Accuracy: 167/818 (20.4156%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 357/818 (43.6430%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.1414, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0570, Accuracy: 337/1645 (20.4863%)
___Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0324, Accuracy: 635/1645 (38.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.0006, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 35/312 (11.2179%)
___Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   2, Avg loss: 0.0422, Accuracy: 164/312 (52.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.3904, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0710, Accuracy: 89/631 (14.1046%)
___Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 228/631 (36.1331%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.8217, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   1, Avg loss: 0.0792, Accuracy: 73/486 (15.0206%)
___Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   2, Avg loss: 0.0409, Accuracy: 209/486 (43.0041%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.8267, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   1, Avg loss: 0.0864, Accuracy: 43/466 (9.2275%)
___Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   2, Avg loss: 0.0470, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.6051, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 240/1071 (22.4090%)
___Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 476/1071 (44.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.9462, Accuracy: 81/10000 (0.8100%)
time spent on training: 139.46058630943298
[foolsgold agg] training data poison_ratio: 0.0  data num: [1130, 712, 440, 818, 1645, 312, 631, 486, 466, 1071]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         0.92733813 1.         1.         0.92733813
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.3133, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Avg loss: 5.5760, Accuracy: 0/9950 (0.0000%)
saving model
Done in 204.86240363121033 sec.
Server Epoch:35 choose agents : [58, 11, 1, 66, 48, 71, 33, 12, 41, 6].
___Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0575, Accuracy: 350/803 (43.5866%)
___Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 398/803 (49.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.9721, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   1, Avg loss: 0.0538, Accuracy: 352/712 (49.4382%)
___Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   2, Avg loss: 0.0277, Accuracy: 421/712 (59.1292%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 6.6905, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 288/928 (31.0345%)
___Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 569/928 (61.3147%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.6192, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 271/1402 (19.3295%)
___Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 379/1402 (27.0328%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.1487, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   1, Avg loss: 0.0712, Accuracy: 92/631 (14.5800%)
___Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 217/631 (34.3899%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.7723, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 155/818 (18.9487%)
___Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 348/818 (42.5428%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 6.9969, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0788, Accuracy: 72/515 (13.9806%)
___Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0493, Accuracy: 134/515 (26.0194%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.7789, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0875, Accuracy: 23/338 (6.8047%)
___Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0467, Accuracy: 150/338 (44.3787%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.4305, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   1, Avg loss: 0.0586, Accuracy: 326/719 (45.3408%)
___Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   2, Avg loss: 0.0327, Accuracy: 447/719 (62.1697%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 6.3340, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 385/1956 (19.6830%)
___Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 660/1956 (33.7423%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.1911, Accuracy: 100/10000 (1.0000%)
time spent on training: 169.6536877155304
[foolsgold agg] training data poison_ratio: 0.0  data num: [803, 712, 928, 1402, 631, 818, 515, 338, 719, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.3132, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Avg loss: 5.5764, Accuracy: 0/9950 (0.0000%)
saving model
Done in 234.13040494918823 sec.
Server Epoch:36 choose agents : [11, 60, 43, 76, 42, 51, 33, 91, 70, 10].
___Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0556, Accuracy: 353/712 (49.5787%)
___Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0280, Accuracy: 400/712 (56.1798%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.4677, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 599/2227 (26.8972%)
___Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1029/2227 (46.2057%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.2557, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 305/946 (32.2410%)
___Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 340/946 (35.9408%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.9967, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   1, Avg loss: 0.0858, Accuracy: 50/466 (10.7296%)
___Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   2, Avg loss: 0.0481, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.6370, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 349/1372 (25.4373%)
___Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 514/1372 (37.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.7889, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 234/1049 (22.3070%)
___Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 522/1049 (49.7617%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.5970, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   1, Avg loss: 0.0776, Accuracy: 67/515 (13.0097%)
___Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   2, Avg loss: 0.0533, Accuracy: 119/515 (23.1068%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.6928, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   1, Avg loss: 0.0515, Accuracy: 335/1030 (32.5243%)
___Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   2, Avg loss: 0.0266, Accuracy: 632/1030 (61.3592%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.4330, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   1, Avg loss: 0.0565, Accuracy: 348/1418 (24.5416%)
___Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 663/1418 (46.7560%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.5765, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 212/861 (24.6225%)
___Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   2, Avg loss: 0.0224, Accuracy: 407/861 (47.2706%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.6290, Accuracy: 51/10000 (0.5100%)
time spent on training: 163.9217083454132
[foolsgold agg] training data poison_ratio: 0.0  data num: [712, 2227, 946, 466, 1372, 1049, 515, 1030, 1418, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.3132, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Avg loss: 5.5755, Accuracy: 0/9950 (0.0000%)
saving model
Done in 228.90765070915222 sec.
Server Epoch:37 choose agents : [32, 58, 94, 51, 24, 77, 25, 46, 0, 83].
___Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   1, Avg loss: 0.0597, Accuracy: 205/735 (27.8912%)
___Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 352/735 (47.8912%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.8076, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   1, Avg loss: 0.0574, Accuracy: 348/803 (43.3375%)
___Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 403/803 (50.1868%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 5.9993, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 336/1662 (20.2166%)
___Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 621/1662 (37.3646%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.8057, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0596, Accuracy: 227/1049 (21.6397%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0297, Accuracy: 507/1049 (48.3317%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.2626, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 35/312 (11.2179%)
___Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 158/312 (50.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 5.3843, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0542, Accuracy: 337/1340 (25.1493%)
___Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 554/1340 (41.3433%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.5630, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0574, Accuracy: 303/690 (43.9130%)
___Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0272, Accuracy: 455/690 (65.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.4433, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 413/1904 (21.6912%)
___Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 682/1904 (35.8193%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.5369, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 367/1657 (22.1485%)
___Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   2, Avg loss: 0.0343, Accuracy: 555/1657 (33.4943%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.7336, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 439/1953 (22.4782%)
___Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 737/1953 (37.7368%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.3669, Accuracy: 100/10000 (1.0000%)
time spent on training: 238.30715084075928
[foolsgold agg] training data poison_ratio: 0.0  data num: [735, 803, 1662, 1049, 312, 1340, 690, 1904, 1657, 1953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 37: Avg loss: 5.3131, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Avg loss: 5.5717, Accuracy: 0/9950 (0.0000%)
saving model
Done in 308.1146547794342 sec.
Server Epoch:38 choose agents : [77, 3, 38, 41, 58, 72, 33, 17, 87, 42].
___Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0545, Accuracy: 309/1340 (23.0597%)
___Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 544/1340 (40.5970%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.7926, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   1, Avg loss: 0.0744, Accuracy: 107/781 (13.7004%)
___Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 244/781 (31.2420%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.7620, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0616, Accuracy: 244/1131 (21.5738%)
___Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 506/1131 (44.7392%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.2040, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0579, Accuracy: 333/719 (46.3143%)
___Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0326, Accuracy: 462/719 (64.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.3190, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   1, Avg loss: 0.0586, Accuracy: 350/803 (43.5866%)
___Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   2, Avg loss: 0.0338, Accuracy: 395/803 (49.1905%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.0000, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 245/1241 (19.7421%)
___Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 430/1241 (34.6495%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.0170, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   1, Avg loss: 0.0783, Accuracy: 70/515 (13.5922%)
___Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   2, Avg loss: 0.0497, Accuracy: 119/515 (23.1068%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 5.6871, Accuracy: 52/10000 (0.5200%)
poison local model 17 index 0 
___Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 409/1574 (25.9848%)
___Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 661/1574 (41.9949%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.0581, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   1, Avg loss: 0.0572, Accuracy: 296/1131 (26.1715%)
___Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/1131 (39.7878%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.5805, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0526, Accuracy: 360/1372 (26.2391%)
___Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 500/1372 (36.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.8553, Accuracy: 77/10000 (0.7700%)
time spent on training: 172.53530192375183
[foolsgold agg] training data poison_ratio: 0.1483925709437164  data num: [1340, 781, 1131, 719, 803, 1241, 515, 1574, 1131, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.04637267841991138
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 38: Avg loss: 5.3129, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Avg loss: 5.5714, Accuracy: 0/9950 (0.0000%)
saving model
Done in 238.76038193702698 sec.
Server Epoch:39 choose agents : [7, 16, 26, 58, 43, 31, 91, 65, 70, 71].
___Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   1, Avg loss: 0.0540, Accuracy: 358/891 (40.1796%)
___Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 454/891 (50.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.1081, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   1, Avg loss: 0.0589, Accuracy: 284/708 (40.1130%)
___Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   2, Avg loss: 0.0379, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 5.9067, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 332/1446 (22.9599%)
___Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 490/1446 (33.8866%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.2600, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 362/803 (45.0809%)
___Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 400/803 (49.8132%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 6.1329, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 295/946 (31.1839%)
___Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0356, Accuracy: 347/946 (36.6808%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 6.0733, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   1, Avg loss: 0.0815, Accuracy: 61/460 (13.2609%)
___Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   2, Avg loss: 0.0363, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 5.7872, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   1, Avg loss: 0.0523, Accuracy: 335/1030 (32.5243%)
___Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   2, Avg loss: 0.0252, Accuracy: 621/1030 (60.2913%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.3367, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   1, Avg loss: 0.0553, Accuracy: 389/1475 (26.3729%)
___Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   2, Avg loss: 0.0314, Accuracy: 624/1475 (42.3051%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.1765, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 338/1418 (23.8364%)
___Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 625/1418 (44.0762%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.8532, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0647, Accuracy: 163/818 (19.9267%)
___Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 336/818 (41.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.2094, Accuracy: 68/10000 (0.6800%)
time spent on training: 200.85489702224731
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 708, 1446, 803, 946, 460, 1030, 1475, 1418, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 39: Avg loss: 5.3129, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Avg loss: 5.5704, Accuracy: 0/9950 (0.0000%)
saving model
Done in 267.45514488220215 sec.
Server Epoch:40 choose agents : [91, 9, 78, 81, 54, 1, 63, 83, 43, 64].
___Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   1, Avg loss: 0.0519, Accuracy: 337/1030 (32.7184%)
___Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   2, Avg loss: 0.0261, Accuracy: 624/1030 (60.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.5668, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   1, Avg loss: 0.0498, Accuracy: 354/1275 (27.7647%)
___Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 700/1275 (54.9020%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.5659, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0837, Accuracy: 38/416 (9.1346%)
___Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0476, Accuracy: 181/416 (43.5096%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.5657, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   1, Avg loss: 0.0656, Accuracy: 245/774 (31.6537%)
___Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   2, Avg loss: 0.0360, Accuracy: 335/774 (43.2817%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.2089, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   1, Avg loss: 0.0549, Accuracy: 343/1130 (30.3540%)
___Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 449/1130 (39.7345%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.5753, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 283/928 (30.4957%)
___Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 549/928 (59.1595%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.4954, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0539, Accuracy: 264/888 (29.7297%)
___Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 448/888 (50.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.1787, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0550, Accuracy: 383/1953 (19.6109%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 734/1953 (37.5832%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.6544, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   1, Avg loss: 0.0620, Accuracy: 304/946 (32.1353%)
___Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 339/946 (35.8351%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.0117, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0638, Accuracy: 198/953 (20.7765%)
___Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0377, Accuracy: 318/953 (33.3683%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.6469, Accuracy: 72/10000 (0.7200%)
time spent on training: 162.83714127540588
[foolsgold agg] training data poison_ratio: 0.0  data num: [1030, 1275, 416, 774, 1130, 928, 888, 1953, 946, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.3128, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Avg loss: 5.5687, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 229.68567037582397 sec.
Server Epoch:41 choose agents : [84, 24, 89, 37, 74, 44, 20, 50, 15, 3].
___Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 327/1190 (27.4790%)
___Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 445/1190 (37.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.9495, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   1, Avg loss: 0.0763, Accuracy: 41/312 (13.1410%)
___Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 157/312 (50.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 5.3913, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0600, Accuracy: 327/896 (36.4955%)
___Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 448/896 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.3414, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   1, Avg loss: 0.0519, Accuracy: 435/1129 (38.5297%)
___Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   2, Avg loss: 0.0250, Accuracy: 745/1129 (65.9876%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.5509, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   1, Avg loss: 0.0436, Accuracy: 469/1552 (30.2191%)
___Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 767/1552 (49.4201%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 10.4541, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 423/1750 (24.1714%)
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 662/1750 (37.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.3922, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 346/807 (42.8748%)
___Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   2, Avg loss: 0.0317, Accuracy: 420/807 (52.0446%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.1745, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   1, Avg loss: 0.0625, Accuracy: 163/809 (20.1483%)
___Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   2, Avg loss: 0.0266, Accuracy: 362/809 (44.7466%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.0150, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 337/1154 (29.2028%)
___Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   2, Avg loss: 0.0291, Accuracy: 397/1154 (34.4021%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.9096, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   1, Avg loss: 0.0750, Accuracy: 117/781 (14.9808%)
___Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   2, Avg loss: 0.0355, Accuracy: 230/781 (29.4494%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.6783, Accuracy: 70/10000 (0.7000%)
time spent on training: 204.25945830345154
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 312, 896, 1129, 1552, 1750, 807, 809, 1154, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 41: Avg loss: 5.3127, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Avg loss: 5.5690, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 271.3967056274414 sec.
Server Epoch:42 choose agents : [42, 66, 59, 31, 44, 93, 14, 37, 33, 29].
___Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 362/1372 (26.3848%)
___Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 494/1372 (36.0058%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.8413, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 276/1402 (19.6862%)
___Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 364/1402 (25.9629%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.2273, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   1, Avg loss: 0.0599, Accuracy: 289/1089 (26.5381%)
___Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   2, Avg loss: 0.0270, Accuracy: 470/1089 (43.1589%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.8585, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0817, Accuracy: 67/460 (14.5652%)
___Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 5.7084, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   1, Avg loss: 0.0605, Accuracy: 382/1750 (21.8286%)
___Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 654/1750 (37.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.5535, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 434/1742 (24.9139%)
___Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 707/1742 (40.5855%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.7982, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 223/1013 (22.0138%)
___Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 345/1013 (34.0573%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.6520, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   1, Avg loss: 0.0522, Accuracy: 421/1129 (37.2896%)
___Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 738/1129 (65.3676%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.4812, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   1, Avg loss: 0.0797, Accuracy: 68/515 (13.2039%)
___Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   2, Avg loss: 0.0533, Accuracy: 128/515 (24.8544%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 5.6940, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 410/1440 (28.4722%)
___Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   2, Avg loss: 0.0274, Accuracy: 718/1440 (49.8611%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.1253, Accuracy: 68/10000 (0.6800%)
time spent on training: 197.4150092601776
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 1402, 1089, 460, 1750, 1742, 1013, 1129, 515, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 42: Avg loss: 5.3126, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Avg loss: 5.5689, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 262.434148311615 sec.
Server Epoch:43 choose agents : [89, 77, 29, 75, 94, 3, 90, 39, 30, 20].
___Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 339/896 (37.8348%)
___Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 446/896 (49.7768%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.4394, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 331/1340 (24.7015%)
___Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 550/1340 (41.0448%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.7607, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   1, Avg loss: 0.0495, Accuracy: 403/1440 (27.9861%)
___Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 649/1440 (45.0694%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.1056, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   1, Avg loss: 0.0624, Accuracy: 252/776 (32.4742%)
___Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 411/776 (52.9639%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.9755, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   1, Avg loss: 0.0545, Accuracy: 359/1662 (21.6005%)
___Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 622/1662 (37.4248%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.7387, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   1, Avg loss: 0.0745, Accuracy: 109/781 (13.9565%)
___Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   2, Avg loss: 0.0359, Accuracy: 224/781 (28.6812%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.6020, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0575, Accuracy: 314/677 (46.3811%)
___Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 437/677 (64.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.2710, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 319/1013 (31.4906%)
___Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 510/1013 (50.3455%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.4827, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0800, Accuracy: 79/486 (16.2551%)
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0417, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 5.7314, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 348/807 (43.1227%)
___Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 423/807 (52.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.2524, Accuracy: 50/10000 (0.5000%)
time spent on training: 209.5076584815979
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 1340, 1440, 776, 1662, 781, 677, 1013, 486, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 43: Avg loss: 5.3125, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Avg loss: 5.5689, Accuracy: 0/9950 (0.0000%)
saving model
Done in 276.0244777202606 sec.
Server Epoch:44 choose agents : [98, 51, 93, 3, 14, 31, 63, 57, 35, 56].
___Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   1, Avg loss: 0.0811, Accuracy: 21/373 (5.6300%)
___Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   2, Avg loss: 0.0478, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 5.4473, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 230/1049 (21.9256%)
___Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   2, Avg loss: 0.0297, Accuracy: 521/1049 (49.6663%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.2131, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   1, Avg loss: 0.0543, Accuracy: 411/1742 (23.5936%)
___Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 712/1742 (40.8726%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.6563, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   1, Avg loss: 0.0739, Accuracy: 110/781 (14.0845%)
___Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 243/781 (31.1140%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.6847, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   1, Avg loss: 0.0618, Accuracy: 233/1013 (23.0010%)
___Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 327/1013 (32.2804%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.7604, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0807, Accuracy: 67/460 (14.5652%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 5.8069, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   1, Avg loss: 0.0538, Accuracy: 270/888 (30.4054%)
___Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 439/888 (49.4369%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.5555, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0547, Accuracy: 294/1154 (25.4766%)
___Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0254, Accuracy: 514/1154 (44.5407%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.1500, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0849, Accuracy: 46/271 (16.9742%)
___Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0546, Accuracy: 106/271 (39.1144%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 5.3624, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 65/186 (34.9462%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 5.3118, Accuracy: 50/10000 (0.5000%)
time spent on training: 146.22924041748047
[foolsgold agg] training data poison_ratio: 0.0  data num: [373, 1049, 1742, 781, 1013, 460, 888, 1154, 271, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 44: Avg loss: 5.3124, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Avg loss: 5.5685, Accuracy: 0/9950 (0.0000%)
saving model
Done in 212.51328015327454 sec.
Server Epoch:45 choose agents : [28, 80, 26, 1, 93, 55, 13, 98, 61, 75].
___Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 398/1581 (25.1739%)
___Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 581/1581 (36.7489%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.9409, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   1, Avg loss: 0.0704, Accuracy: 136/682 (19.9413%)
___Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   2, Avg loss: 0.0378, Accuracy: 249/682 (36.5103%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.3759, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 334/1446 (23.0982%)
___Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 516/1446 (35.6846%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.2524, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   1, Avg loss: 0.0564, Accuracy: 288/928 (31.0345%)
___Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 532/928 (57.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.9496, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 407/1742 (23.3639%)
___Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 701/1742 (40.2411%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.5820, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Avg loss: 0.0560, Accuracy: 273/1071 (25.4902%)
___Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 489/1071 (45.6583%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.0080, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   1, Avg loss: 0.0573, Accuracy: 310/1645 (18.8450%)
___Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   2, Avg loss: 0.0324, Accuracy: 626/1645 (38.0547%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.1595, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   1, Avg loss: 0.0815, Accuracy: 22/373 (5.8981%)
___Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   2, Avg loss: 0.0475, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.4286, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1260, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1191, Accuracy: 6/85 (7.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.3040, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   1, Avg loss: 0.0637, Accuracy: 255/776 (32.8608%)
___Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   2, Avg loss: 0.0312, Accuracy: 394/776 (50.7732%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.0408, Accuracy: 50/10000 (0.5000%)
time spent on training: 202.9423246383667
[foolsgold agg] training data poison_ratio: 0.0  data num: [1581, 682, 1446, 928, 1742, 1071, 1645, 373, 85, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.3122, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Avg loss: 5.5681, Accuracy: 0/9950 (0.0000%)
saving model
Done in 272.4386143684387 sec.
Server Epoch:46 choose agents : [96, 53, 15, 74, 95, 89, 38, 49, 11, 16].
___Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0791, Accuracy: 47/311 (15.1125%)
___Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.3481, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   1, Avg loss: 0.0495, Accuracy: 288/813 (35.4244%)
___Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 453/813 (55.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.1956, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0576, Accuracy: 316/1154 (27.3830%)
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0285, Accuracy: 474/1154 (41.0745%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.8064, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 509/1552 (32.7964%)
___Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 774/1552 (49.8711%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 10.2856, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0541, Accuracy: 329/599 (54.9249%)
___Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0285, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.5282, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0614, Accuracy: 330/896 (36.8304%)
___Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 440/896 (49.1071%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 6.3073, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   1, Avg loss: 0.0613, Accuracy: 250/1131 (22.1043%)
___Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 478/1131 (42.2635%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.5733, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   1, Avg loss: 0.0802, Accuracy: 29/440 (6.5909%)
___Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   2, Avg loss: 0.0475, Accuracy: 148/440 (33.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.4791, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   1, Avg loss: 0.0564, Accuracy: 345/712 (48.4551%)
___Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   2, Avg loss: 0.0264, Accuracy: 409/712 (57.4438%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 6.5233, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0601, Accuracy: 279/708 (39.4068%)
___Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.8161, Accuracy: 60/10000 (0.6000%)
time spent on training: 180.83718419075012
[foolsgold agg] training data poison_ratio: 0.0  data num: [311, 813, 1154, 1552, 599, 896, 1131, 440, 712, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         1.         0.81959217 0.81959217]
___Test Target_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.3122, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Avg loss: 5.5685, Accuracy: 0/9950 (0.0000%)
saving model
Done in 245.51160883903503 sec.
Server Epoch:47 choose agents : [65, 76, 17, 71, 31, 74, 25, 82, 54, 12].
___Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   1, Avg loss: 0.0552, Accuracy: 398/1475 (26.9831%)
___Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   2, Avg loss: 0.0312, Accuracy: 710/1475 (48.1356%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.9962, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0852, Accuracy: 49/466 (10.5150%)
___Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0483, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 5.6633, Accuracy: 50/10000 (0.5000%)
poison local model 17 index 0 
___Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 404/1574 (25.6671%)
___Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 653/1574 (41.4867%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.0665, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   1, Avg loss: 0.0642, Accuracy: 148/818 (18.0929%)
___Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 320/818 (39.1198%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.0139, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   1, Avg loss: 0.0810, Accuracy: 59/460 (12.8261%)
___Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 5.7547, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 486/1552 (31.3144%)
___Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 779/1552 (50.1933%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 10.9045, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   1, Avg loss: 0.0560, Accuracy: 308/690 (44.6377%)
___Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 454/690 (65.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.3886, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 71/500 (14.2000%)
___Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 179/500 (35.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 5.5960, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 348/1130 (30.7965%)
___Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   2, Avg loss: 0.0284, Accuracy: 468/1130 (41.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.5768, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 21/338 (6.2130%)
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0471, Accuracy: 126/338 (37.2781%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 5.4382, Accuracy: 50/10000 (0.5000%)
time spent on training: 194.7787458896637
[foolsgold agg] training data poison_ratio: 0.17483061201821615  data num: [1475, 466, 1574, 818, 460, 1552, 690, 500, 1130, 338]
[foolsgold agg] considering poison per batch poison_fraction: 0.054634566255692546
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 47: Avg loss: 5.3121, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Avg loss: 5.5678, Accuracy: 0/9950 (0.0000%)
saving model
Done in 260.433895111084 sec.
Server Epoch:48 choose agents : [41, 89, 82, 3, 10, 19, 72, 60, 95, 38].
___Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   1, Avg loss: 0.0586, Accuracy: 336/719 (46.7316%)
___Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   2, Avg loss: 0.0325, Accuracy: 451/719 (62.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.3956, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 335/896 (37.3884%)
___Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 448/896 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.3378, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 75/500 (15.0000%)
___Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 171/500 (34.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 5.7159, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   1, Avg loss: 0.0742, Accuracy: 108/781 (13.8284%)
___Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   2, Avg loss: 0.0350, Accuracy: 252/781 (32.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.4985, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   1, Avg loss: 0.0568, Accuracy: 209/861 (24.2741%)
___Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 458/861 (53.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.6323, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0479, Accuracy: 390/1036 (37.6448%)
___Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0243, Accuracy: 663/1036 (63.9961%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 10.0976, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   1, Avg loss: 0.0613, Accuracy: 252/1241 (20.3062%)
___Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 386/1241 (31.1039%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.1887, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 588/2227 (26.4032%)
___Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1007/2227 (45.2178%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.2757, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0540, Accuracy: 335/599 (55.9265%)
___Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0294, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.4021, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0617, Accuracy: 245/1131 (21.6622%)
___Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 491/1131 (43.4129%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.4944, Accuracy: 75/10000 (0.7500%)
time spent on training: 203.37849879264832
[foolsgold agg] training data poison_ratio: 0.0  data num: [719, 896, 500, 781, 861, 1036, 1241, 2227, 599, 1131]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 48: Avg loss: 5.3120, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Avg loss: 5.5658, Accuracy: 0/9950 (0.0000%)
saving model
Done in 270.4049942493439 sec.
Server Epoch:49 choose agents : [17, 1, 30, 40, 83, 97, 18, 68, 10, 21].
poison local model 17 index 0 
___Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0508, Accuracy: 416/1574 (26.4295%)
___Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 689/1574 (43.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.2932, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   1, Avg loss: 0.0558, Accuracy: 292/928 (31.4655%)
___Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 564/928 (60.7759%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.6354, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   1, Avg loss: 0.0800, Accuracy: 69/486 (14.1975%)
___Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   2, Avg loss: 0.0403, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 5.8164, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 340/1573 (21.6147%)
___Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 558/1573 (35.4736%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.2535, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 445/1953 (22.7855%)
___Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 750/1953 (38.4025%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.9043, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 355/1213 (29.2663%)
___Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 499/1213 (41.1377%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.6747, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0772, Accuracy: 116/530 (21.8868%)
___Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0389, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 5.9467, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   1, Avg loss: 0.0628, Accuracy: 365/1163 (31.3844%)
___Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   2, Avg loss: 0.0364, Accuracy: 457/1163 (39.2949%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 6.5519, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   1, Avg loss: 0.0568, Accuracy: 213/861 (24.7387%)
___Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 456/861 (52.9617%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.0551, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 413/1949 (21.1904%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 625/1949 (32.0677%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.3971, Accuracy: 81/10000 (0.8100%)
time spent on training: 257.29852962493896
[foolsgold agg] training data poison_ratio: 0.12869991823385118  data num: [1574, 928, 486, 1573, 1953, 1213, 530, 1163, 861, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.040218724448078495
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 49: Avg loss: 5.3120, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Avg loss: 5.5656, Accuracy: 0/9950 (0.0000%)
saving model
Done in 328.38600158691406 sec.
Server Epoch:50 choose agents : [39, 48, 81, 51, 63, 5, 60, 7, 70, 41].
___Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   1, Avg loss: 0.0539, Accuracy: 313/1013 (30.8983%)
___Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 493/1013 (48.6673%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.6091, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 100/631 (15.8479%)
___Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0410, Accuracy: 227/631 (35.9746%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 5.8280, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0691, Accuracy: 245/774 (31.6537%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0344, Accuracy: 321/774 (41.4729%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.4300, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   1, Avg loss: 0.0593, Accuracy: 235/1049 (22.4023%)
___Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   2, Avg loss: 0.0295, Accuracy: 547/1049 (52.1449%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.4676, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   1, Avg loss: 0.0542, Accuracy: 254/888 (28.6036%)
___Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 421/888 (47.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.8771, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   1, Avg loss: 0.0504, Accuracy: 401/1628 (24.6314%)
___Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 818/1628 (50.2457%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.2743, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 528/2227 (23.7090%)
___Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1021/2227 (45.8464%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.2824, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   1, Avg loss: 0.0541, Accuracy: 364/891 (40.8530%)
___Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 449/891 (50.3928%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.0418, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 351/1418 (24.7532%)
___Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 666/1418 (46.9676%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.6900, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   1, Avg loss: 0.0605, Accuracy: 336/719 (46.7316%)
___Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   2, Avg loss: 0.0303, Accuracy: 459/719 (63.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.3406, Accuracy: 57/10000 (0.5700%)
time spent on training: 191.45229768753052
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 631, 774, 1049, 888, 1628, 2227, 891, 1418, 719]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 50: Avg loss: 5.3119, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Avg loss: 5.5649, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 259.59662914276123 sec.
Server Epoch:51 choose agents : [4, 56, 21, 33, 59, 41, 11, 71, 6, 92].
___Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   1, Avg loss: 0.0609, Accuracy: 329/901 (36.5150%)
___Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   2, Avg loss: 0.0363, Accuracy: 360/901 (39.9556%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.6495, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0671, Accuracy: 70/186 (37.6344%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 419/1949 (21.4982%)
___Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   2, Avg loss: 0.0326, Accuracy: 626/1949 (32.1190%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.0736, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0808, Accuracy: 68/515 (13.2039%)
___Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0508, Accuracy: 122/515 (23.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 5.6868, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0581, Accuracy: 304/1089 (27.9155%)
___Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 453/1089 (41.5978%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.1463, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   1, Avg loss: 0.0575, Accuracy: 335/719 (46.5925%)
___Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   2, Avg loss: 0.0321, Accuracy: 471/719 (65.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 6.3283, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   1, Avg loss: 0.0548, Accuracy: 349/712 (49.0169%)
___Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 441/712 (61.9382%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 6.5893, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0639, Accuracy: 164/818 (20.0489%)
___Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 377/818 (46.0880%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.1502, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 400/1956 (20.4499%)
___Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 641/1956 (32.7710%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.2707, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   1, Avg loss: 0.0519, Accuracy: 455/1715 (26.5306%)
___Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 709/1715 (41.3411%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.7850, Accuracy: 89/10000 (0.8900%)
time spent on training: 227.56282258033752
[foolsgold agg] training data poison_ratio: 0.0  data num: [901, 186, 1949, 515, 1089, 719, 712, 818, 1956, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 51: Avg loss: 5.3118, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 51: Avg loss: 5.5647, Accuracy: 0/9950 (0.0000%)
saving model
Done in 298.51250100135803 sec.
Server Epoch:52 choose agents : [89, 33, 83, 60, 57, 18, 41, 0, 31, 30].
___Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 330/896 (36.8304%)
___Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 437/896 (48.7723%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 6.3021, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   1, Avg loss: 0.0775, Accuracy: 72/515 (13.9806%)
___Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   2, Avg loss: 0.0519, Accuracy: 118/515 (22.9126%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 5.8513, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 417/1953 (21.3518%)
___Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 747/1953 (38.2488%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.7056, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 588/2227 (26.4032%)
___Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   2, Avg loss: 0.0285, Accuracy: 1012/2227 (45.4423%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.3779, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   1, Avg loss: 0.0546, Accuracy: 311/1154 (26.9497%)
___Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   2, Avg loss: 0.0244, Accuracy: 565/1154 (48.9601%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.4740, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0763, Accuracy: 122/530 (23.0189%)
___Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0368, Accuracy: 265/530 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 5.9896, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   1, Avg loss: 0.0607, Accuracy: 330/719 (45.8971%)
___Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   2, Avg loss: 0.0311, Accuracy: 453/719 (63.0042%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 6.2072, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   1, Avg loss: 0.0588, Accuracy: 331/1657 (19.9759%)
___Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 510/1657 (30.7785%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.6724, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0808, Accuracy: 67/460 (14.5652%)
___Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0357, Accuracy: 186/460 (40.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 5.8009, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   1, Avg loss: 0.0790, Accuracy: 74/486 (15.2263%)
___Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   2, Avg loss: 0.0401, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 5.7584, Accuracy: 42/10000 (0.4200%)
time spent on training: 190.91167664527893
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 515, 1953, 2227, 1154, 530, 719, 1657, 460, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 52: Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 52: Avg loss: 5.5635, Accuracy: 0/9950 (0.0000%)
saving model
Done in 256.990797996521 sec.
Server Epoch:53 choose agents : [43, 26, 61, 17, 27, 48, 39, 7, 15, 21].
___Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 308/946 (32.5581%)
___Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   2, Avg loss: 0.0355, Accuracy: 344/946 (36.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 6.0262, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   1, Avg loss: 0.0545, Accuracy: 347/1446 (23.9972%)
___Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 515/1446 (35.6155%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.3192, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   1, Avg loss: 0.1238, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   2, Avg loss: 0.1161, Accuracy: 10/85 (11.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 5.3036, Accuracy: 47/10000 (0.4700%)
poison local model 17 index 0 
___Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 414/1574 (26.3024%)
___Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 670/1574 (42.5667%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.3118, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0540, Accuracy: 437/1587 (27.5362%)
___Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 584/1587 (36.7990%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.1330, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 97/631 (15.3724%)
___Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   2, Avg loss: 0.0401, Accuracy: 222/631 (35.1823%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 5.8602, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   1, Avg loss: 0.0539, Accuracy: 310/1013 (30.6022%)
___Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   2, Avg loss: 0.0255, Accuracy: 515/1013 (50.8391%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.8526, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 355/891 (39.8429%)
___Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   2, Avg loss: 0.0249, Accuracy: 459/891 (51.5152%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.1312, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   1, Avg loss: 0.0563, Accuracy: 335/1154 (29.0295%)
___Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   2, Avg loss: 0.0284, Accuracy: 463/1154 (40.1213%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.9573, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 417/1949 (21.3956%)
___Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 630/1949 (32.3243%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.2759, Accuracy: 93/10000 (0.9300%)
time spent on training: 275.19340991973877
[foolsgold agg] training data poison_ratio: 0.13958850656261085  data num: [946, 1446, 85, 1574, 1587, 631, 1013, 891, 1154, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.043621408300815886
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 53: Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 53: Avg loss: 5.5636, Accuracy: 0/9950 (0.0000%)
saving model
Done in 343.50005078315735 sec.
Server Epoch:54 choose agents : [37, 68, 15, 88, 46, 83, 7, 6, 92, 53].
___Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   1, Avg loss: 0.0514, Accuracy: 431/1129 (38.1754%)
___Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 746/1129 (66.0762%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.3618, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   1, Avg loss: 0.0627, Accuracy: 365/1163 (31.3844%)
___Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   2, Avg loss: 0.0377, Accuracy: 414/1163 (35.5976%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.7540, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   1, Avg loss: 0.0582, Accuracy: 330/1154 (28.5962%)
___Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   2, Avg loss: 0.0296, Accuracy: 442/1154 (38.3016%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.4082, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   1, Avg loss: 0.0748, Accuracy: 146/603 (24.2123%)
___Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 5.8630, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0545, Accuracy: 425/1904 (22.3214%)
___Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 682/1904 (35.8193%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.5493, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 423/1953 (21.6590%)
___Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 797/1953 (40.8090%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.8276, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0528, Accuracy: 347/891 (38.9450%)
___Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 462/891 (51.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.1602, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   1, Avg loss: 0.0543, Accuracy: 407/1956 (20.8078%)
___Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 630/1956 (32.2086%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.4265, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 471/1715 (27.4636%)
___Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 698/1715 (40.6997%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.5390, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   1, Avg loss: 0.0487, Accuracy: 292/813 (35.9164%)
___Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 473/813 (58.1796%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.4555, Accuracy: 53/10000 (0.5300%)
time spent on training: 252.95042824745178
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 1163, 1154, 603, 1904, 1953, 891, 1956, 1715, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 54: Avg loss: 5.3116, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 54: Avg loss: 5.5640, Accuracy: 0/9950 (0.0000%)
saving model
Done in 321.3940703868866 sec.
Server Epoch:55 choose agents : [87, 76, 15, 54, 78, 12, 60, 11, 26, 97].
___Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   1, Avg loss: 0.0571, Accuracy: 300/1131 (26.5252%)
___Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 431/1131 (38.1079%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.6697, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   1, Avg loss: 0.0846, Accuracy: 50/466 (10.7296%)
___Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   2, Avg loss: 0.0492, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.7386, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 325/1154 (28.1629%)
___Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   2, Avg loss: 0.0292, Accuracy: 415/1154 (35.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.6440, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 347/1130 (30.7080%)
___Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 510/1130 (45.1327%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.9099, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.0834, Accuracy: 35/416 (8.4135%)
___Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0462, Accuracy: 182/416 (43.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.5709, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0868, Accuracy: 26/338 (7.6923%)
___Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0470, Accuracy: 147/338 (43.4911%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.4549, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 597/2227 (26.8074%)
___Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1039/2227 (46.6547%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.3559, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   1, Avg loss: 0.0531, Accuracy: 354/712 (49.7191%)
___Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   2, Avg loss: 0.0264, Accuracy: 458/712 (64.3258%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.6188, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 329/1446 (22.7524%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 489/1446 (33.8174%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.1708, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 355/1213 (29.2663%)
___Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 503/1213 (41.4674%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.7168, Accuracy: 93/10000 (0.9300%)
time spent on training: 252.8708324432373
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 466, 1154, 1130, 416, 338, 2227, 712, 1446, 1213]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.3115, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 55: Avg loss: 5.5631, Accuracy: 0/9950 (0.0000%)
saving model
Done in 318.90914034843445 sec.
Server Epoch:56 choose agents : [40, 83, 46, 17, 88, 71, 44, 31, 25, 6].
___Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   1, Avg loss: 0.0551, Accuracy: 374/1573 (23.7762%)
___Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   2, Avg loss: 0.0342, Accuracy: 598/1573 (38.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.5899, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 412/1953 (21.0958%)
___Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 738/1953 (37.7880%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.4926, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   1, Avg loss: 0.0548, Accuracy: 423/1904 (22.2164%)
___Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 660/1904 (34.6639%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.7355, Accuracy: 112/10000 (1.1200%)
poison local model 17 index 0 
___Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0511, Accuracy: 422/1574 (26.8107%)
___Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0270, Accuracy: 699/1574 (44.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.2259, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 140/603 (23.2172%)
___Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   2, Avg loss: 0.0466, Accuracy: 280/603 (46.4345%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 5.9568, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   1, Avg loss: 0.0636, Accuracy: 171/818 (20.9046%)
___Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   2, Avg loss: 0.0302, Accuracy: 382/818 (46.6993%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.2488, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   1, Avg loss: 0.0583, Accuracy: 395/1750 (22.5714%)
___Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 618/1750 (35.3143%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.4592, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   1, Avg loss: 0.0808, Accuracy: 65/460 (14.1304%)
___Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   2, Avg loss: 0.0365, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 5.7791, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0560, Accuracy: 312/690 (45.2174%)
___Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 460/690 (66.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.3990, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 367/1956 (18.7628%)
___Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 683/1956 (34.9182%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.2202, Accuracy: 106/10000 (1.0600%)
time spent on training: 269.56541299819946
[foolsgold agg] training data poison_ratio: 0.11851517205029742  data num: [1573, 1953, 1904, 1574, 603, 818, 1750, 460, 690, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.037035991265717945
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 56: Avg loss: 5.3114, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 56: Avg loss: 5.5630, Accuracy: 0/9950 (0.0000%)
saving model
Done in 337.39787769317627 sec.
Server Epoch:57 choose agents : [39, 55, 3, 31, 73, 74, 69, 87, 8, 34].
___Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   1, Avg loss: 0.0533, Accuracy: 318/1013 (31.3919%)
___Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 494/1013 (48.7660%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.8041, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0555, Accuracy: 261/1071 (24.3697%)
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 533/1071 (49.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.0639, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   1, Avg loss: 0.0746, Accuracy: 106/781 (13.5723%)
___Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   2, Avg loss: 0.0363, Accuracy: 242/781 (30.9859%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.6450, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   1, Avg loss: 0.0799, Accuracy: 70/460 (15.2174%)
___Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 189/460 (41.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 5.7604, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   1, Avg loss: 0.0654, Accuracy: 176/938 (18.7633%)
___Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 310/938 (33.0490%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.9663, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 502/1552 (32.3454%)
___Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 778/1552 (50.1289%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 10.7743, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   1, Avg loss: 0.0571, Accuracy: 292/590 (49.4915%)
___Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   2, Avg loss: 0.0301, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.9370, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   1, Avg loss: 0.0574, Accuracy: 300/1131 (26.5252%)
___Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   2, Avg loss: 0.0312, Accuracy: 428/1131 (37.8426%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.7295, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   1, Avg loss: 0.0598, Accuracy: 225/1513 (14.8711%)
___Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 482/1513 (31.8572%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.3429, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0583, Accuracy: 365/1427 (25.5781%)
___Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 558/1427 (39.1030%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.7773, Accuracy: 56/10000 (0.5600%)
time spent on training: 241.26342701911926
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 1071, 781, 460, 938, 1552, 590, 1131, 1513, 1427]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 57: Avg loss: 5.3114, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 57: Avg loss: 5.5625, Accuracy: 0/9950 (0.0000%)
saving model
Done in 308.0395996570587 sec.
Server Epoch:58 choose agents : [33, 30, 88, 34, 73, 19, 26, 23, 32, 22].
___Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0776, Accuracy: 67/515 (13.0097%)
___Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0554, Accuracy: 134/515 (26.0194%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.7437, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   1, Avg loss: 0.0797, Accuracy: 77/486 (15.8436%)
___Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   2, Avg loss: 0.0398, Accuracy: 209/486 (43.0041%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.7675, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 141/603 (23.3831%)
___Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0463, Accuracy: 288/603 (47.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.0753, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0581, Accuracy: 391/1427 (27.4001%)
___Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 599/1427 (41.9762%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.7468, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   1, Avg loss: 0.0650, Accuracy: 178/938 (18.9765%)
___Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 354/938 (37.7399%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.5771, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0469, Accuracy: 410/1036 (39.5753%)
___Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0237, Accuracy: 663/1036 (63.9961%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.3851, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 353/1446 (24.4122%)
___Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 508/1446 (35.1314%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.4132, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0593, Accuracy: 327/715 (45.7343%)
___Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0398, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.8055, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   1, Avg loss: 0.0596, Accuracy: 197/735 (26.8027%)
___Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 357/735 (48.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.7671, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 540/1470 (36.7347%)
___Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 832/1470 (56.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.1159, Accuracy: 67/10000 (0.6700%)
time spent on training: 204.2391378879547
[foolsgold agg] training data poison_ratio: 0.0  data num: [515, 486, 603, 1427, 938, 1036, 1446, 715, 735, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.3113, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 58: Avg loss: 5.5578, Accuracy: 0/9950 (0.0000%)
saving model
Done in 274.97390818595886 sec.
Server Epoch:59 choose agents : [68, 82, 5, 39, 20, 22, 96, 74, 52, 98].
___Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   1, Avg loss: 0.0630, Accuracy: 368/1163 (31.6423%)
___Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   2, Avg loss: 0.0370, Accuracy: 445/1163 (38.2631%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.0429, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 70/500 (14.0000%)
___Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 170/500 (34.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 5.6648, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   1, Avg loss: 0.0513, Accuracy: 377/1628 (23.1572%)
___Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   2, Avg loss: 0.0259, Accuracy: 833/1628 (51.1671%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.1075, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 321/1013 (31.6881%)
___Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 509/1013 (50.2468%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.6090, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 342/807 (42.3792%)
___Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0326, Accuracy: 399/807 (49.4424%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.7632, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 524/1470 (35.6463%)
___Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 831/1470 (56.5306%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.0580, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 56/311 (18.0064%)
___Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 5.3512, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 493/1552 (31.7655%)
___Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 778/1552 (50.1289%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 10.2259, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 280/636 (44.0252%)
___Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.1197, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   1, Avg loss: 0.0804, Accuracy: 28/373 (7.5067%)
___Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   2, Avg loss: 0.0475, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 5.4380, Accuracy: 50/10000 (0.5000%)
time spent on training: 249.0701277256012
[foolsgold agg] training data poison_ratio: 0.0  data num: [1163, 500, 1628, 1013, 807, 1470, 311, 1552, 636, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 59: Avg loss: 5.3113, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 59: Avg loss: 5.5580, Accuracy: 0/9950 (0.0000%)
saving model
Done in 313.64730405807495 sec.
Server Epoch:60 choose agents : [50, 97, 52, 73, 41, 60, 11, 53, 69, 10].
___Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0628, Accuracy: 148/809 (18.2942%)
___Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 357/809 (44.1286%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.3865, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 364/1213 (30.0082%)
___Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0269, Accuracy: 542/1213 (44.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.5890, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0555, Accuracy: 290/636 (45.5975%)
___Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.5502, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0650, Accuracy: 172/938 (18.3369%)
___Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0337, Accuracy: 323/938 (34.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.3797, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 335/719 (46.5925%)
___Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   2, Avg loss: 0.0317, Accuracy: 453/719 (63.0042%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.3713, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 586/2227 (26.3134%)
___Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1041/2227 (46.7445%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.7030, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 352/712 (49.4382%)
___Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0257, Accuracy: 422/712 (59.2697%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.6001, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 306/813 (37.6384%)
___Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 470/813 (57.8106%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.1824, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   1, Avg loss: 0.0560, Accuracy: 292/590 (49.4915%)
___Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.0673, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0568, Accuracy: 211/861 (24.5064%)
___Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 470/861 (54.5877%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.1561, Accuracy: 55/10000 (0.5500%)
time spent on training: 221.53174018859863
[foolsgold agg] training data poison_ratio: 0.0  data num: [809, 1213, 636, 938, 719, 2227, 712, 813, 590, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 60: Avg loss: 5.3113, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 60: Avg loss: 5.5559, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 288.5946555137634 sec.
Server Epoch:61 choose agents : [83, 17, 50, 24, 37, 5, 54, 52, 11, 68].
___Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 437/1953 (22.3758%)
___Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 760/1953 (38.9145%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.8694, Accuracy: 102/10000 (1.0200%)
poison local model 17 index 0 
___Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 402/1574 (25.5400%)
___Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 705/1574 (44.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.0021, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 145/809 (17.9234%)
___Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0274, Accuracy: 351/809 (43.3869%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.2261, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 36/312 (11.5385%)
___Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   2, Avg loss: 0.0404, Accuracy: 165/312 (52.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 5.3974, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   1, Avg loss: 0.0519, Accuracy: 395/1129 (34.9867%)
___Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   2, Avg loss: 0.0247, Accuracy: 719/1129 (63.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.8065, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   1, Avg loss: 0.0507, Accuracy: 402/1628 (24.6929%)
___Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 816/1628 (50.1229%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.0526, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0539, Accuracy: 357/1130 (31.5929%)
___Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0281, Accuracy: 517/1130 (45.7522%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.7877, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   1, Avg loss: 0.0558, Accuracy: 283/636 (44.4969%)
___Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.1404, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   1, Avg loss: 0.0562, Accuracy: 351/712 (49.2978%)
___Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   2, Avg loss: 0.0271, Accuracy: 406/712 (57.0225%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.5897, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   1, Avg loss: 0.0631, Accuracy: 365/1163 (31.3844%)
___Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   2, Avg loss: 0.0374, Accuracy: 399/1163 (34.3078%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.5629, Accuracy: 66/10000 (0.6600%)
time spent on training: 235.0566005706787
[foolsgold agg] training data poison_ratio: 0.142495020822017  data num: [1953, 1574, 809, 312, 1129, 1628, 1130, 636, 712, 1163]
[foolsgold agg] considering poison per batch poison_fraction: 0.04452969400688032
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 61: Avg loss: 5.3112, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 61: Avg loss: 5.5568, Accuracy: 0/9950 (0.0000%)
saving model
Done in 302.90055871009827 sec.
Server Epoch:62 choose agents : [82, 77, 23, 80, 3, 29, 92, 32, 68, 59].
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0759, Accuracy: 68/500 (13.6000%)
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 182/500 (36.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.7649, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 336/1340 (25.0746%)
___Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 548/1340 (40.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.6567, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   1, Avg loss: 0.0603, Accuracy: 319/715 (44.6154%)
___Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   2, Avg loss: 0.0405, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.7493, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 150/682 (21.9941%)
___Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 250/682 (36.6569%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.3413, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   1, Avg loss: 0.0730, Accuracy: 117/781 (14.9808%)
___Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   2, Avg loss: 0.0362, Accuracy: 251/781 (32.1383%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.7469, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 415/1440 (28.8194%)
___Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0284, Accuracy: 680/1440 (47.2222%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.6965, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 450/1715 (26.2391%)
___Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   2, Avg loss: 0.0302, Accuracy: 740/1715 (43.1487%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.9543, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   1, Avg loss: 0.0602, Accuracy: 195/735 (26.5306%)
___Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 321/735 (43.6735%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.7507, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   1, Avg loss: 0.0626, Accuracy: 371/1163 (31.9003%)
___Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   2, Avg loss: 0.0373, Accuracy: 434/1163 (37.3173%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.8639, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0524, Accuracy: 314/1089 (28.8338%)
___Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 475/1089 (43.6180%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.4563, Accuracy: 64/10000 (0.6400%)
time spent on training: 255.22101593017578
[foolsgold agg] training data poison_ratio: 0.0  data num: [500, 1340, 715, 682, 781, 1440, 1715, 735, 1163, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 62: Avg loss: 5.5540, Accuracy: 0/9950 (0.0000%)
saving model
Done in 321.8318452835083 sec.
Server Epoch:63 choose agents : [18, 63, 37, 93, 54, 89, 57, 58, 65, 75].
___Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0755, Accuracy: 117/530 (22.0755%)
___Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0399, Accuracy: 271/530 (51.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.0790, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 264/888 (29.7297%)
___Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 453/888 (51.0135%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.3188, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0514, Accuracy: 435/1129 (38.5297%)
___Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0243, Accuracy: 736/1129 (65.1904%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.5822, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   1, Avg loss: 0.0545, Accuracy: 423/1742 (24.2824%)
___Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   2, Avg loss: 0.0322, Accuracy: 645/1742 (37.0264%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.6163, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 344/1130 (30.4425%)
___Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 481/1130 (42.5664%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.5261, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 340/896 (37.9464%)
___Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 432/896 (48.2143%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.2976, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0536, Accuracy: 307/1154 (26.6031%)
___Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0261, Accuracy: 496/1154 (42.9809%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.3903, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 347/803 (43.2130%)
___Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 399/803 (49.6887%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 5.9439, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   1, Avg loss: 0.0562, Accuracy: 418/1475 (28.3390%)
___Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   2, Avg loss: 0.0319, Accuracy: 631/1475 (42.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.1124, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   1, Avg loss: 0.0621, Accuracy: 257/776 (33.1186%)
___Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   2, Avg loss: 0.0305, Accuracy: 412/776 (53.0928%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.0651, Accuracy: 51/10000 (0.5100%)
time spent on training: 222.38171243667603
[foolsgold agg] training data poison_ratio: 0.0  data num: [530, 888, 1129, 1742, 1130, 896, 1154, 803, 1475, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 63: Avg loss: 5.3110, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 63: Avg loss: 5.5520, Accuracy: 0/9950 (0.0000%)
saving model
Done in 290.7742819786072 sec.
Server Epoch:64 choose agents : [76, 12, 56, 63, 47, 22, 70, 34, 31, 74].
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 45/466 (9.6567%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0491, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.6873, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 24/338 (7.1006%)
___Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   2, Avg loss: 0.0465, Accuracy: 139/338 (41.1243%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.4621, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   2, Avg loss: 0.0677, Accuracy: 71/186 (38.1720%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.3109, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0540, Accuracy: 264/888 (29.7297%)
___Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 466/888 (52.4775%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.7671, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   1, Avg loss: 0.1237, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   2, Avg loss: 0.1050, Accuracy: 22/134 (16.4179%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.3097, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 542/1470 (36.8707%)
___Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 835/1470 (56.8027%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.1966, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0549, Accuracy: 373/1418 (26.3047%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 693/1418 (48.8717%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.8399, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   1, Avg loss: 0.0585, Accuracy: 389/1427 (27.2600%)
___Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 568/1427 (39.8038%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 6.9421, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   1, Avg loss: 0.0801, Accuracy: 78/460 (16.9565%)
___Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   2, Avg loss: 0.0349, Accuracy: 190/460 (41.3043%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.7819, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   1, Avg loss: 0.0424, Accuracy: 523/1552 (33.6985%)
___Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 791/1552 (50.9665%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 10.3661, Accuracy: 85/10000 (0.8500%)
time spent on training: 241.7738709449768
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 338, 186, 888, 134, 1470, 1418, 1427, 460, 1552]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         0.82972925 1.
 1.         1.         0.82972925 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.3109, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 64: Avg loss: 5.5512, Accuracy: 0/9950 (0.0000%)
saving model
Done in 314.8591899871826 sec.
Server Epoch:65 choose agents : [27, 36, 11, 14, 83, 29, 65, 72, 80, 10].
___Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 421/1587 (26.5280%)
___Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0333, Accuracy: 622/1587 (39.1934%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.1707, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   1, Avg loss: 0.0871, Accuracy: 75/408 (18.3824%)
___Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   2, Avg loss: 0.0543, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 5.4908, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 353/712 (49.5787%)
___Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 435/712 (61.0955%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 6.6063, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0612, Accuracy: 229/1013 (22.6061%)
___Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 328/1013 (32.3791%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 6.7882, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0533, Accuracy: 446/1953 (22.8367%)
___Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 761/1953 (38.9657%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.0176, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   1, Avg loss: 0.0496, Accuracy: 402/1440 (27.9167%)
___Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 639/1440 (44.3750%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.9139, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   1, Avg loss: 0.0545, Accuracy: 416/1475 (28.2034%)
___Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   2, Avg loss: 0.0317, Accuracy: 650/1475 (44.0678%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 6.9991, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 265/1241 (21.3537%)
___Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 399/1241 (32.1515%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.1046, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0697, Accuracy: 153/682 (22.4340%)
___Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 250/682 (36.6569%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 6.4936, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 215/861 (24.9710%)
___Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   2, Avg loss: 0.0209, Accuracy: 462/861 (53.6585%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.8282, Accuracy: 50/10000 (0.5000%)
time spent on training: 238.51842427253723
[foolsgold agg] training data poison_ratio: 0.0  data num: [1587, 408, 712, 1013, 1953, 1440, 1475, 1241, 682, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 65: Avg loss: 5.3108, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 65: Avg loss: 5.5492, Accuracy: 0/9950 (0.0000%)
saving model
Done in 302.53978395462036 sec.
Server Epoch:66 choose agents : [88, 61, 93, 18, 80, 92, 90, 72, 6, 70].
___Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0747, Accuracy: 147/603 (24.3781%)
___Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0456, Accuracy: 283/603 (46.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.9802, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   1, Avg loss: 0.1248, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   2, Avg loss: 0.1169, Accuracy: 8/85 (9.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.3039, Accuracy: 43/10000 (0.4300%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 443/1742 (25.4305%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 708/1742 (40.6429%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.6745, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0761, Accuracy: 129/530 (24.3396%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0387, Accuracy: 266/530 (50.1887%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.0839, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   1, Avg loss: 0.0702, Accuracy: 141/682 (20.6745%)
___Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 245/682 (35.9238%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.3304, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 455/1715 (26.5306%)
___Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 724/1715 (42.2157%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.3780, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   1, Avg loss: 0.0562, Accuracy: 325/677 (48.0059%)
___Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   2, Avg loss: 0.0235, Accuracy: 452/677 (66.7651%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.3174, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 264/1241 (21.2732%)
___Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 431/1241 (34.7301%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.1110, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   1, Avg loss: 0.0543, Accuracy: 381/1956 (19.4785%)
___Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 657/1956 (33.5890%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.1769, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 362/1418 (25.5289%)
___Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 600/1418 (42.3131%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.6442, Accuracy: 107/10000 (1.0700%)
time spent on training: 300.6718189716339
[foolsgold agg] training data poison_ratio: 0.0  data num: [603, 85, 1742, 530, 682, 1715, 677, 1241, 1956, 1418]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.3106, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 66: Avg loss: 5.5487, Accuracy: 0/9950 (0.0000%)
saving model
Done in 367.829549074173 sec.
Server Epoch:67 choose agents : [43, 82, 95, 55, 5, 73, 63, 38, 13, 76].
___Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   1, Avg loss: 0.0608, Accuracy: 308/946 (32.5581%)
___Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   2, Avg loss: 0.0354, Accuracy: 371/946 (39.2178%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.0232, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   1, Avg loss: 0.0755, Accuracy: 78/500 (15.6000%)
___Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 171/500 (34.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 5.6676, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0522, Accuracy: 334/599 (55.7596%)
___Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0314, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.9419, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 268/1071 (25.0233%)
___Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   2, Avg loss: 0.0285, Accuracy: 519/1071 (48.4594%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.9475, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 361/1628 (22.1744%)
___Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 845/1628 (51.9042%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.3335, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0656, Accuracy: 170/938 (18.1237%)
___Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 359/938 (38.2729%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.3240, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   1, Avg loss: 0.0540, Accuracy: 262/888 (29.5045%)
___Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 457/888 (51.4640%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.9894, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   1, Avg loss: 0.0614, Accuracy: 254/1131 (22.4580%)
___Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 484/1131 (42.7940%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.5238, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0567, Accuracy: 339/1645 (20.6079%)
___Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0324, Accuracy: 631/1645 (38.3587%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.8605, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0849, Accuracy: 54/466 (11.5880%)
___Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0456, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 5.7131, Accuracy: 50/10000 (0.5000%)
time spent on training: 224.57630276679993
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 500, 599, 1071, 1628, 938, 888, 1131, 1645, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 67: Avg loss: 5.3106, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 67: Avg loss: 5.5479, Accuracy: 0/9950 (0.0000%)
saving model
Done in 295.37612223625183 sec.
Server Epoch:68 choose agents : [20, 23, 58, 43, 82, 8, 16, 86, 51, 62].
___Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 350/807 (43.3705%)
___Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   2, Avg loss: 0.0326, Accuracy: 406/807 (50.3098%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.0898, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   1, Avg loss: 0.0592, Accuracy: 330/715 (46.1538%)
___Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   2, Avg loss: 0.0383, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 5.8023, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 354/803 (44.0847%)
___Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 385/803 (47.9452%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 6.0123, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   1, Avg loss: 0.0613, Accuracy: 306/946 (32.3467%)
___Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 327/946 (34.5666%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 6.0776, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0761, Accuracy: 70/500 (14.0000%)
___Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 176/500 (35.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 5.6948, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 248/1513 (16.3913%)
___Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 484/1513 (31.9894%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.7053, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   1, Avg loss: 0.0627, Accuracy: 285/708 (40.2542%)
___Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   2, Avg loss: 0.0356, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 5.8449, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   1, Avg loss: 0.0622, Accuracy: 357/1003 (35.5932%)
___Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   2, Avg loss: 0.0339, Accuracy: 393/1003 (39.1825%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 6.7207, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   1, Avg loss: 0.0590, Accuracy: 234/1049 (22.3070%)
___Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   2, Avg loss: 0.0293, Accuracy: 515/1049 (49.0944%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.5049, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   1, Avg loss: 0.0685, Accuracy: 145/568 (25.5282%)
___Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   2, Avg loss: 0.0402, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 5.7703, Accuracy: 52/10000 (0.5200%)
time spent on training: 229.77808475494385
[foolsgold agg] training data poison_ratio: 0.0  data num: [807, 715, 803, 946, 500, 1513, 708, 1003, 1049, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 68: Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 68: Avg loss: 5.5478, Accuracy: 0/9950 (0.0000%)
saving model
Done in 295.79853987693787 sec.
Server Epoch:69 choose agents : [20, 30, 43, 88, 69, 79, 82, 4, 68, 74].
___Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 354/807 (43.8662%)
___Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 423/807 (52.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.1339, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   1, Avg loss: 0.0783, Accuracy: 79/486 (16.2551%)
___Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   2, Avg loss: 0.0407, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 5.7534, Accuracy: 43/10000 (0.4300%)
___Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 311/946 (32.8753%)
___Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 327/946 (34.5666%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.0728, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0737, Accuracy: 147/603 (24.3781%)
___Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0459, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.0140, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0552, Accuracy: 297/590 (50.3390%)
___Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.8259, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   1, Avg loss: 0.1006, Accuracy: 17/197 (8.6294%)
___Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   2, Avg loss: 0.0819, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 5.3227, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   1, Avg loss: 0.0760, Accuracy: 76/500 (15.2000%)
___Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   2, Avg loss: 0.0480, Accuracy: 173/500 (34.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 5.6424, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   1, Avg loss: 0.0612, Accuracy: 337/901 (37.4029%)
___Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   2, Avg loss: 0.0331, Accuracy: 374/901 (41.5094%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.1330, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   1, Avg loss: 0.0625, Accuracy: 371/1163 (31.9003%)
___Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   2, Avg loss: 0.0365, Accuracy: 444/1163 (38.1771%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.7617, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 467/1552 (30.0902%)
___Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 778/1552 (50.1289%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 10.6522, Accuracy: 88/10000 (0.8800%)
time spent on training: 194.22719264030457
[foolsgold agg] training data poison_ratio: 0.0  data num: [807, 486, 946, 603, 590, 197, 500, 901, 1163, 1552]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 69: Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 69: Avg loss: 5.5487, Accuracy: 0/9950 (0.0000%)
saving model
Done in 263.06916189193726 sec.
Server Epoch:70 choose agents : [6, 73, 75, 99, 15, 8, 19, 96, 47, 65].
___Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0541, Accuracy: 399/1956 (20.3988%)
___Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0314, Accuracy: 658/1956 (33.6401%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.1888, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0652, Accuracy: 179/938 (19.0832%)
___Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 340/938 (36.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.9497, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0611, Accuracy: 265/776 (34.1495%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0303, Accuracy: 413/776 (53.2216%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.7684, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   1, Avg loss: 0.0658, Accuracy: 181/773 (23.4153%)
___Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   2, Avg loss: 0.0316, Accuracy: 411/773 (53.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.1427, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   1, Avg loss: 0.0558, Accuracy: 343/1154 (29.7227%)
___Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   2, Avg loss: 0.0280, Accuracy: 452/1154 (39.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.1457, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 245/1513 (16.1930%)
___Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   2, Avg loss: 0.0361, Accuracy: 518/1513 (34.2366%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.2753, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0468, Accuracy: 416/1036 (40.1544%)
___Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0246, Accuracy: 667/1036 (64.3822%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.0296, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   1, Avg loss: 0.0793, Accuracy: 42/311 (13.5048%)
___Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   2, Avg loss: 0.0538, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.3492, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1241, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1043, Accuracy: 17/134 (12.6866%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.3092, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   1, Avg loss: 0.0560, Accuracy: 374/1475 (25.3559%)
___Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   2, Avg loss: 0.0299, Accuracy: 691/1475 (46.8475%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.8480, Accuracy: 99/10000 (0.9900%)
time spent on training: 276.04766178131104
[foolsgold agg] training data poison_ratio: 0.0  data num: [1956, 938, 776, 773, 1154, 1513, 1036, 311, 134, 1475]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.3105, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 70: Avg loss: 5.5468, Accuracy: 0/9950 (0.0000%)
saving model
Done in 341.74049520492554 sec.
Server Epoch:71 choose agents : [48, 5, 73, 89, 81, 23, 32, 77, 18, 83].
___Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   1, Avg loss: 0.0703, Accuracy: 108/631 (17.1157%)
___Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   2, Avg loss: 0.0410, Accuracy: 227/631 (35.9746%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.9123, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   1, Avg loss: 0.0503, Accuracy: 394/1628 (24.2015%)
___Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 812/1628 (49.8771%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.3980, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   1, Avg loss: 0.0637, Accuracy: 180/938 (19.1898%)
___Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   2, Avg loss: 0.0329, Accuracy: 334/938 (35.6077%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.2825, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0597, Accuracy: 337/896 (37.6116%)
___Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 437/896 (48.7723%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 6.3915, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0683, Accuracy: 251/774 (32.4289%)
___Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0365, Accuracy: 266/774 (34.3669%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 6.2552, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0596, Accuracy: 323/715 (45.1748%)
___Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0399, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.7651, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   1, Avg loss: 0.0595, Accuracy: 206/735 (28.0272%)
___Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   2, Avg loss: 0.0222, Accuracy: 310/735 (42.1769%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.8611, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0531, Accuracy: 345/1340 (25.7463%)
___Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 531/1340 (39.6269%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.6798, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0752, Accuracy: 124/530 (23.3962%)
___Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0377, Accuracy: 266/530 (50.1887%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 6.0917, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   1, Avg loss: 0.0530, Accuracy: 485/1953 (24.8336%)
___Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   2, Avg loss: 0.0326, Accuracy: 842/1953 (43.1132%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.7397, Accuracy: 105/10000 (1.0500%)
time spent on training: 283.90442061424255
[foolsgold agg] training data poison_ratio: 0.0  data num: [631, 1628, 938, 896, 774, 715, 735, 1340, 530, 1953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Avg loss: 5.5418, Accuracy: 0/9950 (0.0000%)
saving model
Done in 348.7199671268463 sec.
Server Epoch:72 choose agents : [30, 16, 63, 90, 33, 98, 3, 62, 21, 19].
___Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   1, Avg loss: 0.0784, Accuracy: 88/486 (18.1070%)
___Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 5.8091, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   1, Avg loss: 0.0618, Accuracy: 281/708 (39.6893%)
___Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   2, Avg loss: 0.0369, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 5.8420, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 264/888 (29.7297%)
___Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 432/888 (48.6486%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.2318, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   1, Avg loss: 0.0572, Accuracy: 317/677 (46.8242%)
___Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 449/677 (66.3220%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.2426, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   1, Avg loss: 0.0779, Accuracy: 70/515 (13.5922%)
___Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   2, Avg loss: 0.0526, Accuracy: 140/515 (27.1845%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 5.6911, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   1, Avg loss: 0.0803, Accuracy: 36/373 (9.6515%)
___Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   2, Avg loss: 0.0472, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 5.4460, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   1, Avg loss: 0.0728, Accuracy: 120/781 (15.3649%)
___Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   2, Avg loss: 0.0373, Accuracy: 247/781 (31.6261%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.8034, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   1, Avg loss: 0.0688, Accuracy: 143/568 (25.1761%)
___Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   2, Avg loss: 0.0406, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 5.8156, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 384/1949 (19.7024%)
___Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 635/1949 (32.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.2494, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0477, Accuracy: 421/1036 (40.6371%)
___Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 673/1036 (64.9614%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.0751, Accuracy: 70/10000 (0.7000%)
time spent on training: 223.14544415473938
[foolsgold agg] training data poison_ratio: 0.0  data num: [486, 708, 888, 677, 515, 373, 781, 568, 1949, 1036]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 72: Avg loss: 5.3103, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Avg loss: 5.5415, Accuracy: 0/9950 (0.0000%)
saving model
Done in 289.68831610679626 sec.
Server Epoch:73 choose agents : [26, 99, 33, 95, 3, 71, 80, 11, 58, 87].
___Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 348/1446 (24.0664%)
___Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 511/1446 (35.3389%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.2107, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   1, Avg loss: 0.0670, Accuracy: 198/773 (25.6145%)
___Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   2, Avg loss: 0.0301, Accuracy: 403/773 (52.1345%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.1317, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0787, Accuracy: 70/515 (13.5922%)
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0512, Accuracy: 126/515 (24.4660%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.8316, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   1, Avg loss: 0.0506, Accuracy: 332/599 (55.4257%)
___Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.8491, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   1, Avg loss: 0.0732, Accuracy: 118/781 (15.1088%)
___Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   2, Avg loss: 0.0368, Accuracy: 239/781 (30.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.9470, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0639, Accuracy: 171/818 (20.9046%)
___Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 343/818 (41.9315%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.9334, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   1, Avg loss: 0.0693, Accuracy: 145/682 (21.2610%)
___Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 260/682 (38.1232%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.4589, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   1, Avg loss: 0.0536, Accuracy: 348/712 (48.8764%)
___Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 416/712 (58.4270%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.4986, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   1, Avg loss: 0.0567, Accuracy: 353/803 (43.9601%)
___Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 413/803 (51.4321%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.0555, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   1, Avg loss: 0.0575, Accuracy: 305/1131 (26.9673%)
___Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   2, Avg loss: 0.0312, Accuracy: 394/1131 (34.8364%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.6654, Accuracy: 51/10000 (0.5100%)
time spent on training: 186.44812679290771
[foolsgold agg] training data poison_ratio: 0.0  data num: [1446, 773, 515, 599, 781, 818, 682, 712, 803, 1131]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.3102, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Avg loss: 5.5417, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.74607491493225 sec.
Server Epoch:74 choose agents : [8, 37, 99, 62, 49, 43, 0, 91, 92, 52].
___Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 251/1513 (16.5896%)
___Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   2, Avg loss: 0.0360, Accuracy: 479/1513 (31.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.4060, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0517, Accuracy: 446/1129 (39.5040%)
___Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0243, Accuracy: 747/1129 (66.1647%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.4329, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   1, Avg loss: 0.0664, Accuracy: 193/773 (24.9677%)
___Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   2, Avg loss: 0.0316, Accuracy: 407/773 (52.6520%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.1628, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   1, Avg loss: 0.0682, Accuracy: 156/568 (27.4648%)
___Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 5.7782, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   1, Avg loss: 0.0795, Accuracy: 26/440 (5.9091%)
___Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   2, Avg loss: 0.0473, Accuracy: 149/440 (33.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 5.5254, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   1, Avg loss: 0.0613, Accuracy: 311/946 (32.8753%)
___Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 342/946 (36.1522%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 6.0755, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 341/1657 (20.5794%)
___Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 520/1657 (31.3820%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.7525, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   1, Avg loss: 0.0506, Accuracy: 340/1030 (33.0097%)
___Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   2, Avg loss: 0.0271, Accuracy: 620/1030 (60.1942%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.5131, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 460/1715 (26.8222%)
___Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 721/1715 (42.0408%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.7349, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   1, Avg loss: 0.0554, Accuracy: 285/636 (44.8113%)
___Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 6.4101, Accuracy: 50/10000 (0.5000%)
time spent on training: 207.4974639415741
[foolsgold agg] training data poison_ratio: 0.0  data num: [1513, 1129, 773, 568, 440, 946, 1657, 1030, 1715, 636]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 74: Avg loss: 5.3101, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Avg loss: 5.5419, Accuracy: 0/9950 (0.0000%)
saving model
Done in 271.776638507843 sec.
Server Epoch:75 choose agents : [87, 64, 73, 84, 3, 54, 80, 11, 20, 63].
___Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   1, Avg loss: 0.0573, Accuracy: 313/1131 (27.6746%)
___Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   2, Avg loss: 0.0311, Accuracy: 450/1131 (39.7878%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.5117, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0638, Accuracy: 176/953 (18.4680%)
___Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 307/953 (32.2141%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.6270, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   1, Avg loss: 0.0650, Accuracy: 171/938 (18.2303%)
___Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 315/938 (33.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.1912, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   1, Avg loss: 0.0622, Accuracy: 336/1190 (28.2353%)
___Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 448/1190 (37.6471%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.0032, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   1, Avg loss: 0.0727, Accuracy: 119/781 (15.2369%)
___Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   2, Avg loss: 0.0364, Accuracy: 218/781 (27.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.0218, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   1, Avg loss: 0.0541, Accuracy: 360/1130 (31.8584%)
___Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 511/1130 (45.2212%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.9791, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   1, Avg loss: 0.0694, Accuracy: 147/682 (21.5543%)
___Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   2, Avg loss: 0.0376, Accuracy: 250/682 (36.6569%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.2633, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0543, Accuracy: 359/712 (50.4213%)
___Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0258, Accuracy: 424/712 (59.5506%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.8711, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 356/807 (44.1140%)
___Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 412/807 (51.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.8833, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 269/888 (30.2928%)
___Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 438/888 (49.3243%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.3617, Accuracy: 51/10000 (0.5100%)
time spent on training: 199.4495334625244
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 953, 938, 1190, 781, 1130, 682, 712, 807, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 75: Avg loss: 5.3101, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Avg loss: 5.5396, Accuracy: 0/9950 (0.0000%)
saving model
Done in 263.873752117157 sec.
Server Epoch:76 choose agents : [4, 71, 9, 54, 82, 38, 16, 87, 91, 34].
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0630, Accuracy: 336/901 (37.2919%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0318, Accuracy: 379/901 (42.0644%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 6.8082, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   1, Avg loss: 0.0636, Accuracy: 165/818 (20.1711%)
___Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 343/818 (41.9315%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.3709, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   1, Avg loss: 0.0491, Accuracy: 367/1275 (28.7843%)
___Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 706/1275 (55.3725%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.2588, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   1, Avg loss: 0.0540, Accuracy: 347/1130 (30.7080%)
___Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 473/1130 (41.8584%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.7248, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   1, Avg loss: 0.0761, Accuracy: 72/500 (14.4000%)
___Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   2, Avg loss: 0.0482, Accuracy: 171/500 (34.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 5.6385, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   1, Avg loss: 0.0608, Accuracy: 252/1131 (22.2812%)
___Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 494/1131 (43.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.3324, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   1, Avg loss: 0.0614, Accuracy: 281/708 (39.6893%)
___Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   2, Avg loss: 0.0366, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 5.8969, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0579, Accuracy: 305/1131 (26.9673%)
___Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0319, Accuracy: 387/1131 (34.2175%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.5710, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   1, Avg loss: 0.0502, Accuracy: 342/1030 (33.2039%)
___Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   2, Avg loss: 0.0265, Accuracy: 646/1030 (62.7184%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.6856, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   1, Avg loss: 0.0568, Accuracy: 402/1427 (28.1710%)
___Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 597/1427 (41.8360%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 6.8906, Accuracy: 60/10000 (0.6000%)
time spent on training: 215.04108357429504
[foolsgold agg] training data poison_ratio: 0.0  data num: [901, 818, 1275, 1130, 500, 1131, 708, 1131, 1030, 1427]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 76: Avg loss: 5.3100, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Avg loss: 5.5403, Accuracy: 0/9950 (0.0000%)
saving model
Done in 279.13015604019165 sec.
Server Epoch:77 choose agents : [60, 16, 98, 30, 49, 88, 70, 59, 93, 27].
___Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 598/2227 (26.8523%)
___Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1022/2227 (45.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.1327, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   1, Avg loss: 0.0606, Accuracy: 291/708 (41.1017%)
___Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   2, Avg loss: 0.0390, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.7706, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.0801, Accuracy: 29/373 (7.7748%)
___Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0467, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.4345, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   1, Avg loss: 0.0782, Accuracy: 93/486 (19.1358%)
___Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   2, Avg loss: 0.0428, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.9704, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0790, Accuracy: 39/440 (8.8636%)
___Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0471, Accuracy: 149/440 (33.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.5213, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0740, Accuracy: 149/603 (24.7098%)
___Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0464, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.0306, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   1, Avg loss: 0.0558, Accuracy: 354/1418 (24.9647%)
___Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 635/1418 (44.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.8077, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0532, Accuracy: 322/1089 (29.5684%)
___Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 462/1089 (42.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.3769, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0542, Accuracy: 438/1742 (25.1435%)
___Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 715/1742 (41.0448%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.7228, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   1, Avg loss: 0.0543, Accuracy: 441/1587 (27.7883%)
___Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 633/1587 (39.8866%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.1133, Accuracy: 65/10000 (0.6500%)
time spent on training: 236.7004315853119
[foolsgold agg] training data poison_ratio: 0.0  data num: [2227, 708, 373, 486, 440, 603, 1418, 1089, 1742, 1587]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.3100, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Avg loss: 5.5396, Accuracy: 0/9950 (0.0000%)
saving model
Done in 301.77574253082275 sec.
Server Epoch:78 choose agents : [0, 63, 47, 75, 97, 35, 25, 88, 18, 91].
___Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0574, Accuracy: 351/1657 (21.1829%)
___Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 530/1657 (31.9855%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.2931, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   1, Avg loss: 0.0540, Accuracy: 257/888 (28.9414%)
___Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 432/888 (48.6486%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.4889, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   1, Avg loss: 0.1186, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   2, Avg loss: 0.1071, Accuracy: 20/134 (14.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.3091, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 268/776 (34.5361%)
___Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 426/776 (54.8969%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.9691, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 352/1213 (29.0190%)
___Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   2, Avg loss: 0.0269, Accuracy: 517/1213 (42.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.5940, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   1, Avg loss: 0.0855, Accuracy: 47/271 (17.3432%)
___Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   2, Avg loss: 0.0553, Accuracy: 112/271 (41.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.3685, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   1, Avg loss: 0.0559, Accuracy: 321/690 (46.5217%)
___Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 459/690 (66.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.5393, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   1, Avg loss: 0.0734, Accuracy: 147/603 (24.3781%)
___Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   2, Avg loss: 0.0459, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.1095, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0756, Accuracy: 122/530 (23.0189%)
___Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0375, Accuracy: 277/530 (52.2642%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.2562, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   1, Avg loss: 0.0531, Accuracy: 341/1030 (33.1068%)
___Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   2, Avg loss: 0.0250, Accuracy: 657/1030 (63.7864%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.3463, Accuracy: 82/10000 (0.8200%)
time spent on training: 196.42733311653137
[foolsgold agg] training data poison_ratio: 0.0  data num: [1657, 888, 134, 776, 1213, 271, 690, 603, 530, 1030]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.3100, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Avg loss: 5.5397, Accuracy: 0/9950 (0.0000%)
saving model
Done in 261.05482506752014 sec.
Server Epoch:79 choose agents : [69, 33, 14, 95, 94, 24, 52, 85, 18, 51].
___Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   1, Avg loss: 0.0551, Accuracy: 294/590 (49.8305%)
___Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   2, Avg loss: 0.0314, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.7520, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0778, Accuracy: 71/515 (13.7864%)
___Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0502, Accuracy: 137/515 (26.6019%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 5.8382, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 230/1013 (22.7048%)
___Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 319/1013 (31.4906%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.7273, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0515, Accuracy: 342/599 (57.0952%)
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.6588, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0542, Accuracy: 360/1662 (21.6606%)
___Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0325, Accuracy: 638/1662 (38.3875%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.6528, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   1, Avg loss: 0.0763, Accuracy: 39/312 (12.5000%)
___Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   2, Avg loss: 0.0403, Accuracy: 169/312 (54.1667%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 5.3995, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0558, Accuracy: 288/636 (45.2830%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0321, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.4327, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0552, Accuracy: 449/1988 (22.5855%)
___Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 675/1988 (33.9537%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.9492, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0749, Accuracy: 126/530 (23.7736%)
___Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0367, Accuracy: 270/530 (50.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.2257, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0597, Accuracy: 230/1049 (21.9256%)
___Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0297, Accuracy: 529/1049 (50.4290%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.5964, Accuracy: 71/10000 (0.7100%)
time spent on training: 207.68267273902893
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 515, 1013, 599, 1662, 312, 636, 1988, 530, 1049]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 79: Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Avg loss: 5.5400, Accuracy: 0/9950 (0.0000%)
saving model
Done in 273.9550230503082 sec.
Server Epoch:80 choose agents : [89, 46, 50, 90, 86, 76, 73, 60, 96, 75].
___Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 342/896 (38.1696%)
___Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 422/896 (47.0982%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 6.3811, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0555, Accuracy: 417/1904 (21.9013%)
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 676/1904 (35.5042%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.4533, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   1, Avg loss: 0.0625, Accuracy: 151/809 (18.6650%)
___Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 348/809 (43.0161%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.1010, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0577, Accuracy: 316/677 (46.6765%)
___Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 447/677 (66.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.1498, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   1, Avg loss: 0.0621, Accuracy: 363/1003 (36.1914%)
___Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   2, Avg loss: 0.0340, Accuracy: 390/1003 (38.8833%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 6.6290, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0840, Accuracy: 53/466 (11.3734%)
___Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0480, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.6515, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   1, Avg loss: 0.0644, Accuracy: 183/938 (19.5096%)
___Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 307/938 (32.7292%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.1974, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 605/2227 (27.1666%)
___Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1048/2227 (47.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.3933, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 46/311 (14.7910%)
___Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   2, Avg loss: 0.0543, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.3489, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0637, Accuracy: 258/776 (33.2474%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0286, Accuracy: 409/776 (52.7062%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.2257, Accuracy: 50/10000 (0.5000%)
time spent on training: 211.6166808605194
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 1904, 809, 677, 1003, 466, 938, 2227, 311, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Avg loss: 5.5383, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.7802679538727 sec.
Server Epoch:81 choose agents : [59, 91, 18, 23, 49, 95, 60, 89, 53, 14].
___Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   1, Avg loss: 0.0590, Accuracy: 317/1089 (29.1093%)
___Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   2, Avg loss: 0.0289, Accuracy: 488/1089 (44.8118%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.1085, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   1, Avg loss: 0.0518, Accuracy: 340/1030 (33.0097%)
___Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   2, Avg loss: 0.0247, Accuracy: 661/1030 (64.1748%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.3846, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0754, Accuracy: 122/530 (23.0189%)
___Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0400, Accuracy: 269/530 (50.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 6.0349, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   1, Avg loss: 0.0607, Accuracy: 325/715 (45.4545%)
___Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   2, Avg loss: 0.0387, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.7997, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 37/440 (8.4091%)
___Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0471, Accuracy: 144/440 (32.7273%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.5266, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0514, Accuracy: 333/599 (55.5927%)
___Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0302, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.5596, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 618/2227 (27.7503%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1018/2227 (45.7117%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.1819, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 344/896 (38.3929%)
___Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 428/896 (47.7679%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 6.2814, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0496, Accuracy: 289/813 (35.5474%)
___Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 457/813 (56.2116%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.4763, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   1, Avg loss: 0.0613, Accuracy: 228/1013 (22.5074%)
___Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 351/1013 (34.6496%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 6.7039, Accuracy: 78/10000 (0.7800%)
time spent on training: 210.98349976539612
[foolsgold agg] training data poison_ratio: 0.0  data num: [1089, 1030, 530, 715, 440, 599, 2227, 896, 813, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Avg loss: 5.5376, Accuracy: 0/9950 (0.0000%)
saving model
Done in 277.5367543697357 sec.
Server Epoch:82 choose agents : [58, 82, 36, 79, 60, 20, 46, 80, 12, 30].
___Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 359/803 (44.7073%)
___Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 373/803 (46.4508%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 6.1313, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   1, Avg loss: 0.0759, Accuracy: 76/500 (15.2000%)
___Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   2, Avg loss: 0.0474, Accuracy: 177/500 (35.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.6762, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   1, Avg loss: 0.0871, Accuracy: 78/408 (19.1176%)
___Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   2, Avg loss: 0.0538, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.5196, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1039, Accuracy: 23/197 (11.6751%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.0846, Accuracy: 59/197 (29.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.3194, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 604/2227 (27.1217%)
___Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1022/2227 (45.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.2135, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   1, Avg loss: 0.0555, Accuracy: 357/807 (44.2379%)
___Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 423/807 (52.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 6.9494, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   1, Avg loss: 0.0544, Accuracy: 394/1904 (20.6933%)
___Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 670/1904 (35.1891%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.7359, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0694, Accuracy: 150/682 (21.9941%)
___Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0372, Accuracy: 244/682 (35.7771%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 6.3379, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   1, Avg loss: 0.0865, Accuracy: 22/338 (6.5089%)
___Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   2, Avg loss: 0.0491, Accuracy: 154/338 (45.5621%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.4627, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   1, Avg loss: 0.0784, Accuracy: 86/486 (17.6955%)
___Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.8653, Accuracy: 47/10000 (0.4700%)
time spent on training: 196.9014093875885
[foolsgold agg] training data poison_ratio: 0.0  data num: [803, 500, 408, 197, 2227, 807, 1904, 682, 338, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.3098, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Avg loss: 5.5366, Accuracy: 0/9950 (0.0000%)
saving model
Done in 260.98841071128845 sec.
Server Epoch:83 choose agents : [42, 64, 32, 1, 35, 56, 44, 74, 93, 78].
___Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 351/1372 (25.5831%)
___Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 504/1372 (36.7347%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.9427, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   1, Avg loss: 0.0642, Accuracy: 172/953 (18.0483%)
___Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 291/953 (30.5352%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.5118, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   1, Avg loss: 0.0589, Accuracy: 214/735 (29.1156%)
___Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 369/735 (50.2041%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.5179, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   1, Avg loss: 0.0575, Accuracy: 293/928 (31.5733%)
___Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   2, Avg loss: 0.0234, Accuracy: 557/928 (60.0216%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.9350, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   1, Avg loss: 0.0855, Accuracy: 35/271 (12.9151%)
___Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   2, Avg loss: 0.0539, Accuracy: 116/271 (42.8044%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.3693, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 75/186 (40.3226%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 398/1750 (22.7429%)
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 668/1750 (38.1714%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.3430, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 530/1552 (34.1495%)
___Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 778/1552 (50.1289%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.6194, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 418/1742 (23.9954%)
___Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 737/1742 (42.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.8150, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0830, Accuracy: 41/416 (9.8558%)
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0463, Accuracy: 190/416 (45.6731%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.5866, Accuracy: 51/10000 (0.5100%)
time spent on training: 237.63054299354553
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 953, 735, 928, 271, 186, 1750, 1552, 1742, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.3098, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Avg loss: 5.5326, Accuracy: 0/9950 (0.0000%)
saving model
Done in 302.57891154289246 sec.
Server Epoch:84 choose agents : [97, 25, 53, 60, 55, 28, 37, 44, 1, 14].
___Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   1, Avg loss: 0.0517, Accuracy: 374/1213 (30.8326%)
___Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 517/1213 (42.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.7194, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   1, Avg loss: 0.0567, Accuracy: 309/690 (44.7826%)
___Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   2, Avg loss: 0.0271, Accuracy: 465/690 (67.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 6.5955, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0483, Accuracy: 322/813 (39.6064%)
___Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 471/813 (57.9336%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 9.7519, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   1, Avg loss: 0.0487, Accuracy: 620/2227 (27.8401%)
___Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1050/2227 (47.1486%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.2718, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0552, Accuracy: 273/1071 (25.4902%)
___Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 520/1071 (48.5528%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.0210, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 373/1581 (23.5927%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 588/1581 (37.1917%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.5171, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   1, Avg loss: 0.0509, Accuracy: 438/1129 (38.7954%)
___Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 740/1129 (65.5447%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.0616, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 405/1750 (23.1429%)
___Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 675/1750 (38.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.5826, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   1, Avg loss: 0.0566, Accuracy: 295/928 (31.7888%)
___Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   2, Avg loss: 0.0238, Accuracy: 564/928 (60.7759%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.5430, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 227/1013 (22.4087%)
___Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 359/1013 (35.4393%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 6.6924, Accuracy: 52/10000 (0.5200%)
time spent on training: 296.9377295970917
[foolsgold agg] training data poison_ratio: 0.0  data num: [1213, 690, 813, 2227, 1071, 1581, 1129, 1750, 928, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.3097, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Avg loss: 5.5319, Accuracy: 0/9950 (0.0000%)
saving model
Done in 361.5004405975342 sec.
Server Epoch:85 choose agents : [82, 2, 84, 18, 95, 7, 87, 78, 22, 57].
___Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   1, Avg loss: 0.0758, Accuracy: 76/500 (15.2000%)
___Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 177/500 (35.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.7131, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0653, Accuracy: 235/605 (38.8430%)
___Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0380, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.8027, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   1, Avg loss: 0.0613, Accuracy: 323/1190 (27.1429%)
___Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 432/1190 (36.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.1899, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0750, Accuracy: 120/530 (22.6415%)
___Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0377, Accuracy: 271/530 (51.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.0681, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   1, Avg loss: 0.0497, Accuracy: 340/599 (56.7613%)
___Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   2, Avg loss: 0.0314, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.3107, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 361/891 (40.5163%)
___Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 407/891 (45.6790%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.3364, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   1, Avg loss: 0.0578, Accuracy: 297/1131 (26.2599%)
___Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 391/1131 (34.5712%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.4739, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   1, Avg loss: 0.0826, Accuracy: 43/416 (10.3365%)
___Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   2, Avg loss: 0.0464, Accuracy: 180/416 (43.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.5944, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   1, Avg loss: 0.0465, Accuracy: 492/1470 (33.4694%)
___Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   2, Avg loss: 0.0234, Accuracy: 847/1470 (57.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.9045, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   1, Avg loss: 0.0544, Accuracy: 314/1154 (27.2097%)
___Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   2, Avg loss: 0.0247, Accuracy: 516/1154 (44.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.4175, Accuracy: 69/10000 (0.6900%)
time spent on training: 216.279363155365
[foolsgold agg] training data poison_ratio: 0.0  data num: [500, 605, 1190, 530, 599, 891, 1131, 416, 1470, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.3097, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Avg loss: 5.5321, Accuracy: 0/9950 (0.0000%)
saving model
Done in 282.25704765319824 sec.
Server Epoch:86 choose agents : [56, 98, 59, 19, 34, 83, 80, 43, 40, 58].
___Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 75/186 (40.3226%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 5.3108, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   1, Avg loss: 0.0800, Accuracy: 35/373 (9.3834%)
___Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   2, Avg loss: 0.0465, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 5.4605, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 316/1089 (29.0174%)
___Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0276, Accuracy: 516/1089 (47.3829%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.4463, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 412/1036 (39.7683%)
___Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0237, Accuracy: 663/1036 (63.9961%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.3538, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   1, Avg loss: 0.0583, Accuracy: 382/1427 (26.7694%)
___Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 580/1427 (40.6447%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.9185, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   1, Avg loss: 0.0537, Accuracy: 432/1953 (22.1198%)
___Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   2, Avg loss: 0.0331, Accuracy: 805/1953 (41.2186%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.0389, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 148/682 (21.7009%)
___Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   2, Avg loss: 0.0372, Accuracy: 266/682 (39.0029%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.4651, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   1, Avg loss: 0.0606, Accuracy: 312/946 (32.9810%)
___Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   2, Avg loss: 0.0353, Accuracy: 359/946 (37.9493%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.1126, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 372/1573 (23.6491%)
___Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   2, Avg loss: 0.0344, Accuracy: 615/1573 (39.0973%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.4202, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   1, Avg loss: 0.0568, Accuracy: 350/803 (43.5866%)
___Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 388/803 (48.3188%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.2423, Accuracy: 50/10000 (0.5000%)
time spent on training: 233.860191822052
[foolsgold agg] training data poison_ratio: 0.0  data num: [186, 373, 1089, 1036, 1427, 1953, 682, 946, 1573, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 86: Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Avg loss: 5.5321, Accuracy: 0/9950 (0.0000%)
saving model
Done in 298.26493430137634 sec.
Server Epoch:87 choose agents : [84, 28, 53, 68, 85, 44, 25, 46, 32, 56].
___Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 321/1190 (26.9748%)
___Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 459/1190 (38.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.9709, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 395/1581 (24.9842%)
___Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 608/1581 (38.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.5872, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   1, Avg loss: 0.0485, Accuracy: 309/813 (38.0074%)
___Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 477/813 (58.6716%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.4891, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0602, Accuracy: 386/1163 (33.1900%)
___Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 466/1163 (40.0688%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.2297, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 451/1988 (22.6861%)
___Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 664/1988 (33.4004%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.0757, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 392/1750 (22.4000%)
___Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   2, Avg loss: 0.0345, Accuracy: 698/1750 (39.8857%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.3112, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   1, Avg loss: 0.0579, Accuracy: 309/690 (44.7826%)
___Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   2, Avg loss: 0.0274, Accuracy: 461/690 (66.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.2854, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   1, Avg loss: 0.0550, Accuracy: 424/1904 (22.2689%)
___Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 661/1904 (34.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.5861, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   1, Avg loss: 0.0586, Accuracy: 207/735 (28.1633%)
___Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 359/735 (48.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.5840, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 71/186 (38.1720%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
time spent on training: 264.34814453125
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 1581, 813, 1163, 1988, 1750, 690, 1904, 735, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.3096, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Avg loss: 5.5294, Accuracy: 0/9950 (0.0000%)
saving model
Done in 330.9518473148346 sec.
Server Epoch:88 choose agents : [61, 81, 83, 18, 62, 66, 28, 36, 85, 78].
___Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1246, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1170, Accuracy: 7/85 (8.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.3036, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0671, Accuracy: 243/774 (31.3953%)
___Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0356, Accuracy: 302/774 (39.0181%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 6.1982, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 458/1953 (23.4511%)
___Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 751/1953 (38.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.9251, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0750, Accuracy: 124/530 (23.3962%)
___Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0380, Accuracy: 265/530 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 6.1765, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0680, Accuracy: 152/568 (26.7606%)
___Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0401, Accuracy: 267/568 (47.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.8237, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   1, Avg loss: 0.0615, Accuracy: 248/1402 (17.6890%)
___Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   2, Avg loss: 0.0383, Accuracy: 431/1402 (30.7418%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.2894, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0551, Accuracy: 412/1581 (26.0595%)
___Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 613/1581 (38.7729%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.6289, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   1, Avg loss: 0.0866, Accuracy: 78/408 (19.1176%)
___Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   2, Avg loss: 0.0529, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.5145, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   1, Avg loss: 0.0543, Accuracy: 435/1988 (21.8813%)
___Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   2, Avg loss: 0.0349, Accuracy: 683/1988 (34.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.8232, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   1, Avg loss: 0.0828, Accuracy: 44/416 (10.5769%)
___Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   2, Avg loss: 0.0469, Accuracy: 187/416 (44.9519%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.6050, Accuracy: 50/10000 (0.5000%)
time spent on training: 220.0806930065155
[foolsgold agg] training data poison_ratio: 0.0  data num: [85, 774, 1953, 530, 568, 1402, 1581, 408, 1988, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.3095, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Avg loss: 5.5294, Accuracy: 0/9950 (0.0000%)
saving model
Done in 285.20743894577026 sec.
Server Epoch:89 choose agents : [42, 47, 26, 4, 44, 66, 94, 22, 38, 15].
___Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0528, Accuracy: 356/1372 (25.9475%)
___Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 501/1372 (36.5160%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.4806, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   1, Avg loss: 0.1190, Accuracy: 2/134 (1.4925%)
___Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   2, Avg loss: 0.1107, Accuracy: 21/134 (15.6716%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.3093, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   1, Avg loss: 0.0544, Accuracy: 360/1446 (24.8963%)
___Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 502/1446 (34.7165%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.2862, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   1, Avg loss: 0.0609, Accuracy: 337/901 (37.4029%)
___Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   2, Avg loss: 0.0325, Accuracy: 409/901 (45.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 6.9380, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 413/1750 (23.6000%)
___Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 690/1750 (39.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.2951, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0616, Accuracy: 256/1402 (18.2596%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0381, Accuracy: 436/1402 (31.0984%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.0571, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   1, Avg loss: 0.0547, Accuracy: 341/1662 (20.5174%)
___Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 618/1662 (37.1841%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.6792, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 526/1470 (35.7823%)
___Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 841/1470 (57.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.1294, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   1, Avg loss: 0.0609, Accuracy: 267/1131 (23.6074%)
___Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 496/1131 (43.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.2543, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   1, Avg loss: 0.0548, Accuracy: 332/1154 (28.7695%)
___Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   2, Avg loss: 0.0281, Accuracy: 449/1154 (38.9081%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.5565, Accuracy: 52/10000 (0.5200%)
time spent on training: 274.45335626602173
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 134, 1446, 901, 1750, 1402, 1662, 1470, 1131, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.3094, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Avg loss: 5.5297, Accuracy: 0/9950 (0.0000%)
saving model
Done in 342.04775619506836 sec.
Server Epoch:90 choose agents : [24, 40, 38, 39, 33, 75, 28, 70, 7, 52].
___Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.0762, Accuracy: 41/312 (13.1410%)
___Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 162/312 (51.9231%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.3950, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0554, Accuracy: 373/1573 (23.7127%)
___Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 588/1573 (37.3808%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.5688, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   1, Avg loss: 0.0610, Accuracy: 253/1131 (22.3696%)
___Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   2, Avg loss: 0.0301, Accuracy: 491/1131 (43.4129%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.3033, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0536, Accuracy: 318/1013 (31.3919%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 500/1013 (49.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.5973, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   1, Avg loss: 0.0777, Accuracy: 73/515 (14.1748%)
___Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   2, Avg loss: 0.0530, Accuracy: 126/515 (24.4660%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.7439, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   1, Avg loss: 0.0639, Accuracy: 257/776 (33.1186%)
___Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   2, Avg loss: 0.0280, Accuracy: 415/776 (53.4794%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 6.8451, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 397/1581 (25.1107%)
___Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 599/1581 (37.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.6287, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0549, Accuracy: 354/1418 (24.9647%)
___Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 649/1418 (45.7687%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.5264, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   1, Avg loss: 0.0535, Accuracy: 350/891 (39.2817%)
___Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   2, Avg loss: 0.0248, Accuracy: 461/891 (51.7396%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.2232, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   1, Avg loss: 0.0557, Accuracy: 290/636 (45.5975%)
___Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   2, Avg loss: 0.0301, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 6.2184, Accuracy: 50/10000 (0.5000%)
time spent on training: 228.82952547073364
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 1573, 1131, 1013, 515, 776, 1581, 1418, 891, 636]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.3093, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Avg loss: 5.5297, Accuracy: 0/9950 (0.0000%)
saving model
Done in 293.07308864593506 sec.
Server Epoch:91 choose agents : [35, 33, 70, 10, 71, 89, 62, 2, 49, 23].
___Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   1, Avg loss: 0.0849, Accuracy: 40/271 (14.7601%)
___Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   2, Avg loss: 0.0554, Accuracy: 118/271 (43.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.3765, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0776, Accuracy: 76/515 (14.7573%)
___Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0509, Accuracy: 125/515 (24.2718%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.9263, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   1, Avg loss: 0.0544, Accuracy: 378/1418 (26.6573%)
___Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 655/1418 (46.1918%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.5182, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   1, Avg loss: 0.0564, Accuracy: 217/861 (25.2033%)
___Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   2, Avg loss: 0.0208, Accuracy: 464/861 (53.8908%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.2117, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0643, Accuracy: 153/818 (18.7042%)
___Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 309/818 (37.7751%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.0433, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 335/896 (37.3884%)
___Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 421/896 (46.9866%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.5014, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   1, Avg loss: 0.0681, Accuracy: 153/568 (26.9366%)
___Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   2, Avg loss: 0.0394, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.8023, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 233/605 (38.5124%)
___Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   2, Avg loss: 0.0394, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.8784, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   1, Avg loss: 0.0790, Accuracy: 28/440 (6.3636%)
___Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   2, Avg loss: 0.0468, Accuracy: 151/440 (34.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.5100, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   1, Avg loss: 0.0628, Accuracy: 326/715 (45.5944%)
___Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   2, Avg loss: 0.0373, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.7890, Accuracy: 50/10000 (0.5000%)
time spent on training: 190.0273687839508
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 515, 1418, 861, 818, 896, 568, 605, 440, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.3093, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Avg loss: 5.5298, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.90089917182922 sec.
Server Epoch:92 choose agents : [90, 88, 75, 0, 57, 41, 93, 13, 28, 29].
___Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   1, Avg loss: 0.0565, Accuracy: 322/677 (47.5628%)
___Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   2, Avg loss: 0.0223, Accuracy: 465/677 (68.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.3860, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   1, Avg loss: 0.0745, Accuracy: 147/603 (24.3781%)
___Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 5.8124, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0620, Accuracy: 264/776 (34.0206%)
___Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0289, Accuracy: 413/776 (53.2216%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.0546, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 328/1657 (19.7948%)
___Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 516/1657 (31.1406%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.0104, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   1, Avg loss: 0.0564, Accuracy: 306/1154 (26.5165%)
___Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   2, Avg loss: 0.0249, Accuracy: 517/1154 (44.8007%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.6293, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   1, Avg loss: 0.0604, Accuracy: 332/719 (46.1752%)
___Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   2, Avg loss: 0.0313, Accuracy: 451/719 (62.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 6.2649, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 433/1742 (24.8565%)
___Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 682/1742 (39.1504%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.6702, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0563, Accuracy: 328/1645 (19.9392%)
___Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 620/1645 (37.6900%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.0143, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 387/1581 (24.4782%)
___Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   2, Avg loss: 0.0330, Accuracy: 611/1581 (38.6464%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.7581, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 436/1440 (30.2778%)
___Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0273, Accuracy: 696/1440 (48.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.1834, Accuracy: 62/10000 (0.6200%)
time spent on training: 296.5325448513031
[foolsgold agg] training data poison_ratio: 0.0  data num: [677, 603, 776, 1657, 1154, 719, 1742, 1645, 1581, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 92: Avg loss: 5.3092, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Avg loss: 5.5299, Accuracy: 0/9950 (0.0000%)
saving model
Done in 362.23108553886414 sec.
Server Epoch:93 choose agents : [74, 6, 34, 1, 92, 14, 45, 66, 54, 72].
___Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 475/1552 (30.6057%)
___Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 769/1552 (49.5490%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.3687, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   1, Avg loss: 0.0543, Accuracy: 420/1956 (21.4724%)
___Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   2, Avg loss: 0.0313, Accuracy: 668/1956 (34.1513%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.1173, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   1, Avg loss: 0.0572, Accuracy: 391/1427 (27.4001%)
___Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 605/1427 (42.3966%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 6.9052, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0556, Accuracy: 298/928 (32.1121%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0231, Accuracy: 589/928 (63.4698%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.7270, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   1, Avg loss: 0.0513, Accuracy: 469/1715 (27.3469%)
___Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 746/1715 (43.4985%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.6505, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   1, Avg loss: 0.0610, Accuracy: 228/1013 (22.5074%)
___Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   2, Avg loss: 0.0349, Accuracy: 358/1013 (35.3406%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 6.6922, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0680, Accuracy: 207/669 (30.9417%)
___Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0401, Accuracy: 355/669 (53.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.8052, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   1, Avg loss: 0.0614, Accuracy: 260/1402 (18.5449%)
___Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 412/1402 (29.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.1450, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 344/1130 (30.4425%)
___Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 459/1130 (40.6195%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.6947, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   1, Avg loss: 0.0610, Accuracy: 271/1241 (21.8372%)
___Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 430/1241 (34.6495%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.2588, Accuracy: 57/10000 (0.5700%)
time spent on training: 307.4154140949249
[foolsgold agg] training data poison_ratio: 0.0  data num: [1552, 1956, 1427, 928, 1715, 1013, 669, 1402, 1130, 1241]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.3091, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Avg loss: 5.5303, Accuracy: 0/9950 (0.0000%)
saving model
Done in 373.1544988155365 sec.
Server Epoch:94 choose agents : [53, 22, 94, 97, 27, 51, 47, 23, 4, 2].
___Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   1, Avg loss: 0.0483, Accuracy: 296/813 (36.4084%)
___Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 460/813 (56.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.6559, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 534/1470 (36.3265%)
___Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 866/1470 (58.9116%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.0009, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   1, Avg loss: 0.0544, Accuracy: 358/1662 (21.5403%)
___Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   2, Avg loss: 0.0325, Accuracy: 618/1662 (37.1841%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.8764, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 360/1213 (29.6785%)
___Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 488/1213 (40.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.5147, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   1, Avg loss: 0.0541, Accuracy: 438/1587 (27.5992%)
___Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 590/1587 (37.1771%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.3519, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0594, Accuracy: 246/1049 (23.4509%)
___Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0295, Accuracy: 536/1049 (51.0963%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.6246, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   1, Avg loss: 0.1241, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   2, Avg loss: 0.1075, Accuracy: 14/134 (10.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.3094, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0614, Accuracy: 319/715 (44.6154%)
___Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0385, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.6748, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0615, Accuracy: 341/901 (37.8468%)
___Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0336, Accuracy: 395/901 (43.8402%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 6.9314, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0642, Accuracy: 224/605 (37.0248%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0392, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.8286, Accuracy: 64/10000 (0.6400%)
time spent on training: 276.0786085128784
[foolsgold agg] training data poison_ratio: 0.0  data num: [813, 1470, 1662, 1213, 1587, 1049, 134, 715, 901, 605]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.70210227 1.         1.         0.70210227]
___Test Target_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.3091, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Avg loss: 5.5309, Accuracy: 0/9950 (0.0000%)
saving model
Done in 343.4595715999603 sec.
Server Epoch:95 choose agents : [78, 3, 0, 9, 40, 1, 57, 10, 28, 76].
___Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   1, Avg loss: 0.0823, Accuracy: 41/416 (9.8558%)
___Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   2, Avg loss: 0.0445, Accuracy: 183/416 (43.9904%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.5992, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0719, Accuracy: 118/781 (15.1088%)
___Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0344, Accuracy: 232/781 (29.7055%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.0097, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 347/1657 (20.9415%)
___Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 535/1657 (32.2873%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.4871, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   1, Avg loss: 0.0487, Accuracy: 375/1275 (29.4118%)
___Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   2, Avg loss: 0.0190, Accuracy: 729/1275 (57.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.7940, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   1, Avg loss: 0.0551, Accuracy: 382/1573 (24.2848%)
___Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   2, Avg loss: 0.0340, Accuracy: 590/1573 (37.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.2564, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0557, Accuracy: 305/928 (32.8664%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 580/928 (62.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.6652, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0532, Accuracy: 309/1154 (26.7764%)
___Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0261, Accuracy: 523/1154 (45.3206%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.6599, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0564, Accuracy: 215/861 (24.9710%)
___Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0208, Accuracy: 463/861 (53.7747%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.1829, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0553, Accuracy: 406/1581 (25.6799%)
___Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0329, Accuracy: 610/1581 (38.5832%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.7176, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   1, Avg loss: 0.0842, Accuracy: 56/466 (12.0172%)
___Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   2, Avg loss: 0.0484, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.7148, Accuracy: 50/10000 (0.5000%)
time spent on training: 275.09432649612427
[foolsgold agg] training data poison_ratio: 0.0  data num: [416, 781, 1657, 1275, 1573, 928, 1154, 861, 1581, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.3091, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Avg loss: 5.5319, Accuracy: 0/9950 (0.0000%)
saving model
Done in 339.39418745040894 sec.
Server Epoch:96 choose agents : [76, 8, 1, 29, 41, 17, 60, 2, 14, 5].
___Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   1, Avg loss: 0.0842, Accuracy: 52/466 (11.1588%)
___Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   2, Avg loss: 0.0487, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.6764, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   1, Avg loss: 0.0585, Accuracy: 252/1513 (16.6557%)
___Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 488/1513 (32.2538%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.4823, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0548, Accuracy: 302/928 (32.5431%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 580/928 (62.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.8683, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 469/1440 (32.5694%)
___Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   2, Avg loss: 0.0275, Accuracy: 675/1440 (46.8750%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.1087, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   1, Avg loss: 0.0578, Accuracy: 337/719 (46.8707%)
___Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   2, Avg loss: 0.0309, Accuracy: 469/719 (65.2295%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.8436, Accuracy: 57/10000 (0.5700%)
poison local model 17 index 0 
___Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   1, Avg loss: 0.0508, Accuracy: 413/1574 (26.2389%)
___Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 649/1574 (41.2325%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.2457, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   1, Avg loss: 0.0487, Accuracy: 625/2227 (28.0647%)
___Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   2, Avg loss: 0.0275, Accuracy: 1066/2227 (47.8671%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.3442, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0631, Accuracy: 233/605 (38.5124%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0402, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.8803, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   1, Avg loss: 0.0613, Accuracy: 225/1013 (22.2113%)
___Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 323/1013 (31.8855%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.7661, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   1, Avg loss: 0.0503, Accuracy: 364/1628 (22.3587%)
___Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 790/1628 (48.5258%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.7487, Accuracy: 135/10000 (1.3500%)
time spent on training: 293.8024687767029
[foolsgold agg] training data poison_ratio: 0.12994303640716587  data num: [466, 1513, 928, 1440, 719, 1574, 2227, 605, 1013, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.040607198877239334
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.3090, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Avg loss: 5.5312, Accuracy: 0/9950 (0.0000%)
saving model
Done in 361.3886413574219 sec.
Server Epoch:97 choose agents : [37, 35, 82, 73, 83, 7, 26, 40, 25, 53].
___Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   1, Avg loss: 0.0523, Accuracy: 383/1129 (33.9238%)
___Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 716/1129 (63.4190%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.5836, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0841, Accuracy: 50/271 (18.4502%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0542, Accuracy: 110/271 (40.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.3765, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0757, Accuracy: 71/500 (14.2000%)
___Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 173/500 (34.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.7273, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   1, Avg loss: 0.0645, Accuracy: 184/938 (19.6162%)
___Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   2, Avg loss: 0.0327, Accuracy: 355/938 (37.8465%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.4475, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 444/1953 (22.7343%)
___Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0329, Accuracy: 784/1953 (40.1434%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.8016, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 348/891 (39.0572%)
___Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 451/891 (50.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.3986, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0542, Accuracy: 364/1446 (25.1729%)
___Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 513/1446 (35.4772%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.4087, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 373/1573 (23.7127%)
___Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 583/1573 (37.0629%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.5801, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   1, Avg loss: 0.0551, Accuracy: 316/690 (45.7971%)
___Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   2, Avg loss: 0.0271, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 6.5628, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   1, Avg loss: 0.0488, Accuracy: 289/813 (35.5474%)
___Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 471/813 (57.9336%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.2152, Accuracy: 50/10000 (0.5000%)
time spent on training: 254.91656637191772
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 271, 500, 938, 1953, 891, 1446, 1573, 690, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         0.88242273 1.         1.         0.88242273 1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.3090, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Avg loss: 5.5308, Accuracy: 0/9950 (0.0000%)
saving model
Done in 321.7843449115753 sec.
Server Epoch:98 choose agents : [69, 55, 61, 88, 71, 15, 24, 32, 21, 56].
___Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   1, Avg loss: 0.0559, Accuracy: 295/590 (50.0000%)
___Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   2, Avg loss: 0.0295, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.0836, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   1, Avg loss: 0.0548, Accuracy: 259/1071 (24.1830%)
___Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 508/1071 (47.4323%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.1866, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   2, Avg loss: 0.1170, Accuracy: 7/85 (8.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.3037, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0735, Accuracy: 147/603 (24.3781%)
___Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0447, Accuracy: 288/603 (47.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 6.1869, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   1, Avg loss: 0.0634, Accuracy: 172/818 (21.0269%)
___Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 347/818 (42.4205%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.3366, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   1, Avg loss: 0.0570, Accuracy: 341/1154 (29.5494%)
___Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   2, Avg loss: 0.0301, Accuracy: 363/1154 (31.4558%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.9119, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.0760, Accuracy: 43/312 (13.7821%)
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0404, Accuracy: 157/312 (50.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.4111, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0591, Accuracy: 206/735 (28.0272%)
___Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 347/735 (47.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.2795, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 421/1949 (21.6008%)
___Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 632/1949 (32.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.5583, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 3/186 (1.6129%)
___Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 73/186 (39.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.3109, Accuracy: 50/10000 (0.5000%)
time spent on training: 203.49174308776855
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 1071, 85, 603, 818, 1154, 312, 735, 1949, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.3090, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Avg loss: 5.5286, Accuracy: 0/9950 (0.0000%)
saving model
Done in 267.8433749675751 sec.
Server Epoch:99 choose agents : [23, 48, 34, 65, 24, 80, 37, 61, 91, 77].
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0601, Accuracy: 326/715 (45.5944%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0391, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.8529, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   1, Avg loss: 0.0703, Accuracy: 112/631 (17.7496%)
___Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 230/631 (36.4501%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.9506, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   1, Avg loss: 0.0587, Accuracy: 401/1427 (28.1009%)
___Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 592/1427 (41.4856%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 6.9505, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   1, Avg loss: 0.0547, Accuracy: 383/1475 (25.9661%)
___Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   2, Avg loss: 0.0309, Accuracy: 689/1475 (46.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.0356, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.0756, Accuracy: 41/312 (13.1410%)
___Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0394, Accuracy: 166/312 (53.2051%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.4018, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   1, Avg loss: 0.0688, Accuracy: 149/682 (21.8475%)
___Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 266/682 (39.0029%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 6.6440, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   1, Avg loss: 0.0510, Accuracy: 472/1129 (41.8069%)
___Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   2, Avg loss: 0.0239, Accuracy: 742/1129 (65.7219%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.3097, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1244, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1174, Accuracy: 7/85 (8.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.3038, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   1, Avg loss: 0.0525, Accuracy: 341/1030 (33.1068%)
___Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   2, Avg loss: 0.0245, Accuracy: 628/1030 (60.9709%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.4222, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0541, Accuracy: 317/1340 (23.6567%)
___Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 561/1340 (41.8657%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.9212, Accuracy: 61/10000 (0.6100%)
time spent on training: 248.2792239189148
[foolsgold agg] training data poison_ratio: 0.0  data num: [715, 631, 1427, 1475, 312, 682, 1129, 85, 1030, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.3090, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Avg loss: 5.5279, Accuracy: 0/9950 (0.0000%)
saving model
Done in 314.31757974624634 sec.
Server Epoch:100 choose agents : [46, 64, 84, 23, 38, 4, 0, 52, 86, 57].
___Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   1, Avg loss: 0.0545, Accuracy: 446/1904 (23.4244%)
___Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 700/1904 (36.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.5702, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   1, Avg loss: 0.0636, Accuracy: 197/953 (20.6716%)
___Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 299/953 (31.3746%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.7234, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 325/1190 (27.3109%)
___Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   2, Avg loss: 0.0314, Accuracy: 466/1190 (39.1597%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.1145, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   1, Avg loss: 0.0587, Accuracy: 326/715 (45.5944%)
___Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   2, Avg loss: 0.0402, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.7951, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   1, Avg loss: 0.0606, Accuracy: 265/1131 (23.4306%)
___Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 496/1131 (43.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.2343, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   1, Avg loss: 0.0617, Accuracy: 336/901 (37.2919%)
___Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 402/901 (44.6171%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.0393, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   1, Avg loss: 0.0576, Accuracy: 360/1657 (21.7260%)
___Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 534/1657 (32.2269%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.5483, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0561, Accuracy: 285/636 (44.8113%)
___Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0303, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.3654, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0617, Accuracy: 360/1003 (35.8923%)
___Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0351, Accuracy: 371/1003 (36.9890%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.7265, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0540, Accuracy: 315/1154 (27.2964%)
___Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0255, Accuracy: 496/1154 (42.9809%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.2646, Accuracy: 70/10000 (0.7000%)
time spent on training: 285.4488453865051
[foolsgold agg] training data poison_ratio: 0.0  data num: [1904, 953, 1190, 715, 1131, 901, 1657, 636, 1003, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.3090, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Avg loss: 5.5276, Accuracy: 0/9950 (0.0000%)
saving model
Done in 349.9970529079437 sec.
Saving all the graphs.
This run has a label: Jun.16_21.14.57. Visdom environment: tiny
