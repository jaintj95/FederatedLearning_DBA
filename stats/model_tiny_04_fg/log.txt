current path: saved_models/model_tiny_Jun.16_12.15.01
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [85, 87, 65, 98, 55, 56, 28, 94, 16, 80].
___Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0545, Accuracy: 438/1988 (22.0322%)
___Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 671/1988 (33.7525%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 8.3447, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   1, local model 87, internal_epoch   1, Avg loss: 0.0583, Accuracy: 292/1131 (25.8179%)
___Train Local_ResNet_18, epoch   1, local model 87, internal_epoch   2, Avg loss: 0.0321, Accuracy: 394/1131 (34.8364%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.7187, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 391/1475 (26.5085%)
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0329, Accuracy: 633/1475 (42.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.7744, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   1, Avg loss: 0.0832, Accuracy: 7/373 (1.8767%)
___Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   2, Avg loss: 0.0491, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.4319, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0572, Accuracy: 246/1071 (22.9692%)
___Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 500/1071 (46.6853%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.7626, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 59/186 (31.7204%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3122, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   1, Avg loss: 0.0569, Accuracy: 355/1581 (22.4541%)
___Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 623/1581 (39.4054%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 8.0964, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   1, Avg loss: 0.0560, Accuracy: 328/1662 (19.7353%)
___Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   2, Avg loss: 0.0340, Accuracy: 575/1662 (34.5969%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.7548, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   1, Avg loss: 0.0646, Accuracy: 267/708 (37.7119%)
___Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   2, Avg loss: 0.0352, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.7448, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   1, local model 80, internal_epoch   1, Avg loss: 0.0708, Accuracy: 138/682 (20.2346%)
___Train Local_ResNet_18, epoch   1, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 242/682 (35.4839%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.2480, Accuracy: 50/10000 (0.5000%)
time spent on training: 117.42887711524963
[foolsgold agg] training data poison_ratio: 0.0  data num: [1988, 1131, 1475, 373, 1071, 186, 1581, 1662, 708, 682]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3170, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 1: Avg loss: 5.6220, Accuracy: 0/9950 (0.0000%)
saving model
Done in 205.83996152877808 sec.
Server Epoch:2 choose agents : [65, 48, 44, 24, 25, 20, 86, 29, 7, 95].
___Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   1, Avg loss: 0.0557, Accuracy: 390/1475 (26.4407%)
___Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 649/1475 (44.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.7483, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   1, Avg loss: 0.0716, Accuracy: 84/631 (13.3122%)
___Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 209/631 (33.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.7889, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 392/1750 (22.4000%)
___Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 656/1750 (37.4857%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.6674, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0777, Accuracy: 19/312 (6.0897%)
___Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0417, Accuracy: 162/312 (51.9231%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3834, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0577, Accuracy: 304/690 (44.0580%)
___Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 457/690 (66.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.1868, Accuracy: 54/10000 (0.5400%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 343/807 (42.5031%)
___Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 419/807 (51.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.9164, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 86, internal_epoch   1, Avg loss: 0.0646, Accuracy: 350/1003 (34.8953%)
___Train Local_ResNet_18, epoch   2, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 377/1003 (37.5872%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.8787, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 405/1440 (28.1250%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 659/1440 (45.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.9527, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 346/891 (38.8328%)
___Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 441/891 (49.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.1594, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 325/599 (54.2571%)
___Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   2, Avg loss: 0.0299, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.6041, Accuracy: 50/10000 (0.5000%)
time spent on training: 128.2136514186859
[foolsgold agg] training data poison_ratio: 0.14648885184413418  data num: [1475, 631, 1750, 312, 690, 807, 1003, 1440, 891, 599]
[foolsgold agg] considering poison per batch poison_fraction: 0.04577776620129193
[foolsgold agg] wv: [1.        0.4014119 1.        1.        1.        0.        1.
 1.        1.        1.       ]
___Test Target_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3168, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 2: Avg loss: 5.6198, Accuracy: 0/9950 (0.0000%)
saving model
Done in 217.33780694007874 sec.
Server Epoch:3 choose agents : [77, 59, 8, 86, 97, 14, 4, 70, 96, 11].
___Train Local_ResNet_18, epoch   3, local model 77, internal_epoch   1, Avg loss: 0.0542, Accuracy: 322/1340 (24.0299%)
___Train Local_ResNet_18, epoch   3, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 595/1340 (44.4030%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.5056, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   1, Avg loss: 0.0534, Accuracy: 309/1089 (28.3747%)
___Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 458/1089 (42.0569%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.2678, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0605, Accuracy: 230/1513 (15.2016%)
___Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 502/1513 (33.1791%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.3872, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch   3, local model 86, internal_epoch   1, Avg loss: 0.0640, Accuracy: 356/1003 (35.4935%)
___Train Local_ResNet_18, epoch   3, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 389/1003 (38.7836%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.4513, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 97, internal_epoch   1, Avg loss: 0.0523, Accuracy: 344/1213 (28.3594%)
___Train Local_ResNet_18, epoch   3, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 515/1213 (42.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.7184, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 212/1013 (20.9279%)
___Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 332/1013 (32.7739%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.5167, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0621, Accuracy: 323/901 (35.8491%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0334, Accuracy: 411/901 (45.6160%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.8151, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0559, Accuracy: 319/1418 (22.4965%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 634/1418 (44.7109%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.6934, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   3, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 49/311 (15.7556%)
___Train Local_ResNet_18, epoch   3, local model 96, internal_epoch   2, Avg loss: 0.0542, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3432, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   1, Avg loss: 0.0547, Accuracy: 343/712 (48.1742%)
___Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 431/712 (60.5337%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.5148, Accuracy: 49/10000 (0.4900%)
time spent on training: 112.94490385055542
[foolsgold agg] training data poison_ratio: 0.0  data num: [1340, 1089, 1513, 1003, 1213, 1013, 901, 1418, 311, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3167, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 3: Avg loss: 5.6209, Accuracy: 0/9950 (0.0000%)
saving model
Done in 201.35369610786438 sec.
Server Epoch:4 choose agents : [21, 65, 32, 77, 7, 24, 41, 52, 13, 64].
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 393/1949 (20.1642%)
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 636/1949 (32.6321%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.0418, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   1, Avg loss: 0.0584, Accuracy: 407/1475 (27.5932%)
___Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   2, Avg loss: 0.0318, Accuracy: 618/1475 (41.8983%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.0269, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   1, Avg loss: 0.0608, Accuracy: 193/735 (26.2585%)
___Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 330/735 (44.8980%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.9619, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 307/1340 (22.9104%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0280, Accuracy: 540/1340 (40.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.7829, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 358/891 (40.1796%)
___Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 456/891 (51.1785%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.1171, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0771, Accuracy: 26/312 (8.3333%)
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0407, Accuracy: 167/312 (53.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3807, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   1, Avg loss: 0.0629, Accuracy: 321/719 (44.6453%)
___Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   2, Avg loss: 0.0301, Accuracy: 450/719 (62.5869%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.1401, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   1, Avg loss: 0.0579, Accuracy: 273/636 (42.9245%)
___Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   2, Avg loss: 0.0310, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.0582, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 331/1645 (20.1216%)
___Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 626/1645 (38.0547%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.8164, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 170/953 (17.8384%)
___Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 318/953 (33.3683%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.8596, Accuracy: 50/10000 (0.5000%)
time spent on training: 104.3349096775055
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 1475, 735, 1340, 891, 312, 719, 636, 1645, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3165, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 4: Avg loss: 5.6135, Accuracy: 0/9950 (0.0000%)
saving model
Done in 195.87402319908142 sec.
Server Epoch:5 choose agents : [62, 99, 55, 2, 52, 21, 47, 94, 92, 84].
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 140/568 (24.6479%)
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.7371, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   1, Avg loss: 0.0694, Accuracy: 170/773 (21.9922%)
___Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   2, Avg loss: 0.0307, Accuracy: 398/773 (51.4877%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.5824, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   1, Avg loss: 0.0571, Accuracy: 222/1071 (20.7283%)
___Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 471/1071 (43.9776%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.3872, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 230/605 (38.0165%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.7994, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 270/636 (42.4528%)
___Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   2, Avg loss: 0.0314, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.3622, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 420/1949 (21.5495%)
___Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 658/1949 (33.7609%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.5503, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   1, Avg loss: 0.1237, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   2, Avg loss: 0.1088, Accuracy: 20/134 (14.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 339/1662 (20.3971%)
___Train Local_ResNet_18, epoch   5, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 592/1662 (35.6197%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.5495, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0522, Accuracy: 471/1715 (27.4636%)
___Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 689/1715 (40.1749%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.5752, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   5, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 319/1190 (26.8067%)
___Train Local_ResNet_18, epoch   5, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 447/1190 (37.5630%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.8217, Accuracy: 66/10000 (0.6600%)
time spent on training: 106.53471827507019
[foolsgold agg] training data poison_ratio: 0.0  data num: [568, 773, 1071, 605, 636, 1949, 134, 1662, 1715, 1190]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.72083078 1.         1.
 0.72083078 1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3164, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 5: Avg loss: 5.6128, Accuracy: 0/9950 (0.0000%)
saving model
Done in 195.3872127532959 sec.
Server Epoch:6 choose agents : [42, 86, 96, 97, 56, 87, 53, 33, 44, 98].
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 354/1372 (25.8017%)
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0319, Accuracy: 462/1372 (33.6735%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.0219, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   1, Avg loss: 0.0626, Accuracy: 355/1003 (35.3938%)
___Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   2, Avg loss: 0.0347, Accuracy: 366/1003 (36.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.5415, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 41/311 (13.1833%)
___Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3436, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 97, internal_epoch   1, Avg loss: 0.0534, Accuracy: 357/1213 (29.4312%)
___Train Local_ResNet_18, epoch   6, local model 97, internal_epoch   2, Avg loss: 0.0279, Accuracy: 448/1213 (36.9332%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.2813, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 60/186 (32.2581%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3120, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 87, internal_epoch   1, Avg loss: 0.0584, Accuracy: 285/1131 (25.1989%)
___Train Local_ResNet_18, epoch   6, local model 87, internal_epoch   2, Avg loss: 0.0321, Accuracy: 389/1131 (34.3943%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.4257, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 284/813 (34.9323%)
___Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 436/813 (53.6285%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 9.1066, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   1, Avg loss: 0.0783, Accuracy: 64/515 (12.4272%)
___Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   2, Avg loss: 0.0516, Accuracy: 142/515 (27.5728%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.7361, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0593, Accuracy: 407/1750 (23.2571%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 658/1750 (37.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.4981, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch   6, local model 98, internal_epoch   1, Avg loss: 0.0827, Accuracy: 13/373 (3.4853%)
___Train Local_ResNet_18, epoch   6, local model 98, internal_epoch   2, Avg loss: 0.0486, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.4181, Accuracy: 50/10000 (0.5000%)
time spent on training: 99.18670511245728
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 1003, 311, 1213, 186, 1131, 813, 515, 1750, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3164, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 6: Avg loss: 5.6136, Accuracy: 0/9950 (0.0000%)
saving model
Done in 189.05008745193481 sec.
Server Epoch:7 choose agents : [55, 61, 33, 24, 70, 53, 81, 85, 10, 92].
___Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 259/1071 (24.1830%)
___Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 482/1071 (45.0047%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.8603, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   1, Avg loss: 0.1279, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   2, Avg loss: 0.1187, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3050, Accuracy: 39/10000 (0.3900%)
___Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   1, Avg loss: 0.0773, Accuracy: 63/515 (12.2330%)
___Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   2, Avg loss: 0.0509, Accuracy: 119/515 (23.1068%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.7525, Accuracy: 43/10000 (0.4300%)
___Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   1, Avg loss: 0.0768, Accuracy: 31/312 (9.9359%)
___Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   2, Avg loss: 0.0415, Accuracy: 162/312 (51.9231%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3889, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   1, Avg loss: 0.0567, Accuracy: 345/1418 (24.3300%)
___Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 596/1418 (42.0310%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.7769, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   1, Avg loss: 0.0500, Accuracy: 269/813 (33.0873%)
___Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   2, Avg loss: 0.0193, Accuracy: 419/813 (51.5375%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.9213, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   7, local model 81, internal_epoch   1, Avg loss: 0.0690, Accuracy: 231/774 (29.8450%)
___Train Local_ResNet_18, epoch   7, local model 81, internal_epoch   2, Avg loss: 0.0380, Accuracy: 285/774 (36.8217%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.1468, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 414/1988 (20.8249%)
___Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 679/1988 (34.1549%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.9342, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0574, Accuracy: 196/861 (22.7642%)
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0223, Accuracy: 449/861 (52.1487%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.8023, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 481/1715 (28.0466%)
___Train Local_ResNet_18, epoch   7, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 684/1715 (39.8834%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.6894, Accuracy: 85/10000 (0.8500%)
time spent on training: 111.90074253082275
[foolsgold agg] training data poison_ratio: 0.0  data num: [1071, 85, 515, 312, 1418, 813, 774, 1988, 861, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3164, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 7: Avg loss: 5.6141, Accuracy: 0/9950 (0.0000%)
saving model
Done in 198.4235532283783 sec.
Server Epoch:8 choose agents : [65, 24, 13, 1, 59, 29, 46, 17, 12, 63].
___Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   1, Avg loss: 0.0547, Accuracy: 401/1475 (27.1864%)
___Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   2, Avg loss: 0.0316, Accuracy: 687/1475 (46.5763%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.0551, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   1, Avg loss: 0.0769, Accuracy: 36/312 (11.5385%)
___Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 168/312 (53.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.3870, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 306/1645 (18.6018%)
___Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 627/1645 (38.1155%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.6518, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 280/928 (30.1724%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 578/928 (62.2845%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.6407, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 301/1089 (27.6400%)
___Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   2, Avg loss: 0.0288, Accuracy: 449/1089 (41.2305%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.5624, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 406/1440 (28.1944%)
___Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   2, Avg loss: 0.0283, Accuracy: 652/1440 (45.2778%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.8453, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 437/1904 (22.9517%)
___Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 657/1904 (34.5063%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.4921, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   1, Avg loss: 0.0511, Accuracy: 421/1574 (26.7471%)
___Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 677/1574 (43.0114%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.0329, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0875, Accuracy: 17/338 (5.0296%)
___Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0491, Accuracy: 149/338 (44.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.4482, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 252/888 (28.3784%)
___Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 421/888 (47.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.4072, Accuracy: 50/10000 (0.5000%)
time spent on training: 117.22263288497925
[foolsgold agg] training data poison_ratio: 0.0  data num: [1475, 312, 1645, 928, 1089, 1440, 1904, 1574, 338, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.3162, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 8: Avg loss: 5.6120, Accuracy: 0/9950 (0.0000%)
saving model
Done in 203.15187525749207 sec.
Server Epoch:9 choose agents : [38, 86, 61, 13, 89, 20, 52, 78, 37, 94].
___Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   1, Avg loss: 0.0623, Accuracy: 245/1131 (21.6622%)
___Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 473/1131 (41.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.2651, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   9, local model 86, internal_epoch   1, Avg loss: 0.0645, Accuracy: 357/1003 (35.5932%)
___Train Local_ResNet_18, epoch   9, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 371/1003 (36.9890%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.9619, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1247, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1169, Accuracy: 9/85 (10.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3044, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 313/1645 (19.0274%)
___Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 616/1645 (37.4468%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.8683, Accuracy: 135/10000 (1.3500%)
___Train Local_ResNet_18, epoch   9, local model 89, internal_epoch   1, Avg loss: 0.0618, Accuracy: 322/896 (35.9375%)
___Train Local_ResNet_18, epoch   9, local model 89, internal_epoch   2, Avg loss: 0.0328, Accuracy: 442/896 (49.3304%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.1993, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch   9, local model 20, internal_epoch   1, Avg loss: 0.0562, Accuracy: 342/807 (42.3792%)
___Train Local_ResNet_18, epoch   9, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 428/807 (53.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.0173, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   1, Avg loss: 0.0561, Accuracy: 281/636 (44.1824%)
___Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   2, Avg loss: 0.0316, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.3765, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 78, internal_epoch   1, Avg loss: 0.0843, Accuracy: 32/416 (7.6923%)
___Train Local_ResNet_18, epoch   9, local model 78, internal_epoch   2, Avg loss: 0.0471, Accuracy: 167/416 (40.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.5604, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0530, Accuracy: 381/1129 (33.7467%)
___Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 740/1129 (65.5447%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.4592, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch   9, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 334/1662 (20.0963%)
___Train Local_ResNet_18, epoch   9, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 615/1662 (37.0036%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.7634, Accuracy: 85/10000 (0.8500%)
time spent on training: 128.95537567138672
[foolsgold agg] training data poison_ratio: 0.08575982996811903  data num: [1131, 1003, 85, 1645, 896, 807, 636, 416, 1129, 1662]
[foolsgold agg] considering poison per batch poison_fraction: 0.026799946865037196
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3161, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 9: Avg loss: 5.6120, Accuracy: 0/9950 (0.0000%)
saving model
Done in 214.48289322853088 sec.
Server Epoch:10 choose agents : [72, 15, 56, 44, 90, 31, 57, 99, 20, 6].
___Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   1, Avg loss: 0.0625, Accuracy: 237/1241 (19.0975%)
___Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 421/1241 (33.9243%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.1292, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   1, Avg loss: 0.0555, Accuracy: 318/1154 (27.5563%)
___Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 510/1154 (44.1941%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.6622, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 64/186 (34.4086%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3120, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 389/1750 (22.2286%)
___Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 662/1750 (37.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.5865, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  10, local model 90, internal_epoch   1, Avg loss: 0.0583, Accuracy: 309/677 (45.6425%)
___Train Local_ResNet_18, epoch  10, local model 90, internal_epoch   2, Avg loss: 0.0245, Accuracy: 417/677 (61.5953%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.0269, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   1, Avg loss: 0.0821, Accuracy: 54/460 (11.7391%)
___Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   2, Avg loss: 0.0383, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.7018, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   1, Avg loss: 0.0562, Accuracy: 293/1154 (25.3899%)
___Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   2, Avg loss: 0.0248, Accuracy: 492/1154 (42.6343%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.0757, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   1, Avg loss: 0.0676, Accuracy: 182/773 (23.5446%)
___Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   2, Avg loss: 0.0296, Accuracy: 399/773 (51.6171%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.2231, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  10, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 347/807 (42.9988%)
___Train Local_ResNet_18, epoch  10, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 405/807 (50.1859%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.9412, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0558, Accuracy: 375/1956 (19.1718%)
___Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 657/1956 (33.5890%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.5279, Accuracy: 117/10000 (1.1700%)
time spent on training: 125.22848653793335
[foolsgold agg] training data poison_ratio: 0.07944477259303012  data num: [1241, 1154, 186, 1750, 677, 460, 1154, 773, 807, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.024826491435321913
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3159, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 10: Avg loss: 5.6117, Accuracy: 0/9950 (0.0000%)
saving model
Done in 214.46241641044617 sec.
Server Epoch:11 choose agents : [25, 80, 30, 6, 94, 12, 89, 11, 27, 14].
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 305/690 (44.2029%)
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 456/690 (66.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.4025, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  11, local model 80, internal_epoch   1, Avg loss: 0.0707, Accuracy: 138/682 (20.2346%)
___Train Local_ResNet_18, epoch  11, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 244/682 (35.7771%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.3884, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   1, Avg loss: 0.0809, Accuracy: 65/486 (13.3745%)
___Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   2, Avg loss: 0.0426, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.7943, Accuracy: 40/10000 (0.4000%)
___Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0557, Accuracy: 404/1956 (20.6544%)
___Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 649/1956 (33.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.2689, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  11, local model 94, internal_epoch   1, Avg loss: 0.0558, Accuracy: 322/1662 (19.3742%)
___Train Local_ResNet_18, epoch  11, local model 94, internal_epoch   2, Avg loss: 0.0340, Accuracy: 586/1662 (35.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.3277, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0875, Accuracy: 20/338 (5.9172%)
___Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0478, Accuracy: 148/338 (43.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.4369, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 329/896 (36.7188%)
___Train Local_ResNet_18, epoch  11, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 472/896 (52.6786%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.1696, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0565, Accuracy: 347/712 (48.7360%)
___Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 405/712 (56.8820%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.5427, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 440/1587 (27.7253%)
___Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 634/1587 (39.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.1740, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 223/1013 (22.0138%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 302/1013 (29.8124%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.0965, Accuracy: 63/10000 (0.6300%)
time spent on training: 117.49135661125183
[foolsgold agg] training data poison_ratio: 0.0  data num: [690, 682, 486, 1956, 1662, 338, 896, 712, 1587, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.3158, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 11: Avg loss: 5.6119, Accuracy: 0/9950 (0.0000%)
saving model
Done in 205.46472668647766 sec.
Server Epoch:12 choose agents : [37, 82, 96, 32, 34, 88, 63, 20, 22, 14].
___Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   1, Avg loss: 0.0519, Accuracy: 426/1129 (37.7325%)
___Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 755/1129 (66.8733%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.9538, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  12, local model 82, internal_epoch   1, Avg loss: 0.0774, Accuracy: 62/500 (12.4000%)
___Train Local_ResNet_18, epoch  12, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 169/500 (33.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.5679, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  12, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 46/311 (14.7910%)
___Train Local_ResNet_18, epoch  12, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3438, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0607, Accuracy: 202/735 (27.4830%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 337/735 (45.8503%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.7352, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0586, Accuracy: 394/1427 (27.6104%)
___Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 601/1427 (42.1163%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.8151, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  12, local model 88, internal_epoch   1, Avg loss: 0.0755, Accuracy: 139/603 (23.0514%)
___Train Local_ResNet_18, epoch  12, local model 88, internal_epoch   2, Avg loss: 0.0453, Accuracy: 282/603 (46.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.9306, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 256/888 (28.8288%)
___Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 444/888 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.9982, Accuracy: 66/10000 (0.6600%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 345/807 (42.7509%)
___Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 440/807 (54.5229%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.0370, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0468, Accuracy: 494/1470 (33.6054%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 833/1470 (56.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.8163, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 224/1013 (22.1125%)
___Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   2, Avg loss: 0.0363, Accuracy: 329/1013 (32.4778%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.4965, Accuracy: 71/10000 (0.7100%)
time spent on training: 118.04935812950134
[foolsgold agg] training data poison_ratio: 0.09084768659236744  data num: [1129, 500, 311, 735, 1427, 603, 888, 807, 1470, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.028389902060114824
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3156, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 12: Avg loss: 5.6081, Accuracy: 0/9950 (0.0000%)
saving model
Done in 210.20372533798218 sec.
Server Epoch:13 choose agents : [36, 77, 71, 15, 56, 7, 17, 51, 47, 24].
___Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   1, Avg loss: 0.0870, Accuracy: 72/408 (17.6471%)
___Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   2, Avg loss: 0.0560, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.4682, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 338/1340 (25.2239%)
___Train Local_ResNet_18, epoch  13, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 560/1340 (41.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.9747, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 161/818 (19.6822%)
___Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 384/818 (46.9438%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.9135, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0559, Accuracy: 322/1154 (27.9029%)
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 484/1154 (41.9411%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.5783, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 62/186 (33.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3119, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 349/891 (39.1695%)
___Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 473/891 (53.0864%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.0161, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 399/1574 (25.3494%)
___Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 653/1574 (41.4867%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.0088, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   1, Avg loss: 0.0611, Accuracy: 223/1049 (21.2583%)
___Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 499/1049 (47.5691%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.4417, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   1, Avg loss: 0.1244, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   2, Avg loss: 0.1092, Accuracy: 9/134 (6.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   1, Avg loss: 0.0764, Accuracy: 32/312 (10.2564%)
___Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   2, Avg loss: 0.0403, Accuracy: 165/312 (52.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3864, Accuracy: 50/10000 (0.5000%)
time spent on training: 105.54827976226807
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 1340, 818, 1154, 186, 891, 1574, 1049, 134, 312]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3155, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 13: Avg loss: 5.6074, Accuracy: 0/9950 (0.0000%)
saving model
Done in 192.40356254577637 sec.
Server Epoch:14 choose agents : [70, 65, 66, 62, 34, 71, 84, 61, 85, 20].
___Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 353/1418 (24.8942%)
___Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0313, Accuracy: 617/1418 (43.5120%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.0739, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0566, Accuracy: 377/1475 (25.5593%)
___Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0308, Accuracy: 688/1475 (46.6441%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.0941, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 256/1402 (18.2596%)
___Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 386/1402 (27.5321%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.2366, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 145/568 (25.5282%)
___Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   2, Avg loss: 0.0410, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.8145, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   1, Avg loss: 0.0586, Accuracy: 357/1427 (25.0175%)
___Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 563/1427 (39.4534%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.8405, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   1, Avg loss: 0.0648, Accuracy: 136/818 (16.6259%)
___Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   2, Avg loss: 0.0311, Accuracy: 315/818 (38.5086%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.1211, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0622, Accuracy: 322/1190 (27.0588%)
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 458/1190 (38.4874%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.1711, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1259, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1172, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.3043, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  14, local model 85, internal_epoch   1, Avg loss: 0.0534, Accuracy: 439/1988 (22.0825%)
___Train Local_ResNet_18, epoch  14, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 668/1988 (33.6016%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.9652, Accuracy: 85/10000 (0.8500%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  14, local model 20, internal_epoch   1, Avg loss: 0.0560, Accuracy: 347/807 (42.9988%)
___Train Local_ResNet_18, epoch  14, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 437/807 (54.1512%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.7875, Accuracy: 50/10000 (0.5000%)
time spent on training: 131.14402675628662
[foolsgold agg] training data poison_ratio: 0.07219538378958669  data num: [1418, 1475, 1402, 568, 1427, 818, 1190, 85, 1988, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.02256105743424584
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.3154, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 14: Avg loss: 5.6071, Accuracy: 0/9950 (0.0000%)
saving model
Done in 219.45239210128784 sec.
Server Epoch:15 choose agents : [70, 63, 85, 80, 26, 42, 18, 66, 39, 97].
___Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 353/1418 (24.8942%)
___Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 651/1418 (45.9097%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.5189, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0542, Accuracy: 256/888 (28.8288%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0264, Accuracy: 422/888 (47.5225%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.4903, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  15, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 444/1988 (22.3340%)
___Train Local_ResNet_18, epoch  15, local model 85, internal_epoch   2, Avg loss: 0.0349, Accuracy: 681/1988 (34.2555%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.1470, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  15, local model 80, internal_epoch   1, Avg loss: 0.0700, Accuracy: 145/682 (21.2610%)
___Train Local_ResNet_18, epoch  15, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 256/682 (37.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.3139, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 340/1446 (23.5131%)
___Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 473/1446 (32.7109%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.3649, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 346/1372 (25.2187%)
___Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 505/1372 (36.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.8342, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0770, Accuracy: 108/530 (20.3774%)
___Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0374, Accuracy: 271/530 (51.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.0669, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 270/1402 (19.2582%)
___Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 424/1402 (30.2425%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.1608, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 309/1013 (30.5035%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 488/1013 (48.1737%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.6792, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  15, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 349/1213 (28.7716%)
___Train Local_ResNet_18, epoch  15, local model 97, internal_epoch   2, Avg loss: 0.0279, Accuracy: 456/1213 (37.5927%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.6695, Accuracy: 89/10000 (0.8900%)
time spent on training: 128.29032182693481
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 888, 1988, 682, 1446, 1372, 530, 1402, 1013, 1213]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.3154, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 15: Avg loss: 5.6076, Accuracy: 0/9950 (0.0000%)
saving model
Done in 215.46787524223328 sec.
Server Epoch:16 choose agents : [24, 22, 71, 66, 81, 6, 64, 98, 59, 33].
___Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   1, Avg loss: 0.0765, Accuracy: 39/312 (12.5000%)
___Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   2, Avg loss: 0.0407, Accuracy: 160/312 (51.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.3812, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 492/1470 (33.4694%)
___Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 843/1470 (57.3469%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.0236, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   1, Avg loss: 0.0645, Accuracy: 160/818 (19.5599%)
___Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   2, Avg loss: 0.0316, Accuracy: 326/818 (39.8533%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.3118, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 265/1402 (18.9016%)
___Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 366/1402 (26.1056%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.5948, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  16, local model 81, internal_epoch   1, Avg loss: 0.0690, Accuracy: 229/774 (29.5866%)
___Train Local_ResNet_18, epoch  16, local model 81, internal_epoch   2, Avg loss: 0.0351, Accuracy: 300/774 (38.7597%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.2231, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 440/1956 (22.4949%)
___Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 628/1956 (32.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1642, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 161/953 (16.8940%)
___Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   2, Avg loss: 0.0384, Accuracy: 306/953 (32.1091%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.4000, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  16, local model 98, internal_epoch   1, Avg loss: 0.0828, Accuracy: 15/373 (4.0214%)
___Train Local_ResNet_18, epoch  16, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.4200, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   1, Avg loss: 0.0522, Accuracy: 303/1089 (27.8237%)
___Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   2, Avg loss: 0.0360, Accuracy: 468/1089 (42.9752%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.8512, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   1, Avg loss: 0.0794, Accuracy: 53/515 (10.2913%)
___Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   2, Avg loss: 0.0495, Accuracy: 121/515 (23.4951%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.7301, Accuracy: 53/10000 (0.5300%)
time spent on training: 122.0367591381073
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 1470, 818, 1402, 774, 1956, 953, 373, 1089, 515]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.3152, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 16: Avg loss: 5.6066, Accuracy: 0/9950 (0.0000%)
saving model
Done in 208.4362347126007 sec.
Server Epoch:17 choose agents : [36, 29, 28, 82, 55, 63, 33, 23, 5, 43].
___Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   1, Avg loss: 0.0877, Accuracy: 74/408 (18.1373%)
___Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   2, Avg loss: 0.0558, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.4839, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 436/1440 (30.2778%)
___Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 656/1440 (45.5556%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.9024, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 407/1581 (25.7432%)
___Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 592/1581 (37.4447%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.9020, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   1, Avg loss: 0.0768, Accuracy: 63/500 (12.6000%)
___Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.5893, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 231/1071 (21.5686%)
___Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 484/1071 (45.1914%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.5677, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 257/888 (28.9414%)
___Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 404/888 (45.4955%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.0405, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0772, Accuracy: 71/515 (13.7864%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0538, Accuracy: 121/515 (23.4951%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.7575, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   1, Avg loss: 0.0622, Accuracy: 318/715 (44.4755%)
___Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   2, Avg loss: 0.0390, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.7072, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0511, Accuracy: 392/1628 (24.0786%)
___Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 811/1628 (49.8157%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.2129, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0632, Accuracy: 299/946 (31.6068%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0368, Accuracy: 328/946 (34.6723%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.0821, Accuracy: 50/10000 (0.5000%)
time spent on training: 124.05820512771606
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 1440, 1581, 500, 1071, 888, 515, 715, 1628, 946]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.3152, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 17: Avg loss: 5.6065, Accuracy: 0/9950 (0.0000%)
saving model
Done in 211.17792224884033 sec.
Server Epoch:18 choose agents : [78, 91, 3, 24, 2, 8, 80, 51, 73, 29].
___Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 42/416 (10.0962%)
___Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0459, Accuracy: 183/416 (43.9904%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.5484, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 91, internal_epoch   1, Avg loss: 0.0524, Accuracy: 318/1030 (30.8738%)
___Train Local_ResNet_18, epoch  18, local model 91, internal_epoch   2, Avg loss: 0.0276, Accuracy: 627/1030 (60.8738%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.9863, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0751, Accuracy: 106/781 (13.5723%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0360, Accuracy: 226/781 (28.9373%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.6408, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0765, Accuracy: 32/312 (10.2564%)
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0413, Accuracy: 166/312 (53.2051%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.3845, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0622, Accuracy: 233/605 (38.5124%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0404, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.8812, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0602, Accuracy: 250/1513 (16.5235%)
___Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 463/1513 (30.6015%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.1872, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  18, local model 80, internal_epoch   1, Avg loss: 0.0700, Accuracy: 145/682 (21.2610%)
___Train Local_ResNet_18, epoch  18, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 247/682 (36.2170%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.3064, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   1, Avg loss: 0.0606, Accuracy: 222/1049 (21.1630%)
___Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   2, Avg loss: 0.0300, Accuracy: 540/1049 (51.4776%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.4135, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   1, Avg loss: 0.0661, Accuracy: 178/938 (18.9765%)
___Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   2, Avg loss: 0.0340, Accuracy: 303/938 (32.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.0995, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 420/1440 (29.1667%)
___Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 642/1440 (44.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.8536, Accuracy: 68/10000 (0.6800%)
time spent on training: 122.53276348114014
[foolsgold agg] training data poison_ratio: 0.0  data num: [416, 1030, 781, 312, 605, 1513, 682, 1049, 938, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.3150, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 18: Avg loss: 5.6048, Accuracy: 0/9950 (0.0000%)
saving model
Done in 209.36075067520142 sec.
Server Epoch:19 choose agents : [7, 88, 36, 17, 91, 94, 21, 60, 11, 15].
___Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 354/891 (39.7306%)
___Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 451/891 (50.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.0971, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 88, internal_epoch   1, Avg loss: 0.0739, Accuracy: 140/603 (23.2172%)
___Train Local_ResNet_18, epoch  19, local model 88, internal_epoch   2, Avg loss: 0.0460, Accuracy: 278/603 (46.1028%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.9238, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   1, Avg loss: 0.0874, Accuracy: 69/408 (16.9118%)
___Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   2, Avg loss: 0.0558, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.4644, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0519, Accuracy: 393/1574 (24.9682%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 653/1574 (41.4867%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.5140, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  19, local model 91, internal_epoch   1, Avg loss: 0.0524, Accuracy: 323/1030 (31.3592%)
___Train Local_ResNet_18, epoch  19, local model 91, internal_epoch   2, Avg loss: 0.0298, Accuracy: 606/1030 (58.8350%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.3115, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  19, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 348/1662 (20.9386%)
___Train Local_ResNet_18, epoch  19, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 602/1662 (36.2214%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.7050, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 406/1949 (20.8312%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0334, Accuracy: 640/1949 (32.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.2593, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 592/2227 (26.5828%)
___Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1040/2227 (46.6996%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.2557, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0584, Accuracy: 346/712 (48.5955%)
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0256, Accuracy: 404/712 (56.7416%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.6293, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   1, Avg loss: 0.0584, Accuracy: 317/1154 (27.4697%)
___Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 381/1154 (33.0156%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.7746, Accuracy: 51/10000 (0.5100%)
time spent on training: 134.50959539413452
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 603, 408, 1574, 1030, 1662, 1949, 2227, 712, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.3149, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 19: Avg loss: 5.6029, Accuracy: 0/9950 (0.0000%)
saving model
Done in 222.08159685134888 sec.
Server Epoch:20 choose agents : [77, 14, 55, 7, 64, 50, 71, 52, 59, 10].
___Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 320/1340 (23.8806%)
___Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 540/1340 (40.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.7193, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 219/1013 (21.6190%)
___Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 345/1013 (34.0573%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.5668, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 242/1071 (22.5957%)
___Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 506/1071 (47.2456%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.8848, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0544, Accuracy: 349/891 (39.1695%)
___Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 456/891 (51.1785%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.0270, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   1, Avg loss: 0.0645, Accuracy: 166/953 (17.4187%)
___Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   2, Avg loss: 0.0383, Accuracy: 280/953 (29.3809%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.4765, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   1, Avg loss: 0.0631, Accuracy: 150/809 (18.5414%)
___Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   2, Avg loss: 0.0276, Accuracy: 340/809 (42.0272%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.0828, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   1, Avg loss: 0.0641, Accuracy: 171/818 (20.9046%)
___Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 346/818 (42.2983%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.0269, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   1, Avg loss: 0.0565, Accuracy: 289/636 (45.4403%)
___Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.3228, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 315/1089 (28.9256%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0287, Accuracy: 462/1089 (42.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.8284, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   1, Avg loss: 0.0577, Accuracy: 207/861 (24.0418%)
___Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 458/861 (53.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.2689, Accuracy: 50/10000 (0.5000%)
time spent on training: 122.95207142829895
[foolsgold agg] training data poison_ratio: 0.0  data num: [1340, 1013, 1071, 891, 953, 809, 818, 636, 1089, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 20: Avg loss: 5.3148, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 20: Avg loss: 5.6010, Accuracy: 0/9950 (0.0000%)
saving model
Done in 213.8844120502472 sec.
Server Epoch:21 choose agents : [0, 17, 26, 47, 78, 74, 75, 96, 65, 22].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0566, Accuracy: 402/1657 (24.2607%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0340, Accuracy: 634/1657 (38.2619%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0282, Accuracy: 789/1657 (47.6162%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0272, Accuracy: 802/1657 (48.4007%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0265, Accuracy: 815/1657 (49.1853%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0262, Accuracy: 825/1657 (49.7888%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0260, Accuracy: 832/1657 (50.2112%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0251, Accuracy: 835/1657 (50.3923%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0249, Accuracy: 876/1657 (52.8666%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0243, Accuracy: 881/1657 (53.1684%), train_poison_data_count: 520
Global model norm: 112.05521012959416.
Norm before scaling: 112.02920151544194. Distance: 1.2394910612411074
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.5132, Accuracy: 64/10000 (0.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: 0.8058, Accuracy: 9695/9950 (97.4372%)
Scaling by  100
Scaled Norm after poisoning: 164.8736673088671, distance: 123.94910198469572
Total norm for 2 adversaries is: 164.8736673088671. distance: 123.94910198469572
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 407/1574 (25.8577%)
___Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 669/1574 (42.5032%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.2773, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0545, Accuracy: 326/1446 (22.5450%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0351, Accuracy: 492/1446 (34.0249%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.9891, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   1, Avg loss: 0.1255, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   2, Avg loss: 0.1101, Accuracy: 14/134 (10.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 78, internal_epoch   1, Avg loss: 0.0837, Accuracy: 42/416 (10.0962%)
___Train Local_ResNet_18, epoch  21, local model 78, internal_epoch   2, Avg loss: 0.0460, Accuracy: 170/416 (40.8654%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.5462, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 485/1552 (31.2500%)
___Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 777/1552 (50.0644%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 10.9063, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  21, local model 75, internal_epoch   1, Avg loss: 0.0627, Accuracy: 246/776 (31.7010%)
___Train Local_ResNet_18, epoch  21, local model 75, internal_epoch   2, Avg loss: 0.0314, Accuracy: 401/776 (51.6753%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.8315, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 55/311 (17.6849%)
___Train Local_ResNet_18, epoch  21, local model 96, internal_epoch   2, Avg loss: 0.0528, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.3457, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0571, Accuracy: 386/1475 (26.1695%)
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0304, Accuracy: 719/1475 (48.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.9604, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 497/1470 (33.8095%)
___Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 839/1470 (57.0748%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.0673, Accuracy: 75/10000 (0.7500%)
time spent on training: 261.432391166687
[foolsgold agg] training data poison_ratio: 0.29682730552215336  data num: [1657, 1574, 1446, 134, 416, 1552, 776, 311, 1475, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.09275853297567292
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.3147, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Avg loss: 5.5956, Accuracy: 0/9950 (0.0000%)
saving model
Done in 349.31215596199036 sec.
Server Epoch:22 choose agents : [11, 22, 49, 18, 76, 2, 74, 8, 78, 54].
___Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   1, Avg loss: 0.0526, Accuracy: 356/712 (50.0000%)
___Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 443/712 (62.2191%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.4349, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 529/1470 (35.9864%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 854/1470 (58.0952%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.2052, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   1, Avg loss: 0.0805, Accuracy: 27/440 (6.1364%)
___Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   2, Avg loss: 0.0480, Accuracy: 147/440 (33.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 5.4752, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0767, Accuracy: 111/530 (20.9434%)
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0396, Accuracy: 263/530 (49.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.1863, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0864, Accuracy: 37/466 (7.9399%)
___Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0486, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 5.6519, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0638, Accuracy: 223/605 (36.8595%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0402, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 5.7908, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0436, Accuracy: 468/1552 (30.1546%)
___Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 739/1552 (47.6160%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 10.3805, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0596, Accuracy: 218/1513 (14.4085%)
___Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0369, Accuracy: 474/1513 (31.3285%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.6825, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  22, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 35/416 (8.4135%)
___Train Local_ResNet_18, epoch  22, local model 78, internal_epoch   2, Avg loss: 0.0468, Accuracy: 178/416 (42.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 5.5407, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   1, Avg loss: 0.0552, Accuracy: 345/1130 (30.5310%)
___Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 446/1130 (39.4690%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.6178, Accuracy: 52/10000 (0.5200%)
time spent on training: 137.17025923728943
[foolsgold agg] training data poison_ratio: 0.17568485397328504  data num: [712, 1470, 440, 530, 466, 605, 1552, 1513, 416, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.054901516866651574
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 22: Avg loss: 5.3146, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Avg loss: 5.5955, Accuracy: 0/9950 (0.0000%)
saving model
Done in 223.99778389930725 sec.
Server Epoch:23 choose agents : [20, 9, 53, 97, 2, 88, 22, 77, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Average loss: 0.0602, Accuracy: 222/807 (27.5093%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Average loss: 0.0363, Accuracy: 326/807 (40.3965%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Average loss: 0.0309, Accuracy: 389/807 (48.2032%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Average loss: 0.0286, Accuracy: 432/807 (53.5316%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Average loss: 0.0282, Accuracy: 449/807 (55.6382%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Average loss: 0.0255, Accuracy: 465/807 (57.6208%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Average loss: 0.0258, Accuracy: 451/807 (55.8860%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Average loss: 0.0245, Accuracy: 489/807 (60.5948%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Average loss: 0.0240, Accuracy: 491/807 (60.8426%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Average loss: 0.0239, Accuracy: 493/807 (61.0905%), train_poison_data_count: 260
Global model norm: 112.05510990691143.
Norm before scaling: 112.04414151769605. Distance: 0.8471963223596346
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.2718, Accuracy: 68/10000 (0.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.7940, Accuracy: 9292/9950 (93.3869%)
Scaling by  100
Scaled Norm after poisoning: 139.34266020542668, distance: 84.71962893771284
Total norm for 1 adversaries is: 139.34266020542668. distance: 84.71962893771284
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0498, Accuracy: 357/1275 (28.0000%)
___Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0201, Accuracy: 636/1275 (49.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.3060, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   1, Avg loss: 0.0502, Accuracy: 277/813 (34.0713%)
___Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   2, Avg loss: 0.0194, Accuracy: 415/813 (51.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.6507, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  23, local model 97, internal_epoch   1, Avg loss: 0.0526, Accuracy: 356/1213 (29.3487%)
___Train Local_ResNet_18, epoch  23, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 485/1213 (39.9835%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.5314, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 233/605 (38.5124%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0403, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 5.8106, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 88, internal_epoch   1, Avg loss: 0.0752, Accuracy: 135/603 (22.3881%)
___Train Local_ResNet_18, epoch  23, local model 88, internal_epoch   2, Avg loss: 0.0464, Accuracy: 282/603 (46.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 5.9741, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   1, Avg loss: 0.0463, Accuracy: 517/1470 (35.1701%)
___Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 837/1470 (56.9388%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.8818, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  23, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 342/1340 (25.5224%)
___Train Local_ResNet_18, epoch  23, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 567/1340 (42.3134%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.6361, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0754, Accuracy: 114/781 (14.5967%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0368, Accuracy: 242/781 (30.9859%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 6.5541, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 392/1628 (24.0786%)
___Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0260, Accuracy: 819/1628 (50.3071%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.9497, Accuracy: 113/10000 (1.1300%)
time spent on training: 226.60732984542847
[foolsgold agg] training data poison_ratio: 0.07660180351210251  data num: [807, 1275, 813, 1213, 605, 603, 1470, 1340, 781, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.023938063597532033
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 23: Avg loss: 5.3144, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Avg loss: 5.5925, Accuracy: 0/9950 (0.0000%)
saving model
Done in 316.4883449077606 sec.
Server Epoch:24 choose agents : [63, 83, 86, 84, 14, 68, 3, 11, 51, 71].
___Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   1, Avg loss: 0.0550, Accuracy: 257/888 (28.9414%)
___Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 417/888 (46.9595%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.2632, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 409/1953 (20.9421%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 773/1953 (39.5801%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.5227, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  24, local model 86, internal_epoch   1, Avg loss: 0.0626, Accuracy: 349/1003 (34.7956%)
___Train Local_ResNet_18, epoch  24, local model 86, internal_epoch   2, Avg loss: 0.0340, Accuracy: 399/1003 (39.7807%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.6426, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0625, Accuracy: 320/1190 (26.8908%)
___Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 467/1190 (39.2437%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.9388, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 228/1013 (22.5074%)
___Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 340/1013 (33.5637%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.6348, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   1, Avg loss: 0.0621, Accuracy: 365/1163 (31.3844%)
___Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   2, Avg loss: 0.0375, Accuracy: 409/1163 (35.1677%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.9959, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0750, Accuracy: 106/781 (13.5723%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 234/781 (29.9616%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.6213, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   1, Avg loss: 0.0550, Accuracy: 351/712 (49.2978%)
___Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   2, Avg loss: 0.0255, Accuracy: 428/712 (60.1124%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.4335, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 226/1049 (21.5443%)
___Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   2, Avg loss: 0.0300, Accuracy: 514/1049 (48.9990%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.4198, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   1, Avg loss: 0.0639, Accuracy: 163/818 (19.9267%)
___Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 349/818 (42.6650%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.4328, Accuracy: 59/10000 (0.5900%)
time spent on training: 131.08788776397705
[foolsgold agg] training data poison_ratio: 0.0  data num: [888, 1953, 1003, 1190, 1013, 1163, 781, 712, 1049, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 24: Avg loss: 5.3142, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Avg loss: 5.5924, Accuracy: 0/9950 (0.0000%)
saving model
Done in 218.58593153953552 sec.
Server Epoch:25 choose agents : [74, 15, 70, 45, 27, 54, 89, 16, 97, 32].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Average loss: 0.0475, Accuracy: 408/1552 (26.2887%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Average loss: 0.0212, Accuracy: 771/1552 (49.6778%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Average loss: 0.0180, Accuracy: 903/1552 (58.1830%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Average loss: 0.0171, Accuracy: 932/1552 (60.0515%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Average loss: 0.0167, Accuracy: 986/1552 (63.5309%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Average loss: 0.0163, Accuracy: 966/1552 (62.2423%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Average loss: 0.0160, Accuracy: 992/1552 (63.9175%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Average loss: 0.0166, Accuracy: 968/1552 (62.3711%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Average loss: 0.0158, Accuracy: 1019/1552 (65.6572%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Average loss: 0.0160, Accuracy: 1012/1552 (65.2062%), train_poison_data_count: 496
Global model norm: 112.05500096911115.
Norm before scaling: 112.03168148452473. Distance: 1.2698777415533893
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.7094, Accuracy: 88/10000 (0.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.3797, Accuracy: 9056/9950 (91.0151%)
Scaling by  100
Scaled Norm after poisoning: 167.32815345153367, distance: 126.98778469182577
Total norm for 1 adversaries is: 167.32815345153367. distance: 126.98778469182577
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0575, Accuracy: 322/1154 (27.9029%)
___Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 399/1154 (34.5754%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.9222, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 347/1418 (24.4711%)
___Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 653/1418 (46.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.5894, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   1, Avg loss: 0.0677, Accuracy: 193/669 (28.8490%)
___Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   2, Avg loss: 0.0412, Accuracy: 352/669 (52.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 5.7298, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 452/1587 (28.4814%)
___Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 623/1587 (39.2565%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.2110, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 349/1130 (30.8850%)
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 476/1130 (42.1239%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.5650, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 89, internal_epoch   1, Avg loss: 0.0600, Accuracy: 332/896 (37.0536%)
___Train Local_ResNet_18, epoch  25, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 449/896 (50.1116%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 6.2654, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0639, Accuracy: 278/708 (39.2655%)
___Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0361, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 5.7861, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  25, local model 97, internal_epoch   1, Avg loss: 0.0528, Accuracy: 351/1213 (28.9365%)
___Train Local_ResNet_18, epoch  25, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 496/1213 (40.8904%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.6365, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 196/735 (26.6667%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 365/735 (49.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.7477, Accuracy: 52/10000 (0.5200%)
time spent on training: 250.03409671783447
[foolsgold agg] training data poison_ratio: 0.1403001265593925  data num: [1552, 1154, 1418, 669, 1587, 1130, 896, 708, 1213, 735]
[foolsgold agg] considering poison per batch poison_fraction: 0.04384378954981016
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 25: Avg loss: 5.3141, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Avg loss: 5.5855, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.4817419052124 sec.
Server Epoch:26 choose agents : [16, 3, 83, 49, 82, 57, 75, 76, 46, 55].
___Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   1, Avg loss: 0.0597, Accuracy: 276/708 (38.9831%)
___Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   2, Avg loss: 0.0400, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.7474, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.0746, Accuracy: 105/781 (13.4443%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0374, Accuracy: 219/781 (28.0410%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 6.5258, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  26, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 426/1953 (21.8126%)
___Train Local_ResNet_18, epoch  26, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 784/1953 (40.1434%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.8810, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0803, Accuracy: 26/440 (5.9091%)
___Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0481, Accuracy: 147/440 (33.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.4923, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 70/500 (14.0000%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 171/500 (34.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.6234, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   1, Avg loss: 0.0564, Accuracy: 294/1154 (25.4766%)
___Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   2, Avg loss: 0.0273, Accuracy: 442/1154 (38.3016%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.3047, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   1, Avg loss: 0.0622, Accuracy: 253/776 (32.6031%)
___Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   2, Avg loss: 0.0303, Accuracy: 411/776 (52.9639%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 6.8565, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 76, internal_epoch   1, Avg loss: 0.0857, Accuracy: 47/466 (10.0858%)
___Train Local_ResNet_18, epoch  26, local model 76, internal_epoch   2, Avg loss: 0.0484, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.6356, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 417/1904 (21.9013%)
___Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 656/1904 (34.4538%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.6825, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   1, Avg loss: 0.0567, Accuracy: 238/1071 (22.2222%)
___Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   2, Avg loss: 0.0294, Accuracy: 485/1071 (45.2848%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.8874, Accuracy: 59/10000 (0.5900%)
time spent on training: 141.22305822372437
[foolsgold agg] training data poison_ratio: 0.0  data num: [708, 781, 1953, 440, 500, 1154, 776, 466, 1904, 1071]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 26: Avg loss: 5.3140, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Avg loss: 5.5855, Accuracy: 0/9950 (0.0000%)
saving model
Done in 227.66681551933289 sec.
Server Epoch:27 choose agents : [95, 43, 81, 8, 51, 86, 26, 14, 98, 20].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Average loss: 0.0656, Accuracy: 179/599 (29.8831%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Average loss: 0.0245, Accuracy: 348/599 (58.0968%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Average loss: 0.0236, Accuracy: 379/599 (63.2721%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Average loss: 0.0247, Accuracy: 430/599 (71.7863%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Average loss: 0.0242, Accuracy: 446/599 (74.4574%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Average loss: 0.0220, Accuracy: 464/599 (77.4624%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Average loss: 0.0203, Accuracy: 481/599 (80.3005%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Average loss: 0.0207, Accuracy: 481/599 (80.3005%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Average loss: 0.0182, Accuracy: 491/599 (81.9699%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Average loss: 0.0202, Accuracy: 485/599 (80.9683%), train_poison_data_count: 200
Global model norm: 112.05488767368651.
Norm before scaling: 112.04739684894514. Distance: 0.8035907122402344
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.5216, Accuracy: 52/10000 (0.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.5465, Accuracy: 7976/9950 (80.1608%)
Scaling by  100
Scaled Norm after poisoning: 137.04489313496873, distance: 80.35907878372393
Total norm for 2 adversaries is: 137.04489313496873. distance: 80.35907878372393
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   1, Avg loss: 0.0625, Accuracy: 303/946 (32.0296%)
___Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 364/946 (38.4778%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 5.9899, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  27, local model 81, internal_epoch   1, Avg loss: 0.0693, Accuracy: 243/774 (31.3953%)
___Train Local_ResNet_18, epoch  27, local model 81, internal_epoch   2, Avg loss: 0.0354, Accuracy: 275/774 (35.5297%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 6.3558, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0600, Accuracy: 259/1513 (17.1183%)
___Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 467/1513 (30.8658%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.3264, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0607, Accuracy: 222/1049 (21.1630%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0304, Accuracy: 510/1049 (48.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.3117, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  27, local model 86, internal_epoch   1, Avg loss: 0.0631, Accuracy: 359/1003 (35.7926%)
___Train Local_ResNet_18, epoch  27, local model 86, internal_epoch   2, Avg loss: 0.0353, Accuracy: 359/1003 (35.7926%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 6.8381, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 344/1446 (23.7898%)
___Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   2, Avg loss: 0.0351, Accuracy: 496/1446 (34.3015%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.2211, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 224/1013 (22.1125%)
___Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 364/1013 (35.9329%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 6.5428, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0823, Accuracy: 14/373 (3.7534%)
___Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 155/373 (41.5550%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 5.4353, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  27, local model 20, internal_epoch   1, Avg loss: 0.0564, Accuracy: 348/807 (43.1227%)
___Train Local_ResNet_18, epoch  27, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 415/807 (51.4250%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 6.5991, Accuracy: 50/10000 (0.5000%)
time spent on training: 229.06086683273315
[foolsgold agg] training data poison_ratio: 0.1476425496167174  data num: [599, 946, 774, 1513, 1049, 1003, 1446, 1013, 373, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.04613829675522419
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 27: Avg loss: 5.3139, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Avg loss: 5.5867, Accuracy: 0/9950 (0.0000%)
saving model
Done in 317.8250343799591 sec.
Server Epoch:28 choose agents : [43, 16, 55, 21, 94, 68, 49, 93, 87, 78].
___Train Local_ResNet_18, epoch  28, local model 43, internal_epoch   1, Avg loss: 0.0615, Accuracy: 302/946 (31.9239%)
___Train Local_ResNet_18, epoch  28, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 332/946 (35.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 6.0007, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  28, local model 16, internal_epoch   1, Avg loss: 0.0703, Accuracy: 279/708 (39.4068%)
___Train Local_ResNet_18, epoch  28, local model 16, internal_epoch   2, Avg loss: 0.0324, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 5.8062, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 241/1071 (22.5023%)
___Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 515/1071 (48.0859%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.7380, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 396/1949 (20.3181%)
___Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 629/1949 (32.2730%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.3326, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  28, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 340/1662 (20.4573%)
___Train Local_ResNet_18, epoch  28, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 631/1662 (37.9663%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.2522, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   1, Avg loss: 0.0619, Accuracy: 375/1163 (32.2442%)
___Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 439/1163 (37.7472%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 6.6994, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   1, Avg loss: 0.0802, Accuracy: 27/440 (6.1364%)
___Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   2, Avg loss: 0.0478, Accuracy: 153/440 (34.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 5.4971, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 412/1742 (23.6510%)
___Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 720/1742 (41.3318%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.8190, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  28, local model 87, internal_epoch   1, Avg loss: 0.0575, Accuracy: 304/1131 (26.8789%)
___Train Local_ResNet_18, epoch  28, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 402/1131 (35.5438%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.6037, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 78, internal_epoch   1, Avg loss: 0.0833, Accuracy: 40/416 (9.6154%)
___Train Local_ResNet_18, epoch  28, local model 78, internal_epoch   2, Avg loss: 0.0464, Accuracy: 185/416 (44.4712%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 5.5485, Accuracy: 50/10000 (0.5000%)
time spent on training: 151.04402494430542
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 708, 1071, 1949, 1662, 1163, 440, 1742, 1131, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 28: Avg loss: 5.3138, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Avg loss: 5.5869, Accuracy: 0/9950 (0.0000%)
saving model
Done in 236.39576840400696 sec.
Server Epoch:29 choose agents : [7, 85, 95, 12, 59, 54, 89, 98, 63, 66].
___Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 359/891 (40.2918%)
___Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   2, Avg loss: 0.0268, Accuracy: 437/891 (49.0460%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.2116, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 439/1988 (22.0825%)
___Train Local_ResNet_18, epoch  29, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 657/1988 (33.0483%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.6794, Accuracy: 79/10000 (0.7900%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0532, Accuracy: 334/599 (55.7596%)
___Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0294, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.4366, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 20/338 (5.9172%)
___Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   2, Avg loss: 0.0476, Accuracy: 160/338 (47.3373%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 5.4322, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   1, Avg loss: 0.0534, Accuracy: 297/1089 (27.2727%)
___Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   2, Avg loss: 0.0276, Accuracy: 495/1089 (45.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.2200, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0549, Accuracy: 344/1130 (30.4425%)
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 479/1130 (42.3894%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.5502, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 325/896 (36.2723%)
___Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 443/896 (49.4420%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.2918, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   1, Avg loss: 0.0819, Accuracy: 19/373 (5.0938%)
___Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   2, Avg loss: 0.0487, Accuracy: 153/373 (41.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 5.4350, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 261/888 (29.3919%)
___Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 416/888 (46.8468%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.0477, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   1, Avg loss: 0.0616, Accuracy: 254/1402 (18.1170%)
___Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 421/1402 (30.0285%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.1287, Accuracy: 76/10000 (0.7600%)
time spent on training: 153.6710720062256
[foolsgold agg] training data poison_ratio: 0.06243485511778195  data num: [891, 1988, 599, 338, 1089, 1130, 896, 373, 888, 1402]
[foolsgold agg] considering poison per batch poison_fraction: 0.01951089222430686
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 29: Avg loss: 5.3137, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Avg loss: 5.5869, Accuracy: 0/9950 (0.0000%)
saving model
Done in 240.8715054988861 sec.
Server Epoch:30 choose agents : [61, 58, 70, 49, 93, 67, 44, 24, 1, 14].
___Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   1, Avg loss: 0.1252, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   2, Avg loss: 0.1188, Accuracy: 6/85 (7.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.3040, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 349/803 (43.4620%)
___Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 400/803 (49.8132%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.9190, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 342/1418 (24.1185%)
___Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 638/1418 (44.9929%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.6523, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   1, Avg loss: 0.0799, Accuracy: 26/440 (5.9091%)
___Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   2, Avg loss: 0.0477, Accuracy: 145/440 (32.9545%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.5007, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 416/1742 (23.8806%)
___Train Local_ResNet_18, epoch  30, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 685/1742 (39.3226%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.7507, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   1, Avg loss: 0.0788, Accuracy: 53/426 (12.4413%)
___Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   2, Avg loss: 0.0426, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.5543, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 409/1750 (23.3714%)
___Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 664/1750 (37.9429%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.3944, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   1, Avg loss: 0.0762, Accuracy: 32/312 (10.2564%)
___Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 166/312 (53.2051%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.3943, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0574, Accuracy: 281/928 (30.2802%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0246, Accuracy: 526/928 (56.6810%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.3312, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   1, Avg loss: 0.0622, Accuracy: 229/1013 (22.6061%)
___Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 292/1013 (28.8253%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 6.8484, Accuracy: 61/10000 (0.6100%)
time spent on training: 139.63258719444275
[foolsgold agg] training data poison_ratio: 0.0  data num: [85, 803, 1418, 440, 1742, 426, 1750, 312, 928, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.99288245 1.         1.
 1.         0.99288245 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 30: Avg loss: 5.3136, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Avg loss: 5.5868, Accuracy: 0/9950 (0.0000%)
saving model
Done in 226.79947972297668 sec.
Server Epoch:31 choose agents : [67, 91, 74, 70, 30, 32, 97, 1, 61, 22].
___Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0787, Accuracy: 53/426 (12.4413%)
___Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0427, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.5516, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  31, local model 91, internal_epoch   1, Avg loss: 0.0536, Accuracy: 328/1030 (31.8447%)
___Train Local_ResNet_18, epoch  31, local model 91, internal_epoch   2, Avg loss: 0.0262, Accuracy: 598/1030 (58.0583%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.4493, Accuracy: 79/10000 (0.7900%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 469/1552 (30.2191%)
___Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 761/1552 (49.0335%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 10.9848, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   1, Avg loss: 0.0547, Accuracy: 383/1418 (27.0099%)
___Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 634/1418 (44.7109%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.4457, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0804, Accuracy: 68/486 (13.9918%)
___Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0420, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.8180, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0598, Accuracy: 203/735 (27.6190%)
___Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 340/735 (46.2585%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.7549, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0518, Accuracy: 361/1213 (29.7609%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 515/1213 (42.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.8327, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0571, Accuracy: 287/928 (30.9267%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 532/928 (57.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.4157, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   1, Avg loss: 0.1255, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   2, Avg loss: 0.1173, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.3039, Accuracy: 38/10000 (0.3800%)
___Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   1, Avg loss: 0.0451, Accuracy: 551/1470 (37.4830%)
___Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 847/1470 (57.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.0676, Accuracy: 73/10000 (0.7300%)
time spent on training: 159.35540008544922
[foolsgold agg] training data poison_ratio: 0.16611366798672803  data num: [426, 1030, 1552, 1418, 486, 735, 1213, 928, 85, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.051910521245852506
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 31: Avg loss: 5.3135, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Avg loss: 5.5829, Accuracy: 0/9950 (0.0000%)
saving model
Done in 249.4287874698639 sec.
Server Epoch:32 choose agents : [20, 68, 99, 31, 27, 46, 19, 95, 86, 9].
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   1, Avg loss: 0.0564, Accuracy: 346/807 (42.8748%)
___Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 425/807 (52.6642%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.7738, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   1, Avg loss: 0.0614, Accuracy: 372/1163 (31.9862%)
___Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 449/1163 (38.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.7864, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  32, local model 99, internal_epoch   1, Avg loss: 0.0650, Accuracy: 172/773 (22.2510%)
___Train Local_ResNet_18, epoch  32, local model 99, internal_epoch   2, Avg loss: 0.0305, Accuracy: 406/773 (52.5226%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.2211, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   1, Avg loss: 0.0821, Accuracy: 51/460 (11.0870%)
___Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   2, Avg loss: 0.0366, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 5.7208, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 436/1587 (27.4732%)
___Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 628/1587 (39.5715%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.1052, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 428/1904 (22.4790%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 687/1904 (36.0819%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.6058, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0478, Accuracy: 389/1036 (37.5483%)
___Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0231, Accuracy: 671/1036 (64.7683%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 9.0924, Accuracy: 52/10000 (0.5200%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0524, Accuracy: 326/599 (54.4240%)
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.5165, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 86, internal_epoch   1, Avg loss: 0.0623, Accuracy: 353/1003 (35.1944%)
___Train Local_ResNet_18, epoch  32, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 402/1003 (40.0798%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.6919, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   1, Avg loss: 0.0492, Accuracy: 358/1275 (28.0784%)
___Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   2, Avg loss: 0.0197, Accuracy: 705/1275 (55.2941%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 9.5373, Accuracy: 94/10000 (0.9400%)
time spent on training: 169.11048221588135
[foolsgold agg] training data poison_ratio: 0.13255397379089282  data num: [807, 1163, 773, 460, 1587, 1904, 1036, 599, 1003, 1275]
[foolsgold agg] considering poison per batch poison_fraction: 0.041423116809654006
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 32: Avg loss: 5.3134, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Avg loss: 5.5825, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.1747612953186 sec.
Server Epoch:33 choose agents : [27, 92, 82, 59, 49, 13, 81, 70, 48, 79].
___Train Local_ResNet_18, epoch  33, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 447/1587 (28.1664%)
___Train Local_ResNet_18, epoch  33, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 613/1587 (38.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.1443, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  33, local model 92, internal_epoch   1, Avg loss: 0.0530, Accuracy: 418/1715 (24.3732%)
___Train Local_ResNet_18, epoch  33, local model 92, internal_epoch   2, Avg loss: 0.0313, Accuracy: 691/1715 (40.2915%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.6403, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0764, Accuracy: 66/500 (13.2000%)
___Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 169/500 (33.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.6081, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0528, Accuracy: 280/1089 (25.7117%)
___Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 494/1089 (45.3627%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.5720, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   1, Avg loss: 0.0799, Accuracy: 36/440 (8.1818%)
___Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   2, Avg loss: 0.0482, Accuracy: 150/440 (34.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.5154, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 338/1645 (20.5471%)
___Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   2, Avg loss: 0.0324, Accuracy: 629/1645 (38.2371%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.8863, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  33, local model 81, internal_epoch   1, Avg loss: 0.0685, Accuracy: 236/774 (30.4910%)
___Train Local_ResNet_18, epoch  33, local model 81, internal_epoch   2, Avg loss: 0.0353, Accuracy: 294/774 (37.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 6.4436, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 344/1418 (24.2595%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 605/1418 (42.6657%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.4363, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   1, Avg loss: 0.0709, Accuracy: 96/631 (15.2139%)
___Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   2, Avg loss: 0.0415, Accuracy: 220/631 (34.8653%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.8811, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1028, Accuracy: 15/197 (7.6142%)
___Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0852, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.3211, Accuracy: 50/10000 (0.5000%)
time spent on training: 152.11555814743042
[foolsgold agg] training data poison_ratio: 0.0  data num: [1587, 1715, 500, 1089, 440, 1645, 774, 1418, 631, 197]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 33: Avg loss: 5.3133, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Avg loss: 5.5822, Accuracy: 0/9950 (0.0000%)
saving model
Done in 239.76142978668213 sec.
Server Epoch:34 choose agents : [56, 37, 48, 84, 46, 60, 55, 12, 50, 72].
___Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   2, Avg loss: 0.0669, Accuracy: 73/186 (39.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.3113, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 37, internal_epoch   1, Avg loss: 0.0524, Accuracy: 394/1129 (34.8981%)
___Train Local_ResNet_18, epoch  34, local model 37, internal_epoch   2, Avg loss: 0.0253, Accuracy: 727/1129 (64.3933%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.9534, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0711, Accuracy: 96/631 (15.2139%)
___Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 219/631 (34.7068%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.8835, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 84, internal_epoch   1, Avg loss: 0.0626, Accuracy: 326/1190 (27.3950%)
___Train Local_ResNet_18, epoch  34, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 437/1190 (36.7227%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.0166, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  34, local model 46, internal_epoch   1, Avg loss: 0.0548, Accuracy: 428/1904 (22.4790%)
___Train Local_ResNet_18, epoch  34, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 699/1904 (36.7122%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.6262, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 551/2227 (24.7418%)
___Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 995/2227 (44.6789%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.4248, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 262/1071 (24.4631%)
___Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 496/1071 (46.3119%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.7497, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 23/338 (6.8047%)
___Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   2, Avg loss: 0.0474, Accuracy: 151/338 (44.6746%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.4553, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   1, Avg loss: 0.0630, Accuracy: 154/809 (19.0358%)
___Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 367/809 (45.3646%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.1853, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   1, Avg loss: 0.0624, Accuracy: 250/1241 (20.1450%)
___Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 391/1241 (31.5068%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.0736, Accuracy: 60/10000 (0.6000%)
time spent on training: 144.6397795677185
[foolsgold agg] training data poison_ratio: 0.0  data num: [186, 1129, 631, 1190, 1904, 2227, 1071, 338, 809, 1241]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 34: Avg loss: 5.3131, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Avg loss: 5.5809, Accuracy: 0/9950 (0.0000%)
saving model
Done in 233.63660216331482 sec.
Server Epoch:35 choose agents : [14, 25, 49, 31, 78, 56, 59, 12, 2, 67].
___Train Local_ResNet_18, epoch  35, local model 14, internal_epoch   1, Avg loss: 0.0616, Accuracy: 223/1013 (22.0138%)
___Train Local_ResNet_18, epoch  35, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 334/1013 (32.9714%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 6.8196, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  35, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 302/690 (43.7681%)
___Train Local_ResNet_18, epoch  35, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 457/690 (66.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 6.3436, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   1, Avg loss: 0.0796, Accuracy: 25/440 (5.6818%)
___Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   2, Avg loss: 0.0476, Accuracy: 146/440 (33.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.4905, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 56/460 (12.1739%)
___Train Local_ResNet_18, epoch  35, local model 31, internal_epoch   2, Avg loss: 0.0396, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.7900, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 78, internal_epoch   1, Avg loss: 0.0831, Accuracy: 37/416 (8.8942%)
___Train Local_ResNet_18, epoch  35, local model 78, internal_epoch   2, Avg loss: 0.0464, Accuracy: 175/416 (42.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.5790, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 66/186 (35.4839%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.3119, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0538, Accuracy: 294/1089 (26.9972%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 436/1089 (40.0367%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.4535, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 22/338 (6.5089%)
___Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0473, Accuracy: 141/338 (41.7160%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.4538, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 236/605 (39.0083%)
___Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.7951, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0791, Accuracy: 44/426 (10.3286%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0411, Accuracy: 175/426 (41.0798%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.5628, Accuracy: 58/10000 (0.5800%)
time spent on training: 121.37479376792908
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 690, 440, 460, 416, 186, 1089, 338, 605, 426]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 35: Avg loss: 5.3131, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Avg loss: 5.5809, Accuracy: 0/9950 (0.0000%)
saving model
Done in 208.5021538734436 sec.
Server Epoch:36 choose agents : [49, 72, 34, 13, 42, 7, 12, 61, 44, 78].
___Train Local_ResNet_18, epoch  36, local model 49, internal_epoch   1, Avg loss: 0.0797, Accuracy: 30/440 (6.8182%)
___Train Local_ResNet_18, epoch  36, local model 49, internal_epoch   2, Avg loss: 0.0474, Accuracy: 149/440 (33.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.5328, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   1, Avg loss: 0.0615, Accuracy: 264/1241 (21.2732%)
___Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 428/1241 (34.4883%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.1708, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 412/1427 (28.8718%)
___Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 594/1427 (41.6258%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.9696, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 308/1645 (18.7234%)
___Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 619/1645 (37.6292%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.7846, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 340/1372 (24.7813%)
___Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 511/1372 (37.2449%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.0919, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 347/891 (38.9450%)
___Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 455/891 (51.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.0212, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   1, Avg loss: 0.0869, Accuracy: 20/338 (5.9172%)
___Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   2, Avg loss: 0.0467, Accuracy: 149/338 (44.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.4600, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   1, Avg loss: 0.1253, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   2, Avg loss: 0.1193, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.3043, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 417/1750 (23.8286%)
___Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   2, Avg loss: 0.0347, Accuracy: 702/1750 (40.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.4233, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  36, local model 78, internal_epoch   1, Avg loss: 0.0833, Accuracy: 39/416 (9.3750%)
___Train Local_ResNet_18, epoch  36, local model 78, internal_epoch   2, Avg loss: 0.0451, Accuracy: 176/416 (42.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.5371, Accuracy: 50/10000 (0.5000%)
time spent on training: 157.25979089736938
[foolsgold agg] training data poison_ratio: 0.0  data num: [440, 1241, 1427, 1645, 1372, 891, 338, 85, 1750, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.3130, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Avg loss: 5.5807, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.23079800605774 sec.
Server Epoch:37 choose agents : [43, 52, 34, 93, 71, 11, 33, 59, 97, 25].
___Train Local_ResNet_18, epoch  37, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 307/946 (32.4524%)
___Train Local_ResNet_18, epoch  37, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 324/946 (34.2495%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.0507, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0563, Accuracy: 289/636 (45.4403%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0316, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.1969, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 396/1427 (27.7505%)
___Train Local_ResNet_18, epoch  37, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 614/1427 (43.0273%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.7839, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  37, local model 93, internal_epoch   1, Avg loss: 0.0543, Accuracy: 422/1742 (24.2250%)
___Train Local_ResNet_18, epoch  37, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 739/1742 (42.4225%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.6525, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  37, local model 71, internal_epoch   1, Avg loss: 0.0638, Accuracy: 153/818 (18.7042%)
___Train Local_ResNet_18, epoch  37, local model 71, internal_epoch   2, Avg loss: 0.0311, Accuracy: 333/818 (40.7090%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.3907, Accuracy: 39/10000 (0.3900%)
___Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   1, Avg loss: 0.0564, Accuracy: 351/712 (49.2978%)
___Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   2, Avg loss: 0.0269, Accuracy: 414/712 (58.1461%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.3254, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   1, Avg loss: 0.0789, Accuracy: 61/515 (11.8447%)
___Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   2, Avg loss: 0.0485, Accuracy: 125/515 (24.2718%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 5.7396, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 317/1089 (29.1093%)
___Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   2, Avg loss: 0.0287, Accuracy: 462/1089 (42.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.5255, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  37, local model 97, internal_epoch   1, Avg loss: 0.0527, Accuracy: 364/1213 (30.0082%)
___Train Local_ResNet_18, epoch  37, local model 97, internal_epoch   2, Avg loss: 0.0284, Accuracy: 439/1213 (36.1913%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.6523, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 301/690 (43.6232%)
___Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.4621, Accuracy: 63/10000 (0.6300%)
time spent on training: 162.8513045310974
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 636, 1427, 1742, 818, 712, 515, 1089, 1213, 690]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 37: Avg loss: 5.3128, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Avg loss: 5.5803, Accuracy: 0/9950 (0.0000%)
saving model
Done in 250.396870136261 sec.
Server Epoch:38 choose agents : [79, 26, 47, 1, 85, 4, 39, 42, 59, 73].
___Train Local_ResNet_18, epoch  38, local model 79, internal_epoch   1, Avg loss: 0.1047, Accuracy: 20/197 (10.1523%)
___Train Local_ResNet_18, epoch  38, local model 79, internal_epoch   2, Avg loss: 0.0837, Accuracy: 59/197 (29.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 5.3227, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 345/1446 (23.8589%)
___Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 496/1446 (34.3015%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.2027, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  38, local model 47, internal_epoch   1, Avg loss: 0.1198, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  38, local model 47, internal_epoch   2, Avg loss: 0.1119, Accuracy: 16/134 (11.9403%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 282/928 (30.3879%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 572/928 (61.6379%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.7318, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  38, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 451/1988 (22.6861%)
___Train Local_ResNet_18, epoch  38, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 665/1988 (33.4507%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.9780, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0612, Accuracy: 328/901 (36.4040%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0325, Accuracy: 379/901 (42.0644%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.1217, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 309/1013 (30.5035%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 482/1013 (47.5814%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.8344, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 354/1372 (25.8017%)
___Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 504/1372 (36.7347%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.0832, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   1, Avg loss: 0.0520, Accuracy: 312/1089 (28.6501%)
___Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   2, Avg loss: 0.0291, Accuracy: 441/1089 (40.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.7653, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   1, Avg loss: 0.0660, Accuracy: 168/938 (17.9104%)
___Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 322/938 (34.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.9047, Accuracy: 55/10000 (0.5500%)
time spent on training: 153.41443061828613
[foolsgold agg] training data poison_ratio: 0.0  data num: [197, 1446, 134, 928, 1988, 901, 1013, 1372, 1089, 938]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 38: Avg loss: 5.3128, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Avg loss: 5.5789, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.05382347106934 sec.
Server Epoch:39 choose agents : [34, 95, 89, 43, 8, 17, 27, 59, 44, 32].
___Train Local_ResNet_18, epoch  39, local model 34, internal_epoch   1, Avg loss: 0.0582, Accuracy: 405/1427 (28.3812%)
___Train Local_ResNet_18, epoch  39, local model 34, internal_epoch   2, Avg loss: 0.0337, Accuracy: 582/1427 (40.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 6.9078, Accuracy: 51/10000 (0.5100%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  39, local model 95, internal_epoch   1, Avg loss: 0.0531, Accuracy: 332/599 (55.4257%)
___Train Local_ResNet_18, epoch  39, local model 95, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.8100, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  39, local model 89, internal_epoch   1, Avg loss: 0.0619, Accuracy: 331/896 (36.9420%)
___Train Local_ResNet_18, epoch  39, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 413/896 (46.0938%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 6.2693, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0622, Accuracy: 305/946 (32.2410%)
___Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 323/946 (34.1438%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 6.0492, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 225/1513 (14.8711%)
___Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 486/1513 (32.1216%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.4592, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 407/1574 (25.8577%)
___Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 678/1574 (43.0750%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.1908, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0537, Accuracy: 433/1587 (27.2842%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 640/1587 (40.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.5730, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   1, Avg loss: 0.0522, Accuracy: 319/1089 (29.2929%)
___Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 462/1089 (42.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.1363, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 395/1750 (22.5714%)
___Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 658/1750 (37.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.6004, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 198/735 (26.9388%)
___Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 354/735 (48.1633%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.0418, Accuracy: 54/10000 (0.5400%)
time spent on training: 192.67652654647827
[foolsgold agg] training data poison_ratio: 0.049438758666226476  data num: [1427, 599, 896, 946, 1513, 1574, 1587, 1089, 1750, 735]
[foolsgold agg] considering poison per batch poison_fraction: 0.015449612083195775
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 39: Avg loss: 5.3127, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Avg loss: 5.5753, Accuracy: 0/9950 (0.0000%)
saving model
Done in 278.53010511398315 sec.
Server Epoch:40 choose agents : [93, 66, 71, 72, 10, 80, 83, 55, 2, 64].
___Train Local_ResNet_18, epoch  40, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 429/1742 (24.6269%)
___Train Local_ResNet_18, epoch  40, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 682/1742 (39.1504%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.7957, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 274/1402 (19.5435%)
___Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 382/1402 (27.2468%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.1433, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  40, local model 71, internal_epoch   1, Avg loss: 0.0637, Accuracy: 159/818 (19.4377%)
___Train Local_ResNet_18, epoch  40, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 356/818 (43.5208%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.3224, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   1, Avg loss: 0.0620, Accuracy: 242/1241 (19.5004%)
___Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 416/1241 (33.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.2082, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 219/861 (25.4355%)
___Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 416/861 (48.3159%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.8576, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 80, internal_epoch   1, Avg loss: 0.0700, Accuracy: 145/682 (21.2610%)
___Train Local_ResNet_18, epoch  40, local model 80, internal_epoch   2, Avg loss: 0.0386, Accuracy: 239/682 (35.0440%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.3848, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 424/1953 (21.7102%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 768/1953 (39.3241%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.1886, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 253/1071 (23.6228%)
___Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 528/1071 (49.2997%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.8381, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 231/605 (38.1818%)
___Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   2, Avg loss: 0.0405, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.8058, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 163/953 (17.1039%)
___Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0384, Accuracy: 301/953 (31.5845%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.5765, Accuracy: 59/10000 (0.5900%)
time spent on training: 167.33041048049927
[foolsgold agg] training data poison_ratio: 0.0  data num: [1742, 1402, 818, 1241, 861, 682, 1953, 1071, 605, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 40: Avg loss: 5.3126, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Avg loss: 5.5739, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 257.00464963912964 sec.
Server Epoch:41 choose agents : [85, 44, 65, 86, 25, 91, 38, 76, 45, 21].
___Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 462/1988 (23.2394%)
___Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 678/1988 (34.1046%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.8583, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 409/1750 (23.3714%)
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 672/1750 (38.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.6468, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   1, Avg loss: 0.0545, Accuracy: 392/1475 (26.5763%)
___Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   2, Avg loss: 0.0308, Accuracy: 705/1475 (47.7966%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.7680, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  41, local model 86, internal_epoch   1, Avg loss: 0.0621, Accuracy: 355/1003 (35.3938%)
___Train Local_ResNet_18, epoch  41, local model 86, internal_epoch   2, Avg loss: 0.0341, Accuracy: 382/1003 (38.0857%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.8650, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 304/690 (44.0580%)
___Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 456/690 (66.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.3001, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  41, local model 91, internal_epoch   1, Avg loss: 0.0516, Accuracy: 330/1030 (32.0388%)
___Train Local_ResNet_18, epoch  41, local model 91, internal_epoch   2, Avg loss: 0.0270, Accuracy: 620/1030 (60.1942%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.5297, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0617, Accuracy: 248/1131 (21.9275%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 486/1131 (42.9708%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.5415, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   1, Avg loss: 0.0851, Accuracy: 38/466 (8.1545%)
___Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 5.6529, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   1, Avg loss: 0.0680, Accuracy: 197/669 (29.4469%)
___Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   2, Avg loss: 0.0416, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 5.8167, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 440/1949 (22.5757%)
___Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 653/1949 (33.5044%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.1474, Accuracy: 68/10000 (0.6800%)
time spent on training: 182.35451245307922
[foolsgold agg] training data poison_ratio: 0.0  data num: [1988, 1750, 1475, 1003, 690, 1030, 1131, 466, 669, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 41: Avg loss: 5.3125, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Avg loss: 5.5721, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 268.220894575119 sec.
Server Epoch:42 choose agents : [51, 16, 4, 43, 67, 60, 32, 45, 96, 15].
___Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   1, Avg loss: 0.0593, Accuracy: 232/1049 (22.1163%)
___Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 543/1049 (51.7636%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.3293, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  42, local model 16, internal_epoch   1, Avg loss: 0.0600, Accuracy: 276/708 (38.9831%)
___Train Local_ResNet_18, epoch  42, local model 16, internal_epoch   2, Avg loss: 0.0377, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 5.7927, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0638, Accuracy: 322/901 (35.7381%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0317, Accuracy: 387/901 (42.9523%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.9690, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 305/946 (32.2410%)
___Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 389/946 (41.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.1804, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0787, Accuracy: 52/426 (12.2066%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0421, Accuracy: 175/426 (41.0798%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 5.5467, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 563/2227 (25.2806%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1053/2227 (47.2833%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.0515, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   1, Avg loss: 0.0598, Accuracy: 198/735 (26.9388%)
___Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 331/735 (45.0340%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.8219, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0679, Accuracy: 201/669 (30.0448%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0413, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 5.7777, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 45/311 (14.4695%)
___Train Local_ResNet_18, epoch  42, local model 96, internal_epoch   2, Avg loss: 0.0543, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 5.3463, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   1, Avg loss: 0.0594, Accuracy: 333/1154 (28.8562%)
___Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   2, Avg loss: 0.0282, Accuracy: 441/1154 (38.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.5531, Accuracy: 50/10000 (0.5000%)
time spent on training: 148.28453302383423
[foolsgold agg] training data poison_ratio: 0.0  data num: [1049, 708, 901, 946, 426, 2227, 735, 669, 311, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 42: Avg loss: 5.3124, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Avg loss: 5.5677, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 236.3459701538086 sec.
Server Epoch:43 choose agents : [38, 34, 30, 91, 79, 77, 97, 4, 92, 40].
___Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   1, Avg loss: 0.0613, Accuracy: 258/1131 (22.8117%)
___Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 515/1131 (45.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.4816, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  43, local model 34, internal_epoch   1, Avg loss: 0.0578, Accuracy: 408/1427 (28.5915%)
___Train Local_ResNet_18, epoch  43, local model 34, internal_epoch   2, Avg loss: 0.0326, Accuracy: 589/1427 (41.2754%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.9014, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0805, Accuracy: 72/486 (14.8148%)
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0401, Accuracy: 214/486 (44.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 5.7529, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   1, Avg loss: 0.0541, Accuracy: 336/1030 (32.6214%)
___Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   2, Avg loss: 0.0245, Accuracy: 643/1030 (62.4272%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.3556, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  43, local model 79, internal_epoch   1, Avg loss: 0.1019, Accuracy: 21/197 (10.6599%)
___Train Local_ResNet_18, epoch  43, local model 79, internal_epoch   2, Avg loss: 0.0879, Accuracy: 60/197 (30.4569%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 5.3207, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 324/1340 (24.1791%)
___Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0267, Accuracy: 579/1340 (43.2090%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.5603, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  43, local model 97, internal_epoch   1, Avg loss: 0.0519, Accuracy: 358/1213 (29.5136%)
___Train Local_ResNet_18, epoch  43, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 476/1213 (39.2415%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.7573, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   1, Avg loss: 0.0601, Accuracy: 331/901 (36.7370%)
___Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   2, Avg loss: 0.0339, Accuracy: 393/901 (43.6182%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.7921, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 92, internal_epoch   1, Avg loss: 0.0512, Accuracy: 466/1715 (27.1720%)
___Train Local_ResNet_18, epoch  43, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 717/1715 (41.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.9841, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 365/1573 (23.2041%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0351, Accuracy: 543/1573 (34.5200%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.2874, Accuracy: 64/10000 (0.6400%)
time spent on training: 177.27401185035706
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 1427, 486, 1030, 197, 1340, 1213, 901, 1715, 1573]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 43: Avg loss: 5.3124, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Avg loss: 5.5673, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.4883289337158 sec.
Server Epoch:44 choose agents : [31, 21, 20, 52, 96, 4, 15, 32, 64, 58].
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0824, Accuracy: 58/460 (12.6087%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0368, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 5.7574, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 365/1949 (18.7276%)
___Train Local_ResNet_18, epoch  44, local model 21, internal_epoch   2, Avg loss: 0.0334, Accuracy: 603/1949 (30.9389%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.5882, Accuracy: 89/10000 (0.8900%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 347/807 (42.9988%)
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 410/807 (50.8055%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.8528, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   1, Avg loss: 0.0559, Accuracy: 288/636 (45.2830%)
___Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.3299, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 52/311 (16.7203%)
___Train Local_ResNet_18, epoch  44, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 5.3460, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0606, Accuracy: 327/901 (36.2930%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0341, Accuracy: 386/901 (42.8413%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.7221, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 341/1154 (29.5494%)
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0328, Accuracy: 390/1154 (33.7955%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.8821, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 203/735 (27.6190%)
___Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0236, Accuracy: 325/735 (44.2177%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.0865, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   1, Avg loss: 0.0642, Accuracy: 173/953 (18.1532%)
___Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 303/953 (31.7943%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.5188, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 342/803 (42.5903%)
___Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   2, Avg loss: 0.0347, Accuracy: 392/803 (48.8169%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.0169, Accuracy: 51/10000 (0.5100%)
time spent on training: 162.38112449645996
[foolsgold agg] training data poison_ratio: 0.09266276265931794  data num: [460, 1949, 807, 636, 311, 901, 1154, 735, 953, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.028957113331036857
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 44: Avg loss: 5.3123, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Avg loss: 5.5626, Accuracy: 0/9950 (0.0000%)
saving model
Done in 249.23080110549927 sec.
Server Epoch:45 choose agents : [36, 57, 29, 82, 27, 2, 96, 56, 14, 20].
___Train Local_ResNet_18, epoch  45, local model 36, internal_epoch   1, Avg loss: 0.0870, Accuracy: 70/408 (17.1569%)
___Train Local_ResNet_18, epoch  45, local model 36, internal_epoch   2, Avg loss: 0.0559, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.4784, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 57, internal_epoch   1, Avg loss: 0.0541, Accuracy: 304/1154 (26.3432%)
___Train Local_ResNet_18, epoch  45, local model 57, internal_epoch   2, Avg loss: 0.0252, Accuracy: 544/1154 (47.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.3797, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 407/1440 (28.2639%)
___Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 649/1440 (45.0694%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.8319, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  45, local model 82, internal_epoch   1, Avg loss: 0.0764, Accuracy: 69/500 (13.8000%)
___Train Local_ResNet_18, epoch  45, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 173/500 (34.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.6518, Accuracy: 43/10000 (0.4300%)
___Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 459/1587 (28.9225%)
___Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 605/1587 (38.1222%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.2590, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 234/605 (38.6777%)
___Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.8386, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 49/311 (15.7556%)
___Train Local_ResNet_18, epoch  45, local model 96, internal_epoch   2, Avg loss: 0.0543, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.3514, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   1, Avg loss: 0.0823, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   2, Avg loss: 0.0669, Accuracy: 75/186 (40.3226%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.3115, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   1, Avg loss: 0.0619, Accuracy: 234/1013 (23.0997%)
___Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 355/1013 (35.0444%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.7105, Accuracy: 55/10000 (0.5500%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  45, local model 20, internal_epoch   1, Avg loss: 0.0566, Accuracy: 347/807 (42.9988%)
___Train Local_ResNet_18, epoch  45, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 419/807 (51.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.6750, Accuracy: 50/10000 (0.5000%)
time spent on training: 169.0789806842804
[foolsgold agg] training data poison_ratio: 0.10073648732992135  data num: [408, 1154, 1440, 500, 1587, 605, 311, 186, 1013, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.03148015229060042
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 45: Avg loss: 5.3122, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Avg loss: 5.5628, Accuracy: 0/9950 (0.0000%)
saving model
Done in 256.0564374923706 sec.
Server Epoch:46 choose agents : [14, 62, 77, 99, 54, 16, 76, 98, 91, 39].
___Train Local_ResNet_18, epoch  46, local model 14, internal_epoch   1, Avg loss: 0.0614, Accuracy: 224/1013 (22.1125%)
___Train Local_ResNet_18, epoch  46, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 357/1013 (35.2419%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 6.6668, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  46, local model 62, internal_epoch   1, Avg loss: 0.0689, Accuracy: 147/568 (25.8803%)
___Train Local_ResNet_18, epoch  46, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.7749, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  46, local model 77, internal_epoch   1, Avg loss: 0.0533, Accuracy: 332/1340 (24.7761%)
___Train Local_ResNet_18, epoch  46, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 568/1340 (42.3881%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.7734, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  46, local model 99, internal_epoch   1, Avg loss: 0.0654, Accuracy: 190/773 (24.5796%)
___Train Local_ResNet_18, epoch  46, local model 99, internal_epoch   2, Avg loss: 0.0310, Accuracy: 399/773 (51.6171%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.5035, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   1, Avg loss: 0.0542, Accuracy: 350/1130 (30.9735%)
___Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 471/1130 (41.6814%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.7038, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0625, Accuracy: 282/708 (39.8305%)
___Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0380, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.7622, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  46, local model 76, internal_epoch   1, Avg loss: 0.0860, Accuracy: 47/466 (10.0858%)
___Train Local_ResNet_18, epoch  46, local model 76, internal_epoch   2, Avg loss: 0.0481, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.6284, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 98, internal_epoch   1, Avg loss: 0.0818, Accuracy: 21/373 (5.6300%)
___Train Local_ResNet_18, epoch  46, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.4428, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   1, Avg loss: 0.0529, Accuracy: 333/1030 (32.3301%)
___Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   2, Avg loss: 0.0257, Accuracy: 650/1030 (63.1068%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.0303, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   1, Avg loss: 0.0541, Accuracy: 323/1013 (31.8855%)
___Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   2, Avg loss: 0.0263, Accuracy: 479/1013 (47.2853%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.6356, Accuracy: 59/10000 (0.5900%)
time spent on training: 163.4728307723999
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 568, 1340, 773, 1130, 708, 466, 373, 1030, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 46: Avg loss: 5.3122, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Avg loss: 5.5628, Accuracy: 0/9950 (0.0000%)
saving model
Done in 250.3344922065735 sec.
Server Epoch:47 choose agents : [50, 12, 17, 66, 78, 95, 72, 32, 76, 26].
___Train Local_ResNet_18, epoch  47, local model 50, internal_epoch   1, Avg loss: 0.0630, Accuracy: 157/809 (19.4067%)
___Train Local_ResNet_18, epoch  47, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 347/809 (42.8925%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.1380, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0866, Accuracy: 23/338 (6.8047%)
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0463, Accuracy: 145/338 (42.8994%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 5.4363, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 378/1574 (24.0152%)
___Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0269, Accuracy: 714/1574 (45.3621%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.2320, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   1, Avg loss: 0.0616, Accuracy: 268/1402 (19.1155%)
___Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 387/1402 (27.6034%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.1325, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   1, Avg loss: 0.0829, Accuracy: 39/416 (9.3750%)
___Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   2, Avg loss: 0.0453, Accuracy: 179/416 (43.0288%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 5.5860, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 332/599 (55.4257%)
___Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   2, Avg loss: 0.0288, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.8524, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 254/1241 (20.4674%)
___Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 426/1241 (34.3272%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.9979, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   1, Avg loss: 0.0595, Accuracy: 202/735 (27.4830%)
___Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   2, Avg loss: 0.0232, Accuracy: 326/735 (44.3537%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.0824, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0856, Accuracy: 48/466 (10.3004%)
___Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0485, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 5.7169, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 332/1446 (22.9599%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 523/1446 (36.1687%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.3531, Accuracy: 57/10000 (0.5700%)
time spent on training: 183.73586297035217
[foolsgold agg] training data poison_ratio: 0.0663638378019056  data num: [809, 338, 1574, 1402, 416, 599, 1241, 735, 466, 1446]
[foolsgold agg] considering poison per batch poison_fraction: 0.0207386993130955
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 47: Avg loss: 5.3121, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Avg loss: 5.5595, Accuracy: 0/9950 (0.0000%)
saving model
Done in 270.9099051952362 sec.
Server Epoch:48 choose agents : [84, 55, 13, 42, 91, 4, 11, 19, 73, 61].
___Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   1, Avg loss: 0.0622, Accuracy: 326/1190 (27.3950%)
___Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   2, Avg loss: 0.0316, Accuracy: 468/1190 (39.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.0626, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   1, Avg loss: 0.0554, Accuracy: 254/1071 (23.7162%)
___Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 513/1071 (47.8992%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.2958, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  48, local model 13, internal_epoch   1, Avg loss: 0.0572, Accuracy: 343/1645 (20.8511%)
___Train Local_ResNet_18, epoch  48, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 641/1645 (38.9666%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.9401, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 357/1372 (26.0204%)
___Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 457/1372 (33.3090%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.8838, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  48, local model 91, internal_epoch   1, Avg loss: 0.0510, Accuracy: 338/1030 (32.8155%)
___Train Local_ResNet_18, epoch  48, local model 91, internal_epoch   2, Avg loss: 0.0264, Accuracy: 635/1030 (61.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.6632, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   1, Avg loss: 0.0629, Accuracy: 332/901 (36.8479%)
___Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   2, Avg loss: 0.0330, Accuracy: 371/901 (41.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.0731, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   1, Avg loss: 0.0535, Accuracy: 344/712 (48.3146%)
___Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   2, Avg loss: 0.0280, Accuracy: 427/712 (59.9719%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.4792, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0464, Accuracy: 422/1036 (40.7336%)
___Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 654/1036 (63.1274%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.6353, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   1, Avg loss: 0.0666, Accuracy: 159/938 (16.9510%)
___Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   2, Avg loss: 0.0331, Accuracy: 333/938 (35.5011%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.8051, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   1, Avg loss: 0.1257, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   2, Avg loss: 0.1176, Accuracy: 8/85 (9.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 5.3040, Accuracy: 50/10000 (0.5000%)
time spent on training: 169.57602405548096
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 1071, 1645, 1372, 1030, 901, 712, 1036, 938, 85]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 48: Avg loss: 5.3120, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Avg loss: 5.5583, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.02233266830444 sec.
Server Epoch:49 choose agents : [98, 39, 95, 2, 31, 41, 85, 0, 18, 69].
___Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   1, Avg loss: 0.0815, Accuracy: 24/373 (6.4343%)
___Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   2, Avg loss: 0.0480, Accuracy: 155/373 (41.5550%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 5.4619, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 39, internal_epoch   1, Avg loss: 0.0531, Accuracy: 316/1013 (31.1945%)
___Train Local_ResNet_18, epoch  49, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 514/1013 (50.7404%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.4983, Accuracy: 68/10000 (0.6800%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  49, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 328/599 (54.7579%)
___Train Local_ResNet_18, epoch  49, local model 95, internal_epoch   2, Avg loss: 0.0273, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.5289, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0626, Accuracy: 234/605 (38.6777%)
___Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0403, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 5.8518, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   1, Avg loss: 0.0818, Accuracy: 55/460 (11.9565%)
___Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 5.8144, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0594, Accuracy: 327/719 (45.4798%)
___Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0314, Accuracy: 453/719 (63.0042%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 6.3601, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  49, local model 85, internal_epoch   1, Avg loss: 0.0546, Accuracy: 473/1988 (23.7928%)
___Train Local_ResNet_18, epoch  49, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 676/1988 (34.0040%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.9984, Accuracy: 74/10000 (0.7400%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  49, local model 0, internal_epoch   1, Avg loss: 0.0581, Accuracy: 357/1657 (21.5450%)
___Train Local_ResNet_18, epoch  49, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 525/1657 (31.6838%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.8905, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0766, Accuracy: 117/530 (22.0755%)
___Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0395, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 6.1404, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   1, Avg loss: 0.0570, Accuracy: 283/590 (47.9661%)
___Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   2, Avg loss: 0.0336, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 6.9793, Accuracy: 50/10000 (0.5000%)
time spent on training: 194.00668048858643
[foolsgold agg] training data poison_ratio: 0.2643543473166159  data num: [373, 1013, 599, 605, 460, 719, 1988, 1657, 530, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.08261073353644247
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 0. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 49: Avg loss: 5.3120, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Avg loss: 5.5579, Accuracy: 0/9950 (0.0000%)
saving model
Done in 280.7499294281006 sec.
Server Epoch:50 choose agents : [11, 22, 40, 49, 83, 52, 64, 6, 61, 8].
___Train Local_ResNet_18, epoch  50, local model 11, internal_epoch   1, Avg loss: 0.0572, Accuracy: 348/712 (48.8764%)
___Train Local_ResNet_18, epoch  50, local model 11, internal_epoch   2, Avg loss: 0.0250, Accuracy: 400/712 (56.1798%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.3556, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 501/1470 (34.0816%)
___Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 812/1470 (55.2381%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.4732, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   1, Avg loss: 0.0552, Accuracy: 364/1573 (23.1405%)
___Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 574/1573 (36.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.5342, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   1, Avg loss: 0.0794, Accuracy: 27/440 (6.1364%)
___Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   2, Avg loss: 0.0475, Accuracy: 145/440 (32.9545%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 5.4930, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 414/1953 (21.1982%)
___Train Local_ResNet_18, epoch  50, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 756/1953 (38.7097%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.8114, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0561, Accuracy: 285/636 (44.8113%)
___Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0303, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.1197, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   1, Avg loss: 0.0646, Accuracy: 162/953 (16.9990%)
___Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   2, Avg loss: 0.0376, Accuracy: 314/953 (32.9486%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.4921, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 391/1956 (19.9898%)
___Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 645/1956 (32.9755%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.3638, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   2, Avg loss: 0.1155, Accuracy: 10/85 (11.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 5.3038, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   1, Avg loss: 0.0595, Accuracy: 257/1513 (16.9861%)
___Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 485/1513 (32.0555%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.3141, Accuracy: 105/10000 (1.0500%)
time spent on training: 189.71050190925598
[foolsgold agg] training data poison_ratio: 0.0  data num: [712, 1470, 1573, 440, 1953, 636, 953, 1956, 85, 1513]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 50: Avg loss: 5.3119, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Avg loss: 5.5565, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 276.4291682243347 sec.
Server Epoch:51 choose agents : [40, 71, 49, 42, 5, 57, 22, 34, 60, 12].
___Train Local_ResNet_18, epoch  51, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 353/1573 (22.4412%)
___Train Local_ResNet_18, epoch  51, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 561/1573 (35.6643%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.4178, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0641, Accuracy: 160/818 (19.5599%)
___Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 343/818 (41.9315%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.5815, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  51, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 32/440 (7.2727%)
___Train Local_ResNet_18, epoch  51, local model 49, internal_epoch   2, Avg loss: 0.0473, Accuracy: 145/440 (32.9545%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 5.5187, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 364/1372 (26.5306%)
___Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 503/1372 (36.6618%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.8220, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   1, Avg loss: 0.0505, Accuracy: 403/1628 (24.7543%)
___Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 834/1628 (51.2285%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.1996, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   1, Avg loss: 0.0541, Accuracy: 308/1154 (26.6898%)
___Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   2, Avg loss: 0.0256, Accuracy: 505/1154 (43.7608%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.9080, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 498/1470 (33.8776%)
___Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 845/1470 (57.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.0066, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   1, Avg loss: 0.0577, Accuracy: 405/1427 (28.3812%)
___Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 573/1427 (40.1542%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 6.8560, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 588/2227 (26.4032%)
___Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1032/2227 (46.3404%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.0762, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   1, Avg loss: 0.0868, Accuracy: 28/338 (8.2840%)
___Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   2, Avg loss: 0.0493, Accuracy: 144/338 (42.6036%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 5.4428, Accuracy: 50/10000 (0.5000%)
time spent on training: 199.19947624206543
[foolsgold agg] training data poison_ratio: 0.0  data num: [1573, 818, 440, 1372, 1628, 1154, 1470, 1427, 2227, 338]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 51: Avg loss: 5.3118, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 51: Avg loss: 5.5554, Accuracy: 0/9950 (0.0000%)
saving model
Done in 285.1715178489685 sec.
Server Epoch:52 choose agents : [72, 7, 94, 91, 34, 85, 61, 58, 18, 42].
___Train Local_ResNet_18, epoch  52, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 242/1241 (19.5004%)
___Train Local_ResNet_18, epoch  52, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 409/1241 (32.9573%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.0747, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 353/891 (39.6184%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 437/891 (49.0460%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.0943, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 356/1662 (21.4200%)
___Train Local_ResNet_18, epoch  52, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 626/1662 (37.6655%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.8172, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  52, local model 91, internal_epoch   1, Avg loss: 0.0520, Accuracy: 317/1030 (30.7767%)
___Train Local_ResNet_18, epoch  52, local model 91, internal_epoch   2, Avg loss: 0.0280, Accuracy: 635/1030 (61.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.2513, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   1, Avg loss: 0.0572, Accuracy: 412/1427 (28.8718%)
___Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   2, Avg loss: 0.0337, Accuracy: 584/1427 (40.9250%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 6.8594, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  52, local model 85, internal_epoch   1, Avg loss: 0.0530, Accuracy: 440/1988 (22.1328%)
___Train Local_ResNet_18, epoch  52, local model 85, internal_epoch   2, Avg loss: 0.0357, Accuracy: 675/1988 (33.9537%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.3706, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1255, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 10/85 (11.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 5.3039, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0589, Accuracy: 344/803 (42.8394%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0335, Accuracy: 402/803 (50.0623%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 5.9797, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0758, Accuracy: 115/530 (21.6981%)
___Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0386, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 6.1938, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 355/1372 (25.8746%)
___Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 529/1372 (38.5569%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.8508, Accuracy: 78/10000 (0.7800%)
time spent on training: 192.03747701644897
[foolsgold agg] training data poison_ratio: 0.0  data num: [1241, 891, 1662, 1030, 1427, 1988, 85, 803, 530, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 52: Avg loss: 5.3117, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 52: Avg loss: 5.5549, Accuracy: 0/9950 (0.0000%)
saving model
Done in 280.73935651779175 sec.
Server Epoch:53 choose agents : [1, 32, 31, 44, 27, 62, 95, 28, 49, 40].
___Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   1, Avg loss: 0.0575, Accuracy: 283/928 (30.4957%)
___Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   2, Avg loss: 0.0231, Accuracy: 578/928 (62.2845%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.4718, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  53, local model 32, internal_epoch   1, Avg loss: 0.0591, Accuracy: 210/735 (28.5714%)
___Train Local_ResNet_18, epoch  53, local model 32, internal_epoch   2, Avg loss: 0.0220, Accuracy: 368/735 (50.0680%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.3121, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  53, local model 31, internal_epoch   1, Avg loss: 0.0810, Accuracy: 71/460 (15.4348%)
___Train Local_ResNet_18, epoch  53, local model 31, internal_epoch   2, Avg loss: 0.0376, Accuracy: 185/460 (40.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 5.7896, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 406/1750 (23.2000%)
___Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 667/1750 (38.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.5314, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 428/1587 (26.9691%)
___Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 615/1587 (38.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.1233, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0683, Accuracy: 145/568 (25.5282%)
___Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0402, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 5.6880, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  53, local model 95, internal_epoch   1, Avg loss: 0.0531, Accuracy: 335/599 (55.9265%)
___Train Local_ResNet_18, epoch  53, local model 95, internal_epoch   2, Avg loss: 0.0288, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.3489, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 388/1581 (24.5414%)
___Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 597/1581 (37.7609%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.8741, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   1, Avg loss: 0.0790, Accuracy: 36/440 (8.1818%)
___Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   2, Avg loss: 0.0470, Accuracy: 143/440 (32.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 5.5137, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 380/1573 (24.1577%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 533/1573 (33.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.8555, Accuracy: 68/10000 (0.6800%)
time spent on training: 194.28760194778442
[foolsgold agg] training data poison_ratio: 0.05860483318657666  data num: [928, 735, 460, 1750, 1587, 568, 599, 1581, 440, 1573]
[foolsgold agg] considering poison per batch poison_fraction: 0.018314010370805205
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 53: Avg loss: 5.3116, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 53: Avg loss: 5.5517, Accuracy: 0/9950 (0.0000%)
saving model
Done in 280.3013617992401 sec.
Server Epoch:54 choose agents : [8, 16, 22, 38, 69, 90, 47, 85, 7, 94].
___Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0598, Accuracy: 264/1513 (17.4488%)
___Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 494/1513 (32.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.5274, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   1, Avg loss: 0.0608, Accuracy: 280/708 (39.5480%)
___Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   2, Avg loss: 0.0355, Accuracy: 428/708 (60.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 5.7772, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 541/1470 (36.8027%)
___Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 832/1470 (56.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.9843, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0611, Accuracy: 251/1131 (22.1927%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 470/1131 (41.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.2256, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   1, Avg loss: 0.0548, Accuracy: 286/590 (48.4746%)
___Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   2, Avg loss: 0.0318, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.0757, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   1, Avg loss: 0.0567, Accuracy: 313/677 (46.2334%)
___Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 447/677 (66.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.1373, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1247, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1093, Accuracy: 14/134 (10.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 5.3101, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   1, Avg loss: 0.0545, Accuracy: 453/1988 (22.7867%)
___Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 684/1988 (34.4064%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.4435, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0528, Accuracy: 359/891 (40.2918%)
___Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 440/891 (49.3827%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.0580, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  54, local model 94, internal_epoch   1, Avg loss: 0.0546, Accuracy: 328/1662 (19.7353%)
___Train Local_ResNet_18, epoch  54, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 646/1662 (38.8688%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.9176, Accuracy: 97/10000 (0.9700%)
time spent on training: 195.97249150276184
[foolsgold agg] training data poison_ratio: 0.0  data num: [1513, 708, 1470, 1131, 590, 677, 134, 1988, 891, 1662]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 54: Avg loss: 5.3115, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 54: Avg loss: 5.5518, Accuracy: 0/9950 (0.0000%)
saving model
Done in 281.85618448257446 sec.
Server Epoch:55 choose agents : [54, 89, 78, 16, 55, 80, 13, 61, 12, 27].
___Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0551, Accuracy: 349/1130 (30.8850%)
___Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0284, Accuracy: 477/1130 (42.2124%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.4590, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   1, Avg loss: 0.0601, Accuracy: 341/896 (38.0580%)
___Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 465/896 (51.8973%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.2483, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.0827, Accuracy: 46/416 (11.0577%)
___Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 173/416 (41.5865%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.5733, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   1, Avg loss: 0.0620, Accuracy: 276/708 (38.9831%)
___Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   2, Avg loss: 0.0398, Accuracy: 428/708 (60.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.8457, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 259/1071 (24.1830%)
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 512/1071 (47.8058%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.7519, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  55, local model 80, internal_epoch   1, Avg loss: 0.0701, Accuracy: 145/682 (21.2610%)
___Train Local_ResNet_18, epoch  55, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 246/682 (36.0704%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.4586, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0573, Accuracy: 335/1645 (20.3647%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0322, Accuracy: 666/1645 (40.4863%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.8591, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   1, Avg loss: 0.1246, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 9/85 (10.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.3042, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0857, Accuracy: 27/338 (7.9882%)
___Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0480, Accuracy: 149/338 (44.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.4792, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 452/1587 (28.4814%)
___Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 603/1587 (37.9962%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.4063, Accuracy: 64/10000 (0.6400%)
time spent on training: 164.92104077339172
[foolsgold agg] training data poison_ratio: 0.0  data num: [1130, 896, 416, 708, 1071, 682, 1645, 85, 338, 1587]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 55: Avg loss: 5.3114, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 55: Avg loss: 5.5517, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.62518906593323 sec.
Server Epoch:56 choose agents : [0, 41, 85, 47, 95, 90, 72, 45, 32, 26].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  56, local model 0, internal_epoch   1, Avg loss: 0.0581, Accuracy: 348/1657 (21.0018%)
___Train Local_ResNet_18, epoch  56, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 518/1657 (31.2613%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.8271, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 325/719 (45.2017%)
___Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   2, Avg loss: 0.0320, Accuracy: 446/719 (62.0306%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.4615, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  56, local model 85, internal_epoch   1, Avg loss: 0.0528, Accuracy: 463/1988 (23.2897%)
___Train Local_ResNet_18, epoch  56, local model 85, internal_epoch   2, Avg loss: 0.0360, Accuracy: 661/1988 (33.2495%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.8659, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   1, Avg loss: 0.1209, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   2, Avg loss: 0.1076, Accuracy: 21/134 (15.6716%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  56, local model 95, internal_epoch   1, Avg loss: 0.0527, Accuracy: 335/599 (55.9265%)
___Train Local_ResNet_18, epoch  56, local model 95, internal_epoch   2, Avg loss: 0.0282, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.7472, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   1, Avg loss: 0.0573, Accuracy: 310/677 (45.7903%)
___Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 445/677 (65.7312%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.2320, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 282/1241 (22.7236%)
___Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 402/1241 (32.3932%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.1694, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   1, Avg loss: 0.0667, Accuracy: 200/669 (29.8954%)
___Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   2, Avg loss: 0.0411, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 5.7403, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   1, Avg loss: 0.0593, Accuracy: 195/735 (26.5306%)
___Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 323/735 (43.9456%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.0587, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 360/1446 (24.8963%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0342, Accuracy: 506/1446 (34.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.1620, Accuracy: 59/10000 (0.5900%)
time spent on training: 222.24830412864685
[foolsgold agg] training data poison_ratio: 0.22868727825646223  data num: [1657, 719, 1988, 134, 599, 677, 1241, 669, 735, 1446]
[foolsgold agg] considering poison per batch poison_fraction: 0.07146477445514444
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 56: Avg loss: 5.3114, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 56: Avg loss: 5.5481, Accuracy: 0/9950 (0.0000%)
saving model
Done in 308.28797602653503 sec.
Server Epoch:57 choose agents : [7, 40, 56, 4, 32, 75, 76, 70, 89, 9].
___Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   1, Avg loss: 0.0526, Accuracy: 357/891 (40.0673%)
___Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 437/891 (49.0460%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.4570, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0548, Accuracy: 359/1573 (22.8226%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 544/1573 (34.5836%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.4174, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0669, Accuracy: 69/186 (37.0968%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   1, Avg loss: 0.0605, Accuracy: 328/901 (36.4040%)
___Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   2, Avg loss: 0.0327, Accuracy: 381/901 (42.2863%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.1261, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0593, Accuracy: 215/735 (29.2517%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0222, Accuracy: 368/735 (50.0680%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.7440, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   1, Avg loss: 0.0645, Accuracy: 259/776 (33.3763%)
___Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   2, Avg loss: 0.0298, Accuracy: 417/776 (53.7371%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.1403, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 47/466 (10.0858%)
___Train Local_ResNet_18, epoch  57, local model 76, internal_epoch   2, Avg loss: 0.0487, Accuracy: 181/466 (38.8412%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 5.6806, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 367/1418 (25.8815%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 598/1418 (42.1721%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.6770, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   1, Avg loss: 0.0605, Accuracy: 335/896 (37.3884%)
___Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   2, Avg loss: 0.0330, Accuracy: 444/896 (49.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.3330, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   1, Avg loss: 0.0490, Accuracy: 381/1275 (29.8824%)
___Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   2, Avg loss: 0.0191, Accuracy: 711/1275 (55.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.2734, Accuracy: 89/10000 (0.8900%)
time spent on training: 198.38841772079468
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 1573, 186, 901, 735, 776, 466, 1418, 896, 1275]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 57: Avg loss: 5.3113, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 57: Avg loss: 5.5442, Accuracy: 0/9950 (0.0000%)
saving model
Done in 283.9062030315399 sec.
Server Epoch:58 choose agents : [35, 34, 31, 90, 75, 19, 27, 24, 33, 23].
___Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 35/271 (12.9151%)
___Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   2, Avg loss: 0.0563, Accuracy: 104/271 (38.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.3667, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 394/1427 (27.6104%)
___Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 578/1427 (40.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.9823, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0811, Accuracy: 52/460 (11.3043%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0376, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.8135, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 90, internal_epoch   1, Avg loss: 0.0578, Accuracy: 313/677 (46.2334%)
___Train Local_ResNet_18, epoch  58, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 450/677 (66.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.2870, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   1, Avg loss: 0.0648, Accuracy: 256/776 (32.9897%)
___Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 403/776 (51.9330%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.2568, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0478, Accuracy: 413/1036 (39.8649%)
___Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0249, Accuracy: 664/1036 (64.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.1367, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 432/1587 (27.2212%)
___Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 621/1587 (39.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.1659, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   1, Avg loss: 0.0753, Accuracy: 42/312 (13.4615%)
___Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   2, Avg loss: 0.0396, Accuracy: 159/312 (50.9615%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.3885, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0773, Accuracy: 67/515 (13.0097%)
___Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0517, Accuracy: 129/515 (25.0485%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.8570, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0611, Accuracy: 326/715 (45.5944%)
___Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0378, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.8267, Accuracy: 50/10000 (0.5000%)
time spent on training: 181.2441370487213
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 1427, 460, 677, 776, 1036, 1587, 312, 515, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 58: Avg loss: 5.3113, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 58: Avg loss: 5.5445, Accuracy: 0/9950 (0.0000%)
saving model
Done in 267.30293369293213 sec.
Server Epoch:59 choose agents : [69, 84, 6, 40, 21, 23, 99, 76, 53, 20].
___Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   1, Avg loss: 0.0577, Accuracy: 289/590 (48.9831%)
___Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.8397, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 320/1190 (26.8908%)
___Train Local_ResNet_18, epoch  59, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 424/1190 (35.6303%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.9425, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 411/1956 (21.0123%)
___Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 640/1956 (32.7198%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.3659, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 352/1573 (22.3776%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 608/1573 (38.6523%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.3814, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 401/1949 (20.5747%)
___Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0326, Accuracy: 635/1949 (32.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.2967, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0604, Accuracy: 316/715 (44.1958%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0395, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 5.7863, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   1, Avg loss: 0.0664, Accuracy: 183/773 (23.6740%)
___Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   2, Avg loss: 0.0310, Accuracy: 376/773 (48.6417%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.3185, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  59, local model 76, internal_epoch   1, Avg loss: 0.0846, Accuracy: 47/466 (10.0858%)
___Train Local_ResNet_18, epoch  59, local model 76, internal_epoch   2, Avg loss: 0.0472, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 5.6797, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   1, Avg loss: 0.0493, Accuracy: 289/813 (35.5474%)
___Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 440/813 (54.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.2241, Accuracy: 52/10000 (0.5200%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0570, Accuracy: 347/807 (42.9988%)
___Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0316, Accuracy: 422/807 (52.2924%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.2254, Accuracy: 50/10000 (0.5000%)
time spent on training: 219.5764582157135
[foolsgold agg] training data poison_ratio: 0.07450147710487445  data num: [590, 1190, 1956, 1573, 1949, 715, 773, 466, 813, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.023281711595273265
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 59: Avg loss: 5.3112, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 59: Avg loss: 5.5447, Accuracy: 0/9950 (0.0000%)
saving model
Done in 307.4536337852478 sec.
Server Epoch:60 choose agents : [51, 0, 53, 75, 42, 61, 12, 54, 70, 11].
___Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   1, Avg loss: 0.0598, Accuracy: 223/1049 (21.2583%)
___Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 505/1049 (48.1411%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.5199, Accuracy: 75/10000 (0.7500%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  60, local model 0, internal_epoch   1, Avg loss: 0.0585, Accuracy: 360/1657 (21.7260%)
___Train Local_ResNet_18, epoch  60, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 495/1657 (29.8733%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.6703, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0487, Accuracy: 299/813 (36.7774%)
___Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 480/813 (59.0406%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.6783, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 75, internal_epoch   1, Avg loss: 0.0659, Accuracy: 249/776 (32.0876%)
___Train Local_ResNet_18, epoch  60, local model 75, internal_epoch   2, Avg loss: 0.0283, Accuracy: 420/776 (54.1237%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.9966, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 336/1372 (24.4898%)
___Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 509/1372 (37.0991%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.8858, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   1, Avg loss: 0.1246, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   2, Avg loss: 0.1176, Accuracy: 9/85 (10.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 5.3042, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   1, Avg loss: 0.0861, Accuracy: 22/338 (6.5089%)
___Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   2, Avg loss: 0.0480, Accuracy: 140/338 (41.4201%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 5.4809, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 351/1130 (31.0619%)
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0295, Accuracy: 420/1130 (37.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.4680, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 362/1418 (25.5289%)
___Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   2, Avg loss: 0.0317, Accuracy: 610/1418 (43.0183%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.0357, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0560, Accuracy: 350/712 (49.1573%)
___Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0253, Accuracy: 417/712 (58.5674%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.6815, Accuracy: 48/10000 (0.4800%)
time spent on training: 210.24962329864502
[foolsgold agg] training data poison_ratio: 0.1772192513368984  data num: [1049, 1657, 813, 776, 1372, 85, 338, 1130, 1418, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.05538101604278075
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 60: Avg loss: 5.3111, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 60: Avg loss: 5.5446, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 298.5321350097656 sec.
Server Epoch:61 choose agents : [85, 95, 51, 25, 38, 6, 55, 53, 12, 69].
___Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 462/1988 (23.2394%)
___Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 668/1988 (33.6016%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.6919, Accuracy: 88/10000 (0.8800%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  61, local model 95, internal_epoch   1, Avg loss: 0.0527, Accuracy: 334/599 (55.7596%)
___Train Local_ResNet_18, epoch  61, local model 95, internal_epoch   2, Avg loss: 0.0279, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.5303, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   1, Avg loss: 0.0594, Accuracy: 228/1049 (21.7350%)
___Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 510/1049 (48.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.5357, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 305/690 (44.2029%)
___Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   2, Avg loss: 0.0276, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.5469, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   1, Avg loss: 0.0611, Accuracy: 257/1131 (22.7233%)
___Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 487/1131 (43.0592%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.5377, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 369/1956 (18.8650%)
___Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   2, Avg loss: 0.0325, Accuracy: 625/1956 (31.9530%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.1638, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 251/1071 (23.4360%)
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0285, Accuracy: 519/1071 (48.4594%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.7201, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   1, Avg loss: 0.0487, Accuracy: 290/813 (35.6704%)
___Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 450/813 (55.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.2802, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0854, Accuracy: 33/338 (9.7633%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0467, Accuracy: 158/338 (46.7456%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 5.4567, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   1, Avg loss: 0.0559, Accuracy: 287/590 (48.6441%)
___Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   2, Avg loss: 0.0332, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.8800, Accuracy: 50/10000 (0.5000%)
time spent on training: 217.32253074645996
[foolsgold agg] training data poison_ratio: 0.05858190709046455  data num: [1988, 599, 1049, 690, 1131, 1956, 1071, 813, 338, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.01830684596577017
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 61: Avg loss: 5.3111, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 61: Avg loss: 5.5450, Accuracy: 0/9950 (0.0000%)
saving model
Done in 304.5626060962677 sec.
Server Epoch:62 choose agents : [84, 79, 24, 82, 4, 30, 94, 33, 69, 60].
___Train Local_ResNet_18, epoch  62, local model 84, internal_epoch   1, Avg loss: 0.0626, Accuracy: 320/1190 (26.8908%)
___Train Local_ResNet_18, epoch  62, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 423/1190 (35.5462%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.0400, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   1, Avg loss: 0.1018, Accuracy: 14/197 (7.1066%)
___Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   2, Avg loss: 0.0885, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.3200, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   1, Avg loss: 0.0753, Accuracy: 44/312 (14.1026%)
___Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   2, Avg loss: 0.0393, Accuracy: 160/312 (51.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.3930, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0763, Accuracy: 74/500 (14.8000%)
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0480, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.6734, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   1, Avg loss: 0.0629, Accuracy: 331/901 (36.7370%)
___Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   2, Avg loss: 0.0315, Accuracy: 386/901 (42.8413%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.2568, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   1, Avg loss: 0.0796, Accuracy: 80/486 (16.4609%)
___Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   2, Avg loss: 0.0398, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.7927, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  62, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 361/1662 (21.7208%)
___Train Local_ResNet_18, epoch  62, local model 94, internal_epoch   2, Avg loss: 0.0325, Accuracy: 632/1662 (38.0265%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.7985, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   1, Avg loss: 0.0784, Accuracy: 69/515 (13.3981%)
___Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   2, Avg loss: 0.0536, Accuracy: 143/515 (27.7670%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.7477, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   1, Avg loss: 0.0563, Accuracy: 290/590 (49.1525%)
___Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   2, Avg loss: 0.0317, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.9269, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 605/2227 (27.1666%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0276, Accuracy: 1078/2227 (48.4059%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.2716, Accuracy: 121/10000 (1.2100%)
time spent on training: 167.70411229133606
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 197, 312, 500, 901, 486, 1662, 515, 590, 2227]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.3111, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 62: Avg loss: 5.5442, Accuracy: 0/9950 (0.0000%)
saving model
Done in 259.55958580970764 sec.
Server Epoch:63 choose agents : [18, 64, 38, 96, 55, 91, 58, 59, 66, 77].
___Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0759, Accuracy: 113/530 (21.3208%)
___Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0385, Accuracy: 269/530 (50.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.2060, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0639, Accuracy: 183/953 (19.2025%)
___Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 313/953 (32.8437%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.6053, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0611, Accuracy: 260/1131 (22.9885%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 501/1131 (44.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.2602, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  63, local model 96, internal_epoch   1, Avg loss: 0.0778, Accuracy: 52/311 (16.7203%)
___Train Local_ResNet_18, epoch  63, local model 96, internal_epoch   2, Avg loss: 0.0533, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 5.3467, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   1, Avg loss: 0.0549, Accuracy: 272/1071 (25.3968%)
___Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   2, Avg loss: 0.0294, Accuracy: 494/1071 (46.1251%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.9892, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   1, Avg loss: 0.0524, Accuracy: 345/1030 (33.4951%)
___Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   2, Avg loss: 0.0251, Accuracy: 627/1030 (60.8738%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.4657, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0572, Accuracy: 353/803 (43.9601%)
___Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 386/803 (48.0697%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 6.0040, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 300/1089 (27.5482%)
___Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 471/1089 (43.2507%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.5660, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 253/1402 (18.0456%)
___Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 396/1402 (28.2454%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.1105, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  63, local model 77, internal_epoch   1, Avg loss: 0.0533, Accuracy: 335/1340 (25.0000%)
___Train Local_ResNet_18, epoch  63, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 567/1340 (42.3134%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.5926, Accuracy: 58/10000 (0.5800%)
time spent on training: 201.96616220474243
[foolsgold agg] training data poison_ratio: 0.0  data num: [530, 953, 1131, 311, 1071, 1030, 803, 1089, 1402, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 63: Avg loss: 5.3110, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 63: Avg loss: 5.5428, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.04745054244995 sec.
Server Epoch:64 choose agents : [78, 13, 57, 64, 48, 23, 71, 35, 32, 76].
___Train Local_ResNet_18, epoch  64, local model 78, internal_epoch   1, Avg loss: 0.0826, Accuracy: 45/416 (10.8173%)
___Train Local_ResNet_18, epoch  64, local model 78, internal_epoch   2, Avg loss: 0.0449, Accuracy: 189/416 (45.4327%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.5687, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   1, Avg loss: 0.0577, Accuracy: 316/1645 (19.2097%)
___Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 653/1645 (39.6960%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.0172, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 303/1154 (26.2565%)
___Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   2, Avg loss: 0.0265, Accuracy: 438/1154 (37.9549%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.0651, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   1, Avg loss: 0.0641, Accuracy: 176/953 (18.4680%)
___Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   2, Avg loss: 0.0376, Accuracy: 306/953 (32.1091%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 6.3329, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   1, Avg loss: 0.0708, Accuracy: 108/631 (17.1157%)
___Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   2, Avg loss: 0.0415, Accuracy: 215/631 (34.0729%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.8496, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   1, Avg loss: 0.0618, Accuracy: 325/715 (45.4545%)
___Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   2, Avg loss: 0.0395, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.7771, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0635, Accuracy: 170/818 (20.7824%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 353/818 (43.1540%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.3632, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.0862, Accuracy: 36/271 (13.2841%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0563, Accuracy: 106/271 (39.1144%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.3653, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   1, Avg loss: 0.0594, Accuracy: 210/735 (28.5714%)
___Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 343/735 (46.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.3322, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0846, Accuracy: 52/466 (11.1588%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0490, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.6839, Accuracy: 50/10000 (0.5000%)
time spent on training: 165.96851444244385
[foolsgold agg] training data poison_ratio: 0.0  data num: [416, 1645, 1154, 953, 631, 715, 818, 271, 735, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.3109, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 64: Avg loss: 5.5383, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.57397556304932 sec.
Server Epoch:65 choose agents : [28, 37, 12, 15, 85, 30, 66, 73, 82, 11].
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 394/1581 (24.9209%)
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 617/1581 (39.0259%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.8462, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0526, Accuracy: 393/1129 (34.8096%)
___Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0241, Accuracy: 733/1129 (64.9247%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.5750, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   1, Avg loss: 0.0852, Accuracy: 34/338 (10.0592%)
___Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   2, Avg loss: 0.0458, Accuracy: 150/338 (44.3787%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 5.4636, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   1, Avg loss: 0.0570, Accuracy: 337/1154 (29.2028%)
___Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 469/1154 (40.6412%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.2305, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  65, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 478/1988 (24.0443%)
___Train Local_ResNet_18, epoch  65, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 702/1988 (35.3119%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.1322, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   1, Avg loss: 0.0795, Accuracy: 80/486 (16.4609%)
___Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   2, Avg loss: 0.0408, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 5.8388, Accuracy: 37/10000 (0.3700%)
___Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   1, Avg loss: 0.0614, Accuracy: 265/1402 (18.9016%)
___Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 410/1402 (29.2439%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.1441, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   1, Avg loss: 0.0651, Accuracy: 169/938 (18.0171%)
___Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   2, Avg loss: 0.0330, Accuracy: 352/938 (37.5267%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.7478, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0757, Accuracy: 72/500 (14.4000%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 5.7277, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0534, Accuracy: 349/712 (49.0169%)
___Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0284, Accuracy: 424/712 (59.5506%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 6.6061, Accuracy: 50/10000 (0.5000%)
time spent on training: 226.2051558494568
[foolsgold agg] training data poison_ratio: 0.0  data num: [1581, 1129, 338, 1154, 1988, 486, 1402, 938, 500, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 65: Avg loss: 5.3109, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 65: Avg loss: 5.5372, Accuracy: 0/9950 (0.0000%)
saving model
Done in 312.1524963378906 sec.
Server Epoch:66 choose agents : [90, 62, 96, 18, 82, 94, 92, 73, 7, 71].
___Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   1, Avg loss: 0.0564, Accuracy: 319/677 (47.1196%)
___Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   2, Avg loss: 0.0239, Accuracy: 440/677 (64.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.5402, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   1, Avg loss: 0.0682, Accuracy: 155/568 (27.2887%)
___Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.7516, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  66, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 51/311 (16.3987%)
___Train Local_ResNet_18, epoch  66, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.3463, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0758, Accuracy: 112/530 (21.1321%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0392, Accuracy: 264/530 (49.8113%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.0600, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  66, local model 82, internal_epoch   1, Avg loss: 0.0759, Accuracy: 76/500 (15.2000%)
___Train Local_ResNet_18, epoch  66, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 174/500 (34.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.6517, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 319/1662 (19.1937%)
___Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 595/1662 (35.8002%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.7436, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   1, Avg loss: 0.0519, Accuracy: 453/1715 (26.4140%)
___Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 710/1715 (41.3994%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.5074, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   1, Avg loss: 0.0650, Accuracy: 169/938 (18.0171%)
___Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   2, Avg loss: 0.0329, Accuracy: 325/938 (34.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.4396, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   1, Avg loss: 0.0520, Accuracy: 367/891 (41.1897%)
___Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 451/891 (50.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.2690, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0637, Accuracy: 158/818 (19.3154%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0298, Accuracy: 369/818 (45.1100%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.1874, Accuracy: 60/10000 (0.6000%)
time spent on training: 197.6214244365692
[foolsgold agg] training data poison_ratio: 0.0  data num: [677, 568, 311, 530, 500, 1662, 1715, 938, 891, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.3108, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 66: Avg loss: 5.5357, Accuracy: 0/9950 (0.0000%)
saving model
Done in 283.753787279129 sec.
Server Epoch:67 choose agents : [44, 84, 98, 56, 6, 75, 64, 39, 14, 78].
___Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   1, Avg loss: 0.0585, Accuracy: 382/1750 (21.8286%)
___Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 648/1750 (37.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.6311, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  67, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 327/1190 (27.4790%)
___Train Local_ResNet_18, epoch  67, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 463/1190 (38.9076%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.9866, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  67, local model 98, internal_epoch   1, Avg loss: 0.0813, Accuracy: 26/373 (6.9705%)
___Train Local_ResNet_18, epoch  67, local model 98, internal_epoch   2, Avg loss: 0.0476, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 5.4395, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0666, Accuracy: 76/186 (40.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 5.3114, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 390/1956 (19.9387%)
___Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   2, Avg loss: 0.0315, Accuracy: 666/1956 (34.0491%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.0901, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  67, local model 75, internal_epoch   1, Avg loss: 0.0643, Accuracy: 254/776 (32.7320%)
___Train Local_ResNet_18, epoch  67, local model 75, internal_epoch   2, Avg loss: 0.0296, Accuracy: 390/776 (50.2577%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.6931, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   1, Avg loss: 0.0639, Accuracy: 174/953 (18.2581%)
___Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   2, Avg loss: 0.0377, Accuracy: 326/953 (34.2078%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.3707, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 313/1013 (30.8983%)
___Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 519/1013 (51.2340%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.6230, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 222/1013 (21.9151%)
___Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   2, Avg loss: 0.0351, Accuracy: 331/1013 (32.6752%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.5209, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   1, Avg loss: 0.0824, Accuracy: 46/416 (11.0577%)
___Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   2, Avg loss: 0.0459, Accuracy: 188/416 (45.1923%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 5.5983, Accuracy: 50/10000 (0.5000%)
time spent on training: 235.51058173179626
[foolsgold agg] training data poison_ratio: 0.0  data num: [1750, 1190, 373, 186, 1956, 776, 953, 1013, 1013, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 67: Avg loss: 5.3107, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 67: Avg loss: 5.5346, Accuracy: 0/9950 (0.0000%)
saving model
Done in 321.1353874206543 sec.
Server Epoch:68 choose agents : [21, 24, 59, 44, 84, 9, 17, 88, 52, 63].
___Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 428/1949 (21.9600%)
___Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 626/1949 (32.1190%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.2138, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   1, Avg loss: 0.0751, Accuracy: 42/312 (13.4615%)
___Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 159/312 (50.9615%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 5.3993, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   1, Avg loss: 0.0586, Accuracy: 308/1089 (28.2828%)
___Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   2, Avg loss: 0.0272, Accuracy: 445/1089 (40.8632%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.4606, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 405/1750 (23.1429%)
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 669/1750 (38.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.6679, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  68, local model 84, internal_epoch   1, Avg loss: 0.0628, Accuracy: 329/1190 (27.6471%)
___Train Local_ResNet_18, epoch  68, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 443/1190 (37.2269%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 6.8939, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0498, Accuracy: 352/1275 (27.6078%)
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 667/1275 (52.3137%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.0596, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0506, Accuracy: 391/1574 (24.8412%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 684/1574 (43.4562%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.3259, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   1, Avg loss: 0.0754, Accuracy: 144/603 (23.8806%)
___Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   2, Avg loss: 0.0463, Accuracy: 283/603 (46.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 5.9594, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0565, Accuracy: 290/636 (45.5975%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0309, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 6.2514, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   1, Avg loss: 0.0536, Accuracy: 267/888 (30.0676%)
___Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   2, Avg loss: 0.0264, Accuracy: 399/888 (44.9324%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.4732, Accuracy: 51/10000 (0.5100%)
time spent on training: 240.59376692771912
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 312, 1089, 1750, 1190, 1275, 1574, 603, 636, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 68: Avg loss: 5.3106, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 68: Avg loss: 5.5339, Accuracy: 0/9950 (0.0000%)
saving model
Done in 326.867791891098 sec.
Server Epoch:69 choose agents : [21, 31, 44, 90, 70, 81, 84, 5, 69, 76].
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 359/1949 (18.4197%)
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 628/1949 (32.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.3809, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   1, Avg loss: 0.0811, Accuracy: 59/460 (12.8261%)
___Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 5.8200, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   1, Avg loss: 0.0588, Accuracy: 398/1750 (22.7429%)
___Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   2, Avg loss: 0.0345, Accuracy: 700/1750 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.4522, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   1, Avg loss: 0.0558, Accuracy: 319/677 (47.1196%)
___Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 466/677 (68.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.3198, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0554, Accuracy: 356/1418 (25.1058%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0301, Accuracy: 652/1418 (45.9803%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.6944, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  69, local model 81, internal_epoch   1, Avg loss: 0.0677, Accuracy: 235/774 (30.3618%)
___Train Local_ResNet_18, epoch  69, local model 81, internal_epoch   2, Avg loss: 0.0360, Accuracy: 300/774 (38.7597%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.4828, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  69, local model 84, internal_epoch   1, Avg loss: 0.0610, Accuracy: 328/1190 (27.5630%)
___Train Local_ResNet_18, epoch  69, local model 84, internal_epoch   2, Avg loss: 0.0315, Accuracy: 451/1190 (37.8992%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.0942, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 384/1628 (23.5872%)
___Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 830/1628 (50.9828%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.2561, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0570, Accuracy: 293/590 (49.6610%)
___Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0311, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.0991, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 76, internal_epoch   1, Avg loss: 0.0851, Accuracy: 45/466 (9.6567%)
___Train Local_ResNet_18, epoch  69, local model 76, internal_epoch   2, Avg loss: 0.0484, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 5.7328, Accuracy: 50/10000 (0.5000%)
time spent on training: 222.13401675224304
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 460, 1750, 677, 1418, 774, 1190, 1628, 590, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 69: Avg loss: 5.3105, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 69: Avg loss: 5.5339, Accuracy: 0/9950 (0.0000%)
saving model
Done in 310.09167861938477 sec.
Server Epoch:70 choose agents : [7, 75, 77, 74, 16, 9, 19, 99, 48, 66].
___Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   1, Avg loss: 0.0528, Accuracy: 362/891 (40.6285%)
___Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 440/891 (49.3827%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.2471, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0646, Accuracy: 264/776 (34.0206%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0295, Accuracy: 433/776 (55.7990%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.7680, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 77, internal_epoch   1, Avg loss: 0.0534, Accuracy: 334/1340 (24.9254%)
___Train Local_ResNet_18, epoch  70, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 520/1340 (38.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.9464, Accuracy: 55/10000 (0.5500%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   1, Avg loss: 0.0437, Accuracy: 453/1552 (29.1881%)
___Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 741/1552 (47.7448%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 10.2737, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   1, Avg loss: 0.0639, Accuracy: 287/708 (40.5367%)
___Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   2, Avg loss: 0.0353, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.7785, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   1, Avg loss: 0.0490, Accuracy: 362/1275 (28.3922%)
___Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   2, Avg loss: 0.0190, Accuracy: 734/1275 (57.5686%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.6423, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0475, Accuracy: 395/1036 (38.1274%)
___Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0256, Accuracy: 619/1036 (59.7490%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.0606, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   1, Avg loss: 0.0658, Accuracy: 176/773 (22.7684%)
___Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   2, Avg loss: 0.0327, Accuracy: 402/773 (52.0052%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.9479, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 106/631 (16.7987%)
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0406, Accuracy: 231/631 (36.6086%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.9669, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0618, Accuracy: 257/1402 (18.3310%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 372/1402 (26.5335%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.4147, Accuracy: 69/10000 (0.6900%)
time spent on training: 256.58270359039307
[foolsgold agg] training data poison_ratio: 0.14946070878274267  data num: [891, 776, 1340, 1552, 708, 1275, 1036, 773, 631, 1402]
[foolsgold agg] considering poison per batch poison_fraction: 0.046706471494607084
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.3104, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 70: Avg loss: 5.5337, Accuracy: 0/9950 (0.0000%)
saving model
Done in 343.38504576683044 sec.
Server Epoch:71 choose agents : [49, 6, 75, 91, 83, 24, 33, 79, 18, 85].
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0787, Accuracy: 44/440 (10.0000%)
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0481, Accuracy: 149/440 (33.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.5170, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 426/1956 (21.7791%)
___Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 649/1956 (33.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.7233, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  71, local model 75, internal_epoch   1, Avg loss: 0.0622, Accuracy: 260/776 (33.5052%)
___Train Local_ResNet_18, epoch  71, local model 75, internal_epoch   2, Avg loss: 0.0288, Accuracy: 427/776 (55.0258%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 6.9260, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  71, local model 91, internal_epoch   1, Avg loss: 0.0510, Accuracy: 348/1030 (33.7864%)
___Train Local_ResNet_18, epoch  71, local model 91, internal_epoch   2, Avg loss: 0.0264, Accuracy: 622/1030 (60.3883%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.3238, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 441/1953 (22.5806%)
___Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 769/1953 (39.3753%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.0100, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   1, Avg loss: 0.0751, Accuracy: 42/312 (13.4615%)
___Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   2, Avg loss: 0.0397, Accuracy: 171/312 (54.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.3995, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   1, Avg loss: 0.0767, Accuracy: 72/515 (13.9806%)
___Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   2, Avg loss: 0.0544, Accuracy: 138/515 (26.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.8494, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   1, Avg loss: 0.1014, Accuracy: 14/197 (7.1066%)
___Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   2, Avg loss: 0.0861, Accuracy: 59/197 (29.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.3218, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0754, Accuracy: 125/530 (23.5849%)
___Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0383, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 6.1647, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  71, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 441/1988 (22.1831%)
___Train Local_ResNet_18, epoch  71, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 669/1988 (33.6519%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.7949, Accuracy: 81/10000 (0.8100%)
time spent on training: 208.2717263698578
[foolsgold agg] training data poison_ratio: 0.0  data num: [440, 1956, 776, 1030, 1953, 312, 515, 197, 530, 1988]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.3103, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Avg loss: 5.5338, Accuracy: 0/9950 (0.0000%)
saving model
Done in 293.96035385131836 sec.
Server Epoch:72 choose agents : [31, 17, 64, 92, 34, 20, 4, 63, 22, 19].
___Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   1, Avg loss: 0.0807, Accuracy: 68/460 (14.7826%)
___Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   2, Avg loss: 0.0370, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 5.8570, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 404/1574 (25.6671%)
___Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   2, Avg loss: 0.0268, Accuracy: 684/1574 (43.4562%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.1841, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   1, Avg loss: 0.0640, Accuracy: 182/953 (19.0976%)
___Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 307/953 (32.2141%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.5750, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  72, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 442/1715 (25.7726%)
___Train Local_ResNet_18, epoch  72, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 736/1715 (42.9155%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.6190, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   1, Avg loss: 0.0584, Accuracy: 391/1427 (27.4001%)
___Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   2, Avg loss: 0.0338, Accuracy: 567/1427 (39.7337%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.8818, Accuracy: 52/10000 (0.5200%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  72, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 342/807 (42.3792%)
___Train Local_ResNet_18, epoch  72, local model 20, internal_epoch   2, Avg loss: 0.0313, Accuracy: 426/807 (52.7881%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.8246, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   1, Avg loss: 0.0618, Accuracy: 336/901 (37.2919%)
___Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   2, Avg loss: 0.0312, Accuracy: 398/901 (44.1731%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.7362, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 265/888 (29.8423%)
___Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0252, Accuracy: 435/888 (48.9865%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.7769, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0449, Accuracy: 527/1470 (35.8503%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 817/1470 (55.5782%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.2552, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0472, Accuracy: 389/1036 (37.5483%)
___Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0240, Accuracy: 677/1036 (65.3475%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.5507, Accuracy: 56/10000 (0.5600%)
time spent on training: 260.2875735759735
[foolsgold agg] training data poison_ratio: 0.07185468791737155  data num: [460, 1574, 953, 1715, 1427, 807, 901, 888, 1470, 1036]
[foolsgold agg] considering poison per batch poison_fraction: 0.02245458997417861
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 72: Avg loss: 5.3103, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Avg loss: 5.5328, Accuracy: 0/9950 (0.0000%)
saving model
Done in 345.6182448863983 sec.
Server Epoch:73 choose agents : [27, 74, 34, 98, 4, 72, 82, 12, 59, 89].
___Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 455/1587 (28.6704%)
___Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 631/1587 (39.7606%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.1773, Accuracy: 66/10000 (0.6600%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  73, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 510/1552 (32.8608%)
___Train Local_ResNet_18, epoch  73, local model 74, internal_epoch   2, Avg loss: 0.0206, Accuracy: 800/1552 (51.5464%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 10.3732, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   1, Avg loss: 0.0577, Accuracy: 393/1427 (27.5403%)
___Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 572/1427 (40.0841%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.9007, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   1, Avg loss: 0.0812, Accuracy: 30/373 (8.0429%)
___Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   2, Avg loss: 0.0479, Accuracy: 153/373 (41.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.4588, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0606, Accuracy: 339/901 (37.6249%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0325, Accuracy: 365/901 (40.5105%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.3599, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   1, Avg loss: 0.0606, Accuracy: 279/1241 (22.4819%)
___Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 385/1241 (31.0234%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.2998, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  73, local model 82, internal_epoch   1, Avg loss: 0.0753, Accuracy: 79/500 (15.8000%)
___Train Local_ResNet_18, epoch  73, local model 82, internal_epoch   2, Avg loss: 0.0482, Accuracy: 179/500 (35.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.6331, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   1, Avg loss: 0.0853, Accuracy: 34/338 (10.0592%)
___Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   2, Avg loss: 0.0468, Accuracy: 143/338 (42.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.4746, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   1, Avg loss: 0.0528, Accuracy: 303/1089 (27.8237%)
___Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   2, Avg loss: 0.0300, Accuracy: 486/1089 (44.6281%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.0429, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  73, local model 89, internal_epoch   1, Avg loss: 0.0609, Accuracy: 339/896 (37.8348%)
___Train Local_ResNet_18, epoch  73, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 450/896 (50.2232%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.3309, Accuracy: 50/10000 (0.5000%)
time spent on training: 227.78346300125122
[foolsgold agg] training data poison_ratio: 0.1567043618739903  data num: [1587, 1552, 1427, 373, 901, 1241, 500, 338, 1089, 896]
[foolsgold agg] considering poison per batch poison_fraction: 0.04897011308562197
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.3102, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Avg loss: 5.5324, Accuracy: 0/9950 (0.0000%)
saving model
Done in 317.0216689109802 sec.
Server Epoch:74 choose agents : [9, 38, 74, 63, 50, 44, 1, 93, 94, 53].
___Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   1, Avg loss: 0.0492, Accuracy: 365/1275 (28.6275%)
___Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   2, Avg loss: 0.0191, Accuracy: 730/1275 (57.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.4897, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   1, Avg loss: 0.0611, Accuracy: 257/1131 (22.7233%)
___Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 477/1131 (42.1751%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.2914, Accuracy: 69/10000 (0.6900%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   1, Avg loss: 0.0436, Accuracy: 448/1552 (28.8660%)
___Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 773/1552 (49.8067%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 10.9396, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 263/888 (29.6171%)
___Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 414/888 (46.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.3311, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0629, Accuracy: 176/809 (21.7553%)
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 364/809 (44.9938%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.4699, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0587, Accuracy: 408/1750 (23.3143%)
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0348, Accuracy: 699/1750 (39.9429%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.8687, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   1, Avg loss: 0.0566, Accuracy: 283/928 (30.4957%)
___Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 577/928 (62.1767%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.8435, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 423/1742 (24.2824%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 691/1742 (39.6670%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.7253, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 349/1662 (20.9988%)
___Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 581/1662 (34.9579%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.7934, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   1, Avg loss: 0.0489, Accuracy: 281/813 (34.5633%)
___Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 454/813 (55.8426%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.6137, Accuracy: 50/10000 (0.5000%)
time spent on training: 280.1838147640228
[foolsgold agg] training data poison_ratio: 0.12366533864541833  data num: [1275, 1131, 1552, 888, 809, 1750, 928, 1742, 1662, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.03864541832669323
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 74: Avg loss: 5.3101, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Avg loss: 5.5326, Accuracy: 0/9950 (0.0000%)
saving model
Done in 367.6426637172699 sec.
Server Epoch:75 choose agents : [89, 65, 75, 86, 4, 55, 82, 12, 21, 64].
___Train Local_ResNet_18, epoch  75, local model 89, internal_epoch   1, Avg loss: 0.0599, Accuracy: 336/896 (37.5000%)
___Train Local_ResNet_18, epoch  75, local model 89, internal_epoch   2, Avg loss: 0.0327, Accuracy: 453/896 (50.5580%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.2953, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0557, Accuracy: 391/1475 (26.5085%)
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0319, Accuracy: 694/1475 (47.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.0475, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 257/776 (33.1186%)
___Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 408/776 (52.5773%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.0417, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 86, internal_epoch   1, Avg loss: 0.0614, Accuracy: 365/1003 (36.3908%)
___Train Local_ResNet_18, epoch  75, local model 86, internal_epoch   2, Avg loss: 0.0342, Accuracy: 383/1003 (38.1854%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.7725, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   1, Avg loss: 0.0580, Accuracy: 332/901 (36.8479%)
___Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   2, Avg loss: 0.0343, Accuracy: 413/901 (45.8380%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.7838, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   1, Avg loss: 0.0550, Accuracy: 264/1071 (24.6499%)
___Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 481/1071 (44.9113%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.3864, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  75, local model 82, internal_epoch   1, Avg loss: 0.0756, Accuracy: 78/500 (15.6000%)
___Train Local_ResNet_18, epoch  75, local model 82, internal_epoch   2, Avg loss: 0.0477, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 5.6150, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   1, Avg loss: 0.0853, Accuracy: 27/338 (7.9882%)
___Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   2, Avg loss: 0.0470, Accuracy: 139/338 (41.1243%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 5.4548, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 386/1949 (19.8050%)
___Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 599/1949 (30.7337%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.3849, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 180/953 (18.8877%)
___Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0375, Accuracy: 317/953 (33.2634%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 6.5255, Accuracy: 68/10000 (0.6800%)
time spent on training: 241.6942057609558
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 1475, 776, 1003, 901, 1071, 500, 338, 1949, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 75: Avg loss: 5.3101, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Avg loss: 5.5302, Accuracy: 0/9950 (0.0000%)
saving model
Done in 329.08188676834106 sec.
Server Epoch:76 choose agents : [5, 72, 10, 55, 84, 39, 17, 89, 93, 35].
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0503, Accuracy: 410/1628 (25.1843%)
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 829/1628 (50.9214%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.4135, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   1, Avg loss: 0.0612, Accuracy: 259/1241 (20.8703%)
___Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 428/1241 (34.4883%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.0113, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 211/861 (24.5064%)
___Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 442/861 (51.3357%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.7445, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   1, Avg loss: 0.0545, Accuracy: 296/1071 (27.6377%)
___Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 509/1071 (47.5257%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.9174, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  76, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 321/1190 (26.9748%)
___Train Local_ResNet_18, epoch  76, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 426/1190 (35.7983%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 6.9685, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   1, Avg loss: 0.0534, Accuracy: 318/1013 (31.3919%)
___Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 517/1013 (51.0365%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.6562, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 408/1574 (25.9212%)
___Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 658/1574 (41.8043%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.3357, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  76, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 334/896 (37.2768%)
___Train Local_ResNet_18, epoch  76, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 440/896 (49.1071%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 6.2346, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 424/1742 (24.3398%)
___Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 686/1742 (39.3800%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.6846, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   1, Avg loss: 0.0859, Accuracy: 42/271 (15.4982%)
___Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   2, Avg loss: 0.0563, Accuracy: 96/271 (35.4244%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 5.3686, Accuracy: 44/10000 (0.4400%)
time spent on training: 242.37422394752502
[foolsgold agg] training data poison_ratio: 0.0  data num: [1628, 1241, 861, 1071, 1190, 1013, 1574, 896, 1742, 271]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 76: Avg loss: 5.3100, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Avg loss: 5.5304, Accuracy: 0/9950 (0.0000%)
saving model
Done in 327.62456941604614 sec.
Server Epoch:77 choose agents : [61, 17, 20, 31, 50, 90, 71, 60, 96, 28].
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1245, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1173, Accuracy: 8/85 (9.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.3040, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   1, Avg loss: 0.0505, Accuracy: 422/1574 (26.8107%)
___Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   2, Avg loss: 0.0271, Accuracy: 689/1574 (43.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.3002, Accuracy: 95/10000 (0.9500%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  77, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 345/807 (42.7509%)
___Train Local_ResNet_18, epoch  77, local model 20, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/807 (52.9120%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.6952, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   1, Avg loss: 0.0803, Accuracy: 67/460 (14.5652%)
___Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   2, Avg loss: 0.0380, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.8051, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   1, Avg loss: 0.0626, Accuracy: 163/809 (20.1483%)
___Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 369/809 (45.6119%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.3393, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  77, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 321/677 (47.4151%)
___Train Local_ResNet_18, epoch  77, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 440/677 (64.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.1937, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   1, Avg loss: 0.0629, Accuracy: 179/818 (21.8826%)
___Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   2, Avg loss: 0.0309, Accuracy: 347/818 (42.4205%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.2538, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 564/2227 (25.3256%)
___Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1014/2227 (45.5321%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.4921, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  77, local model 96, internal_epoch   1, Avg loss: 0.0780, Accuracy: 62/311 (19.9357%)
___Train Local_ResNet_18, epoch  77, local model 96, internal_epoch   2, Avg loss: 0.0538, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.3496, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 397/1581 (25.1107%)
___Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 598/1581 (37.8242%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.7230, Accuracy: 98/10000 (0.9800%)
time spent on training: 235.8364691734314
[foolsgold agg] training data poison_ratio: 0.08631939244839021  data num: [85, 1574, 807, 460, 809, 677, 818, 2227, 311, 1581]
[foolsgold agg] considering poison per batch poison_fraction: 0.02697481014012194
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.3100, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Avg loss: 5.5295, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.0607416629791 sec.
Server Epoch:78 choose agents : [1, 64, 48, 77, 0, 36, 26, 90, 18, 93].
___Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   1, Avg loss: 0.0569, Accuracy: 290/928 (31.2500%)
___Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   2, Avg loss: 0.0231, Accuracy: 555/928 (59.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.6027, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0636, Accuracy: 174/953 (18.2581%)
___Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 307/953 (32.2141%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.4961, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   1, Avg loss: 0.0703, Accuracy: 107/631 (16.9572%)
___Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 220/631 (34.8653%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.9181, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 77, internal_epoch   1, Avg loss: 0.0532, Accuracy: 324/1340 (24.1791%)
___Train Local_ResNet_18, epoch  78, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 558/1340 (41.6418%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.9218, Accuracy: 55/10000 (0.5500%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0583, Accuracy: 347/1657 (20.9415%)
___Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 527/1657 (31.8045%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.7258, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0861, Accuracy: 74/408 (18.1373%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0552, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.5282, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   1, Avg loss: 0.0545, Accuracy: 347/1446 (23.9972%)
___Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 512/1446 (35.4080%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.2047, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  78, local model 90, internal_epoch   1, Avg loss: 0.0581, Accuracy: 320/677 (47.2674%)
___Train Local_ResNet_18, epoch  78, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 431/677 (63.6632%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.1560, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0750, Accuracy: 120/530 (22.6415%)
___Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0379, Accuracy: 267/530 (50.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.1811, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 410/1742 (23.5362%)
___Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 721/1742 (41.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.9007, Accuracy: 84/10000 (0.8400%)
time spent on training: 267.13484621047974
[foolsgold agg] training data poison_ratio: 0.1606865787432118  data num: [928, 953, 631, 1340, 1657, 408, 1446, 677, 530, 1742]
[foolsgold agg] considering poison per batch poison_fraction: 0.050214555857253686
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.3099, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Avg loss: 5.5281, Accuracy: 0/9950 (0.0000%)
saving model
Done in 350.8970673084259 sec.
Server Epoch:79 choose agents : [70, 34, 15, 98, 97, 25, 53, 87, 18, 52].
___Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 375/1418 (26.4457%)
___Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 645/1418 (45.4866%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.8179, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   1, Avg loss: 0.0567, Accuracy: 393/1427 (27.5403%)
___Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 616/1427 (43.1675%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.8630, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   1, Avg loss: 0.0577, Accuracy: 331/1154 (28.6828%)
___Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   2, Avg loss: 0.0300, Accuracy: 388/1154 (33.6222%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.0086, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   1, Avg loss: 0.0810, Accuracy: 24/373 (6.4343%)
___Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   2, Avg loss: 0.0476, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 5.4630, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 97, internal_epoch   1, Avg loss: 0.0520, Accuracy: 369/1213 (30.4204%)
___Train Local_ResNet_18, epoch  79, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 517/1213 (42.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.0762, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   1, Avg loss: 0.0562, Accuracy: 310/690 (44.9275%)
___Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 455/690 (65.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.3279, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 280/813 (34.4403%)
___Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 440/813 (54.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.3105, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  79, local model 87, internal_epoch   1, Avg loss: 0.0572, Accuracy: 304/1131 (26.8789%)
___Train Local_ResNet_18, epoch  79, local model 87, internal_epoch   2, Avg loss: 0.0305, Accuracy: 470/1131 (41.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.8182, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0753, Accuracy: 120/530 (22.6415%)
___Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0372, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.2013, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 285/636 (44.8113%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0296, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.1657, Accuracy: 50/10000 (0.5000%)
time spent on training: 222.3045380115509
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 1427, 1154, 373, 1213, 690, 813, 1131, 530, 636]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 79: Avg loss: 5.3099, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Avg loss: 5.5288, Accuracy: 0/9950 (0.0000%)
saving model
Done in 309.0351345539093 sec.
Server Epoch:80 choose agents : [91, 47, 51, 92, 88, 78, 75, 61, 99, 77].
___Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0532, Accuracy: 336/1030 (32.6214%)
___Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0242, Accuracy: 656/1030 (63.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.3492, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   1, Avg loss: 0.1243, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   2, Avg loss: 0.1106, Accuracy: 13/134 (9.7015%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.3101, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   1, Avg loss: 0.0597, Accuracy: 238/1049 (22.6883%)
___Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   2, Avg loss: 0.0296, Accuracy: 507/1049 (48.3317%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.8159, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  80, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 448/1715 (26.1224%)
___Train Local_ResNet_18, epoch  80, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 708/1715 (41.2828%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.7107, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  80, local model 88, internal_epoch   1, Avg loss: 0.0739, Accuracy: 147/603 (24.3781%)
___Train Local_ResNet_18, epoch  80, local model 88, internal_epoch   2, Avg loss: 0.0448, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 6.0611, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 78, internal_epoch   1, Avg loss: 0.0821, Accuracy: 55/416 (13.2212%)
___Train Local_ResNet_18, epoch  80, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 180/416 (43.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.6078, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0621, Accuracy: 254/776 (32.7320%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 406/776 (52.3196%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 6.8159, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   1, Avg loss: 0.1259, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   2, Avg loss: 0.1188, Accuracy: 9/85 (10.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.3033, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  80, local model 99, internal_epoch   1, Avg loss: 0.0671, Accuracy: 192/773 (24.8383%)
___Train Local_ResNet_18, epoch  80, local model 99, internal_epoch   2, Avg loss: 0.0309, Accuracy: 366/773 (47.3480%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 6.8251, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 324/1340 (24.1791%)
___Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 507/1340 (37.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.7621, Accuracy: 54/10000 (0.5400%)
time spent on training: 240.9688856601715
[foolsgold agg] training data poison_ratio: 0.0  data num: [1030, 134, 1049, 1715, 603, 416, 776, 85, 773, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.3098, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Avg loss: 5.5290, Accuracy: 0/9950 (0.0000%)
saving model
Done in 329.1113040447235 sec.
Server Epoch:81 choose agents : [60, 93, 18, 24, 50, 98, 61, 91, 54, 15].
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 582/2227 (26.1338%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1050/2227 (47.1486%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.3377, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  81, local model 93, internal_epoch   1, Avg loss: 0.0544, Accuracy: 438/1742 (25.1435%)
___Train Local_ResNet_18, epoch  81, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 684/1742 (39.2652%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.9567, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0755, Accuracy: 119/530 (22.4528%)
___Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0374, Accuracy: 266/530 (50.1887%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 6.1891, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   1, Avg loss: 0.0750, Accuracy: 49/312 (15.7051%)
___Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   2, Avg loss: 0.0397, Accuracy: 165/312 (52.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.4005, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 171/809 (21.1372%)
___Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 346/809 (42.7689%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.2636, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  81, local model 98, internal_epoch   1, Avg loss: 0.0809, Accuracy: 28/373 (7.5067%)
___Train Local_ResNet_18, epoch  81, local model 98, internal_epoch   2, Avg loss: 0.0485, Accuracy: 153/373 (41.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.4572, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1250, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1135, Accuracy: 13/85 (15.2941%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.3037, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   1, Avg loss: 0.0510, Accuracy: 343/1030 (33.3010%)
___Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   2, Avg loss: 0.0243, Accuracy: 646/1030 (62.7184%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.5386, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 349/1130 (30.8850%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 463/1130 (40.9735%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.6052, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 340/1154 (29.4627%)
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0277, Accuracy: 451/1154 (39.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.0851, Accuracy: 50/10000 (0.5000%)
time spent on training: 230.90082502365112
[foolsgold agg] training data poison_ratio: 0.0  data num: [2227, 1742, 530, 312, 809, 373, 85, 1030, 1130, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.3098, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Avg loss: 5.5278, Accuracy: 0/9950 (0.0000%)
saving model
Done in 320.01349449157715 sec.
Server Epoch:82 choose agents : [59, 84, 37, 81, 61, 21, 47, 82, 13, 31].
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 322/1089 (29.5684%)
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 478/1089 (43.8935%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.0172, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  82, local model 84, internal_epoch   1, Avg loss: 0.0615, Accuracy: 324/1190 (27.2269%)
___Train Local_ResNet_18, epoch  82, local model 84, internal_epoch   2, Avg loss: 0.0312, Accuracy: 499/1190 (41.9328%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.0055, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   1, Avg loss: 0.0513, Accuracy: 451/1129 (39.9469%)
___Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   2, Avg loss: 0.0248, Accuracy: 753/1129 (66.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.4527, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   1, Avg loss: 0.0665, Accuracy: 243/774 (31.3953%)
___Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   2, Avg loss: 0.0355, Accuracy: 298/774 (38.5013%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 6.2742, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   1, Avg loss: 0.1244, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   2, Avg loss: 0.1151, Accuracy: 11/85 (12.9412%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.3036, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   1, Avg loss: 0.0532, Accuracy: 421/1949 (21.6008%)
___Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 653/1949 (33.5044%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.1766, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   1, Avg loss: 0.1216, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   2, Avg loss: 0.1082, Accuracy: 14/134 (10.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.3098, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   1, Avg loss: 0.0756, Accuracy: 82/500 (16.4000%)
___Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.7019, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   1, Avg loss: 0.0568, Accuracy: 342/1645 (20.7903%)
___Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   2, Avg loss: 0.0320, Accuracy: 668/1645 (40.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.7957, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   1, Avg loss: 0.0805, Accuracy: 66/460 (14.3478%)
___Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   2, Avg loss: 0.0360, Accuracy: 187/460 (40.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.7844, Accuracy: 50/10000 (0.5000%)
time spent on training: 224.72297739982605
[foolsgold agg] training data poison_ratio: 0.0  data num: [1089, 1190, 1129, 774, 85, 1949, 134, 500, 1645, 460]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.84811574 1.         1.         0.84811574]
___Test Target_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.3097, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Avg loss: 5.5282, Accuracy: 0/9950 (0.0000%)
saving model
Done in 311.76148223876953 sec.
Server Epoch:83 choose agents : [43, 65, 33, 2, 36, 57, 45, 76, 96, 80].
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 303/946 (32.0296%)
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 323/946 (34.1438%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.0454, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 398/1475 (26.9831%)
___Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0326, Accuracy: 640/1475 (43.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.1029, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.0766, Accuracy: 82/515 (15.9223%)
___Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0511, Accuracy: 128/515 (24.8544%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.7420, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   1, Avg loss: 0.0624, Accuracy: 234/605 (38.6777%)
___Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   2, Avg loss: 0.0404, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.8053, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   1, Avg loss: 0.0862, Accuracy: 84/408 (20.5882%)
___Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   2, Avg loss: 0.0552, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.4950, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   1, Avg loss: 0.0559, Accuracy: 309/1154 (26.7764%)
___Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   2, Avg loss: 0.0242, Accuracy: 541/1154 (46.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.4531, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   1, Avg loss: 0.0667, Accuracy: 205/669 (30.6428%)
___Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   2, Avg loss: 0.0412, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.8068, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   1, Avg loss: 0.0841, Accuracy: 51/466 (10.9442%)
___Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   2, Avg loss: 0.0477, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.6974, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 96, internal_epoch   1, Avg loss: 0.0780, Accuracy: 59/311 (18.9711%)
___Train Local_ResNet_18, epoch  83, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.3514, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 154/682 (22.5806%)
___Train Local_ResNet_18, epoch  83, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 254/682 (37.2434%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.4770, Accuracy: 53/10000 (0.5300%)
time spent on training: 191.84472012519836
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 1475, 515, 605, 408, 1154, 669, 466, 311, 682]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.3097, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Avg loss: 5.5276, Accuracy: 0/9950 (0.0000%)
saving model
Done in 277.2282328605652 sec.
Server Epoch:84 choose agents : [0, 26, 54, 61, 56, 29, 38, 45, 2, 15].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 374/1657 (22.5709%)
___Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 534/1657 (32.2269%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.5997, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   1, Avg loss: 0.0542, Accuracy: 348/1446 (24.0664%)
___Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 532/1446 (36.7911%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.3062, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 353/1130 (31.2389%)
___Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 457/1130 (40.4425%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.7469, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1244, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1173, Accuracy: 12/85 (14.1176%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.3036, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   1, Avg loss: 0.0822, Accuracy: 2/186 (1.0753%)
___Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   2, Avg loss: 0.0669, Accuracy: 76/186 (40.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.3110, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   1, Avg loss: 0.0488, Accuracy: 461/1440 (32.0139%)
___Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 687/1440 (47.7083%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.9651, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0611, Accuracy: 257/1131 (22.7233%)
___Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 460/1131 (40.6720%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.2977, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   1, Avg loss: 0.0662, Accuracy: 206/669 (30.7922%)
___Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   2, Avg loss: 0.0418, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.7651, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0626, Accuracy: 240/605 (39.6694%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0402, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.9335, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 346/1154 (29.9827%)
___Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   2, Avg loss: 0.0278, Accuracy: 509/1154 (44.1075%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.0600, Accuracy: 51/10000 (0.5100%)
time spent on training: 275.01199436187744
[foolsgold agg] training data poison_ratio: 0.1743659896874671  data num: [1657, 1446, 1130, 85, 186, 1440, 1131, 669, 605, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.05448937177733347
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.3097, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Avg loss: 5.5281, Accuracy: 0/9950 (0.0000%)
saving model
Done in 360.70849895477295 sec.
Server Epoch:85 choose agents : [84, 3, 86, 18, 98, 8, 89, 80, 23, 58].
___Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   1, Avg loss: 0.0616, Accuracy: 335/1190 (28.1513%)
___Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   2, Avg loss: 0.0314, Accuracy: 456/1190 (38.3193%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.0683, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   1, Avg loss: 0.0737, Accuracy: 115/781 (14.7247%)
___Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   2, Avg loss: 0.0370, Accuracy: 237/781 (30.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.7819, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  85, local model 86, internal_epoch   1, Avg loss: 0.0620, Accuracy: 368/1003 (36.6899%)
___Train Local_ResNet_18, epoch  85, local model 86, internal_epoch   2, Avg loss: 0.0340, Accuracy: 379/1003 (37.7866%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.6961, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0754, Accuracy: 123/530 (23.2075%)
___Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0376, Accuracy: 271/530 (51.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.2311, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  85, local model 98, internal_epoch   1, Avg loss: 0.0806, Accuracy: 28/373 (7.5067%)
___Train Local_ResNet_18, epoch  85, local model 98, internal_epoch   2, Avg loss: 0.0470, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.4410, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   1, Avg loss: 0.0596, Accuracy: 279/1513 (18.4402%)
___Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 487/1513 (32.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.1996, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  85, local model 89, internal_epoch   1, Avg loss: 0.0595, Accuracy: 343/896 (38.2812%)
___Train Local_ResNet_18, epoch  85, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 434/896 (48.4375%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.3573, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 142/682 (20.8211%)
___Train Local_ResNet_18, epoch  85, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 233/682 (34.1642%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.8388, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   1, Avg loss: 0.0603, Accuracy: 329/715 (46.0140%)
___Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   2, Avg loss: 0.0397, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.8478, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0579, Accuracy: 346/803 (43.0884%)
___Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0332, Accuracy: 418/803 (52.0548%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.0892, Accuracy: 58/10000 (0.5800%)
time spent on training: 256.71077489852905
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 781, 1003, 530, 373, 1513, 896, 682, 715, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.3096, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Avg loss: 5.5286, Accuracy: 0/9950 (0.0000%)
saving model
Done in 344.1125626564026 sec.
Server Epoch:86 choose agents : [57, 20, 60, 19, 35, 85, 82, 44, 41, 59].
___Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 311/1154 (26.9497%)
___Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   2, Avg loss: 0.0257, Accuracy: 475/1154 (41.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.3037, Accuracy: 83/10000 (0.8300%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  86, local model 20, internal_epoch   1, Avg loss: 0.0574, Accuracy: 346/807 (42.8748%)
___Train Local_ResNet_18, epoch  86, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 428/807 (53.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.0659, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 624/2227 (28.0198%)
___Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1049/2227 (47.1037%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.2087, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0477, Accuracy: 412/1036 (39.7683%)
___Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0246, Accuracy: 644/1036 (62.1622%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.2820, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   1, Avg loss: 0.0849, Accuracy: 43/271 (15.8672%)
___Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   2, Avg loss: 0.0551, Accuracy: 108/271 (39.8524%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 5.3770, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  86, local model 85, internal_epoch   1, Avg loss: 0.0528, Accuracy: 483/1988 (24.2958%)
___Train Local_ResNet_18, epoch  86, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 672/1988 (33.8028%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.1725, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  86, local model 82, internal_epoch   1, Avg loss: 0.0755, Accuracy: 81/500 (16.2000%)
___Train Local_ResNet_18, epoch  86, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 5.6698, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0582, Accuracy: 432/1750 (24.6857%)
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 673/1750 (38.4571%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.4869, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   1, Avg loss: 0.0610, Accuracy: 331/719 (46.0362%)
___Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   2, Avg loss: 0.0312, Accuracy: 412/719 (57.3018%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 6.3960, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0525, Accuracy: 305/1089 (28.0073%)
___Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0296, Accuracy: 485/1089 (44.5363%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.6174, Accuracy: 84/10000 (0.8400%)
time spent on training: 302.5910975933075
[foolsgold agg] training data poison_ratio: 0.06992461658435144  data num: [1154, 807, 2227, 1036, 271, 1988, 500, 1750, 719, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.021851442682609825
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 86: Avg loss: 5.3096, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Avg loss: 5.5277, Accuracy: 0/9950 (0.0000%)
saving model
Done in 392.27167987823486 sec.
Server Epoch:87 choose agents : [86, 29, 54, 69, 87, 45, 26, 47, 33, 57].
___Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0614, Accuracy: 370/1003 (36.8893%)
___Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0348, Accuracy: 353/1003 (35.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.9325, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   1, Avg loss: 0.0480, Accuracy: 435/1440 (30.2083%)
___Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 693/1440 (48.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.8575, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 349/1130 (30.8850%)
___Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 473/1130 (41.8584%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.7121, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0587, Accuracy: 295/590 (50.0000%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0300, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.6787, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 87, internal_epoch   1, Avg loss: 0.0570, Accuracy: 310/1131 (27.4094%)
___Train Local_ResNet_18, epoch  87, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 437/1131 (38.6384%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.2399, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   1, Avg loss: 0.0673, Accuracy: 203/669 (30.3438%)
___Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   2, Avg loss: 0.0409, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.8323, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 356/1446 (24.6196%)
___Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 498/1446 (34.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.4434, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1211, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1076, Accuracy: 24/134 (17.9104%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   1, Avg loss: 0.0779, Accuracy: 75/515 (14.5631%)
___Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   2, Avg loss: 0.0486, Accuracy: 124/515 (24.0777%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.7891, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0535, Accuracy: 307/1154 (26.6031%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0242, Accuracy: 566/1154 (49.0468%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.2581, Accuracy: 80/10000 (0.8000%)
time spent on training: 266.23455691337585
[foolsgold agg] training data poison_ratio: 0.0  data num: [1003, 1440, 1130, 590, 1131, 669, 1446, 134, 515, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Avg loss: 5.5282, Accuracy: 0/9950 (0.0000%)
saving model
Done in 352.96356987953186 sec.
Server Epoch:88 choose agents : [62, 83, 85, 18, 63, 67, 29, 37, 87, 80].
___Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0678, Accuracy: 159/568 (27.9930%)
___Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0395, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.7880, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 416/1953 (21.3006%)
___Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 731/1953 (37.4296%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.7863, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   1, Avg loss: 0.0533, Accuracy: 448/1988 (22.5352%)
___Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   2, Avg loss: 0.0359, Accuracy: 664/1988 (33.4004%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.0398, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0748, Accuracy: 124/530 (23.3962%)
___Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0380, Accuracy: 270/530 (50.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 6.1219, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   1, Avg loss: 0.0539, Accuracy: 269/888 (30.2928%)
___Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 409/888 (46.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.8075, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   1, Avg loss: 0.0774, Accuracy: 59/426 (13.8498%)
___Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   2, Avg loss: 0.0410, Accuracy: 173/426 (40.6103%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.5983, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 432/1440 (30.0000%)
___Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   2, Avg loss: 0.0271, Accuracy: 694/1440 (48.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.2254, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   1, Avg loss: 0.0516, Accuracy: 453/1129 (40.1240%)
___Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 724/1129 (64.1275%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.5100, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   1, Avg loss: 0.0574, Accuracy: 306/1131 (27.0557%)
___Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   2, Avg loss: 0.0318, Accuracy: 421/1131 (37.2237%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.7852, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  88, local model 80, internal_epoch   1, Avg loss: 0.0690, Accuracy: 155/682 (22.7273%)
___Train Local_ResNet_18, epoch  88, local model 80, internal_epoch   2, Avg loss: 0.0386, Accuracy: 247/682 (36.2170%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 6.5558, Accuracy: 50/10000 (0.5000%)
time spent on training: 286.015750169754
[foolsgold agg] training data poison_ratio: 0.0  data num: [568, 1953, 1988, 530, 888, 426, 1440, 1129, 1131, 682]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.97207266 1.         0.97207266
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Avg loss: 5.5288, Accuracy: 0/9950 (0.0000%)
saving model
Done in 376.60444045066833 sec.
Server Epoch:89 choose agents : [43, 48, 27, 5, 45, 67, 97, 23, 39, 16].
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 306/946 (32.3467%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 350/946 (36.9979%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 6.0578, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   1, Avg loss: 0.0707, Accuracy: 103/631 (16.3233%)
___Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 223/631 (35.3407%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.9429, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 452/1587 (28.4814%)
___Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 627/1587 (39.5085%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.5956, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   1, Avg loss: 0.0504, Accuracy: 410/1628 (25.1843%)
___Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   2, Avg loss: 0.0251, Accuracy: 840/1628 (51.5971%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.1743, Accuracy: 134/10000 (1.3400%)
___Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   1, Avg loss: 0.0665, Accuracy: 209/669 (31.2407%)
___Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   2, Avg loss: 0.0411, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.8983, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0773, Accuracy: 64/426 (15.0235%)
___Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0417, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.5696, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  89, local model 97, internal_epoch   1, Avg loss: 0.0517, Accuracy: 369/1213 (30.4204%)
___Train Local_ResNet_18, epoch  89, local model 97, internal_epoch   2, Avg loss: 0.0278, Accuracy: 468/1213 (38.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.8637, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   1, Avg loss: 0.0599, Accuracy: 322/715 (45.0350%)
___Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   2, Avg loss: 0.0401, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.8175, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0526, Accuracy: 323/1013 (31.8855%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0253, Accuracy: 529/1013 (52.2211%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.6882, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   1, Avg loss: 0.0626, Accuracy: 287/708 (40.5367%)
___Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   2, Avg loss: 0.0374, Accuracy: 428/708 (60.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.9064, Accuracy: 53/10000 (0.5300%)
time spent on training: 260.2838258743286
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 631, 1587, 1628, 669, 426, 1213, 715, 1013, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Avg loss: 5.5294, Accuracy: 0/9950 (0.0000%)
saving model
Done in 346.4548408985138 sec.
Server Epoch:90 choose agents : [25, 41, 39, 40, 34, 77, 29, 71, 8, 53].
___Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   1, Avg loss: 0.0560, Accuracy: 313/690 (45.3623%)
___Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 455/690 (65.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 6.7207, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0602, Accuracy: 343/719 (47.7051%)
___Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0308, Accuracy: 456/719 (63.4214%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 6.4523, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0533, Accuracy: 320/1013 (31.5893%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0253, Accuracy: 519/1013 (51.2340%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.6732, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0544, Accuracy: 369/1573 (23.4584%)
___Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 588/1573 (37.3808%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.6244, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   1, Avg loss: 0.0570, Accuracy: 387/1427 (27.1198%)
___Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 590/1427 (41.3455%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 6.9489, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  90, local model 77, internal_epoch   1, Avg loss: 0.0531, Accuracy: 332/1340 (24.7761%)
___Train Local_ResNet_18, epoch  90, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 580/1340 (43.2836%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.9087, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 451/1440 (31.3194%)
___Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   2, Avg loss: 0.0271, Accuracy: 694/1440 (48.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.1853, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0635, Accuracy: 168/818 (20.5379%)
___Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 357/818 (43.6430%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.2009, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 244/1513 (16.1269%)
___Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 492/1513 (32.5182%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.5442, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0486, Accuracy: 293/813 (36.0394%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 458/813 (56.3346%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.5303, Accuracy: 52/10000 (0.5200%)
time spent on training: 302.0051727294922
[foolsgold agg] training data poison_ratio: 0.0  data num: [690, 719, 1013, 1573, 1427, 1340, 1440, 818, 1513, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.3095, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Avg loss: 5.5294, Accuracy: 0/9950 (0.0000%)
saving model
Done in 391.8327331542969 sec.
Server Epoch:91 choose agents : [36, 34, 71, 11, 72, 91, 63, 3, 50, 24].
___Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.0866, Accuracy: 76/408 (18.6275%)
___Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0535, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.5062, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0567, Accuracy: 400/1427 (28.0308%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 585/1427 (40.9951%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.0370, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0626, Accuracy: 171/818 (20.9046%)
___Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0300, Accuracy: 329/818 (40.2200%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.0571, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   1, Avg loss: 0.0544, Accuracy: 350/712 (49.1573%)
___Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   2, Avg loss: 0.0256, Accuracy: 419/712 (58.8483%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.7129, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 255/1241 (20.5479%)
___Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 384/1241 (30.9428%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.3366, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  91, local model 91, internal_epoch   1, Avg loss: 0.0517, Accuracy: 352/1030 (34.1748%)
___Train Local_ResNet_18, epoch  91, local model 91, internal_epoch   2, Avg loss: 0.0251, Accuracy: 658/1030 (63.8835%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.3351, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   1, Avg loss: 0.0536, Accuracy: 274/888 (30.8559%)
___Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 409/888 (46.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.4211, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   1, Avg loss: 0.0733, Accuracy: 119/781 (15.2369%)
___Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   2, Avg loss: 0.0359, Accuracy: 242/781 (30.9859%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.7565, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   1, Avg loss: 0.0624, Accuracy: 160/809 (19.7775%)
___Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   2, Avg loss: 0.0267, Accuracy: 377/809 (46.6007%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.2918, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0748, Accuracy: 52/312 (16.6667%)
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0392, Accuracy: 165/312 (52.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.4003, Accuracy: 50/10000 (0.5000%)
time spent on training: 230.49078464508057
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 1427, 818, 712, 1241, 1030, 888, 781, 809, 312]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.3094, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Avg loss: 5.5295, Accuracy: 0/9950 (0.0000%)
saving model
Done in 318.41587138175964 sec.
Server Epoch:92 choose agents : [92, 90, 77, 1, 58, 42, 96, 14, 29, 30].
___Train Local_ResNet_18, epoch  92, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 463/1715 (26.9971%)
___Train Local_ResNet_18, epoch  92, local model 92, internal_epoch   2, Avg loss: 0.0313, Accuracy: 684/1715 (39.8834%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.5815, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   1, Avg loss: 0.0565, Accuracy: 328/677 (48.4490%)
___Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 450/677 (66.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.3705, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   1, Avg loss: 0.0529, Accuracy: 330/1340 (24.6269%)
___Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 574/1340 (42.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.0136, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   1, Avg loss: 0.0560, Accuracy: 295/928 (31.7888%)
___Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 576/928 (62.0690%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.8746, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 344/803 (42.8394%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 417/803 (51.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 6.1433, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 333/1372 (24.2711%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 505/1372 (36.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.8136, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 54/311 (17.3633%)
___Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   2, Avg loss: 0.0521, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 5.3493, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   1, Avg loss: 0.0608, Accuracy: 237/1013 (23.3959%)
___Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 373/1013 (36.8213%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 6.7986, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 425/1440 (29.5139%)
___Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0274, Accuracy: 688/1440 (47.7778%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.8365, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   1, Avg loss: 0.0783, Accuracy: 92/486 (18.9300%)
___Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   2, Avg loss: 0.0399, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 5.7848, Accuracy: 48/10000 (0.4800%)
time spent on training: 274.2783217430115
[foolsgold agg] training data poison_ratio: 0.0  data num: [1715, 677, 1340, 928, 803, 1372, 311, 1013, 1440, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 92: Avg loss: 5.3093, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Avg loss: 5.5300, Accuracy: 0/9950 (0.0000%)
saving model
Done in 362.4518311023712 sec.
Server Epoch:93 choose agents : [76, 7, 35, 2, 94, 15, 46, 67, 55, 73].
___Train Local_ResNet_18, epoch  93, local model 76, internal_epoch   1, Avg loss: 0.0835, Accuracy: 55/466 (11.8026%)
___Train Local_ResNet_18, epoch  93, local model 76, internal_epoch   2, Avg loss: 0.0478, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.7029, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   1, Avg loss: 0.0527, Accuracy: 357/891 (40.0673%)
___Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 446/891 (50.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.1959, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   1, Avg loss: 0.0866, Accuracy: 39/271 (14.3911%)
___Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   2, Avg loss: 0.0549, Accuracy: 99/271 (36.5314%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.3678, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   1, Avg loss: 0.0635, Accuracy: 227/605 (37.5207%)
___Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.8094, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 355/1662 (21.3598%)
___Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   2, Avg loss: 0.0323, Accuracy: 643/1662 (38.6883%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.8429, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0560, Accuracy: 333/1154 (28.8562%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0276, Accuracy: 526/1154 (45.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.0854, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   1, Avg loss: 0.0546, Accuracy: 435/1904 (22.8466%)
___Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   2, Avg loss: 0.0308, Accuracy: 712/1904 (37.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.8118, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   1, Avg loss: 0.0775, Accuracy: 61/426 (14.3192%)
___Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   2, Avg loss: 0.0415, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.6285, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   1, Avg loss: 0.0553, Accuracy: 260/1071 (24.2764%)
___Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 513/1071 (47.8992%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.3948, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   1, Avg loss: 0.0646, Accuracy: 176/938 (18.7633%)
___Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   2, Avg loss: 0.0329, Accuracy: 353/938 (37.6333%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.1557, Accuracy: 51/10000 (0.5100%)
time spent on training: 265.72203612327576
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 891, 271, 605, 1662, 1154, 1904, 426, 1071, 938]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.3093, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Avg loss: 5.5289, Accuracy: 0/9950 (0.0000%)
saving model
Done in 354.4735336303711 sec.
Server Epoch:94 choose agents : [54, 23, 97, 0, 28, 52, 48, 24, 5, 3].
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0542, Accuracy: 360/1130 (31.8584%)
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 482/1130 (42.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.7020, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0599, Accuracy: 327/715 (45.7343%)
___Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0397, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.8261, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   1, Avg loss: 0.0516, Accuracy: 367/1213 (30.2556%)
___Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   2, Avg loss: 0.0268, Accuracy: 549/1213 (45.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.7212, Accuracy: 66/10000 (0.6600%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  94, local model 0, internal_epoch   1, Avg loss: 0.0583, Accuracy: 347/1657 (20.9415%)
___Train Local_ResNet_18, epoch  94, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 503/1657 (30.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.7508, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   1, Avg loss: 0.0550, Accuracy: 419/1581 (26.5022%)
___Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   2, Avg loss: 0.0330, Accuracy: 641/1581 (40.5440%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.8660, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   1, Avg loss: 0.0557, Accuracy: 286/636 (44.9686%)
___Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   2, Avg loss: 0.0310, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 6.2692, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 100/631 (15.8479%)
___Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   2, Avg loss: 0.0403, Accuracy: 237/631 (37.5594%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.9709, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   1, Avg loss: 0.0747, Accuracy: 51/312 (16.3462%)
___Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   2, Avg loss: 0.0393, Accuracy: 162/312 (51.9231%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.3982, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0499, Accuracy: 387/1628 (23.7715%)
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0253, Accuracy: 842/1628 (51.7199%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.2946, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0730, Accuracy: 118/781 (15.1088%)
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 254/781 (32.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 6.8642, Accuracy: 63/10000 (0.6300%)
time spent on training: 276.8583869934082
[foolsgold agg] training data poison_ratio: 0.16112407623492805  data num: [1130, 715, 1213, 1657, 1581, 636, 631, 312, 1628, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.05035127382341502
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.3093, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Avg loss: 5.5297, Accuracy: 0/9950 (0.0000%)
saving model
Done in 363.081782579422 sec.
Server Epoch:95 choose agents : [80, 4, 1, 10, 41, 2, 58, 11, 29, 78].
___Train Local_ResNet_18, epoch  95, local model 80, internal_epoch   1, Avg loss: 0.0690, Accuracy: 148/682 (21.7009%)
___Train Local_ResNet_18, epoch  95, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 249/682 (36.5103%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 6.4004, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   1, Avg loss: 0.0616, Accuracy: 332/901 (36.8479%)
___Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   2, Avg loss: 0.0335, Accuracy: 388/901 (43.0633%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 6.7711, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0554, Accuracy: 299/928 (32.2198%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 575/928 (61.9612%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.5586, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0571, Accuracy: 213/861 (24.7387%)
___Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 456/861 (52.9617%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.0056, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   1, Avg loss: 0.0588, Accuracy: 335/719 (46.5925%)
___Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   2, Avg loss: 0.0314, Accuracy: 467/719 (64.9513%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 6.3760, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   1, Avg loss: 0.0631, Accuracy: 243/605 (40.1653%)
___Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   2, Avg loss: 0.0384, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.8896, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0567, Accuracy: 346/803 (43.0884%)
___Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 409/803 (50.9340%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 6.1575, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   1, Avg loss: 0.0533, Accuracy: 356/712 (50.0000%)
___Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 431/712 (60.5337%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 6.6293, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0481, Accuracy: 442/1440 (30.6944%)
___Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0275, Accuracy: 677/1440 (47.0139%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.8432, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   1, Avg loss: 0.0818, Accuracy: 41/416 (9.8558%)
___Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   2, Avg loss: 0.0448, Accuracy: 190/416 (45.6731%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.6004, Accuracy: 51/10000 (0.5100%)
time spent on training: 247.59332871437073
[foolsgold agg] training data poison_ratio: 0.0  data num: [682, 901, 928, 861, 719, 605, 803, 712, 1440, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.3092, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Avg loss: 5.5301, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.401398897171 sec.
Server Epoch:96 choose agents : [78, 9, 2, 30, 42, 95, 61, 3, 15, 6].
___Train Local_ResNet_18, epoch  96, local model 78, internal_epoch   1, Avg loss: 0.0821, Accuracy: 46/416 (11.0577%)
___Train Local_ResNet_18, epoch  96, local model 78, internal_epoch   2, Avg loss: 0.0457, Accuracy: 186/416 (44.7115%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.6041, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0481, Accuracy: 362/1275 (28.3922%)
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0189, Accuracy: 738/1275 (57.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.7821, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 243/605 (40.1653%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0404, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.9228, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   1, Avg loss: 0.0783, Accuracy: 87/486 (17.9012%)
___Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   2, Avg loss: 0.0423, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.9932, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 344/1372 (25.0729%)
___Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 461/1372 (33.6006%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.9020, Accuracy: 85/10000 (0.8500%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  96, local model 95, internal_epoch   1, Avg loss: 0.0513, Accuracy: 340/599 (56.7613%)
___Train Local_ResNet_18, epoch  96, local model 95, internal_epoch   2, Avg loss: 0.0296, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.9603, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   1, Avg loss: 0.1250, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   2, Avg loss: 0.1160, Accuracy: 8/85 (9.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.3034, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0734, Accuracy: 122/781 (15.6210%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0353, Accuracy: 226/781 (28.9373%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.0520, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   1, Avg loss: 0.0544, Accuracy: 338/1154 (29.2894%)
___Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   2, Avg loss: 0.0275, Accuracy: 515/1154 (44.6274%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.0432, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0541, Accuracy: 397/1956 (20.2965%)
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 661/1956 (33.7935%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.2002, Accuracy: 118/10000 (1.1800%)
time spent on training: 273.67313599586487
[foolsgold agg] training data poison_ratio: 0.06862183526177111  data num: [416, 1275, 605, 486, 1372, 599, 85, 781, 1154, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.021444323519303473
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.3092, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Avg loss: 5.5306, Accuracy: 0/9950 (0.0000%)
saving model
Done in 361.39631724357605 sec.
Server Epoch:97 choose agents : [38, 36, 84, 75, 85, 8, 27, 41, 26, 54].
___Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   1, Avg loss: 0.0609, Accuracy: 259/1131 (22.9001%)
___Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   2, Avg loss: 0.0298, Accuracy: 519/1131 (45.8886%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.5788, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   1, Avg loss: 0.0855, Accuracy: 81/408 (19.8529%)
___Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   2, Avg loss: 0.0529, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.5558, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 328/1190 (27.5630%)
___Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 447/1190 (37.5630%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.0795, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  97, local model 75, internal_epoch   1, Avg loss: 0.0645, Accuracy: 261/776 (33.6340%)
___Train Local_ResNet_18, epoch  97, local model 75, internal_epoch   2, Avg loss: 0.0296, Accuracy: 401/776 (51.6753%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.0126, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   1, Avg loss: 0.0534, Accuracy: 452/1988 (22.7364%)
___Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   2, Avg loss: 0.0348, Accuracy: 698/1988 (35.1107%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.9906, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   1, Avg loss: 0.0595, Accuracy: 250/1513 (16.5235%)
___Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   2, Avg loss: 0.0357, Accuracy: 500/1513 (33.0469%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.2917, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   1, Avg loss: 0.0530, Accuracy: 442/1587 (27.8513%)
___Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 613/1587 (38.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.2424, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0601, Accuracy: 338/719 (47.0097%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0314, Accuracy: 445/719 (61.8915%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 6.3695, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 337/1446 (23.3057%)
___Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 504/1446 (34.8548%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.4096, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   1, Avg loss: 0.0538, Accuracy: 344/1130 (30.4425%)
___Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 484/1130 (42.8319%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.7134, Accuracy: 50/10000 (0.5000%)
time spent on training: 297.3597996234894
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 408, 1190, 776, 1988, 1513, 1587, 719, 1446, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.3092, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Avg loss: 5.5313, Accuracy: 0/9950 (0.0000%)
saving model
Done in 384.6665744781494 sec.
Server Epoch:98 choose agents : [70, 56, 62, 90, 72, 16, 25, 33, 22, 57].
___Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 371/1418 (26.1636%)
___Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 671/1418 (47.3202%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.4616, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0821, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0665, Accuracy: 85/186 (45.6989%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.3108, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0682, Accuracy: 151/568 (26.5845%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0397, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.7679, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  98, local model 90, internal_epoch   1, Avg loss: 0.0567, Accuracy: 326/677 (48.1536%)
___Train Local_ResNet_18, epoch  98, local model 90, internal_epoch   2, Avg loss: 0.0237, Accuracy: 437/677 (64.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.5958, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 237/1241 (19.0975%)
___Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 449/1241 (36.1805%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.1990, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0599, Accuracy: 290/708 (40.9605%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0367, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.9014, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 310/690 (44.9275%)
___Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 6.6365, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   1, Avg loss: 0.0771, Accuracy: 74/515 (14.3689%)
___Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   2, Avg loss: 0.0490, Accuracy: 122/515 (23.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.8135, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   1, Avg loss: 0.0448, Accuracy: 529/1470 (35.9864%)
___Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 825/1470 (56.1224%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.1493, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   1, Avg loss: 0.0534, Accuracy: 306/1154 (26.5165%)
___Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   2, Avg loss: 0.0248, Accuracy: 546/1154 (47.3137%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.4168, Accuracy: 61/10000 (0.6100%)
time spent on training: 257.22539830207825
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 186, 568, 677, 1241, 708, 690, 515, 1470, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.3091, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Avg loss: 5.5316, Accuracy: 0/9950 (0.0000%)
saving model
Done in 346.5564053058624 sec.
Server Epoch:99 choose agents : [24, 49, 35, 66, 25, 82, 38, 62, 93, 79].
___Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.0746, Accuracy: 50/312 (16.0256%)
___Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0390, Accuracy: 161/312 (51.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.4011, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   1, Avg loss: 0.0780, Accuracy: 55/440 (12.5000%)
___Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   2, Avg loss: 0.0468, Accuracy: 146/440 (33.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.5470, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 41/271 (15.1292%)
___Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0560, Accuracy: 108/271 (39.8524%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.3733, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0618, Accuracy: 255/1402 (18.1883%)
___Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0379, Accuracy: 431/1402 (30.7418%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.2224, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   1, Avg loss: 0.0567, Accuracy: 315/690 (45.6522%)
___Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   2, Avg loss: 0.0276, Accuracy: 461/690 (66.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 6.5317, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1, Avg loss: 0.0751, Accuracy: 79/500 (15.8000%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 172/500 (34.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.7098, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   1, Avg loss: 0.0605, Accuracy: 259/1131 (22.9001%)
___Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   2, Avg loss: 0.0299, Accuracy: 496/1131 (43.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.2150, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   1, Avg loss: 0.0675, Accuracy: 155/568 (27.2887%)
___Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   2, Avg loss: 0.0402, Accuracy: 263/568 (46.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.7613, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  99, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 430/1742 (24.6843%)
___Train Local_ResNet_18, epoch  99, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 717/1742 (41.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.3417, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  99, local model 79, internal_epoch   1, Avg loss: 0.1020, Accuracy: 14/197 (7.1066%)
___Train Local_ResNet_18, epoch  99, local model 79, internal_epoch   2, Avg loss: 0.0839, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.3200, Accuracy: 50/10000 (0.5000%)
time spent on training: 225.88112378120422
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 440, 271, 1402, 690, 500, 1131, 568, 1742, 197]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.99581371 0.99581371 1.         1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.3091, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Avg loss: 5.5319, Accuracy: 0/9950 (0.0000%)
saving model
Done in 311.70413541793823 sec.
Server Epoch:100 choose agents : [47, 65, 86, 24, 39, 5, 1, 53, 88, 58].
___Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   1, Avg loss: 0.1224, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   2, Avg loss: 0.1095, Accuracy: 23/134 (17.1642%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.3095, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   1, Avg loss: 0.0539, Accuracy: 410/1475 (27.7966%)
___Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   2, Avg loss: 0.0316, Accuracy: 698/1475 (47.3220%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.9817, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0614, Accuracy: 360/1003 (35.8923%)
___Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0346, Accuracy: 367/1003 (36.5902%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.8953, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   1, Avg loss: 0.0744, Accuracy: 55/312 (17.6282%)
___Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   2, Avg loss: 0.0401, Accuracy: 168/312 (53.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.4057, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0526, Accuracy: 318/1013 (31.3919%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 503/1013 (49.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.8271, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   1, Avg loss: 0.0504, Accuracy: 390/1628 (23.9558%)
___Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 807/1628 (49.5700%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.5253, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   1, Avg loss: 0.0562, Accuracy: 299/928 (32.2198%)
___Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   2, Avg loss: 0.0231, Accuracy: 603/928 (64.9784%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.6716, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0485, Accuracy: 296/813 (36.4084%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 469/813 (57.6876%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.8476, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch 100, local model 88, internal_epoch   1, Avg loss: 0.0738, Accuracy: 144/603 (23.8806%)
___Train Local_ResNet_18, epoch 100, local model 88, internal_epoch   2, Avg loss: 0.0460, Accuracy: 280/603 (46.4345%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.9653, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0568, Accuracy: 350/803 (43.5866%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0335, Accuracy: 418/803 (52.0548%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.0838, Accuracy: 49/10000 (0.4900%)
time spent on training: 275.04129362106323
[foolsgold agg] training data poison_ratio: 0.0  data num: [134, 1475, 1003, 312, 1013, 1628, 928, 813, 603, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.3090, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Avg loss: 5.5308, Accuracy: 0/9950 (0.0000%)
saving model
Done in 359.3027198314667 sec.
Saving all the graphs.
This run has a label: Jun.16_12.15.01. Visdom environment: tiny
