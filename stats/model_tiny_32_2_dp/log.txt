current path: saved_models/model_tiny_Jun.17_15.15.44
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 3, 5, 9, 10, 12, 15, 18, 20, 24, 25, 30, 33, 36, 37, 42, 44, 48, 49, 54, 55, 60, 61, 65, 69, 72, 74, 78, 81, 84, 85, 95]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [37, 44, 94, 74, 82, 83, 41, 65, 26, 24].
poison local model 37 index 14 
___Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   1, Avg loss: 0.0529, Accuracy: 389/1129 (34.4553%)
___Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   2, Avg loss: 0.0250, Accuracy: 722/1129 (63.9504%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.3477, Accuracy: 101/10000 (1.0100%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0597, Accuracy: 381/1750 (21.7714%)
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 666/1750 (38.0571%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.5129, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 342/1662 (20.5776%)
___Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 580/1662 (34.8977%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.6833, Accuracy: 116/10000 (1.1600%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 518/1552 (33.3763%)
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 754/1552 (48.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 10.2017, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 53/500 (10.6000%)
___Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   2, Avg loss: 0.0493, Accuracy: 170/500 (34.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.5997, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0548, Accuracy: 399/1953 (20.4301%)
___Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 765/1953 (39.1705%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 8.0260, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   1, Avg loss: 0.0630, Accuracy: 318/719 (44.2281%)
___Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   2, Avg loss: 0.0306, Accuracy: 441/719 (61.3352%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.2036, Accuracy: 47/10000 (0.4700%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0573, Accuracy: 382/1475 (25.8983%)
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0303, Accuracy: 736/1475 (49.8983%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.7945, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 321/1446 (22.1992%)
___Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 492/1446 (34.0249%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.2850, Accuracy: 67/10000 (0.6700%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 28/312 (8.9744%)
___Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 168/312 (53.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3889, Accuracy: 50/10000 (0.5000%)
time spent on training: 200.11975836753845
___Test Target_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3078, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 1: Avg loss: 5.3782, Accuracy: 0/9950 (0.0000%)
saving model
Done in 638.130744934082 sec.
Server Epoch:2 choose agents : [94, 71, 66, 35, 38, 84, 42, 43, 11, 95].
___Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   1, Avg loss: 0.0546, Accuracy: 339/1662 (20.3971%)
___Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 596/1662 (35.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.7455, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   1, Avg loss: 0.0669, Accuracy: 144/818 (17.6039%)
___Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   2, Avg loss: 0.0313, Accuracy: 353/818 (43.1540%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.8073, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   1, Avg loss: 0.0628, Accuracy: 241/1402 (17.1897%)
___Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   2, Avg loss: 0.0391, Accuracy: 347/1402 (24.7504%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.2095, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   1, Avg loss: 0.0880, Accuracy: 28/271 (10.3321%)
___Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   2, Avg loss: 0.0594, Accuracy: 97/271 (35.7934%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3872, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   1, Avg loss: 0.0633, Accuracy: 228/1131 (20.1592%)
___Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 494/1131 (43.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.2321, Accuracy: 78/10000 (0.7800%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0642, Accuracy: 309/1190 (25.9664%)
___Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 469/1190 (39.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.5649, Accuracy: 53/10000 (0.5300%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 335/1372 (24.4169%)
___Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 473/1372 (34.4752%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.6567, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 299/946 (31.6068%)
___Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 342/946 (36.1522%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.0774, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   1, Avg loss: 0.0571, Accuracy: 303/712 (42.5562%)
___Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   2, Avg loss: 0.0290, Accuracy: 437/712 (61.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.6927, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   1, Avg loss: 0.0543, Accuracy: 295/599 (49.2487%)
___Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   2, Avg loss: 0.0308, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 8.1354, Accuracy: 50/10000 (0.5000%)
time spent on training: 163.84249639511108
___Test Target_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3213, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 2: Avg loss: 5.3896, Accuracy: 0/9950 (0.0000%)
saving model
Done in 606.1678605079651 sec.
Server Epoch:3 choose agents : [15, 88, 13, 42, 72, 22, 6, 0, 69, 17].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0581, Accuracy: 325/1154 (28.1629%)
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0306, Accuracy: 412/1154 (35.7019%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.8616, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   1, Avg loss: 0.0768, Accuracy: 121/603 (20.0663%)
___Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 289/603 (47.9270%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.0669, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0592, Accuracy: 298/1645 (18.1155%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0338, Accuracy: 601/1645 (36.5350%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.0623, Accuracy: 97/10000 (0.9700%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   1, Avg loss: 0.0538, Accuracy: 312/1372 (22.7405%)
___Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 482/1372 (35.1312%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.7719, Accuracy: 72/10000 (0.7200%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   1, Avg loss: 0.0606, Accuracy: 259/1241 (20.8703%)
___Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 416/1241 (33.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.3006, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   1, Avg loss: 0.0462, Accuracy: 504/1470 (34.2857%)
___Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 808/1470 (54.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.9380, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   1, Avg loss: 0.0564, Accuracy: 376/1956 (19.2229%)
___Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 646/1956 (33.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.3471, Accuracy: 97/10000 (0.9700%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0585, Accuracy: 356/1657 (21.4846%)
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0355, Accuracy: 477/1657 (28.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.7408, Accuracy: 60/10000 (0.6000%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0545, Accuracy: 280/590 (47.4576%)
___Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.3122, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0520, Accuracy: 383/1574 (24.3329%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0287, Accuracy: 628/1574 (39.8983%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.0183, Accuracy: 101/10000 (1.0100%)
time spent on training: 279.7905309200287
___Test Target_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3269, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 3: Avg loss: 5.3888, Accuracy: 0/9950 (0.0000%)
saving model
Done in 736.3293259143829 sec.
Server Epoch:4 choose agents : [31, 94, 47, 15, 11, 35, 62, 77, 21, 93].
___Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0802, Accuracy: 58/460 (12.6087%)
___Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0373, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.2239, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 359/1662 (21.6005%)
___Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 623/1662 (37.4850%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.9591, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   1, Avg loss: 0.1272, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   2, Avg loss: 0.1118, Accuracy: 3/134 (2.2388%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3524, Accuracy: 48/10000 (0.4800%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   1, Avg loss: 0.0571, Accuracy: 317/1154 (27.4697%)
___Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   2, Avg loss: 0.0315, Accuracy: 439/1154 (38.0416%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.8895, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   1, Avg loss: 0.0560, Accuracy: 297/712 (41.7135%)
___Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   2, Avg loss: 0.0279, Accuracy: 402/712 (56.4607%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.1516, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   1, Avg loss: 0.0853, Accuracy: 28/271 (10.3321%)
___Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   2, Avg loss: 0.0560, Accuracy: 100/271 (36.9004%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.4543, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0725, Accuracy: 98/568 (17.2535%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0422, Accuracy: 262/568 (46.1268%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.9214, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0536, Accuracy: 348/1340 (25.9701%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 539/1340 (40.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.8593, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0544, Accuracy: 391/1949 (20.0616%)
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0335, Accuracy: 633/1949 (32.4782%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.1887, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   1, Avg loss: 0.0584, Accuracy: 366/1742 (21.0103%)
___Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   2, Avg loss: 0.0324, Accuracy: 697/1742 (40.0115%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.6140, Accuracy: 73/10000 (0.7300%)
time spent on training: 179.60789322853088
___Test Target_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3678, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 4: Avg loss: 5.4913, Accuracy: 0/9950 (0.0000%)
saving model
Done in 645.4952480792999 sec.
Server Epoch:5 choose agents : [91, 78, 82, 2, 77, 31, 70, 65, 60, 36].
___Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0503, Accuracy: 333/1030 (32.3301%)
___Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0255, Accuracy: 614/1030 (59.6117%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.6232, Accuracy: 82/10000 (0.8200%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   1, Avg loss: 0.0818, Accuracy: 31/416 (7.4519%)
___Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   2, Avg loss: 0.0470, Accuracy: 167/416 (40.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.9492, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0751, Accuracy: 68/500 (13.6000%)
___Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 183/500 (36.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.1799, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0630, Accuracy: 210/605 (34.7107%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 328/605 (54.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.1969, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   1, Avg loss: 0.0530, Accuracy: 339/1340 (25.2985%)
___Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   2, Avg loss: 0.0265, Accuracy: 580/1340 (43.2836%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.8594, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   1, Avg loss: 0.0790, Accuracy: 50/460 (10.8696%)
___Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   2, Avg loss: 0.0353, Accuracy: 192/460 (41.7391%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.5301, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   1, Avg loss: 0.0574, Accuracy: 318/1418 (22.4260%)
___Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   2, Avg loss: 0.0318, Accuracy: 666/1418 (46.9676%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.1607, Accuracy: 87/10000 (0.8700%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   1, Avg loss: 0.0605, Accuracy: 348/1475 (23.5932%)
___Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   2, Avg loss: 0.0325, Accuracy: 660/1475 (44.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.0831, Accuracy: 83/10000 (0.8300%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   1, Avg loss: 0.0508, Accuracy: 564/2227 (25.3256%)
___Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   2, Avg loss: 0.0285, Accuracy: 996/2227 (44.7238%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.6739, Accuracy: 119/10000 (1.1900%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   1, Avg loss: 0.0941, Accuracy: 26/408 (6.3725%)
___Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   2, Avg loss: 0.0578, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.8020, Accuracy: 50/10000 (0.5000%)
time spent on training: 190.58787989616394
___Test Target_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3995, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 5: Avg loss: 5.5600, Accuracy: 0/9950 (0.0000%)
saving model
Done in 653.0998389720917 sec.
Server Epoch:6 choose agents : [63, 42, 69, 72, 83, 44, 79, 50, 66, 74].
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0524, Accuracy: 284/888 (31.9820%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 426/888 (47.9730%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.7252, Accuracy: 56/10000 (0.5600%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0555, Accuracy: 272/1372 (19.8251%)
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0324, Accuracy: 474/1372 (34.5481%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.9947, Accuracy: 79/10000 (0.7900%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   1, Avg loss: 0.0529, Accuracy: 277/590 (46.9492%)
___Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   2, Avg loss: 0.0277, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.7437, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   1, Avg loss: 0.0629, Accuracy: 247/1241 (19.9033%)
___Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   2, Avg loss: 0.0372, Accuracy: 352/1241 (28.3642%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.2654, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   1, Avg loss: 0.0555, Accuracy: 406/1953 (20.7885%)
___Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 769/1953 (39.3753%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.8456, Accuracy: 94/10000 (0.9400%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0625, Accuracy: 336/1750 (19.2000%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0359, Accuracy: 641/1750 (36.6286%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.6665, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   1, Avg loss: 0.0980, Accuracy: 39/197 (19.7970%)
___Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   2, Avg loss: 0.0823, Accuracy: 61/197 (30.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.4906, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0682, Accuracy: 122/809 (15.0803%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0292, Accuracy: 321/809 (39.6786%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.7763, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 249/1402 (17.7603%)
___Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   2, Avg loss: 0.0393, Accuracy: 353/1402 (25.1783%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.3867, Accuracy: 75/10000 (0.7500%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0444, Accuracy: 458/1552 (29.5103%)
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0216, Accuracy: 706/1552 (45.4897%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 10.6314, Accuracy: 91/10000 (0.9100%)
time spent on training: 246.46714448928833
___Test Target_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.5430, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 6: Avg loss: 5.3783, Accuracy: 0/9950 (0.0000%)
saving model
Done in 704.9184911251068 sec.
Server Epoch:7 choose agents : [82, 90, 50, 35, 0, 79, 25, 37, 16, 60].
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0758, Accuracy: 71/500 (14.2000%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 183/500 (36.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.3356, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0648, Accuracy: 250/677 (36.9276%)
___Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0245, Accuracy: 457/677 (67.5037%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.3762, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   1, Avg loss: 0.0659, Accuracy: 130/809 (16.0692%)
___Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   2, Avg loss: 0.0286, Accuracy: 328/809 (40.5439%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.0259, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0862, Accuracy: 40/271 (14.7601%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0590, Accuracy: 96/271 (35.4244%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.6979, Accuracy: 51/10000 (0.5100%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   1, Avg loss: 0.0588, Accuracy: 345/1657 (20.8208%)
___Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   2, Avg loss: 0.0352, Accuracy: 506/1657 (30.5371%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.9198, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.1005, Accuracy: 20/197 (10.1523%)
___Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0839, Accuracy: 59/197 (29.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.4850, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0576, Accuracy: 275/690 (39.8551%)
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0287, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.1017, Accuracy: 72/10000 (0.7200%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   1, Avg loss: 0.0558, Accuracy: 330/1129 (29.2294%)
___Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   2, Avg loss: 0.0257, Accuracy: 681/1129 (60.3189%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.0358, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   1, Avg loss: 0.0628, Accuracy: 262/708 (37.0056%)
___Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.0895, Accuracy: 55/10000 (0.5500%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0509, Accuracy: 586/2227 (26.3134%)
___Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1037/2227 (46.5649%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.2191, Accuracy: 116/10000 (1.1600%)
time spent on training: 185.87997007369995
___Test Target_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.1014, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 7: Avg loss: 6.6234, Accuracy: 0/9950 (0.0000%)
saving model
Done in 630.1359171867371 sec.
Server Epoch:8 choose agents : [94, 35, 21, 1, 88, 43, 68, 27, 19, 92].
___Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   1, Avg loss: 0.0532, Accuracy: 342/1662 (20.5776%)
___Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   2, Avg loss: 0.0338, Accuracy: 598/1662 (35.9807%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.1543, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   1, Avg loss: 0.0891, Accuracy: 20/271 (7.3801%)
___Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   2, Avg loss: 0.0589, Accuracy: 96/271 (35.4244%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.7437, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0553, Accuracy: 377/1949 (19.3433%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 632/1949 (32.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.6100, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0597, Accuracy: 245/928 (26.4009%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0253, Accuracy: 519/928 (55.9267%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.2794, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   1, Avg loss: 0.0792, Accuracy: 106/603 (17.5788%)
___Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   2, Avg loss: 0.0472, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.5542, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   1, Avg loss: 0.0611, Accuracy: 298/946 (31.5011%)
___Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 381/946 (40.2748%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.3458, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   1, Avg loss: 0.0632, Accuracy: 345/1163 (29.6647%)
___Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   2, Avg loss: 0.0366, Accuracy: 495/1163 (42.5623%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.9669, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   1, Avg loss: 0.0560, Accuracy: 360/1587 (22.6843%)
___Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 569/1587 (35.8538%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.4041, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   1, Avg loss: 0.0475, Accuracy: 338/1036 (32.6255%)
___Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   2, Avg loss: 0.0260, Accuracy: 600/1036 (57.9151%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 10.8404, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   1, Avg loss: 0.0532, Accuracy: 388/1715 (22.6239%)
___Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   2, Avg loss: 0.0313, Accuracy: 668/1715 (38.9504%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.6604, Accuracy: 85/10000 (0.8500%)
time spent on training: 175.54950952529907
___Test Target_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.0909, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 8: Avg loss: 7.1254, Accuracy: 0/9950 (0.0000%)
saving model
Done in 614.9687464237213 sec.
Server Epoch:9 choose agents : [57, 42, 90, 21, 49, 84, 77, 18, 56, 65].
___Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   1, Avg loss: 0.0586, Accuracy: 241/1154 (20.8839%)
___Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   2, Avg loss: 0.0278, Accuracy: 471/1154 (40.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 10.8570, Accuracy: 52/10000 (0.5200%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   1, Avg loss: 0.0553, Accuracy: 261/1372 (19.0233%)
___Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 513/1372 (37.3907%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.1903, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0611, Accuracy: 274/677 (40.4727%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0247, Accuracy: 461/677 (68.0945%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.5716, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   1, Avg loss: 0.0548, Accuracy: 384/1949 (19.7024%)
___Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 643/1949 (32.9913%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.6918, Accuracy: 93/10000 (0.9300%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   1, Avg loss: 0.0796, Accuracy: 25/440 (5.6818%)
___Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   2, Avg loss: 0.0487, Accuracy: 157/440 (35.6818%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.3495, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 297/1190 (24.9580%)
___Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0317, Accuracy: 449/1190 (37.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.7769, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0545, Accuracy: 323/1340 (24.1045%)
___Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 528/1340 (39.4030%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.3865, Accuracy: 80/10000 (0.8000%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   1, Avg loss: 0.0845, Accuracy: 58/530 (10.9434%)
___Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   2, Avg loss: 0.0398, Accuracy: 265/530 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.2380, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0923, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0768, Accuracy: 11/186 (5.9140%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.5868, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0587, Accuracy: 341/1475 (23.1186%)
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0329, Accuracy: 595/1475 (40.3390%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.5172, Accuracy: 82/10000 (0.8200%)
time spent on training: 241.76979804039001
___Test Target_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.7080, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 9: Avg loss: 9.4729, Accuracy: 0/9950 (0.0000%)
saving model
Done in 704.8140082359314 sec.
Server Epoch:10 choose agents : [5, 23, 83, 66, 54, 46, 86, 78, 84, 8].
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0523, Accuracy: 369/1628 (22.6658%)
___Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0276, Accuracy: 704/1628 (43.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.7584, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   1, Avg loss: 0.0720, Accuracy: 270/715 (37.7622%)
___Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   2, Avg loss: 0.0393, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.0385, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   1, Avg loss: 0.0560, Accuracy: 399/1953 (20.4301%)
___Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 758/1953 (38.8121%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.7025, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   1, Avg loss: 0.0647, Accuracy: 266/1402 (18.9729%)
___Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   2, Avg loss: 0.0400, Accuracy: 356/1402 (25.3923%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.5480, Accuracy: 65/10000 (0.6500%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   1, Avg loss: 0.0512, Accuracy: 378/1130 (33.4513%)
___Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   2, Avg loss: 0.0299, Accuracy: 480/1130 (42.4779%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.5357, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   1, Avg loss: 0.0563, Accuracy: 395/1904 (20.7458%)
___Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 674/1904 (35.3992%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.7245, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   1, Avg loss: 0.0654, Accuracy: 332/1003 (33.1007%)
___Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   2, Avg loss: 0.0366, Accuracy: 384/1003 (38.2851%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.9633, Accuracy: 51/10000 (0.5100%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   1, Avg loss: 0.0829, Accuracy: 19/416 (4.5673%)
___Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   2, Avg loss: 0.0477, Accuracy: 193/416 (46.3942%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.6390, Accuracy: 61/10000 (0.6100%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 289/1190 (24.2857%)
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 414/1190 (34.7899%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.7466, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   1, Avg loss: 0.0630, Accuracy: 212/1513 (14.0119%)
___Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   2, Avg loss: 0.0372, Accuracy: 462/1513 (30.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.8655, Accuracy: 92/10000 (0.9200%)
time spent on training: 241.13910245895386
___Test Target_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.8270, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 10: Avg loss: 11.2519, Accuracy: 0/9950 (0.0000%)
saving model
Done in 679.8992359638214 sec.
Server Epoch:11 choose agents : [38, 24, 45, 8, 65, 19, 49, 17, 40, 22].
___Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   1, Avg loss: 0.0677, Accuracy: 195/1131 (17.2414%)
___Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   2, Avg loss: 0.0323, Accuracy: 463/1131 (40.9372%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.9564, Accuracy: 91/10000 (0.9100%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0671, Accuracy: 69/312 (22.1154%)
___Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0377, Accuracy: 157/312 (50.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.7901, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   1, Avg loss: 0.0720, Accuracy: 171/669 (25.5605%)
___Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   2, Avg loss: 0.0449, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.1916, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   1, Avg loss: 0.0622, Accuracy: 215/1513 (14.2102%)
___Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   2, Avg loss: 0.0372, Accuracy: 457/1513 (30.2049%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.6423, Accuracy: 88/10000 (0.8800%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   1, Avg loss: 0.0593, Accuracy: 362/1475 (24.5424%)
___Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   2, Avg loss: 0.0327, Accuracy: 617/1475 (41.8305%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.6456, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   1, Avg loss: 0.0466, Accuracy: 375/1036 (36.1969%)
___Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   2, Avg loss: 0.0251, Accuracy: 645/1036 (62.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 10.9754, Accuracy: 68/10000 (0.6800%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   1, Avg loss: 0.0757, Accuracy: 44/440 (10.0000%)
___Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   2, Avg loss: 0.0472, Accuracy: 156/440 (35.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.3303, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0529, Accuracy: 350/1574 (22.2363%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0286, Accuracy: 649/1574 (41.2325%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.6161, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   1, Avg loss: 0.0581, Accuracy: 313/1573 (19.8983%)
___Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 590/1573 (37.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.5492, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   1, Avg loss: 0.0486, Accuracy: 459/1470 (31.2245%)
___Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   2, Avg loss: 0.0253, Accuracy: 807/1470 (54.8980%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.5674, Accuracy: 98/10000 (0.9800%)
time spent on training: 225.92620849609375
___Test Target_ResNet_18 poisoned: False, epoch: 11: Avg loss: 11.0772, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 11: Avg loss: 15.2282, Accuracy: 0/9950 (0.0000%)
saving model
Done in 677.2973766326904 sec.
Server Epoch:12 choose agents : [56, 30, 69, 47, 51, 48, 92, 84, 32, 22].
___Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   1, Avg loss: 0.0922, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   2, Avg loss: 0.0758, Accuracy: 22/186 (11.8280%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.7750, Accuracy: 47/10000 (0.4700%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0894, Accuracy: 18/486 (3.7037%)
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0431, Accuracy: 221/486 (45.4733%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.6811, Accuracy: 65/10000 (0.6500%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   1, Avg loss: 0.0534, Accuracy: 264/590 (44.7458%)
___Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   2, Avg loss: 0.0361, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 9.7980, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   1, Avg loss: 0.1281, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   2, Avg loss: 0.1097, Accuracy: 5/134 (3.7313%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.0070, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   1, Avg loss: 0.0666, Accuracy: 189/1049 (18.0172%)
___Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   2, Avg loss: 0.0315, Accuracy: 496/1049 (47.2831%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.5069, Accuracy: 93/10000 (0.9300%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   1, Avg loss: 0.0804, Accuracy: 50/631 (7.9239%)
___Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   2, Avg loss: 0.0444, Accuracy: 211/631 (33.4390%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.8480, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0555, Accuracy: 425/1715 (24.7813%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0317, Accuracy: 661/1715 (38.5423%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.0229, Accuracy: 89/10000 (0.8900%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   1, Avg loss: 0.0646, Accuracy: 277/1190 (23.2773%)
___Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 441/1190 (37.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.2421, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0654, Accuracy: 157/735 (21.3605%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0240, Accuracy: 389/735 (52.9252%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 9.2880, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0464, Accuracy: 481/1470 (32.7211%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0249, Accuracy: 814/1470 (55.3741%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 9.3424, Accuracy: 97/10000 (0.9700%)
time spent on training: 200.5582664012909
___Test Target_ResNet_18 poisoned: False, epoch: 12: Avg loss: 12.0362, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 12: Avg loss: 12.6037, Accuracy: 0/9950 (0.0000%)
saving model
Done in 664.5599865913391 sec.
Server Epoch:13 choose agents : [53, 15, 3, 23, 83, 11, 27, 76, 70, 35].
___Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   1, Avg loss: 0.0521, Accuracy: 264/813 (32.4723%)
___Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   2, Avg loss: 0.0201, Accuracy: 419/813 (51.5375%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 10.8495, Accuracy: 57/10000 (0.5700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0615, Accuracy: 298/1154 (25.8232%)
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0344, Accuracy: 394/1154 (34.1421%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.7209, Accuracy: 59/10000 (0.5900%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   1, Avg loss: 0.0737, Accuracy: 121/781 (15.4930%)
___Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   2, Avg loss: 0.0372, Accuracy: 233/781 (29.8335%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.7300, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0633, Accuracy: 273/715 (38.1818%)
___Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0413, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.1705, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 415/1953 (21.2494%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 768/1953 (39.3241%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.9661, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   1, Avg loss: 0.0586, Accuracy: 256/712 (35.9551%)
___Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   2, Avg loss: 0.0285, Accuracy: 439/712 (61.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.1802, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   1, Avg loss: 0.0584, Accuracy: 367/1587 (23.1254%)
___Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   2, Avg loss: 0.0343, Accuracy: 601/1587 (37.8702%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.9549, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0875, Accuracy: 21/466 (4.5064%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0513, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.5997, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0613, Accuracy: 296/1418 (20.8745%)
___Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0320, Accuracy: 594/1418 (41.8900%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.3871, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0898, Accuracy: 8/271 (2.9520%)
___Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0585, Accuracy: 110/271 (40.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.2633, Accuracy: 54/10000 (0.5400%)
time spent on training: 251.33406805992126
___Test Target_ResNet_18 poisoned: False, epoch: 13: Avg loss: 12.7661, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 13: Avg loss: 15.8067, Accuracy: 0/9950 (0.0000%)
saving model
Done in 693.8299117088318 sec.
Server Epoch:14 choose agents : [0, 94, 96, 91, 51, 3, 36, 90, 37, 84].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   1, Avg loss: 0.0606, Accuracy: 318/1657 (19.1913%)
___Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   2, Avg loss: 0.0356, Accuracy: 462/1657 (27.8817%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.3469, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   1, Avg loss: 0.0529, Accuracy: 363/1662 (21.8412%)
___Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   2, Avg loss: 0.0338, Accuracy: 588/1662 (35.3791%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.3078, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   1, Avg loss: 0.0800, Accuracy: 47/311 (15.1125%)
___Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   2, Avg loss: 0.0581, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.5067, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   1, Avg loss: 0.0523, Accuracy: 291/1030 (28.2524%)
___Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   2, Avg loss: 0.0298, Accuracy: 586/1030 (56.8932%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 9.3101, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   1, Avg loss: 0.0668, Accuracy: 191/1049 (18.2078%)
___Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   2, Avg loss: 0.0319, Accuracy: 473/1049 (45.0906%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.5586, Accuracy: 94/10000 (0.9400%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   1, Avg loss: 0.0747, Accuracy: 101/781 (12.9321%)
___Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   2, Avg loss: 0.0378, Accuracy: 227/781 (29.0653%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.7325, Accuracy: 63/10000 (0.6300%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0915, Accuracy: 44/408 (10.7843%)
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0597, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.2900, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   1, Avg loss: 0.0600, Accuracy: 280/677 (41.3589%)
___Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   2, Avg loss: 0.0244, Accuracy: 444/677 (65.5835%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.9982, Accuracy: 51/10000 (0.5100%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   1, Avg loss: 0.0600, Accuracy: 315/1129 (27.9008%)
___Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   2, Avg loss: 0.0275, Accuracy: 622/1129 (55.0930%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.3571, Accuracy: 87/10000 (0.8700%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0623, Accuracy: 285/1190 (23.9496%)
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 433/1190 (36.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.5135, Accuracy: 60/10000 (0.6000%)
time spent on training: 214.8530511856079
___Test Target_ResNet_18 poisoned: False, epoch: 14: Avg loss: 11.1890, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 14: Avg loss: 12.3096, Accuracy: 0/9950 (0.0000%)
saving model
Done in 667.7883479595184 sec.
Server Epoch:15 choose agents : [0, 92, 37, 24, 39, 63, 28, 96, 58, 72].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   1, Avg loss: 0.0600, Accuracy: 322/1657 (19.4327%)
___Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   2, Avg loss: 0.0358, Accuracy: 466/1657 (28.1231%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.2105, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0562, Accuracy: 418/1715 (24.3732%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0312, Accuracy: 699/1715 (40.7580%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9587, Accuracy: 94/10000 (0.9400%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0579, Accuracy: 316/1129 (27.9894%)
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0270, Accuracy: 643/1129 (56.9531%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.8597, Accuracy: 99/10000 (0.9900%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   1, Avg loss: 0.0723, Accuracy: 41/312 (13.1410%)
___Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   2, Avg loss: 0.0407, Accuracy: 157/312 (50.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.3550, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0564, Accuracy: 287/1013 (28.3317%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0270, Accuracy: 466/1013 (46.0020%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.3099, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0584, Accuracy: 240/888 (27.0270%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0275, Accuracy: 412/888 (46.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.9559, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   1, Avg loss: 0.0604, Accuracy: 344/1581 (21.7584%)
___Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   2, Avg loss: 0.0360, Accuracy: 500/1581 (31.6256%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.0702, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   1, Avg loss: 0.0804, Accuracy: 49/311 (15.7556%)
___Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   2, Avg loss: 0.0564, Accuracy: 133/311 (42.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.6243, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   1, Avg loss: 0.0627, Accuracy: 312/803 (38.8543%)
___Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   2, Avg loss: 0.0377, Accuracy: 424/803 (52.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.4956, Accuracy: 63/10000 (0.6300%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   1, Avg loss: 0.0596, Accuracy: 226/1241 (18.2111%)
___Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 394/1241 (31.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9821, Accuracy: 59/10000 (0.5900%)
time spent on training: 211.4215714931488
___Test Target_ResNet_18 poisoned: False, epoch: 15: Avg loss: 9.6500, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 15: Avg loss: 10.3344, Accuracy: 0/9950 (0.0000%)
saving model
Done in 668.4271852970123 sec.
Server Epoch:16 choose agents : [35, 32, 3, 96, 25, 8, 93, 74, 88, 50].
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0826, Accuracy: 17/271 (6.2731%)
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0526, Accuracy: 107/271 (39.4834%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.5729, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0631, Accuracy: 143/735 (19.4558%)
___Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 359/735 (48.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 9.5246, Accuracy: 57/10000 (0.5700%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   1, Avg loss: 0.0761, Accuracy: 101/781 (12.9321%)
___Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   2, Avg loss: 0.0369, Accuracy: 251/781 (32.1383%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.6679, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0827, Accuracy: 24/311 (7.7170%)
___Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0573, Accuracy: 133/311 (42.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.5855, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0557, Accuracy: 275/690 (39.8551%)
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0288, Accuracy: 463/690 (67.1014%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1847, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   1, Avg loss: 0.0619, Accuracy: 224/1513 (14.8050%)
___Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 467/1513 (30.8658%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.7698, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0604, Accuracy: 343/1742 (19.6900%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0323, Accuracy: 673/1742 (38.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.2632, Accuracy: 82/10000 (0.8200%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0440, Accuracy: 483/1552 (31.1211%)
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0217, Accuracy: 717/1552 (46.1985%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 11.6885, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   1, Avg loss: 0.0772, Accuracy: 104/603 (17.2471%)
___Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   2, Avg loss: 0.0462, Accuracy: 283/603 (46.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.0000, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   1, Avg loss: 0.0689, Accuracy: 112/809 (13.8443%)
___Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   2, Avg loss: 0.0298, Accuracy: 309/809 (38.1953%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.7669, Accuracy: 88/10000 (0.8800%)
time spent on training: 242.67526078224182
___Test Target_ResNet_18 poisoned: False, epoch: 16: Avg loss: 9.9171, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 16: Avg loss: 8.3969, Accuracy: 0/9950 (0.0000%)
saving model
Done in 695.2353472709656 sec.
Server Epoch:17 choose agents : [53, 43, 41, 30, 82, 92, 50, 34, 7, 64].
___Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   1, Avg loss: 0.0535, Accuracy: 239/813 (29.3973%)
___Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 456/813 (56.0886%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 11.7509, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0614, Accuracy: 291/946 (30.7611%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 370/946 (39.1121%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.8520, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   1, Avg loss: 0.0669, Accuracy: 242/719 (33.6579%)
___Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   2, Avg loss: 0.0368, Accuracy: 467/719 (64.9513%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.7950, Accuracy: 57/10000 (0.5700%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   1, Avg loss: 0.0850, Accuracy: 42/486 (8.6420%)
___Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   2, Avg loss: 0.0433, Accuracy: 216/486 (44.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.7071, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   1, Avg loss: 0.0785, Accuracy: 35/500 (7.0000%)
___Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   2, Avg loss: 0.0480, Accuracy: 179/500 (35.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.1687, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   1, Avg loss: 0.0569, Accuracy: 404/1715 (23.5569%)
___Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   2, Avg loss: 0.0318, Accuracy: 677/1715 (39.4752%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.1064, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   1, Avg loss: 0.0682, Accuracy: 111/809 (13.7206%)
___Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   2, Avg loss: 0.0293, Accuracy: 328/809 (40.5439%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.9341, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0585, Accuracy: 360/1427 (25.2278%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0345, Accuracy: 567/1427 (39.7337%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.8306, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   1, Avg loss: 0.0577, Accuracy: 310/891 (34.7924%)
___Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   2, Avg loss: 0.0274, Accuracy: 436/891 (48.9338%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.3552, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   1, Avg loss: 0.0699, Accuracy: 118/953 (12.3820%)
___Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   2, Avg loss: 0.0393, Accuracy: 289/953 (30.3253%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.5969, Accuracy: 59/10000 (0.5900%)
time spent on training: 204.67582201957703
___Test Target_ResNet_18 poisoned: False, epoch: 17: Avg loss: 9.4284, Accuracy: 36/10000 (0.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 17: Avg loss: 8.2545, Accuracy: 0/9950 (0.0000%)
saving model
Done in 671.0588655471802 sec.
Server Epoch:18 choose agents : [18, 55, 4, 35, 2, 13, 24, 76, 9, 43].
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   1, Avg loss: 0.0780, Accuracy: 85/530 (16.0377%)
___Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   2, Avg loss: 0.0371, Accuracy: 267/530 (50.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.1470, Accuracy: 63/10000 (0.6300%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   1, Avg loss: 0.0599, Accuracy: 220/1071 (20.5415%)
___Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   2, Avg loss: 0.0318, Accuracy: 487/1071 (45.4715%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 9.4020, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   1, Avg loss: 0.0623, Accuracy: 279/901 (30.9656%)
___Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   2, Avg loss: 0.0350, Accuracy: 390/901 (43.2852%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.4788, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   1, Avg loss: 0.0804, Accuracy: 25/271 (9.2251%)
___Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   2, Avg loss: 0.0548, Accuracy: 108/271 (39.8524%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.6126, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0606, Accuracy: 214/605 (35.3719%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.7228, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   1, Avg loss: 0.0622, Accuracy: 309/1645 (18.7842%)
___Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   2, Avg loss: 0.0340, Accuracy: 609/1645 (37.0213%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.8419, Accuracy: 99/10000 (0.9900%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0735, Accuracy: 25/312 (8.0128%)
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0415, Accuracy: 156/312 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.5429, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 26/466 (5.5794%)
___Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0473, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.8979, Accuracy: 50/10000 (0.5000%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0517, Accuracy: 347/1275 (27.2157%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0203, Accuracy: 644/1275 (50.5098%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 10.2723, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   1, Avg loss: 0.0607, Accuracy: 306/946 (32.3467%)
___Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   2, Avg loss: 0.0353, Accuracy: 365/946 (38.5835%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.9245, Accuracy: 70/10000 (0.7000%)
time spent on training: 226.59198880195618
___Test Target_ResNet_18 poisoned: False, epoch: 18: Avg loss: 9.0111, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 18: Avg loss: 8.6975, Accuracy: 0/9950 (0.0000%)
saving model
Done in 676.4798259735107 sec.
Server Epoch:19 choose agents : [11, 48, 53, 27, 55, 65, 31, 89, 17, 23].
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0641, Accuracy: 222/712 (31.1798%)
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0280, Accuracy: 441/712 (61.9382%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 9.8688, Accuracy: 65/10000 (0.6500%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   1, Avg loss: 0.0816, Accuracy: 64/631 (10.1426%)
___Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   2, Avg loss: 0.0463, Accuracy: 213/631 (33.7559%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.8621, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   1, Avg loss: 0.0540, Accuracy: 244/813 (30.0123%)
___Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   2, Avg loss: 0.0201, Accuracy: 428/813 (52.6445%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 12.2227, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   1, Avg loss: 0.0571, Accuracy: 345/1587 (21.7391%)
___Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 573/1587 (36.1059%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.1547, Accuracy: 57/10000 (0.5700%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   1, Avg loss: 0.0590, Accuracy: 233/1071 (21.7554%)
___Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   2, Avg loss: 0.0320, Accuracy: 471/1071 (43.9776%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 9.8108, Accuracy: 63/10000 (0.6300%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   1, Avg loss: 0.0605, Accuracy: 334/1475 (22.6441%)
___Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   2, Avg loss: 0.0332, Accuracy: 640/1475 (43.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.9728, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   1, Avg loss: 0.0747, Accuracy: 68/460 (14.7826%)
___Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   2, Avg loss: 0.0350, Accuracy: 189/460 (41.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.4288, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0650, Accuracy: 305/896 (34.0402%)
___Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0366, Accuracy: 437/896 (48.7723%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.9621, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0554, Accuracy: 327/1574 (20.7751%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0294, Accuracy: 635/1574 (40.3431%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.9097, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   1, Avg loss: 0.0587, Accuracy: 316/715 (44.1958%)
___Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   2, Avg loss: 0.0401, Accuracy: 439/715 (61.3986%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.6891, Accuracy: 49/10000 (0.4900%)
time spent on training: 188.89399766921997
___Test Target_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.8273, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 19: Avg loss: 8.6162, Accuracy: 0/9950 (0.0000%)
saving model
Done in 631.0300576686859 sec.
Server Epoch:20 choose agents : [15, 22, 82, 11, 93, 75, 3, 77, 88, 16].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0618, Accuracy: 291/1154 (25.2166%)
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 449/1154 (38.9081%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.6481, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 491/1470 (33.4014%)
___Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   2, Avg loss: 0.0251, Accuracy: 800/1470 (54.4218%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.3155, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   1, Avg loss: 0.0788, Accuracy: 37/500 (7.4000%)
___Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   2, Avg loss: 0.0501, Accuracy: 184/500 (36.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.5086, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0656, Accuracy: 206/712 (28.9326%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0274, Accuracy: 447/712 (62.7809%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.1761, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   1, Avg loss: 0.0596, Accuracy: 392/1742 (22.5029%)
___Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   2, Avg loss: 0.0322, Accuracy: 691/1742 (39.6670%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.1207, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0741, Accuracy: 175/776 (22.5515%)
___Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0309, Accuracy: 427/776 (55.0258%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.9923, Accuracy: 68/10000 (0.6800%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   1, Avg loss: 0.0786, Accuracy: 76/781 (9.7311%)
___Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   2, Avg loss: 0.0380, Accuracy: 238/781 (30.4738%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.8962, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   1, Avg loss: 0.0553, Accuracy: 336/1340 (25.0746%)
___Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 570/1340 (42.5373%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.0029, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   1, Avg loss: 0.0761, Accuracy: 108/603 (17.9104%)
___Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   2, Avg loss: 0.0475, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.1480, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   1, Avg loss: 0.0687, Accuracy: 223/708 (31.4972%)
___Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   2, Avg loss: 0.0379, Accuracy: 425/708 (60.0282%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.9085, Accuracy: 55/10000 (0.5500%)
time spent on training: 241.49034070968628
___Test Target_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.3525, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 20: Avg loss: 9.1976, Accuracy: 0/9950 (0.0000%)
saving model
Done in 689.3669974803925 sec.
Server Epoch:21 choose agents : [0, 27, 39, 70, 20, 85, 12, 72, 94, 32].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0513, Accuracy: 819/1657 (49.4267%), train_poison_data_count: 1040
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0280, Accuracy: 982/1657 (59.2637%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0233, Accuracy: 1049/1657 (63.3072%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0229, Accuracy: 1045/1657 (63.0658%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0224, Accuracy: 1045/1657 (63.0658%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0220, Accuracy: 1048/1657 (63.2468%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0215, Accuracy: 1052/1657 (63.4882%), train_poison_data_count: 1040
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0209, Accuracy: 1069/1657 (64.5142%), train_poison_data_count: 1040
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0203, Accuracy: 1072/1657 (64.6952%), train_poison_data_count: 1040
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0203, Accuracy: 1077/1657 (64.9970%), train_poison_data_count: 1040
Global model norm: 187.41221903533932.
Norm before scaling: 187.35835274614794. Distance: 1.144338754343478
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.5434, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: 0.3633, Accuracy: 9925/9950 (99.7487%)
Scaling by  100
Scaled Norm after poisoning: 214.63776716540357, distance: 114.4338731675416
Total norm for 5 adversaries is: 214.63776716540357. distance: 114.4338731675416
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0566, Accuracy: 371/1587 (23.3774%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0343, Accuracy: 582/1587 (36.6730%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.0416, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   1, Avg loss: 0.0551, Accuracy: 269/1013 (26.5548%)
___Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   2, Avg loss: 0.0270, Accuracy: 487/1013 (48.0750%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 9.3071, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   1, Avg loss: 0.0577, Accuracy: 312/1418 (22.0028%)
___Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   2, Avg loss: 0.0325, Accuracy: 572/1418 (40.3385%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.2972, Accuracy: 94/10000 (0.9400%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0603, Accuracy: 287/807 (35.5638%)
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0345, Accuracy: 412/807 (51.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.1069, Accuracy: 63/10000 (0.6300%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   1, Avg loss: 0.0581, Accuracy: 409/1988 (20.5734%)
___Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   2, Avg loss: 0.0366, Accuracy: 630/1988 (31.6901%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.4225, Accuracy: 86/10000 (0.8600%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   1, Avg loss: 0.1050, Accuracy: 6/338 (1.7751%)
___Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   2, Avg loss: 0.0627, Accuracy: 82/338 (24.2604%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.0253, Accuracy: 57/10000 (0.5700%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   1, Avg loss: 0.0592, Accuracy: 224/1241 (18.0500%)
___Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 386/1241 (31.1039%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.0284, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0573, Accuracy: 311/1662 (18.7124%)
___Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0345, Accuracy: 566/1662 (34.0554%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.6804, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   1, Avg loss: 0.0637, Accuracy: 162/735 (22.0408%)
___Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 366/735 (49.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 11.4687, Accuracy: 58/10000 (0.5800%)
time spent on training: 354.17917585372925
___Test Target_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.4618, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Avg loss: 1.1647, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 804.7455508708954 sec.
Server Epoch:22 choose agents : [17, 32, 73, 28, 12, 2, 85, 13, 18, 80].
___Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   1, Avg loss: 0.0659, Accuracy: 264/1574 (16.7726%)
___Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   2, Avg loss: 0.0307, Accuracy: 606/1574 (38.5006%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.2490, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   1, Avg loss: 0.0689, Accuracy: 150/735 (20.4082%)
___Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   2, Avg loss: 0.0285, Accuracy: 361/735 (49.1156%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 13.0820, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   1, Avg loss: 0.0729, Accuracy: 187/938 (19.9360%)
___Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   2, Avg loss: 0.0365, Accuracy: 339/938 (36.1407%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.4510, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   1, Avg loss: 0.0682, Accuracy: 302/1581 (19.1018%)
___Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   2, Avg loss: 0.0348, Accuracy: 571/1581 (36.1164%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.2818, Accuracy: 92/10000 (0.9200%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.1364, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0713, Accuracy: 22/338 (6.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.8524, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0845, Accuracy: 90/605 (14.8760%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0458, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.5561, Accuracy: 56/10000 (0.5600%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   1, Avg loss: 0.0669, Accuracy: 348/1988 (17.5050%)
___Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   2, Avg loss: 0.0365, Accuracy: 597/1988 (30.0302%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.1993, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0687, Accuracy: 238/1645 (14.4681%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0341, Accuracy: 533/1645 (32.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.7768, Accuracy: 102/10000 (1.0200%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.1051, Accuracy: 6/530 (1.1321%)
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0412, Accuracy: 265/530 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 10.2421, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0918, Accuracy: 50/682 (7.3314%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0426, Accuracy: 251/682 (36.8035%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.1106, Accuracy: 49/10000 (0.4900%)
time spent on training: 200.68802309036255
___Test Target_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.4363, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Avg loss: 1.3581, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 636.4430346488953 sec.
Server Epoch:23 choose agents : [3, 14, 79, 74, 2, 49, 32, 18, 4, 7].
poison local model 3 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Average loss: 0.0492, Accuracy: 492/781 (62.9962%), train_poison_data_count: 493
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Average loss: 0.0348, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   3, Average loss: 0.0279, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   4, Average loss: 0.0276, Accuracy: 495/781 (63.3803%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   5, Average loss: 0.0265, Accuracy: 492/781 (62.9962%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   6, Average loss: 0.0259, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   7, Average loss: 0.0262, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   8, Average loss: 0.0232, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   9, Average loss: 0.0246, Accuracy: 494/781 (63.2522%), train_poison_data_count: 493
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch  10, Average loss: 0.0245, Accuracy: 494/781 (63.2522%), train_poison_data_count: 493
Global model norm: 193.25262773116438.
Norm before scaling: 193.22763251861778. Distance: 0.7584881867209892
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.6014, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.3046, Accuracy: 9929/9950 (99.7889%)
Scaling by  100
Scaled Norm after poisoning: 205.124019269441, distance: 75.84882618467968
Total norm for 4 adversaries is: 205.124019269441. distance: 75.84882618467968
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   1, Avg loss: 0.0888, Accuracy: 99/1013 (9.7730%)
___Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   2, Avg loss: 0.0386, Accuracy: 308/1013 (30.4047%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.0574, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   1, Avg loss: 0.1479, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   2, Avg loss: 0.1121, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 5.9142, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0563, Accuracy: 349/1552 (22.4871%)
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0223, Accuracy: 699/1552 (45.0387%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 11.7077, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0790, Accuracy: 98/605 (16.1983%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0434, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.6029, Accuracy: 63/10000 (0.6300%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   1, Avg loss: 0.1051, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   2, Avg loss: 0.0561, Accuracy: 98/440 (22.2727%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.0715, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   1, Avg loss: 0.0651, Accuracy: 169/735 (22.9932%)
___Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   2, Avg loss: 0.0273, Accuracy: 363/735 (49.3878%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 11.9220, Accuracy: 55/10000 (0.5500%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   1, Avg loss: 0.0995, Accuracy: 8/530 (1.5094%)
___Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   2, Avg loss: 0.0408, Accuracy: 269/530 (50.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 10.6659, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0733, Accuracy: 209/901 (23.1964%)
___Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0334, Accuracy: 422/901 (46.8368%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.5708, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   1, Avg loss: 0.0731, Accuracy: 214/891 (24.0180%)
___Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   2, Avg loss: 0.0291, Accuracy: 444/891 (49.8316%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.1044, Accuracy: 62/10000 (0.6200%)
time spent on training: 287.27249813079834
___Test Target_ResNet_18 poisoned: False, epoch: 23: Avg loss: 12.1607, Accuracy: 59/10000 (0.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.8610, Accuracy: 6896/9950 (69.3065%)
saving model
Done in 717.782543182373 sec.
Server Epoch:24 choose agents : [92, 33, 42, 36, 22, 98, 4, 17, 76, 3].
___Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   1, Avg loss: 0.0645, Accuracy: 344/1715 (20.0583%)
___Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   2, Avg loss: 0.0318, Accuracy: 690/1715 (40.2332%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.4761, Accuracy: 85/10000 (0.8500%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   1, Avg loss: 0.1074, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   2, Avg loss: 0.0599, Accuracy: 116/515 (22.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.2868, Accuracy: 49/10000 (0.4900%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   1, Avg loss: 0.0630, Accuracy: 206/1372 (15.0146%)
___Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   2, Avg loss: 0.0329, Accuracy: 492/1372 (35.8601%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.0015, Accuracy: 81/10000 (0.8100%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   1, Avg loss: 0.1127, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   2, Avg loss: 0.0597, Accuracy: 104/408 (25.4902%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.8151, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   1, Avg loss: 0.0543, Accuracy: 405/1470 (27.5510%)
___Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   2, Avg loss: 0.0251, Accuracy: 810/1470 (55.1020%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 10.0201, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   1, Avg loss: 0.1115, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   2, Avg loss: 0.0633, Accuracy: 83/373 (22.2520%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.8577, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   1, Avg loss: 0.0713, Accuracy: 221/901 (24.5283%)
___Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   2, Avg loss: 0.0332, Accuracy: 394/901 (43.7292%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.3765, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0624, Accuracy: 280/1574 (17.7891%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0299, Accuracy: 625/1574 (39.7078%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.1525, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.1023, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0519, Accuracy: 174/466 (37.3391%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.5899, Accuracy: 55/10000 (0.5500%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0421, Accuracy: 159/781 (20.3585%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0319, Accuracy: 277/781 (35.4673%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.8244, Accuracy: 92/10000 (0.9200%)
time spent on training: 231.033385515213
___Test Target_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.3142, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Avg loss: 1.4325, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 675.7860865592957 sec.
Server Epoch:25 choose agents : [5, 23, 0, 67, 40, 80, 54, 26, 74, 47].
poison local model 5 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   1, Average loss: 0.0370, Accuracy: 1019/1628 (62.5921%), train_poison_data_count: 1028
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   2, Average loss: 0.0213, Accuracy: 1030/1628 (63.2678%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   3, Average loss: 0.0179, Accuracy: 1055/1628 (64.8034%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   4, Average loss: 0.0169, Accuracy: 1102/1628 (67.6904%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   5, Average loss: 0.0161, Accuracy: 1109/1628 (68.1204%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   6, Average loss: 0.0153, Accuracy: 1119/1628 (68.7346%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   7, Average loss: 0.0150, Accuracy: 1135/1628 (69.7174%), train_poison_data_count: 1028
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   8, Average loss: 0.0147, Accuracy: 1163/1628 (71.4373%), train_poison_data_count: 1028
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   9, Average loss: 0.0151, Accuracy: 1164/1628 (71.4988%), train_poison_data_count: 1028
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch  10, Average loss: 0.0149, Accuracy: 1181/1628 (72.5430%), train_poison_data_count: 1028
Global model norm: 198.98712269893247.
Norm before scaling: 198.93014634539432. Distance: 1.0974463537047945
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.1052, Accuracy: 73/10000 (0.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.2636, Accuracy: 9892/9950 (99.4171%)
Scaling by  100
Scaled Norm after poisoning: 221.9274497865237, distance: 109.74464323487503
Total norm for 4 adversaries is: 221.9274497865237. distance: 109.74464323487503
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   1, Avg loss: 0.0751, Accuracy: 178/715 (24.8951%)
___Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   2, Avg loss: 0.0446, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 6.7919, Accuracy: 58/10000 (0.5800%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   1, Avg loss: 0.0482, Accuracy: 315/1657 (19.0103%)
___Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   2, Avg loss: 0.0331, Accuracy: 551/1657 (33.2529%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.6153, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   1, Avg loss: 0.0989, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   2, Avg loss: 0.0465, Accuracy: 130/426 (30.5164%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.8402, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   1, Avg loss: 0.0678, Accuracy: 247/1573 (15.7025%)
___Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   2, Avg loss: 0.0369, Accuracy: 513/1573 (32.6128%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.0195, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   1, Avg loss: 0.0900, Accuracy: 37/682 (5.4252%)
___Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   2, Avg loss: 0.0412, Accuracy: 260/682 (38.1232%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.3806, Accuracy: 61/10000 (0.6100%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0601, Accuracy: 248/1130 (21.9469%)
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 463/1130 (40.9735%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.9584, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0670, Accuracy: 251/1446 (17.3582%)
___Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0351, Accuracy: 502/1446 (34.7165%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.9085, Accuracy: 77/10000 (0.7700%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0536, Accuracy: 347/1552 (22.3582%)
___Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0219, Accuracy: 721/1552 (46.4562%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 11.3884, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   1, Avg loss: 0.1516, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   2, Avg loss: 0.1334, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.9878, Accuracy: 62/10000 (0.6200%)
time spent on training: 309.99854278564453
___Test Target_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.1357, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Avg loss: 2.2491, Accuracy: 0/9950 (0.0000%)
saving model
Done in 749.8981590270996 sec.
Server Epoch:26 choose agents : [26, 4, 33, 73, 30, 86, 10, 12, 68, 82].
___Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   1, Avg loss: 0.0766, Accuracy: 207/1446 (14.3154%)
___Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   2, Avg loss: 0.0361, Accuracy: 498/1446 (34.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.1237, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   1, Avg loss: 0.0863, Accuracy: 183/901 (20.3108%)
___Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   2, Avg loss: 0.0354, Accuracy: 391/901 (43.3962%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.3104, Accuracy: 54/10000 (0.5400%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   1, Avg loss: 0.1285, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   2, Avg loss: 0.0652, Accuracy: 85/515 (16.5049%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.6191, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0736, Accuracy: 163/938 (17.3774%)
___Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0355, Accuracy: 326/938 (34.7548%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.7128, Accuracy: 72/10000 (0.7200%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   1, Avg loss: 0.1172, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   2, Avg loss: 0.0475, Accuracy: 182/486 (37.4486%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.3301, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.0890, Accuracy: 183/1003 (18.2453%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0391, Accuracy: 368/1003 (36.6899%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.1951, Accuracy: 46/10000 (0.4600%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   1, Avg loss: 0.0813, Accuracy: 86/861 (9.9884%)
___Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   2, Avg loss: 0.0230, Accuracy: 436/861 (50.6388%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 10.8222, Accuracy: 97/10000 (0.9700%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   1, Avg loss: 0.1491, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   2, Avg loss: 0.0743, Accuracy: 13/338 (3.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.4281, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0808, Accuracy: 241/1163 (20.7223%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0388, Accuracy: 430/1163 (36.9733%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.0167, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.1169, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0568, Accuracy: 135/500 (27.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.2834, Accuracy: 63/10000 (0.6300%)
time spent on training: 206.00827932357788
___Test Target_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.0983, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Avg loss: 2.3943, Accuracy: 0/9950 (0.0000%)
saving model
Done in 628.5334825515747 sec.
Server Epoch:27 choose agents : [9, 64, 30, 13, 76, 44, 39, 22, 78, 85].
poison local model 9 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Average loss: 0.0430, Accuracy: 789/1275 (61.8824%), train_poison_data_count: 800
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Average loss: 0.0197, Accuracy: 839/1275 (65.8039%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   3, Average loss: 0.0145, Accuracy: 884/1275 (69.3333%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   4, Average loss: 0.0138, Accuracy: 894/1275 (70.1176%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   5, Average loss: 0.0142, Accuracy: 898/1275 (70.4314%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   6, Average loss: 0.0135, Accuracy: 924/1275 (72.4706%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   7, Average loss: 0.0124, Accuracy: 939/1275 (73.6471%), train_poison_data_count: 800
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   8, Average loss: 0.0130, Accuracy: 946/1275 (74.1961%), train_poison_data_count: 800
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   9, Average loss: 0.0127, Accuracy: 929/1275 (72.8627%), train_poison_data_count: 800
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch  10, Average loss: 0.0125, Accuracy: 934/1275 (73.2549%), train_poison_data_count: 800
Global model norm: 204.5112695550052.
Norm before scaling: 204.46747716629656. Distance: 1.0912882758175722
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.9481, Accuracy: 64/10000 (0.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.1105, Accuracy: 9886/9950 (99.3568%)
Scaling by  100
Scaled Norm after poisoning: 227.6498390483727, distance: 109.12883011606053
Total norm for 5 adversaries is: 227.6498390483727. distance: 109.12883011606053
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   1, Avg loss: 0.0876, Accuracy: 89/953 (9.3389%)
___Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   2, Avg loss: 0.0400, Accuracy: 314/953 (32.9486%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.2020, Accuracy: 75/10000 (0.7500%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   1, Avg loss: 0.1102, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   2, Avg loss: 0.0472, Accuracy: 189/486 (38.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.8811, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0712, Accuracy: 221/1645 (13.4347%)
___Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0337, Accuracy: 564/1645 (34.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.6385, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   1, Avg loss: 0.1029, Accuracy: 12/466 (2.5751%)
___Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   2, Avg loss: 0.0564, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.3169, Accuracy: 52/10000 (0.5200%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0750, Accuracy: 239/1750 (13.6571%)
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0376, Accuracy: 590/1750 (33.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.7360, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   1, Avg loss: 0.0742, Accuracy: 163/1013 (16.0908%)
___Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   2, Avg loss: 0.0283, Accuracy: 485/1013 (47.8776%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.7151, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   1, Avg loss: 0.0579, Accuracy: 383/1470 (26.0544%)
___Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   2, Avg loss: 0.0257, Accuracy: 823/1470 (55.9864%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.1445, Accuracy: 106/10000 (1.0600%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   1, Avg loss: 0.1175, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   2, Avg loss: 0.0547, Accuracy: 111/416 (26.6827%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.3590, Accuracy: 73/10000 (0.7300%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0691, Accuracy: 335/1988 (16.8511%)
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0374, Accuracy: 614/1988 (30.8853%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.5660, Accuracy: 76/10000 (0.7600%)
time spent on training: 359.27581095695496
___Test Target_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.0119, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Avg loss: 1.9817, Accuracy: 0/9950 (0.0000%)
saving model
Done in 825.7786450386047 sec.
Server Epoch:28 choose agents : [64, 26, 82, 31, 65, 98, 73, 61, 44, 18].
___Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   1, Avg loss: 0.0970, Accuracy: 63/953 (6.6107%)
___Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   2, Avg loss: 0.0403, Accuracy: 295/953 (30.9549%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.1275, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   1, Avg loss: 0.0747, Accuracy: 224/1446 (15.4910%)
___Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   2, Avg loss: 0.0356, Accuracy: 534/1446 (36.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.2978, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.1204, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0568, Accuracy: 138/500 (27.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.3649, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   1, Avg loss: 0.1297, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   2, Avg loss: 0.0480, Accuracy: 137/460 (29.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.6021, Accuracy: 54/10000 (0.5400%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   1, Avg loss: 0.0782, Accuracy: 255/1475 (17.2881%)
___Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   2, Avg loss: 0.0359, Accuracy: 543/1475 (36.8136%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.1030, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.1328, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0688, Accuracy: 63/373 (16.8901%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.0879, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   1, Avg loss: 0.0790, Accuracy: 145/938 (15.4584%)
___Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   2, Avg loss: 0.0364, Accuracy: 289/938 (30.8102%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.5107, Accuracy: 60/10000 (0.6000%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   1, Avg loss: 0.1703, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   2, Avg loss: 0.1641, Accuracy: 1/85 (1.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.4521, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   1, Avg loss: 0.0787, Accuracy: 255/1750 (14.5714%)
___Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   2, Avg loss: 0.0365, Accuracy: 676/1750 (38.6286%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.0870, Accuracy: 104/10000 (1.0400%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   1, Avg loss: 0.1189, Accuracy: 0/530 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   2, Avg loss: 0.0427, Accuracy: 260/530 (49.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 10.1309, Accuracy: 67/10000 (0.6700%)
time spent on training: 208.19069910049438
___Test Target_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.0604, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Avg loss: 2.1974, Accuracy: 0/9950 (0.0000%)
saving model
Done in 672.2427196502686 sec.
Server Epoch:29 choose agents : [10, 11, 42, 19, 88, 80, 54, 78, 92, 96].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Average loss: 0.0472, Accuracy: 504/861 (58.5366%), train_poison_data_count: 549
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Average loss: 0.0252, Accuracy: 539/861 (62.6016%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Average loss: 0.0182, Accuracy: 572/861 (66.4344%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Average loss: 0.0172, Accuracy: 570/861 (66.2021%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Average loss: 0.0170, Accuracy: 574/861 (66.6667%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Average loss: 0.0166, Accuracy: 583/861 (67.7120%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Average loss: 0.0168, Accuracy: 584/861 (67.8281%), train_poison_data_count: 549
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Average loss: 0.0156, Accuracy: 598/861 (69.4541%), train_poison_data_count: 549
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Average loss: 0.0154, Accuracy: 599/861 (69.5703%), train_poison_data_count: 549
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Average loss: 0.0159, Accuracy: 603/861 (70.0348%), train_poison_data_count: 549
Global model norm: 209.9402909906767.
Norm before scaling: 209.9104533783394. Distance: 0.8599735603038572
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.2217, Accuracy: 75/10000 (0.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.1114, Accuracy: 9879/9950 (99.2864%)
Scaling by  100
Scaled Norm after poisoning: 223.92973751547603, distance: 85.99735415624716
Total norm for 4 adversaries is: 223.92973751547603. distance: 85.99735415624716
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0890, Accuracy: 120/712 (16.8539%)
___Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0349, Accuracy: 446/712 (62.6404%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 11.4574, Accuracy: 75/10000 (0.7500%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   1, Avg loss: 0.0733, Accuracy: 180/1372 (13.1195%)
___Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   2, Avg loss: 0.0329, Accuracy: 487/1372 (35.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.4897, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   1, Avg loss: 0.0738, Accuracy: 216/1036 (20.8494%)
___Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   2, Avg loss: 0.0257, Accuracy: 654/1036 (63.1274%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 13.3374, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.0991, Accuracy: 23/603 (3.8143%)
___Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0488, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.7981, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   1, Avg loss: 0.1039, Accuracy: 25/682 (3.6657%)
___Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   2, Avg loss: 0.0431, Accuracy: 270/682 (39.5894%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.9789, Accuracy: 55/10000 (0.5500%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0703, Accuracy: 240/1130 (21.2389%)
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 487/1130 (43.0973%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 10.4492, Accuracy: 51/10000 (0.5100%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.1207, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0554, Accuracy: 113/416 (27.1635%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.2567, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   1, Avg loss: 0.0683, Accuracy: 311/1715 (18.1341%)
___Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   2, Avg loss: 0.0320, Accuracy: 674/1715 (39.3003%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.3330, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.1291, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0805, Accuracy: 30/311 (9.6463%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.8549, Accuracy: 57/10000 (0.5700%)
time spent on training: 334.9337754249573
___Test Target_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.3436, Accuracy: 72/10000 (0.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.6113, Accuracy: 7845/9950 (78.8442%)
saving model
Done in 785.5618982315063 sec.
Server Epoch:30 choose agents : [90, 87, 0, 73, 61, 97, 66, 35, 1, 22].
___Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0698, Accuracy: 153/677 (22.5997%)
___Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 456/677 (67.3560%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 12.6844, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   1, Avg loss: 0.0798, Accuracy: 183/1131 (16.1804%)
___Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   2, Avg loss: 0.0333, Accuracy: 381/1131 (33.6870%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.7178, Accuracy: 61/10000 (0.6100%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0598, Accuracy: 278/1657 (16.7773%)
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 485/1657 (29.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.7312, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   1, Avg loss: 0.0729, Accuracy: 189/938 (20.1493%)
___Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   2, Avg loss: 0.0355, Accuracy: 320/938 (34.1151%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.6156, Accuracy: 61/10000 (0.6100%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   1, Avg loss: 0.1734, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   2, Avg loss: 0.1606, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.2401, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   1, Avg loss: 0.0790, Accuracy: 190/1213 (15.6636%)
___Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   2, Avg loss: 0.0289, Accuracy: 515/1213 (42.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 10.0122, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0859, Accuracy: 133/1402 (9.4864%)
___Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0419, Accuracy: 357/1402 (25.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.9327, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   1, Avg loss: 0.1370, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   2, Avg loss: 0.0795, Accuracy: 12/271 (4.4280%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.6071, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0762, Accuracy: 180/928 (19.3966%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0268, Accuracy: 555/928 (59.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 10.4490, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   1, Avg loss: 0.0610, Accuracy: 362/1470 (24.6259%)
___Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   2, Avg loss: 0.0254, Accuracy: 797/1470 (54.2177%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 10.1376, Accuracy: 103/10000 (1.0300%)
time spent on training: 218.24425148963928
___Test Target_ResNet_18 poisoned: False, epoch: 30: Avg loss: 11.2367, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Avg loss: 0.5910, Accuracy: 7676/9950 (77.1457%)
saving model
Done in 678.7057414054871 sec.
Server Epoch:31 choose agents : [12, 97, 60, 95, 0, 45, 47, 74, 1, 90].
poison local model 12 index 5 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   1, Average loss: 0.0555, Accuracy: 193/338 (57.1006%), train_poison_data_count: 218
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   2, Average loss: 0.0476, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   3, Average loss: 0.0414, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   4, Average loss: 0.0395, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   5, Average loss: 0.0381, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   6, Average loss: 0.0353, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   7, Average loss: 0.0339, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   8, Average loss: 0.0345, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   9, Average loss: 0.0319, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch  10, Average loss: 0.0324, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Global model norm: 215.20309266771702.
Norm before scaling: 215.19257364044884. Distance: 0.41032422577023697
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.3869, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.0530, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 218.00521424383408, distance: 41.03242364324904
Total norm for 5 adversaries is: 218.00521424383408. distance: 41.03242364324904
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0768, Accuracy: 189/1213 (15.5812%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0293, Accuracy: 523/1213 (43.1162%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 10.7598, Accuracy: 82/10000 (0.8200%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0642, Accuracy: 486/2227 (21.8231%)
___Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0295, Accuracy: 1002/2227 (44.9933%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.9505, Accuracy: 126/10000 (1.2600%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.0920, Accuracy: 96/599 (16.0267%)
___Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0352, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 14.8761, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0573, Accuracy: 276/1657 (16.6566%)
___Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 485/1657 (29.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.7478, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   1, Avg loss: 0.0960, Accuracy: 56/669 (8.3707%)
___Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   2, Avg loss: 0.0455, Accuracy: 356/669 (53.2138%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.8662, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   1, Avg loss: 0.1765, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   2, Avg loss: 0.1526, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.6618, Accuracy: 58/10000 (0.5800%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   1, Avg loss: 0.0580, Accuracy: 334/1552 (21.5206%)
___Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   2, Avg loss: 0.0220, Accuracy: 749/1552 (48.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 11.8003, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0733, Accuracy: 195/928 (21.0129%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0265, Accuracy: 550/928 (59.2672%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 10.3438, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   1, Avg loss: 0.0697, Accuracy: 148/677 (21.8612%)
___Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 447/677 (66.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 12.5416, Accuracy: 63/10000 (0.6300%)
time spent on training: 336.77801060676575
___Test Target_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.9859, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.0409, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 794.0654428005219 sec.
Server Epoch:32 choose agents : [90, 32, 84, 98, 78, 46, 40, 68, 29, 95].
___Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0614, Accuracy: 196/677 (28.9513%)
___Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 453/677 (66.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 11.7412, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0610, Accuracy: 200/735 (27.2109%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0297, Accuracy: 333/735 (45.3061%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 11.6668, Accuracy: 57/10000 (0.5700%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0753, Accuracy: 223/1190 (18.7395%)
___Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 453/1190 (38.0672%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.7553, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   1, Avg loss: 0.1006, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   2, Avg loss: 0.0542, Accuracy: 108/373 (28.9544%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.6689, Accuracy: 49/10000 (0.4900%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   1, Avg loss: 0.1032, Accuracy: 1/416 (0.2404%)
___Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   2, Avg loss: 0.0513, Accuracy: 163/416 (39.1827%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.1553, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0616, Accuracy: 364/1904 (19.1176%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0320, Accuracy: 671/1904 (35.2416%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.2305, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   1, Avg loss: 0.0681, Accuracy: 275/1573 (17.4825%)
___Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   2, Avg loss: 0.0358, Accuracy: 575/1573 (36.5544%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.0296, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   1, Avg loss: 0.0749, Accuracy: 266/1163 (22.8719%)
___Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   2, Avg loss: 0.0398, Accuracy: 452/1163 (38.8650%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.9625, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   1, Avg loss: 0.0550, Accuracy: 337/1440 (23.4028%)
___Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   2, Avg loss: 0.0289, Accuracy: 661/1440 (45.9028%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 9.0325, Accuracy: 83/10000 (0.8300%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0862, Accuracy: 129/599 (21.5359%)
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0342, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 13.9340, Accuracy: 50/10000 (0.5000%)
time spent on training: 253.234290599823
___Test Target_ResNet_18 poisoned: False, epoch: 32: Avg loss: 10.1961, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Avg loss: 0.0973, Accuracy: 9913/9950 (99.6281%)
saving model
Done in 723.3884198665619 sec.
Server Epoch:33 choose agents : [15, 44, 14, 40, 61, 33, 88, 73, 21, 30].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Average loss: 0.0446, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Average loss: 0.0260, Accuracy: 714/1154 (61.8718%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Average loss: 0.0205, Accuracy: 747/1154 (64.7314%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Average loss: 0.0205, Accuracy: 759/1154 (65.7712%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Average loss: 0.0203, Accuracy: 760/1154 (65.8579%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Average loss: 0.0196, Accuracy: 750/1154 (64.9913%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Average loss: 0.0185, Accuracy: 766/1154 (66.3778%), train_poison_data_count: 722
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Average loss: 0.0186, Accuracy: 770/1154 (66.7244%), train_poison_data_count: 722
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Average loss: 0.0187, Accuracy: 759/1154 (65.7712%), train_poison_data_count: 722
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Average loss: 0.0177, Accuracy: 777/1154 (67.3310%), train_poison_data_count: 722
Global model norm: 220.36544576566445.
Norm before scaling: 220.32120550176282. Distance: 0.9714712561567886
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.2250, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.1369, Accuracy: 9856/9950 (99.0553%)
Scaling by  100
Scaled Norm after poisoning: 236.547010721442, distance: 97.14711781622756
Total norm for 5 adversaries is: 236.547010721442. distance: 97.14711781622756
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Avg loss: 0.0685, Accuracy: 277/1750 (15.8286%)
___Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 679/1750 (38.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.0250, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0837, Accuracy: 116/1013 (11.4511%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0379, Accuracy: 338/1013 (33.3662%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.0885, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   1, Avg loss: 0.0652, Accuracy: 285/1573 (18.1182%)
___Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   2, Avg loss: 0.0360, Accuracy: 531/1573 (33.7572%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.2626, Accuracy: 79/10000 (0.7900%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   1, Avg loss: 0.1292, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   2, Avg loss: 0.1130, Accuracy: 2/85 (2.3529%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 6.9596, Accuracy: 57/10000 (0.5700%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   1, Avg loss: 0.0992, Accuracy: 11/515 (2.1359%)
___Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   2, Avg loss: 0.0622, Accuracy: 122/515 (23.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.0000, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   1, Avg loss: 0.0782, Accuracy: 81/603 (13.4328%)
___Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   2, Avg loss: 0.0471, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.0799, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   1, Avg loss: 0.0641, Accuracy: 230/938 (24.5203%)
___Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   2, Avg loss: 0.0342, Accuracy: 322/938 (34.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.0778, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   1, Avg loss: 0.0608, Accuracy: 277/1949 (14.2124%)
___Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   2, Avg loss: 0.0343, Accuracy: 594/1949 (30.4772%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.8703, Accuracy: 83/10000 (0.8300%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   1, Avg loss: 0.0950, Accuracy: 13/486 (2.6749%)
___Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   2, Avg loss: 0.0465, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.8498, Accuracy: 54/10000 (0.5400%)
time spent on training: 344.1937999725342
___Test Target_ResNet_18 poisoned: False, epoch: 33: Avg loss: 6.6423, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Avg loss: 1.6777, Accuracy: 0/9950 (0.0000%)
saving model
Done in 804.8086795806885 sec.
Server Epoch:34 choose agents : [0, 71, 20, 83, 56, 36, 68, 89, 82, 19].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   1, Avg loss: 0.0615, Accuracy: 265/1657 (15.9928%)
___Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   2, Avg loss: 0.0353, Accuracy: 491/1657 (29.6319%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.4119, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0884, Accuracy: 63/818 (7.7017%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0336, Accuracy: 325/818 (39.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 10.0309, Accuracy: 66/10000 (0.6600%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   1, Avg loss: 0.0795, Accuracy: 140/807 (17.3482%)
___Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   2, Avg loss: 0.0349, Accuracy: 408/807 (50.5576%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.1355, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0662, Accuracy: 286/1953 (14.6441%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0351, Accuracy: 702/1953 (35.9447%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.2694, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   1, Avg loss: 0.1267, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   2, Avg loss: 0.0984, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.6860, Accuracy: 64/10000 (0.6400%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   1, Avg loss: 0.1287, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   2, Avg loss: 0.0656, Accuracy: 94/408 (23.0392%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.1159, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   1, Avg loss: 0.0791, Accuracy: 237/1163 (20.3783%)
___Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   2, Avg loss: 0.0397, Accuracy: 455/1163 (39.1230%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.9939, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   1, Avg loss: 0.0830, Accuracy: 213/896 (23.7723%)
___Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   2, Avg loss: 0.0387, Accuracy: 461/896 (51.4509%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.0553, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.1047, Accuracy: 1/500 (0.2000%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0525, Accuracy: 154/500 (30.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.6616, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   1, Avg loss: 0.0672, Accuracy: 251/1036 (24.2278%)
___Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   2, Avg loss: 0.0277, Accuracy: 664/1036 (64.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 13.4171, Accuracy: 73/10000 (0.7300%)
time spent on training: 254.61645650863647
___Test Target_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.9577, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Avg loss: 1.1106, Accuracy: 5655/9950 (56.8342%)
saving model
Done in 714.283182144165 sec.
Server Epoch:35 choose agents : [18, 75, 5, 22, 38, 73, 46, 20, 83, 88].
poison local model 18 index 7 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   1, Average loss: 0.0423, Accuracy: 317/530 (59.8113%), train_poison_data_count: 338
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   2, Average loss: 0.0303, Accuracy: 342/530 (64.5283%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   3, Average loss: 0.0269, Accuracy: 341/530 (64.3396%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   4, Average loss: 0.0246, Accuracy: 358/530 (67.5472%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   5, Average loss: 0.0241, Accuracy: 353/530 (66.6038%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   6, Average loss: 0.0232, Accuracy: 364/530 (68.6792%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   7, Average loss: 0.0223, Accuracy: 366/530 (69.0566%), train_poison_data_count: 338
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   8, Average loss: 0.0230, Accuracy: 356/530 (67.1698%), train_poison_data_count: 338
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   9, Average loss: 0.0209, Accuracy: 363/530 (68.4906%), train_poison_data_count: 338
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch  10, Average loss: 0.0209, Accuracy: 369/530 (69.6226%), train_poison_data_count: 338
Global model norm: 225.36124646054387.
Norm before scaling: 225.3432884650661. Distance: 0.5303586606833797
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.9743, Accuracy: 62/10000 (0.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.0567, Accuracy: 9933/9950 (99.8291%)
Scaling by  100
Scaled Norm after poisoning: 229.70140264047149, distance: 53.03586732256059
Total norm for 3 adversaries is: 229.70140264047149. distance: 53.03586732256059
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   1, Avg loss: 0.0912, Accuracy: 119/776 (15.3351%)
___Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   2, Avg loss: 0.0347, Accuracy: 407/776 (52.4485%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.6413, Accuracy: 57/10000 (0.5700%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   1, Avg loss: 0.0540, Accuracy: 296/1628 (18.1818%)
___Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 763/1628 (46.8673%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.6002, Accuracy: 140/10000 (1.4000%)
___Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   1, Avg loss: 0.0628, Accuracy: 361/1470 (24.5578%)
___Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   2, Avg loss: 0.0258, Accuracy: 836/1470 (56.8707%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.9253, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   1, Avg loss: 0.0835, Accuracy: 165/1131 (14.5889%)
___Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   2, Avg loss: 0.0339, Accuracy: 473/1131 (41.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.6430, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   1, Avg loss: 0.0649, Accuracy: 207/938 (22.0682%)
___Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 364/938 (38.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 10.1800, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   1, Avg loss: 0.0627, Accuracy: 349/1904 (18.3298%)
___Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 691/1904 (36.2920%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.5035, Accuracy: 109/10000 (1.0900%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   1, Avg loss: 0.0738, Accuracy: 158/807 (19.5787%)
___Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   2, Avg loss: 0.0347, Accuracy: 425/807 (52.6642%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.2221, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   1, Avg loss: 0.0634, Accuracy: 343/1953 (17.5627%)
___Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   2, Avg loss: 0.0348, Accuracy: 710/1953 (36.3543%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.6530, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   1, Avg loss: 0.0919, Accuracy: 35/603 (5.8043%)
___Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   2, Avg loss: 0.0488, Accuracy: 281/603 (46.6003%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.4802, Accuracy: 57/10000 (0.5700%)
time spent on training: 320.94780826568604
___Test Target_ResNet_18 poisoned: False, epoch: 35: Avg loss: 6.8132, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Avg loss: 1.5574, Accuracy: 0/9950 (0.0000%)
saving model
Done in 759.8537938594818 sec.
Server Epoch:36 choose agents : [19, 2, 97, 73, 5, 51, 21, 63, 11, 90].
___Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   1, Avg loss: 0.0633, Accuracy: 284/1036 (27.4131%)
___Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   2, Avg loss: 0.0264, Accuracy: 668/1036 (64.4788%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 12.8362, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0893, Accuracy: 58/605 (9.5868%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0439, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.3846, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   1, Avg loss: 0.0644, Accuracy: 279/1213 (23.0008%)
___Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   2, Avg loss: 0.0288, Accuracy: 512/1213 (42.2094%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.3181, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   1, Avg loss: 0.0657, Accuracy: 185/938 (19.7228%)
___Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   2, Avg loss: 0.0342, Accuracy: 343/938 (36.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.0493, Accuracy: 64/10000 (0.6400%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   1, Avg loss: 0.0530, Accuracy: 327/1628 (20.0860%)
___Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   2, Avg loss: 0.0260, Accuracy: 776/1628 (47.6658%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.7122, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0813, Accuracy: 134/1049 (12.7741%)
___Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0313, Accuracy: 470/1049 (44.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.8943, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   1, Avg loss: 0.0632, Accuracy: 279/1949 (14.3150%)
___Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 622/1949 (31.9138%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.0746, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   1, Avg loss: 0.0883, Accuracy: 106/888 (11.9369%)
___Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   2, Avg loss: 0.0286, Accuracy: 435/888 (48.9865%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 11.0263, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0842, Accuracy: 143/712 (20.0843%)
___Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0305, Accuracy: 431/712 (60.5337%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 10.8404, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   1, Avg loss: 0.0637, Accuracy: 161/677 (23.7814%)
___Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   2, Avg loss: 0.0210, Accuracy: 455/677 (67.2083%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 12.3900, Accuracy: 64/10000 (0.6400%)
time spent on training: 216.09900760650635
___Test Target_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.6121, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Avg loss: 1.8696, Accuracy: 0/9950 (0.0000%)
saving model
Done in 661.0508503913879 sec.
Server Epoch:37 choose agents : [20, 66, 18, 64, 77, 51, 65, 3, 17, 50].
poison local model 20 index 8 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   1, Average loss: 0.0406, Accuracy: 504/807 (62.4535%), train_poison_data_count: 519
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   2, Average loss: 0.0258, Accuracy: 508/807 (62.9492%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   3, Average loss: 0.0195, Accuracy: 548/807 (67.9058%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   4, Average loss: 0.0207, Accuracy: 534/807 (66.1710%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   5, Average loss: 0.0205, Accuracy: 542/807 (67.1623%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   6, Average loss: 0.0201, Accuracy: 545/807 (67.5341%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   7, Average loss: 0.0203, Accuracy: 542/807 (67.1623%), train_poison_data_count: 519
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   8, Average loss: 0.0189, Accuracy: 569/807 (70.5081%), train_poison_data_count: 519
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   9, Average loss: 0.0188, Accuracy: 558/807 (69.1450%), train_poison_data_count: 519
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch  10, Average loss: 0.0194, Accuracy: 566/807 (70.1363%), train_poison_data_count: 519
Global model norm: 230.29166289729204.
Norm before scaling: 230.26263876821181. Distance: 0.6966798175440551
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.1537, Accuracy: 58/10000 (0.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.1444, Accuracy: 9808/9950 (98.5729%)
Scaling by  100
Scaled Norm after poisoning: 237.70285744496215, distance: 69.6679870383001
Total norm for 4 adversaries is: 237.70285744496215. distance: 69.6679870383001
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   1, Avg loss: 0.0753, Accuracy: 200/1402 (14.2653%)
___Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   2, Avg loss: 0.0424, Accuracy: 369/1402 (26.3195%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.2352, Accuracy: 72/10000 (0.7200%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   1, Avg loss: 0.0433, Accuracy: 197/530 (37.1698%)
___Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   2, Avg loss: 0.0321, Accuracy: 330/530 (62.2642%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.5251, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   1, Avg loss: 0.0776, Accuracy: 120/953 (12.5918%)
___Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   2, Avg loss: 0.0407, Accuracy: 302/953 (31.6894%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.1890, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0678, Accuracy: 238/1340 (17.7612%)
___Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0295, Accuracy: 558/1340 (41.6418%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.8867, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0770, Accuracy: 147/1049 (14.0133%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0326, Accuracy: 459/1049 (43.7560%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.7250, Accuracy: 111/10000 (1.1100%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   1, Avg loss: 0.0668, Accuracy: 314/1475 (21.2881%)
___Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   2, Avg loss: 0.0341, Accuracy: 616/1475 (41.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.5508, Accuracy: 84/10000 (0.8400%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   1, Avg loss: 0.0805, Accuracy: 43/781 (5.5058%)
___Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   2, Avg loss: 0.0349, Accuracy: 244/781 (31.2420%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.4732, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   1, Avg loss: 0.0620, Accuracy: 245/1574 (15.5654%)
___Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   2, Avg loss: 0.0301, Accuracy: 593/1574 (37.6747%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.2241, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   1, Avg loss: 0.0778, Accuracy: 69/809 (8.5290%)
___Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   2, Avg loss: 0.0292, Accuracy: 326/809 (40.2967%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 10.7418, Accuracy: 93/10000 (0.9300%)
time spent on training: 325.08374190330505
___Test Target_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.4192, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Avg loss: 1.6884, Accuracy: 30/9950 (0.3015%)
saving model
Done in 776.1615335941315 sec.
Server Epoch:38 choose agents : [88, 72, 77, 38, 20, 39, 70, 1, 37, 6].
___Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0952, Accuracy: 35/603 (5.8043%)
___Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0492, Accuracy: 275/603 (45.6053%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.5725, Accuracy: 63/10000 (0.6300%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0745, Accuracy: 166/1241 (13.3763%)
___Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0383, Accuracy: 413/1241 (33.2796%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.4577, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0706, Accuracy: 246/1340 (18.3582%)
___Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0295, Accuracy: 584/1340 (43.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 10.1304, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0838, Accuracy: 139/1131 (12.2900%)
___Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0316, Accuracy: 517/1131 (45.7118%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.8624, Accuracy: 83/10000 (0.8300%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0348, Accuracy: 374/807 (46.3445%)
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0250, Accuracy: 454/807 (56.2577%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.5748, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0711, Accuracy: 149/1013 (14.7088%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0269, Accuracy: 491/1013 (48.4699%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 10.1360, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0738, Accuracy: 238/1418 (16.7842%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0341, Accuracy: 594/1418 (41.8900%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.4887, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0700, Accuracy: 204/928 (21.9828%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0261, Accuracy: 592/928 (63.7931%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 10.3923, Accuracy: 94/10000 (0.9400%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0674, Accuracy: 285/1129 (25.2436%)
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0253, Accuracy: 706/1129 (62.5332%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 10.3811, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   1, Avg loss: 0.0651, Accuracy: 328/1956 (16.7689%)
___Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   2, Avg loss: 0.0337, Accuracy: 633/1956 (32.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.5318, Accuracy: 105/10000 (1.0500%)
time spent on training: 247.42947363853455
___Test Target_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.1688, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Avg loss: 1.6949, Accuracy: 30/9950 (0.3015%)
saving model
Done in 717.4094276428223 sec.
Server Epoch:39 choose agents : [24, 58, 63, 88, 9, 51, 54, 64, 13, 27].
poison local model 24 index 9 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   1, Average loss: 0.0438, Accuracy: 185/312 (59.2949%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   2, Average loss: 0.0364, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   3, Average loss: 0.0304, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   4, Average loss: 0.0284, Accuracy: 199/312 (63.7821%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   5, Average loss: 0.0273, Accuracy: 201/312 (64.4231%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   6, Average loss: 0.0256, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   7, Average loss: 0.0245, Accuracy: 201/312 (64.4231%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   8, Average loss: 0.0258, Accuracy: 198/312 (63.4615%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   9, Average loss: 0.0227, Accuracy: 196/312 (62.8205%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch  10, Average loss: 0.0239, Accuracy: 192/312 (61.5385%), train_poison_data_count: 200
Global model norm: 235.1073308751771.
Norm before scaling: 235.09904827540242. Distance: 0.3541679055061365
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.4981, Accuracy: 55/10000 (0.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: 0.2076, Accuracy: 9776/9950 (98.2513%)
Scaling by  100
Scaled Norm after poisoning: 236.91501146244406, distance: 35.41678978992079
Total norm for 3 adversaries is: 236.91501146244406. distance: 35.41678978992079
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0773, Accuracy: 192/803 (23.9103%)
___Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0382, Accuracy: 449/803 (55.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.5658, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0841, Accuracy: 102/888 (11.4865%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0275, Accuracy: 435/888 (48.9865%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 11.3640, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   1, Avg loss: 0.0906, Accuracy: 46/603 (7.6285%)
___Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   2, Avg loss: 0.0486, Accuracy: 287/603 (47.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.3060, Accuracy: 57/10000 (0.5700%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0501, Accuracy: 324/1275 (25.4118%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0188, Accuracy: 722/1275 (56.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 11.4793, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0813, Accuracy: 132/1049 (12.5834%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0318, Accuracy: 458/1049 (43.6606%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.7560, Accuracy: 110/10000 (1.1000%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   1, Avg loss: 0.0675, Accuracy: 229/1130 (20.2655%)
___Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   2, Avg loss: 0.0297, Accuracy: 451/1130 (39.9115%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 9.8841, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   1, Avg loss: 0.0796, Accuracy: 109/953 (11.4376%)
___Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   2, Avg loss: 0.0398, Accuracy: 298/953 (31.2697%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.1636, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   1, Avg loss: 0.0680, Accuracy: 265/1645 (16.1094%)
___Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   2, Avg loss: 0.0343, Accuracy: 586/1645 (35.6231%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.5985, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0642, Accuracy: 328/1587 (20.6679%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0344, Accuracy: 580/1587 (36.5469%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.5637, Accuracy: 65/10000 (0.6500%)
time spent on training: 312.8156294822693
___Test Target_ResNet_18 poisoned: False, epoch: 39: Avg loss: 6.2871, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Avg loss: 1.6872, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 768.6597168445587 sec.
Server Epoch:40 choose agents : [40, 88, 66, 47, 61, 96, 3, 5, 16, 24].
___Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   1, Avg loss: 0.0693, Accuracy: 232/1573 (14.7489%)
___Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   2, Avg loss: 0.0361, Accuracy: 566/1573 (35.9822%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.0938, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   1, Avg loss: 0.0878, Accuracy: 42/603 (6.9652%)
___Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   2, Avg loss: 0.0490, Accuracy: 283/603 (46.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.3143, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   1, Avg loss: 0.0759, Accuracy: 182/1402 (12.9815%)
___Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   2, Avg loss: 0.0410, Accuracy: 408/1402 (29.1013%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.2568, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1559, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1315, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.7384, Accuracy: 60/10000 (0.6000%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   1, Avg loss: 0.1513, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   2, Avg loss: 0.1409, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.5425, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   1, Avg loss: 0.1224, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   2, Avg loss: 0.0814, Accuracy: 29/311 (9.3248%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.6917, Accuracy: 51/10000 (0.5100%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   1, Avg loss: 0.0809, Accuracy: 42/781 (5.3777%)
___Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   2, Avg loss: 0.0348, Accuracy: 261/781 (33.4187%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.8466, Accuracy: 69/10000 (0.6900%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   1, Avg loss: 0.0520, Accuracy: 323/1628 (19.8403%)
___Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   2, Avg loss: 0.0264, Accuracy: 755/1628 (46.3759%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.5264, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   1, Avg loss: 0.0716, Accuracy: 173/708 (24.4350%)
___Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   2, Avg loss: 0.0371, Accuracy: 429/708 (60.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.5978, Accuracy: 65/10000 (0.6500%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   1, Avg loss: 0.0412, Accuracy: 99/312 (31.7308%)
___Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   2, Avg loss: 0.0292, Accuracy: 191/312 (61.2179%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.5809, Accuracy: 65/10000 (0.6500%)
time spent on training: 222.61155486106873
___Test Target_ResNet_18 poisoned: False, epoch: 40: Avg loss: 10.2043, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Avg loss: 4.7418, Accuracy: 523/9950 (5.2563%)
saving model
Saving model on epoch 40
Done in 676.0160536766052 sec.
Server Epoch:41 choose agents : [25, 36, 82, 2, 93, 42, 66, 94, 44, 38].
poison local model 25 index 10 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Average loss: 0.0439, Accuracy: 370/690 (53.6232%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Average loss: 0.0259, Accuracy: 392/690 (56.8116%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   3, Average loss: 0.0212, Accuracy: 415/690 (60.1449%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   4, Average loss: 0.0210, Accuracy: 440/690 (63.7681%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   5, Average loss: 0.0201, Accuracy: 435/690 (63.0435%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   6, Average loss: 0.0198, Accuracy: 438/690 (63.4783%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   7, Average loss: 0.0193, Accuracy: 457/690 (66.2319%), train_poison_data_count: 440
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   8, Average loss: 0.0196, Accuracy: 448/690 (64.9275%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   9, Average loss: 0.0187, Accuracy: 460/690 (66.6667%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch  10, Average loss: 0.0206, Accuracy: 438/690 (63.4783%), train_poison_data_count: 440
Global model norm: 239.85185857628872.
Norm before scaling: 239.82716758636832. Distance: 0.6582318760962568
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.9749, Accuracy: 55/10000 (0.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.2672, Accuracy: 9251/9950 (92.9749%)
Scaling by  100
Scaled Norm after poisoning: 246.2382770052211, distance: 65.82319772978975
Total norm for 4 adversaries is: 246.2382770052211. distance: 65.82319772978975
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   1, Avg loss: 0.1070, Accuracy: 2/408 (0.4902%)
___Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   2, Avg loss: 0.0630, Accuracy: 110/408 (26.9608%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.6320, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   1, Avg loss: 0.0920, Accuracy: 4/500 (0.8000%)
___Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   2, Avg loss: 0.0524, Accuracy: 171/500 (34.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.4834, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0825, Accuracy: 72/605 (11.9008%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0441, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.1543, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   1, Avg loss: 0.0650, Accuracy: 300/1742 (17.2216%)
___Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 659/1742 (37.8301%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.7355, Accuracy: 87/10000 (0.8700%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   1, Avg loss: 0.0682, Accuracy: 184/1372 (13.4111%)
___Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   2, Avg loss: 0.0330, Accuracy: 511/1372 (37.2449%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 9.7804, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0751, Accuracy: 185/1402 (13.1954%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0418, Accuracy: 367/1402 (26.1769%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.4093, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   1, Avg loss: 0.0666, Accuracy: 243/1662 (14.6209%)
___Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   2, Avg loss: 0.0352, Accuracy: 541/1662 (32.5511%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.6966, Accuracy: 106/10000 (1.0600%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0711, Accuracy: 307/1750 (17.5429%)
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0374, Accuracy: 646/1750 (36.9143%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.1871, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0765, Accuracy: 140/1131 (12.3784%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0330, Accuracy: 500/1131 (44.2087%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.7019, Accuracy: 88/10000 (0.8800%)
time spent on training: 347.27171516418457
___Test Target_ResNet_18 poisoned: False, epoch: 41: Avg loss: 10.2194, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.7205, Accuracy: 6649/9950 (66.8241%)
saving model
Saving model on epoch 41
Done in 806.6911430358887 sec.
Server Epoch:42 choose agents : [55, 57, 12, 67, 31, 76, 26, 6, 64, 97].
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   1, Avg loss: 0.0735, Accuracy: 162/1071 (15.1261%)
___Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   2, Avg loss: 0.0330, Accuracy: 481/1071 (44.9113%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 10.2723, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   1, Avg loss: 0.0774, Accuracy: 169/1154 (14.6447%)
___Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   2, Avg loss: 0.0287, Accuracy: 503/1154 (43.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 11.3050, Accuracy: 69/10000 (0.6900%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   1, Avg loss: 0.1186, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   2, Avg loss: 0.0552, Accuracy: 80/338 (23.6686%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.1687, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.1059, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0428, Accuracy: 128/426 (30.0469%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.6159, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.1120, Accuracy: 2/460 (0.4348%)
___Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0426, Accuracy: 178/460 (38.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.1172, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   1, Avg loss: 0.1106, Accuracy: 2/466 (0.4292%)
___Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   2, Avg loss: 0.0556, Accuracy: 163/466 (34.9785%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.5813, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   1, Avg loss: 0.0736, Accuracy: 212/1446 (14.6611%)
___Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   2, Avg loss: 0.0369, Accuracy: 488/1446 (33.7483%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.1228, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   1, Avg loss: 0.0664, Accuracy: 324/1956 (16.5644%)
___Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   2, Avg loss: 0.0346, Accuracy: 603/1956 (30.8282%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.6094, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0834, Accuracy: 118/953 (12.3820%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0411, Accuracy: 324/953 (33.9979%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.2768, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   1, Avg loss: 0.0723, Accuracy: 239/1213 (19.7032%)
___Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   2, Avg loss: 0.0289, Accuracy: 547/1213 (45.0948%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 10.0993, Accuracy: 83/10000 (0.8300%)
time spent on training: 221.31496143341064
___Test Target_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.8225, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Avg loss: 0.9552, Accuracy: 9950/9950 (100.0000%)
saving model
Saving model on epoch 42
Done in 676.5344061851501 sec.
Server Epoch:43 choose agents : [30, 89, 47, 67, 72, 23, 57, 51, 45, 60].
poison local model 30 index 11 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Average loss: 0.0468, Accuracy: 296/486 (60.9053%), train_poison_data_count: 318
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Average loss: 0.0362, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   3, Average loss: 0.0298, Accuracy: 309/486 (63.5802%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   4, Average loss: 0.0299, Accuracy: 310/486 (63.7860%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   5, Average loss: 0.0286, Accuracy: 316/486 (65.0206%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   6, Average loss: 0.0261, Accuracy: 321/486 (66.0494%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   7, Average loss: 0.0269, Accuracy: 319/486 (65.6379%), train_poison_data_count: 318
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   8, Average loss: 0.0270, Accuracy: 316/486 (65.0206%), train_poison_data_count: 318
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   9, Average loss: 0.0252, Accuracy: 316/486 (65.0206%), train_poison_data_count: 318
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch  10, Average loss: 0.0256, Accuracy: 315/486 (64.8148%), train_poison_data_count: 318
Global model norm: 244.48059579187466.
Norm before scaling: 244.4637626520544. Distance: 0.5037913819915032
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.5652, Accuracy: 52/10000 (0.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.1528, Accuracy: 9845/9950 (98.9447%)
Scaling by  100
Scaled Norm after poisoning: 247.91211743024988, distance: 50.37914113329171
Total norm for 3 adversaries is: 247.91211743024988. distance: 50.37914113329171
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0803, Accuracy: 220/896 (24.5536%)
___Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0403, Accuracy: 424/896 (47.3214%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.5219, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   1, Avg loss: 0.1729, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   2, Avg loss: 0.1352, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.0958, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   1, Avg loss: 0.0996, Accuracy: 1/426 (0.2347%)
___Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   2, Avg loss: 0.0435, Accuracy: 137/426 (32.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 9.0321, Accuracy: 61/10000 (0.6100%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   1, Avg loss: 0.0754, Accuracy: 149/1241 (12.0064%)
___Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   2, Avg loss: 0.0379, Accuracy: 395/1241 (31.8292%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.5843, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   1, Avg loss: 0.0814, Accuracy: 160/715 (22.3776%)
___Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   2, Avg loss: 0.0453, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.1445, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   1, Avg loss: 0.0731, Accuracy: 173/1154 (14.9913%)
___Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   2, Avg loss: 0.0294, Accuracy: 471/1154 (40.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 11.6862, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   1, Avg loss: 0.0767, Accuracy: 189/1049 (18.0172%)
___Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   2, Avg loss: 0.0319, Accuracy: 457/1049 (43.5653%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.4736, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0941, Accuracy: 51/669 (7.6233%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0434, Accuracy: 355/669 (53.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.9183, Accuracy: 65/10000 (0.6500%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   1, Avg loss: 0.0610, Accuracy: 491/2227 (22.0476%)
___Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   2, Avg loss: 0.0306, Accuracy: 939/2227 (42.1643%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.8323, Accuracy: 113/10000 (1.1300%)
time spent on training: 314.86392736434937
___Test Target_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.5299, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.5286, Accuracy: 8848/9950 (88.9246%)
saving model
Done in 761.3639640808105 sec.
Server Epoch:44 choose agents : [20, 45, 15, 72, 6, 60, 59, 46, 31, 84].
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0555, Accuracy: 219/807 (27.1375%)
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0299, Accuracy: 448/807 (55.5143%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.4677, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   1, Avg loss: 0.0837, Accuracy: 79/669 (11.8087%)
___Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   2, Avg loss: 0.0433, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.8469, Accuracy: 64/10000 (0.6400%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0544, Accuracy: 290/1154 (25.1300%)
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0277, Accuracy: 462/1154 (40.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 10.6382, Accuracy: 76/10000 (0.7600%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   1, Avg loss: 0.0718, Accuracy: 154/1241 (12.4093%)
___Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   2, Avg loss: 0.0385, Accuracy: 385/1241 (31.0234%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.4126, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   1, Avg loss: 0.0606, Accuracy: 337/1956 (17.2290%)
___Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   2, Avg loss: 0.0338, Accuracy: 570/1956 (29.1411%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.7096, Accuracy: 85/10000 (0.8500%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   1, Avg loss: 0.0596, Accuracy: 462/2227 (20.7454%)
___Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   2, Avg loss: 0.0299, Accuracy: 952/2227 (42.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.9543, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   1, Avg loss: 0.0709, Accuracy: 187/1089 (17.1717%)
___Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   2, Avg loss: 0.0329, Accuracy: 499/1089 (45.8219%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 10.2694, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   1, Avg loss: 0.0589, Accuracy: 357/1904 (18.7500%)
___Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 710/1904 (37.2899%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.2753, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0983, Accuracy: 5/460 (1.0870%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0432, Accuracy: 186/460 (40.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.7199, Accuracy: 51/10000 (0.5100%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   1, Avg loss: 0.0749, Accuracy: 236/1190 (19.8319%)
___Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 448/1190 (37.6471%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.5473, Accuracy: 82/10000 (0.8200%)
time spent on training: 298.62028455734253
___Test Target_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.4492, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Avg loss: 0.3677, Accuracy: 9256/9950 (93.0251%)
saving model
Done in 750.2024521827698 sec.
Server Epoch:45 choose agents : [33, 77, 72, 6, 23, 47, 93, 87, 53, 86].
poison local model 33 index 12 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   1, Average loss: 0.0484, Accuracy: 317/515 (61.5534%), train_poison_data_count: 323
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   2, Average loss: 0.0420, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   3, Average loss: 0.0368, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   4, Average loss: 0.0370, Accuracy: 322/515 (62.5243%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   5, Average loss: 0.0359, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   6, Average loss: 0.0350, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   7, Average loss: 0.0340, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   8, Average loss: 0.0338, Accuracy: 322/515 (62.5243%), train_poison_data_count: 323
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   9, Average loss: 0.0325, Accuracy: 324/515 (62.9126%), train_poison_data_count: 323
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch  10, Average loss: 0.0332, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Global model norm: 248.98673565322713.
Norm before scaling: 248.96688879999687. Distance: 0.5108041233415351
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.3178, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.2014, Accuracy: 9937/9950 (99.8693%)
Scaling by  100
Scaled Norm after poisoning: 252.16863312325344, distance: 51.08041444853766
Total norm for 2 adversaries is: 252.16863312325344. distance: 51.08041444853766
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   1, Avg loss: 0.0625, Accuracy: 274/1340 (20.4478%)
___Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   2, Avg loss: 0.0301, Accuracy: 564/1340 (42.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.8727, Accuracy: 84/10000 (0.8400%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   1, Avg loss: 0.0705, Accuracy: 144/1241 (11.6035%)
___Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   2, Avg loss: 0.0381, Accuracy: 391/1241 (31.5068%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.7001, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   1, Avg loss: 0.0600, Accuracy: 348/1956 (17.7914%)
___Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   2, Avg loss: 0.0345, Accuracy: 596/1956 (30.4703%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.5710, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   1, Avg loss: 0.0787, Accuracy: 171/715 (23.9161%)
___Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   2, Avg loss: 0.0450, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.0276, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   1, Avg loss: 0.1492, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   2, Avg loss: 0.1308, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.6590, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0656, Accuracy: 293/1742 (16.8197%)
___Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 665/1742 (38.1745%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.0948, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   1, Avg loss: 0.0768, Accuracy: 177/1131 (15.6499%)
___Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   2, Avg loss: 0.0324, Accuracy: 420/1131 (37.1353%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.1602, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   1, Avg loss: 0.0718, Accuracy: 164/813 (20.1722%)
___Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   2, Avg loss: 0.0213, Accuracy: 444/813 (54.6125%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 12.7954, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0794, Accuracy: 235/1003 (23.4297%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0392, Accuracy: 415/1003 (41.3759%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.6269, Accuracy: 54/10000 (0.5400%)
time spent on training: 319.7481849193573
___Test Target_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.3283, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.2748, Accuracy: 9415/9950 (94.6231%)
saving model
Done in 765.4380550384521 sec.
Server Epoch:46 choose agents : [43, 30, 40, 2, 69, 83, 22, 84, 91, 15].
___Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   1, Avg loss: 0.0732, Accuracy: 209/946 (22.0930%)
___Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   2, Avg loss: 0.0380, Accuracy: 369/946 (39.0063%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.7329, Accuracy: 61/10000 (0.6100%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0684, Accuracy: 49/486 (10.0823%)
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0363, Accuracy: 242/486 (49.7942%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.2422, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   1, Avg loss: 0.0693, Accuracy: 244/1573 (15.5118%)
___Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   2, Avg loss: 0.0360, Accuracy: 557/1573 (35.4100%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.3224, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0847, Accuracy: 71/605 (11.7355%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0447, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.9192, Accuracy: 56/10000 (0.5600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   1, Avg loss: 0.0673, Accuracy: 154/590 (26.1017%)
___Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   2, Avg loss: 0.0320, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 12.2479, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   1, Avg loss: 0.0665, Accuracy: 349/1953 (17.8699%)
___Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   2, Avg loss: 0.0352, Accuracy: 731/1953 (37.4296%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.2782, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   1, Avg loss: 0.0581, Accuracy: 382/1470 (25.9864%)
___Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   2, Avg loss: 0.0270, Accuracy: 830/1470 (56.4626%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 10.1772, Accuracy: 98/10000 (0.9800%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   1, Avg loss: 0.0766, Accuracy: 228/1190 (19.1597%)
___Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 484/1190 (40.6723%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.5283, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   1, Avg loss: 0.0660, Accuracy: 182/1030 (17.6699%)
___Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   2, Avg loss: 0.0274, Accuracy: 597/1030 (57.9612%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 11.3896, Accuracy: 94/10000 (0.9400%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0512, Accuracy: 316/1154 (27.3830%)
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0276, Accuracy: 463/1154 (40.1213%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.9725, Accuracy: 80/10000 (0.8000%)
time spent on training: 267.7956967353821
___Test Target_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.6988, Accuracy: 68/10000 (0.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Avg loss: 1.0346, Accuracy: 6108/9950 (61.3869%)
saving model
Done in 700.3215720653534 sec.
Server Epoch:47 choose agents : [36, 81, 80, 26, 12, 78, 60, 58, 75, 19].
poison local model 36 index 13 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   1, Average loss: 0.0457, Accuracy: 250/408 (61.2745%), train_poison_data_count: 264
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   2, Average loss: 0.0384, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   3, Average loss: 0.0350, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   4, Average loss: 0.0335, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   5, Average loss: 0.0318, Accuracy: 263/408 (64.4608%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   6, Average loss: 0.0285, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   7, Average loss: 0.0311, Accuracy: 263/408 (64.4608%), train_poison_data_count: 264
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   8, Average loss: 0.0296, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   9, Average loss: 0.0304, Accuracy: 259/408 (63.4804%), train_poison_data_count: 264
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch  10, Average loss: 0.0318, Accuracy: 257/408 (62.9902%), train_poison_data_count: 264
Global model norm: 253.42654107008997.
Norm before scaling: 253.4123908646734. Distance: 0.41140940733443104
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.5083, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.3027, Accuracy: 9758/9950 (98.0704%)
Scaling by  100
Scaled Norm after poisoning: 255.3126759485318, distance: 41.14094100002074
Total norm for 5 adversaries is: 255.3126759485318. distance: 41.14094100002074
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   1, Avg loss: 0.0779, Accuracy: 125/774 (16.1499%)
___Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   2, Avg loss: 0.0386, Accuracy: 307/774 (39.6641%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.6852, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0833, Accuracy: 59/682 (8.6510%)
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0403, Accuracy: 268/682 (39.2962%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.9801, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0698, Accuracy: 206/1446 (14.2462%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0369, Accuracy: 490/1446 (33.8866%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.3195, Accuracy: 70/10000 (0.7000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0911, Accuracy: 9/338 (2.6627%)
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0477, Accuracy: 124/338 (36.6864%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.2018, Accuracy: 51/10000 (0.5100%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   1, Avg loss: 0.0985, Accuracy: 1/416 (0.2404%)
___Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   2, Avg loss: 0.0510, Accuracy: 164/416 (39.4231%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.8079, Accuracy: 77/10000 (0.7700%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   1, Avg loss: 0.0589, Accuracy: 449/2227 (20.1617%)
___Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   2, Avg loss: 0.0299, Accuracy: 962/2227 (43.1971%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.7610, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   1, Avg loss: 0.0728, Accuracy: 206/803 (25.6538%)
___Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   2, Avg loss: 0.0374, Accuracy: 439/803 (54.6700%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.8340, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0925, Accuracy: 112/776 (14.4330%)
___Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0372, Accuracy: 406/776 (52.3196%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.5700, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0566, Accuracy: 291/1036 (28.0888%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0268, Accuracy: 628/1036 (60.6178%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 12.6372, Accuracy: 67/10000 (0.6700%)
time spent on training: 346.0399007797241
___Test Target_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.9743, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.2812, Accuracy: 9760/9950 (98.0905%)
saving model
Done in 794.6629610061646 sec.
Server Epoch:48 choose agents : [27, 96, 18, 95, 5, 47, 12, 39, 36, 82].
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0653, Accuracy: 302/1587 (19.0296%)
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0352, Accuracy: 554/1587 (34.9086%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.2993, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.1232, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0770, Accuracy: 37/311 (11.8971%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.6977, Accuracy: 51/10000 (0.5100%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   1, Avg loss: 0.0825, Accuracy: 27/530 (5.0943%)
___Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   2, Avg loss: 0.0358, Accuracy: 289/530 (54.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 10.2421, Accuracy: 68/10000 (0.6800%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0990, Accuracy: 87/599 (14.5242%)
___Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0350, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 14.8014, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   1, Avg loss: 0.0580, Accuracy: 305/1628 (18.7346%)
___Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   2, Avg loss: 0.0265, Accuracy: 766/1628 (47.0516%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 10.2073, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   1, Avg loss: 0.1646, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   2, Avg loss: 0.1356, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.4229, Accuracy: 47/10000 (0.4700%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   1, Avg loss: 0.1004, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   2, Avg loss: 0.0487, Accuracy: 100/338 (29.5858%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.8273, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0698, Accuracy: 163/1013 (16.0908%)
___Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 479/1013 (47.2853%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 10.3374, Accuracy: 82/10000 (0.8200%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   1, Avg loss: 0.0636, Accuracy: 52/408 (12.7451%)
___Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   2, Avg loss: 0.0404, Accuracy: 163/408 (39.9510%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.5657, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0919, Accuracy: 5/500 (1.0000%)
___Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 165/500 (33.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.0747, Accuracy: 63/10000 (0.6300%)
time spent on training: 241.25146007537842
___Test Target_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.3934, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Avg loss: 0.6239, Accuracy: 8078/9950 (81.1859%)
saving model
Done in 678.2413046360016 sec.
Server Epoch:49 choose agents : [37, 21, 63, 60, 36, 6, 17, 29, 9, 90].
poison local model 37 index 14 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   1, Average loss: 0.0397, Accuracy: 711/1129 (62.9761%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   2, Average loss: 0.0231, Accuracy: 683/1129 (60.4960%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   3, Average loss: 0.0219, Accuracy: 705/1129 (62.4446%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   4, Average loss: 0.0205, Accuracy: 694/1129 (61.4703%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   5, Average loss: 0.0198, Accuracy: 704/1129 (62.3561%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   6, Average loss: 0.0202, Accuracy: 697/1129 (61.7360%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   7, Average loss: 0.0209, Accuracy: 673/1129 (59.6103%), train_poison_data_count: 720
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   8, Average loss: 0.0192, Accuracy: 690/1129 (61.1160%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   9, Average loss: 0.0191, Accuracy: 701/1129 (62.0903%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch  10, Average loss: 0.0193, Accuracy: 719/1129 (63.6847%), train_poison_data_count: 720
Global model norm: 257.81449241654354.
Norm before scaling: 257.7656396806991. Distance: 0.8582560103195158
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.4952, Accuracy: 64/10000 (0.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.3040, Accuracy: 9573/9950 (96.2111%)
Scaling by  100
Scaled Norm after poisoning: 266.91189733224707, distance: 85.82559475380144
Total norm for 4 adversaries is: 266.91189733224707. distance: 85.82559475380144
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0599, Accuracy: 337/1949 (17.2909%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0335, Accuracy: 644/1949 (33.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.1713, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   1, Avg loss: 0.0825, Accuracy: 120/888 (13.5135%)
___Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   2, Avg loss: 0.0276, Accuracy: 452/888 (50.9009%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 10.8543, Accuracy: 64/10000 (0.6400%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   1, Avg loss: 0.0585, Accuracy: 465/2227 (20.8801%)
___Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   2, Avg loss: 0.0297, Accuracy: 991/2227 (44.4993%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.0522, Accuracy: 125/10000 (1.2500%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   1, Avg loss: 0.0621, Accuracy: 48/408 (11.7647%)
___Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   2, Avg loss: 0.0408, Accuracy: 167/408 (40.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.6568, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   1, Avg loss: 0.0594, Accuracy: 349/1956 (17.8425%)
___Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   2, Avg loss: 0.0329, Accuracy: 671/1956 (34.3047%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.7712, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0638, Accuracy: 244/1574 (15.5019%)
___Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0306, Accuracy: 572/1574 (36.3405%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.2512, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   1, Avg loss: 0.0609, Accuracy: 307/1440 (21.3194%)
___Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   2, Avg loss: 0.0311, Accuracy: 659/1440 (45.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.1523, Accuracy: 77/10000 (0.7700%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   1, Avg loss: 0.0522, Accuracy: 305/1275 (23.9216%)
___Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 710/1275 (55.6863%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 12.1560, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   1, Avg loss: 0.0585, Accuracy: 182/677 (26.8833%)
___Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   2, Avg loss: 0.0211, Accuracy: 461/677 (68.0945%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 12.6789, Accuracy: 59/10000 (0.5900%)
time spent on training: 397.5967664718628
___Test Target_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.2765, Accuracy: 70/10000 (0.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.7936, Accuracy: 6919/9950 (69.5377%)
saving model
Done in 840.4449136257172 sec.
Server Epoch:50 choose agents : [74, 58, 95, 2, 46, 62, 37, 81, 28, 99].
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   1, Avg loss: 0.0632, Accuracy: 343/1552 (22.1005%)
___Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   2, Avg loss: 0.0221, Accuracy: 784/1552 (50.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 11.5748, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   1, Avg loss: 0.0922, Accuracy: 136/803 (16.9365%)
___Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   2, Avg loss: 0.0406, Accuracy: 449/803 (55.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.7798, Accuracy: 58/10000 (0.5800%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   1, Avg loss: 0.1139, Accuracy: 49/599 (8.1803%)
___Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   2, Avg loss: 0.0358, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 15.2854, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.0954, Accuracy: 33/605 (5.4545%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0460, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.2072, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0636, Accuracy: 342/1904 (17.9622%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 725/1904 (38.0777%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.2946, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   1, Avg loss: 0.1114, Accuracy: 14/568 (2.4648%)
___Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   2, Avg loss: 0.0537, Accuracy: 258/568 (45.4225%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.9490, Accuracy: 60/10000 (0.6000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   1, Avg loss: 0.0275, Accuracy: 623/1129 (55.1816%)
___Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   2, Avg loss: 0.0189, Accuracy: 768/1129 (68.0248%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.1962, Accuracy: 105/10000 (1.0500%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0939, Accuracy: 100/774 (12.9199%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0411, Accuracy: 294/774 (37.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.2088, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   1, Avg loss: 0.0791, Accuracy: 264/1581 (16.6983%)
___Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   2, Avg loss: 0.0362, Accuracy: 506/1581 (32.0051%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.3864, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   1, Avg loss: 0.0944, Accuracy: 88/773 (11.3842%)
___Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   2, Avg loss: 0.0356, Accuracy: 376/773 (48.6417%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 10.0486, Accuracy: 66/10000 (0.6600%)
time spent on training: 280.7473440170288
___Test Target_ResNet_18 poisoned: False, epoch: 50: Avg loss: 10.1890, Accuracy: 70/10000 (0.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Avg loss: 1.9270, Accuracy: 2019/9950 (20.2915%)
saving model
Saving model on epoch 50
Done in 727.7653317451477 sec.
Server Epoch:51 choose agents : [42, 17, 32, 59, 73, 33, 77, 93, 8, 90].
poison local model 42 index 15 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Average loss: 0.0454, Accuracy: 819/1372 (59.6939%), train_poison_data_count: 868
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Average loss: 0.0270, Accuracy: 851/1372 (62.0262%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   3, Average loss: 0.0233, Accuracy: 856/1372 (62.3907%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   4, Average loss: 0.0236, Accuracy: 852/1372 (62.0991%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   5, Average loss: 0.0226, Accuracy: 859/1372 (62.6093%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   6, Average loss: 0.0229, Accuracy: 873/1372 (63.6297%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   7, Average loss: 0.0223, Accuracy: 853/1372 (62.1720%), train_poison_data_count: 868
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   8, Average loss: 0.0225, Accuracy: 864/1372 (62.9738%), train_poison_data_count: 868
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   9, Average loss: 0.0224, Accuracy: 862/1372 (62.8280%), train_poison_data_count: 868
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch  10, Average loss: 0.0220, Accuracy: 869/1372 (63.3382%), train_poison_data_count: 868
Global model norm: 262.0815265571002.
Norm before scaling: 262.0175626270117. Distance: 1.0295226339934076
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.6881, Accuracy: 55/10000 (0.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: 0.4216, Accuracy: 9650/9950 (96.9849%)
Scaling by  100
Scaled Norm after poisoning: 275.3671980283781, distance: 102.95226537241665
Total norm for 2 adversaries is: 275.3671980283781. distance: 102.95226537241665
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   1, Avg loss: 0.0684, Accuracy: 262/1574 (16.6455%)
___Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   2, Avg loss: 0.0306, Accuracy: 584/1574 (37.1029%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.4440, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   1, Avg loss: 0.0707, Accuracy: 135/735 (18.3673%)
___Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   2, Avg loss: 0.0274, Accuracy: 360/735 (48.9796%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 11.8121, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0781, Accuracy: 171/1089 (15.7025%)
___Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0308, Accuracy: 451/1089 (41.4141%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 10.9475, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   1, Avg loss: 0.0753, Accuracy: 181/938 (19.2964%)
___Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   2, Avg loss: 0.0362, Accuracy: 327/938 (34.8614%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.0001, Accuracy: 72/10000 (0.7200%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0953, Accuracy: 1/515 (0.1942%)
___Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0535, Accuracy: 154/515 (29.9029%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.8233, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   1, Avg loss: 0.0673, Accuracy: 246/1340 (18.3582%)
___Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   2, Avg loss: 0.0296, Accuracy: 573/1340 (42.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.7358, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0667, Accuracy: 276/1742 (15.8439%)
___Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0327, Accuracy: 658/1742 (37.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.6310, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0738, Accuracy: 168/1513 (11.1038%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0384, Accuracy: 425/1513 (28.0899%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.1758, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   1, Avg loss: 0.0712, Accuracy: 127/677 (18.7592%)
___Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   2, Avg loss: 0.0217, Accuracy: 459/677 (67.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 12.2732, Accuracy: 58/10000 (0.5800%)
time spent on training: 363.11923480033875
___Test Target_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.3216, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 51: Avg loss: 0.5706, Accuracy: 9116/9950 (91.6181%)
saving model
Done in 794.4697787761688 sec.
Server Epoch:52 choose agents : [13, 59, 3, 73, 63, 7, 86, 32, 51, 89].
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0726, Accuracy: 244/1645 (14.8328%)
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0345, Accuracy: 580/1645 (35.2584%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.9576, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   1, Avg loss: 0.0786, Accuracy: 139/1089 (12.7640%)
___Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   2, Avg loss: 0.0296, Accuracy: 483/1089 (44.3526%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.5469, Accuracy: 87/10000 (0.8700%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   1, Avg loss: 0.0917, Accuracy: 16/781 (2.0487%)
___Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   2, Avg loss: 0.0369, Accuracy: 253/781 (32.3944%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.3633, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   1, Avg loss: 0.0767, Accuracy: 193/938 (20.5757%)
___Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   2, Avg loss: 0.0367, Accuracy: 318/938 (33.9019%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.9313, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   1, Avg loss: 0.0915, Accuracy: 83/888 (9.3468%)
___Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   2, Avg loss: 0.0292, Accuracy: 392/888 (44.1441%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 11.3392, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0776, Accuracy: 155/891 (17.3962%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0293, Accuracy: 430/891 (48.2604%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.0961, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   1, Avg loss: 0.0817, Accuracy: 213/1003 (21.2363%)
___Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   2, Avg loss: 0.0393, Accuracy: 366/1003 (36.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.2322, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0720, Accuracy: 121/735 (16.4626%)
___Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0261, Accuracy: 359/735 (48.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 11.7797, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   1, Avg loss: 0.0904, Accuracy: 124/1049 (11.8208%)
___Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   2, Avg loss: 0.0330, Accuracy: 466/1049 (44.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.4586, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0908, Accuracy: 167/896 (18.6384%)
___Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0419, Accuracy: 435/896 (48.5491%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.3475, Accuracy: 57/10000 (0.5700%)
time spent on training: 227.1855182647705
___Test Target_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.6257, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 52: Avg loss: 0.6957, Accuracy: 8350/9950 (83.9196%)
saving model
Done in 672.0518937110901 sec.
Server Epoch:53 choose agents : [44, 63, 19, 5, 11, 69, 60, 51, 37, 90].
poison local model 44 index 16 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Average loss: 0.0450, Accuracy: 1076/1750 (61.4857%), train_poison_data_count: 1102
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Average loss: 0.0287, Accuracy: 1081/1750 (61.7714%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   3, Average loss: 0.0263, Accuracy: 1090/1750 (62.2857%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   4, Average loss: 0.0246, Accuracy: 1089/1750 (62.2286%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   5, Average loss: 0.0252, Accuracy: 1096/1750 (62.6286%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   6, Average loss: 0.0247, Accuracy: 1100/1750 (62.8571%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   7, Average loss: 0.0241, Accuracy: 1102/1750 (62.9714%), train_poison_data_count: 1102
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   8, Average loss: 0.0233, Accuracy: 1107/1750 (63.2571%), train_poison_data_count: 1102
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   9, Average loss: 0.0236, Accuracy: 1111/1750 (63.4857%), train_poison_data_count: 1102
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch  10, Average loss: 0.0240, Accuracy: 1098/1750 (62.7429%), train_poison_data_count: 1102
Global model norm: 266.2588173422619.
Norm before scaling: 266.1727881001362. Distance: 1.1681309718126835
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.0017, Accuracy: 61/10000 (0.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 53: Avg loss: 0.3280, Accuracy: 9818/9950 (98.6734%)
Scaling by  100
Scaled Norm after poisoning: 282.52616029316647, distance: 116.81310610463409
Total norm for 5 adversaries is: 282.52616029316647. distance: 116.81310610463409
___Test Local_ResNet_18 poisoned: True, epoch: 53: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   1, Avg loss: 0.0851, Accuracy: 109/888 (12.2748%)
___Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   2, Avg loss: 0.0282, Accuracy: 417/888 (46.9595%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 11.8503, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0661, Accuracy: 234/1036 (22.5869%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0263, Accuracy: 620/1036 (59.8456%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 13.1839, Accuracy: 73/10000 (0.7300%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0651, Accuracy: 264/1628 (16.2162%)
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0267, Accuracy: 757/1628 (46.4988%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.6041, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   1, Avg loss: 0.0947, Accuracy: 119/712 (16.7135%)
___Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   2, Avg loss: 0.0348, Accuracy: 443/712 (62.2191%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.5390, Accuracy: 67/10000 (0.6700%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0727, Accuracy: 136/590 (23.0508%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0349, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 13.0771, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   1, Avg loss: 0.0577, Accuracy: 491/2227 (22.0476%)
___Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   2, Avg loss: 0.0292, Accuracy: 980/2227 (44.0054%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.5332, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   1, Avg loss: 0.0859, Accuracy: 144/1049 (13.7274%)
___Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   2, Avg loss: 0.0329, Accuracy: 455/1049 (43.3746%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.6945, Accuracy: 101/10000 (1.0100%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 363/1129 (32.1523%)
___Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   2, Avg loss: 0.0223, Accuracy: 753/1129 (66.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.6919, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   1, Avg loss: 0.0746, Accuracy: 132/677 (19.4978%)
___Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 12.5313, Accuracy: 61/10000 (0.6100%)
time spent on training: 412.47284984588623
___Test Target_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.8343, Accuracy: 91/10000 (0.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 53: Avg loss: 1.1470, Accuracy: 5933/9950 (59.6281%)
saving model
Done in 853.1077210903168 sec.
Server Epoch:54 choose agents : [87, 90, 28, 63, 1, 47, 46, 66, 40, 91].
___Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   1, Avg loss: 0.0799, Accuracy: 173/1131 (15.2962%)
___Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   2, Avg loss: 0.0335, Accuracy: 399/1131 (35.2785%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.1470, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   1, Avg loss: 0.0764, Accuracy: 125/677 (18.4638%)
___Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 466/677 (68.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 12.4971, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0741, Accuracy: 241/1581 (15.2435%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0358, Accuracy: 576/1581 (36.4326%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.5477, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   1, Avg loss: 0.0850, Accuracy: 92/888 (10.3604%)
___Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   2, Avg loss: 0.0278, Accuracy: 453/888 (51.0135%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 11.1659, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0707, Accuracy: 175/928 (18.8578%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0254, Accuracy: 543/928 (58.5129%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 10.7352, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1711, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1419, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.2338, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0640, Accuracy: 333/1904 (17.4895%)
___Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 664/1904 (34.8739%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.5662, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0808, Accuracy: 155/1402 (11.0556%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0412, Accuracy: 383/1402 (27.3181%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.2743, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   1, Avg loss: 0.0706, Accuracy: 247/1573 (15.7025%)
___Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   2, Avg loss: 0.0361, Accuracy: 568/1573 (36.1093%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.0630, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   1, Avg loss: 0.0708, Accuracy: 181/1030 (17.5728%)
___Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   2, Avg loss: 0.0258, Accuracy: 647/1030 (62.8155%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 11.1107, Accuracy: 102/10000 (1.0200%)
time spent on training: 234.03121399879456
___Test Target_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.2003, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 54: Avg loss: 2.6764, Accuracy: 0/9950 (0.0000%)
saving model
Done in 669.832257270813 sec.
Server Epoch:55 choose agents : [48, 41, 73, 59, 13, 26, 32, 57, 99, 55].
poison local model 48 index 17 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   1, Average loss: 0.0491, Accuracy: 374/631 (59.2710%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   2, Average loss: 0.0370, Accuracy: 397/631 (62.9160%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   3, Average loss: 0.0347, Accuracy: 359/631 (56.8938%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   4, Average loss: 0.0325, Accuracy: 379/631 (60.0634%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   5, Average loss: 0.0319, Accuracy: 392/631 (62.1236%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   6, Average loss: 0.0297, Accuracy: 394/631 (62.4406%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   7, Average loss: 0.0299, Accuracy: 395/631 (62.5990%), train_poison_data_count: 400
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   8, Average loss: 0.0294, Accuracy: 403/631 (63.8669%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   9, Average loss: 0.0297, Accuracy: 394/631 (62.4406%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch  10, Average loss: 0.0285, Accuracy: 392/631 (62.1236%), train_poison_data_count: 400
Global model norm: 270.36445309988517.
Norm before scaling: 270.3393411529295. Distance: 0.5966548134072158
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.6286, Accuracy: 56/10000 (0.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 55: Avg loss: 0.3661, Accuracy: 9533/9950 (95.8090%)
Scaling by  100
Scaled Norm after poisoning: 274.3447733919857, distance: 59.665481868183214
Total norm for 2 adversaries is: 274.3447733919857. distance: 59.665481868183214
___Test Local_ResNet_18 poisoned: True, epoch: 55: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   1, Avg loss: 0.0894, Accuracy: 118/719 (16.4117%)
___Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   2, Avg loss: 0.0394, Accuracy: 470/719 (65.3686%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.1265, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0706, Accuracy: 206/938 (21.9616%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0350, Accuracy: 329/938 (35.0746%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.7912, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   1, Avg loss: 0.0761, Accuracy: 168/1089 (15.4270%)
___Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   2, Avg loss: 0.0315, Accuracy: 450/1089 (41.3223%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.5169, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0630, Accuracy: 297/1645 (18.0547%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0346, Accuracy: 571/1645 (34.7112%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.6847, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0767, Accuracy: 208/1446 (14.3845%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0374, Accuracy: 507/1446 (35.0622%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.3706, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   1, Avg loss: 0.0677, Accuracy: 147/735 (20.0000%)
___Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   2, Avg loss: 0.0258, Accuracy: 353/735 (48.0272%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 12.1613, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   1, Avg loss: 0.0741, Accuracy: 173/1154 (14.9913%)
___Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   2, Avg loss: 0.0288, Accuracy: 495/1154 (42.8943%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 11.4226, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0889, Accuracy: 94/773 (12.1604%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0351, Accuracy: 374/773 (48.3829%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.7968, Accuracy: 69/10000 (0.6900%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0731, Accuracy: 152/1071 (14.1923%)
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0319, Accuracy: 518/1071 (48.3660%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.8951, Accuracy: 83/10000 (0.8300%)
time spent on training: 327.8637704849243
___Test Target_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.0139, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 55: Avg loss: 0.4369, Accuracy: 9016/9950 (90.6131%)
saving model
Done in 762.0285038948059 sec.
Server Epoch:56 choose agents : [70, 37, 13, 11, 65, 80, 49, 18, 26, 82].
___Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   1, Avg loss: 0.0725, Accuracy: 256/1418 (18.0536%)
___Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   2, Avg loss: 0.0346, Accuracy: 624/1418 (44.0056%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.7056, Accuracy: 90/10000 (0.9000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   1, Avg loss: 0.0552, Accuracy: 338/1129 (29.9380%)
___Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   2, Avg loss: 0.0231, Accuracy: 729/1129 (64.5704%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.1605, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0652, Accuracy: 290/1645 (17.6292%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0344, Accuracy: 561/1645 (34.1033%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.6840, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   1, Avg loss: 0.0829, Accuracy: 168/712 (23.5955%)
___Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   2, Avg loss: 0.0328, Accuracy: 448/712 (62.9213%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.4190, Accuracy: 67/10000 (0.6700%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0703, Accuracy: 278/1475 (18.8475%)
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0352, Accuracy: 590/1475 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.0538, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   1, Avg loss: 0.0819, Accuracy: 84/682 (12.3167%)
___Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   2, Avg loss: 0.0399, Accuracy: 260/682 (38.1232%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.3726, Accuracy: 65/10000 (0.6500%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   1, Avg loss: 0.1138, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   2, Avg loss: 0.0607, Accuracy: 69/440 (15.6818%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.8947, Accuracy: 60/10000 (0.6000%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   1, Avg loss: 0.1010, Accuracy: 3/530 (0.5660%)
___Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   2, Avg loss: 0.0398, Accuracy: 266/530 (50.1887%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.9694, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0750, Accuracy: 218/1446 (15.0761%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0370, Accuracy: 513/1446 (35.4772%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.0558, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.0993, Accuracy: 2/500 (0.4000%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0511, Accuracy: 164/500 (32.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.2283, Accuracy: 58/10000 (0.5800%)
time spent on training: 283.18425989151
___Test Target_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.5298, Accuracy: 62/10000 (0.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 56: Avg loss: 1.2427, Accuracy: 4989/9950 (50.1407%)
saving model
Done in 718.6094799041748 sec.
Server Epoch:57 choose agents : [49, 24, 21, 90, 19, 40, 84, 62, 37, 70].
poison local model 49 index 18 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   1, Average loss: 0.0508, Accuracy: 269/440 (61.1364%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   2, Average loss: 0.0441, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   3, Average loss: 0.0388, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   4, Average loss: 0.0378, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   5, Average loss: 0.0363, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   6, Average loss: 0.0357, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   7, Average loss: 0.0350, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   8, Average loss: 0.0332, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   9, Average loss: 0.0323, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch  10, Average loss: 0.0333, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Global model norm: 274.4954889201278.
Norm before scaling: 274.4797493668704. Distance: 0.4318988942217599
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.1406, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 57: Avg loss: 0.3141, Accuracy: 9938/9950 (99.8794%)
Scaling by  100
Scaled Norm after poisoning: 276.27881637034716, distance: 43.18989258251359
Total norm for 4 adversaries is: 276.27881637034716. distance: 43.18989258251359
___Test Local_ResNet_18 poisoned: True, epoch: 57: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   1, Avg loss: 0.1003, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   2, Avg loss: 0.0515, Accuracy: 79/312 (25.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.9953, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   1, Avg loss: 0.0637, Accuracy: 307/1949 (15.7517%)
___Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   2, Avg loss: 0.0342, Accuracy: 601/1949 (30.8363%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.9333, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   1, Avg loss: 0.0711, Accuracy: 152/677 (22.4520%)
___Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 456/677 (67.3560%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 12.5081, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   1, Avg loss: 0.0592, Accuracy: 277/1036 (26.7375%)
___Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   2, Avg loss: 0.0264, Accuracy: 653/1036 (63.0309%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 13.5611, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0608, Accuracy: 322/1573 (20.4704%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0357, Accuracy: 583/1573 (37.0629%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.0793, Accuracy: 87/10000 (0.8700%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   1, Avg loss: 0.0742, Accuracy: 197/1190 (16.5546%)
___Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 464/1190 (38.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.7482, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   1, Avg loss: 0.0984, Accuracy: 25/568 (4.4014%)
___Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   2, Avg loss: 0.0510, Accuracy: 257/568 (45.2465%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.4048, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   1, Avg loss: 0.0510, Accuracy: 359/1129 (31.7981%)
___Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   2, Avg loss: 0.0231, Accuracy: 725/1129 (64.2161%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.2029, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0699, Accuracy: 264/1418 (18.6178%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0340, Accuracy: 644/1418 (45.4161%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.8521, Accuracy: 85/10000 (0.8500%)
time spent on training: 367.0089876651764
___Test Target_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.0601, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 57: Avg loss: 0.4443, Accuracy: 9913/9950 (99.6281%)
saving model
Done in 794.0458540916443 sec.
Server Epoch:58 choose agents : [95, 54, 5, 67, 47, 39, 11, 59, 83, 6].
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   1, Avg loss: 0.0917, Accuracy: 110/599 (18.3639%)
___Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   2, Avg loss: 0.0328, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 13.9042, Accuracy: 50/10000 (0.5000%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   1, Avg loss: 0.0709, Accuracy: 241/1130 (21.3274%)
___Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   2, Avg loss: 0.0314, Accuracy: 463/1130 (40.9735%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.7790, Accuracy: 63/10000 (0.6300%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   1, Avg loss: 0.0577, Accuracy: 296/1628 (18.1818%)
___Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   2, Avg loss: 0.0272, Accuracy: 729/1628 (44.7789%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.9144, Accuracy: 143/10000 (1.4300%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0934, Accuracy: 3/426 (0.7042%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0482, Accuracy: 160/426 (37.5587%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.9701, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1431, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1136, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.4170, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   1, Avg loss: 0.0705, Accuracy: 169/1013 (16.6831%)
___Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   2, Avg loss: 0.0277, Accuracy: 512/1013 (50.5429%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 10.3736, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   1, Avg loss: 0.0620, Accuracy: 185/712 (25.9831%)
___Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   2, Avg loss: 0.0274, Accuracy: 447/712 (62.7809%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 10.6172, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   1, Avg loss: 0.0690, Accuracy: 203/1089 (18.6410%)
___Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   2, Avg loss: 0.0295, Accuracy: 497/1089 (45.6382%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 10.3092, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   1, Avg loss: 0.0631, Accuracy: 375/1953 (19.2012%)
___Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   2, Avg loss: 0.0346, Accuracy: 761/1953 (38.9657%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.1375, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   1, Avg loss: 0.0596, Accuracy: 325/1956 (16.6155%)
___Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   2, Avg loss: 0.0328, Accuracy: 628/1956 (32.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.8233, Accuracy: 85/10000 (0.8500%)
time spent on training: 288.90901589393616
___Test Target_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.7391, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 58: Avg loss: 1.3516, Accuracy: 6780/9950 (68.1407%)
saving model
Done in 713.9157798290253 sec.
Server Epoch:59 choose agents : [54, 47, 10, 12, 0, 49, 14, 52, 51, 46].
poison local model 54 index 19 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   1, Average loss: 0.0408, Accuracy: 714/1130 (63.1858%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   2, Average loss: 0.0263, Accuracy: 681/1130 (60.2655%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   3, Average loss: 0.0229, Accuracy: 699/1130 (61.8584%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   4, Average loss: 0.0226, Accuracy: 711/1130 (62.9204%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   5, Average loss: 0.0218, Accuracy: 708/1130 (62.6549%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   6, Average loss: 0.0223, Accuracy: 709/1130 (62.7434%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   7, Average loss: 0.0217, Accuracy: 716/1130 (63.3628%), train_poison_data_count: 720
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   8, Average loss: 0.0208, Accuracy: 719/1130 (63.6283%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   9, Average loss: 0.0216, Accuracy: 710/1130 (62.8319%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch  10, Average loss: 0.0209, Accuracy: 721/1130 (63.8053%), train_poison_data_count: 720
Global model norm: 278.5370683365142.
Norm before scaling: 278.48410805196767. Distance: 0.828705278458649
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.4158, Accuracy: 56/10000 (0.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 59: Avg loss: 0.2986, Accuracy: 9771/9950 (98.2010%)
Scaling by  100
Scaled Norm after poisoning: 285.36111989897995, distance: 82.87053391058248
Total norm for 5 adversaries is: 285.36111989897995. distance: 82.87053391058248
___Test Local_ResNet_18 poisoned: True, epoch: 59: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   1, Avg loss: 0.1405, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   2, Avg loss: 0.1194, Accuracy: 3/134 (2.2388%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.5293, Accuracy: 85/10000 (0.8500%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   1, Avg loss: 0.0781, Accuracy: 88/861 (10.2207%)
___Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   2, Avg loss: 0.0222, Accuracy: 430/861 (49.9419%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 11.1059, Accuracy: 92/10000 (0.9200%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   1, Avg loss: 0.1044, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   2, Avg loss: 0.0580, Accuracy: 103/338 (30.4734%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.2925, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   1, Avg loss: 0.0658, Accuracy: 279/1657 (16.8377%)
___Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   2, Avg loss: 0.0370, Accuracy: 479/1657 (28.9077%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.4125, Accuracy: 76/10000 (0.7600%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   1, Avg loss: 0.0617, Accuracy: 32/440 (7.2727%)
___Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   2, Avg loss: 0.0380, Accuracy: 173/440 (39.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.7448, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   1, Avg loss: 0.0849, Accuracy: 131/1013 (12.9319%)
___Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   2, Avg loss: 0.0379, Accuracy: 364/1013 (35.9329%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.6541, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0656, Accuracy: 162/636 (25.4717%)
___Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0347, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.5326, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   1, Avg loss: 0.0791, Accuracy: 164/1049 (15.6339%)
___Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   2, Avg loss: 0.0330, Accuracy: 442/1049 (42.1354%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.7858, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   1, Avg loss: 0.0564, Accuracy: 369/1904 (19.3803%)
___Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 682/1904 (35.8193%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.3547, Accuracy: 113/10000 (1.1300%)
time spent on training: 394.4761612415314
___Test Target_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.4142, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 59: Avg loss: 0.3625, Accuracy: 9634/9950 (96.8241%)
saving model
Done in 822.2155659198761 sec.
Server Epoch:60 choose agents : [54, 52, 10, 29, 40, 35, 50, 34, 99, 36].
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0337, Accuracy: 396/1130 (35.0442%)
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0262, Accuracy: 551/1130 (48.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.9529, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0752, Accuracy: 133/636 (20.9119%)
___Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0326, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.0043, Accuracy: 55/10000 (0.5500%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0772, Accuracy: 106/861 (12.3113%)
___Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0255, Accuracy: 388/861 (45.0639%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.4182, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   1, Avg loss: 0.0692, Accuracy: 296/1440 (20.5556%)
___Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   2, Avg loss: 0.0298, Accuracy: 671/1440 (46.5972%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.9531, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   1, Avg loss: 0.0700, Accuracy: 256/1573 (16.2746%)
___Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   2, Avg loss: 0.0361, Accuracy: 562/1573 (35.7279%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.1488, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   1, Avg loss: 0.1441, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   2, Avg loss: 0.0887, Accuracy: 12/271 (4.4280%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.2426, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0797, Accuracy: 63/809 (7.7874%)
___Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 347/809 (42.8925%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.0108, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   1, Avg loss: 0.0774, Accuracy: 250/1427 (17.5193%)
___Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   2, Avg loss: 0.0359, Accuracy: 559/1427 (39.1731%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.0643, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   1, Avg loss: 0.0916, Accuracy: 84/773 (10.8668%)
___Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   2, Avg loss: 0.0365, Accuracy: 394/773 (50.9702%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.6755, Accuracy: 69/10000 (0.6900%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   1, Avg loss: 0.1207, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   2, Avg loss: 0.0573, Accuracy: 92/408 (22.5490%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.8492, Accuracy: 50/10000 (0.5000%)
time spent on training: 251.41318154335022
___Test Target_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.7513, Accuracy: 61/10000 (0.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 60: Avg loss: 0.5731, Accuracy: 8547/9950 (85.8995%)
saving model
Saving model on epoch 60
Done in 692.0655243396759 sec.
Server Epoch:61 choose agents : [55, 8, 59, 31, 34, 81, 12, 79, 36, 85].
poison local model 55 index 20 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Average loss: 0.0459, Accuracy: 644/1071 (60.1307%), train_poison_data_count: 680
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Average loss: 0.0260, Accuracy: 651/1071 (60.7843%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   3, Average loss: 0.0223, Accuracy: 677/1071 (63.2120%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   4, Average loss: 0.0211, Accuracy: 669/1071 (62.4650%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   5, Average loss: 0.0222, Accuracy: 666/1071 (62.1849%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   6, Average loss: 0.0217, Accuracy: 671/1071 (62.6517%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   7, Average loss: 0.0213, Accuracy: 665/1071 (62.0915%), train_poison_data_count: 680
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   8, Average loss: 0.0202, Accuracy: 671/1071 (62.6517%), train_poison_data_count: 680
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   9, Average loss: 0.0198, Accuracy: 685/1071 (63.9589%), train_poison_data_count: 680
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch  10, Average loss: 0.0206, Accuracy: 668/1071 (62.3716%), train_poison_data_count: 680
Global model norm: 282.49056953286066.
Norm before scaling: 282.43985808929307. Distance: 0.9056075219362616
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.7805, Accuracy: 53/10000 (0.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 61: Avg loss: 0.3485, Accuracy: 9540/9950 (95.8794%)
Scaling by  100
Scaled Norm after poisoning: 291.6394392053311, distance: 90.56075308874148
Total norm for 5 adversaries is: 291.6394392053311. distance: 90.56075308874148
___Test Local_ResNet_18 poisoned: True, epoch: 61: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   1, Avg loss: 0.0717, Accuracy: 161/1513 (10.6411%)
___Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   2, Avg loss: 0.0376, Accuracy: 466/1513 (30.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.4254, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   1, Avg loss: 0.0797, Accuracy: 169/1089 (15.5188%)
___Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   2, Avg loss: 0.0286, Accuracy: 479/1089 (43.9853%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.9265, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   1, Avg loss: 0.0857, Accuracy: 67/460 (14.5652%)
___Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   2, Avg loss: 0.0446, Accuracy: 186/460 (40.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.3069, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   1, Avg loss: 0.0740, Accuracy: 254/1427 (17.7996%)
___Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   2, Avg loss: 0.0358, Accuracy: 548/1427 (38.4022%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.0257, Accuracy: 81/10000 (0.8100%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   1, Avg loss: 0.0876, Accuracy: 83/774 (10.7235%)
___Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   2, Avg loss: 0.0431, Accuracy: 346/774 (44.7028%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.7250, Accuracy: 72/10000 (0.7200%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.1228, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0629, Accuracy: 60/338 (17.7515%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.0843, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1501, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.1159, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 6.7555, Accuracy: 57/10000 (0.5700%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   1, Avg loss: 0.1166, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   2, Avg loss: 0.0575, Accuracy: 98/408 (24.0196%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.4769, Accuracy: 53/10000 (0.5300%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   1, Avg loss: 0.0717, Accuracy: 307/1988 (15.4427%)
___Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   2, Avg loss: 0.0370, Accuracy: 618/1988 (31.0865%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.3849, Accuracy: 89/10000 (0.8900%)
time spent on training: 369.61817383766174
___Test Target_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.5964, Accuracy: 71/10000 (0.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 61: Avg loss: 1.0179, Accuracy: 6164/9950 (61.9497%)
saving model
Done in 792.7028558254242 sec.
Server Epoch:62 choose agents : [76, 81, 79, 10, 63, 90, 19, 80, 0, 17].
___Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   1, Avg loss: 0.1299, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   2, Avg loss: 0.0608, Accuracy: 114/466 (24.4635%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.9004, Accuracy: 51/10000 (0.5100%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.0972, Accuracy: 82/774 (10.5943%)
___Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0413, Accuracy: 317/774 (40.9561%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.1736, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   1, Avg loss: 0.1428, Accuracy: 2/197 (1.0152%)
___Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   2, Avg loss: 0.1138, Accuracy: 12/197 (6.0914%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.6984, Accuracy: 68/10000 (0.6800%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   1, Avg loss: 0.0832, Accuracy: 78/861 (9.0592%)
___Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 435/861 (50.5226%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 11.2635, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0899, Accuracy: 97/888 (10.9234%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0286, Accuracy: 439/888 (49.4369%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 11.4146, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   1, Avg loss: 0.0858, Accuracy: 114/677 (16.8390%)
___Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   2, Avg loss: 0.0246, Accuracy: 465/677 (68.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 12.3141, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   1, Avg loss: 0.0672, Accuracy: 232/1036 (22.3938%)
___Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   2, Avg loss: 0.0270, Accuracy: 657/1036 (63.4170%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 13.8482, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0963, Accuracy: 21/682 (3.0792%)
___Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0391, Accuracy: 270/682 (39.5894%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.1805, Accuracy: 68/10000 (0.6800%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   1, Avg loss: 0.0728, Accuracy: 249/1657 (15.0272%)
___Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   2, Avg loss: 0.0362, Accuracy: 478/1657 (28.8473%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.4823, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   1, Avg loss: 0.0715, Accuracy: 238/1574 (15.1207%)
___Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   2, Avg loss: 0.0299, Accuracy: 581/1574 (36.9123%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.4722, Accuracy: 103/10000 (1.0300%)
time spent on training: 278.50591015815735
___Test Target_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.7608, Accuracy: 59/10000 (0.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 62: Avg loss: 0.9813, Accuracy: 6387/9950 (64.1910%)
saving model
Done in 713.8848497867584 sec.
Server Epoch:63 choose agents : [60, 37, 76, 38, 57, 8, 82, 79, 19, 99].
poison local model 60 index 21 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   1, Average loss: 0.0402, Accuracy: 1381/2227 (62.0117%), train_poison_data_count: 1400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   2, Average loss: 0.0241, Accuracy: 1377/2227 (61.8321%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   3, Average loss: 0.0219, Accuracy: 1404/2227 (63.0445%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   4, Average loss: 0.0211, Accuracy: 1400/2227 (62.8648%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   5, Average loss: 0.0212, Accuracy: 1433/2227 (64.3467%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   6, Average loss: 0.0204, Accuracy: 1412/2227 (63.4037%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   7, Average loss: 0.0202, Accuracy: 1436/2227 (64.4814%), train_poison_data_count: 1400
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   8, Average loss: 0.0196, Accuracy: 1441/2227 (64.7059%), train_poison_data_count: 1400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   9, Average loss: 0.0199, Accuracy: 1434/2227 (64.3916%), train_poison_data_count: 1400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch  10, Average loss: 0.0197, Accuracy: 1455/2227 (65.3345%), train_poison_data_count: 1400
Global model norm: 286.4161908394845.
Norm before scaling: 286.297949040855. Distance: 1.2947712576197024
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.8207, Accuracy: 64/10000 (0.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 63: Avg loss: 0.2074, Accuracy: 9817/9950 (98.6633%)
Scaling by  100
Scaled Norm after poisoning: 303.08128550770004, distance: 129.47712605659348
Total norm for 2 adversaries is: 303.08128550770004. distance: 129.47712605659348
___Test Local_ResNet_18 poisoned: True, epoch: 63: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0610, Accuracy: 289/1129 (25.5979%)
___Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0247, Accuracy: 708/1129 (62.7104%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.8223, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.1218, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0613, Accuracy: 135/466 (28.9700%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.9152, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0773, Accuracy: 148/1131 (13.0858%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0330, Accuracy: 482/1131 (42.6172%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.9563, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0767, Accuracy: 160/1154 (13.8648%)
___Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0296, Accuracy: 481/1154 (41.6811%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.9991, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   1, Avg loss: 0.0734, Accuracy: 157/1513 (10.3767%)
___Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   2, Avg loss: 0.0374, Accuracy: 463/1513 (30.6015%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.6149, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   1, Avg loss: 0.1076, Accuracy: 2/500 (0.4000%)
___Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   2, Avg loss: 0.0550, Accuracy: 129/500 (25.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.1228, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   1, Avg loss: 0.1386, Accuracy: 2/197 (1.0152%)
___Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   2, Avg loss: 0.1005, Accuracy: 9/197 (4.5685%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.3468, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   1, Avg loss: 0.0604, Accuracy: 273/1036 (26.3514%)
___Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   2, Avg loss: 0.0271, Accuracy: 665/1036 (64.1892%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 13.7057, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.0929, Accuracy: 89/773 (11.5136%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0321, Accuracy: 380/773 (49.1591%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.9997, Accuracy: 87/10000 (0.8700%)
time spent on training: 398.7612290382385
___Test Target_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.6821, Accuracy: 73/10000 (0.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 63: Avg loss: 0.4012, Accuracy: 9087/9950 (91.3266%)
saving model
Done in 835.9187014102936 sec.
Server Epoch:64 choose agents : [36, 20, 35, 30, 6, 45, 65, 50, 99, 89].
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   1, Avg loss: 0.1248, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   2, Avg loss: 0.0651, Accuracy: 82/408 (20.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.5235, Accuracy: 51/10000 (0.5100%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   1, Avg loss: 0.0881, Accuracy: 123/807 (15.2416%)
___Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   2, Avg loss: 0.0388, Accuracy: 425/807 (52.6642%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.0100, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.1551, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.1021, Accuracy: 1/271 (0.3690%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.4172, Accuracy: 80/10000 (0.8000%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.1164, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0480, Accuracy: 183/486 (37.6543%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.8712, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   1, Avg loss: 0.0716, Accuracy: 266/1956 (13.5992%)
___Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   2, Avg loss: 0.0326, Accuracy: 650/1956 (33.2311%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.9938, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.1097, Accuracy: 32/669 (4.7833%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0512, Accuracy: 352/669 (52.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.9775, Accuracy: 55/10000 (0.5500%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   1, Avg loss: 0.0811, Accuracy: 261/1475 (17.6949%)
___Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   2, Avg loss: 0.0350, Accuracy: 595/1475 (40.3390%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.9535, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   1, Avg loss: 0.0912, Accuracy: 28/809 (3.4611%)
___Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   2, Avg loss: 0.0287, Accuracy: 355/809 (43.8813%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 10.8514, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   1, Avg loss: 0.0986, Accuracy: 66/773 (8.5382%)
___Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   2, Avg loss: 0.0354, Accuracy: 405/773 (52.3933%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 11.3814, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   1, Avg loss: 0.0931, Accuracy: 167/896 (18.6384%)
___Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   2, Avg loss: 0.0423, Accuracy: 437/896 (48.7723%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.3662, Accuracy: 49/10000 (0.4900%)
time spent on training: 299.20818066596985
___Test Target_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.8156, Accuracy: 78/10000 (0.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 64: Avg loss: 0.9027, Accuracy: 6758/9950 (67.9196%)
saving model
Done in 728.6845562458038 sec.
Server Epoch:65 choose agents : [61, 28, 93, 57, 72, 82, 55, 87, 88, 96].
poison local model 61 index 22 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Average loss: 0.0592, Accuracy: 42/85 (49.4118%), train_poison_data_count: 61
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Average loss: 0.0517, Accuracy: 52/85 (61.1765%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   3, Average loss: 0.0486, Accuracy: 60/85 (70.5882%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   4, Average loss: 0.0465, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   5, Average loss: 0.0455, Accuracy: 60/85 (70.5882%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   6, Average loss: 0.0462, Accuracy: 60/85 (70.5882%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   7, Average loss: 0.0435, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   8, Average loss: 0.0428, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   9, Average loss: 0.0474, Accuracy: 60/85 (70.5882%), train_poison_data_count: 61
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch  10, Average loss: 0.0449, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Global model norm: 290.19285074756755.
Norm before scaling: 290.190293169844. Distance: 0.1305381832847732
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.4021, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 65: Avg loss: 0.0692, Accuracy: 9941/9950 (99.9095%)
Scaling by  100
Scaled Norm after poisoning: 290.2291524597417, distance: 13.053818441487545
Total norm for 3 adversaries is: 290.2291524597417. distance: 13.053818441487545
___Test Local_ResNet_18 poisoned: True, epoch: 65: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0794, Accuracy: 222/1581 (14.0417%)
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0381, Accuracy: 529/1581 (33.4598%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.2411, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   1, Avg loss: 0.0696, Accuracy: 291/1742 (16.7049%)
___Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 685/1742 (39.3226%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.9028, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0783, Accuracy: 149/1154 (12.9116%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0302, Accuracy: 475/1154 (41.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 11.1934, Accuracy: 74/10000 (0.7400%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0854, Accuracy: 131/1241 (10.5560%)
___Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0387, Accuracy: 389/1241 (31.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.8908, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.1187, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0611, Accuracy: 107/500 (21.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.4606, Accuracy: 51/10000 (0.5100%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   1, Avg loss: 0.0663, Accuracy: 192/1071 (17.9272%)
___Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   2, Avg loss: 0.0278, Accuracy: 532/1071 (49.6732%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 10.4437, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   1, Avg loss: 0.0866, Accuracy: 160/1131 (14.1468%)
___Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   2, Avg loss: 0.0367, Accuracy: 387/1131 (34.2175%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.4079, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   1, Avg loss: 0.0959, Accuracy: 34/603 (5.6385%)
___Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   2, Avg loss: 0.0504, Accuracy: 283/603 (46.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.7942, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   1, Avg loss: 0.1287, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   2, Avg loss: 0.0836, Accuracy: 13/311 (4.1801%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.1649, Accuracy: 87/10000 (0.8700%)
time spent on training: 352.5740931034088
___Test Target_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.3404, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 65: Avg loss: 0.1039, Accuracy: 9897/9950 (99.4673%)
saving model
Done in 791.9901201725006 sec.
Server Epoch:66 choose agents : [15, 18, 21, 86, 93, 71, 34, 3, 52, 47].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   1, Avg loss: 0.0692, Accuracy: 223/1154 (19.3241%)
___Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   2, Avg loss: 0.0328, Accuracy: 384/1154 (33.2756%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 10.3688, Accuracy: 76/10000 (0.7600%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.1077, Accuracy: 0/530 (0.0000%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0430, Accuracy: 267/530 (50.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 10.4043, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   1, Avg loss: 0.0692, Accuracy: 289/1949 (14.8281%)
___Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   2, Avg loss: 0.0346, Accuracy: 639/1949 (32.7860%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.1098, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0768, Accuracy: 236/1003 (23.5294%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0357, Accuracy: 385/1003 (38.3848%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.3291, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0670, Accuracy: 313/1742 (17.9679%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 669/1742 (38.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.2155, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0978, Accuracy: 31/818 (3.7897%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0343, Accuracy: 354/818 (43.2763%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 10.0985, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   1, Avg loss: 0.0770, Accuracy: 262/1427 (18.3602%)
___Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   2, Avg loss: 0.0361, Accuracy: 561/1427 (39.3132%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.2318, Accuracy: 76/10000 (0.7600%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   1, Avg loss: 0.0967, Accuracy: 12/781 (1.5365%)
___Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   2, Avg loss: 0.0383, Accuracy: 239/781 (30.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 10.0037, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   1, Avg loss: 0.0807, Accuracy: 118/636 (18.5535%)
___Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   2, Avg loss: 0.0378, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 10.7922, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   1, Avg loss: 0.1842, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   2, Avg loss: 0.1457, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.5065, Accuracy: 87/10000 (0.8700%)
time spent on training: 288.4944281578064
___Test Target_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.0756, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 66: Avg loss: 0.2846, Accuracy: 9517/9950 (95.6482%)
saving model
Done in 726.6322448253632 sec.
Server Epoch:67 choose agents : [65, 12, 41, 56, 19, 23, 37, 45, 96, 9].
poison local model 65 index 23 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   1, Average loss: 0.0442, Accuracy: 921/1475 (62.4407%), train_poison_data_count: 923
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   2, Average loss: 0.0270, Accuracy: 915/1475 (62.0339%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   3, Average loss: 0.0240, Accuracy: 935/1475 (63.3898%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   4, Average loss: 0.0238, Accuracy: 928/1475 (62.9153%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   5, Average loss: 0.0242, Accuracy: 922/1475 (62.5085%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   6, Average loss: 0.0234, Accuracy: 929/1475 (62.9831%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   7, Average loss: 0.0224, Accuracy: 931/1475 (63.1186%), train_poison_data_count: 923
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   8, Average loss: 0.0227, Accuracy: 933/1475 (63.2542%), train_poison_data_count: 923
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   9, Average loss: 0.0219, Accuracy: 933/1475 (63.2542%), train_poison_data_count: 923
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch  10, Average loss: 0.0219, Accuracy: 925/1475 (62.7119%), train_poison_data_count: 923
Global model norm: 294.05428389159715.
Norm before scaling: 293.9746082785042. Distance: 1.0342298861127521
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.5347, Accuracy: 57/10000 (0.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 67: Avg loss: 0.2295, Accuracy: 9812/9950 (98.6131%)
Scaling by  100
Scaled Norm after poisoning: 303.92632485110596, distance: 103.42298330913927
Total norm for 4 adversaries is: 303.92632485110596. distance: 103.42298330913927
___Test Local_ResNet_18 poisoned: True, epoch: 67: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   1, Avg loss: 0.1215, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   2, Avg loss: 0.0659, Accuracy: 73/338 (21.5976%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.4952, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   1, Avg loss: 0.0964, Accuracy: 109/719 (15.1599%)
___Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   2, Avg loss: 0.0397, Accuracy: 467/719 (64.9513%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.1590, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.1352, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.1100, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.0831, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0631, Accuracy: 268/1036 (25.8687%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0259, Accuracy: 656/1036 (63.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 13.2542, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   1, Avg loss: 0.0851, Accuracy: 125/715 (17.4825%)
___Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   2, Avg loss: 0.0504, Accuracy: 439/715 (61.3986%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.7097, Accuracy: 52/10000 (0.5200%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   1, Avg loss: 0.0585, Accuracy: 298/1129 (26.3950%)
___Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   2, Avg loss: 0.0243, Accuracy: 730/1129 (64.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.8096, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   1, Avg loss: 0.0927, Accuracy: 47/669 (7.0254%)
___Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   2, Avg loss: 0.0468, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.4504, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.1202, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0790, Accuracy: 17/311 (5.4662%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 6.9915, Accuracy: 70/10000 (0.7000%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   1, Avg loss: 0.0611, Accuracy: 255/1275 (20.0000%)
___Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   2, Avg loss: 0.0204, Accuracy: 685/1275 (53.7255%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 11.9586, Accuracy: 108/10000 (1.0800%)
time spent on training: 383.2059018611908
___Test Target_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.7460, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 67: Avg loss: 0.4654, Accuracy: 8955/9950 (90.0000%)
saving model
Done in 821.1240377426147 sec.
Server Epoch:68 choose agents : [30, 17, 54, 91, 69, 28, 65, 60, 9, 11].
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   1, Avg loss: 0.1116, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   2, Avg loss: 0.0473, Accuracy: 181/486 (37.2428%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.7063, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0667, Accuracy: 241/1574 (15.3113%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0293, Accuracy: 636/1574 (40.4066%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.5723, Accuracy: 97/10000 (0.9700%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   1, Avg loss: 0.0670, Accuracy: 237/1130 (20.9735%)
___Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   2, Avg loss: 0.0295, Accuracy: 483/1130 (42.7434%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.8776, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   1, Avg loss: 0.0731, Accuracy: 194/1030 (18.8350%)
___Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   2, Avg loss: 0.0273, Accuracy: 606/1030 (58.8350%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 11.2483, Accuracy: 109/10000 (1.0900%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   1, Avg loss: 0.0843, Accuracy: 107/590 (18.1356%)
___Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   2, Avg loss: 0.0362, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 13.6943, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   1, Avg loss: 0.0753, Accuracy: 239/1581 (15.1170%)
___Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   2, Avg loss: 0.0364, Accuracy: 530/1581 (33.5231%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.6293, Accuracy: 81/10000 (0.8100%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   1, Avg loss: 0.0374, Accuracy: 509/1475 (34.5085%)
___Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   2, Avg loss: 0.0292, Accuracy: 657/1475 (44.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.3425, Accuracy: 83/10000 (0.8300%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0475, Accuracy: 610/2227 (27.3911%)
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1060/2227 (47.5977%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.1031, Accuracy: 131/10000 (1.3100%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0637, Accuracy: 262/1275 (20.5490%)
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0204, Accuracy: 686/1275 (53.8039%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 12.2264, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   1, Avg loss: 0.0924, Accuracy: 95/712 (13.3427%)
___Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   2, Avg loss: 0.0293, Accuracy: 434/712 (60.9551%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 11.1438, Accuracy: 67/10000 (0.6700%)
time spent on training: 377.1170256137848
___Test Target_ResNet_18 poisoned: False, epoch: 68: Avg loss: 6.6955, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 68: Avg loss: 1.2064, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 814.774521112442 sec.
Server Epoch:69 choose agents : [69, 3, 66, 36, 78, 83, 8, 10, 93, 58].
poison local model 69 index 24 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Average loss: 0.0449, Accuracy: 339/590 (57.4576%), train_poison_data_count: 374
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Average loss: 0.0265, Accuracy: 328/590 (55.5932%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   3, Average loss: 0.0216, Accuracy: 330/590 (55.9322%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   4, Average loss: 0.0208, Accuracy: 354/590 (60.0000%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   5, Average loss: 0.0208, Accuracy: 368/590 (62.3729%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   6, Average loss: 0.0204, Accuracy: 372/590 (63.0508%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   7, Average loss: 0.0220, Accuracy: 359/590 (60.8475%), train_poison_data_count: 374
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   8, Average loss: 0.0190, Accuracy: 381/590 (64.5763%), train_poison_data_count: 374
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   9, Average loss: 0.0204, Accuracy: 361/590 (61.1864%), train_poison_data_count: 374
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch  10, Average loss: 0.0211, Accuracy: 357/590 (60.5085%), train_poison_data_count: 374
Global model norm: 297.7987732933096.
Norm before scaling: 297.77150163758114. Distance: 0.5909472872903468
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.1402, Accuracy: 57/10000 (0.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 69: Avg loss: 0.2574, Accuracy: 9318/9950 (93.6482%)
Scaling by  100
Scaled Norm after poisoning: 300.8579528822531, distance: 59.09472500517707
Total norm for 5 adversaries is: 300.8579528822531. distance: 59.09472500517707
___Test Local_ResNet_18 poisoned: True, epoch: 69: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   1, Avg loss: 0.0953, Accuracy: 14/781 (1.7926%)
___Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   2, Avg loss: 0.0392, Accuracy: 244/781 (31.2420%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.4085, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   1, Avg loss: 0.0833, Accuracy: 170/1402 (12.1255%)
___Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   2, Avg loss: 0.0423, Accuracy: 346/1402 (24.6790%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.3340, Accuracy: 76/10000 (0.7600%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   1, Avg loss: 0.1103, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   2, Avg loss: 0.0579, Accuracy: 108/408 (26.4706%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.7694, Accuracy: 48/10000 (0.4800%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   1, Avg loss: 0.1121, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   2, Avg loss: 0.0540, Accuracy: 128/416 (30.7692%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.0848, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0737, Accuracy: 298/1953 (15.2586%)
___Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0353, Accuracy: 732/1953 (37.4808%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.1217, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   1, Avg loss: 0.0737, Accuracy: 177/1513 (11.6986%)
___Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   2, Avg loss: 0.0378, Accuracy: 461/1513 (30.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.7819, Accuracy: 91/10000 (0.9100%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   1, Avg loss: 0.0832, Accuracy: 58/861 (6.7364%)
___Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   2, Avg loss: 0.0232, Accuracy: 413/861 (47.9675%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 12.0806, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   1, Avg loss: 0.0649, Accuracy: 337/1742 (19.3456%)
___Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 713/1742 (40.9300%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.0682, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   1, Avg loss: 0.0701, Accuracy: 215/803 (26.7746%)
___Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   2, Avg loss: 0.0387, Accuracy: 405/803 (50.4359%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.4654, Accuracy: 57/10000 (0.5700%)
time spent on training: 405.2299335002899
___Test Target_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.3646, Accuracy: 62/10000 (0.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 69: Avg loss: 0.6086, Accuracy: 7209/9950 (72.4523%)
saving model
Done in 844.7342038154602 sec.
Server Epoch:70 choose agents : [22, 18, 31, 35, 88, 66, 36, 14, 27, 48].
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0704, Accuracy: 354/1470 (24.0816%)
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0261, Accuracy: 824/1470 (56.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.9983, Accuracy: 102/10000 (1.0200%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   1, Avg loss: 0.1080, Accuracy: 8/530 (1.5094%)
___Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   2, Avg loss: 0.0400, Accuracy: 286/530 (53.9623%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 10.3173, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   1, Avg loss: 0.1209, Accuracy: 3/460 (0.6522%)
___Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   2, Avg loss: 0.0440, Accuracy: 180/460 (39.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.4493, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   1, Avg loss: 0.1595, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   2, Avg loss: 0.0907, Accuracy: 11/271 (4.0590%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.7446, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.0989, Accuracy: 50/603 (8.2919%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0505, Accuracy: 282/603 (46.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.1415, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0852, Accuracy: 167/1402 (11.9116%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0415, Accuracy: 375/1402 (26.7475%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.1325, Accuracy: 73/10000 (0.7300%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.1230, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0576, Accuracy: 124/408 (30.3922%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.7475, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   1, Avg loss: 0.1000, Accuracy: 100/1013 (9.8717%)
___Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   2, Avg loss: 0.0420, Accuracy: 321/1013 (31.6881%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.8107, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   1, Avg loss: 0.0783, Accuracy: 286/1587 (18.0214%)
___Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   2, Avg loss: 0.0371, Accuracy: 532/1587 (33.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.4354, Accuracy: 70/10000 (0.7000%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0996, Accuracy: 17/631 (2.6941%)
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0438, Accuracy: 243/631 (38.5103%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.2346, Accuracy: 73/10000 (0.7300%)
time spent on training: 228.22925209999084
___Test Target_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.2144, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 70: Avg loss: 0.9303, Accuracy: 5531/9950 (55.5879%)
saving model
Done in 648.4092407226562 sec.
Server Epoch:71 choose agents : [72, 77, 92, 31, 46, 66, 54, 0, 25, 36].
poison local model 72 index 25 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   1, Average loss: 0.0463, Accuracy: 749/1241 (60.3546%), train_poison_data_count: 785
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   2, Average loss: 0.0295, Accuracy: 759/1241 (61.1604%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   3, Average loss: 0.0263, Accuracy: 750/1241 (60.4351%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   4, Average loss: 0.0253, Accuracy: 771/1241 (62.1273%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   5, Average loss: 0.0253, Accuracy: 768/1241 (61.8856%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   6, Average loss: 0.0251, Accuracy: 766/1241 (61.7244%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   7, Average loss: 0.0243, Accuracy: 774/1241 (62.3691%), train_poison_data_count: 785
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   8, Average loss: 0.0247, Accuracy: 778/1241 (62.6914%), train_poison_data_count: 785
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   9, Average loss: 0.0247, Accuracy: 773/1241 (62.2885%), train_poison_data_count: 785
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch  10, Average loss: 0.0247, Accuracy: 778/1241 (62.6914%), train_poison_data_count: 785
Global model norm: 301.5303415495694.
Norm before scaling: 301.4643298758578. Distance: 0.931722417475871
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.3378, Accuracy: 55/10000 (0.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 71: Avg loss: 0.3105, Accuracy: 9739/9950 (97.8794%)
Scaling by  100
Scaled Norm after poisoning: 309.0822352141902, distance: 93.17224053466784
Total norm for 5 adversaries is: 309.0822352141902. distance: 93.17224053466784
___Test Local_ResNet_18 poisoned: True, epoch: 71: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0656, Accuracy: 254/1340 (18.9552%)
___Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0298, Accuracy: 554/1340 (41.3433%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.2956, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   1, Avg loss: 0.0685, Accuracy: 317/1715 (18.4840%)
___Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   2, Avg loss: 0.0317, Accuracy: 650/1715 (37.9009%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.0785, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   1, Avg loss: 0.1051, Accuracy: 6/460 (1.3043%)
___Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   2, Avg loss: 0.0484, Accuracy: 184/460 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.8372, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   1, Avg loss: 0.0636, Accuracy: 339/1904 (17.8046%)
___Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 679/1904 (35.6618%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.6435, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   1, Avg loss: 0.0822, Accuracy: 179/1402 (12.7675%)
___Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   2, Avg loss: 0.0424, Accuracy: 367/1402 (26.1769%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.2714, Accuracy: 71/10000 (0.7100%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   1, Avg loss: 0.0641, Accuracy: 247/1130 (21.8584%)
___Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   2, Avg loss: 0.0296, Accuracy: 508/1130 (44.9558%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.9002, Accuracy: 56/10000 (0.5600%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   1, Avg loss: 0.0737, Accuracy: 286/1657 (17.2601%)
___Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   2, Avg loss: 0.0382, Accuracy: 467/1657 (28.1835%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.2873, Accuracy: 62/10000 (0.6200%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   1, Avg loss: 0.0794, Accuracy: 161/690 (23.3333%)
___Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   2, Avg loss: 0.0322, Accuracy: 460/690 (66.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.8153, Accuracy: 61/10000 (0.6100%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   1, Avg loss: 0.1125, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   2, Avg loss: 0.0552, Accuracy: 123/408 (30.1471%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.7980, Accuracy: 50/10000 (0.5000%)
time spent on training: 384.8181834220886
___Test Target_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.3100, Accuracy: 62/10000 (0.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Avg loss: 0.8635, Accuracy: 7442/9950 (74.7940%)
saving model
Done in 802.1984786987305 sec.
Server Epoch:72 choose agents : [7, 99, 12, 11, 10, 15, 85, 26, 14, 29].
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0809, Accuracy: 151/891 (16.9473%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0306, Accuracy: 441/891 (49.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.6923, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0905, Accuracy: 86/773 (11.1255%)
___Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0339, Accuracy: 388/773 (50.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 10.5299, Accuracy: 76/10000 (0.7600%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   1, Avg loss: 0.1267, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   2, Avg loss: 0.0661, Accuracy: 57/338 (16.8639%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.9481, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   1, Avg loss: 0.0912, Accuracy: 86/712 (12.0787%)
___Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   2, Avg loss: 0.0317, Accuracy: 431/712 (60.5337%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 11.3256, Accuracy: 69/10000 (0.6900%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   1, Avg loss: 0.0867, Accuracy: 61/861 (7.0848%)
___Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   2, Avg loss: 0.0227, Accuracy: 424/861 (49.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 11.3114, Accuracy: 88/10000 (0.8800%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   1, Avg loss: 0.0729, Accuracy: 230/1154 (19.9307%)
___Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   2, Avg loss: 0.0313, Accuracy: 455/1154 (39.4281%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 10.1209, Accuracy: 72/10000 (0.7200%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   1, Avg loss: 0.0757, Accuracy: 308/1988 (15.4930%)
___Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   2, Avg loss: 0.0382, Accuracy: 633/1988 (31.8410%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.2724, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   1, Avg loss: 0.0790, Accuracy: 198/1446 (13.6929%)
___Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   2, Avg loss: 0.0387, Accuracy: 492/1446 (34.0249%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.4093, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   1, Avg loss: 0.0963, Accuracy: 84/1013 (8.2922%)
___Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   2, Avg loss: 0.0412, Accuracy: 340/1013 (33.5637%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.9782, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   1, Avg loss: 0.0698, Accuracy: 268/1440 (18.6111%)
___Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   2, Avg loss: 0.0306, Accuracy: 648/1440 (45.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 10.0072, Accuracy: 84/10000 (0.8400%)
time spent on training: 281.8812770843506
___Test Target_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.4367, Accuracy: 59/10000 (0.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Avg loss: 1.2792, Accuracy: 5288/9950 (53.1457%)
saving model
Done in 694.5229134559631 sec.
Server Epoch:73 choose agents : [74, 81, 71, 96, 73, 8, 10, 55, 33, 35].
poison local model 74 index 26 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   1, Average loss: 0.0407, Accuracy: 922/1552 (59.4072%), train_poison_data_count: 976
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   2, Average loss: 0.0216, Accuracy: 935/1552 (60.2448%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   3, Average loss: 0.0191, Accuracy: 970/1552 (62.5000%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   4, Average loss: 0.0186, Accuracy: 968/1552 (62.3711%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   5, Average loss: 0.0181, Accuracy: 980/1552 (63.1443%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   6, Average loss: 0.0183, Accuracy: 981/1552 (63.2088%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   7, Average loss: 0.0182, Accuracy: 967/1552 (62.3067%), train_poison_data_count: 976
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   8, Average loss: 0.0176, Accuracy: 976/1552 (62.8866%), train_poison_data_count: 976
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   9, Average loss: 0.0173, Accuracy: 991/1552 (63.8531%), train_poison_data_count: 976
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch  10, Average loss: 0.0176, Accuracy: 996/1552 (64.1753%), train_poison_data_count: 976
Global model norm: 305.212809978546.
Norm before scaling: 305.12677949091915. Distance: 1.0981795397411311
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.6987, Accuracy: 52/10000 (0.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 73: Avg loss: 0.3200, Accuracy: 9414/9950 (94.6131%)
Scaling by  100
Scaled Norm after poisoning: 315.9793555360856, distance: 109.81795571962492
Total norm for 5 adversaries is: 315.9793555360856. distance: 109.81795571962492
___Test Local_ResNet_18 poisoned: True, epoch: 73: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0843, Accuracy: 126/774 (16.2791%)
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0411, Accuracy: 328/774 (42.3773%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.8580, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0971, Accuracy: 39/818 (4.7677%)
___Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0344, Accuracy: 349/818 (42.6650%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.6451, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.1192, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0778, Accuracy: 25/311 (8.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.9919, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   1, Avg loss: 0.0762, Accuracy: 179/938 (19.0832%)
___Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   2, Avg loss: 0.0363, Accuracy: 337/938 (35.9275%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.7452, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   1, Avg loss: 0.0728, Accuracy: 171/1513 (11.3020%)
___Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   2, Avg loss: 0.0375, Accuracy: 455/1513 (30.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.7707, Accuracy: 92/10000 (0.9200%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0830, Accuracy: 68/861 (7.8978%)
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0223, Accuracy: 455/861 (52.8455%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 11.1489, Accuracy: 93/10000 (0.9300%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   1, Avg loss: 0.0699, Accuracy: 194/1071 (18.1139%)
___Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   2, Avg loss: 0.0309, Accuracy: 508/1071 (47.4323%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 10.3024, Accuracy: 82/10000 (0.8200%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.1059, Accuracy: 1/515 (0.1942%)
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0601, Accuracy: 124/515 (24.0777%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.5401, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   1, Avg loss: 0.1398, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   2, Avg loss: 0.0890, Accuracy: 6/271 (2.2140%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.8582, Accuracy: 48/10000 (0.4800%)
time spent on training: 365.12467217445374
___Test Target_ResNet_18 poisoned: False, epoch: 73: Avg loss: 10.8892, Accuracy: 61/10000 (0.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Avg loss: 0.5033, Accuracy: 8176/9950 (82.1709%)
saving model
Done in 787.8547732830048 sec.
Server Epoch:74 choose agents : [50, 33, 10, 20, 28, 37, 46, 27, 93, 60].
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0962, Accuracy: 31/809 (3.8319%)
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0288, Accuracy: 352/809 (43.5105%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 10.7015, Accuracy: 94/10000 (0.9400%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   1, Avg loss: 0.1294, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   2, Avg loss: 0.0582, Accuracy: 89/515 (17.2816%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.1562, Accuracy: 56/10000 (0.5600%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   1, Avg loss: 0.0955, Accuracy: 46/861 (5.3426%)
___Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   2, Avg loss: 0.0223, Accuracy: 431/861 (50.0581%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 11.8123, Accuracy: 89/10000 (0.8900%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   1, Avg loss: 0.0942, Accuracy: 86/807 (10.6568%)
___Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   2, Avg loss: 0.0419, Accuracy: 412/807 (51.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.2285, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0827, Accuracy: 203/1581 (12.8400%)
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0373, Accuracy: 521/1581 (32.9538%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.3912, Accuracy: 73/10000 (0.7300%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0732, Accuracy: 254/1129 (22.4978%)
___Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0265, Accuracy: 694/1129 (61.4703%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 10.2943, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   1, Avg loss: 0.0727, Accuracy: 310/1904 (16.2815%)
___Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 678/1904 (35.6092%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.3992, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   1, Avg loss: 0.0845, Accuracy: 263/1587 (16.5721%)
___Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   2, Avg loss: 0.0367, Accuracy: 548/1587 (34.5306%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.3485, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0745, Accuracy: 272/1742 (15.6142%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 686/1742 (39.3800%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.0045, Accuracy: 88/10000 (0.8800%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   1, Avg loss: 0.0587, Accuracy: 532/2227 (23.8886%)
___Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   2, Avg loss: 0.0296, Accuracy: 985/2227 (44.2299%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.0734, Accuracy: 116/10000 (1.1600%)
time spent on training: 334.2332513332367
___Test Target_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.7413, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Avg loss: 0.4562, Accuracy: 8817/9950 (88.6131%)
saving model
Done in 751.4913837909698 sec.
Server Epoch:75 choose agents : [78, 51, 85, 6, 92, 32, 29, 40, 95, 74].
poison local model 78 index 27 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   1, Average loss: 0.0531, Accuracy: 248/416 (59.6154%), train_poison_data_count: 272
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   2, Average loss: 0.0440, Accuracy: 271/416 (65.1442%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   3, Average loss: 0.0360, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   4, Average loss: 0.0350, Accuracy: 271/416 (65.1442%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   5, Average loss: 0.0328, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   6, Average loss: 0.0314, Accuracy: 271/416 (65.1442%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   7, Average loss: 0.0305, Accuracy: 274/416 (65.8654%), train_poison_data_count: 272
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   8, Average loss: 0.0291, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   9, Average loss: 0.0291, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch  10, Average loss: 0.0287, Accuracy: 273/416 (65.6250%), train_poison_data_count: 272
Global model norm: 308.8031836785366.
Norm before scaling: 308.7851068097359. Distance: 0.47044104090047656
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.7175, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 75: Avg loss: 0.1946, Accuracy: 9931/9950 (99.8090%)
Scaling by  100
Scaled Norm after poisoning: 310.5353114985476, distance: 47.04410642385239
Total norm for 4 adversaries is: 310.5353114985476. distance: 47.04410642385239
___Test Local_ResNet_18 poisoned: True, epoch: 75: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   1, Avg loss: 0.0897, Accuracy: 110/1049 (10.4862%)
___Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   2, Avg loss: 0.0319, Accuracy: 501/1049 (47.7598%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.4212, Accuracy: 100/10000 (1.0000%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0789, Accuracy: 267/1988 (13.4306%)
___Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0391, Accuracy: 579/1988 (29.1247%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.2760, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   1, Avg loss: 0.0725, Accuracy: 300/1956 (15.3374%)
___Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   2, Avg loss: 0.0329, Accuracy: 606/1956 (30.9816%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.8801, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   1, Avg loss: 0.0735, Accuracy: 281/1715 (16.3848%)
___Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   2, Avg loss: 0.0334, Accuracy: 589/1715 (34.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.9544, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   1, Avg loss: 0.0772, Accuracy: 115/735 (15.6463%)
___Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   2, Avg loss: 0.0288, Accuracy: 370/735 (50.3401%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 12.7987, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   1, Avg loss: 0.0730, Accuracy: 264/1440 (18.3333%)
___Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   2, Avg loss: 0.0299, Accuracy: 642/1440 (44.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.1566, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0684, Accuracy: 245/1573 (15.5753%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0365, Accuracy: 573/1573 (36.4272%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.3900, Accuracy: 82/10000 (0.8200%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   1, Avg loss: 0.1037, Accuracy: 63/599 (10.5175%)
___Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   2, Avg loss: 0.0323, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 15.6326, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0266, Accuracy: 595/1552 (38.3376%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 807/1552 (51.9974%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.7720, Accuracy: 94/10000 (0.9400%)
time spent on training: 403.850061416626
___Test Target_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.4598, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Avg loss: 0.4562, Accuracy: 9630/9950 (96.7839%)
saving model
Done in 826.1107337474823 sec.
Server Epoch:76 choose agents : [6, 5, 30, 19, 88, 49, 14, 57, 85, 92].
___Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   1, Avg loss: 0.0654, Accuracy: 311/1956 (15.8998%)
___Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   2, Avg loss: 0.0328, Accuracy: 642/1956 (32.8221%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.0261, Accuracy: 96/10000 (0.9600%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0658, Accuracy: 230/1628 (14.1278%)
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0285, Accuracy: 696/1628 (42.7518%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 10.0660, Accuracy: 117/10000 (1.1700%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   1, Avg loss: 0.1014, Accuracy: 1/486 (0.2058%)
___Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   2, Avg loss: 0.0478, Accuracy: 191/486 (39.3004%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.3688, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   1, Avg loss: 0.0536, Accuracy: 273/1036 (26.3514%)
___Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   2, Avg loss: 0.0246, Accuracy: 664/1036 (64.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 12.7329, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0882, Accuracy: 55/603 (9.1211%)
___Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0523, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.3847, Accuracy: 52/10000 (0.5200%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   1, Avg loss: 0.0960, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   2, Avg loss: 0.0526, Accuracy: 98/440 (22.2727%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.4875, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0901, Accuracy: 84/1013 (8.2922%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0396, Accuracy: 351/1013 (34.6496%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.7698, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   1, Avg loss: 0.0765, Accuracy: 156/1154 (13.5182%)
___Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   2, Avg loss: 0.0290, Accuracy: 470/1154 (40.7279%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 10.7338, Accuracy: 78/10000 (0.7800%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   1, Avg loss: 0.0723, Accuracy: 289/1988 (14.5372%)
___Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   2, Avg loss: 0.0388, Accuracy: 583/1988 (29.3260%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.3311, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0657, Accuracy: 329/1715 (19.1837%)
___Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0319, Accuracy: 664/1715 (38.7172%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.8008, Accuracy: 96/10000 (0.9600%)
time spent on training: 298.14720940589905
___Test Target_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.4179, Accuracy: 61/10000 (0.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Avg loss: 0.6131, Accuracy: 9320/9950 (93.6683%)
saving model
Done in 714.7782726287842 sec.
Server Epoch:77 choose agents : [81, 75, 66, 1, 61, 65, 79, 49, 94, 10].
poison local model 81 index 28 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   1, Average loss: 0.0412, Accuracy: 476/774 (61.4987%), train_poison_data_count: 486
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   2, Average loss: 0.0299, Accuracy: 458/774 (59.1731%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   3, Average loss: 0.0258, Accuracy: 464/774 (59.9483%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   4, Average loss: 0.0264, Accuracy: 474/774 (61.2403%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   5, Average loss: 0.0246, Accuracy: 483/774 (62.4031%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   6, Average loss: 0.0239, Accuracy: 481/774 (62.1447%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   7, Average loss: 0.0251, Accuracy: 473/774 (61.1111%), train_poison_data_count: 486
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   8, Average loss: 0.0236, Accuracy: 473/774 (61.1111%), train_poison_data_count: 486
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   9, Average loss: 0.0250, Accuracy: 481/774 (62.1447%), train_poison_data_count: 486
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch  10, Average loss: 0.0235, Accuracy: 483/774 (62.4031%), train_poison_data_count: 486
Global model norm: 312.43062980044067.
Norm before scaling: 312.39066837455306. Distance: 0.6323942992505379
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.1977, Accuracy: 52/10000 (0.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 77: Avg loss: 0.3389, Accuracy: 9212/9950 (92.5829%)
Scaling by  100
Scaled Norm after poisoning: 314.75961810165546, distance: 63.23942483542703
Total norm for 5 adversaries is: 314.75961810165546. distance: 63.23942483542703
___Test Local_ResNet_18 poisoned: True, epoch: 77: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   1, Avg loss: 0.0873, Accuracy: 101/776 (13.0155%)
___Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   2, Avg loss: 0.0350, Accuracy: 383/776 (49.3557%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 9.5745, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0808, Accuracy: 145/1402 (10.3424%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0423, Accuracy: 364/1402 (25.9629%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.3090, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   1, Avg loss: 0.0688, Accuracy: 192/928 (20.6897%)
___Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   2, Avg loss: 0.0259, Accuracy: 539/928 (58.0819%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 10.4754, Accuracy: 100/10000 (1.0000%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1639, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1490, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.9293, Accuracy: 73/10000 (0.7300%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   1, Avg loss: 0.0535, Accuracy: 352/1475 (23.8644%)
___Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   2, Avg loss: 0.0319, Accuracy: 647/1475 (43.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.3031, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   1, Avg loss: 0.1519, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   2, Avg loss: 0.1210, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.4903, Accuracy: 82/10000 (0.8200%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0930, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0517, Accuracy: 115/440 (26.1364%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.6704, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0712, Accuracy: 205/1662 (12.3345%)
___Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0363, Accuracy: 558/1662 (33.5740%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.7234, Accuracy: 95/10000 (0.9500%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   1, Avg loss: 0.0753, Accuracy: 106/861 (12.3113%)
___Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   2, Avg loss: 0.0232, Accuracy: 408/861 (47.3868%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 11.0099, Accuracy: 88/10000 (0.8800%)
time spent on training: 336.2557592391968
___Test Target_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.2215, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Avg loss: 1.2825, Accuracy: 3965/9950 (39.8492%)
saving model
Done in 755.0080671310425 sec.
Server Epoch:78 choose agents : [42, 6, 82, 30, 19, 31, 93, 7, 5, 16].
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   1, Avg loss: 0.0695, Accuracy: 181/1372 (13.1924%)
___Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   2, Avg loss: 0.0325, Accuracy: 487/1372 (35.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.6087, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   1, Avg loss: 0.0666, Accuracy: 294/1956 (15.0307%)
___Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   2, Avg loss: 0.0327, Accuracy: 657/1956 (33.5890%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.9534, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   1, Avg loss: 0.1003, Accuracy: 16/500 (3.2000%)
___Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   2, Avg loss: 0.0571, Accuracy: 173/500 (34.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.7802, Accuracy: 61/10000 (0.6100%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.1047, Accuracy: 1/486 (0.2058%)
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0456, Accuracy: 213/486 (43.8272%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.3388, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   1, Avg loss: 0.0591, Accuracy: 271/1036 (26.1583%)
___Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   2, Avg loss: 0.0252, Accuracy: 665/1036 (64.1892%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 12.8254, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   1, Avg loss: 0.1056, Accuracy: 3/460 (0.6522%)
___Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   2, Avg loss: 0.0439, Accuracy: 158/460 (34.3478%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.6025, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   1, Avg loss: 0.0666, Accuracy: 331/1742 (19.0011%)
___Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   2, Avg loss: 0.0323, Accuracy: 693/1742 (39.7819%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.8308, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   1, Avg loss: 0.0754, Accuracy: 189/891 (21.2121%)
___Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   2, Avg loss: 0.0302, Accuracy: 418/891 (46.9136%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.4735, Accuracy: 65/10000 (0.6500%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   1, Avg loss: 0.0681, Accuracy: 238/1628 (14.6192%)
___Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   2, Avg loss: 0.0283, Accuracy: 686/1628 (42.1376%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.9515, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   1, Avg loss: 0.0922, Accuracy: 117/708 (16.5254%)
___Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   2, Avg loss: 0.0433, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.3654, Accuracy: 64/10000 (0.6400%)
time spent on training: 302.37874698638916
___Test Target_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.6293, Accuracy: 62/10000 (0.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Avg loss: 1.4421, Accuracy: 4335/9950 (43.5678%)
saving model
Done in 721.3545160293579 sec.
Server Epoch:79 choose agents : [84, 82, 36, 58, 27, 49, 61, 52, 90, 85].
poison local model 84 index 29 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   1, Average loss: 0.0479, Accuracy: 719/1190 (60.4202%), train_poison_data_count: 758
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   2, Average loss: 0.0293, Accuracy: 698/1190 (58.6555%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   3, Average loss: 0.0251, Accuracy: 722/1190 (60.6723%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   4, Average loss: 0.0258, Accuracy: 729/1190 (61.2605%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   5, Average loss: 0.0246, Accuracy: 716/1190 (60.1681%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   6, Average loss: 0.0245, Accuracy: 737/1190 (61.9328%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   7, Average loss: 0.0240, Accuracy: 746/1190 (62.6891%), train_poison_data_count: 758
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   8, Average loss: 0.0235, Accuracy: 750/1190 (63.0252%), train_poison_data_count: 758
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   9, Average loss: 0.0235, Accuracy: 742/1190 (62.3529%), train_poison_data_count: 758
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch  10, Average loss: 0.0237, Accuracy: 735/1190 (61.7647%), train_poison_data_count: 758
Global model norm: 315.9768212424766.
Norm before scaling: 315.91167673892653. Distance: 0.9236976579798954
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.1598, Accuracy: 52/10000 (0.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 79: Avg loss: 0.2659, Accuracy: 9707/9950 (97.5578%)
Scaling by  100
Scaled Norm after poisoning: 322.75643874290097, distance: 92.36976685109148
Total norm for 5 adversaries is: 322.75643874290097. distance: 92.36976685109148
___Test Local_ResNet_18 poisoned: True, epoch: 79: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   1, Avg loss: 0.0928, Accuracy: 23/500 (4.6000%)
___Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   2, Avg loss: 0.0552, Accuracy: 165/500 (33.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.7522, Accuracy: 59/10000 (0.5900%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   1, Avg loss: 0.1084, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   2, Avg loss: 0.0581, Accuracy: 102/408 (25.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.6838, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   1, Avg loss: 0.0771, Accuracy: 187/803 (23.2877%)
___Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   2, Avg loss: 0.0410, Accuracy: 445/803 (55.4172%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.5746, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0768, Accuracy: 272/1587 (17.1393%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0365, Accuracy: 572/1587 (36.0428%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.2414, Accuracy: 68/10000 (0.6800%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   1, Avg loss: 0.1009, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   2, Avg loss: 0.0538, Accuracy: 103/440 (23.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.2810, Accuracy: 57/10000 (0.5700%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   1, Avg loss: 0.1672, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   2, Avg loss: 0.1576, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.0817, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0770, Accuracy: 140/636 (22.0126%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0415, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 10.0540, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   1, Avg loss: 0.0798, Accuracy: 128/677 (18.9069%)
___Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   2, Avg loss: 0.0241, Accuracy: 465/677 (68.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 12.3826, Accuracy: 55/10000 (0.5500%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0709, Accuracy: 303/1988 (15.2414%)
___Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0388, Accuracy: 632/1988 (31.7907%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.7440, Accuracy: 78/10000 (0.7800%)
time spent on training: 376.3212299346924
___Test Target_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.0087, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Avg loss: 0.5921, Accuracy: 8542/9950 (85.8492%)
saving model
Done in 797.8630754947662 sec.
Server Epoch:80 choose agents : [46, 75, 54, 3, 89, 69, 41, 1, 93, 71].
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0684, Accuracy: 317/1904 (16.6492%)
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0323, Accuracy: 672/1904 (35.2941%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.3786, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0930, Accuracy: 82/776 (10.5670%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0362, Accuracy: 391/776 (50.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.4532, Accuracy: 60/10000 (0.6000%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   1, Avg loss: 0.0740, Accuracy: 215/1130 (19.0265%)
___Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   2, Avg loss: 0.0314, Accuracy: 477/1130 (42.2124%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.7497, Accuracy: 55/10000 (0.5500%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   1, Avg loss: 0.0941, Accuracy: 18/781 (2.3047%)
___Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   2, Avg loss: 0.0387, Accuracy: 265/781 (33.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.3876, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0846, Accuracy: 201/896 (22.4330%)
___Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0399, Accuracy: 466/896 (52.0089%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.7360, Accuracy: 63/10000 (0.6300%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   1, Avg loss: 0.0819, Accuracy: 104/590 (17.6271%)
___Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   2, Avg loss: 0.0359, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 13.0881, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   1, Avg loss: 0.1031, Accuracy: 88/719 (12.2392%)
___Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   2, Avg loss: 0.0433, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.6343, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   1, Avg loss: 0.0740, Accuracy: 170/928 (18.3190%)
___Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   2, Avg loss: 0.0276, Accuracy: 544/928 (58.6207%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.4217, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   1, Avg loss: 0.0673, Accuracy: 286/1742 (16.4179%)
___Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 690/1742 (39.6096%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.8626, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   1, Avg loss: 0.0770, Accuracy: 89/818 (10.8802%)
___Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   2, Avg loss: 0.0327, Accuracy: 330/818 (40.3423%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.5114, Accuracy: 80/10000 (0.8000%)
time spent on training: 259.5551264286041
___Test Target_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.7302, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Avg loss: 1.2889, Accuracy: 6023/9950 (60.5327%)
saving model
Done in 676.9075877666473 sec.
Server Epoch:81 choose agents : [85, 15, 81, 53, 39, 54, 28, 61, 0, 51].
poison local model 85 index 30 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   1, Average loss: 0.0433, Accuracy: 1212/1988 (60.9658%), train_poison_data_count: 1244
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   2, Average loss: 0.0277, Accuracy: 1199/1988 (60.3119%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   3, Average loss: 0.0253, Accuracy: 1227/1988 (61.7203%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   4, Average loss: 0.0251, Accuracy: 1218/1988 (61.2676%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   5, Average loss: 0.0244, Accuracy: 1227/1988 (61.7203%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   6, Average loss: 0.0245, Accuracy: 1230/1988 (61.8712%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   7, Average loss: 0.0242, Accuracy: 1225/1988 (61.6197%), train_poison_data_count: 1244
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   8, Average loss: 0.0238, Accuracy: 1224/1988 (61.5694%), train_poison_data_count: 1244
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   9, Average loss: 0.0239, Accuracy: 1228/1988 (61.7706%), train_poison_data_count: 1244
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch  10, Average loss: 0.0236, Accuracy: 1239/1988 (62.3239%), train_poison_data_count: 1244
Global model norm: 319.46405314213365.
Norm before scaling: 319.34418882688317. Distance: 1.2125072026776191
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.5349, Accuracy: 60/10000 (0.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 81: Avg loss: 0.2663, Accuracy: 9679/9950 (97.2764%)
Scaling by  100
Scaled Norm after poisoning: 330.0841630364898, distance: 121.25071278785333
Total norm for 6 adversaries is: 330.0841630364898. distance: 121.25071278785333
___Test Local_ResNet_18 poisoned: True, epoch: 81: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0764, Accuracy: 224/1154 (19.4107%)
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0324, Accuracy: 413/1154 (35.7886%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.7919, Accuracy: 68/10000 (0.6800%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0688, Accuracy: 132/774 (17.0543%)
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0344, Accuracy: 359/774 (46.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.0712, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0707, Accuracy: 141/813 (17.3432%)
___Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0225, Accuracy: 434/813 (53.3825%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 13.2789, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   1, Avg loss: 0.0817, Accuracy: 121/1013 (11.9447%)
___Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   2, Avg loss: 0.0296, Accuracy: 476/1013 (46.9891%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 10.4472, Accuracy: 76/10000 (0.7600%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0708, Accuracy: 226/1130 (20.0000%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0318, Accuracy: 469/1130 (41.5044%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.5143, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   1, Avg loss: 0.0692, Accuracy: 248/1581 (15.6863%)
___Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   2, Avg loss: 0.0356, Accuracy: 558/1581 (35.2941%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.6266, Accuracy: 80/10000 (0.8000%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1803, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1668, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.3007, Accuracy: 58/10000 (0.5800%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   1, Avg loss: 0.0759, Accuracy: 232/1657 (14.0012%)
___Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   2, Avg loss: 0.0393, Accuracy: 452/1657 (27.2782%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.2687, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   1, Avg loss: 0.0833, Accuracy: 123/1049 (11.7255%)
___Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   2, Avg loss: 0.0310, Accuracy: 474/1049 (45.1859%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.2843, Accuracy: 114/10000 (1.1400%)
time spent on training: 430.531441450119
___Test Target_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.8026, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Avg loss: 0.4209, Accuracy: 9088/9950 (91.3367%)
saving model
Done in 855.3639285564423 sec.
Server Epoch:82 choose agents : [23, 74, 72, 38, 79, 44, 28, 77, 55, 70].
___Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   1, Avg loss: 0.1084, Accuracy: 75/715 (10.4895%)
___Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   2, Avg loss: 0.0510, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.7930, Accuracy: 57/10000 (0.5700%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0534, Accuracy: 405/1552 (26.0954%)
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0224, Accuracy: 751/1552 (48.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 12.2536, Accuracy: 92/10000 (0.9200%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0730, Accuracy: 161/1241 (12.9734%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0384, Accuracy: 397/1241 (31.9903%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.6349, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   1, Avg loss: 0.0895, Accuracy: 127/1131 (11.2290%)
___Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   2, Avg loss: 0.0356, Accuracy: 436/1131 (38.5500%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 9.0117, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1829, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.1446, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.4435, Accuracy: 66/10000 (0.6600%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0763, Accuracy: 261/1750 (14.9143%)
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0378, Accuracy: 601/1750 (34.3429%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.3008, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0696, Accuracy: 274/1581 (17.3308%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0363, Accuracy: 539/1581 (34.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.7313, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   1, Avg loss: 0.0769, Accuracy: 228/1340 (17.0149%)
___Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   2, Avg loss: 0.0304, Accuracy: 576/1340 (42.9851%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 10.7216, Accuracy: 86/10000 (0.8600%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   1, Avg loss: 0.0751, Accuracy: 162/1071 (15.1261%)
___Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   2, Avg loss: 0.0319, Accuracy: 512/1071 (47.8058%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 10.6644, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   1, Avg loss: 0.0803, Accuracy: 231/1418 (16.2906%)
___Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   2, Avg loss: 0.0336, Accuracy: 608/1418 (42.8773%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.8206, Accuracy: 94/10000 (0.9400%)
time spent on training: 344.9976668357849
___Test Target_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.7445, Accuracy: 66/10000 (0.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Avg loss: 0.6532, Accuracy: 8147/9950 (81.8794%)
saving model
Done in 787.0109539031982 sec.
Server Epoch:83 choose agents : [95, 76, 60, 48, 18, 10, 90, 78, 15, 89].
poison local model 95 index 31 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   1, Average loss: 0.0538, Accuracy: 350/599 (58.4307%), train_poison_data_count: 383
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   2, Average loss: 0.0287, Accuracy: 352/599 (58.7646%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   3, Average loss: 0.0221, Accuracy: 292/599 (48.7479%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   4, Average loss: 0.0185, Accuracy: 381/599 (63.6060%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   5, Average loss: 0.0201, Accuracy: 374/599 (62.4374%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   6, Average loss: 0.0195, Accuracy: 379/599 (63.2721%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   7, Average loss: 0.0192, Accuracy: 370/599 (61.7696%), train_poison_data_count: 383
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   8, Average loss: 0.0190, Accuracy: 379/599 (63.2721%), train_poison_data_count: 383
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   9, Average loss: 0.0187, Accuracy: 368/599 (61.4357%), train_poison_data_count: 383
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch  10, Average loss: 0.0187, Accuracy: 377/599 (62.9382%), train_poison_data_count: 383
Global model norm: 322.83449223247504.
Norm before scaling: 322.80461631225165. Distance: 0.6593950160093608
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 9.6410, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 83: Avg loss: 0.2318, Accuracy: 9266/9950 (93.1256%)
Scaling by  100
Scaled Norm after poisoning: 326.4946640069329, distance: 65.93950678225839
Total norm for 7 adversaries is: 326.4946640069329. distance: 65.93950678225839
___Test Local_ResNet_18 poisoned: True, epoch: 83: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   1, Avg loss: 0.1210, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   2, Avg loss: 0.0608, Accuracy: 112/466 (24.0343%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.3089, Accuracy: 56/10000 (0.5600%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   1, Avg loss: 0.0587, Accuracy: 498/2227 (22.3619%)
___Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   2, Avg loss: 0.0298, Accuracy: 982/2227 (44.0952%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.8143, Accuracy: 130/10000 (1.3000%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   1, Avg loss: 0.1013, Accuracy: 12/631 (1.9017%)
___Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   2, Avg loss: 0.0489, Accuracy: 215/631 (34.0729%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.0237, Accuracy: 78/10000 (0.7800%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.1114, Accuracy: 4/530 (0.7547%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0458, Accuracy: 266/530 (50.1887%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 9.9607, Accuracy: 71/10000 (0.7100%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   1, Avg loss: 0.0852, Accuracy: 80/861 (9.2915%)
___Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   2, Avg loss: 0.0237, Accuracy: 428/861 (49.7096%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.9085, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   1, Avg loss: 0.0828, Accuracy: 105/677 (15.5096%)
___Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   2, Avg loss: 0.0242, Accuracy: 467/677 (68.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 12.8655, Accuracy: 57/10000 (0.5700%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.1020, Accuracy: 2/416 (0.4808%)
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0488, Accuracy: 151/416 (36.2981%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.4679, Accuracy: 75/10000 (0.7500%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   1, Avg loss: 0.0818, Accuracy: 193/1154 (16.7244%)
___Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   2, Avg loss: 0.0405, Accuracy: 424/1154 (36.7418%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 9.6302, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   1, Avg loss: 0.0880, Accuracy: 177/896 (19.7545%)
___Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   2, Avg loss: 0.0400, Accuracy: 471/896 (52.5670%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.1754, Accuracy: 55/10000 (0.5500%)
time spent on training: 395.8754143714905
___Test Target_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.2890, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Avg loss: 0.4121, Accuracy: 8297/9950 (83.3869%)
saving model
Done in 836.1117980480194 sec.
Server Epoch:84 choose agents : [61, 28, 35, 75, 74, 90, 55, 80, 23, 88].
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.2141, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1906, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.8242, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0686, Accuracy: 287/1581 (18.1531%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0351, Accuracy: 563/1581 (35.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.8558, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.1430, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0759, Accuracy: 28/271 (10.3321%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.6222, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   1, Avg loss: 0.0987, Accuracy: 84/776 (10.8247%)
___Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   2, Avg loss: 0.0329, Accuracy: 405/776 (52.1907%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 9.9926, Accuracy: 65/10000 (0.6500%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   1, Avg loss: 0.0526, Accuracy: 406/1552 (26.1598%)
___Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   2, Avg loss: 0.0224, Accuracy: 745/1552 (48.0026%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 12.2568, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   1, Avg loss: 0.0895, Accuracy: 111/677 (16.3959%)
___Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 465/677 (68.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 12.7207, Accuracy: 58/10000 (0.5800%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0744, Accuracy: 188/1071 (17.5537%)
___Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0306, Accuracy: 506/1071 (47.2456%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 10.0127, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.1054, Accuracy: 35/682 (5.1320%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0439, Accuracy: 277/682 (40.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.9383, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   1, Avg loss: 0.1043, Accuracy: 96/715 (13.4266%)
___Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   2, Avg loss: 0.0512, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.0721, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.1057, Accuracy: 36/603 (5.9701%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0518, Accuracy: 288/603 (47.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.9075, Accuracy: 59/10000 (0.5900%)
time spent on training: 267.5886869430542
___Test Target_ResNet_18 poisoned: False, epoch: 84: Avg loss: 9.9326, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Avg loss: 0.5029, Accuracy: 7901/9950 (79.4070%)
saving model
Done in 689.9965183734894 sec.
Server Epoch:85 choose agents : [36, 56, 25, 90, 31, 70, 30, 21, 46, 64].
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   1, Avg loss: 0.1199, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   2, Avg loss: 0.0586, Accuracy: 106/408 (25.9804%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.9349, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   1, Avg loss: 0.1374, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   2, Avg loss: 0.1091, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.0499, Accuracy: 51/10000 (0.5100%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   1, Avg loss: 0.0866, Accuracy: 142/690 (20.5797%)
___Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   2, Avg loss: 0.0366, Accuracy: 456/690 (66.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 10.0505, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   1, Avg loss: 0.0819, Accuracy: 129/677 (19.0547%)
___Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 475/677 (70.1625%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 12.3318, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.1074, Accuracy: 2/460 (0.4348%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0401, Accuracy: 166/460 (36.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.6946, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   1, Avg loss: 0.0770, Accuracy: 263/1418 (18.5472%)
___Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   2, Avg loss: 0.0344, Accuracy: 568/1418 (40.0564%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.6340, Accuracy: 99/10000 (0.9900%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.1117, Accuracy: 2/486 (0.4115%)
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0427, Accuracy: 215/486 (44.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.4605, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   1, Avg loss: 0.0688, Accuracy: 284/1949 (14.5716%)
___Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   2, Avg loss: 0.0356, Accuracy: 608/1949 (31.1955%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.5740, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   1, Avg loss: 0.0706, Accuracy: 320/1904 (16.8067%)
___Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   2, Avg loss: 0.0334, Accuracy: 634/1904 (33.2983%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.6273, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0952, Accuracy: 66/953 (6.9255%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0442, Accuracy: 335/953 (35.1522%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.4913, Accuracy: 72/10000 (0.7200%)
time spent on training: 298.3723232746124
___Test Target_ResNet_18 poisoned: False, epoch: 85: Avg loss: 10.0657, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Avg loss: 0.5921, Accuracy: 7653/9950 (76.9146%)
saving model
Done in 735.952249288559 sec.
Server Epoch:86 choose agents : [94, 50, 2, 53, 86, 67, 12, 69, 24, 81].
___Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   1, Avg loss: 0.0769, Accuracy: 215/1662 (12.9362%)
___Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   2, Avg loss: 0.0374, Accuracy: 545/1662 (32.7918%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.3454, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   1, Avg loss: 0.0805, Accuracy: 61/809 (7.5402%)
___Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   2, Avg loss: 0.0305, Accuracy: 307/809 (37.9481%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.2065, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.1093, Accuracy: 12/605 (1.9835%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0493, Accuracy: 322/605 (53.2231%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.3848, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   1, Avg loss: 0.0686, Accuracy: 151/813 (18.5732%)
___Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   2, Avg loss: 0.0210, Accuracy: 481/813 (59.1636%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 13.1499, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   1, Avg loss: 0.0705, Accuracy: 228/1003 (22.7318%)
___Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   2, Avg loss: 0.0363, Accuracy: 415/1003 (41.3759%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.3380, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   1, Avg loss: 0.1124, Accuracy: 2/426 (0.4695%)
___Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   2, Avg loss: 0.0552, Accuracy: 137/426 (32.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.2050, Accuracy: 55/10000 (0.5500%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   1, Avg loss: 0.1203, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   2, Avg loss: 0.0646, Accuracy: 87/338 (25.7396%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.1034, Accuracy: 63/10000 (0.6300%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   1, Avg loss: 0.0839, Accuracy: 97/590 (16.4407%)
___Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   2, Avg loss: 0.0357, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 13.4667, Accuracy: 50/10000 (0.5000%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.1142, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0591, Accuracy: 65/312 (20.8333%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.3613, Accuracy: 58/10000 (0.5800%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0768, Accuracy: 114/774 (14.7287%)
___Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0362, Accuracy: 351/774 (45.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.4446, Accuracy: 68/10000 (0.6800%)
time spent on training: 265.9510130882263
___Test Target_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.8188, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Avg loss: 0.7547, Accuracy: 7393/9950 (74.3015%)
saving model
Done in 695.5230429172516 sec.
Server Epoch:87 choose agents : [39, 80, 90, 83, 43, 57, 67, 2, 23, 36].
___Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   1, Avg loss: 0.0815, Accuracy: 123/1013 (12.1422%)
___Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   2, Avg loss: 0.0294, Accuracy: 496/1013 (48.9635%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 10.7892, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   1, Avg loss: 0.0901, Accuracy: 41/682 (6.0117%)
___Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   2, Avg loss: 0.0438, Accuracy: 258/682 (37.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.9547, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   1, Avg loss: 0.0765, Accuracy: 126/677 (18.6115%)
___Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   2, Avg loss: 0.0248, Accuracy: 456/677 (67.3560%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 13.0099, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   1, Avg loss: 0.0681, Accuracy: 320/1953 (16.3850%)
___Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   2, Avg loss: 0.0369, Accuracy: 678/1953 (34.7158%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.3369, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0800, Accuracy: 160/946 (16.9133%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0420, Accuracy: 372/946 (39.3235%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.8519, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0830, Accuracy: 144/1154 (12.4783%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0331, Accuracy: 438/1154 (37.9549%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 11.3327, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   1, Avg loss: 0.1091, Accuracy: 1/426 (0.2347%)
___Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   2, Avg loss: 0.0566, Accuracy: 146/426 (34.2723%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.4643, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   1, Avg loss: 0.1057, Accuracy: 17/605 (2.8099%)
___Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   2, Avg loss: 0.0483, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.1630, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0921, Accuracy: 122/715 (17.0629%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0506, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.3347, Accuracy: 62/10000 (0.6200%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   1, Avg loss: 0.1110, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   2, Avg loss: 0.0593, Accuracy: 107/408 (26.2255%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.0779, Accuracy: 54/10000 (0.5400%)
time spent on training: 267.5427477359772
___Test Target_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.4393, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Avg loss: 1.3279, Accuracy: 5494/9950 (55.2161%)
saving model
Done in 705.4329793453217 sec.
Server Epoch:88 choose agents : [4, 42, 28, 74, 13, 49, 24, 34, 87, 86].
___Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   1, Avg loss: 0.0878, Accuracy: 160/901 (17.7580%)
___Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   2, Avg loss: 0.0441, Accuracy: 416/901 (46.1709%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.6797, Accuracy: 66/10000 (0.6600%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   1, Avg loss: 0.0730, Accuracy: 185/1372 (13.4840%)
___Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   2, Avg loss: 0.0342, Accuracy: 458/1372 (33.3819%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.5157, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0646, Accuracy: 286/1581 (18.0898%)
___Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0357, Accuracy: 549/1581 (34.7249%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.5761, Accuracy: 94/10000 (0.9400%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   1, Avg loss: 0.0459, Accuracy: 416/1552 (26.8041%)
___Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   2, Avg loss: 0.0228, Accuracy: 733/1552 (47.2294%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 11.5958, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   1, Avg loss: 0.0756, Accuracy: 236/1645 (14.3465%)
___Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   2, Avg loss: 0.0357, Accuracy: 537/1645 (32.6444%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.8862, Accuracy: 107/10000 (1.0700%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   1, Avg loss: 0.1045, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   2, Avg loss: 0.0591, Accuracy: 95/440 (21.5909%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.5011, Accuracy: 67/10000 (0.6700%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   1, Avg loss: 0.1029, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   2, Avg loss: 0.0546, Accuracy: 76/312 (24.3590%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.7051, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0737, Accuracy: 253/1427 (17.7295%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0353, Accuracy: 564/1427 (39.5235%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.4161, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   1, Avg loss: 0.0775, Accuracy: 189/1131 (16.7109%)
___Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   2, Avg loss: 0.0370, Accuracy: 376/1131 (33.2449%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.1041, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0648, Accuracy: 252/1003 (25.1246%)
___Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0371, Accuracy: 407/1003 (40.5783%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.3324, Accuracy: 60/10000 (0.6000%)
time spent on training: 329.1694872379303
___Test Target_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.1546, Accuracy: 59/10000 (0.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Avg loss: 1.7882, Accuracy: 4195/9950 (42.1608%)
saving model
Done in 768.2038478851318 sec.
Server Epoch:89 choose agents : [84, 89, 29, 52, 37, 30, 66, 62, 88, 42].
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0599, Accuracy: 254/1190 (21.3445%)
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0304, Accuracy: 483/1190 (40.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.9562, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0783, Accuracy: 200/896 (22.3214%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0394, Accuracy: 456/896 (50.8929%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.2780, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   1, Avg loss: 0.0720, Accuracy: 302/1440 (20.9722%)
___Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   2, Avg loss: 0.0315, Accuracy: 653/1440 (45.3472%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.2316, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   1, Avg loss: 0.0759, Accuracy: 136/636 (21.3836%)
___Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   2, Avg loss: 0.0412, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 10.1646, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   1, Avg loss: 0.0666, Accuracy: 250/1129 (22.1435%)
___Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   2, Avg loss: 0.0283, Accuracy: 638/1129 (56.5102%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.9554, Accuracy: 103/10000 (1.0300%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   1, Avg loss: 0.0942, Accuracy: 10/486 (2.0576%)
___Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   2, Avg loss: 0.0434, Accuracy: 207/486 (42.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.9233, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0818, Accuracy: 123/1402 (8.7732%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0424, Accuracy: 354/1402 (25.2496%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.3929, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   1, Avg loss: 0.0914, Accuracy: 15/568 (2.6408%)
___Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   2, Avg loss: 0.0451, Accuracy: 253/568 (44.5423%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.3330, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   1, Avg loss: 0.0879, Accuracy: 56/603 (9.2869%)
___Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   2, Avg loss: 0.0504, Accuracy: 289/603 (47.9270%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.4961, Accuracy: 56/10000 (0.5600%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0717, Accuracy: 198/1372 (14.4315%)
___Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0348, Accuracy: 470/1372 (34.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.5161, Accuracy: 83/10000 (0.8300%)
time spent on training: 324.71527218818665
___Test Target_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.6001, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Avg loss: 2.5217, Accuracy: 2790/9950 (28.0402%)
saving model
Done in 763.375510931015 sec.
Server Epoch:90 choose agents : [43, 80, 99, 44, 67, 39, 70, 50, 86, 91].
___Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   1, Avg loss: 0.0802, Accuracy: 156/946 (16.4905%)
___Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   2, Avg loss: 0.0432, Accuracy: 365/946 (38.5835%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.8839, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   1, Avg loss: 0.0779, Accuracy: 82/682 (12.0235%)
___Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   2, Avg loss: 0.0417, Accuracy: 268/682 (39.2962%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.5655, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   1, Avg loss: 0.0894, Accuracy: 91/773 (11.7723%)
___Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   2, Avg loss: 0.0348, Accuracy: 368/773 (47.6067%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.3139, Accuracy: 69/10000 (0.6900%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   1, Avg loss: 0.0684, Accuracy: 271/1750 (15.4857%)
___Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   2, Avg loss: 0.0378, Accuracy: 628/1750 (35.8857%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.4303, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   1, Avg loss: 0.0957, Accuracy: 8/426 (1.8779%)
___Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   2, Avg loss: 0.0506, Accuracy: 150/426 (35.2113%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.5515, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0777, Accuracy: 138/1013 (13.6229%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0289, Accuracy: 481/1013 (47.4827%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.8438, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0663, Accuracy: 285/1418 (20.0987%)
___Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0343, Accuracy: 605/1418 (42.6657%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.6711, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   1, Avg loss: 0.0751, Accuracy: 67/809 (8.2818%)
___Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   2, Avg loss: 0.0310, Accuracy: 321/809 (39.6786%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.1751, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   1, Avg loss: 0.0638, Accuracy: 263/1003 (26.2213%)
___Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   2, Avg loss: 0.0369, Accuracy: 411/1003 (40.9771%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.2481, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   1, Avg loss: 0.0689, Accuracy: 211/1030 (20.4854%)
___Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   2, Avg loss: 0.0298, Accuracy: 580/1030 (56.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 11.1651, Accuracy: 92/10000 (0.9200%)
time spent on training: 287.7439353466034
___Test Target_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.9392, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Avg loss: 2.1207, Accuracy: 3548/9950 (35.6583%)
saving model
Done in 726.8036592006683 sec.
Server Epoch:91 choose agents : [33, 37, 28, 92, 97, 43, 56, 44, 24, 64].
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0978, Accuracy: 9/515 (1.7476%)
___Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0610, Accuracy: 124/515 (24.0777%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.9752, Accuracy: 58/10000 (0.5800%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   1, Avg loss: 0.0629, Accuracy: 274/1129 (24.2693%)
___Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   2, Avg loss: 0.0267, Accuracy: 682/1129 (60.4074%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 10.1654, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   1, Avg loss: 0.0622, Accuracy: 307/1581 (19.4181%)
___Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   2, Avg loss: 0.0361, Accuracy: 559/1581 (35.3574%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.6356, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   1, Avg loss: 0.0640, Accuracy: 318/1715 (18.5423%)
___Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   2, Avg loss: 0.0329, Accuracy: 636/1715 (37.0845%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.9267, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   1, Avg loss: 0.0756, Accuracy: 194/1213 (15.9934%)
___Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   2, Avg loss: 0.0318, Accuracy: 496/1213 (40.8904%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 10.2736, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0788, Accuracy: 158/946 (16.7019%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0426, Accuracy: 356/946 (37.6321%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.0059, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   1, Avg loss: 0.1188, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   2, Avg loss: 0.1009, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.9941, Accuracy: 78/10000 (0.7800%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   1, Avg loss: 0.0676, Accuracy: 252/1750 (14.4000%)
___Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   2, Avg loss: 0.0380, Accuracy: 599/1750 (34.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.3900, Accuracy: 97/10000 (0.9700%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0992, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0562, Accuracy: 80/312 (25.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.2675, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   1, Avg loss: 0.0850, Accuracy: 85/953 (8.9192%)
___Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   2, Avg loss: 0.0420, Accuracy: 306/953 (32.1091%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.7589, Accuracy: 67/10000 (0.6700%)
time spent on training: 328.2054936885834
___Test Target_ResNet_18 poisoned: False, epoch: 91: Avg loss: 9.2214, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Avg loss: 3.1575, Accuracy: 1631/9950 (16.3920%)
saving model
Done in 762.0289597511292 sec.
Server Epoch:92 choose agents : [71, 40, 7, 67, 97, 72, 34, 58, 26, 38].
___Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   1, Avg loss: 0.0751, Accuracy: 130/818 (15.8924%)
___Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   2, Avg loss: 0.0338, Accuracy: 317/818 (38.7531%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.6058, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0679, Accuracy: 282/1573 (17.9275%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0385, Accuracy: 531/1573 (33.7572%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.2497, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   1, Avg loss: 0.0716, Accuracy: 193/891 (21.6611%)
___Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   2, Avg loss: 0.0309, Accuracy: 416/891 (46.6891%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.6651, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0952, Accuracy: 7/426 (1.6432%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0520, Accuracy: 152/426 (35.6808%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.3562, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   1, Avg loss: 0.0740, Accuracy: 173/1213 (14.2622%)
___Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   2, Avg loss: 0.0309, Accuracy: 513/1213 (42.2918%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 10.1041, Accuracy: 93/10000 (0.9300%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 236/1241 (19.0169%)
___Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 430/1241 (34.6495%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.6230, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   1, Avg loss: 0.0677, Accuracy: 265/1427 (18.5704%)
___Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   2, Avg loss: 0.0353, Accuracy: 547/1427 (38.3322%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.3914, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0757, Accuracy: 184/803 (22.9141%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0416, Accuracy: 424/803 (52.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.4168, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   1, Avg loss: 0.0680, Accuracy: 235/1446 (16.2517%)
___Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   2, Avg loss: 0.0391, Accuracy: 472/1446 (32.6418%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.1346, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0739, Accuracy: 152/1131 (13.4394%)
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0349, Accuracy: 438/1131 (38.7268%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.8140, Accuracy: 96/10000 (0.9600%)
time spent on training: 330.33077931404114
___Test Target_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.6303, Accuracy: 63/10000 (0.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Avg loss: 3.5294, Accuracy: 1465/9950 (14.7236%)
saving model
Done in 761.7079873085022 sec.
Server Epoch:93 choose agents : [62, 58, 59, 51, 15, 43, 3, 13, 79, 53].
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.0888, Accuracy: 16/568 (2.8169%)
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0454, Accuracy: 251/568 (44.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.4320, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   1, Avg loss: 0.0759, Accuracy: 175/803 (21.7933%)
___Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   2, Avg loss: 0.0406, Accuracy: 426/803 (53.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.8611, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0723, Accuracy: 192/1089 (17.6309%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0335, Accuracy: 506/1089 (46.4646%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 11.0380, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   1, Avg loss: 0.0807, Accuracy: 124/1049 (11.8208%)
___Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   2, Avg loss: 0.0328, Accuracy: 473/1049 (45.0906%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.7701, Accuracy: 95/10000 (0.9500%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0719, Accuracy: 246/1154 (21.3172%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0351, Accuracy: 426/1154 (36.9151%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.4927, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   1, Avg loss: 0.0754, Accuracy: 167/946 (17.6533%)
___Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   2, Avg loss: 0.0432, Accuracy: 352/946 (37.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.0976, Accuracy: 70/10000 (0.7000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   1, Avg loss: 0.0845, Accuracy: 28/781 (3.5851%)
___Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   2, Avg loss: 0.0380, Accuracy: 258/781 (33.0346%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.5742, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   1, Avg loss: 0.0697, Accuracy: 264/1645 (16.0486%)
___Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   2, Avg loss: 0.0363, Accuracy: 531/1645 (32.2796%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.0174, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   1, Avg loss: 0.1460, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   2, Avg loss: 0.1244, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 6.8431, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   1, Avg loss: 0.0646, Accuracy: 176/813 (21.6482%)
___Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   2, Avg loss: 0.0216, Accuracy: 444/813 (54.6125%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 13.1325, Accuracy: 43/10000 (0.4300%)
time spent on training: 282.3214702606201
___Test Target_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.6453, Accuracy: 63/10000 (0.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Avg loss: 5.1068, Accuracy: 482/9950 (4.8442%)
saving model
Done in 714.4556267261505 sec.
Server Epoch:94 choose agents : [51, 3, 17, 5, 55, 92, 4, 75, 35, 60].
___Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0791, Accuracy: 141/1049 (13.4414%)
___Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0329, Accuracy: 471/1049 (44.8999%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.3508, Accuracy: 104/10000 (1.0400%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0818, Accuracy: 30/781 (3.8412%)
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0372, Accuracy: 248/781 (31.7542%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.7273, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   1, Avg loss: 0.0668, Accuracy: 251/1574 (15.9466%)
___Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   2, Avg loss: 0.0315, Accuracy: 599/1574 (38.0559%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.6894, Accuracy: 102/10000 (1.0200%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0634, Accuracy: 254/1628 (15.6020%)
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0295, Accuracy: 673/1628 (41.3391%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.8726, Accuracy: 126/10000 (1.2600%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   1, Avg loss: 0.0623, Accuracy: 205/1071 (19.1410%)
___Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   2, Avg loss: 0.0303, Accuracy: 522/1071 (48.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.9948, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   1, Avg loss: 0.0619, Accuracy: 310/1715 (18.0758%)
___Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   2, Avg loss: 0.0334, Accuracy: 607/1715 (35.3936%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.1596, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0803, Accuracy: 171/901 (18.9789%)
___Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0433, Accuracy: 442/901 (49.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.6177, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   1, Avg loss: 0.0819, Accuracy: 112/776 (14.4330%)
___Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   2, Avg loss: 0.0341, Accuracy: 418/776 (53.8660%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.4964, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.1006, Accuracy: 1/271 (0.3690%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0675, Accuracy: 56/271 (20.6642%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.8877, Accuracy: 56/10000 (0.5600%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   1, Avg loss: 0.0561, Accuracy: 505/2227 (22.6762%)
___Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   2, Avg loss: 0.0303, Accuracy: 914/2227 (41.0418%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.0055, Accuracy: 119/10000 (1.1900%)
time spent on training: 378.95207047462463
___Test Target_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.0885, Accuracy: 62/10000 (0.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Avg loss: 5.1962, Accuracy: 492/9950 (4.9447%)
saving model
Done in 815.3513140678406 sec.
Server Epoch:95 choose agents : [54, 15, 1, 87, 63, 69, 60, 22, 43, 45].
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   1, Avg loss: 0.0655, Accuracy: 294/1130 (26.0177%)
___Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   2, Avg loss: 0.0329, Accuracy: 434/1130 (38.4071%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.5796, Accuracy: 57/10000 (0.5700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   1, Avg loss: 0.0761, Accuracy: 242/1154 (20.9705%)
___Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   2, Avg loss: 0.0334, Accuracy: 393/1154 (34.0555%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.1017, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0652, Accuracy: 206/928 (22.1983%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0265, Accuracy: 546/928 (58.8362%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.9294, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   1, Avg loss: 0.0709, Accuracy: 201/1131 (17.7719%)
___Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   2, Avg loss: 0.0371, Accuracy: 367/1131 (32.4492%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.1946, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   1, Avg loss: 0.0860, Accuracy: 131/888 (14.7523%)
___Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   2, Avg loss: 0.0310, Accuracy: 404/888 (45.4955%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.2901, Accuracy: 76/10000 (0.7600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   1, Avg loss: 0.0728, Accuracy: 133/590 (22.5424%)
___Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   2, Avg loss: 0.0318, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 12.6281, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   1, Avg loss: 0.0555, Accuracy: 546/2227 (24.5173%)
___Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   2, Avg loss: 0.0301, Accuracy: 931/2227 (41.8051%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.2538, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   1, Avg loss: 0.0629, Accuracy: 390/1470 (26.5306%)
___Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   2, Avg loss: 0.0273, Accuracy: 797/1470 (54.2177%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.4826, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   1, Avg loss: 0.0755, Accuracy: 163/946 (17.2304%)
___Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   2, Avg loss: 0.0414, Accuracy: 354/946 (37.4207%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.8745, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   1, Avg loss: 0.0796, Accuracy: 81/669 (12.1076%)
___Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   2, Avg loss: 0.0472, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.4393, Accuracy: 54/10000 (0.5400%)
time spent on training: 366.45085883140564
___Test Target_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.8440, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Avg loss: 7.0197, Accuracy: 76/9950 (0.7638%)
saving model
Done in 790.5190744400024 sec.
Server Epoch:96 choose agents : [12, 11, 52, 2, 65, 23, 68, 97, 82, 9].
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0933, Accuracy: 15/338 (4.4379%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0588, Accuracy: 117/338 (34.6154%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.0157, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0816, Accuracy: 116/712 (16.2921%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0310, Accuracy: 450/712 (63.2022%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 11.5893, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   1, Avg loss: 0.0714, Accuracy: 161/636 (25.3145%)
___Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   2, Avg loss: 0.0395, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 10.1515, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0894, Accuracy: 48/605 (7.9339%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0459, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.9120, Accuracy: 53/10000 (0.5300%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   1, Avg loss: 0.0627, Accuracy: 270/1475 (18.3051%)
___Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   2, Avg loss: 0.0343, Accuracy: 619/1475 (41.9661%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.7354, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   1, Avg loss: 0.0864, Accuracy: 118/715 (16.5035%)
___Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   2, Avg loss: 0.0470, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.9989, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   1, Avg loss: 0.0744, Accuracy: 209/1163 (17.9708%)
___Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   2, Avg loss: 0.0415, Accuracy: 433/1163 (37.2313%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.7679, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   1, Avg loss: 0.0694, Accuracy: 225/1213 (18.5491%)
___Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   2, Avg loss: 0.0309, Accuracy: 500/1213 (41.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 10.0899, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0816, Accuracy: 31/500 (6.2000%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0506, Accuracy: 188/500 (37.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.3741, Accuracy: 74/10000 (0.7400%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0569, Accuracy: 254/1275 (19.9216%)
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0214, Accuracy: 655/1275 (51.3725%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 11.7299, Accuracy: 103/10000 (1.0300%)
time spent on training: 259.01924443244934
___Test Target_ResNet_18 poisoned: False, epoch: 96: Avg loss: 10.9199, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Avg loss: 7.4003, Accuracy: 49/9950 (0.4925%)
saving model
Done in 675.7023029327393 sec.
Server Epoch:97 choose agents : [80, 34, 72, 81, 41, 77, 71, 35, 7, 4].
___Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   1, Avg loss: 0.0738, Accuracy: 89/682 (13.0499%)
___Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   2, Avg loss: 0.0403, Accuracy: 280/682 (41.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.0033, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0642, Accuracy: 269/1427 (18.8507%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0355, Accuracy: 519/1427 (36.3700%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.5917, Accuracy: 80/10000 (0.8000%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 250/1241 (20.1450%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0375, Accuracy: 409/1241 (32.9573%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.5289, Accuracy: 63/10000 (0.6300%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   1, Avg loss: 0.0701, Accuracy: 127/774 (16.4083%)
___Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   2, Avg loss: 0.0372, Accuracy: 341/774 (44.0568%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.5122, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0837, Accuracy: 127/719 (17.6634%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0395, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.6505, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   1, Avg loss: 0.0658, Accuracy: 282/1340 (21.0448%)
___Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   2, Avg loss: 0.0315, Accuracy: 528/1340 (39.4030%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.8705, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   1, Avg loss: 0.0732, Accuracy: 129/818 (15.7702%)
___Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   2, Avg loss: 0.0344, Accuracy: 308/818 (37.6528%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.8085, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0970, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0645, Accuracy: 65/271 (23.9852%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.2131, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0708, Accuracy: 199/891 (22.3345%)
___Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0301, Accuracy: 445/891 (49.9439%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 10.0762, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   1, Avg loss: 0.0802, Accuracy: 181/901 (20.0888%)
___Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   2, Avg loss: 0.0398, Accuracy: 398/901 (44.1731%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.9460, Accuracy: 60/10000 (0.6000%)
time spent on training: 254.91974520683289
___Test Target_ResNet_18 poisoned: False, epoch: 97: Avg loss: 12.7395, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Avg loss: 9.4395, Accuracy: 1/9950 (0.0101%)
saving model
Done in 678.4527370929718 sec.
Server Epoch:98 choose agents : [24, 6, 1, 16, 62, 2, 87, 17, 43, 18].
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.0997, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0581, Accuracy: 93/312 (29.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.8669, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   1, Avg loss: 0.0627, Accuracy: 322/1956 (16.4622%)
___Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   2, Avg loss: 0.0344, Accuracy: 623/1956 (31.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.1626, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   1, Avg loss: 0.0658, Accuracy: 208/928 (22.4138%)
___Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   2, Avg loss: 0.0276, Accuracy: 526/928 (56.6810%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 10.3280, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0701, Accuracy: 175/708 (24.7175%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0402, Accuracy: 424/708 (59.8870%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.7137, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0820, Accuracy: 42/568 (7.3944%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0441, Accuracy: 269/568 (47.3592%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.3854, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   1, Avg loss: 0.0882, Accuracy: 57/605 (9.4215%)
___Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   2, Avg loss: 0.0491, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.9822, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0706, Accuracy: 201/1131 (17.7719%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0358, Accuracy: 404/1131 (35.7206%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.2837, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   1, Avg loss: 0.0643, Accuracy: 248/1574 (15.7560%)
___Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   2, Avg loss: 0.0308, Accuracy: 586/1574 (37.2300%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.7262, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0737, Accuracy: 171/946 (18.0761%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0417, Accuracy: 368/946 (38.9006%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.1079, Accuracy: 61/10000 (0.6100%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   1, Avg loss: 0.0786, Accuracy: 58/530 (10.9434%)
___Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   2, Avg loss: 0.0414, Accuracy: 291/530 (54.9057%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 10.1001, Accuracy: 61/10000 (0.6100%)
time spent on training: 255.7488181591034
___Test Target_ResNet_18 poisoned: False, epoch: 98: Avg loss: 12.3363, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Avg loss: 9.1866, Accuracy: 3/9950 (0.0302%)
saving model
Done in 670.3553318977356 sec.
Server Epoch:99 choose agents : [18, 14, 2, 45, 63, 95, 90, 4, 23, 8].
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   1, Avg loss: 0.0728, Accuracy: 79/530 (14.9057%)
___Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   2, Avg loss: 0.0416, Accuracy: 276/530 (52.0755%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.8589, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   1, Avg loss: 0.0887, Accuracy: 87/1013 (8.5884%)
___Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   2, Avg loss: 0.0401, Accuracy: 361/1013 (35.6367%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.1711, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   1, Avg loss: 0.0874, Accuracy: 42/605 (6.9421%)
___Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   2, Avg loss: 0.0485, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.2668, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   1, Avg loss: 0.0808, Accuracy: 88/669 (13.1540%)
___Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   2, Avg loss: 0.0449, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.9108, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   1, Avg loss: 0.0882, Accuracy: 128/888 (14.4144%)
___Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   2, Avg loss: 0.0297, Accuracy: 397/888 (44.7072%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 10.1872, Accuracy: 87/10000 (0.8700%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0419, Accuracy: 322/599 (53.7563%)
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0278, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 12.2285, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   1, Avg loss: 0.0765, Accuracy: 144/677 (21.2703%)
___Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   2, Avg loss: 0.0246, Accuracy: 460/677 (67.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 12.8439, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   1, Avg loss: 0.0764, Accuracy: 198/901 (21.9756%)
___Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   2, Avg loss: 0.0389, Accuracy: 428/901 (47.5028%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.2246, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0865, Accuracy: 123/715 (17.2028%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0454, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.7699, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   1, Avg loss: 0.0713, Accuracy: 145/1513 (9.5836%)
___Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   2, Avg loss: 0.0414, Accuracy: 389/1513 (25.7105%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.4108, Accuracy: 79/10000 (0.7900%)
time spent on training: 238.1316864490509
___Test Target_ResNet_18 poisoned: False, epoch: 99: Avg loss: 10.6642, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Avg loss: 8.3125, Accuracy: 10/9950 (0.1005%)
saving model
Done in 646.4213447570801 sec.
Server Epoch:100 choose agents : [57, 53, 36, 10, 37, 13, 40, 62, 39, 80].
___Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0737, Accuracy: 189/1154 (16.3778%)
___Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0307, Accuracy: 461/1154 (39.9480%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 11.9236, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0586, Accuracy: 182/813 (22.3862%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0213, Accuracy: 456/813 (56.0886%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 13.1938, Accuracy: 56/10000 (0.5600%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   1, Avg loss: 0.0990, Accuracy: 2/408 (0.4902%)
___Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   2, Avg loss: 0.0587, Accuracy: 127/408 (31.1275%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.1459, Accuracy: 49/10000 (0.4900%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   1, Avg loss: 0.0635, Accuracy: 150/861 (17.4216%)
___Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   2, Avg loss: 0.0229, Accuracy: 420/861 (48.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 10.9347, Accuracy: 93/10000 (0.9300%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0615, Accuracy: 271/1129 (24.0035%)
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0282, Accuracy: 633/1129 (56.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.9809, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   1, Avg loss: 0.0706, Accuracy: 301/1645 (18.2979%)
___Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   2, Avg loss: 0.0364, Accuracy: 528/1645 (32.0973%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.8248, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0637, Accuracy: 308/1573 (19.5804%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0382, Accuracy: 564/1573 (35.8551%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.2463, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   1, Avg loss: 0.0817, Accuracy: 34/568 (5.9859%)
___Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   2, Avg loss: 0.0434, Accuracy: 268/568 (47.1831%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.3353, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0668, Accuracy: 174/1013 (17.1767%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0286, Accuracy: 497/1013 (49.0622%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 10.5976, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   1, Avg loss: 0.0753, Accuracy: 80/682 (11.7302%)
___Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   2, Avg loss: 0.0408, Accuracy: 264/682 (38.7097%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.4361, Accuracy: 60/10000 (0.6000%)
time spent on training: 279.3888065814972
___Test Target_ResNet_18 poisoned: False, epoch: 100: Avg loss: 10.4431, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Avg loss: 8.6130, Accuracy: 2/9950 (0.0201%)
saving model
Done in 699.4857590198517 sec.
Saving all the graphs.
This run has a label: Jun.17_15.15.44. Visdom environment: tiny
