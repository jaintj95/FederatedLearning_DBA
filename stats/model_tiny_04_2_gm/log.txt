current path: saved_models/model_tiny_Jun.25_15.26.47
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [85, 87, 65, 98, 55, 56, 28, 94, 16, 80].
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0546, Accuracy: 425/1988 (21.3783%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 631/1988 (31.7404%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.0707, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   1, local model 87, internal_epoch   1, Avg loss: 0.0583, Accuracy: 291/1131 (25.7294%)
_Train Local_ResNet_18, epoch   1, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 405/1131 (35.8090%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.0495, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 391/1475 (26.5085%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0327, Accuracy: 642/1475 (43.5254%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.2991, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   1, Avg loss: 0.0832, Accuracy: 8/373 (2.1448%)
_Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   2, Avg loss: 0.0491, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.4272, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0573, Accuracy: 238/1071 (22.2222%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 483/1071 (45.0980%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6517, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 59/186 (31.7204%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3121, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   1, Avg loss: 0.0569, Accuracy: 362/1581 (22.8969%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 614/1581 (38.8362%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7652, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   1, Avg loss: 0.0561, Accuracy: 333/1662 (20.0361%)
_Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   2, Avg loss: 0.0340, Accuracy: 579/1662 (34.8375%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5487, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   1, Avg loss: 0.0646, Accuracy: 267/708 (37.7119%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   2, Avg loss: 0.0351, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.7481, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   1, local model 80, internal_epoch   1, Avg loss: 0.0708, Accuracy: 136/682 (19.9413%)
_Train Local_ResNet_18, epoch   1, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 246/682 (36.0704%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.2358, Accuracy: 51/10000 (0.5100%)
time spent on training: 122.25224256515503
[rfa agg] training data poison_ratio: 0.0  data num: [1988, 1131, 1475, 373, 1071, 186, 1581, 1662, 708, 682]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [85, 87, 65, 98, 55, 56, 28, 94, 16, 80], weight: tensor([0.1831, 0.1042, 0.1359, 0.0344, 0.0986, 0.0171, 0.1456, 0.1531, 0.0652,
        0.0628])
[rfa agg] iter:  0, prev_obj_val: 62.27142333984375, obj_val: 64.48551940917969, abs dis: 2.2140960693359375
[rfa agg] iter: 0, weight: tensor([0.0688, 0.2915, 0.1382, 0.0119, 0.1769, 0.0048, 0.1228, 0.1098, 0.0407,
        0.0347])
[rfa agg] iter:  1, prev_obj_val: 64.48551940917969, obj_val: 72.3604965209961, abs dis: 7.874977111816406
[rfa agg] iter: 1, weight: tensor([0.0459, 0.4524, 0.0822, 0.0093, 0.2008, 0.0037, 0.0752, 0.0687, 0.0337,
        0.0282])
[rfa agg] iter:  2, prev_obj_val: 72.3604965209961, obj_val: 69.74008178710938, abs dis: 2.6204147338867188
[rfa agg] iter: 2, weight: tensor([0.0434, 0.2444, 0.0659, 0.0119, 0.4146, 0.0046, 0.0626, 0.0590, 0.0521,
        0.0415])
[rfa agg] iter:  3, prev_obj_val: 69.74008178710938, obj_val: 72.27980041503906, abs dis: 2.5397186279296875
[rfa agg] iter: 3, weight: tensor([0.0325, 0.2324, 0.0511, 0.0083, 0.5174, 0.0032, 0.0482, 0.0451, 0.0342,
        0.0277])
[rfa agg] iter:  4, prev_obj_val: 72.27980041503906, obj_val: 75.03982543945312, abs dis: 2.7600250244140625
[rfa agg] iter: 4, weight: tensor([0.0385, 0.2059, 0.0584, 0.0106, 0.4916, 0.0040, 0.0555, 0.0523, 0.0463,
        0.0368])
[rfa agg] iter:  5, prev_obj_val: 75.03982543945312, obj_val: 69.75109100341797, abs dis: 5.288734436035156
[rfa agg] iter: 5, weight: tensor([0.0492, 0.2119, 0.0724, 0.0147, 0.3894, 0.0055, 0.0693, 0.0657, 0.0684,
        0.0534])
[rfa agg] iter:  6, prev_obj_val: 69.75109100341797, obj_val: 72.27948760986328, abs dis: 2.5283966064453125
[rfa agg] iter: 6, weight: tensor([0.0331, 0.2349, 0.0521, 0.0084, 0.5099, 0.0033, 0.0491, 0.0460, 0.0349,
        0.0282])
[rfa agg] iter:  7, prev_obj_val: 72.27948760986328, obj_val: 75.0395736694336, abs dis: 2.7600860595703125
[rfa agg] iter: 7, weight: tensor([0.0386, 0.2067, 0.0586, 0.0106, 0.4899, 0.0041, 0.0557, 0.0525, 0.0464,
        0.0370])
[rfa agg] iter:  8, prev_obj_val: 75.0395736694336, obj_val: 69.7511215209961, abs dis: 5.2884521484375
[rfa agg] iter: 8, weight: tensor([0.0492, 0.2120, 0.0724, 0.0147, 0.3892, 0.0055, 0.0693, 0.0657, 0.0685,
        0.0534])
[rfa agg] iter:  9, prev_obj_val: 69.7511215209961, obj_val: 72.27948760986328, abs dis: 2.5283660888671875
[rfa agg] iter: 9, weight: tensor([0.0331, 0.2349, 0.0521, 0.0084, 0.5098, 0.0033, 0.0491, 0.0460, 0.0349,
        0.0282])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3040, Accuracy: 38/10000 (0.3800%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.3745, Accuracy: 0/9950 (0.0000%)
saving model
Done in 239.69447445869446 sec.
Server Epoch:2 choose agents : [65, 48, 44, 24, 25, 20, 86, 29, 7, 95].
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   1, Avg loss: 0.0562, Accuracy: 359/1475 (24.3390%)
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   2, Avg loss: 0.0330, Accuracy: 612/1475 (41.4915%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8461, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   1, Avg loss: 0.0715, Accuracy: 85/631 (13.4707%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   2, Avg loss: 0.0419, Accuracy: 204/631 (32.3296%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.9086, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   1, Avg loss: 0.0599, Accuracy: 400/1750 (22.8571%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 653/1750 (37.3143%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.5479, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0745, Accuracy: 28/312 (8.9744%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0403, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.4346, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0592, Accuracy: 295/690 (42.7536%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0285, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.3852, Accuracy: 58/10000 (0.5800%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 364/807 (45.1053%)
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 389/807 (48.2032%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8403, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 86, internal_epoch   1, Avg loss: 0.0631, Accuracy: 335/1003 (33.3998%)
_Train Local_ResNet_18, epoch   2, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 389/1003 (38.7836%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.5928, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 417/1440 (28.9583%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 677/1440 (47.0139%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.0336, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 347/891 (38.9450%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0273, Accuracy: 403/891 (45.2301%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.7208, Accuracy: 55/10000 (0.5500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   1, Avg loss: 0.0538, Accuracy: 308/599 (51.4190%)
_Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   2, Avg loss: 0.0319, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.3642, Accuracy: 50/10000 (0.5000%)
time spent on training: 166.02605652809143
[rfa agg] training data poison_ratio: 0.14648885184413418  data num: [1475, 631, 1750, 312, 690, 807, 1003, 1440, 891, 599]
[rfa agg] considering poison per batch poison_fraction: 0.04577776620129193
[rfa agg] init. name: [65, 48, 44, 24, 25, 20, 86, 29, 7, 95], weight: tensor([0.1537, 0.0657, 0.1823, 0.0325, 0.0719, 0.0841, 0.1045, 0.1500, 0.0928,
        0.0624])
[rfa agg] iter:  0, prev_obj_val: 58.3322868347168, obj_val: 60.73009490966797, abs dis: 2.397808074951172
[rfa agg] iter: 0, weight: tensor([0.0785, 0.0388, 0.0612, 0.0108, 0.0503, 0.0901, 0.4085, 0.0884, 0.1364,
        0.0369])
[rfa agg] iter:  1, prev_obj_val: 60.73009490966797, obj_val: 69.43985748291016, abs dis: 8.709762573242188
[rfa agg] iter: 1, weight: tensor([0.0521, 0.0465, 0.0437, 0.0109, 0.0653, 0.1527, 0.2113, 0.0568, 0.3165,
        0.0442])
[rfa agg] iter:  2, prev_obj_val: 69.43985748291016, obj_val: 69.3560562133789, abs dis: 0.08380126953125
[rfa agg] iter: 2, weight: tensor([0.0431, 0.1028, 0.0385, 0.0153, 0.2054, 0.2145, 0.0867, 0.0459, 0.1500,
        0.0978])
[rfa agg] iter:  3, prev_obj_val: 69.3560562133789, obj_val: 71.75345611572266, abs dis: 2.39739990234375
[rfa agg] iter: 3, weight: tensor([0.0420, 0.1017, 0.0374, 0.0150, 0.2133, 0.2224, 0.0839, 0.0447, 0.1426,
        0.0970])
[rfa agg] iter:  4, prev_obj_val: 71.75345611572266, obj_val: 77.29036712646484, abs dis: 5.5369110107421875
[rfa agg] iter: 4, weight: tensor([0.0370, 0.1192, 0.0333, 0.0147, 0.3142, 0.1523, 0.0688, 0.0393, 0.1072,
        0.1139])
[rfa agg] iter:  5, prev_obj_val: 77.29036712646484, obj_val: 84.35353088378906, abs dis: 7.063163757324219
[rfa agg] iter: 5, weight: tensor([0.0300, 0.1997, 0.0275, 0.0151, 0.2946, 0.0849, 0.0496, 0.0317, 0.0684,
        0.1986])
[rfa agg] iter:  6, prev_obj_val: 84.35353088378906, obj_val: 84.33768463134766, abs dis: 0.01584625244140625
[rfa agg] iter: 6, weight: tensor([0.0345, 0.2637, 0.0322, 0.0226, 0.1508, 0.0763, 0.0520, 0.0362, 0.0663,
        0.2653])
[rfa agg] iter:  7, prev_obj_val: 84.33768463134766, obj_val: 84.33756256103516, abs dis: 0.0001220703125
[rfa agg] iter: 7, weight: tensor([0.0337, 0.2728, 0.0314, 0.0221, 0.1447, 0.0744, 0.0508, 0.0354, 0.0648,
        0.2698])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3056, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.3708, Accuracy: 0/9950 (0.0000%)
saving model
Done in 281.42974400520325 sec.
Server Epoch:3 choose agents : [77, 59, 8, 86, 97, 14, 4, 70, 96, 11].
_Train Local_ResNet_18, epoch   3, local model 77, internal_epoch   1, Avg loss: 0.0551, Accuracy: 311/1340 (23.2090%)
_Train Local_ResNet_18, epoch   3, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 577/1340 (43.0597%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5877, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   1, Avg loss: 0.0544, Accuracy: 299/1089 (27.4564%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   2, Avg loss: 0.0351, Accuracy: 488/1089 (44.8118%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.2853, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0587, Accuracy: 259/1513 (17.1183%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 486/1513 (32.1216%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7025, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   3, local model 86, internal_epoch   1, Avg loss: 0.0646, Accuracy: 329/1003 (32.8016%)
_Train Local_ResNet_18, epoch   3, local model 86, internal_epoch   2, Avg loss: 0.0352, Accuracy: 355/1003 (35.3938%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.6804, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 97, internal_epoch   1, Avg loss: 0.0538, Accuracy: 378/1213 (31.1624%)
_Train Local_ResNet_18, epoch   3, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 462/1213 (38.0874%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7272, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   1, Avg loss: 0.0624, Accuracy: 212/1013 (20.9279%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 325/1013 (32.0829%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8433, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0601, Accuracy: 319/901 (35.4051%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0316, Accuracy: 441/901 (48.9456%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1962, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 389/1418 (27.4330%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0298, Accuracy: 656/1418 (46.2623%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7138, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   3, local model 96, internal_epoch   1, Avg loss: 0.0811, Accuracy: 33/311 (10.6109%)
_Train Local_ResNet_18, epoch   3, local model 96, internal_epoch   2, Avg loss: 0.0565, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.5059, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   1, Avg loss: 0.0575, Accuracy: 320/712 (44.9438%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   2, Avg loss: 0.0255, Accuracy: 418/712 (58.7079%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.7156, Accuracy: 53/10000 (0.5300%)
time spent on training: 128.2044370174408
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 1089, 1513, 1003, 1213, 1013, 901, 1418, 311, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 59, 8, 86, 97, 14, 4, 70, 96, 11], weight: tensor([0.1275, 0.1036, 0.1439, 0.0954, 0.1154, 0.0964, 0.0857, 0.1349, 0.0296,
        0.0677])
[rfa agg] iter:  0, prev_obj_val: 36.457603454589844, obj_val: 46.190155029296875, abs dis: 9.732551574707031
[rfa agg] iter: 0, weight: tensor([0.0667, 0.1325, 0.0459, 0.2102, 0.1036, 0.2308, 0.1190, 0.0494, 0.0061,
        0.0358])
[rfa agg] iter:  1, prev_obj_val: 46.190155029296875, obj_val: 46.141700744628906, abs dis: 0.04845428466796875
[rfa agg] iter: 1, weight: tensor([0.0585, 0.0853, 0.0455, 0.1659, 0.0756, 0.1732, 0.2613, 0.0475, 0.0093,
        0.0780])
[rfa agg] iter:  2, prev_obj_val: 46.141700744628906, obj_val: 46.140220642089844, abs dis: 0.0014801025390625
[rfa agg] iter: 2, weight: tensor([0.0564, 0.0818, 0.0439, 0.1586, 0.0728, 0.1650, 0.2909, 0.0458, 0.0089,
        0.0758])
[rfa agg] iter:  3, prev_obj_val: 46.140220642089844, obj_val: 46.140159606933594, abs dis: 6.103515625e-05
[rfa agg] iter: 3, weight: tensor([0.0560, 0.0812, 0.0436, 0.1571, 0.0723, 0.1633, 0.2968, 0.0455, 0.0089,
        0.0752])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3413, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.4187, Accuracy: 0/9950 (0.0000%)
saving model
Done in 243.51280665397644 sec.
Server Epoch:4 choose agents : [21, 65, 32, 77, 7, 24, 41, 52, 13, 64].
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0546, Accuracy: 420/1949 (21.5495%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 688/1949 (35.3002%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.4879, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   1, Avg loss: 0.0562, Accuracy: 355/1475 (24.0678%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   2, Avg loss: 0.0334, Accuracy: 633/1475 (42.9153%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.0588, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   1, Avg loss: 0.0607, Accuracy: 184/735 (25.0340%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 353/735 (48.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 9.8000, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0551, Accuracy: 294/1340 (21.9403%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 569/1340 (42.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.9408, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0511, Accuracy: 359/891 (40.2918%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 435/891 (48.8215%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.9379, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0743, Accuracy: 19/312 (6.0897%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0388, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.8058, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   1, Avg loss: 0.0591, Accuracy: 333/719 (46.3143%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   2, Avg loss: 0.0317, Accuracy: 457/719 (63.5605%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.4755, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   1, Avg loss: 0.0562, Accuracy: 261/636 (41.0377%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   2, Avg loss: 0.0299, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.8283, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   1, Avg loss: 0.0594, Accuracy: 289/1645 (17.5684%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 621/1645 (37.7508%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.9373, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0625, Accuracy: 184/953 (19.3075%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 309/953 (32.4239%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.7528, Accuracy: 70/10000 (0.7000%)
time spent on training: 125.81282877922058
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 1475, 735, 1340, 891, 312, 719, 636, 1645, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 65, 32, 77, 7, 24, 41, 52, 13, 64], weight: tensor([0.1829, 0.1384, 0.0690, 0.1258, 0.0836, 0.0293, 0.0675, 0.0597, 0.1544,
        0.0894])
[rfa agg] iter:  0, prev_obj_val: 63.52412796020508, obj_val: 66.2077407836914, abs dis: 2.683612823486328
[rfa agg] iter: 0, weight: tensor([0.0816, 0.1381, 0.0590, 0.2587, 0.1021, 0.0121, 0.0575, 0.0391, 0.1141,
        0.1380])
[rfa agg] iter:  1, prev_obj_val: 66.2077407836914, obj_val: 69.19496154785156, abs dis: 2.9872207641601562
[rfa agg] iter: 1, weight: tensor([0.0701, 0.1053, 0.0734, 0.1655, 0.1439, 0.0130, 0.0713, 0.0455, 0.0918,
        0.2201])
[rfa agg] iter:  2, prev_obj_val: 69.19496154785156, obj_val: 78.52571868896484, abs dis: 9.330757141113281
[rfa agg] iter: 2, weight: tensor([0.0453, 0.0622, 0.0740, 0.0867, 0.1869, 0.0106, 0.0715, 0.0412, 0.0563,
        0.3654])
[rfa agg] iter:  3, prev_obj_val: 78.52571868896484, obj_val: 76.04544067382812, abs dis: 2.4802780151367188
[rfa agg] iter: 3, weight: tensor([0.0363, 0.0448, 0.1875, 0.0558, 0.2306, 0.0129, 0.1697, 0.0676, 0.0424,
        0.1524])
[rfa agg] iter:  4, prev_obj_val: 76.04544067382812, obj_val: 73.84720611572266, abs dis: 2.1982345581054688
[rfa agg] iter: 4, weight: tensor([0.0354, 0.0445, 0.1418, 0.0563, 0.3052, 0.0115, 0.1327, 0.0562, 0.0418,
        0.1746])
[rfa agg] iter:  5, prev_obj_val: 73.84720611572266, obj_val: 73.8309555053711, abs dis: 0.0162506103515625
[rfa agg] iter: 5, weight: tensor([0.0332, 0.0426, 0.0999, 0.0550, 0.3695, 0.0100, 0.0949, 0.0451, 0.0397,
        0.2102])
[rfa agg] iter:  6, prev_obj_val: 73.8309555053711, obj_val: 78.48643493652344, abs dis: 4.655479431152344
[rfa agg] iter: 6, weight: tensor([0.0320, 0.0410, 0.0949, 0.0529, 0.3932, 0.0096, 0.0901, 0.0432, 0.0382,
        0.2050])
[rfa agg] iter:  7, prev_obj_val: 78.48643493652344, obj_val: 76.0420150756836, abs dis: 2.4444198608398438
[rfa agg] iter: 7, weight: tensor([0.0355, 0.0438, 0.1845, 0.0545, 0.2502, 0.0126, 0.1666, 0.0663, 0.0414,
        0.1445])
[rfa agg] iter:  8, prev_obj_val: 76.0420150756836, obj_val: 73.84638214111328, abs dis: 2.1956329345703125
[rfa agg] iter: 8, weight: tensor([0.0352, 0.0443, 0.1409, 0.0561, 0.3092, 0.0115, 0.1318, 0.0559, 0.0416,
        0.1734])
[rfa agg] iter:  9, prev_obj_val: 73.84638214111328, obj_val: 73.83084869384766, abs dis: 0.015533447265625
[rfa agg] iter: 9, weight: tensor([0.0332, 0.0425, 0.0997, 0.0549, 0.3709, 0.0099, 0.0947, 0.0450, 0.0396,
        0.2096])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.4188, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.5953, Accuracy: 0/9950 (0.0000%)
saving model
Done in 243.54164290428162 sec.
Server Epoch:5 choose agents : [62, 99, 55, 2, 52, 21, 47, 94, 92, 84].
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0706, Accuracy: 114/568 (20.0704%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0424, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.4171, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   1, Avg loss: 0.0714, Accuracy: 152/773 (19.6636%)
_Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   2, Avg loss: 0.0306, Accuracy: 396/773 (51.2290%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.9788, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   1, Avg loss: 0.0523, Accuracy: 273/1071 (25.4902%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 496/1071 (46.3119%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1601, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0653, Accuracy: 199/605 (32.8926%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0405, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.1635, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   1, Avg loss: 0.0558, Accuracy: 245/636 (38.5220%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   2, Avg loss: 0.0306, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.2411, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   1, Avg loss: 0.0540, Accuracy: 391/1949 (20.0616%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   2, Avg loss: 0.0336, Accuracy: 625/1949 (32.0677%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.5513, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   2, Avg loss: 0.1124, Accuracy: 1/134 (0.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.4848, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 94, internal_epoch   1, Avg loss: 0.0578, Accuracy: 293/1662 (17.6294%)
_Train Local_ResNet_18, epoch   5, local model 94, internal_epoch   2, Avg loss: 0.0344, Accuracy: 549/1662 (33.0325%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.0693, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0525, Accuracy: 392/1715 (22.8571%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 700/1715 (40.8163%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1806, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   5, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 308/1190 (25.8824%)
_Train Local_ResNet_18, epoch   5, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 471/1190 (39.5798%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.0961, Accuracy: 71/10000 (0.7100%)
time spent on training: 127.08521676063538
[rfa agg] training data poison_ratio: 0.0  data num: [568, 773, 1071, 605, 636, 1949, 134, 1662, 1715, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [62, 99, 55, 2, 52, 21, 47, 94, 92, 84], weight: tensor([0.0551, 0.0750, 0.1040, 0.0587, 0.0617, 0.1892, 0.0130, 0.1613, 0.1665,
        0.1155])
[rfa agg] iter:  0, prev_obj_val: 67.47383117675781, obj_val: 72.85527801513672, abs dis: 5.381446838378906
[rfa agg] iter: 0, weight: tensor([0.0243, 0.0567, 0.2322, 0.0289, 0.0304, 0.0634, 0.0035, 0.0895, 0.0816,
        0.3895])
[rfa agg] iter:  1, prev_obj_val: 72.85527801513672, obj_val: 76.71818542480469, abs dis: 3.8629074096679688
[rfa agg] iter: 1, weight: tensor([0.0318, 0.0901, 0.4032, 0.0389, 0.0409, 0.0567, 0.0041, 0.0735, 0.0686,
        0.1922])
[rfa agg] iter:  2, prev_obj_val: 76.71818542480469, obj_val: 76.7040786743164, abs dis: 0.01410675048828125
[rfa agg] iter: 2, weight: tensor([0.0431, 0.1448, 0.3190, 0.0540, 0.0566, 0.0625, 0.0052, 0.0785, 0.0739,
        0.1623])
[rfa agg] iter:  3, prev_obj_val: 76.7040786743164, obj_val: 74.68704223632812, abs dis: 2.0170364379882812
[rfa agg] iter: 3, weight: tensor([0.0435, 0.1475, 0.3127, 0.0545, 0.0572, 0.0630, 0.0053, 0.0790, 0.0744,
        0.1631])
[rfa agg] iter:  4, prev_obj_val: 74.68704223632812, obj_val: 80.90069580078125, abs dis: 6.213653564453125
[rfa agg] iter: 4, weight: tensor([0.0369, 0.1139, 0.3739, 0.0457, 0.0479, 0.0594, 0.0046, 0.0757, 0.0710,
        0.1710])
[rfa agg] iter:  5, prev_obj_val: 80.90069580078125, obj_val: 80.8568344116211, abs dis: 0.04386138916015625
[rfa agg] iter: 5, weight: tensor([0.0538, 0.2350, 0.2164, 0.0695, 0.0728, 0.0623, 0.0060, 0.0760, 0.0722,
        0.1360])
[rfa agg] iter:  6, prev_obj_val: 80.8568344116211, obj_val: 80.85673522949219, abs dis: 9.918212890625e-05
[rfa agg] iter: 6, weight: tensor([0.0536, 0.2446, 0.2098, 0.0693, 0.0727, 0.0619, 0.0060, 0.0755, 0.0717,
        0.1349])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.6127, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.5863, Accuracy: 0/9950 (0.0000%)
saving model
Done in 243.44776463508606 sec.
Server Epoch:6 choose agents : [42, 86, 96, 97, 56, 87, 53, 33, 44, 98].
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0567, Accuracy: 283/1372 (20.6268%)
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0323, Accuracy: 459/1372 (33.4548%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.1992, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   1, Avg loss: 0.0632, Accuracy: 305/1003 (30.4088%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   2, Avg loss: 0.0364, Accuracy: 389/1003 (38.7836%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.8717, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   1, Avg loss: 0.0801, Accuracy: 20/311 (6.4309%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   2, Avg loss: 0.0558, Accuracy: 134/311 (43.0868%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.7219, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 97, internal_epoch   1, Avg loss: 0.0527, Accuracy: 365/1213 (30.0907%)
_Train Local_ResNet_18, epoch   6, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 475/1213 (39.1591%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.1017, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   1, Avg loss: 0.0813, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   2, Avg loss: 0.0655, Accuracy: 60/186 (32.2581%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.5483, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 87, internal_epoch   1, Avg loss: 0.0570, Accuracy: 291/1131 (25.7294%)
_Train Local_ResNet_18, epoch   6, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 392/1131 (34.6596%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8106, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   1, Avg loss: 0.0510, Accuracy: 250/813 (30.7503%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 455/813 (55.9656%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 10.8988, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   1, Avg loss: 0.0830, Accuracy: 46/515 (8.9320%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   2, Avg loss: 0.0526, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.7789, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0578, Accuracy: 375/1750 (21.4286%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 648/1750 (37.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0658, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch   6, local model 98, internal_epoch   1, Avg loss: 0.0860, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch   6, local model 98, internal_epoch   2, Avg loss: 0.0501, Accuracy: 136/373 (36.4611%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.1114, Accuracy: 50/10000 (0.5000%)
time spent on training: 119.5481915473938
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1003, 311, 1213, 186, 1131, 813, 515, 1750, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 86, 96, 97, 56, 87, 53, 33, 44, 98], weight: tensor([0.1583, 0.1157, 0.0359, 0.1400, 0.0215, 0.1305, 0.0938, 0.0594, 0.2019,
        0.0430])
[rfa agg] iter:  0, prev_obj_val: 54.4416618347168, obj_val: 57.999568939208984, abs dis: 3.5579071044921875
[rfa agg] iter: 0, weight: tensor([0.0852, 0.3678, 0.0106, 0.1444, 0.0053, 0.1908, 0.0992, 0.0276, 0.0550,
        0.0140])
[rfa agg] iter:  1, prev_obj_val: 57.999568939208984, obj_val: 57.992210388183594, abs dis: 0.007358551025390625
[rfa agg] iter: 1, weight: tensor([0.0829, 0.3448, 0.0132, 0.1256, 0.0065, 0.1543, 0.1613, 0.0363, 0.0575,
        0.0176])
[rfa agg] iter:  2, prev_obj_val: 57.992210388183594, obj_val: 60.103553771972656, abs dis: 2.1113433837890625
[rfa agg] iter: 2, weight: tensor([0.0829, 0.3434, 0.0132, 0.1255, 0.0065, 0.1538, 0.1632, 0.0364, 0.0575,
        0.0176])
[rfa agg] iter:  3, prev_obj_val: 60.103553771972656, obj_val: 62.264400482177734, abs dis: 2.160846710205078
[rfa agg] iter: 3, weight: tensor([0.0841, 0.2781, 0.0150, 0.1219, 0.0074, 0.1449, 0.2254, 0.0430, 0.0601,
        0.0202])
[rfa agg] iter:  4, prev_obj_val: 62.264400482177734, obj_val: 62.25343322753906, abs dis: 0.010967254638671875
[rfa agg] iter: 4, weight: tensor([0.0794, 0.2170, 0.0159, 0.1109, 0.0077, 0.1285, 0.3134, 0.0474, 0.0582,
        0.0216])
[rfa agg] iter:  5, prev_obj_val: 62.25343322753906, obj_val: 62.25333023071289, abs dis: 0.000102996826171875
[rfa agg] iter: 5, weight: tensor([0.0786, 0.2123, 0.0158, 0.1098, 0.0077, 0.1271, 0.3229, 0.0470, 0.0577,
        0.0214])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.9071, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.3754, Accuracy: 0/9950 (0.0000%)
saving model
Done in 235.90661025047302 sec.
Server Epoch:7 choose agents : [55, 61, 33, 24, 70, 53, 81, 85, 10, 92].
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   1, Avg loss: 0.0514, Accuracy: 305/1071 (28.4781%)
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   2, Avg loss: 0.0284, Accuracy: 512/1071 (47.8058%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.2553, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   1, Avg loss: 0.1322, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   2, Avg loss: 0.1232, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.5428, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   1, Avg loss: 0.0809, Accuracy: 53/515 (10.2913%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   2, Avg loss: 0.0586, Accuracy: 119/515 (23.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.2581, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   1, Avg loss: 0.0784, Accuracy: 7/312 (2.2436%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   2, Avg loss: 0.0432, Accuracy: 151/312 (48.3974%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.3500, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   1, Avg loss: 0.0535, Accuracy: 362/1418 (25.5289%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 680/1418 (47.9549%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.0726, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   1, Avg loss: 0.0501, Accuracy: 253/813 (31.1193%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 458/813 (56.3346%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 10.6084, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   7, local model 81, internal_epoch   1, Avg loss: 0.0722, Accuracy: 182/774 (23.5142%)
_Train Local_ResNet_18, epoch   7, local model 81, internal_epoch   2, Avg loss: 0.0371, Accuracy: 321/774 (41.4729%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.0713, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   1, Avg loss: 0.0529, Accuracy: 461/1988 (23.1891%)
_Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 666/1988 (33.5010%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8987, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0583, Accuracy: 193/861 (22.4158%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0219, Accuracy: 429/861 (49.8258%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.3725, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   7, local model 92, internal_epoch   1, Avg loss: 0.0529, Accuracy: 375/1715 (21.8659%)
_Train Local_ResNet_18, epoch   7, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 714/1715 (41.6327%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.5342, Accuracy: 93/10000 (0.9300%)
time spent on training: 124.08945345878601
[rfa agg] training data poison_ratio: 0.0  data num: [1071, 85, 515, 312, 1418, 813, 774, 1988, 861, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [55, 61, 33, 24, 70, 53, 81, 85, 10, 92], weight: tensor([0.1121, 0.0089, 0.0539, 0.0327, 0.1485, 0.0851, 0.0810, 0.2081, 0.0901,
        0.1795])
[rfa agg] iter:  0, prev_obj_val: 68.98006439208984, obj_val: 70.42407989501953, abs dis: 1.4440155029296875
[rfa agg] iter: 0, weight: tensor([0.3303, 0.0028, 0.0300, 0.0127, 0.1698, 0.0812, 0.0770, 0.0815, 0.1038,
        0.1109])
[rfa agg] iter:  1, prev_obj_val: 70.42407989501953, obj_val: 74.01410675048828, abs dis: 3.59002685546875
[rfa agg] iter: 1, weight: tensor([0.5318, 0.0020, 0.0232, 0.0093, 0.0844, 0.0720, 0.0682, 0.0479, 0.0996,
        0.0616])
[rfa agg] iter:  2, prev_obj_val: 74.01410675048828, obj_val: 76.82942199707031, abs dis: 2.8153152465820312
[rfa agg] iter: 2, weight: tensor([0.2920, 0.0026, 0.0336, 0.0126, 0.0803, 0.1305, 0.1228, 0.0516, 0.2103,
        0.0636])
[rfa agg] iter:  3, prev_obj_val: 76.82942199707031, obj_val: 78.47811126708984, abs dis: 1.6486892700195312
[rfa agg] iter: 3, weight: tensor([0.1471, 0.0024, 0.0330, 0.0116, 0.0591, 0.1687, 0.1570, 0.0405, 0.3319,
        0.0487])
[rfa agg] iter:  4, prev_obj_val: 78.47811126708984, obj_val: 80.57280731201172, abs dis: 2.094696044921875
[rfa agg] iter: 4, weight: tensor([0.1014, 0.0020, 0.0299, 0.0101, 0.0462, 0.1854, 0.1716, 0.0326, 0.3820,
        0.0388])
[rfa agg] iter:  5, prev_obj_val: 80.57280731201172, obj_val: 89.44056701660156, abs dis: 8.867759704589844
[rfa agg] iter: 5, weight: tensor([0.0842, 0.0020, 0.0319, 0.0103, 0.0421, 0.2389, 0.2180, 0.0305, 0.3062,
        0.0359])
[rfa agg] iter:  6, prev_obj_val: 89.44056701660156, obj_val: 86.07002258300781, abs dis: 3.37054443359375
[rfa agg] iter: 6, weight: tensor([0.0871, 0.0034, 0.0679, 0.0180, 0.0530, 0.2672, 0.2475, 0.0410, 0.1679,
        0.0471])
[rfa agg] iter:  7, prev_obj_val: 86.07002258300781, obj_val: 83.04641723632812, abs dis: 3.0236053466796875
[rfa agg] iter: 7, weight: tensor([0.0762, 0.0025, 0.0467, 0.0133, 0.0439, 0.3073, 0.2746, 0.0333, 0.1636,
        0.0385])
[rfa agg] iter:  8, prev_obj_val: 83.04641723632812, obj_val: 89.4216079711914, abs dis: 6.375190734863281
[rfa agg] iter: 8, weight: tensor([0.0711, 0.0020, 0.0343, 0.0105, 0.0385, 0.3254, 0.2783, 0.0285, 0.1780,
        0.0333])
[rfa agg] iter:  9, prev_obj_val: 89.4216079711914, obj_val: 83.05156707763672, abs dis: 6.3700408935546875
[rfa agg] iter: 9, weight: tensor([0.0857, 0.0033, 0.0669, 0.0177, 0.0523, 0.2750, 0.2509, 0.0404, 0.1614,
        0.0464])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.3639, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.2062, Accuracy: 0/9950 (0.0000%)
saving model
Done in 243.9509665966034 sec.
Server Epoch:8 choose agents : [65, 24, 13, 1, 59, 29, 46, 17, 12, 63].
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   1, Avg loss: 0.0575, Accuracy: 358/1475 (24.2712%)
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   2, Avg loss: 0.0339, Accuracy: 568/1475 (38.5085%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.8082, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   1, Avg loss: 0.0806, Accuracy: 8/312 (2.5641%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   2, Avg loss: 0.0434, Accuracy: 147/312 (47.1154%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.5677, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0608, Accuracy: 276/1645 (16.7781%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 599/1645 (36.4134%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.6634, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0613, Accuracy: 260/928 (28.0172%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0253, Accuracy: 541/928 (58.2974%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0145, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   1, Avg loss: 0.0573, Accuracy: 281/1089 (25.8035%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   2, Avg loss: 0.0297, Accuracy: 450/1089 (41.3223%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 9.2526, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   1, Avg loss: 0.0510, Accuracy: 399/1440 (27.7083%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   2, Avg loss: 0.0285, Accuracy: 655/1440 (45.4861%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.6306, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   1, Avg loss: 0.0546, Accuracy: 413/1904 (21.6912%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 702/1904 (36.8697%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0676, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   1, Avg loss: 0.0556, Accuracy: 308/1574 (19.5680%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   2, Avg loss: 0.0297, Accuracy: 569/1574 (36.1499%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.7593, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0990, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0547, Accuracy: 122/338 (36.0947%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.3296, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0609, Accuracy: 216/888 (24.3243%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0268, Accuracy: 374/888 (42.1171%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 9.7486, Accuracy: 53/10000 (0.5300%)
time spent on training: 129.11874079704285
[rfa agg] training data poison_ratio: 0.0  data num: [1475, 312, 1645, 928, 1089, 1440, 1904, 1574, 338, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [65, 24, 13, 1, 59, 29, 46, 17, 12, 63], weight: tensor([0.1272, 0.0269, 0.1419, 0.0800, 0.0939, 0.1242, 0.1642, 0.1358, 0.0292,
        0.0766])
[rfa agg] iter:  0, prev_obj_val: 54.484806060791016, obj_val: 56.181236267089844, abs dis: 1.6964302062988281
[rfa agg] iter: 0, weight: tensor([0.1490, 0.0087, 0.1127, 0.0765, 0.1834, 0.1884, 0.0800, 0.1294, 0.0101,
        0.0618])
[rfa agg] iter:  1, prev_obj_val: 56.181236267089844, obj_val: 57.97463607788086, abs dis: 1.7933998107910156
[rfa agg] iter: 1, weight: tensor([0.1342, 0.0091, 0.1046, 0.0847, 0.2283, 0.1663, 0.0764, 0.1185, 0.0105,
        0.0673])
[rfa agg] iter:  2, prev_obj_val: 57.97463607788086, obj_val: 57.96607971191406, abs dis: 0.008556365966796875
[rfa agg] iter: 2, weight: tensor([0.1190, 0.0092, 0.0954, 0.0927, 0.2785, 0.1439, 0.0715, 0.1068, 0.0107,
        0.0723])
[rfa agg] iter:  3, prev_obj_val: 57.96607971191406, obj_val: 57.96585464477539, abs dis: 0.000225067138671875
[rfa agg] iter: 3, weight: tensor([0.1175, 0.0091, 0.0943, 0.0916, 0.2872, 0.1419, 0.0707, 0.1056, 0.0106,
        0.0715])
[rfa agg] iter:  4, prev_obj_val: 57.96585464477539, obj_val: 59.84939956665039, abs dis: 1.883544921875
[rfa agg] iter: 4, weight: tensor([0.1172, 0.0091, 0.0941, 0.0914, 0.2887, 0.1416, 0.0705, 0.1054, 0.0106,
        0.0713])
[rfa agg] iter:  5, prev_obj_val: 59.84939956665039, obj_val: 61.87151336669922, abs dis: 2.022113800048828
[rfa agg] iter: 5, weight: tensor([0.1032, 0.0090, 0.0848, 0.0994, 0.3359, 0.1222, 0.0650, 0.0939, 0.0106,
        0.0759])
[rfa agg] iter:  6, prev_obj_val: 61.87151336669922, obj_val: 61.8648567199707, abs dis: 0.006656646728515625
[rfa agg] iter: 6, weight: tensor([0.0908, 0.0090, 0.0762, 0.1089, 0.3745, 0.1058, 0.0596, 0.0836, 0.0106,
        0.0811])
[rfa agg] iter:  7, prev_obj_val: 61.8648567199707, obj_val: 59.84307861328125, abs dis: 2.021778106689453
[rfa agg] iter: 7, weight: tensor([0.0886, 0.0088, 0.0745, 0.1063, 0.3891, 0.1032, 0.0583, 0.0817, 0.0103,
        0.0791])
[rfa agg] iter:  8, prev_obj_val: 59.84307861328125, obj_val: 59.840293884277344, abs dis: 0.00278472900390625
[rfa agg] iter: 8, weight: tensor([0.0985, 0.0087, 0.0811, 0.0949, 0.3656, 0.1165, 0.0622, 0.0898, 0.0102,
        0.0725])
[rfa agg] iter:  9, prev_obj_val: 59.840293884277344, obj_val: 61.867462158203125, abs dis: 2.0271682739257812
[rfa agg] iter: 9, weight: tensor([0.0997, 0.0088, 0.0820, 0.0960, 0.3582, 0.1180, 0.0629, 0.0908, 0.0103,
        0.0733])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.2590, Accuracy: 37/10000 (0.3700%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 6.7818, Accuracy: 0/9950 (0.0000%)
saving model
Done in 247.7893419265747 sec.
Server Epoch:9 choose agents : [38, 86, 61, 13, 89, 20, 52, 78, 37, 94].
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   1, Avg loss: 0.0659, Accuracy: 240/1131 (21.2202%)
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   2, Avg loss: 0.0322, Accuracy: 508/1131 (44.9160%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.8437, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   9, local model 86, internal_epoch   1, Avg loss: 0.0606, Accuracy: 322/1003 (32.1037%)
_Train Local_ResNet_18, epoch   9, local model 86, internal_epoch   2, Avg loss: 0.0356, Accuracy: 369/1003 (36.7896%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.0958, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1316, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1232, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.9632, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   1, Avg loss: 0.0599, Accuracy: 300/1645 (18.2371%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 612/1645 (37.2036%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.7379, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch   9, local model 89, internal_epoch   1, Avg loss: 0.0583, Accuracy: 309/896 (34.4866%)
_Train Local_ResNet_18, epoch   9, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 468/896 (52.2321%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.0141, Accuracy: 60/10000 (0.6000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   9, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 346/807 (42.8748%)
_Train Local_ResNet_18, epoch   9, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 431/807 (53.4077%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.1038, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   1, Avg loss: 0.0582, Accuracy: 224/636 (35.2201%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   2, Avg loss: 0.0306, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.0623, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 78, internal_epoch   1, Avg loss: 0.0875, Accuracy: 16/416 (3.8462%)
_Train Local_ResNet_18, epoch   9, local model 78, internal_epoch   2, Avg loss: 0.0488, Accuracy: 185/416 (44.4712%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.9013, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0524, Accuracy: 440/1129 (38.9725%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 743/1129 (65.8105%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.3806, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch   9, local model 94, internal_epoch   1, Avg loss: 0.0574, Accuracy: 294/1662 (17.6895%)
_Train Local_ResNet_18, epoch   9, local model 94, internal_epoch   2, Avg loss: 0.0342, Accuracy: 594/1662 (35.7401%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.4196, Accuracy: 111/10000 (1.1100%)
time spent on training: 133.99767470359802
[rfa agg] training data poison_ratio: 0.08575982996811903  data num: [1131, 1003, 85, 1645, 896, 807, 636, 416, 1129, 1662]
[rfa agg] considering poison per batch poison_fraction: 0.026799946865037196
[rfa agg] init. name: [38, 86, 61, 13, 89, 20, 52, 78, 37, 94], weight: tensor([0.1202, 0.1066, 0.0090, 0.1748, 0.0952, 0.0858, 0.0676, 0.0442, 0.1200,
        0.1766])
[rfa agg] iter:  0, prev_obj_val: 48.72560501098633, obj_val: 53.519630432128906, abs dis: 4.794025421142578
[rfa agg] iter: 0, weight: tensor([0.2405, 0.2274, 0.0018, 0.0576, 0.0884, 0.0621, 0.0287, 0.0131, 0.2221,
        0.0583])
[rfa agg] iter:  1, prev_obj_val: 53.519630432128906, obj_val: 57.36841583251953, abs dis: 3.848785400390625
[rfa agg] iter: 1, weight: tensor([0.1262, 0.2616, 0.0022, 0.0520, 0.1945, 0.1255, 0.0437, 0.0180, 0.1237,
        0.0527])
[rfa agg] iter:  2, prev_obj_val: 57.36841583251953, obj_val: 55.25739288330078, abs dis: 2.11102294921875
[rfa agg] iter: 2, weight: tensor([0.0936, 0.1603, 0.0023, 0.0467, 0.2908, 0.1937, 0.0530, 0.0201, 0.0923,
        0.0473])
[rfa agg] iter:  3, prev_obj_val: 55.25739288330078, obj_val: 62.42362594604492, abs dis: 7.166233062744141
[rfa agg] iter: 3, weight: tensor([0.1034, 0.1942, 0.0022, 0.0479, 0.2845, 0.1523, 0.0467, 0.0185, 0.1017,
        0.0485])
[rfa agg] iter:  4, prev_obj_val: 62.42362594604492, obj_val: 65.34896850585938, abs dis: 2.925342559814453
[rfa agg] iter: 4, weight: tensor([0.0806, 0.1178, 0.0027, 0.0460, 0.2389, 0.2890, 0.0738, 0.0248, 0.0799,
        0.0466])
[rfa agg] iter:  5, prev_obj_val: 65.34896850585938, obj_val: 65.34271240234375, abs dis: 0.006256103515625
[rfa agg] iter: 5, weight: tensor([0.0790, 0.1087, 0.0030, 0.0475, 0.1939, 0.3194, 0.0931, 0.0289, 0.0784,
        0.0481])
[rfa agg] iter:  6, prev_obj_val: 65.34271240234375, obj_val: 65.34241485595703, abs dis: 0.00029754638671875
[rfa agg] iter: 6, weight: tensor([0.0783, 0.1074, 0.0030, 0.0471, 0.1883, 0.3298, 0.0923, 0.0286, 0.0776,
        0.0476])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.2279, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.6475, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.3988814353943 sec.
Server Epoch:10 choose agents : [72, 15, 56, 44, 90, 31, 57, 99, 20, 6].
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   1, Avg loss: 0.0685, Accuracy: 195/1241 (15.7131%)
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 404/1241 (32.5544%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.8150, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   1, Avg loss: 0.0640, Accuracy: 274/1154 (23.7435%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   2, Avg loss: 0.0307, Accuracy: 464/1154 (40.2080%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 9.4359, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0836, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0677, Accuracy: 47/186 (25.2688%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.9093, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   1, Avg loss: 0.0586, Accuracy: 364/1750 (20.8000%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   2, Avg loss: 0.0361, Accuracy: 617/1750 (35.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.9636, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  10, local model 90, internal_epoch   1, Avg loss: 0.0604, Accuracy: 262/677 (38.7001%)
_Train Local_ResNet_18, epoch  10, local model 90, internal_epoch   2, Avg loss: 0.0251, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 9.5887, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   1, Avg loss: 0.0918, Accuracy: 12/460 (2.6087%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   2, Avg loss: 0.0398, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.5461, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   1, Avg loss: 0.0544, Accuracy: 267/1154 (23.1369%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   2, Avg loss: 0.0261, Accuracy: 456/1154 (39.5147%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 10.0985, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   1, Avg loss: 0.0706, Accuracy: 144/773 (18.6287%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   2, Avg loss: 0.0357, Accuracy: 422/773 (54.5925%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.3805, Accuracy: 52/10000 (0.5200%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  10, local model 20, internal_epoch   1, Avg loss: 0.0545, Accuracy: 365/807 (45.2292%)
_Train Local_ResNet_18, epoch  10, local model 20, internal_epoch   2, Avg loss: 0.0326, Accuracy: 429/807 (53.1599%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.1897, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0576, Accuracy: 359/1956 (18.3538%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 642/1956 (32.8221%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.4563, Accuracy: 105/10000 (1.0500%)
time spent on training: 134.96961617469788
[rfa agg] training data poison_ratio: 0.07944477259303012  data num: [1241, 1154, 186, 1750, 677, 460, 1154, 773, 807, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.024826491435321913
[rfa agg] init. name: [72, 15, 56, 44, 90, 31, 57, 99, 20, 6], weight: tensor([0.1222, 0.1136, 0.0183, 0.1723, 0.0666, 0.0453, 0.1136, 0.0761, 0.0794,
        0.1926])
[rfa agg] iter:  0, prev_obj_val: 61.867069244384766, obj_val: 66.80659484863281, abs dis: 4.939525604248047
[rfa agg] iter: 0, weight: tensor([0.1979, 0.2548, 0.0045, 0.0638, 0.0353, 0.0168, 0.2582, 0.0556, 0.0579,
        0.0551])
[rfa agg] iter:  1, prev_obj_val: 66.80659484863281, obj_val: 66.78742218017578, abs dis: 0.01917266845703125
[rfa agg] iter: 1, weight: tensor([0.1631, 0.2022, 0.0065, 0.0725, 0.0582, 0.0257, 0.2016, 0.1012, 0.1046,
        0.0645])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.1707, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 4.8309, Accuracy: 1/9950 (0.0101%)
saving model
Done in 253.95929527282715 sec.
Server Epoch:11 choose agents : [25, 80, 30, 6, 94, 12, 89, 11, 27, 14].
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0593, Accuracy: 250/690 (36.2319%)
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1871, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  11, local model 80, internal_epoch   1, Avg loss: 0.0747, Accuracy: 115/682 (16.8622%)
_Train Local_ResNet_18, epoch  11, local model 80, internal_epoch   2, Avg loss: 0.0405, Accuracy: 244/682 (35.7771%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6257, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   1, Avg loss: 0.0806, Accuracy: 42/486 (8.6420%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   2, Avg loss: 0.0401, Accuracy: 215/486 (44.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6995, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0575, Accuracy: 372/1956 (19.0184%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 648/1956 (33.1288%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.4097, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  11, local model 94, internal_epoch   1, Avg loss: 0.0567, Accuracy: 322/1662 (19.3742%)
_Train Local_ResNet_18, epoch  11, local model 94, internal_epoch   2, Avg loss: 0.0340, Accuracy: 579/1662 (34.8375%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.6122, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0978, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0535, Accuracy: 129/338 (38.1657%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.3766, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  11, local model 89, internal_epoch   1, Avg loss: 0.0587, Accuracy: 306/896 (34.1518%)
_Train Local_ResNet_18, epoch  11, local model 89, internal_epoch   2, Avg loss: 0.0350, Accuracy: 433/896 (48.3259%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.0639, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0619, Accuracy: 260/712 (36.5169%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0284, Accuracy: 419/712 (58.8483%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.3810, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   1, Avg loss: 0.0545, Accuracy: 367/1587 (23.1254%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   2, Avg loss: 0.0346, Accuracy: 561/1587 (35.3497%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7805, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0631, Accuracy: 184/1013 (18.1639%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 322/1013 (31.7868%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7100, Accuracy: 59/10000 (0.5900%)
time spent on training: 127.94118285179138
[rfa agg] training data poison_ratio: 0.0  data num: [690, 682, 486, 1956, 1662, 338, 896, 712, 1587, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 80, 30, 6, 94, 12, 89, 11, 27, 14], weight: tensor([0.0688, 0.0681, 0.0485, 0.1952, 0.1658, 0.0337, 0.0894, 0.0710, 0.1584,
        0.1011])
[rfa agg] iter:  0, prev_obj_val: 71.11812591552734, obj_val: 73.06958770751953, abs dis: 1.9514617919921875
[rfa agg] iter: 0, weight: tensor([0.0608, 0.0600, 0.0294, 0.0834, 0.1119, 0.0168, 0.1394, 0.0735, 0.1206,
        0.3042])
[rfa agg] iter:  1, prev_obj_val: 73.06958770751953, obj_val: 75.3108139038086, abs dis: 2.2412261962890625
[rfa agg] iter: 1, weight: tensor([0.0605, 0.0600, 0.0259, 0.0507, 0.0635, 0.0142, 0.1888, 0.0788, 0.0668,
        0.3907])
[rfa agg] iter:  2, prev_obj_val: 75.3108139038086, obj_val: 78.20357513427734, abs dis: 2.89276123046875
[rfa agg] iter: 2, weight: tensor([0.0768, 0.0765, 0.0299, 0.0479, 0.0583, 0.0158, 0.2864, 0.1067, 0.0608,
        0.2410])
[rfa agg] iter:  3, prev_obj_val: 78.20357513427734, obj_val: 81.92507934570312, abs dis: 3.7215042114257812
[rfa agg] iter: 3, weight: tensor([0.0990, 0.0986, 0.0333, 0.0428, 0.0508, 0.0169, 0.3100, 0.1521, 0.0526,
        0.1439])
[rfa agg] iter:  4, prev_obj_val: 81.92507934570312, obj_val: 81.85975646972656, abs dis: 0.0653228759765625
[rfa agg] iter: 4, weight: tensor([0.1434, 0.1428, 0.0383, 0.0384, 0.0446, 0.0184, 0.1839, 0.2444, 0.0459,
        0.1000])
[rfa agg] iter:  5, prev_obj_val: 81.85975646972656, obj_val: 81.85810852050781, abs dis: 0.00164794921875
[rfa agg] iter: 5, weight: tensor([0.1428, 0.1426, 0.0372, 0.0371, 0.0432, 0.0179, 0.1681, 0.2701, 0.0444,
        0.0966])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.1469, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 6.0224, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.42241597175598 sec.
Server Epoch:12 choose agents : [37, 82, 96, 32, 34, 88, 63, 20, 22, 14].
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   1, Avg loss: 0.0550, Accuracy: 391/1129 (34.6324%)
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 753/1129 (66.6962%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.7537, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  12, local model 82, internal_epoch   1, Avg loss: 0.0750, Accuracy: 81/500 (16.2000%)
_Train Local_ResNet_18, epoch  12, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 198/500 (39.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.2680, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  12, local model 96, internal_epoch   1, Avg loss: 0.0804, Accuracy: 33/311 (10.6109%)
_Train Local_ResNet_18, epoch  12, local model 96, internal_epoch   2, Avg loss: 0.0566, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.3477, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0591, Accuracy: 153/735 (20.8163%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 318/735 (43.2653%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.9787, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0600, Accuracy: 347/1427 (24.3167%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0338, Accuracy: 575/1427 (40.2943%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6516, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  12, local model 88, internal_epoch   1, Avg loss: 0.0769, Accuracy: 113/603 (18.7396%)
_Train Local_ResNet_18, epoch  12, local model 88, internal_epoch   2, Avg loss: 0.0467, Accuracy: 289/603 (47.9270%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.8902, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   1, Avg loss: 0.0597, Accuracy: 205/888 (23.0856%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 397/888 (44.7072%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.6738, Accuracy: 59/10000 (0.5900%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   1, Avg loss: 0.0548, Accuracy: 363/807 (44.9814%)
_Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   2, Avg loss: 0.0331, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.3050, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0490, Accuracy: 452/1470 (30.7483%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0250, Accuracy: 759/1470 (51.6327%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.1346, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   1, Avg loss: 0.0630, Accuracy: 191/1013 (18.8549%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 341/1013 (33.6624%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0244, Accuracy: 61/10000 (0.6100%)
time spent on training: 137.608154296875
[rfa agg] training data poison_ratio: 0.09084768659236744  data num: [1129, 500, 311, 735, 1427, 603, 888, 807, 1470, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.028389902060114824
[rfa agg] init. name: [37, 82, 96, 32, 34, 88, 63, 20, 22, 14], weight: tensor([0.1271, 0.0563, 0.0350, 0.0827, 0.1606, 0.0679, 0.1000, 0.0908, 0.1655,
        0.1140])
[rfa agg] iter:  0, prev_obj_val: 47.08214569091797, obj_val: 50.61138153076172, abs dis: 3.52923583984375
[rfa agg] iter: 0, weight: tensor([0.0772, 0.0286, 0.0114, 0.1307, 0.0480, 0.0537, 0.2570, 0.2250, 0.0493,
        0.1191])
[rfa agg] iter:  1, prev_obj_val: 50.61138153076172, obj_val: 55.618370056152344, abs dis: 5.006988525390625
[rfa agg] iter: 1, weight: tensor([0.0634, 0.0345, 0.0127, 0.2227, 0.0431, 0.0726, 0.1655, 0.2528, 0.0443,
        0.0884])
[rfa agg] iter:  2, prev_obj_val: 55.618370056152344, obj_val: 55.59489822387695, abs dis: 0.023471832275390625
[rfa agg] iter: 2, weight: tensor([0.0618, 0.0499, 0.0166, 0.2807, 0.0450, 0.1270, 0.1213, 0.1717, 0.0463,
        0.0797])
[rfa agg] iter:  3, prev_obj_val: 55.59489822387695, obj_val: 52.9210205078125, abs dis: 2.673877716064453
[rfa agg] iter: 3, weight: tensor([0.0607, 0.0492, 0.0164, 0.2951, 0.0442, 0.1273, 0.1187, 0.1646, 0.0455,
        0.0783])
[rfa agg] iter:  4, prev_obj_val: 52.9210205078125, obj_val: 61.55519104003906, abs dis: 8.634170532226562
[rfa agg] iter: 4, weight: tensor([0.0582, 0.0386, 0.0136, 0.3232, 0.0411, 0.0893, 0.1272, 0.1887, 0.0423,
        0.0777])
[rfa agg] iter:  5, prev_obj_val: 61.55519104003906, obj_val: 55.63076400756836, abs dis: 5.924427032470703
[rfa agg] iter: 5, weight: tensor([0.0615, 0.0768, 0.0221, 0.1850, 0.0473, 0.2553, 0.1018, 0.1265, 0.0487,
        0.0751])
[rfa agg] iter:  6, prev_obj_val: 55.63076400756836, obj_val: 55.59508514404297, abs dis: 0.035678863525390625
[rfa agg] iter: 6, weight: tensor([0.0621, 0.0507, 0.0168, 0.2766, 0.0453, 0.1353, 0.1216, 0.1651, 0.0465,
        0.0801])
[rfa agg] iter:  7, prev_obj_val: 55.59508514404297, obj_val: 52.9211540222168, abs dis: 2.673931121826172
[rfa agg] iter: 7, weight: tensor([0.0608, 0.0493, 0.0164, 0.2943, 0.0443, 0.1278, 0.1189, 0.1644, 0.0455,
        0.0784])
[rfa agg] iter:  8, prev_obj_val: 52.9211540222168, obj_val: 61.55511474609375, abs dis: 8.633960723876953
[rfa agg] iter: 8, weight: tensor([0.0582, 0.0387, 0.0136, 0.3230, 0.0411, 0.0894, 0.1273, 0.1888, 0.0423,
        0.0777])
[rfa agg] iter:  9, prev_obj_val: 61.55511474609375, obj_val: 55.630767822265625, abs dis: 5.924346923828125
[rfa agg] iter: 9, weight: tensor([0.0615, 0.0768, 0.0221, 0.1849, 0.0473, 0.2553, 0.1018, 0.1265, 0.0487,
        0.0751])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.9192, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 7.3617, Accuracy: 0/9950 (0.0000%)
saving model
Done in 259.25198316574097 sec.
Server Epoch:13 choose agents : [36, 77, 71, 15, 56, 7, 17, 51, 47, 24].
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   1, Avg loss: 0.0914, Accuracy: 38/408 (9.3137%)
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   2, Avg loss: 0.0560, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.8672, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  13, local model 77, internal_epoch   1, Avg loss: 0.0556, Accuracy: 288/1340 (21.4925%)
_Train Local_ResNet_18, epoch  13, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 545/1340 (40.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 9.2516, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   1, Avg loss: 0.0657, Accuracy: 125/818 (15.2812%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 332/818 (40.5868%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.6161, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0705, Accuracy: 255/1154 (22.0971%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0335, Accuracy: 413/1154 (35.7886%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.9537, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 40/186 (21.5054%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.9819, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0524, Accuracy: 325/891 (36.4759%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 462/891 (51.8519%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.5457, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   1, Avg loss: 0.0572, Accuracy: 325/1574 (20.6480%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   2, Avg loss: 0.0293, Accuracy: 602/1574 (38.2465%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.7692, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   1, Avg loss: 0.0656, Accuracy: 183/1049 (17.4452%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   2, Avg loss: 0.0309, Accuracy: 504/1049 (48.0458%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.5098, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   1, Avg loss: 0.1289, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   2, Avg loss: 0.1110, Accuracy: 2/134 (1.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.7571, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   1, Avg loss: 0.0853, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   2, Avg loss: 0.0459, Accuracy: 139/312 (44.5513%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.5842, Accuracy: 53/10000 (0.5300%)
time spent on training: 126.25639033317566
[rfa agg] training data poison_ratio: 0.0  data num: [408, 1340, 818, 1154, 186, 891, 1574, 1049, 134, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 77, 71, 15, 56, 7, 17, 51, 47, 24], weight: tensor([0.0519, 0.1704, 0.1040, 0.1467, 0.0236, 0.1133, 0.2001, 0.1334, 0.0170,
        0.0397])
[rfa agg] iter:  0, prev_obj_val: 50.154327392578125, obj_val: 52.88642883300781, abs dis: 2.7321014404296875
[rfa agg] iter: 0, weight: tensor([0.0227, 0.1140, 0.1443, 0.1458, 0.0069, 0.2199, 0.0786, 0.2490, 0.0050,
        0.0140])
[rfa agg] iter:  1, prev_obj_val: 52.88642883300781, obj_val: 52.808143615722656, abs dis: 0.07828521728515625
[rfa agg] iter: 1, weight: tensor([0.0233, 0.0886, 0.1976, 0.1066, 0.0068, 0.3271, 0.0649, 0.1661, 0.0049,
        0.0140])
[rfa agg] iter:  2, prev_obj_val: 52.808143615722656, obj_val: 52.80410385131836, abs dis: 0.004039764404296875
[rfa agg] iter: 2, weight: tensor([0.0221, 0.0840, 0.1931, 0.1004, 0.0064, 0.3609, 0.0615, 0.1536, 0.0046,
        0.0133])
[rfa agg] iter:  3, prev_obj_val: 52.80410385131836, obj_val: 54.50495529174805, abs dis: 1.7008514404296875
[rfa agg] iter: 3, weight: tensor([0.0218, 0.0828, 0.1903, 0.0989, 0.0063, 0.3707, 0.0606, 0.1508, 0.0046,
        0.0131])
[rfa agg] iter:  4, prev_obj_val: 54.50495529174805, obj_val: 56.57717514038086, abs dis: 2.0722198486328125
[rfa agg] iter: 4, weight: tensor([0.0214, 0.0710, 0.2262, 0.0827, 0.0061, 0.4023, 0.0533, 0.1198, 0.0044,
        0.0127])
[rfa agg] iter:  5, prev_obj_val: 56.57717514038086, obj_val: 59.017181396484375, abs dis: 2.4400062561035156
[rfa agg] iter: 5, weight: tensor([0.0228, 0.0656, 0.2995, 0.0749, 0.0063, 0.3592, 0.0505, 0.1034, 0.0045,
        0.0133])
[rfa agg] iter:  6, prev_obj_val: 59.017181396484375, obj_val: 58.98004913330078, abs dis: 0.03713226318359375
[rfa agg] iter: 6, weight: tensor([0.0256, 0.0643, 0.3978, 0.0721, 0.0069, 0.2675, 0.0505, 0.0958, 0.0049,
        0.0146])
[rfa agg] iter:  7, prev_obj_val: 58.98004913330078, obj_val: 58.97365188598633, abs dis: 0.006397247314453125
[rfa agg] iter: 7, weight: tensor([0.0243, 0.0609, 0.4431, 0.0683, 0.0065, 0.2396, 0.0479, 0.0908, 0.0047,
        0.0139])
[rfa agg] iter:  8, prev_obj_val: 58.97365188598633, obj_val: 58.97218704223633, abs dis: 0.00146484375
[rfa agg] iter: 8, weight: tensor([0.0236, 0.0590, 0.4646, 0.0662, 0.0063, 0.2279, 0.0464, 0.0879, 0.0045,
        0.0135])
[rfa agg] iter:  9, prev_obj_val: 58.97218704223633, obj_val: 58.97181701660156, abs dis: 0.000370025634765625
[rfa agg] iter: 9, weight: tensor([0.0232, 0.0581, 0.4754, 0.0651, 0.0062, 0.2224, 0.0457, 0.0864, 0.0045,
        0.0132])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.8045, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 6.1013, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.96523904800415 sec.
Server Epoch:14 choose agents : [70, 65, 66, 62, 34, 71, 84, 61, 85, 20].
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0573, Accuracy: 301/1418 (21.2271%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 594/1418 (41.8900%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.4256, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0560, Accuracy: 414/1475 (28.0678%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0322, Accuracy: 593/1475 (40.2034%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.9602, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0653, Accuracy: 218/1402 (15.5492%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0392, Accuracy: 379/1402 (27.0328%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.9180, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   1, Avg loss: 0.0771, Accuracy: 70/568 (12.3239%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   2, Avg loss: 0.0415, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.0601, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   1, Avg loss: 0.0608, Accuracy: 329/1427 (23.0554%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   2, Avg loss: 0.0339, Accuracy: 595/1427 (41.6959%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.6797, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   1, Avg loss: 0.0623, Accuracy: 130/818 (15.8924%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   2, Avg loss: 0.0300, Accuracy: 359/818 (43.8875%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.3431, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0616, Accuracy: 324/1190 (27.2269%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 472/1190 (39.6639%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.0337, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1294, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1218, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.8532, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  14, local model 85, internal_epoch   1, Avg loss: 0.0531, Accuracy: 425/1988 (21.3783%)
_Train Local_ResNet_18, epoch  14, local model 85, internal_epoch   2, Avg loss: 0.0362, Accuracy: 634/1988 (31.8913%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.1575, Accuracy: 83/10000 (0.8300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  14, local model 20, internal_epoch   1, Avg loss: 0.0585, Accuracy: 303/807 (37.5465%)
_Train Local_ResNet_18, epoch  14, local model 20, internal_epoch   2, Avg loss: 0.0338, Accuracy: 416/807 (51.5489%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.2535, Accuracy: 55/10000 (0.5500%)
time spent on training: 154.4967224597931
[rfa agg] training data poison_ratio: 0.07219538378958669  data num: [1418, 1475, 1402, 568, 1427, 818, 1190, 85, 1988, 807]
[rfa agg] considering poison per batch poison_fraction: 0.02256105743424584
[rfa agg] init. name: [70, 65, 66, 62, 34, 71, 84, 61, 85, 20], weight: tensor([0.1269, 0.1320, 0.1254, 0.0508, 0.1277, 0.0732, 0.1065, 0.0076, 0.1778,
        0.0722])
[rfa agg] iter:  0, prev_obj_val: 55.51136779785156, obj_val: 57.48983383178711, abs dis: 1.9784660339355469
[rfa agg] iter: 0, weight: tensor([0.1289, 0.1080, 0.1656, 0.0216, 0.1293, 0.0515, 0.2846, 0.0019, 0.0582,
        0.0505])
[rfa agg] iter:  1, prev_obj_val: 57.48983383178711, obj_val: 57.4793815612793, abs dis: 0.0104522705078125
[rfa agg] iter: 1, weight: tensor([0.1162, 0.0992, 0.1459, 0.0228, 0.1163, 0.0561, 0.3303, 0.0019, 0.0562,
        0.0549])
[rfa agg] iter:  2, prev_obj_val: 57.4793815612793, obj_val: 55.32469177246094, abs dis: 2.1546897888183594
[rfa agg] iter: 2, weight: tensor([0.1138, 0.0972, 0.1427, 0.0224, 0.1139, 0.0551, 0.3440, 0.0019, 0.0552,
        0.0539])
[rfa agg] iter:  3, prev_obj_val: 55.32469177246094, obj_val: 55.324012756347656, abs dis: 0.00067901611328125
[rfa agg] iter: 3, weight: tensor([0.1168, 0.0980, 0.1505, 0.0197, 0.1167, 0.0468, 0.3512, 0.0017, 0.0529,
        0.0458])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.5077, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 8.7831, Accuracy: 0/9950 (0.0000%)
saving model
Done in 269.223539352417 sec.
Server Epoch:15 choose agents : [70, 63, 85, 80, 26, 42, 18, 66, 39, 97].
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0567, Accuracy: 310/1418 (21.8618%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0317, Accuracy: 575/1418 (40.5501%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.5677, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0589, Accuracy: 196/888 (22.0721%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 429/888 (48.3108%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.5744, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  15, local model 85, internal_epoch   1, Avg loss: 0.0537, Accuracy: 430/1988 (21.6298%)
_Train Local_ResNet_18, epoch  15, local model 85, internal_epoch   2, Avg loss: 0.0366, Accuracy: 640/1988 (32.1932%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.3427, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  15, local model 80, internal_epoch   1, Avg loss: 0.0791, Accuracy: 81/682 (11.8768%)
_Train Local_ResNet_18, epoch  15, local model 80, internal_epoch   2, Avg loss: 0.0414, Accuracy: 252/682 (36.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.0873, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   1, Avg loss: 0.0601, Accuracy: 270/1446 (18.6722%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   2, Avg loss: 0.0354, Accuracy: 484/1446 (33.4716%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.8737, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   1, Avg loss: 0.0569, Accuracy: 277/1372 (20.1895%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   2, Avg loss: 0.0326, Accuracy: 482/1372 (35.1312%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.6971, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0827, Accuracy: 68/530 (12.8302%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0401, Accuracy: 275/530 (51.8868%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.3510, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   1, Avg loss: 0.0637, Accuracy: 249/1402 (17.7603%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   2, Avg loss: 0.0392, Accuracy: 403/1402 (28.7447%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.8237, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0547, Accuracy: 306/1013 (30.2073%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0268, Accuracy: 513/1013 (50.6417%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.4858, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  15, local model 97, internal_epoch   1, Avg loss: 0.0571, Accuracy: 332/1213 (27.3702%)
_Train Local_ResNet_18, epoch  15, local model 97, internal_epoch   2, Avg loss: 0.0281, Accuracy: 468/1213 (38.5820%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.0279, Accuracy: 89/10000 (0.8900%)
time spent on training: 154.6407871246338
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 888, 1988, 682, 1446, 1372, 530, 1402, 1013, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 63, 85, 80, 26, 42, 18, 66, 39, 97], weight: tensor([0.1186, 0.0743, 0.1663, 0.0571, 0.1210, 0.1148, 0.0443, 0.1173, 0.0848,
        0.1015])
[rfa agg] iter:  0, prev_obj_val: 50.70598602294922, obj_val: 56.171226501464844, abs dis: 5.465240478515625
[rfa agg] iter: 0, weight: tensor([0.1031, 0.0538, 0.0475, 0.0264, 0.1064, 0.1312, 0.0164, 0.1325, 0.0970,
        0.2858])
[rfa agg] iter:  1, prev_obj_val: 56.171226501464844, obj_val: 58.257511138916016, abs dis: 2.086284637451172
[rfa agg] iter: 1, weight: tensor([0.0881, 0.0844, 0.0485, 0.0368, 0.0906, 0.1044, 0.0219, 0.1059, 0.1829,
        0.2365])
[rfa agg] iter:  2, prev_obj_val: 58.257511138916016, obj_val: 60.45827102661133, abs dis: 2.2007598876953125
[rfa agg] iter: 2, weight: tensor([0.0822, 0.0983, 0.0474, 0.0402, 0.0843, 0.0954, 0.0235, 0.0971, 0.2409,
        0.1907])
[rfa agg] iter:  3, prev_obj_val: 60.45827102661133, obj_val: 65.41064453125, abs dis: 4.952373504638672
[rfa agg] iter: 3, weight: tensor([0.0738, 0.1114, 0.0444, 0.0423, 0.0756, 0.0844, 0.0243, 0.0860, 0.3051,
        0.1527])
[rfa agg] iter:  4, prev_obj_val: 65.41064453125, obj_val: 62.805908203125, abs dis: 2.604736328125
[rfa agg] iter: 4, weight: tensor([0.0643, 0.1615, 0.0417, 0.0511, 0.0657, 0.0718, 0.0278, 0.0732, 0.3294,
        0.1135])
[rfa agg] iter:  5, prev_obj_val: 62.805908203125, obj_val: 65.40032196044922, abs dis: 2.5944137573242188
[rfa agg] iter: 5, weight: tensor([0.0643, 0.1266, 0.0403, 0.0434, 0.0658, 0.0726, 0.0243, 0.0740, 0.3682,
        0.1205])
[rfa agg] iter:  6, prev_obj_val: 65.40032196044922, obj_val: 62.803890228271484, abs dis: 2.5964317321777344
[rfa agg] iter: 6, weight: tensor([0.0625, 0.1583, 0.0406, 0.0496, 0.0639, 0.0698, 0.0270, 0.0712, 0.3474,
        0.1097])
[rfa agg] iter:  7, prev_obj_val: 62.803890228271484, obj_val: 68.19783782958984, abs dis: 5.393947601318359
[rfa agg] iter: 7, weight: tensor([0.0637, 0.1252, 0.0399, 0.0429, 0.0651, 0.0718, 0.0240, 0.0733, 0.3748,
        0.1192])
[rfa agg] iter:  8, prev_obj_val: 68.19783782958984, obj_val: 68.17060852050781, abs dis: 0.02722930908203125
[rfa agg] iter: 8, weight: tensor([0.0632, 0.2104, 0.0424, 0.0596, 0.0646, 0.0699, 0.0314, 0.0714, 0.2823,
        0.1048])
[rfa agg] iter:  9, prev_obj_val: 68.17060852050781, obj_val: 68.16993713378906, abs dis: 0.00067138671875
[rfa agg] iter: 9, weight: tensor([0.0633, 0.2244, 0.0424, 0.0598, 0.0648, 0.0701, 0.0315, 0.0715, 0.2672,
        0.1049])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.7256, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 8.0744, Accuracy: 0/9950 (0.0000%)
saving model
Done in 266.35199785232544 sec.
Server Epoch:16 choose agents : [24, 22, 71, 66, 81, 6, 64, 98, 59, 33].
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   1, Avg loss: 0.0835, Accuracy: 3/312 (0.9615%)
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   2, Avg loss: 0.0441, Accuracy: 148/312 (47.4359%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.1753, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   1, Avg loss: 0.0472, Accuracy: 464/1470 (31.5646%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   2, Avg loss: 0.0246, Accuracy: 832/1470 (56.5986%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.8305, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   1, Avg loss: 0.0605, Accuracy: 153/818 (18.7042%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 355/818 (43.3985%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.1134, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   1, Avg loss: 0.0629, Accuracy: 248/1402 (17.6890%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   2, Avg loss: 0.0393, Accuracy: 385/1402 (27.4608%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.9299, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  16, local model 81, internal_epoch   1, Avg loss: 0.0718, Accuracy: 184/774 (23.7726%)
_Train Local_ResNet_18, epoch  16, local model 81, internal_epoch   2, Avg loss: 0.0380, Accuracy: 310/774 (40.0517%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.7420, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0579, Accuracy: 354/1956 (18.0982%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0329, Accuracy: 628/1956 (32.1063%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.6651, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   1, Avg loss: 0.0599, Accuracy: 181/953 (18.9927%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 295/953 (30.9549%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.7806, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  16, local model 98, internal_epoch   1, Avg loss: 0.0925, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  16, local model 98, internal_epoch   2, Avg loss: 0.0555, Accuracy: 138/373 (36.9973%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.7474, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   1, Avg loss: 0.0581, Accuracy: 284/1089 (26.0790%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 454/1089 (41.6896%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.9293, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   1, Avg loss: 0.0851, Accuracy: 50/515 (9.7087%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   2, Avg loss: 0.0557, Accuracy: 113/515 (21.9417%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.9966, Accuracy: 51/10000 (0.5100%)
time spent on training: 155.58359217643738
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1470, 818, 1402, 774, 1956, 953, 373, 1089, 515]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 22, 71, 66, 81, 6, 64, 98, 59, 33], weight: tensor([0.0323, 0.1521, 0.0847, 0.1451, 0.0801, 0.2024, 0.0986, 0.0386, 0.1127,
        0.0533])
[rfa agg] iter:  0, prev_obj_val: 62.61389923095703, obj_val: 65.43363189697266, abs dis: 2.819732666015625
[rfa agg] iter: 0, weight: tensor([0.0126, 0.1174, 0.0976, 0.1338, 0.0916, 0.0689, 0.1994, 0.0166, 0.2307,
        0.0315])
[rfa agg] iter:  1, prev_obj_val: 65.43363189697266, obj_val: 68.2298583984375, abs dis: 2.7962265014648438
[rfa agg] iter: 1, weight: tensor([0.0124, 0.0821, 0.1262, 0.0903, 0.1179, 0.0538, 0.3170, 0.0165, 0.1508,
        0.0331])
[rfa agg] iter:  2, prev_obj_val: 68.2298583984375, obj_val: 72.09464263916016, abs dis: 3.8647842407226562
[rfa agg] iter: 2, weight: tensor([0.0122, 0.0650, 0.1662, 0.0703, 0.1539, 0.0452, 0.3330, 0.0164, 0.1032,
        0.0348])
[rfa agg] iter:  3, prev_obj_val: 72.09464263916016, obj_val: 74.33625030517578, abs dis: 2.241607666015625
[rfa agg] iter: 3, weight: tensor([0.0131, 0.0567, 0.2561, 0.0605, 0.2311, 0.0414, 0.2009, 0.0179, 0.0814,
        0.0408])
[rfa agg] iter:  4, prev_obj_val: 74.33625030517578, obj_val: 77.0373764038086, abs dis: 2.7011260986328125
[rfa agg] iter: 4, weight: tensor([0.0130, 0.0503, 0.3053, 0.0534, 0.2666, 0.0376, 0.1442, 0.0179, 0.0693,
        0.0425])
[rfa agg] iter:  5, prev_obj_val: 77.0373764038086, obj_val: 80.05855560302734, abs dis: 3.02117919921875
[rfa agg] iter: 5, weight: tensor([0.0148, 0.0515, 0.3051, 0.0544, 0.2666, 0.0392, 0.1279, 0.0206, 0.0684,
        0.0515])
[rfa agg] iter:  6, prev_obj_val: 80.05855560302734, obj_val: 77.03976440429688, abs dis: 3.0187911987304688
[rfa agg] iter: 6, weight: tensor([0.0186, 0.0580, 0.2723, 0.0609, 0.2459, 0.0450, 0.1290, 0.0261, 0.0747,
        0.0694])
[rfa agg] iter:  7, prev_obj_val: 77.03976440429688, obj_val: 80.05812072753906, abs dis: 3.0183563232421875
[rfa agg] iter: 7, weight: tensor([0.0150, 0.0520, 0.3010, 0.0549, 0.2667, 0.0396, 0.1288, 0.0208, 0.0691,
        0.0522])
[rfa agg] iter:  8, prev_obj_val: 80.05812072753906, obj_val: 77.0398178100586, abs dis: 3.0183029174804688
[rfa agg] iter: 8, weight: tensor([0.0186, 0.0580, 0.2718, 0.0609, 0.2461, 0.0450, 0.1291, 0.0261, 0.0748,
        0.0695])
[rfa agg] iter:  9, prev_obj_val: 77.0398178100586, obj_val: 80.05811309814453, abs dis: 3.0182952880859375
[rfa agg] iter: 9, weight: tensor([0.0150, 0.0520, 0.3008, 0.0549, 0.2668, 0.0396, 0.1288, 0.0208, 0.0691,
        0.0522])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.0228, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 7.6694, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.58019614219666 sec.
Server Epoch:17 choose agents : [36, 29, 28, 82, 55, 63, 33, 23, 5, 43].
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   1, Avg loss: 0.0956, Accuracy: 9/408 (2.2059%)
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   2, Avg loss: 0.0585, Accuracy: 150/408 (36.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.9670, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0506, Accuracy: 402/1440 (27.9167%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0288, Accuracy: 610/1440 (42.3611%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.2123, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0594, Accuracy: 323/1581 (20.4301%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0343, Accuracy: 589/1581 (37.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.8814, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   1, Avg loss: 0.0712, Accuracy: 92/500 (18.4000%)
_Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   2, Avg loss: 0.0495, Accuracy: 193/500 (38.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.2824, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 245/1071 (22.8758%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 510/1071 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.1921, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   1, Avg loss: 0.0576, Accuracy: 206/888 (23.1982%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 439/888 (49.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.8230, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0826, Accuracy: 56/515 (10.8738%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0540, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.1816, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   1, Avg loss: 0.0767, Accuracy: 202/715 (28.2517%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   2, Avg loss: 0.0443, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.5105, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0534, Accuracy: 325/1628 (19.9631%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0265, Accuracy: 774/1628 (47.5430%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.6082, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0593, Accuracy: 290/946 (30.6554%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0373, Accuracy: 355/946 (37.5264%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.2245, Accuracy: 60/10000 (0.6000%)
time spent on training: 152.08669543266296
[rfa agg] training data poison_ratio: 0.0  data num: [408, 1440, 1581, 500, 1071, 888, 515, 715, 1628, 946]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 29, 28, 82, 55, 63, 33, 23, 5, 43], weight: tensor([0.0421, 0.1486, 0.1631, 0.0516, 0.1105, 0.0916, 0.0531, 0.0738, 0.1680,
        0.0976])
[rfa agg] iter:  0, prev_obj_val: 58.39632034301758, obj_val: 65.94950866699219, abs dis: 7.553188323974609
[rfa agg] iter: 0, weight: tensor([0.0180, 0.0640, 0.0563, 0.0253, 0.1585, 0.2125, 0.0301, 0.0789, 0.0529,
        0.3036])
[rfa agg] iter:  1, prev_obj_val: 65.94950866699219, obj_val: 68.39024353027344, abs dis: 2.44073486328125
[rfa agg] iter: 1, weight: tensor([0.0268, 0.0584, 0.0534, 0.0395, 0.1043, 0.2594, 0.0497, 0.1798, 0.0509,
        0.1777])
[rfa agg] iter:  2, prev_obj_val: 68.39024353027344, obj_val: 68.37380981445312, abs dis: 0.0164337158203125
[rfa agg] iter: 2, weight: tensor([0.0301, 0.0575, 0.0529, 0.0452, 0.0963, 0.2148, 0.0581, 0.2467, 0.0506,
        0.1478])
[rfa agg] iter:  3, prev_obj_val: 68.37380981445312, obj_val: 68.37308502197266, abs dis: 0.00072479248046875
[rfa agg] iter: 3, weight: tensor([0.0297, 0.0566, 0.0521, 0.0446, 0.0948, 0.2076, 0.0573, 0.2631, 0.0498,
        0.1445])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 10.8825, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 10.8893, Accuracy: 0/9950 (0.0000%)
saving model
Done in 268.3100037574768 sec.
Server Epoch:18 choose agents : [78, 91, 3, 24, 2, 8, 80, 51, 73, 29].
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 18/416 (4.3269%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0486, Accuracy: 184/416 (44.2308%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5487, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  18, local model 91, internal_epoch   1, Avg loss: 0.0627, Accuracy: 272/1030 (26.4078%)
_Train Local_ResNet_18, epoch  18, local model 91, internal_epoch   2, Avg loss: 0.0283, Accuracy: 617/1030 (59.9029%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 10.1432, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0703, Accuracy: 86/781 (11.0115%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 240/781 (30.7298%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.3538, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0814, Accuracy: 6/312 (1.9231%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0428, Accuracy: 154/312 (49.3590%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5693, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0676, Accuracy: 153/605 (25.2893%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0409, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.7266, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0626, Accuracy: 232/1513 (15.3338%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0379, Accuracy: 437/1513 (28.8830%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.4303, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  18, local model 80, internal_epoch   1, Avg loss: 0.0800, Accuracy: 85/682 (12.4633%)
_Train Local_ResNet_18, epoch  18, local model 80, internal_epoch   2, Avg loss: 0.0414, Accuracy: 251/682 (36.8035%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.4827, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   1, Avg loss: 0.0651, Accuracy: 199/1049 (18.9704%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 509/1049 (48.5224%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.8327, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   1, Avg loss: 0.0702, Accuracy: 139/938 (14.8188%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   2, Avg loss: 0.0342, Accuracy: 327/938 (34.8614%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.0229, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   1, Avg loss: 0.0507, Accuracy: 395/1440 (27.4306%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 652/1440 (45.2778%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 10.0418, Accuracy: 83/10000 (0.8300%)
time spent on training: 146.34441304206848
[rfa agg] training data poison_ratio: 0.0  data num: [416, 1030, 781, 312, 605, 1513, 682, 1049, 938, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [78, 91, 3, 24, 2, 8, 80, 51, 73, 29], weight: tensor([0.0475, 0.1175, 0.0891, 0.0356, 0.0690, 0.1726, 0.0778, 0.1197, 0.1070,
        0.1643])
[rfa agg] iter:  0, prev_obj_val: 48.613224029541016, obj_val: 51.3770751953125, abs dis: 2.7638511657714844
[rfa agg] iter: 0, weight: tensor([0.0220, 0.1360, 0.1703, 0.0129, 0.0526, 0.0640, 0.0752, 0.1458, 0.2536,
        0.0676])
[rfa agg] iter:  1, prev_obj_val: 51.3770751953125, obj_val: 55.178550720214844, abs dis: 3.8014755249023438
[rfa agg] iter: 1, weight: tensor([0.0246, 0.1047, 0.2734, 0.0140, 0.0644, 0.0567, 0.0988, 0.1100, 0.1942,
        0.0592])
[rfa agg] iter:  2, prev_obj_val: 55.178550720214844, obj_val: 57.44331359863281, abs dis: 2.2647628784179688
[rfa agg] iter: 2, weight: tensor([0.0289, 0.0847, 0.3092, 0.0158, 0.0860, 0.0520, 0.1479, 0.0883, 0.1333,
        0.0539])
[rfa agg] iter:  3, prev_obj_val: 57.44331359863281, obj_val: 59.87214660644531, abs dis: 2.4288330078125
[rfa agg] iter: 3, weight: tensor([0.0330, 0.0804, 0.2522, 0.0176, 0.1072, 0.0520, 0.2016, 0.0836, 0.1186,
        0.0538])
[rfa agg] iter:  4, prev_obj_val: 59.87214660644531, obj_val: 62.48652648925781, abs dis: 2.6143798828125
[rfa agg] iter: 4, weight: tensor([0.0364, 0.0738, 0.1869, 0.0188, 0.1316, 0.0500, 0.2708, 0.0764, 0.1039,
        0.0515])
[rfa agg] iter:  5, prev_obj_val: 62.48652648925781, obj_val: 59.86021423339844, abs dis: 2.626312255859375
[rfa agg] iter: 5, weight: tensor([0.0390, 0.0655, 0.1407, 0.0195, 0.1593, 0.0462, 0.3262, 0.0676, 0.0886,
        0.0474])
[rfa agg] iter:  6, prev_obj_val: 59.86021423339844, obj_val: 59.8537712097168, abs dis: 0.006443023681640625
[rfa agg] iter: 6, weight: tensor([0.0355, 0.0713, 0.1732, 0.0183, 0.1309, 0.0484, 0.2987, 0.0738, 0.1002,
        0.0498])
[rfa agg] iter:  7, prev_obj_val: 59.8537712097168, obj_val: 59.85366439819336, abs dis: 0.0001068115234375
[rfa agg] iter: 7, weight: tensor([0.0357, 0.0719, 0.1771, 0.0184, 0.1301, 0.0487, 0.2924, 0.0744, 0.1011,
        0.0502])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 10.5608, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 12.8704, Accuracy: 0/9950 (0.0000%)
saving model
Done in 261.5002372264862 sec.
Server Epoch:19 choose agents : [7, 88, 36, 17, 91, 94, 21, 60, 11, 15].
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0557, Accuracy: 279/891 (31.3131%)
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 427/891 (47.9237%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.8119, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  19, local model 88, internal_epoch   1, Avg loss: 0.0826, Accuracy: 79/603 (13.1012%)
_Train Local_ResNet_18, epoch  19, local model 88, internal_epoch   2, Avg loss: 0.0503, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.7361, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   1, Avg loss: 0.0980, Accuracy: 5/408 (1.2255%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   2, Avg loss: 0.0586, Accuracy: 142/408 (34.8039%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.0724, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0576, Accuracy: 322/1574 (20.4574%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0302, Accuracy: 561/1574 (35.6417%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.2780, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  19, local model 91, internal_epoch   1, Avg loss: 0.0622, Accuracy: 271/1030 (26.3107%)
_Train Local_ResNet_18, epoch  19, local model 91, internal_epoch   2, Avg loss: 0.0272, Accuracy: 571/1030 (55.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.4902, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  19, local model 94, internal_epoch   1, Avg loss: 0.0592, Accuracy: 279/1662 (16.7870%)
_Train Local_ResNet_18, epoch  19, local model 94, internal_epoch   2, Avg loss: 0.0349, Accuracy: 549/1662 (33.0325%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.2338, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0546, Accuracy: 373/1949 (19.1380%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0338, Accuracy: 599/1949 (30.7337%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.7931, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   1, Avg loss: 0.0526, Accuracy: 545/2227 (24.4724%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   2, Avg loss: 0.0291, Accuracy: 1002/2227 (44.9933%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.2669, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0629, Accuracy: 240/712 (33.7079%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0281, Accuracy: 433/712 (60.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.3183, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   1, Avg loss: 0.0687, Accuracy: 244/1154 (21.1438%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   2, Avg loss: 0.0308, Accuracy: 457/1154 (39.6014%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.7057, Accuracy: 62/10000 (0.6200%)
time spent on training: 168.72437143325806
[rfa agg] training data poison_ratio: 0.0  data num: [891, 603, 408, 1574, 1030, 1662, 1949, 2227, 712, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 88, 36, 17, 91, 94, 21, 60, 11, 15], weight: tensor([0.0730, 0.0494, 0.0334, 0.1289, 0.0844, 0.1361, 0.1596, 0.1824, 0.0583,
        0.0945])
[rfa agg] iter:  0, prev_obj_val: 72.85639953613281, obj_val: 74.89073181152344, abs dis: 2.034332275390625
[rfa agg] iter: 0, weight: tensor([0.0626, 0.0272, 0.0145, 0.1847, 0.1192, 0.1580, 0.0960, 0.0790, 0.0391,
        0.2197])
[rfa agg] iter:  1, prev_obj_val: 74.89073181152344, obj_val: 80.62934875488281, abs dis: 5.738616943359375
[rfa agg] iter: 1, weight: tensor([0.0668, 0.0275, 0.0143, 0.1399, 0.1394, 0.1234, 0.0805, 0.0679, 0.0404,
        0.2999])
[rfa agg] iter:  2, prev_obj_val: 80.62934875488281, obj_val: 82.45240020751953, abs dis: 1.8230514526367188
[rfa agg] iter: 2, weight: tensor([0.0884, 0.0311, 0.0153, 0.0922, 0.2294, 0.0851, 0.0621, 0.0545, 0.0483,
        0.2936])
[rfa agg] iter:  3, prev_obj_val: 82.45240020751953, obj_val: 82.43209838867188, abs dis: 0.02030181884765625
[rfa agg] iter: 3, weight: tensor([0.0991, 0.0329, 0.0159, 0.0854, 0.2837, 0.0796, 0.0594, 0.0526, 0.0521,
        0.2394])
[rfa agg] iter:  4, prev_obj_val: 82.43209838867188, obj_val: 82.4304428100586, abs dis: 0.00165557861328125
[rfa agg] iter: 4, weight: tensor([0.0981, 0.0324, 0.0157, 0.0842, 0.3020, 0.0785, 0.0586, 0.0519, 0.0514,
        0.2273])
[rfa agg] iter:  5, prev_obj_val: 82.4304428100586, obj_val: 82.43029022216797, abs dis: 0.000152587890625
[rfa agg] iter: 5, weight: tensor([0.0975, 0.0323, 0.0156, 0.0837, 0.3078, 0.0781, 0.0583, 0.0516, 0.0511,
        0.2240])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 11.0912, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 13.0860, Accuracy: 0/9950 (0.0000%)
saving model
Done in 282.87906527519226 sec.
Server Epoch:20 choose agents : [77, 14, 55, 7, 64, 50, 71, 52, 59, 10].
_Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   1, Avg loss: 0.0567, Accuracy: 276/1340 (20.5970%)
_Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 537/1340 (40.0746%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.2625, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   1, Avg loss: 0.0614, Accuracy: 200/1013 (19.7433%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 345/1013 (34.0573%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.3358, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   1, Avg loss: 0.0536, Accuracy: 261/1071 (24.3697%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 477/1071 (44.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.9489, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0537, Accuracy: 309/891 (34.6801%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0267, Accuracy: 454/891 (50.9540%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.1831, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   1, Avg loss: 0.0640, Accuracy: 146/953 (15.3200%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   2, Avg loss: 0.0390, Accuracy: 294/953 (30.8499%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.6457, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   1, Avg loss: 0.0695, Accuracy: 105/809 (12.9790%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   2, Avg loss: 0.0295, Accuracy: 306/809 (37.8245%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.7020, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   1, Avg loss: 0.0596, Accuracy: 131/818 (16.0147%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   2, Avg loss: 0.0300, Accuracy: 327/818 (39.9756%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.8350, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   1, Avg loss: 0.0500, Accuracy: 272/636 (42.7673%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   2, Avg loss: 0.0284, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.4986, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0517, Accuracy: 298/1089 (27.3646%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0307, Accuracy: 449/1089 (41.2305%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.5521, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   1, Avg loss: 0.0648, Accuracy: 156/861 (18.1185%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   2, Avg loss: 0.0227, Accuracy: 425/861 (49.3612%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.1413, Accuracy: 86/10000 (0.8600%)
time spent on training: 148.63210368156433
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 1013, 1071, 891, 953, 809, 818, 636, 1089, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 14, 55, 7, 64, 50, 71, 52, 59, 10], weight: tensor([0.1413, 0.1068, 0.1130, 0.0940, 0.1005, 0.0853, 0.0863, 0.0671, 0.1149,
        0.0908])
[rfa agg] iter:  0, prev_obj_val: 29.662181854248047, obj_val: 37.96452331542969, abs dis: 8.30234146118164
[rfa agg] iter: 0, weight: tensor([0.0413, 0.0830, 0.0666, 0.1509, 0.1145, 0.1442, 0.1590, 0.0401, 0.0520,
        0.1483])
[rfa agg] iter:  1, prev_obj_val: 37.96452331542969, obj_val: 41.482086181640625, abs dis: 3.5175628662109375
[rfa agg] iter: 1, weight: tensor([0.0457, 0.0744, 0.0639, 0.1195, 0.0914, 0.1709, 0.1811, 0.0836, 0.0532,
        0.1163])
[rfa agg] iter:  2, prev_obj_val: 41.482086181640625, obj_val: 31.786354064941406, abs dis: 9.695732116699219
[rfa agg] iter: 2, weight: tensor([0.0493, 0.0760, 0.0665, 0.1139, 0.0907, 0.1567, 0.1634, 0.1169, 0.0563,
        0.1103])
[rfa agg] iter:  3, prev_obj_val: 31.786354064941406, obj_val: 41.4918098449707, abs dis: 9.705455780029297
[rfa agg] iter: 3, weight: tensor([0.0387, 0.0718, 0.0590, 0.1336, 0.0945, 0.1787, 0.2006, 0.0467, 0.0471,
        0.1293])
[rfa agg] iter:  4, prev_obj_val: 41.4918098449707, obj_val: 31.78569221496582, abs dis: 9.706117630004883
[rfa agg] iter: 4, weight: tensor([0.0493, 0.0760, 0.0665, 0.1141, 0.0908, 0.1571, 0.1638, 0.1155, 0.0563,
        0.1106])
[rfa agg] iter:  5, prev_obj_val: 31.78569221496582, obj_val: 41.4918212890625, abs dis: 9.70612907409668
[rfa agg] iter: 5, weight: tensor([0.0387, 0.0718, 0.0590, 0.1336, 0.0945, 0.1787, 0.2006, 0.0467, 0.0471,
        0.1294])
[rfa agg] iter:  6, prev_obj_val: 41.4918212890625, obj_val: 31.785690307617188, abs dis: 9.706130981445312
[rfa agg] iter: 6, weight: tensor([0.0493, 0.0760, 0.0665, 0.1141, 0.0908, 0.1571, 0.1638, 0.1155, 0.0563,
        0.1106])
[rfa agg] iter:  7, prev_obj_val: 31.785690307617188, obj_val: 41.4918212890625, abs dis: 9.706130981445312
[rfa agg] iter: 7, weight: tensor([0.0387, 0.0718, 0.0590, 0.1336, 0.0945, 0.1787, 0.2006, 0.0467, 0.0471,
        0.1294])
[rfa agg] iter:  8, prev_obj_val: 41.4918212890625, obj_val: 31.785690307617188, abs dis: 9.706130981445312
[rfa agg] iter: 8, weight: tensor([0.0493, 0.0760, 0.0665, 0.1141, 0.0908, 0.1571, 0.1638, 0.1155, 0.0563,
        0.1106])
[rfa agg] iter:  9, prev_obj_val: 31.785690307617188, obj_val: 41.4918212890625, abs dis: 9.706130981445312
[rfa agg] iter: 9, weight: tensor([0.0387, 0.0718, 0.0590, 0.1336, 0.0945, 0.1787, 0.2006, 0.0467, 0.0471,
        0.1294])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 14.6565, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 15.6772, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.58422327041626 sec.
Server Epoch:21 choose agents : [0, 17, 26, 47, 78, 74, 75, 96, 65, 22].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0641, Accuracy: 335/1657 (20.2173%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0352, Accuracy: 590/1657 (35.6065%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0302, Accuracy: 732/1657 (44.1762%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0300, Accuracy: 744/1657 (44.9004%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0285, Accuracy: 780/1657 (47.0730%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0281, Accuracy: 803/1657 (48.4611%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0272, Accuracy: 798/1657 (48.1593%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0264, Accuracy: 833/1657 (50.2716%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0264, Accuracy: 828/1657 (49.9698%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0266, Accuracy: 824/1657 (49.7284%), train_poison_data_count: 520
Global model norm: 187.41511620264254.
Norm before scaling: 187.36300203415294. Distance: 1.3924251006852655
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8562, Accuracy: 57/10000 (0.5700%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.5806, Accuracy: 9540/9950 (95.8794%)
Scaling by  100
Scaled Norm after poisoning: 228.83543486531974, distance: 139.2425239240872
Total norm for 2 adversaries is: 228.83543486531974. distance: 139.2425239240872
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   1, Avg loss: 0.0588, Accuracy: 282/1574 (17.9161%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   2, Avg loss: 0.0300, Accuracy: 585/1574 (37.1665%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.9703, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0575, Accuracy: 289/1446 (19.9862%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0355, Accuracy: 495/1446 (34.2324%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.9117, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   1, Avg loss: 0.1319, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   2, Avg loss: 0.1194, Accuracy: 0/134 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.2568, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  21, local model 78, internal_epoch   1, Avg loss: 0.0787, Accuracy: 27/416 (6.4904%)
_Train Local_ResNet_18, epoch  21, local model 78, internal_epoch   2, Avg loss: 0.0464, Accuracy: 195/416 (46.8750%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7028, Accuracy: 74/10000 (0.7400%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   1, Avg loss: 0.0481, Accuracy: 439/1552 (28.2861%)
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   2, Avg loss: 0.0219, Accuracy: 753/1552 (48.5180%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 11.0629, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  21, local model 75, internal_epoch   1, Avg loss: 0.0681, Accuracy: 200/776 (25.7732%)
_Train Local_ResNet_18, epoch  21, local model 75, internal_epoch   2, Avg loss: 0.0316, Accuracy: 399/776 (51.4175%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.6327, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  21, local model 96, internal_epoch   1, Avg loss: 0.0847, Accuracy: 22/311 (7.0740%)
_Train Local_ResNet_18, epoch  21, local model 96, internal_epoch   2, Avg loss: 0.0600, Accuracy: 131/311 (42.1222%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.2849, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0595, Accuracy: 379/1475 (25.6949%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0334, Accuracy: 613/1475 (41.5593%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.9404, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   1, Avg loss: 0.0476, Accuracy: 470/1470 (31.9728%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   2, Avg loss: 0.0247, Accuracy: 828/1470 (56.3265%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.5702, Accuracy: 106/10000 (1.0600%)
time spent on training: 319.65259289741516
[rfa agg] training data poison_ratio: 0.29682730552215336  data num: [1657, 1574, 1446, 134, 416, 1552, 776, 311, 1475, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.09275853297567292
[rfa agg] init. name: [0, 17, 26, 47, 78, 74, 75, 96, 65, 22], weight: tensor([0.1533, 0.1456, 0.1338, 0.0124, 0.0385, 0.1436, 0.0718, 0.0288, 0.1364,
        0.1360])
[rfa agg] iter:  0, prev_obj_val: 30188.251953125, obj_val: 20381.845703125, abs dis: 9806.40625
[rfa agg] iter: 0, weight: tensor([0.0317, 0.1668, 0.1531, 0.0140, 0.0437, 0.1645, 0.0817, 0.0326, 0.1562,
        0.1556])
[rfa agg] iter:  1, prev_obj_val: 20381.845703125, obj_val: 18293.259765625, abs dis: 2088.5859375
[rfa agg] iter: 1, weight: tensor([0.0059, 0.1724, 0.1576, 0.0139, 0.0436, 0.1700, 0.0826, 0.0325, 0.1612,
        0.1603])
[rfa agg] iter:  2, prev_obj_val: 18293.259765625, obj_val: 17899.486328125, abs dis: 393.7734375
[rfa agg] iter: 2, weight: tensor([0.0010, 0.1796, 0.1605, 0.0116, 0.0378, 0.1771, 0.0757, 0.0276, 0.1660,
        0.1631])
[rfa agg] iter:  3, prev_obj_val: 17899.486328125, obj_val: 17861.6484375, abs dis: 37.837890625
[rfa agg] iter: 3, weight: tensor([1.2675e-04, 2.1843e-01, 1.5720e-01, 4.5231e-03, 1.6445e-02, 2.1367e-01,
        4.0399e-02, 1.1342e-02, 1.7823e-01, 1.5964e-01])
[rfa agg] iter:  4, prev_obj_val: 17861.6484375, obj_val: 17865.275390625, abs dis: 3.626953125
[rfa agg] iter: 4, weight: tensor([3.1918e-05, 1.6515e-01, 2.4460e-01, 1.6368e-03, 6.4533e-03, 1.5177e-01,
        1.9178e-02, 4.2629e-03, 1.7789e-01, 2.2903e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 12.2199, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 14.6167, Accuracy: 0/9950 (0.0000%)
saving model
Done in 434.5045051574707 sec.
Server Epoch:22 choose agents : [11, 22, 49, 18, 76, 2, 74, 8, 78, 54].
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   1, Avg loss: 0.0597, Accuracy: 256/712 (35.9551%)
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   2, Avg loss: 0.0269, Accuracy: 439/712 (61.6573%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.0342, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0466, Accuracy: 486/1470 (33.0612%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0251, Accuracy: 804/1470 (54.6939%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.6074, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   1, Avg loss: 0.0857, Accuracy: 5/440 (1.1364%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   2, Avg loss: 0.0511, Accuracy: 135/440 (30.6818%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.1832, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0868, Accuracy: 47/530 (8.8679%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0416, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.3005, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0960, Accuracy: 3/466 (0.6438%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0536, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.9238, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0716, Accuracy: 145/605 (23.9669%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0423, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.1548, Accuracy: 58/10000 (0.5800%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0468, Accuracy: 456/1552 (29.3814%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0215, Accuracy: 757/1552 (48.7758%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 11.5310, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0611, Accuracy: 235/1513 (15.5321%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0373, Accuracy: 459/1513 (30.3371%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.1378, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  22, local model 78, internal_epoch   1, Avg loss: 0.0807, Accuracy: 24/416 (5.7692%)
_Train Local_ResNet_18, epoch  22, local model 78, internal_epoch   2, Avg loss: 0.0460, Accuracy: 204/416 (49.0385%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.0257, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   1, Avg loss: 0.0660, Accuracy: 288/1130 (25.4867%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   2, Avg loss: 0.0306, Accuracy: 444/1130 (39.2920%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.9490, Accuracy: 51/10000 (0.5100%)
time spent on training: 161.0829496383667
[rfa agg] training data poison_ratio: 0.17568485397328504  data num: [712, 1470, 440, 530, 466, 605, 1552, 1513, 416, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.054901516866651574
[rfa agg] init. name: [11, 22, 49, 18, 76, 2, 74, 8, 78, 54], weight: tensor([0.0806, 0.1664, 0.0498, 0.0600, 0.0528, 0.0685, 0.1757, 0.1713, 0.0471,
        0.1279])
[rfa agg] iter:  0, prev_obj_val: 65.29771423339844, obj_val: 67.76041412353516, abs dis: 2.4626998901367188
[rfa agg] iter: 0, weight: tensor([0.1526, 0.1256, 0.0376, 0.0604, 0.0455, 0.0818, 0.1068, 0.1154, 0.0355,
        0.2386])
[rfa agg] iter:  1, prev_obj_val: 67.76041412353516, obj_val: 70.379150390625, abs dis: 2.6187362670898438
[rfa agg] iter: 1, weight: tensor([0.2094, 0.1092, 0.0417, 0.0701, 0.0514, 0.0983, 0.0947, 0.1014, 0.0394,
        0.1843])
[rfa agg] iter:  2, prev_obj_val: 70.379150390625, obj_val: 73.31288146972656, abs dis: 2.9337310791015625
[rfa agg] iter: 2, weight: tensor([0.2946, 0.0873, 0.0428, 0.0768, 0.0541, 0.1132, 0.0770, 0.0818, 0.0404,
        0.1319])
[rfa agg] iter:  3, prev_obj_val: 73.31288146972656, obj_val: 79.14189147949219, abs dis: 5.829010009765625
[rfa agg] iter: 3, weight: tensor([0.3795, 0.0648, 0.0415, 0.0815, 0.0543, 0.1300, 0.0581, 0.0612, 0.0390,
        0.0902])
[rfa agg] iter:  4, prev_obj_val: 79.14189147949219, obj_val: 83.76316833496094, abs dis: 4.62127685546875
[rfa agg] iter: 4, weight: tensor([0.2010, 0.0557, 0.0557, 0.1375, 0.0788, 0.2445, 0.0508, 0.0531, 0.0521,
        0.0708])
[rfa agg] iter:  5, prev_obj_val: 83.76316833496094, obj_val: 86.45426177978516, abs dis: 2.6910934448242188
[rfa agg] iter: 5, weight: tensor([0.1119, 0.0457, 0.0663, 0.2141, 0.1034, 0.2554, 0.0421, 0.0438, 0.0618,
        0.0555])
[rfa agg] iter:  6, prev_obj_val: 86.45426177978516, obj_val: 89.44285583496094, abs dis: 2.9885940551757812
[rfa agg] iter: 6, weight: tensor([0.0906, 0.0425, 0.0772, 0.2688, 0.1285, 0.1900, 0.0393, 0.0409, 0.0718,
        0.0505])
[rfa agg] iter:  7, prev_obj_val: 89.44285583496094, obj_val: 96.20380401611328, abs dis: 6.760948181152344
[rfa agg] iter: 7, weight: tensor([0.0803, 0.0418, 0.0973, 0.2496, 0.1690, 0.1440, 0.0389, 0.0403, 0.0898,
        0.0489])
[rfa agg] iter:  8, prev_obj_val: 96.20380401611328, obj_val: 89.45899200439453, abs dis: 6.74481201171875
[rfa agg] iter: 8, weight: tensor([0.0694, 0.0427, 0.1675, 0.1442, 0.1950, 0.1028, 0.0400, 0.0414, 0.1487,
        0.0483])
[rfa agg] iter:  9, prev_obj_val: 89.45899200439453, obj_val: 92.68125915527344, abs dis: 3.2222671508789062
[rfa agg] iter: 9, weight: tensor([0.0792, 0.0416, 0.1025, 0.2263, 0.1903, 0.1385, 0.0387, 0.0401, 0.0942,
        0.0486])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 15.1043, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 17.6627, Accuracy: 0/9950 (0.0000%)
saving model
Done in 274.47324442863464 sec.
Server Epoch:23 choose agents : [20, 9, 53, 97, 2, 88, 22, 77, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0640, Accuracy: 187/807 (23.1722%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0369, Accuracy: 335/807 (41.5118%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0288, Accuracy: 392/807 (48.5750%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0281, Accuracy: 427/807 (52.9120%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0259, Accuracy: 448/807 (55.5143%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0253, Accuracy: 454/807 (56.2577%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0247, Accuracy: 461/807 (57.1252%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0232, Accuracy: 490/807 (60.7187%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0235, Accuracy: 480/807 (59.4796%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0231, Accuracy: 485/807 (60.0991%), train_poison_data_count: 260
Global model norm: 193.3440808345319.
Norm before scaling: 193.32099682264212. Distance: 0.9193172533167977
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7472, Accuracy: 70/10000 (0.7000%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.9506, Accuracy: 7132/9950 (71.6784%)
Scaling by  100
Scaled Norm after poisoning: 211.79529289800092, distance: 91.93173205903933
Total norm for 1 adversaries is: 211.79529289800092. distance: 91.93173205903933
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0501, Accuracy: 348/1275 (27.2941%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 689/1275 (54.0392%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 11.5967, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   1, Avg loss: 0.0536, Accuracy: 232/813 (28.5363%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   2, Avg loss: 0.0193, Accuracy: 438/813 (53.8745%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 12.2965, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  23, local model 97, internal_epoch   1, Avg loss: 0.0591, Accuracy: 296/1213 (24.4023%)
_Train Local_ResNet_18, epoch  23, local model 97, internal_epoch   2, Avg loss: 0.0285, Accuracy: 486/1213 (40.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.3904, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0682, Accuracy: 169/605 (27.9339%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0416, Accuracy: 329/605 (54.3802%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.8023, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  23, local model 88, internal_epoch   1, Avg loss: 0.0868, Accuracy: 65/603 (10.7794%)
_Train Local_ResNet_18, epoch  23, local model 88, internal_epoch   2, Avg loss: 0.0487, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.0502, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   1, Avg loss: 0.0471, Accuracy: 487/1470 (33.1293%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   2, Avg loss: 0.0249, Accuracy: 779/1470 (52.9932%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.7309, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  23, local model 77, internal_epoch   1, Avg loss: 0.0565, Accuracy: 271/1340 (20.2239%)
_Train Local_ResNet_18, epoch  23, local model 77, internal_epoch   2, Avg loss: 0.0280, Accuracy: 568/1340 (42.3881%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.2562, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0752, Accuracy: 110/781 (14.0845%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0389, Accuracy: 212/781 (27.1447%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.3460, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0532, Accuracy: 347/1628 (21.3145%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 773/1628 (47.4816%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.2785, Accuracy: 118/10000 (1.1800%)
time spent on training: 254.37003183364868
[rfa agg] training data poison_ratio: 0.07660180351210251  data num: [807, 1275, 813, 1213, 605, 603, 1470, 1340, 781, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.023938063597532033
[rfa agg] init. name: [20, 9, 53, 97, 2, 88, 22, 77, 3, 5], weight: tensor([0.0766, 0.1210, 0.0772, 0.1151, 0.0574, 0.0572, 0.1395, 0.1272, 0.0741,
        0.1545])
[rfa agg] iter:  0, prev_obj_val: 8264.525390625, obj_val: 4804.4482421875, abs dis: 3460.0771484375
[rfa agg] iter: 0, weight: tensor([0.0068, 0.1304, 0.0820, 0.1238, 0.0607, 0.0605, 0.1513, 0.1373, 0.0788,
        0.1685])
[rfa agg] iter:  1, prev_obj_val: 4804.4482421875, obj_val: 4521.56201171875, abs dis: 282.88623046875
[rfa agg] iter: 1, weight: tensor([0.0005, 0.1320, 0.0720, 0.1226, 0.0504, 0.0503, 0.1641, 0.1421, 0.0692,
        0.1968])
[rfa agg] iter:  2, prev_obj_val: 4521.56201171875, obj_val: 4525.91943359375, abs dis: 4.357421875
[rfa agg] iter: 2, weight: tensor([3.9593e-05, 2.2561e-01, 3.3997e-02, 1.7066e-01, 1.8176e-02, 1.8177e-02,
        1.5332e-01, 2.5580e-01, 3.2758e-02, 9.1473e-02])
[rfa agg] iter:  3, prev_obj_val: 4525.91943359375, obj_val: 4529.447265625, abs dis: 3.52783203125
[rfa agg] iter: 3, weight: tensor([4.9782e-05, 2.0419e-01, 6.2772e-02, 2.5793e-01, 2.9794e-02, 2.9862e-02,
        1.1089e-01, 1.6382e-01, 6.0529e-02, 8.0162e-02])
[rfa agg] iter:  4, prev_obj_val: 4529.447265625, obj_val: 4531.37060546875, abs dis: 1.92333984375
[rfa agg] iter: 4, weight: tensor([5.7584e-05, 1.7672e-01, 8.8953e-02, 2.3232e-01, 3.9227e-02, 3.9350e-02,
        1.0846e-01, 1.4575e-01, 8.6284e-02, 8.2869e-02])
[rfa agg] iter:  5, prev_obj_val: 4531.37060546875, obj_val: 4537.48974609375, abs dis: 6.119140625
[rfa agg] iter: 5, weight: tensor([6.0891e-05, 1.6416e-01, 1.0616e-01, 2.0831e-01, 4.4563e-02, 4.4732e-02,
        1.0676e-01, 1.3882e-01, 1.0321e-01, 8.3221e-02])
[rfa agg] iter:  6, prev_obj_val: 4537.48974609375, obj_val: 4537.45849609375, abs dis: 0.03125
[rfa agg] iter: 6, weight: tensor([6.2817e-05, 1.2389e-01, 1.6985e-01, 1.4522e-01, 5.8676e-02, 5.9147e-02,
        9.0878e-02, 1.1009e-01, 1.6771e-01, 7.4488e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 13.7045, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 19.7728, Accuracy: 0/9950 (0.0000%)
saving model
Done in 370.41753697395325 sec.
Server Epoch:24 choose agents : [63, 83, 86, 84, 14, 68, 3, 11, 51, 71].
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   1, Avg loss: 0.0609, Accuracy: 231/888 (26.0135%)
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   2, Avg loss: 0.0265, Accuracy: 419/888 (47.1847%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 10.0531, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0608, Accuracy: 349/1953 (17.8699%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0346, Accuracy: 729/1953 (37.3272%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.2833, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  24, local model 86, internal_epoch   1, Avg loss: 0.0546, Accuracy: 353/1003 (35.1944%)
_Train Local_ResNet_18, epoch  24, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 409/1003 (40.7777%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.9055, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0618, Accuracy: 282/1190 (23.6975%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0335, Accuracy: 418/1190 (35.1261%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.2935, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0636, Accuracy: 190/1013 (18.7562%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0367, Accuracy: 340/1013 (33.5637%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.7101, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   1, Avg loss: 0.0699, Accuracy: 351/1163 (30.1806%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   2, Avg loss: 0.0394, Accuracy: 406/1163 (34.9097%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.4469, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0755, Accuracy: 124/781 (15.8771%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0382, Accuracy: 221/781 (28.2971%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.1658, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   1, Avg loss: 0.0598, Accuracy: 273/712 (38.3427%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 398/712 (55.8989%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 10.0039, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   1, Avg loss: 0.0704, Accuracy: 167/1049 (15.9199%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   2, Avg loss: 0.0317, Accuracy: 486/1049 (46.3298%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.6409, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   1, Avg loss: 0.0585, Accuracy: 150/818 (18.3374%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   2, Avg loss: 0.0302, Accuracy: 320/818 (39.1198%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 10.0916, Accuracy: 68/10000 (0.6800%)
time spent on training: 161.2998490333557
[rfa agg] training data poison_ratio: 0.0  data num: [888, 1953, 1003, 1190, 1013, 1163, 781, 712, 1049, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 83, 86, 84, 14, 68, 3, 11, 51, 71], weight: tensor([0.0840, 0.1848, 0.0949, 0.1126, 0.0958, 0.1100, 0.0739, 0.0674, 0.0992,
        0.0774])
[rfa agg] iter:  0, prev_obj_val: 44.16935729980469, obj_val: 48.63908004760742, abs dis: 4.469722747802734
[rfa agg] iter: 0, weight: tensor([0.0723, 0.0377, 0.1682, 0.1233, 0.1643, 0.1269, 0.0495, 0.0373, 0.1670,
        0.0534])
[rfa agg] iter:  1, prev_obj_val: 48.63908004760742, obj_val: 52.96206283569336, abs dis: 4.3229827880859375
[rfa agg] iter: 1, weight: tensor([0.1564, 0.0327, 0.1459, 0.0690, 0.1434, 0.0685, 0.0996, 0.0687, 0.0988,
        0.1171])
[rfa agg] iter:  2, prev_obj_val: 52.96206283569336, obj_val: 55.720211029052734, abs dis: 2.758148193359375
[rfa agg] iter: 2, weight: tensor([0.1725, 0.0303, 0.0991, 0.0563, 0.0985, 0.0558, 0.1385, 0.0955, 0.0739,
        0.1796])
[rfa agg] iter:  3, prev_obj_val: 55.720211029052734, obj_val: 62.549766540527344, abs dis: 6.829555511474609
[rfa agg] iter: 3, weight: tensor([0.1503, 0.0296, 0.0847, 0.0521, 0.0844, 0.0516, 0.1549, 0.1164, 0.0661,
        0.2100])
[rfa agg] iter:  4, prev_obj_val: 62.549766540527344, obj_val: 55.7259635925293, abs dis: 6.823802947998047
[rfa agg] iter: 4, weight: tensor([0.1219, 0.0335, 0.0784, 0.0540, 0.0785, 0.0533, 0.1522, 0.1769, 0.0650,
        0.1863])
[rfa agg] iter:  5, prev_obj_val: 55.7259635925293, obj_val: 62.54639434814453, abs dis: 6.820430755615234
[rfa agg] iter: 5, weight: tensor([0.1439, 0.0295, 0.0842, 0.0520, 0.0838, 0.0515, 0.1583, 0.1233, 0.0659,
        0.2076])
[rfa agg] iter:  6, prev_obj_val: 62.54639434814453, obj_val: 55.7265625, abs dis: 6.819831848144531
[rfa agg] iter: 6, weight: tensor([0.1215, 0.0335, 0.0783, 0.0539, 0.0784, 0.0532, 0.1524, 0.1782, 0.0650,
        0.1856])
[rfa agg] iter:  7, prev_obj_val: 55.7265625, obj_val: 62.546321868896484, abs dis: 6.819759368896484
[rfa agg] iter: 7, weight: tensor([0.1438, 0.0295, 0.0843, 0.0520, 0.0838, 0.0515, 0.1584, 0.1234, 0.0659,
        0.2074])
[rfa agg] iter:  8, prev_obj_val: 62.546321868896484, obj_val: 55.7265739440918, abs dis: 6.8197479248046875
[rfa agg] iter: 8, weight: tensor([0.1215, 0.0335, 0.0783, 0.0539, 0.0784, 0.0532, 0.1524, 0.1783, 0.0650,
        0.1856])
[rfa agg] iter:  9, prev_obj_val: 55.7265739440918, obj_val: 62.54631805419922, abs dis: 6.819744110107422
[rfa agg] iter: 9, weight: tensor([0.1438, 0.0295, 0.0843, 0.0520, 0.0838, 0.0515, 0.1584, 0.1234, 0.0659,
        0.2074])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 12.3594, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 16.9207, Accuracy: 0/9950 (0.0000%)
saving model
Done in 281.18910241127014 sec.
Server Epoch:25 choose agents : [74, 15, 70, 45, 27, 54, 89, 16, 97, 32].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0511, Accuracy: 386/1552 (24.8711%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0228, Accuracy: 775/1552 (49.9356%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Avg loss: 0.0192, Accuracy: 851/1552 (54.8325%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Avg loss: 0.0188, Accuracy: 905/1552 (58.3119%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Avg loss: 0.0182, Accuracy: 928/1552 (59.7938%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Avg loss: 0.0177, Accuracy: 955/1552 (61.5335%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Avg loss: 0.0175, Accuracy: 981/1552 (63.2088%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Avg loss: 0.0173, Accuracy: 980/1552 (63.1443%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Avg loss: 0.0167, Accuracy: 985/1552 (63.4665%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Avg loss: 0.0169, Accuracy: 1013/1552 (65.2706%), train_poison_data_count: 496
Global model norm: 199.10431272011664.
Norm before scaling: 199.05231528105872. Distance: 1.3963686168150153
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.2799, Accuracy: 92/10000 (0.9200%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.5166, Accuracy: 8645/9950 (86.8844%)
Scaling by  100
Scaled Norm after poisoning: 238.484767595333, distance: 139.63685463327724
Total norm for 1 adversaries is: 238.484767595333. distance: 139.63685463327724
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0710, Accuracy: 248/1154 (21.4905%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0332, Accuracy: 421/1154 (36.4818%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 12.0110, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   1, Avg loss: 0.0568, Accuracy: 306/1418 (21.5797%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   2, Avg loss: 0.0315, Accuracy: 627/1418 (44.2172%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.5789, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   1, Avg loss: 0.0832, Accuracy: 104/669 (15.5456%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   2, Avg loss: 0.0442, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.1374, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   1, Avg loss: 0.0565, Accuracy: 431/1587 (27.1582%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   2, Avg loss: 0.0342, Accuracy: 635/1587 (40.0126%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8106, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0669, Accuracy: 262/1130 (23.1858%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0304, Accuracy: 439/1130 (38.8496%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.1725, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  25, local model 89, internal_epoch   1, Avg loss: 0.0563, Accuracy: 317/896 (35.3795%)
_Train Local_ResNet_18, epoch  25, local model 89, internal_epoch   2, Avg loss: 0.0322, Accuracy: 458/896 (51.1161%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.1290, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0619, Accuracy: 246/708 (34.7458%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0363, Accuracy: 431/708 (60.8757%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7710, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  25, local model 97, internal_epoch   1, Avg loss: 0.0587, Accuracy: 280/1213 (23.0833%)
_Train Local_ResNet_18, epoch  25, local model 97, internal_epoch   2, Avg loss: 0.0285, Accuracy: 508/1213 (41.8796%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.2403, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0556, Accuracy: 217/735 (29.5238%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0234, Accuracy: 343/735 (46.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 11.5037, Accuracy: 59/10000 (0.5900%)
time spent on training: 282.0620183944702
[rfa agg] training data poison_ratio: 0.1403001265593925  data num: [1552, 1154, 1418, 669, 1587, 1130, 896, 708, 1213, 735]
[rfa agg] considering poison per batch poison_fraction: 0.04384378954981016
[rfa agg] init. name: [74, 15, 70, 45, 27, 54, 89, 16, 97, 32], weight: tensor([0.1403, 0.1043, 0.1282, 0.0605, 0.1435, 0.1022, 0.0810, 0.0640, 0.1097,
        0.0664])
[rfa agg] iter:  0, prev_obj_val: 26997.38671875, obj_val: 17780.66796875, abs dis: 9216.71875
[rfa agg] iter: 0, weight: tensor([0.0259, 0.1182, 0.1456, 0.0682, 0.1632, 0.1157, 0.0915, 0.0723, 0.1243,
        0.0750])
[rfa agg] iter:  1, prev_obj_val: 17780.66796875, obj_val: 16038.203125, abs dis: 1742.46484375
[rfa agg] iter: 1, weight: tensor([0.0043, 0.1210, 0.1506, 0.0685, 0.1696, 0.1182, 0.0925, 0.0727, 0.1272,
        0.0754])
[rfa agg] iter:  2, prev_obj_val: 16038.203125, obj_val: 15755.6259765625, abs dis: 282.5771484375
[rfa agg] iter: 2, weight: tensor([0.0007, 0.1217, 0.1624, 0.0608, 0.1901, 0.1169, 0.0860, 0.0655, 0.1279,
        0.0680])
[rfa agg] iter:  3, prev_obj_val: 15755.6259765625, obj_val: 15745.6640625, abs dis: 9.9619140625
[rfa agg] iter: 3, weight: tensor([5.3835e-05, 8.3955e-02, 2.5525e-01, 2.1322e-02, 3.8860e-01, 7.3175e-02,
        3.6602e-02, 2.4301e-02, 9.1448e-02, 2.5292e-02])
[rfa agg] iter:  4, prev_obj_val: 15745.6640625, obj_val: 15751.0537109375, abs dis: 5.3896484375
[rfa agg] iter: 4, weight: tensor([4.8357e-05, 1.7292e-01, 1.5971e-01, 2.8490e-02, 1.1963e-01, 1.6443e-01,
        5.6099e-02, 3.3563e-02, 2.3004e-01, 3.5055e-02])
[rfa agg] iter:  5, prev_obj_val: 15751.0537109375, obj_val: 15754.7509765625, abs dis: 3.697265625
[rfa agg] iter: 5, weight: tensor([5.1207e-05, 1.4539e-01, 8.6703e-02, 4.8296e-02, 7.5350e-02, 2.1984e-01,
        1.2615e-01, 6.0757e-02, 1.7356e-01, 6.3913e-02])
[rfa agg] iter:  6, prev_obj_val: 15754.7509765625, obj_val: 15754.7265625, abs dis: 0.0244140625
[rfa agg] iter: 6, weight: tensor([5.3716e-05, 1.2106e-01, 7.9235e-02, 6.1246e-02, 7.0944e-02, 1.7295e-01,
        1.9232e-01, 7.9714e-02, 1.3775e-01, 8.4715e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 11.8298, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 16.2116, Accuracy: 0/9950 (0.0000%)
saving model
Done in 394.04883098602295 sec.
Server Epoch:26 choose agents : [16, 3, 83, 49, 82, 57, 75, 76, 46, 55].
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   1, Avg loss: 0.0619, Accuracy: 248/708 (35.0282%)
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   2, Avg loss: 0.0371, Accuracy: 424/708 (59.8870%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.6656, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.0726, Accuracy: 133/781 (17.0294%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0377, Accuracy: 231/781 (29.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.4964, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  26, local model 83, internal_epoch   1, Avg loss: 0.0608, Accuracy: 349/1953 (17.8699%)
_Train Local_ResNet_18, epoch  26, local model 83, internal_epoch   2, Avg loss: 0.0347, Accuracy: 688/1953 (35.2279%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.1937, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0793, Accuracy: 19/440 (4.3182%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0468, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.5843, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0730, Accuracy: 58/500 (11.6000%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0473, Accuracy: 186/500 (37.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.3577, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   1, Avg loss: 0.0586, Accuracy: 282/1154 (24.4367%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   2, Avg loss: 0.0268, Accuracy: 450/1154 (38.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 11.9846, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   1, Avg loss: 0.0683, Accuracy: 186/776 (23.9691%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   2, Avg loss: 0.0301, Accuracy: 381/776 (49.0979%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.2717, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  26, local model 76, internal_epoch   1, Avg loss: 0.0900, Accuracy: 10/466 (2.1459%)
_Train Local_ResNet_18, epoch  26, local model 76, internal_epoch   2, Avg loss: 0.0486, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.9668, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   1, Avg loss: 0.0570, Accuracy: 394/1904 (20.6933%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   2, Avg loss: 0.0322, Accuracy: 638/1904 (33.5084%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.2592, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   1, Avg loss: 0.0540, Accuracy: 236/1071 (22.0355%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 494/1071 (46.1251%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.7450, Accuracy: 77/10000 (0.7700%)
time spent on training: 162.3802421092987
[rfa agg] training data poison_ratio: 0.0  data num: [708, 781, 1953, 440, 500, 1154, 776, 466, 1904, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 3, 83, 49, 82, 57, 75, 76, 46, 55], weight: tensor([0.0726, 0.0801, 0.2002, 0.0451, 0.0513, 0.1183, 0.0796, 0.0478, 0.1952,
        0.1098])
[rfa agg] iter:  0, prev_obj_val: 74.32193756103516, obj_val: 75.87104797363281, abs dis: 1.5491104125976562
[rfa agg] iter: 0, weight: tensor([0.0632, 0.0839, 0.0735, 0.0211, 0.0266, 0.2205, 0.0840, 0.0247, 0.0773,
        0.3252])
[rfa agg] iter:  1, prev_obj_val: 75.87104797363281, obj_val: 82.04148864746094, abs dis: 6.170440673828125
[rfa agg] iter: 1, weight: tensor([0.0796, 0.1113, 0.0629, 0.0232, 0.0298, 0.1573, 0.1121, 0.0277, 0.0657,
        0.3304])
[rfa agg] iter:  2, prev_obj_val: 82.04148864746094, obj_val: 83.50261688232422, abs dis: 1.4611282348632812
[rfa agg] iter: 2, weight: tensor([0.1440, 0.2129, 0.0493, 0.0288, 0.0387, 0.0872, 0.2228, 0.0360, 0.0510,
        0.1292])
[rfa agg] iter:  3, prev_obj_val: 83.50261688232422, obj_val: 88.00360107421875, abs dis: 4.500984191894531
[rfa agg] iter: 3, weight: tensor([0.1586, 0.2364, 0.0422, 0.0275, 0.0376, 0.0703, 0.2511, 0.0349, 0.0436,
        0.0980])
[rfa agg] iter:  4, prev_obj_val: 88.00360107421875, obj_val: 90.66888427734375, abs dis: 2.665283203125
[rfa agg] iter: 4, weight: tensor([0.2109, 0.2057, 0.0432, 0.0350, 0.0497, 0.0660, 0.2130, 0.0459, 0.0444,
        0.0863])
[rfa agg] iter:  5, prev_obj_val: 90.66888427734375, obj_val: 96.54707336425781, abs dis: 5.8781890869140625
[rfa agg] iter: 5, weight: tensor([0.2312, 0.1806, 0.0457, 0.0418, 0.0609, 0.0672, 0.1837, 0.0562, 0.0469,
        0.0858])
[rfa agg] iter:  6, prev_obj_val: 96.54707336425781, obj_val: 93.5399398803711, abs dis: 3.0071334838867188
[rfa agg] iter: 6, weight: tensor([0.1956, 0.1493, 0.0513, 0.0612, 0.0951, 0.0708, 0.1500, 0.0872, 0.0526,
        0.0867])
[rfa agg] iter:  7, prev_obj_val: 93.5399398803711, obj_val: 85.60479736328125, abs dis: 7.935142517089844
[rfa agg] iter: 7, weight: tensor([0.2180, 0.1622, 0.0489, 0.0514, 0.0774, 0.0697, 0.1639, 0.0713, 0.0502,
        0.0869])
[rfa agg] iter:  8, prev_obj_val: 85.60479736328125, obj_val: 90.67428588867188, abs dis: 5.069488525390625
[rfa agg] iter: 8, weight: tensor([0.2071, 0.2152, 0.0419, 0.0306, 0.0426, 0.0666, 0.2238, 0.0395, 0.0432,
        0.0896])
[rfa agg] iter:  9, prev_obj_val: 90.67428588867188, obj_val: 96.54713439941406, abs dis: 5.8728485107421875
[rfa agg] iter: 9, weight: tensor([0.2292, 0.1815, 0.0457, 0.0418, 0.0608, 0.0673, 0.1847, 0.0561, 0.0470,
        0.0859])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 13.0416, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 17.2440, Accuracy: 0/9950 (0.0000%)
saving model
Done in 280.7501049041748 sec.
Server Epoch:27 choose agents : [95, 43, 81, 8, 51, 86, 26, 14, 98, 20].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0613, Accuracy: 174/599 (29.0484%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0266, Accuracy: 328/599 (54.7579%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Avg loss: 0.0234, Accuracy: 362/599 (60.4341%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Avg loss: 0.0243, Accuracy: 357/599 (59.5993%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Avg loss: 0.0236, Accuracy: 399/599 (66.6110%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Avg loss: 0.0245, Accuracy: 382/599 (63.7730%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Avg loss: 0.0208, Accuracy: 409/599 (68.2805%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Avg loss: 0.0203, Accuracy: 401/599 (66.9449%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Avg loss: 0.0221, Accuracy: 400/599 (66.7780%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Avg loss: 0.0212, Accuracy: 418/599 (69.7830%), train_poison_data_count: 200
Global model norm: 204.68417936237768.
Norm before scaling: 204.66677375981183. Distance: 0.7979293654570927
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.7411, Accuracy: 56/10000 (0.5600%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.6088, Accuracy: 6776/9950 (68.1005%)
Scaling by  100
Scaled Norm after poisoning: 217.91243224056768, distance: 79.79293270318493
Total norm for 2 adversaries is: 217.91243224056768. distance: 79.79293270318493
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   1, Avg loss: 0.0626, Accuracy: 257/946 (27.1670%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   2, Avg loss: 0.0376, Accuracy: 350/946 (36.9979%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9892, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  27, local model 81, internal_epoch   1, Avg loss: 0.0734, Accuracy: 189/774 (24.4186%)
_Train Local_ResNet_18, epoch  27, local model 81, internal_epoch   2, Avg loss: 0.0438, Accuracy: 289/774 (37.3385%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.5760, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0627, Accuracy: 211/1513 (13.9458%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0385, Accuracy: 427/1513 (28.2221%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.1736, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0672, Accuracy: 174/1049 (16.5872%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 489/1049 (46.6158%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.0023, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  27, local model 86, internal_epoch   1, Avg loss: 0.0580, Accuracy: 341/1003 (33.9980%)
_Train Local_ResNet_18, epoch  27, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 413/1003 (41.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.2377, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   1, Avg loss: 0.0564, Accuracy: 291/1446 (20.1245%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   2, Avg loss: 0.0357, Accuracy: 470/1446 (32.5035%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9847, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   1, Avg loss: 0.0633, Accuracy: 187/1013 (18.4600%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   2, Avg loss: 0.0372, Accuracy: 322/1013 (31.7868%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.1941, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0879, Accuracy: 4/373 (1.0724%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0510, Accuracy: 139/373 (37.2654%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0560, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  27, local model 20, internal_epoch   1, Avg loss: 0.0610, Accuracy: 271/807 (33.5812%)
_Train Local_ResNet_18, epoch  27, local model 20, internal_epoch   2, Avg loss: 0.0328, Accuracy: 409/807 (50.6815%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9688, Accuracy: 78/10000 (0.7800%)
time spent on training: 265.06076550483704
[rfa agg] training data poison_ratio: 0.1476425496167174  data num: [599, 946, 774, 1513, 1049, 1003, 1446, 1013, 373, 807]
[rfa agg] considering poison per batch poison_fraction: 0.04613829675522419
[rfa agg] init. name: [95, 43, 81, 8, 51, 86, 26, 14, 98, 20], weight: tensor([0.0629, 0.0993, 0.0813, 0.1589, 0.1102, 0.1053, 0.1518, 0.1064, 0.0392,
        0.0847])
[rfa agg] iter:  0, prev_obj_val: 5329.05615234375, obj_val: 3013.549072265625, abs dis: 2315.507080078125
[rfa agg] iter: 0, weight: tensor([0.0044, 0.1047, 0.0851, 0.1722, 0.1168, 0.1113, 0.1641, 0.1124, 0.0401,
        0.0887])
[rfa agg] iter:  1, prev_obj_val: 3013.549072265625, obj_val: 2890.770751953125, abs dis: 122.7783203125
[rfa agg] iter: 1, weight: tensor([0.0003, 0.0895, 0.0674, 0.2325, 0.1085, 0.0993, 0.2069, 0.1002, 0.0252,
        0.0702])
[rfa agg] iter:  2, prev_obj_val: 2890.770751953125, obj_val: 2895.369384765625, abs dis: 4.5986328125
[rfa agg] iter: 2, weight: tensor([4.5032e-05, 1.1830e-01, 6.1775e-02, 8.6664e-02, 2.0019e-01, 1.8167e-01,
        9.4522e-02, 1.8156e-01, 1.1997e-02, 6.3278e-02])
[rfa agg] iter:  3, prev_obj_val: 2895.369384765625, obj_val: 2897.59033203125, abs dis: 2.220947265625
[rfa agg] iter: 3, weight: tensor([3.9327e-05, 1.8685e-01, 1.2223e-01, 5.2204e-02, 1.1573e-01, 1.6724e-01,
        5.4822e-02, 1.6901e-01, 1.3965e-02, 1.1790e-01])
[rfa agg] iter:  4, prev_obj_val: 2897.59033203125, obj_val: 2900.2197265625, abs dis: 2.62939453125
[rfa agg] iter: 4, weight: tensor([4.0450e-05, 1.8459e-01, 1.5875e-01, 5.1033e-02, 1.0193e-01, 1.4295e-01,
        5.3267e-02, 1.4517e-01, 1.5234e-02, 1.4704e-01])
[rfa agg] iter:  5, prev_obj_val: 2900.2197265625, obj_val: 2900.20458984375, abs dis: 0.01513671875
[rfa agg] iter: 5, weight: tensor([4.1706e-05, 1.6057e-01, 1.9949e-01, 5.0185e-02, 9.3347e-02, 1.2419e-01,
        5.2180e-02, 1.2601e-01, 1.6665e-02, 1.7732e-01])
[rfa agg] iter:  6, prev_obj_val: 2900.20458984375, obj_val: 2903.157470703125, abs dis: 2.952880859375
[rfa agg] iter: 6, weight: tensor([4.1195e-05, 1.5625e-01, 2.0636e-01, 4.9560e-02, 9.2057e-02, 1.2191e-01,
        5.1518e-02, 1.2372e-01, 1.6471e-02, 1.8212e-01])
[rfa agg] iter:  7, prev_obj_val: 2903.157470703125, obj_val: 2900.208740234375, abs dis: 2.94873046875
[rfa agg] iter: 7, weight: tensor([4.2888e-05, 1.3762e-01, 2.3459e-01, 4.9319e-02, 8.6160e-02, 1.0984e-01,
        5.1104e-02, 1.1135e-01, 1.8242e-02, 2.0173e-01])
[rfa agg] iter:  8, prev_obj_val: 2900.208740234375, obj_val: 2903.155517578125, abs dis: 2.94677734375
[rfa agg] iter: 8, weight: tensor([4.0789e-05, 1.5235e-01, 2.1246e-01, 4.9062e-02, 9.0986e-02, 1.2003e-01,
        5.0990e-02, 1.2183e-01, 1.6316e-02, 1.8594e-01])
[rfa agg] iter:  9, prev_obj_val: 2903.155517578125, obj_val: 2900.209228515625, abs dis: 2.9462890625
[rfa agg] iter: 9, weight: tensor([4.2779e-05, 1.3701e-01, 2.3587e-01, 4.9191e-02, 8.5921e-02, 1.0950e-01,
        5.0969e-02, 1.1100e-01, 1.8197e-02, 2.0231e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 17.3271, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 20.8982, Accuracy: 0/9950 (0.0000%)
saving model
Done in 382.11820101737976 sec.
Server Epoch:28 choose agents : [43, 16, 55, 21, 94, 68, 49, 93, 87, 78].
_Train Local_ResNet_18, epoch  28, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 283/946 (29.9154%)
_Train Local_ResNet_18, epoch  28, local model 43, internal_epoch   2, Avg loss: 0.0380, Accuracy: 339/946 (35.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9857, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  28, local model 16, internal_epoch   1, Avg loss: 0.0639, Accuracy: 242/708 (34.1808%)
_Train Local_ResNet_18, epoch  28, local model 16, internal_epoch   2, Avg loss: 0.0375, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.1135, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   1, Avg loss: 0.0557, Accuracy: 225/1071 (21.0084%)
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   2, Avg loss: 0.0303, Accuracy: 455/1071 (42.4837%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.7584, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   1, Avg loss: 0.0545, Accuracy: 344/1949 (17.6501%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   2, Avg loss: 0.0340, Accuracy: 600/1949 (30.7850%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.2903, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  28, local model 94, internal_epoch   1, Avg loss: 0.0596, Accuracy: 262/1662 (15.7641%)
_Train Local_ResNet_18, epoch  28, local model 94, internal_epoch   2, Avg loss: 0.0352, Accuracy: 532/1662 (32.0096%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.6784, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   1, Avg loss: 0.0671, Accuracy: 334/1163 (28.7188%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   2, Avg loss: 0.0396, Accuracy: 438/1163 (37.6612%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.5430, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   1, Avg loss: 0.0817, Accuracy: 9/440 (2.0455%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   2, Avg loss: 0.0483, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.4430, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   1, Avg loss: 0.0587, Accuracy: 371/1742 (21.2974%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   2, Avg loss: 0.0323, Accuracy: 680/1742 (39.0356%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.3656, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  28, local model 87, internal_epoch   1, Avg loss: 0.0581, Accuracy: 243/1131 (21.4854%)
_Train Local_ResNet_18, epoch  28, local model 87, internal_epoch   2, Avg loss: 0.0329, Accuracy: 406/1131 (35.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.3031, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  28, local model 78, internal_epoch   1, Avg loss: 0.0841, Accuracy: 25/416 (6.0096%)
_Train Local_ResNet_18, epoch  28, local model 78, internal_epoch   2, Avg loss: 0.0491, Accuracy: 192/416 (46.1538%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.3181, Accuracy: 72/10000 (0.7200%)
time spent on training: 182.172429561615
[rfa agg] training data poison_ratio: 0.0  data num: [946, 708, 1071, 1949, 1662, 1163, 440, 1742, 1131, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 16, 55, 21, 94, 68, 49, 93, 87, 78], weight: tensor([0.0843, 0.0631, 0.0954, 0.1736, 0.1480, 0.1036, 0.0392, 0.1551, 0.1007,
        0.0371])
[rfa agg] iter:  0, prev_obj_val: 63.28092575073242, obj_val: 66.9942855834961, abs dis: 3.713359832763672
[rfa agg] iter: 0, weight: tensor([0.0931, 0.0393, 0.1769, 0.0575, 0.0804, 0.2426, 0.0140, 0.0670, 0.2158,
        0.0133])
[rfa agg] iter:  1, prev_obj_val: 66.9942855834961, obj_val: 65.32901763916016, abs dis: 1.6652679443359375
[rfa agg] iter: 1, weight: tensor([0.1394, 0.0477, 0.2386, 0.0493, 0.0646, 0.1681, 0.0154, 0.0557, 0.2067,
        0.0146])
[rfa agg] iter:  2, prev_obj_val: 65.32901763916016, obj_val: 66.94684600830078, abs dis: 1.617828369140625
[rfa agg] iter: 2, weight: tensor([0.1161, 0.0424, 0.2408, 0.0493, 0.0658, 0.1830, 0.0142, 0.0562, 0.2188,
        0.0134])
[rfa agg] iter:  3, prev_obj_val: 66.94684600830078, obj_val: 66.94007110595703, abs dis: 0.00677490234375
[rfa agg] iter: 3, weight: tensor([0.1382, 0.0469, 0.2564, 0.0484, 0.0634, 0.1602, 0.0151, 0.0547, 0.2023,
        0.0143])
[rfa agg] iter:  4, prev_obj_val: 66.94007110595703, obj_val: 68.84542846679688, abs dis: 1.9053573608398438
[rfa agg] iter: 4, weight: tensor([0.1387, 0.0467, 0.2640, 0.0481, 0.0630, 0.1579, 0.0150, 0.0544, 0.1979,
        0.0142])
[rfa agg] iter:  5, prev_obj_val: 68.84542846679688, obj_val: 68.8399658203125, abs dis: 0.005462646484375
[rfa agg] iter: 5, weight: tensor([0.1723, 0.0530, 0.2602, 0.0481, 0.0619, 0.1410, 0.0163, 0.0539, 0.1779,
        0.0155])
[rfa agg] iter:  6, prev_obj_val: 68.8399658203125, obj_val: 68.83988189697266, abs dis: 8.392333984375e-05
[rfa agg] iter: 6, weight: tensor([0.1749, 0.0529, 0.2620, 0.0479, 0.0617, 0.1400, 0.0163, 0.0537, 0.1751,
        0.0154])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 16.3174, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 21.2293, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.5307378768921 sec.
Server Epoch:29 choose agents : [7, 85, 95, 12, 59, 54, 89, 98, 63, 66].
_Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   1, Avg loss: 0.0542, Accuracy: 294/891 (32.9966%)
_Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 442/891 (49.6072%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.9175, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  29, local model 85, internal_epoch   1, Avg loss: 0.0522, Accuracy: 435/1988 (21.8813%)
_Train Local_ResNet_18, epoch  29, local model 85, internal_epoch   2, Avg loss: 0.0362, Accuracy: 623/1988 (31.3380%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.3645, Accuracy: 77/10000 (0.7700%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0508, Accuracy: 295/599 (49.2487%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0303, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.0212, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   1, Avg loss: 0.1055, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   2, Avg loss: 0.0602, Accuracy: 102/338 (30.1775%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.8840, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   1, Avg loss: 0.0517, Accuracy: 299/1089 (27.4564%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   2, Avg loss: 0.0303, Accuracy: 438/1089 (40.2204%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.2708, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0653, Accuracy: 270/1130 (23.8938%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0311, Accuracy: 414/1130 (36.6372%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.1509, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   1, Avg loss: 0.0563, Accuracy: 321/896 (35.8259%)
_Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   2, Avg loss: 0.0318, Accuracy: 438/896 (48.8839%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.3393, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   1, Avg loss: 0.0902, Accuracy: 3/373 (0.8043%)
_Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   2, Avg loss: 0.0521, Accuracy: 137/373 (36.7292%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.0802, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0661, Accuracy: 182/888 (20.4955%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0278, Accuracy: 405/888 (45.6081%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 11.2904, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   1, Avg loss: 0.0665, Accuracy: 222/1402 (15.8345%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   2, Avg loss: 0.0400, Accuracy: 378/1402 (26.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.8601, Accuracy: 79/10000 (0.7900%)
time spent on training: 182.67759656906128
[rfa agg] training data poison_ratio: 0.06243485511778195  data num: [891, 1988, 599, 338, 1089, 1130, 896, 373, 888, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.01951089222430686
[rfa agg] init. name: [7, 85, 95, 12, 59, 54, 89, 98, 63, 66], weight: tensor([0.0929, 0.2072, 0.0624, 0.0352, 0.1135, 0.1178, 0.0934, 0.0389, 0.0926,
        0.1461])
[rfa agg] iter:  0, prev_obj_val: 60.38434600830078, obj_val: 62.002140045166016, abs dis: 1.6177940368652344
[rfa agg] iter: 0, weight: tensor([0.1113, 0.0576, 0.0367, 0.0132, 0.1554, 0.2654, 0.1169, 0.0145, 0.1143,
        0.1146])
[rfa agg] iter:  1, prev_obj_val: 62.002140045166016, obj_val: 65.87714385986328, abs dis: 3.8750038146972656
[rfa agg] iter: 1, weight: tensor([0.1584, 0.0498, 0.0438, 0.0144, 0.1232, 0.1686, 0.1751, 0.0158, 0.1643,
        0.0865])
[rfa agg] iter:  2, prev_obj_val: 65.87714385986328, obj_val: 70.37339782714844, abs dis: 4.496253967285156
[rfa agg] iter: 2, weight: tensor([0.1940, 0.0402, 0.0514, 0.0148, 0.0816, 0.0981, 0.2333, 0.0163, 0.2076,
        0.0626])
[rfa agg] iter:  3, prev_obj_val: 70.37339782714844, obj_val: 70.36991119384766, abs dis: 0.00348663330078125
[rfa agg] iter: 3, weight: tensor([0.1929, 0.0425, 0.0728, 0.0187, 0.0765, 0.0886, 0.2220, 0.0205, 0.2033,
        0.0623])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 16.2890, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 20.0622, Accuracy: 0/9950 (0.0000%)
saving model
Done in 298.9042820930481 sec.
Server Epoch:30 choose agents : [61, 58, 70, 49, 93, 67, 44, 24, 1, 14].
_Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   1, Avg loss: 0.1519, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   2, Avg loss: 0.1414, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.1666, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   1, Avg loss: 0.0608, Accuracy: 260/803 (32.3786%)
_Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   2, Avg loss: 0.0348, Accuracy: 408/803 (50.8095%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.2662, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   1, Avg loss: 0.0582, Accuracy: 323/1418 (22.7786%)
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   2, Avg loss: 0.0324, Accuracy: 555/1418 (39.1396%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.7796, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   1, Avg loss: 0.0816, Accuracy: 18/440 (4.0909%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   2, Avg loss: 0.0487, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8749, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  30, local model 93, internal_epoch   1, Avg loss: 0.0589, Accuracy: 400/1742 (22.9621%)
_Train Local_ResNet_18, epoch  30, local model 93, internal_epoch   2, Avg loss: 0.0326, Accuracy: 684/1742 (39.2652%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.3023, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   1, Avg loss: 0.0867, Accuracy: 7/426 (1.6432%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   2, Avg loss: 0.0458, Accuracy: 169/426 (39.6714%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.9930, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   1, Avg loss: 0.0620, Accuracy: 320/1750 (18.2857%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   2, Avg loss: 0.0366, Accuracy: 609/1750 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.9166, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 8/312 (2.5641%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 148/312 (47.4359%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.2995, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0603, Accuracy: 257/928 (27.6940%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0256, Accuracy: 544/928 (58.6207%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.5805, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   1, Avg loss: 0.0609, Accuracy: 184/1013 (18.1639%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   2, Avg loss: 0.0368, Accuracy: 338/1013 (33.3662%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.4775, Accuracy: 71/10000 (0.7100%)
time spent on training: 170.40507125854492
[rfa agg] training data poison_ratio: 0.0  data num: [85, 803, 1418, 440, 1742, 426, 1750, 312, 928, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 58, 70, 49, 93, 67, 44, 24, 1, 14], weight: tensor([0.0095, 0.0901, 0.1590, 0.0493, 0.1954, 0.0478, 0.1963, 0.0350, 0.1041,
        0.1136])
[rfa agg] iter:  0, prev_obj_val: 69.44436645507812, obj_val: 71.7175521850586, abs dis: 2.2731857299804688
[rfa agg] iter: 0, weight: tensor([0.0032, 0.1060, 0.1486, 0.0256, 0.1014, 0.0248, 0.1019, 0.0151, 0.1916,
        0.2820])
[rfa agg] iter:  1, prev_obj_val: 71.7175521850586, obj_val: 74.61604309082031, abs dis: 2.8984909057617188
[rfa agg] iter: 1, weight: tensor([0.0026, 0.1136, 0.0903, 0.0222, 0.0667, 0.0215, 0.0670, 0.0127, 0.2404,
        0.3628])
[rfa agg] iter:  2, prev_obj_val: 74.61604309082031, obj_val: 76.51175689697266, abs dis: 1.8957138061523438
[rfa agg] iter: 2, weight: tensor([0.0027, 0.1486, 0.0768, 0.0240, 0.0595, 0.0232, 0.0598, 0.0135, 0.2919,
        0.3000])
[rfa agg] iter:  3, prev_obj_val: 76.51175689697266, obj_val: 76.497802734375, abs dis: 0.01395416259765625
[rfa agg] iter: 3, weight: tensor([0.0029, 0.1866, 0.0754, 0.0265, 0.0597, 0.0257, 0.0599, 0.0147, 0.3064,
        0.2423])
[rfa agg] iter:  4, prev_obj_val: 76.497802734375, obj_val: 76.49744415283203, abs dis: 0.00035858154296875
[rfa agg] iter: 4, weight: tensor([0.0029, 0.1897, 0.0752, 0.0265, 0.0595, 0.0256, 0.0598, 0.0146, 0.3123,
        0.2340])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 17.9382, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 20.2864, Accuracy: 0/9950 (0.0000%)
saving model
Done in 282.4068248271942 sec.
Server Epoch:31 choose agents : [67, 91, 74, 70, 30, 32, 97, 1, 61, 22].
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0831, Accuracy: 3/426 (0.7042%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0410, Accuracy: 182/426 (42.7230%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.4879, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  31, local model 91, internal_epoch   1, Avg loss: 0.0649, Accuracy: 228/1030 (22.1359%)
_Train Local_ResNet_18, epoch  31, local model 91, internal_epoch   2, Avg loss: 0.0277, Accuracy: 578/1030 (56.1165%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.6970, Accuracy: 90/10000 (0.9000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   1, Avg loss: 0.0473, Accuracy: 448/1552 (28.8660%)
_Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   2, Avg loss: 0.0223, Accuracy: 722/1552 (46.5206%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 11.9847, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   1, Avg loss: 0.0594, Accuracy: 305/1418 (21.5092%)
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   2, Avg loss: 0.0325, Accuracy: 567/1418 (39.9859%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.0612, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0827, Accuracy: 23/486 (4.7325%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0420, Accuracy: 217/486 (44.6502%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.3202, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0496, Accuracy: 196/735 (26.6667%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 341/735 (46.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 11.9416, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0601, Accuracy: 295/1213 (24.3199%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0286, Accuracy: 492/1213 (40.5606%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.7383, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0558, Accuracy: 288/928 (31.0345%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 539/928 (58.0819%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.3930, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   1, Avg loss: 0.1528, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   2, Avg loss: 0.1420, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.7198, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   1, Avg loss: 0.0479, Accuracy: 460/1470 (31.2925%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   2, Avg loss: 0.0252, Accuracy: 778/1470 (52.9252%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.4851, Accuracy: 101/10000 (1.0100%)
time spent on training: 179.12220931053162
[rfa agg] training data poison_ratio: 0.16611366798672803  data num: [426, 1030, 1552, 1418, 486, 735, 1213, 928, 85, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.051910521245852506
[rfa agg] init. name: [67, 91, 74, 70, 30, 32, 97, 1, 61, 22], weight: tensor([0.0456, 0.1102, 0.1661, 0.1518, 0.0520, 0.0787, 0.1298, 0.0993, 0.0091,
        0.1573])
[rfa agg] iter:  0, prev_obj_val: 55.88166046142578, obj_val: 55.65609359741211, abs dis: 0.22556686401367188
[rfa agg] iter: 0, weight: tensor([0.0241, 0.2064, 0.0794, 0.0911, 0.0312, 0.0952, 0.1498, 0.2262, 0.0029,
        0.0937])
[rfa agg] iter:  1, prev_obj_val: 55.65609359741211, obj_val: 55.652217864990234, abs dis: 0.003875732421875
[rfa agg] iter: 1, weight: tensor([0.0229, 0.2111, 0.0751, 0.0863, 0.0296, 0.0903, 0.1432, 0.2503, 0.0027,
        0.0884])
[rfa agg] iter:  2, prev_obj_val: 55.652217864990234, obj_val: 55.652042388916016, abs dis: 0.00017547607421875
[rfa agg] iter: 2, weight: tensor([0.0227, 0.2101, 0.0745, 0.0856, 0.0294, 0.0896, 0.1418, 0.2557, 0.0027,
        0.0878])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 13.3303, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 13.9395, Accuracy: 0/9950 (0.0000%)
saving model
Done in 291.2698838710785 sec.
Server Epoch:32 choose agents : [20, 68, 99, 31, 27, 46, 19, 95, 86, 9].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   1, Avg loss: 0.0612, Accuracy: 265/807 (32.8377%)
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   2, Avg loss: 0.0328, Accuracy: 410/807 (50.8055%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.7497, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   1, Avg loss: 0.0645, Accuracy: 332/1163 (28.5469%)
_Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   2, Avg loss: 0.0394, Accuracy: 441/1163 (37.9192%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.8410, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 99, internal_epoch   1, Avg loss: 0.0816, Accuracy: 135/773 (17.4644%)
_Train Local_ResNet_18, epoch  32, local model 99, internal_epoch   2, Avg loss: 0.0363, Accuracy: 419/773 (54.2044%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.9123, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   1, Avg loss: 0.0931, Accuracy: 8/460 (1.7391%)
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   2, Avg loss: 0.0430, Accuracy: 182/460 (39.5652%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.4643, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   1, Avg loss: 0.0611, Accuracy: 337/1587 (21.2350%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   2, Avg loss: 0.0353, Accuracy: 569/1587 (35.8538%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.2553, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0572, Accuracy: 352/1904 (18.4874%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0324, Accuracy: 647/1904 (33.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.2439, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0589, Accuracy: 338/1036 (32.6255%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0257, Accuracy: 602/1036 (58.1081%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 12.8172, Accuracy: 73/10000 (0.7300%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0525, Accuracy: 272/599 (45.4090%)
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 13.5670, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 86, internal_epoch   1, Avg loss: 0.0554, Accuracy: 388/1003 (38.6839%)
_Train Local_ResNet_18, epoch  32, local model 86, internal_epoch   2, Avg loss: 0.0335, Accuracy: 429/1003 (42.7717%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.1541, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   1, Avg loss: 0.0494, Accuracy: 353/1275 (27.6863%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   2, Avg loss: 0.0200, Accuracy: 664/1275 (52.0784%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 11.3512, Accuracy: 111/10000 (1.1100%)
time spent on training: 197.49219346046448
[rfa agg] training data poison_ratio: 0.13255397379089282  data num: [807, 1163, 773, 460, 1587, 1904, 1036, 599, 1003, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.041423116809654006
[rfa agg] init. name: [20, 68, 99, 31, 27, 46, 19, 95, 86, 9], weight: tensor([0.0761, 0.1096, 0.0729, 0.0434, 0.1496, 0.1795, 0.0977, 0.0565, 0.0946,
        0.1202])
[rfa agg] iter:  0, prev_obj_val: 54.77295684814453, obj_val: 60.672332763671875, abs dis: 5.899375915527344
[rfa agg] iter: 0, weight: tensor([0.0679, 0.1565, 0.0658, 0.0184, 0.0713, 0.0533, 0.1883, 0.0306, 0.2142,
        0.1337])
[rfa agg] iter:  1, prev_obj_val: 60.672332763671875, obj_val: 65.06903839111328, abs dis: 4.396705627441406
[rfa agg] iter: 1, weight: tensor([0.1171, 0.1024, 0.1140, 0.0243, 0.0598, 0.0482, 0.1475, 0.0434, 0.2513,
        0.0920])
[rfa agg] iter:  2, prev_obj_val: 65.06903839111328, obj_val: 65.03054809570312, abs dis: 0.03849029541015625
[rfa agg] iter: 2, weight: tensor([0.1724, 0.0885, 0.1689, 0.0296, 0.0575, 0.0477, 0.1189, 0.0560, 0.1787,
        0.0819])
[rfa agg] iter:  3, prev_obj_val: 65.03054809570312, obj_val: 67.48905944824219, abs dis: 2.4585113525390625
[rfa agg] iter: 3, weight: tensor([0.1793, 0.0872, 0.1751, 0.0293, 0.0568, 0.0471, 0.1163, 0.0555, 0.1725,
        0.0809])
[rfa agg] iter:  4, prev_obj_val: 67.48905944824219, obj_val: 67.48086547851562, abs dis: 0.0081939697265625
[rfa agg] iter: 4, weight: tensor([0.2048, 0.0797, 0.2010, 0.0315, 0.0541, 0.0454, 0.1031, 0.0618, 0.1439,
        0.0747])
[rfa agg] iter:  5, prev_obj_val: 67.48086547851562, obj_val: 70.16381072998047, abs dis: 2.6829452514648438
[rfa agg] iter: 5, weight: tensor([0.2087, 0.0788, 0.2044, 0.0312, 0.0536, 0.0450, 0.1017, 0.0613, 0.1414,
        0.0739])
[rfa agg] iter:  6, prev_obj_val: 70.16381072998047, obj_val: 73.10736083984375, abs dis: 2.9435501098632812
[rfa agg] iter: 6, weight: tensor([0.2235, 0.0733, 0.2193, 0.0342, 0.0517, 0.0440, 0.0922, 0.0698, 0.1224,
        0.0695])
[rfa agg] iter:  7, prev_obj_val: 73.10736083984375, obj_val: 76.28410339355469, abs dis: 3.1767425537109375
[rfa agg] iter: 7, weight: tensor([0.2242, 0.0711, 0.2187, 0.0392, 0.0519, 0.0446, 0.0872, 0.0837, 0.1114,
        0.0680])
[rfa agg] iter:  8, prev_obj_val: 76.28410339355469, obj_val: 73.1087646484375, abs dis: 3.1753387451171875
[rfa agg] iter: 8, weight: tensor([0.2101, 0.0717, 0.2032, 0.0469, 0.0540, 0.0469, 0.0860, 0.1055, 0.1067,
        0.0692])
[rfa agg] iter:  9, prev_obj_val: 73.1087646484375, obj_val: 76.28369903564453, abs dis: 3.1749343872070312
[rfa agg] iter: 9, weight: tensor([0.2238, 0.0713, 0.2160, 0.0395, 0.0521, 0.0448, 0.0874, 0.0851, 0.1116,
        0.0683])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 14.4846, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 15.3070, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.1947355270386 sec.
Server Epoch:33 choose agents : [27, 92, 82, 59, 49, 13, 81, 70, 48, 79].
_Train Local_ResNet_18, epoch  33, local model 27, internal_epoch   1, Avg loss: 0.0616, Accuracy: 348/1587 (21.9282%)
_Train Local_ResNet_18, epoch  33, local model 27, internal_epoch   2, Avg loss: 0.0352, Accuracy: 585/1587 (36.8620%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.4075, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  33, local model 92, internal_epoch   1, Avg loss: 0.0579, Accuracy: 377/1715 (21.9825%)
_Train Local_ResNet_18, epoch  33, local model 92, internal_epoch   2, Avg loss: 0.0316, Accuracy: 695/1715 (40.5248%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.4415, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0719, Accuracy: 56/500 (11.2000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 190/500 (38.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.8632, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0508, Accuracy: 292/1089 (26.8136%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0290, Accuracy: 468/1089 (42.9752%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.6922, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   1, Avg loss: 0.0800, Accuracy: 13/440 (2.9545%)
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   2, Avg loss: 0.0481, Accuracy: 137/440 (31.1364%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.0655, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   1, Avg loss: 0.0643, Accuracy: 264/1645 (16.0486%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   2, Avg loss: 0.0345, Accuracy: 545/1645 (33.1307%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.6765, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  33, local model 81, internal_epoch   1, Avg loss: 0.0759, Accuracy: 162/774 (20.9302%)
_Train Local_ResNet_18, epoch  33, local model 81, internal_epoch   2, Avg loss: 0.0383, Accuracy: 324/774 (41.8605%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.1164, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0585, Accuracy: 315/1418 (22.2144%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0322, Accuracy: 574/1418 (40.4795%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.8932, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   1, Avg loss: 0.0813, Accuracy: 20/631 (3.1696%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   2, Avg loss: 0.0428, Accuracy: 239/631 (37.8764%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.2816, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1164, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0947, Accuracy: 28/197 (14.2132%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.9413, Accuracy: 50/10000 (0.5000%)
time spent on training: 171.19839715957642
[rfa agg] training data poison_ratio: 0.0  data num: [1587, 1715, 500, 1089, 440, 1645, 774, 1418, 631, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [27, 92, 82, 59, 49, 13, 81, 70, 48, 79], weight: tensor([0.1588, 0.1716, 0.0500, 0.1089, 0.0440, 0.1646, 0.0774, 0.1419, 0.0631,
        0.0197])
[rfa agg] iter:  0, prev_obj_val: 66.60894775390625, obj_val: 64.8896255493164, abs dis: 1.7193222045898438
[rfa agg] iter: 0, weight: tensor([0.1439, 0.1211, 0.0322, 0.2225, 0.0257, 0.1303, 0.0944, 0.1702, 0.0507,
        0.0089])
[rfa agg] iter:  1, prev_obj_val: 64.8896255493164, obj_val: 64.8862533569336, abs dis: 0.0033721923828125
[rfa agg] iter: 1, weight: tensor([0.1459, 0.1208, 0.0291, 0.2382, 0.0233, 0.1308, 0.0824, 0.1759, 0.0453,
        0.0081])
[rfa agg] iter:  2, prev_obj_val: 64.8862533569336, obj_val: 64.88612365722656, abs dis: 0.00012969970703125
[rfa agg] iter: 2, weight: tensor([0.1453, 0.1204, 0.0290, 0.2415, 0.0232, 0.1303, 0.0819, 0.1752, 0.0451,
        0.0081])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 15.8390, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 16.5614, Accuracy: 0/9950 (0.0000%)
saving model
Done in 285.46951055526733 sec.
Server Epoch:34 choose agents : [56, 37, 48, 84, 46, 60, 55, 12, 50, 72].
_Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   1, Avg loss: 0.0947, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   2, Avg loss: 0.0770, Accuracy: 13/186 (6.9892%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.9947, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  34, local model 37, internal_epoch   1, Avg loss: 0.0573, Accuracy: 322/1129 (28.5208%)
_Train Local_ResNet_18, epoch  34, local model 37, internal_epoch   2, Avg loss: 0.0259, Accuracy: 711/1129 (62.9761%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.0489, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0822, Accuracy: 28/631 (4.4374%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0430, Accuracy: 238/631 (37.7179%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.1324, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  34, local model 84, internal_epoch   1, Avg loss: 0.0645, Accuracy: 239/1190 (20.0840%)
_Train Local_ResNet_18, epoch  34, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 446/1190 (37.4790%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.7610, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  34, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 383/1904 (20.1155%)
_Train Local_ResNet_18, epoch  34, local model 46, internal_epoch   2, Avg loss: 0.0322, Accuracy: 637/1904 (33.4559%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.3931, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0523, Accuracy: 520/2227 (23.3498%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0292, Accuracy: 951/2227 (42.7032%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.0463, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0573, Accuracy: 221/1071 (20.6349%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0303, Accuracy: 461/1071 (43.0439%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 10.0685, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   1, Avg loss: 0.1053, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   2, Avg loss: 0.0582, Accuracy: 97/338 (28.6982%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.9993, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   1, Avg loss: 0.0711, Accuracy: 108/809 (13.3498%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   2, Avg loss: 0.0301, Accuracy: 319/809 (39.4314%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.4065, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   1, Avg loss: 0.0724, Accuracy: 195/1241 (15.7131%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   2, Avg loss: 0.0386, Accuracy: 366/1241 (29.4923%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.6193, Accuracy: 68/10000 (0.6800%)
time spent on training: 184.44300317764282
[rfa agg] training data poison_ratio: 0.0  data num: [186, 1129, 631, 1190, 1904, 2227, 1071, 338, 809, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [56, 37, 48, 84, 46, 60, 55, 12, 50, 72], weight: tensor([0.0173, 0.1053, 0.0588, 0.1109, 0.1775, 0.2076, 0.0999, 0.0315, 0.0754,
        0.1157])
[rfa agg] iter:  0, prev_obj_val: 71.30097961425781, obj_val: 73.40033721923828, abs dis: 2.0993576049804688
[rfa agg] iter: 0, weight: tensor([0.0043, 0.1662, 0.0254, 0.2090, 0.0756, 0.0598, 0.1239, 0.0097, 0.0459,
        0.2803])
[rfa agg] iter:  1, prev_obj_val: 73.40033721923828, obj_val: 74.8061294555664, abs dis: 1.405792236328125
[rfa agg] iter: 1, weight: tensor([0.0042, 0.2309, 0.0279, 0.2030, 0.0562, 0.0468, 0.1854, 0.0099, 0.0556,
        0.1799])
[rfa agg] iter:  2, prev_obj_val: 74.8061294555664, obj_val: 76.61036682128906, abs dis: 1.8042373657226562
[rfa agg] iter: 2, weight: tensor([0.0044, 0.2408, 0.0300, 0.1821, 0.0545, 0.0460, 0.2200, 0.0104, 0.0617,
        0.1501])
[rfa agg] iter:  3, prev_obj_val: 76.61036682128906, obj_val: 76.60139465332031, abs dis: 0.00897216796875
[rfa agg] iter: 3, weight: tensor([0.0048, 0.2261, 0.0335, 0.1646, 0.0549, 0.0467, 0.2503, 0.0114, 0.0715,
        0.1364])
[rfa agg] iter:  4, prev_obj_val: 76.60139465332031, obj_val: 78.70464324951172, abs dis: 2.1032485961914062
[rfa agg] iter: 4, weight: tensor([0.0047, 0.2210, 0.0333, 0.1621, 0.0545, 0.0465, 0.2602, 0.0113, 0.0712,
        0.1351])
[rfa agg] iter:  5, prev_obj_val: 78.70464324951172, obj_val: 76.60276794433594, abs dis: 2.1018753051757812
[rfa agg] iter: 5, weight: tensor([0.0052, 0.2041, 0.0382, 0.1527, 0.0563, 0.0484, 0.2687, 0.0126, 0.0853,
        0.1284])
[rfa agg] iter:  6, prev_obj_val: 76.60276794433594, obj_val: 76.60064697265625, abs dis: 0.0021209716796875
[rfa agg] iter: 6, weight: tensor([0.0047, 0.2156, 0.0332, 0.1607, 0.0544, 0.0463, 0.2680, 0.0113, 0.0712,
        0.1346])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 18.6902, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 17.3338, Accuracy: 0/9950 (0.0000%)
saving model
Done in 301.2829399108887 sec.
Server Epoch:35 choose agents : [14, 25, 49, 31, 78, 56, 59, 12, 2, 67].
_Train Local_ResNet_18, epoch  35, local model 14, internal_epoch   1, Avg loss: 0.0604, Accuracy: 200/1013 (19.7433%)
_Train Local_ResNet_18, epoch  35, local model 14, internal_epoch   2, Avg loss: 0.0365, Accuracy: 336/1013 (33.1688%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.7851, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  35, local model 25, internal_epoch   1, Avg loss: 0.0710, Accuracy: 198/690 (28.6957%)
_Train Local_ResNet_18, epoch  35, local model 25, internal_epoch   2, Avg loss: 0.0314, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.1299, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   1, Avg loss: 0.0769, Accuracy: 29/440 (6.5909%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   2, Avg loss: 0.0459, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4239, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  35, local model 31, internal_epoch   1, Avg loss: 0.0940, Accuracy: 17/460 (3.6957%)
_Train Local_ResNet_18, epoch  35, local model 31, internal_epoch   2, Avg loss: 0.0449, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.5667, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  35, local model 78, internal_epoch   1, Avg loss: 0.0874, Accuracy: 23/416 (5.5288%)
_Train Local_ResNet_18, epoch  35, local model 78, internal_epoch   2, Avg loss: 0.0519, Accuracy: 187/416 (44.9519%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4095, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   1, Avg loss: 0.0911, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   2, Avg loss: 0.0747, Accuracy: 27/186 (14.5161%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.1285, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 299/1089 (27.4564%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0288, Accuracy: 392/1089 (35.9963%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 19.4148, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.1021, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0562, Accuracy: 115/338 (34.0237%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.3108, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   1, Avg loss: 0.0673, Accuracy: 168/605 (27.7686%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   2, Avg loss: 0.0434, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.7856, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0792, Accuracy: 35/426 (8.2160%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0426, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.6364, Accuracy: 57/10000 (0.5700%)
time spent on training: 146.23157215118408
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 690, 440, 460, 416, 186, 1089, 338, 605, 426]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [14, 25, 49, 31, 78, 56, 59, 12, 2, 67], weight: tensor([0.1789, 0.1218, 0.0777, 0.0812, 0.0735, 0.0328, 0.1923, 0.0597, 0.1068,
        0.0752])
[rfa agg] iter:  0, prev_obj_val: 43.53511047363281, obj_val: 44.51268005371094, abs dis: 0.977569580078125
[rfa agg] iter: 0, weight: tensor([0.0889, 0.1839, 0.0869, 0.1252, 0.0818, 0.0145, 0.0683, 0.0502, 0.2172,
        0.0831])
[rfa agg] iter:  1, prev_obj_val: 44.51268005371094, obj_val: 52.3538932800293, abs dis: 7.841213226318359
[rfa agg] iter: 1, weight: tensor([0.0683, 0.1289, 0.1141, 0.1804, 0.1045, 0.0146, 0.0533, 0.0593, 0.1674,
        0.1092])
[rfa agg] iter:  2, prev_obj_val: 52.3538932800293, obj_val: 52.137298583984375, abs dis: 0.21659469604492188
[rfa agg] iter: 2, weight: tensor([0.0531, 0.0748, 0.1750, 0.1267, 0.1517, 0.0189, 0.0442, 0.1098, 0.0829,
        0.1629])
[rfa agg] iter:  3, prev_obj_val: 52.137298583984375, obj_val: 55.39244079589844, abs dis: 3.2551422119140625
[rfa agg] iter: 3, weight: tensor([0.0484, 0.0675, 0.1894, 0.1148, 0.1585, 0.0179, 0.0403, 0.1158, 0.0742,
        0.1732])
[rfa agg] iter:  4, prev_obj_val: 55.39244079589844, obj_val: 55.388729095458984, abs dis: 0.003711700439453125
[rfa agg] iter: 4, weight: tensor([0.0527, 0.0701, 0.1722, 0.1068, 0.1497, 0.0222, 0.0444, 0.1458, 0.0754,
        0.1607])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 17.7736, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 15.7837, Accuracy: 0/9950 (0.0000%)
saving model
Done in 260.8477466106415 sec.
Server Epoch:36 choose agents : [49, 72, 34, 13, 42, 7, 12, 61, 44, 78].
_Train Local_ResNet_18, epoch  36, local model 49, internal_epoch   1, Avg loss: 0.0753, Accuracy: 23/440 (5.2273%)
_Train Local_ResNet_18, epoch  36, local model 49, internal_epoch   2, Avg loss: 0.0446, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.9467, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   1, Avg loss: 0.0715, Accuracy: 194/1241 (15.6326%)
_Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   2, Avg loss: 0.0386, Accuracy: 365/1241 (29.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.4135, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   1, Avg loss: 0.0612, Accuracy: 323/1427 (22.6349%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   2, Avg loss: 0.0345, Accuracy: 571/1427 (40.0140%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.2538, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   1, Avg loss: 0.0656, Accuracy: 276/1645 (16.7781%)
_Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   2, Avg loss: 0.0347, Accuracy: 571/1645 (34.7112%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.7513, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0609, Accuracy: 247/1372 (18.0029%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0329, Accuracy: 464/1372 (33.8192%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.1417, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0490, Accuracy: 317/891 (35.5780%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 450/891 (50.5051%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.7195, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   1, Avg loss: 0.1015, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   2, Avg loss: 0.0559, Accuracy: 121/338 (35.7988%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.8723, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   1, Avg loss: 0.1395, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   2, Avg loss: 0.1266, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.6117, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   1, Avg loss: 0.0633, Accuracy: 322/1750 (18.4000%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   2, Avg loss: 0.0371, Accuracy: 609/1750 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.8255, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  36, local model 78, internal_epoch   1, Avg loss: 0.0849, Accuracy: 25/416 (6.0096%)
_Train Local_ResNet_18, epoch  36, local model 78, internal_epoch   2, Avg loss: 0.0498, Accuracy: 201/416 (48.3173%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.7112, Accuracy: 75/10000 (0.7500%)
time spent on training: 185.68972444534302
[rfa agg] training data poison_ratio: 0.0  data num: [440, 1241, 1427, 1645, 1372, 891, 338, 85, 1750, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [49, 72, 34, 13, 42, 7, 12, 61, 44, 78], weight: tensor([0.0458, 0.1292, 0.1486, 0.1713, 0.1428, 0.0928, 0.0352, 0.0088, 0.1822,
        0.0433])
[rfa agg] iter:  0, prev_obj_val: 61.42771911621094, obj_val: 59.21938705444336, abs dis: 2.208332061767578
[rfa agg] iter: 0, weight: tensor([0.0210, 0.2719, 0.1564, 0.1179, 0.1921, 0.1026, 0.0148, 0.0027, 0.1008,
        0.0198])
[rfa agg] iter:  1, prev_obj_val: 59.21938705444336, obj_val: 57.337074279785156, abs dis: 1.8823127746582031
[rfa agg] iter: 1, weight: tensor([0.0180, 0.3103, 0.1532, 0.1116, 0.1969, 0.0834, 0.0127, 0.0023, 0.0944,
        0.0170])
[rfa agg] iter:  2, prev_obj_val: 57.337074279785156, obj_val: 57.333255767822266, abs dis: 0.003818511962890625
[rfa agg] iter: 2, weight: tensor([0.0158, 0.3293, 0.1532, 0.1087, 0.2042, 0.0698, 0.0112, 0.0021, 0.0908,
        0.0149])
[rfa agg] iter:  3, prev_obj_val: 57.333255767822266, obj_val: 59.20998764038086, abs dis: 1.8767318725585938
[rfa agg] iter: 3, weight: tensor([0.0157, 0.3344, 0.1519, 0.1078, 0.2030, 0.0691, 0.0111, 0.0021, 0.0901,
        0.0148])
[rfa agg] iter:  4, prev_obj_val: 59.20998764038086, obj_val: 59.20804977416992, abs dis: 0.0019378662109375
[rfa agg] iter: 4, weight: tensor([0.0177, 0.3242, 0.1498, 0.1094, 0.1935, 0.0814, 0.0125, 0.0023, 0.0926,
        0.0167])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.7801, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.0705, Accuracy: 0/9950 (0.0000%)
saving model
Done in 299.1525309085846 sec.
Server Epoch:37 choose agents : [43, 52, 34, 93, 71, 11, 33, 59, 97, 25].
_Train Local_ResNet_18, epoch  37, local model 43, internal_epoch   1, Avg loss: 0.0596, Accuracy: 272/946 (28.7526%)
_Train Local_ResNet_18, epoch  37, local model 43, internal_epoch   2, Avg loss: 0.0377, Accuracy: 341/946 (36.0465%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1887, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 232/636 (36.4780%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0315, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.1837, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  37, local model 34, internal_epoch   1, Avg loss: 0.0612, Accuracy: 315/1427 (22.0743%)
_Train Local_ResNet_18, epoch  37, local model 34, internal_epoch   2, Avg loss: 0.0359, Accuracy: 531/1427 (37.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.9208, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  37, local model 93, internal_epoch   1, Avg loss: 0.0584, Accuracy: 417/1742 (23.9380%)
_Train Local_ResNet_18, epoch  37, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 702/1742 (40.2985%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.4050, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  37, local model 71, internal_epoch   1, Avg loss: 0.0643, Accuracy: 123/818 (15.0367%)
_Train Local_ResNet_18, epoch  37, local model 71, internal_epoch   2, Avg loss: 0.0315, Accuracy: 350/818 (42.7873%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.7288, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   1, Avg loss: 0.0592, Accuracy: 237/712 (33.2865%)
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 416/712 (58.4270%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.6625, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   1, Avg loss: 0.0875, Accuracy: 59/515 (11.4563%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   2, Avg loss: 0.0530, Accuracy: 129/515 (25.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.8188, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   1, Avg loss: 0.0498, Accuracy: 295/1089 (27.0891%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   2, Avg loss: 0.0297, Accuracy: 447/1089 (41.0468%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.7538, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  37, local model 97, internal_epoch   1, Avg loss: 0.0597, Accuracy: 286/1213 (23.5779%)
_Train Local_ResNet_18, epoch  37, local model 97, internal_epoch   2, Avg loss: 0.0284, Accuracy: 533/1213 (43.9406%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.5119, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0727, Accuracy: 190/690 (27.5362%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0325, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.7961, Accuracy: 55/10000 (0.5500%)
time spent on training: 186.97722864151
[rfa agg] training data poison_ratio: 0.0  data num: [946, 636, 1427, 1742, 818, 712, 515, 1089, 1213, 690]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 52, 34, 93, 71, 11, 33, 59, 97, 25], weight: tensor([0.0966, 0.0650, 0.1458, 0.1780, 0.0836, 0.0727, 0.0526, 0.1113, 0.1239,
        0.0705])
[rfa agg] iter:  0, prev_obj_val: 55.46670150756836, obj_val: 57.49444580078125, abs dis: 2.0277442932128906
[rfa agg] iter: 0, weight: tensor([0.2431, 0.0524, 0.0765, 0.0585, 0.1423, 0.0896, 0.0359, 0.1115, 0.1201,
        0.0701])
[rfa agg] iter:  1, prev_obj_val: 57.49444580078125, obj_val: 64.8290786743164, abs dis: 7.334632873535156
[rfa agg] iter: 1, weight: tensor([0.2225, 0.0594, 0.0634, 0.0505, 0.1883, 0.1119, 0.0394, 0.0883, 0.0930,
        0.0833])
[rfa agg] iter:  2, prev_obj_val: 64.8290786743164, obj_val: 64.68073272705078, abs dis: 0.148345947265625
[rfa agg] iter: 2, weight: tensor([0.1116, 0.0937, 0.0501, 0.0425, 0.1911, 0.1758, 0.0569, 0.0630, 0.0658,
        0.1495])
[rfa agg] iter:  3, prev_obj_val: 64.68073272705078, obj_val: 67.20923614501953, abs dis: 2.52850341796875
[rfa agg] iter: 3, weight: tensor([0.1029, 0.0919, 0.0476, 0.0404, 0.1910, 0.1916, 0.0553, 0.0593, 0.0624,
        0.1575])
[rfa agg] iter:  4, prev_obj_val: 67.20923614501953, obj_val: 62.4792366027832, abs dis: 4.729999542236328
[rfa agg] iter: 4, weight: tensor([0.0920, 0.1080, 0.0461, 0.0396, 0.1587, 0.1864, 0.0635, 0.0563, 0.0592,
        0.1901])
[rfa agg] iter:  5, prev_obj_val: 62.4792366027832, obj_val: 67.22675323486328, abs dis: 4.747516632080078
[rfa agg] iter: 5, weight: tensor([0.1156, 0.0795, 0.0494, 0.0413, 0.2197, 0.1840, 0.0489, 0.0626, 0.0663,
        0.1326])
[rfa agg] iter:  6, prev_obj_val: 67.22675323486328, obj_val: 62.47628402709961, abs dis: 4.750469207763672
[rfa agg] iter: 6, weight: tensor([0.0931, 0.1080, 0.0466, 0.0400, 0.1619, 0.1843, 0.0638, 0.0569, 0.0598,
        0.1857])
[rfa agg] iter:  7, prev_obj_val: 62.47628402709961, obj_val: 67.22708129882812, abs dis: 4.750797271728516
[rfa agg] iter: 7, weight: tensor([0.1156, 0.0795, 0.0494, 0.0413, 0.2204, 0.1835, 0.0489, 0.0627, 0.0663,
        0.1323])
[rfa agg] iter:  8, prev_obj_val: 67.22708129882812, obj_val: 62.47623062133789, abs dis: 4.750850677490234
[rfa agg] iter: 8, weight: tensor([0.0931, 0.1080, 0.0466, 0.0400, 0.1620, 0.1842, 0.0638, 0.0569, 0.0598,
        0.1856])
[rfa agg] iter:  9, prev_obj_val: 62.47623062133789, obj_val: 67.22709655761719, abs dis: 4.750865936279297
[rfa agg] iter: 9, weight: tensor([0.1156, 0.0795, 0.0494, 0.0413, 0.2204, 0.1834, 0.0489, 0.0627, 0.0663,
        0.1323])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.7954, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.0192, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.21504378318787 sec.
Server Epoch:38 choose agents : [79, 26, 47, 1, 85, 4, 39, 42, 59, 73].
_Train Local_ResNet_18, epoch  38, local model 79, internal_epoch   1, Avg loss: 0.1161, Accuracy: 2/197 (1.0152%)
_Train Local_ResNet_18, epoch  38, local model 79, internal_epoch   2, Avg loss: 0.0982, Accuracy: 29/197 (14.7208%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.4168, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   1, Avg loss: 0.0576, Accuracy: 283/1446 (19.5712%)
_Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   2, Avg loss: 0.0362, Accuracy: 476/1446 (32.9184%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.1885, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  38, local model 47, internal_epoch   1, Avg loss: 0.1128, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  38, local model 47, internal_epoch   2, Avg loss: 0.1000, Accuracy: 4/134 (2.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7100, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0569, Accuracy: 281/928 (30.2802%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0254, Accuracy: 540/928 (58.1897%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.5559, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  38, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 378/1988 (19.0141%)
_Train Local_ResNet_18, epoch  38, local model 85, internal_epoch   2, Avg loss: 0.0374, Accuracy: 571/1988 (28.7223%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.0189, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0620, Accuracy: 265/901 (29.4118%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0349, Accuracy: 421/901 (46.7259%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.5301, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0500, Accuracy: 286/1013 (28.2330%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0269, Accuracy: 487/1013 (48.0750%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.7357, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0606, Accuracy: 230/1372 (16.7638%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0334, Accuracy: 471/1372 (34.3294%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.0264, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   1, Avg loss: 0.0490, Accuracy: 304/1089 (27.9155%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   2, Avg loss: 0.0298, Accuracy: 462/1089 (42.4242%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 14.2821, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   1, Avg loss: 0.0760, Accuracy: 107/938 (11.4072%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   2, Avg loss: 0.0354, Accuracy: 339/938 (36.1407%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.5781, Accuracy: 64/10000 (0.6400%)
time spent on training: 188.54562211036682
[rfa agg] training data poison_ratio: 0.0  data num: [197, 1446, 134, 928, 1988, 901, 1013, 1372, 1089, 938]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [79, 26, 47, 1, 85, 4, 39, 42, 59, 73], weight: tensor([0.0197, 0.1445, 0.0134, 0.0927, 0.1987, 0.0900, 0.1012, 0.1371, 0.1088,
        0.0937])
[rfa agg] iter:  0, prev_obj_val: 57.30984115600586, obj_val: 58.48970413208008, abs dis: 1.1798629760742188
[rfa agg] iter: 0, weight: tensor([0.0062, 0.1238, 0.0039, 0.1115, 0.0643, 0.1136, 0.1689, 0.1388, 0.1467,
        0.1223])
[rfa agg] iter:  1, prev_obj_val: 58.48970413208008, obj_val: 62.78542709350586, abs dis: 4.295722961425781
[rfa agg] iter: 1, weight: tensor([0.0059, 0.0939, 0.0037, 0.1252, 0.0533, 0.1308, 0.2099, 0.1035, 0.1317,
        0.1421])
[rfa agg] iter:  2, prev_obj_val: 62.78542709350586, obj_val: 62.72352981567383, abs dis: 0.06189727783203125
[rfa agg] iter: 2, weight: tensor([0.0058, 0.0675, 0.0036, 0.1483, 0.0429, 0.1610, 0.2194, 0.0724, 0.0953,
        0.1838])
[rfa agg] iter:  3, prev_obj_val: 62.72352981567383, obj_val: 62.72276306152344, abs dis: 0.000766754150390625
[rfa agg] iter: 3, weight: tensor([0.0057, 0.0657, 0.0035, 0.1507, 0.0419, 0.1618, 0.2212, 0.0704, 0.0904,
        0.1887])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.8128, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 4.9450, Accuracy: 0/9950 (0.0000%)
saving model
Done in 303.2900493144989 sec.
Server Epoch:39 choose agents : [34, 95, 89, 43, 8, 17, 27, 59, 44, 32].
_Train Local_ResNet_18, epoch  39, local model 34, internal_epoch   1, Avg loss: 0.0597, Accuracy: 329/1427 (23.0554%)
_Train Local_ResNet_18, epoch  39, local model 34, internal_epoch   2, Avg loss: 0.0351, Accuracy: 584/1427 (40.9250%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.0488, Accuracy: 74/10000 (0.7400%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  39, local model 95, internal_epoch   1, Avg loss: 0.0483, Accuracy: 293/599 (48.9149%)
_Train Local_ResNet_18, epoch  39, local model 95, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 14.7317, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 89, internal_epoch   1, Avg loss: 0.0583, Accuracy: 295/896 (32.9241%)
_Train Local_ResNet_18, epoch  39, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 437/896 (48.7723%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.1882, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0588, Accuracy: 281/946 (29.7040%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 373/946 (39.4292%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.1147, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0677, Accuracy: 197/1513 (13.0205%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0392, Accuracy: 414/1513 (27.3629%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.1908, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   1, Avg loss: 0.0629, Accuracy: 300/1574 (19.0597%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   2, Avg loss: 0.0291, Accuracy: 646/1574 (41.0419%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.8487, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0615, Accuracy: 353/1587 (22.2432%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0360, Accuracy: 581/1587 (36.6100%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.9343, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   1, Avg loss: 0.0479, Accuracy: 315/1089 (28.9256%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/1089 (44.9954%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.6420, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   1, Avg loss: 0.0636, Accuracy: 341/1750 (19.4857%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   2, Avg loss: 0.0369, Accuracy: 612/1750 (34.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.0854, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   1, Avg loss: 0.0537, Accuracy: 165/735 (22.4490%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   2, Avg loss: 0.0219, Accuracy: 346/735 (47.0748%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 12.0142, Accuracy: 63/10000 (0.6300%)
time spent on training: 224.0215139389038
[rfa agg] training data poison_ratio: 0.049438758666226476  data num: [1427, 599, 896, 946, 1513, 1574, 1587, 1089, 1750, 735]
[rfa agg] considering poison per batch poison_fraction: 0.015449612083195775
[rfa agg] init. name: [34, 95, 89, 43, 8, 17, 27, 59, 44, 32], weight: tensor([0.1178, 0.0494, 0.0740, 0.0781, 0.1249, 0.1299, 0.1310, 0.0899, 0.1444,
        0.0607])
[rfa agg] iter:  0, prev_obj_val: 55.155616760253906, obj_val: 56.60871505737305, abs dis: 1.4530982971191406
[rfa agg] iter: 0, weight: tensor([0.1469, 0.0304, 0.0791, 0.1014, 0.1299, 0.1161, 0.1153, 0.1447, 0.0883,
        0.0480])
[rfa agg] iter:  1, prev_obj_val: 56.60871505737305, obj_val: 58.213470458984375, abs dis: 1.6047554016113281
[rfa agg] iter: 1, weight: tensor([0.1352, 0.0322, 0.0872, 0.1136, 0.1202, 0.1084, 0.1078, 0.1596, 0.0840,
        0.0517])
[rfa agg] iter:  2, prev_obj_val: 58.213470458984375, obj_val: 59.923980712890625, abs dis: 1.71051025390625
[rfa agg] iter: 2, weight: tensor([0.1240, 0.0342, 0.0969, 0.1288, 0.1117, 0.1016, 0.1012, 0.1653, 0.0803,
        0.0559])
[rfa agg] iter:  3, prev_obj_val: 59.923980712890625, obj_val: 61.739768981933594, abs dis: 1.8157882690429688
[rfa agg] iter: 3, weight: tensor([0.1138, 0.0363, 0.1080, 0.1472, 0.1037, 0.0951, 0.0948, 0.1640, 0.0765,
        0.0605])
[rfa agg] iter:  4, prev_obj_val: 61.739768981933594, obj_val: 61.73582458496094, abs dis: 0.00394439697265625
[rfa agg] iter: 4, weight: tensor([0.1042, 0.0383, 0.1209, 0.1694, 0.0959, 0.0886, 0.0885, 0.1563, 0.0724,
        0.0654])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.8189, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 4.9351, Accuracy: 0/9950 (0.0000%)
saving model
Done in 341.6529757976532 sec.
Server Epoch:40 choose agents : [93, 66, 71, 72, 10, 80, 83, 55, 2, 64].
_Train Local_ResNet_18, epoch  40, local model 93, internal_epoch   1, Avg loss: 0.0580, Accuracy: 371/1742 (21.2974%)
_Train Local_ResNet_18, epoch  40, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 653/1742 (37.4856%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.6972, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   1, Avg loss: 0.0687, Accuracy: 208/1402 (14.8359%)
_Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   2, Avg loss: 0.0406, Accuracy: 386/1402 (27.5321%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.4972, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  40, local model 71, internal_epoch   1, Avg loss: 0.0632, Accuracy: 146/818 (17.8484%)
_Train Local_ResNet_18, epoch  40, local model 71, internal_epoch   2, Avg loss: 0.0313, Accuracy: 358/818 (43.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.1307, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   1, Avg loss: 0.0670, Accuracy: 242/1241 (19.5004%)
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   2, Avg loss: 0.0384, Accuracy: 379/1241 (30.5399%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.2560, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   1, Avg loss: 0.0731, Accuracy: 113/861 (13.1243%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   2, Avg loss: 0.0238, Accuracy: 420/861 (48.7805%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 11.6203, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  40, local model 80, internal_epoch   1, Avg loss: 0.0791, Accuracy: 108/682 (15.8358%)
_Train Local_ResNet_18, epoch  40, local model 80, internal_epoch   2, Avg loss: 0.0432, Accuracy: 242/682 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.1467, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0663, Accuracy: 273/1953 (13.9785%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0362, Accuracy: 650/1953 (33.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.1757, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 215/1071 (20.0747%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 491/1071 (45.8450%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.8819, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   1, Avg loss: 0.0669, Accuracy: 151/605 (24.9587%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   2, Avg loss: 0.0419, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8310, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0684, Accuracy: 141/953 (14.7954%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0398, Accuracy: 320/953 (33.5782%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.2708, Accuracy: 44/10000 (0.4400%)
time spent on training: 204.66311883926392
[rfa agg] training data poison_ratio: 0.0  data num: [1742, 1402, 818, 1241, 861, 682, 1953, 1071, 605, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [93, 66, 71, 72, 10, 80, 83, 55, 2, 64], weight: tensor([0.1538, 0.1238, 0.0722, 0.1096, 0.0760, 0.0602, 0.1724, 0.0945, 0.0534,
        0.0841])
[rfa agg] iter:  0, prev_obj_val: 60.29024124145508, obj_val: 62.27754592895508, abs dis: 1.9873046875
[rfa agg] iter: 0, weight: tensor([0.0763, 0.1477, 0.0609, 0.2098, 0.0759, 0.0379, 0.0658, 0.1910, 0.0297,
        0.1050])
[rfa agg] iter:  1, prev_obj_val: 62.27754592895508, obj_val: 67.82748413085938, abs dis: 5.549938201904297
[rfa agg] iter: 1, weight: tensor([0.0612, 0.1035, 0.0747, 0.1407, 0.0970, 0.0434, 0.0544, 0.2464, 0.0330,
        0.1456])
[rfa agg] iter:  2, prev_obj_val: 67.82748413085938, obj_val: 69.68505859375, abs dis: 1.857574462890625
[rfa agg] iter: 2, weight: tensor([0.0484, 0.0707, 0.1164, 0.0850, 0.1563, 0.0581, 0.0444, 0.1553, 0.0416,
        0.2238])
[rfa agg] iter:  3, prev_obj_val: 69.68505859375, obj_val: 74.44725036621094, abs dis: 4.7621917724609375
[rfa agg] iter: 3, weight: tensor([0.0449, 0.0637, 0.1344, 0.0746, 0.1792, 0.0629, 0.0414, 0.1246, 0.0440,
        0.2304])
[rfa agg] iter:  4, prev_obj_val: 74.44725036621094, obj_val: 74.42416381835938, abs dis: 0.0230865478515625
[rfa agg] iter: 4, weight: tensor([0.0434, 0.0586, 0.1875, 0.0665, 0.1902, 0.0846, 0.0405, 0.0998, 0.0561,
        0.1728])
[rfa agg] iter:  5, prev_obj_val: 74.42416381835938, obj_val: 74.42369842529297, abs dis: 0.00046539306640625
[rfa agg] iter: 5, weight: tensor([0.0430, 0.0581, 0.1975, 0.0658, 0.1906, 0.0843, 0.0401, 0.0985, 0.0558,
        0.1663])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 23.9997, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 18.7065, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 315.97722339630127 sec.
Server Epoch:41 choose agents : [85, 44, 65, 86, 25, 91, 38, 76, 45, 21].
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   1, Avg loss: 0.0545, Accuracy: 389/1988 (19.5674%)
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   2, Avg loss: 0.0368, Accuracy: 590/1988 (29.6781%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.2128, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0633, Accuracy: 327/1750 (18.6857%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0367, Accuracy: 644/1750 (36.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.0213, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   1, Avg loss: 0.0663, Accuracy: 341/1475 (23.1186%)
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   2, Avg loss: 0.0341, Accuracy: 588/1475 (39.8644%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.2510, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  41, local model 86, internal_epoch   1, Avg loss: 0.0617, Accuracy: 297/1003 (29.6112%)
_Train Local_ResNet_18, epoch  41, local model 86, internal_epoch   2, Avg loss: 0.0346, Accuracy: 395/1003 (39.3819%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.0520, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Avg loss: 0.0700, Accuracy: 192/690 (27.8261%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Avg loss: 0.0319, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.8729, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  41, local model 91, internal_epoch   1, Avg loss: 0.0672, Accuracy: 219/1030 (21.2621%)
_Train Local_ResNet_18, epoch  41, local model 91, internal_epoch   2, Avg loss: 0.0301, Accuracy: 547/1030 (53.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 12.5583, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0788, Accuracy: 174/1131 (15.3846%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0358, Accuracy: 434/1131 (38.3731%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.8030, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   1, Avg loss: 0.1003, Accuracy: 2/466 (0.4292%)
_Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   2, Avg loss: 0.0537, Accuracy: 162/466 (34.7639%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.3282, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   1, Avg loss: 0.0866, Accuracy: 87/669 (13.0045%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   2, Avg loss: 0.0457, Accuracy: 358/669 (53.5127%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.5012, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   1, Avg loss: 0.0571, Accuracy: 341/1949 (17.4962%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   2, Avg loss: 0.0354, Accuracy: 559/1949 (28.6814%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.9502, Accuracy: 81/10000 (0.8100%)
time spent on training: 225.79367876052856
[rfa agg] training data poison_ratio: 0.0  data num: [1988, 1750, 1475, 1003, 690, 1030, 1131, 466, 669, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [85, 44, 65, 86, 25, 91, 38, 76, 45, 21], weight: tensor([0.1636, 0.1440, 0.1214, 0.0825, 0.0568, 0.0848, 0.0931, 0.0384, 0.0551,
        0.1604])
[rfa agg] iter:  0, prev_obj_val: 71.3304443359375, obj_val: 75.36126708984375, abs dis: 4.03082275390625
[rfa agg] iter: 0, weight: tensor([0.0895, 0.1195, 0.1834, 0.1098, 0.0381, 0.1266, 0.1801, 0.0196, 0.0367,
        0.0967])
[rfa agg] iter:  1, prev_obj_val: 75.36126708984375, obj_val: 78.2490463256836, abs dis: 2.8877792358398438
[rfa agg] iter: 1, weight: tensor([0.0664, 0.0830, 0.1145, 0.1479, 0.0414, 0.1646, 0.2517, 0.0200, 0.0398,
        0.0707])
[rfa agg] iter:  2, prev_obj_val: 78.2490463256836, obj_val: 82.10393524169922, abs dis: 3.854888916015625
[rfa agg] iter: 2, weight: tensor([0.0574, 0.0698, 0.0908, 0.1804, 0.0438, 0.1821, 0.2524, 0.0204, 0.0421,
        0.0608])
[rfa agg] iter:  3, prev_obj_val: 82.10393524169922, obj_val: 80.04511260986328, abs dis: 2.0588226318359375
[rfa agg] iter: 3, weight: tensor([0.0541, 0.0642, 0.0801, 0.2319, 0.0513, 0.1865, 0.2032, 0.0228, 0.0491,
        0.0569])
[rfa agg] iter:  4, prev_obj_val: 80.04511260986328, obj_val: 80.04319763183594, abs dis: 0.00191497802734375
[rfa agg] iter: 4, weight: tensor([0.0550, 0.0661, 0.0838, 0.2200, 0.0468, 0.1898, 0.2143, 0.0213, 0.0449,
        0.0581])
[rfa agg] iter:  5, prev_obj_val: 80.04319763183594, obj_val: 82.07994079589844, abs dis: 2.0367431640625
[rfa agg] iter: 5, weight: tensor([0.0550, 0.0661, 0.0838, 0.2166, 0.0468, 0.1906, 0.2168, 0.0213, 0.0448,
        0.0581])
[rfa agg] iter:  6, prev_obj_val: 82.07994079589844, obj_val: 80.04735565185547, abs dis: 2.0325851440429688
[rfa agg] iter: 6, weight: tensor([0.0537, 0.0637, 0.0794, 0.2417, 0.0510, 0.1875, 0.1952, 0.0226, 0.0487,
        0.0565])
[rfa agg] iter:  7, prev_obj_val: 80.04735565185547, obj_val: 80.0433349609375, abs dis: 0.00402069091796875
[rfa agg] iter: 7, weight: tensor([0.0550, 0.0660, 0.0837, 0.2221, 0.0468, 0.1900, 0.2122, 0.0213, 0.0448,
        0.0580])
[rfa agg] iter:  8, prev_obj_val: 80.0433349609375, obj_val: 82.07974243164062, abs dis: 2.036407470703125
[rfa agg] iter: 8, weight: tensor([0.0550, 0.0661, 0.0838, 0.2171, 0.0468, 0.1906, 0.2163, 0.0213, 0.0448,
        0.0581])
[rfa agg] iter:  9, prev_obj_val: 82.07974243164062, obj_val: 80.04739379882812, abs dis: 2.0323486328125
[rfa agg] iter: 9, weight: tensor([0.0537, 0.0637, 0.0794, 0.2418, 0.0510, 0.1875, 0.1951, 0.0226, 0.0487,
        0.0565])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.7887, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.1288, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 346.0820152759552 sec.
Server Epoch:42 choose agents : [51, 16, 4, 43, 67, 60, 32, 45, 96, 15].
_Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   1, Avg loss: 0.0660, Accuracy: 197/1049 (18.7798%)
_Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   2, Avg loss: 0.0312, Accuracy: 494/1049 (47.0925%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.3654, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  42, local model 16, internal_epoch   1, Avg loss: 0.0689, Accuracy: 188/708 (26.5537%)
_Train Local_ResNet_18, epoch  42, local model 16, internal_epoch   2, Avg loss: 0.0382, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.5750, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0626, Accuracy: 278/901 (30.8546%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0351, Accuracy: 386/901 (42.8413%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.3278, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   1, Avg loss: 0.0593, Accuracy: 264/946 (27.9070%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 380/946 (40.1691%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.4127, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0813, Accuracy: 22/426 (5.1643%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0432, Accuracy: 168/426 (39.4366%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.0157, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0527, Accuracy: 523/2227 (23.4845%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0292, Accuracy: 965/2227 (43.3318%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.8071, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   1, Avg loss: 0.0546, Accuracy: 190/735 (25.8503%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 355/735 (48.2993%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 12.2292, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0856, Accuracy: 92/669 (13.7519%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0458, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.0888, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  42, local model 96, internal_epoch   1, Avg loss: 0.0849, Accuracy: 23/311 (7.3955%)
_Train Local_ResNet_18, epoch  42, local model 96, internal_epoch   2, Avg loss: 0.0598, Accuracy: 124/311 (39.8714%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.2437, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   1, Avg loss: 0.0757, Accuracy: 209/1154 (18.1109%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   2, Avg loss: 0.0305, Accuracy: 415/1154 (35.9619%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 11.2573, Accuracy: 61/10000 (0.6100%)
time spent on training: 201.25919437408447
[rfa agg] training data poison_ratio: 0.0  data num: [1049, 708, 901, 946, 426, 2227, 735, 669, 311, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [51, 16, 4, 43, 67, 60, 32, 45, 96, 15], weight: tensor([0.1149, 0.0776, 0.0987, 0.1037, 0.0467, 0.2440, 0.0805, 0.0733, 0.0341,
        0.1265])
[rfa agg] iter:  0, prev_obj_val: 70.27706909179688, obj_val: 72.43790435791016, abs dis: 2.1608352661132812
[rfa agg] iter: 0, weight: tensor([0.1910, 0.0727, 0.1752, 0.2032, 0.0213, 0.0542, 0.0784, 0.0589, 0.0126,
        0.1325])
[rfa agg] iter:  1, prev_obj_val: 72.43790435791016, obj_val: 75.41971588134766, abs dis: 2.9818115234375
[rfa agg] iter: 1, weight: tensor([0.1248, 0.1062, 0.1754, 0.2124, 0.0252, 0.0459, 0.1234, 0.0842, 0.0142,
        0.0884])
[rfa agg] iter:  2, prev_obj_val: 75.41971588134766, obj_val: 77.24774932861328, abs dis: 1.828033447265625
[rfa agg] iter: 2, weight: tensor([0.1008, 0.1401, 0.1403, 0.1636, 0.0294, 0.0442, 0.1758, 0.1133, 0.0159,
        0.0766])
[rfa agg] iter:  3, prev_obj_val: 77.24774932861328, obj_val: 81.88562774658203, abs dis: 4.63787841796875
[rfa agg] iter: 3, weight: tensor([0.0894, 0.1563, 0.1188, 0.1361, 0.0311, 0.0423, 0.2082, 0.1316, 0.0165,
        0.0699])
[rfa agg] iter:  4, prev_obj_val: 81.88562774658203, obj_val: 84.67857360839844, abs dis: 2.7929458618164062
[rfa agg] iter: 4, weight: tensor([0.0768, 0.1623, 0.0957, 0.1063, 0.0374, 0.0411, 0.2200, 0.1787, 0.0189,
        0.0627])
[rfa agg] iter:  5, prev_obj_val: 84.67857360839844, obj_val: 87.76074981689453, abs dis: 3.0821762084960938
[rfa agg] iter: 5, weight: tensor([0.0747, 0.1565, 0.0903, 0.0994, 0.0434, 0.0423, 0.2008, 0.2092, 0.0212,
        0.0622])
[rfa agg] iter:  6, prev_obj_val: 87.76074981689453, obj_val: 84.67341613769531, abs dis: 3.0873336791992188
[rfa agg] iter: 6, weight: tensor([0.0756, 0.1488, 0.0893, 0.0974, 0.0524, 0.0449, 0.1793, 0.2235, 0.0247,
        0.0639])
[rfa agg] iter:  7, prev_obj_val: 84.67341613769531, obj_val: 87.75884246826172, abs dis: 3.0854263305664062
[rfa agg] iter: 7, weight: tensor([0.0742, 0.1534, 0.0897, 0.0985, 0.0434, 0.0420, 0.1928, 0.2232, 0.0212,
        0.0618])
[rfa agg] iter:  8, prev_obj_val: 87.75884246826172, obj_val: 84.67365264892578, abs dis: 3.0851898193359375
[rfa agg] iter: 8, weight: tensor([0.0754, 0.1480, 0.0891, 0.0971, 0.0523, 0.0448, 0.1780, 0.2268, 0.0247,
        0.0638])
[rfa agg] iter:  9, prev_obj_val: 84.67365264892578, obj_val: 87.75877380371094, abs dis: 3.0851211547851562
[rfa agg] iter: 9, weight: tensor([0.0742, 0.1531, 0.0896, 0.0984, 0.0433, 0.0420, 0.1924, 0.2240, 0.0212,
        0.0617])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 18.4256, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 15.9563, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 317.5776002407074 sec.
Server Epoch:43 choose agents : [38, 34, 30, 91, 79, 77, 97, 4, 92, 40].
_Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   1, Avg loss: 0.0799, Accuracy: 163/1131 (14.4120%)
_Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   2, Avg loss: 0.0347, Accuracy: 483/1131 (42.7056%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.9037, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  43, local model 34, internal_epoch   1, Avg loss: 0.0582, Accuracy: 374/1427 (26.2088%)
_Train Local_ResNet_18, epoch  43, local model 34, internal_epoch   2, Avg loss: 0.0347, Accuracy: 590/1427 (41.3455%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.1118, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0768, Accuracy: 45/486 (9.2593%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0383, Accuracy: 229/486 (47.1193%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.4893, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   1, Avg loss: 0.0621, Accuracy: 235/1030 (22.8155%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   2, Avg loss: 0.0282, Accuracy: 577/1030 (56.0194%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.7349, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  43, local model 79, internal_epoch   1, Avg loss: 0.1294, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  43, local model 79, internal_epoch   2, Avg loss: 0.0997, Accuracy: 12/197 (6.0914%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.2638, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0612, Accuracy: 248/1340 (18.5075%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0281, Accuracy: 535/1340 (39.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.5791, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  43, local model 97, internal_epoch   1, Avg loss: 0.0603, Accuracy: 297/1213 (24.4847%)
_Train Local_ResNet_18, epoch  43, local model 97, internal_epoch   2, Avg loss: 0.0293, Accuracy: 509/1213 (41.9621%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.1407, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   1, Avg loss: 0.0624, Accuracy: 277/901 (30.7436%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   2, Avg loss: 0.0337, Accuracy: 394/901 (43.7292%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.3988, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  43, local model 92, internal_epoch   1, Avg loss: 0.0599, Accuracy: 372/1715 (21.6910%)
_Train Local_ResNet_18, epoch  43, local model 92, internal_epoch   2, Avg loss: 0.0321, Accuracy: 683/1715 (39.8251%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.4959, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0625, Accuracy: 314/1573 (19.9619%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0367, Accuracy: 567/1573 (36.0458%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.8884, Accuracy: 80/10000 (0.8000%)
time spent on training: 215.22546219825745
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 1427, 486, 1030, 197, 1340, 1213, 901, 1715, 1573]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 34, 30, 91, 79, 77, 97, 4, 92, 40], weight: tensor([0.1027, 0.1296, 0.0441, 0.0935, 0.0179, 0.1217, 0.1101, 0.0818, 0.1557,
        0.1428])
[rfa agg] iter:  0, prev_obj_val: 47.23185348510742, obj_val: 50.4451904296875, abs dis: 3.213336944580078
[rfa agg] iter: 0, weight: tensor([0.1836, 0.1012, 0.0163, 0.1293, 0.0047, 0.1347, 0.1999, 0.0771, 0.0700,
        0.0831])
[rfa agg] iter:  1, prev_obj_val: 50.4451904296875, obj_val: 55.059783935546875, abs dis: 4.614593505859375
[rfa agg] iter: 1, weight: tensor([0.2042, 0.0868, 0.0182, 0.1577, 0.0051, 0.1132, 0.1805, 0.0966, 0.0638,
        0.0737])
[rfa agg] iter:  2, prev_obj_val: 55.059783935546875, obj_val: 55.04136657714844, abs dis: 0.0184173583984375
[rfa agg] iter: 2, weight: tensor([0.1874, 0.0821, 0.0222, 0.1797, 0.0060, 0.1032, 0.1522, 0.1318, 0.0636,
        0.0718])
[rfa agg] iter:  3, prev_obj_val: 55.04136657714844, obj_val: 52.595054626464844, abs dis: 2.4463119506835938
[rfa agg] iter: 3, weight: tensor([0.1844, 0.0816, 0.0221, 0.1841, 0.0060, 0.1026, 0.1497, 0.1349, 0.0633,
        0.0714])
[rfa agg] iter:  4, prev_obj_val: 52.595054626464844, obj_val: 50.424678802490234, abs dis: 2.1703758239746094
[rfa agg] iter: 4, weight: tensor([0.1961, 0.0829, 0.0199, 0.1803, 0.0055, 0.1059, 0.1600, 0.1150, 0.0629,
        0.0717])
[rfa agg] iter:  5, prev_obj_val: 50.424678802490234, obj_val: 55.05562210083008, abs dis: 4.630943298339844
[rfa agg] iter: 5, weight: tensor([0.2071, 0.0853, 0.0181, 0.1672, 0.0051, 0.1108, 0.1734, 0.0972, 0.0631,
        0.0728])
[rfa agg] iter:  6, prev_obj_val: 55.05562210083008, obj_val: 55.04127502441406, abs dis: 0.014347076416015625
[rfa agg] iter: 6, weight: tensor([0.1877, 0.0819, 0.0221, 0.1815, 0.0060, 0.1029, 0.1513, 0.1315, 0.0635,
        0.0716])
[rfa agg] iter:  7, prev_obj_val: 55.04127502441406, obj_val: 52.59505844116211, abs dis: 2.446216583251953
[rfa agg] iter: 7, weight: tensor([0.1844, 0.0816, 0.0221, 0.1845, 0.0060, 0.1025, 0.1495, 0.1348, 0.0633,
        0.0714])
[rfa agg] iter:  8, prev_obj_val: 52.59505844116211, obj_val: 50.4246940612793, abs dis: 2.1703643798828125
[rfa agg] iter: 8, weight: tensor([0.1961, 0.0829, 0.0199, 0.1803, 0.0055, 0.1059, 0.1599, 0.1149, 0.0629,
        0.0717])
[rfa agg] iter:  9, prev_obj_val: 50.4246940612793, obj_val: 55.05562210083008, abs dis: 4.630928039550781
[rfa agg] iter: 9, weight: tensor([0.2071, 0.0853, 0.0181, 0.1672, 0.0051, 0.1108, 0.1733, 0.0972, 0.0631,
        0.0728])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 24.7727, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 25.4875, Accuracy: 0/9950 (0.0000%)
saving model
Done in 326.40655303001404 sec.
Server Epoch:44 choose agents : [31, 21, 20, 52, 96, 4, 15, 32, 64, 58].
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0897, Accuracy: 24/460 (5.2174%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0397, Accuracy: 185/460 (40.2174%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.5619, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  44, local model 21, internal_epoch   1, Avg loss: 0.0578, Accuracy: 307/1949 (15.7517%)
_Train Local_ResNet_18, epoch  44, local model 21, internal_epoch   2, Avg loss: 0.0346, Accuracy: 572/1949 (29.3484%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.4399, Accuracy: 76/10000 (0.7600%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0642, Accuracy: 226/807 (28.0050%)
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0334, Accuracy: 419/807 (51.9207%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.6202, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   1, Avg loss: 0.0585, Accuracy: 235/636 (36.9497%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   2, Avg loss: 0.0330, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.5542, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 96, internal_epoch   1, Avg loss: 0.0862, Accuracy: 16/311 (5.1447%)
_Train Local_ResNet_18, epoch  44, local model 96, internal_epoch   2, Avg loss: 0.0599, Accuracy: 125/311 (40.1929%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.5115, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0615, Accuracy: 277/901 (30.7436%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0324, Accuracy: 397/901 (44.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.6783, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0749, Accuracy: 199/1154 (17.2444%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0322, Accuracy: 442/1154 (38.3016%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.3987, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0522, Accuracy: 190/735 (25.8503%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 357/735 (48.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 12.6036, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   1, Avg loss: 0.0681, Accuracy: 152/953 (15.9496%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   2, Avg loss: 0.0396, Accuracy: 305/953 (32.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.9015, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   1, Avg loss: 0.0617, Accuracy: 263/803 (32.7522%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 431/803 (53.6737%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.7438, Accuracy: 58/10000 (0.5800%)
time spent on training: 222.93516564369202
[rfa agg] training data poison_ratio: 0.09266276265931794  data num: [460, 1949, 807, 636, 311, 901, 1154, 735, 953, 803]
[rfa agg] considering poison per batch poison_fraction: 0.028957113331036857
[rfa agg] init. name: [31, 21, 20, 52, 96, 4, 15, 32, 64, 58], weight: tensor([0.0528, 0.2238, 0.0927, 0.0730, 0.0357, 0.1035, 0.1325, 0.0844, 0.1094,
        0.0922])
[rfa agg] iter:  0, prev_obj_val: 59.73855972290039, obj_val: 61.426856994628906, abs dis: 1.6882972717285156
[rfa agg] iter: 0, weight: tensor([0.0273, 0.0573, 0.1162, 0.0498, 0.0130, 0.1763, 0.1228, 0.0886, 0.2262,
        0.1224])
[rfa agg] iter:  1, prev_obj_val: 61.426856994628906, obj_val: 64.83586883544922, abs dis: 3.4090118408203125
[rfa agg] iter: 1, weight: tensor([0.0331, 0.0413, 0.1573, 0.0672, 0.0139, 0.1216, 0.0683, 0.1553, 0.1461,
        0.1959])
[rfa agg] iter:  2, prev_obj_val: 64.83586883544922, obj_val: 69.8131332397461, abs dis: 4.977264404296875
[rfa agg] iter: 2, weight: tensor([0.0413, 0.0402, 0.1526, 0.0885, 0.0160, 0.0962, 0.0609, 0.2114, 0.1101,
        0.1828])
[rfa agg] iter:  3, prev_obj_val: 69.8131332397461, obj_val: 75.73814392089844, abs dis: 5.925010681152344
[rfa agg] iter: 3, weight: tensor([0.0598, 0.0440, 0.1358, 0.1317, 0.0210, 0.0896, 0.0623, 0.2074, 0.0999,
        0.1485])
[rfa agg] iter:  4, prev_obj_val: 75.73814392089844, obj_val: 72.65841674804688, abs dis: 3.0797271728515625
[rfa agg] iter: 4, weight: tensor([0.0905, 0.0482, 0.1198, 0.1802, 0.0279, 0.0861, 0.0644, 0.1630, 0.0945,
        0.1255])
[rfa agg] iter:  5, prev_obj_val: 72.65841674804688, obj_val: 69.80106353759766, abs dis: 2.8573532104492188
[rfa agg] iter: 5, weight: tensor([0.0744, 0.0459, 0.1248, 0.1728, 0.0243, 0.0872, 0.0630, 0.1783, 0.0962,
        0.1331])
[rfa agg] iter:  6, prev_obj_val: 69.80106353759766, obj_val: 75.73104095458984, abs dis: 5.9299774169921875
[rfa agg] iter: 6, weight: tensor([0.0606, 0.0439, 0.1329, 0.1436, 0.0211, 0.0892, 0.0621, 0.2025, 0.0993,
        0.1448])
[rfa agg] iter:  7, prev_obj_val: 75.73104095458984, obj_val: 72.65875244140625, abs dis: 3.0722885131835938
[rfa agg] iter: 7, weight: tensor([0.0904, 0.0481, 0.1193, 0.1825, 0.0278, 0.0859, 0.0642, 0.1623, 0.0942,
        0.1251])
[rfa agg] iter:  8, prev_obj_val: 72.65875244140625, obj_val: 69.80120849609375, abs dis: 2.8575439453125
[rfa agg] iter: 8, weight: tensor([0.0744, 0.0459, 0.1247, 0.1732, 0.0243, 0.0871, 0.0630, 0.1782, 0.0962,
        0.1330])
[rfa agg] iter:  9, prev_obj_val: 69.80120849609375, obj_val: 75.73100280761719, abs dis: 5.9297943115234375
[rfa agg] iter: 9, weight: tensor([0.0606, 0.0439, 0.1328, 0.1437, 0.0211, 0.0892, 0.0621, 0.2025, 0.0993,
        0.1448])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.8086, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 4.4206, Accuracy: 0/9950 (0.0000%)
saving model
Done in 337.2093403339386 sec.
Server Epoch:45 choose agents : [36, 57, 29, 82, 27, 2, 96, 56, 14, 20].
_Train Local_ResNet_18, epoch  45, local model 36, internal_epoch   1, Avg loss: 0.0916, Accuracy: 41/408 (10.0490%)
_Train Local_ResNet_18, epoch  45, local model 36, internal_epoch   2, Avg loss: 0.0586, Accuracy: 150/408 (36.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.3041, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  45, local model 57, internal_epoch   1, Avg loss: 0.0615, Accuracy: 282/1154 (24.4367%)
_Train Local_ResNet_18, epoch  45, local model 57, internal_epoch   2, Avg loss: 0.0295, Accuracy: 410/1154 (35.5286%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.3036, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   1, Avg loss: 0.0555, Accuracy: 375/1440 (26.0417%)
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   2, Avg loss: 0.0289, Accuracy: 649/1440 (45.0694%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.5330, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  45, local model 82, internal_epoch   1, Avg loss: 0.0697, Accuracy: 64/500 (12.8000%)
_Train Local_ResNet_18, epoch  45, local model 82, internal_epoch   2, Avg loss: 0.0463, Accuracy: 202/500 (40.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.9288, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   1, Avg loss: 0.0641, Accuracy: 324/1587 (20.4159%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   2, Avg loss: 0.0365, Accuracy: 554/1587 (34.9086%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.3520, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   1, Avg loss: 0.0695, Accuracy: 139/605 (22.9752%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   2, Avg loss: 0.0420, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.0553, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 96, internal_epoch   1, Avg loss: 0.0860, Accuracy: 23/311 (7.3955%)
_Train Local_ResNet_18, epoch  45, local model 96, internal_epoch   2, Avg loss: 0.0601, Accuracy: 121/311 (38.9068%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.2288, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   1, Avg loss: 0.0797, Accuracy: 4/186 (2.1505%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   2, Avg loss: 0.0644, Accuracy: 41/186 (22.0430%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.8369, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   1, Avg loss: 0.0638, Accuracy: 175/1013 (17.2754%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   2, Avg loss: 0.0378, Accuracy: 337/1013 (33.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.8205, Accuracy: 76/10000 (0.7600%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  45, local model 20, internal_epoch   1, Avg loss: 0.0621, Accuracy: 244/807 (30.2354%)
_Train Local_ResNet_18, epoch  45, local model 20, internal_epoch   2, Avg loss: 0.0316, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.3629, Accuracy: 77/10000 (0.7700%)
time spent on training: 208.9032700061798
[rfa agg] training data poison_ratio: 0.10073648732992135  data num: [408, 1154, 1440, 500, 1587, 605, 311, 186, 1013, 807]
[rfa agg] considering poison per batch poison_fraction: 0.03148015229060042
[rfa agg] init. name: [36, 57, 29, 82, 27, 2, 96, 56, 14, 20], weight: tensor([0.0509, 0.1441, 0.1798, 0.0624, 0.1981, 0.0755, 0.0388, 0.0232, 0.1265,
        0.1007])
[rfa agg] iter:  0, prev_obj_val: 61.73975372314453, obj_val: 64.26366424560547, abs dis: 2.5239105224609375
[rfa agg] iter: 0, weight: tensor([0.0332, 0.1377, 0.1043, 0.0470, 0.0942, 0.0801, 0.0197, 0.0094, 0.2695,
        0.2048])
[rfa agg] iter:  1, prev_obj_val: 64.26366424560547, obj_val: 65.81649017333984, abs dis: 1.552825927734375
[rfa agg] iter: 1, weight: tensor([0.0370, 0.1166, 0.0916, 0.0534, 0.0842, 0.0966, 0.0213, 0.0099, 0.2149,
        0.2744])
[rfa agg] iter:  2, prev_obj_val: 65.81649017333984, obj_val: 67.58558654785156, abs dis: 1.7690963745117188
[rfa agg] iter: 2, weight: tensor([0.0392, 0.1063, 0.0857, 0.0573, 0.0794, 0.1079, 0.0221, 0.0102, 0.1808,
        0.3110])
[rfa agg] iter:  3, prev_obj_val: 67.58558654785156, obj_val: 67.58085632324219, abs dis: 0.004730224609375
[rfa agg] iter: 3, weight: tensor([0.0427, 0.1001, 0.0825, 0.0634, 0.0769, 0.1248, 0.0236, 0.0107, 0.1599,
        0.3153])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.7912, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 4.6707, Accuracy: 0/9950 (0.0000%)
saving model
Done in 321.7438790798187 sec.
Server Epoch:46 choose agents : [14, 62, 77, 99, 54, 16, 76, 98, 91, 39].
_Train Local_ResNet_18, epoch  46, local model 14, internal_epoch   1, Avg loss: 0.0637, Accuracy: 181/1013 (17.8677%)
_Train Local_ResNet_18, epoch  46, local model 14, internal_epoch   2, Avg loss: 0.0371, Accuracy: 353/1013 (34.8470%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.0731, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  46, local model 62, internal_epoch   1, Avg loss: 0.0744, Accuracy: 77/568 (13.5563%)
_Train Local_ResNet_18, epoch  46, local model 62, internal_epoch   2, Avg loss: 0.0425, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.8673, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  46, local model 77, internal_epoch   1, Avg loss: 0.0626, Accuracy: 249/1340 (18.5821%)
_Train Local_ResNet_18, epoch  46, local model 77, internal_epoch   2, Avg loss: 0.0282, Accuracy: 582/1340 (43.4328%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.7563, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  46, local model 99, internal_epoch   1, Avg loss: 0.0729, Accuracy: 161/773 (20.8279%)
_Train Local_ResNet_18, epoch  46, local model 99, internal_epoch   2, Avg loss: 0.0343, Accuracy: 408/773 (52.7814%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.7091, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   1, Avg loss: 0.0688, Accuracy: 258/1130 (22.8319%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   2, Avg loss: 0.0309, Accuracy: 447/1130 (39.5575%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.9199, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0656, Accuracy: 182/708 (25.7062%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0408, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.7851, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  46, local model 76, internal_epoch   1, Avg loss: 0.0989, Accuracy: 3/466 (0.6438%)
_Train Local_ResNet_18, epoch  46, local model 76, internal_epoch   2, Avg loss: 0.0551, Accuracy: 159/466 (34.1202%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.3443, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  46, local model 98, internal_epoch   1, Avg loss: 0.0874, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  46, local model 98, internal_epoch   2, Avg loss: 0.0500, Accuracy: 137/373 (36.7292%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.8916, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   1, Avg loss: 0.0607, Accuracy: 252/1030 (24.4660%)
_Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   2, Avg loss: 0.0294, Accuracy: 588/1030 (57.0874%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.5723, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   1, Avg loss: 0.0505, Accuracy: 304/1013 (30.0099%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   2, Avg loss: 0.0267, Accuracy: 498/1013 (49.1609%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.7688, Accuracy: 70/10000 (0.7000%)
time spent on training: 207.40645098686218
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 568, 1340, 773, 1130, 708, 466, 373, 1030, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [14, 62, 77, 99, 54, 16, 76, 98, 91, 39], weight: tensor([0.1204, 0.0675, 0.1593, 0.0919, 0.1343, 0.0841, 0.0554, 0.0443, 0.1224,
        0.1204])
[rfa agg] iter:  0, prev_obj_val: 44.604583740234375, obj_val: 44.48016357421875, abs dis: 0.124420166015625
[rfa agg] iter: 0, weight: tensor([0.1265, 0.0725, 0.0751, 0.1741, 0.0951, 0.1589, 0.0466, 0.0259, 0.0982,
        0.1271])
[rfa agg] iter:  1, prev_obj_val: 44.48016357421875, obj_val: 46.60865020751953, abs dis: 2.1284866333007812
[rfa agg] iter: 1, weight: tensor([0.1231, 0.0703, 0.0727, 0.1832, 0.0919, 0.1692, 0.0453, 0.0253, 0.0952,
        0.1238])
[rfa agg] iter:  2, prev_obj_val: 46.60865020751953, obj_val: 48.9578742980957, abs dis: 2.349224090576172
[rfa agg] iter: 2, weight: tensor([0.1143, 0.0822, 0.0714, 0.1758, 0.0881, 0.1830, 0.0516, 0.0280, 0.0908,
        0.1148])
[rfa agg] iter:  3, prev_obj_val: 48.9578742980957, obj_val: 51.49843215942383, abs dis: 2.540557861328125
[rfa agg] iter: 3, weight: tensor([0.1077, 0.0986, 0.0708, 0.1621, 0.0855, 0.1880, 0.0599, 0.0314, 0.0877,
        0.1083])
[rfa agg] iter:  4, prev_obj_val: 51.49843215942383, obj_val: 48.958248138427734, abs dis: 2.5401840209960938
[rfa agg] iter: 4, weight: tensor([0.1026, 0.1205, 0.0704, 0.1480, 0.0835, 0.1807, 0.0704, 0.0355, 0.0852,
        0.1031])
[rfa agg] iter:  5, prev_obj_val: 48.958248138427734, obj_val: 51.497501373291016, abs dis: 2.5392532348632812
[rfa agg] iter: 5, weight: tensor([0.1077, 0.1005, 0.0708, 0.1587, 0.0856, 0.1884, 0.0606, 0.0317, 0.0877,
        0.1084])
[rfa agg] iter:  6, prev_obj_val: 51.497501373291016, obj_val: 48.958309173583984, abs dis: 2.5391921997070312
[rfa agg] iter: 6, weight: tensor([0.1026, 0.1206, 0.0704, 0.1477, 0.0835, 0.1808, 0.0705, 0.0355, 0.0852,
        0.1031])
[rfa agg] iter:  7, prev_obj_val: 48.958309173583984, obj_val: 51.49749755859375, abs dis: 2.5391883850097656
[rfa agg] iter: 7, weight: tensor([0.1077, 0.1005, 0.0708, 0.1586, 0.0856, 0.1885, 0.0606, 0.0317, 0.0877,
        0.1084])
[rfa agg] iter:  8, prev_obj_val: 51.49749755859375, obj_val: 48.95831298828125, abs dis: 2.5391845703125
[rfa agg] iter: 8, weight: tensor([0.1026, 0.1206, 0.0704, 0.1477, 0.0835, 0.1808, 0.0705, 0.0355, 0.0852,
        0.1031])
[rfa agg] iter:  9, prev_obj_val: 48.95831298828125, obj_val: 51.49749755859375, abs dis: 2.5391845703125
[rfa agg] iter: 9, weight: tensor([0.1077, 0.1005, 0.0708, 0.1586, 0.0856, 0.1885, 0.0606, 0.0317, 0.0877,
        0.1084])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.7807, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 4.2444, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.49492621421814 sec.
Server Epoch:47 choose agents : [50, 12, 17, 66, 78, 95, 72, 32, 76, 26].
_Train Local_ResNet_18, epoch  47, local model 50, internal_epoch   1, Avg loss: 0.0702, Accuracy: 125/809 (15.4512%)
_Train Local_ResNet_18, epoch  47, local model 50, internal_epoch   2, Avg loss: 0.0289, Accuracy: 326/809 (40.2967%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.1638, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0896, Accuracy: 3/338 (0.8876%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0474, Accuracy: 144/338 (42.6036%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.3111, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0623, Accuracy: 297/1574 (18.8691%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0296, Accuracy: 613/1574 (38.9454%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.4720, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   1, Avg loss: 0.0686, Accuracy: 187/1402 (13.3381%)
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   2, Avg loss: 0.0411, Accuracy: 366/1402 (26.1056%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.3637, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   1, Avg loss: 0.0863, Accuracy: 23/416 (5.5288%)
_Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   2, Avg loss: 0.0499, Accuracy: 175/416 (42.0673%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.9605, Accuracy: 70/10000 (0.7000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   1, Avg loss: 0.0478, Accuracy: 295/599 (49.2487%)
_Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   2, Avg loss: 0.0306, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 12.9673, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   1, Avg loss: 0.0685, Accuracy: 204/1241 (16.4384%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   2, Avg loss: 0.0395, Accuracy: 348/1241 (28.0419%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.7062, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   1, Avg loss: 0.0501, Accuracy: 183/735 (24.8980%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 349/735 (47.4830%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 12.0787, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0956, Accuracy: 2/466 (0.4292%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0515, Accuracy: 169/466 (36.2661%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.0451, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0583, Accuracy: 290/1446 (20.0553%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0364, Accuracy: 480/1446 (33.1950%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.0948, Accuracy: 62/10000 (0.6200%)
time spent on training: 219.42311072349548
[rfa agg] training data poison_ratio: 0.0663638378019056  data num: [809, 338, 1574, 1402, 416, 599, 1241, 735, 466, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.0207386993130955
[rfa agg] init. name: [50, 12, 17, 66, 78, 95, 72, 32, 76, 26], weight: tensor([0.0896, 0.0374, 0.1744, 0.1553, 0.0461, 0.0664, 0.1375, 0.0814, 0.0516,
        0.1602])
[rfa agg] iter:  0, prev_obj_val: 62.58933639526367, obj_val: 63.72935485839844, abs dis: 1.1400184631347656
[rfa agg] iter: 0, weight: tensor([0.1913, 0.0237, 0.1016, 0.1268, 0.0328, 0.0734, 0.1502, 0.1434, 0.0422,
        0.1146])
[rfa agg] iter:  1, prev_obj_val: 63.72935485839844, obj_val: 68.02879333496094, abs dis: 4.2994384765625
[rfa agg] iter: 1, weight: tensor([0.2244, 0.0238, 0.0919, 0.1128, 0.0332, 0.0768, 0.1319, 0.1595, 0.0430,
        0.1027])
[rfa agg] iter:  2, prev_obj_val: 68.02879333496094, obj_val: 71.82083129882812, abs dis: 3.7920379638671875
[rfa agg] iter: 2, weight: tensor([0.2672, 0.0240, 0.0685, 0.0805, 0.0343, 0.0898, 0.0899, 0.2250, 0.0462,
        0.0746])
[rfa agg] iter:  3, prev_obj_val: 71.82083129882812, obj_val: 76.61172485351562, abs dis: 4.7908935546875
[rfa agg] iter: 3, weight: tensor([0.2257, 0.0260, 0.0596, 0.0684, 0.0379, 0.1111, 0.0745, 0.2800, 0.0528,
        0.0641])
[rfa agg] iter:  4, prev_obj_val: 76.61172485351562, obj_val: 76.58345031738281, abs dis: 0.0282745361328125
[rfa agg] iter: 4, weight: tensor([0.1718, 0.0327, 0.0598, 0.0673, 0.0490, 0.1601, 0.0719, 0.2524, 0.0716,
        0.0635])
[rfa agg] iter:  5, prev_obj_val: 76.58345031738281, obj_val: 79.2535400390625, abs dis: 2.6700897216796875
[rfa agg] iter: 5, weight: tensor([0.1674, 0.0328, 0.0596, 0.0671, 0.0494, 0.1692, 0.0717, 0.2471, 0.0724,
        0.0634])
[rfa agg] iter:  6, prev_obj_val: 79.2535400390625, obj_val: 82.06598663330078, abs dis: 2.8124465942382812
[rfa agg] iter: 6, weight: tensor([0.1504, 0.0371, 0.0598, 0.0668, 0.0568, 0.1995, 0.0708, 0.2097, 0.0858,
        0.0633])
[rfa agg] iter:  7, prev_obj_val: 82.06598663330078, obj_val: 82.05511474609375, abs dis: 0.01087188720703125
[rfa agg] iter: 7, weight: tensor([0.1342, 0.0417, 0.0592, 0.0655, 0.0653, 0.2255, 0.0689, 0.1750, 0.1023,
        0.0623])
[rfa agg] iter:  8, prev_obj_val: 82.05511474609375, obj_val: 82.05467987060547, abs dis: 0.00043487548828125
[rfa agg] iter: 8, weight: tensor([0.1321, 0.0415, 0.0586, 0.0648, 0.0652, 0.2348, 0.0682, 0.1704, 0.1027,
        0.0617])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.7991, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 4.1579, Accuracy: 0/9950 (0.0000%)
saving model
Done in 336.48385310173035 sec.
Server Epoch:48 choose agents : [84, 55, 13, 42, 91, 4, 11, 19, 73, 61].
_Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   1, Avg loss: 0.0638, Accuracy: 266/1190 (22.3529%)
_Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 447/1190 (37.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.7225, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   1, Avg loss: 0.0545, Accuracy: 220/1071 (20.5415%)
_Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   2, Avg loss: 0.0299, Accuracy: 490/1071 (45.7516%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.5531, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  48, local model 13, internal_epoch   1, Avg loss: 0.0669, Accuracy: 309/1645 (18.7842%)
_Train Local_ResNet_18, epoch  48, local model 13, internal_epoch   2, Avg loss: 0.0344, Accuracy: 566/1645 (34.4073%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.8440, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   1, Avg loss: 0.0561, Accuracy: 260/1372 (18.9504%)
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   2, Avg loss: 0.0337, Accuracy: 463/1372 (33.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.6660, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  48, local model 91, internal_epoch   1, Avg loss: 0.0580, Accuracy: 267/1030 (25.9223%)
_Train Local_ResNet_18, epoch  48, local model 91, internal_epoch   2, Avg loss: 0.0300, Accuracy: 577/1030 (56.0194%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 11.2885, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   1, Avg loss: 0.0617, Accuracy: 275/901 (30.5216%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   2, Avg loss: 0.0332, Accuracy: 403/901 (44.7281%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.4581, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   1, Avg loss: 0.0513, Accuracy: 273/712 (38.3427%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   2, Avg loss: 0.0239, Accuracy: 438/712 (61.5169%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 11.0362, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0538, Accuracy: 329/1036 (31.7568%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0264, Accuracy: 629/1036 (60.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 13.5099, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   1, Avg loss: 0.0792, Accuracy: 103/938 (10.9808%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   2, Avg loss: 0.0359, Accuracy: 336/938 (35.8209%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.8203, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   1, Avg loss: 0.1433, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   2, Avg loss: 0.1335, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.8821, Accuracy: 47/10000 (0.4700%)
time spent on training: 234.28451991081238
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 1071, 1645, 1372, 1030, 901, 712, 1036, 938, 85]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 55, 13, 42, 91, 4, 11, 19, 73, 61], weight: tensor([0.1192, 0.1073, 0.1648, 0.1375, 0.1032, 0.0903, 0.0713, 0.1038, 0.0940,
        0.0085])
[rfa agg] iter:  0, prev_obj_val: 43.01903533935547, obj_val: 46.63810348510742, abs dis: 3.619068145751953
[rfa agg] iter: 0, weight: tensor([0.1044, 0.1523, 0.0574, 0.0759, 0.1287, 0.1340, 0.0568, 0.1398, 0.1488,
        0.0020])
[rfa agg] iter:  1, prev_obj_val: 46.63810348510742, obj_val: 51.967369079589844, abs dis: 5.329265594482422
[rfa agg] iter: 1, weight: tensor([0.0900, 0.1333, 0.0533, 0.0673, 0.1134, 0.1640, 0.0713, 0.1246, 0.1807,
        0.0021])
[rfa agg] iter:  2, prev_obj_val: 51.967369079589844, obj_val: 49.120567321777344, abs dis: 2.8468017578125
[rfa agg] iter: 2, weight: tensor([0.0852, 0.1181, 0.0549, 0.0668, 0.1045, 0.1699, 0.1008, 0.1118, 0.1855,
        0.0025])
[rfa agg] iter:  3, prev_obj_val: 49.120567321777344, obj_val: 49.11841583251953, abs dis: 0.0021514892578125
[rfa agg] iter: 3, weight: tensor([0.0856, 0.1221, 0.0532, 0.0659, 0.1063, 0.1738, 0.0845, 0.1147, 0.1916,
        0.0023])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 23.3600, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 15.7818, Accuracy: 0/9950 (0.0000%)
saving model
Done in 347.6249918937683 sec.
Server Epoch:49 choose agents : [98, 39, 95, 2, 31, 41, 85, 0, 18, 69].
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   1, Avg loss: 0.0857, Accuracy: 3/373 (0.8043%)
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   2, Avg loss: 0.0495, Accuracy: 139/373 (37.2654%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.7907, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  49, local model 39, internal_epoch   1, Avg loss: 0.0491, Accuracy: 305/1013 (30.1086%)
_Train Local_ResNet_18, epoch  49, local model 39, internal_epoch   2, Avg loss: 0.0271, Accuracy: 489/1013 (48.2725%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.7167, Accuracy: 59/10000 (0.5900%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  49, local model 95, internal_epoch   1, Avg loss: 0.0447, Accuracy: 319/599 (53.2554%)
_Train Local_ResNet_18, epoch  49, local model 95, internal_epoch   2, Avg loss: 0.0283, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 14.0255, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0695, Accuracy: 141/605 (23.3058%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0417, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.6020, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   1, Avg loss: 0.0899, Accuracy: 5/460 (1.0870%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   2, Avg loss: 0.0398, Accuracy: 181/460 (39.3478%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.0696, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0657, Accuracy: 237/719 (32.9624%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0326, Accuracy: 458/719 (63.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.3822, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  49, local model 85, internal_epoch   1, Avg loss: 0.0546, Accuracy: 374/1988 (18.8129%)
_Train Local_ResNet_18, epoch  49, local model 85, internal_epoch   2, Avg loss: 0.0373, Accuracy: 573/1988 (28.8229%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.8241, Accuracy: 80/10000 (0.8000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  49, local model 0, internal_epoch   1, Avg loss: 0.0694, Accuracy: 294/1657 (17.7429%)
_Train Local_ResNet_18, epoch  49, local model 0, internal_epoch   2, Avg loss: 0.0375, Accuracy: 466/1657 (28.1231%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.5680, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0990, Accuracy: 16/530 (3.0189%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0439, Accuracy: 280/530 (52.8302%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.5931, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   1, Avg loss: 0.0616, Accuracy: 215/590 (36.4407%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   2, Avg loss: 0.0330, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 12.7030, Accuracy: 50/10000 (0.5000%)
time spent on training: 235.45165467262268
[rfa agg] training data poison_ratio: 0.2643543473166159  data num: [373, 1013, 599, 605, 460, 719, 1988, 1657, 530, 590]
[rfa agg] considering poison per batch poison_fraction: 0.08261073353644247
[rfa agg] init. name: [98, 39, 95, 2, 31, 41, 85, 0, 18, 69], weight: tensor([0.0437, 0.1187, 0.0702, 0.0709, 0.0539, 0.0843, 0.2330, 0.1942, 0.0621,
        0.0691])
[rfa agg] iter:  0, prev_obj_val: 81.4903564453125, obj_val: 82.7284164428711, abs dis: 1.2380599975585938
[rfa agg] iter: 0, weight: tensor([0.0253, 0.3719, 0.0647, 0.0651, 0.0387, 0.1032, 0.0928, 0.1243, 0.0503,
        0.0638])
[rfa agg] iter:  1, prev_obj_val: 82.7284164428711, obj_val: 86.0321044921875, abs dis: 3.3036880493164062
[rfa agg] iter: 1, weight: tensor([0.0305, 0.2326, 0.0978, 0.0974, 0.0513, 0.1693, 0.0692, 0.0849, 0.0707,
        0.0963])
[rfa agg] iter:  2, prev_obj_val: 86.0321044921875, obj_val: 90.7992935180664, abs dis: 4.767189025878906
[rfa agg] iter: 2, weight: tensor([0.0326, 0.1120, 0.1389, 0.1344, 0.0619, 0.1805, 0.0509, 0.0598, 0.0919,
        0.1371])
[rfa agg] iter:  3, prev_obj_val: 90.7992935180664, obj_val: 90.7327651977539, abs dis: 0.0665283203125
[rfa agg] iter: 3, weight: tensor([0.0356, 0.0718, 0.1672, 0.1568, 0.0783, 0.1148, 0.0400, 0.0457, 0.1215,
        0.1684])
[rfa agg] iter:  4, prev_obj_val: 90.7327651977539, obj_val: 90.73218536376953, abs dis: 0.000579833984375
[rfa agg] iter: 4, weight: tensor([0.0352, 0.0697, 0.1682, 0.1611, 0.0782, 0.1078, 0.0390, 0.0446, 0.1235,
        0.1728])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8053, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 4.0968, Accuracy: 0/9950 (0.0000%)
saving model
Done in 349.9630374908447 sec.
Server Epoch:50 choose agents : [11, 22, 40, 49, 83, 52, 64, 6, 61, 8].
_Train Local_ResNet_18, epoch  50, local model 11, internal_epoch   1, Avg loss: 0.0538, Accuracy: 264/712 (37.0787%)
_Train Local_ResNet_18, epoch  50, local model 11, internal_epoch   2, Avg loss: 0.0257, Accuracy: 424/712 (59.5506%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.5565, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   1, Avg loss: 0.0507, Accuracy: 433/1470 (29.4558%)
_Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   2, Avg loss: 0.0262, Accuracy: 794/1470 (54.0136%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.3104, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   1, Avg loss: 0.0627, Accuracy: 315/1573 (20.0254%)
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   2, Avg loss: 0.0376, Accuracy: 494/1573 (31.4050%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.0813, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   1, Avg loss: 0.0740, Accuracy: 53/440 (12.0455%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   2, Avg loss: 0.0466, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.6145, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  50, local model 83, internal_epoch   1, Avg loss: 0.0644, Accuracy: 324/1953 (16.5899%)
_Train Local_ResNet_18, epoch  50, local model 83, internal_epoch   2, Avg loss: 0.0354, Accuracy: 715/1953 (36.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.4222, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0641, Accuracy: 188/636 (29.5597%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0343, Accuracy: 426/636 (66.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.5271, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   1, Avg loss: 0.0706, Accuracy: 126/953 (13.2214%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   2, Avg loss: 0.0402, Accuracy: 303/953 (31.7943%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.6780, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   1, Avg loss: 0.0633, Accuracy: 297/1956 (15.1840%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   2, Avg loss: 0.0336, Accuracy: 629/1956 (32.1575%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.9782, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   1, Avg loss: 0.1472, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   2, Avg loss: 0.1351, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.9624, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   1, Avg loss: 0.0660, Accuracy: 205/1513 (13.5492%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   2, Avg loss: 0.0400, Accuracy: 397/1513 (26.2393%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.3726, Accuracy: 84/10000 (0.8400%)
time spent on training: 262.10011196136475
[rfa agg] training data poison_ratio: 0.0  data num: [712, 1470, 1573, 440, 1953, 636, 953, 1956, 85, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 22, 40, 49, 83, 52, 64, 6, 61, 8], weight: tensor([0.0631, 0.1302, 0.1393, 0.0390, 0.1730, 0.0563, 0.0844, 0.1732, 0.0075,
        0.1340])
[rfa agg] iter:  0, prev_obj_val: 70.13101959228516, obj_val: 68.04695892333984, abs dis: 2.0840606689453125
[rfa agg] iter: 0, weight: tensor([0.0457, 0.2349, 0.1705, 0.0180, 0.1014, 0.0331, 0.0911, 0.1024, 0.0024,
        0.2004])
[rfa agg] iter:  1, prev_obj_val: 68.04695892333984, obj_val: 68.04021453857422, abs dis: 0.006744384765625
[rfa agg] iter: 1, weight: tensor([0.0395, 0.2589, 0.1726, 0.0159, 0.0965, 0.0289, 0.0772, 0.0976, 0.0022,
        0.2108])
[rfa agg] iter:  2, prev_obj_val: 68.04021453857422, obj_val: 66.26565551757812, abs dis: 1.7745590209960938
[rfa agg] iter: 2, weight: tensor([0.0392, 0.2619, 0.1718, 0.0158, 0.0960, 0.0288, 0.0766, 0.0971, 0.0022,
        0.2106])
[rfa agg] iter:  3, prev_obj_val: 66.26565551757812, obj_val: 69.93282318115234, abs dis: 3.6671676635742188
[rfa agg] iter: 3, weight: tensor([0.0347, 0.2747, 0.1751, 0.0142, 0.0935, 0.0257, 0.0663, 0.0947, 0.0020,
        0.2192])
[rfa agg] iter:  4, prev_obj_val: 69.93282318115234, obj_val: 66.27387237548828, abs dis: 3.6589508056640625
[rfa agg] iter: 4, weight: tensor([0.0440, 0.2497, 0.1677, 0.0175, 0.0978, 0.0320, 0.0878, 0.0988, 0.0024,
        0.2022])
[rfa agg] iter:  5, prev_obj_val: 66.27387237548828, obj_val: 68.04225158691406, abs dis: 1.7683792114257812
[rfa agg] iter: 5, weight: tensor([0.0348, 0.2729, 0.1756, 0.0143, 0.0938, 0.0258, 0.0667, 0.0951, 0.0020,
        0.2191])
[rfa agg] iter:  6, prev_obj_val: 68.04225158691406, obj_val: 66.26532745361328, abs dis: 1.7769241333007812
[rfa agg] iter: 6, weight: tensor([0.0391, 0.2636, 0.1713, 0.0158, 0.0957, 0.0287, 0.0762, 0.0968, 0.0022,
        0.2107])
[rfa agg] iter:  7, prev_obj_val: 66.26532745361328, obj_val: 69.93289184570312, abs dis: 3.6675643920898438
[rfa agg] iter: 7, weight: tensor([0.0347, 0.2750, 0.1750, 0.0142, 0.0934, 0.0257, 0.0663, 0.0946, 0.0020,
        0.2191])
[rfa agg] iter:  8, prev_obj_val: 69.93289184570312, obj_val: 66.27386474609375, abs dis: 3.659027099609375
[rfa agg] iter: 8, weight: tensor([0.0440, 0.2498, 0.1677, 0.0175, 0.0978, 0.0320, 0.0878, 0.0988, 0.0024,
        0.2022])
[rfa agg] iter:  9, prev_obj_val: 66.27386474609375, obj_val: 68.04225158691406, abs dis: 1.7683868408203125
[rfa agg] iter: 9, weight: tensor([0.0348, 0.2729, 0.1756, 0.0143, 0.0938, 0.0258, 0.0667, 0.0951, 0.0020,
        0.2191])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.8133, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 4.6964, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 374.7142298221588 sec.
Server Epoch:51 choose agents : [40, 71, 49, 42, 5, 57, 22, 34, 60, 12].
_Train Local_ResNet_18, epoch  51, local model 40, internal_epoch   1, Avg loss: 0.0626, Accuracy: 293/1573 (18.6268%)
_Train Local_ResNet_18, epoch  51, local model 40, internal_epoch   2, Avg loss: 0.0367, Accuracy: 548/1573 (34.8379%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.0190, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0645, Accuracy: 134/818 (16.3814%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0322, Accuracy: 340/818 (41.5648%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.3680, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  51, local model 49, internal_epoch   1, Avg loss: 0.0745, Accuracy: 45/440 (10.2273%)
_Train Local_ResNet_18, epoch  51, local model 49, internal_epoch   2, Avg loss: 0.0464, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.4357, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0567, Accuracy: 254/1372 (18.5131%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0333, Accuracy: 480/1372 (34.9854%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.7100, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   1, Avg loss: 0.0518, Accuracy: 356/1628 (21.8673%)
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   2, Avg loss: 0.0258, Accuracy: 767/1628 (47.1130%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.9189, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   1, Avg loss: 0.0611, Accuracy: 261/1154 (22.6170%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   2, Avg loss: 0.0278, Accuracy: 476/1154 (41.2478%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 11.1048, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   1, Avg loss: 0.0490, Accuracy: 419/1470 (28.5034%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   2, Avg loss: 0.0255, Accuracy: 829/1470 (56.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.5663, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   1, Avg loss: 0.0662, Accuracy: 298/1427 (20.8830%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   2, Avg loss: 0.0356, Accuracy: 539/1427 (37.7715%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.1783, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   1, Avg loss: 0.0524, Accuracy: 516/2227 (23.1702%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   2, Avg loss: 0.0302, Accuracy: 940/2227 (42.2093%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.9454, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   1, Avg loss: 0.0935, Accuracy: 4/338 (1.1834%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   2, Avg loss: 0.0475, Accuracy: 137/338 (40.5325%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.5461, Accuracy: 50/10000 (0.5000%)
time spent on training: 270.51902770996094
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 818, 440, 1372, 1628, 1154, 1470, 1427, 2227, 338]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 71, 49, 42, 5, 57, 22, 34, 60, 12], weight: tensor([0.1264, 0.0657, 0.0353, 0.1102, 0.1308, 0.0927, 0.1181, 0.1146, 0.1789,
        0.0272])
[rfa agg] iter:  0, prev_obj_val: 60.6927604675293, obj_val: 62.415340423583984, abs dis: 1.7225799560546875
[rfa agg] iter: 0, weight: tensor([0.1292, 0.0382, 0.0119, 0.1817, 0.1113, 0.1166, 0.1767, 0.1656, 0.0605,
        0.0085])
[rfa agg] iter:  1, prev_obj_val: 62.415340423583984, obj_val: 60.4641227722168, abs dis: 1.9512176513671875
[rfa agg] iter: 1, weight: tensor([0.1223, 0.0418, 0.0128, 0.1844, 0.1062, 0.1311, 0.1709, 0.1613, 0.0602,
        0.0091])
[rfa agg] iter:  2, prev_obj_val: 60.4641227722168, obj_val: 60.460601806640625, abs dis: 0.003520965576171875
[rfa agg] iter: 2, weight: tensor([0.1256, 0.0371, 0.0116, 0.1880, 0.1078, 0.1171, 0.1781, 0.1675, 0.0588,
        0.0083])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.7912, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 4.4638, Accuracy: 0/9950 (0.0000%)
saving model
Done in 383.6345672607422 sec.
Server Epoch:52 choose agents : [72, 7, 94, 91, 34, 85, 61, 58, 18, 42].
_Train Local_ResNet_18, epoch  52, local model 72, internal_epoch   1, Avg loss: 0.0643, Accuracy: 222/1241 (17.8888%)
_Train Local_ResNet_18, epoch  52, local model 72, internal_epoch   2, Avg loss: 0.0391, Accuracy: 380/1241 (30.6205%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3812, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0564, Accuracy: 273/891 (30.6397%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0281, Accuracy: 419/891 (47.0258%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.3096, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  52, local model 94, internal_epoch   1, Avg loss: 0.0652, Accuracy: 245/1662 (14.7413%)
_Train Local_ResNet_18, epoch  52, local model 94, internal_epoch   2, Avg loss: 0.0371, Accuracy: 511/1662 (30.7461%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.7446, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  52, local model 91, internal_epoch   1, Avg loss: 0.0594, Accuracy: 263/1030 (25.5340%)
_Train Local_ResNet_18, epoch  52, local model 91, internal_epoch   2, Avg loss: 0.0291, Accuracy: 614/1030 (59.6117%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 11.4474, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   1, Avg loss: 0.0642, Accuracy: 295/1427 (20.6727%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   2, Avg loss: 0.0354, Accuracy: 533/1427 (37.3511%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.2045, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  52, local model 85, internal_epoch   1, Avg loss: 0.0553, Accuracy: 359/1988 (18.0584%)
_Train Local_ResNet_18, epoch  52, local model 85, internal_epoch   2, Avg loss: 0.0376, Accuracy: 557/1988 (28.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.7596, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1438, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1309, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.2183, Accuracy: 39/10000 (0.3900%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0659, Accuracy: 233/803 (29.0162%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0357, Accuracy: 413/803 (51.4321%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.4078, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0968, Accuracy: 17/530 (3.2075%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0409, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 11.4059, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   1, Avg loss: 0.0563, Accuracy: 236/1372 (17.2012%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   2, Avg loss: 0.0336, Accuracy: 477/1372 (34.7668%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.7486, Accuracy: 68/10000 (0.6800%)
time spent on training: 259.84429121017456
[rfa agg] training data poison_ratio: 0.0  data num: [1241, 891, 1662, 1030, 1427, 1988, 85, 803, 530, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [72, 7, 94, 91, 34, 85, 61, 58, 18, 42], weight: tensor([0.1125, 0.0808, 0.1507, 0.0934, 0.1294, 0.1803, 0.0077, 0.0728, 0.0481,
        0.1244])
[rfa agg] iter:  0, prev_obj_val: 60.735809326171875, obj_val: 60.40713119506836, abs dis: 0.3286781311035156
[rfa agg] iter: 0, weight: tensor([0.2268, 0.0747, 0.1040, 0.1328, 0.1430, 0.0690, 0.0022, 0.0598, 0.0240,
        0.1637])
[rfa agg] iter:  1, prev_obj_val: 60.40713119506836, obj_val: 60.40237045288086, abs dis: 0.0047607421875
[rfa agg] iter: 1, weight: tensor([0.2522, 0.0713, 0.0991, 0.1316, 0.1374, 0.0654, 0.0021, 0.0571, 0.0230,
        0.1608])
[rfa agg] iter:  2, prev_obj_val: 60.40237045288086, obj_val: 60.40217590332031, abs dis: 0.000194549560546875
[rfa agg] iter: 2, weight: tensor([0.2574, 0.0708, 0.0985, 0.1306, 0.1363, 0.0650, 0.0021, 0.0567, 0.0228,
        0.1598])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 22.2964, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 23.7919, Accuracy: 0/9950 (0.0000%)
saving model
Done in 371.6612617969513 sec.
Server Epoch:53 choose agents : [1, 32, 31, 44, 27, 62, 95, 28, 49, 40].
_Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   1, Avg loss: 0.0586, Accuracy: 270/928 (29.0948%)
_Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   2, Avg loss: 0.0261, Accuracy: 528/928 (56.8966%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.4378, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  53, local model 32, internal_epoch   1, Avg loss: 0.0550, Accuracy: 140/735 (19.0476%)
_Train Local_ResNet_18, epoch  53, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 330/735 (44.8980%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 12.4182, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  53, local model 31, internal_epoch   1, Avg loss: 0.0953, Accuracy: 6/460 (1.3043%)
_Train Local_ResNet_18, epoch  53, local model 31, internal_epoch   2, Avg loss: 0.0391, Accuracy: 184/460 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 11.8048, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Avg loss: 0.0688, Accuracy: 306/1750 (17.4857%)
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Avg loss: 0.0377, Accuracy: 589/1750 (33.6571%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.9903, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0648, Accuracy: 328/1587 (20.6679%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0369, Accuracy: 542/1587 (34.1525%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.1053, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0667, Accuracy: 121/568 (21.3028%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0414, Accuracy: 261/568 (45.9507%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.7937, Accuracy: 57/10000 (0.5700%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  53, local model 95, internal_epoch   1, Avg loss: 0.0443, Accuracy: 315/599 (52.5876%)
_Train Local_ResNet_18, epoch  53, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 13.6600, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   1, Avg loss: 0.0603, Accuracy: 313/1581 (19.7976%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   2, Avg loss: 0.0360, Accuracy: 535/1581 (33.8393%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.2666, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   1, Avg loss: 0.0728, Accuracy: 59/440 (13.4091%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   2, Avg loss: 0.0446, Accuracy: 156/440 (35.4545%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.1312, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0636, Accuracy: 275/1573 (17.4825%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0369, Accuracy: 499/1573 (31.7228%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0812, Accuracy: 79/10000 (0.7900%)
time spent on training: 273.71937918663025
[rfa agg] training data poison_ratio: 0.05860483318657666  data num: [928, 735, 460, 1750, 1587, 568, 599, 1581, 440, 1573]
[rfa agg] considering poison per batch poison_fraction: 0.018314010370805205
[rfa agg] init. name: [1, 32, 31, 44, 27, 62, 95, 28, 49, 40], weight: tensor([0.0908, 0.0719, 0.0450, 0.1712, 0.1553, 0.0556, 0.0586, 0.1547, 0.0430,
        0.1539])
[rfa agg] iter:  0, prev_obj_val: 72.55797576904297, obj_val: 72.4926986694336, abs dis: 0.065277099609375
[rfa agg] iter: 0, weight: tensor([0.1870, 0.0914, 0.0343, 0.1168, 0.1474, 0.0475, 0.0556, 0.1466, 0.0297,
        0.1438])
[rfa agg] iter:  1, prev_obj_val: 72.4926986694336, obj_val: 72.49225616455078, abs dis: 0.0004425048828125
[rfa agg] iter: 1, weight: tensor([0.1959, 0.0907, 0.0339, 0.1151, 0.1457, 0.0470, 0.0550, 0.1452, 0.0294,
        0.1421])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 98.5794, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 122.3432, Accuracy: 0/9950 (0.0000%)
saving model
Done in 384.5565257072449 sec.
Server Epoch:54 choose agents : [8, 16, 22, 38, 69, 90, 47, 85, 7, 94].
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0648, Accuracy: 216/1513 (14.2763%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0389, Accuracy: 419/1513 (27.6933%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5816, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   1, Avg loss: 0.0788, Accuracy: 181/708 (25.5650%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   2, Avg loss: 0.0375, Accuracy: 424/708 (59.8870%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5602, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   1, Avg loss: 0.0473, Accuracy: 432/1470 (29.3878%)
_Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   2, Avg loss: 0.0251, Accuracy: 824/1470 (56.0544%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.5296, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0771, Accuracy: 166/1131 (14.6773%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0361, Accuracy: 468/1131 (41.3793%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.0387, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   1, Avg loss: 0.0581, Accuracy: 229/590 (38.8136%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   2, Avg loss: 0.0331, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 13.5206, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   1, Avg loss: 0.0639, Accuracy: 229/677 (33.8257%)
_Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   2, Avg loss: 0.0248, Accuracy: 467/677 (68.9808%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 12.4157, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1300, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1117, Accuracy: 1/134 (0.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1992, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   1, Avg loss: 0.0546, Accuracy: 382/1988 (19.2153%)
_Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   2, Avg loss: 0.0374, Accuracy: 596/1988 (29.9799%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.6746, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 283/891 (31.7621%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 465/891 (52.1886%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.5464, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  54, local model 94, internal_epoch   1, Avg loss: 0.0654, Accuracy: 248/1662 (14.9218%)
_Train Local_ResNet_18, epoch  54, local model 94, internal_epoch   2, Avg loss: 0.0369, Accuracy: 533/1662 (32.0698%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.1331, Accuracy: 95/10000 (0.9500%)
time spent on training: 261.19505405426025
[rfa agg] training data poison_ratio: 0.0  data num: [1513, 708, 1470, 1131, 590, 677, 134, 1988, 891, 1662]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [8, 16, 22, 38, 69, 90, 47, 85, 7, 94], weight: tensor([0.1406, 0.0658, 0.1366, 0.1051, 0.0548, 0.0629, 0.0124, 0.1847, 0.0828,
        0.1544])
[rfa agg] iter:  0, prev_obj_val: 66.7181396484375, obj_val: 68.89714813232422, abs dis: 2.1790084838867188
[rfa agg] iter: 0, weight: tensor([0.1717, 0.0515, 0.1883, 0.1895, 0.0350, 0.0449, 0.0044, 0.0896, 0.0876,
        0.1374])
[rfa agg] iter:  1, prev_obj_val: 68.89714813232422, obj_val: 68.86273956298828, abs dis: 0.0344085693359375
[rfa agg] iter: 1, weight: tensor([0.1463, 0.0583, 0.1621, 0.2319, 0.0389, 0.0503, 0.0047, 0.0827, 0.1039,
        0.1210])
[rfa agg] iter:  2, prev_obj_val: 68.86273956298828, obj_val: 70.20758056640625, abs dis: 1.3448410034179688
[rfa agg] iter: 2, weight: tensor([0.1436, 0.0577, 0.1584, 0.2437, 0.0384, 0.0496, 0.0046, 0.0816, 0.1032,
        0.1192])
[rfa agg] iter:  3, prev_obj_val: 70.20758056640625, obj_val: 70.20343017578125, abs dis: 0.004150390625
[rfa agg] iter: 3, weight: tensor([0.1337, 0.0620, 0.1467, 0.2531, 0.0408, 0.0530, 0.0048, 0.0791, 0.1139,
        0.1129])
[rfa agg] iter:  4, prev_obj_val: 70.20343017578125, obj_val: 70.20328521728516, abs dis: 0.00014495849609375
[rfa agg] iter: 4, weight: tensor([0.1329, 0.0618, 0.1456, 0.2566, 0.0406, 0.0528, 0.0048, 0.0787, 0.1138,
        0.1124])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.7805, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 4.5663, Accuracy: 0/9950 (0.0000%)
saving model
Done in 372.5250623226166 sec.
Server Epoch:55 choose agents : [54, 89, 78, 16, 55, 80, 13, 61, 12, 27].
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0653, Accuracy: 285/1130 (25.2212%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0308, Accuracy: 440/1130 (38.9381%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.1879, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   1, Avg loss: 0.0582, Accuracy: 318/896 (35.4911%)
_Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 438/896 (48.8839%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.2214, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.0923, Accuracy: 2/416 (0.4808%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0510, Accuracy: 151/416 (36.2981%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.4671, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   1, Avg loss: 0.0741, Accuracy: 167/708 (23.5876%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   2, Avg loss: 0.0376, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.3628, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 238/1071 (22.2222%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0299, Accuracy: 495/1071 (46.2185%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.8999, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  55, local model 80, internal_epoch   1, Avg loss: 0.0828, Accuracy: 80/682 (11.7302%)
_Train Local_ResNet_18, epoch  55, local model 80, internal_epoch   2, Avg loss: 0.0436, Accuracy: 266/682 (39.0029%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.6438, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0667, Accuracy: 302/1645 (18.3587%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0356, Accuracy: 516/1645 (31.3678%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.1513, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   1, Avg loss: 0.1512, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   2, Avg loss: 0.1403, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.5513, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0955, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0500, Accuracy: 127/338 (37.5740%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.8231, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   1, Avg loss: 0.0634, Accuracy: 341/1587 (21.4871%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   2, Avg loss: 0.0366, Accuracy: 560/1587 (35.2867%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.3717, Accuracy: 71/10000 (0.7100%)
time spent on training: 235.72588086128235
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 896, 416, 708, 1071, 682, 1645, 85, 338, 1587]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 89, 78, 16, 55, 80, 13, 61, 12, 27], weight: tensor([0.1320, 0.1047, 0.0486, 0.0827, 0.1251, 0.0797, 0.1922, 0.0099, 0.0395,
        0.1854])
[rfa agg] iter:  0, prev_obj_val: 60.80206298828125, obj_val: 63.51287841796875, abs dis: 2.7108154296875
[rfa agg] iter: 0, weight: tensor([0.1804, 0.2013, 0.0286, 0.1062, 0.1985, 0.0881, 0.0836, 0.0034, 0.0206,
        0.0894])
[rfa agg] iter:  1, prev_obj_val: 63.51287841796875, obj_val: 65.23611450195312, abs dis: 1.723236083984375
[rfa agg] iter: 1, weight: tensor([0.1439, 0.2427, 0.0316, 0.1298, 0.1626, 0.1085, 0.0751, 0.0035, 0.0224,
        0.0798])
[rfa agg] iter:  2, prev_obj_val: 65.23611450195312, obj_val: 67.19651794433594, abs dis: 1.9604034423828125
[rfa agg] iter: 2, weight: tensor([0.1286, 0.2500, 0.0336, 0.1463, 0.1431, 0.1234, 0.0717, 0.0036, 0.0236,
        0.0760])
[rfa agg] iter:  3, prev_obj_val: 67.19651794433594, obj_val: 67.1895751953125, abs dis: 0.0069427490234375
[rfa agg] iter: 3, weight: tensor([0.1183, 0.2347, 0.0364, 0.1648, 0.1302, 0.1433, 0.0696, 0.0038, 0.0253,
        0.0735])
[rfa agg] iter:  4, prev_obj_val: 67.1895751953125, obj_val: 65.2346420288086, abs dis: 1.9549331665039062
[rfa agg] iter: 4, weight: tensor([0.1179, 0.2315, 0.0364, 0.1681, 0.1295, 0.1446, 0.0695, 0.0038, 0.0253,
        0.0734])
[rfa agg] iter:  5, prev_obj_val: 65.2346420288086, obj_val: 69.37126159667969, abs dis: 4.136619567871094
[rfa agg] iter: 5, weight: tensor([0.1274, 0.2485, 0.0335, 0.1509, 0.1407, 0.1247, 0.0714, 0.0036, 0.0236,
        0.0756])
[rfa agg] iter:  6, prev_obj_val: 69.37126159667969, obj_val: 69.34668731689453, abs dis: 0.02457427978515625
[rfa agg] iter: 6, weight: tensor([0.1105, 0.2112, 0.0397, 0.1799, 0.1207, 0.1669, 0.0681, 0.0040, 0.0274,
        0.0717])
[rfa agg] iter:  7, prev_obj_val: 69.34668731689453, obj_val: 69.34616088867188, abs dis: 0.00052642822265625
[rfa agg] iter: 7, weight: tensor([0.1095, 0.2046, 0.0396, 0.1859, 0.1193, 0.1710, 0.0677, 0.0040, 0.0273,
        0.0712])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 20.9594, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 24.3999, Accuracy: 0/9950 (0.0000%)
saving model
Done in 350.57060956954956 sec.
Server Epoch:56 choose agents : [0, 41, 85, 47, 95, 90, 72, 45, 32, 26].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  56, local model 0, internal_epoch   1, Avg loss: 0.0688, Accuracy: 278/1657 (16.7773%)
_Train Local_ResNet_18, epoch  56, local model 0, internal_epoch   2, Avg loss: 0.0374, Accuracy: 479/1657 (28.9077%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.7748, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   1, Avg loss: 0.0636, Accuracy: 241/719 (33.5188%)
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   2, Avg loss: 0.0325, Accuracy: 442/719 (61.4743%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.6956, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  56, local model 85, internal_epoch   1, Avg loss: 0.0545, Accuracy: 382/1988 (19.2153%)
_Train Local_ResNet_18, epoch  56, local model 85, internal_epoch   2, Avg loss: 0.0373, Accuracy: 589/1988 (29.6278%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.6424, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   1, Avg loss: 0.1265, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   2, Avg loss: 0.1111, Accuracy: 4/134 (2.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.7429, Accuracy: 59/10000 (0.5900%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  56, local model 95, internal_epoch   1, Avg loss: 0.0474, Accuracy: 308/599 (51.4190%)
_Train Local_ResNet_18, epoch  56, local model 95, internal_epoch   2, Avg loss: 0.0295, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 13.7234, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   1, Avg loss: 0.0631, Accuracy: 234/677 (34.5643%)
_Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   2, Avg loss: 0.0250, Accuracy: 460/677 (67.9468%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 12.0900, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   1, Avg loss: 0.0647, Accuracy: 230/1241 (18.5334%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   2, Avg loss: 0.0383, Accuracy: 390/1241 (31.4263%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.9215, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   1, Avg loss: 0.0833, Accuracy: 109/669 (16.2930%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   2, Avg loss: 0.0459, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.2226, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   1, Avg loss: 0.0537, Accuracy: 185/735 (25.1701%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 363/735 (49.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 12.7386, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0629, Accuracy: 249/1446 (17.2199%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0359, Accuracy: 503/1446 (34.7856%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1643, Accuracy: 62/10000 (0.6200%)
time spent on training: 274.63287448883057
[rfa agg] training data poison_ratio: 0.22868727825646223  data num: [1657, 719, 1988, 134, 599, 677, 1241, 669, 735, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.07146477445514444
[rfa agg] init. name: [0, 41, 85, 47, 95, 90, 72, 45, 32, 26], weight: tensor([0.1680, 0.0729, 0.2015, 0.0136, 0.0607, 0.0686, 0.1258, 0.0678, 0.0745,
        0.1466])
[rfa agg] iter:  0, prev_obj_val: 73.61461639404297, obj_val: 76.83100891113281, abs dis: 3.2163925170898438
[rfa agg] iter: 0, weight: tensor([0.1337, 0.0739, 0.0931, 0.0057, 0.0486, 0.0629, 0.2675, 0.0612, 0.0780,
        0.1755])
[rfa agg] iter:  1, prev_obj_val: 76.83100891113281, obj_val: 78.04374694824219, abs dis: 1.212738037109375
[rfa agg] iter: 1, weight: tensor([0.1186, 0.0968, 0.0874, 0.0065, 0.0612, 0.0817, 0.2177, 0.0785, 0.1040,
        0.1478])
[rfa agg] iter:  2, prev_obj_val: 78.04374694824219, obj_val: 80.66461944580078, abs dis: 2.6208724975585938
[rfa agg] iter: 2, weight: tensor([0.1131, 0.1070, 0.0848, 0.0067, 0.0661, 0.0896, 0.1937, 0.0857, 0.1156,
        0.1379])
[rfa agg] iter:  3, prev_obj_val: 80.66461944580078, obj_val: 79.32197570800781, abs dis: 1.3426437377929688
[rfa agg] iter: 3, weight: tensor([0.0997, 0.1255, 0.0773, 0.0069, 0.0748, 0.1050, 0.1550, 0.0991, 0.1389,
        0.1177])
[rfa agg] iter:  4, prev_obj_val: 79.32197570800781, obj_val: 79.31790161132812, abs dis: 0.0040740966796875
[rfa agg] iter: 4, weight: tensor([0.1064, 0.1179, 0.0811, 0.0069, 0.0708, 0.0977, 0.1710, 0.0930, 0.1281,
        0.1271])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.8107, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 4.0958, Accuracy: 0/9950 (0.0000%)
saving model
Done in 388.6804392337799 sec.
Server Epoch:57 choose agents : [7, 40, 56, 4, 32, 75, 76, 70, 89, 9].
_Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   1, Avg loss: 0.0526, Accuracy: 302/891 (33.8945%)
_Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 458/891 (51.4029%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.3318, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0614, Accuracy: 278/1573 (17.6732%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0369, Accuracy: 532/1573 (33.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.2054, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.0810, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0636, Accuracy: 32/186 (17.2043%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0442, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   1, Avg loss: 0.0626, Accuracy: 278/901 (30.8546%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   2, Avg loss: 0.0334, Accuracy: 390/901 (43.2852%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.3014, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0554, Accuracy: 151/735 (20.5442%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 341/735 (46.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 12.1162, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   1, Avg loss: 0.0831, Accuracy: 135/776 (17.3969%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   2, Avg loss: 0.0343, Accuracy: 395/776 (50.9021%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.3511, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  57, local model 76, internal_epoch   1, Avg loss: 0.0943, Accuracy: 13/466 (2.7897%)
_Train Local_ResNet_18, epoch  57, local model 76, internal_epoch   2, Avg loss: 0.0521, Accuracy: 170/466 (36.4807%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.5959, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0630, Accuracy: 322/1418 (22.7080%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0336, Accuracy: 539/1418 (38.0113%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.6832, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   1, Avg loss: 0.0554, Accuracy: 329/896 (36.7188%)
_Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   2, Avg loss: 0.0324, Accuracy: 426/896 (47.5446%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.5082, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   1, Avg loss: 0.0551, Accuracy: 307/1275 (24.0784%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   2, Avg loss: 0.0201, Accuracy: 663/1275 (52.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.8300, Accuracy: 104/10000 (1.0400%)
time spent on training: 236.44379544258118
[rfa agg] training data poison_ratio: 0.0  data num: [891, 1573, 186, 901, 735, 776, 466, 1418, 896, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 40, 56, 4, 32, 75, 76, 70, 89, 9], weight: tensor([0.0977, 0.1725, 0.0204, 0.0988, 0.0806, 0.0851, 0.0511, 0.1555, 0.0983,
        0.1398])
[rfa agg] iter:  0, prev_obj_val: 52.54543685913086, obj_val: 55.059600830078125, abs dis: 2.5141639709472656
[rfa agg] iter: 0, weight: tensor([0.1820, 0.0642, 0.0064, 0.1523, 0.1006, 0.1329, 0.0297, 0.0702, 0.1706,
        0.0912])
[rfa agg] iter:  1, prev_obj_val: 55.059600830078125, obj_val: 62.21232604980469, abs dis: 7.1527252197265625
[rfa agg] iter: 1, weight: tensor([0.1865, 0.0545, 0.0065, 0.1307, 0.1228, 0.1582, 0.0320, 0.0584, 0.1773,
        0.0732])
[rfa agg] iter:  2, prev_obj_val: 62.21232604980469, obj_val: 59.44660949707031, abs dis: 2.765716552734375
[rfa agg] iter: 2, weight: tensor([0.1515, 0.0552, 0.0083, 0.1082, 0.1836, 0.1702, 0.0471, 0.0580, 0.1483,
        0.0695])
[rfa agg] iter:  3, prev_obj_val: 59.44660949707031, obj_val: 59.44537353515625, abs dis: 0.0012359619140625
[rfa agg] iter: 3, weight: tensor([0.1569, 0.0531, 0.0074, 0.1094, 0.1778, 0.1783, 0.0401, 0.0562, 0.1526,
        0.0682])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.7961, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 3.9483, Accuracy: 0/9950 (0.0000%)
saving model
Done in 346.71819043159485 sec.
Server Epoch:58 choose agents : [35, 34, 31, 90, 75, 19, 27, 24, 33, 23].
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   1, Avg loss: 0.1156, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   2, Avg loss: 0.0758, Accuracy: 60/271 (22.1402%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.3161, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0618, Accuracy: 326/1427 (22.8451%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0349, Accuracy: 550/1427 (38.5424%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.7563, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0925, Accuracy: 16/460 (3.4783%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0418, Accuracy: 178/460 (38.6957%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.4338, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  58, local model 90, internal_epoch   1, Avg loss: 0.0631, Accuracy: 217/677 (32.0532%)
_Train Local_ResNet_18, epoch  58, local model 90, internal_epoch   2, Avg loss: 0.0241, Accuracy: 450/677 (66.4697%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 13.2137, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   1, Avg loss: 0.0814, Accuracy: 142/776 (18.2990%)
_Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   2, Avg loss: 0.0342, Accuracy: 395/776 (50.9021%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.8693, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0525, Accuracy: 321/1036 (30.9846%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0242, Accuracy: 631/1036 (60.9073%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 12.9766, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   1, Avg loss: 0.0640, Accuracy: 333/1587 (20.9830%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   2, Avg loss: 0.0369, Accuracy: 566/1587 (35.6648%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.1571, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   1, Avg loss: 0.0914, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   2, Avg loss: 0.0484, Accuracy: 118/312 (37.8205%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.1172, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0877, Accuracy: 55/515 (10.6796%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0627, Accuracy: 116/515 (22.5243%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.0360, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0816, Accuracy: 153/715 (21.3986%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0473, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.5828, Accuracy: 54/10000 (0.5400%)
time spent on training: 226.77811336517334
[rfa agg] training data poison_ratio: 0.0  data num: [271, 1427, 460, 677, 776, 1036, 1587, 312, 515, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 34, 31, 90, 75, 19, 27, 24, 33, 23], weight: tensor([0.0349, 0.1835, 0.0592, 0.0871, 0.0998, 0.1332, 0.2041, 0.0401, 0.0662,
        0.0919])
[rfa agg] iter:  0, prev_obj_val: 61.169281005859375, obj_val: 63.522621154785156, abs dis: 2.3533401489257812
[rfa agg] iter: 0, weight: tensor([0.0185, 0.1009, 0.0473, 0.1290, 0.2171, 0.1769, 0.0929, 0.0214, 0.0595,
        0.1365])
[rfa agg] iter:  1, prev_obj_val: 63.522621154785156, obj_val: 66.42234802246094, abs dis: 2.8997268676757812
[rfa agg] iter: 1, weight: tensor([0.0192, 0.0770, 0.0537, 0.1767, 0.2393, 0.1193, 0.0725, 0.0223, 0.0674,
        0.1525])
[rfa agg] iter:  2, prev_obj_val: 66.42234802246094, obj_val: 66.38679504394531, abs dis: 0.035552978515625
[rfa agg] iter: 2, weight: tensor([0.0212, 0.0688, 0.0641, 0.2353, 0.1906, 0.0975, 0.0656, 0.0246, 0.0794,
        0.1529])
[rfa agg] iter:  3, prev_obj_val: 66.38679504394531, obj_val: 66.38551330566406, abs dis: 0.00128173828125
[rfa agg] iter: 3, weight: tensor([0.0210, 0.0679, 0.0638, 0.2501, 0.1813, 0.0957, 0.0648, 0.0244, 0.0792,
        0.1520])
[rfa agg] iter:  4, prev_obj_val: 66.38551330566406, obj_val: 66.38544464111328, abs dis: 6.866455078125e-05
[rfa agg] iter: 4, weight: tensor([0.0209, 0.0677, 0.0636, 0.2538, 0.1795, 0.0953, 0.0646, 0.0243, 0.0789,
        0.1514])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8384, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 3.9147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 340.9357316493988 sec.
Server Epoch:59 choose agents : [69, 84, 6, 40, 21, 23, 99, 76, 53, 20].
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   1, Avg loss: 0.0573, Accuracy: 222/590 (37.6271%)
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   2, Avg loss: 0.0347, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 12.6554, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 84, internal_epoch   1, Avg loss: 0.0661, Accuracy: 259/1190 (21.7647%)
_Train Local_ResNet_18, epoch  59, local model 84, internal_epoch   2, Avg loss: 0.0335, Accuracy: 427/1190 (35.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.2820, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   1, Avg loss: 0.0617, Accuracy: 325/1956 (16.6155%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   2, Avg loss: 0.0343, Accuracy: 597/1956 (30.5215%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.1926, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0614, Accuracy: 287/1573 (18.2454%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0375, Accuracy: 512/1573 (32.5493%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.0426, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0568, Accuracy: 344/1949 (17.6501%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0351, Accuracy: 571/1949 (29.2971%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.1669, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0796, Accuracy: 166/715 (23.2168%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0444, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.4538, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   1, Avg loss: 0.0690, Accuracy: 153/773 (19.7930%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   2, Avg loss: 0.0350, Accuracy: 405/773 (52.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 11.2904, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  59, local model 76, internal_epoch   1, Avg loss: 0.0979, Accuracy: 3/466 (0.6438%)
_Train Local_ResNet_18, epoch  59, local model 76, internal_epoch   2, Avg loss: 0.0532, Accuracy: 162/466 (34.7639%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.7155, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   1, Avg loss: 0.0481, Accuracy: 272/813 (33.4563%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   2, Avg loss: 0.0192, Accuracy: 480/813 (59.0406%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 13.6167, Accuracy: 56/10000 (0.5600%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0647, Accuracy: 249/807 (30.8550%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0365, Accuracy: 403/807 (49.9380%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.9146, Accuracy: 72/10000 (0.7200%)
time spent on training: 286.5577721595764
[rfa agg] training data poison_ratio: 0.07450147710487445  data num: [590, 1190, 1956, 1573, 1949, 715, 773, 466, 813, 807]
[rfa agg] considering poison per batch poison_fraction: 0.023281711595273265
[rfa agg] init. name: [69, 84, 6, 40, 21, 23, 99, 76, 53, 20], weight: tensor([0.0545, 0.1099, 0.1806, 0.1452, 0.1799, 0.0660, 0.0714, 0.0430, 0.0751,
        0.0745])
[rfa agg] iter:  0, prev_obj_val: 76.9487533569336, obj_val: 78.86377716064453, abs dis: 1.9150238037109375
[rfa agg] iter: 0, weight: tensor([0.0404, 0.2854, 0.1006, 0.1522, 0.0998, 0.0601, 0.0741, 0.0262, 0.0820,
        0.0793])
[rfa agg] iter:  1, prev_obj_val: 78.86377716064453, obj_val: 80.8318099975586, abs dis: 1.9680328369140625
[rfa agg] iter: 1, weight: tensor([0.0458, 0.2795, 0.0855, 0.1201, 0.0850, 0.0701, 0.0887, 0.0287, 0.1005,
        0.0960])
[rfa agg] iter:  2, prev_obj_val: 80.8318099975586, obj_val: 83.07205963134766, abs dis: 2.2402496337890625
[rfa agg] iter: 2, weight: tensor([0.0523, 0.2207, 0.0799, 0.1071, 0.0794, 0.0821, 0.1061, 0.0319, 0.1238,
        0.1167])
[rfa agg] iter:  3, prev_obj_val: 83.07205963134766, obj_val: 84.29653930664062, abs dis: 1.2244796752929688
[rfa agg] iter: 3, weight: tensor([0.0580, 0.1645, 0.0714, 0.0920, 0.0710, 0.0935, 0.1234, 0.0341, 0.1525,
        0.1395])
[rfa agg] iter:  4, prev_obj_val: 84.29653930664062, obj_val: 84.28897857666016, abs dis: 0.00756072998046875
[rfa agg] iter: 4, weight: tensor([0.0601, 0.1392, 0.0658, 0.0833, 0.0654, 0.0984, 0.1312, 0.0346, 0.1700,
        0.1519])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.8873, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 4.2308, Accuracy: 0/9950 (0.0000%)
saving model
Done in 397.9255292415619 sec.
Server Epoch:60 choose agents : [51, 0, 53, 75, 42, 61, 12, 54, 70, 11].
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   1, Avg loss: 0.0689, Accuracy: 176/1049 (16.7779%)
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   2, Avg loss: 0.0331, Accuracy: 460/1049 (43.8513%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.3678, Accuracy: 91/10000 (0.9100%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  60, local model 0, internal_epoch   1, Avg loss: 0.0692, Accuracy: 267/1657 (16.1135%)
_Train Local_ResNet_18, epoch  60, local model 0, internal_epoch   2, Avg loss: 0.0368, Accuracy: 490/1657 (29.5715%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.4423, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0449, Accuracy: 287/813 (35.3014%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0201, Accuracy: 455/813 (55.9656%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 13.3410, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  60, local model 75, internal_epoch   1, Avg loss: 0.0788, Accuracy: 145/776 (18.6856%)
_Train Local_ResNet_18, epoch  60, local model 75, internal_epoch   2, Avg loss: 0.0342, Accuracy: 381/776 (49.0979%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.0323, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0546, Accuracy: 255/1372 (18.5860%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0341, Accuracy: 438/1372 (31.9242%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.0750, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   1, Avg loss: 0.1486, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   2, Avg loss: 0.1383, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.3791, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   1, Avg loss: 0.0897, Accuracy: 11/338 (3.2544%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   2, Avg loss: 0.0457, Accuracy: 126/338 (37.2781%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.9989, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0674, Accuracy: 256/1130 (22.6549%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0316, Accuracy: 434/1130 (38.4071%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.2312, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   1, Avg loss: 0.0654, Accuracy: 306/1418 (21.5797%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   2, Avg loss: 0.0344, Accuracy: 531/1418 (37.4471%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.4598, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0550, Accuracy: 239/712 (33.5674%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0252, Accuracy: 452/712 (63.4831%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.6549, Accuracy: 72/10000 (0.7200%)
time spent on training: 246.04693460464478
[rfa agg] training data poison_ratio: 0.1772192513368984  data num: [1049, 1657, 813, 776, 1372, 85, 338, 1130, 1418, 712]
[rfa agg] considering poison per batch poison_fraction: 0.05538101604278075
[rfa agg] init. name: [51, 0, 53, 75, 42, 61, 12, 54, 70, 11], weight: tensor([0.1122, 0.1772, 0.0870, 0.0830, 0.1467, 0.0091, 0.0361, 0.1209, 0.1517,
        0.0761])
[rfa agg] iter:  0, prev_obj_val: 54.24882125854492, obj_val: 58.47743606567383, abs dis: 4.228614807128906
[rfa agg] iter: 0, weight: tensor([0.1753, 0.0883, 0.1066, 0.0986, 0.1165, 0.0028, 0.0163, 0.2151, 0.1053,
        0.0751])
[rfa agg] iter:  1, prev_obj_val: 58.47743606567383, obj_val: 58.433162689208984, abs dis: 0.04427337646484375
[rfa agg] iter: 1, weight: tensor([0.1602, 0.0771, 0.1518, 0.1398, 0.0955, 0.0031, 0.0188, 0.1650, 0.0881,
        0.1006])
[rfa agg] iter:  2, prev_obj_val: 58.433162689208984, obj_val: 58.43289566040039, abs dis: 0.00026702880859375
[rfa agg] iter: 2, weight: tensor([0.1578, 0.0766, 0.1561, 0.1425, 0.0947, 0.0031, 0.0187, 0.1612, 0.0875,
        0.1017])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.9210, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 3.9281, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 358.0749521255493 sec.
Server Epoch:61 choose agents : [85, 95, 51, 25, 38, 6, 55, 53, 12, 69].
_Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   1, Avg loss: 0.0575, Accuracy: 363/1988 (18.2596%)
_Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   2, Avg loss: 0.0374, Accuracy: 577/1988 (29.0241%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.1589, Accuracy: 75/10000 (0.7500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  61, local model 95, internal_epoch   1, Avg loss: 0.0450, Accuracy: 311/599 (51.9199%)
_Train Local_ResNet_18, epoch  61, local model 95, internal_epoch   2, Avg loss: 0.0262, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 13.4272, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   1, Avg loss: 0.0672, Accuracy: 210/1049 (20.0191%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   2, Avg loss: 0.0331, Accuracy: 475/1049 (45.2812%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.9616, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   1, Avg loss: 0.0671, Accuracy: 194/690 (28.1159%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   2, Avg loss: 0.0314, Accuracy: 453/690 (65.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.8752, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   1, Avg loss: 0.0774, Accuracy: 164/1131 (14.5004%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   2, Avg loss: 0.0372, Accuracy: 441/1131 (38.9920%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.4303, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   1, Avg loss: 0.0621, Accuracy: 322/1956 (16.4622%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   2, Avg loss: 0.0353, Accuracy: 590/1956 (30.1636%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.7755, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0560, Accuracy: 235/1071 (21.9421%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0308, Accuracy: 474/1071 (44.2577%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.7880, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   1, Avg loss: 0.0418, Accuracy: 310/813 (38.1304%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   2, Avg loss: 0.0200, Accuracy: 473/813 (58.1796%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 12.5289, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0899, Accuracy: 9/338 (2.6627%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0476, Accuracy: 133/338 (39.3491%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.5704, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   1, Avg loss: 0.0578, Accuracy: 238/590 (40.3390%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   2, Avg loss: 0.0321, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 12.5805, Accuracy: 50/10000 (0.5000%)
time spent on training: 258.72636580467224
[rfa agg] training data poison_ratio: 0.05858190709046455  data num: [1988, 599, 1049, 690, 1131, 1956, 1071, 813, 338, 590]
[rfa agg] considering poison per batch poison_fraction: 0.01830684596577017
[rfa agg] init. name: [85, 95, 51, 25, 38, 6, 55, 53, 12, 69], weight: tensor([0.1944, 0.0586, 0.1026, 0.0675, 0.1106, 0.1913, 0.1047, 0.0795, 0.0331,
        0.0577])
[rfa agg] iter:  0, prev_obj_val: 77.44111633300781, obj_val: 79.4157943725586, abs dis: 1.9746780395507812
[rfa agg] iter: 0, weight: tensor([0.0840, 0.0401, 0.1671, 0.0515, 0.2220, 0.0896, 0.2107, 0.0799, 0.0155,
        0.0395])
[rfa agg] iter:  1, prev_obj_val: 79.4157943725586, obj_val: 83.5921859741211, abs dis: 4.1763916015625
[rfa agg] iter: 1, weight: tensor([0.0635, 0.0491, 0.1701, 0.0653, 0.1834, 0.0670, 0.2241, 0.1123, 0.0170,
        0.0483])
[rfa agg] iter:  2, prev_obj_val: 83.5921859741211, obj_val: 85.2272720336914, abs dis: 1.6350860595703125
[rfa agg] iter: 2, weight: tensor([0.0612, 0.0661, 0.1473, 0.0902, 0.1418, 0.0641, 0.1760, 0.1675, 0.0207,
        0.0650])
[rfa agg] iter:  3, prev_obj_val: 85.2272720336914, obj_val: 85.21263885498047, abs dis: 0.0146331787109375
[rfa agg] iter: 3, weight: tensor([0.0590, 0.0728, 0.1336, 0.1008, 0.1268, 0.0617, 0.1537, 0.1980, 0.0217,
        0.0718])
[rfa agg] iter:  4, prev_obj_val: 85.21263885498047, obj_val: 85.21229553222656, abs dis: 0.00034332275390625
[rfa agg] iter: 4, weight: tensor([0.0586, 0.0727, 0.1318, 0.1009, 0.1251, 0.0613, 0.1512, 0.2050, 0.0216,
        0.0717])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.8953, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 3.8398, Accuracy: 0/9950 (0.0000%)
saving model
Done in 375.7792754173279 sec.
Server Epoch:62 choose agents : [84, 79, 24, 82, 4, 30, 94, 33, 69, 60].
_Train Local_ResNet_18, epoch  62, local model 84, internal_epoch   1, Avg loss: 0.0667, Accuracy: 255/1190 (21.4286%)
_Train Local_ResNet_18, epoch  62, local model 84, internal_epoch   2, Avg loss: 0.0345, Accuracy: 425/1190 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.0173, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   1, Avg loss: 0.1081, Accuracy: 6/197 (3.0457%)
_Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   2, Avg loss: 0.0839, Accuracy: 23/197 (11.6751%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.5692, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   1, Avg loss: 0.0944, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   2, Avg loss: 0.0504, Accuracy: 99/312 (31.7308%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.1603, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0774, Accuracy: 39/500 (7.8000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0474, Accuracy: 201/500 (40.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.4542, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   1, Avg loss: 0.0630, Accuracy: 273/901 (30.2997%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   2, Avg loss: 0.0338, Accuracy: 401/901 (44.5061%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.0825, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   1, Avg loss: 0.0772, Accuracy: 37/486 (7.6132%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   2, Avg loss: 0.0384, Accuracy: 227/486 (46.7078%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.4177, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  62, local model 94, internal_epoch   1, Avg loss: 0.0647, Accuracy: 271/1662 (16.3057%)
_Train Local_ResNet_18, epoch  62, local model 94, internal_epoch   2, Avg loss: 0.0373, Accuracy: 480/1662 (28.8809%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.8567, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   1, Avg loss: 0.0855, Accuracy: 41/515 (7.9612%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   2, Avg loss: 0.0589, Accuracy: 125/515 (24.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9834, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   1, Avg loss: 0.0551, Accuracy: 249/590 (42.2034%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   2, Avg loss: 0.0331, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 14.5889, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0572, Accuracy: 464/2227 (20.8352%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0317, Accuracy: 877/2227 (39.3803%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.0393, Accuracy: 107/10000 (1.0700%)
time spent on training: 228.18058466911316
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 197, 312, 500, 901, 486, 1662, 515, 590, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 79, 24, 82, 4, 30, 94, 33, 69, 60], weight: tensor([0.1387, 0.0230, 0.0364, 0.0583, 0.1050, 0.0566, 0.1937, 0.0600, 0.0688,
        0.2596])
[rfa agg] iter:  0, prev_obj_val: 90.50407409667969, obj_val: 92.07469177246094, abs dis: 1.57061767578125
[rfa agg] iter: 0, weight: tensor([0.3134, 0.0112, 0.0192, 0.0394, 0.1603, 0.0383, 0.1973, 0.0438, 0.0563,
        0.1210])
[rfa agg] iter:  1, prev_obj_val: 92.07469177246094, obj_val: 93.7785873413086, abs dis: 1.7038955688476562
[rfa agg] iter: 1, weight: tensor([0.2981, 0.0119, 0.0207, 0.0446, 0.2160, 0.0434, 0.1478, 0.0502, 0.0664,
        0.1009])
[rfa agg] iter:  2, prev_obj_val: 93.7785873413086, obj_val: 95.90484619140625, abs dis: 2.1262588500976562
[rfa agg] iter: 2, weight: tensor([0.2435, 0.0127, 0.0223, 0.0496, 0.2636, 0.0481, 0.1329, 0.0561, 0.0759,
        0.0952])
[rfa agg] iter:  3, prev_obj_val: 95.90484619140625, obj_val: 95.8667221069336, abs dis: 0.03812408447265625
[rfa agg] iter: 3, weight: tensor([0.1951, 0.0135, 0.0239, 0.0552, 0.3000, 0.0535, 0.1194, 0.0628, 0.0877,
        0.0890])
[rfa agg] iter:  4, prev_obj_val: 95.8667221069336, obj_val: 95.86415100097656, abs dis: 0.00257110595703125
[rfa agg] iter: 4, weight: tensor([0.1873, 0.0133, 0.0236, 0.0544, 0.3152, 0.0527, 0.1174, 0.0619, 0.0867,
        0.0875])
[rfa agg] iter:  5, prev_obj_val: 95.86415100097656, obj_val: 95.86386108398438, abs dis: 0.0002899169921875
[rfa agg] iter: 5, weight: tensor([0.1853, 0.0132, 0.0234, 0.0541, 0.3206, 0.0523, 0.1166, 0.0615, 0.0861,
        0.0869])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.8687, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 4.0402, Accuracy: 0/9950 (0.0000%)
saving model
Done in 342.9668838977814 sec.
Server Epoch:63 choose agents : [18, 64, 38, 96, 55, 91, 58, 59, 66, 77].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.1044, Accuracy: 18/530 (3.3962%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0436, Accuracy: 262/530 (49.4340%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 12.0624, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0685, Accuracy: 157/953 (16.4743%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0403, Accuracy: 299/953 (31.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.4066, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0747, Accuracy: 154/1131 (13.6163%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0365, Accuracy: 469/1131 (41.4677%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.4736, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  63, local model 96, internal_epoch   1, Avg loss: 0.0813, Accuracy: 16/311 (5.1447%)
_Train Local_ResNet_18, epoch  63, local model 96, internal_epoch   2, Avg loss: 0.0553, Accuracy: 124/311 (39.8714%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.3736, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   1, Avg loss: 0.0555, Accuracy: 258/1071 (24.0896%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   2, Avg loss: 0.0301, Accuracy: 485/1071 (45.2848%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.2722, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   1, Avg loss: 0.0600, Accuracy: 233/1030 (22.6214%)
_Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   2, Avg loss: 0.0308, Accuracy: 575/1030 (55.8252%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.6962, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0718, Accuracy: 200/803 (24.9066%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0377, Accuracy: 433/803 (53.9228%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.1305, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   1, Avg loss: 0.0537, Accuracy: 256/1089 (23.5078%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   2, Avg loss: 0.0316, Accuracy: 439/1089 (40.3122%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 12.4522, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   1, Avg loss: 0.0749, Accuracy: 159/1402 (11.3409%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   2, Avg loss: 0.0427, Accuracy: 372/1402 (26.5335%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.3010, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  63, local model 77, internal_epoch   1, Avg loss: 0.0615, Accuracy: 239/1340 (17.8358%)
_Train Local_ResNet_18, epoch  63, local model 77, internal_epoch   2, Avg loss: 0.0281, Accuracy: 563/1340 (42.0149%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.4652, Accuracy: 70/10000 (0.7000%)
time spent on training: 264.4281687736511
[rfa agg] training data poison_ratio: 0.0  data num: [530, 953, 1131, 311, 1071, 1030, 803, 1089, 1402, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [18, 64, 38, 96, 55, 91, 58, 59, 66, 77], weight: tensor([0.0549, 0.0987, 0.1171, 0.0322, 0.1109, 0.1066, 0.0831, 0.1127, 0.1451,
        0.1387])
[rfa agg] iter:  0, prev_obj_val: 48.23412322998047, obj_val: 52.57392883300781, abs dis: 4.339805603027344
[rfa agg] iter: 0, weight: tensor([0.0403, 0.1979, 0.1157, 0.0139, 0.1325, 0.1173, 0.1433, 0.0718, 0.0817,
        0.0855])
[rfa agg] iter:  1, prev_obj_val: 52.57392883300781, obj_val: 50.169647216796875, abs dis: 2.4042816162109375
[rfa agg] iter: 1, weight: tensor([0.0498, 0.1899, 0.1032, 0.0161, 0.1187, 0.1066, 0.1925, 0.0679, 0.0761,
        0.0792])
[rfa agg] iter:  2, prev_obj_val: 50.169647216796875, obj_val: 50.16646957397461, abs dis: 0.003177642822265625
[rfa agg] iter: 2, weight: tensor([0.0438, 0.2027, 0.1061, 0.0146, 0.1233, 0.1094, 0.1770, 0.0669, 0.0765,
        0.0797])
[rfa agg] iter:  3, prev_obj_val: 50.16646957397461, obj_val: 50.16638946533203, abs dis: 8.0108642578125e-05
[rfa agg] iter: 3, weight: tensor([0.0437, 0.2052, 0.1062, 0.0146, 0.1236, 0.1096, 0.1740, 0.0668, 0.0765,
        0.0797])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.8518, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 3.4954, Accuracy: 0/9950 (0.0000%)
saving model
Done in 377.1688234806061 sec.
Server Epoch:64 choose agents : [78, 13, 57, 64, 48, 23, 71, 35, 32, 76].
_Train Local_ResNet_18, epoch  64, local model 78, internal_epoch   1, Avg loss: 0.0943, Accuracy: 8/416 (1.9231%)
_Train Local_ResNet_18, epoch  64, local model 78, internal_epoch   2, Avg loss: 0.0520, Accuracy: 167/416 (40.1442%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.9547, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   1, Avg loss: 0.0705, Accuracy: 310/1645 (18.8450%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   2, Avg loss: 0.0358, Accuracy: 524/1645 (31.8541%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.6699, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   1, Avg loss: 0.0660, Accuracy: 238/1154 (20.6239%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   2, Avg loss: 0.0277, Accuracy: 480/1154 (41.5945%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.1197, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   1, Avg loss: 0.0685, Accuracy: 147/953 (15.4250%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   2, Avg loss: 0.0404, Accuracy: 283/953 (29.6957%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.2584, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   1, Avg loss: 0.0830, Accuracy: 33/631 (5.2298%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   2, Avg loss: 0.0471, Accuracy: 221/631 (35.0238%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.7457, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   1, Avg loss: 0.0793, Accuracy: 180/715 (25.1748%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   2, Avg loss: 0.0434, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.7302, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0621, Accuracy: 166/818 (20.2934%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0321, Accuracy: 318/818 (38.8753%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.1093, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.1110, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0729, Accuracy: 76/271 (28.0443%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.1674, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   1, Avg loss: 0.0515, Accuracy: 194/735 (26.3946%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 346/735 (47.0748%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 12.0174, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0976, Accuracy: 3/466 (0.6438%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0539, Accuracy: 165/466 (35.4077%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.5595, Accuracy: 55/10000 (0.5500%)
time spent on training: 235.66906642913818
[rfa agg] training data poison_ratio: 0.0  data num: [416, 1645, 1154, 953, 631, 715, 818, 271, 735, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [78, 13, 57, 64, 48, 23, 71, 35, 32, 76], weight: tensor([0.0533, 0.2108, 0.1479, 0.1221, 0.0809, 0.0916, 0.1048, 0.0347, 0.0942,
        0.0597])
[rfa agg] iter:  0, prev_obj_val: 56.3586311340332, obj_val: 58.38344192504883, abs dis: 2.024810791015625
[rfa agg] iter: 0, weight: tensor([0.0358, 0.0623, 0.0811, 0.1526, 0.1025, 0.1325, 0.1803, 0.0173, 0.1873,
        0.0483])
[rfa agg] iter:  1, prev_obj_val: 58.38344192504883, obj_val: 62.25510787963867, abs dis: 3.8716659545898438
[rfa agg] iter: 1, weight: tensor([0.0404, 0.0549, 0.0680, 0.1189, 0.1328, 0.1347, 0.1594, 0.0186, 0.2160,
        0.0563])
[rfa agg] iter:  2, prev_obj_val: 62.25510787963867, obj_val: 62.22283935546875, abs dis: 0.032268524169921875
[rfa agg] iter: 2, weight: tensor([0.0521, 0.0550, 0.0654, 0.1030, 0.1843, 0.1280, 0.1326, 0.0227, 0.1814,
        0.0754])
[rfa agg] iter:  3, prev_obj_val: 62.22283935546875, obj_val: 62.22206115722656, abs dis: 0.0007781982421875
[rfa agg] iter: 3, weight: tensor([0.0523, 0.0545, 0.0648, 0.1018, 0.1955, 0.1268, 0.1298, 0.0226, 0.1761,
        0.0759])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8546, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 3.2054, Accuracy: 0/9950 (0.0000%)
saving model
Done in 352.87753891944885 sec.
Server Epoch:65 choose agents : [28, 37, 12, 15, 85, 30, 66, 73, 82, 11].
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0626, Accuracy: 307/1581 (19.4181%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0370, Accuracy: 530/1581 (33.5231%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.4446, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0597, Accuracy: 317/1129 (28.0779%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0282, Accuracy: 649/1129 (57.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.9077, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   1, Avg loss: 0.0927, Accuracy: 10/338 (2.9586%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   2, Avg loss: 0.0506, Accuracy: 128/338 (37.8698%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.8180, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   1, Avg loss: 0.0762, Accuracy: 224/1154 (19.4107%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   2, Avg loss: 0.0335, Accuracy: 400/1154 (34.6620%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.3066, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  65, local model 85, internal_epoch   1, Avg loss: 0.0570, Accuracy: 386/1988 (19.4165%)
_Train Local_ResNet_18, epoch  65, local model 85, internal_epoch   2, Avg loss: 0.0387, Accuracy: 570/1988 (28.6720%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.4826, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   1, Avg loss: 0.0744, Accuracy: 44/486 (9.0535%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   2, Avg loss: 0.0368, Accuracy: 229/486 (47.1193%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.9490, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   1, Avg loss: 0.0744, Accuracy: 167/1402 (11.9116%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   2, Avg loss: 0.0429, Accuracy: 342/1402 (24.3937%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.6772, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   1, Avg loss: 0.0841, Accuracy: 92/938 (9.8081%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   2, Avg loss: 0.0344, Accuracy: 356/938 (37.9531%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.3049, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0782, Accuracy: 40/500 (8.0000%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 187/500 (37.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.5189, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0524, Accuracy: 263/712 (36.9382%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0279, Accuracy: 424/712 (59.5506%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.8222, Accuracy: 72/10000 (0.7200%)
time spent on training: 297.19546842575073
[rfa agg] training data poison_ratio: 0.0  data num: [1581, 1129, 338, 1154, 1988, 486, 1402, 938, 500, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [28, 37, 12, 15, 85, 30, 66, 73, 82, 11], weight: tensor([0.1546, 0.1104, 0.0330, 0.1128, 0.1944, 0.0475, 0.1371, 0.0917, 0.0489,
        0.0696])
[rfa agg] iter:  0, prev_obj_val: 69.70806884765625, obj_val: 73.54953002929688, abs dis: 3.841461181640625
[rfa agg] iter: 0, weight: tensor([0.1122, 0.2072, 0.0162, 0.1569, 0.0762, 0.0284, 0.1542, 0.1523, 0.0291,
        0.0673])
[rfa agg] iter:  1, prev_obj_val: 73.54953002929688, obj_val: 73.50473022460938, abs dis: 0.0447998046875
[rfa agg] iter: 1, weight: tensor([0.0943, 0.1939, 0.0182, 0.1373, 0.0682, 0.0328, 0.1221, 0.2150, 0.0336,
        0.0847])
[rfa agg] iter:  2, prev_obj_val: 73.50473022460938, obj_val: 73.5033950805664, abs dis: 0.00133514404296875
[rfa agg] iter: 2, weight: tensor([0.0927, 0.1913, 0.0179, 0.1331, 0.0672, 0.0324, 0.1198, 0.2281, 0.0333,
        0.0842])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 15.3838, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 15.6056, Accuracy: 0/9950 (0.0000%)
saving model
Done in 409.6181552410126 sec.
Server Epoch:66 choose agents : [90, 62, 96, 18, 82, 94, 92, 73, 7, 71].
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   1, Avg loss: 0.0651, Accuracy: 201/677 (29.6898%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   2, Avg loss: 0.0236, Accuracy: 471/677 (69.5716%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 13.6436, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   1, Avg loss: 0.0756, Accuracy: 80/568 (14.0845%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   2, Avg loss: 0.0439, Accuracy: 261/568 (45.9507%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.3325, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  66, local model 96, internal_epoch   1, Avg loss: 0.0807, Accuracy: 19/311 (6.1093%)
_Train Local_ResNet_18, epoch  66, local model 96, internal_epoch   2, Avg loss: 0.0553, Accuracy: 127/311 (40.8360%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.7239, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0945, Accuracy: 27/530 (5.0943%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0407, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 12.1152, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  66, local model 82, internal_epoch   1, Avg loss: 0.0763, Accuracy: 37/500 (7.4000%)
_Train Local_ResNet_18, epoch  66, local model 82, internal_epoch   2, Avg loss: 0.0465, Accuracy: 197/500 (39.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.9105, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   1, Avg loss: 0.0629, Accuracy: 239/1662 (14.3803%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   2, Avg loss: 0.0360, Accuracy: 527/1662 (31.7088%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.4778, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   1, Avg loss: 0.0633, Accuracy: 353/1715 (20.5831%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   2, Avg loss: 0.0321, Accuracy: 651/1715 (37.9592%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.6793, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   1, Avg loss: 0.0811, Accuracy: 100/938 (10.6610%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   2, Avg loss: 0.0354, Accuracy: 330/938 (35.1812%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 10.5250, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   1, Avg loss: 0.0553, Accuracy: 264/891 (29.6296%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 456/891 (51.1785%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.8816, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0613, Accuracy: 158/818 (19.3154%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 343/818 (41.9315%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 10.0510, Accuracy: 68/10000 (0.6800%)
time spent on training: 253.29306292533875
[rfa agg] training data poison_ratio: 0.0  data num: [677, 568, 311, 530, 500, 1662, 1715, 938, 891, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 62, 96, 18, 82, 94, 92, 73, 7, 71], weight: tensor([0.0786, 0.0660, 0.0361, 0.0616, 0.0581, 0.1930, 0.1992, 0.1089, 0.1035,
        0.0950])
[rfa agg] iter:  0, prev_obj_val: 66.81925201416016, obj_val: 69.5951919555664, abs dis: 2.77593994140625
[rfa agg] iter: 0, weight: tensor([0.0858, 0.0517, 0.0168, 0.0473, 0.0393, 0.0851, 0.0792, 0.2240, 0.2165,
        0.1542])
[rfa agg] iter:  1, prev_obj_val: 69.5951919555664, obj_val: 69.49617004394531, abs dis: 0.09902191162109375
[rfa agg] iter: 1, weight: tensor([0.1373, 0.0723, 0.0190, 0.0649, 0.0512, 0.0615, 0.0581, 0.1485, 0.1923,
        0.1948])
[rfa agg] iter:  2, prev_obj_val: 69.49617004394531, obj_val: 69.49486541748047, abs dis: 0.00130462646484375
[rfa agg] iter: 2, weight: tensor([0.1421, 0.0722, 0.0189, 0.0649, 0.0508, 0.0603, 0.0570, 0.1410, 0.1880,
        0.2048])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 13.2474, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 11.9248, Accuracy: 0/9950 (0.0000%)
saving model
Done in 367.8135771751404 sec.
Server Epoch:67 choose agents : [44, 84, 98, 56, 6, 75, 64, 39, 14, 78].
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   1, Avg loss: 0.0678, Accuracy: 305/1750 (17.4286%)
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   2, Avg loss: 0.0401, Accuracy: 574/1750 (32.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.3051, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  67, local model 84, internal_epoch   1, Avg loss: 0.0667, Accuracy: 259/1190 (21.7647%)
_Train Local_ResNet_18, epoch  67, local model 84, internal_epoch   2, Avg loss: 0.0338, Accuracy: 448/1190 (37.6471%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.7184, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  67, local model 98, internal_epoch   1, Avg loss: 0.0888, Accuracy: 9/373 (2.4129%)
_Train Local_ResNet_18, epoch  67, local model 98, internal_epoch   2, Avg loss: 0.0513, Accuracy: 141/373 (37.8016%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.6379, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.0808, Accuracy: 5/186 (2.6882%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0647, Accuracy: 53/186 (28.4946%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.6622, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   1, Avg loss: 0.0624, Accuracy: 327/1956 (16.7178%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   2, Avg loss: 0.0345, Accuracy: 597/1956 (30.5215%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.9939, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  67, local model 75, internal_epoch   1, Avg loss: 0.0808, Accuracy: 133/776 (17.1392%)
_Train Local_ResNet_18, epoch  67, local model 75, internal_epoch   2, Avg loss: 0.0345, Accuracy: 409/776 (52.7062%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.0460, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   1, Avg loss: 0.0702, Accuracy: 163/953 (17.1039%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   2, Avg loss: 0.0408, Accuracy: 293/953 (30.7450%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.9414, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   1, Avg loss: 0.0561, Accuracy: 254/1013 (25.0740%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   2, Avg loss: 0.0267, Accuracy: 473/1013 (46.6930%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.9770, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   1, Avg loss: 0.0658, Accuracy: 212/1013 (20.9279%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   2, Avg loss: 0.0389, Accuracy: 359/1013 (35.4393%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.3505, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   1, Avg loss: 0.0883, Accuracy: 16/416 (3.8462%)
_Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   2, Avg loss: 0.0512, Accuracy: 176/416 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.8591, Accuracy: 71/10000 (0.7100%)
time spent on training: 250.04703330993652
[rfa agg] training data poison_ratio: 0.0  data num: [1750, 1190, 373, 186, 1956, 776, 953, 1013, 1013, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 84, 98, 56, 6, 75, 64, 39, 14, 78], weight: tensor([0.1818, 0.1236, 0.0387, 0.0193, 0.2032, 0.0806, 0.0990, 0.1052, 0.1052,
        0.0432])
[rfa agg] iter:  0, prev_obj_val: 69.69657897949219, obj_val: 70.69358825683594, abs dis: 0.99700927734375
[rfa agg] iter: 0, weight: tensor([0.0936, 0.2056, 0.0168, 0.0065, 0.0824, 0.0773, 0.1446, 0.1818, 0.1708,
        0.0205])
[rfa agg] iter:  1, prev_obj_val: 70.69358825683594, obj_val: 74.65072631835938, abs dis: 3.9571380615234375
[rfa agg] iter: 1, weight: tensor([0.0696, 0.1527, 0.0161, 0.0061, 0.0628, 0.0849, 0.1800, 0.2138, 0.1940,
        0.0200])
[rfa agg] iter:  2, prev_obj_val: 74.65072631835938, obj_val: 76.6300277709961, abs dis: 1.9793014526367188
[rfa agg] iter: 2, weight: tensor([0.0605, 0.1116, 0.0181, 0.0065, 0.0557, 0.1111, 0.2253, 0.2022, 0.1861,
        0.0229])
[rfa agg] iter:  3, prev_obj_val: 76.6300277709961, obj_val: 76.62492370605469, abs dis: 0.00510406494140625
[rfa agg] iter: 3, weight: tensor([0.0602, 0.1049, 0.0196, 0.0070, 0.0558, 0.1282, 0.2360, 0.1867, 0.1765,
        0.0250])
[rfa agg] iter:  4, prev_obj_val: 76.62492370605469, obj_val: 76.62483978271484, abs dis: 8.392333984375e-05
[rfa agg] iter: 4, weight: tensor([0.0601, 0.1046, 0.0196, 0.0070, 0.0557, 0.1298, 0.2385, 0.1843, 0.1754,
        0.0250])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 14.4055, Accuracy: 39/10000 (0.3900%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 14.2495, Accuracy: 0/9950 (0.0000%)
saving model
Done in 360.09143328666687 sec.
Server Epoch:68 choose agents : [21, 24, 59, 44, 84, 9, 17, 88, 52, 63].
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   1, Avg loss: 0.0577, Accuracy: 333/1949 (17.0857%)
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   2, Avg loss: 0.0360, Accuracy: 540/1949 (27.7065%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.1560, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   1, Avg loss: 0.0876, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   2, Avg loss: 0.0463, Accuracy: 134/312 (42.9487%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.4127, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   1, Avg loss: 0.0522, Accuracy: 270/1089 (24.7934%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   2, Avg loss: 0.0296, Accuracy: 466/1089 (42.7916%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.5709, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0686, Accuracy: 299/1750 (17.0857%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0386, Accuracy: 632/1750 (36.1143%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.5744, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  68, local model 84, internal_epoch   1, Avg loss: 0.0658, Accuracy: 256/1190 (21.5126%)
_Train Local_ResNet_18, epoch  68, local model 84, internal_epoch   2, Avg loss: 0.0347, Accuracy: 431/1190 (36.2185%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.1941, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0577, Accuracy: 284/1275 (22.2745%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0207, Accuracy: 641/1275 (50.2745%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 12.0543, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0631, Accuracy: 259/1574 (16.4549%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0325, Accuracy: 544/1574 (34.5616%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.0051, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   1, Avg loss: 0.0824, Accuracy: 63/603 (10.4478%)
_Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   2, Avg loss: 0.0475, Accuracy: 276/603 (45.7711%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.0403, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0626, Accuracy: 223/636 (35.0629%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0356, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.4822, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   1, Avg loss: 0.0691, Accuracy: 182/888 (20.4955%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   2, Avg loss: 0.0293, Accuracy: 435/888 (48.9865%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.6296, Accuracy: 67/10000 (0.6700%)
time spent on training: 312.8952884674072
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 312, 1089, 1750, 1190, 1275, 1574, 603, 636, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 24, 59, 44, 84, 9, 17, 88, 52, 63], weight: tensor([0.1730, 0.0277, 0.0967, 0.1553, 0.1056, 0.1132, 0.1397, 0.0535, 0.0565,
        0.0788])
[rfa agg] iter:  0, prev_obj_val: 68.03846740722656, obj_val: 71.47224426269531, abs dis: 3.43377685546875
[rfa agg] iter: 0, weight: tensor([0.0864, 0.0112, 0.1058, 0.1045, 0.1923, 0.2182, 0.1348, 0.0330, 0.0343,
        0.0795])
[rfa agg] iter:  1, prev_obj_val: 71.47224426269531, obj_val: 73.06610870361328, abs dis: 1.5938644409179688
[rfa agg] iter: 1, weight: tensor([0.0786, 0.0126, 0.1133, 0.0916, 0.2036, 0.2027, 0.1132, 0.0393, 0.0408,
        0.1043])
[rfa agg] iter:  2, prev_obj_val: 73.06610870361328, obj_val: 73.06306457519531, abs dis: 0.00304412841796875
[rfa agg] iter: 2, weight: tensor([0.0777, 0.0134, 0.1166, 0.0897, 0.1993, 0.1890, 0.1090, 0.0427, 0.0443,
        0.1183])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 12.5860, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 11.5342, Accuracy: 0/9950 (0.0000%)
saving model
Done in 434.18404507637024 sec.
Server Epoch:69 choose agents : [21, 31, 44, 90, 70, 81, 84, 5, 69, 76].
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0581, Accuracy: 337/1949 (17.2909%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0352, Accuracy: 579/1949 (29.7075%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.0685, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   1, Avg loss: 0.0865, Accuracy: 14/460 (3.0435%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   2, Avg loss: 0.0397, Accuracy: 172/460 (37.3913%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.0166, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   1, Avg loss: 0.0671, Accuracy: 303/1750 (17.3143%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   2, Avg loss: 0.0385, Accuracy: 628/1750 (35.8857%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.0856, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   1, Avg loss: 0.0701, Accuracy: 176/677 (25.9970%)
_Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   2, Avg loss: 0.0243, Accuracy: 456/677 (67.3560%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 14.0455, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0629, Accuracy: 317/1418 (22.3554%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0350, Accuracy: 516/1418 (36.3893%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.3134, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  69, local model 81, internal_epoch   1, Avg loss: 0.0824, Accuracy: 147/774 (18.9922%)
_Train Local_ResNet_18, epoch  69, local model 81, internal_epoch   2, Avg loss: 0.0418, Accuracy: 281/774 (36.3049%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.8427, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  69, local model 84, internal_epoch   1, Avg loss: 0.0664, Accuracy: 256/1190 (21.5126%)
_Train Local_ResNet_18, epoch  69, local model 84, internal_epoch   2, Avg loss: 0.0336, Accuracy: 422/1190 (35.4622%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.1663, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   1, Avg loss: 0.0515, Accuracy: 305/1628 (18.7346%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   2, Avg loss: 0.0276, Accuracy: 727/1628 (44.6560%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.8667, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0601, Accuracy: 218/590 (36.9492%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0325, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 12.8124, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 76, internal_epoch   1, Avg loss: 0.0895, Accuracy: 15/466 (3.2189%)
_Train Local_ResNet_18, epoch  69, local model 76, internal_epoch   2, Avg loss: 0.0507, Accuracy: 178/466 (38.1974%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.5530, Accuracy: 58/10000 (0.5800%)
time spent on training: 325.73225951194763
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 460, 1750, 677, 1418, 774, 1190, 1628, 590, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 31, 44, 90, 70, 81, 84, 5, 69, 76], weight: tensor([0.1788, 0.0422, 0.1605, 0.0621, 0.1301, 0.0710, 0.1092, 0.1493, 0.0541,
        0.0427])
[rfa agg] iter:  0, prev_obj_val: 74.95027160644531, obj_val: 74.6885757446289, abs dis: 0.26169586181640625
[rfa agg] iter: 0, weight: tensor([0.1005, 0.0260, 0.1178, 0.0522, 0.1795, 0.0741, 0.2459, 0.1372, 0.0405,
        0.0264])
[rfa agg] iter:  1, prev_obj_val: 74.6885757446289, obj_val: 76.10371398925781, abs dis: 1.4151382446289062
[rfa agg] iter: 1, weight: tensor([0.0952, 0.0248, 0.1119, 0.0498, 0.1743, 0.0709, 0.2784, 0.1308, 0.0387,
        0.0252])
[rfa agg] iter:  2, prev_obj_val: 76.10371398925781, obj_val: 77.65463256835938, abs dis: 1.5509185791015625
[rfa agg] iter: 2, weight: tensor([0.0927, 0.0262, 0.1078, 0.0534, 0.1623, 0.0767, 0.2886, 0.1246, 0.0412,
        0.0266])
[rfa agg] iter:  3, prev_obj_val: 77.65463256835938, obj_val: 77.6527099609375, abs dis: 0.001922607421875
[rfa agg] iter: 3, weight: tensor([0.0916, 0.0280, 0.1055, 0.0582, 0.1537, 0.0846, 0.2846, 0.1207, 0.0446,
        0.0285])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 11.8465, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 12.1555, Accuracy: 0/9950 (0.0000%)
saving model
Done in 436.21758103370667 sec.
Server Epoch:70 choose agents : [7, 75, 77, 74, 16, 9, 19, 99, 48, 66].
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   1, Avg loss: 0.0548, Accuracy: 267/891 (29.9663%)
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 439/891 (49.2705%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.7924, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0849, Accuracy: 124/776 (15.9794%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0347, Accuracy: 390/776 (50.2577%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.3371, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  70, local model 77, internal_epoch   1, Avg loss: 0.0633, Accuracy: 220/1340 (16.4179%)
_Train Local_ResNet_18, epoch  70, local model 77, internal_epoch   2, Avg loss: 0.0289, Accuracy: 553/1340 (41.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.3403, Accuracy: 80/10000 (0.8000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   1, Avg loss: 0.0496, Accuracy: 426/1552 (27.4485%)
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   2, Avg loss: 0.0226, Accuracy: 759/1552 (48.9046%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 11.8867, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   1, Avg loss: 0.0756, Accuracy: 190/708 (26.8362%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   2, Avg loss: 0.0377, Accuracy: 424/708 (59.8870%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.7859, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   1, Avg loss: 0.0549, Accuracy: 307/1275 (24.0784%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   2, Avg loss: 0.0207, Accuracy: 688/1275 (53.9608%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 11.9624, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0614, Accuracy: 268/1036 (25.8687%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0274, Accuracy: 599/1036 (57.8185%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 13.6040, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   1, Avg loss: 0.0658, Accuracy: 163/773 (21.0867%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   2, Avg loss: 0.0374, Accuracy: 423/773 (54.7219%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.6022, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0833, Accuracy: 37/631 (5.8637%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0459, Accuracy: 226/631 (35.8162%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.5945, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0743, Accuracy: 168/1402 (11.9829%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0427, Accuracy: 381/1402 (27.1755%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.5938, Accuracy: 84/10000 (0.8400%)
time spent on training: 337.26230025291443
[rfa agg] training data poison_ratio: 0.14946070878274267  data num: [891, 776, 1340, 1552, 708, 1275, 1036, 773, 631, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.046706471494607084
[rfa agg] init. name: [7, 75, 77, 74, 16, 9, 19, 99, 48, 66], weight: tensor([0.0858, 0.0747, 0.1290, 0.1495, 0.0682, 0.1228, 0.0998, 0.0744, 0.0608,
        0.1350])
[rfa agg] iter:  0, prev_obj_val: 52.77085876464844, obj_val: 55.92648696899414, abs dis: 3.155628204345703
[rfa agg] iter: 0, weight: tensor([0.1562, 0.1138, 0.0957, 0.0709, 0.0751, 0.1018, 0.1446, 0.0996, 0.0547,
        0.0876])
[rfa agg] iter:  1, prev_obj_val: 55.92648696899414, obj_val: 54.127342224121094, abs dis: 1.7991447448730469
[rfa agg] iter: 1, weight: tensor([0.1809, 0.1342, 0.0811, 0.0623, 0.0858, 0.0853, 0.1195, 0.1129, 0.0633,
        0.0748])
[rfa agg] iter:  2, prev_obj_val: 54.127342224121094, obj_val: 55.90212631225586, abs dis: 1.7747840881347656
[rfa agg] iter: 2, weight: tensor([0.1820, 0.1251, 0.0856, 0.0646, 0.0805, 0.0902, 0.1286, 0.1073, 0.0576,
        0.0784])
[rfa agg] iter:  3, prev_obj_val: 55.90212631225586, obj_val: 55.89788818359375, abs dis: 0.004238128662109375
[rfa agg] iter: 3, weight: tensor([0.1859, 0.1343, 0.0802, 0.0617, 0.0860, 0.0844, 0.1175, 0.1130, 0.0629,
        0.0740])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 13.2208, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 13.9999, Accuracy: 0/9950 (0.0000%)
saving model
Done in 448.3704106807709 sec.
Server Epoch:71 choose agents : [49, 6, 75, 91, 83, 24, 33, 79, 18, 85].
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0812, Accuracy: 14/440 (3.1818%)
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0485, Accuracy: 137/440 (31.1364%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.3719, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   1, Avg loss: 0.0608, Accuracy: 335/1956 (17.1268%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   2, Avg loss: 0.0350, Accuracy: 583/1956 (29.8057%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.1341, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  71, local model 75, internal_epoch   1, Avg loss: 0.0830, Accuracy: 134/776 (17.2680%)
_Train Local_ResNet_18, epoch  71, local model 75, internal_epoch   2, Avg loss: 0.0333, Accuracy: 381/776 (49.0979%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.6656, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  71, local model 91, internal_epoch   1, Avg loss: 0.0610, Accuracy: 271/1030 (26.3107%)
_Train Local_ResNet_18, epoch  71, local model 91, internal_epoch   2, Avg loss: 0.0313, Accuracy: 536/1030 (52.0388%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.7358, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   1, Avg loss: 0.0666, Accuracy: 331/1953 (16.9483%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   2, Avg loss: 0.0361, Accuracy: 674/1953 (34.5110%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.5755, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   1, Avg loss: 0.0837, Accuracy: 6/312 (1.9231%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   2, Avg loss: 0.0440, Accuracy: 142/312 (45.5128%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.2173, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   1, Avg loss: 0.0845, Accuracy: 43/515 (8.3495%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   2, Avg loss: 0.0555, Accuracy: 134/515 (26.0194%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.1551, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   1, Avg loss: 0.1099, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   2, Avg loss: 0.0983, Accuracy: 10/197 (5.0761%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.0406, Accuracy: 40/10000 (0.4000%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0957, Accuracy: 19/530 (3.5849%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0413, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 11.1432, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  71, local model 85, internal_epoch   1, Avg loss: 0.0574, Accuracy: 359/1988 (18.0584%)
_Train Local_ResNet_18, epoch  71, local model 85, internal_epoch   2, Avg loss: 0.0383, Accuracy: 569/1988 (28.6217%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.9739, Accuracy: 91/10000 (0.9100%)
time spent on training: 301.4227647781372
[rfa agg] training data poison_ratio: 0.0  data num: [440, 1956, 776, 1030, 1953, 312, 515, 197, 530, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [49, 6, 75, 91, 83, 24, 33, 79, 18, 85], weight: tensor([0.0454, 0.2017, 0.0800, 0.1062, 0.2014, 0.0322, 0.0531, 0.0203, 0.0547,
        0.2050])
[rfa agg] iter:  0, prev_obj_val: 96.54560089111328, obj_val: 97.47515869140625, abs dis: 0.9295578002929688
[rfa agg] iter: 0, weight: tensor([0.0319, 0.1931, 0.0952, 0.1919, 0.1923, 0.0197, 0.0429, 0.0116, 0.0447,
        0.1768])
[rfa agg] iter:  1, prev_obj_val: 97.47515869140625, obj_val: 97.46856689453125, abs dis: 0.006591796875
[rfa agg] iter: 1, weight: tensor([0.0326, 0.1828, 0.0998, 0.2134, 0.1820, 0.0200, 0.0441, 0.0118, 0.0460,
        0.1675])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 15.0655, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 15.0394, Accuracy: 0/9950 (0.0000%)
saving model
Done in 414.91731309890747 sec.
Server Epoch:72 choose agents : [31, 17, 64, 92, 34, 20, 4, 63, 22, 19].
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   1, Avg loss: 0.0893, Accuracy: 11/460 (2.3913%)
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   2, Avg loss: 0.0370, Accuracy: 175/460 (38.0435%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.6703, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   1, Avg loss: 0.0626, Accuracy: 253/1574 (16.0737%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   2, Avg loss: 0.0313, Accuracy: 584/1574 (37.1029%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.9377, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   1, Avg loss: 0.0702, Accuracy: 167/953 (17.5236%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   2, Avg loss: 0.0419, Accuracy: 307/953 (32.2141%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.3820, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  72, local model 92, internal_epoch   1, Avg loss: 0.0616, Accuracy: 356/1715 (20.7580%)
_Train Local_ResNet_18, epoch  72, local model 92, internal_epoch   2, Avg loss: 0.0316, Accuracy: 707/1715 (41.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.9590, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   1, Avg loss: 0.0650, Accuracy: 307/1427 (21.5137%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   2, Avg loss: 0.0342, Accuracy: 592/1427 (41.4856%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2214, Accuracy: 92/10000 (0.9200%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  72, local model 20, internal_epoch   1, Avg loss: 0.0683, Accuracy: 232/807 (28.7485%)
_Train Local_ResNet_18, epoch  72, local model 20, internal_epoch   2, Avg loss: 0.0384, Accuracy: 407/807 (50.4337%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.1259, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   1, Avg loss: 0.0688, Accuracy: 253/901 (28.0799%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   2, Avg loss: 0.0346, Accuracy: 368/901 (40.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.3133, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0681, Accuracy: 185/888 (20.8333%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0304, Accuracy: 391/888 (44.0315%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 11.0596, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0513, Accuracy: 398/1470 (27.0748%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0255, Accuracy: 812/1470 (55.2381%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.9560, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0611, Accuracy: 295/1036 (28.4749%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0274, Accuracy: 583/1036 (56.2741%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 13.7254, Accuracy: 64/10000 (0.6400%)
time spent on training: 344.4907522201538
[rfa agg] training data poison_ratio: 0.07185468791737155  data num: [460, 1574, 953, 1715, 1427, 807, 901, 888, 1470, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.02245458997417861
[rfa agg] init. name: [31, 17, 64, 92, 34, 20, 4, 63, 22, 19], weight: tensor([0.0410, 0.1401, 0.0849, 0.1527, 0.1271, 0.0719, 0.0802, 0.0791, 0.1309,
        0.0922])
[rfa agg] iter:  0, prev_obj_val: 55.597408294677734, obj_val: 58.4576530456543, abs dis: 2.8602447509765625
[rfa agg] iter: 0, weight: tensor([0.0210, 0.0987, 0.1184, 0.0846, 0.1202, 0.0655, 0.1011, 0.0863, 0.1149,
        0.1894])
[rfa agg] iter:  1, prev_obj_val: 58.4576530456543, obj_val: 63.54238510131836, abs dis: 5.0847320556640625
[rfa agg] iter: 1, weight: tensor([0.0223, 0.0760, 0.1535, 0.0671, 0.0888, 0.0757, 0.1203, 0.1032, 0.0869,
        0.2064])
[rfa agg] iter:  2, prev_obj_val: 63.54238510131836, obj_val: 61.5249137878418, abs dis: 2.0174713134765625
[rfa agg] iter: 2, weight: tensor([0.0261, 0.0643, 0.1901, 0.0583, 0.0724, 0.0955, 0.1370, 0.1312, 0.0717,
        0.1534])
[rfa agg] iter:  3, prev_obj_val: 61.5249137878418, obj_val: 61.52320098876953, abs dis: 0.001712799072265625
[rfa agg] iter: 3, weight: tensor([0.0242, 0.0662, 0.1919, 0.0594, 0.0751, 0.0878, 0.1361, 0.1243, 0.0740,
        0.1611])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 13.6752, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 13.7518, Accuracy: 0/9950 (0.0000%)
saving model
Done in 460.5173234939575 sec.
Server Epoch:73 choose agents : [27, 74, 34, 98, 4, 72, 82, 12, 59, 89].
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   1, Avg loss: 0.0698, Accuracy: 298/1587 (18.7776%)
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   2, Avg loss: 0.0374, Accuracy: 525/1587 (33.0813%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.6285, Accuracy: 65/10000 (0.6500%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  73, local model 74, internal_epoch   1, Avg loss: 0.0502, Accuracy: 402/1552 (25.9021%)
_Train Local_ResNet_18, epoch  73, local model 74, internal_epoch   2, Avg loss: 0.0228, Accuracy: 711/1552 (45.8119%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 12.2153, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   1, Avg loss: 0.0638, Accuracy: 329/1427 (23.0554%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   2, Avg loss: 0.0349, Accuracy: 544/1427 (38.1219%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.3070, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   1, Avg loss: 0.0878, Accuracy: 9/373 (2.4129%)
_Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   2, Avg loss: 0.0526, Accuracy: 133/373 (35.6568%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.0824, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0629, Accuracy: 266/901 (29.5228%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0361, Accuracy: 373/901 (41.3984%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.5282, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   1, Avg loss: 0.0645, Accuracy: 221/1241 (17.8082%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   2, Avg loss: 0.0376, Accuracy: 442/1241 (35.6164%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.6300, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  73, local model 82, internal_epoch   1, Avg loss: 0.0752, Accuracy: 37/500 (7.4000%)
_Train Local_ResNet_18, epoch  73, local model 82, internal_epoch   2, Avg loss: 0.0458, Accuracy: 218/500 (43.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.5047, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   1, Avg loss: 0.0948, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   2, Avg loss: 0.0529, Accuracy: 106/338 (31.3609%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.0249, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   1, Avg loss: 0.0515, Accuracy: 282/1089 (25.8953%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   2, Avg loss: 0.0299, Accuracy: 437/1089 (40.1286%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 11.6299, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  73, local model 89, internal_epoch   1, Avg loss: 0.0630, Accuracy: 283/896 (31.5848%)
_Train Local_ResNet_18, epoch  73, local model 89, internal_epoch   2, Avg loss: 0.0363, Accuracy: 431/896 (48.1027%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.4519, Accuracy: 67/10000 (0.6700%)
time spent on training: 303.79600048065186
[rfa agg] training data poison_ratio: 0.1567043618739903  data num: [1587, 1552, 1427, 373, 901, 1241, 500, 338, 1089, 896]
[rfa agg] considering poison per batch poison_fraction: 0.04897011308562197
[rfa agg] init. name: [27, 74, 34, 98, 4, 72, 82, 12, 59, 89], weight: tensor([0.1602, 0.1567, 0.1441, 0.0377, 0.0910, 0.1253, 0.0505, 0.0341, 0.1100,
        0.0905])
[rfa agg] iter:  0, prev_obj_val: 62.194557189941406, obj_val: 62.061946868896484, abs dis: 0.13261032104492188
[rfa agg] iter: 0, weight: tensor([0.1067, 0.1048, 0.1212, 0.0203, 0.1567, 0.1737, 0.0340, 0.0185, 0.1157,
        0.1485])
[rfa agg] iter:  1, prev_obj_val: 62.061946868896484, obj_val: 62.06118392944336, abs dis: 0.000762939453125
[rfa agg] iter: 1, weight: tensor([0.1042, 0.1024, 0.1186, 0.0199, 0.1636, 0.1744, 0.0333, 0.0181, 0.1141,
        0.1512])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 14.2365, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 14.3554, Accuracy: 0/9950 (0.0000%)
saving model
Done in 415.96578311920166 sec.
Server Epoch:74 choose agents : [9, 38, 74, 63, 50, 44, 1, 93, 94, 53].
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   1, Avg loss: 0.0549, Accuracy: 309/1275 (24.2353%)
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   2, Avg loss: 0.0200, Accuracy: 687/1275 (53.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 11.9615, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   1, Avg loss: 0.0769, Accuracy: 163/1131 (14.4120%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   2, Avg loss: 0.0367, Accuracy: 462/1131 (40.8488%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.9837, Accuracy: 94/10000 (0.9400%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   1, Avg loss: 0.0495, Accuracy: 413/1552 (26.6108%)
_Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   2, Avg loss: 0.0235, Accuracy: 675/1552 (43.4923%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 11.6927, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0678, Accuracy: 190/888 (21.3964%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0285, Accuracy: 429/888 (48.3108%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 11.3157, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0770, Accuracy: 88/809 (10.8776%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0294, Accuracy: 337/809 (41.6564%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.2758, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0679, Accuracy: 281/1750 (16.0571%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0391, Accuracy: 573/1750 (32.7429%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.3140, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   1, Avg loss: 0.0584, Accuracy: 244/928 (26.2931%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   2, Avg loss: 0.0264, Accuracy: 521/928 (56.1422%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.7252, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0608, Accuracy: 345/1742 (19.8048%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0327, Accuracy: 665/1742 (38.1745%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.8652, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   1, Avg loss: 0.0651, Accuracy: 262/1662 (15.7641%)
_Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   2, Avg loss: 0.0374, Accuracy: 516/1662 (31.0469%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.0348, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   1, Avg loss: 0.0423, Accuracy: 294/813 (36.1624%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   2, Avg loss: 0.0205, Accuracy: 468/813 (57.5646%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 12.6365, Accuracy: 62/10000 (0.6200%)
time spent on training: 354.63760352134705
[rfa agg] training data poison_ratio: 0.12366533864541833  data num: [1275, 1131, 1552, 888, 809, 1750, 928, 1742, 1662, 813]
[rfa agg] considering poison per batch poison_fraction: 0.03864541832669323
[rfa agg] init. name: [9, 38, 74, 63, 50, 44, 1, 93, 94, 53], weight: tensor([0.1016, 0.0901, 0.1237, 0.0708, 0.0645, 0.1394, 0.0739, 0.1388, 0.1324,
        0.0648])
[rfa agg] iter:  0, prev_obj_val: 61.49262619018555, obj_val: 65.40369415283203, abs dis: 3.9110679626464844
[rfa agg] iter: 0, weight: tensor([0.1712, 0.1496, 0.1085, 0.0779, 0.0612, 0.0889, 0.0843, 0.0889, 0.1078,
        0.0616])
[rfa agg] iter:  1, prev_obj_val: 65.40369415283203, obj_val: 67.04692840576172, abs dis: 1.6432342529296875
[rfa agg] iter: 1, weight: tensor([0.1510, 0.1629, 0.0892, 0.1005, 0.0763, 0.0757, 0.1036, 0.0755, 0.0889,
        0.0763])
[rfa agg] iter:  2, prev_obj_val: 67.04692840576172, obj_val: 63.8718147277832, abs dis: 3.1751136779785156
[rfa agg] iter: 2, weight: tensor([0.1377, 0.1603, 0.0837, 0.1119, 0.0834, 0.0720, 0.1123, 0.0718, 0.0837,
        0.0832])
[rfa agg] iter:  3, prev_obj_val: 63.8718147277832, obj_val: 67.05482482910156, abs dis: 3.1830101013183594
[rfa agg] iter: 3, weight: tensor([0.1582, 0.1680, 0.0929, 0.0922, 0.0702, 0.0784, 0.0985, 0.0783, 0.0930,
        0.0702])
[rfa agg] iter:  4, prev_obj_val: 67.05482482910156, obj_val: 63.871185302734375, abs dis: 3.1836395263671875
[rfa agg] iter: 4, weight: tensor([0.1382, 0.1609, 0.0838, 0.1114, 0.0832, 0.0721, 0.1117, 0.0719, 0.0838,
        0.0831])
[rfa agg] iter:  5, prev_obj_val: 63.871185302734375, obj_val: 67.05485534667969, abs dis: 3.1836700439453125
[rfa agg] iter: 5, weight: tensor([0.1582, 0.1681, 0.0929, 0.0922, 0.0702, 0.0784, 0.0985, 0.0782, 0.0930,
        0.0702])
[rfa agg] iter:  6, prev_obj_val: 67.05485534667969, obj_val: 63.871185302734375, abs dis: 3.1836700439453125
[rfa agg] iter: 6, weight: tensor([0.1382, 0.1609, 0.0838, 0.1114, 0.0832, 0.0721, 0.1117, 0.0719, 0.0838,
        0.0831])
[rfa agg] iter:  7, prev_obj_val: 63.871185302734375, obj_val: 67.05485534667969, abs dis: 3.1836700439453125
[rfa agg] iter: 7, weight: tensor([0.1582, 0.1681, 0.0929, 0.0922, 0.0702, 0.0784, 0.0985, 0.0782, 0.0930,
        0.0702])
[rfa agg] iter:  8, prev_obj_val: 67.05485534667969, obj_val: 63.871185302734375, abs dis: 3.1836700439453125
[rfa agg] iter: 8, weight: tensor([0.1382, 0.1609, 0.0838, 0.1114, 0.0832, 0.0721, 0.1117, 0.0719, 0.0838,
        0.0831])
[rfa agg] iter:  9, prev_obj_val: 63.871185302734375, obj_val: 67.05485534667969, abs dis: 3.1836700439453125
[rfa agg] iter: 9, weight: tensor([0.1582, 0.1681, 0.0929, 0.0922, 0.0702, 0.0784, 0.0985, 0.0782, 0.0930,
        0.0702])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 14.9359, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 16.7215, Accuracy: 0/9950 (0.0000%)
saving model
Done in 470.3075773715973 sec.
Server Epoch:75 choose agents : [89, 65, 75, 86, 4, 55, 82, 12, 21, 64].
_Train Local_ResNet_18, epoch  75, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 303/896 (33.8170%)
_Train Local_ResNet_18, epoch  75, local model 89, internal_epoch   2, Avg loss: 0.0343, Accuracy: 434/896 (48.4375%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.5926, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0720, Accuracy: 307/1475 (20.8136%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0358, Accuracy: 585/1475 (39.6610%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.3612, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   1, Avg loss: 0.0850, Accuracy: 147/776 (18.9433%)
_Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   2, Avg loss: 0.0372, Accuracy: 371/776 (47.8093%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.3817, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  75, local model 86, internal_epoch   1, Avg loss: 0.0657, Accuracy: 249/1003 (24.8255%)
_Train Local_ResNet_18, epoch  75, local model 86, internal_epoch   2, Avg loss: 0.0363, Accuracy: 394/1003 (39.2822%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2876, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   1, Avg loss: 0.0648, Accuracy: 270/901 (29.9667%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   2, Avg loss: 0.0353, Accuracy: 371/901 (41.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.1411, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 270/1071 (25.2101%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   2, Avg loss: 0.0307, Accuracy: 498/1071 (46.4986%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.0566, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  75, local model 82, internal_epoch   1, Avg loss: 0.0783, Accuracy: 33/500 (6.6000%)
_Train Local_ResNet_18, epoch  75, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 218/500 (43.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.0225, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   1, Avg loss: 0.0970, Accuracy: 6/338 (1.7751%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   2, Avg loss: 0.0510, Accuracy: 119/338 (35.2071%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.9748, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   1, Avg loss: 0.0594, Accuracy: 341/1949 (17.4962%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   2, Avg loss: 0.0356, Accuracy: 592/1949 (30.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.1859, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0680, Accuracy: 164/953 (17.2088%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0410, Accuracy: 285/953 (29.9056%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.4094, Accuracy: 62/10000 (0.6200%)
time spent on training: 280.1180121898651
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1475, 776, 1003, 901, 1071, 500, 338, 1949, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 65, 75, 86, 4, 55, 82, 12, 21, 64], weight: tensor([0.0909, 0.1496, 0.0787, 0.1017, 0.0914, 0.1086, 0.0507, 0.0343, 0.1976,
        0.0966])
[rfa agg] iter:  0, prev_obj_val: 62.40060043334961, obj_val: 66.79100799560547, abs dis: 4.390407562255859
[rfa agg] iter: 0, weight: tensor([0.1127, 0.0833, 0.0855, 0.1825, 0.1230, 0.1652, 0.0270, 0.0146, 0.0625,
        0.1437])
[rfa agg] iter:  1, prev_obj_val: 66.79100799560547, obj_val: 71.2373275756836, abs dis: 4.446319580078125
[rfa agg] iter: 1, weight: tensor([0.1554, 0.0606, 0.1270, 0.1518, 0.1303, 0.1171, 0.0344, 0.0173, 0.0498,
        0.1562])
[rfa agg] iter:  2, prev_obj_val: 71.2373275756836, obj_val: 68.8219985961914, abs dis: 2.4153289794921875
[rfa agg] iter: 2, weight: tensor([0.1644, 0.0605, 0.1545, 0.1310, 0.1242, 0.1050, 0.0435, 0.0210, 0.0511,
        0.1446])
[rfa agg] iter:  3, prev_obj_val: 68.8219985961914, obj_val: 71.22695922851562, abs dis: 2.4049606323242188
[rfa agg] iter: 3, weight: tensor([0.1655, 0.0596, 0.1482, 0.1373, 0.1261, 0.1075, 0.0382, 0.0188, 0.0497,
        0.1490])
[rfa agg] iter:  4, prev_obj_val: 71.22695922851562, obj_val: 68.82258605957031, abs dis: 2.4043731689453125
[rfa agg] iter: 4, weight: tensor([0.1651, 0.0603, 0.1580, 0.1300, 0.1234, 0.1044, 0.0434, 0.0210, 0.0510,
        0.1435])
[rfa agg] iter:  5, prev_obj_val: 68.82258605957031, obj_val: 71.22686004638672, abs dis: 2.4042739868164062
[rfa agg] iter: 5, weight: tensor([0.1656, 0.0596, 0.1487, 0.1372, 0.1259, 0.1074, 0.0382, 0.0188, 0.0497,
        0.1488])
[rfa agg] iter:  6, prev_obj_val: 71.22686004638672, obj_val: 68.82260131835938, abs dis: 2.4042587280273438
[rfa agg] iter: 6, weight: tensor([0.1651, 0.0603, 0.1580, 0.1300, 0.1234, 0.1044, 0.0434, 0.0210, 0.0510,
        0.1435])
[rfa agg] iter:  7, prev_obj_val: 68.82260131835938, obj_val: 71.22684478759766, abs dis: 2.4042434692382812
[rfa agg] iter: 7, weight: tensor([0.1655, 0.0596, 0.1487, 0.1372, 0.1259, 0.1074, 0.0382, 0.0188, 0.0497,
        0.1488])
[rfa agg] iter:  8, prev_obj_val: 71.22684478759766, obj_val: 68.82260131835938, abs dis: 2.4042434692382812
[rfa agg] iter: 8, weight: tensor([0.1651, 0.0603, 0.1580, 0.1300, 0.1234, 0.1044, 0.0434, 0.0210, 0.0510,
        0.1435])
[rfa agg] iter:  9, prev_obj_val: 68.82260131835938, obj_val: 71.22686004638672, abs dis: 2.4042587280273438
[rfa agg] iter: 9, weight: tensor([0.1655, 0.0596, 0.1488, 0.1372, 0.1259, 0.1074, 0.0382, 0.0188, 0.0497,
        0.1488])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 15.7038, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 16.5219, Accuracy: 0/9950 (0.0000%)
saving model
Done in 397.4297921657562 sec.
Server Epoch:76 choose agents : [5, 72, 10, 55, 84, 39, 17, 89, 93, 35].
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0537, Accuracy: 299/1628 (18.3661%)
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0287, Accuracy: 695/1628 (42.6904%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.3867, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   1, Avg loss: 0.0659, Accuracy: 198/1241 (15.9549%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   2, Avg loss: 0.0386, Accuracy: 410/1241 (33.0379%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.6706, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   1, Avg loss: 0.0838, Accuracy: 95/861 (11.0337%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   2, Avg loss: 0.0255, Accuracy: 410/861 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 12.0663, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   1, Avg loss: 0.0555, Accuracy: 253/1071 (23.6228%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   2, Avg loss: 0.0310, Accuracy: 471/1071 (43.9776%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.0932, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  76, local model 84, internal_epoch   1, Avg loss: 0.0682, Accuracy: 225/1190 (18.9076%)
_Train Local_ResNet_18, epoch  76, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 474/1190 (39.8319%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.6325, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   1, Avg loss: 0.0544, Accuracy: 274/1013 (27.0484%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   2, Avg loss: 0.0271, Accuracy: 477/1013 (47.0879%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.9483, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   1, Avg loss: 0.0624, Accuracy: 254/1574 (16.1372%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   2, Avg loss: 0.0313, Accuracy: 556/1574 (35.3240%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.6093, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  76, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 297/896 (33.1473%)
_Train Local_ResNet_18, epoch  76, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 435/896 (48.5491%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.3356, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   1, Avg loss: 0.0619, Accuracy: 344/1742 (19.7474%)
_Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   2, Avg loss: 0.0328, Accuracy: 636/1742 (36.5098%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.0118, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   1, Avg loss: 0.1075, Accuracy: 4/271 (1.4760%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   2, Avg loss: 0.0714, Accuracy: 72/271 (26.5683%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.7493, Accuracy: 52/10000 (0.5200%)
time spent on training: 333.5432107448578
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 1241, 861, 1071, 1190, 1013, 1574, 896, 1742, 271]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 72, 10, 55, 84, 39, 17, 89, 93, 35], weight: tensor([0.1417, 0.1080, 0.0750, 0.0932, 0.1036, 0.0882, 0.1370, 0.0780, 0.1516,
        0.0236])
[rfa agg] iter:  0, prev_obj_val: 55.42067337036133, obj_val: 59.10084915161133, abs dis: 3.68017578125
[rfa agg] iter: 0, weight: tensor([0.0891, 0.1614, 0.0723, 0.1407, 0.1549, 0.1196, 0.0988, 0.0765, 0.0781,
        0.0086])
[rfa agg] iter:  1, prev_obj_val: 59.10084915161133, obj_val: 60.82958984375, abs dis: 1.7287406921386719
[rfa agg] iter: 1, weight: tensor([0.0742, 0.1303, 0.0911, 0.1594, 0.1400, 0.1514, 0.0809, 0.0967, 0.0666,
        0.0094])
[rfa agg] iter:  2, prev_obj_val: 60.82958984375, obj_val: 65.12928771972656, abs dis: 4.2996978759765625
[rfa agg] iter: 2, weight: tensor([0.0705, 0.1171, 0.1007, 0.1628, 0.1284, 0.1640, 0.0763, 0.1068, 0.0637,
        0.0097])
[rfa agg] iter:  3, prev_obj_val: 65.12928771972656, obj_val: 60.83455276489258, abs dis: 4.294734954833984
[rfa agg] iter: 3, weight: tensor([0.0663, 0.1022, 0.1233, 0.1515, 0.1122, 0.1708, 0.0709, 0.1315, 0.0606,
        0.0108])
[rfa agg] iter:  4, prev_obj_val: 60.83455276489258, obj_val: 62.844627380371094, abs dis: 2.0100746154785156
[rfa agg] iter: 4, weight: tensor([0.0702, 0.1147, 0.1027, 0.1633, 0.1254, 0.1662, 0.0758, 0.1086, 0.0635,
        0.0097])
[rfa agg] iter:  5, prev_obj_val: 62.844627380371094, obj_val: 60.825016021728516, abs dis: 2.019611358642578
[rfa agg] iter: 5, weight: tensor([0.0679, 0.1080, 0.1118, 0.1590, 0.1187, 0.1710, 0.0730, 0.1187, 0.0617,
        0.0102])
[rfa agg] iter:  6, prev_obj_val: 60.825016021728516, obj_val: 62.84501647949219, abs dis: 2.020000457763672
[rfa agg] iter: 6, weight: tensor([0.0702, 0.1150, 0.1018, 0.1640, 0.1258, 0.1666, 0.0758, 0.1077, 0.0634,
        0.0097])
[rfa agg] iter:  7, prev_obj_val: 62.84501647949219, obj_val: 60.824989318847656, abs dis: 2.0200271606445312
[rfa agg] iter: 7, weight: tensor([0.0679, 0.1080, 0.1117, 0.1591, 0.1187, 0.1711, 0.0730, 0.1186, 0.0617,
        0.0102])
[rfa agg] iter:  8, prev_obj_val: 60.824989318847656, obj_val: 62.84502029418945, abs dis: 2.020030975341797
[rfa agg] iter: 8, weight: tensor([0.0702, 0.1150, 0.1018, 0.1640, 0.1258, 0.1667, 0.0758, 0.1077, 0.0634,
        0.0097])
[rfa agg] iter:  9, prev_obj_val: 62.84502029418945, obj_val: 60.82498550415039, abs dis: 2.0200347900390625
[rfa agg] iter: 9, weight: tensor([0.0679, 0.1080, 0.1117, 0.1591, 0.1187, 0.1711, 0.0730, 0.1186, 0.0617,
        0.0102])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 18.2461, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 21.0339, Accuracy: 0/9950 (0.0000%)
saving model
Done in 446.4108712673187 sec.
Server Epoch:77 choose agents : [61, 17, 20, 31, 50, 90, 71, 60, 96, 28].
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1511, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1425, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.2306, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   1, Avg loss: 0.0609, Accuracy: 278/1574 (17.6620%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   2, Avg loss: 0.0317, Accuracy: 546/1574 (34.6887%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.6817, Accuracy: 95/10000 (0.9500%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  77, local model 20, internal_epoch   1, Avg loss: 0.0677, Accuracy: 231/807 (28.6245%)
_Train Local_ResNet_18, epoch  77, local model 20, internal_epoch   2, Avg loss: 0.0391, Accuracy: 410/807 (50.8055%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.3223, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   1, Avg loss: 0.0917, Accuracy: 13/460 (2.8261%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   2, Avg loss: 0.0381, Accuracy: 174/460 (37.8261%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.1464, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   1, Avg loss: 0.0773, Accuracy: 84/809 (10.3832%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   2, Avg loss: 0.0305, Accuracy: 318/809 (39.3078%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 11.5063, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  77, local model 90, internal_epoch   1, Avg loss: 0.0759, Accuracy: 150/677 (22.1566%)
_Train Local_ResNet_18, epoch  77, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 467/677 (68.9808%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 13.4591, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   1, Avg loss: 0.0608, Accuracy: 176/818 (21.5159%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   2, Avg loss: 0.0325, Accuracy: 342/818 (41.8093%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.0634, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0579, Accuracy: 450/2227 (20.2066%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0318, Accuracy: 848/2227 (38.0781%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.2216, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  77, local model 96, internal_epoch   1, Avg loss: 0.0782, Accuracy: 25/311 (8.0386%)
_Train Local_ResNet_18, epoch  77, local model 96, internal_epoch   2, Avg loss: 0.0547, Accuracy: 126/311 (40.5145%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.2259, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   1, Avg loss: 0.0657, Accuracy: 278/1581 (17.5838%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   2, Avg loss: 0.0373, Accuracy: 516/1581 (32.6376%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.5493, Accuracy: 70/10000 (0.7000%)
time spent on training: 321.4530839920044
[rfa agg] training data poison_ratio: 0.08631939244839021  data num: [85, 1574, 807, 460, 809, 677, 818, 2227, 311, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.02697481014012194
[rfa agg] init. name: [61, 17, 20, 31, 50, 90, 71, 60, 96, 28], weight: tensor([0.0091, 0.1684, 0.0863, 0.0492, 0.0865, 0.0724, 0.0875, 0.2382, 0.0333,
        0.1691])
[rfa agg] iter:  0, prev_obj_val: 87.69210815429688, obj_val: 89.33438110351562, abs dis: 1.64227294921875
[rfa agg] iter: 0, weight: tensor([0.0041, 0.2175, 0.0994, 0.0350, 0.1023, 0.0691, 0.1048, 0.1253, 0.0186,
        0.2239])
[rfa agg] iter:  1, prev_obj_val: 89.33438110351562, obj_val: 90.00740814208984, abs dis: 0.6730270385742188
[rfa agg] iter: 1, weight: tensor([0.0043, 0.1822, 0.1204, 0.0394, 0.1253, 0.0814, 0.1285, 0.1121, 0.0203,
        0.1861])
[rfa agg] iter:  2, prev_obj_val: 90.00740814208984, obj_val: 91.55950927734375, abs dis: 1.5521011352539062
[rfa agg] iter: 2, weight: tensor([0.0044, 0.1680, 0.1288, 0.0406, 0.1347, 0.0859, 0.1384, 0.1072, 0.0207,
        0.1714])
[rfa agg] iter:  3, prev_obj_val: 91.55950927734375, obj_val: 92.39962768554688, abs dis: 0.840118408203125
[rfa agg] iter: 3, weight: tensor([0.0044, 0.1428, 0.1432, 0.0426, 0.1524, 0.0943, 0.1574, 0.0964, 0.0211,
        0.1454])
[rfa agg] iter:  4, prev_obj_val: 92.39962768554688, obj_val: 93.32648468017578, abs dis: 0.9268569946289062
[rfa agg] iter: 4, weight: tensor([0.0043, 0.1298, 0.1506, 0.0432, 0.1623, 0.0984, 0.1683, 0.0901, 0.0211,
        0.1320])
[rfa agg] iter:  5, prev_obj_val: 93.32648468017578, obj_val: 95.5076904296875, abs dis: 2.1812057495117188
[rfa agg] iter: 5, weight: tensor([0.0042, 0.1178, 0.1570, 0.0436, 0.1716, 0.1024, 0.1789, 0.0838, 0.0210,
        0.1197])
[rfa agg] iter:  6, prev_obj_val: 95.5076904296875, obj_val: 96.80230712890625, abs dis: 1.29461669921875
[rfa agg] iter: 6, weight: tensor([0.0040, 0.0967, 0.1656, 0.0443, 0.1881, 0.1117, 0.1990, 0.0718, 0.0206,
        0.0981])
[rfa agg] iter:  7, prev_obj_val: 96.80230712890625, obj_val: 96.7982406616211, abs dis: 0.00406646728515625
[rfa agg] iter: 7, weight: tensor([0.0039, 0.0871, 0.1676, 0.0446, 0.1958, 0.1176, 0.2088, 0.0660, 0.0203,
        0.0883])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.9630, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.3121, Accuracy: 0/9950 (0.0000%)
saving model
Done in 438.5063714981079 sec.
Server Epoch:78 choose agents : [1, 64, 48, 77, 0, 36, 26, 90, 18, 93].
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   1, Avg loss: 0.0569, Accuracy: 246/928 (26.5086%)
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   2, Avg loss: 0.0257, Accuracy: 572/928 (61.6379%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.9216, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0679, Accuracy: 162/953 (16.9990%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0406, Accuracy: 304/953 (31.8993%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.2963, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   1, Avg loss: 0.0781, Accuracy: 52/631 (8.2409%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   2, Avg loss: 0.0447, Accuracy: 246/631 (38.9857%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.9878, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  78, local model 77, internal_epoch   1, Avg loss: 0.0713, Accuracy: 197/1340 (14.7015%)
_Train Local_ResNet_18, epoch  78, local model 77, internal_epoch   2, Avg loss: 0.0297, Accuracy: 503/1340 (37.5373%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.8984, Accuracy: 65/10000 (0.6500%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0726, Accuracy: 263/1657 (15.8721%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0386, Accuracy: 469/1657 (28.3042%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.3630, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0927, Accuracy: 18/408 (4.4118%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0562, Accuracy: 148/408 (36.2745%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.5022, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   1, Avg loss: 0.0609, Accuracy: 280/1446 (19.3638%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   2, Avg loss: 0.0366, Accuracy: 458/1446 (31.6736%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.2793, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  78, local model 90, internal_epoch   1, Avg loss: 0.0734, Accuracy: 155/677 (22.8951%)
_Train Local_ResNet_18, epoch  78, local model 90, internal_epoch   2, Avg loss: 0.0245, Accuracy: 470/677 (69.4239%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 13.1568, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0953, Accuracy: 19/530 (3.5849%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0375, Accuracy: 283/530 (53.3962%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 12.0020, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   1, Avg loss: 0.0608, Accuracy: 377/1742 (21.6418%)
_Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   2, Avg loss: 0.0332, Accuracy: 646/1742 (37.0838%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.9659, Accuracy: 82/10000 (0.8200%)
time spent on training: 352.2644896507263
[rfa agg] training data poison_ratio: 0.1606865787432118  data num: [928, 953, 631, 1340, 1657, 408, 1446, 677, 530, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.050214555857253686
[rfa agg] init. name: [1, 64, 48, 77, 0, 36, 26, 90, 18, 93], weight: tensor([0.0900, 0.0924, 0.0612, 0.1299, 0.1607, 0.0396, 0.1402, 0.0657, 0.0514,
        0.1689])
[rfa agg] iter:  0, prev_obj_val: 67.35295104980469, obj_val: 68.2376937866211, abs dis: 0.8847427368164062
[rfa agg] iter: 0, weight: tensor([0.1493, 0.1748, 0.0530, 0.1623, 0.1071, 0.0243, 0.1321, 0.0648, 0.0385,
        0.0937])
[rfa agg] iter:  1, prev_obj_val: 68.2376937866211, obj_val: 70.7798843383789, abs dis: 2.5421905517578125
[rfa agg] iter: 1, weight: tensor([0.1634, 0.1981, 0.0547, 0.1474, 0.0981, 0.0246, 0.1206, 0.0673, 0.0393,
        0.0864])
[rfa agg] iter:  2, prev_obj_val: 70.7798843383789, obj_val: 72.28622436523438, abs dis: 1.5063400268554688
[rfa agg] iter: 2, weight: tensor([0.1767, 0.2262, 0.0610, 0.1228, 0.0868, 0.0264, 0.1034, 0.0764, 0.0429,
        0.0774])
[rfa agg] iter:  3, prev_obj_val: 72.28622436523438, obj_val: 72.28213500976562, abs dis: 0.00408935546875
[rfa agg] iter: 3, weight: tensor([0.1797, 0.2371, 0.0649, 0.1121, 0.0819, 0.0274, 0.0960, 0.0824, 0.0452,
        0.0734])
[rfa agg] iter:  4, prev_obj_val: 72.28213500976562, obj_val: 72.28205108642578, abs dis: 8.392333984375e-05
[rfa agg] iter: 4, weight: tensor([0.1797, 0.2400, 0.0646, 0.1112, 0.0814, 0.0273, 0.0954, 0.0822, 0.0450,
        0.0731])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 36.8293, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 35.8094, Accuracy: 0/9950 (0.0000%)
saving model
Done in 468.963730096817 sec.
Server Epoch:79 choose agents : [70, 34, 15, 98, 97, 25, 53, 87, 18, 52].
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   1, Avg loss: 0.0648, Accuracy: 296/1418 (20.8745%)
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   2, Avg loss: 0.0363, Accuracy: 547/1418 (38.5755%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.8404, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   1, Avg loss: 0.0663, Accuracy: 262/1427 (18.3602%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   2, Avg loss: 0.0359, Accuracy: 521/1427 (36.5102%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.2049, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   1, Avg loss: 0.0768, Accuracy: 212/1154 (18.3709%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   2, Avg loss: 0.0336, Accuracy: 389/1154 (33.7088%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.4170, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   1, Avg loss: 0.0927, Accuracy: 4/373 (1.0724%)
_Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   2, Avg loss: 0.0540, Accuracy: 114/373 (30.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.4970, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  79, local model 97, internal_epoch   1, Avg loss: 0.0560, Accuracy: 291/1213 (23.9901%)
_Train Local_ResNet_18, epoch  79, local model 97, internal_epoch   2, Avg loss: 0.0303, Accuracy: 491/1213 (40.4782%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.0879, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   1, Avg loss: 0.0657, Accuracy: 229/690 (33.1884%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   2, Avg loss: 0.0340, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.1642, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   1, Avg loss: 0.0438, Accuracy: 288/813 (35.4244%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   2, Avg loss: 0.0201, Accuracy: 484/813 (59.5326%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 13.3007, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  79, local model 87, internal_epoch   1, Avg loss: 0.0764, Accuracy: 172/1131 (15.2078%)
_Train Local_ResNet_18, epoch  79, local model 87, internal_epoch   2, Avg loss: 0.0345, Accuracy: 388/1131 (34.3059%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.1010, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0950, Accuracy: 27/530 (5.0943%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0386, Accuracy: 285/530 (53.7736%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.8651, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0694, Accuracy: 194/636 (30.5031%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0394, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.8948, Accuracy: 50/10000 (0.5000%)
time spent on training: 311.8657009601593
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 1427, 1154, 373, 1213, 690, 813, 1131, 530, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 34, 15, 98, 97, 25, 53, 87, 18, 52], weight: tensor([0.1511, 0.1521, 0.1230, 0.0397, 0.1292, 0.0735, 0.0866, 0.1205, 0.0565,
        0.0678])
[rfa agg] iter:  0, prev_obj_val: 57.94629669189453, obj_val: 57.83187484741211, abs dis: 0.11442184448242188
[rfa agg] iter: 0, weight: tensor([0.0935, 0.0959, 0.1094, 0.0244, 0.1366, 0.0980, 0.1684, 0.1517, 0.0515,
        0.0705])
[rfa agg] iter:  1, prev_obj_val: 57.83187484741211, obj_val: 57.83110809326172, abs dis: 0.000766754150390625
[rfa agg] iter: 1, weight: tensor([0.0913, 0.0938, 0.1071, 0.0241, 0.1354, 0.0978, 0.1783, 0.1512, 0.0510,
        0.0699])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 18.1315, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 17.4248, Accuracy: 0/9950 (0.0000%)
saving model
Done in 423.50516080856323 sec.
Server Epoch:80 choose agents : [91, 47, 51, 92, 88, 78, 75, 61, 99, 77].
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0636, Accuracy: 273/1030 (26.5049%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0327, Accuracy: 559/1030 (54.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.3784, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   1, Avg loss: 0.1312, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   2, Avg loss: 0.1091, Accuracy: 2/134 (1.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.5018, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   1, Avg loss: 0.0648, Accuracy: 195/1049 (18.5891%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   2, Avg loss: 0.0340, Accuracy: 425/1049 (40.5148%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.3327, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  80, local model 92, internal_epoch   1, Avg loss: 0.0609, Accuracy: 353/1715 (20.5831%)
_Train Local_ResNet_18, epoch  80, local model 92, internal_epoch   2, Avg loss: 0.0334, Accuracy: 641/1715 (37.3761%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.8368, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  80, local model 88, internal_epoch   1, Avg loss: 0.0884, Accuracy: 45/603 (7.4627%)
_Train Local_ResNet_18, epoch  80, local model 88, internal_epoch   2, Avg loss: 0.0507, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.3483, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  80, local model 78, internal_epoch   1, Avg loss: 0.0922, Accuracy: 13/416 (3.1250%)
_Train Local_ResNet_18, epoch  80, local model 78, internal_epoch   2, Avg loss: 0.0513, Accuracy: 170/416 (40.8654%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.4856, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0844, Accuracy: 155/776 (19.9742%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0360, Accuracy: 403/776 (51.9330%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.9311, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   1, Avg loss: 0.1507, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   2, Avg loss: 0.1425, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.6430, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  80, local model 99, internal_epoch   1, Avg loss: 0.0684, Accuracy: 149/773 (19.2755%)
_Train Local_ResNet_18, epoch  80, local model 99, internal_epoch   2, Avg loss: 0.0322, Accuracy: 404/773 (52.2639%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.9454, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   1, Avg loss: 0.0702, Accuracy: 200/1340 (14.9254%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   2, Avg loss: 0.0305, Accuracy: 486/1340 (36.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.4966, Accuracy: 65/10000 (0.6500%)
time spent on training: 310.90220189094543
[rfa agg] training data poison_ratio: 0.0  data num: [1030, 134, 1049, 1715, 603, 416, 776, 85, 773, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 47, 51, 92, 88, 78, 75, 61, 99, 77], weight: tensor([0.1300, 0.0169, 0.1324, 0.2165, 0.0761, 0.0525, 0.0980, 0.0107, 0.0976,
        0.1692])
[rfa agg] iter:  0, prev_obj_val: 61.781646728515625, obj_val: 63.5872802734375, abs dis: 1.805633544921875
[rfa agg] iter: 0, weight: tensor([0.1841, 0.0068, 0.1765, 0.1016, 0.0708, 0.0328, 0.1381, 0.0040, 0.1328,
        0.1526])
[rfa agg] iter:  1, prev_obj_val: 63.5872802734375, obj_val: 66.51498413085938, abs dis: 2.927703857421875
[rfa agg] iter: 1, weight: tensor([0.1696, 0.0071, 0.1631, 0.0915, 0.0814, 0.0358, 0.1648, 0.0041, 0.1510,
        0.1315])
[rfa agg] iter:  2, prev_obj_val: 66.51498413085938, obj_val: 70.31207275390625, abs dis: 3.797088623046875
[rfa agg] iter: 2, weight: tensor([0.1469, 0.0077, 0.1428, 0.0855, 0.0981, 0.0406, 0.1892, 0.0044, 0.1682,
        0.1167])
[rfa agg] iter:  3, prev_obj_val: 70.31207275390625, obj_val: 66.49842071533203, abs dis: 3.8136520385742188
[rfa agg] iter: 3, weight: tensor([0.1288, 0.0084, 0.1264, 0.0815, 0.1227, 0.0473, 0.1990, 0.0048, 0.1749,
        0.1063])
[rfa agg] iter:  4, prev_obj_val: 66.49842071533203, obj_val: 68.28157806396484, abs dis: 1.7831573486328125
[rfa agg] iter: 4, weight: tensor([0.1424, 0.0076, 0.1382, 0.0845, 0.0992, 0.0404, 0.1968, 0.0044, 0.1716,
        0.1149])
[rfa agg] iter:  5, prev_obj_val: 68.28157806396484, obj_val: 66.49073028564453, abs dis: 1.7908477783203125
[rfa agg] iter: 5, weight: tensor([0.1352, 0.0080, 0.1320, 0.0826, 0.1092, 0.0434, 0.2005, 0.0045, 0.1745,
        0.1100])
[rfa agg] iter:  6, prev_obj_val: 66.49073028564453, obj_val: 68.28190612792969, abs dis: 1.7911758422851562
[rfa agg] iter: 6, weight: tensor([0.1430, 0.0076, 0.1387, 0.0845, 0.0986, 0.0404, 0.1965, 0.0044, 0.1713,
        0.1150])
[rfa agg] iter:  7, prev_obj_val: 68.28190612792969, obj_val: 66.4906997680664, abs dis: 1.7912063598632812
[rfa agg] iter: 7, weight: tensor([0.1353, 0.0080, 0.1320, 0.0826, 0.1092, 0.0434, 0.2004, 0.0045, 0.1745,
        0.1101])
[rfa agg] iter:  8, prev_obj_val: 66.4906997680664, obj_val: 68.28190612792969, abs dis: 1.7912063598632812
[rfa agg] iter: 8, weight: tensor([0.1430, 0.0076, 0.1387, 0.0845, 0.0986, 0.0404, 0.1965, 0.0044, 0.1713,
        0.1150])
[rfa agg] iter:  9, prev_obj_val: 68.28190612792969, obj_val: 66.4906997680664, abs dis: 1.7912063598632812
[rfa agg] iter: 9, weight: tensor([0.1353, 0.0080, 0.1320, 0.0826, 0.1092, 0.0434, 0.2004, 0.0045, 0.1745,
        0.1101])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 13.6944, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 13.7742, Accuracy: 0/9950 (0.0000%)
saving model
Done in 425.0210406780243 sec.
Server Epoch:81 choose agents : [60, 93, 18, 24, 50, 98, 61, 91, 54, 15].
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0581, Accuracy: 450/2227 (20.2066%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0320, Accuracy: 873/2227 (39.2007%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.3707, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  81, local model 93, internal_epoch   1, Avg loss: 0.0607, Accuracy: 372/1742 (21.3548%)
_Train Local_ResNet_18, epoch  81, local model 93, internal_epoch   2, Avg loss: 0.0332, Accuracy: 678/1742 (38.9208%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.1791, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0960, Accuracy: 26/530 (4.9057%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0432, Accuracy: 288/530 (54.3396%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 11.3060, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   1, Avg loss: 0.0958, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   2, Avg loss: 0.0523, Accuracy: 107/312 (34.2949%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.6844, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0729, Accuracy: 100/809 (12.3609%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0308, Accuracy: 335/809 (41.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.5119, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  81, local model 98, internal_epoch   1, Avg loss: 0.0909, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  81, local model 98, internal_epoch   2, Avg loss: 0.0526, Accuracy: 130/373 (34.8525%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.8782, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1460, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1327, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.6276, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   1, Avg loss: 0.0653, Accuracy: 263/1030 (25.5340%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   2, Avg loss: 0.0322, Accuracy: 558/1030 (54.1748%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.9926, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0704, Accuracy: 233/1130 (20.6195%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0328, Accuracy: 414/1130 (36.6372%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.0440, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0733, Accuracy: 220/1154 (19.0641%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0337, Accuracy: 380/1154 (32.9289%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.9653, Accuracy: 51/10000 (0.5100%)
time spent on training: 355.8175768852234
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 1742, 530, 312, 809, 373, 85, 1030, 1130, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 93, 18, 24, 50, 98, 61, 91, 54, 15], weight: tensor([0.2371, 0.1855, 0.0564, 0.0332, 0.0861, 0.0397, 0.0091, 0.1097, 0.1203,
        0.1229])
[rfa agg] iter:  0, prev_obj_val: 85.2918930053711, obj_val: 86.67150115966797, abs dis: 1.379608154296875
[rfa agg] iter: 0, weight: tensor([0.1137, 0.1563, 0.0365, 0.0158, 0.0841, 0.0202, 0.0034, 0.1605, 0.2204,
        0.1890])
[rfa agg] iter:  1, prev_obj_val: 86.67150115966797, obj_val: 86.6099624633789, abs dis: 0.0615386962890625
[rfa agg] iter: 1, weight: tensor([0.0886, 0.1136, 0.0386, 0.0159, 0.0968, 0.0205, 0.0034, 0.1809, 0.2572,
        0.1845])
[rfa agg] iter:  2, prev_obj_val: 86.6099624633789, obj_val: 87.59920501708984, abs dis: 0.9892425537109375
[rfa agg] iter: 2, weight: tensor([0.0869, 0.1109, 0.0380, 0.0157, 0.0952, 0.0202, 0.0033, 0.1821, 0.2665,
        0.1812])
[rfa agg] iter:  3, prev_obj_val: 87.59920501708984, obj_val: 90.24183654785156, abs dis: 2.6426315307617188
[rfa agg] iter: 3, weight: tensor([0.0844, 0.1061, 0.0398, 0.0162, 0.1023, 0.0210, 0.0034, 0.1866, 0.2654,
        0.1748])
[rfa agg] iter:  4, prev_obj_val: 90.24183654785156, obj_val: 90.22897338867188, abs dis: 0.0128631591796875
[rfa agg] iter: 4, weight: tensor([0.0824, 0.1007, 0.0456, 0.0180, 0.1236, 0.0234, 0.0037, 0.1934, 0.2457,
        0.1635])
[rfa agg] iter:  5, prev_obj_val: 90.22897338867188, obj_val: 90.22847747802734, abs dis: 0.00049591064453125
[rfa agg] iter: 5, weight: tensor([0.0825, 0.1008, 0.0458, 0.0180, 0.1254, 0.0234, 0.0037, 0.1969, 0.2416,
        0.1619])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 12.1740, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 11.6528, Accuracy: 0/9950 (0.0000%)
saving model
Done in 470.1112685203552 sec.
Server Epoch:82 choose agents : [59, 84, 37, 81, 61, 21, 47, 82, 13, 31].
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0525, Accuracy: 264/1089 (24.2424%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0311, Accuracy: 426/1089 (39.1185%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.5720, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  82, local model 84, internal_epoch   1, Avg loss: 0.0691, Accuracy: 217/1190 (18.2353%)
_Train Local_ResNet_18, epoch  82, local model 84, internal_epoch   2, Avg loss: 0.0343, Accuracy: 442/1190 (37.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.1873, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   1, Avg loss: 0.0579, Accuracy: 307/1129 (27.1922%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   2, Avg loss: 0.0273, Accuracy: 644/1129 (57.0416%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.5183, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   1, Avg loss: 0.0868, Accuracy: 151/774 (19.5090%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   2, Avg loss: 0.0442, Accuracy: 302/774 (39.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.5257, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   1, Avg loss: 0.1446, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   2, Avg loss: 0.1338, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.4559, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   1, Avg loss: 0.0619, Accuracy: 317/1949 (16.2648%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   2, Avg loss: 0.0363, Accuracy: 580/1949 (29.7589%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.2147, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   1, Avg loss: 0.1254, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   2, Avg loss: 0.1052, Accuracy: 5/134 (3.7313%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.0291, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   1, Avg loss: 0.0795, Accuracy: 29/500 (5.8000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   2, Avg loss: 0.0472, Accuracy: 216/500 (43.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.0583, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   1, Avg loss: 0.0730, Accuracy: 265/1645 (16.1094%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   2, Avg loss: 0.0377, Accuracy: 507/1645 (30.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.9742, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   1, Avg loss: 0.0858, Accuracy: 16/460 (3.4783%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   2, Avg loss: 0.0367, Accuracy: 193/460 (41.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.7629, Accuracy: 60/10000 (0.6000%)
time spent on training: 343.99480390548706
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1190, 1129, 774, 85, 1949, 134, 500, 1645, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 84, 37, 81, 61, 21, 47, 82, 13, 31], weight: tensor([0.1216, 0.1329, 0.1261, 0.0864, 0.0095, 0.2176, 0.0150, 0.0558, 0.1837,
        0.0514])
[rfa agg] iter:  0, prev_obj_val: 74.09586334228516, obj_val: 75.46292877197266, abs dis: 1.3670654296875
[rfa agg] iter: 0, weight: tensor([0.1042, 0.2461, 0.2472, 0.0848, 0.0033, 0.1068, 0.0057, 0.0327, 0.1396,
        0.0296])
[rfa agg] iter:  1, prev_obj_val: 75.46292877197266, obj_val: 75.43556213378906, abs dis: 0.02736663818359375
[rfa agg] iter: 1, weight: tensor([0.0958, 0.2487, 0.2801, 0.0922, 0.0033, 0.0928, 0.0056, 0.0336, 0.1176,
        0.0303])
[rfa agg] iter:  2, prev_obj_val: 75.43556213378906, obj_val: 76.79095458984375, abs dis: 1.3553924560546875
[rfa agg] iter: 2, weight: tensor([0.0933, 0.2478, 0.2899, 0.0911, 0.0032, 0.0911, 0.0055, 0.0331, 0.1152,
        0.0298])
[rfa agg] iter:  3, prev_obj_val: 76.79095458984375, obj_val: 78.34959411621094, abs dis: 1.5586395263671875
[rfa agg] iter: 3, weight: tensor([0.0952, 0.2358, 0.2868, 0.1010, 0.0034, 0.0908, 0.0059, 0.0358, 0.1132,
        0.0322])
[rfa agg] iter:  4, prev_obj_val: 78.34959411621094, obj_val: 80.07697296142578, abs dis: 1.7273788452148438
[rfa agg] iter: 4, weight: tensor([0.0985, 0.2234, 0.2749, 0.1141, 0.0037, 0.0917, 0.0063, 0.0393, 0.1128,
        0.0353])
[rfa agg] iter:  5, prev_obj_val: 80.07697296142578, obj_val: 78.34796142578125, abs dis: 1.7290115356445312
[rfa agg] iter: 5, weight: tensor([0.1018, 0.2117, 0.2584, 0.1296, 0.0039, 0.0927, 0.0068, 0.0434, 0.1127,
        0.0389])
[rfa agg] iter:  6, prev_obj_val: 78.34796142578125, obj_val: 78.34398651123047, abs dis: 0.00397491455078125
[rfa agg] iter: 6, weight: tensor([0.1003, 0.2213, 0.2692, 0.1170, 0.0037, 0.0926, 0.0064, 0.0398, 0.1139,
        0.0358])
[rfa agg] iter:  7, prev_obj_val: 78.34398651123047, obj_val: 78.3438949584961, abs dis: 9.1552734375e-05
[rfa agg] iter: 7, weight: tensor([0.0998, 0.2221, 0.2713, 0.1158, 0.0037, 0.0922, 0.0063, 0.0396, 0.1135,
        0.0356])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 12.9369, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 13.0498, Accuracy: 0/9950 (0.0000%)
saving model
Done in 453.35563468933105 sec.
Server Epoch:83 choose agents : [43, 65, 33, 2, 36, 57, 45, 76, 96, 80].
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0627, Accuracy: 252/946 (26.6385%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 391/946 (41.3319%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1426, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0718, Accuracy: 309/1475 (20.9492%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0382, Accuracy: 563/1475 (38.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1145, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.0871, Accuracy: 25/515 (4.8544%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0601, Accuracy: 134/515 (26.0194%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.1111, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   1, Avg loss: 0.0708, Accuracy: 123/605 (20.3306%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   2, Avg loss: 0.0419, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4930, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   1, Avg loss: 0.0954, Accuracy: 14/408 (3.4314%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   2, Avg loss: 0.0592, Accuracy: 136/408 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.0435, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   1, Avg loss: 0.0743, Accuracy: 208/1154 (18.0243%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   2, Avg loss: 0.0311, Accuracy: 421/1154 (36.4818%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.7418, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   1, Avg loss: 0.0758, Accuracy: 137/669 (20.4783%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   2, Avg loss: 0.0446, Accuracy: 356/669 (53.2138%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.6574, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   1, Avg loss: 0.0926, Accuracy: 14/466 (3.0043%)
_Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   2, Avg loss: 0.0569, Accuracy: 168/466 (36.0515%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4393, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  83, local model 96, internal_epoch   1, Avg loss: 0.0845, Accuracy: 16/311 (5.1447%)
_Train Local_ResNet_18, epoch  83, local model 96, internal_epoch   2, Avg loss: 0.0586, Accuracy: 112/311 (36.0129%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.9082, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 80, internal_epoch   1, Avg loss: 0.0881, Accuracy: 80/682 (11.7302%)
_Train Local_ResNet_18, epoch  83, local model 80, internal_epoch   2, Avg loss: 0.0450, Accuracy: 243/682 (35.6305%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.1899, Accuracy: 60/10000 (0.6000%)
time spent on training: 292.2987058162689
[rfa agg] training data poison_ratio: 0.0  data num: [946, 1475, 515, 605, 408, 1154, 669, 466, 311, 682]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 65, 33, 2, 36, 57, 45, 76, 96, 80], weight: tensor([0.1308, 0.2040, 0.0712, 0.0837, 0.0564, 0.1596, 0.0925, 0.0644, 0.0430,
        0.0943])
[rfa agg] iter:  0, prev_obj_val: 58.80154800415039, obj_val: 60.190486907958984, abs dis: 1.3889389038085938
[rfa agg] iter: 0, weight: tensor([0.1748, 0.0873, 0.0769, 0.1136, 0.0473, 0.1042, 0.1408, 0.0632, 0.0262,
        0.1658])
[rfa agg] iter:  1, prev_obj_val: 60.190486907958984, obj_val: 64.6769027709961, abs dis: 4.486415863037109
[rfa agg] iter: 1, weight: tensor([0.1239, 0.0680, 0.0866, 0.1361, 0.0540, 0.0778, 0.1587, 0.0749, 0.0277,
        0.1923])
[rfa agg] iter:  2, prev_obj_val: 64.6769027709961, obj_val: 66.77571868896484, abs dis: 2.09881591796875
[rfa agg] iter: 2, weight: tensor([0.0969, 0.0617, 0.1029, 0.1504, 0.0734, 0.0680, 0.1433, 0.1035, 0.0341,
        0.1658])
[rfa agg] iter:  3, prev_obj_val: 66.77571868896484, obj_val: 71.88201141357422, abs dis: 5.106292724609375
[rfa agg] iter: 3, weight: tensor([0.0914, 0.0608, 0.1083, 0.1496, 0.0850, 0.0664, 0.1326, 0.1194, 0.0377,
        0.1488])
[rfa agg] iter:  4, prev_obj_val: 71.88201141357422, obj_val: 71.86453247070312, abs dis: 0.01747894287109375
[rfa agg] iter: 4, weight: tensor([0.0859, 0.0612, 0.1108, 0.1338, 0.1113, 0.0656, 0.1164, 0.1421, 0.0467,
        0.1262])
[rfa agg] iter:  5, prev_obj_val: 71.86453247070312, obj_val: 71.8642578125, abs dis: 0.000274658203125
[rfa agg] iter: 5, weight: tensor([0.0851, 0.0607, 0.1103, 0.1322, 0.1144, 0.0651, 0.1148, 0.1461, 0.0469,
        0.1243])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.9359, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.3376, Accuracy: 0/9950 (0.0000%)
saving model
Done in 404.6053776741028 sec.
Server Epoch:84 choose agents : [0, 26, 54, 61, 56, 29, 38, 45, 2, 15].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   1, Avg loss: 0.0700, Accuracy: 270/1657 (16.2945%)
_Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   2, Avg loss: 0.0390, Accuracy: 462/1657 (27.8817%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.5263, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   1, Avg loss: 0.0657, Accuracy: 253/1446 (17.4965%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   2, Avg loss: 0.0368, Accuracy: 461/1446 (31.8811%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.3130, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   1, Avg loss: 0.0670, Accuracy: 260/1130 (23.0088%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   2, Avg loss: 0.0317, Accuracy: 470/1130 (41.5929%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.8393, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1347, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1225, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.9487, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   1, Avg loss: 0.0785, Accuracy: 17/186 (9.1398%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   2, Avg loss: 0.0632, Accuracy: 69/186 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.5418, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   1, Avg loss: 0.0608, Accuracy: 282/1440 (19.5833%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   2, Avg loss: 0.0302, Accuracy: 641/1440 (44.5139%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.6781, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0742, Accuracy: 159/1131 (14.0584%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0376, Accuracy: 437/1131 (38.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.9222, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   1, Avg loss: 0.0733, Accuracy: 142/669 (21.2257%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   2, Avg loss: 0.0465, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.9470, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0697, Accuracy: 126/605 (20.8264%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0434, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.6447, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   1, Avg loss: 0.0738, Accuracy: 238/1154 (20.6239%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   2, Avg loss: 0.0318, Accuracy: 389/1154 (33.7088%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.4566, Accuracy: 66/10000 (0.6600%)
time spent on training: 347.5125186443329
[rfa agg] training data poison_ratio: 0.1743659896874671  data num: [1657, 1446, 1130, 85, 186, 1440, 1131, 669, 605, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.05448937177733347
[rfa agg] init. name: [0, 26, 54, 61, 56, 29, 38, 45, 2, 15], weight: tensor([0.1744, 0.1522, 0.1189, 0.0089, 0.0196, 0.1515, 0.1190, 0.0704, 0.0637,
        0.1214])
[rfa agg] iter:  0, prev_obj_val: 57.16879653930664, obj_val: 56.946006774902344, abs dis: 0.22278976440429688
[rfa agg] iter: 0, weight: tensor([0.1052, 0.1281, 0.2255, 0.0028, 0.0067, 0.1283, 0.1692, 0.0538, 0.0430,
        0.1375])
[rfa agg] iter:  1, prev_obj_val: 56.946006774902344, obj_val: 56.940853118896484, abs dis: 0.005153656005859375
[rfa agg] iter: 1, weight: tensor([0.1006, 0.1219, 0.2434, 0.0027, 0.0065, 0.1236, 0.1741, 0.0519, 0.0414,
        0.1339])
[rfa agg] iter:  2, prev_obj_val: 56.940853118896484, obj_val: 56.94057846069336, abs dis: 0.000274658203125
[rfa agg] iter: 2, weight: tensor([0.1000, 0.1209, 0.2475, 0.0027, 0.0065, 0.1228, 0.1745, 0.0516, 0.0412,
        0.1324])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.9357, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.1074, Accuracy: 0/9950 (0.0000%)
saving model
Done in 458.309597492218 sec.
Server Epoch:85 choose agents : [84, 3, 86, 18, 98, 8, 89, 80, 23, 58].
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   1, Avg loss: 0.0662, Accuracy: 241/1190 (20.2521%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   2, Avg loss: 0.0340, Accuracy: 456/1190 (38.3193%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.0603, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   1, Avg loss: 0.0807, Accuracy: 52/781 (6.6581%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   2, Avg loss: 0.0395, Accuracy: 224/781 (28.6812%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.2611, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  85, local model 86, internal_epoch   1, Avg loss: 0.0625, Accuracy: 272/1003 (27.1186%)
_Train Local_ResNet_18, epoch  85, local model 86, internal_epoch   2, Avg loss: 0.0360, Accuracy: 425/1003 (42.3729%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.6209, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0935, Accuracy: 25/530 (4.7170%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0402, Accuracy: 290/530 (54.7170%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.7401, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  85, local model 98, internal_epoch   1, Avg loss: 0.0934, Accuracy: 1/373 (0.2681%)
_Train Local_ResNet_18, epoch  85, local model 98, internal_epoch   2, Avg loss: 0.0549, Accuracy: 121/373 (32.4397%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.5136, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   1, Avg loss: 0.0672, Accuracy: 181/1513 (11.9630%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   2, Avg loss: 0.0398, Accuracy: 379/1513 (25.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.5255, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  85, local model 89, internal_epoch   1, Avg loss: 0.0669, Accuracy: 261/896 (29.1295%)
_Train Local_ResNet_18, epoch  85, local model 89, internal_epoch   2, Avg loss: 0.0364, Accuracy: 445/896 (49.6652%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.3201, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  85, local model 80, internal_epoch   1, Avg loss: 0.0871, Accuracy: 77/682 (11.2903%)
_Train Local_ResNet_18, epoch  85, local model 80, internal_epoch   2, Avg loss: 0.0450, Accuracy: 242/682 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.3702, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   1, Avg loss: 0.0796, Accuracy: 160/715 (22.3776%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   2, Avg loss: 0.0463, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.7099, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0821, Accuracy: 159/803 (19.8007%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0392, Accuracy: 435/803 (54.1719%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.9924, Accuracy: 54/10000 (0.5400%)
time spent on training: 323.5203082561493
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 781, 1003, 530, 373, 1513, 896, 682, 715, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 3, 86, 18, 98, 8, 89, 80, 23, 58], weight: tensor([0.1402, 0.0920, 0.1182, 0.0625, 0.0440, 0.1783, 0.1056, 0.0804, 0.0843,
        0.0946])
[rfa agg] iter:  0, prev_obj_val: 50.18292999267578, obj_val: 52.825923919677734, abs dis: 2.642993927001953
[rfa agg] iter: 0, weight: tensor([0.0865, 0.1364, 0.1237, 0.0553, 0.0242, 0.0675, 0.1446, 0.1079, 0.0993,
        0.1547])
[rfa agg] iter:  1, prev_obj_val: 52.825923919677734, obj_val: 57.04158020019531, abs dis: 4.215656280517578
[rfa agg] iter: 1, weight: tensor([0.0767, 0.1380, 0.1060, 0.0659, 0.0273, 0.0622, 0.1319, 0.1344, 0.1026,
        0.1552])
[rfa agg] iter:  2, prev_obj_val: 57.04158020019531, obj_val: 57.021114349365234, abs dis: 0.020465850830078125
[rfa agg] iter: 2, weight: tensor([0.0736, 0.1268, 0.0960, 0.0846, 0.0332, 0.0617, 0.1178, 0.1611, 0.1063,
        0.1390])
[rfa agg] iter:  3, prev_obj_val: 57.021114349365234, obj_val: 57.020694732666016, abs dis: 0.00041961669921875
[rfa agg] iter: 3, weight: tensor([0.0732, 0.1248, 0.0952, 0.0858, 0.0333, 0.0613, 0.1161, 0.1666, 0.1071,
        0.1365])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.9521, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.1459, Accuracy: 0/9950 (0.0000%)
saving model
Done in 436.999947309494 sec.
Server Epoch:86 choose agents : [57, 20, 60, 19, 35, 85, 82, 44, 41, 59].
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   1, Avg loss: 0.0692, Accuracy: 209/1154 (18.1109%)
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   2, Avg loss: 0.0305, Accuracy: 425/1154 (36.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.6600, Accuracy: 73/10000 (0.7300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  86, local model 20, internal_epoch   1, Avg loss: 0.0700, Accuracy: 228/807 (28.2528%)
_Train Local_ResNet_18, epoch  86, local model 20, internal_epoch   2, Avg loss: 0.0389, Accuracy: 410/807 (50.8055%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.5055, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   1, Avg loss: 0.0580, Accuracy: 476/2227 (21.3740%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   2, Avg loss: 0.0322, Accuracy: 891/2227 (40.0090%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.3805, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0550, Accuracy: 317/1036 (30.5985%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0254, Accuracy: 630/1036 (60.8108%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 13.2829, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   1, Avg loss: 0.1072, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   2, Avg loss: 0.0720, Accuracy: 70/271 (25.8303%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.5883, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  86, local model 85, internal_epoch   1, Avg loss: 0.0603, Accuracy: 339/1988 (17.0523%)
_Train Local_ResNet_18, epoch  86, local model 85, internal_epoch   2, Avg loss: 0.0388, Accuracy: 545/1988 (27.4145%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.5739, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  86, local model 82, internal_epoch   1, Avg loss: 0.0806, Accuracy: 28/500 (5.6000%)
_Train Local_ResNet_18, epoch  86, local model 82, internal_epoch   2, Avg loss: 0.0498, Accuracy: 195/500 (39.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.7699, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0666, Accuracy: 294/1750 (16.8000%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0390, Accuracy: 605/1750 (34.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.1471, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   1, Avg loss: 0.0857, Accuracy: 142/719 (19.7497%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   2, Avg loss: 0.0393, Accuracy: 469/719 (65.2295%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.3610, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0599, Accuracy: 261/1089 (23.9669%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 453/1089 (41.5978%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.9653, Accuracy: 79/10000 (0.7900%)
time spent on training: 417.1024672985077
[rfa agg] training data poison_ratio: 0.06992461658435144  data num: [1154, 807, 2227, 1036, 271, 1988, 500, 1750, 719, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.021851442682609825
[rfa agg] init. name: [57, 20, 60, 19, 35, 85, 82, 44, 41, 59], weight: tensor([0.1000, 0.0699, 0.1930, 0.0898, 0.0235, 0.1723, 0.0433, 0.1516, 0.0623,
        0.0944])
[rfa agg] iter:  0, prev_obj_val: 88.9884033203125, obj_val: 90.11872100830078, abs dis: 1.1303176879882812
[rfa agg] iter: 0, weight: tensor([0.1596, 0.0674, 0.1212, 0.1358, 0.0122, 0.1342, 0.0277, 0.1795, 0.0546,
        0.1078])
[rfa agg] iter:  1, prev_obj_val: 90.11872100830078, obj_val: 91.81361389160156, abs dis: 1.6948928833007812
[rfa agg] iter: 1, weight: tensor([0.1766, 0.0726, 0.1092, 0.1542, 0.0125, 0.1195, 0.0288, 0.1566, 0.0581,
        0.1118])
[rfa agg] iter:  2, prev_obj_val: 91.81361389160156, obj_val: 94.01322937011719, abs dis: 2.199615478515625
[rfa agg] iter: 2, weight: tensor([0.1835, 0.0791, 0.0997, 0.1740, 0.0129, 0.1078, 0.0303, 0.1365, 0.0627,
        0.1135])
[rfa agg] iter:  3, prev_obj_val: 94.01322937011719, obj_val: 94.00281524658203, abs dis: 0.01041412353515625
[rfa agg] iter: 3, weight: tensor([0.1807, 0.0874, 0.0916, 0.1949, 0.0134, 0.0979, 0.0321, 0.1206, 0.0685,
        0.1130])
[rfa agg] iter:  4, prev_obj_val: 94.00281524658203, obj_val: 94.00264739990234, abs dis: 0.0001678466796875
[rfa agg] iter: 4, weight: tensor([0.1797, 0.0873, 0.0911, 0.1987, 0.0134, 0.0974, 0.0319, 0.1198, 0.0684,
        0.1124])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.7422, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 15.1870, Accuracy: 0/9950 (0.0000%)
saving model
Done in 527.864075422287 sec.
Server Epoch:87 choose agents : [86, 29, 54, 69, 87, 45, 26, 47, 33, 57].
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0638, Accuracy: 282/1003 (28.1157%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0369, Accuracy: 400/1003 (39.8804%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.4555, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   1, Avg loss: 0.0562, Accuracy: 337/1440 (23.4028%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   2, Avg loss: 0.0294, Accuracy: 641/1440 (44.5139%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.5335, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   1, Avg loss: 0.0663, Accuracy: 262/1130 (23.1858%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   2, Avg loss: 0.0328, Accuracy: 438/1130 (38.7611%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.1478, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0596, Accuracy: 213/590 (36.1017%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0360, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 12.6829, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 87, internal_epoch   1, Avg loss: 0.0748, Accuracy: 169/1131 (14.9425%)
_Train Local_ResNet_18, epoch  87, local model 87, internal_epoch   2, Avg loss: 0.0357, Accuracy: 385/1131 (34.0407%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.5004, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   1, Avg loss: 0.0738, Accuracy: 150/669 (22.4215%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   2, Avg loss: 0.0451, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.5609, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   1, Avg loss: 0.0655, Accuracy: 271/1446 (18.7414%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   2, Avg loss: 0.0381, Accuracy: 466/1446 (32.2268%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.2599, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1187, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1100, Accuracy: 8/134 (5.9701%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.3830, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   1, Avg loss: 0.0905, Accuracy: 23/515 (4.4660%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   2, Avg loss: 0.0600, Accuracy: 132/515 (25.6311%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.6918, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0691, Accuracy: 206/1154 (17.8510%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0296, Accuracy: 398/1154 (34.4887%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 11.8994, Accuracy: 63/10000 (0.6300%)
time spent on training: 347.7135775089264
[rfa agg] training data poison_ratio: 0.0  data num: [1003, 1440, 1130, 590, 1131, 669, 1446, 134, 515, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [86, 29, 54, 69, 87, 45, 26, 47, 33, 57], weight: tensor([0.1089, 0.1563, 0.1227, 0.0640, 0.1228, 0.0726, 0.1570, 0.0145, 0.0559,
        0.1253])
[rfa agg] iter:  0, prev_obj_val: 51.965702056884766, obj_val: 53.249080657958984, abs dis: 1.2833786010742188
[rfa agg] iter: 0, weight: tensor([0.2012, 0.1006, 0.1713, 0.0475, 0.1675, 0.0608, 0.1000, 0.0050, 0.0345,
        0.1115])
[rfa agg] iter:  1, prev_obj_val: 53.249080657958984, obj_val: 53.24114990234375, abs dis: 0.007930755615234375
[rfa agg] iter: 1, weight: tensor([0.2238, 0.0942, 0.1637, 0.0512, 0.1606, 0.0654, 0.0936, 0.0051, 0.0365,
        0.1059])
[rfa agg] iter:  2, prev_obj_val: 53.24114990234375, obj_val: 54.99513626098633, abs dis: 1.7539863586425781
[rfa agg] iter: 2, weight: tensor([0.2295, 0.0935, 0.1624, 0.0510, 0.1592, 0.0652, 0.0930, 0.0051, 0.0363,
        0.1049])
[rfa agg] iter:  3, prev_obj_val: 54.99513626098633, obj_val: 54.992977142333984, abs dis: 0.00215911865234375
[rfa agg] iter: 3, weight: tensor([0.2266, 0.0927, 0.1551, 0.0574, 0.1526, 0.0736, 0.0922, 0.0055, 0.0402,
        0.1041])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 11.8907, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 14.0923, Accuracy: 0/9950 (0.0000%)
saving model
Done in 465.52638840675354 sec.
Server Epoch:88 choose agents : [62, 83, 85, 18, 63, 67, 29, 37, 87, 80].
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0831, Accuracy: 46/568 (8.0986%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0458, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.3293, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   1, Avg loss: 0.0701, Accuracy: 289/1953 (14.7977%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   2, Avg loss: 0.0377, Accuracy: 615/1953 (31.4900%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.7557, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   1, Avg loss: 0.0594, Accuracy: 343/1988 (17.2535%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   2, Avg loss: 0.0388, Accuracy: 547/1988 (27.5151%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.5255, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0911, Accuracy: 32/530 (6.0377%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0380, Accuracy: 280/530 (52.8302%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 11.1653, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   1, Avg loss: 0.0697, Accuracy: 174/888 (19.5946%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   2, Avg loss: 0.0298, Accuracy: 409/888 (46.0586%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 11.2951, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   1, Avg loss: 0.0795, Accuracy: 30/426 (7.0423%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   2, Avg loss: 0.0425, Accuracy: 188/426 (44.1315%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.5109, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   1, Avg loss: 0.0559, Accuracy: 342/1440 (23.7500%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   2, Avg loss: 0.0288, Accuracy: 627/1440 (43.5417%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.8630, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   1, Avg loss: 0.0586, Accuracy: 306/1129 (27.1036%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   2, Avg loss: 0.0273, Accuracy: 660/1129 (58.4588%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.7548, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   1, Avg loss: 0.0740, Accuracy: 169/1131 (14.9425%)
_Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   2, Avg loss: 0.0347, Accuracy: 386/1131 (34.1291%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.3605, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  88, local model 80, internal_epoch   1, Avg loss: 0.0812, Accuracy: 76/682 (11.1437%)
_Train Local_ResNet_18, epoch  88, local model 80, internal_epoch   2, Avg loss: 0.0441, Accuracy: 257/682 (37.6833%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.2954, Accuracy: 51/10000 (0.5100%)
time spent on training: 369.1045105457306
[rfa agg] training data poison_ratio: 0.0  data num: [568, 1953, 1988, 530, 888, 426, 1440, 1129, 1131, 682]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [62, 83, 85, 18, 63, 67, 29, 37, 87, 80], weight: tensor([0.0529, 0.1819, 0.1852, 0.0494, 0.0827, 0.0397, 0.1341, 0.1052, 0.1054,
        0.0635])
[rfa agg] iter:  0, prev_obj_val: 80.49078369140625, obj_val: 84.22796630859375, abs dis: 3.7371826171875
[rfa agg] iter: 0, weight: tensor([0.0363, 0.0936, 0.0874, 0.0332, 0.1006, 0.0223, 0.1588, 0.1941, 0.2208,
        0.0529])
[rfa agg] iter:  1, prev_obj_val: 84.22796630859375, obj_val: 87.35079193115234, abs dis: 3.1228256225585938
[rfa agg] iter: 1, weight: tensor([0.0435, 0.0782, 0.0737, 0.0396, 0.1373, 0.0257, 0.1190, 0.1961, 0.2204,
        0.0666])
[rfa agg] iter:  2, prev_obj_val: 87.35079193115234, obj_val: 91.02690887451172, abs dis: 3.676116943359375
[rfa agg] iter: 2, weight: tensor([0.0508, 0.0755, 0.0714, 0.0460, 0.1701, 0.0292, 0.1082, 0.1771, 0.1916,
        0.0801])
[rfa agg] iter:  3, prev_obj_val: 91.02690887451172, obj_val: 89.10445404052734, abs dis: 1.922454833984375
[rfa agg] iter: 3, weight: tensor([0.0600, 0.0726, 0.0690, 0.0538, 0.2013, 0.0332, 0.0993, 0.1528, 0.1607,
        0.0973])
[rfa agg] iter:  4, prev_obj_val: 89.10445404052734, obj_val: 91.00700378417969, abs dis: 1.9025497436523438
[rfa agg] iter: 4, weight: tensor([0.0551, 0.0737, 0.0698, 0.0497, 0.1973, 0.0311, 0.1030, 0.1613, 0.1704,
        0.0886])
[rfa agg] iter:  5, prev_obj_val: 91.00700378417969, obj_val: 89.10555267333984, abs dis: 1.9014511108398438
[rfa agg] iter: 5, weight: tensor([0.0598, 0.0722, 0.0685, 0.0536, 0.2075, 0.0331, 0.0988, 0.1510, 0.1583,
        0.0971])
[rfa agg] iter:  6, prev_obj_val: 89.10555267333984, obj_val: 91.00675964355469, abs dis: 1.9012069702148438
[rfa agg] iter: 6, weight: tensor([0.0551, 0.0736, 0.0697, 0.0497, 0.1985, 0.0311, 0.1029, 0.1610, 0.1700,
        0.0884])
[rfa agg] iter:  7, prev_obj_val: 91.00675964355469, obj_val: 89.10559844970703, abs dis: 1.9011611938476562
[rfa agg] iter: 7, weight: tensor([0.0597, 0.0722, 0.0685, 0.0536, 0.2078, 0.0331, 0.0987, 0.1509, 0.1582,
        0.0970])
[rfa agg] iter:  8, prev_obj_val: 89.10559844970703, obj_val: 91.00674438476562, abs dis: 1.9011459350585938
[rfa agg] iter: 8, weight: tensor([0.0551, 0.0736, 0.0697, 0.0497, 0.1986, 0.0311, 0.1029, 0.1610, 0.1700,
        0.0884])
[rfa agg] iter:  9, prev_obj_val: 91.00674438476562, obj_val: 89.10560607910156, abs dis: 1.9011383056640625
[rfa agg] iter: 9, weight: tensor([0.0597, 0.0722, 0.0685, 0.0536, 0.2078, 0.0331, 0.0987, 0.1509, 0.1582,
        0.0970])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 11.4157, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 13.5839, Accuracy: 0/9950 (0.0000%)
saving model
Done in 480.98091554641724 sec.
Server Epoch:89 choose agents : [43, 48, 27, 5, 45, 67, 97, 23, 39, 16].
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0651, Accuracy: 231/946 (24.4186%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 369/946 (39.0063%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.0671, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   1, Avg loss: 0.0844, Accuracy: 44/631 (6.9731%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   2, Avg loss: 0.0479, Accuracy: 229/631 (36.2916%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.7029, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   1, Avg loss: 0.0698, Accuracy: 302/1587 (19.0296%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   2, Avg loss: 0.0373, Accuracy: 539/1587 (33.9635%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.7464, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   1, Avg loss: 0.0529, Accuracy: 308/1628 (18.9189%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   2, Avg loss: 0.0290, Accuracy: 707/1628 (43.4275%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.6779, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   1, Avg loss: 0.0729, Accuracy: 166/669 (24.8132%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   2, Avg loss: 0.0439, Accuracy: 359/669 (53.6622%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.5885, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0786, Accuracy: 27/426 (6.3380%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0414, Accuracy: 180/426 (42.2535%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.8328, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  89, local model 97, internal_epoch   1, Avg loss: 0.0588, Accuracy: 297/1213 (24.4847%)
_Train Local_ResNet_18, epoch  89, local model 97, internal_epoch   2, Avg loss: 0.0300, Accuracy: 490/1213 (40.3957%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 11.9538, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   1, Avg loss: 0.0753, Accuracy: 177/715 (24.7552%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   2, Avg loss: 0.0450, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.4754, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 267/1013 (26.3574%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0273, Accuracy: 481/1013 (47.4827%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.0971, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   1, Avg loss: 0.0709, Accuracy: 184/708 (25.9887%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   2, Avg loss: 0.0457, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.4678, Accuracy: 55/10000 (0.5500%)
time spent on training: 334.67449617385864
[rfa agg] training data poison_ratio: 0.0  data num: [946, 631, 1587, 1628, 669, 426, 1213, 715, 1013, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 48, 27, 5, 45, 67, 97, 23, 39, 16], weight: tensor([0.0992, 0.0662, 0.1664, 0.1707, 0.0702, 0.0447, 0.1272, 0.0750, 0.1062,
        0.0742])
[rfa agg] iter:  0, prev_obj_val: 61.712913513183594, obj_val: 64.1481704711914, abs dis: 2.4352569580078125
[rfa agg] iter: 0, weight: tensor([0.1696, 0.0677, 0.0822, 0.0768, 0.0817, 0.0294, 0.1239, 0.0927, 0.1793,
        0.0966])
[rfa agg] iter:  1, prev_obj_val: 64.1481704711914, obj_val: 65.80290222167969, abs dis: 1.6547317504882812
[rfa agg] iter: 1, weight: tensor([0.1651, 0.0802, 0.0743, 0.0698, 0.0967, 0.0329, 0.1066, 0.1051, 0.1563,
        0.1129])
[rfa agg] iter:  2, prev_obj_val: 65.80290222167969, obj_val: 69.79549407958984, abs dis: 3.9925918579101562
[rfa agg] iter: 2, weight: tensor([0.1537, 0.0890, 0.0718, 0.0677, 0.1072, 0.0354, 0.0999, 0.1122, 0.1411,
        0.1222])
[rfa agg] iter:  3, prev_obj_val: 69.79549407958984, obj_val: 69.77721405029297, abs dis: 0.018280029296875
[rfa agg] iter: 3, weight: tensor([0.1305, 0.1096, 0.0676, 0.0641, 0.1268, 0.0412, 0.0896, 0.1198, 0.1192,
        0.1317])
[rfa agg] iter:  4, prev_obj_val: 69.77721405029297, obj_val: 69.7770767211914, abs dis: 0.0001373291015625
[rfa agg] iter: 4, weight: tensor([0.1284, 0.1105, 0.0672, 0.0637, 0.1293, 0.0412, 0.0889, 0.1207, 0.1176,
        0.1325])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 12.3981, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 13.6618, Accuracy: 0/9950 (0.0000%)
saving model
Done in 447.65310072898865 sec.
Server Epoch:90 choose agents : [25, 41, 39, 40, 34, 77, 29, 71, 8, 53].
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   1, Avg loss: 0.0694, Accuracy: 208/690 (30.1449%)
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   2, Avg loss: 0.0344, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.9346, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0864, Accuracy: 152/719 (21.1405%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0388, Accuracy: 466/719 (64.8122%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.5536, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0530, Accuracy: 275/1013 (27.1471%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0271, Accuracy: 507/1013 (50.0494%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.5698, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0623, Accuracy: 287/1573 (18.2454%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0379, Accuracy: 505/1573 (32.1043%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.6677, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   1, Avg loss: 0.0638, Accuracy: 307/1427 (21.5137%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   2, Avg loss: 0.0359, Accuracy: 585/1427 (40.9951%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.5485, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  90, local model 77, internal_epoch   1, Avg loss: 0.0720, Accuracy: 222/1340 (16.5672%)
_Train Local_ResNet_18, epoch  90, local model 77, internal_epoch   2, Avg loss: 0.0299, Accuracy: 534/1340 (39.8507%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.4390, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   1, Avg loss: 0.0557, Accuracy: 351/1440 (24.3750%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   2, Avg loss: 0.0293, Accuracy: 643/1440 (44.6528%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.0001, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0621, Accuracy: 150/818 (18.3374%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0330, Accuracy: 311/818 (38.0196%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.2124, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   1, Avg loss: 0.0685, Accuracy: 155/1513 (10.2445%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   2, Avg loss: 0.0399, Accuracy: 394/1513 (26.0410%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.9036, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0438, Accuracy: 275/813 (33.8253%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0209, Accuracy: 459/813 (56.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 13.0872, Accuracy: 58/10000 (0.5800%)
time spent on training: 401.4041996002197
[rfa agg] training data poison_ratio: 0.0  data num: [690, 719, 1013, 1573, 1427, 1340, 1440, 818, 1513, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 41, 39, 40, 34, 77, 29, 71, 8, 53], weight: tensor([0.0608, 0.0634, 0.0893, 0.1386, 0.1258, 0.1181, 0.1269, 0.0721, 0.1334,
        0.0717])
[rfa agg] iter:  0, prev_obj_val: 60.59233093261719, obj_val: 62.18491744995117, abs dis: 1.5925865173339844
[rfa agg] iter: 0, weight: tensor([0.0609, 0.0698, 0.1851, 0.0850, 0.0959, 0.1169, 0.0972, 0.0988, 0.0917,
        0.0988])
[rfa agg] iter:  1, prev_obj_val: 62.18491744995117, obj_val: 62.178340911865234, abs dis: 0.0065765380859375
[rfa agg] iter: 1, weight: tensor([0.0642, 0.0740, 0.2002, 0.0786, 0.0884, 0.1072, 0.0893, 0.1079, 0.0845,
        0.1057])
[rfa agg] iter:  2, prev_obj_val: 62.178340911865234, obj_val: 62.17825698852539, abs dis: 8.392333984375e-05
[rfa agg] iter: 2, weight: tensor([0.0640, 0.0739, 0.2032, 0.0781, 0.0879, 0.1064, 0.0887, 0.1082, 0.0840,
        0.1055])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 11.3635, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 12.9887, Accuracy: 0/9950 (0.0000%)
saving model
Done in 520.7144014835358 sec.
Server Epoch:91 choose agents : [36, 34, 71, 11, 72, 91, 63, 3, 50, 24].
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.1015, Accuracy: 6/408 (1.4706%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0626, Accuracy: 133/408 (32.5980%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.8915, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0636, Accuracy: 301/1427 (21.0932%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0362, Accuracy: 538/1427 (37.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.4224, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0627, Accuracy: 143/818 (17.4817%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0335, Accuracy: 298/818 (36.4303%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.3290, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   1, Avg loss: 0.0557, Accuracy: 226/712 (31.7416%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   2, Avg loss: 0.0274, Accuracy: 435/712 (61.0955%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.0710, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   1, Avg loss: 0.0691, Accuracy: 192/1241 (15.4714%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   2, Avg loss: 0.0400, Accuracy: 395/1241 (31.8292%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.6698, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  91, local model 91, internal_epoch   1, Avg loss: 0.0645, Accuracy: 241/1030 (23.3981%)
_Train Local_ResNet_18, epoch  91, local model 91, internal_epoch   2, Avg loss: 0.0326, Accuracy: 587/1030 (56.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.3405, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   1, Avg loss: 0.0675, Accuracy: 179/888 (20.1577%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   2, Avg loss: 0.0289, Accuracy: 441/888 (49.6622%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.2561, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   1, Avg loss: 0.0799, Accuracy: 45/781 (5.7618%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   2, Avg loss: 0.0411, Accuracy: 228/781 (29.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.6437, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   1, Avg loss: 0.0698, Accuracy: 116/809 (14.3387%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   2, Avg loss: 0.0300, Accuracy: 336/809 (41.5328%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.8473, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.1042, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0592, Accuracy: 70/312 (22.4359%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.2091, Accuracy: 50/10000 (0.5000%)
time spent on training: 327.46078419685364
[rfa agg] training data poison_ratio: 0.0  data num: [408, 1427, 818, 712, 1241, 1030, 888, 781, 809, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 34, 71, 11, 72, 91, 63, 3, 50, 24], weight: tensor([0.0484, 0.1694, 0.0971, 0.0845, 0.1473, 0.1222, 0.1054, 0.0927, 0.0960,
        0.0370])
[rfa agg] iter:  0, prev_obj_val: 50.11875915527344, obj_val: 51.38859558105469, abs dis: 1.26983642578125
[rfa agg] iter: 0, weight: tensor([0.0303, 0.0671, 0.1608, 0.1121, 0.0819, 0.0913, 0.1422, 0.1283, 0.1686,
        0.0175])
[rfa agg] iter:  1, prev_obj_val: 51.38859558105469, obj_val: 55.732906341552734, abs dis: 4.344310760498047
[rfa agg] iter: 1, weight: tensor([0.0319, 0.0623, 0.1678, 0.1189, 0.0753, 0.0836, 0.1378, 0.1273, 0.1769,
        0.0181])
[rfa agg] iter:  2, prev_obj_val: 55.732906341552734, obj_val: 55.72699737548828, abs dis: 0.005908966064453125
[rfa agg] iter: 2, weight: tensor([0.0410, 0.0637, 0.1610, 0.1329, 0.0747, 0.0818, 0.1286, 0.1273, 0.1668,
        0.0223])
[rfa agg] iter:  3, prev_obj_val: 55.72699737548828, obj_val: 55.72692108154297, abs dis: 7.62939453125e-05
[rfa agg] iter: 3, weight: tensor([0.0411, 0.0637, 0.1604, 0.1352, 0.0746, 0.0817, 0.1278, 0.1276, 0.1653,
        0.0224])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 11.3912, Accuracy: 71/10000 (0.7100%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 12.2673, Accuracy: 0/9950 (0.0000%)
saving model
Done in 444.46013927459717 sec.
Server Epoch:92 choose agents : [92, 90, 77, 1, 58, 42, 96, 14, 29, 30].
_Train Local_ResNet_18, epoch  92, local model 92, internal_epoch   1, Avg loss: 0.0644, Accuracy: 288/1715 (16.7930%)
_Train Local_ResNet_18, epoch  92, local model 92, internal_epoch   2, Avg loss: 0.0340, Accuracy: 633/1715 (36.9096%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.8939, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   1, Avg loss: 0.0816, Accuracy: 126/677 (18.6115%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   2, Avg loss: 0.0252, Accuracy: 468/677 (69.1285%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 13.6164, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   1, Avg loss: 0.0713, Accuracy: 214/1340 (15.9701%)
_Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   2, Avg loss: 0.0303, Accuracy: 516/1340 (38.5075%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.3511, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   1, Avg loss: 0.0586, Accuracy: 250/928 (26.9397%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   2, Avg loss: 0.0264, Accuracy: 564/928 (60.7759%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.0921, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0826, Accuracy: 160/803 (19.9253%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0417, Accuracy: 442/803 (55.0436%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.4728, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0666, Accuracy: 209/1372 (15.2332%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0347, Accuracy: 455/1372 (33.1633%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.5475, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   1, Avg loss: 0.0861, Accuracy: 13/311 (4.1801%)
_Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   2, Avg loss: 0.0621, Accuracy: 107/311 (34.4051%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.5836, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   1, Avg loss: 0.0682, Accuracy: 167/1013 (16.4857%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   2, Avg loss: 0.0403, Accuracy: 337/1013 (33.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.5584, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0565, Accuracy: 320/1440 (22.2222%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0294, Accuracy: 653/1440 (45.3472%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.8621, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   1, Avg loss: 0.0934, Accuracy: 6/486 (1.2346%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   2, Avg loss: 0.0438, Accuracy: 205/486 (42.1811%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.2585, Accuracy: 60/10000 (0.6000%)
time spent on training: 345.3327667713165
[rfa agg] training data poison_ratio: 0.0  data num: [1715, 677, 1340, 928, 803, 1372, 311, 1013, 1440, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [92, 90, 77, 1, 58, 42, 96, 14, 29, 30], weight: tensor([0.1701, 0.0671, 0.1329, 0.0920, 0.0796, 0.1360, 0.0308, 0.1004, 0.1428,
        0.0482])
[rfa agg] iter:  0, prev_obj_val: 61.722496032714844, obj_val: 64.14733123779297, abs dis: 2.424835205078125
[rfa agg] iter: 0, weight: tensor([0.0885, 0.0628, 0.1391, 0.1328, 0.1032, 0.1172, 0.0147, 0.1944, 0.1163,
        0.0312])
[rfa agg] iter:  1, prev_obj_val: 64.14733123779297, obj_val: 64.1240463256836, abs dis: 0.023284912109375
[rfa agg] iter: 1, weight: tensor([0.0790, 0.0715, 0.1192, 0.1459, 0.1234, 0.1014, 0.0156, 0.2098, 0.1004,
        0.0339])
[rfa agg] iter:  2, prev_obj_val: 64.1240463256836, obj_val: 65.74063110351562, abs dis: 1.6165847778320312
[rfa agg] iter: 2, weight: tensor([0.0782, 0.0714, 0.1176, 0.1475, 0.1245, 0.1000, 0.0155, 0.2123, 0.0994,
        0.0337])
[rfa agg] iter:  3, prev_obj_val: 65.74063110351562, obj_val: 65.73621368408203, abs dis: 0.00441741943359375
[rfa agg] iter: 3, weight: tensor([0.0760, 0.0780, 0.1110, 0.1504, 0.1378, 0.0955, 0.0162, 0.2043, 0.0948,
        0.0360])
[rfa agg] iter:  4, prev_obj_val: 65.73621368408203, obj_val: 65.73614501953125, abs dis: 6.866455078125e-05
[rfa agg] iter: 4, weight: tensor([0.0758, 0.0783, 0.1108, 0.1511, 0.1395, 0.0953, 0.0162, 0.2023, 0.0946,
        0.0360])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.2458, Accuracy: 64/10000 (0.6400%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 14.0383, Accuracy: 0/9950 (0.0000%)
saving model
Done in 455.6149694919586 sec.
Server Epoch:93 choose agents : [76, 7, 35, 2, 94, 15, 46, 67, 55, 73].
_Train Local_ResNet_18, epoch  93, local model 76, internal_epoch   1, Avg loss: 0.0964, Accuracy: 6/466 (1.2876%)
_Train Local_ResNet_18, epoch  93, local model 76, internal_epoch   2, Avg loss: 0.0535, Accuracy: 169/466 (36.2661%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.5936, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 317/891 (35.5780%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   2, Avg loss: 0.0280, Accuracy: 430/891 (48.2604%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.5039, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   1, Avg loss: 0.1132, Accuracy: 3/271 (1.1070%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   2, Avg loss: 0.0743, Accuracy: 48/271 (17.7122%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.4018, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   1, Avg loss: 0.0780, Accuracy: 86/605 (14.2149%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   2, Avg loss: 0.0450, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.9005, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   1, Avg loss: 0.0693, Accuracy: 222/1662 (13.3574%)
_Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   2, Avg loss: 0.0378, Accuracy: 479/1662 (28.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.1144, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0703, Accuracy: 258/1154 (22.3570%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0355, Accuracy: 350/1154 (30.3293%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 11.6455, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   1, Avg loss: 0.0630, Accuracy: 321/1904 (16.8592%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   2, Avg loss: 0.0343, Accuracy: 601/1904 (31.5651%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.9039, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   1, Avg loss: 0.0821, Accuracy: 15/426 (3.5211%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   2, Avg loss: 0.0430, Accuracy: 177/426 (41.5493%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.2776, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   1, Avg loss: 0.0557, Accuracy: 259/1071 (24.1830%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   2, Avg loss: 0.0316, Accuracy: 484/1071 (45.1914%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.8029, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   1, Avg loss: 0.0899, Accuracy: 60/938 (6.3966%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   2, Avg loss: 0.0379, Accuracy: 329/938 (35.0746%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.3642, Accuracy: 68/10000 (0.6800%)
time spent on training: 348.32532358169556
[rfa agg] training data poison_ratio: 0.0  data num: [466, 891, 271, 605, 1662, 1154, 1904, 426, 1071, 938]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 7, 35, 2, 94, 15, 46, 67, 55, 73], weight: tensor([0.0496, 0.0949, 0.0289, 0.0644, 0.1770, 0.1229, 0.2028, 0.0454, 0.1141,
        0.0999])
[rfa agg] iter:  0, prev_obj_val: 73.68806457519531, obj_val: 75.13408660888672, abs dis: 1.4460220336914062
[rfa agg] iter: 0, weight: tensor([0.0350, 0.1459, 0.0151, 0.0576, 0.1121, 0.1356, 0.0928, 0.0289, 0.1974,
        0.1797])
[rfa agg] iter:  1, prev_obj_val: 75.13408660888672, obj_val: 76.32867431640625, abs dis: 1.1945877075195312
[rfa agg] iter: 1, weight: tensor([0.0370, 0.1664, 0.0155, 0.0625, 0.0969, 0.1206, 0.0819, 0.0302, 0.1872,
        0.2017])
[rfa agg] iter:  2, prev_obj_val: 76.32867431640625, obj_val: 77.75772094726562, abs dis: 1.429046630859375
[rfa agg] iter: 2, weight: tensor([0.0389, 0.1789, 0.0161, 0.0668, 0.0922, 0.1134, 0.0787, 0.0317, 0.1738,
        0.2094])
[rfa agg] iter:  3, prev_obj_val: 77.75772094726562, obj_val: 77.753662109375, abs dis: 0.004058837890625
[rfa agg] iter: 3, weight: tensor([0.0416, 0.1898, 0.0169, 0.0725, 0.0890, 0.1083, 0.0767, 0.0337, 0.1617,
        0.2099])
[rfa agg] iter:  4, prev_obj_val: 77.753662109375, obj_val: 77.7535400390625, abs dis: 0.0001220703125
[rfa agg] iter: 4, weight: tensor([0.0415, 0.1923, 0.0168, 0.0725, 0.0888, 0.1078, 0.0765, 0.0336, 0.1600,
        0.2102])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.4661, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 12.8901, Accuracy: 0/9950 (0.0000%)
saving model
Done in 459.6781361103058 sec.
Server Epoch:94 choose agents : [54, 23, 97, 0, 28, 52, 48, 24, 5, 3].
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0653, Accuracy: 259/1130 (22.9204%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0328, Accuracy: 460/1130 (40.7080%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.4042, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0785, Accuracy: 156/715 (21.8182%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0445, Accuracy: 435/715 (60.8392%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.8577, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   1, Avg loss: 0.0647, Accuracy: 254/1213 (20.9398%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   2, Avg loss: 0.0305, Accuracy: 497/1213 (40.9728%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.1632, Accuracy: 62/10000 (0.6200%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  94, local model 0, internal_epoch   1, Avg loss: 0.0722, Accuracy: 254/1657 (15.3289%)
_Train Local_ResNet_18, epoch  94, local model 0, internal_epoch   2, Avg loss: 0.0404, Accuracy: 415/1657 (25.0453%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.6620, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   1, Avg loss: 0.0686, Accuracy: 277/1581 (17.5206%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   2, Avg loss: 0.0387, Accuracy: 505/1581 (31.9418%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.6429, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   1, Avg loss: 0.0744, Accuracy: 176/636 (27.6730%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   2, Avg loss: 0.0415, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.3817, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   1, Avg loss: 0.0852, Accuracy: 46/631 (7.2900%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   2, Avg loss: 0.0492, Accuracy: 233/631 (36.9255%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.4484, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   1, Avg loss: 0.1104, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   2, Avg loss: 0.0644, Accuracy: 65/312 (20.8333%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.8019, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0532, Accuracy: 281/1628 (17.2604%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0292, Accuracy: 674/1628 (41.4005%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.6485, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0835, Accuracy: 35/781 (4.4814%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0415, Accuracy: 218/781 (27.9129%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.6537, Accuracy: 80/10000 (0.8000%)
time spent on training: 421.55871295928955
[rfa agg] training data poison_ratio: 0.16112407623492805  data num: [1130, 715, 1213, 1657, 1581, 636, 631, 312, 1628, 781]
[rfa agg] considering poison per batch poison_fraction: 0.05035127382341502
[rfa agg] init. name: [54, 23, 97, 0, 28, 52, 48, 24, 5, 3], weight: tensor([0.1099, 0.0695, 0.1180, 0.1611, 0.1537, 0.0618, 0.0614, 0.0303, 0.1583,
        0.0759])
[rfa agg] iter:  0, prev_obj_val: 66.97987365722656, obj_val: 66.75442504882812, abs dis: 0.2254486083984375
[rfa agg] iter: 0, weight: tensor([0.2030, 0.0702, 0.1847, 0.1067, 0.1157, 0.0515, 0.0527, 0.0154, 0.1059,
        0.0941])
[rfa agg] iter:  1, prev_obj_val: 66.75442504882812, obj_val: 66.75115203857422, abs dis: 0.00327301025390625
[rfa agg] iter: 1, weight: tensor([0.2167, 0.0682, 0.1914, 0.1025, 0.1118, 0.0500, 0.0510, 0.0150, 0.1020,
        0.0914])
[rfa agg] iter:  2, prev_obj_val: 66.75115203857422, obj_val: 68.0716781616211, abs dis: 1.320526123046875
[rfa agg] iter: 2, weight: tensor([0.2190, 0.0679, 0.1918, 0.1020, 0.1114, 0.0498, 0.0508, 0.0149, 0.1015,
        0.0908])
[rfa agg] iter:  3, prev_obj_val: 68.0716781616211, obj_val: 68.06812286376953, abs dis: 0.0035552978515625
[rfa agg] iter: 3, weight: tensor([0.2116, 0.0738, 0.1828, 0.0997, 0.1081, 0.0540, 0.0553, 0.0158, 0.0991,
        0.0998])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.9894, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 4.2958, Accuracy: 0/9950 (0.0000%)
saving model
Done in 531.9314484596252 sec.
Server Epoch:95 choose agents : [80, 4, 1, 10, 41, 2, 58, 11, 29, 78].
_Train Local_ResNet_18, epoch  95, local model 80, internal_epoch   1, Avg loss: 0.0823, Accuracy: 90/682 (13.1965%)
_Train Local_ResNet_18, epoch  95, local model 80, internal_epoch   2, Avg loss: 0.0419, Accuracy: 260/682 (38.1232%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.3434, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   1, Avg loss: 0.0689, Accuracy: 255/901 (28.3019%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   2, Avg loss: 0.0365, Accuracy: 402/901 (44.6171%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.3860, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0575, Accuracy: 243/928 (26.1853%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0255, Accuracy: 566/928 (60.9914%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.5236, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0808, Accuracy: 86/861 (9.9884%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0251, Accuracy: 404/861 (46.9222%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.6603, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   1, Avg loss: 0.0913, Accuracy: 131/719 (18.2197%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   2, Avg loss: 0.0400, Accuracy: 469/719 (65.2295%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.2500, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   1, Avg loss: 0.0758, Accuracy: 102/605 (16.8595%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   2, Avg loss: 0.0444, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.4652, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0771, Accuracy: 175/803 (21.7933%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0386, Accuracy: 445/803 (55.4172%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.8090, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   1, Avg loss: 0.0613, Accuracy: 215/712 (30.1966%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   2, Avg loss: 0.0289, Accuracy: 431/712 (60.5337%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.9683, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0581, Accuracy: 309/1440 (21.4583%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0304, Accuracy: 658/1440 (45.6944%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.0605, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   1, Avg loss: 0.0922, Accuracy: 8/416 (1.9231%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   2, Avg loss: 0.0498, Accuracy: 176/416 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.7795, Accuracy: 72/10000 (0.7200%)
time spent on training: 210.06068015098572
[rfa agg] training data poison_ratio: 0.0  data num: [682, 901, 928, 861, 719, 605, 803, 712, 1440, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 4, 1, 10, 41, 2, 58, 11, 29, 78], weight: tensor([0.0845, 0.1117, 0.1150, 0.1067, 0.0891, 0.0750, 0.0995, 0.0883, 0.1785,
        0.0516])
[rfa agg] iter:  0, prev_obj_val: 46.5660514831543, obj_val: 57.32442855834961, abs dis: 10.758377075195312
[rfa agg] iter: 0, weight: tensor([0.1222, 0.0988, 0.0990, 0.1226, 0.1129, 0.0874, 0.1467, 0.1101, 0.0646,
        0.0357])
[rfa agg] iter:  1, prev_obj_val: 57.32442855834961, obj_val: 54.43730163574219, abs dis: 2.887126922607422
[rfa agg] iter: 1, weight: tensor([0.1413, 0.0844, 0.0851, 0.0985, 0.1116, 0.1298, 0.1159, 0.1085, 0.0634,
        0.0615])
[rfa agg] iter:  2, prev_obj_val: 54.43730163574219, obj_val: 54.43637466430664, abs dis: 0.000926971435546875
[rfa agg] iter: 2, weight: tensor([0.1471, 0.0837, 0.0842, 0.0985, 0.1126, 0.1299, 0.1184, 0.1099, 0.0614,
        0.0543])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.9931, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 4.7471, Accuracy: 0/9950 (0.0000%)
saving model
Done in 320.74196791648865 sec.
Server Epoch:96 choose agents : [78, 9, 2, 30, 42, 95, 61, 3, 15, 6].
_Train Local_ResNet_18, epoch  96, local model 78, internal_epoch   1, Avg loss: 0.0909, Accuracy: 15/416 (3.6058%)
_Train Local_ResNet_18, epoch  96, local model 78, internal_epoch   2, Avg loss: 0.0490, Accuracy: 166/416 (39.9038%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.7107, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0598, Accuracy: 267/1275 (20.9412%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0213, Accuracy: 657/1275 (51.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 12.0714, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0775, Accuracy: 89/605 (14.7107%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0451, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.8265, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   1, Avg loss: 0.0984, Accuracy: 8/486 (1.6461%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   2, Avg loss: 0.0454, Accuracy: 196/486 (40.3292%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.5186, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   1, Avg loss: 0.0661, Accuracy: 199/1372 (14.5044%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   2, Avg loss: 0.0354, Accuracy: 448/1372 (32.6531%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.3353, Accuracy: 71/10000 (0.7100%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  96, local model 95, internal_epoch   1, Avg loss: 0.0632, Accuracy: 202/599 (33.7229%)
_Train Local_ResNet_18, epoch  96, local model 95, internal_epoch   2, Avg loss: 0.0355, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 14.7001, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   1, Avg loss: 0.1365, Accuracy: 2/85 (2.3529%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   2, Avg loss: 0.1268, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.4200, Accuracy: 37/10000 (0.3700%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0851, Accuracy: 38/781 (4.8656%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0398, Accuracy: 227/781 (29.0653%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.6409, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   1, Avg loss: 0.0667, Accuracy: 260/1154 (22.5303%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   2, Avg loss: 0.0341, Accuracy: 395/1154 (34.2288%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.7031, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0648, Accuracy: 337/1956 (17.2290%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0367, Accuracy: 535/1956 (27.3517%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.0331, Accuracy: 88/10000 (0.8800%)
time spent on training: 227.5304822921753
[rfa agg] training data poison_ratio: 0.06862183526177111  data num: [416, 1275, 605, 486, 1372, 599, 85, 781, 1154, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.021444323519303473
[rfa agg] init. name: [78, 9, 2, 30, 42, 95, 61, 3, 15, 6], weight: tensor([0.0477, 0.1461, 0.0693, 0.0557, 0.1572, 0.0686, 0.0097, 0.0895, 0.1322,
        0.2241])
[rfa agg] iter:  0, prev_obj_val: 75.61332702636719, obj_val: 76.37644958496094, abs dis: 0.76312255859375
[rfa agg] iter: 0, weight: tensor([0.0335, 0.2137, 0.0682, 0.0436, 0.1703, 0.0662, 0.0042, 0.1322, 0.1620,
        0.1060])
[rfa agg] iter:  1, prev_obj_val: 76.37644958496094, obj_val: 76.37258911132812, abs dis: 0.0038604736328125
[rfa agg] iter: 1, weight: tensor([0.0349, 0.2049, 0.0723, 0.0456, 0.1604, 0.0702, 0.0043, 0.1455, 0.1607,
        0.1013])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 20.0428, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 23.8333, Accuracy: 0/9950 (0.0000%)
saving model
Done in 338.89263367652893 sec.
Server Epoch:97 choose agents : [38, 36, 84, 75, 85, 8, 27, 41, 26, 54].
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   1, Avg loss: 0.0805, Accuracy: 122/1131 (10.7869%)
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   2, Avg loss: 0.0376, Accuracy: 412/1131 (36.4279%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.5392, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   1, Avg loss: 0.1071, Accuracy: 10/408 (2.4510%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   2, Avg loss: 0.0661, Accuracy: 132/408 (32.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.3267, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   1, Avg loss: 0.0700, Accuracy: 224/1190 (18.8235%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   2, Avg loss: 0.0344, Accuracy: 433/1190 (36.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.0442, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  97, local model 75, internal_epoch   1, Avg loss: 0.0741, Accuracy: 162/776 (20.8763%)
_Train Local_ResNet_18, epoch  97, local model 75, internal_epoch   2, Avg loss: 0.0378, Accuracy: 380/776 (48.9691%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.8227, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   1, Avg loss: 0.0604, Accuracy: 356/1988 (17.9074%)
_Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   2, Avg loss: 0.0391, Accuracy: 557/1988 (28.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.1121, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   1, Avg loss: 0.0693, Accuracy: 161/1513 (10.6411%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   2, Avg loss: 0.0401, Accuracy: 385/1513 (25.4461%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.4828, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   1, Avg loss: 0.0731, Accuracy: 276/1587 (17.3913%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   2, Avg loss: 0.0387, Accuracy: 528/1587 (33.2703%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.4909, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0879, Accuracy: 139/719 (19.3324%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0425, Accuracy: 469/719 (65.2295%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.0873, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0659, Accuracy: 255/1446 (17.6349%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0384, Accuracy: 450/1446 (31.1203%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.1845, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   1, Avg loss: 0.0595, Accuracy: 277/1130 (24.5133%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   2, Avg loss: 0.0318, Accuracy: 485/1130 (42.9204%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.1345, Accuracy: 68/10000 (0.6800%)
time spent on training: 260.8139889240265
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 408, 1190, 776, 1988, 1513, 1587, 719, 1446, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 36, 84, 75, 85, 8, 27, 41, 26, 54], weight: tensor([0.0951, 0.0343, 0.1001, 0.0653, 0.1672, 0.1273, 0.1335, 0.0605, 0.1216,
        0.0951])
[rfa agg] iter:  0, prev_obj_val: 64.24755859375, obj_val: 66.83851623535156, abs dis: 2.5909576416015625
[rfa agg] iter: 0, weight: tensor([0.1271, 0.0163, 0.1484, 0.0569, 0.0722, 0.1248, 0.1152, 0.0460, 0.1368,
        0.1562])
[rfa agg] iter:  1, prev_obj_val: 66.83851623535156, obj_val: 66.8224868774414, abs dis: 0.01602935791015625
[rfa agg] iter: 1, weight: tensor([0.1379, 0.0178, 0.1527, 0.0653, 0.0671, 0.1103, 0.1024, 0.0520, 0.1206,
        0.1740])
[rfa agg] iter:  2, prev_obj_val: 66.8224868774414, obj_val: 65.27521514892578, abs dis: 1.547271728515625
[rfa agg] iter: 2, weight: tensor([0.1391, 0.0177, 0.1519, 0.0652, 0.0667, 0.1094, 0.1015, 0.0519, 0.1192,
        0.1774])
[rfa agg] iter:  3, prev_obj_val: 65.27521514892578, obj_val: 66.8241195678711, abs dis: 1.5489044189453125
[rfa agg] iter: 3, weight: tensor([0.1360, 0.0167, 0.1529, 0.0599, 0.0677, 0.1146, 0.1057, 0.0481, 0.1254,
        0.1732])
[rfa agg] iter:  4, prev_obj_val: 66.8241195678711, obj_val: 66.8222427368164, abs dis: 0.0018768310546875
[rfa agg] iter: 4, weight: tensor([0.1389, 0.0177, 0.1521, 0.0651, 0.0667, 0.1095, 0.1016, 0.0519, 0.1194,
        0.1770])
[rfa agg] iter:  5, prev_obj_val: 66.8222427368164, obj_val: 65.27534484863281, abs dis: 1.5468978881835938
[rfa agg] iter: 5, weight: tensor([0.1393, 0.0177, 0.1516, 0.0651, 0.0666, 0.1093, 0.1014, 0.0519, 0.1190,
        0.1780])
[rfa agg] iter:  6, prev_obj_val: 65.27534484863281, obj_val: 66.82408905029297, abs dis: 1.5487442016601562
[rfa agg] iter: 6, weight: tensor([0.1361, 0.0167, 0.1528, 0.0598, 0.0677, 0.1146, 0.1057, 0.0480, 0.1253,
        0.1733])
[rfa agg] iter:  7, prev_obj_val: 66.82408905029297, obj_val: 66.82222747802734, abs dis: 0.001861572265625
[rfa agg] iter: 7, weight: tensor([0.1389, 0.0177, 0.1521, 0.0651, 0.0667, 0.1095, 0.1016, 0.0519, 0.1194,
        0.1770])
[rfa agg] iter:  8, prev_obj_val: 66.82222747802734, obj_val: 65.27535247802734, abs dis: 1.546875
[rfa agg] iter: 8, weight: tensor([0.1393, 0.0177, 0.1516, 0.0651, 0.0666, 0.1093, 0.1014, 0.0519, 0.1190,
        0.1780])
[rfa agg] iter:  9, prev_obj_val: 65.27535247802734, obj_val: 66.8240966796875, abs dis: 1.5487442016601562
[rfa agg] iter: 9, weight: tensor([0.1361, 0.0167, 0.1528, 0.0598, 0.0677, 0.1146, 0.1057, 0.0480, 0.1253,
        0.1733])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.9828, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 11.1546, Accuracy: 0/9950 (0.0000%)
saving model
Done in 372.38720631599426 sec.
Server Epoch:98 choose agents : [70, 56, 62, 90, 72, 16, 25, 33, 22, 57].
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   1, Avg loss: 0.0692, Accuracy: 265/1418 (18.6883%)
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   2, Avg loss: 0.0373, Accuracy: 492/1418 (34.6968%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.8287, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0949, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0780, Accuracy: 22/186 (11.8280%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.3023, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0831, Accuracy: 43/568 (7.5704%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0448, Accuracy: 258/568 (45.4225%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.0579, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  98, local model 90, internal_epoch   1, Avg loss: 0.0826, Accuracy: 132/677 (19.4978%)
_Train Local_ResNet_18, epoch  98, local model 90, internal_epoch   2, Avg loss: 0.0245, Accuracy: 466/677 (68.8331%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 12.8462, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   1, Avg loss: 0.0710, Accuracy: 198/1241 (15.9549%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   2, Avg loss: 0.0418, Accuracy: 377/1241 (30.3787%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.6045, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0766, Accuracy: 173/708 (24.4350%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0410, Accuracy: 422/708 (59.6045%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.4844, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   1, Avg loss: 0.0649, Accuracy: 209/690 (30.2899%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   2, Avg loss: 0.0333, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.6148, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   1, Avg loss: 0.0879, Accuracy: 31/515 (6.0194%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   2, Avg loss: 0.0630, Accuracy: 115/515 (22.3301%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.3852, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   1, Avg loss: 0.0525, Accuracy: 450/1470 (30.6122%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   2, Avg loss: 0.0273, Accuracy: 829/1470 (56.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.0691, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   1, Avg loss: 0.0698, Accuracy: 205/1154 (17.7643%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   2, Avg loss: 0.0320, Accuracy: 427/1154 (37.0017%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 11.1253, Accuracy: 68/10000 (0.6800%)
time spent on training: 217.46765661239624
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 186, 568, 677, 1241, 708, 690, 515, 1470, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 56, 62, 90, 72, 16, 25, 33, 22, 57], weight: tensor([0.1644, 0.0216, 0.0658, 0.0785, 0.1439, 0.0821, 0.0800, 0.0597, 0.1704,
        0.1338])
[rfa agg] iter:  0, prev_obj_val: 64.42772674560547, obj_val: 65.38034057617188, abs dis: 0.9526138305664062
[rfa agg] iter: 0, weight: tensor([0.1159, 0.0110, 0.0707, 0.1142, 0.1442, 0.1185, 0.1144, 0.0569, 0.1205,
        0.1337])
[rfa agg] iter:  1, prev_obj_val: 65.38034057617188, obj_val: 66.5295639038086, abs dis: 1.1492233276367188
[rfa agg] iter: 1, weight: tensor([0.1078, 0.0112, 0.0751, 0.1249, 0.1333, 0.1273, 0.1245, 0.0593, 0.1119,
        0.1246])
[rfa agg] iter:  2, prev_obj_val: 66.5295639038086, obj_val: 69.28839874267578, abs dis: 2.7588348388671875
[rfa agg] iter: 2, weight: tensor([0.1010, 0.0114, 0.0800, 0.1353, 0.1229, 0.1329, 0.1343, 0.0619, 0.1048,
        0.1156])
[rfa agg] iter:  3, prev_obj_val: 69.28839874267578, obj_val: 67.81639099121094, abs dis: 1.4720077514648438
[rfa agg] iter: 3, weight: tensor([0.0885, 0.0118, 0.0910, 0.1557, 0.1048, 0.1371, 0.1528, 0.0668, 0.0918,
        0.0996])
[rfa agg] iter:  4, prev_obj_val: 67.81639099121094, obj_val: 66.5289077758789, abs dis: 1.2874832153320312
[rfa agg] iter: 4, weight: tensor([0.0936, 0.0115, 0.0853, 0.1485, 0.1120, 0.1362, 0.1462, 0.0644, 0.0969,
        0.1053])
[rfa agg] iter:  5, prev_obj_val: 66.5289077758789, obj_val: 67.81780242919922, abs dis: 1.2888946533203125
[rfa agg] iter: 5, weight: tensor([0.1002, 0.0114, 0.0801, 0.1374, 0.1216, 0.1336, 0.1362, 0.0619, 0.1038,
        0.1137])
[rfa agg] iter:  6, prev_obj_val: 67.81780242919922, obj_val: 66.52741241455078, abs dis: 1.2903900146484375
[rfa agg] iter: 6, weight: tensor([0.0943, 0.0116, 0.0852, 0.1464, 0.1130, 0.1363, 0.1445, 0.0643, 0.0977,
        0.1067])
[rfa agg] iter:  7, prev_obj_val: 66.52741241455078, obj_val: 67.81790924072266, abs dis: 1.290496826171875
[rfa agg] iter: 7, weight: tensor([0.1002, 0.0114, 0.0801, 0.1373, 0.1217, 0.1336, 0.1361, 0.0619, 0.1039,
        0.1138])
[rfa agg] iter:  8, prev_obj_val: 67.81790924072266, obj_val: 66.52739715576172, abs dis: 1.2905120849609375
[rfa agg] iter: 8, weight: tensor([0.0943, 0.0116, 0.0852, 0.1464, 0.1130, 0.1363, 0.1444, 0.0643, 0.0977,
        0.1067])
[rfa agg] iter:  9, prev_obj_val: 66.52739715576172, obj_val: 67.81791687011719, abs dis: 1.2905197143554688
[rfa agg] iter: 9, weight: tensor([0.1002, 0.0114, 0.0801, 0.1373, 0.1217, 0.1336, 0.1361, 0.0619, 0.1039,
        0.1138])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.8834, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 10.9215, Accuracy: 0/9950 (0.0000%)
saving model
Done in 328.3615071773529 sec.
Server Epoch:99 choose agents : [24, 49, 35, 66, 25, 82, 38, 62, 93, 79].
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.1047, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0584, Accuracy: 78/312 (25.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.0886, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   1, Avg loss: 0.0909, Accuracy: 7/440 (1.5909%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   2, Avg loss: 0.0547, Accuracy: 122/440 (27.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.7760, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.1171, Accuracy: 0/271 (0.0000%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0766, Accuracy: 42/271 (15.4982%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.4897, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0757, Accuracy: 152/1402 (10.8417%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0445, Accuracy: 333/1402 (23.7518%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.4797, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   1, Avg loss: 0.0678, Accuracy: 201/690 (29.1304%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   2, Avg loss: 0.0323, Accuracy: 453/690 (65.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.2037, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1, Avg loss: 0.0891, Accuracy: 8/500 (1.6000%)
_Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2, Avg loss: 0.0513, Accuracy: 183/500 (36.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.0896, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   1, Avg loss: 0.0794, Accuracy: 135/1131 (11.9363%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   2, Avg loss: 0.0372, Accuracy: 419/1131 (37.0469%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.2658, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   1, Avg loss: 0.0841, Accuracy: 36/568 (6.3380%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   2, Avg loss: 0.0454, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.8856, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  99, local model 93, internal_epoch   1, Avg loss: 0.0583, Accuracy: 392/1742 (22.5029%)
_Train Local_ResNet_18, epoch  99, local model 93, internal_epoch   2, Avg loss: 0.0329, Accuracy: 676/1742 (38.8060%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.0981, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  99, local model 79, internal_epoch   1, Avg loss: 0.1213, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  99, local model 79, internal_epoch   2, Avg loss: 0.0929, Accuracy: 6/197 (3.0457%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.2748, Accuracy: 50/10000 (0.5000%)
time spent on training: 197.99758505821228
[rfa agg] training data poison_ratio: 0.0  data num: [312, 440, 271, 1402, 690, 500, 1131, 568, 1742, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 49, 35, 66, 25, 82, 38, 62, 93, 79], weight: tensor([0.0430, 0.0607, 0.0374, 0.1933, 0.0951, 0.0689, 0.1559, 0.0783, 0.2402,
        0.0272])
[rfa agg] iter:  0, prev_obj_val: 78.14840698242188, obj_val: 78.59282684326172, abs dis: 0.44441986083984375
[rfa agg] iter: 0, weight: tensor([0.0305, 0.0538, 0.0264, 0.1844, 0.1424, 0.0690, 0.2508, 0.0906, 0.1353,
        0.0169])
[rfa agg] iter:  1, prev_obj_val: 78.59282684326172, obj_val: 80.12895965576172, abs dis: 1.5361328125
[rfa agg] iter: 1, weight: tensor([0.0313, 0.0561, 0.0272, 0.1720, 0.1548, 0.0726, 0.2450, 0.0961, 0.1277,
        0.0173])
[rfa agg] iter:  2, prev_obj_val: 80.12895965576172, obj_val: 80.958251953125, abs dis: 0.8292922973632812
[rfa agg] iter: 2, weight: tensor([0.0341, 0.0626, 0.0295, 0.1530, 0.1828, 0.0824, 0.2075, 0.1116, 0.1179,
        0.0185])
[rfa agg] iter:  3, prev_obj_val: 80.958251953125, obj_val: 81.88646697998047, abs dis: 0.9282150268554688
[rfa agg] iter: 3, weight: tensor([0.0352, 0.0659, 0.0305, 0.1422, 0.2014, 0.0875, 0.1860, 0.1206, 0.1116,
        0.0189])
[rfa agg] iter:  4, prev_obj_val: 81.88646697998047, obj_val: 84.06751251220703, abs dis: 2.1810455322265625
[rfa agg] iter: 4, weight: tensor([0.0362, 0.0689, 0.0313, 0.1317, 0.2177, 0.0925, 0.1676, 0.1297, 0.1051,
        0.0192])
[rfa agg] iter:  5, prev_obj_val: 84.06751251220703, obj_val: 85.31773376464844, abs dis: 1.2502212524414062
[rfa agg] iter: 5, weight: tensor([0.0381, 0.0755, 0.0329, 0.1129, 0.2363, 0.1036, 0.1378, 0.1506, 0.0927,
        0.0198])
[rfa agg] iter:  6, prev_obj_val: 85.31773376464844, obj_val: 86.74647521972656, abs dis: 1.428741455078125
[rfa agg] iter: 6, weight: tensor([0.0390, 0.0794, 0.0336, 0.1035, 0.2394, 0.1104, 0.1236, 0.1648, 0.0862,
        0.0200])
[rfa agg] iter:  7, prev_obj_val: 86.74647521972656, obj_val: 85.31497955322266, abs dis: 1.4314956665039062
[rfa agg] iter: 7, weight: tensor([0.0404, 0.0845, 0.0348, 0.0962, 0.2293, 0.1190, 0.1129, 0.1813, 0.0812,
        0.0204])
[rfa agg] iter:  8, prev_obj_val: 85.31497955322266, obj_val: 85.30979919433594, abs dis: 0.00518035888671875
[rfa agg] iter: 8, weight: tensor([0.0390, 0.0797, 0.0336, 0.1025, 0.2375, 0.1114, 0.1219, 0.1689, 0.0855,
        0.0199])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.4456, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 12.5457, Accuracy: 0/9950 (0.0000%)
saving model
Done in 310.98603677749634 sec.
Server Epoch:100 choose agents : [47, 65, 86, 24, 39, 5, 1, 53, 88, 58].
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   1, Avg loss: 0.1430, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   2, Avg loss: 0.1192, Accuracy: 2/134 (1.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.5022, Accuracy: 39/10000 (0.3900%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   1, Avg loss: 0.0733, Accuracy: 251/1475 (17.0169%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   2, Avg loss: 0.0371, Accuracy: 538/1475 (36.4746%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.2282, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0611, Accuracy: 290/1003 (28.9133%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0360, Accuracy: 422/1003 (42.0738%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.5267, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   1, Avg loss: 0.1025, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   2, Avg loss: 0.0571, Accuracy: 74/312 (23.7179%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.1717, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0525, Accuracy: 298/1013 (29.4176%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0274, Accuracy: 488/1013 (48.1737%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.9701, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   1, Avg loss: 0.0549, Accuracy: 311/1628 (19.1032%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   2, Avg loss: 0.0297, Accuracy: 680/1628 (41.7690%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.3907, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   1, Avg loss: 0.0545, Accuracy: 268/928 (28.8793%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   2, Avg loss: 0.0260, Accuracy: 553/928 (59.5905%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.7990, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0473, Accuracy: 256/813 (31.4883%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0205, Accuracy: 459/813 (56.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 12.8024, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch 100, local model 88, internal_epoch   1, Avg loss: 0.0917, Accuracy: 19/603 (3.1509%)
_Train Local_ResNet_18, epoch 100, local model 88, internal_epoch   2, Avg loss: 0.0493, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.6917, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0751, Accuracy: 185/803 (23.0386%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0407, Accuracy: 423/803 (52.6775%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.8063, Accuracy: 64/10000 (0.6400%)
time spent on training: 219.36361145973206
[rfa agg] training data poison_ratio: 0.0  data num: [134, 1475, 1003, 312, 1013, 1628, 928, 813, 603, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [47, 65, 86, 24, 39, 5, 1, 53, 88, 58], weight: tensor([0.0154, 0.1693, 0.1151, 0.0358, 0.1163, 0.1869, 0.1065, 0.0933, 0.0692,
        0.0922])
[rfa agg] iter:  0, prev_obj_val: 58.96932601928711, obj_val: 60.19317626953125, abs dis: 1.2238502502441406
[rfa agg] iter: 0, weight: tensor([0.0053, 0.0856, 0.2043, 0.0155, 0.1939, 0.0828, 0.1259, 0.1125, 0.0544,
        0.1199])
[rfa agg] iter:  1, prev_obj_val: 60.19317626953125, obj_val: 63.1289176940918, abs dis: 2.935741424560547
[rfa agg] iter: 1, weight: tensor([0.0054, 0.0734, 0.1905, 0.0161, 0.1828, 0.0721, 0.1241, 0.1324, 0.0610,
        0.1421])
[rfa agg] iter:  2, prev_obj_val: 63.1289176940918, obj_val: 63.09873580932617, abs dis: 0.030181884765625
[rfa agg] iter: 2, weight: tensor([0.0060, 0.0697, 0.1597, 0.0182, 0.1558, 0.0688, 0.1203, 0.1558, 0.0748,
        0.1708])
[rfa agg] iter:  3, prev_obj_val: 63.09873580932617, obj_val: 63.0980110168457, abs dis: 0.00072479248046875
[rfa agg] iter: 3, weight: tensor([0.0060, 0.0691, 0.1565, 0.0181, 0.1524, 0.0682, 0.1186, 0.1596, 0.0749,
        0.1765])
[rfa agg] iter:  4, prev_obj_val: 63.0980110168457, obj_val: 64.99971008300781, abs dis: 1.9016990661621094
[rfa agg] iter: 4, weight: tensor([0.0060, 0.0690, 0.1561, 0.0181, 0.1519, 0.0681, 0.1182, 0.1602, 0.0749,
        0.1776])
[rfa agg] iter:  5, prev_obj_val: 64.99971008300781, obj_val: 64.99555206298828, abs dis: 0.00415802001953125
[rfa agg] iter: 5, weight: tensor([0.0063, 0.0681, 0.1446, 0.0194, 0.1416, 0.0673, 0.1157, 0.1669, 0.0840,
        0.1859])
[rfa agg] iter:  6, prev_obj_val: 64.99555206298828, obj_val: 64.9954605102539, abs dis: 9.1552734375e-05
[rfa agg] iter: 6, weight: tensor([0.0063, 0.0679, 0.1436, 0.0194, 0.1406, 0.0671, 0.1149, 0.1681, 0.0842,
        0.1880])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.0519, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 12.6280, Accuracy: 0/9950 (0.0000%)
saving model
Done in 330.50683546066284 sec.
Saving all the graphs.
This run has a label: Jun.25_15.26.47. Visdom environment: tiny
