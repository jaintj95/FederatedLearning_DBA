current path: saved_models/model_tiny_Jun.29_22.04.52
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 5, 10, 15, 25, 30, 37, 44, 49, 55, 61, 65, 85]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [98, 0, 77, 44, 66, 67, 33, 25, 19, 92].
_Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   1, Avg loss: 0.0833, Accuracy: 12/373 (3.2172%)
_Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   2, Avg loss: 0.0495, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.4317, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   1, Avg loss: 0.0585, Accuracy: 385/1657 (23.2348%)
_Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   2, Avg loss: 0.0354, Accuracy: 471/1657 (28.4249%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.4067, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 307/1340 (22.9104%)
_Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 584/1340 (43.5821%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.0068, Accuracy: 63/10000 (0.6300%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0593, Accuracy: 389/1750 (22.2286%)
_Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 657/1750 (37.5429%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.4944, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   1, Avg loss: 0.0625, Accuracy: 250/1402 (17.8317%)
_Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 383/1402 (27.3181%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.2054, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   1, Avg loss: 0.0794, Accuracy: 44/426 (10.3286%)
_Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   2, Avg loss: 0.0420, Accuracy: 176/426 (41.3146%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5858, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   1, Avg loss: 0.0802, Accuracy: 57/515 (11.0680%)
_Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   2, Avg loss: 0.0546, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.6637, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   1, Avg loss: 0.0575, Accuracy: 295/690 (42.7536%)
_Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.2006, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   1, Avg loss: 0.0468, Accuracy: 391/1036 (37.7413%)
_Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   2, Avg loss: 0.0253, Accuracy: 648/1036 (62.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 9.4956, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 459/1715 (26.7638%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 736/1715 (42.9155%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.4507, Accuracy: 75/10000 (0.7500%)
time spent on training: 135.48419833183289
[rfa agg] training data poison_ratio: 0.37573367571533384  data num: [373, 1657, 1340, 1750, 1402, 426, 515, 690, 1036, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.11741677366104182
[rfa agg] init. name: [98, 0, 77, 44, 66, 67, 33, 25, 19, 92], weight: tensor([0.0342, 0.1520, 0.1229, 0.1605, 0.1286, 0.0391, 0.0472, 0.0633, 0.0950,
        0.1573])
[rfa agg] iter:  0, prev_obj_val: 60.8475341796875, obj_val: 62.775062561035156, abs dis: 1.9275283813476562
[rfa agg] iter: 0, weight: tensor([0.0129, 0.0955, 0.2167, 0.0799, 0.1689, 0.0161, 0.0235, 0.0399, 0.2594,
        0.0872])
[rfa agg] iter:  1, prev_obj_val: 62.775062561035156, obj_val: 62.765350341796875, abs dis: 0.00971221923828125
[rfa agg] iter: 1, weight: tensor([0.0129, 0.0857, 0.1785, 0.0726, 0.1430, 0.0160, 0.0237, 0.0408, 0.3478,
        0.0788])
[rfa agg] iter:  2, prev_obj_val: 62.765350341796875, obj_val: 60.797935485839844, abs dis: 1.9674148559570312
[rfa agg] iter: 2, weight: tensor([0.0127, 0.0846, 0.1751, 0.0716, 0.1408, 0.0158, 0.0234, 0.0402, 0.3581,
        0.0777])
[rfa agg] iter:  3, prev_obj_val: 60.797935485839844, obj_val: 62.77298355102539, abs dis: 1.9750480651855469
[rfa agg] iter: 3, weight: tensor([0.0127, 0.0937, 0.2139, 0.0783, 0.1660, 0.0157, 0.0231, 0.0391, 0.2721,
        0.0854])
[rfa agg] iter:  4, prev_obj_val: 62.77298355102539, obj_val: 62.76531982421875, abs dis: 0.007663726806640625
[rfa agg] iter: 4, weight: tensor([0.0128, 0.0856, 0.1781, 0.0725, 0.1427, 0.0160, 0.0237, 0.0407, 0.3492,
        0.0787])
[rfa agg] iter:  5, prev_obj_val: 62.76531982421875, obj_val: 60.7979736328125, abs dis: 1.96734619140625
[rfa agg] iter: 5, weight: tensor([0.0127, 0.0845, 0.1750, 0.0716, 0.1408, 0.0158, 0.0234, 0.0402, 0.3583,
        0.0777])
[rfa agg] iter:  6, prev_obj_val: 60.7979736328125, obj_val: 62.77298355102539, abs dis: 1.9750099182128906
[rfa agg] iter: 6, weight: tensor([0.0127, 0.0937, 0.2139, 0.0783, 0.1660, 0.0157, 0.0231, 0.0391, 0.2721,
        0.0854])
[rfa agg] iter:  7, prev_obj_val: 62.77298355102539, obj_val: 62.76531982421875, abs dis: 0.007663726806640625
[rfa agg] iter: 7, weight: tensor([0.0128, 0.0856, 0.1781, 0.0725, 0.1427, 0.0160, 0.0237, 0.0407, 0.3492,
        0.0787])
[rfa agg] iter:  8, prev_obj_val: 62.76531982421875, obj_val: 60.7979736328125, abs dis: 1.96734619140625
[rfa agg] iter: 8, weight: tensor([0.0127, 0.0845, 0.1750, 0.0716, 0.1408, 0.0158, 0.0234, 0.0402, 0.3583,
        0.0777])
[rfa agg] iter:  9, prev_obj_val: 60.7979736328125, obj_val: 62.77298355102539, abs dis: 1.9750099182128906
[rfa agg] iter: 9, weight: tensor([0.0127, 0.0937, 0.2139, 0.0783, 0.1660, 0.0157, 0.0231, 0.0391, 0.2721,
        0.0854])
			Update norm = 169.38556816660918 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 390.9472360610962 sec.
Server Epoch:2 choose agents : [77, 57, 52, 28, 29, 61, 99, 34, 8, 85].
_Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 336/1340 (25.0746%)
_Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 551/1340 (41.1194%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.8830, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   1, Avg loss: 0.0572, Accuracy: 293/1154 (25.3899%)
_Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   2, Avg loss: 0.0263, Accuracy: 470/1154 (40.7279%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.4438, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 277/636 (43.5535%)
_Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   2, Avg loss: 0.0322, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.1907, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 385/1581 (24.3517%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0343, Accuracy: 548/1581 (34.6616%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.5862, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0494, Accuracy: 424/1440 (29.4444%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 685/1440 (47.5694%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.9433, Accuracy: 68/10000 (0.6800%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   1, Avg loss: 0.1258, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   2, Avg loss: 0.1178, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3046, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0661, Accuracy: 169/773 (21.8629%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0313, Accuracy: 417/773 (53.9457%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.1015, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   1, Avg loss: 0.0588, Accuracy: 367/1427 (25.7183%)
_Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 559/1427 (39.1731%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8143, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   1, Avg loss: 0.0606, Accuracy: 226/1513 (14.9372%)
_Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   2, Avg loss: 0.0373, Accuracy: 476/1513 (31.4607%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.4125, Accuracy: 89/10000 (0.8900%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0545, Accuracy: 459/1988 (23.0885%)
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 659/1988 (33.1489%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.1327, Accuracy: 83/10000 (0.8300%)
time spent on training: 147.66112804412842
[rfa agg] training data poison_ratio: 0.17366172405126917  data num: [1340, 1154, 636, 1581, 1440, 85, 773, 1427, 1513, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.05426928876602162
[rfa agg] init. name: [77, 57, 52, 28, 29, 61, 99, 34, 8, 85], weight: tensor([0.1123, 0.0967, 0.0533, 0.1324, 0.1206, 0.0071, 0.0648, 0.1195, 0.1267,
        0.1665])
[rfa agg] iter:  0, prev_obj_val: 45.747196197509766, obj_val: 53.21092224121094, abs dis: 7.463726043701172
[rfa agg] iter: 0, weight: tensor([0.3174, 0.1551, 0.0147, 0.0837, 0.1299, 0.0011, 0.0249, 0.1304, 0.1009,
        0.0419])
[rfa agg] iter:  1, prev_obj_val: 53.21092224121094, obj_val: 56.080902099609375, abs dis: 2.8699798583984375
[rfa agg] iter: 1, weight: tensor([0.1846, 0.3463, 0.0205, 0.0758, 0.1018, 0.0014, 0.0372, 0.1016, 0.0864,
        0.0444])
[rfa agg] iter:  2, prev_obj_val: 56.080902099609375, obj_val: 56.075557708740234, abs dis: 0.005344390869140625
[rfa agg] iter: 2, weight: tensor([0.1536, 0.3925, 0.0225, 0.0728, 0.0944, 0.0015, 0.0421, 0.0942, 0.0818,
        0.0445])
[rfa agg] iter:  3, prev_obj_val: 56.075557708740234, obj_val: 53.09845733642578, abs dis: 2.977100372314453
[rfa agg] iter: 3, weight: tensor([0.1497, 0.4055, 0.0221, 0.0714, 0.0925, 0.0015, 0.0413, 0.0922, 0.0802,
        0.0436])
[rfa agg] iter:  4, prev_obj_val: 53.09845733642578, obj_val: 53.09564208984375, abs dis: 0.00281524658203125
[rfa agg] iter: 4, weight: tensor([0.1545, 0.4385, 0.0178, 0.0659, 0.0881, 0.0012, 0.0324, 0.0880, 0.0749,
        0.0386])
[rfa agg] iter:  5, prev_obj_val: 53.09564208984375, obj_val: 56.077239990234375, abs dis: 2.981597900390625
[rfa agg] iter: 5, weight: tensor([0.1507, 0.4518, 0.0174, 0.0644, 0.0861, 0.0012, 0.0316, 0.0860, 0.0732,
        0.0378])
[rfa agg] iter:  6, prev_obj_val: 56.077239990234375, obj_val: 53.09695053100586, abs dis: 2.9802894592285156
[rfa agg] iter: 6, weight: tensor([0.1456, 0.4209, 0.0215, 0.0696, 0.0901, 0.0015, 0.0403, 0.0899, 0.0781,
        0.0425])
[rfa agg] iter:  7, prev_obj_val: 53.09695053100586, obj_val: 53.09534454345703, abs dis: 0.001605987548828125
[rfa agg] iter: 7, weight: tensor([0.1525, 0.4452, 0.0176, 0.0651, 0.0871, 0.0012, 0.0320, 0.0870, 0.0741,
        0.0382])
[rfa agg] iter:  8, prev_obj_val: 53.09534454345703, obj_val: 56.077537536621094, abs dis: 2.9821929931640625
[rfa agg] iter: 8, weight: tensor([0.1498, 0.4548, 0.0173, 0.0640, 0.0856, 0.0012, 0.0315, 0.0855, 0.0728,
        0.0376])
[rfa agg] iter:  9, prev_obj_val: 56.077537536621094, obj_val: 50.447418212890625, abs dis: 5.630119323730469
[rfa agg] iter: 9, weight: tensor([0.1453, 0.4218, 0.0215, 0.0695, 0.0900, 0.0015, 0.0402, 0.0897, 0.0780,
        0.0425])
			Update norm = 182.2514789034646 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 396.0043008327484 sec.
Server Epoch:3 choose agents : [89, 70, 9, 99, 37, 17, 4, 82, 30, 13].
_Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   1, Avg loss: 0.0612, Accuracy: 328/896 (36.6071%)
_Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 440/896 (49.1071%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.2012, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0562, Accuracy: 323/1418 (22.7786%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0321, Accuracy: 596/1418 (42.0310%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7003, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   1, Avg loss: 0.0493, Accuracy: 366/1275 (28.7059%)
_Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 698/1275 (54.7451%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 9.2375, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   1, Avg loss: 0.0674, Accuracy: 173/773 (22.3803%)
_Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   2, Avg loss: 0.0316, Accuracy: 398/773 (51.4877%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.9691, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   1, Avg loss: 0.0532, Accuracy: 385/1129 (34.1010%)
_Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   2, Avg loss: 0.0254, Accuracy: 706/1129 (62.5332%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1963, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 418/1574 (26.5565%)
_Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 659/1574 (41.8679%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.9105, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0636, Accuracy: 322/901 (35.7381%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0336, Accuracy: 403/901 (44.7281%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.6587, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   1, Avg loss: 0.0775, Accuracy: 65/500 (13.0000%)
_Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   2, Avg loss: 0.0495, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.6502, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   1, Avg loss: 0.0816, Accuracy: 64/486 (13.1687%)
_Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   2, Avg loss: 0.0421, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.8335, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 317/1645 (19.2705%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 646/1645 (39.2705%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0144, Accuracy: 118/10000 (1.1800%)
time spent on training: 151.87777042388916
[rfa agg] training data poison_ratio: 0.1524016231008776  data num: [896, 1418, 1275, 773, 1129, 1574, 901, 500, 486, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.04762550721902425
[rfa agg] init. name: [89, 70, 9, 99, 37, 17, 4, 82, 30, 13], weight: tensor([0.0846, 0.1338, 0.1203, 0.0729, 0.1065, 0.1485, 0.0850, 0.0472, 0.0459,
        0.1552])
[rfa agg] iter:  0, prev_obj_val: 50.907936096191406, obj_val: 52.3336181640625, abs dis: 1.4256820678710938
[rfa agg] iter: 0, weight: tensor([0.1251, 0.0792, 0.1305, 0.0790, 0.2257, 0.0676, 0.1875, 0.0214, 0.0209,
        0.0632])
[rfa agg] iter:  1, prev_obj_val: 52.3336181640625, obj_val: 53.89012908935547, abs dis: 1.5565109252929688
[rfa agg] iter: 1, weight: tensor([0.1465, 0.0705, 0.1099, 0.0876, 0.1797, 0.0611, 0.2442, 0.0218, 0.0212,
        0.0574])
[rfa agg] iter:  2, prev_obj_val: 53.89012908935547, obj_val: 60.10223388671875, abs dis: 6.212104797363281
[rfa agg] iter: 2, weight: tensor([0.1689, 0.0592, 0.0882, 0.0935, 0.1325, 0.0521, 0.3150, 0.0209, 0.0203,
        0.0492])
[rfa agg] iter:  3, prev_obj_val: 60.10223388671875, obj_val: 65.8609848022461, abs dis: 5.758750915527344
[rfa agg] iter: 3, weight: tensor([0.3353, 0.0426, 0.0573, 0.1670, 0.0742, 0.0388, 0.2036, 0.0224, 0.0218,
        0.0371])
[rfa agg] iter:  4, prev_obj_val: 65.8609848022461, obj_val: 72.69141387939453, abs dis: 6.8304290771484375
[rfa agg] iter: 4, weight: tensor([0.2363, 0.0426, 0.0547, 0.3365, 0.0665, 0.0395, 0.1272, 0.0297, 0.0289,
        0.0381])
[rfa agg] iter:  5, prev_obj_val: 72.69141387939453, obj_val: 69.17161560058594, abs dis: 3.5197982788085938
[rfa agg] iter: 5, weight: tensor([0.1819, 0.0547, 0.0676, 0.2897, 0.0788, 0.0515, 0.1234, 0.0519, 0.0505,
        0.0499])
[rfa agg] iter:  6, prev_obj_val: 69.17161560058594, obj_val: 62.79283905029297, abs dis: 6.378776550292969
[rfa agg] iter: 6, weight: tensor([0.1897, 0.0469, 0.0590, 0.3539, 0.0702, 0.0438, 0.1192, 0.0380, 0.0370,
        0.0424])
[rfa agg] iter:  7, prev_obj_val: 62.79283905029297, obj_val: 65.823486328125, abs dis: 3.0306472778320312
[rfa agg] iter: 7, weight: tensor([0.2875, 0.0403, 0.0529, 0.2900, 0.0662, 0.0371, 0.1422, 0.0244, 0.0237,
        0.0357])
[rfa agg] iter:  8, prev_obj_val: 65.823486328125, obj_val: 69.16852569580078, abs dis: 3.3450393676757812
[rfa agg] iter: 8, weight: tensor([0.2200, 0.0403, 0.0518, 0.3766, 0.0630, 0.0374, 0.1193, 0.0281, 0.0274,
        0.0361])
[rfa agg] iter:  9, prev_obj_val: 69.16852569580078, obj_val: 62.79498291015625, abs dis: 6.373542785644531
[rfa agg] iter: 9, weight: tensor([0.1862, 0.0458, 0.0576, 0.3685, 0.0685, 0.0428, 0.1162, 0.0371, 0.0361,
        0.0414])
			Update norm = 131.0908856957645 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 406.7676305770874 sec.
Server Epoch:4 choose agents : [24, 77, 38, 89, 8, 28, 48, 62, 16, 76].
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0771, Accuracy: 29/312 (9.2949%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3797, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0547, Accuracy: 314/1340 (23.4328%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 565/1340 (42.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.6209, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   1, Avg loss: 0.0622, Accuracy: 244/1131 (21.5738%)
_Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 489/1131 (43.2361%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.3225, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   1, Avg loss: 0.0614, Accuracy: 326/896 (36.3839%)
_Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.1658, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   1, Avg loss: 0.0603, Accuracy: 240/1513 (15.8625%)
_Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 498/1513 (32.9147%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.1217, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   1, Avg loss: 0.0569, Accuracy: 371/1581 (23.4662%)
_Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   2, Avg loss: 0.0341, Accuracy: 584/1581 (36.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.4789, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   1, Avg loss: 0.0714, Accuracy: 93/631 (14.7385%)
_Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   2, Avg loss: 0.0417, Accuracy: 208/631 (32.9635%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7967, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0693, Accuracy: 136/568 (23.9437%)
_Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0416, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7427, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   1, Avg loss: 0.0647, Accuracy: 268/708 (37.8531%)
_Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   2, Avg loss: 0.0358, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.8124, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0866, Accuracy: 38/466 (8.1545%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.5977, Accuracy: 50/10000 (0.5000%)
time spent on training: 131.1568524837494
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1340, 1131, 896, 1513, 1581, 631, 568, 708, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 77, 38, 89, 8, 28, 48, 62, 16, 76], weight: tensor([0.0341, 0.1465, 0.1237, 0.0980, 0.1654, 0.1729, 0.0690, 0.0621, 0.0774,
        0.0510])
[rfa agg] iter:  0, prev_obj_val: 56.462562561035156, obj_val: 60.30635070800781, abs dis: 3.8437881469726562
[rfa agg] iter: 0, weight: tensor([0.0145, 0.1037, 0.1700, 0.3177, 0.0786, 0.0740, 0.0584, 0.0442, 0.1080,
        0.0310])
[rfa agg] iter:  1, prev_obj_val: 60.30635070800781, obj_val: 66.0699234008789, abs dis: 5.763572692871094
[rfa agg] iter: 1, weight: tensor([0.0137, 0.0674, 0.0939, 0.4108, 0.0545, 0.0521, 0.0662, 0.0473, 0.1624,
        0.0317])
[rfa agg] iter:  2, prev_obj_val: 66.0699234008789, obj_val: 65.93224334716797, abs dis: 0.1376800537109375
[rfa agg] iter: 2, weight: tensor([0.0163, 0.0557, 0.0702, 0.1624, 0.0473, 0.0457, 0.1076, 0.0693, 0.3828,
        0.0427])
[rfa agg] iter:  3, prev_obj_val: 65.93224334716797, obj_val: 73.46484375, abs dis: 7.532600402832031
[rfa agg] iter: 3, weight: tensor([0.0137, 0.0468, 0.0589, 0.1308, 0.0397, 0.0383, 0.0920, 0.0585, 0.4853,
        0.0360])
[rfa agg] iter:  4, prev_obj_val: 73.46484375, obj_val: 70.78917694091797, abs dis: 2.6756668090820312
[rfa agg] iter: 4, weight: tensor([0.0226, 0.0527, 0.0621, 0.1031, 0.0464, 0.0451, 0.2616, 0.1432, 0.1899,
        0.0731])
[rfa agg] iter:  5, prev_obj_val: 70.78917694091797, obj_val: 70.78292083740234, abs dis: 0.006256103515625
[rfa agg] iter: 5, weight: tensor([0.0209, 0.0551, 0.0662, 0.1184, 0.0480, 0.0466, 0.2195, 0.1135, 0.2495,
        0.0624])
[rfa agg] iter:  6, prev_obj_val: 70.78292083740234, obj_val: 68.29252624511719, abs dis: 2.4903945922851562
[rfa agg] iter: 6, weight: tensor([0.0209, 0.0552, 0.0662, 0.1187, 0.0480, 0.0466, 0.2139, 0.1130, 0.2554,
        0.0622])
[rfa agg] iter:  7, prev_obj_val: 68.29252624511719, obj_val: 70.79398345947266, abs dis: 2.5014572143554688
[rfa agg] iter: 7, weight: tensor([0.0179, 0.0537, 0.0659, 0.1295, 0.0462, 0.0447, 0.1458, 0.0848, 0.3619,
        0.0498])
[rfa agg] iter:  8, prev_obj_val: 70.79398345947266, obj_val: 68.29000091552734, abs dis: 2.5039825439453125
[rfa agg] iter: 8, weight: tensor([0.0208, 0.0552, 0.0663, 0.1188, 0.0480, 0.0466, 0.2049, 0.1122, 0.2651,
        0.0620])
[rfa agg] iter:  9, prev_obj_val: 68.29000091552734, obj_val: 70.7942886352539, abs dis: 2.5042877197265625
[rfa agg] iter: 9, weight: tensor([0.0178, 0.0535, 0.0657, 0.1292, 0.0460, 0.0446, 0.1450, 0.0845, 0.3640,
        0.0496])
			Update norm = 110.08491484559771 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 391.4474313259125 sec.
Server Epoch:5 choose agents : [73, 49, 66, 2, 62, 24, 56, 25, 10, 97].
_Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   1, Avg loss: 0.0660, Accuracy: 167/938 (17.8038%)
_Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 306/938 (32.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.9781, Accuracy: 59/10000 (0.5900%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   1, Avg loss: 0.0815, Accuracy: 13/440 (2.9545%)
_Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   2, Avg loss: 0.0488, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.4947, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 248/1402 (17.6890%)
_Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 382/1402 (27.2468%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.0946, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 231/605 (38.1818%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0394, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7845, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0694, Accuracy: 141/568 (24.8239%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0416, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7582, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   1, Avg loss: 0.0773, Accuracy: 26/312 (8.3333%)
_Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 168/312 (53.8462%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3823, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0679, Accuracy: 59/186 (31.7204%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3126, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   1, Avg loss: 0.0587, Accuracy: 298/690 (43.1884%)
_Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.3304, Accuracy: 52/10000 (0.5200%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 201/861 (23.3449%)
_Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 425/861 (49.3612%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.7593, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0530, Accuracy: 365/1213 (30.0907%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 484/1213 (39.9011%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6872, Accuracy: 75/10000 (0.7500%)
time spent on training: 152.266352891922
[rfa agg] training data poison_ratio: 0.27595287595287593  data num: [938, 440, 1402, 605, 568, 312, 186, 690, 861, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.08623527373527373
[rfa agg] init. name: [73, 49, 66, 2, 62, 24, 56, 25, 10, 97], weight: tensor([0.1300, 0.0610, 0.1943, 0.0839, 0.0787, 0.0432, 0.0258, 0.0956, 0.1193,
        0.1681])
[rfa agg] iter:  0, prev_obj_val: 46.4178581237793, obj_val: 50.416656494140625, abs dis: 3.998798370361328
[rfa agg] iter: 0, weight: tensor([0.1357, 0.0390, 0.0627, 0.1298, 0.0833, 0.0196, 0.0089, 0.2625, 0.1813,
        0.0773])
[rfa agg] iter:  1, prev_obj_val: 50.416656494140625, obj_val: 52.38777160644531, abs dis: 1.9711151123046875
[rfa agg] iter: 1, weight: tensor([0.0684, 0.0407, 0.0405, 0.2591, 0.1164, 0.0182, 0.0078, 0.3209, 0.0806,
        0.0473])
[rfa agg] iter:  2, prev_obj_val: 52.38777160644531, obj_val: 60.62744140625, abs dis: 8.239669799804688
[rfa agg] iter: 2, weight: tensor([0.0574, 0.0440, 0.0362, 0.3821, 0.1536, 0.0187, 0.0078, 0.1929, 0.0657,
        0.0417])
[rfa agg] iter:  3, prev_obj_val: 60.62744140625, obj_val: 63.85098648071289, abs dis: 3.2235450744628906
[rfa agg] iter: 3, weight: tensor([0.0610, 0.1114, 0.0442, 0.1667, 0.3385, 0.0354, 0.0132, 0.1146, 0.0661,
        0.0491])
[rfa agg] iter:  4, prev_obj_val: 63.85098648071289, obj_val: 63.84542465209961, abs dis: 0.00556182861328125
[rfa agg] iter: 4, weight: tensor([0.0653, 0.1812, 0.0491, 0.1443, 0.2624, 0.0471, 0.0165, 0.1104, 0.0699,
        0.0540])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3006, Accuracy: 38/10000 (0.3800%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.3549, Accuracy: 0/9950 (0.0000%)
saving model
Done in 407.6835629940033 sec.
Server Epoch:6 choose agents : [50, 99, 30, 37, 67, 0, 63, 39, 52, 44].
_Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0637, Accuracy: 155/809 (19.1595%)
_Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0282, Accuracy: 333/809 (41.1619%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.3662, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   1, Avg loss: 0.0670, Accuracy: 174/773 (22.5097%)
_Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   2, Avg loss: 0.0326, Accuracy: 391/773 (50.5821%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.9666, Accuracy: 58/10000 (0.5800%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   1, Avg loss: 0.0815, Accuracy: 71/486 (14.6091%)
_Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   2, Avg loss: 0.0421, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.8792, Accuracy: 49/10000 (0.4900%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   1, Avg loss: 0.0522, Accuracy: 421/1129 (37.2896%)
_Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 734/1129 (65.0133%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6409, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   1, Avg loss: 0.0792, Accuracy: 39/426 (9.1549%)
_Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   2, Avg loss: 0.0437, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.6066, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0585, Accuracy: 351/1657 (21.1829%)
_Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0354, Accuracy: 470/1657 (28.3645%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.1244, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 256/888 (28.8288%)
_Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 432/888 (48.6486%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.1049, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   1, Avg loss: 0.0547, Accuracy: 308/1013 (30.4047%)
_Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   2, Avg loss: 0.0267, Accuracy: 449/1013 (44.3238%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8798, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 275/636 (43.2390%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.5446, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0601, Accuracy: 383/1750 (21.8857%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 638/1750 (36.4571%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.4979, Accuracy: 111/10000 (1.1100%)
time spent on training: 177.29969787597656
[rfa agg] training data poison_ratio: 0.5249294449670743  data num: [809, 773, 486, 1129, 426, 1657, 888, 1013, 636, 1750]
[rfa agg] considering poison per batch poison_fraction: 0.1640404515522107
[rfa agg] init. name: [50, 99, 30, 37, 67, 0, 63, 39, 52, 44], weight: tensor([0.0846, 0.0808, 0.0508, 0.1180, 0.0445, 0.1732, 0.0928, 0.1059, 0.0665,
        0.1829])
[rfa agg] iter:  0, prev_obj_val: 55.61151885986328, obj_val: 58.51361083984375, abs dis: 2.9020919799804688
[rfa agg] iter: 0, weight: tensor([0.0761, 0.0733, 0.0193, 0.2079, 0.0151, 0.0587, 0.1153, 0.3502, 0.0329,
        0.0513])
[rfa agg] iter:  1, prev_obj_val: 58.51361083984375, obj_val: 67.01402282714844, abs dis: 8.500411987304688
[rfa agg] iter: 1, weight: tensor([0.1693, 0.1632, 0.0214, 0.0733, 0.0160, 0.0367, 0.3159, 0.1297, 0.0413,
        0.0332])
[rfa agg] iter:  2, prev_obj_val: 67.01402282714844, obj_val: 66.979736328125, abs dis: 0.0342864990234375
[rfa agg] iter: 2, weight: tensor([0.2275, 0.2254, 0.0410, 0.0639, 0.0287, 0.0408, 0.1481, 0.0859, 0.1010,
        0.0377])
[rfa agg] iter:  3, prev_obj_val: 66.979736328125, obj_val: 64.16162109375, abs dis: 2.818115234375
[rfa agg] iter: 3, weight: tensor([0.2311, 0.2283, 0.0408, 0.0633, 0.0285, 0.0403, 0.1441, 0.0849, 0.1014,
        0.0373])
[rfa agg] iter:  4, prev_obj_val: 64.16162109375, obj_val: 69.93334197998047, abs dis: 5.771720886230469
[rfa agg] iter: 4, weight: tensor([0.2672, 0.2742, 0.0290, 0.0548, 0.0207, 0.0333, 0.1472, 0.0768, 0.0662,
        0.0306])
[rfa agg] iter:  5, prev_obj_val: 69.93334197998047, obj_val: 72.91703033447266, abs dis: 2.9836883544921875
[rfa agg] iter: 5, weight: tensor([0.1960, 0.1905, 0.0533, 0.0675, 0.0364, 0.0449, 0.1353, 0.0874, 0.1469,
        0.0417])
[rfa agg] iter:  6, prev_obj_val: 72.91703033447266, obj_val: 67.00361633300781, abs dis: 5.913414001464844
[rfa agg] iter: 6, weight: tensor([0.1602, 0.1548, 0.0657, 0.0667, 0.0433, 0.0461, 0.1209, 0.0837, 0.2157,
        0.0430])
[rfa agg] iter:  7, prev_obj_val: 67.00361633300781, obj_val: 66.979736328125, abs dis: 0.0238800048828125
[rfa agg] iter: 7, weight: tensor([0.2269, 0.2255, 0.0413, 0.0639, 0.0289, 0.0408, 0.1449, 0.0857, 0.1044,
        0.0377])
[rfa agg] iter:  8, prev_obj_val: 66.979736328125, obj_val: 64.16162872314453, abs dis: 2.8181076049804688
[rfa agg] iter: 8, weight: tensor([0.2311, 0.2283, 0.0408, 0.0633, 0.0286, 0.0403, 0.1440, 0.0849, 0.1015,
        0.0373])
[rfa agg] iter:  9, prev_obj_val: 64.16162872314453, obj_val: 69.93334197998047, abs dis: 5.7717132568359375
[rfa agg] iter: 9, weight: tensor([0.2672, 0.2742, 0.0290, 0.0548, 0.0207, 0.0333, 0.1472, 0.0768, 0.0662,
        0.0306])
			Update norm = 112.79203415467778 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3006, Accuracy: 38/10000 (0.3800%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.3549, Accuracy: 0/9950 (0.0000%)
saving model
Done in 427.3126347064972 sec.
Server Epoch:7 choose agents : [66, 72, 39, 28, 82, 63, 93, 98, 12, 10].
_Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 258/1402 (18.4023%)
_Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 397/1402 (28.3167%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.1951, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   1, Avg loss: 0.0632, Accuracy: 224/1241 (18.0500%)
_Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 404/1241 (32.5544%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.2024, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   1, Avg loss: 0.0541, Accuracy: 317/1013 (31.2932%)
_Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 498/1013 (49.1609%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.5793, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   1, Avg loss: 0.0567, Accuracy: 382/1581 (24.1619%)
_Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 592/1581 (37.4447%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.4944, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0773, Accuracy: 63/500 (12.6000%)
_Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6682, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   1, Avg loss: 0.0550, Accuracy: 249/888 (28.0405%)
_Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 437/888 (49.2117%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4133, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 445/1742 (25.5454%)
_Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 694/1742 (39.8393%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7774, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   1, Avg loss: 0.0821, Accuracy: 13/373 (3.4853%)
_Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   2, Avg loss: 0.0480, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.4552, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   1, Avg loss: 0.0881, Accuracy: 17/338 (5.0296%)
_Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   2, Avg loss: 0.0469, Accuracy: 151/338 (44.6746%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.4573, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0572, Accuracy: 205/861 (23.8095%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 445/861 (51.6841%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.9108, Accuracy: 50/10000 (0.5000%)
time spent on training: 149.78501105308533
[rfa agg] training data poison_ratio: 0.08662843344400845  data num: [1402, 1241, 1013, 1581, 500, 888, 1742, 373, 338, 861]
[rfa agg] considering poison per batch poison_fraction: 0.02707138545125264
[rfa agg] init. name: [66, 72, 39, 28, 82, 63, 93, 98, 12, 10], weight: tensor([0.1411, 0.1249, 0.1019, 0.1591, 0.0503, 0.0893, 0.1753, 0.0375, 0.0340,
        0.0866])
[rfa agg] iter:  0, prev_obj_val: 56.84431076049805, obj_val: 61.26530838012695, abs dis: 4.420997619628906
[rfa agg] iter: 0, weight: tensor([0.0888, 0.1218, 0.3882, 0.0653, 0.0206, 0.1209, 0.0533, 0.0124, 0.0113,
        0.1174])
[rfa agg] iter:  1, prev_obj_val: 61.26530838012695, obj_val: 63.14905548095703, abs dis: 1.8837471008300781
[rfa agg] iter: 1, weight: tensor([0.0613, 0.0755, 0.2785, 0.0486, 0.0219, 0.2268, 0.0413, 0.0127, 0.0115,
        0.2220])
[rfa agg] iter:  2, prev_obj_val: 63.14905548095703, obj_val: 68.23883819580078, abs dis: 5.08978271484375
[rfa agg] iter: 2, weight: tensor([0.0491, 0.0590, 0.1662, 0.0397, 0.0202, 0.3072, 0.0341, 0.0115, 0.0104,
        0.3027])
[rfa agg] iter:  3, prev_obj_val: 68.23883819580078, obj_val: 71.45672607421875, abs dis: 3.2178878784179688
[rfa agg] iter: 3, weight: tensor([0.0451, 0.0521, 0.1075, 0.0377, 0.0247, 0.3401, 0.0330, 0.0135, 0.0122,
        0.3341])
[rfa agg] iter:  4, prev_obj_val: 71.45672607421875, obj_val: 68.23794555664062, abs dis: 3.218780517578125
[rfa agg] iter: 4, weight: tensor([0.0579, 0.0657, 0.1225, 0.0491, 0.0368, 0.2976, 0.0433, 0.0196, 0.0178,
        0.2898])
[rfa agg] iter:  5, prev_obj_val: 68.23794555664062, obj_val: 71.45671081542969, abs dis: 3.2187652587890625
[rfa agg] iter: 5, weight: tensor([0.0452, 0.0521, 0.1072, 0.0378, 0.0247, 0.3399, 0.0331, 0.0135, 0.0123,
        0.3342])
[rfa agg] iter:  6, prev_obj_val: 71.45671081542969, obj_val: 68.23794555664062, abs dis: 3.2187652587890625
[rfa agg] iter: 6, weight: tensor([0.0579, 0.0657, 0.1225, 0.0491, 0.0368, 0.2976, 0.0433, 0.0196, 0.0178,
        0.2898])
[rfa agg] iter:  7, prev_obj_val: 68.23794555664062, obj_val: 71.45671081542969, abs dis: 3.2187652587890625
[rfa agg] iter: 7, weight: tensor([0.0452, 0.0521, 0.1072, 0.0378, 0.0247, 0.3399, 0.0331, 0.0135, 0.0123,
        0.3342])
[rfa agg] iter:  8, prev_obj_val: 71.45671081542969, obj_val: 68.23794555664062, abs dis: 3.2187652587890625
[rfa agg] iter: 8, weight: tensor([0.0579, 0.0657, 0.1225, 0.0491, 0.0368, 0.2976, 0.0433, 0.0196, 0.0178,
        0.2898])
[rfa agg] iter:  9, prev_obj_val: 68.23794555664062, obj_val: 71.45671081542969, abs dis: 3.2187652587890625
[rfa agg] iter: 9, weight: tensor([0.0452, 0.0521, 0.1072, 0.0378, 0.0247, 0.3399, 0.0331, 0.0135, 0.0123,
        0.3342])
			Update norm = 125.322782464672 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3006, Accuracy: 38/10000 (0.3800%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.3549, Accuracy: 0/9950 (0.0000%)
saving model
Done in 402.6552484035492 sec.
Server Epoch:8 choose agents : [77, 28, 16, 1, 70, 34, 54, 21, 14, 75].
_Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 344/1340 (25.6716%)
_Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 578/1340 (43.1343%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.7593, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0566, Accuracy: 375/1581 (23.7192%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0345, Accuracy: 561/1581 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.5418, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0621, Accuracy: 271/708 (38.2768%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0391, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.7667, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0570, Accuracy: 287/928 (30.9267%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0247, Accuracy: 524/928 (56.4655%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0202, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   1, Avg loss: 0.0562, Accuracy: 352/1418 (24.8237%)
_Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   2, Avg loss: 0.0315, Accuracy: 615/1418 (43.3709%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.4692, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 381/1427 (26.6994%)
_Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 597/1427 (41.8360%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.9740, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   1, Avg loss: 0.0559, Accuracy: 341/1130 (30.1770%)
_Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   2, Avg loss: 0.0295, Accuracy: 443/1130 (39.2035%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.5520, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0541, Accuracy: 390/1949 (20.0103%)
_Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0334, Accuracy: 598/1949 (30.6824%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.1837, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0622, Accuracy: 226/1013 (22.3100%)
_Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 328/1013 (32.3791%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.7146, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   1, Avg loss: 0.0667, Accuracy: 238/776 (30.6701%)
_Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   2, Avg loss: 0.0291, Accuracy: 397/776 (51.1598%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.8924, Accuracy: 52/10000 (0.5200%)
time spent on training: 145.85069298744202
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 1581, 708, 928, 1418, 1427, 1130, 1949, 1013, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 28, 16, 1, 70, 34, 54, 21, 14, 75], weight: tensor([0.1092, 0.1289, 0.0577, 0.0756, 0.1156, 0.1163, 0.0921, 0.1588, 0.0826,
        0.0632])
[rfa agg] iter:  0, prev_obj_val: 47.94171905517578, obj_val: 54.149539947509766, abs dis: 6.207820892333984
[rfa agg] iter: 0, weight: tensor([0.1818, 0.0771, 0.0297, 0.0670, 0.1026, 0.1024, 0.2567, 0.0478, 0.0969,
        0.0379])
[rfa agg] iter:  1, prev_obj_val: 54.149539947509766, obj_val: 60.94551086425781, abs dis: 6.795970916748047
[rfa agg] iter: 1, weight: tensor([0.0904, 0.0540, 0.0384, 0.1166, 0.0643, 0.0645, 0.2564, 0.0381, 0.2249,
        0.0524])
[rfa agg] iter:  2, prev_obj_val: 60.94551086425781, obj_val: 63.751914978027344, abs dis: 2.8064041137695312
[rfa agg] iter: 2, weight: tensor([0.0593, 0.0408, 0.0485, 0.2319, 0.0463, 0.0464, 0.1077, 0.0309, 0.3147,
        0.0735])
[rfa agg] iter:  3, prev_obj_val: 63.751914978027344, obj_val: 63.73306655883789, abs dis: 0.018848419189453125
[rfa agg] iter: 3, weight: tensor([0.0558, 0.0398, 0.0575, 0.3186, 0.0445, 0.0447, 0.0919, 0.0307, 0.2245,
        0.0921])
[rfa agg] iter:  4, prev_obj_val: 63.73306655883789, obj_val: 70.1805648803711, abs dis: 6.447498321533203
[rfa agg] iter: 4, weight: tensor([0.0539, 0.0384, 0.0555, 0.3500, 0.0430, 0.0431, 0.0886, 0.0296, 0.2089,
        0.0889])
[rfa agg] iter:  5, prev_obj_val: 70.1805648803711, obj_val: 63.75597381591797, abs dis: 6.424591064453125
[rfa agg] iter: 5, weight: tensor([0.0583, 0.0440, 0.1001, 0.2426, 0.0481, 0.0483, 0.0849, 0.0351, 0.1479,
        0.1908])
[rfa agg] iter:  6, prev_obj_val: 63.75597381591797, obj_val: 66.86183166503906, abs dis: 3.1058578491210938
[rfa agg] iter: 6, weight: tensor([0.0560, 0.0399, 0.0579, 0.3265, 0.0446, 0.0448, 0.0922, 0.0308, 0.2137,
        0.0937])
[rfa agg] iter:  7, prev_obj_val: 66.86183166503906, obj_val: 60.912925720214844, abs dis: 5.948905944824219
[rfa agg] iter: 7, weight: tensor([0.0565, 0.0415, 0.0743, 0.3163, 0.0459, 0.0460, 0.0869, 0.0326, 0.1717,
        0.1284])
[rfa agg] iter:  8, prev_obj_val: 60.912925720214844, obj_val: 63.74249267578125, abs dis: 2.8295669555664062
[rfa agg] iter: 8, weight: tensor([0.0575, 0.0396, 0.0471, 0.2713, 0.0449, 0.0450, 0.1026, 0.0300, 0.2906,
        0.0714])
[rfa agg] iter:  9, prev_obj_val: 63.74249267578125, obj_val: 66.86245727539062, abs dis: 3.119964599609375
[rfa agg] iter: 9, weight: tensor([0.0550, 0.0392, 0.0566, 0.3314, 0.0439, 0.0440, 0.0905, 0.0302, 0.2187,
        0.0906])
			Update norm = 138.11522165614116 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3006, Accuracy: 38/10000 (0.3800%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.3549, Accuracy: 0/9950 (0.0000%)
saving model
Done in 400.00606966018677 sec.
Server Epoch:9 choose agents : [45, 99, 72, 16, 74, 61, 62, 90, 43, 25].
_Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   1, Avg loss: 0.0678, Accuracy: 190/669 (28.4006%)
_Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   2, Avg loss: 0.0411, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.8373, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0684, Accuracy: 175/773 (22.6391%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0336, Accuracy: 390/773 (50.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.0452, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   1, Avg loss: 0.0622, Accuracy: 241/1241 (19.4198%)
_Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 405/1241 (32.6350%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.0155, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   1, Avg loss: 0.0612, Accuracy: 283/708 (39.9718%)
_Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   2, Avg loss: 0.0402, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.8264, Accuracy: 53/10000 (0.5300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   1, Avg loss: 0.0437, Accuracy: 431/1552 (27.7706%)
_Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 777/1552 (50.0644%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 10.5424, Accuracy: 86/10000 (0.8600%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1265, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1167, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3067, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   1, Avg loss: 0.0672, Accuracy: 154/568 (27.1127%)
_Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.7790, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 316/677 (46.6765%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0235, Accuracy: 444/677 (65.5835%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.9877, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 301/946 (31.8182%)
_Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 327/946 (34.5666%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.0480, Accuracy: 55/10000 (0.5500%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   1, Avg loss: 0.0564, Accuracy: 309/690 (44.7826%)
_Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.1662, Accuracy: 52/10000 (0.5200%)
time spent on training: 158.86433815956116
[rfa agg] training data poison_ratio: 0.2942217726640536  data num: [669, 773, 1241, 708, 1552, 85, 568, 677, 946, 690]
[rfa agg] considering poison per batch poison_fraction: 0.09194430395751674
[rfa agg] init. name: [45, 99, 72, 16, 74, 61, 62, 90, 43, 25], weight: tensor([0.0846, 0.0977, 0.1569, 0.0895, 0.1962, 0.0107, 0.0718, 0.0856, 0.1196,
        0.0872])
[rfa agg] iter:  0, prev_obj_val: 43.5760612487793, obj_val: 46.19173812866211, abs dis: 2.6156768798828125
[rfa agg] iter: 0, weight: tensor([0.0941, 0.2742, 0.0523, 0.1711, 0.0383, 0.0022, 0.0415, 0.0959, 0.1325,
        0.0979])
[rfa agg] iter:  1, prev_obj_val: 46.19173812866211, obj_val: 54.56041717529297, abs dis: 8.36867904663086
[rfa agg] iter: 1, weight: tensor([0.1700, 0.1024, 0.0313, 0.1846, 0.0248, 0.0018, 0.0470, 0.1842, 0.0572,
        0.1967])
[rfa agg] iter:  2, prev_obj_val: 54.56041717529297, obj_val: 58.21372604370117, abs dis: 3.653308868408203
[rfa agg] iter: 2, weight: tensor([0.1753, 0.0766, 0.0379, 0.1039, 0.0317, 0.0030, 0.1430, 0.1827, 0.0575,
        0.1882])
[rfa agg] iter:  3, prev_obj_val: 58.21372604370117, obj_val: 58.20301818847656, abs dis: 0.010707855224609375
[rfa agg] iter: 3, weight: tensor([0.1438, 0.0748, 0.0409, 0.0951, 0.0347, 0.0036, 0.2483, 0.1484, 0.0593,
        0.1511])
[rfa agg] iter:  4, prev_obj_val: 58.20301818847656, obj_val: 58.20281219482422, abs dis: 0.00020599365234375
[rfa agg] iter: 4, weight: tensor([0.1408, 0.0735, 0.0403, 0.0933, 0.0342, 0.0036, 0.2626, 0.1458, 0.0583,
        0.1476])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.2998, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.3093, Accuracy: 0/9950 (0.0000%)
saving model
Done in 401.0958127975464 sec.
Server Epoch:10 choose agents : [84, 18, 67, 52, 95, 36, 68, 49, 61, 7].
_Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0634, Accuracy: 316/1190 (26.5546%)
_Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 463/1190 (38.9076%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.9782, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   1, Avg loss: 0.0758, Accuracy: 111/530 (20.9434%)
_Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   2, Avg loss: 0.0400, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.1357, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   1, Avg loss: 0.0791, Accuracy: 48/426 (11.2676%)
_Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   2, Avg loss: 0.0436, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.5825, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   1, Avg loss: 0.0579, Accuracy: 275/636 (43.2390%)
_Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   2, Avg loss: 0.0310, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.3402, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0508, Accuracy: 329/599 (54.9249%)
_Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0332, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.0191, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   1, Avg loss: 0.0876, Accuracy: 68/408 (16.6667%)
_Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   2, Avg loss: 0.0550, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.5063, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   1, Avg loss: 0.0622, Accuracy: 369/1163 (31.7283%)
_Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   2, Avg loss: 0.0374, Accuracy: 427/1163 (36.7154%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.6508, Accuracy: 57/10000 (0.5700%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 17/440 (3.8636%)
_Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   2, Avg loss: 0.0475, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.5469, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1263, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1164, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3092, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 348/891 (39.0572%)
_Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 445/891 (49.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.1450, Accuracy: 52/10000 (0.5200%)
time spent on training: 162.27651262283325
[rfa agg] training data poison_ratio: 0.1765075376884422  data num: [1190, 530, 426, 636, 599, 408, 1163, 440, 85, 891]
[rfa agg] considering poison per batch poison_fraction: 0.05515860552763819
[rfa agg] init. name: [84, 18, 67, 52, 95, 36, 68, 49, 61, 7], weight: tensor([0.1869, 0.0832, 0.0669, 0.0999, 0.0941, 0.0641, 0.1826, 0.0691, 0.0133,
        0.1399])
[rfa agg] iter:  0, prev_obj_val: 44.97064208984375, obj_val: 57.3490104675293, abs dis: 12.378368377685547
[rfa agg] iter: 0, weight: tensor([0.0410, 0.2038, 0.0533, 0.2445, 0.2435, 0.0512, 0.0401, 0.0553, 0.0035,
        0.0640])
[rfa agg] iter:  1, prev_obj_val: 57.3490104675293, obj_val: 60.87263870239258, abs dis: 3.5236282348632812
[rfa agg] iter: 1, weight: tensor([0.0338, 0.0873, 0.2141, 0.0712, 0.0674, 0.2059, 0.0330, 0.2389, 0.0051,
        0.0432])
[rfa agg] iter:  2, prev_obj_val: 60.87263870239258, obj_val: 54.060359954833984, abs dis: 6.812278747558594
[rfa agg] iter: 2, weight: tensor([0.0335, 0.0729, 0.2244, 0.0626, 0.0595, 0.2207, 0.0327, 0.2463, 0.0059,
        0.0416])
[rfa agg] iter:  3, prev_obj_val: 54.060359954833984, obj_val: 60.87468719482422, abs dis: 6.814327239990234
[rfa agg] iter: 3, weight: tensor([0.0328, 0.1045, 0.2051, 0.0773, 0.0740, 0.2021, 0.0321, 0.2244, 0.0045,
        0.0432])
[rfa agg] iter:  4, prev_obj_val: 60.87468719482422, obj_val: 54.06014633178711, abs dis: 6.814540863037109
[rfa agg] iter: 4, weight: tensor([0.0337, 0.0734, 0.2235, 0.0630, 0.0599, 0.2205, 0.0329, 0.2455, 0.0059,
        0.0418])
[rfa agg] iter:  5, prev_obj_val: 54.06014633178711, obj_val: 60.87470245361328, abs dis: 6.814556121826172
[rfa agg] iter: 5, weight: tensor([0.0328, 0.1046, 0.2051, 0.0773, 0.0741, 0.2020, 0.0321, 0.2243, 0.0045,
        0.0432])
[rfa agg] iter:  6, prev_obj_val: 60.87470245361328, obj_val: 54.060142517089844, abs dis: 6.8145599365234375
[rfa agg] iter: 6, weight: tensor([0.0337, 0.0734, 0.2234, 0.0630, 0.0599, 0.2205, 0.0329, 0.2455, 0.0059,
        0.0418])
[rfa agg] iter:  7, prev_obj_val: 54.060142517089844, obj_val: 60.87470245361328, abs dis: 6.8145599365234375
[rfa agg] iter: 7, weight: tensor([0.0328, 0.1046, 0.2050, 0.0773, 0.0741, 0.2020, 0.0321, 0.2243, 0.0045,
        0.0432])
[rfa agg] iter:  8, prev_obj_val: 60.87470245361328, obj_val: 54.060142517089844, abs dis: 6.8145599365234375
[rfa agg] iter: 8, weight: tensor([0.0337, 0.0734, 0.2234, 0.0630, 0.0599, 0.2205, 0.0329, 0.2455, 0.0059,
        0.0418])
[rfa agg] iter:  9, prev_obj_val: 54.060142517089844, obj_val: 60.87470245361328, abs dis: 6.8145599365234375
[rfa agg] iter: 9, weight: tensor([0.0328, 0.1046, 0.2050, 0.0773, 0.0741, 0.2020, 0.0321, 0.2243, 0.0045,
        0.0432])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 408.8816182613373 sec.
Server Epoch:11 choose agents : [29, 92, 35, 7, 25, 14, 74, 13, 32, 17].
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 405/1440 (28.1250%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 653/1440 (45.3472%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9120, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 473/1715 (27.5802%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 734/1715 (42.7988%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6743, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   1, Avg loss: 0.0860, Accuracy: 38/271 (14.0221%)
_Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   2, Avg loss: 0.0557, Accuracy: 102/271 (37.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3932, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   1, Avg loss: 0.0542, Accuracy: 340/891 (38.1594%)
_Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 461/891 (51.7396%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.9393, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0546, Accuracy: 316/690 (45.7971%)
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.6668, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0627, Accuracy: 220/1013 (21.7177%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 307/1013 (30.3060%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.7558, Accuracy: 59/10000 (0.5900%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 468/1552 (30.1546%)
_Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 764/1552 (49.2268%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 11.3741, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 330/1645 (20.0608%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 617/1645 (37.5076%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.0169, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0608, Accuracy: 204/735 (27.7551%)
_Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 343/735 (46.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.0031, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 365/1574 (23.1893%)
_Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0282, Accuracy: 642/1574 (40.7878%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1195, Accuracy: 100/10000 (1.0000%)
time spent on training: 164.6264111995697
[rfa agg] training data poison_ratio: 0.19451674475099776  data num: [1440, 1715, 271, 891, 690, 1013, 1552, 1645, 735, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.0607864827346868
[rfa agg] init. name: [29, 92, 35, 7, 25, 14, 74, 13, 32, 17], weight: tensor([0.1249, 0.1488, 0.0235, 0.0773, 0.0599, 0.0879, 0.1347, 0.1427, 0.0638,
        0.1366])
[rfa agg] iter:  0, prev_obj_val: 56.253273010253906, obj_val: 57.9140510559082, abs dis: 1.6607780456542969
[rfa agg] iter: 0, weight: tensor([0.1735, 0.1052, 0.0095, 0.0868, 0.0424, 0.1611, 0.1265, 0.1150, 0.0515,
        0.1283])
[rfa agg] iter:  1, prev_obj_val: 57.9140510559082, obj_val: 59.591651916503906, abs dis: 1.6776008605957031
[rfa agg] iter: 1, weight: tensor([0.1560, 0.0994, 0.0099, 0.0966, 0.0454, 0.1927, 0.1174, 0.1079, 0.0556,
        0.1191])
[rfa agg] iter:  2, prev_obj_val: 59.591651916503906, obj_val: 59.5899543762207, abs dis: 0.001697540283203125
[rfa agg] iter: 2, weight: tensor([0.1380, 0.0921, 0.0101, 0.1062, 0.0477, 0.2323, 0.1070, 0.0992, 0.0590,
        0.1085])
			Update norm = 165.81032673849057 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 413.00289607048035 sec.
Server Epoch:12 choose agents : [43, 94, 30, 38, 40, 20, 75, 61, 26, 17].
_Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   1, Avg loss: 0.0610, Accuracy: 310/946 (32.7696%)
_Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 362/946 (38.2664%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.0626, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 334/1662 (20.0963%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 639/1662 (38.4477%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8312, Accuracy: 104/10000 (1.0400%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0805, Accuracy: 65/486 (13.3745%)
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.9572, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   1, Avg loss: 0.0617, Accuracy: 258/1131 (22.8117%)
_Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 501/1131 (44.2971%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.4557, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 342/1573 (21.7419%)
_Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   2, Avg loss: 0.0353, Accuracy: 560/1573 (35.6008%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.4849, Accuracy: 55/10000 (0.5500%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   1, Avg loss: 0.0571, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   2, Avg loss: 0.0326, Accuracy: 404/807 (50.0620%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.9074, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   1, Avg loss: 0.0652, Accuracy: 237/776 (30.5412%)
_Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   2, Avg loss: 0.0311, Accuracy: 377/776 (48.5825%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.3401, Accuracy: 52/10000 (0.5200%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   2, Avg loss: 0.1185, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3113, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 324/1446 (22.4066%)
_Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 478/1446 (33.0567%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.1772, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 381/1574 (24.2058%)
_Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 669/1574 (42.5032%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.4528, Accuracy: 99/10000 (0.9900%)
time spent on training: 171.42519807815552
[rfa agg] training data poison_ratio: 0.1314133129887469  data num: [946, 1662, 486, 1131, 1573, 807, 776, 85, 1446, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.041066660308983406
[rfa agg] init. name: [43, 94, 30, 38, 40, 20, 75, 61, 26, 17], weight: tensor([0.0902, 0.1585, 0.0463, 0.1079, 0.1500, 0.0770, 0.0740, 0.0081, 0.1379,
        0.1501])
[rfa agg] iter:  0, prev_obj_val: 52.22505187988281, obj_val: 57.10022735595703, abs dis: 4.875175476074219
[rfa agg] iter: 0, weight: tensor([0.1081, 0.0730, 0.0171, 0.4312, 0.0788, 0.0562, 0.0542, 0.0019, 0.1005,
        0.0789])
[rfa agg] iter:  1, prev_obj_val: 57.10022735595703, obj_val: 57.0620231628418, abs dis: 0.038204193115234375
[rfa agg] iter: 1, weight: tensor([0.2196, 0.0692, 0.0226, 0.2790, 0.0731, 0.0885, 0.0853, 0.0023, 0.0874,
        0.0731])
[rfa agg] iter:  2, prev_obj_val: 57.0620231628418, obj_val: 58.902000427246094, abs dis: 1.8399772644042969
[rfa agg] iter: 2, weight: tensor([0.2288, 0.0692, 0.0226, 0.2683, 0.0732, 0.0890, 0.0860, 0.0023, 0.0875,
        0.0732])
[rfa agg] iter:  3, prev_obj_val: 58.902000427246094, obj_val: 58.89219665527344, abs dis: 0.00980377197265625
[rfa agg] iter: 3, weight: tensor([0.3018, 0.0634, 0.0232, 0.2027, 0.0667, 0.0990, 0.0958, 0.0023, 0.0784,
        0.0667])
[rfa agg] iter:  4, prev_obj_val: 58.89219665527344, obj_val: 58.89211654663086, abs dis: 8.0108642578125e-05
[rfa agg] iter: 4, weight: tensor([0.3100, 0.0629, 0.0230, 0.1983, 0.0661, 0.0982, 0.0953, 0.0023, 0.0777,
        0.0661])
			Update norm = 148.48139482566495 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 422.5947370529175 sec.
Server Epoch:13 choose agents : [42, 89, 83, 18, 67, 8, 21, 60, 56, 28].
_Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 348/1372 (25.3644%)
_Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 532/1372 (38.7755%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2885, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 319/896 (35.6027%)
_Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   2, Avg loss: 0.0339, Accuracy: 460/896 (51.3393%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.4075, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 448/1953 (22.9391%)
_Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 780/1953 (39.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.7005, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0745, Accuracy: 119/530 (22.4528%)
_Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0392, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.1002, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   1, Avg loss: 0.0770, Accuracy: 50/426 (11.7371%)
_Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   2, Avg loss: 0.0419, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.6677, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   1, Avg loss: 0.0606, Accuracy: 224/1513 (14.8050%)
_Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 461/1513 (30.4693%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.2909, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   1, Avg loss: 0.0542, Accuracy: 373/1949 (19.1380%)
_Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 599/1949 (30.7337%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2248, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 552/2227 (24.7867%)
_Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0285, Accuracy: 1003/2227 (45.0382%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 9.4443, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 64/186 (34.4086%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3220, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 414/1581 (26.1860%)
_Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   2, Avg loss: 0.0342, Accuracy: 565/1581 (35.7369%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.0738, Accuracy: 85/10000 (0.8500%)
time spent on training: 158.00166177749634
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 896, 1953, 530, 426, 1513, 1949, 2227, 186, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 89, 83, 18, 67, 8, 21, 60, 56, 28], weight: tensor([0.1086, 0.0709, 0.1546, 0.0420, 0.0337, 0.1198, 0.1543, 0.1763, 0.0147,
        0.1251])
[rfa agg] iter:  0, prev_obj_val: 65.2502212524414, obj_val: 65.04956817626953, abs dis: 0.200653076171875
[rfa agg] iter: 0, weight: tensor([0.2552, 0.0280, 0.0684, 0.0107, 0.0075, 0.3072, 0.0680, 0.0522, 0.0026,
        0.2001])
[rfa agg] iter:  1, prev_obj_val: 65.04956817626953, obj_val: 69.49063110351562, abs dis: 4.441062927246094
[rfa agg] iter: 1, weight: tensor([0.2643, 0.0264, 0.0643, 0.0101, 0.0071, 0.3208, 0.0639, 0.0491, 0.0025,
        0.1917])
[rfa agg] iter:  2, prev_obj_val: 69.49063110351562, obj_val: 72.02210235595703, abs dis: 2.5314712524414062
[rfa agg] iter: 2, weight: tensor([0.4205, 0.0322, 0.0623, 0.0118, 0.0082, 0.2051, 0.0619, 0.0494, 0.0028,
        0.1459])
[rfa agg] iter:  3, prev_obj_val: 72.02210235595703, obj_val: 69.39816284179688, abs dis: 2.6239395141601562
[rfa agg] iter: 3, weight: tensor([0.4652, 0.0358, 0.0615, 0.0127, 0.0088, 0.1714, 0.0612, 0.0495, 0.0030,
        0.1309])
[rfa agg] iter:  4, prev_obj_val: 69.39816284179688, obj_val: 69.39199829101562, abs dis: 0.00616455078125
[rfa agg] iter: 4, weight: tensor([0.5075, 0.0278, 0.0538, 0.0102, 0.0071, 0.1704, 0.0535, 0.0427, 0.0024,
        0.1245])
[rfa agg] iter:  5, prev_obj_val: 69.39199829101562, obj_val: 72.01791381835938, abs dis: 2.62591552734375
[rfa agg] iter: 5, weight: tensor([0.5281, 0.0267, 0.0517, 0.0098, 0.0068, 0.1629, 0.0514, 0.0410, 0.0023,
        0.1193])
[rfa agg] iter:  6, prev_obj_val: 72.01791381835938, obj_val: 72.01564025878906, abs dis: 0.0022735595703125
[rfa agg] iter: 6, weight: tensor([0.4994, 0.0336, 0.0578, 0.0120, 0.0083, 0.1593, 0.0576, 0.0466, 0.0028,
        0.1224])
[rfa agg] iter:  7, prev_obj_val: 72.01564025878906, obj_val: 72.01544952392578, abs dis: 0.00019073486328125
[rfa agg] iter: 7, weight: tensor([0.4907, 0.0342, 0.0588, 0.0122, 0.0084, 0.1622, 0.0585, 0.0474, 0.0029,
        0.1246])
			Update norm = 196.50518838570142 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 405.7222993373871 sec.
Server Epoch:14 choose agents : [82, 77, 78, 73, 40, 83, 97, 72, 98, 61].
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 70/500 (14.0000%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.8070, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 333/1340 (24.8507%)
_Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 550/1340 (41.0448%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.9112, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   1, Avg loss: 0.0838, Accuracy: 35/416 (8.4135%)
_Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   2, Avg loss: 0.0471, Accuracy: 178/416 (42.7885%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.6546, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   1, Avg loss: 0.0658, Accuracy: 177/938 (18.8699%)
_Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 326/938 (34.7548%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.1864, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   1, Avg loss: 0.0551, Accuracy: 368/1573 (23.3948%)
_Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 575/1573 (36.5544%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.3209, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 429/1953 (21.9662%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 771/1953 (39.4777%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.4873, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 358/1213 (29.5136%)
_Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 485/1213 (39.9835%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8201, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   1, Avg loss: 0.0619, Accuracy: 257/1241 (20.7091%)
_Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 414/1241 (33.3602%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.4614, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0809, Accuracy: 16/373 (4.2895%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 152/373 (40.7507%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.4857, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1255, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1173, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3107, Accuracy: 41/10000 (0.4100%)
time spent on training: 150.3368399143219
[rfa agg] training data poison_ratio: 0.008824750830564785  data num: [500, 1340, 416, 938, 1573, 1953, 1213, 1241, 373, 85]
[rfa agg] considering poison per batch poison_fraction: 0.002757734634551495
[rfa agg] init. name: [82, 77, 78, 73, 40, 83, 97, 72, 98, 61], weight: tensor([0.0519, 0.1391, 0.0432, 0.0974, 0.1633, 0.2028, 0.1259, 0.1288, 0.0387,
        0.0088])
[rfa agg] iter:  0, prev_obj_val: 59.04610824584961, obj_val: 58.91164779663086, abs dis: 0.13446044921875
[rfa agg] iter: 0, weight: tensor([0.0187, 0.1588, 0.0141, 0.1135, 0.0835, 0.0561, 0.3290, 0.2128, 0.0116,
        0.0020])
[rfa agg] iter:  1, prev_obj_val: 58.91164779663086, obj_val: 58.9106330871582, abs dis: 0.00101470947265625
[rfa agg] iter: 1, weight: tensor([0.0179, 0.1525, 0.0135, 0.1085, 0.0799, 0.0537, 0.3536, 0.2074, 0.0111,
        0.0019])
			Update norm = 165.86543868449507 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 398.8447976112366 sec.
Server Epoch:15 choose agents : [82, 75, 98, 92, 31, 50, 22, 78, 46, 37].
_Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   1, Avg loss: 0.0768, Accuracy: 69/500 (13.8000%)
_Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.7497, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0651, Accuracy: 247/776 (31.8299%)
_Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0278, Accuracy: 437/776 (56.3144%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.1116, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   1, Avg loss: 0.0816, Accuracy: 21/373 (5.6300%)
_Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   2, Avg loss: 0.0480, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.5176, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0526, Accuracy: 435/1715 (25.3644%)
_Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 699/1715 (40.7580%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.7692, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   1, Avg loss: 0.0821, Accuracy: 56/460 (12.1739%)
_Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   2, Avg loss: 0.0391, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.9212, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   1, Avg loss: 0.0638, Accuracy: 149/809 (18.4178%)
_Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 352/809 (43.5105%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.1781, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 508/1470 (34.5578%)
_Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 847/1470 (57.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.2294, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0841, Accuracy: 32/416 (7.6923%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0478, Accuracy: 161/416 (38.7019%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.6741, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   1, Avg loss: 0.0555, Accuracy: 414/1904 (21.7437%)
_Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 640/1904 (33.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.6457, Accuracy: 94/10000 (0.9400%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0517, Accuracy: 395/1129 (34.9867%)
_Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0249, Accuracy: 742/1129 (65.7219%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.3813, Accuracy: 108/10000 (1.0800%)
time spent on training: 149.26536417007446
[rfa agg] training data poison_ratio: 0.11819514237855946  data num: [500, 776, 373, 1715, 460, 809, 1470, 416, 1904, 1129]
[rfa agg] considering poison per batch poison_fraction: 0.03693598199329983
[rfa agg] init. name: [82, 75, 98, 92, 31, 50, 22, 78, 46, 37], weight: tensor([0.0523, 0.0812, 0.0390, 0.1795, 0.0482, 0.0847, 0.1539, 0.0436, 0.1993,
        0.1182])
[rfa agg] iter:  0, prev_obj_val: 69.95154571533203, obj_val: 72.30391693115234, abs dis: 2.3523712158203125
[rfa agg] iter: 0, weight: tensor([0.0236, 0.0767, 0.0145, 0.0809, 0.0217, 0.0798, 0.1186, 0.0178, 0.0684,
        0.4981])
[rfa agg] iter:  1, prev_obj_val: 72.30391693115234, obj_val: 74.97100830078125, abs dis: 2.6670913696289062
[rfa agg] iter: 1, weight: tensor([0.0312, 0.1151, 0.0189, 0.0868, 0.0287, 0.1202, 0.1193, 0.0233, 0.0751,
        0.3815])
[rfa agg] iter:  2, prev_obj_val: 74.97100830078125, obj_val: 76.31275177001953, abs dis: 1.3417434692382812
[rfa agg] iter: 2, weight: tensor([0.0382, 0.1712, 0.0225, 0.0856, 0.0352, 0.1786, 0.1121, 0.0281, 0.0756,
        0.2530])
[rfa agg] iter:  3, prev_obj_val: 76.31275177001953, obj_val: 77.68628692626953, abs dis: 1.37353515625
[rfa agg] iter: 3, weight: tensor([0.0395, 0.2047, 0.0229, 0.0792, 0.0364, 0.2131, 0.1015, 0.0288, 0.0705,
        0.2034])
[rfa agg] iter:  4, prev_obj_val: 77.68628692626953, obj_val: 80.60820007324219, abs dis: 2.9219131469726562
[rfa agg] iter: 4, weight: tensor([0.0389, 0.2427, 0.0222, 0.0697, 0.0358, 0.2522, 0.0876, 0.0281, 0.0625,
        0.1604])
[rfa agg] iter:  5, prev_obj_val: 80.60820007324219, obj_val: 82.37831115722656, abs dis: 1.770111083984375
[rfa agg] iter: 5, weight: tensor([0.0307, 0.3370, 0.0168, 0.0432, 0.0282, 0.3467, 0.0525, 0.0216, 0.0393,
        0.0841])
[rfa agg] iter:  6, prev_obj_val: 82.37831115722656, obj_val: 90.21300506591797, abs dis: 7.834693908691406
[rfa agg] iter: 6, weight: tensor([0.0261, 0.3745, 0.0139, 0.0323, 0.0240, 0.3841, 0.0387, 0.0181, 0.0296,
        0.0587])
[rfa agg] iter:  7, prev_obj_val: 90.21300506591797, obj_val: 82.41358184814453, abs dis: 7.7994232177734375
[rfa agg] iter: 7, weight: tensor([0.0719, 0.2524, 0.0344, 0.0571, 0.0663, 0.2628, 0.0659, 0.0469, 0.0532,
        0.0890])
[rfa agg] iter:  8, prev_obj_val: 82.41358184814453, obj_val: 90.2106704711914, abs dis: 7.797088623046875
[rfa agg] iter: 8, weight: tensor([0.0277, 0.3713, 0.0148, 0.0342, 0.0255, 0.3729, 0.0409, 0.0192, 0.0313,
        0.0622])
[rfa agg] iter:  9, prev_obj_val: 90.2106704711914, obj_val: 82.41364288330078, abs dis: 7.797027587890625
[rfa agg] iter: 9, weight: tensor([0.0719, 0.2526, 0.0345, 0.0571, 0.0663, 0.2625, 0.0659, 0.0470, 0.0532,
        0.0890])
			Update norm = 122.36614976935002 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 397.64116072654724 sec.
Server Epoch:16 choose agents : [28, 26, 83, 78, 93, 7, 76, 44, 70, 39].
_Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 381/1581 (24.0987%)
_Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 551/1581 (34.8514%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.6155, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   1, Avg loss: 0.0543, Accuracy: 328/1446 (22.6833%)
_Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   2, Avg loss: 0.0351, Accuracy: 492/1446 (34.0249%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.3780, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 397/1953 (20.3277%)
_Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 736/1953 (37.6856%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.6825, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   1, Avg loss: 0.0838, Accuracy: 42/416 (10.0962%)
_Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   2, Avg loss: 0.0461, Accuracy: 165/416 (39.6635%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.6191, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 417/1742 (23.9380%)
_Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 722/1742 (41.4466%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.0272, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   1, Avg loss: 0.0543, Accuracy: 350/891 (39.2817%)
_Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 460/891 (51.6274%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.3544, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0867, Accuracy: 41/466 (8.7983%)
_Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0491, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.7470, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 390/1750 (22.2857%)
_Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 689/1750 (39.3714%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.4632, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0559, Accuracy: 334/1418 (23.5543%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 648/1418 (45.6982%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.7269, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   1, Avg loss: 0.0554, Accuracy: 300/1013 (29.6150%)
_Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 465/1013 (45.9033%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.4520, Accuracy: 52/10000 (0.5200%)
time spent on training: 176.84773015975952
[rfa agg] training data poison_ratio: 0.1380561691385295  data num: [1581, 1446, 1953, 416, 1742, 891, 466, 1750, 1418, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.04314255285579047
[rfa agg] init. name: [28, 26, 83, 78, 93, 7, 76, 44, 70, 39], weight: tensor([0.1247, 0.1141, 0.1541, 0.0328, 0.1374, 0.0703, 0.0368, 0.1381, 0.1119,
        0.0799])
[rfa agg] iter:  0, prev_obj_val: 56.854957580566406, obj_val: 54.44416427612305, abs dis: 2.4107933044433594
[rfa agg] iter: 0, weight: tensor([0.1397, 0.2329, 0.0708, 0.0108, 0.0898, 0.0460, 0.0130, 0.0903, 0.2338,
        0.0729])
[rfa agg] iter:  1, prev_obj_val: 54.44416427612305, obj_val: 59.226383209228516, abs dis: 4.782218933105469
[rfa agg] iter: 1, weight: tensor([0.1369, 0.2576, 0.0643, 0.0090, 0.0834, 0.0371, 0.0108, 0.0839, 0.2595,
        0.0574])
[rfa agg] iter:  2, prev_obj_val: 59.226383209228516, obj_val: 56.81065368652344, abs dis: 2.415729522705078
[rfa agg] iter: 2, weight: tensor([0.1374, 0.2177, 0.0741, 0.0123, 0.0922, 0.0543, 0.0149, 0.0927, 0.2158,
        0.0886])
[rfa agg] iter:  3, prev_obj_val: 56.81065368652344, obj_val: 56.80963134765625, abs dis: 0.0010223388671875
[rfa agg] iter: 3, weight: tensor([0.1386, 0.2359, 0.0701, 0.0107, 0.0890, 0.0456, 0.0129, 0.0895, 0.2355,
        0.0722])
			Update norm = 192.11119420143118 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 423.7442219257355 sec.
Server Epoch:17 choose agents : [42, 34, 33, 94, 66, 75, 39, 27, 6, 51].
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 365/1372 (26.6035%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0305, Accuracy: 534/1372 (38.9213%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.9195, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0581, Accuracy: 374/1427 (26.2088%)
_Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 595/1427 (41.6959%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.9264, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0795, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0536, Accuracy: 115/515 (22.3301%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.8352, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 336/1662 (20.2166%)
_Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 606/1662 (36.4621%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7893, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   1, Avg loss: 0.0631, Accuracy: 251/1402 (17.9030%)
_Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   2, Avg loss: 0.0393, Accuracy: 354/1402 (25.2496%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.1307, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   1, Avg loss: 0.0655, Accuracy: 248/776 (31.9588%)
_Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   2, Avg loss: 0.0284, Accuracy: 427/776 (55.0258%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.0150, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   1, Avg loss: 0.0543, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 507/1013 (50.0494%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.4007, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 431/1587 (27.1582%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 624/1587 (39.3195%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.1734, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   1, Avg loss: 0.0551, Accuracy: 405/1956 (20.7055%)
_Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 664/1956 (33.9468%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.9507, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 225/1049 (21.4490%)
_Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 493/1049 (46.9971%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.5038, Accuracy: 71/10000 (0.7100%)
time spent on training: 165.61991453170776
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1427, 515, 1662, 1402, 776, 1013, 1587, 1956, 1049]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 34, 33, 94, 66, 75, 39, 27, 6, 51], weight: tensor([0.1075, 0.1118, 0.0404, 0.1303, 0.1099, 0.0608, 0.0794, 0.1244, 0.1533,
        0.0822])
[rfa agg] iter:  0, prev_obj_val: 50.414188385009766, obj_val: 50.389060974121094, abs dis: 0.025127410888671875
[rfa agg] iter: 0, weight: tensor([0.1705, 0.1323, 0.0164, 0.0850, 0.1764, 0.0398, 0.0945, 0.0955, 0.0569,
        0.1327])
			Update norm = 178.98407968657435 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 412.6926395893097 sec.
Server Epoch:18 choose agents : [90, 5, 3, 28, 2, 9, 92, 60, 86, 34].
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0561, Accuracy: 327/677 (48.3013%)
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0219, Accuracy: 456/677 (67.3560%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.2031, Accuracy: 56/10000 (0.5600%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   1, Avg loss: 0.0509, Accuracy: 387/1628 (23.7715%)
_Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 795/1628 (48.8329%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.4748, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0750, Accuracy: 102/781 (13.0602%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0359, Accuracy: 239/781 (30.6018%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.7696, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0566, Accuracy: 382/1581 (24.1619%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0342, Accuracy: 570/1581 (36.0531%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5383, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0618, Accuracy: 237/605 (39.1736%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0391, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.9107, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0505, Accuracy: 353/1275 (27.6863%)
_Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0193, Accuracy: 687/1275 (53.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.1926, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 444/1715 (25.8892%)
_Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 737/1715 (42.9738%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5369, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 563/2227 (25.2806%)
_Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   2, Avg loss: 0.0287, Accuracy: 990/2227 (44.4544%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.2710, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   1, Avg loss: 0.0633, Accuracy: 361/1003 (35.9920%)
_Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 368/1003 (36.6899%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.7169, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   1, Avg loss: 0.0584, Accuracy: 374/1427 (26.2088%)
_Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   2, Avg loss: 0.0328, Accuracy: 597/1427 (41.8360%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.8141, Accuracy: 77/10000 (0.7700%)
time spent on training: 177.13515543937683
[rfa agg] training data poison_ratio: 0.12601594550661815  data num: [677, 1628, 781, 1581, 605, 1275, 1715, 2227, 1003, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.03937998297081817
[rfa agg] init. name: [90, 5, 3, 28, 2, 9, 92, 60, 86, 34], weight: tensor([0.0524, 0.1260, 0.0605, 0.1224, 0.0468, 0.0987, 0.1328, 0.1724, 0.0776,
        0.1105])
[rfa agg] iter:  0, prev_obj_val: 58.28636169433594, obj_val: 62.932674407958984, abs dis: 4.646312713623047
[rfa agg] iter: 0, weight: tensor([0.0202, 0.1107, 0.0288, 0.1370, 0.0165, 0.2317, 0.0960, 0.0517, 0.0568,
        0.2505])
[rfa agg] iter:  1, prev_obj_val: 62.932674407958984, obj_val: 69.39557647705078, abs dis: 6.462902069091797
[rfa agg] iter: 1, weight: tensor([0.0209, 0.0745, 0.0310, 0.0867, 0.0168, 0.4646, 0.0674, 0.0413, 0.0686,
        0.1282])
[rfa agg] iter:  2, prev_obj_val: 69.39557647705078, obj_val: 69.37397766113281, abs dis: 0.02159881591796875
[rfa agg] iter: 2, weight: tensor([0.0347, 0.0830, 0.0544, 0.0930, 0.0274, 0.3109, 0.0772, 0.0521, 0.1474,
        0.1199])
			Update norm = 170.270493672935 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 424.32409167289734 sec.
Server Epoch:19 choose agents : [8, 20, 42, 21, 5, 25, 24, 71, 13, 18].
_Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   1, Avg loss: 0.0606, Accuracy: 235/1513 (15.5321%)
_Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 466/1513 (30.7997%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4941, Accuracy: 109/10000 (1.0900%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0579, Accuracy: 342/807 (42.3792%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0326, Accuracy: 404/807 (50.0620%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.1451, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 342/1372 (24.9271%)
_Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 497/1372 (36.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.7274, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 436/1949 (22.3704%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 611/1949 (31.3494%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.4472, Accuracy: 87/10000 (0.8700%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   1, Avg loss: 0.0516, Accuracy: 377/1628 (23.1572%)
_Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 790/1628 (48.5258%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.9007, Accuracy: 121/10000 (1.2100%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   1, Avg loss: 0.0561, Accuracy: 318/690 (46.0870%)
_Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   2, Avg loss: 0.0276, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.4931, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   1, Avg loss: 0.0753, Accuracy: 38/312 (12.1795%)
_Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   2, Avg loss: 0.0390, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.4466, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   1, Avg loss: 0.0653, Accuracy: 162/818 (19.8044%)
_Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 352/818 (43.0318%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4794, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 320/1645 (19.4529%)
_Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 633/1645 (38.4802%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.8306, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0750, Accuracy: 117/530 (22.0755%)
_Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0385, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.3350, Accuracy: 54/10000 (0.5400%)
time spent on training: 195.2334702014923
[rfa agg] training data poison_ratio: 0.2774325284090909  data num: [1513, 807, 1372, 1949, 1628, 690, 312, 818, 1645, 530]
[rfa agg] considering poison per batch poison_fraction: 0.0866976651278409
[rfa agg] init. name: [8, 20, 42, 21, 5, 25, 24, 71, 13, 18], weight: tensor([0.1343, 0.0716, 0.1218, 0.1730, 0.1445, 0.0613, 0.0277, 0.0726, 0.1460,
        0.0471])
[rfa agg] iter:  0, prev_obj_val: 66.51019287109375, obj_val: 68.42676544189453, abs dis: 1.9165725708007812
[rfa agg] iter: 0, weight: tensor([0.1658, 0.0744, 0.2446, 0.0906, 0.1287, 0.0481, 0.0124, 0.0757, 0.1301,
        0.0296])
[rfa agg] iter:  1, prev_obj_val: 68.42676544189453, obj_val: 66.49620819091797, abs dis: 1.9305572509765625
[rfa agg] iter: 1, weight: tensor([0.1590, 0.0850, 0.2243, 0.0913, 0.1263, 0.0538, 0.0135, 0.0866, 0.1276,
        0.0327])
[rfa agg] iter:  2, prev_obj_val: 66.49620819091797, obj_val: 68.42680358886719, abs dis: 1.9305953979492188
[rfa agg] iter: 2, weight: tensor([0.1657, 0.0743, 0.2460, 0.0903, 0.1284, 0.0480, 0.0124, 0.0756, 0.1298,
        0.0295])
[rfa agg] iter:  3, prev_obj_val: 68.42680358886719, obj_val: 66.49620819091797, abs dis: 1.9305953979492188
[rfa agg] iter: 3, weight: tensor([0.1590, 0.0850, 0.2243, 0.0913, 0.1263, 0.0538, 0.0135, 0.0866, 0.1276,
        0.0327])
[rfa agg] iter:  4, prev_obj_val: 66.49620819091797, obj_val: 68.42680358886719, abs dis: 1.9305953979492188
[rfa agg] iter: 4, weight: tensor([0.1657, 0.0743, 0.2460, 0.0903, 0.1284, 0.0480, 0.0124, 0.0756, 0.1298,
        0.0295])
[rfa agg] iter:  5, prev_obj_val: 68.42680358886719, obj_val: 66.49620819091797, abs dis: 1.9305953979492188
[rfa agg] iter: 5, weight: tensor([0.1590, 0.0850, 0.2243, 0.0913, 0.1263, 0.0538, 0.0135, 0.0866, 0.1276,
        0.0327])
[rfa agg] iter:  6, prev_obj_val: 66.49620819091797, obj_val: 68.42680358886719, abs dis: 1.9305953979492188
[rfa agg] iter: 6, weight: tensor([0.1657, 0.0743, 0.2460, 0.0903, 0.1284, 0.0480, 0.0124, 0.0756, 0.1298,
        0.0295])
[rfa agg] iter:  7, prev_obj_val: 68.42680358886719, obj_val: 66.49620819091797, abs dis: 1.9305953979492188
[rfa agg] iter: 7, weight: tensor([0.1590, 0.0850, 0.2243, 0.0913, 0.1263, 0.0538, 0.0135, 0.0866, 0.1276,
        0.0327])
[rfa agg] iter:  8, prev_obj_val: 66.49620819091797, obj_val: 68.42680358886719, abs dis: 1.9305953979492188
[rfa agg] iter: 8, weight: tensor([0.1657, 0.0743, 0.2460, 0.0903, 0.1284, 0.0480, 0.0124, 0.0756, 0.1298,
        0.0295])
[rfa agg] iter:  9, prev_obj_val: 68.42680358886719, obj_val: 66.49620819091797, abs dis: 1.9305953979492188
[rfa agg] iter: 9, weight: tensor([0.1590, 0.0850, 0.2243, 0.0913, 0.1263, 0.0538, 0.0135, 0.0866, 0.1276,
        0.0327])
			Update norm = 174.50385024405622 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 445.7095251083374 sec.
Server Epoch:20 choose agents : [89, 17, 66, 8, 76, 59, 83, 62, 70, 12].
_Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 333/896 (37.1652%)
_Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 467/896 (52.1205%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.3151, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   1, Avg loss: 0.0522, Accuracy: 365/1574 (23.1893%)
_Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   2, Avg loss: 0.0283, Accuracy: 644/1574 (40.9149%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.2488, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 259/1402 (18.4736%)
_Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 385/1402 (27.4608%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.0827, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   1, Avg loss: 0.0606, Accuracy: 242/1513 (15.9947%)
_Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   2, Avg loss: 0.0373, Accuracy: 460/1513 (30.4032%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.3745, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0502, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.7320, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0532, Accuracy: 312/1089 (28.6501%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0295, Accuracy: 469/1089 (43.0670%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.0121, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 400/1953 (20.4813%)
_Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 702/1953 (35.9447%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.9771, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   1, Avg loss: 0.0657, Accuracy: 158/568 (27.8169%)
_Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   2, Avg loss: 0.0392, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.7992, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0562, Accuracy: 324/1418 (22.8491%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0316, Accuracy: 621/1418 (43.7941%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.5257, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   1, Avg loss: 0.0877, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   2, Avg loss: 0.0489, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.4878, Accuracy: 50/10000 (0.5000%)
time spent on training: 167.63746762275696
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1574, 1402, 1513, 466, 1089, 1953, 568, 1418, 338]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 17, 66, 8, 76, 59, 83, 62, 70, 12], weight: tensor([0.0799, 0.1403, 0.1250, 0.1349, 0.0415, 0.0971, 0.1741, 0.0506, 0.1264,
        0.0301])
[rfa agg] iter:  0, prev_obj_val: 57.722023010253906, obj_val: 59.54579544067383, abs dis: 1.8237724304199219
[rfa agg] iter: 0, weight: tensor([0.0689, 0.1013, 0.1747, 0.1166, 0.0165, 0.2904, 0.0635, 0.0222, 0.1357,
        0.0101])
[rfa agg] iter:  1, prev_obj_val: 59.54579544067383, obj_val: 59.5218505859375, abs dis: 0.023944854736328125
[rfa agg] iter: 1, weight: tensor([0.0698, 0.0857, 0.1391, 0.0971, 0.0158, 0.3951, 0.0557, 0.0213, 0.1107,
        0.0096])
[rfa agg] iter:  2, prev_obj_val: 59.5218505859375, obj_val: 61.56936264038086, abs dis: 2.0475120544433594
[rfa agg] iter: 2, weight: tensor([0.0666, 0.0817, 0.1322, 0.0925, 0.0151, 0.4238, 0.0532, 0.0204, 0.1054,
        0.0092])
[rfa agg] iter:  3, prev_obj_val: 61.56936264038086, obj_val: 66.45401000976562, abs dis: 4.884647369384766
[rfa agg] iter: 3, weight: tensor([0.0685, 0.0700, 0.1073, 0.0783, 0.0146, 0.4980, 0.0471, 0.0198, 0.0876,
        0.0088])
[rfa agg] iter:  4, prev_obj_val: 66.45401000976562, obj_val: 63.91621780395508, abs dis: 2.537792205810547
[rfa agg] iter: 4, weight: tensor([0.1166, 0.0803, 0.1133, 0.0881, 0.0212, 0.3855, 0.0573, 0.0291, 0.0960,
        0.0126])
[rfa agg] iter:  5, prev_obj_val: 63.91621780395508, obj_val: 63.908748626708984, abs dis: 0.00746917724609375
[rfa agg] iter: 5, weight: tensor([0.0895, 0.0751, 0.1101, 0.0832, 0.0176, 0.4460, 0.0521, 0.0240, 0.0918,
        0.0106])
[rfa agg] iter:  6, prev_obj_val: 63.908748626708984, obj_val: 63.90816116333008, abs dis: 0.00058746337890625
[rfa agg] iter: 6, weight: tensor([0.0866, 0.0729, 0.1068, 0.0807, 0.0171, 0.4628, 0.0506, 0.0233, 0.0890,
        0.0103])
			Update norm = 161.54343456173018 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 415.92759370803833 sec.
Server Epoch:21 choose agents : [0, 21, 31, 56, 90, 65, 87, 37, 77, 26].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 374/1657 (22.5709%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0354, Accuracy: 545/1657 (32.8908%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0322, Accuracy: 611/1657 (36.8739%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0316, Accuracy: 625/1657 (37.7188%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0308, Accuracy: 638/1657 (38.5033%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0305, Accuracy: 674/1657 (40.6759%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0296, Accuracy: 698/1657 (42.1243%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0290, Accuracy: 723/1657 (43.6331%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0288, Accuracy: 739/1657 (44.5987%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0285, Accuracy: 733/1657 (44.2366%), train_poison_data_count: 520
Global model norm: 112.05412074779981.
Norm before scaling: 112.02737092308067. Distance: 1.19296133142749
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7224, Accuracy: 63/10000 (0.6300%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.9658, Accuracy: 9249/9950 (92.9548%)
Scaling by  100
Scaled Norm after poisoning: 161.3879315597204, distance: 119.29612495671223
Total norm for 3 adversaries is: 161.3879315597204. distance: 119.29612495671223
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 391/1949 (20.0616%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 624/1949 (32.0164%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.6474, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   1, Avg loss: 0.0829, Accuracy: 49/460 (10.6522%)
_Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   2, Avg loss: 0.0380, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.8571, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   2, Avg loss: 0.0680, Accuracy: 64/186 (34.4086%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3225, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   1, Avg loss: 0.0556, Accuracy: 330/677 (48.7445%)
_Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 441/677 (65.1403%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.2652, Accuracy: 55/10000 (0.5500%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0564, Accuracy: 363/1475 (24.6102%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0329, Accuracy: 644/1475 (43.6610%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.9145, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   1, Avg loss: 0.0582, Accuracy: 301/1131 (26.6136%)
_Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 411/1131 (36.3395%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7593, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 403/1129 (35.6953%)
_Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 723/1129 (64.0390%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.5423, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0545, Accuracy: 320/1340 (23.8806%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 524/1340 (39.1045%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8204, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 315/1446 (21.7842%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0353, Accuracy: 468/1446 (32.3651%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.1489, Accuracy: 50/10000 (0.5000%)
time spent on training: 296.2064208984375
[rfa agg] training data poison_ratio: 0.3721397379912664  data num: [1657, 1949, 460, 186, 677, 1475, 1131, 1129, 1340, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.11629366812227074
[rfa agg] init. name: [0, 21, 31, 56, 90, 65, 87, 37, 77, 26], weight: tensor([0.1447, 0.1702, 0.0402, 0.0162, 0.0591, 0.1288, 0.0988, 0.0986, 0.1170,
        0.1263])
[rfa agg] iter:  0, prev_obj_val: 28737.953125, obj_val: 19093.6796875, abs dis: 9644.2734375
[rfa agg] iter: 0, weight: tensor([0.0278, 0.1945, 0.0453, 0.0183, 0.0668, 0.1466, 0.1121, 0.1119, 0.1330,
        0.1437])
[rfa agg] iter:  1, prev_obj_val: 19093.6796875, obj_val: 17192.2265625, abs dis: 1901.453125
[rfa agg] iter: 1, weight: tensor([0.0048, 0.2034, 0.0450, 0.0180, 0.0668, 0.1509, 0.1138, 0.1136, 0.1360,
        0.1476])
[rfa agg] iter:  2, prev_obj_val: 17192.2265625, obj_val: 16866.77734375, abs dis: 325.44921875
[rfa agg] iter: 2, weight: tensor([0.0008, 0.2337, 0.0379, 0.0143, 0.0582, 0.1554, 0.1079, 0.1077, 0.1342,
        0.1498])
[rfa agg] iter:  3, prev_obj_val: 16866.77734375, obj_val: 16852.337890625, abs dis: 14.439453125
[rfa agg] iter: 3, weight: tensor([6.4453e-05, 5.4445e-01, 1.0784e-02, 3.5260e-03, 1.8452e-02, 1.3351e-01,
        4.9502e-02, 4.9369e-02, 7.9057e-02, 1.1129e-01])
[rfa agg] iter:  4, prev_obj_val: 16852.337890625, obj_val: 16848.7265625, abs dis: 3.611328125
[rfa agg] iter: 4, weight: tensor([4.7617e-05, 1.2065e-01, 1.0073e-02, 3.1356e-03, 1.8002e-02, 3.6818e-01,
        5.9672e-02, 5.9404e-02, 1.2004e-01, 2.4079e-01])
[rfa agg] iter:  5, prev_obj_val: 16848.7265625, obj_val: 16852.244140625, abs dis: 3.517578125
[rfa agg] iter: 5, weight: tensor([3.1876e-05, 5.6771e-02, 7.9030e-03, 2.3644e-03, 1.4667e-02, 2.2365e-01,
        6.1511e-02, 6.1003e-02, 1.8630e-01, 3.8579e-01])
[rfa agg] iter:  6, prev_obj_val: 16852.244140625, obj_val: 16857.11328125, abs dis: 4.869140625
[rfa agg] iter: 6, weight: tensor([3.7884e-05, 5.4763e-02, 1.0888e-02, 3.1262e-03, 2.1083e-02, 1.2171e-01,
        1.2606e-01, 1.2348e-01, 3.7252e-01, 1.6634e-01])
[rfa agg] iter:  7, prev_obj_val: 16857.11328125, obj_val: 16857.0234375, abs dis: 0.08984375
[rfa agg] iter: 7, weight: tensor([3.9588e-05, 5.0156e-02, 1.2926e-02, 3.5678e-03, 2.6131e-02, 9.0007e-02,
        2.6471e-01, 2.4659e-01, 1.9638e-01, 1.0949e-01])
[rfa agg] iter:  8, prev_obj_val: 16857.0234375, obj_val: 16861.162109375, abs dis: 4.138671875
[rfa agg] iter: 8, weight: tensor([3.8387e-05, 4.8650e-02, 1.2533e-02, 3.4603e-03, 2.5348e-02, 8.7163e-02,
        2.7484e-01, 2.5803e-01, 1.8380e-01, 1.0613e-01])
[rfa agg] iter:  9, prev_obj_val: 16861.162109375, obj_val: 16863.919921875, abs dis: 2.7578125
[rfa agg] iter: 9, weight: tensor([3.0681e-05, 3.5920e-02, 1.1010e-02, 2.9459e-03, 2.3123e-02, 5.8372e-02,
        3.7595e-01, 3.2146e-01, 1.0273e-01, 6.8457e-02])
			Update norm = 161.68031246104147 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 557.4570686817169 sec.
Server Epoch:22 choose agents : [13, 26, 58, 22, 88, 2, 65, 9, 90, 64].
_Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 308/1645 (18.7234%)
_Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 592/1645 (35.9878%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.9401, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 358/1446 (24.7580%)
_Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   2, Avg loss: 0.0353, Accuracy: 449/1446 (31.0512%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.2087, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0579, Accuracy: 355/803 (44.2092%)
_Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 381/803 (47.4471%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.1009, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 488/1470 (33.1973%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 863/1470 (58.7075%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.0290, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   1, Avg loss: 0.0744, Accuracy: 133/603 (22.0564%)
_Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   2, Avg loss: 0.0467, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.8525, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0616, Accuracy: 236/605 (39.0083%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.0935, Accuracy: 54/10000 (0.5400%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   1, Avg loss: 0.0574, Accuracy: 388/1475 (26.3051%)
_Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 639/1475 (43.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.0643, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   1, Avg loss: 0.0502, Accuracy: 340/1275 (26.6667%)
_Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   2, Avg loss: 0.0193, Accuracy: 724/1275 (56.7843%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.4174, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   1, Avg loss: 0.0547, Accuracy: 329/677 (48.5968%)
_Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 461/677 (68.0945%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4709, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   1, Avg loss: 0.0651, Accuracy: 166/953 (17.4187%)
_Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 313/953 (32.8437%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.3587, Accuracy: 61/10000 (0.6100%)
time spent on training: 173.85515689849854
[rfa agg] training data poison_ratio: 0.13467859751643535  data num: [1645, 1446, 803, 1470, 603, 605, 1475, 1275, 677, 953]
[rfa agg] considering poison per batch poison_fraction: 0.04208706172388604
[rfa agg] init. name: [13, 26, 58, 22, 88, 2, 65, 9, 90, 64], weight: tensor([0.1502, 0.1320, 0.0733, 0.1342, 0.0551, 0.0552, 0.1347, 0.1164, 0.0618,
        0.0870])
[rfa agg] iter:  0, prev_obj_val: 51.572505950927734, obj_val: 54.54062271118164, abs dis: 2.9681167602539062
[rfa agg] iter: 0, weight: tensor([0.0864, 0.1164, 0.0793, 0.1184, 0.0360, 0.0361, 0.1007, 0.2178, 0.0466,
        0.1624])
[rfa agg] iter:  1, prev_obj_val: 54.54062271118164, obj_val: 57.64950180053711, abs dis: 3.1088790893554688
[rfa agg] iter: 1, weight: tensor([0.0761, 0.0972, 0.0994, 0.0988, 0.0407, 0.0408, 0.0860, 0.1576, 0.0540,
        0.2494])
[rfa agg] iter:  2, prev_obj_val: 57.64950180053711, obj_val: 61.40066146850586, abs dis: 3.75115966796875
[rfa agg] iter: 2, weight: tensor([0.0559, 0.0685, 0.1110, 0.0697, 0.0389, 0.0390, 0.0617, 0.1000, 0.0534,
        0.4019])
[rfa agg] iter:  3, prev_obj_val: 61.40066146850586, obj_val: 65.96546936035156, abs dis: 4.564807891845703
[rfa agg] iter: 3, weight: tensor([0.0460, 0.0546, 0.1560, 0.0555, 0.0427, 0.0428, 0.0498, 0.0740, 0.0614,
        0.4171])
[rfa agg] iter:  4, prev_obj_val: 65.96546936035156, obj_val: 65.897705078125, abs dis: 0.0677642822265625
[rfa agg] iter: 4, weight: tensor([0.0451, 0.0521, 0.3230, 0.0529, 0.0580, 0.0580, 0.0480, 0.0668, 0.0900,
        0.2061])
[rfa agg] iter:  5, prev_obj_val: 65.897705078125, obj_val: 65.89579772949219, abs dis: 0.0019073486328125
[rfa agg] iter: 5, weight: tensor([0.0427, 0.0493, 0.3675, 0.0501, 0.0549, 0.0552, 0.0455, 0.0633, 0.0859,
        0.1857])
[rfa agg] iter:  6, prev_obj_val: 65.89579772949219, obj_val: 65.89572143554688, abs dis: 7.62939453125e-05
[rfa agg] iter: 6, weight: tensor([0.0422, 0.0487, 0.3762, 0.0495, 0.0542, 0.0545, 0.0449, 0.0625, 0.0848,
        0.1823])
			Update norm = 126.85932015179256 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 420.7142119407654 sec.
Server Epoch:23 choose agents : [20, 11, 63, 44, 2, 74, 26, 89, 3, 6].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0605, Accuracy: 232/807 (28.7485%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0367, Accuracy: 322/807 (39.9009%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0301, Accuracy: 361/807 (44.7336%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0300, Accuracy: 372/807 (46.0967%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0294, Accuracy: 397/807 (49.1945%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0278, Accuracy: 394/807 (48.8228%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0273, Accuracy: 407/807 (50.4337%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0272, Accuracy: 404/807 (50.0620%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0266, Accuracy: 407/807 (50.4337%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0268, Accuracy: 406/807 (50.3098%), train_poison_data_count: 260
Global model norm: 112.05412074779981.
Norm before scaling: 112.04305202828286. Distance: 0.8498610901926523
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.2826, Accuracy: 72/10000 (0.7200%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.9196, Accuracy: 8955/9950 (90.0000%)
Scaling by  100
Scaled Norm after poisoning: 139.4944415335249, distance: 84.98610869945158
Total norm for 3 adversaries is: 139.4944415335249. distance: 84.98610869945158
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   1, Avg loss: 0.0527, Accuracy: 347/712 (48.7360%)
_Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 433/712 (60.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.5081, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 252/888 (28.3784%)
_Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 454/888 (51.1261%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.1196, Accuracy: 54/10000 (0.5400%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   1, Avg loss: 0.0600, Accuracy: 380/1750 (21.7143%)
_Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 662/1750 (37.8286%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.3478, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 227/605 (37.5207%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0383, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.9451, Accuracy: 56/10000 (0.5600%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 480/1552 (30.9278%)
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 785/1552 (50.5799%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.4180, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 339/1446 (23.4440%)
_Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   2, Avg loss: 0.0351, Accuracy: 457/1446 (31.6044%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.1899, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   1, Avg loss: 0.0616, Accuracy: 330/896 (36.8304%)
_Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 443/896 (49.4420%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.2443, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0756, Accuracy: 100/781 (12.8041%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0364, Accuracy: 215/781 (27.5288%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.6848, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 408/1956 (20.8589%)
_Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 647/1956 (33.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.1167, Accuracy: 119/10000 (1.1900%)
time spent on training: 298.5833444595337
[rfa agg] training data poison_ratio: 0.3606600544193803  data num: [807, 712, 888, 1750, 605, 1552, 1446, 896, 781, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.11270626700605635
[rfa agg] init. name: [20, 11, 63, 44, 2, 74, 26, 89, 3, 6], weight: tensor([0.0708, 0.0625, 0.0779, 0.1536, 0.0531, 0.1362, 0.1269, 0.0786, 0.0686,
        0.1717])
[rfa agg] iter:  0, prev_obj_val: 7625.1494140625, obj_val: 4385.10400390625, abs dis: 3240.04541015625
[rfa agg] iter: 0, weight: tensor([0.0057, 0.0654, 0.0820, 0.1666, 0.0554, 0.1467, 0.1361, 0.0827, 0.0719,
        0.1874])
[rfa agg] iter:  1, prev_obj_val: 4385.10400390625, obj_val: 4168.0458984375, abs dis: 217.05810546875
[rfa agg] iter: 1, weight: tensor([0.0004, 0.0504, 0.0657, 0.1917, 0.0410, 0.1541, 0.1352, 0.0663, 0.0565,
        0.2387])
[rfa agg] iter:  2, prev_obj_val: 4168.0458984375, obj_val: 4174.11669921875, abs dis: 6.07080078125
[rfa agg] iter: 2, weight: tensor([3.8193e-05, 1.9819e-02, 3.0154e-02, 1.0538e-01, 1.4265e-02, 2.1442e-01,
        4.8701e-01, 3.0359e-02, 2.3907e-02, 7.4649e-02])
[rfa agg] iter:  3, prev_obj_val: 4174.11669921875, obj_val: 4172.70751953125, abs dis: 1.4091796875
[rfa agg] iter: 3, weight: tensor([6.7774e-05, 4.5389e-02, 7.3691e-02, 1.2568e-01, 3.1324e-02, 1.8421e-01,
        3.0821e-01, 7.4064e-02, 5.6362e-02, 1.0101e-01])
[rfa agg] iter:  4, prev_obj_val: 4172.70751953125, obj_val: 4176.8974609375, abs dis: 4.18994140625
[rfa agg] iter: 4, weight: tensor([6.2603e-05, 3.9668e-02, 6.3411e-02, 1.2436e-01, 2.7638e-02, 1.9054e-01,
        3.4363e-01, 6.3782e-02, 4.8923e-02, 9.7982e-02])
[rfa agg] iter:  5, prev_obj_val: 4176.8974609375, obj_val: 4179.72216796875, abs dis: 2.82470703125
[rfa agg] iter: 5, weight: tensor([7.5120e-05, 5.6993e-02, 9.6340e-02, 1.2341e-01, 3.8370e-02, 1.6831e-01,
        2.4535e-01, 9.6710e-02, 7.2039e-02, 1.0240e-01])
[rfa agg] iter:  6, prev_obj_val: 4179.72216796875, obj_val: 4178.30126953125, abs dis: 1.4208984375
[rfa agg] iter: 6, weight: tensor([7.7605e-05, 6.7862e-02, 1.2115e-01, 1.1431e-01, 4.4286e-02, 1.4770e-01,
        1.9799e-01, 1.2140e-01, 8.7809e-02, 9.7417e-02])
[rfa agg] iter:  7, prev_obj_val: 4178.30126953125, obj_val: 4176.8896484375, abs dis: 1.41162109375
[rfa agg] iter: 7, weight: tensor([7.6970e-05, 6.2601e-02, 1.0861e-01, 1.1956e-01, 4.1507e-02, 1.5834e-01,
        2.1966e-01, 1.0902e-01, 8.0017e-02, 1.0060e-01])
[rfa agg] iter:  8, prev_obj_val: 4176.8896484375, obj_val: 4179.72216796875, abs dis: 2.83251953125
[rfa agg] iter: 8, weight: tensor([7.5188e-05, 5.7108e-02, 9.6623e-02, 1.2355e-01, 3.8420e-02, 1.6839e-01,
        2.4407e-01, 9.7050e-02, 7.2211e-02, 1.0251e-01])
[rfa agg] iter:  9, prev_obj_val: 4179.72216796875, obj_val: 4178.30126953125, abs dis: 1.4208984375
[rfa agg] iter: 9, weight: tensor([7.7605e-05, 6.7862e-02, 1.2116e-01, 1.1431e-01, 4.4286e-02, 1.4770e-01,
        1.9798e-01, 1.2140e-01, 8.7810e-02, 9.7417e-02])
			Update norm = 174.55610554883205 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 547.3884789943695 sec.
Server Epoch:24 choose agents : [75, 96, 99, 97, 17, 80, 3, 13, 60, 83].
_Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 250/776 (32.2165%)
_Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   2, Avg loss: 0.0289, Accuracy: 411/776 (52.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.8803, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3715, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   1, Avg loss: 0.0686, Accuracy: 178/773 (23.0272%)
_Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   2, Avg loss: 0.0324, Accuracy: 427/773 (55.2393%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.0553, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   1, Avg loss: 0.0523, Accuracy: 361/1213 (29.7609%)
_Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   2, Avg loss: 0.0279, Accuracy: 446/1213 (36.7683%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.8533, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 371/1574 (23.5705%)
_Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 681/1574 (43.2656%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.0466, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   1, Avg loss: 0.0717, Accuracy: 129/682 (18.9150%)
_Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 247/682 (36.2170%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5669, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0743, Accuracy: 116/781 (14.8528%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0359, Accuracy: 235/781 (30.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.7469, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 319/1645 (19.3921%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 607/1645 (36.8997%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.8531, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 579/2227 (25.9991%)
_Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1018/2227 (45.7117%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.9705, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 463/1953 (23.7071%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 774/1953 (39.6313%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.9853, Accuracy: 99/10000 (0.9900%)
time spent on training: 172.6180305480957
[rfa agg] training data poison_ratio: 0.0  data num: [776, 311, 773, 1213, 1574, 682, 781, 1645, 2227, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 96, 99, 97, 17, 80, 3, 13, 60, 83], weight: tensor([0.0650, 0.0261, 0.0648, 0.1016, 0.1319, 0.0571, 0.0654, 0.1378, 0.1866,
        0.1636])
[rfa agg] iter:  0, prev_obj_val: 73.14315032958984, obj_val: 74.18464660644531, abs dis: 1.0414962768554688
[rfa agg] iter: 0, weight: tensor([0.0462, 0.0095, 0.0460, 0.2290, 0.2206, 0.0329, 0.0465, 0.1816, 0.0836,
        0.1040])
[rfa agg] iter:  1, prev_obj_val: 74.18464660644531, obj_val: 75.27288818359375, abs dis: 1.0882415771484375
[rfa agg] iter: 1, weight: tensor([0.0485, 0.0097, 0.0482, 0.2786, 0.1927, 0.0341, 0.0487, 0.1624, 0.0796,
        0.0975])
[rfa agg] iter:  2, prev_obj_val: 75.27288818359375, obj_val: 76.38494110107422, abs dis: 1.1120529174804688
[rfa agg] iter: 2, weight: tensor([0.0494, 0.0096, 0.0491, 0.3405, 0.1642, 0.0343, 0.0496, 0.1413, 0.0734,
        0.0887])
[rfa agg] iter:  3, prev_obj_val: 76.38494110107422, obj_val: 77.54478454589844, abs dis: 1.1598434448242188
[rfa agg] iter: 3, weight: tensor([0.0478, 0.0089, 0.0475, 0.4227, 0.1340, 0.0327, 0.0480, 0.1174, 0.0642,
        0.0766])
[rfa agg] iter:  4, prev_obj_val: 77.54478454589844, obj_val: 78.8504867553711, abs dis: 1.3057022094726562
[rfa agg] iter: 4, weight: tensor([0.0425, 0.0076, 0.0422, 0.5338, 0.1008, 0.0286, 0.0427, 0.0897, 0.0514,
        0.0606])
[rfa agg] iter:  5, prev_obj_val: 78.8504867553711, obj_val: 86.41252136230469, abs dis: 7.562034606933594
[rfa agg] iter: 5, weight: tensor([0.0353, 0.0061, 0.0350, 0.6472, 0.0709, 0.0233, 0.0354, 0.0639, 0.0382,
        0.0446])
[rfa agg] iter:  6, prev_obj_val: 86.41252136230469, obj_val: 84.3681411743164, abs dis: 2.0443801879882812
[rfa agg] iter: 6, weight: tensor([0.0977, 0.0133, 0.0964, 0.3073, 0.1003, 0.0580, 0.0980, 0.0936, 0.0637,
        0.0717])
[rfa agg] iter:  7, prev_obj_val: 84.3681411743164, obj_val: 80.59394836425781, abs dis: 3.7741928100585938
[rfa agg] iter: 7, weight: tensor([0.0837, 0.0121, 0.0830, 0.3561, 0.1021, 0.0512, 0.0841, 0.0944, 0.0624,
        0.0708])
[rfa agg] iter:  8, prev_obj_val: 80.59394836425781, obj_val: 82.44256591796875, abs dis: 1.8486175537109375
[rfa agg] iter: 8, weight: tensor([0.0519, 0.0085, 0.0515, 0.5257, 0.0886, 0.0335, 0.0521, 0.0806, 0.0499,
        0.0577])
[rfa agg] iter:  9, prev_obj_val: 82.44256591796875, obj_val: 86.33567810058594, abs dis: 3.8931121826171875
[rfa agg] iter: 9, weight: tensor([0.0648, 0.0101, 0.0643, 0.4560, 0.0939, 0.0409, 0.0651, 0.0863, 0.0553,
        0.0633])
			Update norm = 157.08757385412443 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 428.0869314670563 sec.
Server Epoch:25 choose agents : [74, 18, 82, 53, 32, 64, 95, 19, 44, 38].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0482, Accuracy: 386/1552 (24.8711%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0247, Accuracy: 603/1552 (38.8531%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Avg loss: 0.0231, Accuracy: 634/1552 (40.8505%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Avg loss: 0.0225, Accuracy: 703/1552 (45.2964%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Avg loss: 0.0221, Accuracy: 737/1552 (47.4871%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Avg loss: 0.0216, Accuracy: 756/1552 (48.7113%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Avg loss: 0.0210, Accuracy: 800/1552 (51.5464%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Avg loss: 0.0209, Accuracy: 799/1552 (51.4820%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Avg loss: 0.0209, Accuracy: 815/1552 (52.5129%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Avg loss: 0.0206, Accuracy: 814/1552 (52.4485%), train_poison_data_count: 496
Global model norm: 112.05412074779981.
Norm before scaling: 112.03015602673683. Distance: 1.2240373410095253
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.0355, Accuracy: 82/10000 (0.8200%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 1.0761, Accuracy: 6554/9950 (65.8693%)
Scaling by  100
Scaled Norm after poisoning: 163.8665436891405, distance: 122.40373290110477
Total norm for 3 adversaries is: 163.8665436891405. distance: 122.40373290110477
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   1, Avg loss: 0.0749, Accuracy: 122/530 (23.0189%)
_Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   2, Avg loss: 0.0375, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.1780, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   1, Avg loss: 0.0767, Accuracy: 64/500 (12.8000%)
_Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   2, Avg loss: 0.0499, Accuracy: 167/500 (33.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.8197, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0504, Accuracy: 286/813 (35.1784%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.5597, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0605, Accuracy: 209/735 (28.4354%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 362/735 (49.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9463, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 171/953 (17.9433%)
_Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 336/953 (35.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.5849, Accuracy: 74/10000 (0.7400%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0529, Accuracy: 335/599 (55.9265%)
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0275, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8956, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 413/1036 (39.8649%)
_Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 664/1036 (64.0927%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.3355, Accuracy: 54/10000 (0.5400%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 399/1750 (22.8000%)
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 683/1750 (39.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7361, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   1, Avg loss: 0.0620, Accuracy: 247/1131 (21.8391%)
_Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   2, Avg loss: 0.0308, Accuracy: 494/1131 (43.6782%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.2792, Accuracy: 79/10000 (0.7900%)
time spent on training: 302.9799978733063
[rfa agg] training data poison_ratio: 0.40639649963537866  data num: [1552, 530, 500, 813, 735, 953, 599, 1036, 1750, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.12699890613605583
[rfa agg] init. name: [74, 18, 82, 53, 32, 64, 95, 19, 44, 38], weight: tensor([0.1617, 0.0552, 0.0521, 0.0847, 0.0766, 0.0993, 0.0624, 0.1079, 0.1823,
        0.1178])
[rfa agg] iter:  0, prev_obj_val: 30271.998046875, obj_val: 20757.814453125, abs dis: 9514.18359375
[rfa agg] iter: 0, weight: tensor([0.0358, 0.0633, 0.0596, 0.0972, 0.0879, 0.1141, 0.0715, 0.1241, 0.2109,
        0.1356])
[rfa agg] iter:  1, prev_obj_val: 20757.814453125, obj_val: 18586.716796875, abs dis: 2171.09765625
[rfa agg] iter: 1, weight: tensor([0.0071, 0.0643, 0.0605, 0.0994, 0.0897, 0.1171, 0.0728, 0.1279, 0.2214,
        0.1399])
[rfa agg] iter:  2, prev_obj_val: 18586.716796875, obj_val: 18157.046875, abs dis: 429.669921875
[rfa agg] iter: 2, weight: tensor([0.0013, 0.0599, 0.0559, 0.0960, 0.0858, 0.1151, 0.0685, 0.1280, 0.2479,
        0.1414])
[rfa agg] iter:  3, prev_obj_val: 18157.046875, obj_val: 18116.2265625, abs dis: 40.8203125
[rfa agg] iter: 3, weight: tensor([1.6023e-04, 2.9640e-02, 2.6795e-02, 5.5037e-02, 4.7279e-02, 7.2097e-02,
        3.5028e-02, 8.8706e-02, 5.4144e-01, 1.0382e-01])
[rfa agg] iter:  4, prev_obj_val: 18116.2265625, obj_val: 18105.6171875, abs dis: 10.609375
[rfa agg] iter: 4, weight: tensor([1.0466e-04, 3.4203e-02, 2.9970e-02, 7.5562e-02, 6.1615e-02, 1.1358e-01,
        4.1882e-02, 1.6919e-01, 2.4414e-01, 2.2976e-01])
[rfa agg] iter:  5, prev_obj_val: 18105.6171875, obj_val: 18108.794921875, abs dis: 3.177734375
[rfa agg] iter: 5, weight: tensor([4.1942e-05, 2.3691e-02, 1.9746e-02, 7.6473e-02, 5.4440e-02, 1.9027e-01,
        3.0883e-02, 3.2617e-01, 5.1137e-02, 2.2714e-01])
[rfa agg] iter:  6, prev_obj_val: 18108.794921875, obj_val: 18113.4765625, abs dis: 4.681640625
[rfa agg] iter: 6, weight: tensor([4.2031e-05, 3.2217e-02, 2.5805e-02, 1.6254e-01, 9.5388e-02, 3.5411e-01,
        4.4364e-02, 1.3488e-01, 4.3625e-02, 1.0703e-01])
[rfa agg] iter:  7, prev_obj_val: 18113.4765625, obj_val: 18120.564453125, abs dis: 7.087890625
[rfa agg] iter: 7, weight: tensor([3.8092e-05, 3.9888e-02, 3.0288e-02, 3.6129e-01, 1.8681e-01, 1.4061e-01,
        5.9636e-02, 7.7388e-02, 3.5637e-02, 6.8408e-02])
[rfa agg] iter:  8, prev_obj_val: 18120.564453125, obj_val: 18120.51953125, abs dis: 0.044921875
[rfa agg] iter: 8, weight: tensor([4.2503e-05, 6.9638e-02, 4.7955e-02, 1.7661e-01, 3.3145e-01, 9.0982e-02,
        1.2467e-01, 6.3443e-02, 3.6171e-02, 5.9041e-02])
			Update norm = 109.65646373589885 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 557.9400954246521 sec.
Server Epoch:26 choose agents : [19, 3, 96, 58, 94, 68, 87, 88, 54, 66].
_Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 380/1036 (36.6795%)
_Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   2, Avg loss: 0.0251, Accuracy: 629/1036 (60.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.4419, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.0739, Accuracy: 114/781 (14.5967%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 225/781 (28.8092%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.7173, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 48/311 (15.4341%)
_Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3690, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   1, Avg loss: 0.0566, Accuracy: 345/803 (42.9639%)
_Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 404/803 (50.3113%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.9850, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 325/1662 (19.5548%)
_Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 599/1662 (36.0409%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.8341, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0624, Accuracy: 368/1163 (31.6423%)
_Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0359, Accuracy: 461/1163 (39.6389%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.6892, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.0582, Accuracy: 294/1131 (25.9947%)
_Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0319, Accuracy: 392/1131 (34.6596%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.6495, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   1, Avg loss: 0.0755, Accuracy: 139/603 (23.0514%)
_Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   2, Avg loss: 0.0457, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.9753, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0546, Accuracy: 345/1130 (30.5310%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 477/1130 (42.2124%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.5905, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 261/1402 (18.6163%)
_Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 409/1402 (29.1726%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.2371, Accuracy: 78/10000 (0.7800%)
time spent on training: 164.93190240859985
[rfa agg] training data poison_ratio: 0.0  data num: [1036, 781, 311, 803, 1662, 1163, 1131, 603, 1130, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [19, 3, 96, 58, 94, 68, 87, 88, 54, 66], weight: tensor([0.1034, 0.0779, 0.0310, 0.0801, 0.1658, 0.1160, 0.1129, 0.0602, 0.1128,
        0.1399])
[rfa agg] iter:  0, prev_obj_val: 38.37913131713867, obj_val: 44.078857421875, abs dis: 5.699726104736328
[rfa agg] iter: 0, weight: tensor([0.2770, 0.0436, 0.0058, 0.0449, 0.0417, 0.1218, 0.1931, 0.0194, 0.1900,
        0.0627])
[rfa agg] iter:  1, prev_obj_val: 44.078857421875, obj_val: 46.23649597167969, abs dis: 2.1576385498046875
[rfa agg] iter: 1, weight: tensor([0.2136, 0.1022, 0.0100, 0.1062, 0.0539, 0.1105, 0.1475, 0.0371, 0.1461,
        0.0730])
[rfa agg] iter:  2, prev_obj_val: 46.23649597167969, obj_val: 50.712745666503906, abs dis: 4.476249694824219
[rfa agg] iter: 2, weight: tensor([0.1769, 0.1343, 0.0112, 0.1397, 0.0548, 0.1036, 0.1324, 0.0435, 0.1315,
        0.0722])
[rfa agg] iter:  3, prev_obj_val: 50.712745666503906, obj_val: 53.044151306152344, abs dis: 2.3314056396484375
[rfa agg] iter: 3, weight: tensor([0.1133, 0.2206, 0.0115, 0.2340, 0.0467, 0.0776, 0.0937, 0.0503, 0.0934,
        0.0589])
[rfa agg] iter:  4, prev_obj_val: 53.044151306152344, obj_val: 58.87446212768555, abs dis: 5.830310821533203
[rfa agg] iter: 4, weight: tensor([0.0801, 0.2804, 0.0100, 0.3051, 0.0368, 0.0580, 0.0686, 0.0470, 0.0684,
        0.0455])
[rfa agg] iter:  5, prev_obj_val: 58.87446212768555, obj_val: 58.87293243408203, abs dis: 0.001529693603515625
[rfa agg] iter: 5, weight: tensor([0.0640, 0.2961, 0.0115, 0.3216, 0.0347, 0.0501, 0.0574, 0.0658, 0.0573,
        0.0415])
			Update norm = 118.33142099760528 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 419.6831421852112 sec.
Server Epoch:27 choose agents : [95, 51, 93, 9, 60, 99, 31, 17, 49, 65].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0650, Accuracy: 194/599 (32.3873%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0267, Accuracy: 317/599 (52.9215%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Avg loss: 0.0265, Accuracy: 294/599 (49.0818%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Avg loss: 0.0246, Accuracy: 370/599 (61.7696%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Avg loss: 0.0259, Accuracy: 350/599 (58.4307%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Avg loss: 0.0238, Accuracy: 359/599 (59.9332%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Avg loss: 0.0237, Accuracy: 367/599 (61.2688%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Avg loss: 0.0226, Accuracy: 361/599 (60.2671%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Avg loss: 0.0217, Accuracy: 393/599 (65.6093%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Avg loss: 0.0214, Accuracy: 383/599 (63.9399%), train_poison_data_count: 200
Global model norm: 112.05412074779981.
Norm before scaling: 112.04640326389331. Distance: 0.7820215230331132
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.3280, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.7238, Accuracy: 5417/9950 (54.4422%)
Scaling by  100
Scaled Norm after poisoning: 135.7857989744325, distance: 78.20215565083548
Total norm for 3 adversaries is: 135.7857989744325. distance: 78.20215565083548
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0601, Accuracy: 229/1049 (21.8303%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 506/1049 (48.2364%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.4677, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   1, Avg loss: 0.0555, Accuracy: 418/1742 (23.9954%)
_Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 701/1742 (40.2411%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.1014, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Avg loss: 0.0504, Accuracy: 367/1275 (28.7843%)
_Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Avg loss: 0.0193, Accuracy: 729/1275 (57.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.3438, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 549/2227 (24.6520%)
_Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   2, Avg loss: 0.0286, Accuracy: 1007/2227 (45.2178%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.2550, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.0685, Accuracy: 186/773 (24.0621%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0292, Accuracy: 390/773 (50.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.2462, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   1, Avg loss: 0.0822, Accuracy: 69/460 (15.0000%)
_Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   2, Avg loss: 0.0373, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.8712, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 381/1574 (24.2058%)
_Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 690/1574 (43.8374%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0850, Accuracy: 81/10000 (0.8100%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   1, Avg loss: 0.0773, Accuracy: 31/440 (7.0455%)
_Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   2, Avg loss: 0.0474, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.5931, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   1, Avg loss: 0.0551, Accuracy: 395/1475 (26.7797%)
_Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   2, Avg loss: 0.0327, Accuracy: 656/1475 (44.4746%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.0862, Accuracy: 77/10000 (0.7700%)
time spent on training: 304.52029609680176
[rfa agg] training data poison_ratio: 0.2164628896159807  data num: [599, 1049, 1742, 1275, 2227, 773, 460, 1574, 440, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.06764465300499398
[rfa agg] init. name: [95, 51, 93, 9, 60, 99, 31, 17, 49, 65], weight: tensor([0.0516, 0.0903, 0.1500, 0.1098, 0.1918, 0.0666, 0.0396, 0.1355, 0.0379,
        0.1270])
[rfa agg] iter:  0, prev_obj_val: 4354.57763671875, obj_val: 2406.34912109375, abs dis: 1948.228515625
[rfa agg] iter: 0, weight: tensor([0.0029, 0.0924, 0.1602, 0.1136, 0.2106, 0.0671, 0.0392, 0.1430, 0.0373,
        0.1335])
[rfa agg] iter:  1, prev_obj_val: 2406.34912109375, obj_val: 2370.00537109375, abs dis: 36.34375
[rfa agg] iter: 1, weight: tensor([6.5773e-05, 3.0097e-02, 1.1664e-01, 4.3420e-02, 6.2987e-01, 1.8352e-02,
        8.9694e-03, 7.7517e-02, 8.2822e-03, 6.6787e-02])
[rfa agg] iter:  2, prev_obj_val: 2370.00537109375, obj_val: 2360.36376953125, abs dis: 9.6416015625
[rfa agg] iter: 2, weight: tensor([5.0551e-05, 3.6634e-02, 4.3009e-01, 5.9261e-02, 1.5588e-01, 2.0310e-02,
        9.2139e-03, 1.5914e-01, 8.4128e-03, 1.2101e-01])
[rfa agg] iter:  3, prev_obj_val: 2360.36376953125, obj_val: 2363.79833984375, abs dis: 3.4345703125
[rfa agg] iter: 3, weight: tensor([3.0495e-05, 3.5168e-02, 1.2373e-01, 7.0419e-02, 5.3613e-02, 1.7051e-02,
        7.0784e-03, 3.6967e-01, 6.3832e-03, 3.1685e-01])
[rfa agg] iter:  4, prev_obj_val: 2363.79833984375, obj_val: 2366.4921875, abs dis: 2.69384765625
[rfa agg] iter: 4, weight: tensor([4.3348e-05, 6.7596e-02, 1.1207e-01, 1.7315e-01, 6.4147e-02, 2.9300e-02,
        1.1446e-02, 2.1927e-01, 1.0241e-02, 3.1273e-01])
[rfa agg] iter:  5, prev_obj_val: 2366.4921875, obj_val: 2369.381591796875, abs dis: 2.889404296875
[rfa agg] iter: 5, weight: tensor([4.6791e-05, 8.8525e-02, 1.0304e-01, 2.9277e-01, 6.4189e-02, 3.5331e-02,
        1.3269e-02, 1.7084e-01, 1.1817e-02, 2.2018e-01])
[rfa agg] iter:  6, prev_obj_val: 2369.381591796875, obj_val: 2370.9814453125, abs dis: 1.599853515625
[rfa agg] iter: 6, weight: tensor([3.8489e-05, 9.2245e-02, 7.3758e-02, 4.8782e-01, 4.9197e-02, 3.2906e-02,
        1.1786e-02, 1.1037e-01, 1.0439e-02, 1.3144e-01])
[rfa agg] iter:  7, prev_obj_val: 2370.9814453125, obj_val: 2375.407958984375, abs dis: 4.426513671875
[rfa agg] iter: 7, weight: tensor([2.8721e-05, 7.8931e-02, 5.1622e-02, 6.3038e-01, 3.5493e-02, 2.6274e-02,
        9.1581e-03, 7.4165e-02, 8.0869e-03, 8.5862e-02])
[rfa agg] iter:  8, prev_obj_val: 2375.407958984375, obj_val: 2375.365478515625, abs dis: 0.04248046875
[rfa agg] iter: 8, weight: tensor([4.3656e-05, 1.6635e-01, 6.9862e-02, 4.3880e-01, 5.0595e-02, 4.6410e-02,
        1.5171e-02, 9.4275e-02, 1.3306e-02, 1.0518e-01])
			Update norm = 174.65862909902276 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 557.3380298614502 sec.
Server Epoch:28 choose agents : [51, 19, 66, 24, 25, 80, 58, 15, 0, 90].
_Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 231/1049 (22.0210%)
_Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 507/1049 (48.3317%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.5292, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   1, Avg loss: 0.0480, Accuracy: 388/1036 (37.4517%)
_Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   2, Avg loss: 0.0245, Accuracy: 652/1036 (62.9344%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.7331, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 270/1402 (19.2582%)
_Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 369/1402 (26.3195%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.3280, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   1, Avg loss: 0.0756, Accuracy: 47/312 (15.0641%)
_Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 158/312 (50.6410%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.4311, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   1, Avg loss: 0.0555, Accuracy: 310/690 (44.9275%)
_Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   2, Avg loss: 0.0270, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.5641, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   1, Avg loss: 0.0706, Accuracy: 138/682 (20.2346%)
_Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   2, Avg loss: 0.0378, Accuracy: 248/682 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.3321, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   1, Avg loss: 0.0570, Accuracy: 350/803 (43.5866%)
_Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   2, Avg loss: 0.0348, Accuracy: 384/803 (47.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.0201, Accuracy: 54/10000 (0.5400%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   1, Avg loss: 0.0586, Accuracy: 313/1154 (27.1231%)
_Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   2, Avg loss: 0.0305, Accuracy: 358/1154 (31.0225%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9462, Accuracy: 53/10000 (0.5300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 364/1657 (21.9674%)
_Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 528/1657 (31.8648%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8796, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   1, Avg loss: 0.0570, Accuracy: 325/677 (48.0059%)
_Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 440/677 (64.9926%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.2342, Accuracy: 54/10000 (0.5400%)
time spent on training: 201.3524169921875
[rfa agg] training data poison_ratio: 0.37000634115409003  data num: [1049, 1036, 1402, 312, 690, 682, 803, 1154, 1657, 677]
[rfa agg] considering poison per batch poison_fraction: 0.11562698161065313
[rfa agg] init. name: [51, 19, 66, 24, 25, 80, 58, 15, 0, 90], weight: tensor([0.1109, 0.1095, 0.1482, 0.0330, 0.0729, 0.0721, 0.0849, 0.1220, 0.1751,
        0.0715])
[rfa agg] iter:  0, prev_obj_val: 47.88917541503906, obj_val: 50.75297164916992, abs dis: 2.8637962341308594
[rfa agg] iter: 0, weight: tensor([0.1915, 0.1862, 0.0798, 0.0124, 0.0684, 0.0676, 0.1536, 0.1132, 0.0603,
        0.0670])
[rfa agg] iter:  1, prev_obj_val: 50.75297164916992, obj_val: 58.26551818847656, abs dis: 7.512546539306641
[rfa agg] iter: 1, weight: tensor([0.1291, 0.1272, 0.0668, 0.0132, 0.0863, 0.0851, 0.2677, 0.0873, 0.0528,
        0.0844])
[rfa agg] iter:  2, prev_obj_val: 58.26551818847656, obj_val: 66.9440689086914, abs dis: 8.678550720214844
[rfa agg] iter: 2, weight: tensor([0.0621, 0.0614, 0.0420, 0.0132, 0.1766, 0.1735, 0.2174, 0.0492, 0.0355,
        0.1690])
[rfa agg] iter:  3, prev_obj_val: 66.9440689086914, obj_val: 63.3193473815918, abs dis: 3.6247215270996094
[rfa agg] iter: 3, weight: tensor([0.0415, 0.0410, 0.0316, 0.0144, 0.2499, 0.2465, 0.0817, 0.0351, 0.0277,
        0.2307])
[rfa agg] iter:  4, prev_obj_val: 63.3193473815918, obj_val: 63.31581115722656, abs dis: 0.003536224365234375
[rfa agg] iter: 4, weight: tensor([0.0316, 0.0312, 0.0233, 0.0094, 0.2752, 0.2737, 0.0701, 0.0263, 0.0202,
        0.2390])
[rfa agg] iter:  5, prev_obj_val: 63.31581115722656, obj_val: 63.31574249267578, abs dis: 6.866455078125e-05
[rfa agg] iter: 5, weight: tensor([0.0310, 0.0306, 0.0229, 0.0092, 0.2781, 0.2786, 0.0686, 0.0258, 0.0199,
        0.2354])
			Update norm = 105.34872336969727 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 446.39090394973755 sec.
Server Epoch:29 choose agents : [5, 8, 98, 14, 70, 64, 74, 49, 75, 78].
poison local model 5 index 4 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   1, Avg loss: 0.0535, Accuracy: 389/1628 (23.8943%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   2, Avg loss: 0.0287, Accuracy: 592/1628 (36.3636%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   3, Avg loss: 0.0267, Accuracy: 692/1628 (42.5061%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   4, Avg loss: 0.0255, Accuracy: 810/1628 (49.7543%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   5, Avg loss: 0.0246, Accuracy: 850/1628 (52.2113%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   6, Avg loss: 0.0236, Accuracy: 902/1628 (55.4054%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   7, Avg loss: 0.0228, Accuracy: 940/1628 (57.7396%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   8, Avg loss: 0.0212, Accuracy: 994/1628 (61.0565%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   9, Avg loss: 0.0216, Accuracy: 1027/1628 (63.0835%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch  10, Avg loss: 0.0214, Accuracy: 1019/1628 (62.5921%), train_poison_data_count: 520
Global model norm: 112.05412074779981.
Norm before scaling: 112.0283733940313. Distance: 1.2553243728543444
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.5160, Accuracy: 128/10000 (1.2800%)
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: 0.8871, Accuracy: 8946/9950 (89.9095%)
Scaling by  100
Scaled Norm after poisoning: 166.0727556110574, distance: 125.53242857923206
Total norm for 3 adversaries is: 166.0727556110574. distance: 125.53242857923206
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   1, Avg loss: 0.0602, Accuracy: 235/1513 (15.5321%)
_Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   2, Avg loss: 0.0373, Accuracy: 414/1513 (27.3629%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.3466, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   1, Avg loss: 0.0812, Accuracy: 14/373 (3.7534%)
_Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   2, Avg loss: 0.0475, Accuracy: 151/373 (40.4826%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.5038, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 218/1013 (21.5202%)
_Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 315/1013 (31.0958%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.7258, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0559, Accuracy: 355/1418 (25.0353%)
_Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 651/1418 (45.9097%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.5793, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 174/953 (18.2581%)
_Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 325/953 (34.1028%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.6970, Accuracy: 56/10000 (0.5600%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 494/1552 (31.8299%)
_Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 748/1552 (48.1959%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.8009, Accuracy: 82/10000 (0.8200%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   1, Avg loss: 0.0774, Accuracy: 31/440 (7.0455%)
_Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   2, Avg loss: 0.0471, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.5857, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   1, Avg loss: 0.0658, Accuracy: 238/776 (30.6701%)
_Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   2, Avg loss: 0.0279, Accuracy: 418/776 (53.8660%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.8327, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.0842, Accuracy: 34/416 (8.1731%)
_Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0470, Accuracy: 168/416 (40.3846%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.6308, Accuracy: 50/10000 (0.5000%)
time spent on training: 319.46266412734985
[rfa agg] training data poison_ratio: 0.3590557429081531  data num: [1628, 1513, 373, 1013, 1418, 953, 1552, 440, 776, 416]
[rfa agg] considering poison per batch poison_fraction: 0.11220491965879785
[rfa agg] init. name: [5, 8, 98, 14, 70, 64, 74, 49, 75, 78], weight: tensor([0.1615, 0.1501, 0.0370, 0.1005, 0.1406, 0.0945, 0.1539, 0.0436, 0.0770,
        0.0413])
[rfa agg] iter:  0, prev_obj_val: 31450.857421875, obj_val: 21555.18359375, abs dis: 9895.673828125
[rfa agg] iter: 0, weight: tensor([0.0357, 0.1730, 0.0423, 0.1154, 0.1621, 0.1085, 0.1776, 0.0499, 0.0883,
        0.0472])
[rfa agg] iter:  1, prev_obj_val: 21555.18359375, obj_val: 19300.955078125, abs dis: 2254.228515625
[rfa agg] iter: 1, weight: tensor([0.0070, 0.1798, 0.0426, 0.1183, 0.1682, 0.1111, 0.1849, 0.0504, 0.0901,
        0.0477])
[rfa agg] iter:  2, prev_obj_val: 19300.955078125, obj_val: 18855.759765625, abs dis: 445.1953125
[rfa agg] iter: 2, weight: tensor([0.0013, 0.1895, 0.0384, 0.1158, 0.1755, 0.1078, 0.1967, 0.0458, 0.0859,
        0.0433])
[rfa agg] iter:  3, prev_obj_val: 18855.759765625, obj_val: 18800.72265625, abs dis: 55.037109375
[rfa agg] iter: 3, weight: tensor([1.9655e-04, 2.3562e-01, 2.0829e-02, 8.8022e-02, 2.0117e-01, 7.8453e-02,
        2.6830e-01, 2.5491e-02, 5.7816e-02, 2.4098e-02])
[rfa agg] iter:  4, prev_obj_val: 18800.72265625, obj_val: 18802.451171875, abs dis: 1.728515625
[rfa agg] iter: 4, weight: tensor([5.4012e-05, 2.4321e-01, 1.0331e-02, 7.8259e-02, 3.5545e-01, 6.2583e-02,
        1.8561e-01, 1.3037e-02, 3.9141e-02, 1.2322e-02])
[rfa agg] iter:  5, prev_obj_val: 18802.451171875, obj_val: 18805.228515625, abs dis: 2.77734375
[rfa agg] iter: 5, weight: tensor([6.6553e-05, 2.2131e-01, 1.3602e-02, 1.1680e-01, 2.9037e-01, 9.0705e-02,
        1.7905e-01, 1.7247e-02, 5.4552e-02, 1.6299e-02])
[rfa agg] iter:  6, prev_obj_val: 18805.228515625, obj_val: 18807.130859375, abs dis: 1.90234375
[rfa agg] iter: 6, weight: tensor([7.4396e-05, 1.7629e-01, 1.6949e-02, 1.9182e-01, 2.0687e-01, 1.3815e-01,
        1.5166e-01, 2.1680e-02, 7.6029e-02, 2.0487e-02])
[rfa agg] iter:  7, prev_obj_val: 18807.130859375, obj_val: 18808.099609375, abs dis: 0.96875
[rfa agg] iter: 7, weight: tensor([7.0121e-05, 1.3907e-01, 1.7302e-02, 2.6318e-01, 1.5654e-01, 1.7178e-01,
        1.2291e-01, 2.2289e-02, 8.5806e-02, 2.1061e-02])
[rfa agg] iter:  8, prev_obj_val: 18808.099609375, obj_val: 18809.10546875, abs dis: 1.005859375
[rfa agg] iter: 8, weight: tensor([6.4340e-05, 1.1789e-01, 1.6563e-02, 3.1317e-01, 1.3065e-01, 1.8735e-01,
        1.0534e-01, 2.1424e-02, 8.7320e-02, 2.0243e-02])
[rfa agg] iter:  9, prev_obj_val: 18809.10546875, obj_val: 18811.458984375, abs dis: 2.353515625
[rfa agg] iter: 9, weight: tensor([5.5905e-05, 9.5223e-02, 1.5040e-02, 3.7729e-01, 1.0418e-01, 1.9927e-01,
        8.5868e-02, 1.9541e-02, 8.5060e-02, 1.8463e-02])
			Update norm = 148.46423443459372 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 565.4727184772491 sec.
Server Epoch:30 choose agents : [72, 69, 82, 58, 15, 79, 52, 28, 1, 17].
_Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 267/1241 (21.5149%)
_Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 428/1241 (34.4883%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.2496, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0574, Accuracy: 282/590 (47.7966%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0317, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.1681, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 66/500 (13.2000%)
_Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.7365, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   1, Avg loss: 0.0561, Accuracy: 345/803 (42.9639%)
_Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.0761, Accuracy: 50/10000 (0.5000%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0574, Accuracy: 316/1154 (27.3830%)
_Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0303, Accuracy: 370/1154 (32.0624%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.1320, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   1, Avg loss: 0.1021, Accuracy: 15/197 (7.6142%)
_Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   2, Avg loss: 0.0859, Accuracy: 62/197 (31.4721%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3324, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.0562, Accuracy: 284/636 (44.6541%)
_Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.5055, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   1, Avg loss: 0.0572, Accuracy: 358/1581 (22.6439%)
_Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 584/1581 (36.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.5429, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0582, Accuracy: 277/928 (29.8491%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 566/928 (60.9914%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7758, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 380/1574 (24.1423%)
_Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 658/1574 (41.8043%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.1091, Accuracy: 90/10000 (0.9000%)
time spent on training: 181.57485365867615
[rfa agg] training data poison_ratio: 0.12538026944806605  data num: [1241, 590, 500, 803, 1154, 197, 636, 1581, 928, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.03918133420252064
[rfa agg] init. name: [72, 69, 82, 58, 15, 79, 52, 28, 1, 17], weight: tensor([0.1348, 0.0641, 0.0543, 0.0872, 0.1254, 0.0214, 0.0691, 0.1718, 0.1008,
        0.1710])
[rfa agg] iter:  0, prev_obj_val: 53.27436828613281, obj_val: 56.985687255859375, abs dis: 3.7113189697265625
[rfa agg] iter: 0, weight: tensor([0.1355, 0.0437, 0.0278, 0.1165, 0.1656, 0.0073, 0.0469, 0.0780, 0.3010,
        0.0778])
[rfa agg] iter:  1, prev_obj_val: 56.985687255859375, obj_val: 62.617897033691406, abs dis: 5.632209777832031
[rfa agg] iter: 1, weight: tensor([0.0836, 0.0486, 0.0287, 0.1832, 0.0948, 0.0069, 0.0521, 0.0562, 0.3897,
        0.0561])
[rfa agg] iter:  2, prev_obj_val: 62.617897033691406, obj_val: 64.86495971679688, abs dis: 2.2470626831054688
[rfa agg] iter: 2, weight: tensor([0.0621, 0.0676, 0.0350, 0.4391, 0.0673, 0.0076, 0.0719, 0.0464, 0.1568,
        0.0463])
[rfa agg] iter:  3, prev_obj_val: 64.86495971679688, obj_val: 67.414794921875, abs dis: 2.549835205078125
[rfa agg] iter: 3, weight: tensor([0.0592, 0.0818, 0.0396, 0.4434, 0.0634, 0.0082, 0.0869, 0.0454, 0.1269,
        0.0453])
[rfa agg] iter:  4, prev_obj_val: 67.414794921875, obj_val: 69.99751281738281, abs dis: 2.5827178955078125
[rfa agg] iter: 4, weight: tensor([0.0665, 0.1201, 0.0531, 0.3200, 0.0705, 0.0104, 0.1267, 0.0523, 0.1282,
        0.0521])
[rfa agg] iter:  5, prev_obj_val: 69.99751281738281, obj_val: 69.98921203613281, abs dis: 0.00830078125
[rfa agg] iter: 5, weight: tensor([0.0660, 0.1643, 0.0638, 0.2304, 0.0695, 0.0116, 0.1714, 0.0531, 0.1171,
        0.0529])
			Update norm = 109.61003764054868 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 434.64431047439575 sec.
Server Epoch:31 choose agents : [10, 79, 5, 85, 82, 35, 38, 44, 1, 72].
poison local model 10 index 5 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   1, Avg loss: 0.0614, Accuracy: 175/861 (20.3252%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   2, Avg loss: 0.0281, Accuracy: 310/861 (36.0046%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   3, Avg loss: 0.0231, Accuracy: 410/861 (47.6190%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   4, Avg loss: 0.0231, Accuracy: 364/861 (42.2764%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   5, Avg loss: 0.0222, Accuracy: 383/861 (44.4832%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   6, Avg loss: 0.0221, Accuracy: 411/861 (47.7352%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   7, Avg loss: 0.0218, Accuracy: 437/861 (50.7549%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   8, Avg loss: 0.0213, Accuracy: 409/861 (47.5029%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   9, Avg loss: 0.0218, Accuracy: 400/861 (46.4576%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch  10, Avg loss: 0.0209, Accuracy: 437/861 (50.7549%), train_poison_data_count: 280
Global model norm: 112.05412074779981.
Norm before scaling: 112.04406307481223. Distance: 1.0256135244151756
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.0945, Accuracy: 90/10000 (0.9000%)
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: 0.9586, Accuracy: 8810/9950 (88.5427%)
Scaling by  100
Scaled Norm after poisoning: 150.8133676933182, distance: 102.56134311504749
Total norm for 4 adversaries is: 150.8133676933182. distance: 102.56134311504749
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   1, Avg loss: 0.1031, Accuracy: 14/197 (7.1066%)
_Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   2, Avg loss: 0.0854, Accuracy: 53/197 (26.9036%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3334, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   1, Avg loss: 0.0514, Accuracy: 383/1628 (23.5258%)
_Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   2, Avg loss: 0.0264, Accuracy: 764/1628 (46.9287%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.3115, Accuracy: 114/10000 (1.1400%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 428/1988 (21.5292%)
_Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   2, Avg loss: 0.0350, Accuracy: 680/1988 (34.2052%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9450, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   1, Avg loss: 0.0767, Accuracy: 69/500 (13.8000%)
_Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.7671, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   1, Avg loss: 0.0854, Accuracy: 36/271 (13.2841%)
_Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   2, Avg loss: 0.0564, Accuracy: 97/271 (35.7934%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3967, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   1, Avg loss: 0.0619, Accuracy: 253/1131 (22.3696%)
_Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 516/1131 (45.6233%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.2688, Accuracy: 68/10000 (0.6800%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 375/1750 (21.4286%)
_Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 658/1750 (37.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.4472, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0574, Accuracy: 289/928 (31.1422%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 555/928 (59.8060%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5757, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 244/1241 (19.6616%)
_Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 401/1241 (32.3127%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.1470, Accuracy: 70/10000 (0.7000%)
time spent on training: 311.9518721103668
[rfa agg] training data poison_ratio: 0.5933301572177228  data num: [861, 197, 1628, 1988, 500, 271, 1131, 1750, 928, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.18541567413053836
[rfa agg] init. name: [10, 79, 5, 85, 82, 35, 38, 44, 1, 72], weight: tensor([0.0820, 0.0188, 0.1551, 0.1894, 0.0476, 0.0258, 0.1078, 0.1667, 0.0884,
        0.1182])
[rfa agg] iter:  0, prev_obj_val: 9403.060546875, obj_val: 5529.23291015625, abs dis: 3873.82763671875
[rfa agg] iter: 0, weight: tensor([0.0079, 0.0196, 0.1685, 0.2080, 0.0502, 0.0271, 0.1155, 0.1818, 0.0943,
        0.1271])
[rfa agg] iter:  1, prev_obj_val: 5529.23291015625, obj_val: 5183.07373046875, abs dis: 346.1591796875
[rfa agg] iter: 1, weight: tensor([0.0007, 0.0148, 0.1759, 0.2439, 0.0398, 0.0206, 0.1054, 0.1969, 0.0822,
        0.1198])
[rfa agg] iter:  2, prev_obj_val: 5183.07373046875, obj_val: 5184.1552734375, abs dis: 1.08154296875
[rfa agg] iter: 2, weight: tensor([3.9477e-05, 2.7922e-03, 4.3812e-01, 1.1372e-01, 8.6429e-03, 4.0244e-03,
        4.2372e-02, 3.0400e-01, 2.5751e-02, 6.0532e-02])
[rfa agg] iter:  3, prev_obj_val: 5184.1552734375, obj_val: 5186.5234375, abs dis: 2.3681640625
[rfa agg] iter: 3, weight: tensor([5.3371e-05, 4.1429e-03, 4.2212e-01, 1.1299e-01, 1.3100e-02, 5.9988e-03,
        7.4250e-02, 2.0942e-01, 4.2030e-02, 1.1590e-01])
[rfa agg] iter:  4, prev_obj_val: 5186.5234375, obj_val: 5188.158203125, abs dis: 1.634765625
[rfa agg] iter: 4, weight: tensor([6.5704e-05, 5.5005e-03, 2.8111e-01, 1.1662e-01, 1.7740e-02, 7.9984e-03,
        1.1799e-01, 1.8293e-01, 6.1350e-02, 2.0869e-01])
[rfa agg] iter:  5, prev_obj_val: 5188.158203125, obj_val: 5189.90234375, abs dis: 1.744140625
[rfa agg] iter: 5, weight: tensor([6.4138e-05, 5.6665e-03, 2.0657e-01, 1.0279e-01, 1.8556e-02, 8.2664e-03,
        1.4338e-01, 1.4970e-01, 6.8362e-02, 2.9664e-01])
[rfa agg] iter:  6, prev_obj_val: 5189.90234375, obj_val: 5193.6025390625, abs dis: 3.7001953125
[rfa agg] iter: 6, weight: tensor([5.3020e-05, 4.9575e-03, 1.3733e-01, 7.7368e-02, 1.6517e-02, 7.2582e-03,
        1.5581e-01, 1.0639e-01, 6.5724e-02, 4.2860e-01])
[rfa agg] iter:  7, prev_obj_val: 5193.6025390625, obj_val: 5195.44287109375, abs dis: 1.84033203125
[rfa agg] iter: 7, weight: tensor([3.9175e-05, 4.0128e-03, 7.8493e-02, 5.0377e-02, 1.3787e-02, 5.9124e-03,
        2.0811e-01, 6.4910e-02, 6.4022e-02, 5.1034e-01])
[rfa agg] iter:  8, prev_obj_val: 5195.44287109375, obj_val: 5197.3828125, abs dis: 1.93994140625
[rfa agg] iter: 8, weight: tensor([4.3068e-05, 4.5562e-03, 8.0092e-02, 5.3262e-02, 1.5838e-02, 6.7288e-03,
        3.0498e-01, 6.7386e-02, 7.8524e-02, 3.8859e-01])
[rfa agg] iter:  9, prev_obj_val: 5197.3828125, obj_val: 5199.4833984375, abs dis: 2.1005859375
[rfa agg] iter: 9, weight: tensor([4.1747e-05, 4.5671e-03, 7.2635e-02, 4.9744e-02, 1.6080e-02, 6.7623e-03,
        4.4280e-01, 6.1971e-02, 8.6461e-02, 2.5894e-01])
			Update norm = 165.97347773816153 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 561.0918824672699 sec.
Server Epoch:32 choose agents : [72, 26, 61, 80, 49, 36, 32, 54, 23, 85].
_Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0620, Accuracy: 237/1241 (19.0975%)
_Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 418/1241 (33.6825%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.2538, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 348/1446 (24.0664%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 462/1446 (31.9502%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.5446, Accuracy: 58/10000 (0.5800%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   2, Avg loss: 0.1165, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3110, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0717, Accuracy: 136/682 (19.9413%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 251/682 (36.8035%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.4525, Accuracy: 54/10000 (0.5400%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.0772, Accuracy: 31/440 (7.0455%)
_Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0470, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.5957, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   1, Avg loss: 0.0852, Accuracy: 81/408 (19.8529%)
_Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   2, Avg loss: 0.0550, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.5365, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0610, Accuracy: 197/735 (26.8027%)
_Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 355/735 (48.2993%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9373, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   1, Avg loss: 0.0552, Accuracy: 347/1130 (30.7080%)
_Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 481/1130 (42.5664%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.8588, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.0600, Accuracy: 326/715 (45.5944%)
_Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0391, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.8437, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 431/1988 (21.6801%)
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0347, Accuracy: 687/1988 (34.5573%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.8017, Accuracy: 79/10000 (0.7900%)
time spent on training: 212.8081226348877
[rfa agg] training data poison_ratio: 0.28331454340473505  data num: [1241, 1446, 85, 682, 440, 408, 735, 1130, 715, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.0885357948139797
[rfa agg] init. name: [72, 26, 61, 80, 49, 36, 32, 54, 23, 85], weight: tensor([0.1399, 0.1630, 0.0096, 0.0769, 0.0496, 0.0460, 0.0829, 0.1274, 0.0806,
        0.2241])
[rfa agg] iter:  0, prev_obj_val: 67.15467834472656, obj_val: 67.071044921875, abs dis: 0.0836334228515625
[rfa agg] iter: 0, weight: tensor([0.1859, 0.1185, 0.0031, 0.0661, 0.0248, 0.0230, 0.0868, 0.3390, 0.0839,
        0.0689])
[rfa agg] iter:  1, prev_obj_val: 67.071044921875, obj_val: 68.40644836425781, abs dis: 1.3354034423828125
[rfa agg] iter: 1, weight: tensor([0.1817, 0.1155, 0.0030, 0.0645, 0.0242, 0.0224, 0.0845, 0.3552, 0.0818,
        0.0672])
[rfa agg] iter:  2, prev_obj_val: 68.40644836425781, obj_val: 71.13166809082031, abs dis: 2.7252197265625
[rfa agg] iter: 2, weight: tensor([0.1735, 0.1167, 0.0034, 0.0769, 0.0277, 0.0257, 0.1028, 0.3032, 0.0994,
        0.0707])
[rfa agg] iter:  3, prev_obj_val: 71.13166809082031, obj_val: 73.90525817871094, abs dis: 2.773590087890625
[rfa agg] iter: 3, weight: tensor([0.1484, 0.1086, 0.0039, 0.1016, 0.0330, 0.0306, 0.1439, 0.2207, 0.1386,
        0.0706])
[rfa agg] iter:  4, prev_obj_val: 73.90525817871094, obj_val: 76.78001403808594, abs dis: 2.874755859375
[rfa agg] iter: 4, weight: tensor([0.1151, 0.0897, 0.0039, 0.1246, 0.0350, 0.0325, 0.1956, 0.1550, 0.1866,
        0.0619])
[rfa agg] iter:  5, prev_obj_val: 76.78001403808594, obj_val: 80.19412231445312, abs dis: 3.4141082763671875
[rfa agg] iter: 5, weight: tensor([0.0757, 0.0619, 0.0032, 0.1400, 0.0312, 0.0290, 0.2698, 0.0955, 0.2487,
        0.0449])
[rfa agg] iter:  6, prev_obj_val: 80.19412231445312, obj_val: 88.77490234375, abs dis: 8.580780029296875
[rfa agg] iter: 6, weight: tensor([0.0414, 0.0351, 0.0022, 0.1560, 0.0233, 0.0216, 0.3555, 0.0498, 0.2885,
        0.0266])
[rfa agg] iter:  7, prev_obj_val: 88.77490234375, obj_val: 82.63732147216797, abs dis: 6.137580871582031
[rfa agg] iter: 7, weight: tensor([0.0522, 0.0463, 0.0038, 0.3441, 0.0491, 0.0455, 0.1863, 0.0598, 0.1759,
        0.0370])
[rfa agg] iter:  8, prev_obj_val: 82.63732147216797, obj_val: 88.73599243164062, abs dis: 6.098670959472656
[rfa agg] iter: 8, weight: tensor([0.0416, 0.0359, 0.0025, 0.2897, 0.0276, 0.0256, 0.2667, 0.0491, 0.2337,
        0.0277])
[rfa agg] iter:  9, prev_obj_val: 88.73599243164062, obj_val: 80.24699401855469, abs dis: 8.488998413085938
[rfa agg] iter: 9, weight: tensor([0.0504, 0.0447, 0.0037, 0.3697, 0.0476, 0.0441, 0.1779, 0.0578, 0.1684,
        0.0358])
			Update norm = 113.66592016189374 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 459.2755286693573 sec.
Server Epoch:33 choose agents : [15, 99, 11, 32, 10, 94, 70, 58, 16, 93].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Avg loss: 0.0581, Accuracy: 256/1154 (22.1837%), train_poison_data_count: 362
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Avg loss: 0.0318, Accuracy: 393/1154 (34.0555%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Avg loss: 0.0289, Accuracy: 378/1154 (32.7556%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Avg loss: 0.0278, Accuracy: 435/1154 (37.6950%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Avg loss: 0.0268, Accuracy: 467/1154 (40.4679%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Avg loss: 0.0274, Accuracy: 469/1154 (40.6412%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Avg loss: 0.0262, Accuracy: 481/1154 (41.6811%), train_poison_data_count: 362
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Avg loss: 0.0261, Accuracy: 489/1154 (42.3744%), train_poison_data_count: 362
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Avg loss: 0.0258, Accuracy: 521/1154 (45.1473%), train_poison_data_count: 362
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Avg loss: 0.0256, Accuracy: 528/1154 (45.7539%), train_poison_data_count: 362
Global model norm: 112.05412074779981.
Norm before scaling: 112.03692890069773. Distance: 1.101995504782036
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.8362, Accuracy: 69/10000 (0.6900%)
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: 0.9356, Accuracy: 8333/9950 (83.7487%)
Scaling by  100
Scaled Norm after poisoning: 155.5426112235808, distance: 110.19954822814611
Total norm for 2 adversaries is: 155.5426112235808. distance: 110.19954822814611
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   1, Avg loss: 0.0649, Accuracy: 183/773 (23.6740%)
_Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   2, Avg loss: 0.0323, Accuracy: 398/773 (51.4877%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.4848, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   1, Avg loss: 0.0566, Accuracy: 348/712 (48.8764%)
_Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   2, Avg loss: 0.0252, Accuracy: 448/712 (62.9213%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.5576, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   1, Avg loss: 0.0616, Accuracy: 196/735 (26.6667%)
_Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 338/735 (45.9864%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.9242, Accuracy: 51/10000 (0.5100%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   1, Avg loss: 0.0570, Accuracy: 202/861 (23.4611%)
_Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 449/861 (52.1487%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.0538, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 349/1662 (20.9988%)
_Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 622/1662 (37.4248%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.1113, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0565, Accuracy: 343/1418 (24.1890%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 657/1418 (46.3329%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.4436, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   1, Avg loss: 0.0583, Accuracy: 337/803 (41.9676%)
_Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 431/803 (53.6737%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.0240, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   1, Avg loss: 0.0592, Accuracy: 273/708 (38.5593%)
_Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.8534, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   1, Avg loss: 0.0557, Accuracy: 399/1742 (22.9047%)
_Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 696/1742 (39.9541%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.7757, Accuracy: 96/10000 (0.9600%)
time spent on training: 307.764422416687
[rfa agg] training data poison_ratio: 0.19066994700984102  data num: [1154, 773, 712, 735, 861, 1662, 1418, 803, 708, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.059584358440575316
[rfa agg] init. name: [15, 99, 11, 32, 10, 94, 70, 58, 16, 93], weight: tensor([0.1092, 0.0731, 0.0674, 0.0695, 0.0815, 0.1573, 0.1342, 0.0760, 0.0670,
        0.1648])
[rfa agg] iter:  0, prev_obj_val: 16498.138671875, obj_val: 10233.72265625, abs dis: 6264.416015625
[rfa agg] iter: 0, weight: tensor([0.0148, 0.0804, 0.0740, 0.0764, 0.0896, 0.1750, 0.1489, 0.0835, 0.0736,
        0.1838])
[rfa agg] iter:  1, prev_obj_val: 10233.72265625, obj_val: 9380.0263671875, abs dis: 853.6962890625
[rfa agg] iter: 1, weight: tensor([0.0018, 0.0781, 0.0715, 0.0738, 0.0876, 0.1846, 0.1540, 0.0811, 0.0711,
        0.1965])
[rfa agg] iter:  2, prev_obj_val: 9380.0263671875, obj_val: 9320.9560546875, abs dis: 59.0703125
[rfa agg] iter: 2, weight: tensor([1.6180e-04, 4.6617e-02, 4.1069e-02, 4.2397e-02, 5.4376e-02, 2.4345e-01,
        1.5614e-01, 4.8426e-02, 4.0837e-02, 3.2653e-01])
[rfa agg] iter:  3, prev_obj_val: 9320.9560546875, obj_val: 9322.9453125, abs dis: 1.9892578125
[rfa agg] iter: 3, weight: tensor([5.5940e-05, 3.9340e-02, 3.2622e-02, 3.3694e-02, 4.9168e-02, 1.8680e-01,
        4.5252e-01, 4.0864e-02, 3.2440e-02, 1.3249e-01])
[rfa agg] iter:  4, prev_obj_val: 9322.9453125, obj_val: 9325.234375, abs dis: 2.2890625
[rfa agg] iter: 4, weight: tensor([7.6795e-05, 6.9189e-02, 5.5832e-02, 5.7671e-02, 8.9370e-02, 1.7266e-01,
        2.9145e-01, 7.1832e-02, 5.5512e-02, 1.3640e-01])
[rfa agg] iter:  5, prev_obj_val: 9325.234375, obj_val: 9328.2880859375, abs dis: 3.0537109375
[rfa agg] iter: 5, weight: tensor([7.9095e-05, 9.9377e-02, 7.6488e-02, 7.9045e-02, 1.3672e-01, 1.3430e-01,
        1.8193e-01, 1.0319e-01, 7.6050e-02, 1.1283e-01])
[rfa agg] iter:  6, prev_obj_val: 9328.2880859375, obj_val: 9330.6103515625, abs dis: 2.322265625
[rfa agg] iter: 6, weight: tensor([5.5246e-05, 1.3508e-01, 9.0380e-02, 9.3567e-02, 2.3053e-01, 7.1679e-02,
        8.5232e-02, 1.4046e-01, 8.9850e-02, 6.3167e-02])
[rfa agg] iter:  7, prev_obj_val: 9330.6103515625, obj_val: 9339.197265625, abs dis: 8.5869140625
[rfa agg] iter: 7, weight: tensor([3.0249e-05, 1.5890e-01, 8.3414e-02, 8.6662e-02, 3.1591e-01, 3.4362e-02,
        3.8932e-02, 1.6808e-01, 8.2809e-02, 3.0895e-02])
[rfa agg] iter:  8, prev_obj_val: 9339.197265625, obj_val: 9342.8173828125, abs dis: 3.6201171875
[rfa agg] iter: 8, weight: tensor([2.4027e-05, 1.2604e-01, 1.9261e-01, 2.0815e-01, 8.1586e-02, 2.3413e-02,
        2.5350e-02, 1.3436e-01, 1.8698e-01, 2.1486e-02])
[rfa agg] iter:  9, prev_obj_val: 9342.8173828125, obj_val: 9347.01171875, abs dis: 4.1943359375
[rfa agg] iter: 9, weight: tensor([2.7793e-05, 1.0677e-01, 2.0269e-01, 2.2049e-01, 7.4924e-02, 2.6159e-02,
        2.8064e-02, 1.1281e-01, 2.0396e-01, 2.4103e-02])
			Update norm = 105.65856068162438 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 558.2016899585724 sec.
Server Epoch:34 choose agents : [82, 57, 91, 67, 43, 97, 54, 71, 66, 14].
_Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 66/500 (13.2000%)
_Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 168/500 (33.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.7197, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 300/1154 (25.9965%)
_Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   2, Avg loss: 0.0278, Accuracy: 420/1154 (36.3951%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.0926, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   1, Avg loss: 0.0541, Accuracy: 329/1030 (31.9417%)
_Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   2, Avg loss: 0.0277, Accuracy: 556/1030 (53.9806%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.3813, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   1, Avg loss: 0.0772, Accuracy: 52/426 (12.2066%)
_Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   2, Avg loss: 0.0418, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.6175, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 301/946 (31.8182%)
_Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 347/946 (36.6808%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.1112, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 363/1213 (29.9258%)
_Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 483/1213 (39.8186%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.1809, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 494/1130 (43.7168%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.0097, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0646, Accuracy: 170/818 (20.7824%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0312, Accuracy: 342/818 (41.8093%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3904, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   1, Avg loss: 0.0625, Accuracy: 247/1402 (17.6177%)
_Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 384/1402 (27.3894%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3739, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0626, Accuracy: 226/1013 (22.3100%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 348/1013 (34.3534%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.7758, Accuracy: 71/10000 (0.7100%)
time spent on training: 188.64405059814453
[rfa agg] training data poison_ratio: 0.0  data num: [500, 1154, 1030, 426, 946, 1213, 1130, 818, 1402, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 57, 91, 67, 43, 97, 54, 71, 66, 14], weight: tensor([0.0519, 0.1198, 0.1069, 0.0442, 0.0982, 0.1259, 0.1173, 0.0849, 0.1456,
        0.1052])
[rfa agg] iter:  0, prev_obj_val: 38.69178771972656, obj_val: 44.4212646484375, abs dis: 5.7294769287109375
[rfa agg] iter: 0, weight: tensor([0.0252, 0.0691, 0.0988, 0.0184, 0.2271, 0.0727, 0.0832, 0.2104, 0.0529,
        0.1422])
[rfa agg] iter:  1, prev_obj_val: 44.4212646484375, obj_val: 44.35842514038086, abs dis: 0.06283950805664062
[rfa agg] iter: 1, weight: tensor([0.0288, 0.0553, 0.0726, 0.0204, 0.1309, 0.0581, 0.0644, 0.4294, 0.0450,
        0.0950])
[rfa agg] iter:  2, prev_obj_val: 44.35842514038086, obj_val: 51.220489501953125, abs dis: 6.862064361572266
[rfa agg] iter: 2, weight: tensor([0.0245, 0.0470, 0.0617, 0.0174, 0.1097, 0.0494, 0.0548, 0.5169, 0.0383,
        0.0803])
[rfa agg] iter:  3, prev_obj_val: 51.220489501953125, obj_val: 51.201812744140625, abs dis: 0.0186767578125
[rfa agg] iter: 3, weight: tensor([0.0513, 0.0681, 0.0841, 0.0349, 0.1274, 0.0716, 0.0774, 0.3240, 0.0581,
        0.1031])
			Update norm = 114.13614916789071 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 438.3855514526367 sec.
Server Epoch:35 choose agents : [25, 59, 84, 17, 29, 58, 36, 90, 67, 70].
poison local model 25 index 7 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   1, Avg loss: 0.0626, Accuracy: 196/690 (28.4058%), train_poison_data_count: 220
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   2, Avg loss: 0.0313, Accuracy: 299/690 (43.3333%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   3, Avg loss: 0.0257, Accuracy: 338/690 (48.9855%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   4, Avg loss: 0.0252, Accuracy: 340/690 (49.2754%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   5, Avg loss: 0.0233, Accuracy: 343/690 (49.7101%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   6, Avg loss: 0.0234, Accuracy: 349/690 (50.5797%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   7, Avg loss: 0.0218, Accuracy: 360/690 (52.1739%), train_poison_data_count: 220
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   8, Avg loss: 0.0212, Accuracy: 387/690 (56.0870%), train_poison_data_count: 220
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   9, Avg loss: 0.0213, Accuracy: 354/690 (51.3043%), train_poison_data_count: 220
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch  10, Avg loss: 0.0213, Accuracy: 372/690 (53.9130%), train_poison_data_count: 220
Global model norm: 112.05412074779981.
Norm before scaling: 112.04543581735045. Distance: 0.8216467406221298
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.3215, Accuracy: 64/10000 (0.6400%)
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: 1.0086, Accuracy: 4271/9950 (42.9246%)
Scaling by  100
Scaled Norm after poisoning: 138.00485442095868, distance: 82.16467720187002
Total norm for 1 adversaries is: 138.00485442095868. distance: 82.16467720187002
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 303/1089 (27.8237%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 485/1089 (44.5363%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.3661, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   1, Avg loss: 0.0625, Accuracy: 324/1190 (27.2269%)
_Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 480/1190 (40.3361%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.2845, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   1, Avg loss: 0.0520, Accuracy: 402/1574 (25.5400%)
_Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 673/1574 (42.7573%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.3800, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   1, Avg loss: 0.0498, Accuracy: 432/1440 (30.0000%)
_Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 670/1440 (46.5278%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.7996, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0577, Accuracy: 340/803 (42.3412%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 398/803 (49.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.0188, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   1, Avg loss: 0.0862, Accuracy: 74/408 (18.1373%)
_Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   2, Avg loss: 0.0545, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.5540, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   1, Avg loss: 0.0555, Accuracy: 328/677 (48.4490%)
_Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.4371, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0770, Accuracy: 59/426 (13.8498%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0415, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.7202, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 333/1418 (23.4838%)
_Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 598/1418 (42.1721%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.8777, Accuracy: 77/10000 (0.7700%)
time spent on training: 271.3585638999939
[rfa agg] training data poison_ratio: 0.07102418939783839  data num: [690, 1089, 1190, 1574, 1440, 803, 408, 677, 426, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.022195059186824496
[rfa agg] init. name: [25, 59, 84, 17, 29, 58, 36, 90, 67, 70], weight: tensor([0.0710, 0.1121, 0.1225, 0.1620, 0.1482, 0.0827, 0.0420, 0.0697, 0.0438,
        0.1460])
[rfa agg] iter:  0, prev_obj_val: 6474.9140625, obj_val: 3718.194091796875, abs dis: 2756.719970703125
[rfa agg] iter: 0, weight: tensor([0.0058, 0.1197, 0.1311, 0.1761, 0.1603, 0.0871, 0.0436, 0.0731, 0.0455,
        0.1578])
[rfa agg] iter:  1, prev_obj_val: 3718.194091796875, obj_val: 3534.033935546875, abs dis: 184.16015625
[rfa agg] iter: 1, weight: tensor([0.0004, 0.1129, 0.1276, 0.2123, 0.1788, 0.0714, 0.0310, 0.0570, 0.0323,
        0.1762])
[rfa agg] iter:  2, prev_obj_val: 3534.033935546875, obj_val: 3536.200439453125, abs dis: 2.16650390625
[rfa agg] iter: 2, weight: tensor([4.5730e-05, 1.7237e-01, 2.9530e-01, 1.1268e-01, 1.6420e-01, 4.1553e-02,
        1.1386e-02, 2.7277e-02, 1.1894e-02, 1.6330e-01])
[rfa agg] iter:  3, prev_obj_val: 3536.200439453125, obj_val: 3539.45947265625, abs dis: 3.259033203125
[rfa agg] iter: 3, weight: tensor([3.8662e-05, 2.7971e-01, 3.6213e-01, 7.3616e-02, 9.5597e-02, 4.4533e-02,
        1.0878e-02, 2.7618e-02, 1.1365e-02, 9.4517e-02])
[rfa agg] iter:  4, prev_obj_val: 3539.45947265625, obj_val: 3541.496337890625, abs dis: 2.036865234375
[rfa agg] iter: 4, weight: tensor([4.5269e-05, 3.6122e-01, 2.5180e-01, 7.4904e-02, 9.2056e-02, 6.3343e-02,
        1.3940e-02, 3.7221e-02, 1.4564e-02, 9.0909e-02])
[rfa agg] iter:  5, prev_obj_val: 3541.496337890625, obj_val: 3539.421630859375, abs dis: 2.07470703125
[rfa agg] iter: 5, weight: tensor([5.1686e-05, 3.4518e-01, 2.2100e-01, 8.0301e-02, 9.6759e-02, 8.1068e-02,
        1.6706e-02, 4.5995e-02, 1.7457e-02, 9.5476e-02])
[rfa agg] iter:  6, prev_obj_val: 3539.421630859375, obj_val: 3541.497802734375, abs dis: 2.076171875
[rfa agg] iter: 6, weight: tensor([4.4018e-05, 3.9082e-01, 2.3260e-01, 7.2862e-02, 8.9589e-02, 6.1692e-02,
        1.3559e-02, 3.6232e-02, 1.4168e-02, 8.8427e-02])
[rfa agg] iter:  7, prev_obj_val: 3541.497802734375, obj_val: 3541.493896484375, abs dis: 0.00390625
[rfa agg] iter: 7, weight: tensor([5.1414e-05, 3.5023e-01, 2.1839e-01, 7.9867e-02, 9.6217e-02, 8.0589e-02,
        1.6617e-02, 4.5745e-02, 1.7365e-02, 9.4934e-02])
[rfa agg] iter:  8, prev_obj_val: 3541.493896484375, obj_val: 3539.421630859375, abs dis: 2.072265625
[rfa agg] iter: 8, weight: tensor([5.1764e-05, 3.4524e-01, 2.2003e-01, 8.0439e-02, 9.6961e-02, 8.1293e-02,
        1.6734e-02, 4.6091e-02, 1.7487e-02, 9.5668e-02])
[rfa agg] iter:  9, prev_obj_val: 3539.421630859375, obj_val: 3541.498046875, abs dis: 2.076416015625
[rfa agg] iter: 9, weight: tensor([4.4017e-05, 3.9091e-01, 2.3252e-01, 7.2861e-02, 8.9589e-02, 6.1691e-02,
        1.3559e-02, 3.6232e-02, 1.4168e-02, 8.8426e-02])
			Update norm = 157.27988711410305 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 518.4381670951843 sec.
Server Epoch:36 choose agents : [14, 2, 79, 58, 84, 40, 16, 50, 8, 72].
_Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 224/1013 (22.1125%)
_Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 348/1013 (34.3534%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.7414, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0629, Accuracy: 233/605 (38.5124%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0390, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.0624, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   1, Avg loss: 0.1020, Accuracy: 18/197 (9.1371%)
_Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   2, Avg loss: 0.0867, Accuracy: 62/197 (31.4721%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3336, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 343/803 (42.7148%)
_Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   2, Avg loss: 0.0330, Accuracy: 430/803 (53.5492%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.0708, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   1, Avg loss: 0.0634, Accuracy: 305/1190 (25.6303%)
_Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   2, Avg loss: 0.0331, Accuracy: 430/1190 (36.1345%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.1938, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   1, Avg loss: 0.0554, Accuracy: 344/1573 (21.8690%)
_Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 586/1573 (37.2537%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.7983, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   1, Avg loss: 0.0627, Accuracy: 282/708 (39.8305%)
_Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   2, Avg loss: 0.0370, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.8588, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   1, Avg loss: 0.0638, Accuracy: 139/809 (17.1817%)
_Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   2, Avg loss: 0.0274, Accuracy: 365/809 (45.1174%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.5845, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   1, Avg loss: 0.0602, Accuracy: 225/1513 (14.8711%)
_Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 463/1513 (30.6015%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.5376, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 249/1241 (20.0645%)
_Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 411/1241 (33.1185%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.0328, Accuracy: 61/10000 (0.6100%)
time spent on training: 178.6124563217163
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 605, 197, 803, 1190, 1573, 708, 809, 1513, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [14, 2, 79, 58, 84, 40, 16, 50, 8, 72], weight: tensor([0.1050, 0.0627, 0.0204, 0.0832, 0.1233, 0.1630, 0.0734, 0.0838, 0.1568,
        0.1286])
[rfa agg] iter:  0, prev_obj_val: 45.388221740722656, obj_val: 50.560367584228516, abs dis: 5.172145843505859
[rfa agg] iter: 0, weight: tensor([0.3707, 0.0309, 0.0052, 0.0750, 0.1484, 0.0616, 0.0519, 0.0753, 0.0670,
        0.1140])
[rfa agg] iter:  1, prev_obj_val: 50.560367584228516, obj_val: 53.92890548706055, abs dis: 3.3685379028320312
[rfa agg] iter: 1, weight: tensor([0.2269, 0.0475, 0.0066, 0.1710, 0.0926, 0.0535, 0.0969, 0.1689, 0.0568,
        0.0794])
[rfa agg] iter:  2, prev_obj_val: 53.92890548706055, obj_val: 61.727020263671875, abs dis: 7.798114776611328
[rfa agg] iter: 2, weight: tensor([0.1097, 0.0473, 0.0057, 0.2723, 0.0594, 0.0381, 0.1191, 0.2556, 0.0401,
        0.0526])
[rfa agg] iter:  3, prev_obj_val: 61.727020263671875, obj_val: 65.11031341552734, abs dis: 3.3832931518554688
[rfa agg] iter: 3, weight: tensor([0.0710, 0.0814, 0.0069, 0.1984, 0.0479, 0.0344, 0.2876, 0.1927, 0.0358,
        0.0438])
[rfa agg] iter:  4, prev_obj_val: 65.11031341552734, obj_val: 65.10664367675781, abs dis: 0.00366973876953125
[rfa agg] iter: 4, weight: tensor([0.0720, 0.1201, 0.0083, 0.1604, 0.0509, 0.0377, 0.3070, 0.1576, 0.0391,
        0.0469])
			Update norm = 109.82767485503142 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 429.0570993423462 sec.
Server Epoch:37 choose agents : [30, 52, 90, 51, 62, 40, 15, 83, 13, 39].
poison local model 30 index 8 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   1, Avg loss: 0.0820, Accuracy: 47/486 (9.6708%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   2, Avg loss: 0.0444, Accuracy: 169/486 (34.7737%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   3, Avg loss: 0.0357, Accuracy: 175/486 (36.0082%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   4, Avg loss: 0.0363, Accuracy: 168/486 (34.5679%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   5, Avg loss: 0.0354, Accuracy: 176/486 (36.2140%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   6, Avg loss: 0.0324, Accuracy: 185/486 (38.0658%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   7, Avg loss: 0.0316, Accuracy: 214/486 (44.0329%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   8, Avg loss: 0.0315, Accuracy: 196/486 (40.3292%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   9, Avg loss: 0.0309, Accuracy: 217/486 (44.6502%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch  10, Avg loss: 0.0323, Accuracy: 188/486 (38.6831%), train_poison_data_count: 160
Global model norm: 112.05412074779981.
Norm before scaling: 112.0486823954771. Distance: 0.7235374645268932
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.4172, Accuracy: 70/10000 (0.7000%)
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: 1.0703, Accuracy: 6045/9950 (60.7538%)
Scaling by  100
Scaled Norm after poisoning: 132.72937104311163, distance: 72.35374863409808
Total norm for 2 adversaries is: 132.72937104311163. distance: 72.35374863409808
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0562, Accuracy: 285/636 (44.8113%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.5754, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   1, Avg loss: 0.0553, Accuracy: 325/677 (48.0059%)
_Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.4726, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0608, Accuracy: 222/1049 (21.1630%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 497/1049 (47.3785%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.6005, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   1, Avg loss: 0.0650, Accuracy: 156/568 (27.4648%)
_Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   2, Avg loss: 0.0391, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.8662, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 350/1573 (22.2505%)
_Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 577/1573 (36.6815%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.4406, Accuracy: 66/10000 (0.6600%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   1, Avg loss: 0.0578, Accuracy: 324/1154 (28.0763%)
_Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   2, Avg loss: 0.0297, Accuracy: 403/1154 (34.9220%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.9844, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 426/1953 (21.8126%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 777/1953 (39.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.9399, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 322/1645 (19.5745%)
_Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 615/1645 (37.3860%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.8582, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 311/1013 (30.7009%)
_Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 497/1013 (49.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.6076, Accuracy: 62/10000 (0.6200%)
time spent on training: 305.5305528640747
[rfa agg] training data poison_ratio: 0.15250139482983077  data num: [486, 636, 677, 1049, 568, 1573, 1154, 1953, 1645, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.04765668588432212
[rfa agg] init. name: [30, 52, 90, 51, 62, 40, 15, 83, 13, 39], weight: tensor([0.0452, 0.0591, 0.0630, 0.0975, 0.0528, 0.1463, 0.1073, 0.1816, 0.1530,
        0.0942])
[rfa agg] iter:  0, prev_obj_val: 3076.07666015625, obj_val: 1686.1597900390625, abs dis: 1389.9168701171875
[rfa agg] iter: 0, weight: tensor([0.0022, 0.0581, 0.0622, 0.0995, 0.0516, 0.1559, 0.1106, 0.2004, 0.1640,
        0.0955])
[rfa agg] iter:  1, prev_obj_val: 1686.1597900390625, obj_val: 1674.12255859375, abs dis: 12.0372314453125
[rfa agg] iter: 1, weight: tensor([5.6043e-05, 1.6231e-02, 1.8299e-02, 4.3585e-02, 1.3734e-02, 2.2004e-01,
        5.8455e-02, 2.7558e-01, 3.1530e-01, 3.8719e-02])
[rfa agg] iter:  2, prev_obj_val: 1674.12255859375, obj_val: 1674.489013671875, abs dis: 0.366455078125
[rfa agg] iter: 2, weight: tensor([4.3201e-05, 1.6118e-02, 1.8487e-02, 5.2681e-02, 1.3445e-02, 4.0614e-01,
        8.0044e-02, 9.8510e-02, 2.6975e-01, 4.4775e-02])
[rfa agg] iter:  3, prev_obj_val: 1674.489013671875, obj_val: 1675.4638671875, abs dis: 0.974853515625
[rfa agg] iter: 3, weight: tensor([5.7967e-05, 2.4214e-02, 2.8039e-02, 8.9384e-02, 2.0044e-02, 2.8877e-01,
        1.4999e-01, 1.0886e-01, 2.1689e-01, 7.3756e-02])
[rfa agg] iter:  4, prev_obj_val: 1675.4638671875, obj_val: 1677.627197265625, abs dis: 2.163330078125
[rfa agg] iter: 4, weight: tensor([5.6319e-05, 2.7995e-02, 3.2967e-02, 1.3380e-01, 2.2859e-02, 1.5962e-01,
        2.9708e-01, 8.5921e-02, 1.3687e-01, 1.0284e-01])
[rfa agg] iter:  5, prev_obj_val: 1677.627197265625, obj_val: 1681.5980224609375, abs dis: 3.9708251953125
[rfa agg] iter: 5, weight: tensor([3.9961e-05, 2.4504e-02, 2.9587e-02, 1.9538e-01, 1.9618e-02, 7.8875e-02,
        4.0165e-01, 5.1294e-02, 7.1631e-02, 1.2743e-01])
[rfa agg] iter:  6, prev_obj_val: 1681.5980224609375, obj_val: 1688.0220947265625, abs dis: 6.424072265625
[rfa agg] iter: 6, weight: tensor([3.6887e-05, 2.7386e-02, 3.4017e-02, 3.5388e-01, 2.1464e-02, 5.9289e-02,
        1.6617e-01, 4.2303e-02, 5.5204e-02, 2.4025e-01])
[rfa agg] iter:  7, prev_obj_val: 1688.0220947265625, obj_val: 1690.739990234375, abs dis: 2.7178955078125
[rfa agg] iter: 7, weight: tensor([4.1116e-05, 3.8713e-02, 5.0264e-02, 2.1630e-01, 2.9381e-02, 5.5824e-02,
        1.0781e-01, 4.2636e-02, 5.2871e-02, 4.0616e-01])
[rfa agg] iter:  8, prev_obj_val: 1690.739990234375, obj_val: 1685.421875, abs dis: 5.318115234375
[rfa agg] iter: 8, weight: tensor([4.8865e-05, 5.0492e-02, 6.7045e-02, 1.9572e-01, 3.7776e-02, 6.3085e-02,
        1.1274e-01, 4.9104e-02, 6.0027e-02, 3.6396e-01])
[rfa agg] iter:  9, prev_obj_val: 1685.421875, obj_val: 1687.9681396484375, abs dis: 2.5462646484375
[rfa agg] iter: 9, weight: tensor([3.1552e-05, 2.7309e-02, 3.4879e-02, 2.0996e-01, 2.0972e-02, 4.5198e-02,
        9.4945e-02, 3.3803e-02, 4.2588e-02, 4.9031e-01])
			Update norm = 144.2348887232212 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 552.2811253070831 sec.
Server Epoch:38 choose agents : [70, 37, 62, 29, 91, 31, 56, 1, 98, 4].
_Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0553, Accuracy: 354/1418 (24.9647%)
_Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 651/1418 (45.9097%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.8450, Accuracy: 86/10000 (0.8600%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0529, Accuracy: 384/1129 (34.0124%)
_Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 730/1129 (64.6590%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.4598, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   1, Avg loss: 0.0652, Accuracy: 167/568 (29.4014%)
_Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   2, Avg loss: 0.0394, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.8761, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 403/1440 (27.9861%)
_Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 661/1440 (45.9028%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.6045, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   1, Avg loss: 0.0522, Accuracy: 333/1030 (32.3301%)
_Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   2, Avg loss: 0.0267, Accuracy: 616/1030 (59.8058%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.7378, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   1, Avg loss: 0.0829, Accuracy: 64/460 (13.9130%)
_Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   2, Avg loss: 0.0383, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.8276, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 60/186 (32.2581%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3216, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0573, Accuracy: 279/928 (30.0647%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 553/928 (59.5905%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.5510, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   1, Avg loss: 0.0813, Accuracy: 16/373 (4.2895%)
_Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   2, Avg loss: 0.0475, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.4863, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0631, Accuracy: 321/901 (35.6271%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0361, Accuracy: 358/901 (39.7336%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.1510, Accuracy: 50/10000 (0.5000%)
time spent on training: 189.42037391662598
[rfa agg] training data poison_ratio: 0.13387880943910827  data num: [1418, 1129, 568, 1440, 1030, 460, 186, 928, 373, 901]
[rfa agg] considering poison per batch poison_fraction: 0.04183712794972133
[rfa agg] init. name: [70, 37, 62, 29, 91, 31, 56, 1, 98, 4], weight: tensor([0.1681, 0.1339, 0.0674, 0.1708, 0.1221, 0.0545, 0.0221, 0.1100, 0.0442,
        0.1068])
[rfa agg] iter:  0, prev_obj_val: 47.34252166748047, obj_val: 49.65751647949219, abs dis: 2.3149948120117188
[rfa agg] iter: 0, weight: tensor([0.0529, 0.0985, 0.0327, 0.0538, 0.1229, 0.0224, 0.0051, 0.3032, 0.0139,
        0.2946])
[rfa agg] iter:  1, prev_obj_val: 49.65751647949219, obj_val: 52.2763671875, abs dis: 2.6188507080078125
[rfa agg] iter: 1, weight: tensor([0.0586, 0.1016, 0.0421, 0.0595, 0.1220, 0.0284, 0.0062, 0.2874, 0.0173,
        0.2769])
[rfa agg] iter:  2, prev_obj_val: 52.2763671875, obj_val: 49.65922927856445, abs dis: 2.617137908935547
[rfa agg] iter: 2, weight: tensor([0.0673, 0.1103, 0.0565, 0.0683, 0.1284, 0.0375, 0.0079, 0.2550, 0.0223,
        0.2465])
[rfa agg] iter:  3, prev_obj_val: 49.65922927856445, obj_val: 52.276084899902344, abs dis: 2.6168556213378906
[rfa agg] iter: 3, weight: tensor([0.0591, 0.1025, 0.0424, 0.0600, 0.1232, 0.0287, 0.0063, 0.2852, 0.0174,
        0.2752])
[rfa agg] iter:  4, prev_obj_val: 52.276084899902344, obj_val: 49.65924072265625, abs dis: 2.6168441772460938
[rfa agg] iter: 4, weight: tensor([0.0673, 0.1103, 0.0565, 0.0683, 0.1285, 0.0375, 0.0079, 0.2549, 0.0223,
        0.2464])
[rfa agg] iter:  5, prev_obj_val: 49.65924072265625, obj_val: 52.276084899902344, abs dis: 2.6168441772460938
[rfa agg] iter: 5, weight: tensor([0.0591, 0.1025, 0.0424, 0.0600, 0.1232, 0.0287, 0.0063, 0.2852, 0.0174,
        0.2752])
[rfa agg] iter:  6, prev_obj_val: 52.276084899902344, obj_val: 49.65924072265625, abs dis: 2.6168441772460938
[rfa agg] iter: 6, weight: tensor([0.0673, 0.1103, 0.0565, 0.0683, 0.1285, 0.0375, 0.0079, 0.2549, 0.0223,
        0.2464])
[rfa agg] iter:  7, prev_obj_val: 49.65924072265625, obj_val: 52.276084899902344, abs dis: 2.6168441772460938
[rfa agg] iter: 7, weight: tensor([0.0591, 0.1025, 0.0424, 0.0600, 0.1232, 0.0287, 0.0063, 0.2852, 0.0174,
        0.2752])
[rfa agg] iter:  8, prev_obj_val: 52.276084899902344, obj_val: 49.65924072265625, abs dis: 2.6168441772460938
[rfa agg] iter: 8, weight: tensor([0.0673, 0.1103, 0.0565, 0.0683, 0.1285, 0.0375, 0.0079, 0.2549, 0.0223,
        0.2464])
[rfa agg] iter:  9, prev_obj_val: 49.65924072265625, obj_val: 52.276084899902344, abs dis: 2.6168441772460938
[rfa agg] iter: 9, weight: tensor([0.0591, 0.1025, 0.0424, 0.0600, 0.1232, 0.0287, 0.0063, 0.2852, 0.0174,
        0.2752])
			Update norm = 126.79801389661039 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 436.3356993198395 sec.
Server Epoch:39 choose agents : [37, 46, 50, 70, 86, 40, 74, 51, 9, 21].
poison local model 37 index 9 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   1, Avg loss: 0.0564, Accuracy: 247/1129 (21.8778%), train_poison_data_count: 360
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   2, Avg loss: 0.0289, Accuracy: 506/1129 (44.8184%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   3, Avg loss: 0.0245, Accuracy: 537/1129 (47.5642%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   4, Avg loss: 0.0247, Accuracy: 541/1129 (47.9185%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   5, Avg loss: 0.0245, Accuracy: 534/1129 (47.2985%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   6, Avg loss: 0.0237, Accuracy: 563/1129 (49.8671%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   7, Avg loss: 0.0230, Accuracy: 579/1129 (51.2843%), train_poison_data_count: 360
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   8, Avg loss: 0.0230, Accuracy: 594/1129 (52.6129%), train_poison_data_count: 360
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   9, Avg loss: 0.0228, Accuracy: 597/1129 (52.8787%), train_poison_data_count: 360
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch  10, Avg loss: 0.0229, Accuracy: 548/1129 (48.5385%), train_poison_data_count: 360
Global model norm: 112.05412074779981.
Norm before scaling: 112.03728627392312. Distance: 1.043690064131316
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2822, Accuracy: 115/10000 (1.1500%)
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: 1.0220, Accuracy: 6058/9950 (60.8844%)
Scaling by  100
Scaled Norm after poisoning: 151.5354421723677, distance: 104.36901648268274
Total norm for 2 adversaries is: 151.5354421723677. distance: 104.36901648268274
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 407/1904 (21.3761%)
_Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0321, Accuracy: 617/1904 (32.4055%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.5882, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   1, Avg loss: 0.0640, Accuracy: 137/809 (16.9345%)
_Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 372/809 (45.9827%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.2652, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 344/1418 (24.2595%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0311, Accuracy: 651/1418 (45.9097%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.5294, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   1, Avg loss: 0.0630, Accuracy: 363/1003 (36.1914%)
_Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 398/1003 (39.6810%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.7859, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 351/1573 (22.3140%)
_Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 554/1573 (35.2193%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.5249, Accuracy: 69/10000 (0.6900%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 483/1552 (31.1211%)
_Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 753/1552 (48.5180%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 10.7437, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0607, Accuracy: 220/1049 (20.9724%)
_Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0301, Accuracy: 468/1049 (44.6139%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.3170, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0502, Accuracy: 362/1275 (28.3922%)
_Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0194, Accuracy: 706/1275 (55.3725%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.4109, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 399/1949 (20.4720%)
_Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 631/1949 (32.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.1983, Accuracy: 97/10000 (0.9700%)
time spent on training: 337.6526050567627
[rfa agg] training data poison_ratio: 0.19625210453114705  data num: [1129, 1904, 809, 1418, 1003, 1573, 1552, 1049, 1275, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.061328782665983454
[rfa agg] init. name: [37, 46, 50, 70, 86, 40, 74, 51, 9, 21], weight: tensor([0.0826, 0.1394, 0.0592, 0.1038, 0.0734, 0.1151, 0.1136, 0.0768, 0.0933,
        0.1427])
[rfa agg] iter:  0, prev_obj_val: 12166.8955078125, obj_val: 7169.15771484375, abs dis: 4997.73779296875
[rfa agg] iter: 0, weight: tensor([0.0080, 0.1520, 0.0631, 0.1121, 0.0786, 0.1247, 0.1230, 0.0823, 0.1004,
        0.1558])
[rfa agg] iter:  1, prev_obj_val: 7169.15771484375, obj_val: 6689.3779296875, abs dis: 479.77978515625
[rfa agg] iter: 1, weight: tensor([0.0007, 0.1655, 0.0556, 0.1111, 0.0716, 0.1268, 0.1251, 0.0758, 0.0959,
        0.1720])
[rfa agg] iter:  2, prev_obj_val: 6689.3779296875, obj_val: 6683.83154296875, abs dis: 5.54638671875
[rfa agg] iter: 2, weight: tensor([4.0365e-05, 2.7608e-01, 1.7292e-02, 8.9332e-02, 2.6777e-02, 1.5799e-01,
        1.5619e-01, 3.0473e-02, 5.0868e-02, 1.9497e-01])
[rfa agg] iter:  3, prev_obj_val: 6683.83154296875, obj_val: 6689.013671875, abs dis: 5.18212890625
[rfa agg] iter: 3, weight: tensor([2.6652e-05, 7.2624e-02, 1.4884e-02, 1.6589e-01, 2.4911e-02, 2.8440e-01,
        2.8627e-01, 2.9354e-02, 5.8907e-02, 6.2733e-02])
[rfa agg] iter:  4, prev_obj_val: 6689.013671875, obj_val: 6692.34814453125, abs dis: 3.33447265625
[rfa agg] iter: 4, weight: tensor([3.5885e-05, 6.7431e-02, 2.5575e-02, 2.9027e-01, 4.7287e-02, 1.4299e-01,
        1.4165e-01, 5.8499e-02, 1.6499e-01, 6.1278e-02])
[rfa agg] iter:  5, prev_obj_val: 6692.34814453125, obj_val: 6698.44775390625, abs dis: 6.099609375
[rfa agg] iter: 5, weight: tensor([3.7236e-05, 6.2341e-02, 2.9837e-02, 1.9618e-01, 5.8720e-02, 1.1245e-01,
        1.1138e-01, 7.5370e-02, 2.9635e-01, 5.7339e-02])
[rfa agg] iter:  6, prev_obj_val: 6698.44775390625, obj_val: 6706.1669921875, abs dis: 7.71923828125
[rfa agg] iter: 6, weight: tensor([3.4416e-05, 4.9471e-02, 3.3865e-02, 1.0780e-01, 7.6700e-02, 7.6811e-02,
        7.5939e-02, 1.0691e-01, 4.2628e-01, 4.6190e-02])
[rfa agg] iter:  7, prev_obj_val: 6706.1669921875, obj_val: 6703.50146484375, abs dis: 2.66552734375
[rfa agg] iter: 7, weight: tensor([4.1518e-05, 5.2269e-02, 5.2811e-02, 9.2077e-02, 1.5491e-01, 7.3290e-02,
        7.2409e-02, 2.4861e-01, 2.0422e-01, 4.9360e-02])
			Update norm = 170.2669663902837 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 594.4015839099884 sec.
Server Epoch:40 choose agents : [32, 70, 52, 38, 15, 78, 83, 84, 12, 92].
_Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   1, Avg loss: 0.0604, Accuracy: 201/735 (27.3469%)
_Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 370/735 (50.3401%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.0911, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 339/1418 (23.9069%)
_Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 678/1418 (47.8138%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.7989, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   1, Avg loss: 0.0556, Accuracy: 291/636 (45.7547%)
_Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   2, Avg loss: 0.0321, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.4904, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   1, Avg loss: 0.0623, Accuracy: 251/1131 (22.1927%)
_Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   2, Avg loss: 0.0315, Accuracy: 454/1131 (40.1415%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.2852, Accuracy: 77/10000 (0.7700%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   1, Avg loss: 0.0573, Accuracy: 324/1154 (28.0763%)
_Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   2, Avg loss: 0.0292, Accuracy: 454/1154 (39.3414%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.0100, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0843, Accuracy: 33/416 (7.9327%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0478, Accuracy: 172/416 (41.3462%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.6527, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 436/1953 (22.3246%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 755/1953 (38.6585%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.6338, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 325/1190 (27.3109%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 450/1190 (37.8151%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.1567, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   1, Avg loss: 0.0871, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   2, Avg loss: 0.0473, Accuracy: 143/338 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.5324, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0522, Accuracy: 464/1715 (27.0554%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0312, Accuracy: 715/1715 (41.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.6824, Accuracy: 88/10000 (0.8800%)
time spent on training: 225.35129475593567
[rfa agg] training data poison_ratio: 0.1079917649260715  data num: [735, 1418, 636, 1131, 1154, 416, 1953, 1190, 338, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.03374742653939734
[rfa agg] init. name: [32, 70, 52, 38, 15, 78, 83, 84, 12, 92], weight: tensor([0.0688, 0.1327, 0.0595, 0.1058, 0.1080, 0.0389, 0.1828, 0.1114, 0.0316,
        0.1605])
[rfa agg] iter:  0, prev_obj_val: 56.466461181640625, obj_val: 63.7427978515625, abs dis: 7.276336669921875
[rfa agg] iter: 0, weight: tensor([0.0254, 0.0840, 0.0171, 0.1899, 0.2897, 0.0084, 0.0394, 0.2880, 0.0063,
        0.0517])
[rfa agg] iter:  1, prev_obj_val: 63.7427978515625, obj_val: 63.70545196533203, abs dis: 0.03734588623046875
[rfa agg] iter: 1, weight: tensor([0.0530, 0.0853, 0.0329, 0.2951, 0.1950, 0.0151, 0.0508, 0.1994, 0.0112,
        0.0623])
[rfa agg] iter:  2, prev_obj_val: 63.70545196533203, obj_val: 61.2962760925293, abs dis: 2.4091758728027344
[rfa agg] iter: 2, weight: tensor([0.0522, 0.0839, 0.0324, 0.3123, 0.1890, 0.0149, 0.0500, 0.1930, 0.0110,
        0.0613])
[rfa agg] iter:  3, prev_obj_val: 61.2962760925293, obj_val: 66.24420166015625, abs dis: 4.947925567626953
[rfa agg] iter: 3, weight: tensor([0.0392, 0.0754, 0.0250, 0.3514, 0.1948, 0.0117, 0.0428, 0.1978, 0.0087,
        0.0532])
[rfa agg] iter:  4, prev_obj_val: 66.24420166015625, obj_val: 63.707035064697266, abs dis: 2.5371665954589844
[rfa agg] iter: 4, weight: tensor([0.0671, 0.0902, 0.0405, 0.2804, 0.1810, 0.0182, 0.0561, 0.1853, 0.0134,
        0.0679])
[rfa agg] iter:  5, prev_obj_val: 63.707035064697266, obj_val: 61.29646682739258, abs dis: 2.4105682373046875
[rfa agg] iter: 5, weight: tensor([0.0523, 0.0841, 0.0325, 0.3110, 0.1893, 0.0149, 0.0501, 0.1932, 0.0110,
        0.0614])
[rfa agg] iter:  6, prev_obj_val: 61.29646682739258, obj_val: 66.24414825439453, abs dis: 4.947681427001953
[rfa agg] iter: 6, weight: tensor([0.0392, 0.0754, 0.0250, 0.3511, 0.1949, 0.0117, 0.0428, 0.1979, 0.0087,
        0.0532])
[rfa agg] iter:  7, prev_obj_val: 66.24414825439453, obj_val: 63.707035064697266, abs dis: 2.5371131896972656
[rfa agg] iter: 7, weight: tensor([0.0671, 0.0902, 0.0405, 0.2803, 0.1810, 0.0182, 0.0562, 0.1853, 0.0134,
        0.0679])
[rfa agg] iter:  8, prev_obj_val: 63.707035064697266, obj_val: 61.296470642089844, abs dis: 2.410564422607422
[rfa agg] iter: 8, weight: tensor([0.0523, 0.0841, 0.0325, 0.3110, 0.1893, 0.0149, 0.0501, 0.1932, 0.0110,
        0.0614])
[rfa agg] iter:  9, prev_obj_val: 61.296470642089844, obj_val: 66.24414825439453, abs dis: 4.9476776123046875
[rfa agg] iter: 9, weight: tensor([0.0392, 0.0754, 0.0250, 0.3511, 0.1949, 0.0117, 0.0428, 0.1979, 0.0087,
        0.0532])
			Update norm = 152.92305561131062 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 493.06850361824036 sec.
Server Epoch:41 choose agents : [44, 96, 66, 2, 76, 98, 52, 77, 99, 29].
poison local model 44 index 10 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0583, Accuracy: 433/1750 (24.7429%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 644/1750 (36.8000%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   3, Avg loss: 0.0318, Accuracy: 659/1750 (37.6571%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   4, Avg loss: 0.0310, Accuracy: 739/1750 (42.2286%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   5, Avg loss: 0.0304, Accuracy: 764/1750 (43.6571%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   6, Avg loss: 0.0297, Accuracy: 774/1750 (44.2286%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   7, Avg loss: 0.0289, Accuracy: 821/1750 (46.9143%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   8, Avg loss: 0.0283, Accuracy: 865/1750 (49.4286%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   9, Avg loss: 0.0279, Accuracy: 893/1750 (51.0286%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch  10, Avg loss: 0.0277, Accuracy: 870/1750 (49.7143%), train_poison_data_count: 560
Global model norm: 112.05412074779981.
Norm before scaling: 112.02482111958493. Distance: 1.2446398250060493
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.4633, Accuracy: 108/10000 (1.0800%)
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: 0.8545, Accuracy: 9287/9950 (93.3367%)
Scaling by  100
Scaled Norm after poisoning: 165.03398087590932, distance: 124.46398748106819
Total norm for 1 adversaries is: 165.03398087590932. distance: 124.46398748106819
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 42/311 (13.5048%)
_Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3678, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 269/1402 (19.1869%)
_Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 400/1402 (28.5307%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.2609, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0621, Accuracy: 232/605 (38.3471%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0391, Accuracy: 324/605 (53.5537%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.8685, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 44/466 (9.4421%)
_Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   2, Avg loss: 0.0502, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.6638, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   1, Avg loss: 0.0811, Accuracy: 20/373 (5.3619%)
_Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   2, Avg loss: 0.0472, Accuracy: 156/373 (41.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.4966, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   1, Avg loss: 0.0563, Accuracy: 290/636 (45.5975%)
_Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   2, Avg loss: 0.0316, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.3906, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 335/1340 (25.0000%)
_Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 527/1340 (39.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.7425, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   1, Avg loss: 0.0674, Accuracy: 186/773 (24.0621%)
_Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   2, Avg loss: 0.0313, Accuracy: 396/773 (51.2290%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.2860, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   1, Avg loss: 0.0488, Accuracy: 400/1440 (27.7778%)
_Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 662/1440 (45.9722%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.0468, Accuracy: 67/10000 (0.6700%)
time spent on training: 303.0953748226166
[rfa agg] training data poison_ratio: 0.19239226033421283  data num: [1750, 311, 1402, 605, 466, 373, 636, 1340, 773, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.06012258135444151
[rfa agg] init. name: [44, 96, 66, 2, 76, 98, 52, 77, 99, 29], weight: tensor([0.1924, 0.0342, 0.1541, 0.0665, 0.0512, 0.0410, 0.0699, 0.1473, 0.0850,
        0.1583])
[rfa agg] iter:  0, prev_obj_val: 38875.0859375, obj_val: 28191.1796875, abs dis: 10683.90625
[rfa agg] iter: 0, weight: tensor([0.0536, 0.0399, 0.1810, 0.0777, 0.0598, 0.0479, 0.0817, 0.1729, 0.0994,
        0.1859])
[rfa agg] iter:  1, prev_obj_val: 28191.1796875, obj_val: 25080.443359375, abs dis: 3110.736328125
[rfa agg] iter: 1, weight: tensor([0.0133, 0.0411, 0.1897, 0.0805, 0.0619, 0.0494, 0.0847, 0.1810, 0.1033,
        0.1951])
[rfa agg] iter:  2, prev_obj_val: 25080.443359375, obj_val: 24301.435546875, abs dis: 779.0078125
[rfa agg] iter: 2, weight: tensor([0.0031, 0.0396, 0.1958, 0.0791, 0.0603, 0.0478, 0.0832, 0.1861, 0.1027,
        0.2022])
[rfa agg] iter:  3, prev_obj_val: 24301.435546875, obj_val: 24123.091796875, abs dis: 178.34375
[rfa agg] iter: 3, weight: tensor([0.0007, 0.0322, 0.2145, 0.0692, 0.0511, 0.0393, 0.0727, 0.1994, 0.0944,
        0.2266])
[rfa agg] iter:  4, prev_obj_val: 24123.091796875, obj_val: 24112.634765625, abs dis: 10.45703125
[rfa agg] iter: 4, weight: tensor([7.6397e-05, 9.4579e-03, 2.7161e-01, 2.4583e-02, 1.6704e-02, 1.1954e-02,
        2.5824e-02, 1.9922e-01, 3.9241e-02, 4.0133e-01])
[rfa agg] iter:  5, prev_obj_val: 24112.634765625, obj_val: 24114.955078125, abs dis: 2.3203125
[rfa agg] iter: 5, weight: tensor([5.2899e-05, 8.7167e-03, 2.6702e-01, 2.5491e-02, 1.6367e-02, 1.1220e-02,
        2.6754e-02, 4.0093e-01, 4.6357e-02, 1.9709e-01])
[rfa agg] iter:  6, prev_obj_val: 24114.955078125, obj_val: 24117.5546875, abs dis: 2.599609375
[rfa agg] iter: 6, weight: tensor([7.0249e-05, 1.2390e-02, 2.5002e-01, 3.7583e-02, 2.3701e-02, 1.6034e-02,
        3.9416e-02, 3.5306e-01, 7.1597e-02, 1.9613e-01])
			Update norm = 165.8113161944172 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 550.7269184589386 sec.
Server Epoch:42 choose agents : [5, 45, 88, 53, 24, 60, 19, 4, 51, 79].
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 354/1628 (21.7445%)
_Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   2, Avg loss: 0.0260, Accuracy: 808/1628 (49.6314%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.6340, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0676, Accuracy: 196/669 (29.2975%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0405, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.8693, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   1, Avg loss: 0.0769, Accuracy: 132/603 (21.8905%)
_Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   2, Avg loss: 0.0457, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.8566, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   1, Avg loss: 0.0503, Accuracy: 283/813 (34.8093%)
_Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   2, Avg loss: 0.0192, Accuracy: 449/813 (55.2276%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.5925, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   1, Avg loss: 0.0755, Accuracy: 43/312 (13.7821%)
_Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   2, Avg loss: 0.0399, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.4372, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 573/2227 (25.7297%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1064/2227 (47.7773%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.7107, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   1, Avg loss: 0.0466, Accuracy: 385/1036 (37.1622%)
_Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   2, Avg loss: 0.0255, Accuracy: 679/1036 (65.5405%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.3556, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0623, Accuracy: 326/901 (36.1820%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0337, Accuracy: 378/901 (41.9534%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.9466, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   1, Avg loss: 0.0611, Accuracy: 221/1049 (21.0677%)
_Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 512/1049 (48.8084%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.3696, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   1, Avg loss: 0.1010, Accuracy: 20/197 (10.1523%)
_Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   2, Avg loss: 0.0863, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3348, Accuracy: 50/10000 (0.5000%)
time spent on training: 207.59259748458862
[rfa agg] training data poison_ratio: 0.17254901960784313  data num: [1628, 669, 603, 813, 312, 2227, 1036, 901, 1049, 197]
[rfa agg] considering poison per batch poison_fraction: 0.05392156862745098
[rfa agg] init. name: [5, 45, 88, 53, 24, 60, 19, 4, 51, 79], weight: tensor([0.1725, 0.0709, 0.0639, 0.0862, 0.0331, 0.2360, 0.1098, 0.0955, 0.1112,
        0.0209])
[rfa agg] iter:  0, prev_obj_val: 73.20018768310547, obj_val: 75.13170623779297, abs dis: 1.9315185546875
[rfa agg] iter: 0, weight: tensor([0.0799, 0.0376, 0.0297, 0.0635, 0.0094, 0.0518, 0.2943, 0.1142, 0.3140,
        0.0055])
[rfa agg] iter:  1, prev_obj_val: 75.13170623779297, obj_val: 78.12080383300781, abs dis: 2.9890975952148438
[rfa agg] iter: 1, weight: tensor([0.0510, 0.0484, 0.0359, 0.1018, 0.0097, 0.0377, 0.2023, 0.3003, 0.2073,
        0.0056])
[rfa agg] iter:  2, prev_obj_val: 78.12080383300781, obj_val: 80.02725219726562, abs dis: 1.9064483642578125
[rfa agg] iter: 2, weight: tensor([0.0472, 0.0625, 0.0443, 0.1610, 0.0109, 0.0363, 0.1315, 0.3672, 0.1329,
        0.0062])
[rfa agg] iter:  3, prev_obj_val: 80.02725219726562, obj_val: 80.01460266113281, abs dis: 0.0126495361328125
[rfa agg] iter: 3, weight: tensor([0.0489, 0.0782, 0.0537, 0.2382, 0.0124, 0.0383, 0.1195, 0.2831, 0.1207,
        0.0070])
[rfa agg] iter:  4, prev_obj_val: 80.01460266113281, obj_val: 80.01445770263672, abs dis: 0.00014495849609375
[rfa agg] iter: 4, weight: tensor([0.0488, 0.0784, 0.0537, 0.2472, 0.0124, 0.0383, 0.1193, 0.2741, 0.1207,
        0.0070])
			Update norm = 131.0029371092496 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3010, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.3249, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 455.63373160362244 sec.
Server Epoch:43 choose agents : [49, 71, 38, 53, 30, 18, 45, 40, 35, 5].
poison local model 49 index 11 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   1, Avg loss: 0.0795, Accuracy: 23/440 (5.2273%), train_poison_data_count: 140
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   2, Avg loss: 0.0501, Accuracy: 144/440 (32.7273%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   3, Avg loss: 0.0399, Accuracy: 141/440 (32.0455%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   4, Avg loss: 0.0369, Accuracy: 140/440 (31.8182%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   5, Avg loss: 0.0350, Accuracy: 152/440 (34.5455%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   6, Avg loss: 0.0342, Accuracy: 167/440 (37.9545%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   7, Avg loss: 0.0334, Accuracy: 168/440 (38.1818%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   8, Avg loss: 0.0342, Accuracy: 152/440 (34.5455%), train_poison_data_count: 140
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   9, Avg loss: 0.0326, Accuracy: 158/440 (35.9091%), train_poison_data_count: 140
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch  10, Avg loss: 0.0316, Accuracy: 164/440 (37.2727%), train_poison_data_count: 140
Global model norm: 112.05412074779981.
Norm before scaling: 112.04998100038884. Distance: 0.6364341755188004
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.6237, Accuracy: 63/10000 (0.6300%)
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: 1.2121, Accuracy: 7842/9950 (78.8141%)
Scaling by  100
Scaled Norm after poisoning: 128.3485777945163, distance: 63.64341196635163
Total norm for 3 adversaries is: 128.3485777945163. distance: 63.64341196635163
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 151/818 (18.4597%)
_Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   2, Avg loss: 0.0304, Accuracy: 341/818 (41.6870%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.2081, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   1, Avg loss: 0.0616, Accuracy: 247/1131 (21.8391%)
_Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 513/1131 (45.3581%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.4625, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   1, Avg loss: 0.0503, Accuracy: 281/813 (34.5633%)
_Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.7093, Accuracy: 51/10000 (0.5100%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0805, Accuracy: 67/486 (13.7860%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0418, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.9102, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   1, Avg loss: 0.0744, Accuracy: 123/530 (23.2075%)
_Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   2, Avg loss: 0.0380, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.2636, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0679, Accuracy: 192/669 (28.6996%)
_Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0398, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.8259, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0553, Accuracy: 358/1573 (22.7591%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 525/1573 (33.3757%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.8136, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   1, Avg loss: 0.0859, Accuracy: 37/271 (13.6531%)
_Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   2, Avg loss: 0.0565, Accuracy: 97/271 (35.7934%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3978, Accuracy: 41/10000 (0.4100%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   1, Avg loss: 0.0508, Accuracy: 411/1628 (25.2457%)
_Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   2, Avg loss: 0.0262, Accuracy: 764/1628 (46.9287%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.2042, Accuracy: 137/10000 (1.3700%)
time spent on training: 294.68422293663025
[rfa agg] training data poison_ratio: 0.30553894006460103  data num: [440, 818, 1131, 813, 486, 530, 669, 1573, 271, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.09548091877018783
[rfa agg] init. name: [49, 71, 38, 53, 30, 18, 45, 40, 35, 5], weight: tensor([0.0526, 0.0979, 0.1353, 0.0973, 0.0581, 0.0634, 0.0800, 0.1882, 0.0324,
        0.1948])
[rfa agg] iter:  0, prev_obj_val: 3114.545654296875, obj_val: 1727.9119873046875, abs dis: 1386.6336669921875
[rfa agg] iter: 0, weight: tensor([0.0030, 0.1002, 0.1424, 0.0996, 0.0580, 0.0636, 0.0811, 0.2059, 0.0318,
        0.2143])
[rfa agg] iter:  1, prev_obj_val: 1727.9119873046875, obj_val: 1713.1854248046875, abs dis: 14.7265625
[rfa agg] iter: 1, weight: tensor([5.8391e-05, 2.7973e-02, 6.0799e-02, 2.7807e-02, 1.2150e-02, 1.4004e-02,
        1.9946e-02, 3.4105e-01, 5.8157e-03, 4.9040e-01])
[rfa agg] iter:  2, prev_obj_val: 1713.1854248046875, obj_val: 1709.563232421875, abs dis: 3.6221923828125
[rfa agg] iter: 2, weight: tensor([8.3024e-05, 5.9821e-02, 1.7966e-01, 5.9403e-02, 2.2922e-02, 2.6917e-02,
        4.0085e-02, 3.3447e-01, 1.0506e-02, 2.6613e-01])
[rfa agg] iter:  3, prev_obj_val: 1709.563232421875, obj_val: 1711.7777099609375, abs dis: 2.2144775390625
[rfa agg] iter: 3, weight: tensor([6.2552e-05, 7.3304e-02, 5.2123e-01, 7.2723e-02, 2.3018e-02, 2.7744e-02,
        4.4212e-02, 1.2008e-01, 9.9588e-03, 1.0767e-01])
[rfa agg] iter:  4, prev_obj_val: 1711.7777099609375, obj_val: 1715.930419921875, abs dis: 4.1527099609375
[rfa agg] iter: 4, weight: tensor([7.4198e-05, 1.8142e-01, 2.6232e-01, 1.7971e-01, 3.8078e-02, 4.7894e-02,
        8.6372e-02, 9.7606e-02, 1.5138e-02, 9.1398e-02])
[rfa agg] iter:  5, prev_obj_val: 1715.930419921875, obj_val: 1719.8231201171875, abs dis: 3.8927001953125
[rfa agg] iter: 5, weight: tensor([3.8641e-05, 3.4105e-01, 6.8973e-02, 3.3432e-01, 2.9653e-02, 4.0280e-02,
        9.6440e-02, 4.0364e-02, 1.0308e-02, 3.8569e-02])
[rfa agg] iter:  6, prev_obj_val: 1719.8231201171875, obj_val: 1722.172607421875, abs dis: 2.3494873046875
[rfa agg] iter: 6, weight: tensor([4.6669e-05, 2.6124e-01, 6.9270e-02, 2.6064e-01, 4.4638e-02, 6.4166e-02,
        1.9754e-01, 4.5003e-02, 1.4191e-02, 4.3272e-02])
[rfa agg] iter:  7, prev_obj_val: 1722.172607421875, obj_val: 1722.150390625, abs dis: 0.022216796875
[rfa agg] iter: 7, weight: tensor([4.8364e-05, 1.9275e-01, 6.6463e-02, 1.9354e-01, 5.2721e-02, 7.9384e-02,
        3.1103e-01, 4.4936e-02, 1.5818e-02, 4.3313e-02])
[rfa agg] iter:  8, prev_obj_val: 1722.150390625, obj_val: 1724.68310546875, abs dis: 2.53271484375
[rfa agg] iter: 8, weight: tensor([4.6970e-05, 1.8370e-01, 6.4554e-02, 1.8591e-01, 5.1225e-02, 7.7368e-02,
        3.3612e-01, 4.3643e-02, 1.5377e-02, 4.2060e-02])
[rfa agg] iter:  9, prev_obj_val: 1724.68310546875, obj_val: 1730.566162109375, abs dis: 5.883056640625
[rfa agg] iter: 9, weight: tensor([4.3806e-05, 1.3411e-01, 5.6008e-02, 1.3494e-01, 5.5367e-02, 8.8796e-02,
        4.3805e-01, 3.9263e-02, 1.5491e-02, 3.7930e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3026, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.3293, Accuracy: 0/9950 (0.0000%)
saving model
Done in 544.5099949836731 sec.
Server Epoch:44 choose agents : [91, 35, 89, 37, 4, 10, 47, 36, 24, 61].
_Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   1, Avg loss: 0.0513, Accuracy: 328/1030 (31.8447%)
_Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   2, Avg loss: 0.0251, Accuracy: 639/1030 (62.0388%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.7224, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0855, Accuracy: 41/271 (15.1292%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0570, Accuracy: 97/271 (35.7934%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.4099, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   1, Avg loss: 0.0620, Accuracy: 332/896 (37.0536%)
_Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 446/896 (49.7768%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.2711, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   1, Avg loss: 0.0522, Accuracy: 384/1129 (34.0124%)
_Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   2, Avg loss: 0.0249, Accuracy: 727/1129 (64.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.9931, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0608, Accuracy: 332/901 (36.8479%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0336, Accuracy: 390/901 (43.2852%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.1724, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 222/861 (25.7840%)
_Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 459/861 (53.3101%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.3924, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   1, Avg loss: 0.1240, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   2, Avg loss: 0.1093, Accuracy: 22/134 (16.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3216, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.0857, Accuracy: 79/408 (19.3627%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0532, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.5828, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   1, Avg loss: 0.0759, Accuracy: 44/312 (14.1026%)
_Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.4626, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   1, Avg loss: 0.1274, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   2, Avg loss: 0.1177, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3134, Accuracy: 40/10000 (0.4000%)
time spent on training: 197.87524032592773
[rfa agg] training data poison_ratio: 0.3442840550854488  data num: [1030, 271, 896, 1129, 901, 861, 134, 408, 312, 85]
[rfa agg] considering poison per batch poison_fraction: 0.10758876721420274
[rfa agg] init. name: [91, 35, 89, 37, 4, 10, 47, 36, 24, 61], weight: tensor([0.1709, 0.0450, 0.1487, 0.1873, 0.1495, 0.1429, 0.0222, 0.0677, 0.0518,
        0.0141])
[rfa agg] iter:  0, prev_obj_val: 42.579830169677734, obj_val: 37.417327880859375, abs dis: 5.162502288818359
[rfa agg] iter: 0, weight: tensor([0.1241, 0.0277, 0.2312, 0.1162, 0.1692, 0.2229, 0.0104, 0.0604, 0.0320,
        0.0059])
[rfa agg] iter:  1, prev_obj_val: 37.417327880859375, obj_val: 37.41001510620117, abs dis: 0.007312774658203125
[rfa agg] iter: 1, weight: tensor([0.1105, 0.0178, 0.2705, 0.1008, 0.1713, 0.2614, 0.0069, 0.0365, 0.0205,
        0.0039])
			Update norm = 117.09034722837958 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3026, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.3293, Accuracy: 0/9950 (0.0000%)
saving model
Done in 446.12409138679504 sec.
Server Epoch:45 choose agents : [55, 62, 30, 4, 18, 38, 76, 69, 42, 68].
poison local model 55 index 12 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Avg loss: 0.0593, Accuracy: 228/1071 (21.2885%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Avg loss: 0.0305, Accuracy: 372/1071 (34.7339%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   3, Avg loss: 0.0289, Accuracy: 407/1071 (38.0019%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   4, Avg loss: 0.0279, Accuracy: 421/1071 (39.3091%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   5, Avg loss: 0.0277, Accuracy: 436/1071 (40.7096%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   6, Avg loss: 0.0271, Accuracy: 445/1071 (41.5500%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   7, Avg loss: 0.0268, Accuracy: 460/1071 (42.9505%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   8, Avg loss: 0.0255, Accuracy: 471/1071 (43.9776%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   9, Avg loss: 0.0261, Accuracy: 486/1071 (45.3782%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch  10, Avg loss: 0.0264, Accuracy: 489/1071 (45.6583%), train_poison_data_count: 340
Global model norm: 112.05316208305993.
Norm before scaling: 112.03803152417709. Distance: 1.0451149450173627
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.5758, Accuracy: 78/10000 (0.7800%)
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: 0.9866, Accuracy: 8471/9950 (85.1357%)
Scaling by  100
Scaled Norm after poisoning: 151.75773507880908, distance: 104.5114985076403
Total norm for 2 adversaries is: 151.75773507880908. distance: 104.5114985076403
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0654, Accuracy: 161/568 (28.3451%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0411, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.8745, Accuracy: 55/10000 (0.5500%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   1, Avg loss: 0.0796, Accuracy: 73/486 (15.0206%)
_Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.0187, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0620, Accuracy: 330/901 (36.6260%)
_Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0345, Accuracy: 368/901 (40.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.1225, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   1, Avg loss: 0.0739, Accuracy: 121/530 (22.8302%)
_Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   2, Avg loss: 0.0382, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.3884, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0620, Accuracy: 248/1131 (21.9275%)
_Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 465/1131 (41.1141%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.4497, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0864, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0482, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.7347, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   1, Avg loss: 0.0596, Accuracy: 285/590 (48.3051%)
_Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.7090, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 341/1372 (24.8542%)
_Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 532/1372 (38.7755%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.1114, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0627, Accuracy: 367/1163 (31.5563%)
_Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0378, Accuracy: 400/1163 (34.3938%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.9194, Accuracy: 67/10000 (0.6700%)
time spent on training: 304.72037410736084
[rfa agg] training data poison_ratio: 0.18808891036482242  data num: [1071, 568, 486, 901, 530, 1131, 466, 590, 1372, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.05877778448900701
[rfa agg] init. name: [55, 62, 30, 4, 18, 38, 76, 69, 42, 68], weight: tensor([0.1294, 0.0686, 0.0587, 0.1088, 0.0640, 0.1366, 0.0563, 0.0713, 0.1657,
        0.1405])
[rfa agg] iter:  0, prev_obj_val: 17101.31640625, obj_val: 11034.17578125, abs dis: 6067.140625
[rfa agg] iter: 0, weight: tensor([0.0216, 0.0767, 0.0655, 0.1223, 0.0715, 0.1539, 0.0629, 0.0797, 0.1874,
        0.1584])
[rfa agg] iter:  1, prev_obj_val: 11034.17578125, obj_val: 9995.4345703125, abs dis: 1038.7412109375
[rfa agg] iter: 1, weight: tensor([0.0032, 0.0759, 0.0646, 0.1244, 0.0708, 0.1587, 0.0619, 0.0793, 0.1970,
        0.1642])
[rfa agg] iter:  2, prev_obj_val: 9995.4345703125, obj_val: 9865.2412109375, abs dis: 130.193359375
[rfa agg] iter: 2, weight: tensor([0.0004, 0.0603, 0.0500, 0.1186, 0.0563, 0.1691, 0.0479, 0.0647, 0.2505,
        0.1822])
[rfa agg] iter:  3, prev_obj_val: 9865.2412109375, obj_val: 9867.8212890625, abs dis: 2.580078125
[rfa agg] iter: 3, weight: tensor([3.8664e-05, 1.9278e-02, 1.4846e-02, 8.8575e-02, 1.7973e-02, 4.3678e-01,
        1.4225e-02, 2.2486e-02, 1.0309e-01, 2.8271e-01])
[rfa agg] iter:  4, prev_obj_val: 9867.8212890625, obj_val: 9872.892578125, abs dis: 5.0712890625
[rfa agg] iter: 4, weight: tensor([5.6361e-05, 3.8743e-02, 2.8764e-02, 3.8577e-01, 3.6103e-02, 1.9708e-01,
        2.7539e-02, 4.7312e-02, 9.3275e-02, 1.4535e-01])
[rfa agg] iter:  5, prev_obj_val: 9872.892578125, obj_val: 9874.47265625, abs dis: 1.580078125
[rfa agg] iter: 5, weight: tensor([7.1884e-05, 7.1003e-02, 4.9906e-02, 3.1975e-01, 6.6186e-02, 1.4095e-01,
        4.7714e-02, 9.3702e-02, 9.1377e-02, 1.1934e-01])
[rfa agg] iter:  6, prev_obj_val: 9874.47265625, obj_val: 9877.697265625, abs dis: 3.224609375
[rfa agg] iter: 6, weight: tensor([7.6507e-05, 8.5040e-02, 5.8446e-02, 2.6148e-01, 7.9189e-02, 1.3530e-01,
        5.5878e-02, 1.1609e-01, 9.1942e-02, 1.1657e-01])
[rfa agg] iter:  7, prev_obj_val: 9877.697265625, obj_val: 9877.6845703125, abs dis: 0.0126953125
[rfa agg] iter: 7, weight: tensor([7.6255e-05, 1.1219e-01, 7.2538e-02, 1.7747e-01, 1.0420e-01, 1.1290e-01,
        6.9272e-02, 1.6891e-01, 8.2594e-02, 9.9834e-02])
			Update norm = 112.63901567202414 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3026, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.3293, Accuracy: 0/9950 (0.0000%)
saving model
Done in 556.2030408382416 sec.
Server Epoch:46 choose agents : [34, 94, 32, 2, 30, 67, 17, 61, 73, 89].
_Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   1, Avg loss: 0.0589, Accuracy: 399/1427 (27.9608%)
_Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 572/1427 (40.0841%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.9058, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   1, Avg loss: 0.0558, Accuracy: 326/1662 (19.6149%)
_Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 602/1662 (36.2214%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8578, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   1, Avg loss: 0.0607, Accuracy: 202/735 (27.4830%)
_Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 361/735 (49.1156%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.5629, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0618, Accuracy: 232/605 (38.3471%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.0953, Accuracy: 53/10000 (0.5300%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0795, Accuracy: 81/486 (16.6667%)
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0403, Accuracy: 214/486 (44.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8977, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   1, Avg loss: 0.0774, Accuracy: 55/426 (12.9108%)
_Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   2, Avg loss: 0.0414, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.7464, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 391/1574 (24.8412%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 668/1574 (42.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.1214, Accuracy: 104/10000 (1.0400%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   1, Avg loss: 0.1254, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   2, Avg loss: 0.1188, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3140, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   1, Avg loss: 0.0657, Accuracy: 170/938 (18.1237%)
_Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   2, Avg loss: 0.0340, Accuracy: 313/938 (33.3689%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.5969, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0613, Accuracy: 329/896 (36.7188%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 446/896 (49.7768%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.3655, Accuracy: 50/10000 (0.5000%)
time spent on training: 219.48898267745972
[rfa agg] training data poison_ratio: 0.06463663119764546  data num: [1427, 1662, 735, 605, 486, 426, 1574, 85, 938, 896]
[rfa agg] considering poison per batch poison_fraction: 0.020198947249264205
[rfa agg] init. name: [34, 94, 32, 2, 30, 67, 17, 61, 73, 89], weight: tensor([0.1615, 0.1881, 0.0832, 0.0685, 0.0550, 0.0482, 0.1782, 0.0096, 0.1062,
        0.1014])
[rfa agg] iter:  0, prev_obj_val: 61.00944900512695, obj_val: 65.73957061767578, abs dis: 4.730121612548828
[rfa agg] iter: 0, weight: tensor([0.0778, 0.0650, 0.0848, 0.0449, 0.0266, 0.0206, 0.0680, 0.0026, 0.3994,
        0.2103])
[rfa agg] iter:  1, prev_obj_val: 65.73957061767578, obj_val: 69.83936309814453, abs dis: 4.09979248046875
[rfa agg] iter: 1, weight: tensor([0.0549, 0.0487, 0.1590, 0.0618, 0.0322, 0.0239, 0.0501, 0.0027, 0.2162,
        0.3506])
[rfa agg] iter:  2, prev_obj_val: 69.83936309814453, obj_val: 72.05877685546875, abs dis: 2.2194137573242188
[rfa agg] iter: 2, weight: tensor([0.0533, 0.0484, 0.3239, 0.0908, 0.0420, 0.0302, 0.0495, 0.0031, 0.1423,
        0.2163])
[rfa agg] iter:  3, prev_obj_val: 72.05877685546875, obj_val: 74.64344787597656, abs dis: 2.5846710205078125
[rfa agg] iter: 3, weight: tensor([0.0443, 0.0406, 0.4566, 0.0979, 0.0411, 0.0289, 0.0414, 0.0028, 0.1038,
        0.1425])
[rfa agg] iter:  4, prev_obj_val: 74.64344787597656, obj_val: 74.64081573486328, abs dis: 0.00263214111328125
[rfa agg] iter: 4, weight: tensor([0.0462, 0.0428, 0.4181, 0.1372, 0.0509, 0.0349, 0.0435, 0.0032, 0.0974,
        0.1258])
[rfa agg] iter:  5, prev_obj_val: 74.64081573486328, obj_val: 77.43632507324219, abs dis: 2.7955093383789062
[rfa agg] iter: 5, weight: tensor([0.0465, 0.0430, 0.4136, 0.1394, 0.0513, 0.0351, 0.0437, 0.0033, 0.0979,
        0.1263])
[rfa agg] iter:  6, prev_obj_val: 77.43632507324219, obj_val: 77.4244613647461, abs dis: 0.01186370849609375
[rfa agg] iter: 6, weight: tensor([0.0513, 0.0479, 0.2909, 0.2205, 0.0685, 0.0453, 0.0486, 0.0040, 0.0994,
        0.1236])
[rfa agg] iter:  7, prev_obj_val: 77.4244613647461, obj_val: 77.42436981201172, abs dis: 9.1552734375e-05
[rfa agg] iter: 7, weight: tensor([0.0514, 0.0480, 0.2820, 0.2280, 0.0688, 0.0455, 0.0487, 0.0040, 0.0996,
        0.1240])
			Update norm = 104.1501976564375 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3026, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.3293, Accuracy: 0/9950 (0.0000%)
saving model
Done in 470.40738010406494 sec.
Server Epoch:47 choose agents : [61, 49, 64, 19, 88, 44, 5, 46, 59, 14].
poison local model 61 index 13 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   1, Avg loss: 0.1305, Accuracy: 0/85 (0.0000%), train_poison_data_count: 40
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   2, Avg loss: 0.1174, Accuracy: 2/85 (2.3529%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   3, Avg loss: 0.1012, Accuracy: 28/85 (32.9412%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   4, Avg loss: 0.0974, Accuracy: 38/85 (44.7059%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   5, Avg loss: 0.0933, Accuracy: 39/85 (45.8824%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   6, Avg loss: 0.0902, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   7, Avg loss: 0.0850, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   8, Avg loss: 0.0803, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   9, Avg loss: 0.0788, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch  10, Avg loss: 0.0759, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Global model norm: 112.05316208305993.
Norm before scaling: 112.05237335728324. Distance: 0.20999468155211515
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3895, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: 3.2807, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 113.90680726887003, distance: 20.999468842101475
Total norm for 4 adversaries is: 113.90680726887003. distance: 20.999468842101475
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   1, Avg loss: 0.0775, Accuracy: 38/440 (8.6364%)
_Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   2, Avg loss: 0.0463, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.6204, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 175/953 (18.3631%)
_Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   2, Avg loss: 0.0384, Accuracy: 303/953 (31.7943%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.7151, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 388/1036 (37.4517%)
_Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0236, Accuracy: 673/1036 (64.9614%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.9822, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   1, Avg loss: 0.0751, Accuracy: 144/603 (23.8806%)
_Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   2, Avg loss: 0.0463, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.0075, Accuracy: 47/10000 (0.4700%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   1, Avg loss: 0.0599, Accuracy: 404/1750 (23.0857%)
_Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 654/1750 (37.3714%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.4912, Accuracy: 113/10000 (1.1300%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 368/1628 (22.6044%)
_Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   2, Avg loss: 0.0259, Accuracy: 793/1628 (48.7101%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.1223, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   1, Avg loss: 0.0555, Accuracy: 416/1904 (21.8487%)
_Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 667/1904 (35.0315%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.0337, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   1, Avg loss: 0.0533, Accuracy: 305/1089 (28.0073%)
_Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 500/1089 (45.9137%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.6211, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 220/1013 (21.7177%)
_Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 334/1013 (32.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.7947, Accuracy: 68/10000 (0.6800%)
time spent on training: 313.9522294998169
[rfa agg] training data poison_ratio: 0.3716788877249786  data num: [85, 440, 953, 1036, 603, 1750, 1628, 1904, 1089, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.11614965241405581
[rfa agg] init. name: [61, 49, 64, 19, 88, 44, 5, 46, 59, 14], weight: tensor([0.0081, 0.0419, 0.0908, 0.0987, 0.0574, 0.1667, 0.1550, 0.1813, 0.1037,
        0.0965])
[rfa agg] iter:  0, prev_obj_val: 147.79127502441406, obj_val: 134.42820739746094, abs dis: 13.363067626953125
[rfa agg] iter: 0, weight: tensor([4.2264e-05, 1.0920e-02, 3.8177e-02, 4.8895e-02, 1.7497e-02, 2.8329e-01,
        2.5179e-01, 2.4906e-01, 5.6343e-02, 4.3982e-02])
[rfa agg] iter:  1, prev_obj_val: 134.42820739746094, obj_val: 134.86541748046875, abs dis: 0.4372100830078125
[rfa agg] iter: 1, weight: tensor([4.1583e-05, 1.3604e-02, 5.6798e-02, 8.0667e-02, 2.2790e-02, 1.9448e-01,
        3.1530e-01, 1.4837e-01, 9.9384e-02, 6.8570e-02])
[rfa agg] iter:  2, prev_obj_val: 134.86541748046875, obj_val: 135.81024169921875, abs dis: 0.94482421875
[rfa agg] iter: 2, weight: tensor([4.4610e-05, 1.7230e-02, 8.5882e-02, 1.3899e-01, 3.0051e-02, 1.3589e-01,
        1.7707e-01, 1.1561e-01, 1.8937e-01, 1.0987e-01])
[rfa agg] iter:  3, prev_obj_val: 135.81024169921875, obj_val: 140.1954803466797, abs dis: 4.3852386474609375
[rfa agg] iter: 3, weight: tensor([2.6963e-05, 1.2695e-02, 8.6998e-02, 2.0266e-01, 2.3534e-02, 6.0938e-02,
        7.1810e-02, 5.4922e-02, 3.5773e-01, 1.2869e-01])
[rfa agg] iter:  4, prev_obj_val: 140.1954803466797, obj_val: 142.17098999023438, abs dis: 1.9755096435546875
[rfa agg] iter: 4, weight: tensor([2.0568e-05, 1.1724e-02, 1.3323e-01, 2.8233e-01, 2.3450e-02, 3.8516e-02,
        4.3373e-02, 3.5770e-02, 1.6700e-01, 2.6459e-01])
[rfa agg] iter:  5, prev_obj_val: 142.17098999023438, obj_val: 147.58970642089844, abs dis: 5.4187164306640625
[rfa agg] iter: 5, weight: tensor([1.9543e-05, 1.1763e-02, 1.6591e-01, 2.0756e-01, 2.4151e-02, 3.5098e-02,
        3.9186e-02, 3.2794e-02, 1.1908e-01, 3.6444e-01])
[rfa agg] iter:  6, prev_obj_val: 147.58970642089844, obj_val: 147.53347778320312, abs dis: 0.0562286376953125
[rfa agg] iter: 6, weight: tensor([2.4364e-05, 1.6490e-02, 3.0908e-01, 1.4628e-01, 3.6055e-02, 4.0451e-02,
        4.4491e-02, 3.8206e-02, 1.0385e-01, 2.6508e-01])
[rfa agg] iter:  7, prev_obj_val: 147.53347778320312, obj_val: 147.5272216796875, abs dis: 0.006256103515625
[rfa agg] iter: 7, weight: tensor([2.3118e-05, 1.5647e-02, 3.5787e-01, 1.3713e-01, 3.4212e-02, 3.8382e-02,
        4.2209e-02, 3.6249e-02, 9.8474e-02, 2.3981e-01])
[rfa agg] iter:  8, prev_obj_val: 147.5272216796875, obj_val: 144.6912841796875, abs dis: 2.8359375
[rfa agg] iter: 8, weight: tensor([2.2607e-05, 1.5298e-02, 3.7687e-01, 1.3353e-01, 3.3443e-02, 3.7530e-02,
        4.1268e-02, 3.5443e-02, 9.6176e-02, 2.3042e-01])
[rfa agg] iter:  9, prev_obj_val: 144.6912841796875, obj_val: 144.66844177246094, abs dis: 0.0228424072265625
[rfa agg] iter: 9, weight: tensor([2.0978e-05, 1.3364e-02, 2.9133e-01, 1.5567e-01, 2.8243e-02, 3.6187e-02,
        4.0080e-02, 3.3999e-02, 1.0457e-01, 2.9653e-01])
			Update norm = 143.30084721487168 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3026, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.3293, Accuracy: 0/9950 (0.0000%)
saving model
Done in 567.1568462848663 sec.
Server Epoch:48 choose agents : [21, 78, 90, 85, 84, 38, 88, 31, 97, 66].
_Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 397/1949 (20.3694%)
_Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 642/1949 (32.9400%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.2403, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   1, Avg loss: 0.0844, Accuracy: 37/416 (8.8942%)
_Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   2, Avg loss: 0.0476, Accuracy: 162/416 (38.9423%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.6826, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0553, Accuracy: 328/677 (48.4490%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 452/677 (66.7651%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.6599, Accuracy: 62/10000 (0.6200%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 451/1988 (22.6861%)
_Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 671/1988 (33.7525%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.0287, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   1, Avg loss: 0.0624, Accuracy: 318/1190 (26.7227%)
_Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 435/1190 (36.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.1517, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0610, Accuracy: 258/1131 (22.8117%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 497/1131 (43.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.5236, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0754, Accuracy: 142/603 (23.5489%)
_Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0461, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.1004, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 76/460 (16.5217%)
_Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   2, Avg loss: 0.0390, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.8979, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   1, Avg loss: 0.0526, Accuracy: 348/1213 (28.6892%)
_Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   2, Avg loss: 0.0278, Accuracy: 473/1213 (38.9942%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.7124, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   1, Avg loss: 0.0622, Accuracy: 258/1402 (18.4023%)
_Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 379/1402 (27.0328%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.5349, Accuracy: 75/10000 (0.7500%)
time spent on training: 231.45858335494995
[rfa agg] training data poison_ratio: 0.18025206274367575  data num: [1949, 416, 677, 1988, 1190, 1131, 603, 460, 1213, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.056328769607398674
[rfa agg] init. name: [21, 78, 90, 85, 84, 38, 88, 31, 97, 66], weight: tensor([0.1767, 0.0377, 0.0614, 0.1803, 0.1079, 0.1025, 0.0547, 0.0417, 0.1100,
        0.1271])
[rfa agg] iter:  0, prev_obj_val: 63.09550857543945, obj_val: 71.24748229980469, abs dis: 8.151973724365234
[rfa agg] iter: 0, weight: tensor([0.0426, 0.0084, 0.0200, 0.0400, 0.2580, 0.1619, 0.0160, 0.0101, 0.3115,
        0.1316])
[rfa agg] iter:  1, prev_obj_val: 71.24748229980469, obj_val: 71.20523071289062, abs dis: 0.0422515869140625
[rfa agg] iter: 1, weight: tensor([0.0500, 0.0149, 0.0403, 0.0475, 0.1946, 0.2982, 0.0308, 0.0183, 0.2063,
        0.0991])
[rfa agg] iter:  2, prev_obj_val: 71.20523071289062, obj_val: 71.20457458496094, abs dis: 0.0006561279296875
[rfa agg] iter: 2, weight: tensor([0.0490, 0.0146, 0.0395, 0.0466, 0.1876, 0.3181, 0.0302, 0.0180, 0.1994,
        0.0971])
			Update norm = 156.25249998000032 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3026, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.3293, Accuracy: 0/9950 (0.0000%)
saving model
Done in 484.25270986557007 sec.
Server Epoch:49 choose agents : [65, 16, 50, 5, 97, 4, 13, 23, 86, 72].
poison local model 65 index 14 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Avg loss: 0.0549, Accuracy: 374/1475 (25.3559%), train_poison_data_count: 463
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Avg loss: 0.0316, Accuracy: 569/1475 (38.5763%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   3, Avg loss: 0.0285, Accuracy: 566/1475 (38.3729%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   4, Avg loss: 0.0277, Accuracy: 620/1475 (42.0339%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   5, Avg loss: 0.0268, Accuracy: 650/1475 (44.0678%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   6, Avg loss: 0.0267, Accuracy: 660/1475 (44.7458%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   7, Avg loss: 0.0259, Accuracy: 685/1475 (46.4407%), train_poison_data_count: 463
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   8, Avg loss: 0.0256, Accuracy: 706/1475 (47.8644%), train_poison_data_count: 463
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   9, Avg loss: 0.0251, Accuracy: 708/1475 (48.0000%), train_poison_data_count: 463
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch  10, Avg loss: 0.0252, Accuracy: 704/1475 (47.7288%), train_poison_data_count: 463
Global model norm: 112.05316208305993.
Norm before scaling: 112.02900102345151. Distance: 1.1542626906753433
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.7951, Accuracy: 85/10000 (0.8500%)
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: 0.8177, Accuracy: 9543/9950 (95.9095%)
Scaling by  100
Scaled Norm after poisoning: 158.7590487086484, distance: 115.42627347954624
Total norm for 2 adversaries is: 158.7590487086484. distance: 115.42627347954624
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   1, Avg loss: 0.0653, Accuracy: 282/708 (39.8305%)
_Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   2, Avg loss: 0.0358, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.0667, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   1, Avg loss: 0.0643, Accuracy: 143/809 (17.6761%)
_Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 340/809 (42.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.4863, Accuracy: 89/10000 (0.8900%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   1, Avg loss: 0.0509, Accuracy: 396/1628 (24.3243%)
_Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   2, Avg loss: 0.0260, Accuracy: 769/1628 (47.2359%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.2421, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0525, Accuracy: 352/1213 (29.0190%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 518/1213 (42.7040%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.9343, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0617, Accuracy: 331/901 (36.7370%)
_Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0334, Accuracy: 418/901 (46.3929%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.5690, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 348/1645 (21.1550%)
_Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 624/1645 (37.9331%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.8714, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   1, Avg loss: 0.0591, Accuracy: 320/715 (44.7552%)
_Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   2, Avg loss: 0.0398, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.9331, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   1, Avg loss: 0.0635, Accuracy: 349/1003 (34.7956%)
_Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   2, Avg loss: 0.0354, Accuracy: 361/1003 (35.9920%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.7599, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 242/1241 (19.5004%)
_Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 424/1241 (34.1660%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.3466, Accuracy: 61/10000 (0.6100%)
time spent on training: 336.9242813587189
[rfa agg] training data poison_ratio: 0.2736814252954666  data num: [1475, 708, 809, 1628, 1213, 901, 1645, 715, 1003, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.08552544540483331
[rfa agg] init. name: [65, 16, 50, 5, 97, 4, 13, 23, 86, 72], weight: tensor([0.1301, 0.0624, 0.0714, 0.1436, 0.1070, 0.0795, 0.1451, 0.0631, 0.0885,
        0.1095])
[rfa agg] iter:  0, prev_obj_val: 24254.787109375, obj_val: 15666.6201171875, abs dis: 8588.1669921875
[rfa agg] iter: 0, weight: tensor([0.0218, 0.0699, 0.0799, 0.1622, 0.1203, 0.0891, 0.1638, 0.0706, 0.0993,
        0.1231])
[rfa agg] iter:  1, prev_obj_val: 15666.6201171875, obj_val: 14196.7109375, abs dis: 1469.9091796875
[rfa agg] iter: 1, weight: tensor([0.0033, 0.0696, 0.0798, 0.1688, 0.1224, 0.0895, 0.1706, 0.0703, 0.1001,
        0.1257])
[rfa agg] iter:  2, prev_obj_val: 14196.7109375, obj_val: 13991.0673828125, abs dis: 205.6435546875
[rfa agg] iter: 2, weight: tensor([0.0005, 0.0588, 0.0687, 0.1970, 0.1194, 0.0802, 0.1991, 0.0593, 0.0915,
        0.1256])
[rfa agg] iter:  3, prev_obj_val: 13991.0673828125, obj_val: 13987.5693359375, abs dis: 3.498046875
[rfa agg] iter: 3, weight: tensor([5.6231e-05, 2.9307e-02, 3.6816e-02, 2.3653e-01, 1.3494e-01, 5.1086e-02,
        2.3651e-01, 2.9595e-02, 6.4813e-02, 1.8034e-01])
[rfa agg] iter:  4, prev_obj_val: 13987.5693359375, obj_val: 13993.7109375, abs dis: 6.1416015625
[rfa agg] iter: 4, weight: tensor([3.4957e-05, 2.4986e-02, 3.2564e-02, 7.6173e-02, 2.5576e-01, 5.0246e-02,
        7.6796e-02, 2.5238e-02, 6.9044e-02, 3.8916e-01])
[rfa agg] iter:  5, prev_obj_val: 13993.7109375, obj_val: 14001.4521484375, abs dis: 7.7412109375
[rfa agg] iter: 5, weight: tensor([4.0264e-05, 5.0508e-02, 7.3011e-02, 5.5721e-02, 1.5079e-01, 1.6526e-01,
        5.6229e-02, 5.0910e-02, 2.8355e-01, 1.1397e-01])
[rfa agg] iter:  6, prev_obj_val: 14001.4521484375, obj_val: 14006.8173828125, abs dis: 5.365234375
[rfa agg] iter: 6, weight: tensor([3.7192e-05, 8.1093e-02, 1.4221e-01, 4.2624e-02, 7.9950e-02, 2.8216e-01,
        4.3024e-02, 8.1190e-02, 1.8046e-01, 6.7249e-02])
[rfa agg] iter:  7, prev_obj_val: 14006.8173828125, obj_val: 14009.7216796875, abs dis: 2.904296875
[rfa agg] iter: 7, weight: tensor([3.7288e-05, 1.2627e-01, 2.6814e-01, 3.9351e-02, 6.5887e-02, 1.6524e-01,
        3.9705e-02, 1.2315e-01, 1.1497e-01, 5.7248e-02])
[rfa agg] iter:  8, prev_obj_val: 14009.7216796875, obj_val: 14016.619140625, abs dis: 6.8974609375
[rfa agg] iter: 8, weight: tensor([3.3010e-05, 1.5233e-01, 3.3740e-01, 3.3512e-02, 5.3573e-02, 1.1217e-01,
        3.3815e-02, 1.4423e-01, 8.5802e-02, 4.7134e-02])
[rfa agg] iter:  9, prev_obj_val: 14016.619140625, obj_val: 14016.5732421875, abs dis: 0.0458984375
[rfa agg] iter: 9, weight: tensor([3.4355e-05, 2.7108e-01, 1.9520e-01, 3.2401e-02, 4.7932e-02, 8.0637e-02,
        3.2700e-02, 2.2886e-01, 6.8142e-02, 4.3011e-02])
			Update norm = 112.98917951511994 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3026, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.3293, Accuracy: 0/9950 (0.0000%)
saving model
Done in 584.5464508533478 sec.
Server Epoch:50 choose agents : [44, 46, 85, 2, 36, 48, 98, 55, 22, 81].
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   1, Avg loss: 0.0593, Accuracy: 391/1750 (22.3429%)
_Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 644/1750 (36.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.6865, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 425/1904 (22.3214%)
_Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 655/1904 (34.4013%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.6298, Accuracy: 100/10000 (1.0000%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   1, Avg loss: 0.0537, Accuracy: 441/1988 (22.1831%)
_Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   2, Avg loss: 0.0360, Accuracy: 667/1988 (33.5513%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.0329, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.0624, Accuracy: 238/605 (39.3388%)
_Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.9684, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   1, Avg loss: 0.0861, Accuracy: 84/408 (20.5882%)
_Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   2, Avg loss: 0.0555, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.5579, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0714, Accuracy: 104/631 (16.4818%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0421, Accuracy: 225/631 (35.6577%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.9817, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   1, Avg loss: 0.0808, Accuracy: 21/373 (5.6300%)
_Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   2, Avg loss: 0.0479, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.5027, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 247/1071 (23.0626%)
_Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/1071 (45.7516%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.0883, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 492/1470 (33.4694%)
_Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 822/1470 (55.9184%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.1502, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0697, Accuracy: 244/774 (31.5245%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0359, Accuracy: 314/774 (40.5685%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.3970, Accuracy: 67/10000 (0.6700%)
time spent on training: 233.76000213623047
[rfa agg] training data poison_ratio: 0.4382176052487698  data num: [1750, 1904, 1988, 605, 408, 631, 373, 1071, 1470, 774]
[rfa agg] considering poison per batch poison_fraction: 0.13694300164024056
[rfa agg] init. name: [44, 46, 85, 2, 36, 48, 98, 55, 22, 81], weight: tensor([0.1595, 0.1735, 0.1812, 0.0551, 0.0372, 0.0575, 0.0340, 0.0976, 0.1340,
        0.0705])
[rfa agg] iter:  0, prev_obj_val: 75.00598907470703, obj_val: 77.58267211914062, abs dis: 2.5766830444335938
[rfa agg] iter: 0, weight: tensor([0.1346, 0.1161, 0.1002, 0.0334, 0.0175, 0.0349, 0.0149, 0.1723, 0.3163,
        0.0597])
[rfa agg] iter:  1, prev_obj_val: 77.58267211914062, obj_val: 78.90166473388672, abs dis: 1.3189926147460938
[rfa agg] iter: 1, weight: tensor([0.1227, 0.1084, 0.0951, 0.0381, 0.0195, 0.0397, 0.0165, 0.2433, 0.2458,
        0.0708])
[rfa agg] iter:  2, prev_obj_val: 78.90166473388672, obj_val: 81.60845947265625, abs dis: 2.7067947387695312
[rfa agg] iter: 2, weight: tensor([0.1134, 0.1012, 0.0894, 0.0393, 0.0199, 0.0410, 0.0168, 0.2934, 0.2107,
        0.0749])
[rfa agg] iter:  3, prev_obj_val: 81.60845947265625, obj_val: 86.50536346435547, abs dis: 4.896903991699219
[rfa agg] iter: 3, weight: tensor([0.0867, 0.0787, 0.0705, 0.0375, 0.0184, 0.0390, 0.0154, 0.4340, 0.1439,
        0.0759])
[rfa agg] iter:  4, prev_obj_val: 86.50536346435547, obj_val: 86.48123168945312, abs dis: 0.02413177490234375
[rfa agg] iter: 4, weight: tensor([0.0596, 0.0553, 0.0503, 0.0363, 0.0168, 0.0378, 0.0139, 0.5580, 0.0878,
        0.0843])
[rfa agg] iter:  5, prev_obj_val: 86.48123168945312, obj_val: 86.4798583984375, abs dis: 0.001373291015625
[rfa agg] iter: 5, weight: tensor([0.0553, 0.0513, 0.0467, 0.0337, 0.0156, 0.0351, 0.0129, 0.5897, 0.0814,
        0.0782])
[rfa agg] iter:  6, prev_obj_val: 86.4798583984375, obj_val: 88.62505340576172, abs dis: 2.1451950073242188
[rfa agg] iter: 6, weight: tensor([0.0543, 0.0504, 0.0459, 0.0331, 0.0153, 0.0344, 0.0127, 0.5972, 0.0799,
        0.0767])
[rfa agg] iter:  7, prev_obj_val: 88.62505340576172, obj_val: 92.9743881225586, abs dis: 4.349334716796875
[rfa agg] iter: 7, weight: tensor([0.0679, 0.0634, 0.0579, 0.0466, 0.0211, 0.0485, 0.0173, 0.4653, 0.0969,
        0.1151])
[rfa agg] iter:  8, prev_obj_val: 92.9743881225586, obj_val: 88.62908172607422, abs dis: 4.345306396484375
[rfa agg] iter: 8, weight: tensor([0.0759, 0.0716, 0.0660, 0.0675, 0.0286, 0.0702, 0.0233, 0.2929, 0.1030,
        0.2011])
[rfa agg] iter:  9, prev_obj_val: 88.62908172607422, obj_val: 86.50178527832031, abs dis: 2.1272964477539062
[rfa agg] iter: 9, weight: tensor([0.0716, 0.0669, 0.0611, 0.0493, 0.0223, 0.0514, 0.0183, 0.4332, 0.1024,
        0.1235])
			Update norm = 151.79175959600047 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3026, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.3293, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 490.2582817077637 sec.
Server Epoch:51 choose agents : [85, 13, 26, 47, 58, 96, 62, 76, 7, 72].
poison local model 85 index 15 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 457/1988 (22.9879%), train_poison_data_count: 624
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 646/1988 (32.4950%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   3, Avg loss: 0.0325, Accuracy: 685/1988 (34.4567%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   4, Avg loss: 0.0326, Accuracy: 697/1988 (35.0604%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   5, Avg loss: 0.0324, Accuracy: 715/1988 (35.9658%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   6, Avg loss: 0.0322, Accuracy: 729/1988 (36.6700%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   7, Avg loss: 0.0316, Accuracy: 731/1988 (36.7706%), train_poison_data_count: 624
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   8, Avg loss: 0.0312, Accuracy: 746/1988 (37.5252%), train_poison_data_count: 624
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   9, Avg loss: 0.0311, Accuracy: 744/1988 (37.4245%), train_poison_data_count: 624
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch  10, Avg loss: 0.0307, Accuracy: 745/1988 (37.4748%), train_poison_data_count: 624
Global model norm: 112.05316208305993.
Norm before scaling: 112.01857058653266. Distance: 1.2458331275012677
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9529, Accuracy: 82/10000 (0.8200%)
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: 0.9935, Accuracy: 9299/9950 (93.4573%)
Scaling by  100
Scaled Norm after poisoning: 164.7628207739082, distance: 124.58332505922492
Total norm for 1 adversaries is: 164.7628207739082. distance: 124.58332505922492
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   1, Avg loss: 0.0581, Accuracy: 297/1645 (18.0547%)
_Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 621/1645 (37.7508%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.0483, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 340/1446 (23.5131%)
_Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 501/1446 (34.6473%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.2843, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   1, Avg loss: 0.1218, Accuracy: 3/134 (2.2388%)
_Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   2, Avg loss: 0.1046, Accuracy: 26/134 (19.4030%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3232, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 342/803 (42.5903%)
_Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 409/803 (50.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.0438, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   1, Avg loss: 0.0778, Accuracy: 49/311 (15.7556%)
_Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   2, Avg loss: 0.0538, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3806, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   1, Avg loss: 0.0654, Accuracy: 165/568 (29.0493%)
_Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   2, Avg loss: 0.0394, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.9347, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.0862, Accuracy: 36/466 (7.7253%)
_Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0490, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.8615, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 349/891 (39.1695%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0266, Accuracy: 412/891 (46.2402%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.5628, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0622, Accuracy: 242/1241 (19.5004%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 420/1241 (33.8437%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.3554, Accuracy: 54/10000 (0.5400%)
time spent on training: 325.7181816101074
[rfa agg] training data poison_ratio: 0.2094174655008954  data num: [1988, 1645, 1446, 134, 803, 311, 568, 466, 891, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.06544295796902981
[rfa agg] init. name: [85, 13, 26, 47, 58, 96, 62, 76, 7, 72], weight: tensor([0.2094, 0.1733, 0.1523, 0.0141, 0.0846, 0.0328, 0.0598, 0.0491, 0.0939,
        0.1307])
[rfa agg] iter:  0, prev_obj_val: 47343.65234375, obj_val: 35383.67578125, abs dis: 11959.9765625
[rfa agg] iter: 0, weight: tensor([0.0655, 0.2053, 0.1803, 0.0166, 0.0998, 0.0386, 0.0705, 0.0579, 0.1108,
        0.1546])
[rfa agg] iter:  1, prev_obj_val: 35383.67578125, obj_val: 31447.283203125, abs dis: 3936.392578125
[rfa agg] iter: 1, weight: tensor([0.0182, 0.2169, 0.1901, 0.0173, 0.1046, 0.0402, 0.0737, 0.0604, 0.1161,
        0.1627])
[rfa agg] iter:  2, prev_obj_val: 31447.283203125, obj_val: 30337.115234375, abs dis: 1110.16796875
[rfa agg] iter: 2, weight: tensor([0.0048, 0.2243, 0.1951, 0.0169, 0.1046, 0.0394, 0.0730, 0.0597, 0.1165,
        0.1657])
[rfa agg] iter:  3, prev_obj_val: 30337.115234375, obj_val: 30040.84375, abs dis: 296.271484375
[rfa agg] iter: 3, weight: tensor([0.0012, 0.2433, 0.2047, 0.0147, 0.0995, 0.0350, 0.0670, 0.0543, 0.1118,
        0.1685])
[rfa agg] iter:  4, prev_obj_val: 30040.84375, obj_val: 29983.826171875, abs dis: 57.017578125
[rfa agg] iter: 4, weight: tensor([2.5965e-04, 3.4172e-01, 2.3148e-01, 8.4457e-03, 7.2765e-02, 2.0889e-02,
        4.3847e-02, 3.4682e-02, 8.4387e-02, 1.6153e-01])
[rfa agg] iter:  5, prev_obj_val: 29983.826171875, obj_val: 29985.642578125, abs dis: 1.81640625
[rfa agg] iter: 5, weight: tensor([5.1609e-05, 1.6790e-01, 4.7211e-01, 2.9074e-03, 3.6860e-02, 7.5602e-03,
        1.8093e-02, 1.3779e-02, 4.5889e-02, 2.3486e-01])
[rfa agg] iter:  6, prev_obj_val: 29985.642578125, obj_val: 29987.818359375, abs dis: 2.17578125
[rfa agg] iter: 6, weight: tensor([4.9050e-05, 1.0681e-01, 1.8695e-01, 3.0837e-03, 4.4874e-02, 8.1347e-03,
        2.0302e-02, 1.5264e-02, 5.7755e-02, 5.5678e-01])
[rfa agg] iter:  7, prev_obj_val: 29987.818359375, obj_val: 29990.7109375, abs dis: 2.892578125
[rfa agg] iter: 7, weight: tensor([5.8128e-05, 1.0862e-01, 1.6463e-01, 3.8788e-03, 6.1852e-02, 1.0320e-02,
        2.6454e-02, 1.9726e-02, 8.1483e-02, 5.2298e-01])
[rfa agg] iter:  8, prev_obj_val: 29990.7109375, obj_val: 29992.154296875, abs dis: 1.443359375
[rfa agg] iter: 8, weight: tensor([7.7441e-05, 1.2699e-01, 1.7710e-01, 5.5066e-03, 9.8534e-02, 1.4797e-02,
        3.9143e-02, 2.8895e-02, 1.3443e-01, 3.7453e-01])
[rfa agg] iter:  9, prev_obj_val: 29992.154296875, obj_val: 29993.619140625, abs dis: 1.46484375
[rfa agg] iter: 9, weight: tensor([8.2692e-05, 1.2785e-01, 1.7277e-01, 6.0819e-03, 1.1696e-01, 1.6434e-02,
        4.4275e-02, 3.2486e-02, 1.6397e-01, 3.1910e-01])
			Update norm = 156.31476782641172 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3026, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.3293, Accuracy: 0/9950 (0.0000%)
saving model
Done in 579.8099601268768 sec.
Server Epoch:52 choose agents : [9, 47, 83, 58, 50, 6, 68, 26, 40, 71].
_Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   1, Avg loss: 0.0503, Accuracy: 356/1275 (27.9216%)
_Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   2, Avg loss: 0.0199, Accuracy: 695/1275 (54.5098%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.5575, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   1, Avg loss: 0.1222, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   2, Avg loss: 0.1098, Accuracy: 25/134 (18.6567%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3241, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 419/1953 (21.4542%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 791/1953 (40.5018%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.2062, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 340/803 (42.3412%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 388/803 (48.3188%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.0349, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   1, Avg loss: 0.0641, Accuracy: 134/809 (16.5637%)
_Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 369/809 (45.6119%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.4215, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   1, Avg loss: 0.0553, Accuracy: 386/1956 (19.7342%)
_Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   2, Avg loss: 0.0326, Accuracy: 639/1956 (32.6687%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.1420, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   1, Avg loss: 0.0630, Accuracy: 370/1163 (31.8143%)
_Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   2, Avg loss: 0.0365, Accuracy: 447/1163 (38.4351%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.6135, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 345/1446 (23.8589%)
_Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 504/1446 (34.8548%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.1819, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 335/1573 (21.2969%)
_Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 573/1573 (36.4272%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.3725, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   1, Avg loss: 0.0642, Accuracy: 148/818 (18.0929%)
_Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   2, Avg loss: 0.0313, Accuracy: 321/818 (39.2421%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.4595, Accuracy: 65/10000 (0.6500%)
time spent on training: 250.27477598190308
[rfa agg] training data poison_ratio: 0.0  data num: [1275, 134, 1953, 803, 809, 1956, 1163, 1446, 1573, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [9, 47, 83, 58, 50, 6, 68, 26, 40, 71], weight: tensor([0.1069, 0.0112, 0.1637, 0.0673, 0.0678, 0.1640, 0.0975, 0.1212, 0.1319,
        0.0686])
[rfa agg] iter:  0, prev_obj_val: 57.316932678222656, obj_val: 61.54691696166992, abs dis: 4.229984283447266
[rfa agg] iter: 0, weight: tensor([0.3515, 0.0022, 0.0537, 0.0309, 0.0311, 0.0539, 0.1914, 0.1541, 0.0996,
        0.0315])
[rfa agg] iter:  1, prev_obj_val: 61.54691696166992, obj_val: 68.47569274902344, abs dis: 6.928775787353516
[rfa agg] iter: 1, weight: tensor([0.2824, 0.0022, 0.0433, 0.0354, 0.0356, 0.0434, 0.3590, 0.0935, 0.0692,
        0.0361])
[rfa agg] iter:  2, prev_obj_val: 68.47569274902344, obj_val: 70.95109558105469, abs dis: 2.47540283203125
[rfa agg] iter: 2, weight: tensor([0.1958, 0.0037, 0.0579, 0.0705, 0.0709, 0.0581, 0.2838, 0.1036, 0.0837,
        0.0720])
[rfa agg] iter:  3, prev_obj_val: 70.95109558105469, obj_val: 66.0196762084961, abs dis: 4.931419372558594
[rfa agg] iter: 3, weight: tensor([0.1801, 0.0042, 0.0612, 0.0868, 0.0872, 0.0613, 0.2403, 0.1043, 0.0860,
        0.0886])
[rfa agg] iter:  4, prev_obj_val: 66.0196762084961, obj_val: 66.00760650634766, abs dis: 0.0120697021484375
[rfa agg] iter: 4, weight: tensor([0.2095, 0.0032, 0.0534, 0.0567, 0.0570, 0.0535, 0.3285, 0.1008, 0.0795,
        0.0578])
[rfa agg] iter:  5, prev_obj_val: 66.00760650634766, obj_val: 66.00751495361328, abs dis: 9.1552734375e-05
[rfa agg] iter: 5, weight: tensor([0.2072, 0.0031, 0.0527, 0.0559, 0.0562, 0.0528, 0.3370, 0.0995, 0.0785,
        0.0570])
			Update norm = 165.1253607585007 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3026, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.3293, Accuracy: 0/9950 (0.0000%)
saving model
Done in 500.3913357257843 sec.
Server Epoch:53 choose agents : [50, 14, 84, 8, 25, 5, 40, 98, 72, 69].
_Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   1, Avg loss: 0.0643, Accuracy: 140/809 (17.3053%)
_Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 341/809 (42.1508%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.2470, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   1, Avg loss: 0.0627, Accuracy: 221/1013 (21.8164%)
_Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 307/1013 (30.3060%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.7848, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   1, Avg loss: 0.0616, Accuracy: 325/1190 (27.3109%)
_Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 449/1190 (37.7311%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.2595, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0605, Accuracy: 238/1513 (15.7303%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 475/1513 (31.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.4736, Accuracy: 100/10000 (1.0000%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   1, Avg loss: 0.0559, Accuracy: 310/690 (44.9275%)
_Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.4817, Accuracy: 56/10000 (0.5600%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0513, Accuracy: 389/1628 (23.8943%)
_Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 820/1628 (50.3686%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3836, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 365/1573 (23.2041%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0353, Accuracy: 540/1573 (34.3293%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.9066, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   1, Avg loss: 0.0805, Accuracy: 25/373 (6.7024%)
_Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   2, Avg loss: 0.0483, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.5437, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   1, Avg loss: 0.0621, Accuracy: 256/1241 (20.6285%)
_Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   2, Avg loss: 0.0359, Accuracy: 430/1241 (34.6495%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.6612, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0573, Accuracy: 296/590 (50.1695%)
_Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0347, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.0436, Accuracy: 50/10000 (0.5000%)
time spent on training: 231.02778482437134
[rfa agg] training data poison_ratio: 0.21826741996233523  data num: [809, 1013, 1190, 1513, 690, 1628, 1573, 373, 1241, 590]
[rfa agg] considering poison per batch poison_fraction: 0.06820856873822975
[rfa agg] init. name: [50, 14, 84, 8, 25, 5, 40, 98, 72, 69], weight: tensor([0.0762, 0.0954, 0.1121, 0.1425, 0.0650, 0.1533, 0.1481, 0.0351, 0.1169,
        0.0556])
[rfa agg] iter:  0, prev_obj_val: 51.87128448486328, obj_val: 57.29255676269531, abs dis: 5.421272277832031
[rfa agg] iter: 0, weight: tensor([0.0723, 0.2886, 0.1979, 0.0778, 0.0415, 0.0653, 0.0709, 0.0122, 0.1431,
        0.0304])
[rfa agg] iter:  1, prev_obj_val: 57.29255676269531, obj_val: 61.94529724121094, abs dis: 4.652740478515625
[rfa agg] iter: 1, weight: tensor([0.1045, 0.4260, 0.1117, 0.0595, 0.0510, 0.0519, 0.0554, 0.0131, 0.0910,
        0.0358])
[rfa agg] iter:  2, prev_obj_val: 61.94529724121094, obj_val: 57.29233932495117, abs dis: 4.652957916259766
[rfa agg] iter: 2, weight: tensor([0.2002, 0.2648, 0.1071, 0.0654, 0.0798, 0.0582, 0.0615, 0.0180, 0.0917,
        0.0534])
[rfa agg] iter:  3, prev_obj_val: 57.29233932495117, obj_val: 61.94477844238281, abs dis: 4.652439117431641
[rfa agg] iter: 3, weight: tensor([0.1059, 0.4244, 0.1112, 0.0596, 0.0512, 0.0520, 0.0555, 0.0132, 0.0910,
        0.0359])
[rfa agg] iter:  4, prev_obj_val: 61.94477844238281, obj_val: 57.29236602783203, abs dis: 4.652412414550781
[rfa agg] iter: 4, weight: tensor([0.2003, 0.2647, 0.1071, 0.0654, 0.0798, 0.0582, 0.0615, 0.0180, 0.0917,
        0.0534])
[rfa agg] iter:  5, prev_obj_val: 57.29236602783203, obj_val: 61.94477844238281, abs dis: 4.652412414550781
[rfa agg] iter: 5, weight: tensor([0.1059, 0.4244, 0.1112, 0.0596, 0.0512, 0.0520, 0.0555, 0.0132, 0.0910,
        0.0359])
[rfa agg] iter:  6, prev_obj_val: 61.94477844238281, obj_val: 57.29236602783203, abs dis: 4.652412414550781
[rfa agg] iter: 6, weight: tensor([0.2003, 0.2647, 0.1071, 0.0654, 0.0798, 0.0582, 0.0615, 0.0180, 0.0917,
        0.0534])
[rfa agg] iter:  7, prev_obj_val: 57.29236602783203, obj_val: 61.94477844238281, abs dis: 4.652412414550781
[rfa agg] iter: 7, weight: tensor([0.1059, 0.4244, 0.1112, 0.0596, 0.0512, 0.0520, 0.0555, 0.0132, 0.0910,
        0.0359])
[rfa agg] iter:  8, prev_obj_val: 61.94477844238281, obj_val: 57.29236602783203, abs dis: 4.652412414550781
[rfa agg] iter: 8, weight: tensor([0.2003, 0.2647, 0.1071, 0.0654, 0.0798, 0.0582, 0.0615, 0.0180, 0.0917,
        0.0534])
[rfa agg] iter:  9, prev_obj_val: 57.29236602783203, obj_val: 61.94477844238281, abs dis: 4.652412414550781
[rfa agg] iter: 9, weight: tensor([0.1059, 0.4244, 0.1112, 0.0596, 0.0512, 0.0520, 0.0555, 0.0132, 0.0910,
        0.0359])
			Update norm = 134.54222153287049 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3026, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.3293, Accuracy: 0/9950 (0.0000%)
saving model
Done in 479.87313985824585 sec.
Server Epoch:54 choose agents : [72, 22, 50, 1, 38, 36, 52, 32, 73, 85].
_Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   1, Avg loss: 0.0624, Accuracy: 252/1241 (20.3062%)
_Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 385/1241 (31.0234%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.1937, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 498/1470 (33.8776%)
_Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 833/1470 (56.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.2397, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   1, Avg loss: 0.0638, Accuracy: 136/809 (16.8109%)
_Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   2, Avg loss: 0.0274, Accuracy: 356/809 (44.0049%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.2597, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 288/928 (31.0345%)
_Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 562/928 (60.5603%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.7226, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0619, Accuracy: 250/1131 (22.1043%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 486/1131 (42.9708%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.7596, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   1, Avg loss: 0.0859, Accuracy: 81/408 (19.8529%)
_Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   2, Avg loss: 0.0547, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.5467, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0562, Accuracy: 284/636 (44.6541%)
_Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.4904, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   1, Avg loss: 0.0613, Accuracy: 204/735 (27.7551%)
_Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 356/735 (48.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1136, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   1, Avg loss: 0.0657, Accuracy: 182/938 (19.4030%)
_Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   2, Avg loss: 0.0338, Accuracy: 319/938 (34.0085%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.2672, Accuracy: 48/10000 (0.4800%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 460/1988 (23.1388%)
_Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 652/1988 (32.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.2272, Accuracy: 82/10000 (0.8200%)
time spent on training: 235.0326657295227
[rfa agg] training data poison_ratio: 0.19330999611046285  data num: [1241, 1470, 809, 928, 1131, 408, 636, 735, 938, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.06040937378451964
[rfa agg] init. name: [72, 22, 50, 1, 38, 36, 52, 32, 73, 85], weight: tensor([0.1207, 0.1429, 0.0787, 0.0902, 0.1100, 0.0397, 0.0618, 0.0715, 0.0912,
        0.1933])
[rfa agg] iter:  0, prev_obj_val: 56.212669372558594, obj_val: 60.46576690673828, abs dis: 4.2530975341796875
[rfa agg] iter: 0, weight: tensor([0.1171, 0.0763, 0.0770, 0.1781, 0.2175, 0.0146, 0.0332, 0.0550, 0.1874,
        0.0437])
[rfa agg] iter:  1, prev_obj_val: 60.46576690673828, obj_val: 64.64801025390625, abs dis: 4.182243347167969
[rfa agg] iter: 1, weight: tensor([0.0595, 0.0458, 0.1282, 0.2469, 0.0839, 0.0144, 0.0372, 0.0753, 0.2784,
        0.0303])
[rfa agg] iter:  2, prev_obj_val: 64.64801025390625, obj_val: 64.60792541503906, abs dis: 0.0400848388671875
[rfa agg] iter: 2, weight: tensor([0.0556, 0.0453, 0.2653, 0.1607, 0.0723, 0.0183, 0.0521, 0.1302, 0.1685,
        0.0316])
[rfa agg] iter:  3, prev_obj_val: 64.60792541503906, obj_val: 67.00423431396484, abs dis: 2.3963088989257812
[rfa agg] iter: 3, weight: tensor([0.0541, 0.0439, 0.2912, 0.1529, 0.0702, 0.0178, 0.0507, 0.1275, 0.1609,
        0.0307])
[rfa agg] iter:  4, prev_obj_val: 67.00423431396484, obj_val: 72.76821899414062, abs dis: 5.763984680175781
[rfa agg] iter: 4, weight: tensor([0.0469, 0.0390, 0.3623, 0.1133, 0.0592, 0.0180, 0.0547, 0.1612, 0.1175,
        0.0279])
[rfa agg] iter:  5, prev_obj_val: 72.76821899414062, obj_val: 79.51063537597656, abs dis: 6.7424163818359375
[rfa agg] iter: 5, weight: tensor([0.0463, 0.0399, 0.2142, 0.0888, 0.0559, 0.0242, 0.0888, 0.3210, 0.0910,
        0.0298])
[rfa agg] iter:  6, prev_obj_val: 79.51063537597656, obj_val: 76.02730560302734, abs dis: 3.4833297729492188
[rfa agg] iter: 6, weight: tensor([0.0526, 0.0468, 0.1468, 0.0866, 0.0613, 0.0383, 0.1945, 0.2485, 0.0883,
        0.0362])
[rfa agg] iter:  7, prev_obj_val: 76.02730560302734, obj_val: 76.0196304321289, abs dis: 0.0076751708984375
[rfa agg] iter: 7, weight: tensor([0.0487, 0.0427, 0.1629, 0.0859, 0.0577, 0.0299, 0.1303, 0.3218, 0.0878,
        0.0325])
[rfa agg] iter:  8, prev_obj_val: 76.0196304321289, obj_val: 72.7125244140625, abs dis: 3.3071060180664062
[rfa agg] iter: 8, weight: tensor([0.0479, 0.0420, 0.1604, 0.0845, 0.0567, 0.0294, 0.1262, 0.3346, 0.0864,
        0.0319])
[rfa agg] iter:  9, prev_obj_val: 72.7125244140625, obj_val: 79.51766967773438, abs dis: 6.805145263671875
[rfa agg] iter: 9, weight: tensor([0.0424, 0.0366, 0.1802, 0.0813, 0.0512, 0.0222, 0.0824, 0.3930, 0.0834,
        0.0273])
			Update norm = 104.38984737212235 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3026, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.3293, Accuracy: 0/9950 (0.0000%)
saving model
Done in 487.5713403224945 sec.
Server Epoch:55 choose agents : [33, 58, 47, 9, 19, 26, 45, 81, 95, 56].
_Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   1, Avg loss: 0.0799, Accuracy: 63/515 (12.2330%)
_Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   2, Avg loss: 0.0509, Accuracy: 110/515 (21.3592%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.7419, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 347/803 (43.2130%)
_Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0349, Accuracy: 369/803 (45.9527%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.0605, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   1, Avg loss: 0.1211, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   2, Avg loss: 0.1108, Accuracy: 23/134 (17.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3236, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   1, Avg loss: 0.0506, Accuracy: 358/1275 (28.0784%)
_Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   2, Avg loss: 0.0199, Accuracy: 682/1275 (53.4902%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.5030, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   1, Avg loss: 0.0481, Accuracy: 398/1036 (38.4170%)
_Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   2, Avg loss: 0.0242, Accuracy: 660/1036 (63.7066%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.8094, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 346/1446 (23.9281%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 506/1446 (34.9931%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.3993, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   1, Avg loss: 0.0637, Accuracy: 220/669 (32.8849%)
_Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   2, Avg loss: 0.0403, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.9917, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   1, Avg loss: 0.0677, Accuracy: 242/774 (31.2661%)
_Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   2, Avg loss: 0.0352, Accuracy: 326/774 (42.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.2404, Accuracy: 54/10000 (0.5400%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   1, Avg loss: 0.0533, Accuracy: 337/599 (56.2604%)
_Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   2, Avg loss: 0.0277, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.9782, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 68/186 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3265, Accuracy: 50/10000 (0.5000%)
time spent on training: 217.94785118103027
[rfa agg] training data poison_ratio: 0.08054322979696114  data num: [515, 803, 134, 1275, 1036, 1446, 669, 774, 599, 186]
[rfa agg] considering poison per batch poison_fraction: 0.02516975931155036
[rfa agg] init. name: [33, 58, 47, 9, 19, 26, 45, 81, 95, 56], weight: tensor([0.0692, 0.1080, 0.0180, 0.1714, 0.1393, 0.1944, 0.0900, 0.1041, 0.0805,
        0.0250])
[rfa agg] iter:  0, prev_obj_val: 46.457603454589844, obj_val: 50.04332733154297, abs dis: 3.585723876953125
[rfa agg] iter: 0, weight: tensor([0.0466, 0.2865, 0.0045, 0.0546, 0.0731, 0.0444, 0.1307, 0.2791, 0.0744,
        0.0062])
[rfa agg] iter:  1, prev_obj_val: 50.04332733154297, obj_val: 49.99159240722656, abs dis: 0.05173492431640625
[rfa agg] iter: 1, weight: tensor([0.0698, 0.1754, 0.0054, 0.0524, 0.0653, 0.0441, 0.2860, 0.1682, 0.1258,
        0.0075])
[rfa agg] iter:  2, prev_obj_val: 49.99159240722656, obj_val: 52.147247314453125, abs dis: 2.1556549072265625
[rfa agg] iter: 2, weight: tensor([0.0676, 0.1663, 0.0052, 0.0506, 0.0630, 0.0425, 0.3151, 0.1589, 0.1236,
        0.0073])
[rfa agg] iter:  3, prev_obj_val: 52.147247314453125, obj_val: 60.9027214050293, abs dis: 8.755474090576172
[rfa agg] iter: 3, weight: tensor([0.0740, 0.1154, 0.0049, 0.0426, 0.0516, 0.0364, 0.4074, 0.1106, 0.1502,
        0.0069])
[rfa agg] iter:  4, prev_obj_val: 60.9027214050293, obj_val: 60.82304000854492, abs dis: 0.079681396484375
[rfa agg] iter: 4, weight: tensor([0.2347, 0.0858, 0.0076, 0.0462, 0.0523, 0.0408, 0.1638, 0.0825, 0.2758,
        0.0105])
[rfa agg] iter:  5, prev_obj_val: 60.82304000854492, obj_val: 60.822303771972656, abs dis: 0.000736236572265625
[rfa agg] iter: 5, weight: tensor([0.2509, 0.0810, 0.0072, 0.0436, 0.0494, 0.0385, 0.1490, 0.0778, 0.2928,
        0.0100])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3046, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.3398, Accuracy: 0/9950 (0.0000%)
saving model
Done in 464.10084772109985 sec.
Server Epoch:56 choose agents : [98, 9, 8, 25, 64, 74, 90, 19, 66, 92].
_Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   1, Avg loss: 0.0804, Accuracy: 25/373 (6.7024%)
_Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   2, Avg loss: 0.0478, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.5484, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   1, Avg loss: 0.0502, Accuracy: 348/1275 (27.2941%)
_Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 683/1275 (53.5686%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.4318, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   1, Avg loss: 0.0602, Accuracy: 241/1513 (15.9286%)
_Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 449/1513 (29.6761%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.3444, Accuracy: 108/10000 (1.0800%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0555, Accuracy: 319/690 (46.2319%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0272, Accuracy: 465/690 (67.3913%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.7253, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   1, Avg loss: 0.0651, Accuracy: 157/953 (16.4743%)
_Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   2, Avg loss: 0.0386, Accuracy: 304/953 (31.8993%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.5466, Accuracy: 74/10000 (0.7400%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 512/1552 (32.9897%)
_Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 743/1552 (47.8737%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 12.1526, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   1, Avg loss: 0.0554, Accuracy: 331/677 (48.8922%)
_Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   2, Avg loss: 0.0218, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.7096, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   1, Avg loss: 0.0469, Accuracy: 380/1036 (36.6795%)
_Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   2, Avg loss: 0.0233, Accuracy: 663/1036 (63.9961%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.2563, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   1, Avg loss: 0.0622, Accuracy: 251/1402 (17.9030%)
_Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 393/1402 (28.0314%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.3272, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   1, Avg loss: 0.0525, Accuracy: 439/1715 (25.5977%)
_Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 708/1715 (41.2828%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4360, Accuracy: 85/10000 (0.8500%)
time spent on training: 255.368017911911
[rfa agg] training data poison_ratio: 0.20042910781333811  data num: [373, 1275, 1513, 690, 953, 1552, 677, 1036, 1402, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.06263409619166815
[rfa agg] init. name: [98, 9, 8, 25, 64, 74, 90, 19, 66, 92], weight: tensor([0.0333, 0.1140, 0.1353, 0.0617, 0.0852, 0.1387, 0.0605, 0.0926, 0.1253,
        0.1533])
[rfa agg] iter:  0, prev_obj_val: 50.197025299072266, obj_val: 51.69488525390625, abs dis: 1.4978599548339844
[rfa agg] iter: 0, weight: tensor([0.0108, 0.2024, 0.0868, 0.0340, 0.1060, 0.0761, 0.0334, 0.2661, 0.1188,
        0.0656])
[rfa agg] iter:  1, prev_obj_val: 51.69488525390625, obj_val: 53.411651611328125, abs dis: 1.716766357421875
[rfa agg] iter: 1, weight: tensor([0.0102, 0.1529, 0.0726, 0.0331, 0.1133, 0.0643, 0.0326, 0.3687, 0.0960,
        0.0562])
[rfa agg] iter:  2, prev_obj_val: 53.411651611328125, obj_val: 60.13484191894531, abs dis: 6.7231903076171875
[rfa agg] iter: 2, weight: tensor([0.0093, 0.1130, 0.0593, 0.0315, 0.1208, 0.0530, 0.0310, 0.4589, 0.0761,
        0.0470])
[rfa agg] iter:  3, prev_obj_val: 60.13484191894531, obj_val: 62.54259490966797, abs dis: 2.4077529907226562
[rfa agg] iter: 3, weight: tensor([0.0134, 0.0956, 0.0609, 0.0518, 0.3228, 0.0558, 0.0511, 0.2241, 0.0734,
        0.0510])
[rfa agg] iter:  4, prev_obj_val: 62.54259490966797, obj_val: 60.0274543762207, abs dis: 2.5151405334472656
[rfa agg] iter: 4, weight: tensor([0.0127, 0.0772, 0.0515, 0.0520, 0.4542, 0.0475, 0.0514, 0.1487, 0.0611,
        0.0437])
[rfa agg] iter:  5, prev_obj_val: 60.0274543762207, obj_val: 60.02328109741211, abs dis: 0.00417327880859375
[rfa agg] iter: 5, weight: tensor([0.0121, 0.0854, 0.0547, 0.0465, 0.4098, 0.0501, 0.0459, 0.1840, 0.0659,
        0.0457])
[rfa agg] iter:  6, prev_obj_val: 60.02328109741211, obj_val: 62.52067565917969, abs dis: 2.497394561767578
[rfa agg] iter: 6, weight: tensor([0.0122, 0.0869, 0.0555, 0.0473, 0.3978, 0.0509, 0.0467, 0.1894, 0.0669,
        0.0464])
[rfa agg] iter:  7, prev_obj_val: 62.52067565917969, obj_val: 62.50437927246094, abs dis: 0.01629638671875
[rfa agg] iter: 7, weight: tensor([0.0120, 0.0730, 0.0488, 0.0492, 0.4847, 0.0449, 0.0486, 0.1396, 0.0578,
        0.0414])
[rfa agg] iter:  8, prev_obj_val: 62.50437927246094, obj_val: 65.32618713378906, abs dis: 2.821807861328125
[rfa agg] iter: 8, weight: tensor([0.0111, 0.0672, 0.0450, 0.0453, 0.5266, 0.0414, 0.0448, 0.1271, 0.0533,
        0.0382])
[rfa agg] iter:  9, prev_obj_val: 65.32618713378906, obj_val: 65.32022857666016, abs dis: 0.00595855712890625
[rfa agg] iter: 9, weight: tensor([0.0141, 0.0738, 0.0513, 0.0618, 0.4601, 0.0475, 0.0613, 0.1259, 0.0600,
        0.0441])
			Update norm = 133.78758963605333 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3046, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.3398, Accuracy: 0/9950 (0.0000%)
saving model
Done in 506.50087809562683 sec.
Server Epoch:57 choose agents : [16, 72, 14, 32, 55, 48, 98, 56, 85, 95].
_Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   1, Avg loss: 0.0589, Accuracy: 288/708 (40.6780%)
_Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   2, Avg loss: 0.0382, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.0052, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   1, Avg loss: 0.0625, Accuracy: 247/1241 (19.9033%)
_Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 409/1241 (32.9573%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.1791, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 223/1013 (22.0138%)
_Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 353/1013 (34.8470%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.9355, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0604, Accuracy: 215/735 (29.2517%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 363/735 (49.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.2865, Accuracy: 58/10000 (0.5800%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 230/1071 (21.4753%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 470/1071 (43.8842%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0030, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.0719, Accuracy: 91/631 (14.4216%)
_Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0414, Accuracy: 209/631 (33.1220%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.9788, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   1, Avg loss: 0.0807, Accuracy: 22/373 (5.8981%)
_Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   2, Avg loss: 0.0471, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.5459, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 70/186 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3303, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   1, Avg loss: 0.0546, Accuracy: 454/1988 (22.8370%)
_Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 676/1988 (34.0040%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.7915, Accuracy: 80/10000 (0.8000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   1, Avg loss: 0.0498, Accuracy: 357/599 (59.5993%)
_Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   2, Avg loss: 0.0274, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.7252, Accuracy: 50/10000 (0.5000%)
time spent on training: 242.02015781402588
[rfa agg] training data poison_ratio: 0.4280866003510825  data num: [708, 1241, 1013, 735, 1071, 631, 373, 186, 1988, 599]
[rfa agg] considering poison per batch poison_fraction: 0.13377706260971328
[rfa agg] init. name: [16, 72, 14, 32, 55, 48, 98, 56, 85, 95], weight: tensor([0.0829, 0.1452, 0.1185, 0.0860, 0.1253, 0.0738, 0.0437, 0.0218, 0.2327,
        0.0701])
[rfa agg] iter:  0, prev_obj_val: 61.87998580932617, obj_val: 65.95637512207031, abs dis: 4.076389312744141
[rfa agg] iter: 0, weight: tensor([0.0685, 0.0938, 0.4179, 0.0709, 0.2123, 0.0392, 0.0135, 0.0051, 0.0415,
        0.0373])
[rfa agg] iter:  1, prev_obj_val: 65.95637512207031, obj_val: 68.27877807617188, abs dis: 2.3224029541015625
[rfa agg] iter: 1, weight: tensor([0.1874, 0.0835, 0.1761, 0.1929, 0.1319, 0.0777, 0.0217, 0.0077, 0.0473,
        0.0739])
[rfa agg] iter:  2, prev_obj_val: 68.27877807617188, obj_val: 71.95296478271484, abs dis: 3.6741867065429688
[rfa agg] iter: 2, weight: tensor([0.2878, 0.0512, 0.0888, 0.2954, 0.0729, 0.0761, 0.0177, 0.0060, 0.0317,
        0.0725])
[rfa agg] iter:  3, prev_obj_val: 71.95296478271484, obj_val: 74.45773315429688, abs dis: 2.5047683715820312
[rfa agg] iter: 3, weight: tensor([0.2811, 0.0413, 0.0632, 0.2918, 0.0546, 0.1101, 0.0191, 0.0061, 0.0275,
        0.1052])
[rfa agg] iter:  4, prev_obj_val: 74.45773315429688, obj_val: 80.02748107910156, abs dis: 5.5697479248046875
[rfa agg] iter: 4, weight: tensor([0.2063, 0.0450, 0.0658, 0.2150, 0.0579, 0.1773, 0.0241, 0.0075, 0.0310,
        0.1701])
[rfa agg] iter:  5, prev_obj_val: 80.02748107910156, obj_val: 79.94871520996094, abs dis: 0.078765869140625
[rfa agg] iter: 5, weight: tensor([0.0922, 0.0335, 0.0454, 0.0959, 0.0411, 0.3190, 0.0248, 0.0070, 0.0244,
        0.3169])
[rfa agg] iter:  6, prev_obj_val: 79.94871520996094, obj_val: 87.2426986694336, abs dis: 7.293983459472656
[rfa agg] iter: 6, weight: tensor([0.0774, 0.0285, 0.0386, 0.0806, 0.0350, 0.3464, 0.0211, 0.0060, 0.0208,
        0.3455])
[rfa agg] iter:  7, prev_obj_val: 87.2426986694336, obj_val: 77.06714630126953, abs dis: 10.175552368164062
[rfa agg] iter: 7, weight: tensor([0.1027, 0.0502, 0.0642, 0.1068, 0.0593, 0.2614, 0.0538, 0.0134, 0.0385,
        0.2497])
[rfa agg] iter:  8, prev_obj_val: 77.06714630126953, obj_val: 79.96366882324219, abs dis: 2.8965225219726562
[rfa agg] iter: 8, weight: tensor([0.1280, 0.0384, 0.0539, 0.1333, 0.0481, 0.2741, 0.0241, 0.0072, 0.0272,
        0.2657])
[rfa agg] iter:  9, prev_obj_val: 79.96366882324219, obj_val: 83.46025848388672, abs dis: 3.4965896606445312
[rfa agg] iter: 9, weight: tensor([0.0820, 0.0300, 0.0407, 0.0854, 0.0369, 0.3386, 0.0223, 0.0063, 0.0219,
        0.3359])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3067, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.3370, Accuracy: 0/9950 (0.0000%)
saving model
Done in 493.80125880241394 sec.
Server Epoch:58 choose agents : [84, 53, 38, 31, 8, 47, 67, 4, 87, 88].
_Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   1, Avg loss: 0.0621, Accuracy: 325/1190 (27.3109%)
_Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 447/1190 (37.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.3120, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   1, Avg loss: 0.0486, Accuracy: 278/813 (34.1943%)
_Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 448/813 (55.1046%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.0071, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   1, Avg loss: 0.0609, Accuracy: 255/1131 (22.5464%)
_Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 517/1131 (45.7118%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.5813, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0824, Accuracy: 62/460 (13.4783%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0369, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.0851, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 257/1513 (16.9861%)
_Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 464/1513 (30.6675%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.6259, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1226, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1079, Accuracy: 30/134 (22.3881%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3309, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0772, Accuracy: 57/426 (13.3803%)
_Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0411, Accuracy: 176/426 (41.3146%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8990, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0638, Accuracy: 322/901 (35.7381%)
_Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0336, Accuracy: 399/901 (44.2841%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.2430, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   1, Avg loss: 0.0585, Accuracy: 306/1131 (27.0557%)
_Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   2, Avg loss: 0.0321, Accuracy: 393/1131 (34.7480%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.7214, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0760, Accuracy: 135/603 (22.3881%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0452, Accuracy: 278/603 (46.1028%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.1620, Accuracy: 53/10000 (0.5300%)
time spent on training: 195.74341368675232
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 813, 1131, 460, 1513, 134, 426, 901, 1131, 603]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 53, 38, 31, 8, 47, 67, 4, 87, 88], weight: tensor([0.1433, 0.0979, 0.1362, 0.0554, 0.1822, 0.0161, 0.0513, 0.1085, 0.1362,
        0.0726])
[rfa agg] iter:  0, prev_obj_val: 47.473976135253906, obj_val: 47.36465072631836, abs dis: 0.10932540893554688
[rfa agg] iter: 0, weight: tensor([0.0793, 0.3598, 0.0915, 0.0309, 0.0534, 0.0047, 0.0242, 0.2014, 0.0919,
        0.0629])
[rfa agg] iter:  1, prev_obj_val: 47.36465072631836, obj_val: 49.389095306396484, abs dis: 2.024444580078125
[rfa agg] iter: 1, weight: tensor([0.0726, 0.4084, 0.0839, 0.0284, 0.0490, 0.0043, 0.0222, 0.1891, 0.0843,
        0.0578])
[rfa agg] iter:  2, prev_obj_val: 49.389095306396484, obj_val: 51.841064453125, abs dis: 2.4519691467285156
[rfa agg] iter: 2, weight: tensor([0.0561, 0.5475, 0.0637, 0.0262, 0.0393, 0.0038, 0.0202, 0.1231, 0.0639,
        0.0562])
[rfa agg] iter:  3, prev_obj_val: 51.841064453125, obj_val: 54.48802185058594, abs dis: 2.6469573974609375
[rfa agg] iter: 3, weight: tensor([0.0633, 0.4785, 0.0710, 0.0354, 0.0460, 0.0049, 0.0269, 0.1216, 0.0712,
        0.0812])
[rfa agg] iter:  4, prev_obj_val: 54.48802185058594, obj_val: 57.16379928588867, abs dis: 2.6757774353027344
[rfa agg] iter: 4, weight: tensor([0.0758, 0.3435, 0.0839, 0.0511, 0.0566, 0.0066, 0.0380, 0.1319, 0.0841,
        0.1285])
[rfa agg] iter:  5, prev_obj_val: 57.16379928588867, obj_val: 57.158077239990234, abs dis: 0.0057220458984375
[rfa agg] iter: 5, weight: tensor([0.0785, 0.2585, 0.0860, 0.0646, 0.0603, 0.0077, 0.0467, 0.1263, 0.0862,
        0.1851])
			Update norm = 106.73292365614043 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3067, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.3370, Accuracy: 0/9950 (0.0000%)
saving model
Done in 446.48674845695496 sec.
Server Epoch:59 choose agents : [82, 74, 11, 41, 40, 36, 95, 87, 23, 32].
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 65/500 (13.0000%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.8341, Accuracy: 53/10000 (0.5300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 522/1552 (33.6340%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 762/1552 (49.0979%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 11.3830, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   1, Avg loss: 0.0555, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 389/712 (54.6348%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.8677, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   1, Avg loss: 0.0581, Accuracy: 335/719 (46.5925%)
_Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   2, Avg loss: 0.0320, Accuracy: 462/719 (64.2559%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.4604, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 379/1573 (24.0941%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 557/1573 (35.4100%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.2524, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.0865, Accuracy: 82/408 (20.0980%)
_Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0552, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.6144, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   1, Avg loss: 0.0456, Accuracy: 391/599 (65.2755%)
_Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   2, Avg loss: 0.0301, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1584, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   1, Avg loss: 0.0582, Accuracy: 298/1131 (26.3484%)
_Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   2, Avg loss: 0.0318, Accuracy: 415/1131 (36.6932%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.2133, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0629, Accuracy: 324/715 (45.3147%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0375, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.8487, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 203/735 (27.6190%)
_Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 339/735 (46.1224%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.5010, Accuracy: 52/10000 (0.5200%)
time spent on training: 230.59172415733337
[rfa agg] training data poison_ratio: 0.2488431281813975  data num: [500, 1552, 712, 719, 1573, 408, 599, 1131, 715, 735]
[rfa agg] considering poison per batch poison_fraction: 0.07776347755668672
[rfa agg] init. name: [82, 74, 11, 41, 40, 36, 95, 87, 23, 32], weight: tensor([0.0578, 0.1795, 0.0824, 0.0832, 0.1820, 0.0472, 0.0693, 0.1308, 0.0827,
        0.0850])
[rfa agg] iter:  0, prev_obj_val: 55.48152160644531, obj_val: 61.254886627197266, abs dis: 5.773365020751953
[rfa agg] iter: 0, weight: tensor([0.0353, 0.0526, 0.1695, 0.1666, 0.0533, 0.0244, 0.0656, 0.0963, 0.1635,
        0.1729])
[rfa agg] iter:  1, prev_obj_val: 61.254886627197266, obj_val: 70.36009216308594, abs dis: 9.105205535888672
[rfa agg] iter: 1, weight: tensor([0.0460, 0.0311, 0.1732, 0.1665, 0.0315, 0.0283, 0.1394, 0.0451, 0.1631,
        0.1758])
[rfa agg] iter:  2, prev_obj_val: 70.36009216308594, obj_val: 77.30658721923828, abs dis: 6.946495056152344
[rfa agg] iter: 2, weight: tensor([0.1164, 0.0374, 0.1040, 0.1042, 0.0379, 0.0591, 0.2822, 0.0495, 0.1026,
        0.1067])
[rfa agg] iter:  3, prev_obj_val: 77.30658721923828, obj_val: 80.92132568359375, abs dis: 3.6147384643554688
[rfa agg] iter: 3, weight: tensor([0.2871, 0.0383, 0.0819, 0.0825, 0.0389, 0.1028, 0.1549, 0.0483, 0.0812,
        0.0840])
[rfa agg] iter:  4, prev_obj_val: 80.92132568359375, obj_val: 84.83726501464844, abs dis: 3.9159393310546875
[rfa agg] iter: 4, weight: tensor([0.4319, 0.0313, 0.0605, 0.0609, 0.0318, 0.1233, 0.0992, 0.0387, 0.0602,
        0.0622])
[rfa agg] iter:  5, prev_obj_val: 84.83726501464844, obj_val: 80.91195678710938, abs dis: 3.9253082275390625
[rfa agg] iter: 5, weight: tensor([0.3307, 0.0344, 0.0609, 0.0613, 0.0349, 0.2223, 0.0906, 0.0417, 0.0607,
        0.0626])
[rfa agg] iter:  6, prev_obj_val: 80.91195678710938, obj_val: 80.90079498291016, abs dis: 0.01116180419921875
[rfa agg] iter: 6, weight: tensor([0.4619, 0.0295, 0.0569, 0.0573, 0.0299, 0.1201, 0.0927, 0.0364, 0.0567,
        0.0585])
[rfa agg] iter:  7, prev_obj_val: 80.90079498291016, obj_val: 77.30155181884766, abs dis: 3.5992431640625
[rfa agg] iter: 7, weight: tensor([0.5087, 0.0271, 0.0522, 0.0525, 0.0274, 0.1080, 0.0852, 0.0334, 0.0519,
        0.0536])
[rfa agg] iter:  8, prev_obj_val: 77.30155181884766, obj_val: 84.8408203125, abs dis: 7.539268493652344
[rfa agg] iter: 8, weight: tensor([0.3366, 0.0358, 0.0763, 0.0767, 0.0363, 0.0982, 0.1411, 0.0452, 0.0756,
        0.0782])
[rfa agg] iter:  9, prev_obj_val: 84.8408203125, obj_val: 80.912841796875, abs dis: 3.927978515625
[rfa agg] iter: 9, weight: tensor([0.3201, 0.0353, 0.0624, 0.0629, 0.0357, 0.2213, 0.0931, 0.0427, 0.0622,
        0.0642])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3087, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.3329, Accuracy: 0/9950 (0.0000%)
saving model
Done in 471.3057782649994 sec.
Server Epoch:60 choose agents : [28, 39, 27, 81, 97, 7, 47, 24, 49, 88].
_Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   1, Avg loss: 0.0566, Accuracy: 384/1581 (24.2884%)
_Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 578/1581 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.5145, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   1, Avg loss: 0.0536, Accuracy: 315/1013 (31.0958%)
_Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   2, Avg loss: 0.0264, Accuracy: 471/1013 (46.4956%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.7273, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   1, Avg loss: 0.0541, Accuracy: 441/1587 (27.7883%)
_Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 574/1587 (36.1689%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.5258, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   1, Avg loss: 0.0666, Accuracy: 240/774 (31.0078%)
_Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   2, Avg loss: 0.0360, Accuracy: 308/774 (39.7933%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.4840, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0520, Accuracy: 368/1213 (30.3380%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 486/1213 (40.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.8040, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 353/891 (39.6184%)
_Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 438/891 (49.1582%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.4097, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   1, Avg loss: 0.1198, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   2, Avg loss: 0.1097, Accuracy: 24/134 (17.9104%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3368, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0760, Accuracy: 42/312 (13.4615%)
_Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0396, Accuracy: 173/312 (55.4487%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.5553, Accuracy: 50/10000 (0.5000%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   1, Avg loss: 0.0773, Accuracy: 37/440 (8.4091%)
_Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   2, Avg loss: 0.0458, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.7013, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0756, Accuracy: 137/603 (22.7197%)
_Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0479, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.2879, Accuracy: 51/10000 (0.5100%)
time spent on training: 213.6186285018921
[rfa agg] training data poison_ratio: 0.05147402901263454  data num: [1581, 1013, 1587, 774, 1213, 891, 134, 312, 440, 603]
[rfa agg] considering poison per batch poison_fraction: 0.016085634066448293
[rfa agg] init. name: [28, 39, 27, 81, 97, 7, 47, 24, 49, 88], weight: tensor([0.1850, 0.1185, 0.1857, 0.0905, 0.1419, 0.1042, 0.0157, 0.0365, 0.0515,
        0.0705])
[rfa agg] iter:  0, prev_obj_val: 53.52186965942383, obj_val: 59.2194938659668, abs dis: 5.697624206542969
[rfa agg] iter: 0, weight: tensor([0.0592, 0.3942, 0.0594, 0.1061, 0.1200, 0.1893, 0.0038, 0.0106, 0.0184,
        0.0389])
[rfa agg] iter:  1, prev_obj_val: 59.2194938659668, obj_val: 59.069393157958984, abs dis: 0.1501007080078125
[rfa agg] iter: 1, weight: tensor([0.0457, 0.1321, 0.0458, 0.2754, 0.0725, 0.3335, 0.0042, 0.0122, 0.0224,
        0.0563])
[rfa agg] iter:  2, prev_obj_val: 59.069393157958984, obj_val: 61.306488037109375, abs dis: 2.2370948791503906
[rfa agg] iter: 2, weight: tensor([0.0416, 0.1171, 0.0417, 0.2940, 0.0659, 0.3533, 0.0038, 0.0111, 0.0204,
        0.0512])
[rfa agg] iter:  3, prev_obj_val: 61.306488037109375, obj_val: 61.27520751953125, abs dis: 0.031280517578125
[rfa agg] iter: 3, weight: tensor([0.0417, 0.1035, 0.0419, 0.4013, 0.0634, 0.2465, 0.0042, 0.0123, 0.0231,
        0.0620])
[rfa agg] iter:  4, prev_obj_val: 61.27520751953125, obj_val: 63.87709045410156, abs dis: 2.6018829345703125
[rfa agg] iter: 4, weight: tensor([0.0389, 0.0963, 0.0390, 0.4528, 0.0591, 0.2191, 0.0039, 0.0115, 0.0216,
        0.0579])
[rfa agg] iter:  5, prev_obj_val: 63.87709045410156, obj_val: 63.874168395996094, abs dis: 0.00292205810546875
[rfa agg] iter: 5, weight: tensor([0.0457, 0.1019, 0.0459, 0.4123, 0.0668, 0.1949, 0.0051, 0.0150, 0.0287,
        0.0838])
			Update norm = 114.82282547472867 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3087, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.3329, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 458.75681614875793 sec.
Server Epoch:61 choose agents : [63, 97, 61, 60, 55, 87, 50, 72, 14, 64].
_Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 262/888 (29.5045%)
_Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 455/888 (51.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.0297, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   1, Avg loss: 0.0520, Accuracy: 360/1213 (29.6785%)
_Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 487/1213 (40.1484%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.7837, Accuracy: 89/10000 (0.8900%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   1, Avg loss: 0.1268, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   2, Avg loss: 0.1198, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3220, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 577/2227 (25.9093%)
_Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1050/2227 (47.1486%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.3106, Accuracy: 119/10000 (1.1900%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0561, Accuracy: 271/1071 (25.3035%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 484/1071 (45.1914%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1258, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   1, Avg loss: 0.0583, Accuracy: 301/1131 (26.6136%)
_Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   2, Avg loss: 0.0326, Accuracy: 373/1131 (32.9797%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.8772, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0633, Accuracy: 147/809 (18.1706%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 348/809 (43.0161%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.4678, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 258/1241 (20.7897%)
_Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 409/1241 (32.9573%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.4315, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   1, Avg loss: 0.0627, Accuracy: 225/1013 (22.2113%)
_Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 359/1013 (35.4393%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.7470, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   1, Avg loss: 0.0651, Accuracy: 168/953 (17.6285%)
_Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   2, Avg loss: 0.0388, Accuracy: 299/953 (31.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.6194, Accuracy: 71/10000 (0.7100%)
time spent on training: 291.94692826271057
[rfa agg] training data poison_ratio: 0.1087385946759477  data num: [888, 1213, 85, 2227, 1071, 1131, 809, 1241, 1013, 953]
[rfa agg] considering poison per batch poison_fraction: 0.03398081083623365
[rfa agg] init. name: [63, 97, 61, 60, 55, 87, 50, 72, 14, 64], weight: tensor([0.0835, 0.1141, 0.0080, 0.2095, 0.1007, 0.1064, 0.0761, 0.1167, 0.0953,
        0.0896])
[rfa agg] iter:  0, prev_obj_val: 49.47092056274414, obj_val: 56.98683166503906, abs dis: 7.515911102294922
[rfa agg] iter: 0, weight: tensor([0.0439, 0.1832, 0.0011, 0.0263, 0.1657, 0.2773, 0.0322, 0.1138, 0.0950,
        0.0615])
[rfa agg] iter:  1, prev_obj_val: 56.98683166503906, obj_val: 62.591583251953125, abs dis: 5.6047515869140625
[rfa agg] iter: 1, weight: tensor([0.1557, 0.0657, 0.0014, 0.0246, 0.1104, 0.0812, 0.0829, 0.0540, 0.1779,
        0.2461])
[rfa agg] iter:  2, prev_obj_val: 62.591583251953125, obj_val: 66.03015899658203, abs dis: 3.4385757446289062
[rfa agg] iter: 2, weight: tensor([0.3066, 0.0532, 0.0016, 0.0236, 0.0766, 0.0616, 0.1458, 0.0455, 0.1069,
        0.1787])
[rfa agg] iter:  3, prev_obj_val: 66.03015899658203, obj_val: 69.80765533447266, abs dis: 3.777496337890625
[rfa agg] iter: 3, weight: tensor([0.2897, 0.0521, 0.0017, 0.0248, 0.0711, 0.0591, 0.2246, 0.0452, 0.0933,
        0.1383])
[rfa agg] iter:  4, prev_obj_val: 69.80765533447266, obj_val: 69.78314971923828, abs dis: 0.024505615234375
[rfa agg] iter: 4, weight: tensor([0.2044, 0.0528, 0.0020, 0.0267, 0.0691, 0.0589, 0.3344, 0.0464, 0.0868,
        0.1185])
[rfa agg] iter:  5, prev_obj_val: 69.78314971923828, obj_val: 69.78022766113281, abs dis: 0.00292205810546875
[rfa agg] iter: 5, weight: tensor([0.1864, 0.0501, 0.0019, 0.0253, 0.0656, 0.0558, 0.3765, 0.0440, 0.0823,
        0.1120])
[rfa agg] iter:  6, prev_obj_val: 69.78022766113281, obj_val: 69.77975463867188, abs dis: 0.0004730224609375
[rfa agg] iter: 6, weight: tensor([0.1800, 0.0489, 0.0019, 0.0248, 0.0640, 0.0545, 0.3934, 0.0430, 0.0804,
        0.1092])
[rfa agg] iter:  7, prev_obj_val: 69.77975463867188, obj_val: 73.87617492675781, abs dis: 4.0964202880859375
[rfa agg] iter: 7, weight: tensor([0.1773, 0.0484, 0.0018, 0.0245, 0.0633, 0.0540, 0.4005, 0.0426, 0.0795,
        0.1080])
[rfa agg] iter:  8, prev_obj_val: 73.87617492675781, obj_val: 62.63206100463867, abs dis: 11.24411392211914
[rfa agg] iter: 8, weight: tensor([0.1659, 0.0570, 0.0025, 0.0305, 0.0720, 0.0626, 0.3588, 0.0506, 0.0874,
        0.1126])
[rfa agg] iter:  9, prev_obj_val: 62.63206100463867, obj_val: 62.55520248413086, abs dis: 0.0768585205078125
[rfa agg] iter: 9, weight: tensor([0.2918, 0.0539, 0.0016, 0.0239, 0.0775, 0.0624, 0.1628, 0.0462, 0.1078,
        0.1721])
			Update norm = 128.13259123852916 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3087, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.3329, Accuracy: 0/9950 (0.0000%)
saving model
Done in 542.4168922901154 sec.
Server Epoch:62 choose agents : [82, 13, 98, 85, 60, 29, 45, 7, 66, 63].
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0745, Accuracy: 81/500 (16.2000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0479, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.9503, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0581, Accuracy: 326/1645 (19.8176%)
_Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 627/1645 (38.1155%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.1649, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   1, Avg loss: 0.0798, Accuracy: 32/373 (8.5791%)
_Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.6012, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   1, Avg loss: 0.0533, Accuracy: 450/1988 (22.6358%)
_Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 653/1988 (32.8471%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9020, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 545/2227 (24.4724%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 994/2227 (44.6340%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.2452, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 416/1440 (28.8889%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 703/1440 (48.8194%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.9876, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   1, Avg loss: 0.0631, Accuracy: 230/669 (34.3797%)
_Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   2, Avg loss: 0.0397, Accuracy: 356/669 (53.2138%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.9745, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   1, Avg loss: 0.0541, Accuracy: 344/891 (38.6083%)
_Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 422/891 (47.3625%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.4403, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 261/1402 (18.6163%)
_Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 380/1402 (27.1041%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.0843, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0538, Accuracy: 268/888 (30.1802%)
_Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0263, Accuracy: 424/888 (47.7477%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.2654, Accuracy: 59/10000 (0.5900%)
time spent on training: 277.8484106063843
[rfa agg] training data poison_ratio: 0.16534974631955418  data num: [500, 1645, 373, 1988, 2227, 1440, 669, 891, 1402, 888]
[rfa agg] considering poison per batch poison_fraction: 0.05167179572486068
[rfa agg] init. name: [82, 13, 98, 85, 60, 29, 45, 7, 66, 63], weight: tensor([0.0416, 0.1368, 0.0310, 0.1653, 0.1852, 0.1198, 0.0556, 0.0741, 0.1166,
        0.0739])
[rfa agg] iter:  0, prev_obj_val: 69.78268432617188, obj_val: 74.73546600341797, abs dis: 4.952781677246094
[rfa agg] iter: 0, weight: tensor([0.0100, 0.1120, 0.0065, 0.0552, 0.0477, 0.3103, 0.0170, 0.0309, 0.3796,
        0.0309])
[rfa agg] iter:  1, prev_obj_val: 74.73546600341797, obj_val: 74.72825622558594, abs dis: 0.00720977783203125
[rfa agg] iter: 1, weight: tensor([0.0165, 0.1215, 0.0106, 0.0708, 0.0631, 0.2290, 0.0289, 0.0560, 0.3476,
        0.0559])
			Update norm = 185.43310788529647 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3087, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.3329, Accuracy: 0/9950 (0.0000%)
saving model
Done in 525.0041680335999 sec.
Server Epoch:63 choose agents : [14, 81, 97, 91, 28, 94, 4, 35, 25, 39].
_Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   1, Avg loss: 0.0623, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 353/1013 (34.8470%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.7505, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   1, Avg loss: 0.0665, Accuracy: 248/774 (32.0413%)
_Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   2, Avg loss: 0.0384, Accuracy: 296/774 (38.2429%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.5275, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   1, Avg loss: 0.0519, Accuracy: 359/1213 (29.5960%)
_Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 475/1213 (39.1591%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.9599, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   1, Avg loss: 0.0548, Accuracy: 334/1030 (32.4272%)
_Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   2, Avg loss: 0.0248, Accuracy: 597/1030 (57.9612%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.2504, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   1, Avg loss: 0.0569, Accuracy: 368/1581 (23.2764%)
_Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 609/1581 (38.5199%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.7054, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 331/1662 (19.9158%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 611/1662 (36.7629%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.9907, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0594, Accuracy: 333/901 (36.9589%)
_Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0325, Accuracy: 393/901 (43.6182%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.2108, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.0865, Accuracy: 33/271 (12.1771%)
_Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0550, Accuracy: 102/271 (37.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.4739, Accuracy: 54/10000 (0.5400%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 317/690 (45.9420%)
_Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.7098, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   1, Avg loss: 0.0545, Accuracy: 317/1013 (31.2932%)
_Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   2, Avg loss: 0.0267, Accuracy: 465/1013 (45.9033%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.6470, Accuracy: 52/10000 (0.5200%)
time spent on training: 234.53146886825562
[rfa agg] training data poison_ratio: 0.06799369333858889  data num: [1013, 774, 1213, 1030, 1581, 1662, 901, 271, 690, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.021248029168309028
[rfa agg] init. name: [14, 81, 97, 91, 28, 94, 4, 35, 25, 39], weight: tensor([0.0998, 0.0763, 0.1195, 0.1015, 0.1558, 0.1638, 0.0888, 0.0267, 0.0680,
        0.0998])
[rfa agg] iter:  0, prev_obj_val: 42.346435546875, obj_val: 45.84328079223633, abs dis: 3.496845245361328
[rfa agg] iter: 0, weight: tensor([0.2522, 0.0512, 0.0790, 0.1494, 0.0355, 0.0337, 0.1377, 0.0050, 0.0278,
        0.2287])
[rfa agg] iter:  1, prev_obj_val: 45.84328079223633, obj_val: 53.95193862915039, abs dis: 8.108657836914062
[rfa agg] iter: 1, weight: tensor([0.1929, 0.0848, 0.0685, 0.1074, 0.0363, 0.0348, 0.2470, 0.0062, 0.0392,
        0.1829])
[rfa agg] iter:  2, prev_obj_val: 53.95193862915039, obj_val: 56.964778900146484, abs dis: 3.0128402709960938
[rfa agg] iter: 2, weight: tensor([0.1170, 0.2850, 0.0654, 0.0850, 0.0411, 0.0398, 0.1626, 0.0095, 0.0794,
        0.1152])
[rfa agg] iter:  3, prev_obj_val: 56.964778900146484, obj_val: 63.8985595703125, abs dis: 6.933780670166016
[rfa agg] iter: 3, weight: tensor([0.0888, 0.4206, 0.0542, 0.0676, 0.0355, 0.0346, 0.1138, 0.0091, 0.0881,
        0.0877])
[rfa agg] iter:  4, prev_obj_val: 63.8985595703125, obj_val: 60.34036636352539, abs dis: 3.5581932067871094
[rfa agg] iter: 4, weight: tensor([0.0916, 0.2645, 0.0633, 0.0743, 0.0446, 0.0436, 0.1067, 0.0141, 0.2065,
        0.0909])
[rfa agg] iter:  5, prev_obj_val: 60.34036636352539, obj_val: 53.913307189941406, abs dis: 6.427059173583984
[rfa agg] iter: 5, weight: tensor([0.0911, 0.3475, 0.0596, 0.0719, 0.0406, 0.0396, 0.1104, 0.0115, 0.1373,
        0.0903])
[rfa agg] iter:  6, prev_obj_val: 53.913307189941406, obj_val: 60.33721160888672, abs dis: 6.4239044189453125
[rfa agg] iter: 6, weight: tensor([0.1104, 0.3266, 0.0620, 0.0804, 0.0390, 0.0378, 0.1503, 0.0090, 0.0760,
        0.1085])
[rfa agg] iter:  7, prev_obj_val: 60.33721160888672, obj_val: 56.951114654541016, abs dis: 3.386096954345703
[rfa agg] iter: 7, weight: tensor([0.0900, 0.3590, 0.0588, 0.0710, 0.0400, 0.0391, 0.1094, 0.0114, 0.1321,
        0.0892])
[rfa agg] iter:  8, prev_obj_val: 56.951114654541016, obj_val: 63.90376663208008, abs dis: 6.9526519775390625
[rfa agg] iter: 8, weight: tensor([0.0845, 0.4483, 0.0516, 0.0644, 0.0339, 0.0329, 0.1077, 0.0087, 0.0845,
        0.0835])
[rfa agg] iter:  9, prev_obj_val: 63.90376663208008, obj_val: 60.34014129638672, abs dis: 3.5636253356933594
[rfa agg] iter: 9, weight: tensor([0.0915, 0.2660, 0.0632, 0.0742, 0.0446, 0.0436, 0.1065, 0.0141, 0.2056,
        0.0908])
			Update norm = 114.9085701424724 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3087, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.3329, Accuracy: 0/9950 (0.0000%)
saving model
Done in 483.8183271884918 sec.
Server Epoch:64 choose agents : [81, 71, 22, 76, 45, 30, 66, 5, 69, 70].
_Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0675, Accuracy: 245/774 (31.6537%)
_Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0381, Accuracy: 296/774 (38.2429%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.5299, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0641, Accuracy: 154/818 (18.8264%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0309, Accuracy: 333/818 (40.7090%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.3866, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 505/1470 (34.3537%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 847/1470 (57.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.4217, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 41/466 (8.7983%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0495, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.9689, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.0642, Accuracy: 229/669 (34.2302%)
_Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0391, Accuracy: 352/669 (52.6158%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.0289, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.0791, Accuracy: 86/486 (17.6955%)
_Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.3221, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 257/1402 (18.3310%)
_Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 416/1402 (29.6719%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.7578, Accuracy: 69/10000 (0.6900%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   1, Avg loss: 0.0515, Accuracy: 381/1628 (23.4029%)
_Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   2, Avg loss: 0.0262, Accuracy: 780/1628 (47.9115%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.3489, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   1, Avg loss: 0.0572, Accuracy: 285/590 (48.3051%)
_Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.7659, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 342/1418 (24.1185%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 643/1418 (45.3456%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.8207, Accuracy: 97/10000 (0.9700%)
time spent on training: 248.7666654586792
[rfa agg] training data poison_ratio: 0.21746733875115729  data num: [774, 818, 1470, 466, 669, 486, 1402, 1628, 590, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.06795854335973665
[rfa agg] init. name: [81, 71, 22, 76, 45, 30, 66, 5, 69, 70], weight: tensor([0.0796, 0.0841, 0.1512, 0.0479, 0.0688, 0.0500, 0.1442, 0.1675, 0.0607,
        0.1459])
[rfa agg] iter:  0, prev_obj_val: 59.60226821899414, obj_val: 61.57400131225586, abs dis: 1.9717330932617188
[rfa agg] iter: 0, weight: tensor([0.1486, 0.1597, 0.1252, 0.0349, 0.0795, 0.0364, 0.1386, 0.0975, 0.0587,
        0.1208])
[rfa agg] iter:  1, prev_obj_val: 61.57400131225586, obj_val: 64.8250961303711, abs dis: 3.2510948181152344
[rfa agg] iter: 1, weight: tensor([0.1915, 0.2084, 0.0977, 0.0355, 0.0880, 0.0370, 0.1061, 0.0789, 0.0626,
        0.0942])
[rfa agg] iter:  2, prev_obj_val: 64.8250961303711, obj_val: 68.2338638305664, abs dis: 3.4087677001953125
[rfa agg] iter: 2, weight: tensor([0.2734, 0.3379, 0.0502, 0.0274, 0.0839, 0.0287, 0.0534, 0.0424, 0.0542,
        0.0485])
[rfa agg] iter:  3, prev_obj_val: 68.2338638305664, obj_val: 78.47599792480469, abs dis: 10.242134094238281
[rfa agg] iter: 3, weight: tensor([0.2629, 0.3259, 0.0415, 0.0305, 0.1198, 0.0318, 0.0436, 0.0358, 0.0683,
        0.0400])
[rfa agg] iter:  4, prev_obj_val: 78.47599792480469, obj_val: 84.9250259399414, abs dis: 6.449028015136719
[rfa agg] iter: 4, weight: tensor([0.0990, 0.1062, 0.0390, 0.0601, 0.2631, 0.0629, 0.0404, 0.0349, 0.2567,
        0.0376])
[rfa agg] iter:  5, prev_obj_val: 84.9250259399414, obj_val: 84.91376495361328, abs dis: 0.011260986328125
[rfa agg] iter: 5, weight: tensor([0.0779, 0.0828, 0.0392, 0.1052, 0.1518, 0.1097, 0.0404, 0.0356, 0.3196,
        0.0378])
[rfa agg] iter:  6, prev_obj_val: 84.91376495361328, obj_val: 88.4722900390625, abs dis: 3.5585250854492188
[rfa agg] iter: 6, weight: tensor([0.0766, 0.0816, 0.0386, 0.1045, 0.1470, 0.1089, 0.0397, 0.0350, 0.3308,
        0.0373])
[rfa agg] iter:  7, prev_obj_val: 88.4722900390625, obj_val: 92.08808898925781, abs dis: 3.6157989501953125
[rfa agg] iter: 7, weight: tensor([0.0754, 0.0801, 0.0416, 0.1646, 0.1271, 0.1713, 0.0427, 0.0380, 0.2190,
        0.0402])
[rfa agg] iter:  8, prev_obj_val: 92.08808898925781, obj_val: 92.07842254638672, abs dis: 0.00966644287109375
[rfa agg] iter: 8, weight: tensor([0.0613, 0.0651, 0.0366, 0.2437, 0.0940, 0.2561, 0.0375, 0.0336, 0.1366,
        0.0353])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3107, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.3463, Accuracy: 0/9950 (0.0000%)
saving model
Done in 490.69733810424805 sec.
Server Epoch:65 choose agents : [78, 89, 90, 16, 68, 76, 57, 27, 83, 41].
_Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   1, Avg loss: 0.0828, Accuracy: 43/416 (10.3365%)
_Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   2, Avg loss: 0.0462, Accuracy: 169/416 (40.6250%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.8015, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 339/896 (37.8348%)
_Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   2, Avg loss: 0.0339, Accuracy: 429/896 (47.8795%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.6515, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   1, Avg loss: 0.0553, Accuracy: 330/677 (48.7445%)
_Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 431/677 (63.6632%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.0179, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   1, Avg loss: 0.0633, Accuracy: 288/708 (40.6780%)
_Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   2, Avg loss: 0.0370, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.0107, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0626, Accuracy: 366/1163 (31.4703%)
_Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0373, Accuracy: 439/1163 (37.7472%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.1980, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0842, Accuracy: 48/466 (10.3004%)
_Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0484, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.9811, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0542, Accuracy: 301/1154 (26.0832%)
_Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0250, Accuracy: 526/1154 (45.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.4329, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0542, Accuracy: 435/1587 (27.4102%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 610/1587 (38.4373%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.3560, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 424/1953 (21.7102%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 790/1953 (40.4506%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.0808, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   1, Avg loss: 0.0583, Accuracy: 337/719 (46.8707%)
_Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   2, Avg loss: 0.0318, Accuracy: 469/719 (65.2295%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.6504, Accuracy: 57/10000 (0.5700%)
time spent on training: 246.2086799144745
[rfa agg] training data poison_ratio: 0.0  data num: [416, 896, 677, 708, 1163, 466, 1154, 1587, 1953, 719]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [78, 89, 90, 16, 68, 76, 57, 27, 83, 41], weight: tensor([0.0427, 0.0920, 0.0695, 0.0727, 0.1194, 0.0478, 0.1185, 0.1630, 0.2005,
        0.0738])
[rfa agg] iter:  0, prev_obj_val: 63.11994171142578, obj_val: 65.84529113769531, abs dis: 2.7253494262695312
[rfa agg] iter: 0, weight: tensor([0.0212, 0.1650, 0.0594, 0.0754, 0.2109, 0.0265, 0.2100, 0.0902, 0.0653,
        0.0760])
[rfa agg] iter:  1, prev_obj_val: 65.84529113769531, obj_val: 69.51834869384766, abs dis: 3.6730575561523438
[rfa agg] iter: 1, weight: tensor([0.0225, 0.3092, 0.0727, 0.0996, 0.1235, 0.0288, 0.1227, 0.0686, 0.0529,
        0.0995])
[rfa agg] iter:  2, prev_obj_val: 69.51834869384766, obj_val: 73.138916015625, abs dis: 3.6205673217773438
[rfa agg] iter: 2, weight: tensor([0.0209, 0.3719, 0.0864, 0.1398, 0.0684, 0.0276, 0.0679, 0.0451, 0.0366,
        0.1356])
[rfa agg] iter:  3, prev_obj_val: 73.138916015625, obj_val: 80.90023040771484, abs dis: 7.761314392089844
[rfa agg] iter: 3, weight: tensor([0.0227, 0.1702, 0.1269, 0.2496, 0.0536, 0.0311, 0.0533, 0.0384, 0.0320,
        0.2223])
[rfa agg] iter:  4, prev_obj_val: 80.90023040771484, obj_val: 84.24472045898438, abs dis: 3.3444900512695312
[rfa agg] iter: 4, weight: tensor([0.0298, 0.0845, 0.3506, 0.1776, 0.0420, 0.0443, 0.0417, 0.0329, 0.0284,
        0.1682])
[rfa agg] iter:  5, prev_obj_val: 84.24472045898438, obj_val: 87.80758666992188, abs dis: 3.5628662109375
[rfa agg] iter: 5, weight: tensor([0.0398, 0.0853, 0.3566, 0.1488, 0.0464, 0.0618, 0.0461, 0.0373, 0.0325,
        0.1453])
[rfa agg] iter:  6, prev_obj_val: 87.80758666992188, obj_val: 80.86234283447266, abs dis: 6.945243835449219
[rfa agg] iter: 6, weight: tensor([0.0579, 0.0943, 0.2695, 0.1446, 0.0551, 0.0956, 0.0547, 0.0453, 0.0399,
        0.1433])
[rfa agg] iter:  7, prev_obj_val: 80.86234283447266, obj_val: 87.81291961669922, abs dis: 6.9505767822265625
[rfa agg] iter: 7, weight: tensor([0.0277, 0.0781, 0.4046, 0.1611, 0.0390, 0.0412, 0.0387, 0.0306, 0.0264,
        0.1526])
[rfa agg] iter:  8, prev_obj_val: 87.81291961669922, obj_val: 80.862060546875, abs dis: 6.950859069824219
[rfa agg] iter: 8, weight: tensor([0.0577, 0.0941, 0.2712, 0.1443, 0.0550, 0.0952, 0.0546, 0.0452, 0.0398,
        0.1430])
[rfa agg] iter:  9, prev_obj_val: 80.862060546875, obj_val: 87.81297302246094, abs dis: 6.9509124755859375
[rfa agg] iter: 9, weight: tensor([0.0277, 0.0780, 0.4051, 0.1610, 0.0389, 0.0412, 0.0387, 0.0305, 0.0263,
        0.1525])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3130, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.3533, Accuracy: 0/9950 (0.0000%)
saving model
Done in 491.23619651794434 sec.
Server Epoch:66 choose agents : [38, 88, 33, 43, 14, 18, 98, 35, 78, 86].
_Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   1, Avg loss: 0.0614, Accuracy: 265/1131 (23.4306%)
_Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   2, Avg loss: 0.0311, Accuracy: 452/1131 (39.9646%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.7794, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0748, Accuracy: 141/603 (23.3831%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0473, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.1271, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   1, Avg loss: 0.0788, Accuracy: 71/515 (13.7864%)
_Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   2, Avg loss: 0.0542, Accuracy: 136/515 (26.4078%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.0443, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   1, Avg loss: 0.0606, Accuracy: 310/946 (32.7696%)
_Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 341/946 (36.0465%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.2682, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   1, Avg loss: 0.0630, Accuracy: 221/1013 (21.8164%)
_Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 294/1013 (29.0227%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.9652, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0733, Accuracy: 125/530 (23.5849%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0379, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.7265, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   1, Avg loss: 0.0788, Accuracy: 41/373 (10.9920%)
_Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   2, Avg loss: 0.0474, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.6904, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   1, Avg loss: 0.0864, Accuracy: 35/271 (12.9151%)
_Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   2, Avg loss: 0.0563, Accuracy: 113/271 (41.6974%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.4817, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0831, Accuracy: 50/416 (12.0192%)
_Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0463, Accuracy: 162/416 (38.9423%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.8756, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0627, Accuracy: 356/1003 (35.4935%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0352, Accuracy: 369/1003 (36.7896%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.6311, Accuracy: 50/10000 (0.5000%)
time spent on training: 211.14398765563965
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 603, 515, 946, 1013, 530, 373, 271, 416, 1003]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 88, 33, 43, 14, 18, 98, 35, 78, 86], weight: tensor([0.1663, 0.0887, 0.0757, 0.1391, 0.1489, 0.0779, 0.0548, 0.0398, 0.0612,
        0.1475])
[rfa agg] iter:  0, prev_obj_val: 41.888832092285156, obj_val: 54.06672286987305, abs dis: 12.17789077758789
[rfa agg] iter: 0, weight: tensor([0.0503, 0.3476, 0.1540, 0.0669, 0.0598, 0.1612, 0.0330, 0.0191, 0.0487,
        0.0593])
[rfa agg] iter:  1, prev_obj_val: 54.06672286987305, obj_val: 57.19328308105469, abs dis: 3.1265602111816406
[rfa agg] iter: 1, weight: tensor([0.0476, 0.1056, 0.1421, 0.0556, 0.0526, 0.1478, 0.1030, 0.0462, 0.2476,
        0.0520])
[rfa agg] iter:  2, prev_obj_val: 57.19328308105469, obj_val: 60.67401885986328, abs dis: 3.4807357788085938
[rfa agg] iter: 2, weight: tensor([0.0386, 0.0745, 0.0932, 0.0444, 0.0422, 0.0969, 0.1285, 0.0489, 0.3909,
        0.0418])
[rfa agg] iter:  3, prev_obj_val: 60.67401885986328, obj_val: 60.66794967651367, abs dis: 0.006069183349609375
[rfa agg] iter: 3, weight: tensor([0.0400, 0.0694, 0.0816, 0.0452, 0.0433, 0.0846, 0.2353, 0.0690, 0.2887,
        0.0429])
[rfa agg] iter:  4, prev_obj_val: 60.66794967651367, obj_val: 64.36724853515625, abs dis: 3.699298858642578
[rfa agg] iter: 4, weight: tensor([0.0399, 0.0691, 0.0812, 0.0450, 0.0432, 0.0844, 0.2462, 0.0691, 0.2793,
        0.0427])
[rfa agg] iter:  5, prev_obj_val: 64.36724853515625, obj_val: 60.67864990234375, abs dis: 3.6885986328125
[rfa agg] iter: 5, weight: tensor([0.0365, 0.0580, 0.0653, 0.0407, 0.0392, 0.0677, 0.4081, 0.0927, 0.1530,
        0.0388])
[rfa agg] iter:  6, prev_obj_val: 60.67864990234375, obj_val: 60.667991638183594, abs dis: 0.01065826416015625
[rfa agg] iter: 6, weight: tensor([0.0396, 0.0686, 0.0806, 0.0448, 0.0429, 0.0839, 0.2637, 0.0692, 0.2643,
        0.0425])
[rfa agg] iter:  7, prev_obj_val: 60.667991638183594, obj_val: 64.36685180664062, abs dis: 3.6988601684570312
[rfa agg] iter: 7, weight: tensor([0.0398, 0.0690, 0.0812, 0.0450, 0.0431, 0.0843, 0.2490, 0.0691, 0.2767,
        0.0427])
[rfa agg] iter:  8, prev_obj_val: 64.36685180664062, obj_val: 60.67872619628906, abs dis: 3.6881256103515625
[rfa agg] iter: 8, weight: tensor([0.0365, 0.0579, 0.0652, 0.0406, 0.0392, 0.0676, 0.4089, 0.0925, 0.1527,
        0.0388])
[rfa agg] iter:  9, prev_obj_val: 60.67872619628906, obj_val: 60.667999267578125, abs dis: 0.0107269287109375
[rfa agg] iter: 9, weight: tensor([0.0396, 0.0686, 0.0806, 0.0448, 0.0429, 0.0839, 0.2638, 0.0692, 0.2643,
        0.0425])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3151, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.3656, Accuracy: 0/9950 (0.0000%)
saving model
Done in 456.10928201675415 sec.
Server Epoch:67 choose agents : [94, 13, 95, 73, 30, 22, 25, 10, 86, 8].
_Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 339/1662 (20.3971%)
_Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 601/1662 (36.1613%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.8513, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 316/1645 (19.2097%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 601/1645 (36.5350%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.1302, Accuracy: 120/10000 (1.2000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0455, Accuracy: 409/599 (68.2805%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0299, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.7643, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0649, Accuracy: 184/938 (19.6162%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 295/938 (31.4499%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.7577, Accuracy: 59/10000 (0.5900%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   1, Avg loss: 0.0750, Accuracy: 102/486 (20.9877%)
_Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   2, Avg loss: 0.0401, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.2945, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   1, Avg loss: 0.0449, Accuracy: 568/1470 (38.6395%)
_Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 877/1470 (59.6599%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.4984, Accuracy: 100/10000 (1.0000%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   1, Avg loss: 0.0554, Accuracy: 320/690 (46.3768%)
_Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.0211, Accuracy: 63/10000 (0.6300%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   1, Avg loss: 0.0569, Accuracy: 217/861 (25.2033%)
_Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 448/861 (52.0325%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.4920, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0634, Accuracy: 362/1003 (36.0917%)
_Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0349, Accuracy: 392/1003 (39.0828%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.8861, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   1, Avg loss: 0.0595, Accuracy: 275/1513 (18.1758%)
_Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 500/1513 (33.0469%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.6753, Accuracy: 92/10000 (0.9200%)
time spent on training: 340.1857433319092
[rfa agg] training data poison_ratio: 0.24256924634213675  data num: [1662, 1645, 599, 938, 486, 1470, 690, 861, 1003, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.07580288948191774
[rfa agg] init. name: [94, 13, 95, 73, 30, 22, 25, 10, 86, 8], weight: tensor([0.1529, 0.1514, 0.0551, 0.0863, 0.0447, 0.1353, 0.0635, 0.0792, 0.0923,
        0.1392])
[rfa agg] iter:  0, prev_obj_val: 56.294700622558594, obj_val: 61.319618225097656, abs dis: 5.0249176025390625
[rfa agg] iter: 0, weight: tensor([0.0725, 0.0717, 0.0336, 0.1658, 0.0213, 0.0956, 0.0451, 0.1095, 0.3003,
        0.0846])
[rfa agg] iter:  1, prev_obj_val: 61.319618225097656, obj_val: 63.32981872558594, abs dis: 2.0102005004882812
[rfa agg] iter: 1, weight: tensor([0.0425, 0.0420, 0.0335, 0.2895, 0.0195, 0.0515, 0.0479, 0.1906, 0.2357,
        0.0472])
[rfa agg] iter:  2, prev_obj_val: 63.32981872558594, obj_val: 63.316036224365234, abs dis: 0.013782501220703125
[rfa agg] iter: 2, weight: tensor([0.0399, 0.0395, 0.0365, 0.2830, 0.0206, 0.0476, 0.0534, 0.2702, 0.1653,
        0.0439])
[rfa agg] iter:  3, prev_obj_val: 63.316036224365234, obj_val: 63.31568145751953, abs dis: 0.000354766845703125
[rfa agg] iter: 3, weight: tensor([0.0393, 0.0389, 0.0359, 0.2780, 0.0203, 0.0468, 0.0526, 0.2854, 0.1596,
        0.0432])
[rfa agg] iter:  4, prev_obj_val: 63.31568145751953, obj_val: 61.27640914916992, abs dis: 2.0392723083496094
[rfa agg] iter: 4, weight: tensor([0.0392, 0.0388, 0.0358, 0.2760, 0.0203, 0.0467, 0.0525, 0.2886, 0.1590,
        0.0431])
[rfa agg] iter:  5, prev_obj_val: 61.27640914916992, obj_val: 63.3267936706543, abs dis: 2.050384521484375
[rfa agg] iter: 5, weight: tensor([0.0406, 0.0402, 0.0321, 0.3243, 0.0187, 0.0492, 0.0458, 0.1962, 0.2077,
        0.0451])
[rfa agg] iter:  6, prev_obj_val: 63.3267936706543, obj_val: 63.316253662109375, abs dis: 0.010540008544921875
[rfa agg] iter: 6, weight: tensor([0.0396, 0.0392, 0.0362, 0.2911, 0.0205, 0.0472, 0.0530, 0.2676, 0.1623,
        0.0435])
[rfa agg] iter:  7, prev_obj_val: 63.316253662109375, obj_val: 63.315696716308594, abs dis: 0.00055694580078125
[rfa agg] iter: 7, weight: tensor([0.0392, 0.0388, 0.0359, 0.2801, 0.0203, 0.0468, 0.0525, 0.2840, 0.1592,
        0.0431])
[rfa agg] iter:  8, prev_obj_val: 63.315696716308594, obj_val: 61.27626419067383, abs dis: 2.0394325256347656
[rfa agg] iter: 8, weight: tensor([0.0392, 0.0388, 0.0358, 0.2765, 0.0203, 0.0467, 0.0525, 0.2881, 0.1589,
        0.0431])
[rfa agg] iter:  9, prev_obj_val: 61.27626419067383, obj_val: 63.326812744140625, abs dis: 2.050548553466797
[rfa agg] iter: 9, weight: tensor([0.0406, 0.0402, 0.0321, 0.3245, 0.0187, 0.0492, 0.0458, 0.1961, 0.2076,
        0.0451])
			Update norm = 131.3491589714224 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3151, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.3656, Accuracy: 0/9950 (0.0000%)
saving model
Done in 594.7714169025421 sec.
Server Epoch:68 choose agents : [83, 52, 97, 44, 67, 7, 87, 76, 46, 17].
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 445/1953 (22.7855%)
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 776/1953 (39.7337%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6738, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0564, Accuracy: 285/636 (44.8113%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0314, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.9690, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   1, Avg loss: 0.0519, Accuracy: 354/1213 (29.1838%)
_Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 468/1213 (38.5820%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3750, Accuracy: 92/10000 (0.9200%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 408/1750 (23.3143%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 692/1750 (39.5429%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6953, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   1, Avg loss: 0.0770, Accuracy: 58/426 (13.6150%)
_Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   2, Avg loss: 0.0413, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.9690, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   1, Avg loss: 0.0529, Accuracy: 350/891 (39.2817%)
_Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 446/891 (50.0561%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6844, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0576, Accuracy: 302/1131 (26.7020%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0322, Accuracy: 391/1131 (34.5712%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.8327, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   1, Avg loss: 0.0842, Accuracy: 53/466 (11.3734%)
_Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   2, Avg loss: 0.0497, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.2328, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   1, Avg loss: 0.0559, Accuracy: 404/1904 (21.2185%)
_Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 639/1904 (33.5609%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1282, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0521, Accuracy: 373/1574 (23.6976%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 656/1574 (41.6773%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3008, Accuracy: 104/10000 (1.0400%)
time spent on training: 295.06313729286194
[rfa agg] training data poison_ratio: 0.14651707970529135  data num: [1953, 636, 1213, 1750, 426, 891, 1131, 466, 1904, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.04578658740790355
[rfa agg] init. name: [83, 52, 97, 44, 67, 7, 87, 76, 46, 17], weight: tensor([0.1635, 0.0532, 0.1016, 0.1465, 0.0357, 0.0746, 0.0947, 0.0390, 0.1594,
        0.1318])
[rfa agg] iter:  0, prev_obj_val: 65.21607208251953, obj_val: 68.12291717529297, abs dis: 2.9068450927734375
[rfa agg] iter: 0, weight: tensor([0.0878, 0.0260, 0.2542, 0.1117, 0.0137, 0.0568, 0.1649, 0.0161, 0.0949,
        0.1738])
[rfa agg] iter:  1, prev_obj_val: 68.12291717529297, obj_val: 70.94731140136719, abs dis: 2.8243942260742188
[rfa agg] iter: 1, weight: tensor([0.0514, 0.0202, 0.4470, 0.0621, 0.0103, 0.0483, 0.2076, 0.0123, 0.0548,
        0.0860])
[rfa agg] iter:  2, prev_obj_val: 70.94731140136719, obj_val: 75.28130340576172, abs dis: 4.333992004394531
[rfa agg] iter: 2, weight: tensor([0.0376, 0.0180, 0.4191, 0.0442, 0.0089, 0.0464, 0.3174, 0.0107, 0.0398,
        0.0579])
[rfa agg] iter:  3, prev_obj_val: 75.28130340576172, obj_val: 77.80001831054688, abs dis: 2.5187149047851562
[rfa agg] iter: 3, weight: tensor([0.0440, 0.0257, 0.2326, 0.0506, 0.0123, 0.0741, 0.4359, 0.0149, 0.0463,
        0.0635])
[rfa agg] iter:  4, prev_obj_val: 77.80001831054688, obj_val: 75.24348449707031, abs dis: 2.5565338134765625
[rfa agg] iter: 4, weight: tensor([0.0516, 0.0334, 0.2122, 0.0587, 0.0158, 0.1039, 0.3786, 0.0191, 0.0542,
        0.0725])
[rfa agg] iter:  5, prev_obj_val: 75.24348449707031, obj_val: 75.23461151123047, abs dis: 0.00887298583984375
[rfa agg] iter: 5, weight: tensor([0.0426, 0.0249, 0.2158, 0.0490, 0.0120, 0.0723, 0.4625, 0.0145, 0.0449,
        0.0616])
[rfa agg] iter:  6, prev_obj_val: 75.23461151123047, obj_val: 80.43231201171875, abs dis: 5.197700500488281
[rfa agg] iter: 6, weight: tensor([0.0413, 0.0241, 0.2086, 0.0475, 0.0116, 0.0698, 0.4798, 0.0140, 0.0435,
        0.0597])
[rfa agg] iter:  7, prev_obj_val: 80.43231201171875, obj_val: 80.40959167480469, abs dis: 0.0227203369140625
[rfa agg] iter: 7, weight: tensor([0.0578, 0.0417, 0.2003, 0.0652, 0.0192, 0.1411, 0.3114, 0.0235, 0.0605,
        0.0792])
			Update norm = 149.01805548112281 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3151, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.3656, Accuracy: 0/9950 (0.0000%)
saving model
Done in 538.549702167511 sec.
Server Epoch:69 choose agents : [90, 24, 28, 70, 52, 97, 11, 21, 20, 62].
_Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   1, Avg loss: 0.0518, Accuracy: 356/677 (52.5849%)
_Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   2, Avg loss: 0.0218, Accuracy: 426/677 (62.9247%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.7287, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   1, Avg loss: 0.0758, Accuracy: 50/312 (16.0256%)
_Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   2, Avg loss: 0.0407, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.6474, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 383/1581 (24.2252%)
_Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 594/1581 (37.5712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8149, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 357/1418 (25.1763%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 658/1418 (46.4034%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.2515, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   1, Avg loss: 0.0568, Accuracy: 287/636 (45.1258%)
_Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   2, Avg loss: 0.0316, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.7309, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   1, Avg loss: 0.0512, Accuracy: 364/1213 (30.0082%)
_Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 492/1213 (40.5606%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.9008, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   1, Avg loss: 0.0545, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 405/712 (56.8820%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.1201, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 380/1949 (19.4972%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0326, Accuracy: 660/1949 (33.8635%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.0847, Accuracy: 87/10000 (0.8700%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0577, Accuracy: 343/807 (42.5031%)
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 414/807 (51.3011%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.0326, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   1, Avg loss: 0.0653, Accuracy: 175/568 (30.8099%)
_Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   2, Avg loss: 0.0395, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.1332, Accuracy: 56/10000 (0.5600%)
time spent on training: 244.70902132987976
[rfa agg] training data poison_ratio: 0.08173807353388028  data num: [677, 312, 1581, 1418, 636, 1213, 712, 1949, 807, 568]
[rfa agg] considering poison per batch poison_fraction: 0.02554314797933759
[rfa agg] init. name: [90, 24, 28, 70, 52, 97, 11, 21, 20, 62], weight: tensor([0.0686, 0.0316, 0.1601, 0.1436, 0.0644, 0.1229, 0.0721, 0.1974, 0.0817,
        0.0575])
[rfa agg] iter:  0, prev_obj_val: 65.94853210449219, obj_val: 69.0898208618164, abs dis: 3.1412887573242188
[rfa agg] iter: 0, weight: tensor([0.0452, 0.0112, 0.1053, 0.1310, 0.0372, 0.4404, 0.0552, 0.0702, 0.0747,
        0.0296])
[rfa agg] iter:  1, prev_obj_val: 69.0898208618164, obj_val: 71.28905487060547, abs dis: 2.1992340087890625
[rfa agg] iter: 1, weight: tensor([0.0713, 0.0158, 0.1082, 0.1262, 0.0569, 0.2778, 0.0908, 0.0784, 0.1306,
        0.0441])
[rfa agg] iter:  2, prev_obj_val: 71.28905487060547, obj_val: 74.7230224609375, abs dis: 3.4339675903320312
[rfa agg] iter: 2, weight: tensor([0.0872, 0.0174, 0.0972, 0.1100, 0.0673, 0.1997, 0.1164, 0.0736, 0.1802,
        0.0510])
[rfa agg] iter:  3, prev_obj_val: 74.7230224609375, obj_val: 77.31439208984375, abs dis: 2.59136962890625
[rfa agg] iter: 3, weight: tensor([0.1019, 0.0160, 0.0663, 0.0725, 0.0726, 0.1111, 0.1548, 0.0530, 0.2996,
        0.0522])
[rfa agg] iter:  4, prev_obj_val: 77.31439208984375, obj_val: 79.01622009277344, abs dis: 1.7018280029296875
[rfa agg] iter: 4, weight: tensor([0.1011, 0.0122, 0.0414, 0.0445, 0.0651, 0.0631, 0.1860, 0.0340, 0.4083,
        0.0443])
[rfa agg] iter:  5, prev_obj_val: 79.01622009277344, obj_val: 85.99242401123047, abs dis: 6.976203918457031
[rfa agg] iter: 5, weight: tensor([0.1207, 0.0122, 0.0373, 0.0398, 0.0721, 0.0547, 0.2547, 0.0311, 0.3301,
        0.0473])
[rfa agg] iter:  6, prev_obj_val: 85.99242401123047, obj_val: 88.80928802490234, abs dis: 2.816864013671875
[rfa agg] iter: 6, weight: tensor([0.3032, 0.0155, 0.0339, 0.0354, 0.1547, 0.0453, 0.1844, 0.0293, 0.1164,
        0.0819])
[rfa agg] iter:  7, prev_obj_val: 88.80928802490234, obj_val: 91.99088287353516, abs dis: 3.1815948486328125
[rfa agg] iter: 7, weight: tensor([0.2876, 0.0165, 0.0318, 0.0330, 0.2399, 0.0415, 0.1276, 0.0277, 0.0898,
        0.1046])
[rfa agg] iter:  8, prev_obj_val: 91.99088287353516, obj_val: 95.46965789794922, abs dis: 3.4787750244140625
[rfa agg] iter: 8, weight: tensor([0.1779, 0.0180, 0.0306, 0.0316, 0.3551, 0.0390, 0.0978, 0.0269, 0.0753,
        0.1478])
[rfa agg] iter:  9, prev_obj_val: 95.46965789794922, obj_val: 95.462158203125, abs dis: 0.00749969482421875
[rfa agg] iter: 9, weight: tensor([0.1327, 0.0215, 0.0319, 0.0328, 0.3007, 0.0398, 0.0855, 0.0283, 0.0700,
        0.2569])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3179, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.3795, Accuracy: 0/9950 (0.0000%)
saving model
Done in 489.47283458709717 sec.
Server Epoch:70 choose agents : [75, 24, 36, 52, 95, 82, 93, 97, 6, 81].
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0638, Accuracy: 237/776 (30.5412%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 415/776 (53.4794%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.2911, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   1, Avg loss: 0.0758, Accuracy: 54/312 (17.3077%)
_Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   2, Avg loss: 0.0403, Accuracy: 157/312 (50.3205%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.6539, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.0832, Accuracy: 93/408 (22.7941%)
_Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0519, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.8120, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   1, Avg loss: 0.0536, Accuracy: 312/636 (49.0566%)
_Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   2, Avg loss: 0.0303, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.0224, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   1, Avg loss: 0.0456, Accuracy: 401/599 (66.9449%)
_Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   2, Avg loss: 0.0266, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.8421, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   1, Avg loss: 0.0740, Accuracy: 85/500 (17.0000%)
_Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 180/500 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.0461, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   1, Avg loss: 0.0562, Accuracy: 425/1742 (24.3972%)
_Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 690/1742 (39.6096%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.2023, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0513, Accuracy: 362/1213 (29.8434%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 500/1213 (41.2201%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3581, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0552, Accuracy: 410/1956 (20.9611%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 682/1956 (34.8671%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.4863, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   1, Avg loss: 0.0679, Accuracy: 236/774 (30.4910%)
_Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   2, Avg loss: 0.0374, Accuracy: 307/774 (39.6641%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.4147, Accuracy: 74/10000 (0.7400%)
time spent on training: 261.7449402809143
[rfa agg] training data poison_ratio: 0.06718259309107223  data num: [776, 312, 408, 636, 599, 500, 1742, 1213, 1956, 774]
[rfa agg] considering poison per batch poison_fraction: 0.02099456034096007
[rfa agg] init. name: [75, 24, 36, 52, 95, 82, 93, 97, 6, 81], weight: tensor([0.0870, 0.0350, 0.0458, 0.0713, 0.0672, 0.0561, 0.1954, 0.1360, 0.2194,
        0.0868])
[rfa agg] iter:  0, prev_obj_val: 76.87583923339844, obj_val: 78.19157409667969, abs dis: 1.31573486328125
[rfa agg] iter: 0, weight: tensor([0.1245, 0.0169, 0.0265, 0.0587, 0.0554, 0.0361, 0.1026, 0.3647, 0.0907,
        0.1239])
[rfa agg] iter:  1, prev_obj_val: 78.19157409667969, obj_val: 81.24746704101562, abs dis: 3.0558929443359375
[rfa agg] iter: 1, weight: tensor([0.1910, 0.0189, 0.0305, 0.0728, 0.0688, 0.0423, 0.0884, 0.2175, 0.0801,
        0.1898])
[rfa agg] iter:  2, prev_obj_val: 81.24746704101562, obj_val: 84.6152114868164, abs dis: 3.3677444458007812
[rfa agg] iter: 2, weight: tensor([0.3680, 0.0106, 0.0184, 0.0560, 0.0533, 0.0271, 0.0316, 0.0547, 0.0295,
        0.3508])
[rfa agg] iter:  3, prev_obj_val: 84.6152114868164, obj_val: 88.63556671142578, abs dis: 4.020355224609375
[rfa agg] iter: 3, weight: tensor([0.2691, 0.0170, 0.0310, 0.1130, 0.1092, 0.0474, 0.0415, 0.0657, 0.0393,
        0.2668])
[rfa agg] iter:  4, prev_obj_val: 88.63556671142578, obj_val: 90.73138427734375, abs dis: 2.0958175659179688
[rfa agg] iter: 4, weight: tensor([0.1533, 0.0211, 0.0413, 0.2096, 0.2114, 0.0671, 0.0417, 0.0615, 0.0399,
        0.1531])
[rfa agg] iter:  5, prev_obj_val: 90.73138427734375, obj_val: 95.9554672241211, abs dis: 5.224082946777344
[rfa agg] iter: 5, weight: tensor([0.1035, 0.0193, 0.0396, 0.2665, 0.2848, 0.0675, 0.0341, 0.0487, 0.0327,
        0.1034])
[rfa agg] iter:  6, prev_obj_val: 95.9554672241211, obj_val: 105.66471862792969, abs dis: 9.709251403808594
[rfa agg] iter: 6, weight: tensor([0.0738, 0.0233, 0.0542, 0.2722, 0.2890, 0.1081, 0.0318, 0.0431, 0.0308,
        0.0738])
[rfa agg] iter:  7, prev_obj_val: 105.66471862792969, obj_val: 105.60002136230469, abs dis: 0.064697265625
[rfa agg] iter: 7, weight: tensor([0.0547, 0.0362, 0.1301, 0.1082, 0.1034, 0.4125, 0.0309, 0.0391, 0.0302,
        0.0546])
[rfa agg] iter:  8, prev_obj_val: 105.60002136230469, obj_val: 105.5922622680664, abs dis: 0.00775909423828125
[rfa agg] iter: 8, weight: tensor([0.0437, 0.0291, 0.1068, 0.0855, 0.0822, 0.5289, 0.0247, 0.0312, 0.0242,
        0.0437])
[rfa agg] iter:  9, prev_obj_val: 105.5922622680664, obj_val: 102.30236053466797, abs dis: 3.2899017333984375
[rfa agg] iter: 9, weight: tensor([0.0387, 0.0258, 0.0939, 0.0753, 0.0726, 0.5842, 0.0219, 0.0276, 0.0214,
        0.0386])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3205, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.3920, Accuracy: 0/9950 (0.0000%)
saving model
Done in 507.67748737335205 sec.
Server Epoch:71 choose agents : [88, 8, 87, 89, 65, 19, 11, 23, 49, 57].
_Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   1, Avg loss: 0.0759, Accuracy: 138/603 (22.8856%)
_Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.4291, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   1, Avg loss: 0.0593, Accuracy: 245/1513 (16.1930%)
_Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 475/1513 (31.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.5776, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   1, Avg loss: 0.0576, Accuracy: 307/1131 (27.1441%)
_Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   2, Avg loss: 0.0312, Accuracy: 434/1131 (38.3731%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.8634, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 332/896 (37.0536%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 452/896 (50.4464%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.4767, Accuracy: 55/10000 (0.5500%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   1, Avg loss: 0.0547, Accuracy: 389/1475 (26.3729%)
_Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   2, Avg loss: 0.0316, Accuracy: 686/1475 (46.5085%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.6933, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 422/1036 (40.7336%)
_Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   2, Avg loss: 0.0254, Accuracy: 626/1036 (60.4247%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.1375, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   1, Avg loss: 0.0535, Accuracy: 352/712 (49.4382%)
_Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 416/712 (58.4270%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.0864, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0639, Accuracy: 324/715 (45.3147%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0382, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.8681, Accuracy: 50/10000 (0.5000%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0760, Accuracy: 49/440 (11.1364%)
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0450, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.8594, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   1, Avg loss: 0.0556, Accuracy: 317/1154 (27.4697%)
_Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   2, Avg loss: 0.0253, Accuracy: 469/1154 (40.6412%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.4751, Accuracy: 85/10000 (0.8500%)
time spent on training: 318.444118976593
[rfa agg] training data poison_ratio: 0.1979328165374677  data num: [603, 1513, 1131, 896, 1475, 1036, 712, 715, 440, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.06185400516795865
[rfa agg] init. name: [88, 8, 87, 89, 65, 19, 11, 23, 49, 57], weight: tensor([0.0623, 0.1564, 0.1169, 0.0926, 0.1525, 0.1071, 0.0736, 0.0739, 0.0455,
        0.1193])
[rfa agg] iter:  0, prev_obj_val: 45.96940612792969, obj_val: 52.995399475097656, abs dis: 7.025993347167969
[rfa agg] iter: 0, weight: tensor([0.0432, 0.0604, 0.1305, 0.2468, 0.0589, 0.1720, 0.0838, 0.0834, 0.0198,
        0.1013])
[rfa agg] iter:  1, prev_obj_val: 52.995399475097656, obj_val: 55.229248046875, abs dis: 2.2338485717773438
[rfa agg] iter: 1, weight: tensor([0.0632, 0.0438, 0.0714, 0.2380, 0.0427, 0.0815, 0.1909, 0.1846, 0.0234,
        0.0607])
[rfa agg] iter:  2, prev_obj_val: 55.229248046875, obj_val: 60.826744079589844, abs dis: 5.597496032714844
[rfa agg] iter: 2, weight: tensor([0.0665, 0.0370, 0.0573, 0.1540, 0.0360, 0.0639, 0.2654, 0.2480, 0.0225,
        0.0494])
[rfa agg] iter:  3, prev_obj_val: 60.826744079589844, obj_val: 67.67227935791016, abs dis: 6.8455352783203125
[rfa agg] iter: 3, weight: tensor([0.1080, 0.0346, 0.0494, 0.0985, 0.0337, 0.0534, 0.2852, 0.2657, 0.0278,
        0.0437])
[rfa agg] iter:  4, prev_obj_val: 67.67227935791016, obj_val: 79.11792755126953, abs dis: 11.445648193359375
[rfa agg] iter: 4, weight: tensor([0.2956, 0.0407, 0.0545, 0.0910, 0.0397, 0.0576, 0.1643, 0.1623, 0.0453,
        0.0491])
[rfa agg] iter:  5, prev_obj_val: 79.11792755126953, obj_val: 64.19744873046875, abs dis: 14.920478820800781
[rfa agg] iter: 5, weight: tensor([0.2805, 0.0508, 0.0632, 0.0895, 0.0496, 0.0651, 0.1180, 0.1178, 0.1074,
        0.0580])
[rfa agg] iter:  6, prev_obj_val: 64.19744873046875, obj_val: 67.6520004272461, abs dis: 3.4545516967773438
[rfa agg] iter: 6, weight: tensor([0.1932, 0.0405, 0.0559, 0.1010, 0.0394, 0.0597, 0.2151, 0.2073, 0.0381,
        0.0499])
[rfa agg] iter:  7, prev_obj_val: 67.6520004272461, obj_val: 75.11836242675781, abs dis: 7.466361999511719
[rfa agg] iter: 7, weight: tensor([0.3090, 0.0401, 0.0537, 0.0897, 0.0391, 0.0567, 0.1606, 0.1584, 0.0446,
        0.0483])
[rfa agg] iter:  8, prev_obj_val: 75.11836242675781, obj_val: 75.11454010009766, abs dis: 0.00382232666015625
[rfa agg] iter: 8, weight: tensor([0.3787, 0.0425, 0.0541, 0.0803, 0.0415, 0.0562, 0.1137, 0.1133, 0.0704,
        0.0494])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3228, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.4005, Accuracy: 0/9950 (0.0000%)
saving model
Done in 562.1781747341156 sec.
Server Epoch:72 choose agents : [78, 58, 7, 87, 5, 96, 28, 39, 91, 22].
_Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   1, Avg loss: 0.0787, Accuracy: 80/416 (19.2308%)
_Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   2, Avg loss: 0.0448, Accuracy: 161/416 (38.7019%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.0414, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   1, Avg loss: 0.0574, Accuracy: 351/803 (43.7111%)
_Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   2, Avg loss: 0.0338, Accuracy: 420/803 (52.3039%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.3221, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 437/891 (49.0460%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.5403, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0574, Accuracy: 307/1131 (27.1441%)
_Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 417/1131 (36.8700%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.3355, Accuracy: 52/10000 (0.5200%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   1, Avg loss: 0.0509, Accuracy: 391/1628 (24.0172%)
_Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 813/1628 (49.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.1571, Accuracy: 144/10000 (1.4400%)
_Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 51/311 (16.3987%)
_Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0529, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.5358, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   1, Avg loss: 0.0555, Accuracy: 401/1581 (25.3637%)
_Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 607/1581 (38.3934%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.7985, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 316/1013 (31.1945%)
_Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 501/1013 (49.4571%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.9255, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0518, Accuracy: 337/1030 (32.7184%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0256, Accuracy: 634/1030 (61.5534%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.7623, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 529/1470 (35.9864%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 819/1470 (55.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2841, Accuracy: 101/10000 (1.0100%)
time spent on training: 258.5158143043518
[rfa agg] training data poison_ratio: 0.15845824411134904  data num: [416, 803, 891, 1131, 1628, 311, 1581, 1013, 1030, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.04951820128479657
[rfa agg] init. name: [78, 58, 7, 87, 5, 96, 28, 39, 91, 22], weight: tensor([0.0405, 0.0782, 0.0867, 0.1101, 0.1585, 0.0303, 0.1539, 0.0986, 0.1003,
        0.1431])
[rfa agg] iter:  0, prev_obj_val: 47.170684814453125, obj_val: 54.10911560058594, abs dis: 6.9384307861328125
[rfa agg] iter: 0, weight: tensor([0.0108, 0.0516, 0.0738, 0.2219, 0.0469, 0.0067, 0.0513, 0.2156, 0.2582,
        0.0632])
[rfa agg] iter:  1, prev_obj_val: 54.10911560058594, obj_val: 56.45777130126953, abs dis: 2.3486557006835938
[rfa agg] iter: 1, weight: tensor([0.0159, 0.1148, 0.1936, 0.1120, 0.0451, 0.0095, 0.0482, 0.2594, 0.1456,
        0.0559])
[rfa agg] iter:  2, prev_obj_val: 56.45777130126953, obj_val: 59.03764343261719, abs dis: 2.5798721313476562
[rfa agg] iter: 2, weight: tensor([0.0169, 0.1488, 0.2771, 0.0961, 0.0431, 0.0100, 0.0459, 0.1921, 0.1175,
        0.0526])
[rfa agg] iter:  3, prev_obj_val: 59.03764343261719, obj_val: 59.023529052734375, abs dis: 0.0141143798828125
[rfa agg] iter: 3, weight: tensor([0.0171, 0.1919, 0.3414, 0.0797, 0.0390, 0.0099, 0.0413, 0.1388, 0.0939,
        0.0469])
[rfa agg] iter:  4, prev_obj_val: 59.023529052734375, obj_val: 61.933719635009766, abs dis: 2.9101905822753906
[rfa agg] iter: 4, weight: tensor([0.0165, 0.1866, 0.3639, 0.0770, 0.0377, 0.0096, 0.0400, 0.1330, 0.0904,
        0.0453])
[rfa agg] iter:  5, prev_obj_val: 61.933719635009766, obj_val: 65.12277221679688, abs dis: 3.1890525817871094
[rfa agg] iter: 5, weight: tensor([0.0184, 0.2749, 0.3104, 0.0711, 0.0374, 0.0105, 0.0395, 0.1122, 0.0812,
        0.0444])
[rfa agg] iter:  6, prev_obj_val: 65.12277221679688, obj_val: 65.09002685546875, abs dis: 0.032745361328125
[rfa agg] iter: 6, weight: tensor([0.0204, 0.3976, 0.2145, 0.0659, 0.0370, 0.0115, 0.0389, 0.0972, 0.0737,
        0.0433])
[rfa agg] iter:  7, prev_obj_val: 65.09002685546875, obj_val: 68.62388610839844, abs dis: 3.5338592529296875
[rfa agg] iter: 7, weight: tensor([0.0188, 0.4555, 0.1874, 0.0607, 0.0340, 0.0106, 0.0358, 0.0895, 0.0678,
        0.0399])
[rfa agg] iter:  8, prev_obj_val: 68.62388610839844, obj_val: 61.938140869140625, abs dis: 6.6857452392578125
[rfa agg] iter: 8, weight: tensor([0.0256, 0.4131, 0.1752, 0.0689, 0.0409, 0.0140, 0.0429, 0.0963, 0.0757,
        0.0474])
[rfa agg] iter:  9, prev_obj_val: 61.938140869140625, obj_val: 65.10160064697266, abs dis: 3.1634597778320312
[rfa agg] iter: 9, weight: tensor([0.0181, 0.3371, 0.2536, 0.0701, 0.0369, 0.0104, 0.0390, 0.1108, 0.0801,
        0.0438])
			Update norm = 117.34249749664441 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3228, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.4005, Accuracy: 0/9950 (0.0000%)
saving model
Done in 501.01547837257385 sec.
Server Epoch:73 choose agents : [98, 36, 21, 76, 10, 40, 61, 4, 75, 26].
_Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   1, Avg loss: 0.0765, Accuracy: 46/373 (12.3324%)
_Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   2, Avg loss: 0.0458, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.7908, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.0824, Accuracy: 97/408 (23.7745%)
_Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0509, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.8883, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 412/1949 (21.1390%)
_Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 643/1949 (32.9913%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.2466, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   1, Avg loss: 0.0840, Accuracy: 58/466 (12.4464%)
_Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   2, Avg loss: 0.0510, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.1074, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0571, Accuracy: 206/861 (23.9257%)
_Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 442/861 (51.3357%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.5410, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 356/1573 (22.6319%)
_Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 575/1573 (36.5544%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.7354, Accuracy: 77/10000 (0.7700%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   1, Avg loss: 0.1289, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   2, Avg loss: 0.1202, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3383, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0616, Accuracy: 328/901 (36.4040%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0315, Accuracy: 400/901 (44.3951%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.6090, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   1, Avg loss: 0.0650, Accuracy: 250/776 (32.2165%)
_Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 418/776 (53.8660%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.2628, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 340/1446 (23.5131%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 509/1446 (35.2006%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.5048, Accuracy: 65/10000 (0.6500%)
time spent on training: 241.61870551109314
[rfa agg] training data poison_ratio: 0.1070377913555103  data num: [373, 408, 1949, 466, 861, 1573, 85, 901, 776, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.03344930979859697
[rfa agg] init. name: [98, 36, 21, 76, 10, 40, 61, 4, 75, 26], weight: tensor([0.0422, 0.0462, 0.2205, 0.0527, 0.0974, 0.1780, 0.0096, 0.1019, 0.0878,
        0.1636])
[rfa agg] iter:  0, prev_obj_val: 70.5079345703125, obj_val: 72.28404235839844, abs dis: 1.7761077880859375
[rfa agg] iter: 0, weight: tensor([0.0218, 0.0261, 0.0968, 0.0329, 0.1612, 0.1397, 0.0037, 0.2289, 0.1144,
        0.1747])
[rfa agg] iter:  1, prev_obj_val: 72.28404235839844, obj_val: 75.15441131591797, abs dis: 2.8703689575195312
[rfa agg] iter: 1, weight: tensor([0.0182, 0.0221, 0.0633, 0.0284, 0.1984, 0.0848, 0.0030, 0.3585, 0.1231,
        0.1003])
[rfa agg] iter:  2, prev_obj_val: 75.15441131591797, obj_val: 78.94410705566406, abs dis: 3.7896957397460938
[rfa agg] iter: 2, weight: tensor([0.0133, 0.0164, 0.0357, 0.0216, 0.3142, 0.0452, 0.0021, 0.3585, 0.1417,
        0.0513])
[rfa agg] iter:  3, prev_obj_val: 78.94410705566406, obj_val: 78.88704681396484, abs dis: 0.05706024169921875
[rfa agg] iter: 3, weight: tensor([0.0156, 0.0197, 0.0350, 0.0265, 0.3559, 0.0428, 0.0023, 0.1767, 0.2778,
        0.0477])
[rfa agg] iter:  4, prev_obj_val: 78.88704681396484, obj_val: 81.34231567382812, abs dis: 2.4552688598632812
[rfa agg] iter: 4, weight: tensor([0.0150, 0.0189, 0.0336, 0.0254, 0.3554, 0.0411, 0.0022, 0.1628, 0.3000,
        0.0457])
[rfa agg] iter:  5, prev_obj_val: 81.34231567382812, obj_val: 78.90386199951172, abs dis: 2.4384536743164062
[rfa agg] iter: 5, weight: tensor([0.0170, 0.0217, 0.0347, 0.0297, 0.2435, 0.0419, 0.0025, 0.1354, 0.4273,
        0.0462])
[rfa agg] iter:  6, prev_obj_val: 78.90386199951172, obj_val: 81.32697296142578, abs dis: 2.4231109619140625
[rfa agg] iter: 6, weight: tensor([0.0149, 0.0188, 0.0334, 0.0253, 0.3160, 0.0409, 0.0022, 0.1599, 0.3429,
        0.0455])
[rfa agg] iter:  7, prev_obj_val: 81.32697296142578, obj_val: 81.30279541015625, abs dis: 0.02417755126953125
[rfa agg] iter: 7, weight: tensor([0.0166, 0.0212, 0.0338, 0.0289, 0.2331, 0.0408, 0.0024, 0.1317, 0.4467,
        0.0450])
[rfa agg] iter:  8, prev_obj_val: 81.30279541015625, obj_val: 87.1485595703125, abs dis: 5.84576416015625
[rfa agg] iter: 8, weight: tensor([0.0152, 0.0194, 0.0310, 0.0266, 0.2063, 0.0375, 0.0022, 0.1203, 0.5001,
        0.0413])
[rfa agg] iter:  9, prev_obj_val: 87.1485595703125, obj_val: 84.13035583496094, abs dis: 3.0182037353515625
[rfa agg] iter: 9, weight: tensor([0.0304, 0.0398, 0.0503, 0.0565, 0.1996, 0.0592, 0.0041, 0.1423, 0.3536,
        0.0643])
			Update norm = 112.83218318591554 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3228, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.4005, Accuracy: 0/9950 (0.0000%)
saving model
Done in 489.82831025123596 sec.
Server Epoch:74 choose agents : [23, 32, 65, 40, 44, 4, 84, 94, 14, 70].
_Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   1, Avg loss: 0.0605, Accuracy: 333/715 (46.5734%)
_Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   2, Avg loss: 0.0393, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.0409, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   1, Avg loss: 0.0597, Accuracy: 206/735 (28.0272%)
_Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 336/735 (45.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.8851, Accuracy: 48/10000 (0.4800%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   1, Avg loss: 0.0561, Accuracy: 391/1475 (26.5085%)
_Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   2, Avg loss: 0.0306, Accuracy: 682/1475 (46.2373%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.2500, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 356/1573 (22.6319%)
_Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 566/1573 (35.9822%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6015, Accuracy: 84/10000 (0.8400%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 393/1750 (22.4571%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 680/1750 (38.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.0893, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0596, Accuracy: 336/901 (37.2919%)
_Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0321, Accuracy: 427/901 (47.3918%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.7398, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   1, Avg loss: 0.0628, Accuracy: 321/1190 (26.9748%)
_Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 452/1190 (37.9832%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.1856, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 353/1662 (21.2395%)
_Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 623/1662 (37.4850%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.0441, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   1, Avg loss: 0.0626, Accuracy: 227/1013 (22.4087%)
_Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 313/1013 (30.8983%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.1746, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 368/1418 (25.9520%)
_Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 651/1418 (45.9097%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.8427, Accuracy: 98/10000 (0.9800%)
time spent on training: 342.13546872138977
[rfa agg] training data poison_ratio: 0.2594111969111969  data num: [715, 735, 1475, 1573, 1750, 901, 1190, 1662, 1013, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.08106599903474904
[rfa agg] init. name: [23, 32, 65, 40, 44, 4, 84, 94, 14, 70], weight: tensor([0.0575, 0.0591, 0.1186, 0.1265, 0.1408, 0.0725, 0.0957, 0.1337, 0.0815,
        0.1141])
[rfa agg] iter:  0, prev_obj_val: 49.429290771484375, obj_val: 52.95448684692383, abs dis: 3.525196075439453
[rfa agg] iter: 0, weight: tensor([0.0315, 0.0324, 0.0899, 0.0805, 0.0600, 0.0685, 0.3561, 0.0730, 0.1008,
        0.1071])
[rfa agg] iter:  1, prev_obj_val: 52.95448684692383, obj_val: 59.199188232421875, abs dis: 6.244701385498047
[rfa agg] iter: 1, weight: tensor([0.0384, 0.0394, 0.0788, 0.0724, 0.0566, 0.0940, 0.3124, 0.0669, 0.1504,
        0.0906])
[rfa agg] iter:  2, prev_obj_val: 59.199188232421875, obj_val: 61.3984375, abs dis: 2.199249267578125
[rfa agg] iter: 2, weight: tensor([0.0479, 0.0491, 0.0595, 0.0562, 0.0463, 0.1622, 0.1388, 0.0531, 0.3208,
        0.0660])
[rfa agg] iter:  3, prev_obj_val: 61.3984375, obj_val: 59.10823440551758, abs dis: 2.290203094482422
[rfa agg] iter: 3, weight: tensor([0.0441, 0.0452, 0.0458, 0.0436, 0.0364, 0.1845, 0.0942, 0.0414, 0.4147,
        0.0502])
[rfa agg] iter:  4, prev_obj_val: 59.10823440551758, obj_val: 61.38450622558594, abs dis: 2.2762718200683594
[rfa agg] iter: 4, weight: tensor([0.0433, 0.0445, 0.0538, 0.0508, 0.0418, 0.1502, 0.1207, 0.0480, 0.3875,
        0.0595])
[rfa agg] iter:  5, prev_obj_val: 61.38450622558594, obj_val: 59.110496520996094, abs dis: 2.2740097045898438
[rfa agg] iter: 5, weight: tensor([0.0422, 0.0433, 0.0439, 0.0417, 0.0349, 0.1751, 0.0899, 0.0396, 0.4414,
        0.0481])
[rfa agg] iter:  6, prev_obj_val: 59.110496520996094, obj_val: 61.383663177490234, abs dis: 2.2731666564941406
[rfa agg] iter: 6, weight: tensor([0.0429, 0.0441, 0.0533, 0.0504, 0.0415, 0.1484, 0.1195, 0.0476, 0.3935,
        0.0589])
[rfa agg] iter:  7, prev_obj_val: 61.383663177490234, obj_val: 59.110774993896484, abs dis: 2.27288818359375
[rfa agg] iter: 7, weight: tensor([0.0420, 0.0431, 0.0437, 0.0415, 0.0347, 0.1742, 0.0895, 0.0395, 0.4439,
        0.0479])
[rfa agg] iter:  8, prev_obj_val: 59.110774993896484, obj_val: 61.38357925415039, abs dis: 2.2728042602539062
[rfa agg] iter: 8, weight: tensor([0.0429, 0.0440, 0.0532, 0.0503, 0.0415, 0.1482, 0.1194, 0.0475, 0.3941,
        0.0589])
[rfa agg] iter:  9, prev_obj_val: 61.38357925415039, obj_val: 59.11079406738281, abs dis: 2.272785186767578
[rfa agg] iter: 9, weight: tensor([0.0420, 0.0431, 0.0437, 0.0415, 0.0347, 0.1741, 0.0895, 0.0394, 0.4442,
        0.0479])
			Update norm = 148.44139468574795 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3228, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.4005, Accuracy: 0/9950 (0.0000%)
saving model
Done in 585.4631378650665 sec.
Server Epoch:75 choose agents : [74, 11, 45, 65, 75, 59, 52, 1, 15, 25].
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 547/1552 (35.2448%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 772/1552 (49.7423%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.3780, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0524, Accuracy: 364/712 (51.1236%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0256, Accuracy: 443/712 (62.2191%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.1929, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   1, Avg loss: 0.0630, Accuracy: 233/669 (34.8281%)
_Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   2, Avg loss: 0.0391, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.1637, Accuracy: 54/10000 (0.5400%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0567, Accuracy: 391/1475 (26.5085%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 698/1475 (47.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.9231, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   1, Avg loss: 0.0665, Accuracy: 248/776 (31.9588%)
_Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   2, Avg loss: 0.0289, Accuracy: 398/776 (51.2887%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.3337, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   1, Avg loss: 0.0609, Accuracy: 304/1089 (27.9155%)
_Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   2, Avg loss: 0.0272, Accuracy: 449/1089 (41.2305%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.7440, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   1, Avg loss: 0.0537, Accuracy: 322/636 (50.6289%)
_Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   2, Avg loss: 0.0304, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.8769, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0576, Accuracy: 290/928 (31.2500%)
_Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 551/928 (59.3750%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.0636, Accuracy: 98/10000 (0.9800%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 327/1154 (28.3362%)
_Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   2, Avg loss: 0.0296, Accuracy: 424/1154 (36.7418%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.9605, Accuracy: 58/10000 (0.5800%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   1, Avg loss: 0.0561, Accuracy: 317/690 (45.9420%)
_Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.0137, Accuracy: 67/10000 (0.6700%)
time spent on training: 317.38639092445374
[rfa agg] training data poison_ratio: 0.5031505009813035  data num: [1552, 712, 669, 1475, 776, 1089, 636, 928, 1154, 690]
[rfa agg] considering poison per batch poison_fraction: 0.15723453155665734
[rfa agg] init. name: [74, 11, 45, 65, 75, 59, 52, 1, 15, 25], weight: tensor([0.1603, 0.0735, 0.0691, 0.1524, 0.0802, 0.1125, 0.0657, 0.0959, 0.1192,
        0.0713])
[rfa agg] iter:  0, prev_obj_val: 46.130611419677734, obj_val: 51.77495574951172, abs dis: 5.644344329833984
[rfa agg] iter: 0, weight: tensor([0.0562, 0.0689, 0.0505, 0.0595, 0.1018, 0.1367, 0.0395, 0.3255, 0.1089,
        0.0525])
[rfa agg] iter:  1, prev_obj_val: 51.77495574951172, obj_val: 61.141807556152344, abs dis: 9.366851806640625
[rfa agg] iter: 1, weight: tensor([0.0375, 0.1660, 0.0887, 0.0388, 0.2692, 0.0618, 0.0596, 0.1286, 0.0550,
        0.0948])
[rfa agg] iter:  2, prev_obj_val: 61.141807556152344, obj_val: 61.01948547363281, abs dis: 0.12232208251953125
[rfa agg] iter: 2, weight: tensor([0.0267, 0.1437, 0.1919, 0.0273, 0.0890, 0.0370, 0.1204, 0.0549, 0.0345,
        0.2747])
[rfa agg] iter:  3, prev_obj_val: 61.01948547363281, obj_val: 58.11521911621094, abs dis: 2.904266357421875
[rfa agg] iter: 3, weight: tensor([0.0238, 0.1284, 0.1992, 0.0243, 0.0772, 0.0329, 0.1106, 0.0488, 0.0307,
        0.3240])
[rfa agg] iter:  4, prev_obj_val: 58.11521911621094, obj_val: 68.41127014160156, abs dis: 10.296051025390625
[rfa agg] iter: 4, weight: tensor([0.0266, 0.1983, 0.1782, 0.0272, 0.1049, 0.0382, 0.0883, 0.0597, 0.0353,
        0.2433])
[rfa agg] iter:  5, prev_obj_val: 68.41127014160156, obj_val: 68.37102508544922, abs dis: 0.04024505615234375
[rfa agg] iter: 5, weight: tensor([0.0318, 0.1047, 0.1653, 0.0323, 0.0768, 0.0414, 0.2608, 0.0563, 0.0391,
        0.1916])
[rfa agg] iter:  6, prev_obj_val: 68.37102508544922, obj_val: 68.36844635009766, abs dis: 0.0025787353515625
[rfa agg] iter: 6, weight: tensor([0.0302, 0.0986, 0.1558, 0.0307, 0.0728, 0.0393, 0.3030, 0.0535, 0.0372,
        0.1788])
[rfa agg] iter:  7, prev_obj_val: 68.36844635009766, obj_val: 68.36817169189453, abs dis: 0.000274658203125
[rfa agg] iter: 7, weight: tensor([0.0297, 0.0970, 0.1522, 0.0302, 0.0716, 0.0387, 0.3164, 0.0527, 0.0366,
        0.1749])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3255, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.4094, Accuracy: 0/9950 (0.0000%)
saving model
Done in 561.4454483985901 sec.
Server Epoch:76 choose agents : [63, 74, 77, 87, 99, 4, 66, 94, 14, 24].
_Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 268/888 (30.1802%)
_Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 420/888 (47.2973%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.3295, Accuracy: 67/10000 (0.6700%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 508/1552 (32.7320%)
_Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 769/1552 (49.5490%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 11.3284, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 319/1340 (23.8060%)
_Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 541/1340 (40.3731%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2559, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0580, Accuracy: 315/1131 (27.8515%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0318, Accuracy: 396/1131 (35.0133%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2907, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   1, Avg loss: 0.0665, Accuracy: 187/773 (24.1915%)
_Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   2, Avg loss: 0.0293, Accuracy: 416/773 (53.8163%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.9678, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0593, Accuracy: 335/901 (37.1809%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0322, Accuracy: 409/901 (45.3940%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.7846, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   1, Avg loss: 0.0615, Accuracy: 267/1402 (19.0442%)
_Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 392/1402 (27.9601%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.4811, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   1, Avg loss: 0.0559, Accuracy: 349/1662 (20.9988%)
_Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 621/1662 (37.3646%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.8032, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0616, Accuracy: 231/1013 (22.8036%)
_Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 321/1013 (31.6881%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.9468, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   1, Avg loss: 0.0759, Accuracy: 48/312 (15.3846%)
_Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.8017, Accuracy: 50/10000 (0.5000%)
time spent on training: 267.34795236587524
[rfa agg] training data poison_ratio: 0.14142518680517588  data num: [888, 1552, 1340, 1131, 773, 901, 1402, 1662, 1013, 312]
[rfa agg] considering poison per batch poison_fraction: 0.044195370876617464
[rfa agg] init. name: [63, 74, 77, 87, 99, 4, 66, 94, 14, 24], weight: tensor([0.0809, 0.1414, 0.1221, 0.1031, 0.0704, 0.0821, 0.1278, 0.1514, 0.0923,
        0.0284])
[rfa agg] iter:  0, prev_obj_val: 44.49522399902344, obj_val: 49.356136322021484, abs dis: 4.860912322998047
[rfa agg] iter: 0, weight: tensor([0.0812, 0.0545, 0.0921, 0.2409, 0.0536, 0.1186, 0.0781, 0.0519, 0.2217,
        0.0073])
[rfa agg] iter:  1, prev_obj_val: 49.356136322021484, obj_val: 60.642086029052734, abs dis: 11.28594970703125
[rfa agg] iter: 1, weight: tensor([0.1240, 0.0385, 0.0569, 0.1031, 0.0697, 0.2319, 0.0506, 0.0373, 0.2809,
        0.0070])
[rfa agg] iter:  2, prev_obj_val: 60.642086029052734, obj_val: 64.18942260742188, abs dis: 3.5473365783691406
[rfa agg] iter: 2, weight: tensor([0.2688, 0.0370, 0.0488, 0.0680, 0.2270, 0.1508, 0.0451, 0.0365, 0.1079,
        0.0101])
[rfa agg] iter:  3, prev_obj_val: 64.18942260742188, obj_val: 72.1871109008789, abs dis: 7.997688293457031
[rfa agg] iter: 3, weight: tensor([0.2143, 0.0365, 0.0470, 0.0630, 0.3361, 0.1200, 0.0439, 0.0361, 0.0922,
        0.0110])
[rfa agg] iter:  4, prev_obj_val: 72.1871109008789, obj_val: 60.55830001831055, abs dis: 11.62881088256836
[rfa agg] iter: 4, weight: tensor([0.1761, 0.0498, 0.0619, 0.0779, 0.2824, 0.1219, 0.0584, 0.0495, 0.1036,
        0.0186])
[rfa agg] iter:  5, prev_obj_val: 60.55830001831055, obj_val: 64.1839599609375, abs dis: 3.625659942626953
[rfa agg] iter: 5, weight: tensor([0.2709, 0.0349, 0.0460, 0.0640, 0.2575, 0.1401, 0.0426, 0.0344, 0.1000,
        0.0095])
[rfa agg] iter:  6, prev_obj_val: 64.1839599609375, obj_val: 72.18771362304688, abs dis: 8.003753662109375
[rfa agg] iter: 6, weight: tensor([0.2115, 0.0360, 0.0465, 0.0622, 0.3446, 0.1184, 0.0433, 0.0356, 0.0909,
        0.0109])
[rfa agg] iter:  7, prev_obj_val: 72.18771362304688, obj_val: 60.5583610534668, abs dis: 11.629352569580078
[rfa agg] iter: 7, weight: tensor([0.1759, 0.0497, 0.0618, 0.0779, 0.2831, 0.1218, 0.0583, 0.0495, 0.1035,
        0.0186])
[rfa agg] iter:  8, prev_obj_val: 60.5583610534668, obj_val: 64.18392944335938, abs dis: 3.625568389892578
[rfa agg] iter: 8, weight: tensor([0.2708, 0.0349, 0.0460, 0.0640, 0.2576, 0.1401, 0.0426, 0.0344, 0.1000,
        0.0095])
[rfa agg] iter:  9, prev_obj_val: 64.18392944335938, obj_val: 72.1877212524414, abs dis: 8.003791809082031
[rfa agg] iter: 9, weight: tensor([0.2115, 0.0360, 0.0465, 0.0622, 0.3447, 0.1183, 0.0433, 0.0356, 0.0909,
        0.0109])
			Update norm = 108.29603524598673 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3255, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.4094, Accuracy: 0/9950 (0.0000%)
saving model
Done in 513.4771015644073 sec.
Server Epoch:77 choose agents : [76, 6, 84, 12, 66, 97, 46, 21, 74, 15].
_Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   1, Avg loss: 0.0846, Accuracy: 64/466 (13.7339%)
_Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   2, Avg loss: 0.0486, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.2667, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   1, Avg loss: 0.0550, Accuracy: 406/1956 (20.7566%)
_Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 648/1956 (33.1288%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.4193, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   1, Avg loss: 0.0625, Accuracy: 318/1190 (26.7227%)
_Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 467/1190 (39.2437%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.4907, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   1, Avg loss: 0.0877, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   2, Avg loss: 0.0470, Accuracy: 149/338 (44.0828%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.9199, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 262/1402 (18.6876%)
_Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 392/1402 (27.9601%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.8591, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   1, Avg loss: 0.0512, Accuracy: 368/1213 (30.3380%)
_Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 516/1213 (42.5392%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.4307, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   1, Avg loss: 0.0550, Accuracy: 427/1904 (22.4265%)
_Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 678/1904 (35.6092%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.8835, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 375/1949 (19.2406%)
_Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 619/1949 (31.7599%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.4952, Accuracy: 79/10000 (0.7900%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 477/1552 (30.7345%)
_Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 785/1552 (50.5799%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.6327, Accuracy: 98/10000 (0.9800%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   1, Avg loss: 0.0589, Accuracy: 331/1154 (28.6828%)
_Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   2, Avg loss: 0.0296, Accuracy: 417/1154 (36.1352%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.2215, Accuracy: 64/10000 (0.6400%)
time spent on training: 324.58380365371704
[rfa agg] training data poison_ratio: 0.20618713806766228  data num: [466, 1956, 1190, 338, 1402, 1213, 1904, 1949, 1552, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.06443348064614446
[rfa agg] init. name: [76, 6, 84, 12, 66, 97, 46, 21, 74, 15], weight: tensor([0.0355, 0.1490, 0.0907, 0.0258, 0.1068, 0.0924, 0.1451, 0.1485, 0.1183,
        0.0879])
[rfa agg] iter:  0, prev_obj_val: 54.512245178222656, obj_val: 57.01789093017578, abs dis: 2.505645751953125
[rfa agg] iter: 0, weight: tensor([0.0083, 0.0539, 0.0942, 0.0053, 0.4163, 0.0962, 0.0588, 0.0536, 0.1221,
        0.0913])
[rfa agg] iter:  1, prev_obj_val: 57.01789093017578, obj_val: 57.002628326416016, abs dis: 0.015262603759765625
[rfa agg] iter: 1, weight: tensor([0.0093, 0.0503, 0.1370, 0.0058, 0.3186, 0.1428, 0.0543, 0.0501, 0.0970,
        0.1349])
[rfa agg] iter:  2, prev_obj_val: 57.002628326416016, obj_val: 58.55884552001953, abs dis: 1.5562171936035156
[rfa agg] iter: 2, weight: tensor([0.0093, 0.0507, 0.1393, 0.0059, 0.3097, 0.1452, 0.0547, 0.0504, 0.0977,
        0.1372])
[rfa agg] iter:  3, prev_obj_val: 58.55884552001953, obj_val: 64.45951080322266, abs dis: 5.900665283203125
[rfa agg] iter: 3, weight: tensor([0.0097, 0.0481, 0.1727, 0.0060, 0.2234, 0.1821, 0.0516, 0.0479, 0.0871,
        0.1714])
[rfa agg] iter:  4, prev_obj_val: 64.45951080322266, obj_val: 70.90734100341797, abs dis: 6.4478302001953125
[rfa agg] iter: 4, weight: tensor([0.0079, 0.0304, 0.2375, 0.0049, 0.0852, 0.2743, 0.0322, 0.0303, 0.0477,
        0.2497])
[rfa agg] iter:  5, prev_obj_val: 70.90734100341797, obj_val: 70.90570068359375, abs dis: 0.00164031982421875
[rfa agg] iter: 5, weight: tensor([0.0121, 0.0391, 0.2299, 0.0073, 0.0896, 0.2510, 0.0412, 0.0390, 0.0572,
        0.2336])
			Update norm = 161.65277337746173 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3255, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.4094, Accuracy: 0/9950 (0.0000%)
saving model
Done in 566.741795539856 sec.
Server Epoch:78 choose agents : [41, 72, 21, 61, 36, 59, 95, 83, 71, 30].
_Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   1, Avg loss: 0.0572, Accuracy: 344/719 (47.8442%)
_Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   2, Avg loss: 0.0309, Accuracy: 456/719 (63.4214%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.9123, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   1, Avg loss: 0.0612, Accuracy: 267/1241 (21.5149%)
_Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 422/1241 (34.0048%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.4069, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 387/1949 (19.8563%)
_Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 587/1949 (30.1180%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4214, Accuracy: 82/10000 (0.8200%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   1, Avg loss: 0.1270, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   2, Avg loss: 0.1198, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3395, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0819, Accuracy: 106/408 (25.9804%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0515, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.8990, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 292/1089 (26.8136%)
_Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   2, Avg loss: 0.0277, Accuracy: 522/1089 (47.9339%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.9633, Accuracy: 75/10000 (0.7500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   1, Avg loss: 0.0453, Accuracy: 401/599 (66.9449%)
_Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   2, Avg loss: 0.0284, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.9446, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 411/1953 (21.0445%)
_Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 790/1953 (40.4506%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.7956, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   1, Avg loss: 0.0632, Accuracy: 151/818 (18.4597%)
_Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   2, Avg loss: 0.0304, Accuracy: 342/818 (41.8093%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.5848, Accuracy: 84/10000 (0.8400%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0749, Accuracy: 101/486 (20.7819%)
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 214/486 (44.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.4469, Accuracy: 52/10000 (0.5200%)
time spent on training: 329.8389735221863
[rfa agg] training data poison_ratio: 0.12517385257301808  data num: [719, 1241, 1949, 85, 408, 1089, 599, 1953, 818, 486]
[rfa agg] considering poison per batch poison_fraction: 0.03911682892906815
[rfa agg] init. name: [41, 72, 21, 61, 36, 59, 95, 83, 71, 30], weight: tensor([0.0769, 0.1328, 0.2085, 0.0091, 0.0437, 0.1165, 0.0641, 0.2089, 0.0875,
        0.0520])
[rfa agg] iter:  0, prev_obj_val: 74.43769073486328, obj_val: 77.44346618652344, abs dis: 3.0057754516601562
[rfa agg] iter: 0, weight: tensor([0.0441, 0.2895, 0.0624, 0.0021, 0.0142, 0.4191, 0.0282, 0.0626, 0.0591,
        0.0186])
[rfa agg] iter:  1, prev_obj_val: 77.44346618652344, obj_val: 78.86187744140625, abs dis: 1.4184112548828125
[rfa agg] iter: 1, weight: tensor([0.0669, 0.1887, 0.0654, 0.0027, 0.0192, 0.4313, 0.0402, 0.0656, 0.0947,
        0.0254])
[rfa agg] iter:  2, prev_obj_val: 78.86187744140625, obj_val: 80.31204986572266, abs dis: 1.4501724243164062
[rfa agg] iter: 2, weight: tensor([0.0841, 0.1840, 0.0716, 0.0031, 0.0229, 0.3608, 0.0490, 0.0719, 0.1221,
        0.0305])
[rfa agg] iter:  3, prev_obj_val: 80.31204986572266, obj_val: 81.78044128417969, abs dis: 1.4683914184570312
[rfa agg] iter: 3, weight: tensor([0.1018, 0.1753, 0.0747, 0.0035, 0.0261, 0.2984, 0.0573, 0.0750, 0.1529,
        0.0350])
[rfa agg] iter:  4, prev_obj_val: 81.78044128417969, obj_val: 84.77039337158203, abs dis: 2.9899520874023438
[rfa agg] iter: 4, weight: tensor([0.1193, 0.1611, 0.0744, 0.0037, 0.0284, 0.2486, 0.0642, 0.0746, 0.1873,
        0.0384])
[rfa agg] iter:  5, prev_obj_val: 84.77039337158203, obj_val: 84.76061248779297, abs dis: 0.0097808837890625
[rfa agg] iter: 5, weight: tensor([0.1529, 0.1236, 0.0652, 0.0038, 0.0300, 0.1683, 0.0729, 0.0654, 0.2767,
        0.0412])
[rfa agg] iter:  6, prev_obj_val: 84.76061248779297, obj_val: 86.28453063964844, abs dis: 1.5239181518554688
[rfa agg] iter: 6, weight: tensor([0.1528, 0.1229, 0.0648, 0.0037, 0.0299, 0.1666, 0.0726, 0.0650, 0.2806,
        0.0410])
[rfa agg] iter:  7, prev_obj_val: 86.28453063964844, obj_val: 87.85237121582031, abs dis: 1.567840576171875
[rfa agg] iter: 7, weight: tensor([0.1664, 0.1002, 0.0559, 0.0035, 0.0284, 0.1303, 0.0723, 0.0560, 0.3476,
        0.0394])
[rfa agg] iter:  8, prev_obj_val: 87.85237121582031, obj_val: 91.72626495361328, abs dis: 3.8738937377929688
[rfa agg] iter: 8, weight: tensor([0.1713, 0.0741, 0.0434, 0.0029, 0.0245, 0.0929, 0.0658, 0.0436, 0.4471,
        0.0344])
[rfa agg] iter:  9, prev_obj_val: 91.72626495361328, obj_val: 91.71175384521484, abs dis: 0.0145111083984375
[rfa agg] iter: 9, weight: tensor([0.2780, 0.0533, 0.0341, 0.0026, 0.0239, 0.0633, 0.0749, 0.0342, 0.4011,
        0.0347])
			Update norm = 112.6713972133123 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3255, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.4094, Accuracy: 0/9950 (0.0000%)
saving model
Done in 574.7904613018036 sec.
Server Epoch:79 choose agents : [33, 1, 76, 57, 89, 55, 42, 31, 95, 22].
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0792, Accuracy: 76/515 (14.7573%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0487, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.0210, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0578, Accuracy: 283/928 (30.4957%)
_Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 537/928 (57.8664%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0416, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   1, Avg loss: 0.0843, Accuracy: 58/466 (12.4464%)
_Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   2, Avg loss: 0.0479, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.2820, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   1, Avg loss: 0.0529, Accuracy: 310/1154 (26.8631%)
_Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   2, Avg loss: 0.0249, Accuracy: 538/1154 (46.6205%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.3613, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 334/896 (37.2768%)
_Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   2, Avg loss: 0.0330, Accuracy: 415/896 (46.3170%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.4733, Accuracy: 52/10000 (0.5200%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   1, Avg loss: 0.0547, Accuracy: 274/1071 (25.5836%)
_Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 484/1071 (45.1914%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.2089, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   1, Avg loss: 0.0537, Accuracy: 354/1372 (25.8017%)
_Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 524/1372 (38.1924%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.5771, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   1, Avg loss: 0.0830, Accuracy: 72/460 (15.6522%)
_Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   2, Avg loss: 0.0369, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.2543, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0465, Accuracy: 404/599 (67.4457%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0279, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.6373, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 489/1470 (33.2653%)
_Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 857/1470 (58.2993%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.3637, Accuracy: 89/10000 (0.8900%)
time spent on training: 231.76964116096497
[rfa agg] training data poison_ratio: 0.18698913895420446  data num: [515, 928, 466, 1154, 896, 1071, 1372, 460, 599, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.05843410592318889
[rfa agg] init. name: [33, 1, 76, 57, 89, 55, 42, 31, 95, 22], weight: tensor([0.0577, 0.1039, 0.0522, 0.1292, 0.1003, 0.1199, 0.1536, 0.0515, 0.0671,
        0.1646])
[rfa agg] iter:  0, prev_obj_val: 46.15502166748047, obj_val: 52.688995361328125, abs dis: 6.533973693847656
[rfa agg] iter: 0, weight: tensor([0.0314, 0.2099, 0.0237, 0.0696, 0.3891, 0.1053, 0.0523, 0.0234, 0.0454,
        0.0499])
[rfa agg] iter:  1, prev_obj_val: 52.688995361328125, obj_val: 55.0562629699707, abs dis: 2.367267608642578
[rfa agg] iter: 1, weight: tensor([0.0661, 0.1604, 0.0468, 0.0801, 0.2584, 0.1068, 0.0656, 0.0463, 0.1058,
        0.0637])
[rfa agg] iter:  2, prev_obj_val: 55.0562629699707, obj_val: 59.89109802246094, abs dis: 4.834835052490234
[rfa agg] iter: 2, weight: tensor([0.0820, 0.1445, 0.0561, 0.0794, 0.2093, 0.1027, 0.0664, 0.0554, 0.1395,
        0.0648])
[rfa agg] iter:  3, prev_obj_val: 59.89109802246094, obj_val: 59.88103485107422, abs dis: 0.01006317138671875
[rfa agg] iter: 3, weight: tensor([0.1149, 0.1052, 0.0708, 0.0664, 0.1358, 0.0820, 0.0576, 0.0699, 0.2406,
        0.0567])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3286, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.4229, Accuracy: 0/9950 (0.0000%)
saving model
Done in 481.90521717071533 sec.
Server Epoch:80 choose agents : [15, 82, 40, 18, 44, 37, 29, 63, 0, 22].
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   1, Avg loss: 0.0574, Accuracy: 329/1154 (28.5095%)
_Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   2, Avg loss: 0.0297, Accuracy: 365/1154 (31.6291%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.7191, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   1, Avg loss: 0.0706, Accuracy: 107/500 (21.4000%)
_Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   2, Avg loss: 0.0464, Accuracy: 183/500 (36.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.2922, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 351/1573 (22.3140%)
_Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 571/1573 (36.3001%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.0156, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   1, Avg loss: 0.0745, Accuracy: 127/530 (23.9623%)
_Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   2, Avg loss: 0.0376, Accuracy: 261/530 (49.2453%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.8583, Accuracy: 64/10000 (0.6400%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   1, Avg loss: 0.0593, Accuracy: 391/1750 (22.3429%)
_Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 666/1750 (38.0571%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.8375, Accuracy: 122/10000 (1.2200%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   1, Avg loss: 0.0528, Accuracy: 400/1129 (35.4296%)
_Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   2, Avg loss: 0.0250, Accuracy: 717/1129 (63.5075%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.1980, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   1, Avg loss: 0.0497, Accuracy: 407/1440 (28.2639%)
_Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   2, Avg loss: 0.0274, Accuracy: 676/1440 (46.9444%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.3574, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   1, Avg loss: 0.0551, Accuracy: 257/888 (28.9414%)
_Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 417/888 (46.9595%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.2094, Accuracy: 54/10000 (0.5400%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 366/1657 (22.0881%)
_Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 514/1657 (31.0199%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.0705, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   1, Avg loss: 0.0445, Accuracy: 560/1470 (38.0952%)
_Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 851/1470 (57.8912%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.9740, Accuracy: 112/10000 (1.1200%)
time spent on training: 289.9253854751587
[rfa agg] training data poison_ratio: 0.47059796542883137  data num: [1154, 500, 1573, 530, 1750, 1129, 1440, 888, 1657, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.1470618641965098
[rfa agg] init. name: [15, 82, 40, 18, 44, 37, 29, 63, 0, 22], weight: tensor([0.0954, 0.0414, 0.1301, 0.0438, 0.1447, 0.0934, 0.1191, 0.0734, 0.1370,
        0.1216])
[rfa agg] iter:  0, prev_obj_val: 47.924800872802734, obj_val: 49.5399169921875, abs dis: 1.6151161193847656
[rfa agg] iter: 0, weight: tensor([0.2975, 0.0127, 0.0823, 0.0147, 0.0596, 0.1775, 0.1170, 0.0467, 0.0734,
        0.1186])
[rfa agg] iter:  1, prev_obj_val: 49.5399169921875, obj_val: 49.5239143371582, abs dis: 0.016002655029296875
[rfa agg] iter: 1, weight: tensor([0.3698, 0.0116, 0.0664, 0.0136, 0.0494, 0.2023, 0.0903, 0.0450, 0.0600,
        0.0916])
[rfa agg] iter:  2, prev_obj_val: 49.5239143371582, obj_val: 51.582489013671875, abs dis: 2.058574676513672
[rfa agg] iter: 2, weight: tensor([0.3926, 0.0112, 0.0639, 0.0131, 0.0476, 0.1959, 0.0867, 0.0434, 0.0577,
        0.0880])
[rfa agg] iter:  3, prev_obj_val: 51.582489013671875, obj_val: 53.93377685546875, abs dis: 2.351287841796875
[rfa agg] iter: 3, weight: tensor([0.3440, 0.0122, 0.0613, 0.0143, 0.0469, 0.2534, 0.0804, 0.0499, 0.0560,
        0.0817])
[rfa agg] iter:  4, prev_obj_val: 53.93377685546875, obj_val: 59.391990661621094, abs dis: 5.458213806152344
[rfa agg] iter: 4, weight: tensor([0.2536, 0.0138, 0.0616, 0.0163, 0.0482, 0.3309, 0.0785, 0.0604, 0.0568,
        0.0798])
[rfa agg] iter:  5, prev_obj_val: 59.391990661621094, obj_val: 56.54589080810547, abs dis: 2.846099853515625
[rfa agg] iter: 5, weight: tensor([0.1870, 0.0196, 0.0692, 0.0234, 0.0561, 0.3083, 0.0841, 0.1019, 0.0648,
        0.0856])
[rfa agg] iter:  6, prev_obj_val: 56.54589080810547, obj_val: 56.541168212890625, abs dis: 0.00472259521484375
[rfa agg] iter: 6, weight: tensor([0.1993, 0.0161, 0.0637, 0.0190, 0.0508, 0.3559, 0.0792, 0.0762, 0.0592,
        0.0806])
[rfa agg] iter:  7, prev_obj_val: 56.541168212890625, obj_val: 53.8993034362793, abs dis: 2.641864776611328
[rfa agg] iter: 7, weight: tensor([0.1959, 0.0158, 0.0627, 0.0188, 0.0500, 0.3663, 0.0779, 0.0749, 0.0583,
        0.0793])
[rfa agg] iter:  8, prev_obj_val: 53.8993034362793, obj_val: 59.39464569091797, abs dis: 5.495342254638672
[rfa agg] iter: 8, weight: tensor([0.2192, 0.0131, 0.0586, 0.0155, 0.0458, 0.3857, 0.0746, 0.0576, 0.0540,
        0.0759])
[rfa agg] iter:  9, prev_obj_val: 59.39464569091797, obj_val: 59.385345458984375, abs dis: 0.00930023193359375
[rfa agg] iter: 9, weight: tensor([0.1833, 0.0195, 0.0686, 0.0232, 0.0556, 0.3165, 0.0833, 0.1009, 0.0642,
        0.0849])
			Update norm = 152.64833973876034 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3286, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.4229, Accuracy: 0/9950 (0.0000%)
saving model
Done in 522.8359997272491 sec.
Server Epoch:81 choose agents : [62, 5, 56, 60, 10, 20, 90, 87, 72, 49].
_Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   1, Avg loss: 0.0642, Accuracy: 175/568 (30.8099%)
_Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   2, Avg loss: 0.0392, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.1707, Accuracy: 55/10000 (0.5500%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   1, Avg loss: 0.0507, Accuracy: 395/1628 (24.2629%)
_Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 827/1628 (50.7985%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.5321, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   2, Avg loss: 0.0669, Accuracy: 68/186 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3729, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 624/2227 (28.0198%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0275, Accuracy: 1057/2227 (47.4630%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.0584, Accuracy: 122/10000 (1.2200%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   1, Avg loss: 0.0573, Accuracy: 209/861 (24.2741%)
_Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 452/861 (52.4971%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.5547, Accuracy: 69/10000 (0.6900%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   1, Avg loss: 0.0581, Accuracy: 331/807 (41.0161%)
_Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   2, Avg loss: 0.0313, Accuracy: 426/807 (52.7881%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.1935, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0516, Accuracy: 354/677 (52.2895%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 437/677 (64.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.1490, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   1, Avg loss: 0.0585, Accuracy: 302/1131 (26.7020%)
_Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 385/1131 (34.0407%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.0781, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   1, Avg loss: 0.0613, Accuracy: 281/1241 (22.6430%)
_Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 359/1241 (28.9283%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.5210, Accuracy: 63/10000 (0.6300%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0750, Accuracy: 58/440 (13.1818%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0450, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.9509, Accuracy: 50/10000 (0.5000%)
time spent on training: 285.2338888645172
[rfa agg] training data poison_ratio: 0.38255171001433547  data num: [568, 1628, 186, 2227, 861, 807, 677, 1131, 1241, 440]
[rfa agg] considering poison per batch poison_fraction: 0.11954740937947983
[rfa agg] init. name: [62, 5, 56, 60, 10, 20, 90, 87, 72, 49], weight: tensor([0.0582, 0.1667, 0.0190, 0.2280, 0.0882, 0.0826, 0.0693, 0.1158, 0.1271,
        0.0451])
[rfa agg] iter:  0, prev_obj_val: 72.3083267211914, obj_val: 74.89691162109375, abs dis: 2.5885848999023438
[rfa agg] iter: 0, weight: tensor([0.0212, 0.0862, 0.0043, 0.0520, 0.0637, 0.0499, 0.0316, 0.3167, 0.3606,
        0.0137])
[rfa agg] iter:  1, prev_obj_val: 74.89691162109375, obj_val: 77.2706298828125, abs dis: 2.37371826171875
[rfa agg] iter: 1, weight: tensor([0.0301, 0.0765, 0.0056, 0.0526, 0.1176, 0.0838, 0.0478, 0.3947, 0.1727,
        0.0187])
[rfa agg] iter:  2, prev_obj_val: 77.2706298828125, obj_val: 79.77088928222656, abs dis: 2.5002593994140625
[rfa agg] iter: 2, weight: tensor([0.0392, 0.0785, 0.0069, 0.0568, 0.1934, 0.1255, 0.0653, 0.2631, 0.1477,
        0.0237])
[rfa agg] iter:  3, prev_obj_val: 79.77088928222656, obj_val: 82.60425567626953, abs dis: 2.8333663940429688
[rfa agg] iter: 3, weight: tensor([0.0413, 0.0647, 0.0068, 0.0488, 0.3075, 0.1646, 0.0736, 0.1609, 0.1077,
        0.0241])
[rfa agg] iter:  4, prev_obj_val: 82.60425567626953, obj_val: 84.46318054199219, abs dis: 1.8589248657226562
[rfa agg] iter: 4, weight: tensor([0.0351, 0.0421, 0.0053, 0.0330, 0.4455, 0.2000, 0.0693, 0.0863, 0.0639,
        0.0195])
[rfa agg] iter:  5, prev_obj_val: 84.46318054199219, obj_val: 86.63356018066406, abs dis: 2.170379638671875
[rfa agg] iter: 5, weight: tensor([0.0383, 0.0399, 0.0054, 0.0318, 0.3785, 0.2703, 0.0811, 0.0757, 0.0582,
        0.0207])
[rfa agg] iter:  6, prev_obj_val: 86.63356018066406, obj_val: 89.0777816772461, abs dis: 2.4442214965820312
[rfa agg] iter: 6, weight: tensor([0.0451, 0.0403, 0.0060, 0.0326, 0.2426, 0.3763, 0.1050, 0.0718, 0.0568,
        0.0236])
[rfa agg] iter:  7, prev_obj_val: 89.0777816772461, obj_val: 86.59550476074219, abs dis: 2.4822769165039062
[rfa agg] iter: 7, weight: tensor([0.0557, 0.0421, 0.0068, 0.0346, 0.1824, 0.3738, 0.1480, 0.0711, 0.0576,
        0.0279])
[rfa agg] iter:  8, prev_obj_val: 86.59550476074219, obj_val: 89.07807922363281, abs dis: 2.482574462890625
[rfa agg] iter: 8, weight: tensor([0.0420, 0.0375, 0.0056, 0.0304, 0.2082, 0.4364, 0.0983, 0.0669, 0.0529,
        0.0219])
[rfa agg] iter:  9, prev_obj_val: 89.07807922363281, obj_val: 89.07427215576172, abs dis: 0.00380706787109375
[rfa agg] iter: 9, weight: tensor([0.0546, 0.0413, 0.0067, 0.0340, 0.1768, 0.3885, 0.1445, 0.0697, 0.0565,
        0.0273])
			Update norm = 112.53483835572875 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3286, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.4229, Accuracy: 0/9950 (0.0000%)
saving model
Done in 524.2709889411926 sec.
Server Epoch:82 choose agents : [89, 71, 15, 22, 28, 59, 44, 72, 5, 64].
_Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   1, Avg loss: 0.0591, Accuracy: 333/896 (37.1652%)
_Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 436/896 (48.6607%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.7393, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   1, Avg loss: 0.0627, Accuracy: 173/818 (21.1491%)
_Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   2, Avg loss: 0.0299, Accuracy: 365/818 (44.6210%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.7891, Accuracy: 61/10000 (0.6100%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   1, Avg loss: 0.0579, Accuracy: 319/1154 (27.6430%)
_Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   2, Avg loss: 0.0290, Accuracy: 471/1154 (40.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.1665, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 543/1470 (36.9388%)
_Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 836/1470 (56.8707%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.8165, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0556, Accuracy: 406/1581 (25.6799%)
_Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 610/1581 (38.5832%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.8406, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0576, Accuracy: 298/1089 (27.3646%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0310, Accuracy: 461/1089 (42.3324%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 12.6822, Accuracy: 62/10000 (0.6200%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 369/1750 (21.0857%)
_Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 683/1750 (39.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.6168, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0612, Accuracy: 257/1241 (20.7091%)
_Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 412/1241 (33.1990%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.7332, Accuracy: 70/10000 (0.7000%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 389/1628 (23.8943%)
_Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 796/1628 (48.8943%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.6007, Accuracy: 151/10000 (1.5100%)
_Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0646, Accuracy: 189/953 (19.8321%)
_Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 307/953 (32.2141%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.8868, Accuracy: 65/10000 (0.6500%)
time spent on training: 306.91015005111694
[rfa agg] training data poison_ratio: 0.3602543720190779  data num: [896, 818, 1154, 1470, 1581, 1089, 1750, 1241, 1628, 953]
[rfa agg] considering poison per batch poison_fraction: 0.11257949125596184
[rfa agg] init. name: [89, 71, 15, 22, 28, 59, 44, 72, 5, 64], weight: tensor([0.0712, 0.0650, 0.0917, 0.1169, 0.1257, 0.0866, 0.1391, 0.0986, 0.1294,
        0.0758])
[rfa agg] iter:  0, prev_obj_val: 45.024715423583984, obj_val: 56.322513580322266, abs dis: 11.297798156738281
[rfa agg] iter: 0, weight: tensor([0.0484, 0.0364, 0.2590, 0.0791, 0.0592, 0.1825, 0.0453, 0.1714, 0.0532,
        0.0655])
[rfa agg] iter:  1, prev_obj_val: 56.322513580322266, obj_val: 58.860076904296875, abs dis: 2.5375633239746094
[rfa agg] iter: 1, weight: tensor([0.1268, 0.0814, 0.1148, 0.0645, 0.0540, 0.1428, 0.0450, 0.0937, 0.0502,
        0.2267])
[rfa agg] iter:  2, prev_obj_val: 58.860076904296875, obj_val: 58.84538650512695, abs dis: 0.014690399169921875
[rfa agg] iter: 2, weight: tensor([0.1460, 0.0863, 0.0874, 0.0535, 0.0455, 0.1066, 0.0384, 0.0742, 0.0425,
        0.3197])
[rfa agg] iter:  3, prev_obj_val: 58.84538650512695, obj_val: 56.26482391357422, abs dis: 2.5805625915527344
[rfa agg] iter: 3, weight: tensor([0.1430, 0.0840, 0.0848, 0.0520, 0.0442, 0.1028, 0.0374, 0.0721, 0.0413,
        0.3384])
[rfa agg] iter:  4, prev_obj_val: 56.26482391357422, obj_val: 58.8551025390625, abs dis: 2.5902786254882812
[rfa agg] iter: 4, weight: tensor([0.1260, 0.0796, 0.1096, 0.0625, 0.0524, 0.1358, 0.0437, 0.0904, 0.0487,
        0.2513])
[rfa agg] iter:  5, prev_obj_val: 58.8551025390625, obj_val: 58.84524154663086, abs dis: 0.009860992431640625
[rfa agg] iter: 5, weight: tensor([0.1451, 0.0857, 0.0868, 0.0532, 0.0452, 0.1057, 0.0382, 0.0737, 0.0422,
        0.3243])
[rfa agg] iter:  6, prev_obj_val: 58.84524154663086, obj_val: 58.84498977661133, abs dis: 0.00025177001953125
[rfa agg] iter: 6, weight: tensor([0.1428, 0.0839, 0.0847, 0.0520, 0.0442, 0.1026, 0.0373, 0.0720, 0.0413,
        0.3393])
			Update norm = 139.26836587816703 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3286, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.4229, Accuracy: 0/9950 (0.0000%)
saving model
Done in 546.4620697498322 sec.
Server Epoch:83 choose agents : [44, 18, 70, 97, 43, 93, 72, 24, 56, 94].
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0588, Accuracy: 392/1750 (22.4000%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 679/1750 (38.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.8811, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.0729, Accuracy: 129/530 (24.3396%)
_Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0385, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.1063, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 353/1418 (24.8942%)
_Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   2, Avg loss: 0.0298, Accuracy: 665/1418 (46.8970%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.4818, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   1, Avg loss: 0.0517, Accuracy: 361/1213 (29.7609%)
_Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 495/1213 (40.8079%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.6919, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0606, Accuracy: 310/946 (32.7696%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 374/946 (39.5349%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.1919, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 422/1742 (24.2250%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 742/1742 (42.5947%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1518, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   1, Avg loss: 0.0609, Accuracy: 272/1241 (21.9178%)
_Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 416/1241 (33.5214%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.7394, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   1, Avg loss: 0.0763, Accuracy: 40/312 (12.8205%)
_Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 157/312 (50.3205%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.7907, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0663, Accuracy: 75/186 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3741, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0559, Accuracy: 358/1662 (21.5403%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 629/1662 (37.8460%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4793, Accuracy: 93/10000 (0.9300%)
time spent on training: 248.7793471813202
[rfa agg] training data poison_ratio: 0.1590909090909091  data num: [1750, 530, 1418, 1213, 946, 1742, 1241, 312, 186, 1662]
[rfa agg] considering poison per batch poison_fraction: 0.04971590909090909
[rfa agg] init. name: [44, 18, 70, 97, 43, 93, 72, 24, 56, 94], weight: tensor([0.1591, 0.0482, 0.1289, 0.1103, 0.0860, 0.1584, 0.1128, 0.0284, 0.0169,
        0.1511])
[rfa agg] iter:  0, prev_obj_val: 55.51817321777344, obj_val: 57.80077362060547, abs dis: 2.2826004028320312
[rfa agg] iter: 0, weight: tensor([0.0519, 0.0142, 0.0923, 0.3999, 0.0623, 0.0516, 0.2555, 0.0060, 0.0031,
        0.0632])
[rfa agg] iter:  1, prev_obj_val: 57.80077362060547, obj_val: 60.499210357666016, abs dis: 2.698436737060547
[rfa agg] iter: 1, weight: tensor([0.0517, 0.0157, 0.0866, 0.4406, 0.0743, 0.0514, 0.2078, 0.0065, 0.0034,
        0.0619])
[rfa agg] iter:  2, prev_obj_val: 60.499210357666016, obj_val: 55.355125427246094, abs dis: 5.144084930419922
[rfa agg] iter: 2, weight: tensor([0.0607, 0.0205, 0.0968, 0.3711, 0.1061, 0.0604, 0.2001, 0.0084, 0.0043,
        0.0718])
[rfa agg] iter:  3, prev_obj_val: 55.355125427246094, obj_val: 60.505191802978516, abs dis: 5.150066375732422
[rfa agg] iter: 3, weight: tensor([0.0454, 0.0124, 0.0808, 0.4698, 0.0546, 0.0452, 0.2285, 0.0052, 0.0027,
        0.0553])
[rfa agg] iter:  4, prev_obj_val: 60.505191802978516, obj_val: 57.802391052246094, abs dis: 2.702800750732422
[rfa agg] iter: 4, weight: tensor([0.0605, 0.0204, 0.0964, 0.3731, 0.1055, 0.0602, 0.1996, 0.0083, 0.0043,
        0.0716])
[rfa agg] iter:  5, prev_obj_val: 57.802391052246094, obj_val: 57.795448303222656, abs dis: 0.0069427490234375
[rfa agg] iter: 5, weight: tensor([0.0520, 0.0158, 0.0872, 0.4386, 0.0749, 0.0517, 0.2074, 0.0066, 0.0034,
        0.0623])
[rfa agg] iter:  6, prev_obj_val: 57.795448303222656, obj_val: 57.79505157470703, abs dis: 0.000396728515625
[rfa agg] iter: 6, weight: tensor([0.0508, 0.0154, 0.0851, 0.4534, 0.0730, 0.0505, 0.2013, 0.0064, 0.0033,
        0.0608])
[rfa agg] iter:  7, prev_obj_val: 57.79505157470703, obj_val: 60.50178527832031, abs dis: 2.7067337036132812
[rfa agg] iter: 7, weight: tensor([0.0505, 0.0153, 0.0846, 0.4573, 0.0725, 0.0502, 0.1995, 0.0064, 0.0033,
        0.0605])
[rfa agg] iter:  8, prev_obj_val: 60.50178527832031, obj_val: 57.80243682861328, abs dis: 2.6993484497070312
[rfa agg] iter: 8, weight: tensor([0.0606, 0.0204, 0.0965, 0.3729, 0.1058, 0.0602, 0.1992, 0.0083, 0.0043,
        0.0717])
[rfa agg] iter:  9, prev_obj_val: 57.80243682861328, obj_val: 57.79545211791992, abs dis: 0.006984710693359375
[rfa agg] iter: 9, weight: tensor([0.0520, 0.0158, 0.0872, 0.4386, 0.0749, 0.0517, 0.2074, 0.0066, 0.0034,
        0.0623])
			Update norm = 165.99149309904408 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3286, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.4229, Accuracy: 0/9950 (0.0000%)
saving model
Done in 487.19577050209045 sec.
Server Epoch:84 choose agents : [16, 36, 51, 77, 39, 2, 42, 68, 53, 88].
_Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   1, Avg loss: 0.0618, Accuracy: 289/708 (40.8192%)
_Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   2, Avg loss: 0.0357, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.1851, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   1, Avg loss: 0.0835, Accuracy: 88/408 (21.5686%)
_Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   2, Avg loss: 0.0515, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.8357, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   1, Avg loss: 0.0596, Accuracy: 237/1049 (22.5929%)
_Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   2, Avg loss: 0.0291, Accuracy: 534/1049 (50.9056%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.8791, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   1, Avg loss: 0.0534, Accuracy: 327/1340 (24.4030%)
_Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 564/1340 (42.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.0810, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   1, Avg loss: 0.0549, Accuracy: 301/1013 (29.7137%)
_Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 451/1013 (44.5212%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.9710, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 229/605 (37.8512%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0405, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.3039, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   1, Avg loss: 0.0536, Accuracy: 338/1372 (24.6356%)
_Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 532/1372 (38.7755%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.0955, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   1, Avg loss: 0.0616, Accuracy: 376/1163 (32.3302%)
_Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   2, Avg loss: 0.0363, Accuracy: 465/1163 (39.9828%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.1784, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0489, Accuracy: 280/813 (34.4403%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 447/813 (54.9815%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.8060, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.0730, Accuracy: 158/603 (26.2023%)
_Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 290/603 (48.0929%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.4633, Accuracy: 51/10000 (0.5100%)
time spent on training: 216.48942351341248
[rfa agg] training data poison_ratio: 0.0  data num: [708, 408, 1049, 1340, 1013, 605, 1372, 1163, 813, 603]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 36, 51, 77, 39, 2, 42, 68, 53, 88], weight: tensor([0.0780, 0.0450, 0.1156, 0.1477, 0.1116, 0.0667, 0.1512, 0.1282, 0.0896,
        0.0665])
[rfa agg] iter:  0, prev_obj_val: 43.01750183105469, obj_val: 46.57075500488281, abs dis: 3.553253173828125
[rfa agg] iter: 0, weight: tensor([0.1455, 0.0214, 0.0993, 0.0607, 0.1327, 0.0580, 0.0549, 0.0715, 0.2975,
        0.0583])
[rfa agg] iter:  1, prev_obj_val: 46.57075500488281, obj_val: 57.242889404296875, abs dis: 10.672134399414062
[rfa agg] iter: 1, weight: tensor([0.2456, 0.0216, 0.0669, 0.0459, 0.0830, 0.0683, 0.0421, 0.0520, 0.3054,
        0.0692])
[rfa agg] iter:  2, prev_obj_val: 57.242889404296875, obj_val: 64.0074691772461, abs dis: 6.764579772949219
[rfa agg] iter: 2, weight: tensor([0.1399, 0.0368, 0.0509, 0.0406, 0.0582, 0.2264, 0.0379, 0.0434, 0.1010,
        0.2649])
[rfa agg] iter:  3, prev_obj_val: 64.0074691772461, obj_val: 64.00238037109375, abs dis: 0.00508880615234375
[rfa agg] iter: 3, weight: tensor([0.0888, 0.0518, 0.0449, 0.0375, 0.0500, 0.2682, 0.0354, 0.0394, 0.0734,
        0.3107])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3313, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.4372, Accuracy: 0/9950 (0.0000%)
saving model
Done in 452.96439599990845 sec.
Server Epoch:85 choose agents : [30, 92, 55, 31, 64, 72, 67, 34, 45, 53].
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0750, Accuracy: 106/486 (21.8107%)
_Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0386, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.5691, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 445/1715 (25.9475%)
_Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 709/1715 (41.3411%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.8255, Accuracy: 79/10000 (0.7900%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   1, Avg loss: 0.0546, Accuracy: 265/1071 (24.7432%)
_Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 486/1071 (45.3782%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.6765, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0817, Accuracy: 72/460 (15.6522%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0390, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.5240, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 180/953 (18.8877%)
_Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 329/953 (34.5226%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.8240, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   1, Avg loss: 0.0613, Accuracy: 263/1241 (21.1926%)
_Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 379/1241 (30.5399%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.6780, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   1, Avg loss: 0.0763, Accuracy: 57/426 (13.3803%)
_Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   2, Avg loss: 0.0408, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.2403, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   1, Avg loss: 0.0585, Accuracy: 408/1427 (28.5915%)
_Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 571/1427 (40.0140%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.3736, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   1, Avg loss: 0.0634, Accuracy: 226/669 (33.7818%)
_Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   2, Avg loss: 0.0387, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.2803, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   1, Avg loss: 0.0476, Accuracy: 295/813 (36.2854%)
_Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 456/813 (56.0886%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.7041, Accuracy: 51/10000 (0.5100%)
time spent on training: 275.89083099365234
[rfa agg] training data poison_ratio: 0.16812439261418854  data num: [486, 1715, 1071, 460, 953, 1241, 426, 1427, 669, 813]
[rfa agg] considering poison per batch poison_fraction: 0.05253887269193392
[rfa agg] init. name: [30, 92, 55, 31, 64, 72, 67, 34, 45, 53], weight: tensor([0.0525, 0.1852, 0.1156, 0.0497, 0.1029, 0.1340, 0.0460, 0.1541, 0.0722,
        0.0878])
[rfa agg] iter:  0, prev_obj_val: 53.00505828857422, obj_val: 57.01110076904297, abs dis: 4.00604248046875
[rfa agg] iter: 0, weight: tensor([0.0219, 0.0503, 0.2079, 0.0207, 0.3711, 0.0918, 0.0169, 0.0639, 0.0499,
        0.1055])
[rfa agg] iter:  1, prev_obj_val: 57.01110076904297, obj_val: 62.916473388671875, abs dis: 5.905372619628906
[rfa agg] iter: 1, weight: tensor([0.0291, 0.0475, 0.1252, 0.0275, 0.3098, 0.0739, 0.0219, 0.0569, 0.0784,
        0.2299])
[rfa agg] iter:  2, prev_obj_val: 62.916473388671875, obj_val: 65.28657531738281, abs dis: 2.3701019287109375
[rfa agg] iter: 2, weight: tensor([0.0397, 0.0437, 0.0868, 0.0375, 0.1378, 0.0609, 0.0285, 0.0501, 0.1521,
        0.3629])
[rfa agg] iter:  3, prev_obj_val: 65.28657531738281, obj_val: 67.78414916992188, abs dis: 2.4975738525390625
[rfa agg] iter: 3, weight: tensor([0.0472, 0.0447, 0.0828, 0.0446, 0.1210, 0.0605, 0.0332, 0.0507, 0.2296,
        0.2856])
[rfa agg] iter:  4, prev_obj_val: 67.78414916992188, obj_val: 70.4064712524414, abs dis: 2.6223220825195312
[rfa agg] iter: 4, weight: tensor([0.0517, 0.0416, 0.0724, 0.0488, 0.1003, 0.0547, 0.0354, 0.0466, 0.3567,
        0.1919])
[rfa agg] iter:  5, prev_obj_val: 70.4064712524414, obj_val: 76.46749114990234, abs dis: 6.0610198974609375
[rfa agg] iter: 5, weight: tensor([0.0500, 0.0335, 0.0554, 0.0471, 0.0734, 0.0430, 0.0331, 0.0372, 0.5053,
        0.1220])
[rfa agg] iter:  6, prev_obj_val: 76.46749114990234, obj_val: 73.36219787597656, abs dis: 3.1052932739257812
[rfa agg] iter: 6, weight: tensor([0.1081, 0.0464, 0.0699, 0.1012, 0.0868, 0.0570, 0.0642, 0.0504, 0.2939,
        0.1221])
[rfa agg] iter:  7, prev_obj_val: 73.36219787597656, obj_val: 67.7742919921875, abs dis: 5.5879058837890625
[rfa agg] iter: 7, weight: tensor([0.0759, 0.0412, 0.0649, 0.0714, 0.0830, 0.0517, 0.0479, 0.0452, 0.3938,
        0.1250])
[rfa agg] iter:  8, prev_obj_val: 67.7742919921875, obj_val: 70.4013900756836, abs dis: 2.6270980834960938
[rfa agg] iter: 8, weight: tensor([0.0500, 0.0401, 0.0698, 0.0471, 0.0967, 0.0528, 0.0342, 0.0449, 0.3836,
        0.1808])
[rfa agg] iter:  9, prev_obj_val: 70.4013900756836, obj_val: 76.46944427490234, abs dis: 6.06805419921875
[rfa agg] iter: 9, weight: tensor([0.0490, 0.0328, 0.0542, 0.0461, 0.0718, 0.0421, 0.0324, 0.0364, 0.5160,
        0.1193])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3344, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.4403, Accuracy: 0/9950 (0.0000%)
saving model
Done in 522.3493423461914 sec.
Server Epoch:86 choose agents : [2, 18, 97, 3, 99, 22, 44, 9, 74, 92].
_Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0610, Accuracy: 237/605 (39.1736%)
_Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0390, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.4476, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   1, Avg loss: 0.0741, Accuracy: 126/530 (23.7736%)
_Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   2, Avg loss: 0.0382, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.2252, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   1, Avg loss: 0.0515, Accuracy: 359/1213 (29.5960%)
_Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 516/1213 (42.5392%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.5204, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0722, Accuracy: 105/781 (13.4443%)
_Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0352, Accuracy: 246/781 (31.4981%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.1895, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0647, Accuracy: 175/773 (22.6391%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0307, Accuracy: 379/773 (49.0298%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.2454, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 539/1470 (36.6667%)
_Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 842/1470 (57.2789%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.4654, Accuracy: 91/10000 (0.9100%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 376/1750 (21.4857%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 682/1750 (38.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.0233, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   1, Avg loss: 0.0501, Accuracy: 350/1275 (27.4510%)
_Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 688/1275 (53.9608%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.9446, Accuracy: 112/10000 (1.1200%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 484/1552 (31.1856%)
_Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 781/1552 (50.3222%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.7528, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 469/1715 (27.3469%)
_Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 705/1715 (41.1079%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.8656, Accuracy: 91/10000 (0.9100%)
time spent on training: 295.773099899292
[rfa agg] training data poison_ratio: 0.28309327846364885  data num: [605, 530, 1213, 781, 773, 1470, 1750, 1275, 1552, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.08846664951989026
[rfa agg] init. name: [2, 18, 97, 3, 99, 22, 44, 9, 74, 92], weight: tensor([0.0519, 0.0454, 0.1040, 0.0670, 0.0663, 0.1260, 0.1500, 0.1093, 0.1331,
        0.1470])
[rfa agg] iter:  0, prev_obj_val: 56.361122131347656, obj_val: 58.59496307373047, abs dis: 2.2338409423828125
[rfa agg] iter: 0, weight: tensor([0.0267, 0.0208, 0.3299, 0.0548, 0.0542, 0.1023, 0.0617, 0.2049, 0.0777,
        0.0671])
[rfa agg] iter:  1, prev_obj_val: 58.59496307373047, obj_val: 60.93772888183594, abs dis: 2.3427658081054688
[rfa agg] iter: 1, weight: tensor([0.0318, 0.0247, 0.2947, 0.0679, 0.0672, 0.1043, 0.0657, 0.1914, 0.0812,
        0.0711])
[rfa agg] iter:  2, prev_obj_val: 60.93772888183594, obj_val: 58.595237731933594, abs dis: 2.3424911499023438
[rfa agg] iter: 2, weight: tensor([0.0377, 0.0289, 0.2522, 0.0843, 0.0834, 0.1060, 0.0694, 0.1791, 0.0843,
        0.0747])
[rfa agg] iter:  3, prev_obj_val: 58.595237731933594, obj_val: 60.93757247924805, abs dis: 2.342334747314453
[rfa agg] iter: 3, weight: tensor([0.0320, 0.0248, 0.2917, 0.0683, 0.0676, 0.1048, 0.0660, 0.1920, 0.0815,
        0.0714])
[rfa agg] iter:  4, prev_obj_val: 60.93757247924805, obj_val: 58.595245361328125, abs dis: 2.342327117919922
[rfa agg] iter: 4, weight: tensor([0.0377, 0.0289, 0.2521, 0.0843, 0.0834, 0.1060, 0.0694, 0.1792, 0.0843,
        0.0747])
[rfa agg] iter:  5, prev_obj_val: 58.595245361328125, obj_val: 60.93757247924805, abs dis: 2.342327117919922
[rfa agg] iter: 5, weight: tensor([0.0320, 0.0248, 0.2917, 0.0683, 0.0676, 0.1048, 0.0660, 0.1920, 0.0815,
        0.0714])
[rfa agg] iter:  6, prev_obj_val: 60.93757247924805, obj_val: 58.595245361328125, abs dis: 2.342327117919922
[rfa agg] iter: 6, weight: tensor([0.0377, 0.0289, 0.2521, 0.0843, 0.0834, 0.1060, 0.0694, 0.1792, 0.0843,
        0.0747])
[rfa agg] iter:  7, prev_obj_val: 58.595245361328125, obj_val: 60.93757247924805, abs dis: 2.342327117919922
[rfa agg] iter: 7, weight: tensor([0.0320, 0.0248, 0.2917, 0.0683, 0.0676, 0.1048, 0.0660, 0.1920, 0.0815,
        0.0714])
[rfa agg] iter:  8, prev_obj_val: 60.93757247924805, obj_val: 58.595245361328125, abs dis: 2.342327117919922
[rfa agg] iter: 8, weight: tensor([0.0377, 0.0289, 0.2521, 0.0843, 0.0834, 0.1060, 0.0694, 0.1792, 0.0843,
        0.0747])
[rfa agg] iter:  9, prev_obj_val: 58.595245361328125, obj_val: 60.93757247924805, abs dis: 2.342327117919922
[rfa agg] iter: 9, weight: tensor([0.0320, 0.0248, 0.2917, 0.0683, 0.0676, 0.1048, 0.0660, 0.1920, 0.0815,
        0.0714])
			Update norm = 152.45339964231692 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3344, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.4403, Accuracy: 0/9950 (0.0000%)
saving model
Done in 545.4684112071991 sec.
Server Epoch:87 choose agents : [27, 69, 68, 61, 71, 23, 41, 98, 94, 52].
_Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   1, Avg loss: 0.0542, Accuracy: 441/1587 (27.7883%)
_Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 591/1587 (37.2401%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4793, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0584, Accuracy: 298/590 (50.5085%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0330, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.1269, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0619, Accuracy: 378/1163 (32.5021%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0370, Accuracy: 434/1163 (37.3173%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.2849, Accuracy: 74/10000 (0.7400%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1303, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1197, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3492, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   1, Avg loss: 0.0628, Accuracy: 177/818 (21.6381%)
_Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   2, Avg loss: 0.0304, Accuracy: 364/818 (44.4988%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.0784, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0637, Accuracy: 323/715 (45.1748%)
_Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0381, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.0291, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   1, Avg loss: 0.0583, Accuracy: 334/719 (46.4534%)
_Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   2, Avg loss: 0.0314, Accuracy: 449/719 (62.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.3264, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   1, Avg loss: 0.0760, Accuracy: 55/373 (14.7453%)
_Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   2, Avg loss: 0.0460, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.9211, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 354/1662 (21.2996%)
_Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 591/1662 (35.5596%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.5706, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   1, Avg loss: 0.0509, Accuracy: 334/636 (52.5157%)
_Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   2, Avg loss: 0.0296, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.3353, Accuracy: 50/10000 (0.5000%)
time spent on training: 235.75976061820984
[rfa agg] training data poison_ratio: 0.010182079540009582  data num: [1587, 590, 1163, 85, 818, 715, 719, 373, 1662, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0031818998562529945
[rfa agg] init. name: [27, 69, 68, 61, 71, 23, 41, 98, 94, 52], weight: tensor([0.1901, 0.0707, 0.1393, 0.0102, 0.0980, 0.0856, 0.0861, 0.0447, 0.1991,
        0.0762])
[rfa agg] iter:  0, prev_obj_val: 59.31816482543945, obj_val: 60.4752197265625, abs dis: 1.1570549011230469
[rfa agg] iter: 0, weight: tensor([0.1114, 0.0621, 0.2356, 0.0038, 0.1678, 0.1118, 0.1119, 0.0236, 0.1051,
        0.0669])
[rfa agg] iter:  1, prev_obj_val: 60.4752197265625, obj_val: 64.11444854736328, abs dis: 3.6392288208007812
[rfa agg] iter: 1, weight: tensor([0.0649, 0.0660, 0.1039, 0.0032, 0.3030, 0.1529, 0.1517, 0.0210, 0.0624,
        0.0709])
[rfa agg] iter:  2, prev_obj_val: 64.11444854736328, obj_val: 71.40563201904297, abs dis: 7.2911834716796875
[rfa agg] iter: 2, weight: tensor([0.0319, 0.0745, 0.0432, 0.0022, 0.1857, 0.2762, 0.2599, 0.0162, 0.0310,
        0.0792])
[rfa agg] iter:  3, prev_obj_val: 71.40563201904297, obj_val: 77.86529541015625, abs dis: 6.459663391113281
[rfa agg] iter: 3, weight: tensor([0.0337, 0.2463, 0.0420, 0.0031, 0.0974, 0.1370, 0.1363, 0.0255, 0.0331,
        0.2456])
[rfa agg] iter:  4, prev_obj_val: 77.86529541015625, obj_val: 81.70545196533203, abs dis: 3.8401565551757812
[rfa agg] iter: 4, weight: tensor([0.0339, 0.2947, 0.0405, 0.0037, 0.0759, 0.0920, 0.0919, 0.0351, 0.0334,
        0.2989])
[rfa agg] iter:  5, prev_obj_val: 81.70545196533203, obj_val: 74.30191802978516, abs dis: 7.403533935546875
[rfa agg] iter: 5, weight: tensor([0.0443, 0.2437, 0.0518, 0.0054, 0.0899, 0.1041, 0.1041, 0.0550, 0.0437,
        0.2580])
[rfa agg] iter:  6, prev_obj_val: 74.30191802978516, obj_val: 74.28877258300781, abs dis: 0.01314544677734375
[rfa agg] iter: 6, weight: tensor([0.0261, 0.3345, 0.0318, 0.0026, 0.0656, 0.0841, 0.0837, 0.0230, 0.0257,
        0.3229])
[rfa agg] iter:  7, prev_obj_val: 74.28877258300781, obj_val: 81.71111297607422, abs dis: 7.422340393066406
[rfa agg] iter: 7, weight: tensor([0.0249, 0.3455, 0.0303, 0.0025, 0.0623, 0.0798, 0.0795, 0.0219, 0.0245,
        0.3288])
[rfa agg] iter:  8, prev_obj_val: 81.71111297607422, obj_val: 74.30169677734375, abs dis: 7.409416198730469
[rfa agg] iter: 8, weight: tensor([0.0442, 0.2447, 0.0517, 0.0054, 0.0896, 0.1037, 0.1038, 0.0549, 0.0436,
        0.2585])
[rfa agg] iter:  9, prev_obj_val: 74.30169677734375, obj_val: 74.28876495361328, abs dis: 0.01293182373046875
[rfa agg] iter: 9, weight: tensor([0.0261, 0.3346, 0.0318, 0.0026, 0.0655, 0.0840, 0.0836, 0.0230, 0.0257,
        0.3230])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3372, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.4530, Accuracy: 0/9950 (0.0000%)
saving model
Done in 489.89749908447266 sec.
Server Epoch:88 choose agents : [48, 70, 99, 34, 64, 81, 0, 53, 31, 56].
_Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0706, Accuracy: 103/631 (16.3233%)
_Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 215/631 (34.0729%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.3543, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   1, Avg loss: 0.0566, Accuracy: 362/1418 (25.5289%)
_Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 642/1418 (45.2750%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.7707, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   1, Avg loss: 0.0626, Accuracy: 196/773 (25.3558%)
_Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   2, Avg loss: 0.0341, Accuracy: 407/773 (52.6520%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.4686, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0584, Accuracy: 393/1427 (27.5403%)
_Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 563/1427 (39.4534%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.1784, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 178/953 (18.6779%)
_Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   2, Avg loss: 0.0372, Accuracy: 336/953 (35.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.8926, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0669, Accuracy: 243/774 (31.3953%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0380, Accuracy: 302/774 (39.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.8609, Accuracy: 77/10000 (0.7700%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 350/1657 (21.1225%)
_Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 521/1657 (31.4424%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.1632, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   1, Avg loss: 0.0469, Accuracy: 306/813 (37.6384%)
_Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   2, Avg loss: 0.0181, Accuracy: 492/813 (60.5166%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 11.0985, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0810, Accuracy: 81/460 (17.6087%)
_Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0378, Accuracy: 191/460 (41.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.8422, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   2, Avg loss: 0.0668, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3875, Accuracy: 50/10000 (0.5000%)
time spent on training: 274.6714324951172
[rfa agg] training data poison_ratio: 0.18224813022437308  data num: [631, 1418, 773, 1427, 953, 774, 1657, 813, 460, 186]
[rfa agg] considering poison per batch poison_fraction: 0.056952540695116585
[rfa agg] init. name: [48, 70, 99, 34, 64, 81, 0, 53, 31, 56], weight: tensor([0.0694, 0.1560, 0.0850, 0.1570, 0.1048, 0.0851, 0.1822, 0.0894, 0.0506,
        0.0205])
[rfa agg] iter:  0, prev_obj_val: 54.15324783325195, obj_val: 58.903812408447266, abs dis: 4.7505645751953125
[rfa agg] iter: 0, weight: tensor([0.0481, 0.1075, 0.1076, 0.1084, 0.2865, 0.1079, 0.0865, 0.1137, 0.0269,
        0.0069])
[rfa agg] iter:  1, prev_obj_val: 58.903812408447266, obj_val: 64.1722640991211, abs dis: 5.268451690673828
[rfa agg] iter: 1, weight: tensor([0.0438, 0.0301, 0.2366, 0.0303, 0.0980, 0.2349, 0.0271, 0.2757, 0.0195,
        0.0040])
[rfa agg] iter:  2, prev_obj_val: 64.1722640991211, obj_val: 73.69169616699219, abs dis: 9.519432067871094
[rfa agg] iter: 2, weight: tensor([0.0947, 0.0406, 0.2119, 0.0409, 0.0980, 0.2053, 0.0373, 0.2288, 0.0360,
        0.0065])
[rfa agg] iter:  3, prev_obj_val: 73.69169616699219, obj_val: 64.21390533447266, abs dis: 9.477790832519531
[rfa agg] iter: 3, weight: tensor([0.3214, 0.0460, 0.1225, 0.0464, 0.0853, 0.1221, 0.0434, 0.1295, 0.0732,
        0.0101])
[rfa agg] iter:  4, prev_obj_val: 64.21390533447266, obj_val: 73.6893081665039, abs dis: 9.47540283203125
[rfa agg] iter: 4, weight: tensor([0.0991, 0.0413, 0.2057, 0.0416, 0.0998, 0.2083, 0.0380, 0.2226, 0.0367,
        0.0066])
[rfa agg] iter:  5, prev_obj_val: 73.6893081665039, obj_val: 64.21427917480469, abs dis: 9.475028991699219
[rfa agg] iter: 5, weight: tensor([0.3225, 0.0460, 0.1223, 0.0463, 0.0852, 0.1220, 0.0434, 0.1293, 0.0731,
        0.0101])
[rfa agg] iter:  6, prev_obj_val: 64.21427917480469, obj_val: 73.6893081665039, abs dis: 9.475028991699219
[rfa agg] iter: 6, weight: tensor([0.0991, 0.0413, 0.2057, 0.0416, 0.0998, 0.2084, 0.0380, 0.2226, 0.0367,
        0.0066])
[rfa agg] iter:  7, prev_obj_val: 73.6893081665039, obj_val: 64.21427917480469, abs dis: 9.475028991699219
[rfa agg] iter: 7, weight: tensor([0.3225, 0.0460, 0.1223, 0.0463, 0.0852, 0.1220, 0.0434, 0.1293, 0.0731,
        0.0101])
[rfa agg] iter:  8, prev_obj_val: 64.21427917480469, obj_val: 73.6893081665039, abs dis: 9.475028991699219
[rfa agg] iter: 8, weight: tensor([0.0991, 0.0413, 0.2057, 0.0416, 0.0998, 0.2084, 0.0380, 0.2226, 0.0367,
        0.0066])
[rfa agg] iter:  9, prev_obj_val: 73.6893081665039, obj_val: 64.21427917480469, abs dis: 9.475028991699219
[rfa agg] iter: 9, weight: tensor([0.3225, 0.0460, 0.1223, 0.0463, 0.0852, 0.1220, 0.0434, 0.1293, 0.0731,
        0.0101])
			Update norm = 107.74443956795405 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3372, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.4530, Accuracy: 0/9950 (0.0000%)
saving model
Done in 531.5107514858246 sec.
Server Epoch:89 choose agents : [39, 68, 73, 96, 98, 22, 75, 79, 34, 43].
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 304/1013 (30.0099%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 511/1013 (50.4442%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.4732, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   1, Avg loss: 0.0618, Accuracy: 373/1163 (32.0722%)
_Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   2, Avg loss: 0.0361, Accuracy: 455/1163 (39.1230%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.1306, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   1, Avg loss: 0.0649, Accuracy: 181/938 (19.2964%)
_Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   2, Avg loss: 0.0325, Accuracy: 342/938 (36.4606%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.7924, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   1, Avg loss: 0.0780, Accuracy: 42/311 (13.5048%)
_Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   2, Avg loss: 0.0514, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.6258, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   1, Avg loss: 0.0765, Accuracy: 48/373 (12.8686%)
_Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   2, Avg loss: 0.0453, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.9731, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 498/1470 (33.8776%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 849/1470 (57.7551%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.6966, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   1, Avg loss: 0.0644, Accuracy: 253/776 (32.6031%)
_Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   2, Avg loss: 0.0305, Accuracy: 411/776 (52.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.7123, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   1, Avg loss: 0.1036, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   2, Avg loss: 0.0811, Accuracy: 52/197 (26.3959%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.4196, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   1, Avg loss: 0.0583, Accuracy: 377/1427 (26.4191%)
_Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 576/1427 (40.3644%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.2078, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0598, Accuracy: 305/946 (32.2410%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 364/946 (38.4778%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.4143, Accuracy: 71/10000 (0.7100%)
time spent on training: 228.46505618095398
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 1163, 938, 311, 373, 1470, 776, 197, 1427, 946]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 68, 73, 96, 98, 22, 75, 79, 34, 43], weight: tensor([0.1176, 0.1350, 0.1089, 0.0361, 0.0433, 0.1707, 0.0901, 0.0229, 0.1657,
        0.1098])
[rfa agg] iter:  0, prev_obj_val: 42.515892028808594, obj_val: 46.9251823425293, abs dis: 4.409290313720703
[rfa agg] iter: 0, weight: tensor([0.1792, 0.0619, 0.3084, 0.0067, 0.0090, 0.0397, 0.0797, 0.0039, 0.0385,
        0.2729])
[rfa agg] iter:  1, prev_obj_val: 46.9251823425293, obj_val: 46.91164779663086, abs dis: 0.0135345458984375
[rfa agg] iter: 1, weight: tensor([0.1409, 0.0675, 0.2412, 0.0102, 0.0137, 0.0478, 0.1903, 0.0058, 0.0464,
        0.2364])
[rfa agg] iter:  2, prev_obj_val: 46.91164779663086, obj_val: 44.41109085083008, abs dis: 2.5005569458007812
[rfa agg] iter: 2, weight: tensor([0.1403, 0.0673, 0.2381, 0.0101, 0.0137, 0.0477, 0.1968, 0.0058, 0.0463,
        0.2340])
[rfa agg] iter:  3, prev_obj_val: 44.41109085083008, obj_val: 49.633853912353516, abs dis: 5.2227630615234375
[rfa agg] iter: 3, weight: tensor([0.1468, 0.0609, 0.2929, 0.0078, 0.0105, 0.0412, 0.1159, 0.0045, 0.0400,
        0.2793])
[rfa agg] iter:  4, prev_obj_val: 49.633853912353516, obj_val: 52.487205505371094, abs dis: 2.853351593017578
[rfa agg] iter: 4, weight: tensor([0.1243, 0.0666, 0.1869, 0.0116, 0.0158, 0.0491, 0.3049, 0.0066, 0.0477,
        0.1863])
[rfa agg] iter:  5, prev_obj_val: 52.487205505371094, obj_val: 59.19172286987305, abs dis: 6.704517364501953
[rfa agg] iter: 5, weight: tensor([0.0976, 0.0570, 0.1332, 0.0115, 0.0158, 0.0434, 0.4597, 0.0065, 0.0422,
        0.1331])
[rfa agg] iter:  6, prev_obj_val: 59.19172286987305, obj_val: 55.7397346496582, abs dis: 3.4519882202148438
[rfa agg] iter: 6, weight: tensor([0.1163, 0.0769, 0.1426, 0.0207, 0.0289, 0.0621, 0.3377, 0.0115, 0.0603,
        0.1430])
[rfa agg] iter:  7, prev_obj_val: 55.7397346496582, obj_val: 49.5962028503418, abs dis: 6.143531799316406
[rfa agg] iter: 7, weight: tensor([0.1048, 0.0655, 0.1344, 0.0153, 0.0211, 0.0515, 0.4145, 0.0085, 0.0500,
        0.1345])
[rfa agg] iter:  8, prev_obj_val: 49.5962028503418, obj_val: 46.9344596862793, abs dis: 2.6617431640625
[rfa agg] iter: 8, weight: tensor([0.1167, 0.0626, 0.1721, 0.0109, 0.0149, 0.0461, 0.3556, 0.0062, 0.0448,
        0.1702])
[rfa agg] iter:  9, prev_obj_val: 46.9344596862793, obj_val: 46.91170120239258, abs dis: 0.02275848388671875
[rfa agg] iter: 9, weight: tensor([0.1402, 0.0673, 0.2338, 0.0101, 0.0137, 0.0477, 0.2069, 0.0058, 0.0463,
        0.2283])
			Update norm = 125.65883406320863 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3372, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.4530, Accuracy: 0/9950 (0.0000%)
saving model
Done in 475.0508623123169 sec.
Server Epoch:90 choose agents : [0, 96, 92, 51, 57, 32, 6, 53, 79, 37].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 359/1657 (21.6657%)
_Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 491/1657 (29.6319%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.1304, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 37/311 (11.8971%)
_Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   2, Avg loss: 0.0527, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.6668, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   1, Avg loss: 0.0534, Accuracy: 424/1715 (24.7230%)
_Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 717/1715 (41.8076%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.6854, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0586, Accuracy: 234/1049 (22.3070%)
_Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0296, Accuracy: 510/1049 (48.6177%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.3256, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   1, Avg loss: 0.0539, Accuracy: 310/1154 (26.8631%)
_Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   2, Avg loss: 0.0255, Accuracy: 483/1154 (41.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.4727, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   1, Avg loss: 0.0595, Accuracy: 218/735 (29.6599%)
_Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 378/735 (51.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.0727, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   1, Avg loss: 0.0551, Accuracy: 389/1956 (19.8875%)
_Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 666/1956 (34.0491%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.6525, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0471, Accuracy: 295/813 (36.2854%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 463/813 (56.9496%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 12.0928, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   1, Avg loss: 0.1035, Accuracy: 12/197 (6.0914%)
_Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   2, Avg loss: 0.0845, Accuracy: 58/197 (29.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.4041, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   1, Avg loss: 0.0526, Accuracy: 383/1129 (33.9238%)
_Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 704/1129 (62.3561%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.2936, Accuracy: 116/10000 (1.1600%)
time spent on training: 283.99602723121643
[rfa agg] training data poison_ratio: 0.25998506905561775  data num: [1657, 311, 1715, 1049, 1154, 735, 1956, 813, 197, 1129]
[rfa agg] considering poison per batch poison_fraction: 0.08124533407988055
[rfa agg] init. name: [0, 96, 92, 51, 57, 32, 6, 53, 79, 37], weight: tensor([0.1546, 0.0290, 0.1600, 0.0979, 0.1077, 0.0686, 0.1825, 0.0759, 0.0184,
        0.1054])
[rfa agg] iter:  0, prev_obj_val: 59.15516662597656, obj_val: 61.43637466430664, abs dis: 2.281208038330078
[rfa agg] iter: 0, weight: tensor([0.0832, 0.0071, 0.0748, 0.1293, 0.3622, 0.0322, 0.0559, 0.0410, 0.0042,
        0.2101])
[rfa agg] iter:  1, prev_obj_val: 61.43637466430664, obj_val: 65.03314971923828, abs dis: 3.5967750549316406
[rfa agg] iter: 1, weight: tensor([0.0519, 0.0060, 0.0478, 0.1910, 0.2439, 0.0307, 0.0379, 0.0405, 0.0036,
        0.3467])
[rfa agg] iter:  2, prev_obj_val: 65.03314971923828, obj_val: 69.8876953125, abs dis: 4.854545593261719
[rfa agg] iter: 2, weight: tensor([0.0518, 0.0073, 0.0483, 0.3337, 0.1518, 0.0411, 0.0395, 0.0562, 0.0043,
        0.2660])
[rfa agg] iter:  3, prev_obj_val: 69.8876953125, obj_val: 64.97454833984375, abs dis: 4.91314697265625
[rfa agg] iter: 3, weight: tensor([0.0614, 0.0105, 0.0578, 0.3178, 0.1372, 0.0671, 0.0485, 0.0970, 0.0061,
        0.1966])
[rfa agg] iter:  4, prev_obj_val: 64.97454833984375, obj_val: 67.30926513671875, abs dis: 2.334716796875
[rfa agg] iter: 4, weight: tensor([0.0490, 0.0069, 0.0457, 0.3913, 0.1404, 0.0389, 0.0373, 0.0534, 0.0041,
        0.2330])
[rfa agg] iter:  5, prev_obj_val: 67.30926513671875, obj_val: 67.30728149414062, abs dis: 0.001983642578125
[rfa agg] iter: 5, weight: tensor([0.0530, 0.0083, 0.0497, 0.3903, 0.1322, 0.0492, 0.0412, 0.0689, 0.0048,
        0.2026])
			Update norm = 147.94988330090024 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3372, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.4530, Accuracy: 0/9950 (0.0000%)
saving model
Done in 527.1489777565002 sec.
Server Epoch:91 choose agents : [27, 46, 19, 29, 48, 47, 40, 89, 34, 83].
_Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   1, Avg loss: 0.0541, Accuracy: 431/1587 (27.1582%)
_Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 575/1587 (36.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.8536, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 409/1904 (21.4811%)
_Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 709/1904 (37.2374%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.0140, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   1, Avg loss: 0.0464, Accuracy: 435/1036 (41.9884%)
_Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 678/1036 (65.4440%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.9633, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   1, Avg loss: 0.0488, Accuracy: 406/1440 (28.1944%)
_Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 690/1440 (47.9167%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.8535, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   1, Avg loss: 0.0700, Accuracy: 104/631 (16.4818%)
_Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   2, Avg loss: 0.0410, Accuracy: 225/631 (35.6577%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.4091, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   1, Avg loss: 0.1225, Accuracy: 5/134 (3.7313%)
_Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   2, Avg loss: 0.1094, Accuracy: 37/134 (27.6119%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3744, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   1, Avg loss: 0.0558, Accuracy: 345/1573 (21.9326%)
_Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 551/1573 (35.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.7329, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0593, Accuracy: 345/896 (38.5045%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 433/896 (48.3259%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.6728, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0576, Accuracy: 405/1427 (28.3812%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 567/1427 (39.7337%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.4414, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   1, Avg loss: 0.0537, Accuracy: 441/1953 (22.5806%)
_Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 787/1953 (40.2970%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.1726, Accuracy: 85/10000 (0.8500%)
time spent on training: 304.64072823524475
[rfa agg] training data poison_ratio: 0.0  data num: [1587, 1904, 1036, 1440, 631, 134, 1573, 896, 1427, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [27, 46, 19, 29, 48, 47, 40, 89, 34, 83], weight: tensor([0.1261, 0.1513, 0.0823, 0.1145, 0.0502, 0.0107, 0.1250, 0.0712, 0.1134,
        0.1552])
[rfa agg] iter:  0, prev_obj_val: 49.44585037231445, obj_val: 51.676734924316406, abs dis: 2.230884552001953
[rfa agg] iter: 0, weight: tensor([0.1300, 0.0607, 0.0525, 0.2671, 0.0135, 0.0018, 0.1287, 0.0286, 0.2617,
        0.0554])
[rfa agg] iter:  1, prev_obj_val: 51.676734924316406, obj_val: 54.09181594848633, abs dis: 2.415081024169922
[rfa agg] iter: 1, weight: tensor([0.1298, 0.0659, 0.0670, 0.2491, 0.0162, 0.0021, 0.1287, 0.0352, 0.2454,
        0.0605])
[rfa agg] iter:  2, prev_obj_val: 54.09181594848633, obj_val: 51.67733383178711, abs dis: 2.4144821166992188
[rfa agg] iter: 2, weight: tensor([0.1315, 0.0715, 0.0862, 0.2260, 0.0195, 0.0025, 0.1303, 0.0432, 0.2231,
        0.0661])
[rfa agg] iter:  3, prev_obj_val: 51.67733383178711, obj_val: 54.091678619384766, abs dis: 2.4143447875976562
[rfa agg] iter: 3, weight: tensor([0.1305, 0.0661, 0.0674, 0.2480, 0.0163, 0.0022, 0.1293, 0.0353, 0.2442,
        0.0608])
[rfa agg] iter:  4, prev_obj_val: 54.091678619384766, obj_val: 51.677337646484375, abs dis: 2.4143409729003906
[rfa agg] iter: 4, weight: tensor([0.1315, 0.0715, 0.0862, 0.2259, 0.0195, 0.0025, 0.1304, 0.0432, 0.2231,
        0.0661])
[rfa agg] iter:  5, prev_obj_val: 51.677337646484375, obj_val: 54.091678619384766, abs dis: 2.4143409729003906
[rfa agg] iter: 5, weight: tensor([0.1305, 0.0661, 0.0674, 0.2480, 0.0163, 0.0022, 0.1293, 0.0353, 0.2442,
        0.0608])
[rfa agg] iter:  6, prev_obj_val: 54.091678619384766, obj_val: 51.677337646484375, abs dis: 2.4143409729003906
[rfa agg] iter: 6, weight: tensor([0.1315, 0.0715, 0.0862, 0.2259, 0.0195, 0.0025, 0.1304, 0.0432, 0.2231,
        0.0661])
[rfa agg] iter:  7, prev_obj_val: 51.677337646484375, obj_val: 54.091678619384766, abs dis: 2.4143409729003906
[rfa agg] iter: 7, weight: tensor([0.1305, 0.0661, 0.0674, 0.2480, 0.0163, 0.0022, 0.1293, 0.0353, 0.2442,
        0.0608])
[rfa agg] iter:  8, prev_obj_val: 54.091678619384766, obj_val: 51.677337646484375, abs dis: 2.4143409729003906
[rfa agg] iter: 8, weight: tensor([0.1315, 0.0715, 0.0862, 0.2259, 0.0195, 0.0025, 0.1304, 0.0432, 0.2231,
        0.0661])
[rfa agg] iter:  9, prev_obj_val: 51.677337646484375, obj_val: 54.091678619384766, abs dis: 2.4143409729003906
[rfa agg] iter: 9, weight: tensor([0.1305, 0.0661, 0.0674, 0.2480, 0.0163, 0.0022, 0.1293, 0.0353, 0.2442,
        0.0608])
			Update norm = 188.12857139467147 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3372, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.4530, Accuracy: 0/9950 (0.0000%)
saving model
Done in 550.7077901363373 sec.
Server Epoch:92 choose agents : [9, 63, 42, 40, 83, 13, 84, 5, 75, 3].
_Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   1, Avg loss: 0.0497, Accuracy: 365/1275 (28.6275%)
_Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   2, Avg loss: 0.0192, Accuracy: 726/1275 (56.9412%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.3314, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 259/888 (29.1667%)
_Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 417/888 (46.9595%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.3460, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0524, Accuracy: 370/1372 (26.9679%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 556/1372 (40.5248%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.2397, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0556, Accuracy: 341/1573 (21.6783%)
_Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 546/1573 (34.7107%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.8316, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   1, Avg loss: 0.0547, Accuracy: 433/1953 (22.1710%)
_Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 780/1953 (39.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.9623, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0563, Accuracy: 337/1645 (20.4863%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 622/1645 (37.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.6707, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   1, Avg loss: 0.0628, Accuracy: 316/1190 (26.5546%)
_Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 419/1190 (35.2101%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.6625, Accuracy: 53/10000 (0.5300%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 390/1628 (23.9558%)
_Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 827/1628 (50.7985%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.6603, Accuracy: 144/10000 (1.4400%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0624, Accuracy: 256/776 (32.9897%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0304, Accuracy: 410/776 (52.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.4270, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0724, Accuracy: 103/781 (13.1882%)
_Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 225/781 (28.8092%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.6894, Accuracy: 72/10000 (0.7200%)
time spent on training: 356.9583113193512
[rfa agg] training data poison_ratio: 0.1244553168717988  data num: [1275, 888, 1372, 1573, 1953, 1645, 1190, 1628, 776, 781]
[rfa agg] considering poison per batch poison_fraction: 0.038892286522437126
[rfa agg] init. name: [9, 63, 42, 40, 83, 13, 84, 5, 75, 3], weight: tensor([0.0975, 0.0679, 0.1049, 0.1203, 0.1493, 0.1258, 0.0910, 0.1245, 0.0593,
        0.0597])
[rfa agg] iter:  0, prev_obj_val: 49.01477813720703, obj_val: 52.78506088256836, abs dis: 3.770282745361328
[rfa agg] iter: 0, weight: tensor([0.3540, 0.0334, 0.1396, 0.0700, 0.0403, 0.0615, 0.1896, 0.0611, 0.0251,
        0.0253])
[rfa agg] iter:  1, prev_obj_val: 52.78506088256836, obj_val: 57.77804183959961, abs dis: 4.99298095703125
[rfa agg] iter: 1, weight: tensor([0.2629, 0.0422, 0.1044, 0.0620, 0.0390, 0.0559, 0.3162, 0.0555, 0.0308,
        0.0311])
[rfa agg] iter:  2, prev_obj_val: 57.77804183959961, obj_val: 57.77152633666992, abs dis: 0.0065155029296875
[rfa agg] iter: 2, weight: tensor([0.1891, 0.0682, 0.1042, 0.0696, 0.0470, 0.0640, 0.2979, 0.0635, 0.0481,
        0.0485])
			Update norm = 161.33794839946987 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3372, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.4530, Accuracy: 0/9950 (0.0000%)
saving model
Done in 597.5520324707031 sec.
Server Epoch:93 choose agents : [59, 28, 10, 95, 89, 1, 69, 50, 30, 17].
_Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 306/1089 (28.0992%)
_Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0286, Accuracy: 447/1089 (41.0468%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.1841, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   1, Avg loss: 0.0557, Accuracy: 391/1581 (24.7312%)
_Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 601/1581 (38.0139%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.8583, Accuracy: 97/10000 (0.9700%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   1, Avg loss: 0.0574, Accuracy: 206/861 (23.9257%)
_Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   2, Avg loss: 0.0210, Accuracy: 482/861 (55.9814%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.7975, Accuracy: 69/10000 (0.6900%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   1, Avg loss: 0.0444, Accuracy: 436/599 (72.7880%)
_Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   2, Avg loss: 0.0282, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.8006, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   1, Avg loss: 0.0600, Accuracy: 333/896 (37.1652%)
_Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   2, Avg loss: 0.0330, Accuracy: 438/896 (48.8839%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.8497, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 286/928 (30.8190%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0227, Accuracy: 608/928 (65.5172%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.6506, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   1, Avg loss: 0.0511, Accuracy: 325/590 (55.0847%)
_Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   2, Avg loss: 0.0309, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.8144, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   1, Avg loss: 0.0643, Accuracy: 137/809 (16.9345%)
_Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 350/809 (43.2633%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.3975, Accuracy: 81/10000 (0.8100%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   1, Avg loss: 0.0749, Accuracy: 106/486 (21.8107%)
_Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   2, Avg loss: 0.0390, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.6627, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   1, Avg loss: 0.0519, Accuracy: 402/1574 (25.5400%)
_Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 668/1574 (42.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.4217, Accuracy: 96/10000 (0.9600%)
time spent on training: 284.4173843860626
[rfa agg] training data poison_ratio: 0.2067353659832147  data num: [1089, 1581, 861, 599, 896, 928, 590, 809, 486, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.06460480186975459
[rfa agg] init. name: [59, 28, 10, 95, 89, 1, 69, 50, 30, 17], weight: tensor([0.1157, 0.1680, 0.0915, 0.0636, 0.0952, 0.0986, 0.0627, 0.0859, 0.0516,
        0.1672])
[rfa agg] iter:  0, prev_obj_val: 46.7609748840332, obj_val: 51.64743423461914, abs dis: 4.8864593505859375
[rfa agg] iter: 0, weight: tensor([0.0882, 0.0405, 0.1784, 0.0305, 0.1833, 0.2928, 0.0301, 0.0983, 0.0178,
        0.0402])
[rfa agg] iter:  1, prev_obj_val: 51.64743423461914, obj_val: 62.498779296875, abs dis: 10.85134506225586
[rfa agg] iter: 1, weight: tensor([0.0538, 0.0332, 0.1767, 0.0492, 0.1871, 0.1116, 0.0487, 0.2822, 0.0244,
        0.0330])
[rfa agg] iter:  2, prev_obj_val: 62.498779296875, obj_val: 65.3837661743164, abs dis: 2.8849868774414062
[rfa agg] iter: 2, weight: tensor([0.0563, 0.0413, 0.1026, 0.1812, 0.1067, 0.0833, 0.1864, 0.1428, 0.0585,
        0.0411])
[rfa agg] iter:  3, prev_obj_val: 65.3837661743164, obj_val: 72.19287109375, abs dis: 6.809104919433594
[rfa agg] iter: 3, weight: tensor([0.0444, 0.0336, 0.0744, 0.2495, 0.0775, 0.0626, 0.2691, 0.0965, 0.0591,
        0.0334])
[rfa agg] iter:  4, prev_obj_val: 72.19287109375, obj_val: 76.103515625, abs dis: 3.91064453125
[rfa agg] iter: 4, weight: tensor([0.0397, 0.0318, 0.0590, 0.2681, 0.0615, 0.0522, 0.2879, 0.0708, 0.0973,
        0.0317])
[rfa agg] iter:  5, prev_obj_val: 76.103515625, obj_val: 76.09881591796875, abs dis: 0.00469970703125
[rfa agg] iter: 5, weight: tensor([0.0470, 0.0386, 0.0665, 0.2120, 0.0693, 0.0599, 0.2153, 0.0777, 0.1753,
        0.0384])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3401, Accuracy: 39/10000 (0.3900%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.4703, Accuracy: 0/9950 (0.0000%)
saving model
Done in 537.1566822528839 sec.
Server Epoch:94 choose agents : [34, 35, 88, 8, 41, 2, 25, 18, 54, 79].
_Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   1, Avg loss: 0.0576, Accuracy: 396/1427 (27.7505%)
_Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 587/1427 (41.1352%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.2924, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.0878, Accuracy: 17/271 (6.2731%)
_Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0556, Accuracy: 117/271 (43.1734%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.7311, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   1, Avg loss: 0.0715, Accuracy: 157/603 (26.0365%)
_Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   2, Avg loss: 0.0438, Accuracy: 280/603 (46.4345%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.7661, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   1, Avg loss: 0.0590, Accuracy: 271/1513 (17.9114%)
_Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   2, Avg loss: 0.0361, Accuracy: 474/1513 (31.3285%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.5610, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   1, Avg loss: 0.0568, Accuracy: 347/719 (48.2615%)
_Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   2, Avg loss: 0.0307, Accuracy: 450/719 (62.5869%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.5724, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0606, Accuracy: 225/605 (37.1901%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0392, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.3824, Accuracy: 69/10000 (0.6900%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   1, Avg loss: 0.0541, Accuracy: 323/690 (46.8116%)
_Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.5258, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   1, Avg loss: 0.0728, Accuracy: 130/530 (24.5283%)
_Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   2, Avg loss: 0.0379, Accuracy: 261/530 (49.2453%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.2176, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0556, Accuracy: 341/1130 (30.1770%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 449/1130 (39.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.2481, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   1, Avg loss: 0.1025, Accuracy: 4/197 (2.0305%)
_Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   2, Avg loss: 0.0847, Accuracy: 56/197 (28.4264%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.4382, Accuracy: 50/10000 (0.5000%)
time spent on training: 235.10692286491394
[rfa agg] training data poison_ratio: 0.08978529603122967  data num: [1427, 271, 603, 1513, 719, 605, 690, 530, 1130, 197]
[rfa agg] considering poison per batch poison_fraction: 0.02805790500975927
[rfa agg] init. name: [34, 35, 88, 8, 41, 2, 25, 18, 54, 79], weight: tensor([0.1857, 0.0353, 0.0785, 0.1969, 0.0936, 0.0787, 0.0898, 0.0690, 0.1470,
        0.0256])
[rfa agg] iter:  0, prev_obj_val: 56.290931701660156, obj_val: 57.92585372924805, abs dis: 1.6349220275878906
[rfa agg] iter: 0, weight: tensor([0.0990, 0.0188, 0.0936, 0.0945, 0.2068, 0.0936, 0.1413, 0.0660, 0.1740,
        0.0123])
[rfa agg] iter:  1, prev_obj_val: 57.92585372924805, obj_val: 58.82176971435547, abs dis: 0.8959159851074219
[rfa agg] iter: 1, weight: tensor([0.0458, 0.0137, 0.1029, 0.0445, 0.3426, 0.1021, 0.2121, 0.0614, 0.0662,
        0.0087])
[rfa agg] iter:  2, prev_obj_val: 58.82176971435547, obj_val: 64.16096496582031, abs dis: 5.339195251464844
[rfa agg] iter: 2, weight: tensor([0.0380, 0.0128, 0.1148, 0.0371, 0.2798, 0.1142, 0.2792, 0.0631, 0.0530,
        0.0080])
[rfa agg] iter:  3, prev_obj_val: 64.16096496582031, obj_val: 64.02482604980469, abs dis: 0.136138916015625
[rfa agg] iter: 3, weight: tensor([0.0280, 0.0138, 0.2744, 0.0276, 0.0873, 0.2514, 0.1575, 0.1156, 0.0360,
        0.0084])
[rfa agg] iter:  4, prev_obj_val: 64.02482604980469, obj_val: 70.3017807006836, abs dis: 6.276954650878906
[rfa agg] iter: 4, weight: tensor([0.0243, 0.0120, 0.3231, 0.0239, 0.0735, 0.2689, 0.1340, 0.1020, 0.0312,
        0.0073])
[rfa agg] iter:  5, prev_obj_val: 70.3017807006836, obj_val: 73.91986083984375, abs dis: 3.6180801391601562
[rfa agg] iter: 5, weight: tensor([0.0339, 0.0224, 0.1874, 0.0335, 0.0768, 0.1813, 0.1106, 0.2994, 0.0417,
        0.0131])
[rfa agg] iter:  6, prev_obj_val: 73.91986083984375, obj_val: 73.91838073730469, abs dis: 0.0014801025390625
[rfa agg] iter: 6, weight: tensor([0.0400, 0.0312, 0.1563, 0.0397, 0.0813, 0.1539, 0.1097, 0.3220, 0.0483,
        0.0177])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3427, Accuracy: 35/10000 (0.3500%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.4727, Accuracy: 0/9950 (0.0000%)
saving model
Done in 482.697212934494 sec.
Server Epoch:95 choose agents : [66, 86, 64, 27, 37, 55, 33, 62, 57, 28].
_Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 258/1402 (18.4023%)
_Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 384/1402 (27.3894%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.8115, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   1, Avg loss: 0.0627, Accuracy: 351/1003 (34.9950%)
_Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 361/1003 (35.9920%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.2958, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 178/953 (18.6779%)
_Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   2, Avg loss: 0.0374, Accuracy: 324/953 (33.9979%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.1567, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 454/1587 (28.6074%)
_Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 611/1587 (38.5003%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.9565, Accuracy: 68/10000 (0.6800%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   1, Avg loss: 0.0533, Accuracy: 386/1129 (34.1895%)
_Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 722/1129 (63.9504%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.7218, Accuracy: 108/10000 (1.0800%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   1, Avg loss: 0.0541, Accuracy: 268/1071 (25.0233%)
_Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 523/1071 (48.8329%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.9988, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   1, Avg loss: 0.0780, Accuracy: 70/515 (13.5922%)
_Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   2, Avg loss: 0.0538, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.4273, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   1, Avg loss: 0.0646, Accuracy: 173/568 (30.4577%)
_Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   2, Avg loss: 0.0391, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.4091, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0540, Accuracy: 304/1154 (26.3432%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0266, Accuracy: 466/1154 (40.3813%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.7172, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 379/1581 (23.9722%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 619/1581 (39.1524%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.2549, Accuracy: 87/10000 (0.8700%)
time spent on training: 332.3191993236542
[rfa agg] training data poison_ratio: 0.2006749977196023  data num: [1402, 1003, 953, 1587, 1129, 1071, 515, 568, 1154, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.06271093678737572
[rfa agg] init. name: [66, 86, 64, 27, 37, 55, 33, 62, 57, 28], weight: tensor([0.1279, 0.0915, 0.0869, 0.1448, 0.1030, 0.0977, 0.0470, 0.0518, 0.1053,
        0.1442])
[rfa agg] iter:  0, prev_obj_val: 42.226097106933594, obj_val: 46.706546783447266, abs dis: 4.480449676513672
[rfa agg] iter: 0, weight: tensor([0.0552, 0.2344, 0.1244, 0.0406, 0.1352, 0.2438, 0.0150, 0.0165, 0.0944,
        0.0404])
[rfa agg] iter:  1, prev_obj_val: 46.706546783447266, obj_val: 52.7618522644043, abs dis: 6.055305480957031
[rfa agg] iter: 1, weight: tensor([0.0486, 0.2770, 0.2464, 0.0378, 0.0953, 0.1475, 0.0179, 0.0198, 0.0721,
        0.0375])
[rfa agg] iter:  2, prev_obj_val: 52.7618522644043, obj_val: 52.74388885498047, abs dis: 0.017963409423828125
[rfa agg] iter: 2, weight: tensor([0.0533, 0.1785, 0.3480, 0.0432, 0.0886, 0.1173, 0.0267, 0.0294, 0.0719,
        0.0430])
[rfa agg] iter:  3, prev_obj_val: 52.74388885498047, obj_val: 49.50758361816406, abs dis: 3.2363052368164062
[rfa agg] iter: 3, weight: tensor([0.0519, 0.1706, 0.3688, 0.0421, 0.0862, 0.1138, 0.0260, 0.0287, 0.0700,
        0.0419])
[rfa agg] iter:  4, prev_obj_val: 49.50758361816406, obj_val: 59.68994140625, abs dis: 10.182357788085938
[rfa agg] iter: 4, weight: tensor([0.0438, 0.1828, 0.4157, 0.0348, 0.0780, 0.1090, 0.0188, 0.0207, 0.0617,
        0.0346])
[rfa agg] iter:  5, prev_obj_val: 59.68994140625, obj_val: 56.17646026611328, abs dis: 3.5134811401367188
[rfa agg] iter: 5, weight: tensor([0.0678, 0.1602, 0.2509, 0.0569, 0.1008, 0.1230, 0.0467, 0.0516, 0.0854,
        0.0566])
[rfa agg] iter:  6, prev_obj_val: 56.17646026611328, obj_val: 52.74912643432617, abs dis: 3.4273338317871094
[rfa agg] iter: 6, weight: tensor([0.0620, 0.1686, 0.2908, 0.0511, 0.0971, 0.1227, 0.0363, 0.0401, 0.0806,
        0.0508])
[rfa agg] iter:  7, prev_obj_val: 52.74912643432617, obj_val: 52.74357223510742, abs dis: 0.00555419921875
[rfa agg] iter: 7, weight: tensor([0.0528, 0.1731, 0.3582, 0.0428, 0.0878, 0.1159, 0.0264, 0.0292, 0.0713,
        0.0425])
[rfa agg] iter:  8, prev_obj_val: 52.74357223510742, obj_val: 49.507381439208984, abs dis: 3.2361907958984375
[rfa agg] iter: 8, weight: tensor([0.0518, 0.1700, 0.3708, 0.0420, 0.0859, 0.1134, 0.0259, 0.0286, 0.0699,
        0.0417])
[rfa agg] iter:  9, prev_obj_val: 49.507381439208984, obj_val: 59.690093994140625, abs dis: 10.18271255493164
[rfa agg] iter: 9, weight: tensor([0.0438, 0.1825, 0.4165, 0.0348, 0.0779, 0.1088, 0.0188, 0.0207, 0.0617,
        0.0346])
			Update norm = 121.0727239810334 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3427, Accuracy: 35/10000 (0.3500%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.4727, Accuracy: 0/9950 (0.0000%)
saving model
Done in 578.73459649086 sec.
Server Epoch:96 choose agents : [6, 3, 92, 4, 1, 12, 48, 2, 69, 13].
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0547, Accuracy: 375/1956 (19.1718%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 667/1956 (34.1002%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.1685, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0724, Accuracy: 102/781 (13.0602%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0353, Accuracy: 243/781 (31.1140%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.6293, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   1, Avg loss: 0.0528, Accuracy: 442/1715 (25.7726%)
_Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 714/1715 (41.6327%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.8940, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0601, Accuracy: 332/901 (36.8479%)
_Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0316, Accuracy: 390/901 (43.2852%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.1829, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0558, Accuracy: 297/928 (32.0043%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0231, Accuracy: 591/928 (63.6853%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.1516, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0877, Accuracy: 16/338 (4.7337%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0453, Accuracy: 158/338 (46.7456%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.9650, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   1, Avg loss: 0.0701, Accuracy: 109/631 (17.2742%)
_Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   2, Avg loss: 0.0416, Accuracy: 221/631 (35.0238%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.5783, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0604, Accuracy: 244/605 (40.3306%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.4436, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   1, Avg loss: 0.0515, Accuracy: 339/590 (57.4576%)
_Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   2, Avg loss: 0.0299, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.5627, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   1, Avg loss: 0.0567, Accuracy: 337/1645 (20.4863%)
_Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 666/1645 (40.4863%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.2795, Accuracy: 128/10000 (1.2800%)
time spent on training: 259.14641666412354
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 781, 1715, 901, 928, 338, 631, 605, 590, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 3, 92, 4, 1, 12, 48, 2, 69, 13], weight: tensor([0.1939, 0.0774, 0.1700, 0.0893, 0.0920, 0.0335, 0.0625, 0.0600, 0.0585,
        0.1630])
[rfa agg] iter:  0, prev_obj_val: 72.7630386352539, obj_val: 74.12722778320312, abs dis: 1.3641891479492188
[rfa agg] iter: 0, weight: tensor([0.1150, 0.0914, 0.1508, 0.1555, 0.1605, 0.0184, 0.0495, 0.0475, 0.0463,
        0.1650])
[rfa agg] iter:  1, prev_obj_val: 74.12722778320312, obj_val: 78.73823547363281, abs dis: 4.6110076904296875
[rfa agg] iter: 1, weight: tensor([0.0649, 0.1053, 0.0784, 0.2538, 0.2642, 0.0155, 0.0466, 0.0447, 0.0436,
        0.0831])
[rfa agg] iter:  2, prev_obj_val: 78.73823547363281, obj_val: 82.60946655273438, abs dis: 3.8712310791015625
[rfa agg] iter: 2, weight: tensor([0.0381, 0.2092, 0.0437, 0.2440, 0.2560, 0.0140, 0.0517, 0.0495, 0.0485,
        0.0454])
[rfa agg] iter:  3, prev_obj_val: 82.60946655273438, obj_val: 80.55113220214844, abs dis: 2.0583343505859375
[rfa agg] iter: 3, weight: tensor([0.0354, 0.3920, 0.0398, 0.1383, 0.1434, 0.0157, 0.0671, 0.0642, 0.0630,
        0.0411])
[rfa agg] iter:  4, prev_obj_val: 80.55113220214844, obj_val: 78.7488021850586, abs dis: 1.8023300170898438
[rfa agg] iter: 4, weight: tensor([0.0355, 0.3634, 0.0403, 0.1668, 0.1740, 0.0143, 0.0566, 0.0543, 0.0530,
        0.0418])
[rfa agg] iter:  5, prev_obj_val: 78.7488021850586, obj_val: 82.59793853759766, abs dis: 3.8491363525390625
[rfa agg] iter: 5, weight: tensor([0.0381, 0.2317, 0.0437, 0.2324, 0.2449, 0.0140, 0.0518, 0.0496, 0.0485,
        0.0453])
[rfa agg] iter:  6, prev_obj_val: 82.59793853759766, obj_val: 80.55179595947266, abs dis: 2.046142578125
[rfa agg] iter: 6, weight: tensor([0.0349, 0.4001, 0.0393, 0.1362, 0.1413, 0.0155, 0.0663, 0.0634, 0.0622,
        0.0406])
[rfa agg] iter:  7, prev_obj_val: 80.55179595947266, obj_val: 80.54747009277344, abs dis: 0.00432586669921875
[rfa agg] iter: 7, weight: tensor([0.0354, 0.3650, 0.0402, 0.1663, 0.1735, 0.0143, 0.0565, 0.0542, 0.0529,
        0.0417])
[rfa agg] iter:  8, prev_obj_val: 80.54747009277344, obj_val: 78.74624633789062, abs dis: 1.8012237548828125
[rfa agg] iter: 8, weight: tensor([0.0358, 0.3544, 0.0407, 0.1699, 0.1772, 0.0145, 0.0571, 0.0547, 0.0535,
        0.0421])
[rfa agg] iter:  9, prev_obj_val: 78.74624633789062, obj_val: 82.59834289550781, abs dis: 3.8520965576171875
[rfa agg] iter: 9, weight: tensor([0.0381, 0.2309, 0.0436, 0.2329, 0.2453, 0.0140, 0.0518, 0.0496, 0.0485,
        0.0453])
			Update norm = 116.5587298317891 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3427, Accuracy: 35/10000 (0.3500%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.4727, Accuracy: 0/9950 (0.0000%)
saving model
Done in 506.1032738685608 sec.
Server Epoch:97 choose agents : [34, 90, 11, 2, 35, 50, 85, 72, 3, 18].
_Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0583, Accuracy: 374/1427 (26.2088%)
_Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0328, Accuracy: 574/1427 (40.2242%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.4218, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   1, Avg loss: 0.0516, Accuracy: 350/677 (51.6987%)
_Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 435/677 (64.2541%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.4145, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   1, Avg loss: 0.0533, Accuracy: 355/712 (49.8596%)
_Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   2, Avg loss: 0.0248, Accuracy: 409/712 (57.4438%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.6479, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0605, Accuracy: 239/605 (39.5041%)
_Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0382, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.3781, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0874, Accuracy: 25/271 (9.2251%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0547, Accuracy: 129/271 (47.6015%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.7085, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   1, Avg loss: 0.0634, Accuracy: 161/809 (19.9011%)
_Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 372/809 (45.9827%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.6500, Accuracy: 101/10000 (1.0100%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   1, Avg loss: 0.0545, Accuracy: 479/1988 (24.0946%)
_Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 675/1988 (33.9537%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.4748, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0602, Accuracy: 268/1241 (21.5955%)
_Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 408/1241 (32.8767%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.7760, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0715, Accuracy: 115/781 (14.7247%)
_Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0356, Accuracy: 233/781 (29.8335%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.7587, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   1, Avg loss: 0.0705, Accuracy: 141/530 (26.6038%)
_Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   2, Avg loss: 0.0364, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.5597, Accuracy: 74/10000 (0.7400%)
time spent on training: 253.92916750907898
[rfa agg] training data poison_ratio: 0.21988718062161267  data num: [1427, 677, 712, 605, 271, 809, 1988, 1241, 781, 530]
[rfa agg] considering poison per batch poison_fraction: 0.06871474394425396
[rfa agg] init. name: [34, 90, 11, 2, 35, 50, 85, 72, 3, 18], weight: tensor([0.1578, 0.0749, 0.0788, 0.0669, 0.0300, 0.0895, 0.2199, 0.1373, 0.0864,
        0.0586])
[rfa agg] iter:  0, prev_obj_val: 67.60997009277344, obj_val: 68.00105285644531, abs dis: 0.391082763671875
[rfa agg] iter: 0, weight: tensor([0.1482, 0.0709, 0.0892, 0.0544, 0.0142, 0.1255, 0.0835, 0.2513, 0.1211,
        0.0417])
[rfa agg] iter:  1, prev_obj_val: 68.00105285644531, obj_val: 69.62139892578125, abs dis: 1.6203460693359375
[rfa agg] iter: 1, weight: tensor([0.1073, 0.0848, 0.1138, 0.0622, 0.0147, 0.1772, 0.0684, 0.1549, 0.1706,
        0.0462])
[rfa agg] iter:  2, prev_obj_val: 69.62139892578125, obj_val: 80.28368377685547, abs dis: 10.662284851074219
[rfa agg] iter: 2, weight: tensor([0.0341, 0.0781, 0.1466, 0.0476, 0.0081, 0.3019, 0.0251, 0.0423, 0.2848,
        0.0315])
[rfa agg] iter:  3, prev_obj_val: 80.28368377685547, obj_val: 83.32733154296875, abs dis: 3.0436477661132812
[rfa agg] iter: 3, weight: tensor([0.0333, 0.2504, 0.1287, 0.2312, 0.0143, 0.0924, 0.0270, 0.0380, 0.0891,
        0.0957])
[rfa agg] iter:  4, prev_obj_val: 83.32733154296875, obj_val: 86.82264709472656, abs dis: 3.4953155517578125
[rfa agg] iter: 4, weight: tensor([0.0297, 0.1679, 0.0928, 0.3679, 0.0146, 0.0712, 0.0245, 0.0335, 0.0689,
        0.1290])
[rfa agg] iter:  5, prev_obj_val: 86.82264709472656, obj_val: 86.81594848632812, abs dis: 0.0066986083984375
[rfa agg] iter: 5, weight: tensor([0.0322, 0.1310, 0.0846, 0.3004, 0.0183, 0.0693, 0.0270, 0.0360, 0.0670,
        0.2340])
[rfa agg] iter:  6, prev_obj_val: 86.81594848632812, obj_val: 90.55573272705078, abs dis: 3.7397842407226562
[rfa agg] iter: 6, weight: tensor([0.0321, 0.1304, 0.0843, 0.2898, 0.0183, 0.0690, 0.0269, 0.0359, 0.0668,
        0.2466])
[rfa agg] iter:  7, prev_obj_val: 90.55573272705078, obj_val: 90.53743743896484, abs dis: 0.0182952880859375
[rfa agg] iter: 7, weight: tensor([0.0322, 0.1041, 0.0737, 0.1781, 0.0213, 0.0631, 0.0274, 0.0356, 0.0610,
        0.4035])
[rfa agg] iter:  8, prev_obj_val: 90.53743743896484, obj_val: 86.83673095703125, abs dis: 3.7007064819335938
[rfa agg] iter: 8, weight: tensor([0.0293, 0.0945, 0.0669, 0.1579, 0.0194, 0.0573, 0.0249, 0.0324, 0.0554,
        0.4620])
[rfa agg] iter:  9, prev_obj_val: 86.83673095703125, obj_val: 90.55067443847656, abs dis: 3.7139434814453125
[rfa agg] iter: 9, weight: tensor([0.0319, 0.1293, 0.0837, 0.2635, 0.0182, 0.0684, 0.0268, 0.0357, 0.0663,
        0.2761])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3457, Accuracy: 30/10000 (0.3000%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.4945, Accuracy: 0/9950 (0.0000%)
saving model
Done in 503.014684677124 sec.
Server Epoch:98 choose agents : [7, 45, 42, 97, 87, 98, 9, 32, 48, 31].
_Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   1, Avg loss: 0.0529, Accuracy: 364/891 (40.8530%)
_Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 429/891 (48.1481%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.7202, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   1, Avg loss: 0.0608, Accuracy: 246/669 (36.7713%)
_Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   2, Avg loss: 0.0370, Accuracy: 360/669 (53.8117%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.2019, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 323/1372 (23.5423%)
_Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 510/1372 (37.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.2042, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   1, Avg loss: 0.0501, Accuracy: 352/1213 (29.0190%)
_Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   2, Avg loss: 0.0269, Accuracy: 509/1213 (41.9621%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.9658, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0592, Accuracy: 301/1131 (26.6136%)
_Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0322, Accuracy: 377/1131 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.4347, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   1, Avg loss: 0.0760, Accuracy: 62/373 (16.6220%)
_Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   2, Avg loss: 0.0452, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.9879, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   1, Avg loss: 0.0504, Accuracy: 357/1275 (28.0000%)
_Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 700/1275 (54.9020%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.1595, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0601, Accuracy: 198/735 (26.9388%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 374/735 (50.8844%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.0334, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   1, Avg loss: 0.0700, Accuracy: 110/631 (17.4326%)
_Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   2, Avg loss: 0.0404, Accuracy: 221/631 (35.0238%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.5384, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   1, Avg loss: 0.0817, Accuracy: 66/460 (14.3478%)
_Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.8723, Accuracy: 50/10000 (0.5000%)
time spent on training: 270.29605746269226
[rfa agg] training data poison_ratio: 0.0  data num: [891, 669, 1372, 1213, 1131, 373, 1275, 735, 631, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 45, 42, 97, 87, 98, 9, 32, 48, 31], weight: tensor([0.1018, 0.0765, 0.1568, 0.1386, 0.1293, 0.0426, 0.1457, 0.0840, 0.0721,
        0.0526])
[rfa agg] iter:  0, prev_obj_val: 45.76959228515625, obj_val: 51.15381622314453, abs dis: 5.384223937988281
[rfa agg] iter: 0, weight: tensor([0.2540, 0.1164, 0.0553, 0.0730, 0.0811, 0.0194, 0.0659, 0.2263, 0.0753,
        0.0333])
[rfa agg] iter:  1, prev_obj_val: 51.15381622314453, obj_val: 59.408546447753906, abs dis: 8.254730224609375
[rfa agg] iter: 1, weight: tensor([0.1015, 0.2487, 0.0382, 0.0472, 0.0505, 0.0198, 0.0438, 0.2975, 0.1149,
        0.0381])
[rfa agg] iter:  2, prev_obj_val: 59.408546447753906, obj_val: 62.73805236816406, abs dis: 3.3295059204101562
[rfa agg] iter: 2, weight: tensor([0.0694, 0.1878, 0.0361, 0.0425, 0.0445, 0.0294, 0.0403, 0.1132, 0.3664,
        0.0703])
[rfa agg] iter:  3, prev_obj_val: 62.73805236816406, obj_val: 66.29499053955078, abs dis: 3.5569381713867188
[rfa agg] iter: 3, weight: tensor([0.0696, 0.1496, 0.0391, 0.0454, 0.0472, 0.0379, 0.0432, 0.1020, 0.3618,
        0.1042])
[rfa agg] iter:  4, prev_obj_val: 66.29499053955078, obj_val: 66.29070281982422, abs dis: 0.0042877197265625
[rfa agg] iter: 4, weight: tensor([0.0753, 0.1376, 0.0450, 0.0517, 0.0534, 0.0528, 0.0494, 0.1027, 0.2538,
        0.1783])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3487, Accuracy: 35/10000 (0.3500%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.4593, Accuracy: 0/9950 (0.0000%)
saving model
Done in 526.0172972679138 sec.
Server Epoch:99 choose agents : [64, 82, 67, 73, 95, 84, 19, 29, 39, 26].
_Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   1, Avg loss: 0.0635, Accuracy: 182/953 (19.0976%)
_Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 322/953 (33.7880%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.2226, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1, Avg loss: 0.0713, Accuracy: 101/500 (20.2000%)
_Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2, Avg loss: 0.0471, Accuracy: 185/500 (37.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.4292, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   1, Avg loss: 0.0745, Accuracy: 64/426 (15.0235%)
_Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   2, Avg loss: 0.0390, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.5951, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   1, Avg loss: 0.0653, Accuracy: 177/938 (18.8699%)
_Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   2, Avg loss: 0.0323, Accuracy: 369/938 (39.3390%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.3922, Accuracy: 73/10000 (0.7300%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0437, Accuracy: 428/599 (71.4524%)
_Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0259, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.1907, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 321/1190 (26.9748%)
_Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   2, Avg loss: 0.0317, Accuracy: 491/1190 (41.2605%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.3082, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   1, Avg loss: 0.0469, Accuracy: 405/1036 (39.0927%)
_Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   2, Avg loss: 0.0241, Accuracy: 666/1036 (64.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 11.2818, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   1, Avg loss: 0.0498, Accuracy: 392/1440 (27.2222%)
_Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   2, Avg loss: 0.0275, Accuracy: 692/1440 (48.0556%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.3997, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 306/1013 (30.2073%)
_Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 503/1013 (49.6545%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.0499, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 362/1446 (25.0346%)
_Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 471/1446 (32.5726%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.6520, Accuracy: 60/10000 (0.6000%)
time spent on training: 273.2222876548767
[rfa agg] training data poison_ratio: 0.06278167906927995  data num: [953, 500, 426, 938, 599, 1190, 1036, 1440, 1013, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.019619274709149984
[rfa agg] init. name: [64, 82, 67, 73, 95, 84, 19, 29, 39, 26], weight: tensor([0.0999, 0.0524, 0.0446, 0.0983, 0.0628, 0.1247, 0.1086, 0.1509, 0.1062,
        0.1516])
[rfa agg] iter:  0, prev_obj_val: 48.251426696777344, obj_val: 48.2087287902832, abs dis: 0.042697906494140625
[rfa agg] iter: 0, weight: tensor([0.2121, 0.0344, 0.0249, 0.2123, 0.0641, 0.0810, 0.1095, 0.0574, 0.1466,
        0.0577])
			Update norm = 120.95535640139093 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3487, Accuracy: 35/10000 (0.3500%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.4593, Accuracy: 0/9950 (0.0000%)
saving model
Done in 519.2417294979095 sec.
Server Epoch:100 choose agents : [68, 28, 58, 41, 78, 29, 94, 45, 73, 15].
_Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   1, Avg loss: 0.0616, Accuracy: 372/1163 (31.9862%)
_Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   2, Avg loss: 0.0368, Accuracy: 425/1163 (36.5434%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.4188, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   1, Avg loss: 0.0557, Accuracy: 400/1581 (25.3004%)
_Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 615/1581 (38.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7486, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0586, Accuracy: 336/803 (41.8431%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0349, Accuracy: 402/803 (50.0623%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.5057, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   1, Avg loss: 0.0559, Accuracy: 337/719 (46.8707%)
_Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   2, Avg loss: 0.0306, Accuracy: 458/719 (63.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.4521, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   1, Avg loss: 0.0796, Accuracy: 63/416 (15.1442%)
_Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   2, Avg loss: 0.0442, Accuracy: 181/416 (43.5096%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.6973, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   1, Avg loss: 0.0506, Accuracy: 392/1440 (27.2222%)
_Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 678/1440 (47.0833%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.2880, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 342/1662 (20.5776%)
_Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 623/1662 (37.4850%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.0654, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   1, Avg loss: 0.0606, Accuracy: 255/669 (38.1166%)
_Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   2, Avg loss: 0.0369, Accuracy: 359/669 (53.6622%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.1949, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   1, Avg loss: 0.0660, Accuracy: 177/938 (18.8699%)
_Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   2, Avg loss: 0.0333, Accuracy: 325/938 (34.6482%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.5858, Accuracy: 60/10000 (0.6000%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   1, Avg loss: 0.0562, Accuracy: 337/1154 (29.2028%)
_Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   2, Avg loss: 0.0286, Accuracy: 450/1154 (38.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.2637, Accuracy: 66/10000 (0.6600%)
time spent on training: 283.7156538963318
[rfa agg] training data poison_ratio: 0.1094357515410147  data num: [1163, 1581, 803, 719, 416, 1440, 1662, 669, 938, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.034198672356567095
[rfa agg] init. name: [68, 28, 58, 41, 78, 29, 94, 45, 73, 15], weight: tensor([0.1103, 0.1499, 0.0761, 0.0682, 0.0394, 0.1366, 0.1576, 0.0634, 0.0890,
        0.1094])
[rfa agg] iter:  0, prev_obj_val: 49.778499603271484, obj_val: 54.17464065551758, abs dis: 4.396141052246094
[rfa agg] iter: 0, weight: tensor([0.2069, 0.0752, 0.0759, 0.0544, 0.0159, 0.0909, 0.0703, 0.0425, 0.1702,
        0.1977])
[rfa agg] iter:  1, prev_obj_val: 54.17464065551758, obj_val: 57.8298225402832, abs dis: 3.655181884765625
[rfa agg] iter: 1, weight: tensor([0.1079, 0.0548, 0.1029, 0.0662, 0.0162, 0.0631, 0.0521, 0.0487, 0.3823,
        0.1059])
[rfa agg] iter:  2, prev_obj_val: 57.8298225402832, obj_val: 62.38602066040039, abs dis: 4.5561981201171875
[rfa agg] iter: 2, weight: tensor([0.0757, 0.0446, 0.1466, 0.0815, 0.0164, 0.0501, 0.0428, 0.0560, 0.4119,
        0.0745])
[rfa agg] iter:  3, prev_obj_val: 62.38602066040039, obj_val: 62.328826904296875, abs dis: 0.057193756103515625
[rfa agg] iter: 3, weight: tensor([0.0653, 0.0428, 0.3173, 0.1327, 0.0199, 0.0471, 0.0414, 0.0812, 0.1878,
        0.0644])
[rfa agg] iter:  4, prev_obj_val: 62.328826904296875, obj_val: 60.05531692504883, abs dis: 2.273509979248047
[rfa agg] iter: 4, weight: tensor([0.0624, 0.0408, 0.3524, 0.1289, 0.0190, 0.0449, 0.0395, 0.0778, 0.1729,
        0.0614])
[rfa agg] iter:  5, prev_obj_val: 60.05531692504883, obj_val: 64.81825256347656, abs dis: 4.762935638427734
[rfa agg] iter: 5, weight: tensor([0.0754, 0.0470, 0.2418, 0.1111, 0.0195, 0.0522, 0.0453, 0.0719, 0.2617,
        0.0742])
[rfa agg] iter:  6, prev_obj_val: 64.81825256347656, obj_val: 77.69075775146484, abs dis: 12.872505187988281
[rfa agg] iter: 6, weight: tensor([0.0512, 0.0350, 0.4120, 0.1542, 0.0184, 0.0382, 0.0340, 0.0857, 0.1207,
        0.0505])
[rfa agg] iter:  7, prev_obj_val: 77.69075775146484, obj_val: 77.60528564453125, abs dis: 0.08547210693359375
[rfa agg] iter: 7, weight: tensor([0.0465, 0.0362, 0.1267, 0.1888, 0.0331, 0.0384, 0.0355, 0.3744, 0.0744,
        0.0460])
[rfa agg] iter:  8, prev_obj_val: 77.60528564453125, obj_val: 81.51774597167969, abs dis: 3.9124603271484375
[rfa agg] iter: 8, weight: tensor([0.0396, 0.0308, 0.1057, 0.1643, 0.0282, 0.0327, 0.0303, 0.4659, 0.0633,
        0.0391])
[rfa agg] iter:  9, prev_obj_val: 81.51774597167969, obj_val: 85.56001281738281, abs dis: 4.042266845703125
[rfa agg] iter: 9, weight: tensor([0.0489, 0.0391, 0.1123, 0.1565, 0.0422, 0.0412, 0.0384, 0.3990, 0.0740,
        0.0484])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3523, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.4413, Accuracy: 0/9950 (0.0000%)
saving model
Done in 528.8580501079559 sec.
Saving all the graphs.
This run has a label: Jun.29_22.04.52. Visdom environment: tiny
