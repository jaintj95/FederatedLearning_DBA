current path: saved_models/model_tiny_Jun.12_14.23.19
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 3, 5, 9, 10, 12, 15, 18, 20, 24, 25, 30, 33, 36, 37, 42, 44, 48, 49, 54, 55, 60, 61, 65, 69, 72, 74, 78, 81, 84, 85, 95]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [37, 44, 94, 74, 82, 83, 41, 65, 26, 24].
poison local model 37 index 14 
___Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   1, Avg loss: 0.0529, Accuracy: 387/1129 (34.2781%)
___Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 720/1129 (63.7733%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 8.0715, Accuracy: 83/10000 (0.8300%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0597, Accuracy: 397/1750 (22.6857%)
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 638/1750 (36.4571%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.5240, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 350/1662 (21.0590%)
___Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 603/1662 (36.2816%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.9966, Accuracy: 109/10000 (1.0900%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 512/1552 (32.9897%)
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 775/1552 (49.9356%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 10.5310, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 56/500 (11.2000%)
___Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 171/500 (34.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.5980, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0548, Accuracy: 404/1953 (20.6861%)
___Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 763/1953 (39.0681%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.8441, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   1, Avg loss: 0.0631, Accuracy: 318/719 (44.2281%)
___Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   2, Avg loss: 0.0305, Accuracy: 439/719 (61.0570%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.1281, Accuracy: 54/10000 (0.5400%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0575, Accuracy: 383/1475 (25.9661%)
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0303, Accuracy: 709/1475 (48.0678%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.8826, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 327/1446 (22.6141%)
___Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 482/1446 (33.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.9891, Accuracy: 56/10000 (0.5600%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 28/312 (8.9744%)
___Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 166/312 (53.2051%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3863, Accuracy: 50/10000 (0.5000%)
time spent on training: 140.29631638526917
___Test Target_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3078, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 1: Avg loss: 5.3774, Accuracy: 0/9950 (0.0000%)
saving model
Done in 552.5655748844147 sec.
Server Epoch:2 choose agents : [94, 71, 66, 35, 38, 84, 42, 43, 11, 95].
___Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   1, Avg loss: 0.0545, Accuracy: 345/1662 (20.7581%)
___Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 611/1662 (36.7629%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.8405, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   1, Avg loss: 0.0670, Accuracy: 146/818 (17.8484%)
___Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 350/818 (42.7873%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.9974, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   1, Avg loss: 0.0627, Accuracy: 237/1402 (16.9044%)
___Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   2, Avg loss: 0.0391, Accuracy: 345/1402 (24.6077%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.1623, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   1, Avg loss: 0.0880, Accuracy: 27/271 (9.9631%)
___Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   2, Avg loss: 0.0596, Accuracy: 98/271 (36.1624%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3857, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   1, Avg loss: 0.0634, Accuracy: 234/1131 (20.6897%)
___Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   2, Avg loss: 0.0317, Accuracy: 484/1131 (42.7940%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.1669, Accuracy: 83/10000 (0.8300%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0640, Accuracy: 308/1190 (25.8824%)
___Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 449/1190 (37.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.4484, Accuracy: 52/10000 (0.5200%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 331/1372 (24.1254%)
___Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 494/1372 (36.0058%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.8672, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0613, Accuracy: 297/946 (31.3953%)
___Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0366, Accuracy: 341/946 (36.0465%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.1166, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   1, Avg loss: 0.0571, Accuracy: 305/712 (42.8371%)
___Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   2, Avg loss: 0.0290, Accuracy: 436/712 (61.2360%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.8892, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   1, Avg loss: 0.0542, Accuracy: 291/599 (48.5810%)
___Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   2, Avg loss: 0.0306, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 8.0057, Accuracy: 50/10000 (0.5000%)
time spent on training: 138.1766755580902
___Test Target_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3221, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 2: Avg loss: 5.3783, Accuracy: 0/9950 (0.0000%)
saving model
Done in 547.7875893115997 sec.
Server Epoch:3 choose agents : [15, 88, 13, 42, 72, 22, 6, 0, 69, 17].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0581, Accuracy: 315/1154 (27.2964%)
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0304, Accuracy: 413/1154 (35.7886%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.1397, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   1, Avg loss: 0.0767, Accuracy: 123/603 (20.3980%)
___Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   2, Avg loss: 0.0458, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.0236, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0592, Accuracy: 309/1645 (18.7842%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0336, Accuracy: 600/1645 (36.4742%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.9538, Accuracy: 89/10000 (0.8900%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   1, Avg loss: 0.0539, Accuracy: 310/1372 (22.5948%)
___Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   2, Avg loss: 0.0319, Accuracy: 450/1372 (32.7988%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.7442, Accuracy: 72/10000 (0.7200%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   1, Avg loss: 0.0606, Accuracy: 240/1241 (19.3392%)
___Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 403/1241 (32.4738%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.2024, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 481/1470 (32.7211%)
___Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   2, Avg loss: 0.0243, Accuracy: 825/1470 (56.1224%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.0520, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   1, Avg loss: 0.0564, Accuracy: 386/1956 (19.7342%)
___Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 637/1956 (32.5665%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.5607, Accuracy: 108/10000 (1.0800%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0585, Accuracy: 361/1657 (21.7864%)
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0355, Accuracy: 496/1657 (29.9336%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.7494, Accuracy: 53/10000 (0.5300%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0544, Accuracy: 284/590 (48.1356%)
___Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0302, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.3530, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0521, Accuracy: 375/1574 (23.8247%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0287, Accuracy: 642/1574 (40.7878%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.1939, Accuracy: 101/10000 (1.0100%)
time spent on training: 169.70666480064392
___Test Target_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3273, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 3: Avg loss: 5.4095, Accuracy: 0/9950 (0.0000%)
saving model
Done in 591.8829455375671 sec.
Server Epoch:4 choose agents : [31, 94, 47, 15, 11, 35, 62, 77, 21, 93].
___Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0801, Accuracy: 57/460 (12.3913%)
___Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 186/460 (40.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.1954, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 331/1662 (19.9158%)
___Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   2, Avg loss: 0.0336, Accuracy: 602/1662 (36.2214%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.2670, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   1, Avg loss: 0.1275, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   2, Avg loss: 0.1118, Accuracy: 2/134 (1.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3445, Accuracy: 52/10000 (0.5200%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 310/1154 (26.8631%)
___Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   2, Avg loss: 0.0314, Accuracy: 431/1154 (37.3484%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.0476, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   1, Avg loss: 0.0560, Accuracy: 291/712 (40.8708%)
___Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 409/712 (57.4438%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.9213, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   1, Avg loss: 0.0853, Accuracy: 27/271 (9.9631%)
___Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   2, Avg loss: 0.0557, Accuracy: 97/271 (35.7934%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.4505, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0726, Accuracy: 99/568 (17.4296%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0426, Accuracy: 263/568 (46.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.9145, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0535, Accuracy: 338/1340 (25.2239%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 535/1340 (39.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.7696, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0544, Accuracy: 393/1949 (20.1642%)
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 627/1949 (32.1703%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 8.1983, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   1, Avg loss: 0.0584, Accuracy: 368/1742 (21.1251%)
___Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   2, Avg loss: 0.0323, Accuracy: 714/1742 (40.9874%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.7688, Accuracy: 92/10000 (0.9200%)
time spent on training: 123.77335119247437
___Test Target_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3667, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 4: Avg loss: 5.4679, Accuracy: 0/9950 (0.0000%)
saving model
Done in 554.4237322807312 sec.
Server Epoch:5 choose agents : [91, 78, 82, 2, 77, 31, 70, 65, 60, 36].
___Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0508, Accuracy: 333/1030 (32.3301%)
___Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0257, Accuracy: 629/1030 (61.0680%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.6296, Accuracy: 78/10000 (0.7800%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   1, Avg loss: 0.0820, Accuracy: 32/416 (7.6923%)
___Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   2, Avg loss: 0.0472, Accuracy: 172/416 (41.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.9501, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0750, Accuracy: 64/500 (12.8000%)
___Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 174/500 (34.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.1383, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0630, Accuracy: 213/605 (35.2066%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0392, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.1427, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   1, Avg loss: 0.0530, Accuracy: 341/1340 (25.4478%)
___Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   2, Avg loss: 0.0265, Accuracy: 581/1340 (43.3582%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.8844, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   1, Avg loss: 0.0786, Accuracy: 56/460 (12.1739%)
___Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   2, Avg loss: 0.0352, Accuracy: 191/460 (41.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.5389, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   1, Avg loss: 0.0574, Accuracy: 303/1418 (21.3681%)
___Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   2, Avg loss: 0.0316, Accuracy: 655/1418 (46.1918%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.0071, Accuracy: 92/10000 (0.9200%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   1, Avg loss: 0.0607, Accuracy: 344/1475 (23.3220%)
___Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   2, Avg loss: 0.0326, Accuracy: 653/1475 (44.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.9402, Accuracy: 91/10000 (0.9100%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   1, Avg loss: 0.0507, Accuracy: 575/2227 (25.8195%)
___Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1032/2227 (46.3404%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.3593, Accuracy: 118/10000 (1.1800%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   1, Avg loss: 0.0942, Accuracy: 25/408 (6.1275%)
___Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   2, Avg loss: 0.0584, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.8406, Accuracy: 50/10000 (0.5000%)
time spent on training: 153.85165548324585
___Test Target_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3951, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 5: Avg loss: 5.5309, Accuracy: 0/9950 (0.0000%)
saving model
Done in 566.9828281402588 sec.
Server Epoch:6 choose agents : [63, 42, 69, 72, 83, 44, 79, 50, 66, 74].
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0523, Accuracy: 282/888 (31.7568%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 432/888 (48.6486%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 9.0278, Accuracy: 58/10000 (0.5800%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0554, Accuracy: 268/1372 (19.5335%)
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0323, Accuracy: 478/1372 (34.8397%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.0928, Accuracy: 86/10000 (0.8600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   1, Avg loss: 0.0529, Accuracy: 280/590 (47.4576%)
___Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   2, Avg loss: 0.0274, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.8392, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   1, Avg loss: 0.0631, Accuracy: 237/1241 (19.0975%)
___Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   2, Avg loss: 0.0373, Accuracy: 370/1241 (29.8147%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.6559, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   1, Avg loss: 0.0552, Accuracy: 414/1953 (21.1982%)
___Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 749/1953 (38.3513%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.9288, Accuracy: 101/10000 (1.0100%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0622, Accuracy: 340/1750 (19.4286%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0358, Accuracy: 627/1750 (35.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.5775, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   1, Avg loss: 0.0976, Accuracy: 37/197 (18.7817%)
___Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   2, Avg loss: 0.0811, Accuracy: 60/197 (30.4569%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.4731, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0685, Accuracy: 112/809 (13.8443%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0291, Accuracy: 310/809 (38.3189%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.7474, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   1, Avg loss: 0.0627, Accuracy: 258/1402 (18.4023%)
___Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   2, Avg loss: 0.0395, Accuracy: 362/1402 (25.8203%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.5804, Accuracy: 59/10000 (0.5900%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0446, Accuracy: 439/1552 (28.2861%)
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 761/1552 (49.0335%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 10.7406, Accuracy: 92/10000 (0.9200%)
time spent on training: 180.57603931427002
___Test Target_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.5299, Accuracy: 61/10000 (0.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 6: Avg loss: 5.3646, Accuracy: 0/9950 (0.0000%)
saving model
Done in 590.1703565120697 sec.
Server Epoch:7 choose agents : [82, 90, 50, 35, 0, 79, 25, 37, 16, 60].
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0757, Accuracy: 64/500 (12.8000%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0493, Accuracy: 184/500 (36.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.2947, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0647, Accuracy: 251/677 (37.0753%)
___Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0242, Accuracy: 454/677 (67.0606%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.2754, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   1, Avg loss: 0.0660, Accuracy: 124/809 (15.3276%)
___Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   2, Avg loss: 0.0288, Accuracy: 329/809 (40.6675%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.0167, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0864, Accuracy: 36/271 (13.2841%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0595, Accuracy: 97/271 (35.7934%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.6680, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   1, Avg loss: 0.0588, Accuracy: 322/1657 (19.4327%)
___Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   2, Avg loss: 0.0353, Accuracy: 519/1657 (31.3217%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.5039, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.1004, Accuracy: 19/197 (9.6447%)
___Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0834, Accuracy: 59/197 (29.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.4826, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0577, Accuracy: 277/690 (40.1449%)
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 459/690 (66.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.2752, Accuracy: 71/10000 (0.7100%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   1, Avg loss: 0.0562, Accuracy: 328/1129 (29.0523%)
___Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   2, Avg loss: 0.0258, Accuracy: 672/1129 (59.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.8099, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   1, Avg loss: 0.0631, Accuracy: 266/708 (37.5706%)
___Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   2, Avg loss: 0.0374, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.1049, Accuracy: 58/10000 (0.5800%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0510, Accuracy: 556/2227 (24.9663%)
___Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1019/2227 (45.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.7375, Accuracy: 118/10000 (1.1800%)
time spent on training: 168.55409717559814
___Test Target_ResNet_18 poisoned: False, epoch: 7: Avg loss: 6.0488, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 7: Avg loss: 6.6866, Accuracy: 0/9950 (0.0000%)
saving model
Done in 568.5526525974274 sec.
Server Epoch:8 choose agents : [94, 35, 21, 1, 88, 43, 68, 27, 19, 92].
___Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   1, Avg loss: 0.0534, Accuracy: 334/1662 (20.0963%)
___Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 624/1662 (37.5451%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.1104, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   1, Avg loss: 0.0891, Accuracy: 17/271 (6.2731%)
___Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   2, Avg loss: 0.0586, Accuracy: 96/271 (35.4244%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.7571, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0551, Accuracy: 393/1949 (20.1642%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 651/1949 (33.4017%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.3734, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0598, Accuracy: 244/928 (26.2931%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0248, Accuracy: 541/928 (58.2974%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.1422, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   1, Avg loss: 0.0791, Accuracy: 106/603 (17.5788%)
___Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   2, Avg loss: 0.0472, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.5367, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 298/946 (31.5011%)
___Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   2, Avg loss: 0.0355, Accuracy: 374/946 (39.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.3228, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   1, Avg loss: 0.0631, Accuracy: 338/1163 (29.0628%)
___Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   2, Avg loss: 0.0367, Accuracy: 479/1163 (41.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.9594, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   1, Avg loss: 0.0561, Accuracy: 356/1587 (22.4323%)
___Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 564/1587 (35.5388%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.7325, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 336/1036 (32.4324%)
___Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   2, Avg loss: 0.0261, Accuracy: 610/1036 (58.8803%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 10.5835, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   1, Avg loss: 0.0533, Accuracy: 388/1715 (22.6239%)
___Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   2, Avg loss: 0.0315, Accuracy: 655/1715 (38.1924%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.7297, Accuracy: 86/10000 (0.8600%)
time spent on training: 128.14178848266602
___Test Target_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.0237, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 8: Avg loss: 7.0161, Accuracy: 0/9950 (0.0000%)
saving model
Done in 532.9740891456604 sec.
Server Epoch:9 choose agents : [57, 42, 90, 21, 49, 84, 77, 18, 56, 65].
___Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   1, Avg loss: 0.0583, Accuracy: 251/1154 (21.7504%)
___Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   2, Avg loss: 0.0278, Accuracy: 461/1154 (39.9480%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 10.4470, Accuracy: 61/10000 (0.6100%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   1, Avg loss: 0.0552, Accuracy: 264/1372 (19.2420%)
___Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   2, Avg loss: 0.0318, Accuracy: 511/1372 (37.2449%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.4647, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0612, Accuracy: 273/677 (40.3250%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0246, Accuracy: 454/677 (67.0606%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.4020, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   1, Avg loss: 0.0550, Accuracy: 373/1949 (19.1380%)
___Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   2, Avg loss: 0.0336, Accuracy: 618/1949 (31.7086%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.5459, Accuracy: 83/10000 (0.8300%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   1, Avg loss: 0.0794, Accuracy: 27/440 (6.1364%)
___Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   2, Avg loss: 0.0491, Accuracy: 146/440 (33.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.1507, Accuracy: 52/10000 (0.5200%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 296/1190 (24.8739%)
___Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0317, Accuracy: 449/1190 (37.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.6463, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 327/1340 (24.4030%)
___Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 521/1340 (38.8806%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.5356, Accuracy: 84/10000 (0.8400%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   1, Avg loss: 0.0843, Accuracy: 62/530 (11.6981%)
___Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   2, Avg loss: 0.0390, Accuracy: 265/530 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.1459, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0920, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0767, Accuracy: 10/186 (5.3763%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.5849, Accuracy: 52/10000 (0.5200%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0588, Accuracy: 345/1475 (23.3898%)
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0330, Accuracy: 604/1475 (40.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.3437, Accuracy: 87/10000 (0.8700%)
time spent on training: 184.517963886261
___Test Target_ResNet_18 poisoned: False, epoch: 9: Avg loss: 8.6382, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 9: Avg loss: 9.7396, Accuracy: 0/9950 (0.0000%)
saving model
Done in 595.2200725078583 sec.
Server Epoch:10 choose agents : [5, 23, 83, 66, 54, 46, 86, 78, 84, 8].
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0523, Accuracy: 362/1628 (22.2359%)
___Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0273, Accuracy: 724/1628 (44.4717%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.8174, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   1, Avg loss: 0.0723, Accuracy: 268/715 (37.4825%)
___Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   2, Avg loss: 0.0399, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.1274, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   1, Avg loss: 0.0557, Accuracy: 405/1953 (20.7373%)
___Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 751/1953 (38.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.9449, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   1, Avg loss: 0.0645, Accuracy: 256/1402 (18.2596%)
___Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   2, Avg loss: 0.0404, Accuracy: 335/1402 (23.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.1183, Accuracy: 80/10000 (0.8000%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   1, Avg loss: 0.0512, Accuracy: 373/1130 (33.0088%)
___Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   2, Avg loss: 0.0300, Accuracy: 465/1130 (41.1504%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.6316, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   1, Avg loss: 0.0562, Accuracy: 398/1904 (20.9034%)
___Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 710/1904 (37.2899%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.0961, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   1, Avg loss: 0.0655, Accuracy: 328/1003 (32.7019%)
___Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   2, Avg loss: 0.0366, Accuracy: 377/1003 (37.5872%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.8504, Accuracy: 49/10000 (0.4900%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   1, Avg loss: 0.0830, Accuracy: 18/416 (4.3269%)
___Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   2, Avg loss: 0.0479, Accuracy: 202/416 (48.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.8636, Accuracy: 62/10000 (0.6200%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0624, Accuracy: 292/1190 (24.5378%)
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 440/1190 (36.9748%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.8986, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   1, Avg loss: 0.0630, Accuracy: 219/1513 (14.4746%)
___Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 463/1513 (30.6015%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.7502, Accuracy: 96/10000 (0.9600%)
time spent on training: 177.24699187278748
___Test Target_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.8559, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 10: Avg loss: 11.1638, Accuracy: 0/9950 (0.0000%)
saving model
Done in 584.7936058044434 sec.
Server Epoch:11 choose agents : [38, 24, 45, 8, 65, 19, 49, 17, 40, 22].
___Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   1, Avg loss: 0.0677, Accuracy: 197/1131 (17.4182%)
___Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   2, Avg loss: 0.0324, Accuracy: 451/1131 (39.8762%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.0912, Accuracy: 81/10000 (0.8100%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0672, Accuracy: 70/312 (22.4359%)
___Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0377, Accuracy: 158/312 (50.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.8499, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   1, Avg loss: 0.0719, Accuracy: 174/669 (26.0090%)
___Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   2, Avg loss: 0.0452, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.1949, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   1, Avg loss: 0.0621, Accuracy: 223/1513 (14.7389%)
___Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   2, Avg loss: 0.0373, Accuracy: 453/1513 (29.9405%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.0198, Accuracy: 99/10000 (0.9900%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   1, Avg loss: 0.0590, Accuracy: 362/1475 (24.5424%)
___Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   2, Avg loss: 0.0330, Accuracy: 599/1475 (40.6102%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.9762, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   1, Avg loss: 0.0464, Accuracy: 383/1036 (36.9691%)
___Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 671/1036 (64.7683%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 10.6367, Accuracy: 72/10000 (0.7200%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   1, Avg loss: 0.0758, Accuracy: 42/440 (9.5455%)
___Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   2, Avg loss: 0.0471, Accuracy: 154/440 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.3525, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0529, Accuracy: 339/1574 (21.5375%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0289, Accuracy: 623/1574 (39.5807%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.5139, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   1, Avg loss: 0.0583, Accuracy: 303/1573 (19.2626%)
___Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   2, Avg loss: 0.0353, Accuracy: 571/1573 (36.3001%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.6282, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   1, Avg loss: 0.0487, Accuracy: 455/1470 (30.9524%)
___Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   2, Avg loss: 0.0248, Accuracy: 805/1470 (54.7619%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.4802, Accuracy: 82/10000 (0.8200%)
time spent on training: 163.36584854125977
___Test Target_ResNet_18 poisoned: False, epoch: 11: Avg loss: 11.2253, Accuracy: 46/10000 (0.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 11: Avg loss: 15.1246, Accuracy: 0/9950 (0.0000%)
saving model
Done in 558.2986981868744 sec.
Server Epoch:12 choose agents : [56, 30, 69, 47, 51, 48, 92, 84, 32, 22].
___Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   1, Avg loss: 0.0925, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   2, Avg loss: 0.0758, Accuracy: 26/186 (13.9785%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.7618, Accuracy: 53/10000 (0.5300%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0894, Accuracy: 23/486 (4.7325%)
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0431, Accuracy: 219/486 (45.0617%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.6454, Accuracy: 66/10000 (0.6600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   1, Avg loss: 0.0535, Accuracy: 260/590 (44.0678%)
___Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   2, Avg loss: 0.0364, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 9.7291, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   1, Avg loss: 0.1287, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   2, Avg loss: 0.1109, Accuracy: 6/134 (4.4776%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.0355, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   1, Avg loss: 0.0667, Accuracy: 199/1049 (18.9704%)
___Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   2, Avg loss: 0.0314, Accuracy: 504/1049 (48.0458%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.4372, Accuracy: 90/10000 (0.9000%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   1, Avg loss: 0.0806, Accuracy: 50/631 (7.9239%)
___Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   2, Avg loss: 0.0443, Accuracy: 206/631 (32.6466%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.7450, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0558, Accuracy: 434/1715 (25.3061%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0317, Accuracy: 662/1715 (38.6006%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.6548, Accuracy: 92/10000 (0.9200%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   1, Avg loss: 0.0646, Accuracy: 278/1190 (23.3613%)
___Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 445/1190 (37.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.2466, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0655, Accuracy: 152/735 (20.6803%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0242, Accuracy: 366/735 (49.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 10.0112, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0467, Accuracy: 446/1470 (30.3401%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0250, Accuracy: 810/1470 (55.1020%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.7443, Accuracy: 82/10000 (0.8200%)
time spent on training: 164.7905592918396
___Test Target_ResNet_18 poisoned: False, epoch: 12: Avg loss: 12.0677, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 12: Avg loss: 12.6163, Accuracy: 0/9950 (0.0000%)
saving model
Done in 575.0725898742676 sec.
Server Epoch:13 choose agents : [53, 15, 3, 23, 83, 11, 27, 76, 70, 35].
___Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   1, Avg loss: 0.0519, Accuracy: 269/813 (33.0873%)
___Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   2, Avg loss: 0.0196, Accuracy: 437/813 (53.7515%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 11.2977, Accuracy: 57/10000 (0.5700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0613, Accuracy: 304/1154 (26.3432%)
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0346, Accuracy: 412/1154 (35.7019%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.6020, Accuracy: 81/10000 (0.8100%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   1, Avg loss: 0.0739, Accuracy: 117/781 (14.9808%)
___Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   2, Avg loss: 0.0370, Accuracy: 233/781 (29.8335%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.6525, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0635, Accuracy: 270/715 (37.7622%)
___Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0412, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.0637, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 431/1953 (22.0686%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0343, Accuracy: 753/1953 (38.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.3159, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   1, Avg loss: 0.0585, Accuracy: 258/712 (36.2360%)
___Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   2, Avg loss: 0.0287, Accuracy: 442/712 (62.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.4329, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   1, Avg loss: 0.0585, Accuracy: 356/1587 (22.4323%)
___Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   2, Avg loss: 0.0343, Accuracy: 599/1587 (37.7442%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.6129, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0880, Accuracy: 17/466 (3.6481%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0509, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.6648, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0611, Accuracy: 308/1418 (21.7207%)
___Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0322, Accuracy: 601/1418 (42.3836%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.0410, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0892, Accuracy: 6/271 (2.2140%)
___Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0589, Accuracy: 115/271 (42.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.2448, Accuracy: 48/10000 (0.4800%)
time spent on training: 151.38947534561157
___Test Target_ResNet_18 poisoned: False, epoch: 13: Avg loss: 12.9741, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 13: Avg loss: 15.9557, Accuracy: 0/9950 (0.0000%)
saving model
Done in 553.3291645050049 sec.
Server Epoch:14 choose agents : [0, 94, 96, 91, 51, 3, 36, 90, 37, 84].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   1, Avg loss: 0.0606, Accuracy: 314/1657 (18.9499%)
___Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   2, Avg loss: 0.0353, Accuracy: 485/1657 (29.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.6501, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   1, Avg loss: 0.0530, Accuracy: 347/1662 (20.8785%)
___Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   2, Avg loss: 0.0340, Accuracy: 595/1662 (35.8002%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.7258, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   1, Avg loss: 0.0801, Accuracy: 39/311 (12.5402%)
___Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   2, Avg loss: 0.0582, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.5459, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   1, Avg loss: 0.0521, Accuracy: 293/1030 (28.4466%)
___Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   2, Avg loss: 0.0297, Accuracy: 598/1030 (58.0583%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 9.1525, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   1, Avg loss: 0.0668, Accuracy: 201/1049 (19.1611%)
___Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   2, Avg loss: 0.0321, Accuracy: 454/1049 (43.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.2901, Accuracy: 78/10000 (0.7800%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   1, Avg loss: 0.0749, Accuracy: 106/781 (13.5723%)
___Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   2, Avg loss: 0.0376, Accuracy: 240/781 (30.7298%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.7759, Accuracy: 68/10000 (0.6800%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0916, Accuracy: 47/408 (11.5196%)
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0599, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.3725, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   1, Avg loss: 0.0598, Accuracy: 278/677 (41.0635%)
___Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   2, Avg loss: 0.0244, Accuracy: 445/677 (65.7312%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 9.0118, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   1, Avg loss: 0.0597, Accuracy: 313/1129 (27.7236%)
___Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   2, Avg loss: 0.0276, Accuracy: 613/1129 (54.2958%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.7694, Accuracy: 98/10000 (0.9800%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 291/1190 (24.4538%)
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 423/1190 (35.5462%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.4348, Accuracy: 53/10000 (0.5300%)
time spent on training: 187.74503254890442
___Test Target_ResNet_18 poisoned: False, epoch: 14: Avg loss: 11.2451, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 14: Avg loss: 12.2561, Accuracy: 0/9950 (0.0000%)
saving model
Done in 584.270845413208 sec.
Server Epoch:15 choose agents : [0, 92, 37, 24, 39, 63, 28, 96, 58, 72].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   1, Avg loss: 0.0599, Accuracy: 305/1657 (18.4068%)
___Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 506/1657 (30.5371%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.0942, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0560, Accuracy: 407/1715 (23.7318%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 692/1715 (40.3499%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 9.1581, Accuracy: 77/10000 (0.7700%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0579, Accuracy: 305/1129 (27.0151%)
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0272, Accuracy: 637/1129 (56.4216%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.8110, Accuracy: 97/10000 (0.9700%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   1, Avg loss: 0.0723, Accuracy: 36/312 (11.5385%)
___Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 157/312 (50.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.3371, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0564, Accuracy: 280/1013 (27.6407%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 467/1013 (46.1007%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.8221, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0584, Accuracy: 245/888 (27.5901%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0274, Accuracy: 402/888 (45.2703%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 9.0743, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   1, Avg loss: 0.0607, Accuracy: 349/1581 (22.0746%)
___Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   2, Avg loss: 0.0358, Accuracy: 512/1581 (32.3846%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.4031, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   1, Avg loss: 0.0805, Accuracy: 46/311 (14.7910%)
___Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   2, Avg loss: 0.0569, Accuracy: 134/311 (43.0868%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.8117, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   1, Avg loss: 0.0626, Accuracy: 315/803 (39.2279%)
___Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   2, Avg loss: 0.0376, Accuracy: 435/803 (54.1719%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.5581, Accuracy: 59/10000 (0.5900%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   1, Avg loss: 0.0593, Accuracy: 262/1241 (21.1120%)
___Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 411/1241 (33.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9416, Accuracy: 60/10000 (0.6000%)
time spent on training: 175.3850953578949
___Test Target_ResNet_18 poisoned: False, epoch: 15: Avg loss: 9.5972, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 15: Avg loss: 10.2322, Accuracy: 0/9950 (0.0000%)
saving model
Done in 581.4444460868835 sec.
Server Epoch:16 choose agents : [35, 32, 3, 96, 25, 8, 93, 74, 88, 50].
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0823, Accuracy: 15/271 (5.5351%)
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0525, Accuracy: 104/271 (38.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.5393, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0630, Accuracy: 141/735 (19.1837%)
___Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 357/735 (48.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 10.2718, Accuracy: 54/10000 (0.5400%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   1, Avg loss: 0.0759, Accuracy: 99/781 (12.6761%)
___Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   2, Avg loss: 0.0370, Accuracy: 256/781 (32.7785%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.6591, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0828, Accuracy: 26/311 (8.3601%)
___Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0574, Accuracy: 135/311 (43.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.6107, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0556, Accuracy: 277/690 (40.1449%)
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0287, Accuracy: 460/690 (66.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1387, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   1, Avg loss: 0.0621, Accuracy: 219/1513 (14.4746%)
___Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   2, Avg loss: 0.0378, Accuracy: 434/1513 (28.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1296, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0604, Accuracy: 338/1742 (19.4030%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0328, Accuracy: 677/1742 (38.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.2139, Accuracy: 98/10000 (0.9800%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0441, Accuracy: 476/1552 (30.6701%)
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0217, Accuracy: 723/1552 (46.5851%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 11.5321, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   1, Avg loss: 0.0768, Accuracy: 107/603 (17.7446%)
___Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   2, Avg loss: 0.0460, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.9872, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   1, Avg loss: 0.0689, Accuracy: 112/809 (13.8443%)
___Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   2, Avg loss: 0.0297, Accuracy: 331/809 (40.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 9.3061, Accuracy: 93/10000 (0.9300%)
time spent on training: 167.1055042743683
___Test Target_ResNet_18 poisoned: False, epoch: 16: Avg loss: 9.8125, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 16: Avg loss: 8.4109, Accuracy: 0/9950 (0.0000%)
saving model
Done in 560.8761901855469 sec.
Server Epoch:17 choose agents : [53, 43, 41, 30, 82, 92, 50, 34, 7, 64].
___Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   1, Avg loss: 0.0536, Accuracy: 239/813 (29.3973%)
___Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 455/813 (55.9656%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 11.6613, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 288/946 (30.4440%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 379/946 (40.0634%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.8248, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   1, Avg loss: 0.0665, Accuracy: 242/719 (33.6579%)
___Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   2, Avg loss: 0.0363, Accuracy: 471/719 (65.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.8974, Accuracy: 65/10000 (0.6500%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   1, Avg loss: 0.0851, Accuracy: 43/486 (8.8477%)
___Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   2, Avg loss: 0.0436, Accuracy: 214/486 (44.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.9211, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   1, Avg loss: 0.0786, Accuracy: 36/500 (7.2000%)
___Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   2, Avg loss: 0.0476, Accuracy: 176/500 (35.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.0985, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   1, Avg loss: 0.0567, Accuracy: 409/1715 (23.8484%)
___Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   2, Avg loss: 0.0313, Accuracy: 684/1715 (39.8834%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.8291, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   1, Avg loss: 0.0678, Accuracy: 115/809 (14.2151%)
___Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   2, Avg loss: 0.0295, Accuracy: 328/809 (40.5439%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.9418, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0584, Accuracy: 366/1427 (25.6482%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0344, Accuracy: 563/1427 (39.4534%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.6361, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   1, Avg loss: 0.0580, Accuracy: 299/891 (33.5578%)
___Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   2, Avg loss: 0.0271, Accuracy: 443/891 (49.7194%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.2249, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   1, Avg loss: 0.0698, Accuracy: 122/953 (12.8017%)
___Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   2, Avg loss: 0.0401, Accuracy: 274/953 (28.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.9071, Accuracy: 50/10000 (0.5000%)
time spent on training: 142.23157405853271
___Test Target_ResNet_18 poisoned: False, epoch: 17: Avg loss: 9.3892, Accuracy: 36/10000 (0.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 17: Avg loss: 8.1133, Accuracy: 0/9950 (0.0000%)
saving model
Done in 545.8287909030914 sec.
Server Epoch:18 choose agents : [18, 55, 4, 35, 2, 13, 24, 76, 9, 43].
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   1, Avg loss: 0.0778, Accuracy: 84/530 (15.8491%)
___Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   2, Avg loss: 0.0377, Accuracy: 266/530 (50.1887%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.0702, Accuracy: 67/10000 (0.6700%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   1, Avg loss: 0.0604, Accuracy: 211/1071 (19.7012%)
___Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   2, Avg loss: 0.0321, Accuracy: 472/1071 (44.0710%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 9.4511, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   1, Avg loss: 0.0628, Accuracy: 281/901 (31.1876%)
___Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   2, Avg loss: 0.0348, Accuracy: 395/901 (43.8402%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.6047, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   1, Avg loss: 0.0803, Accuracy: 22/271 (8.1181%)
___Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   2, Avg loss: 0.0557, Accuracy: 107/271 (39.4834%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.6634, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0607, Accuracy: 215/605 (35.5372%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0388, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.8425, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   1, Avg loss: 0.0623, Accuracy: 297/1645 (18.0547%)
___Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   2, Avg loss: 0.0348, Accuracy: 582/1645 (35.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.7310, Accuracy: 96/10000 (0.9600%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0735, Accuracy: 31/312 (9.9359%)
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 157/312 (50.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.4649, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0848, Accuracy: 24/466 (5.1502%)
___Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0476, Accuracy: 183/466 (39.2704%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.0470, Accuracy: 50/10000 (0.5000%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0511, Accuracy: 368/1275 (28.8627%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 668/1275 (52.3922%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 10.5375, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   1, Avg loss: 0.0607, Accuracy: 303/946 (32.0296%)
___Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 355/946 (37.5264%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.9720, Accuracy: 75/10000 (0.7500%)
time spent on training: 176.96279096603394
___Test Target_ResNet_18 poisoned: False, epoch: 18: Avg loss: 9.0460, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 18: Avg loss: 8.5796, Accuracy: 0/9950 (0.0000%)
saving model
Done in 570.6968507766724 sec.
Server Epoch:19 choose agents : [11, 48, 53, 27, 55, 65, 31, 89, 17, 23].
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0640, Accuracy: 223/712 (31.3202%)
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 442/712 (62.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 9.6798, Accuracy: 59/10000 (0.5900%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   1, Avg loss: 0.0817, Accuracy: 62/631 (9.8257%)
___Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   2, Avg loss: 0.0467, Accuracy: 197/631 (31.2203%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.0363, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   1, Avg loss: 0.0540, Accuracy: 239/813 (29.3973%)
___Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   2, Avg loss: 0.0197, Accuracy: 461/813 (56.7036%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 11.8346, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   1, Avg loss: 0.0569, Accuracy: 351/1587 (22.1172%)
___Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 594/1587 (37.4291%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.2399, Accuracy: 63/10000 (0.6300%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   1, Avg loss: 0.0589, Accuracy: 231/1071 (21.5686%)
___Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   2, Avg loss: 0.0315, Accuracy: 492/1071 (45.9384%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 9.8142, Accuracy: 64/10000 (0.6400%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   1, Avg loss: 0.0605, Accuracy: 323/1475 (21.8983%)
___Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   2, Avg loss: 0.0338, Accuracy: 609/1475 (41.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.1719, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   1, Avg loss: 0.0748, Accuracy: 65/460 (14.1304%)
___Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   2, Avg loss: 0.0350, Accuracy: 194/460 (42.1739%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.7273, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0651, Accuracy: 302/896 (33.7054%)
___Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0365, Accuracy: 416/896 (46.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.0186, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0552, Accuracy: 315/1574 (20.0127%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0294, Accuracy: 633/1574 (40.2160%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.6753, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   1, Avg loss: 0.0588, Accuracy: 310/715 (43.3566%)
___Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   2, Avg loss: 0.0397, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.4635, Accuracy: 59/10000 (0.5900%)
time spent on training: 174.22072863578796
___Test Target_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.8375, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 19: Avg loss: 8.5699, Accuracy: 0/9950 (0.0000%)
saving model
Done in 568.927520275116 sec.
Server Epoch:20 choose agents : [15, 22, 82, 11, 93, 75, 3, 77, 88, 16].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0618, Accuracy: 289/1154 (25.0433%)
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0291, Accuracy: 437/1154 (37.8683%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 10.4538, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 492/1470 (33.4694%)
___Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   2, Avg loss: 0.0253, Accuracy: 831/1470 (56.5306%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.2543, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   1, Avg loss: 0.0787, Accuracy: 40/500 (8.0000%)
___Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   2, Avg loss: 0.0500, Accuracy: 182/500 (36.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.3797, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0658, Accuracy: 200/712 (28.0899%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0275, Accuracy: 447/712 (62.7809%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 10.1252, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   1, Avg loss: 0.0593, Accuracy: 407/1742 (23.3639%)
___Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 693/1742 (39.7819%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.6794, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0745, Accuracy: 179/776 (23.0670%)
___Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0312, Accuracy: 424/776 (54.6392%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.9307, Accuracy: 62/10000 (0.6200%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   1, Avg loss: 0.0785, Accuracy: 83/781 (10.6274%)
___Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   2, Avg loss: 0.0377, Accuracy: 230/781 (29.4494%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.9358, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   1, Avg loss: 0.0555, Accuracy: 329/1340 (24.5522%)
___Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 536/1340 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.9080, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   1, Avg loss: 0.0756, Accuracy: 113/603 (18.7396%)
___Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   2, Avg loss: 0.0477, Accuracy: 281/603 (46.6003%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.3860, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   1, Avg loss: 0.0683, Accuracy: 219/708 (30.9322%)
___Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   2, Avg loss: 0.0368, Accuracy: 427/708 (60.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.2093, Accuracy: 69/10000 (0.6900%)
time spent on training: 165.6447355747223
___Test Target_ResNet_18 poisoned: False, epoch: 20: Avg loss: 9.3060, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 20: Avg loss: 9.0234, Accuracy: 0/9950 (0.0000%)
saving model
Done in 571.3073749542236 sec.
Server Epoch:21 choose agents : [0, 27, 39, 70, 20, 85, 12, 72, 94, 32].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0601, Accuracy: 340/1657 (20.5190%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0368, Accuracy: 478/1657 (28.8473%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0335, Accuracy: 546/1657 (32.9511%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0325, Accuracy: 578/1657 (34.8823%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0324, Accuracy: 591/1657 (35.6669%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0321, Accuracy: 615/1657 (37.1153%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0309, Accuracy: 628/1657 (37.8998%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0308, Accuracy: 662/1657 (39.9517%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0301, Accuracy: 641/1657 (38.6844%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0301, Accuracy: 678/1657 (40.9173%), train_poison_data_count: 520
Global model norm: 187.4122294568847.
Norm before scaling: 187.35987472308472. Distance: 1.2904439748391991
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.0567, Accuracy: 54/10000 (0.5400%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: 1.0500, Accuracy: 8558/9950 (86.0101%)
Scaling by  100
Scaled Norm after poisoning: 222.81627801846076, distance: 129.04439945712483
Total norm for 5 adversaries is: 222.81627801846076. distance: 129.04439945712483
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0568, Accuracy: 364/1587 (22.9364%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0347, Accuracy: 568/1587 (35.7908%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.2792, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   1, Avg loss: 0.0550, Accuracy: 260/1013 (25.6663%)
___Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   2, Avg loss: 0.0270, Accuracy: 484/1013 (47.7789%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 9.1961, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   1, Avg loss: 0.0579, Accuracy: 311/1418 (21.9323%)
___Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   2, Avg loss: 0.0322, Accuracy: 628/1418 (44.2877%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.5771, Accuracy: 88/10000 (0.8800%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0601, Accuracy: 281/807 (34.8203%)
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0349, Accuracy: 399/807 (49.4424%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.3502, Accuracy: 70/10000 (0.7000%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   1, Avg loss: 0.0577, Accuracy: 417/1988 (20.9759%)
___Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   2, Avg loss: 0.0367, Accuracy: 634/1988 (31.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.0635, Accuracy: 82/10000 (0.8200%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   1, Avg loss: 0.1048, Accuracy: 5/338 (1.4793%)
___Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   2, Avg loss: 0.0622, Accuracy: 89/338 (26.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.6380, Accuracy: 48/10000 (0.4800%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   1, Avg loss: 0.0594, Accuracy: 242/1241 (19.5004%)
___Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 378/1241 (30.4593%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.9255, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0574, Accuracy: 309/1662 (18.5921%)
___Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0345, Accuracy: 555/1662 (33.3935%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 9.0277, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   1, Avg loss: 0.0637, Accuracy: 158/735 (21.4966%)
___Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   2, Avg loss: 0.0235, Accuracy: 352/735 (47.8912%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 10.5443, Accuracy: 61/10000 (0.6100%)
time spent on training: 286.90065693855286
___Test Target_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.7441, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Avg loss: 1.5905, Accuracy: 9950/9950 (100.0000%)
saving model
Done in 687.0068695545197 sec.
Server Epoch:22 choose agents : [17, 32, 73, 28, 12, 2, 85, 13, 18, 80].
___Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   1, Avg loss: 0.0696, Accuracy: 256/1574 (16.2643%)
___Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   2, Avg loss: 0.0311, Accuracy: 592/1574 (37.6112%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.5870, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   1, Avg loss: 0.0744, Accuracy: 131/735 (17.8231%)
___Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   2, Avg loss: 0.0261, Accuracy: 374/735 (50.8844%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 13.8425, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   1, Avg loss: 0.0779, Accuracy: 172/938 (18.3369%)
___Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   2, Avg loss: 0.0364, Accuracy: 339/938 (36.1407%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.5401, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   1, Avg loss: 0.0720, Accuracy: 299/1581 (18.9121%)
___Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   2, Avg loss: 0.0350, Accuracy: 565/1581 (35.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.1903, Accuracy: 100/10000 (1.0000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.1424, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0792, Accuracy: 13/338 (3.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.8771, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0919, Accuracy: 66/605 (10.9091%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0509, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.9811, Accuracy: 51/10000 (0.5100%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   1, Avg loss: 0.0701, Accuracy: 328/1988 (16.4990%)
___Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   2, Avg loss: 0.0357, Accuracy: 637/1988 (32.0423%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.3824, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0712, Accuracy: 247/1645 (15.0152%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0339, Accuracy: 539/1645 (32.7660%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.9710, Accuracy: 113/10000 (1.1300%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.1136, Accuracy: 0/530 (0.0000%)
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0438, Accuracy: 260/530 (49.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 11.4755, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0967, Accuracy: 54/682 (7.9179%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0430, Accuracy: 266/682 (39.0029%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.5244, Accuracy: 62/10000 (0.6200%)
time spent on training: 181.748464345932
___Test Target_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.7800, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Avg loss: 1.6725, Accuracy: 30/9950 (0.3015%)
saving model
Done in 576.3355836868286 sec.
Server Epoch:23 choose agents : [3, 14, 79, 74, 2, 49, 32, 18, 4, 7].
poison local model 3 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Average loss: 0.0820, Accuracy: 232/781 (29.7055%), train_poison_data_count: 253
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Average loss: 0.0455, Accuracy: 219/781 (28.0410%), train_poison_data_count: 253
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   3, Average loss: 0.0338, Accuracy: 237/781 (30.3457%), train_poison_data_count: 253
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   4, Average loss: 0.0330, Accuracy: 264/781 (33.8028%), train_poison_data_count: 253
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   5, Average loss: 0.0323, Accuracy: 262/781 (33.5467%), train_poison_data_count: 253
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   6, Average loss: 0.0318, Accuracy: 274/781 (35.0832%), train_poison_data_count: 253
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   7, Average loss: 0.0318, Accuracy: 273/781 (34.9552%), train_poison_data_count: 253
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   8, Average loss: 0.0309, Accuracy: 278/781 (35.5954%), train_poison_data_count: 253
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   9, Average loss: 0.0314, Accuracy: 279/781 (35.7234%), train_poison_data_count: 253
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch  10, Average loss: 0.0311, Accuracy: 294/781 (37.6440%), train_poison_data_count: 253
Global model norm: 193.2540022224637.
Norm before scaling: 193.22840071726. Distance: 1.0371047772379252
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.1170, Accuracy: 62/10000 (0.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.9239, Accuracy: 8861/9950 (89.0553%)
Scaling by  100
Scaled Norm after poisoning: 216.80938308511926, distance: 103.71047816517866
Total norm for 4 adversaries is: 216.80938308511926. distance: 103.71047816517866
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   1, Avg loss: 0.0952, Accuracy: 91/1013 (8.9832%)
___Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   2, Avg loss: 0.0398, Accuracy: 302/1013 (29.8124%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.1372, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   1, Avg loss: 0.1558, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   2, Avg loss: 0.1262, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 6.1674, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0598, Accuracy: 345/1552 (22.2294%)
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0220, Accuracy: 718/1552 (46.2629%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 12.2478, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0866, Accuracy: 76/605 (12.5620%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0487, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.4511, Accuracy: 52/10000 (0.5200%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   1, Avg loss: 0.1118, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   2, Avg loss: 0.0608, Accuracy: 82/440 (18.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.8333, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   1, Avg loss: 0.0705, Accuracy: 144/735 (19.5918%)
___Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   2, Avg loss: 0.0257, Accuracy: 346/735 (47.0748%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 12.7096, Accuracy: 58/10000 (0.5800%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   1, Avg loss: 0.1082, Accuracy: 3/530 (0.5660%)
___Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   2, Avg loss: 0.0448, Accuracy: 260/530 (49.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 10.4941, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0781, Accuracy: 200/901 (22.1976%)
___Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0364, Accuracy: 401/901 (44.5061%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.9559, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   1, Avg loss: 0.0781, Accuracy: 196/891 (21.9978%)
___Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   2, Avg loss: 0.0309, Accuracy: 428/891 (48.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 10.4162, Accuracy: 67/10000 (0.6700%)
time spent on training: 238.1091046333313
___Test Target_ResNet_18 poisoned: False, epoch: 23: Avg loss: 6.9320, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Avg loss: 1.3642, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 647.8372006416321 sec.
Server Epoch:24 choose agents : [92, 33, 42, 36, 22, 98, 4, 17, 76, 3].
___Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   1, Avg loss: 0.0695, Accuracy: 304/1715 (17.7259%)
___Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   2, Avg loss: 0.0322, Accuracy: 672/1715 (39.1837%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.8266, Accuracy: 80/10000 (0.8000%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   1, Avg loss: 0.1191, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   2, Avg loss: 0.0628, Accuracy: 98/515 (19.0291%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.8819, Accuracy: 60/10000 (0.6000%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   1, Avg loss: 0.0685, Accuracy: 182/1372 (13.2653%)
___Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   2, Avg loss: 0.0333, Accuracy: 500/1372 (36.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.1964, Accuracy: 89/10000 (0.8900%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   1, Avg loss: 0.1258, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   2, Avg loss: 0.0649, Accuracy: 88/408 (21.5686%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.1350, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   1, Avg loss: 0.0601, Accuracy: 368/1470 (25.0340%)
___Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   2, Avg loss: 0.0260, Accuracy: 805/1470 (54.7619%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 10.1050, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   1, Avg loss: 0.1237, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   2, Avg loss: 0.0702, Accuracy: 63/373 (16.8901%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.4326, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   1, Avg loss: 0.0795, Accuracy: 204/901 (22.6415%)
___Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   2, Avg loss: 0.0352, Accuracy: 383/901 (42.5083%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.8012, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0675, Accuracy: 260/1574 (16.5184%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0304, Accuracy: 587/1574 (37.2935%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.1658, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.1159, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0572, Accuracy: 153/466 (32.8326%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.3056, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0348, Accuracy: 217/781 (27.7849%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0292, Accuracy: 307/781 (39.3086%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.6279, Accuracy: 92/10000 (0.9200%)
time spent on training: 188.50473475456238
___Test Target_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.6519, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Avg loss: 1.7302, Accuracy: 0/9950 (0.0000%)
saving model
Done in 586.5921986103058 sec.
Server Epoch:25 choose agents : [5, 23, 0, 67, 40, 80, 54, 26, 74, 47].
poison local model 5 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   1, Average loss: 0.0558, Accuracy: 418/1628 (25.6757%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   2, Average loss: 0.0298, Accuracy: 583/1628 (35.8108%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   3, Average loss: 0.0267, Accuracy: 681/1628 (41.8305%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   4, Average loss: 0.0257, Accuracy: 758/1628 (46.5602%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   5, Average loss: 0.0247, Accuracy: 783/1628 (48.0958%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   6, Average loss: 0.0240, Accuracy: 836/1628 (51.3514%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   7, Average loss: 0.0243, Accuracy: 850/1628 (52.2113%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   8, Average loss: 0.0231, Accuracy: 848/1628 (52.0885%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   9, Average loss: 0.0237, Accuracy: 853/1628 (52.3956%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch  10, Average loss: 0.0230, Accuracy: 907/1628 (55.7125%), train_poison_data_count: 520
Global model norm: 198.98747605062988.
Norm before scaling: 198.92970452838358. Distance: 1.3165470127269576
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.7120, Accuracy: 114/10000 (1.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.7707, Accuracy: 8574/9950 (86.1709%)
Scaling by  100
Scaled Norm after poisoning: 233.35856262413, distance: 131.65469602097374
Total norm for 4 adversaries is: 233.35856262413. distance: 131.65469602097374
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   1, Avg loss: 0.0827, Accuracy: 160/715 (22.3776%)
___Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   2, Avg loss: 0.0461, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 6.9394, Accuracy: 59/10000 (0.5900%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   1, Avg loss: 0.0528, Accuracy: 283/1657 (17.0791%)
___Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   2, Avg loss: 0.0326, Accuracy: 548/1657 (33.0718%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.2750, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   1, Avg loss: 0.1103, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   2, Avg loss: 0.0498, Accuracy: 122/426 (28.6385%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.7977, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   1, Avg loss: 0.0715, Accuracy: 241/1573 (15.3210%)
___Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   2, Avg loss: 0.0364, Accuracy: 586/1573 (37.2537%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.0985, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   1, Avg loss: 0.0994, Accuracy: 18/682 (2.6393%)
___Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   2, Avg loss: 0.0425, Accuracy: 257/682 (37.6833%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.4080, Accuracy: 61/10000 (0.6100%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0665, Accuracy: 227/1130 (20.0885%)
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 462/1130 (40.8850%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 10.4307, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0723, Accuracy: 227/1446 (15.6985%)
___Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0359, Accuracy: 489/1446 (33.8174%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.9245, Accuracy: 61/10000 (0.6100%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0580, Accuracy: 356/1552 (22.9381%)
___Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0220, Accuracy: 728/1552 (46.9072%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 11.4627, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   1, Avg loss: 0.1709, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   2, Avg loss: 0.1498, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 12.6493, Accuracy: 51/10000 (0.5100%)
time spent on training: 271.9288625717163
___Test Target_ResNet_18 poisoned: False, epoch: 25: Avg loss: 13.0519, Accuracy: 78/10000 (0.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Avg loss: 1.6274, Accuracy: 4046/9950 (40.6633%)
saving model
Done in 669.4672591686249 sec.
Server Epoch:26 choose agents : [26, 4, 33, 73, 30, 86, 10, 12, 68, 82].
___Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   1, Avg loss: 0.0809, Accuracy: 211/1446 (14.5920%)
___Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   2, Avg loss: 0.0359, Accuracy: 491/1446 (33.9557%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.8736, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   1, Avg loss: 0.0908, Accuracy: 178/901 (19.7558%)
___Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   2, Avg loss: 0.0361, Accuracy: 389/901 (43.1743%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.6578, Accuracy: 62/10000 (0.6200%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   1, Avg loss: 0.1345, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   2, Avg loss: 0.0688, Accuracy: 73/515 (14.1748%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.7530, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0766, Accuracy: 178/938 (18.9765%)
___Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0359, Accuracy: 308/938 (32.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.8172, Accuracy: 63/10000 (0.6300%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   1, Avg loss: 0.1236, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   2, Avg loss: 0.0517, Accuracy: 171/486 (35.1852%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.5451, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.0934, Accuracy: 180/1003 (17.9462%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0403, Accuracy: 382/1003 (38.0857%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.1215, Accuracy: 49/10000 (0.4900%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   1, Avg loss: 0.0875, Accuracy: 71/861 (8.2462%)
___Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   2, Avg loss: 0.0235, Accuracy: 427/861 (49.5935%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 11.7544, Accuracy: 84/10000 (0.8400%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   1, Avg loss: 0.1525, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   2, Avg loss: 0.0794, Accuracy: 4/338 (1.1834%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.3642, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0826, Accuracy: 230/1163 (19.7764%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0393, Accuracy: 418/1163 (35.9415%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.1066, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.1222, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0594, Accuracy: 134/500 (26.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.3242, Accuracy: 57/10000 (0.5700%)
time spent on training: 184.15434908866882
___Test Target_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.6220, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Avg loss: 2.0705, Accuracy: 0/9950 (0.0000%)
saving model
Done in 580.1404774188995 sec.
Server Epoch:27 choose agents : [9, 64, 30, 13, 76, 44, 39, 22, 78, 85].
poison local model 9 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Average loss: 0.0641, Accuracy: 345/1275 (27.0588%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Average loss: 0.0256, Accuracy: 487/1275 (38.1961%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   3, Average loss: 0.0211, Accuracy: 615/1275 (48.2353%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   4, Average loss: 0.0204, Accuracy: 650/1275 (50.9804%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   5, Average loss: 0.0210, Accuracy: 646/1275 (50.6667%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   6, Average loss: 0.0200, Accuracy: 685/1275 (53.7255%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   7, Average loss: 0.0189, Accuracy: 730/1275 (57.2549%), train_poison_data_count: 400
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   8, Average loss: 0.0193, Accuracy: 722/1275 (56.6275%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   9, Average loss: 0.0191, Accuracy: 704/1275 (55.2157%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch  10, Average loss: 0.0190, Accuracy: 726/1275 (56.9412%), train_poison_data_count: 400
Global model norm: 204.51066789106625.
Norm before scaling: 204.4661493988675. Distance: 1.296668944017687
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.0496, Accuracy: 91/10000 (0.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.5910, Accuracy: 8668/9950 (87.1156%)
Scaling by  100
Scaled Norm after poisoning: 238.01274420973763, distance: 129.6668959536319
Total norm for 5 adversaries is: 238.01274420973763. distance: 129.6668959536319
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   1, Avg loss: 0.0923, Accuracy: 87/953 (9.1291%)
___Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   2, Avg loss: 0.0398, Accuracy: 309/953 (32.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.6523, Accuracy: 66/10000 (0.6600%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   1, Avg loss: 0.1174, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   2, Avg loss: 0.0506, Accuracy: 175/486 (36.0082%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 9.5772, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0745, Accuracy: 221/1645 (13.4347%)
___Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 579/1645 (35.1976%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.8370, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   1, Avg loss: 0.1006, Accuracy: 31/466 (6.6524%)
___Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   2, Avg loss: 0.0577, Accuracy: 182/466 (39.0558%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.9782, Accuracy: 55/10000 (0.5500%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0777, Accuracy: 248/1750 (14.1714%)
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0366, Accuracy: 646/1750 (36.9143%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.2602, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   1, Avg loss: 0.0781, Accuracy: 146/1013 (14.4126%)
___Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   2, Avg loss: 0.0279, Accuracy: 503/1013 (49.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.5750, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   1, Avg loss: 0.0608, Accuracy: 345/1470 (23.4694%)
___Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   2, Avg loss: 0.0268, Accuracy: 788/1470 (53.6054%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.1979, Accuracy: 98/10000 (0.9800%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   1, Avg loss: 0.1238, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   2, Avg loss: 0.0585, Accuracy: 104/416 (25.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.6894, Accuracy: 74/10000 (0.7400%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0712, Accuracy: 326/1988 (16.3984%)
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0366, Accuracy: 654/1988 (32.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.6911, Accuracy: 87/10000 (0.8700%)
time spent on training: 279.237655878067
___Test Target_ResNet_18 poisoned: False, epoch: 27: Avg loss: 31.1760, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Avg loss: 6.5844, Accuracy: 222/9950 (2.2312%)
saving model
Done in 691.4343874454498 sec.
Server Epoch:28 choose agents : [64, 26, 82, 31, 65, 98, 73, 61, 44, 18].
___Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   1, Avg loss: 0.1064, Accuracy: 52/953 (5.4565%)
___Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   2, Avg loss: 0.0404, Accuracy: 313/953 (32.8437%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.4626, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   1, Avg loss: 0.0814, Accuracy: 231/1446 (15.9751%)
___Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   2, Avg loss: 0.0361, Accuracy: 522/1446 (36.0996%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.9269, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.1346, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0602, Accuracy: 129/500 (25.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.7811, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   1, Avg loss: 0.1456, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   2, Avg loss: 0.0539, Accuracy: 112/460 (24.3478%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.9389, Accuracy: 52/10000 (0.5200%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   1, Avg loss: 0.0845, Accuracy: 238/1475 (16.1356%)
___Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   2, Avg loss: 0.0337, Accuracy: 601/1475 (40.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.7411, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.1431, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0752, Accuracy: 46/373 (12.3324%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.3284, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   1, Avg loss: 0.0893, Accuracy: 127/938 (13.5394%)
___Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   2, Avg loss: 0.0376, Accuracy: 281/938 (29.9574%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.4445, Accuracy: 55/10000 (0.5500%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   1, Avg loss: 0.1831, Accuracy: 2/85 (2.3529%)
___Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   2, Avg loss: 0.1813, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 11.2087, Accuracy: 95/10000 (0.9500%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   1, Avg loss: 0.0849, Accuracy: 249/1750 (14.2286%)
___Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   2, Avg loss: 0.0363, Accuracy: 669/1750 (38.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.0957, Accuracy: 127/10000 (1.2700%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   1, Avg loss: 0.1328, Accuracy: 0/530 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   2, Avg loss: 0.0463, Accuracy: 245/530 (46.2264%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 10.6689, Accuracy: 65/10000 (0.6500%)
time spent on training: 185.9146168231964
___Test Target_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.8165, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Avg loss: 2.0747, Accuracy: 0/9950 (0.0000%)
saving model
Done in 590.4066350460052 sec.
Server Epoch:29 choose agents : [10, 11, 42, 19, 88, 80, 54, 78, 92, 96].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Average loss: 0.0781, Accuracy: 207/861 (24.0418%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Average loss: 0.0307, Accuracy: 259/861 (30.0813%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Average loss: 0.0242, Accuracy: 345/861 (40.0697%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Average loss: 0.0229, Accuracy: 365/861 (42.3926%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Average loss: 0.0227, Accuracy: 401/861 (46.5738%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Average loss: 0.0219, Accuracy: 432/861 (50.1742%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Average loss: 0.0212, Accuracy: 443/861 (51.4518%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Average loss: 0.0214, Accuracy: 413/861 (47.9675%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Average loss: 0.0212, Accuracy: 422/861 (49.0128%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Average loss: 0.0212, Accuracy: 429/861 (49.8258%), train_poison_data_count: 280
Global model norm: 209.9389513197825.
Norm before scaling: 209.90825749002823. Distance: 1.123277670323559
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.1562, Accuracy: 85/10000 (0.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.7830, Accuracy: 8333/9950 (83.7487%)
Scaling by  100
Scaled Norm after poisoning: 235.1096818508332, distance: 112.3277718122838
Total norm for 4 adversaries is: 235.1096818508332. distance: 112.3277718122838
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0992, Accuracy: 94/712 (13.2022%)
___Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0364, Accuracy: 443/712 (62.2191%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 11.6598, Accuracy: 77/10000 (0.7700%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   1, Avg loss: 0.0791, Accuracy: 162/1372 (11.8076%)
___Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   2, Avg loss: 0.0334, Accuracy: 475/1372 (34.6210%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.0439, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   1, Avg loss: 0.0809, Accuracy: 218/1036 (21.0425%)
___Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   2, Avg loss: 0.0256, Accuracy: 680/1036 (65.6371%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 14.0054, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.1113, Accuracy: 11/603 (1.8242%)
___Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0493, Accuracy: 288/603 (47.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.5677, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   1, Avg loss: 0.1149, Accuracy: 13/682 (1.9062%)
___Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   2, Avg loss: 0.0434, Accuracy: 278/682 (40.7625%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.4811, Accuracy: 58/10000 (0.5800%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0776, Accuracy: 216/1130 (19.1150%)
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 458/1130 (40.5310%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 10.0985, Accuracy: 55/10000 (0.5500%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.1340, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0615, Accuracy: 98/416 (23.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 9.0291, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   1, Avg loss: 0.0734, Accuracy: 313/1715 (18.2507%)
___Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   2, Avg loss: 0.0315, Accuracy: 710/1715 (41.3994%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.4026, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.1433, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0902, Accuracy: 12/311 (3.8585%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.9543, Accuracy: 77/10000 (0.7700%)
time spent on training: 250.6497507095337
___Test Target_ResNet_18 poisoned: False, epoch: 29: Avg loss: 11.4555, Accuracy: 97/10000 (0.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Avg loss: 2.1263, Accuracy: 2034/9950 (20.4422%)
saving model
Done in 657.1627984046936 sec.
Server Epoch:30 choose agents : [90, 87, 0, 73, 61, 97, 66, 35, 1, 22].
___Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0809, Accuracy: 123/677 (18.1684%)
___Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0255, Accuracy: 463/677 (68.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 12.9424, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   1, Avg loss: 0.0873, Accuracy: 191/1131 (16.8877%)
___Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   2, Avg loss: 0.0336, Accuracy: 370/1131 (32.7144%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.5249, Accuracy: 61/10000 (0.6100%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0650, Accuracy: 278/1657 (16.7773%)
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0338, Accuracy: 523/1657 (31.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.5473, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   1, Avg loss: 0.0831, Accuracy: 157/938 (16.7377%)
___Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   2, Avg loss: 0.0366, Accuracy: 326/938 (34.7548%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.9660, Accuracy: 60/10000 (0.6000%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   1, Avg loss: 0.2000, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   2, Avg loss: 0.1853, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.5588, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   1, Avg loss: 0.0875, Accuracy: 168/1213 (13.8500%)
___Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   2, Avg loss: 0.0291, Accuracy: 502/1213 (41.3850%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 10.0654, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0936, Accuracy: 117/1402 (8.3452%)
___Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0420, Accuracy: 387/1402 (27.6034%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.0659, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   1, Avg loss: 0.1556, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   2, Avg loss: 0.0937, Accuracy: 2/271 (0.7380%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.8368, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0861, Accuracy: 146/928 (15.7328%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0262, Accuracy: 593/928 (63.9009%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 10.7847, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   1, Avg loss: 0.0668, Accuracy: 351/1470 (23.8776%)
___Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   2, Avg loss: 0.0262, Accuracy: 809/1470 (55.0340%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 10.2836, Accuracy: 106/10000 (1.0600%)
time spent on training: 182.84278774261475
___Test Target_ResNet_18 poisoned: False, epoch: 30: Avg loss: 14.0034, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Avg loss: 2.3323, Accuracy: 1663/9950 (16.7136%)
saving model
Done in 587.2127544879913 sec.
Server Epoch:31 choose agents : [12, 97, 60, 95, 0, 45, 47, 74, 1, 90].
poison local model 12 index 5 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   1, Average loss: 0.1007, Accuracy: 53/338 (15.6805%), train_poison_data_count: 118
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   2, Average loss: 0.0752, Accuracy: 116/338 (34.3195%), train_poison_data_count: 118
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   3, Average loss: 0.0507, Accuracy: 118/338 (34.9112%), train_poison_data_count: 118
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   4, Average loss: 0.0473, Accuracy: 118/338 (34.9112%), train_poison_data_count: 118
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   5, Average loss: 0.0433, Accuracy: 117/338 (34.6154%), train_poison_data_count: 118
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   6, Average loss: 0.0403, Accuracy: 119/338 (35.2071%), train_poison_data_count: 118
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   7, Average loss: 0.0372, Accuracy: 127/338 (37.5740%), train_poison_data_count: 118
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   8, Average loss: 0.0354, Accuracy: 118/338 (34.9112%), train_poison_data_count: 118
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   9, Average loss: 0.0349, Accuracy: 139/338 (41.1243%), train_poison_data_count: 118
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch  10, Average loss: 0.0340, Accuracy: 134/338 (39.6450%), train_poison_data_count: 118
Global model norm: 215.20087817838942.
Norm before scaling: 215.18961478774946. Distance: 0.6598289174809525
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.2037, Accuracy: 55/10000 (0.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.7087, Accuracy: 9488/9950 (95.3568%)
Scaling by  100
Scaled Norm after poisoning: 223.91096689030218, distance: 65.98289314284423
Total norm for 5 adversaries is: 223.91096689030218. distance: 65.98289314284423
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0833, Accuracy: 177/1213 (14.5919%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0287, Accuracy: 537/1213 (44.2704%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 10.5691, Accuracy: 79/10000 (0.7900%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0673, Accuracy: 471/2227 (21.1495%)
___Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0285, Accuracy: 1034/2227 (46.4302%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.0257, Accuracy: 129/10000 (1.2900%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.1044, Accuracy: 68/599 (11.3523%)
___Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0365, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 15.9331, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0619, Accuracy: 290/1657 (17.5015%)
___Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 519/1657 (31.3217%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.5878, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   1, Avg loss: 0.1067, Accuracy: 39/669 (5.8296%)
___Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   2, Avg loss: 0.0459, Accuracy: 355/669 (53.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.1785, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   1, Avg loss: 0.2007, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   2, Avg loss: 0.1742, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.0679, Accuracy: 70/10000 (0.7000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   1, Avg loss: 0.0633, Accuracy: 345/1552 (22.2294%)
___Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   2, Avg loss: 0.0222, Accuracy: 750/1552 (48.3247%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 12.1426, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0810, Accuracy: 166/928 (17.8879%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0250, Accuracy: 603/928 (64.9784%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 11.2767, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   1, Avg loss: 0.0796, Accuracy: 121/677 (17.8730%)
___Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   2, Avg loss: 0.0246, Accuracy: 455/677 (67.2083%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 12.6666, Accuracy: 63/10000 (0.6300%)
time spent on training: 269.62888646125793
___Test Target_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.7353, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.4844, Accuracy: 9033/9950 (90.7839%)
saving model
Done in 667.1499087810516 sec.
Server Epoch:32 choose agents : [90, 32, 84, 98, 78, 46, 40, 68, 29, 95].
___Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0613, Accuracy: 171/677 (25.2585%)
___Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0225, Accuracy: 455/677 (67.2083%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 12.3979, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0592, Accuracy: 186/735 (25.3061%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0261, Accuracy: 350/735 (47.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 11.7473, Accuracy: 54/10000 (0.5400%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0765, Accuracy: 215/1190 (18.0672%)
___Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 475/1190 (39.9160%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.3792, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   1, Avg loss: 0.0964, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   2, Avg loss: 0.0515, Accuracy: 94/373 (25.2011%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.8071, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   1, Avg loss: 0.1032, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   2, Avg loss: 0.0522, Accuracy: 155/416 (37.2596%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.1492, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0604, Accuracy: 386/1904 (20.2731%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 738/1904 (38.7605%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.0812, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   1, Avg loss: 0.0688, Accuracy: 234/1573 (14.8760%)
___Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   2, Avg loss: 0.0355, Accuracy: 577/1573 (36.6815%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.1417, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   1, Avg loss: 0.0738, Accuracy: 250/1163 (21.4961%)
___Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   2, Avg loss: 0.0398, Accuracy: 436/1163 (37.4893%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.1994, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   1, Avg loss: 0.0546, Accuracy: 359/1440 (24.9306%)
___Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   2, Avg loss: 0.0288, Accuracy: 645/1440 (44.7917%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 9.1137, Accuracy: 91/10000 (0.9100%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0882, Accuracy: 106/599 (17.6962%)
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0339, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 14.7445, Accuracy: 50/10000 (0.5000%)
time spent on training: 195.28595352172852
___Test Target_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.4808, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Avg loss: 1.0469, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 602.5206770896912 sec.
Server Epoch:33 choose agents : [15, 44, 14, 40, 61, 33, 88, 73, 21, 30].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Average loss: 0.0668, Accuracy: 351/1154 (30.4159%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Average loss: 0.0341, Accuracy: 391/1154 (33.8821%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Average loss: 0.0279, Accuracy: 463/1154 (40.1213%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Average loss: 0.0277, Accuracy: 469/1154 (40.6412%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Average loss: 0.0272, Accuracy: 467/1154 (40.4679%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Average loss: 0.0267, Accuracy: 474/1154 (41.0745%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Average loss: 0.0256, Accuracy: 501/1154 (43.4142%), train_poison_data_count: 362
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Average loss: 0.0261, Accuracy: 508/1154 (44.0208%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Average loss: 0.0256, Accuracy: 529/1154 (45.8406%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Average loss: 0.0250, Accuracy: 537/1154 (46.5338%), train_poison_data_count: 362
Global model norm: 220.36258295988.
Norm before scaling: 220.31842190622643. Distance: 1.226914665059031
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.9580, Accuracy: 79/10000 (0.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.9965, Accuracy: 6450/9950 (64.8241%)
Scaling by  100
Scaled Norm after poisoning: 248.02412937051105, distance: 122.69147583343963
Total norm for 5 adversaries is: 248.02412937051105. distance: 122.69147583343963
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Avg loss: 0.0688, Accuracy: 279/1750 (15.9429%)
___Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 676/1750 (38.6286%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.0613, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0854, Accuracy: 95/1013 (9.3781%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0367, Accuracy: 371/1013 (36.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.0451, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   1, Avg loss: 0.0667, Accuracy: 274/1573 (17.4189%)
___Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   2, Avg loss: 0.0360, Accuracy: 577/1573 (36.6815%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.2713, Accuracy: 86/10000 (0.8600%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   1, Avg loss: 0.1176, Accuracy: 3/85 (3.5294%)
___Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   2, Avg loss: 0.1107, Accuracy: 9/85 (10.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.1506, Accuracy: 61/10000 (0.6100%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   1, Avg loss: 0.0955, Accuracy: 32/515 (6.2136%)
___Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   2, Avg loss: 0.0622, Accuracy: 128/515 (24.8544%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.6847, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   1, Avg loss: 0.0805, Accuracy: 60/603 (9.9502%)
___Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   2, Avg loss: 0.0466, Accuracy: 283/603 (46.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.3654, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   1, Avg loss: 0.0660, Accuracy: 226/938 (24.0938%)
___Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   2, Avg loss: 0.0343, Accuracy: 328/938 (34.9680%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.4083, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   1, Avg loss: 0.0614, Accuracy: 274/1949 (14.0585%)
___Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   2, Avg loss: 0.0339, Accuracy: 601/1949 (30.8363%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.0167, Accuracy: 91/10000 (0.9100%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   1, Avg loss: 0.0983, Accuracy: 5/486 (1.0288%)
___Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   2, Avg loss: 0.0468, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.7903, Accuracy: 53/10000 (0.5300%)
time spent on training: 288.52761340141296
___Test Target_ResNet_18 poisoned: False, epoch: 33: Avg loss: 11.4079, Accuracy: 77/10000 (0.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Avg loss: 2.2929, Accuracy: 1387/9950 (13.9397%)
saving model
Done in 686.9284889698029 sec.
Server Epoch:34 choose agents : [0, 71, 20, 83, 56, 36, 68, 89, 82, 19].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   1, Avg loss: 0.0656, Accuracy: 261/1657 (15.7514%)
___Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 507/1657 (30.5975%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.9337, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0970, Accuracy: 52/818 (6.3570%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0341, Accuracy: 320/818 (39.1198%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.5378, Accuracy: 73/10000 (0.7300%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   1, Avg loss: 0.0868, Accuracy: 123/807 (15.2416%)
___Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   2, Avg loss: 0.0373, Accuracy: 410/807 (50.8055%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.6968, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0687, Accuracy: 315/1953 (16.1290%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0345, Accuracy: 717/1953 (36.7127%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.2458, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   1, Avg loss: 0.1327, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   2, Avg loss: 0.1084, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.0580, Accuracy: 81/10000 (0.8100%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   1, Avg loss: 0.1387, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   2, Avg loss: 0.0714, Accuracy: 77/408 (18.8725%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.9806, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   1, Avg loss: 0.0822, Accuracy: 216/1163 (18.5727%)
___Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   2, Avg loss: 0.0398, Accuracy: 460/1163 (39.5529%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.2193, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   1, Avg loss: 0.0898, Accuracy: 187/896 (20.8705%)
___Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   2, Avg loss: 0.0401, Accuracy: 464/896 (51.7857%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.1431, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.1141, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0572, Accuracy: 121/500 (24.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.7685, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   1, Avg loss: 0.0723, Accuracy: 252/1036 (24.3243%)
___Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   2, Avg loss: 0.0289, Accuracy: 660/1036 (63.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 14.2148, Accuracy: 68/10000 (0.6800%)
time spent on training: 198.41222977638245
___Test Target_ResNet_18 poisoned: False, epoch: 34: Avg loss: 13.0871, Accuracy: 67/10000 (0.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Avg loss: 2.8887, Accuracy: 591/9950 (5.9397%)
saving model
Done in 600.2036292552948 sec.
Server Epoch:35 choose agents : [18, 75, 5, 22, 38, 73, 46, 20, 83, 88].
poison local model 18 index 7 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   1, Average loss: 0.0757, Accuracy: 121/530 (22.8302%), train_poison_data_count: 178
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   2, Average loss: 0.0436, Accuracy: 189/530 (35.6604%), train_poison_data_count: 178
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   3, Average loss: 0.0349, Accuracy: 195/530 (36.7925%), train_poison_data_count: 178
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   4, Average loss: 0.0324, Accuracy: 231/530 (43.5849%), train_poison_data_count: 178
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   5, Average loss: 0.0326, Accuracy: 235/530 (44.3396%), train_poison_data_count: 178
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   6, Average loss: 0.0290, Accuracy: 248/530 (46.7925%), train_poison_data_count: 178
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   7, Average loss: 0.0311, Accuracy: 243/530 (45.8491%), train_poison_data_count: 178
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   8, Average loss: 0.0311, Accuracy: 247/530 (46.6038%), train_poison_data_count: 178
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   9, Average loss: 0.0303, Accuracy: 247/530 (46.6038%), train_poison_data_count: 178
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch  10, Average loss: 0.0306, Accuracy: 244/530 (46.0377%), train_poison_data_count: 178
Global model norm: 225.35843845139237.
Norm before scaling: 225.33967415881295. Distance: 0.7160663676244438
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.2219, Accuracy: 62/10000 (0.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.7548, Accuracy: 7607/9950 (76.4523%)
Scaling by  100
Scaled Norm after poisoning: 234.55481435583454, distance: 71.6066321343561
Total norm for 3 adversaries is: 234.55481435583454. distance: 71.6066321343561
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   1, Avg loss: 0.0981, Accuracy: 99/776 (12.7577%)
___Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   2, Avg loss: 0.0353, Accuracy: 411/776 (52.9639%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.5403, Accuracy: 77/10000 (0.7700%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   1, Avg loss: 0.0597, Accuracy: 291/1628 (17.8747%)
___Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   2, Avg loss: 0.0245, Accuracy: 794/1628 (48.7715%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 10.1388, Accuracy: 135/10000 (1.3500%)
___Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   1, Avg loss: 0.0658, Accuracy: 334/1470 (22.7211%)
___Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   2, Avg loss: 0.0263, Accuracy: 851/1470 (57.8912%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 10.4593, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   1, Avg loss: 0.0874, Accuracy: 176/1131 (15.5615%)
___Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   2, Avg loss: 0.0333, Accuracy: 522/1131 (46.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.5757, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   1, Avg loss: 0.0708, Accuracy: 165/938 (17.5906%)
___Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   2, Avg loss: 0.0339, Accuracy: 339/938 (36.1407%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.9977, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   1, Avg loss: 0.0648, Accuracy: 357/1904 (18.7500%)
___Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   2, Avg loss: 0.0310, Accuracy: 723/1904 (37.9727%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.3483, Accuracy: 130/10000 (1.3000%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   1, Avg loss: 0.0809, Accuracy: 137/807 (16.9765%)
___Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   2, Avg loss: 0.0364, Accuracy: 420/807 (52.0446%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.8680, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   1, Avg loss: 0.0657, Accuracy: 343/1953 (17.5627%)
___Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 726/1953 (37.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.4693, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   1, Avg loss: 0.1001, Accuracy: 23/603 (3.8143%)
___Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   2, Avg loss: 0.0500, Accuracy: 294/603 (48.7562%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.9763, Accuracy: 61/10000 (0.6100%)
time spent on training: 257.249116897583
___Test Target_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.8975, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.4809, Accuracy: 8538/9950 (85.8090%)
saving model
Done in 664.9081618785858 sec.
Server Epoch:36 choose agents : [19, 2, 97, 73, 5, 51, 21, 63, 11, 90].
___Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   1, Avg loss: 0.0666, Accuracy: 270/1036 (26.0618%)
___Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   2, Avg loss: 0.0272, Accuracy: 648/1036 (62.5483%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 13.1025, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0941, Accuracy: 40/605 (6.6116%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0436, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.1062, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   1, Avg loss: 0.0637, Accuracy: 322/1213 (26.5458%)
___Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   2, Avg loss: 0.0284, Accuracy: 530/1213 (43.6933%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.0779, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   1, Avg loss: 0.0684, Accuracy: 179/938 (19.0832%)
___Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   2, Avg loss: 0.0339, Accuracy: 338/938 (36.0341%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.8137, Accuracy: 81/10000 (0.8100%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   1, Avg loss: 0.0564, Accuracy: 306/1628 (18.7961%)
___Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   2, Avg loss: 0.0245, Accuracy: 812/1628 (49.8771%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 9.5897, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0834, Accuracy: 134/1049 (12.7741%)
___Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0307, Accuracy: 506/1049 (48.2364%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.9703, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   1, Avg loss: 0.0644, Accuracy: 281/1949 (14.4177%)
___Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 633/1949 (32.4782%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.8547, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   1, Avg loss: 0.0915, Accuracy: 103/888 (11.5991%)
___Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   2, Avg loss: 0.0285, Accuracy: 447/888 (50.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 11.7389, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0872, Accuracy: 135/712 (18.9607%)
___Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0303, Accuracy: 440/712 (61.7978%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 10.3827, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   1, Avg loss: 0.0675, Accuracy: 147/677 (21.7134%)
___Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   2, Avg loss: 0.0215, Accuracy: 471/677 (69.5716%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 12.5476, Accuracy: 62/10000 (0.6200%)
time spent on training: 196.2903697490692
___Test Target_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.7857, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Avg loss: 1.3458, Accuracy: 0/9950 (0.0000%)
saving model
Done in 601.2930970191956 sec.
Server Epoch:37 choose agents : [20, 66, 18, 64, 77, 51, 65, 3, 17, 50].
poison local model 20 index 8 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   1, Average loss: 0.0634, Accuracy: 220/807 (27.2615%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   2, Average loss: 0.0369, Accuracy: 321/807 (39.7770%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   3, Average loss: 0.0316, Accuracy: 314/807 (38.9095%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   4, Average loss: 0.0294, Accuracy: 330/807 (40.8922%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   5, Average loss: 0.0283, Accuracy: 365/807 (45.2292%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   6, Average loss: 0.0281, Accuracy: 360/807 (44.6097%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   7, Average loss: 0.0278, Accuracy: 355/807 (43.9901%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   8, Average loss: 0.0270, Accuracy: 385/807 (47.7076%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   9, Average loss: 0.0269, Accuracy: 373/807 (46.2206%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch  10, Average loss: 0.0260, Accuracy: 391/807 (48.4511%), train_poison_data_count: 260
Global model norm: 230.28770219282228.
Norm before scaling: 230.25814317847696. Distance: 0.8677390466744447
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.0520, Accuracy: 74/10000 (0.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.8369, Accuracy: 7927/9950 (79.6683%)
Scaling by  100
Scaled Norm after poisoning: 243.15760546145785, distance: 86.77390982191162
Total norm for 4 adversaries is: 243.15760546145785. distance: 86.77390982191162
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   1, Avg loss: 0.0771, Accuracy: 199/1402 (14.1940%)
___Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   2, Avg loss: 0.0415, Accuracy: 405/1402 (28.8873%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.1822, Accuracy: 80/10000 (0.8000%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   1, Avg loss: 0.0364, Accuracy: 239/530 (45.0943%)
___Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   2, Avg loss: 0.0288, Accuracy: 321/530 (60.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.9507, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   1, Avg loss: 0.0795, Accuracy: 105/953 (11.0178%)
___Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   2, Avg loss: 0.0399, Accuracy: 320/953 (33.5782%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.3096, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0702, Accuracy: 237/1340 (17.6866%)
___Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0297, Accuracy: 550/1340 (41.0448%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.9315, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0791, Accuracy: 143/1049 (13.6320%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0321, Accuracy: 466/1049 (44.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.8082, Accuracy: 111/10000 (1.1100%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   1, Avg loss: 0.0686, Accuracy: 311/1475 (21.0847%)
___Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   2, Avg loss: 0.0345, Accuracy: 599/1475 (40.6102%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.1368, Accuracy: 84/10000 (0.8400%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   1, Avg loss: 0.0864, Accuracy: 32/781 (4.0973%)
___Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   2, Avg loss: 0.0346, Accuracy: 251/781 (32.1383%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.8493, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   1, Avg loss: 0.0632, Accuracy: 260/1574 (16.5184%)
___Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   2, Avg loss: 0.0297, Accuracy: 646/1574 (41.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.2734, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   1, Avg loss: 0.0802, Accuracy: 78/809 (9.6415%)
___Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   2, Avg loss: 0.0283, Accuracy: 338/809 (41.7800%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 10.4682, Accuracy: 104/10000 (1.0400%)
time spent on training: 266.2035114765167
___Test Target_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.7036, Accuracy: 73/10000 (0.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Avg loss: 1.5963, Accuracy: 3301/9950 (33.1759%)
saving model
Done in 672.8135778903961 sec.
Server Epoch:38 choose agents : [88, 72, 77, 38, 20, 39, 70, 1, 37, 6].
___Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0977, Accuracy: 27/603 (4.4776%)
___Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0496, Accuracy: 291/603 (48.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.3177, Accuracy: 63/10000 (0.6300%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0770, Accuracy: 145/1241 (11.6841%)
___Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0386, Accuracy: 420/1241 (33.8437%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.5953, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0731, Accuracy: 223/1340 (16.6418%)
___Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0292, Accuracy: 603/1340 (45.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 10.1995, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0863, Accuracy: 134/1131 (11.8479%)
___Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0316, Accuracy: 505/1131 (44.6508%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.8675, Accuracy: 106/10000 (1.0600%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0281, Accuracy: 430/807 (53.2838%)
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0223, Accuracy: 479/807 (59.3556%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.4780, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0696, Accuracy: 166/1013 (16.3870%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0273, Accuracy: 492/1013 (48.5686%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.9896, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0755, Accuracy: 251/1418 (17.7010%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0339, Accuracy: 609/1418 (42.9478%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.7339, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0726, Accuracy: 194/928 (20.9052%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0263, Accuracy: 588/928 (63.3621%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 10.4658, Accuracy: 104/10000 (1.0400%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0687, Accuracy: 274/1129 (24.2693%)
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0252, Accuracy: 733/1129 (64.9247%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 10.2582, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   1, Avg loss: 0.0642, Accuracy: 339/1956 (17.3313%)
___Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   2, Avg loss: 0.0328, Accuracy: 648/1956 (33.1288%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.5522, Accuracy: 97/10000 (0.9700%)
time spent on training: 221.72011733055115
___Test Target_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.0839, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Avg loss: 1.3627, Accuracy: 30/9950 (0.3015%)
saving model
Done in 626.5531072616577 sec.
Server Epoch:39 choose agents : [24, 58, 63, 88, 9, 51, 54, 64, 13, 27].
poison local model 24 index 9 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   1, Average loss: 0.0760, Accuracy: 51/312 (16.3462%), train_poison_data_count: 100
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   2, Average loss: 0.0515, Accuracy: 95/312 (30.4487%), train_poison_data_count: 100
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   3, Average loss: 0.0353, Accuracy: 116/312 (37.1795%), train_poison_data_count: 100
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   4, Average loss: 0.0311, Accuracy: 128/312 (41.0256%), train_poison_data_count: 100
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   5, Average loss: 0.0344, Accuracy: 134/312 (42.9487%), train_poison_data_count: 100
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   6, Average loss: 0.0305, Accuracy: 139/312 (44.5513%), train_poison_data_count: 100
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   7, Average loss: 0.0291, Accuracy: 139/312 (44.5513%), train_poison_data_count: 100
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   8, Average loss: 0.0317, Accuracy: 132/312 (42.3077%), train_poison_data_count: 100
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   9, Average loss: 0.0270, Accuracy: 152/312 (48.7179%), train_poison_data_count: 100
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch  10, Average loss: 0.0302, Accuracy: 139/312 (44.5513%), train_poison_data_count: 100
Global model norm: 235.10291961713278.
Norm before scaling: 235.09448732105565. Distance: 0.500104744191847
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.6676, Accuracy: 81/10000 (0.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: 1.1585, Accuracy: 5692/9950 (57.2060%)
Scaling by  100
Scaled Norm after poisoning: 239.48474148941096, distance: 50.010472536072385
Total norm for 3 adversaries is: 239.48474148941096. distance: 50.010472536072385
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0753, Accuracy: 203/803 (25.2802%)
___Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0387, Accuracy: 437/803 (54.4209%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.5879, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0863, Accuracy: 97/888 (10.9234%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0280, Accuracy: 430/888 (48.4234%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 11.4071, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   1, Avg loss: 0.0929, Accuracy: 30/603 (4.9751%)
___Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   2, Avg loss: 0.0496, Accuracy: 282/603 (46.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.2796, Accuracy: 61/10000 (0.6100%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0536, Accuracy: 331/1275 (25.9608%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0185, Accuracy: 712/1275 (55.8431%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 11.7572, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0817, Accuracy: 146/1049 (13.9180%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0311, Accuracy: 470/1049 (44.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.4732, Accuracy: 109/10000 (1.0900%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   1, Avg loss: 0.0676, Accuracy: 226/1130 (20.0000%)
___Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 458/1130 (40.5310%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 10.0872, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   1, Avg loss: 0.0821, Accuracy: 82/953 (8.6044%)
___Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   2, Avg loss: 0.0395, Accuracy: 309/953 (32.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.0543, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   1, Avg loss: 0.0687, Accuracy: 266/1645 (16.1702%)
___Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   2, Avg loss: 0.0337, Accuracy: 637/1645 (38.7234%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.7251, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0639, Accuracy: 321/1587 (20.2268%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 592/1587 (37.3031%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.1471, Accuracy: 74/10000 (0.7400%)
time spent on training: 249.85322499275208
___Test Target_ResNet_18 poisoned: False, epoch: 39: Avg loss: 9.3126, Accuracy: 68/10000 (0.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Avg loss: 2.7159, Accuracy: 634/9950 (6.3719%)
saving model
Done in 658.466977596283 sec.
Server Epoch:40 choose agents : [40, 88, 66, 47, 61, 96, 3, 5, 16, 24].
___Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   1, Avg loss: 0.0716, Accuracy: 217/1573 (13.7953%)
___Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   2, Avg loss: 0.0360, Accuracy: 569/1573 (36.1729%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.5033, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   1, Avg loss: 0.0940, Accuracy: 32/603 (5.3068%)
___Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   2, Avg loss: 0.0484, Accuracy: 290/603 (48.0929%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.5316, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   1, Avg loss: 0.0788, Accuracy: 187/1402 (13.3381%)
___Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   2, Avg loss: 0.0413, Accuracy: 393/1402 (28.0314%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.0651, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1654, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1411, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.2496, Accuracy: 71/10000 (0.7100%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   1, Avg loss: 0.1718, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   2, Avg loss: 0.1515, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.9436, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   1, Avg loss: 0.1284, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   2, Avg loss: 0.0826, Accuracy: 21/311 (6.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.9023, Accuracy: 57/10000 (0.5700%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   1, Avg loss: 0.0862, Accuracy: 31/781 (3.9693%)
___Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   2, Avg loss: 0.0338, Accuracy: 277/781 (35.4673%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.4343, Accuracy: 89/10000 (0.8900%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   1, Avg loss: 0.0550, Accuracy: 285/1628 (17.5061%)
___Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   2, Avg loss: 0.0249, Accuracy: 800/1628 (49.1400%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.9431, Accuracy: 136/10000 (1.3600%)
___Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   1, Avg loss: 0.0759, Accuracy: 151/708 (21.3277%)
___Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   2, Avg loss: 0.0386, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.1003, Accuracy: 64/10000 (0.6400%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   1, Avg loss: 0.0303, Accuracy: 181/312 (58.0128%)
___Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   2, Avg loss: 0.0267, Accuracy: 206/312 (66.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.6164, Accuracy: 84/10000 (0.8400%)
time spent on training: 197.2002556324005
___Test Target_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.4067, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Avg loss: 2.7852, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 593.7862846851349 sec.
Server Epoch:41 choose agents : [25, 36, 82, 2, 93, 42, 66, 94, 44, 38].
poison local model 25 index 10 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Average loss: 0.0675, Accuracy: 135/690 (19.5652%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Average loss: 0.0342, Accuracy: 309/690 (44.7826%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   3, Average loss: 0.0278, Accuracy: 275/690 (39.8551%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   4, Average loss: 0.0254, Accuracy: 333/690 (48.2609%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   5, Average loss: 0.0229, Accuracy: 351/690 (50.8696%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   6, Average loss: 0.0239, Accuracy: 341/690 (49.4203%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   7, Average loss: 0.0226, Accuracy: 352/690 (51.0145%), train_poison_data_count: 220
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   8, Average loss: 0.0223, Accuracy: 369/690 (53.4783%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   9, Average loss: 0.0225, Accuracy: 357/690 (51.7391%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch  10, Average loss: 0.0233, Accuracy: 320/690 (46.3768%), train_poison_data_count: 220
Global model norm: 239.84743686091375.
Norm before scaling: 239.82228120527083. Distance: 0.8691357558896265
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.8324, Accuracy: 71/10000 (0.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.9636, Accuracy: 5453/9950 (54.8040%)
Scaling by  100
Scaled Norm after poisoning: 252.58261334165502, distance: 86.91357619245971
Total norm for 4 adversaries is: 252.58261334165502. distance: 86.91357619245971
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   1, Avg loss: 0.1120, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   2, Avg loss: 0.0616, Accuracy: 108/408 (26.4706%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.0121, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   1, Avg loss: 0.0974, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   2, Avg loss: 0.0528, Accuracy: 160/500 (32.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.6227, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0879, Accuracy: 58/605 (9.5868%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0455, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.2609, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   1, Avg loss: 0.0660, Accuracy: 293/1742 (16.8197%)
___Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   2, Avg loss: 0.0312, Accuracy: 686/1742 (39.3800%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.9253, Accuracy: 103/10000 (1.0300%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   1, Avg loss: 0.0703, Accuracy: 223/1372 (16.2536%)
___Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   2, Avg loss: 0.0334, Accuracy: 519/1372 (37.8280%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 9.2123, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0770, Accuracy: 177/1402 (12.6248%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0417, Accuracy: 384/1402 (27.3894%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.3238, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   1, Avg loss: 0.0677, Accuracy: 227/1662 (13.6582%)
___Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   2, Avg loss: 0.0343, Accuracy: 589/1662 (35.4392%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.9271, Accuracy: 101/10000 (1.0100%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0724, Accuracy: 297/1750 (16.9714%)
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0366, Accuracy: 648/1750 (37.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.0908, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0782, Accuracy: 145/1131 (12.8205%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0322, Accuracy: 515/1131 (45.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.7735, Accuracy: 99/10000 (0.9900%)
time spent on training: 283.34630823135376
___Test Target_ResNet_18 poisoned: False, epoch: 41: Avg loss: 11.9301, Accuracy: 62/10000 (0.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Avg loss: 1.7213, Accuracy: 2485/9950 (24.9749%)
saving model
Saving model on epoch 41
Done in 690.3996570110321 sec.
Server Epoch:42 choose agents : [55, 57, 12, 67, 31, 76, 26, 6, 64, 97].
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   1, Avg loss: 0.0741, Accuracy: 172/1071 (16.0598%)
___Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   2, Avg loss: 0.0320, Accuracy: 495/1071 (46.2185%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 10.2819, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   1, Avg loss: 0.0760, Accuracy: 163/1154 (14.1248%)
___Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   2, Avg loss: 0.0288, Accuracy: 513/1154 (44.4541%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 11.1757, Accuracy: 76/10000 (0.7600%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   1, Avg loss: 0.1273, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   2, Avg loss: 0.0599, Accuracy: 58/338 (17.1598%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.6257, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.1100, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0459, Accuracy: 116/426 (27.2300%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.5469, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.1166, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0448, Accuracy: 163/460 (35.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.1266, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   1, Avg loss: 0.1142, Accuracy: 1/466 (0.2146%)
___Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   2, Avg loss: 0.0572, Accuracy: 165/466 (35.4077%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.8323, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   1, Avg loss: 0.0752, Accuracy: 226/1446 (15.6293%)
___Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   2, Avg loss: 0.0353, Accuracy: 542/1446 (37.4827%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.2409, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   1, Avg loss: 0.0652, Accuracy: 315/1956 (16.1043%)
___Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   2, Avg loss: 0.0334, Accuracy: 656/1956 (33.5378%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.5010, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0869, Accuracy: 91/953 (9.5488%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0403, Accuracy: 309/953 (32.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.1751, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   1, Avg loss: 0.0764, Accuracy: 218/1213 (17.9720%)
___Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   2, Avg loss: 0.0287, Accuracy: 554/1213 (45.6719%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 10.1839, Accuracy: 83/10000 (0.8300%)
time spent on training: 186.488383769989
___Test Target_ResNet_18 poisoned: False, epoch: 42: Avg loss: 14.3872, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Avg loss: 2.0140, Accuracy: 2446/9950 (24.5829%)
saving model
Saving model on epoch 42
Done in 576.906888961792 sec.
Server Epoch:43 choose agents : [30, 89, 47, 67, 72, 23, 57, 51, 45, 60].
poison local model 30 index 11 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Average loss: 0.0816, Accuracy: 129/486 (26.5432%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Average loss: 0.0501, Accuracy: 149/486 (30.6584%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   3, Average loss: 0.0409, Accuracy: 148/486 (30.4527%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   4, Average loss: 0.0374, Accuracy: 155/486 (31.8930%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   5, Average loss: 0.0344, Accuracy: 174/486 (35.8025%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   6, Average loss: 0.0333, Accuracy: 187/486 (38.4774%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   7, Average loss: 0.0337, Accuracy: 179/486 (36.8313%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   8, Average loss: 0.0335, Accuracy: 187/486 (38.4774%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   9, Average loss: 0.0330, Accuracy: 191/486 (39.3004%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch  10, Average loss: 0.0319, Accuracy: 204/486 (41.9753%), train_poison_data_count: 160
Global model norm: 244.47571454031993.
Norm before scaling: 244.45859343915484. Distance: 0.7055631960891505
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.6836, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.9388, Accuracy: 7309/9950 (73.4573%)
Scaling by  100
Scaled Norm after poisoning: 252.70638224033837, distance: 70.55632377199616
Total norm for 3 adversaries is: 252.70638224033837. distance: 70.55632377199616
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0808, Accuracy: 204/896 (22.7679%)
___Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0393, Accuracy: 438/896 (48.8839%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.0673, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   1, Avg loss: 0.1763, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   2, Avg loss: 0.1389, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.6031, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   1, Avg loss: 0.1022, Accuracy: 1/426 (0.2347%)
___Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   2, Avg loss: 0.0455, Accuracy: 126/426 (29.5775%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.7156, Accuracy: 57/10000 (0.5700%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   1, Avg loss: 0.0783, Accuracy: 132/1241 (10.6366%)
___Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   2, Avg loss: 0.0382, Accuracy: 375/1241 (30.2176%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.5287, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   1, Avg loss: 0.0831, Accuracy: 146/715 (20.4196%)
___Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   2, Avg loss: 0.0445, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.1992, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   1, Avg loss: 0.0722, Accuracy: 172/1154 (14.9047%)
___Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   2, Avg loss: 0.0295, Accuracy: 477/1154 (41.3345%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 11.5194, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   1, Avg loss: 0.0763, Accuracy: 173/1049 (16.4919%)
___Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   2, Avg loss: 0.0312, Accuracy: 469/1049 (44.7092%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.3911, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0940, Accuracy: 42/669 (6.2780%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0417, Accuracy: 360/669 (53.8117%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.8491, Accuracy: 78/10000 (0.7800%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   1, Avg loss: 0.0608, Accuracy: 498/2227 (22.3619%)
___Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   2, Avg loss: 0.0293, Accuracy: 990/2227 (44.4544%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.7549, Accuracy: 121/10000 (1.2100%)
time spent on training: 260.3746531009674
___Test Target_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.9422, Accuracy: 45/10000 (0.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Avg loss: 1.5887, Accuracy: 3779/9950 (37.9799%)
saving model
Done in 665.8530442714691 sec.
Server Epoch:44 choose agents : [20, 45, 15, 72, 6, 60, 59, 46, 31, 84].
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0600, Accuracy: 191/807 (23.6679%)
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0296, Accuracy: 423/807 (52.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.4924, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   1, Avg loss: 0.0826, Accuracy: 82/669 (12.2571%)
___Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   2, Avg loss: 0.0415, Accuracy: 359/669 (53.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.9489, Accuracy: 74/10000 (0.7400%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0574, Accuracy: 284/1154 (24.6101%)
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0267, Accuracy: 532/1154 (46.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 10.5161, Accuracy: 79/10000 (0.7900%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   1, Avg loss: 0.0756, Accuracy: 131/1241 (10.5560%)
___Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   2, Avg loss: 0.0388, Accuracy: 391/1241 (31.5068%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.5840, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   1, Avg loss: 0.0599, Accuracy: 340/1956 (17.3824%)
___Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   2, Avg loss: 0.0329, Accuracy: 651/1956 (33.2822%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.5200, Accuracy: 112/10000 (1.1200%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   1, Avg loss: 0.0599, Accuracy: 490/2227 (22.0027%)
___Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   2, Avg loss: 0.0294, Accuracy: 963/2227 (43.2420%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.7413, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   1, Avg loss: 0.0740, Accuracy: 186/1089 (17.0799%)
___Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   2, Avg loss: 0.0336, Accuracy: 539/1089 (49.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 10.5979, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   1, Avg loss: 0.0588, Accuracy: 367/1904 (19.2752%)
___Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   2, Avg loss: 0.0311, Accuracy: 747/1904 (39.2332%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.4595, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.1027, Accuracy: 3/460 (0.6522%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0436, Accuracy: 181/460 (39.3478%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.2047, Accuracy: 58/10000 (0.5800%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   1, Avg loss: 0.0778, Accuracy: 222/1190 (18.6555%)
___Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   2, Avg loss: 0.0313, Accuracy: 492/1190 (41.3445%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.5498, Accuracy: 96/10000 (0.9600%)
time spent on training: 250.66149234771729
___Test Target_ResNet_18 poisoned: False, epoch: 44: Avg loss: 10.0917, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Avg loss: 1.1284, Accuracy: 5873/9950 (59.0251%)
saving model
Done in 646.0960876941681 sec.
Server Epoch:45 choose agents : [33, 77, 72, 6, 23, 47, 93, 87, 53, 86].
poison local model 33 index 12 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   1, Average loss: 0.0822, Accuracy: 127/515 (24.6602%), train_poison_data_count: 163
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   2, Average loss: 0.0618, Accuracy: 156/515 (30.2913%), train_poison_data_count: 163
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   3, Average loss: 0.0478, Accuracy: 171/515 (33.2039%), train_poison_data_count: 163
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   4, Average loss: 0.0470, Accuracy: 166/515 (32.2330%), train_poison_data_count: 163
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   5, Average loss: 0.0466, Accuracy: 163/515 (31.6505%), train_poison_data_count: 163
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   6, Average loss: 0.0448, Accuracy: 167/515 (32.4272%), train_poison_data_count: 163
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   7, Average loss: 0.0447, Accuracy: 169/515 (32.8155%), train_poison_data_count: 163
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   8, Average loss: 0.0421, Accuracy: 169/515 (32.8155%), train_poison_data_count: 163
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   9, Average loss: 0.0414, Accuracy: 177/515 (34.3689%), train_poison_data_count: 163
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch  10, Average loss: 0.0421, Accuracy: 173/515 (33.5922%), train_poison_data_count: 163
Global model norm: 248.98180938825632.
Norm before scaling: 248.96162480390427. Distance: 0.7383887803015726
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.0184, Accuracy: 57/10000 (0.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.9794, Accuracy: 8575/9950 (86.1809%)
Scaling by  100
Scaled Norm after poisoning: 257.6525640276068, distance: 73.83887322554936
Total norm for 2 adversaries is: 257.6525640276068. distance: 73.83887322554936
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   1, Avg loss: 0.0644, Accuracy: 289/1340 (21.5672%)
___Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   2, Avg loss: 0.0303, Accuracy: 557/1340 (41.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.6877, Accuracy: 84/10000 (0.8400%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   1, Avg loss: 0.0729, Accuracy: 133/1241 (10.7172%)
___Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   2, Avg loss: 0.0387, Accuracy: 377/1241 (30.3787%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.9399, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   1, Avg loss: 0.0587, Accuracy: 337/1956 (17.2290%)
___Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 706/1956 (36.0941%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.8419, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   1, Avg loss: 0.0803, Accuracy: 149/715 (20.8392%)
___Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   2, Avg loss: 0.0422, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.4185, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   1, Avg loss: 0.1539, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   2, Avg loss: 0.1351, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.7684, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0665, Accuracy: 305/1742 (17.5086%)
___Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 696/1742 (39.9541%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.1306, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   1, Avg loss: 0.0783, Accuracy: 166/1131 (14.6773%)
___Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   2, Avg loss: 0.0327, Accuracy: 421/1131 (37.2237%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 9.0187, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   1, Avg loss: 0.0741, Accuracy: 145/813 (17.8352%)
___Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   2, Avg loss: 0.0213, Accuracy: 467/813 (57.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 13.3070, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0827, Accuracy: 212/1003 (21.1366%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0391, Accuracy: 425/1003 (42.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.6791, Accuracy: 47/10000 (0.4700%)
time spent on training: 254.50353455543518
___Test Target_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.4009, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Avg loss: 1.0128, Accuracy: 7700/9950 (77.3869%)
saving model
Done in 646.5647141933441 sec.
Server Epoch:46 choose agents : [43, 30, 40, 2, 69, 83, 22, 84, 91, 15].
___Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   1, Avg loss: 0.0734, Accuracy: 201/946 (21.2474%)
___Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   2, Avg loss: 0.0375, Accuracy: 377/946 (39.8520%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.7464, Accuracy: 69/10000 (0.6900%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0761, Accuracy: 12/486 (2.4691%)
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0359, Accuracy: 233/486 (47.9424%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.1926, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   1, Avg loss: 0.0700, Accuracy: 244/1573 (15.5118%)
___Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   2, Avg loss: 0.0356, Accuracy: 576/1573 (36.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.5007, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0879, Accuracy: 58/605 (9.5868%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0456, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.8617, Accuracy: 55/10000 (0.5500%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   1, Avg loss: 0.0673, Accuracy: 149/590 (25.2542%)
___Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   2, Avg loss: 0.0322, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 11.8082, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   1, Avg loss: 0.0674, Accuracy: 307/1953 (15.7194%)
___Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   2, Avg loss: 0.0352, Accuracy: 671/1953 (34.3574%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.1982, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   1, Avg loss: 0.0557, Accuracy: 391/1470 (26.5986%)
___Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   2, Avg loss: 0.0267, Accuracy: 813/1470 (55.3061%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.6145, Accuracy: 103/10000 (1.0300%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   1, Avg loss: 0.0780, Accuracy: 218/1190 (18.3193%)
___Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 470/1190 (39.4958%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.4926, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   1, Avg loss: 0.0665, Accuracy: 207/1030 (20.0971%)
___Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   2, Avg loss: 0.0248, Accuracy: 649/1030 (63.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 11.1680, Accuracy: 105/10000 (1.0500%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0520, Accuracy: 332/1154 (28.7695%)
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0272, Accuracy: 504/1154 (43.6742%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 9.9192, Accuracy: 95/10000 (0.9500%)
time spent on training: 232.0802834033966
___Test Target_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.7310, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Avg loss: 1.5115, Accuracy: 4445/9950 (44.6734%)
saving model
Done in 634.857118844986 sec.
Server Epoch:47 choose agents : [36, 81, 80, 26, 12, 78, 60, 58, 75, 19].
poison local model 36 index 13 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   1, Average loss: 0.0762, Accuracy: 92/408 (22.5490%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   2, Average loss: 0.0560, Accuracy: 137/408 (33.5784%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   3, Average loss: 0.0443, Accuracy: 134/408 (32.8431%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   4, Average loss: 0.0417, Accuracy: 145/408 (35.5392%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   5, Average loss: 0.0397, Accuracy: 126/408 (30.8824%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   6, Average loss: 0.0379, Accuracy: 145/408 (35.5392%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   7, Average loss: 0.0389, Accuracy: 134/408 (32.8431%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   8, Average loss: 0.0374, Accuracy: 144/408 (35.2941%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   9, Average loss: 0.0360, Accuracy: 136/408 (33.3333%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch  10, Average loss: 0.0372, Accuracy: 133/408 (32.5980%), train_poison_data_count: 140
Global model norm: 253.42159321227936.
Norm before scaling: 253.40731941135797. Distance: 0.5967429169712727
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.2080, Accuracy: 60/10000 (0.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.9560, Accuracy: 7827/9950 (78.6633%)
Scaling by  100
Scaled Norm after poisoning: 258.8909791060708, distance: 59.67429705087128
Total norm for 5 adversaries is: 258.8909791060708. distance: 59.67429705087128
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   1, Avg loss: 0.0790, Accuracy: 112/774 (14.4703%)
___Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   2, Avg loss: 0.0368, Accuracy: 327/774 (42.2481%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.8208, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0859, Accuracy: 50/682 (7.3314%)
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0411, Accuracy: 273/682 (40.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.8591, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0712, Accuracy: 208/1446 (14.3845%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0364, Accuracy: 505/1446 (34.9239%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.2045, Accuracy: 78/10000 (0.7800%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0948, Accuracy: 23/338 (6.8047%)
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0505, Accuracy: 104/338 (30.7692%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.7429, Accuracy: 53/10000 (0.5300%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   1, Avg loss: 0.1015, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   2, Avg loss: 0.0535, Accuracy: 142/416 (34.1346%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.9172, Accuracy: 81/10000 (0.8100%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   1, Avg loss: 0.0581, Accuracy: 467/2227 (20.9699%)
___Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   2, Avg loss: 0.0292, Accuracy: 968/2227 (43.4665%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.6740, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   1, Avg loss: 0.0725, Accuracy: 206/803 (25.6538%)
___Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   2, Avg loss: 0.0379, Accuracy: 436/803 (54.2964%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.5598, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0949, Accuracy: 100/776 (12.8866%)
___Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0360, Accuracy: 418/776 (53.8660%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 9.0617, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0584, Accuracy: 279/1036 (26.9305%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0261, Accuracy: 671/1036 (64.7683%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 12.5633, Accuracy: 78/10000 (0.7800%)
time spent on training: 280.8279013633728
___Test Target_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.9919, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.7435, Accuracy: 8464/9950 (85.0653%)
saving model
Done in 670.402642250061 sec.
Server Epoch:48 choose agents : [27, 96, 18, 95, 5, 47, 12, 39, 36, 82].
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0640, Accuracy: 309/1587 (19.4707%)
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0344, Accuracy: 571/1587 (35.9798%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.2377, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.1236, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0826, Accuracy: 16/311 (5.1447%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.5568, Accuracy: 55/10000 (0.5500%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   1, Avg loss: 0.0899, Accuracy: 12/530 (2.2642%)
___Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   2, Avg loss: 0.0359, Accuracy: 277/530 (52.2642%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.8450, Accuracy: 73/10000 (0.7300%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.1007, Accuracy: 76/599 (12.6878%)
___Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0350, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 14.9536, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   1, Avg loss: 0.0598, Accuracy: 297/1628 (18.2432%)
___Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 798/1628 (49.0172%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 9.6627, Accuracy: 143/10000 (1.4300%)
___Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   1, Avg loss: 0.1617, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   2, Avg loss: 0.1363, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.8015, Accuracy: 57/10000 (0.5700%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   1, Avg loss: 0.1046, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   2, Avg loss: 0.0531, Accuracy: 84/338 (24.8521%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.7035, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0704, Accuracy: 165/1013 (16.2883%)
___Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 503/1013 (49.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 10.9275, Accuracy: 85/10000 (0.8500%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   1, Avg loss: 0.0459, Accuracy: 97/408 (23.7745%)
___Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   2, Avg loss: 0.0346, Accuracy: 183/408 (44.8529%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.0675, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0885, Accuracy: 10/500 (2.0000%)
___Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 179/500 (35.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.6080, Accuracy: 73/10000 (0.7300%)
time spent on training: 206.98525619506836
___Test Target_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.6584, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Avg loss: 0.9492, Accuracy: 7036/9950 (70.7136%)
saving model
Done in 607.87921667099 sec.
Server Epoch:49 choose agents : [37, 21, 63, 60, 36, 6, 17, 29, 9, 90].
poison local model 37 index 14 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   1, Average loss: 0.0591, Accuracy: 341/1129 (30.2037%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   2, Average loss: 0.0303, Accuracy: 482/1129 (42.6926%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   3, Average loss: 0.0264, Accuracy: 518/1129 (45.8813%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   4, Average loss: 0.0244, Accuracy: 558/1129 (49.4243%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   5, Average loss: 0.0254, Accuracy: 516/1129 (45.7042%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   6, Average loss: 0.0250, Accuracy: 538/1129 (47.6528%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   7, Average loss: 0.0254, Accuracy: 494/1129 (43.7555%), train_poison_data_count: 360
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   8, Average loss: 0.0236, Accuracy: 542/1129 (48.0071%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   9, Average loss: 0.0240, Accuracy: 542/1129 (48.0071%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch  10, Average loss: 0.0240, Accuracy: 541/1129 (47.9185%), train_poison_data_count: 360
Global model norm: 257.8094924066994.
Norm before scaling: 257.76033563176475. Distance: 1.049762274306749
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.4438, Accuracy: 99/10000 (0.9900%)
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: 1.0720, Accuracy: 5656/9950 (56.8442%)
Scaling by  100
Scaled Norm after poisoning: 273.56940389963205, distance: 104.9762203355479
Total norm for 4 adversaries is: 273.56940389963205. distance: 104.9762203355479
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0608, Accuracy: 302/1949 (15.4951%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0337, Accuracy: 628/1949 (32.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.8570, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   1, Avg loss: 0.0836, Accuracy: 103/888 (11.5991%)
___Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   2, Avg loss: 0.0280, Accuracy: 417/888 (46.9595%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 11.3210, Accuracy: 74/10000 (0.7400%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   1, Avg loss: 0.0589, Accuracy: 487/2227 (21.8680%)
___Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   2, Avg loss: 0.0292, Accuracy: 1009/2227 (45.3076%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.8345, Accuracy: 118/10000 (1.1800%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   1, Avg loss: 0.0451, Accuracy: 103/408 (25.2451%)
___Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   2, Avg loss: 0.0345, Accuracy: 189/408 (46.3235%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.1539, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   1, Avg loss: 0.0576, Accuracy: 367/1956 (18.7628%)
___Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 663/1956 (33.8957%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.8311, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0643, Accuracy: 255/1574 (16.2008%)
___Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0294, Accuracy: 635/1574 (40.3431%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.2732, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   1, Avg loss: 0.0631, Accuracy: 272/1440 (18.8889%)
___Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   2, Avg loss: 0.0311, Accuracy: 650/1440 (45.1389%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.1197, Accuracy: 73/10000 (0.7300%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   1, Avg loss: 0.0547, Accuracy: 274/1275 (21.4902%)
___Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   2, Avg loss: 0.0188, Accuracy: 709/1275 (55.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 11.9248, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   1, Avg loss: 0.0574, Accuracy: 163/677 (24.0768%)
___Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   2, Avg loss: 0.0213, Accuracy: 453/677 (66.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 12.0623, Accuracy: 64/10000 (0.6400%)
time spent on training: 331.81155705451965
___Test Target_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.4840, Accuracy: 91/10000 (0.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Avg loss: 1.6587, Accuracy: 2220/9950 (22.3116%)
saving model
Done in 737.6838691234589 sec.
Server Epoch:50 choose agents : [74, 58, 95, 2, 46, 62, 37, 81, 28, 99].
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   1, Avg loss: 0.0665, Accuracy: 312/1552 (20.1031%)
___Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   2, Avg loss: 0.0218, Accuracy: 773/1552 (49.8067%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 12.2598, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   1, Avg loss: 0.0954, Accuracy: 126/803 (15.6912%)
___Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   2, Avg loss: 0.0423, Accuracy: 448/803 (55.7908%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.0726, Accuracy: 58/10000 (0.5800%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   1, Avg loss: 0.1207, Accuracy: 35/599 (5.8431%)
___Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   2, Avg loss: 0.0362, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 15.7543, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.1027, Accuracy: 31/605 (5.1240%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0466, Accuracy: 329/605 (54.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.4254, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0648, Accuracy: 375/1904 (19.6954%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0311, Accuracy: 734/1904 (38.5504%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.4029, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   1, Avg loss: 0.1172, Accuracy: 7/568 (1.2324%)
___Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   2, Avg loss: 0.0566, Accuracy: 260/568 (45.7746%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.1673, Accuracy: 51/10000 (0.5100%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   1, Avg loss: 0.0215, Accuracy: 738/1129 (65.3676%)
___Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   2, Avg loss: 0.0164, Accuracy: 811/1129 (71.8335%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.7883, Accuracy: 111/10000 (1.1100%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.1018, Accuracy: 83/774 (10.7235%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0403, Accuracy: 318/774 (41.0853%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.7171, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   1, Avg loss: 0.0821, Accuracy: 239/1581 (15.1170%)
___Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   2, Avg loss: 0.0359, Accuracy: 562/1581 (35.5471%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.4866, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   1, Avg loss: 0.1001, Accuracy: 71/773 (9.1850%)
___Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   2, Avg loss: 0.0361, Accuracy: 382/773 (49.4179%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 10.4889, Accuracy: 72/10000 (0.7200%)
time spent on training: 246.855952501297
___Test Target_ResNet_18 poisoned: False, epoch: 50: Avg loss: 10.2222, Accuracy: 75/10000 (0.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Avg loss: 1.6930, Accuracy: 2337/9950 (23.4874%)
saving model
Saving model on epoch 50
Done in 653.5428771972656 sec.
Server Epoch:51 choose agents : [42, 17, 32, 59, 73, 33, 77, 93, 8, 90].
poison local model 42 index 15 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Average loss: 0.0685, Accuracy: 299/1372 (21.7930%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Average loss: 0.0357, Accuracy: 403/1372 (29.3732%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   3, Average loss: 0.0328, Accuracy: 453/1372 (33.0175%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   4, Average loss: 0.0321, Accuracy: 439/1372 (31.9971%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   5, Average loss: 0.0305, Accuracy: 473/1372 (34.4752%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   6, Average loss: 0.0300, Accuracy: 490/1372 (35.7143%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   7, Average loss: 0.0298, Accuracy: 481/1372 (35.0583%), train_poison_data_count: 440
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   8, Average loss: 0.0299, Accuracy: 488/1372 (35.5685%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   9, Average loss: 0.0299, Accuracy: 496/1372 (36.1516%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch  10, Average loss: 0.0289, Accuracy: 524/1372 (38.1924%), train_poison_data_count: 440
Global model norm: 262.07625023549923.
Norm before scaling: 262.01173339661716. Distance: 1.2819784466215622
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.8255, Accuracy: 82/10000 (0.8200%)
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: 1.1162, Accuracy: 6704/9950 (67.3769%)
Scaling by  100
Scaled Norm after poisoning: 285.6059621664086, distance: 128.1978451456966
Total norm for 2 adversaries is: 285.6059621664086. distance: 128.1978451456966
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   1, Avg loss: 0.0710, Accuracy: 263/1574 (16.7090%)
___Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   2, Avg loss: 0.0294, Accuracy: 645/1574 (40.9784%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.3543, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   1, Avg loss: 0.0739, Accuracy: 104/735 (14.1497%)
___Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   2, Avg loss: 0.0264, Accuracy: 360/735 (48.9796%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 12.1719, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0822, Accuracy: 165/1089 (15.1515%)
___Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0311, Accuracy: 450/1089 (41.3223%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.9467, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   1, Avg loss: 0.0800, Accuracy: 144/938 (15.3518%)
___Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   2, Avg loss: 0.0368, Accuracy: 325/938 (34.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.0240, Accuracy: 72/10000 (0.7200%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0997, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0491, Accuracy: 143/515 (27.7670%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.9907, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   1, Avg loss: 0.0711, Accuracy: 234/1340 (17.4627%)
___Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   2, Avg loss: 0.0300, Accuracy: 550/1340 (41.0448%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.8441, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0678, Accuracy: 274/1742 (15.7290%)
___Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 727/1742 (41.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 9.2990, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0772, Accuracy: 169/1513 (11.1699%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0376, Accuracy: 477/1513 (31.5268%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.5343, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   1, Avg loss: 0.0758, Accuracy: 120/677 (17.7253%)
___Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   2, Avg loss: 0.0218, Accuracy: 452/677 (66.7651%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 12.4705, Accuracy: 65/10000 (0.6500%)
time spent on training: 292.2739670276642
___Test Target_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.8005, Accuracy: 63/10000 (0.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 51: Avg loss: 1.5473, Accuracy: 3887/9950 (39.0653%)
saving model
Done in 697.82262134552 sec.
Server Epoch:52 choose agents : [13, 59, 3, 73, 63, 7, 86, 32, 51, 89].
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0749, Accuracy: 238/1645 (14.4681%)
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0343, Accuracy: 576/1645 (35.0152%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.7420, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   1, Avg loss: 0.0825, Accuracy: 139/1089 (12.7640%)
___Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   2, Avg loss: 0.0299, Accuracy: 504/1089 (46.2810%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.5908, Accuracy: 84/10000 (0.8400%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   1, Avg loss: 0.0954, Accuracy: 11/781 (1.4085%)
___Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 259/781 (33.1626%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.8028, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   1, Avg loss: 0.0825, Accuracy: 163/938 (17.3774%)
___Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   2, Avg loss: 0.0376, Accuracy: 301/938 (32.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.0623, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   1, Avg loss: 0.0965, Accuracy: 66/888 (7.4324%)
___Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   2, Avg loss: 0.0296, Accuracy: 388/888 (43.6937%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 12.3258, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0814, Accuracy: 148/891 (16.6105%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0290, Accuracy: 460/891 (51.6274%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.5296, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   1, Avg loss: 0.0858, Accuracy: 201/1003 (20.0399%)
___Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   2, Avg loss: 0.0409, Accuracy: 364/1003 (36.2911%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.2930, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0760, Accuracy: 99/735 (13.4694%)
___Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0246, Accuracy: 359/735 (48.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 12.9039, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   1, Avg loss: 0.0934, Accuracy: 116/1049 (11.0582%)
___Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   2, Avg loss: 0.0329, Accuracy: 502/1049 (47.8551%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.6354, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0948, Accuracy: 154/896 (17.1875%)
___Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0428, Accuracy: 444/896 (49.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.1451, Accuracy: 57/10000 (0.5700%)
time spent on training: 202.78869652748108
___Test Target_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.5954, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 52: Avg loss: 1.5141, Accuracy: 3904/9950 (39.2362%)
saving model
Done in 598.6873242855072 sec.
Server Epoch:53 choose agents : [44, 63, 19, 5, 11, 69, 60, 51, 37, 90].
poison local model 44 index 16 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Average loss: 0.0679, Accuracy: 440/1750 (25.1429%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Average loss: 0.0382, Accuracy: 579/1750 (33.0857%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   3, Average loss: 0.0357, Accuracy: 605/1750 (34.5714%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   4, Average loss: 0.0336, Accuracy: 640/1750 (36.5714%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   5, Average loss: 0.0342, Accuracy: 630/1750 (36.0000%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   6, Average loss: 0.0330, Accuracy: 662/1750 (37.8286%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   7, Average loss: 0.0325, Accuracy: 662/1750 (37.8286%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   8, Average loss: 0.0320, Accuracy: 705/1750 (40.2857%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   9, Average loss: 0.0319, Accuracy: 685/1750 (39.1429%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch  10, Average loss: 0.0327, Accuracy: 655/1750 (37.4286%), train_poison_data_count: 560
Global model norm: 266.25302228331606.
Norm before scaling: 266.1663013982048. Distance: 1.4122879949487177
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.9471, Accuracy: 84/10000 (0.8400%)
___Test Local_ResNet_18 poisoned: True, epoch: 53: Avg loss: 1.0455, Accuracy: 7664/9950 (77.0251%)
Scaling by  100
Scaled Norm after poisoning: 293.2882940683109, distance: 141.22880095345283
Total norm for 5 adversaries is: 293.2882940683109. distance: 141.22880095345283
___Test Local_ResNet_18 poisoned: True, epoch: 53: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   1, Avg loss: 0.0898, Accuracy: 100/888 (11.2613%)
___Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   2, Avg loss: 0.0281, Accuracy: 435/888 (48.9865%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 11.7193, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0700, Accuracy: 234/1036 (22.5869%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0262, Accuracy: 649/1036 (62.6448%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 13.6265, Accuracy: 73/10000 (0.7300%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0686, Accuracy: 265/1628 (16.2776%)
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0268, Accuracy: 767/1628 (47.1130%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.6937, Accuracy: 139/10000 (1.3900%)
___Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   1, Avg loss: 0.0950, Accuracy: 115/712 (16.1517%)
___Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   2, Avg loss: 0.0337, Accuracy: 446/712 (62.6404%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.4424, Accuracy: 71/10000 (0.7100%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0765, Accuracy: 115/590 (19.4915%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0372, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 13.6633, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   1, Avg loss: 0.0582, Accuracy: 504/2227 (22.6313%)
___Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   2, Avg loss: 0.0290, Accuracy: 942/2227 (42.2991%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.6872, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   1, Avg loss: 0.0881, Accuracy: 143/1049 (13.6320%)
___Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   2, Avg loss: 0.0322, Accuracy: 496/1049 (47.2831%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.6171, Accuracy: 114/10000 (1.1400%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   1, Avg loss: 0.0631, Accuracy: 327/1129 (28.9637%)
___Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   2, Avg loss: 0.0214, Accuracy: 769/1129 (68.1134%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 10.2065, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   1, Avg loss: 0.0814, Accuracy: 106/677 (15.6573%)
___Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   2, Avg loss: 0.0246, Accuracy: 462/677 (68.2422%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 12.7845, Accuracy: 58/10000 (0.5800%)
time spent on training: 327.5584352016449
___Test Target_ResNet_18 poisoned: False, epoch: 53: Avg loss: 8.3588, Accuracy: 90/10000 (0.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 53: Avg loss: 1.7807, Accuracy: 2855/9950 (28.6935%)
saving model
Done in 733.5184941291809 sec.
Server Epoch:54 choose agents : [87, 90, 28, 63, 1, 47, 46, 66, 40, 91].
___Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   1, Avg loss: 0.0826, Accuracy: 177/1131 (15.6499%)
___Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   2, Avg loss: 0.0337, Accuracy: 411/1131 (36.3395%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.0948, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   1, Avg loss: 0.0808, Accuracy: 110/677 (16.2482%)
___Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   2, Avg loss: 0.0246, Accuracy: 458/677 (67.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 12.4563, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0772, Accuracy: 246/1581 (15.5598%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0356, Accuracy: 563/1581 (35.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.3988, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   1, Avg loss: 0.0894, Accuracy: 75/888 (8.4459%)
___Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   2, Avg loss: 0.0281, Accuracy: 436/888 (49.0991%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 11.4570, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0723, Accuracy: 170/928 (18.3190%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 579/928 (62.3922%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 10.4900, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1748, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1537, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.5308, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0654, Accuracy: 295/1904 (15.4937%)
___Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 683/1904 (35.8718%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.8219, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0837, Accuracy: 151/1402 (10.7703%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0421, Accuracy: 373/1402 (26.6049%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.0971, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   1, Avg loss: 0.0726, Accuracy: 241/1573 (15.3210%)
___Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   2, Avg loss: 0.0367, Accuracy: 565/1573 (35.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.4004, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   1, Avg loss: 0.0757, Accuracy: 170/1030 (16.5049%)
___Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   2, Avg loss: 0.0257, Accuracy: 642/1030 (62.3301%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 11.3922, Accuracy: 108/10000 (1.0800%)
time spent on training: 209.64594531059265
___Test Target_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.1289, Accuracy: 85/10000 (0.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 54: Avg loss: 2.0693, Accuracy: 1801/9950 (18.1005%)
saving model
Done in 608.9881799221039 sec.
Server Epoch:55 choose agents : [48, 41, 73, 59, 13, 26, 32, 57, 99, 55].
poison local model 48 index 17 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   1, Average loss: 0.0818, Accuracy: 141/631 (22.3455%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   2, Average loss: 0.0518, Accuracy: 185/631 (29.3185%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   3, Average loss: 0.0435, Accuracy: 181/631 (28.6846%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   4, Average loss: 0.0395, Accuracy: 202/631 (32.0127%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   5, Average loss: 0.0389, Accuracy: 224/631 (35.4992%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   6, Average loss: 0.0379, Accuracy: 214/631 (33.9144%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   7, Average loss: 0.0345, Accuracy: 256/631 (40.5705%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   8, Average loss: 0.0362, Accuracy: 225/631 (35.6577%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   9, Average loss: 0.0343, Accuracy: 242/631 (38.3518%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch  10, Average loss: 0.0356, Accuracy: 228/631 (36.1331%), train_poison_data_count: 200
Global model norm: 270.3580236233058.
Norm before scaling: 270.33250648506925. Distance: 0.8181808750431327
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.4787, Accuracy: 77/10000 (0.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 55: Avg loss: 1.1208, Accuracy: 6769/9950 (68.0302%)
Scaling by  100
Scaled Norm after poisoning: 279.8944695103853, distance: 81.8180861347294
Total norm for 2 adversaries is: 279.8944695103853. distance: 81.8180861347294
___Test Local_ResNet_18 poisoned: True, epoch: 55: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   1, Avg loss: 0.0928, Accuracy: 117/719 (16.2726%)
___Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   2, Avg loss: 0.0417, Accuracy: 469/719 (65.2295%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 9.5199, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0747, Accuracy: 173/938 (18.4435%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0365, Accuracy: 338/938 (36.0341%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.9176, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   1, Avg loss: 0.0796, Accuracy: 170/1089 (15.6107%)
___Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   2, Avg loss: 0.0321, Accuracy: 460/1089 (42.2406%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 10.5107, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0648, Accuracy: 339/1645 (20.6079%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0341, Accuracy: 633/1645 (38.4802%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.6860, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0800, Accuracy: 181/1446 (12.5173%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0380, Accuracy: 484/1446 (33.4716%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.2774, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   1, Avg loss: 0.0707, Accuracy: 110/735 (14.9660%)
___Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   2, Avg loss: 0.0258, Accuracy: 346/735 (47.0748%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 11.9144, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   1, Avg loss: 0.0756, Accuracy: 170/1154 (14.7314%)
___Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   2, Avg loss: 0.0290, Accuracy: 495/1154 (42.8943%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 11.3319, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0916, Accuracy: 84/773 (10.8668%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0353, Accuracy: 374/773 (48.3829%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 10.2498, Accuracy: 73/10000 (0.7300%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0786, Accuracy: 125/1071 (11.6713%)
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0324, Accuracy: 505/1071 (47.1522%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 10.4770, Accuracy: 69/10000 (0.6900%)
time spent on training: 307.4911358356476
___Test Target_ResNet_18 poisoned: False, epoch: 55: Avg loss: 8.4833, Accuracy: 78/10000 (0.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 55: Avg loss: 1.1754, Accuracy: 5681/9950 (57.0955%)
saving model
Done in 706.4238717556 sec.
Server Epoch:56 choose agents : [70, 37, 13, 11, 65, 80, 49, 18, 26, 82].
___Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   1, Avg loss: 0.0754, Accuracy: 267/1418 (18.8293%)
___Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   2, Avg loss: 0.0340, Accuracy: 658/1418 (46.4034%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.6021, Accuracy: 103/10000 (1.0300%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   1, Avg loss: 0.0608, Accuracy: 334/1129 (29.5837%)
___Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   2, Avg loss: 0.0222, Accuracy: 741/1129 (65.6333%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.5596, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0668, Accuracy: 261/1645 (15.8663%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0346, Accuracy: 597/1645 (36.2918%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.5765, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   1, Avg loss: 0.0818, Accuracy: 163/712 (22.8933%)
___Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   2, Avg loss: 0.0327, Accuracy: 452/712 (63.4831%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.9495, Accuracy: 76/10000 (0.7600%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0712, Accuracy: 266/1475 (18.0339%)
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0342, Accuracy: 589/1475 (39.9322%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.0777, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   1, Avg loss: 0.0839, Accuracy: 84/682 (12.3167%)
___Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   2, Avg loss: 0.0414, Accuracy: 266/682 (39.0029%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.3870, Accuracy: 62/10000 (0.6200%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   1, Avg loss: 0.1187, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   2, Avg loss: 0.0653, Accuracy: 53/440 (12.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.7684, Accuracy: 63/10000 (0.6300%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   1, Avg loss: 0.1109, Accuracy: 0/530 (0.0000%)
___Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   2, Avg loss: 0.0418, Accuracy: 258/530 (48.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.7820, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0777, Accuracy: 213/1446 (14.7303%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0377, Accuracy: 494/1446 (34.1632%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.1757, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.1009, Accuracy: 1/500 (0.2000%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0537, Accuracy: 148/500 (29.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.0096, Accuracy: 54/10000 (0.5400%)
time spent on training: 234.26002883911133
___Test Target_ResNet_18 poisoned: False, epoch: 56: Avg loss: 12.6424, Accuracy: 59/10000 (0.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 56: Avg loss: 2.1855, Accuracy: 2318/9950 (23.2965%)
saving model
Done in 635.5988891124725 sec.
Server Epoch:57 choose agents : [49, 24, 21, 90, 19, 40, 84, 62, 37, 70].
poison local model 49 index 18 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   1, Average loss: 0.0883, Accuracy: 97/440 (22.0455%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   2, Average loss: 0.0642, Accuracy: 133/440 (30.2273%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   3, Average loss: 0.0489, Accuracy: 132/440 (30.0000%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   4, Average loss: 0.0447, Accuracy: 138/440 (31.3636%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   5, Average loss: 0.0436, Accuracy: 138/440 (31.3636%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   6, Average loss: 0.0410, Accuracy: 144/440 (32.7273%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   7, Average loss: 0.0396, Accuracy: 144/440 (32.7273%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   8, Average loss: 0.0382, Accuracy: 137/440 (31.1364%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   9, Average loss: 0.0385, Accuracy: 142/440 (32.2727%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch  10, Average loss: 0.0364, Accuracy: 149/440 (33.8636%), train_poison_data_count: 140
Global model norm: 274.4885727357334.
Norm before scaling: 274.4725908446962. Distance: 0.6799898242539689
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.8993, Accuracy: 66/10000 (0.6600%)
___Test Local_ResNet_18 poisoned: True, epoch: 57: Avg loss: 1.1990, Accuracy: 7778/9950 (78.1709%)
Scaling by  100
Scaled Norm after poisoning: 281.14627253886897, distance: 67.99898393657254
Total norm for 4 adversaries is: 281.14627253886897. distance: 67.99898393657254
___Test Local_ResNet_18 poisoned: True, epoch: 57: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   1, Avg loss: 0.1164, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   2, Avg loss: 0.0667, Accuracy: 34/312 (10.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.0705, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   1, Avg loss: 0.0650, Accuracy: 303/1949 (15.5464%)
___Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   2, Avg loss: 0.0343, Accuracy: 612/1949 (31.4007%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.7432, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   1, Avg loss: 0.0744, Accuracy: 138/677 (20.3840%)
___Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   2, Avg loss: 0.0247, Accuracy: 459/677 (67.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 11.8726, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   1, Avg loss: 0.0613, Accuracy: 253/1036 (24.4208%)
___Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   2, Avg loss: 0.0268, Accuracy: 664/1036 (64.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 13.1088, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0601, Accuracy: 321/1573 (20.4069%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0362, Accuracy: 578/1573 (36.7451%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.0913, Accuracy: 83/10000 (0.8300%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   1, Avg loss: 0.0766, Accuracy: 187/1190 (15.7143%)
___Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 465/1190 (39.0756%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.5865, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   1, Avg loss: 0.0997, Accuracy: 14/568 (2.4648%)
___Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   2, Avg loss: 0.0525, Accuracy: 260/568 (45.7746%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.2130, Accuracy: 53/10000 (0.5300%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   1, Avg loss: 0.0568, Accuracy: 338/1129 (29.9380%)
___Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   2, Avg loss: 0.0222, Accuracy: 757/1129 (67.0505%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.6813, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0738, Accuracy: 258/1418 (18.1946%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0338, Accuracy: 649/1418 (45.7687%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.5278, Accuracy: 90/10000 (0.9000%)
time spent on training: 334.7701780796051
___Test Target_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.1346, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 57: Avg loss: 1.4899, Accuracy: 5664/9950 (56.9246%)
saving model
Done in 734.7430713176727 sec.
Server Epoch:58 choose agents : [95, 54, 5, 67, 47, 39, 11, 59, 83, 6].
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   1, Avg loss: 0.0949, Accuracy: 91/599 (15.1920%)
___Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   2, Avg loss: 0.0331, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 13.9076, Accuracy: 50/10000 (0.5000%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   1, Avg loss: 0.0717, Accuracy: 230/1130 (20.3540%)
___Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   2, Avg loss: 0.0313, Accuracy: 475/1130 (42.0354%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.5245, Accuracy: 62/10000 (0.6200%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   1, Avg loss: 0.0594, Accuracy: 311/1628 (19.1032%)
___Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   2, Avg loss: 0.0263, Accuracy: 780/1628 (47.9115%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.7356, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.1006, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0502, Accuracy: 138/426 (32.3944%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.9960, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1437, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1161, Accuracy: 2/134 (1.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.5895, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   1, Avg loss: 0.0726, Accuracy: 157/1013 (15.4985%)
___Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   2, Avg loss: 0.0280, Accuracy: 517/1013 (51.0365%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 10.2911, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   1, Avg loss: 0.0547, Accuracy: 221/712 (31.0393%)
___Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   2, Avg loss: 0.0271, Accuracy: 460/712 (64.6067%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.5143, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   1, Avg loss: 0.0711, Accuracy: 181/1089 (16.6208%)
___Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   2, Avg loss: 0.0292, Accuracy: 524/1089 (48.1175%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 9.6723, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   1, Avg loss: 0.0650, Accuracy: 373/1953 (19.0988%)
___Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   2, Avg loss: 0.0354, Accuracy: 748/1953 (38.3001%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.0880, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   1, Avg loss: 0.0602, Accuracy: 325/1956 (16.6155%)
___Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 658/1956 (33.6401%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.8668, Accuracy: 99/10000 (0.9900%)
time spent on training: 245.89757251739502
___Test Target_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.7123, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 58: Avg loss: 2.1131, Accuracy: 2955/9950 (29.6985%)
saving model
Done in 642.7564334869385 sec.
Server Epoch:59 choose agents : [54, 47, 10, 12, 0, 49, 14, 52, 51, 46].
poison local model 54 index 19 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   1, Average loss: 0.0601, Accuracy: 305/1130 (26.9912%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   2, Average loss: 0.0340, Accuracy: 363/1130 (32.1239%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   3, Average loss: 0.0294, Accuracy: 401/1130 (35.4867%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   4, Average loss: 0.0292, Accuracy: 416/1130 (36.8142%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   5, Average loss: 0.0288, Accuracy: 434/1130 (38.4071%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   6, Average loss: 0.0294, Accuracy: 401/1130 (35.4867%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   7, Average loss: 0.0287, Accuracy: 434/1130 (38.4071%), train_poison_data_count: 360
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   8, Average loss: 0.0278, Accuracy: 429/1130 (37.9646%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   9, Average loss: 0.0285, Accuracy: 417/1130 (36.9027%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch  10, Average loss: 0.0282, Accuracy: 419/1130 (37.0796%), train_poison_data_count: 360
Global model norm: 278.5298037239462.
Norm before scaling: 278.47660359534694. Distance: 1.0427115476840103
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.6843, Accuracy: 63/10000 (0.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 59: Avg loss: 1.0765, Accuracy: 6177/9950 (62.0804%)
Scaling by  100
Scaled Norm after poisoning: 292.19790756865456, distance: 104.27115436597266
Total norm for 5 adversaries is: 292.19790756865456. distance: 104.27115436597266
___Test Local_ResNet_18 poisoned: True, epoch: 59: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   1, Avg loss: 0.1341, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   2, Avg loss: 0.1250, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.8158, Accuracy: 77/10000 (0.7700%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   1, Avg loss: 0.0815, Accuracy: 88/861 (10.2207%)
___Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   2, Avg loss: 0.0227, Accuracy: 405/861 (47.0383%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 10.7519, Accuracy: 86/10000 (0.8600%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   1, Avg loss: 0.1094, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   2, Avg loss: 0.0616, Accuracy: 80/338 (23.6686%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.6617, Accuracy: 51/10000 (0.5100%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   1, Avg loss: 0.0678, Accuracy: 268/1657 (16.1738%)
___Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   2, Avg loss: 0.0371, Accuracy: 460/1657 (27.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.3584, Accuracy: 62/10000 (0.6200%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   1, Avg loss: 0.0446, Accuracy: 125/440 (28.4091%)
___Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   2, Avg loss: 0.0330, Accuracy: 185/440 (42.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.9316, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   1, Avg loss: 0.0871, Accuracy: 110/1013 (10.8588%)
___Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   2, Avg loss: 0.0395, Accuracy: 346/1013 (34.1560%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.4653, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0685, Accuracy: 144/636 (22.6415%)
___Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0352, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.4831, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   1, Avg loss: 0.0799, Accuracy: 153/1049 (14.5853%)
___Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   2, Avg loss: 0.0321, Accuracy: 458/1049 (43.6606%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.7267, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   1, Avg loss: 0.0578, Accuracy: 335/1904 (17.5945%)
___Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 667/1904 (35.0315%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.4098, Accuracy: 107/10000 (1.0700%)
time spent on training: 318.42441725730896
___Test Target_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.0138, Accuracy: 68/10000 (0.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 59: Avg loss: 1.1052, Accuracy: 5667/9950 (56.9548%)
saving model
Done in 722.3576819896698 sec.
Server Epoch:60 choose agents : [54, 52, 10, 29, 40, 35, 50, 34, 99, 36].
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0290, Accuracy: 496/1130 (43.8938%)
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0243, Accuracy: 610/1130 (53.9823%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.7586, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0807, Accuracy: 94/636 (14.7799%)
___Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0329, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.5826, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0843, Accuracy: 116/861 (13.4727%)
___Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0268, Accuracy: 387/861 (44.9477%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.3434, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   1, Avg loss: 0.0739, Accuracy: 267/1440 (18.5417%)
___Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   2, Avg loss: 0.0292, Accuracy: 693/1440 (48.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.6714, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   1, Avg loss: 0.0735, Accuracy: 241/1573 (15.3210%)
___Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   2, Avg loss: 0.0367, Accuracy: 524/1573 (33.3121%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.1771, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   1, Avg loss: 0.1540, Accuracy: 1/271 (0.3690%)
___Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   2, Avg loss: 0.0986, Accuracy: 7/271 (2.5830%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.3241, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0869, Accuracy: 47/809 (5.8096%)
___Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0281, Accuracy: 344/809 (42.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.4080, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   1, Avg loss: 0.0807, Accuracy: 232/1427 (16.2579%)
___Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   2, Avg loss: 0.0357, Accuracy: 559/1427 (39.1731%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.0889, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   1, Avg loss: 0.0999, Accuracy: 61/773 (7.8913%)
___Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   2, Avg loss: 0.0374, Accuracy: 381/773 (49.2885%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 10.9667, Accuracy: 66/10000 (0.6600%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   1, Avg loss: 0.1339, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   2, Avg loss: 0.0647, Accuracy: 64/408 (15.6863%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.7690, Accuracy: 50/10000 (0.5000%)
time spent on training: 254.30116963386536
___Test Target_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.1843, Accuracy: 67/10000 (0.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 60: Avg loss: 1.2604, Accuracy: 5110/9950 (51.3568%)
saving model
Saving model on epoch 60
Done in 655.4766600131989 sec.
Server Epoch:61 choose agents : [55, 8, 59, 31, 34, 81, 12, 79, 36, 85].
poison local model 55 index 20 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Average loss: 0.0726, Accuracy: 263/1071 (24.5565%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Average loss: 0.0328, Accuracy: 340/1071 (31.7460%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   3, Average loss: 0.0286, Accuracy: 391/1071 (36.5079%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   4, Average loss: 0.0281, Accuracy: 410/1071 (38.2820%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   5, Average loss: 0.0282, Accuracy: 390/1071 (36.4146%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   6, Average loss: 0.0269, Accuracy: 402/1071 (37.5350%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   7, Average loss: 0.0267, Accuracy: 433/1071 (40.4295%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   8, Average loss: 0.0264, Accuracy: 441/1071 (41.1765%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   9, Average loss: 0.0264, Accuracy: 420/1071 (39.2157%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch  10, Average loss: 0.0270, Accuracy: 409/1071 (38.1886%), train_poison_data_count: 340
Global model norm: 282.48297791636935.
Norm before scaling: 282.43154590980095. Distance: 1.1476779424124706
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.9467, Accuracy: 76/10000 (0.7600%)
___Test Local_ResNet_18 poisoned: True, epoch: 61: Avg loss: 1.0426, Accuracy: 6281/9950 (63.1256%)
Scaling by  100
Scaled Norm after poisoning: 299.8854338534968, distance: 114.76778950477569
Total norm for 5 adversaries is: 299.8854338534968. distance: 114.76778950477569
___Test Local_ResNet_18 poisoned: True, epoch: 61: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   1, Avg loss: 0.0761, Accuracy: 131/1513 (8.6583%)
___Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   2, Avg loss: 0.0385, Accuracy: 430/1513 (28.4204%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.3518, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   1, Avg loss: 0.0856, Accuracy: 157/1089 (14.4169%)
___Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   2, Avg loss: 0.0301, Accuracy: 473/1089 (43.4343%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 10.3041, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   1, Avg loss: 0.0875, Accuracy: 95/460 (20.6522%)
___Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   2, Avg loss: 0.0446, Accuracy: 192/460 (41.7391%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.1818, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   1, Avg loss: 0.0772, Accuracy: 250/1427 (17.5193%)
___Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   2, Avg loss: 0.0357, Accuracy: 524/1427 (36.7204%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.2744, Accuracy: 81/10000 (0.8100%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   1, Avg loss: 0.0951, Accuracy: 68/774 (8.7855%)
___Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   2, Avg loss: 0.0444, Accuracy: 353/774 (45.6072%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.7850, Accuracy: 69/10000 (0.6900%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.1359, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0698, Accuracy: 40/338 (11.8343%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.6701, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1602, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.1274, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.2892, Accuracy: 73/10000 (0.7300%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   1, Avg loss: 0.1286, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   2, Avg loss: 0.0636, Accuracy: 73/408 (17.8922%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.4088, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   1, Avg loss: 0.0743, Accuracy: 303/1988 (15.2414%)
___Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   2, Avg loss: 0.0367, Accuracy: 652/1988 (32.7968%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.1954, Accuracy: 83/10000 (0.8300%)
time spent on training: 296.7479054927826
___Test Target_ResNet_18 poisoned: False, epoch: 61: Avg loss: 11.5784, Accuracy: 68/10000 (0.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 61: Avg loss: 2.6953, Accuracy: 1005/9950 (10.1005%)
saving model
Done in 690.8220999240875 sec.
Server Epoch:62 choose agents : [76, 81, 79, 10, 63, 90, 19, 80, 0, 17].
___Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   1, Avg loss: 0.1410, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   2, Avg loss: 0.0670, Accuracy: 100/466 (21.4592%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.6700, Accuracy: 51/10000 (0.5100%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.1053, Accuracy: 61/774 (7.8811%)
___Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0417, Accuracy: 339/774 (43.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.1912, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   1, Avg loss: 0.1459, Accuracy: 10/197 (5.0761%)
___Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   2, Avg loss: 0.1197, Accuracy: 15/197 (7.6142%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.0100, Accuracy: 67/10000 (0.6700%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   1, Avg loss: 0.0952, Accuracy: 56/861 (6.5041%)
___Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   2, Avg loss: 0.0222, Accuracy: 432/861 (50.1742%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 11.4818, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0958, Accuracy: 81/888 (9.1216%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0294, Accuracy: 416/888 (46.8468%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 11.6064, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   1, Avg loss: 0.0938, Accuracy: 93/677 (13.7371%)
___Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   2, Avg loss: 0.0265, Accuracy: 466/677 (68.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 12.0863, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   1, Avg loss: 0.0717, Accuracy: 230/1036 (22.2008%)
___Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   2, Avg loss: 0.0273, Accuracy: 638/1036 (61.5830%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 14.0529, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.1043, Accuracy: 18/682 (2.6393%)
___Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0414, Accuracy: 284/682 (41.6422%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.4436, Accuracy: 58/10000 (0.5800%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   1, Avg loss: 0.0774, Accuracy: 240/1657 (14.4840%)
___Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   2, Avg loss: 0.0372, Accuracy: 488/1657 (29.4508%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.4739, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   1, Avg loss: 0.0752, Accuracy: 250/1574 (15.8831%)
___Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   2, Avg loss: 0.0293, Accuracy: 627/1574 (39.8348%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.6239, Accuracy: 110/10000 (1.1000%)
time spent on training: 249.13023781776428
___Test Target_ResNet_18 poisoned: False, epoch: 62: Avg loss: 10.4608, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 62: Avg loss: 1.9701, Accuracy: 2416/9950 (24.2814%)
saving model
Done in 639.6758008003235 sec.
Server Epoch:63 choose agents : [60, 37, 76, 38, 57, 8, 82, 79, 19, 99].
poison local model 60 index 21 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   1, Average loss: 0.0584, Accuracy: 616/2227 (27.6605%), train_poison_data_count: 700
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   2, Average loss: 0.0307, Accuracy: 810/2227 (36.3718%), train_poison_data_count: 700
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   3, Average loss: 0.0283, Accuracy: 859/2227 (38.5721%), train_poison_data_count: 700
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   4, Average loss: 0.0274, Accuracy: 916/2227 (41.1316%), train_poison_data_count: 700
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   5, Average loss: 0.0275, Accuracy: 884/2227 (39.6947%), train_poison_data_count: 700
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   6, Average loss: 0.0268, Accuracy: 938/2227 (42.1194%), train_poison_data_count: 700
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   7, Average loss: 0.0270, Accuracy: 910/2227 (40.8621%), train_poison_data_count: 700
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   8, Average loss: 0.0268, Accuracy: 928/2227 (41.6704%), train_poison_data_count: 700
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   9, Average loss: 0.0262, Accuracy: 969/2227 (43.5115%), train_poison_data_count: 700
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch  10, Average loss: 0.0260, Accuracy: 964/2227 (43.2869%), train_poison_data_count: 700
Global model norm: 286.4076940089075.
Norm before scaling: 286.28901207957665. Distance: 1.5602392244313765
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.8917, Accuracy: 113/10000 (1.1300%)
___Test Local_ResNet_18 poisoned: True, epoch: 63: Avg loss: 1.0389, Accuracy: 7093/9950 (71.2864%)
Scaling by  100
Scaled Norm after poisoning: 315.1697831130072, distance: 156.0239239467781
Total norm for 2 adversaries is: 315.1697831130072. distance: 156.0239239467781
___Test Local_ResNet_18 poisoned: True, epoch: 63: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0688, Accuracy: 257/1129 (22.7635%)
___Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 722/1129 (63.9504%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.0540, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.1321, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0680, Accuracy: 110/466 (23.6052%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.9041, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0823, Accuracy: 136/1131 (12.0248%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0331, Accuracy: 462/1131 (40.8488%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.1166, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0806, Accuracy: 145/1154 (12.5650%)
___Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0299, Accuracy: 451/1154 (39.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.8173, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   1, Avg loss: 0.0774, Accuracy: 121/1513 (7.9974%)
___Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   2, Avg loss: 0.0386, Accuracy: 411/1513 (27.1646%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.6622, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   1, Avg loss: 0.1144, Accuracy: 7/500 (1.4000%)
___Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   2, Avg loss: 0.0588, Accuracy: 125/500 (25.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.9512, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   1, Avg loss: 0.1431, Accuracy: 5/197 (2.5381%)
___Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   2, Avg loss: 0.1065, Accuracy: 13/197 (6.5990%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.0762, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   1, Avg loss: 0.0653, Accuracy: 214/1036 (20.6564%)
___Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   2, Avg loss: 0.0279, Accuracy: 652/1036 (62.9344%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 14.4409, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.1001, Accuracy: 63/773 (8.1501%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0335, Accuracy: 387/773 (50.0647%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 10.5623, Accuracy: 68/10000 (0.6800%)
time spent on training: 289.7296075820923
___Test Target_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.5106, Accuracy: 101/10000 (1.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 63: Avg loss: 1.3676, Accuracy: 4928/9950 (49.5276%)
saving model
Done in 695.0980110168457 sec.
Server Epoch:64 choose agents : [36, 20, 35, 30, 6, 45, 65, 50, 99, 89].
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   1, Avg loss: 0.1374, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   2, Avg loss: 0.0737, Accuracy: 50/408 (12.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.1076, Accuracy: 56/10000 (0.5600%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   1, Avg loss: 0.0940, Accuracy: 111/807 (13.7546%)
___Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   2, Avg loss: 0.0404, Accuracy: 413/807 (51.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.2689, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.1610, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.1118, Accuracy: 1/271 (0.3690%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.8207, Accuracy: 119/10000 (1.1900%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.1269, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0515, Accuracy: 161/486 (33.1276%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.8220, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   1, Avg loss: 0.0752, Accuracy: 238/1956 (12.1677%)
___Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 653/1956 (33.3845%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.9842, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.1182, Accuracy: 22/669 (3.2885%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0541, Accuracy: 351/669 (52.4664%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.6087, Accuracy: 53/10000 (0.5300%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   1, Avg loss: 0.0843, Accuracy: 250/1475 (16.9492%)
___Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   2, Avg loss: 0.0353, Accuracy: 617/1475 (41.8305%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.1738, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   1, Avg loss: 0.0981, Accuracy: 17/809 (2.1014%)
___Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   2, Avg loss: 0.0293, Accuracy: 362/809 (44.7466%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 11.2004, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   1, Avg loss: 0.1064, Accuracy: 35/773 (4.5278%)
___Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   2, Avg loss: 0.0365, Accuracy: 397/773 (51.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 10.7748, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   1, Avg loss: 0.0994, Accuracy: 143/896 (15.9598%)
___Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   2, Avg loss: 0.0451, Accuracy: 450/896 (50.2232%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.6411, Accuracy: 60/10000 (0.6000%)
time spent on training: 244.07682371139526
___Test Target_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.7771, Accuracy: 94/10000 (0.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 64: Avg loss: 1.6283, Accuracy: 3706/9950 (37.2462%)
saving model
Done in 640.5067610740662 sec.
Server Epoch:65 choose agents : [61, 28, 93, 57, 72, 82, 55, 87, 88, 96].
poison local model 61 index 22 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Average loss: 0.1033, Accuracy: 18/85 (21.1765%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Average loss: 0.0964, Accuracy: 23/85 (27.0588%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   3, Average loss: 0.0868, Accuracy: 33/85 (38.8235%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   4, Average loss: 0.0853, Accuracy: 35/85 (41.1765%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   5, Average loss: 0.0861, Accuracy: 36/85 (42.3529%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   6, Average loss: 0.0848, Accuracy: 35/85 (41.1765%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   7, Average loss: 0.0818, Accuracy: 38/85 (44.7059%), train_poison_data_count: 40
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   8, Average loss: 0.0828, Accuracy: 38/85 (44.7059%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   9, Average loss: 0.0852, Accuracy: 39/85 (45.8824%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch  10, Average loss: 0.0801, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Global model norm: 290.1839260494971.
Norm before scaling: 290.18119339474777. Distance: 0.1498968328401097
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.2746, Accuracy: 61/10000 (0.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 65: Avg loss: 0.4947, Accuracy: 9424/9950 (94.7136%)
Scaling by  100
Scaled Norm after poisoning: 290.2931976898529, distance: 14.989683036481448
Total norm for 3 adversaries is: 290.2931976898529. distance: 14.989683036481448
___Test Local_ResNet_18 poisoned: True, epoch: 65: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0823, Accuracy: 207/1581 (13.0930%)
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0376, Accuracy: 543/1581 (34.3454%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.5330, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   1, Avg loss: 0.0743, Accuracy: 286/1742 (16.4179%)
___Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 720/1742 (41.3318%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.9389, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0831, Accuracy: 140/1154 (12.1317%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0312, Accuracy: 432/1154 (37.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 13.0235, Accuracy: 56/10000 (0.5600%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0900, Accuracy: 125/1241 (10.0725%)
___Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0402, Accuracy: 387/1241 (31.1845%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.8649, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.1253, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0655, Accuracy: 110/500 (22.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.3364, Accuracy: 52/10000 (0.5200%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   1, Avg loss: 0.0801, Accuracy: 150/1071 (14.0056%)
___Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 524/1071 (48.9262%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 10.6289, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   1, Avg loss: 0.0911, Accuracy: 146/1131 (12.9089%)
___Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   2, Avg loss: 0.0367, Accuracy: 386/1131 (34.1291%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.9530, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   1, Avg loss: 0.1040, Accuracy: 18/603 (2.9851%)
___Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   2, Avg loss: 0.0555, Accuracy: 279/603 (46.2687%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.3220, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   1, Avg loss: 0.1327, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   2, Avg loss: 0.0885, Accuracy: 9/311 (2.8939%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.6087, Accuracy: 100/10000 (1.0000%)
time spent on training: 293.7820689678192
___Test Target_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.7969, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 65: Avg loss: 0.5821, Accuracy: 8830/9950 (88.7437%)
saving model
Done in 704.2796504497528 sec.
Server Epoch:66 choose agents : [15, 18, 21, 86, 93, 71, 34, 3, 52, 47].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   1, Avg loss: 0.0712, Accuracy: 216/1154 (18.7175%)
___Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   2, Avg loss: 0.0308, Accuracy: 434/1154 (37.6083%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 10.2833, Accuracy: 83/10000 (0.8300%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.1180, Accuracy: 1/530 (0.1887%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0446, Accuracy: 242/530 (45.6604%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 10.3501, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   1, Avg loss: 0.0713, Accuracy: 289/1949 (14.8281%)
___Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   2, Avg loss: 0.0354, Accuracy: 588/1949 (30.1693%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.0961, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0788, Accuracy: 216/1003 (21.5354%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0365, Accuracy: 382/1003 (38.0857%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.3474, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0694, Accuracy: 312/1742 (17.9104%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 698/1742 (40.0689%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.2273, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.1022, Accuracy: 18/818 (2.2005%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0353, Accuracy: 338/818 (41.3203%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.9501, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   1, Avg loss: 0.0790, Accuracy: 223/1427 (15.6272%)
___Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   2, Avg loss: 0.0360, Accuracy: 548/1427 (38.4022%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.2785, Accuracy: 83/10000 (0.8300%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   1, Avg loss: 0.0987, Accuracy: 14/781 (1.7926%)
___Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   2, Avg loss: 0.0398, Accuracy: 235/781 (30.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.5324, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   1, Avg loss: 0.0828, Accuracy: 102/636 (16.0377%)
___Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   2, Avg loss: 0.0378, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 10.9283, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   1, Avg loss: 0.1838, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   2, Avg loss: 0.1492, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.0766, Accuracy: 112/10000 (1.1200%)
time spent on training: 244.04080820083618
___Test Target_ResNet_18 poisoned: False, epoch: 66: Avg loss: 9.4295, Accuracy: 79/10000 (0.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 66: Avg loss: 0.9843, Accuracy: 6979/9950 (70.1407%)
saving model
Done in 643.2683091163635 sec.
Server Epoch:67 choose agents : [65, 12, 41, 56, 19, 23, 37, 45, 96, 9].
poison local model 65 index 23 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   1, Average loss: 0.0645, Accuracy: 425/1475 (28.8136%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   2, Average loss: 0.0343, Accuracy: 516/1475 (34.9831%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   3, Average loss: 0.0302, Accuracy: 571/1475 (38.7119%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   4, Average loss: 0.0296, Accuracy: 540/1475 (36.6102%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   5, Average loss: 0.0295, Accuracy: 534/1475 (36.2034%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   6, Average loss: 0.0288, Accuracy: 599/1475 (40.6102%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   7, Average loss: 0.0281, Accuracy: 579/1475 (39.2542%), train_poison_data_count: 463
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   8, Average loss: 0.0281, Accuracy: 593/1475 (40.2034%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   9, Average loss: 0.0280, Accuracy: 591/1475 (40.0678%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch  10, Average loss: 0.0267, Accuracy: 617/1475 (41.8305%), train_poison_data_count: 463
Global model norm: 294.04560923860095.
Norm before scaling: 293.9655724953179. Distance: 1.2767459975628612
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.5647, Accuracy: 83/10000 (0.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 67: Avg loss: 1.1235, Accuracy: 6332/9950 (63.6382%)
Scaling by  100
Scaled Norm after poisoning: 312.8832275186703, distance: 127.67458941093173
Total norm for 4 adversaries is: 312.8832275186703. distance: 127.67458941093173
___Test Local_ResNet_18 poisoned: True, epoch: 67: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   1, Avg loss: 0.1266, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   2, Avg loss: 0.0717, Accuracy: 54/338 (15.9763%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.2355, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   1, Avg loss: 0.0989, Accuracy: 91/719 (12.6565%)
___Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   2, Avg loss: 0.0416, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.4189, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.1363, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.1146, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.3920, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0669, Accuracy: 240/1036 (23.1660%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0266, Accuracy: 639/1036 (61.6795%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 13.2565, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   1, Avg loss: 0.0873, Accuracy: 123/715 (17.2028%)
___Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   2, Avg loss: 0.0504, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.1630, Accuracy: 51/10000 (0.5100%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   1, Avg loss: 0.0643, Accuracy: 243/1129 (21.5235%)
___Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 707/1129 (62.6218%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 10.2849, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   1, Avg loss: 0.0968, Accuracy: 36/669 (5.3812%)
___Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   2, Avg loss: 0.0471, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.4525, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.1195, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0796, Accuracy: 15/311 (4.8232%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.2618, Accuracy: 84/10000 (0.8400%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   1, Avg loss: 0.0649, Accuracy: 226/1275 (17.7255%)
___Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   2, Avg loss: 0.0205, Accuracy: 658/1275 (51.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 11.5409, Accuracy: 111/10000 (1.1100%)
time spent on training: 322.4412479400635
___Test Target_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.7422, Accuracy: 84/10000 (0.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 67: Avg loss: 1.6084, Accuracy: 3492/9950 (35.0955%)
saving model
Done in 709.5581703186035 sec.
Server Epoch:68 choose agents : [30, 17, 54, 91, 69, 28, 65, 60, 9, 11].
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   1, Avg loss: 0.1186, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   2, Avg loss: 0.0507, Accuracy: 169/486 (34.7737%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.5376, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0713, Accuracy: 242/1574 (15.3748%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0298, Accuracy: 637/1574 (40.4701%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.3948, Accuracy: 112/10000 (1.1200%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   1, Avg loss: 0.0737, Accuracy: 199/1130 (17.6106%)
___Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   2, Avg loss: 0.0294, Accuracy: 504/1130 (44.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 10.2521, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   1, Avg loss: 0.0703, Accuracy: 205/1030 (19.9029%)
___Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   2, Avg loss: 0.0266, Accuracy: 629/1030 (61.0680%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 10.9600, Accuracy: 109/10000 (1.0900%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   1, Avg loss: 0.0890, Accuracy: 85/590 (14.4068%)
___Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   2, Avg loss: 0.0368, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 13.9025, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   1, Avg loss: 0.0772, Accuracy: 232/1581 (14.6743%)
___Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   2, Avg loss: 0.0361, Accuracy: 557/1581 (35.2309%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.5016, Accuracy: 91/10000 (0.9100%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   1, Avg loss: 0.0302, Accuracy: 651/1475 (44.1356%)
___Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   2, Avg loss: 0.0242, Accuracy: 758/1475 (51.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.7438, Accuracy: 102/10000 (1.0200%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0490, Accuracy: 651/2227 (29.2322%)
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0260, Accuracy: 1114/2227 (50.0225%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 9.0781, Accuracy: 144/10000 (1.4400%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0666, Accuracy: 236/1275 (18.5098%)
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0201, Accuracy: 671/1275 (52.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 11.8644, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   1, Avg loss: 0.0970, Accuracy: 78/712 (10.9551%)
___Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   2, Avg loss: 0.0294, Accuracy: 435/712 (61.0955%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 11.0789, Accuracy: 70/10000 (0.7000%)
time spent on training: 309.69994378089905
___Test Target_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.8080, Accuracy: 83/10000 (0.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 68: Avg loss: 2.2349, Accuracy: 1349/9950 (13.5578%)
saving model
Done in 714.5853490829468 sec.
Server Epoch:69 choose agents : [69, 3, 66, 36, 78, 83, 8, 10, 93, 58].
poison local model 69 index 24 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Average loss: 0.0692, Accuracy: 145/590 (24.5763%), train_poison_data_count: 194
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Average loss: 0.0352, Accuracy: 289/590 (48.9831%), train_poison_data_count: 194
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   3, Average loss: 0.0289, Accuracy: 270/590 (45.7627%), train_poison_data_count: 194
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   4, Average loss: 0.0304, Accuracy: 258/590 (43.7288%), train_poison_data_count: 194
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   5, Average loss: 0.0282, Accuracy: 276/590 (46.7797%), train_poison_data_count: 194
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   6, Average loss: 0.0294, Accuracy: 286/590 (48.4746%), train_poison_data_count: 194
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   7, Average loss: 0.0267, Accuracy: 285/590 (48.3051%), train_poison_data_count: 194
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   8, Average loss: 0.0244, Accuracy: 291/590 (49.3220%), train_poison_data_count: 194
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   9, Average loss: 0.0261, Accuracy: 282/590 (47.7966%), train_poison_data_count: 194
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch  10, Average loss: 0.0268, Accuracy: 283/590 (47.9661%), train_poison_data_count: 194
Global model norm: 297.7895780790523.
Norm before scaling: 297.7617677145607. Distance: 0.7347403084400349
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.2914, Accuracy: 54/10000 (0.5400%)
___Test Local_ResNet_18 poisoned: True, epoch: 69: Avg loss: 0.8587, Accuracy: 5745/9950 (57.7387%)
Scaling by  100
Scaled Norm after poisoning: 303.91967997317977, distance: 73.47402682028188
Total norm for 5 adversaries is: 303.91967997317977. distance: 73.47402682028188
___Test Local_ResNet_18 poisoned: True, epoch: 69: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   1, Avg loss: 0.0988, Accuracy: 11/781 (1.4085%)
___Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   2, Avg loss: 0.0384, Accuracy: 239/781 (30.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.5317, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   1, Avg loss: 0.0850, Accuracy: 162/1402 (11.5549%)
___Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   2, Avg loss: 0.0422, Accuracy: 370/1402 (26.3909%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.0637, Accuracy: 71/10000 (0.7100%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   1, Avg loss: 0.1200, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   2, Avg loss: 0.0626, Accuracy: 79/408 (19.3627%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.9042, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   1, Avg loss: 0.1199, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   2, Avg loss: 0.0583, Accuracy: 103/416 (24.7596%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.9071, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0773, Accuracy: 282/1953 (14.4393%)
___Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0355, Accuracy: 725/1953 (37.1224%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.9464, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   1, Avg loss: 0.0771, Accuracy: 144/1513 (9.5175%)
___Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 488/1513 (32.2538%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.4158, Accuracy: 101/10000 (1.0100%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   1, Avg loss: 0.0878, Accuracy: 62/861 (7.2009%)
___Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   2, Avg loss: 0.0224, Accuracy: 419/861 (48.6643%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 11.2438, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   1, Avg loss: 0.0674, Accuracy: 293/1742 (16.8197%)
___Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 705/1742 (40.4707%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.9764, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   1, Avg loss: 0.0732, Accuracy: 209/803 (26.0274%)
___Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   2, Avg loss: 0.0395, Accuracy: 407/803 (50.6849%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.3052, Accuracy: 64/10000 (0.6400%)
time spent on training: 362.67007088661194
___Test Target_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.7694, Accuracy: 62/10000 (0.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 69: Avg loss: 1.3308, Accuracy: 3096/9950 (31.1156%)
saving model
Done in 766.5445973873138 sec.
Server Epoch:70 choose agents : [22, 18, 31, 35, 88, 66, 36, 14, 27, 48].
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0716, Accuracy: 345/1470 (23.4694%)
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0262, Accuracy: 818/1470 (55.6463%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.9039, Accuracy: 99/10000 (0.9900%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   1, Avg loss: 0.1158, Accuracy: 3/530 (0.5660%)
___Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   2, Avg loss: 0.0421, Accuracy: 281/530 (53.0189%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 10.1890, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   1, Avg loss: 0.1266, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   2, Avg loss: 0.0443, Accuracy: 158/460 (34.3478%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.5484, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   1, Avg loss: 0.1678, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   2, Avg loss: 0.0971, Accuracy: 4/271 (1.4760%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.7703, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.1044, Accuracy: 37/603 (6.1360%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0523, Accuracy: 288/603 (47.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.4786, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0884, Accuracy: 142/1402 (10.1284%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0420, Accuracy: 357/1402 (25.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.1240, Accuracy: 82/10000 (0.8200%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.1315, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0611, Accuracy: 82/408 (20.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.7920, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   1, Avg loss: 0.1036, Accuracy: 87/1013 (8.5884%)
___Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   2, Avg loss: 0.0425, Accuracy: 318/1013 (31.3919%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.7445, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   1, Avg loss: 0.0805, Accuracy: 280/1587 (17.6434%)
___Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   2, Avg loss: 0.0367, Accuracy: 574/1587 (36.1689%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.7547, Accuracy: 67/10000 (0.6700%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.1050, Accuracy: 8/631 (1.2678%)
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0436, Accuracy: 231/631 (36.6086%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.3833, Accuracy: 78/10000 (0.7800%)
time spent on training: 241.26954579353333
___Test Target_ResNet_18 poisoned: False, epoch: 70: Avg loss: 9.7904, Accuracy: 62/10000 (0.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 70: Avg loss: 1.4105, Accuracy: 3099/9950 (31.1457%)
saving model
Done in 644.2651519775391 sec.
Server Epoch:71 choose agents : [72, 77, 92, 31, 46, 66, 54, 0, 25, 36].
poison local model 72 index 25 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   1, Average loss: 0.0711, Accuracy: 296/1241 (23.8517%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   2, Average loss: 0.0388, Accuracy: 393/1241 (31.6680%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   3, Average loss: 0.0356, Accuracy: 379/1241 (30.5399%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   4, Average loss: 0.0342, Accuracy: 399/1241 (32.1515%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   5, Average loss: 0.0341, Accuracy: 396/1241 (31.9098%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   6, Average loss: 0.0336, Accuracy: 427/1241 (34.4077%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   7, Average loss: 0.0326, Accuracy: 431/1241 (34.7301%), train_poison_data_count: 400
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   8, Average loss: 0.0330, Accuracy: 435/1241 (35.0524%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   9, Average loss: 0.0332, Accuracy: 411/1241 (33.1185%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch  10, Average loss: 0.0330, Accuracy: 423/1241 (34.0854%), train_poison_data_count: 400
Global model norm: 301.52085852391707.
Norm before scaling: 301.454391243518. Distance: 1.183281633877462
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.4326, Accuracy: 57/10000 (0.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 71: Avg loss: 1.1520, Accuracy: 6320/9950 (63.5176%)
Scaling by  100
Scaled Norm after poisoning: 317.442526786346, distance: 118.32817348638912
Total norm for 5 adversaries is: 317.442526786346. distance: 118.32817348638912
___Test Local_ResNet_18 poisoned: True, epoch: 71: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0665, Accuracy: 268/1340 (20.0000%)
___Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0294, Accuracy: 580/1340 (43.2836%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.3314, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   1, Avg loss: 0.0703, Accuracy: 287/1715 (16.7347%)
___Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   2, Avg loss: 0.0314, Accuracy: 691/1715 (40.2915%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.8518, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   1, Avg loss: 0.1116, Accuracy: 1/460 (0.2174%)
___Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   2, Avg loss: 0.0488, Accuracy: 165/460 (35.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.0121, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   1, Avg loss: 0.0659, Accuracy: 330/1904 (17.3319%)
___Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 710/1904 (37.2899%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.6193, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   1, Avg loss: 0.0850, Accuracy: 144/1402 (10.2710%)
___Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   2, Avg loss: 0.0420, Accuracy: 354/1402 (25.2496%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.9601, Accuracy: 76/10000 (0.7600%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   1, Avg loss: 0.0706, Accuracy: 232/1130 (20.5310%)
___Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   2, Avg loss: 0.0294, Accuracy: 521/1130 (46.1062%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 10.3027, Accuracy: 64/10000 (0.6400%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   1, Avg loss: 0.0775, Accuracy: 257/1657 (15.5100%)
___Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   2, Avg loss: 0.0384, Accuracy: 465/1657 (28.0628%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.2179, Accuracy: 62/10000 (0.6200%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   1, Avg loss: 0.0836, Accuracy: 141/690 (20.4348%)
___Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   2, Avg loss: 0.0325, Accuracy: 456/690 (66.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 10.2375, Accuracy: 57/10000 (0.5700%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   1, Avg loss: 0.1216, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   2, Avg loss: 0.0591, Accuracy: 100/408 (24.5098%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.8978, Accuracy: 51/10000 (0.5100%)
time spent on training: 369.05675172805786
___Test Target_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.5467, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Avg loss: 1.8985, Accuracy: 2160/9950 (21.7085%)
saving model
Done in 774.1629776954651 sec.
Server Epoch:72 choose agents : [7, 99, 12, 11, 10, 15, 85, 26, 14, 29].
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0842, Accuracy: 138/891 (15.4882%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0310, Accuracy: 461/891 (51.7396%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.9227, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0941, Accuracy: 63/773 (8.1501%)
___Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0338, Accuracy: 403/773 (52.1345%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 10.7655, Accuracy: 74/10000 (0.7400%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   1, Avg loss: 0.1314, Accuracy: 1/338 (0.2959%)
___Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   2, Avg loss: 0.0708, Accuracy: 37/338 (10.9467%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.8473, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   1, Avg loss: 0.0968, Accuracy: 79/712 (11.0955%)
___Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   2, Avg loss: 0.0319, Accuracy: 438/712 (61.5169%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 10.9795, Accuracy: 68/10000 (0.6800%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   1, Avg loss: 0.0927, Accuracy: 61/861 (7.0848%)
___Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 481/861 (55.8653%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 11.0888, Accuracy: 100/10000 (1.0000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   1, Avg loss: 0.0780, Accuracy: 213/1154 (18.4575%)
___Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   2, Avg loss: 0.0328, Accuracy: 408/1154 (35.3553%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.9817, Accuracy: 71/10000 (0.7100%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   1, Avg loss: 0.0776, Accuracy: 297/1988 (14.9396%)
___Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   2, Avg loss: 0.0382, Accuracy: 625/1988 (31.4386%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.2697, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   1, Avg loss: 0.0822, Accuracy: 209/1446 (14.4537%)
___Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   2, Avg loss: 0.0375, Accuracy: 528/1446 (36.5145%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.6682, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   1, Avg loss: 0.1011, Accuracy: 76/1013 (7.5025%)
___Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   2, Avg loss: 0.0412, Accuracy: 331/1013 (32.6752%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.7312, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   1, Avg loss: 0.0726, Accuracy: 274/1440 (19.0278%)
___Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   2, Avg loss: 0.0310, Accuracy: 647/1440 (44.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.7835, Accuracy: 84/10000 (0.8400%)
time spent on training: 268.44132947921753
___Test Target_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.1334, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Avg loss: 2.1802, Accuracy: 1262/9950 (12.6834%)
saving model
Done in 662.5423634052277 sec.
Server Epoch:73 choose agents : [74, 81, 71, 96, 73, 8, 10, 55, 33, 35].
poison local model 74 index 26 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   1, Average loss: 0.0575, Accuracy: 372/1552 (23.9691%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   2, Average loss: 0.0279, Accuracy: 521/1552 (33.5696%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   3, Average loss: 0.0245, Accuracy: 655/1552 (42.2036%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   4, Average loss: 0.0249, Accuracy: 587/1552 (37.8222%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   5, Average loss: 0.0250, Accuracy: 584/1552 (37.6289%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   6, Average loss: 0.0241, Accuracy: 640/1552 (41.2371%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   7, Average loss: 0.0241, Accuracy: 650/1552 (41.8814%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   8, Average loss: 0.0235, Accuracy: 656/1552 (42.2680%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   9, Average loss: 0.0232, Accuracy: 647/1552 (41.6881%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch  10, Average loss: 0.0234, Accuracy: 680/1552 (43.8144%), train_poison_data_count: 496
Global model norm: 305.2033005842171.
Norm before scaling: 305.11679372414096. Distance: 1.3144454615739414
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 10.4944, Accuracy: 62/10000 (0.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 73: Avg loss: 1.1159, Accuracy: 5378/9950 (54.0503%)
Scaling by  100
Scaled Norm after poisoning: 323.99734759716785, distance: 131.4445433205578
Total norm for 5 adversaries is: 323.99734759716785. distance: 131.4445433205578
___Test Local_ResNet_18 poisoned: True, epoch: 73: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0864, Accuracy: 111/774 (14.3411%)
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0415, Accuracy: 353/774 (45.6072%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.0945, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.1013, Accuracy: 31/818 (3.7897%)
___Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0349, Accuracy: 352/818 (43.0318%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.8143, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.1239, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0817, Accuracy: 18/311 (5.7878%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.2995, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   1, Avg loss: 0.0792, Accuracy: 155/938 (16.5245%)
___Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   2, Avg loss: 0.0365, Accuracy: 337/938 (35.9275%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.7685, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   1, Avg loss: 0.0768, Accuracy: 151/1513 (9.9802%)
___Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   2, Avg loss: 0.0374, Accuracy: 465/1513 (30.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.4897, Accuracy: 99/10000 (0.9900%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0887, Accuracy: 57/861 (6.6202%)
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 456/861 (52.9617%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 10.9919, Accuracy: 102/10000 (1.0200%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   1, Avg loss: 0.0782, Accuracy: 144/1071 (13.4454%)
___Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   2, Avg loss: 0.0307, Accuracy: 522/1071 (48.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 10.6455, Accuracy: 83/10000 (0.8300%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.1101, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0592, Accuracy: 117/515 (22.7184%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.1256, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   1, Avg loss: 0.1475, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   2, Avg loss: 0.0985, Accuracy: 1/271 (0.3690%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.9826, Accuracy: 54/10000 (0.5400%)
time spent on training: 351.04864501953125
___Test Target_ResNet_18 poisoned: False, epoch: 73: Avg loss: 10.7555, Accuracy: 70/10000 (0.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Avg loss: 1.1502, Accuracy: 5111/9950 (51.3668%)
saving model
Done in 766.0028576850891 sec.
Server Epoch:74 choose agents : [50, 33, 10, 20, 28, 37, 46, 27, 93, 60].
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.1058, Accuracy: 16/809 (1.9778%)
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0280, Accuracy: 380/809 (46.9716%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 10.8956, Accuracy: 100/10000 (1.0000%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   1, Avg loss: 0.1447, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   2, Avg loss: 0.0615, Accuracy: 76/515 (14.7573%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.4386, Accuracy: 59/10000 (0.5900%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   1, Avg loss: 0.1077, Accuracy: 27/861 (3.1359%)
___Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 456/861 (52.9617%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 11.5692, Accuracy: 101/10000 (1.0100%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   1, Avg loss: 0.1056, Accuracy: 74/807 (9.1698%)
___Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   2, Avg loss: 0.0443, Accuracy: 418/807 (51.7968%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.6071, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0894, Accuracy: 203/1581 (12.8400%)
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0378, Accuracy: 512/1581 (32.3846%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.3899, Accuracy: 92/10000 (0.9200%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0842, Accuracy: 250/1129 (22.1435%)
___Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0281, Accuracy: 703/1129 (62.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 10.4286, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   1, Avg loss: 0.0782, Accuracy: 294/1904 (15.4412%)
___Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 690/1904 (36.2395%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.5784, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   1, Avg loss: 0.0908, Accuracy: 265/1587 (16.6982%)
___Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   2, Avg loss: 0.0361, Accuracy: 549/1587 (34.5936%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.3547, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0804, Accuracy: 277/1742 (15.9013%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0330, Accuracy: 668/1742 (38.3467%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 9.3193, Accuracy: 95/10000 (0.9500%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   1, Avg loss: 0.0634, Accuracy: 530/2227 (23.7988%)
___Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 1031/2227 (46.2955%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.6833, Accuracy: 128/10000 (1.2800%)
time spent on training: 295.62978506088257
___Test Target_ResNet_18 poisoned: False, epoch: 74: Avg loss: 10.2682, Accuracy: 63/10000 (0.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Avg loss: 1.1346, Accuracy: 5343/9950 (53.6985%)
saving model
Done in 716.7639122009277 sec.
Server Epoch:75 choose agents : [78, 51, 85, 6, 92, 32, 29, 40, 95, 74].
poison local model 78 index 27 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   1, Average loss: 0.1039, Accuracy: 94/416 (22.5962%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   2, Average loss: 0.0678, Accuracy: 112/416 (26.9231%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   3, Average loss: 0.0434, Accuracy: 155/416 (37.2596%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   4, Average loss: 0.0424, Accuracy: 158/416 (37.9808%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   5, Average loss: 0.0406, Accuracy: 156/416 (37.5000%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   6, Average loss: 0.0377, Accuracy: 182/416 (43.7500%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   7, Average loss: 0.0384, Accuracy: 163/416 (39.1827%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   8, Average loss: 0.0362, Accuracy: 179/416 (43.0288%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   9, Average loss: 0.0370, Accuracy: 159/416 (38.2212%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch  10, Average loss: 0.0357, Accuracy: 178/416 (42.7885%), train_poison_data_count: 140
Global model norm: 308.7930764484528.
Norm before scaling: 308.7743031932871. Distance: 0.7309878539656207
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.5411, Accuracy: 88/10000 (0.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 75: Avg loss: 0.9859, Accuracy: 7417/9950 (74.5427%)
Scaling by  100
Scaled Norm after poisoning: 315.41140049544816, distance: 73.09878670119977
Total norm for 4 adversaries is: 315.41140049544816. distance: 73.09878670119977
___Test Local_ResNet_18 poisoned: True, epoch: 75: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   1, Avg loss: 0.0913, Accuracy: 144/1049 (13.7274%)
___Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 511/1049 (48.7131%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.0289, Accuracy: 107/10000 (1.0700%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0832, Accuracy: 267/1988 (13.4306%)
___Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0387, Accuracy: 566/1988 (28.4708%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.3014, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   1, Avg loss: 0.0758, Accuracy: 284/1956 (14.5194%)
___Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 652/1956 (33.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.8855, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   1, Avg loss: 0.0789, Accuracy: 266/1715 (15.5102%)
___Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   2, Avg loss: 0.0332, Accuracy: 630/1715 (36.7347%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.9604, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   1, Avg loss: 0.0869, Accuracy: 91/735 (12.3810%)
___Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   2, Avg loss: 0.0282, Accuracy: 359/735 (48.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 12.8596, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   1, Avg loss: 0.0780, Accuracy: 260/1440 (18.0556%)
___Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   2, Avg loss: 0.0300, Accuracy: 674/1440 (46.8056%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.8606, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0740, Accuracy: 212/1573 (13.4774%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0367, Accuracy: 556/1573 (35.3465%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.6185, Accuracy: 76/10000 (0.7600%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   1, Avg loss: 0.1158, Accuracy: 36/599 (6.0100%)
___Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   2, Avg loss: 0.0333, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 15.4019, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0234, Accuracy: 680/1552 (43.8144%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0199, Accuracy: 865/1552 (55.7345%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.5426, Accuracy: 91/10000 (0.9100%)
time spent on training: 328.58877539634705
___Test Target_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.4639, Accuracy: 72/10000 (0.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Avg loss: 1.6298, Accuracy: 3924/9950 (39.4372%)
saving model
Done in 758.1511771678925 sec.
Server Epoch:76 choose agents : [6, 5, 30, 19, 88, 49, 14, 57, 85, 92].
___Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   1, Avg loss: 0.0657, Accuracy: 303/1956 (15.4908%)
___Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 653/1956 (33.3845%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.8249, Accuracy: 116/10000 (1.1600%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0655, Accuracy: 270/1628 (16.5848%)
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0273, Accuracy: 764/1628 (46.9287%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.8987, Accuracy: 142/10000 (1.4200%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   1, Avg loss: 0.1051, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   2, Avg loss: 0.0471, Accuracy: 184/486 (37.8601%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.4813, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   1, Avg loss: 0.0510, Accuracy: 313/1036 (30.2124%)
___Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   2, Avg loss: 0.0251, Accuracy: 652/1036 (62.9344%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 11.8492, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0914, Accuracy: 47/603 (7.7944%)
___Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0523, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.3561, Accuracy: 57/10000 (0.5700%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   1, Avg loss: 0.1004, Accuracy: 1/440 (0.2273%)
___Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   2, Avg loss: 0.0559, Accuracy: 91/440 (20.6818%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.6189, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0919, Accuracy: 81/1013 (7.9961%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0406, Accuracy: 348/1013 (34.3534%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.7225, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   1, Avg loss: 0.0785, Accuracy: 156/1154 (13.5182%)
___Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   2, Avg loss: 0.0288, Accuracy: 472/1154 (40.9012%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 11.4359, Accuracy: 69/10000 (0.6900%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   1, Avg loss: 0.0726, Accuracy: 298/1988 (14.9899%)
___Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   2, Avg loss: 0.0390, Accuracy: 579/1988 (29.1247%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.3207, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0679, Accuracy: 279/1715 (16.2682%)
___Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0320, Accuracy: 688/1715 (40.1166%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.7727, Accuracy: 85/10000 (0.8500%)
time spent on training: 277.1870424747467
___Test Target_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.6167, Accuracy: 80/10000 (0.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Avg loss: 2.0807, Accuracy: 2470/9950 (24.8241%)
saving model
Done in 702.5193023681641 sec.
Server Epoch:77 choose agents : [81, 75, 66, 1, 61, 65, 79, 49, 94, 10].
poison local model 81 index 28 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   1, Average loss: 0.0633, Accuracy: 179/774 (23.1266%), train_poison_data_count: 246
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   2, Average loss: 0.0384, Accuracy: 290/774 (37.4677%), train_poison_data_count: 246
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   3, Average loss: 0.0320, Accuracy: 286/774 (36.9509%), train_poison_data_count: 246
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   4, Average loss: 0.0332, Accuracy: 286/774 (36.9509%), train_poison_data_count: 246
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   5, Average loss: 0.0326, Accuracy: 279/774 (36.0465%), train_poison_data_count: 246
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   6, Average loss: 0.0307, Accuracy: 311/774 (40.1809%), train_poison_data_count: 246
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   7, Average loss: 0.0304, Accuracy: 298/774 (38.5013%), train_poison_data_count: 246
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   8, Average loss: 0.0304, Accuracy: 310/774 (40.0517%), train_poison_data_count: 246
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   9, Average loss: 0.0311, Accuracy: 283/774 (36.5633%), train_poison_data_count: 246
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch  10, Average loss: 0.0314, Accuracy: 295/774 (38.1137%), train_poison_data_count: 246
Global model norm: 312.42008978297156.
Norm before scaling: 312.38002697035546. Distance: 0.8377177453589498
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.2294, Accuracy: 67/10000 (0.6700%)
___Test Local_ResNet_18 poisoned: True, epoch: 77: Avg loss: 0.9980, Accuracy: 6307/9950 (63.3869%)
Scaling by  100
Scaled Norm after poisoning: 319.45504133993563, distance: 83.77177597030368
Total norm for 5 adversaries is: 319.45504133993563. distance: 83.77177597030368
___Test Local_ResNet_18 poisoned: True, epoch: 77: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   1, Avg loss: 0.0892, Accuracy: 102/776 (13.1443%)
___Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   2, Avg loss: 0.0356, Accuracy: 412/776 (53.0928%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 9.2142, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0813, Accuracy: 158/1402 (11.2696%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0415, Accuracy: 356/1402 (25.3923%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.1840, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   1, Avg loss: 0.0694, Accuracy: 199/928 (21.4440%)
___Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   2, Avg loss: 0.0253, Accuracy: 575/928 (61.9612%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 9.9672, Accuracy: 102/10000 (1.0200%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1663, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1442, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.0475, Accuracy: 83/10000 (0.8300%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   1, Avg loss: 0.0515, Accuracy: 387/1475 (26.2373%)
___Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   2, Avg loss: 0.0303, Accuracy: 676/1475 (45.8305%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.4495, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   1, Avg loss: 0.1515, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   2, Avg loss: 0.1307, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.6166, Accuracy: 79/10000 (0.7900%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0962, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0548, Accuracy: 113/440 (25.6818%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.7835, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0713, Accuracy: 225/1662 (13.5379%)
___Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0358, Accuracy: 549/1662 (33.0325%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 9.1340, Accuracy: 85/10000 (0.8500%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   1, Avg loss: 0.0791, Accuracy: 80/861 (9.2915%)
___Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   2, Avg loss: 0.0227, Accuracy: 404/861 (46.9222%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 11.0138, Accuracy: 88/10000 (0.8800%)
time spent on training: 297.2895781993866
___Test Target_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.3923, Accuracy: 70/10000 (0.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Avg loss: 1.7535, Accuracy: 2234/9950 (22.4523%)
saving model
Done in 727.383466720581 sec.
Server Epoch:78 choose agents : [42, 6, 82, 30, 19, 31, 93, 7, 5, 16].
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   1, Avg loss: 0.0731, Accuracy: 186/1372 (13.5569%)
___Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   2, Avg loss: 0.0327, Accuracy: 509/1372 (37.0991%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.3077, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   1, Avg loss: 0.0675, Accuracy: 320/1956 (16.3599%)
___Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   2, Avg loss: 0.0326, Accuracy: 644/1956 (32.9243%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.7999, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   1, Avg loss: 0.1122, Accuracy: 3/500 (0.6000%)
___Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   2, Avg loss: 0.0612, Accuracy: 155/500 (31.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.8060, Accuracy: 72/10000 (0.7200%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.1108, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0461, Accuracy: 186/486 (38.2716%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.3240, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   1, Avg loss: 0.0606, Accuracy: 273/1036 (26.3514%)
___Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   2, Avg loss: 0.0261, Accuracy: 638/1036 (61.5830%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 13.3484, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   1, Avg loss: 0.1100, Accuracy: 1/460 (0.2174%)
___Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   2, Avg loss: 0.0411, Accuracy: 154/460 (33.4783%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.6190, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   1, Avg loss: 0.0683, Accuracy: 306/1742 (17.5660%)
___Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 682/1742 (39.1504%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.8105, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   1, Avg loss: 0.0781, Accuracy: 176/891 (19.7531%)
___Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   2, Avg loss: 0.0301, Accuracy: 416/891 (46.6891%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.8806, Accuracy: 75/10000 (0.7500%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   1, Avg loss: 0.0700, Accuracy: 237/1628 (14.5577%)
___Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   2, Avg loss: 0.0275, Accuracy: 747/1628 (45.8845%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 9.8552, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   1, Avg loss: 0.0961, Accuracy: 97/708 (13.7006%)
___Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   2, Avg loss: 0.0412, Accuracy: 429/708 (60.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.2271, Accuracy: 77/10000 (0.7700%)
time spent on training: 258.502179145813
___Test Target_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.0157, Accuracy: 59/10000 (0.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Avg loss: 1.8724, Accuracy: 2380/9950 (23.9196%)
saving model
Done in 682.4258921146393 sec.
Server Epoch:79 choose agents : [84, 82, 36, 58, 27, 49, 61, 52, 90, 85].
poison local model 84 index 29 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   1, Average loss: 0.0738, Accuracy: 285/1190 (23.9496%), train_poison_data_count: 380
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   2, Average loss: 0.0395, Accuracy: 361/1190 (30.3361%), train_poison_data_count: 380
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   3, Average loss: 0.0329, Accuracy: 408/1190 (34.2857%), train_poison_data_count: 380
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   4, Average loss: 0.0322, Accuracy: 425/1190 (35.7143%), train_poison_data_count: 380
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   5, Average loss: 0.0308, Accuracy: 454/1190 (38.1513%), train_poison_data_count: 380
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   6, Average loss: 0.0312, Accuracy: 422/1190 (35.4622%), train_poison_data_count: 380
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   7, Average loss: 0.0308, Accuracy: 448/1190 (37.6471%), train_poison_data_count: 380
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   8, Average loss: 0.0300, Accuracy: 447/1190 (37.5630%), train_poison_data_count: 380
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   9, Average loss: 0.0294, Accuracy: 477/1190 (40.0840%), train_poison_data_count: 380
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch  10, Average loss: 0.0301, Accuracy: 441/1190 (37.0588%), train_poison_data_count: 380
Global model norm: 315.96651078476657.
Norm before scaling: 315.90107975044975. Distance: 1.202740595455506
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.2324, Accuracy: 75/10000 (0.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 79: Avg loss: 1.1533, Accuracy: 6115/9950 (61.4573%)
Scaling by  100
Scaled Norm after poisoning: 331.694913474717, distance: 120.27405635802137
Total norm for 5 adversaries is: 331.694913474717. distance: 120.27405635802137
___Test Local_ResNet_18 poisoned: True, epoch: 79: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   1, Avg loss: 0.1052, Accuracy: 3/500 (0.6000%)
___Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   2, Avg loss: 0.0603, Accuracy: 159/500 (31.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.7556, Accuracy: 69/10000 (0.6900%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   1, Avg loss: 0.1166, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   2, Avg loss: 0.0606, Accuracy: 79/408 (19.3627%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.7835, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   1, Avg loss: 0.0808, Accuracy: 169/803 (21.0461%)
___Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   2, Avg loss: 0.0417, Accuracy: 438/803 (54.5455%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.2855, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0785, Accuracy: 271/1587 (17.0762%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0364, Accuracy: 572/1587 (36.0428%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.2433, Accuracy: 72/10000 (0.7200%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   1, Avg loss: 0.1078, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   2, Avg loss: 0.0579, Accuracy: 87/440 (19.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.4444, Accuracy: 54/10000 (0.5400%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   1, Avg loss: 0.1727, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   2, Avg loss: 0.1621, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.4476, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0764, Accuracy: 130/636 (20.4403%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0418, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 10.0494, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   1, Avg loss: 0.0849, Accuracy: 109/677 (16.1004%)
___Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   2, Avg loss: 0.0261, Accuracy: 463/677 (68.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 11.9488, Accuracy: 62/10000 (0.6200%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0715, Accuracy: 274/1988 (13.7827%)
___Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0394, Accuracy: 613/1988 (30.8350%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.5208, Accuracy: 71/10000 (0.7100%)
time spent on training: 295.0067434310913
___Test Target_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.2680, Accuracy: 83/10000 (0.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Avg loss: 1.5971, Accuracy: 4216/9950 (42.3719%)
saving model
Done in 728.2604789733887 sec.
Server Epoch:80 choose agents : [46, 75, 54, 3, 89, 69, 41, 1, 93, 71].
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0724, Accuracy: 295/1904 (15.4937%)
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0329, Accuracy: 645/1904 (33.8761%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.4910, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0993, Accuracy: 67/776 (8.6340%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0385, Accuracy: 396/776 (51.0309%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.3585, Accuracy: 61/10000 (0.6100%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   1, Avg loss: 0.0821, Accuracy: 194/1130 (17.1681%)
___Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   2, Avg loss: 0.0323, Accuracy: 460/1130 (40.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.9096, Accuracy: 60/10000 (0.6000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   1, Avg loss: 0.1010, Accuracy: 13/781 (1.6645%)
___Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   2, Avg loss: 0.0383, Accuracy: 261/781 (33.4187%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.4939, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0900, Accuracy: 170/896 (18.9732%)
___Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0416, Accuracy: 466/896 (52.0089%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.9391, Accuracy: 55/10000 (0.5500%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   1, Avg loss: 0.1072, Accuracy: 35/590 (5.9322%)
___Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   2, Avg loss: 0.0370, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 14.1715, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   1, Avg loss: 0.1081, Accuracy: 65/719 (9.0403%)
___Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   2, Avg loss: 0.0438, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.0229, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   1, Avg loss: 0.0804, Accuracy: 153/928 (16.4871%)
___Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   2, Avg loss: 0.0285, Accuracy: 543/928 (58.5129%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 10.1980, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   1, Avg loss: 0.0695, Accuracy: 296/1742 (16.9920%)
___Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 719/1742 (41.2744%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.9549, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   1, Avg loss: 0.0783, Accuracy: 114/818 (13.9364%)
___Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   2, Avg loss: 0.0343, Accuracy: 331/818 (40.4645%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.8500, Accuracy: 76/10000 (0.7600%)
time spent on training: 249.98502135276794
___Test Target_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.3891, Accuracy: 79/10000 (0.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Avg loss: 2.1550, Accuracy: 1898/9950 (19.0754%)
saving model
Done in 676.9059302806854 sec.
Server Epoch:81 choose agents : [85, 15, 81, 53, 39, 54, 28, 61, 0, 51].
poison local model 85 index 30 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   1, Average loss: 0.0638, Accuracy: 493/1988 (24.7988%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   2, Average loss: 0.0386, Accuracy: 580/1988 (29.1751%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   3, Average loss: 0.0353, Accuracy: 675/1988 (33.9537%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   4, Average loss: 0.0344, Accuracy: 660/1988 (33.1992%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   5, Average loss: 0.0342, Accuracy: 672/1988 (33.8028%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   6, Average loss: 0.0339, Accuracy: 665/1988 (33.4507%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   7, Average loss: 0.0327, Accuracy: 694/1988 (34.9095%), train_poison_data_count: 624
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   8, Average loss: 0.0327, Accuracy: 683/1988 (34.3561%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   9, Average loss: 0.0328, Accuracy: 700/1988 (35.2113%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch  10, Average loss: 0.0323, Accuracy: 692/1988 (34.8089%), train_poison_data_count: 624
Global model norm: 319.45369627302796.
Norm before scaling: 319.3330818870792. Distance: 1.4663135529750886
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.5823, Accuracy: 70/10000 (0.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 81: Avg loss: 1.1091, Accuracy: 6900/9950 (69.3467%)
Scaling by  100
Scaled Norm after poisoning: 340.0481238920456, distance: 146.63135376259063
Total norm for 6 adversaries is: 340.0481238920456. distance: 146.63135376259063
___Test Local_ResNet_18 poisoned: True, epoch: 81: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0819, Accuracy: 202/1154 (17.5043%)
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0331, Accuracy: 381/1154 (33.0156%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.9615, Accuracy: 57/10000 (0.5700%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0821, Accuracy: 80/774 (10.3359%)
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0343, Accuracy: 351/774 (45.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.5260, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0767, Accuracy: 133/813 (16.3592%)
___Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0223, Accuracy: 427/813 (52.5215%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 13.4077, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   1, Avg loss: 0.0866, Accuracy: 115/1013 (11.3524%)
___Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   2, Avg loss: 0.0291, Accuracy: 476/1013 (46.9891%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 10.4554, Accuracy: 78/10000 (0.7800%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0790, Accuracy: 198/1130 (17.5221%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0325, Accuracy: 446/1130 (39.4690%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 10.1469, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   1, Avg loss: 0.0726, Accuracy: 250/1581 (15.8128%)
___Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   2, Avg loss: 0.0360, Accuracy: 565/1581 (35.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.5286, Accuracy: 97/10000 (0.9700%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1889, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1725, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.7308, Accuracy: 76/10000 (0.7600%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   1, Avg loss: 0.0803, Accuracy: 230/1657 (13.8805%)
___Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   2, Avg loss: 0.0393, Accuracy: 473/1657 (28.5456%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.2760, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   1, Avg loss: 0.0870, Accuracy: 124/1049 (11.8208%)
___Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 504/1049 (48.0458%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.9363, Accuracy: 112/10000 (1.1200%)
time spent on training: 354.44630575180054
___Test Target_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.1750, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Avg loss: 1.2416, Accuracy: 6084/9950 (61.1457%)
saving model
Done in 784.4057092666626 sec.
Server Epoch:82 choose agents : [23, 74, 72, 38, 79, 44, 28, 77, 55, 70].
___Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   1, Avg loss: 0.1137, Accuracy: 64/715 (8.9510%)
___Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   2, Avg loss: 0.0530, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.1851, Accuracy: 52/10000 (0.5200%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0562, Accuracy: 397/1552 (25.5799%)
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0216, Accuracy: 778/1552 (50.1289%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 12.7724, Accuracy: 81/10000 (0.8100%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0777, Accuracy: 151/1241 (12.1676%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0379, Accuracy: 431/1241 (34.7301%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.9175, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   1, Avg loss: 0.0927, Accuracy: 118/1131 (10.4332%)
___Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   2, Avg loss: 0.0346, Accuracy: 497/1131 (43.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 9.0181, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1816, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.1551, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.9954, Accuracy: 75/10000 (0.7500%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0778, Accuracy: 251/1750 (14.3429%)
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0366, Accuracy: 670/1750 (38.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.3722, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0724, Accuracy: 261/1581 (16.5085%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0358, Accuracy: 523/1581 (33.0803%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.5686, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   1, Avg loss: 0.0799, Accuracy: 206/1340 (15.3731%)
___Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   2, Avg loss: 0.0307, Accuracy: 562/1340 (41.9403%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 10.1516, Accuracy: 68/10000 (0.6800%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   1, Avg loss: 0.0822, Accuracy: 140/1071 (13.0719%)
___Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   2, Avg loss: 0.0322, Accuracy: 504/1071 (47.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 10.8156, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   1, Avg loss: 0.0826, Accuracy: 212/1418 (14.9506%)
___Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   2, Avg loss: 0.0338, Accuracy: 605/1418 (42.6657%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.9972, Accuracy: 94/10000 (0.9400%)
time spent on training: 284.47945380210876
___Test Target_ResNet_18 poisoned: False, epoch: 82: Avg loss: 9.1948, Accuracy: 75/10000 (0.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Avg loss: 1.4191, Accuracy: 5433/9950 (54.6030%)
saving model
Done in 705.4074060916901 sec.
Server Epoch:83 choose agents : [95, 76, 60, 48, 18, 10, 90, 78, 15, 89].
poison local model 95 index 31 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   1, Average loss: 0.0855, Accuracy: 135/599 (22.5376%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   2, Average loss: 0.0362, Accuracy: 300/599 (50.0835%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   3, Average loss: 0.0316, Accuracy: 319/599 (53.2554%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   4, Average loss: 0.0296, Accuracy: 299/599 (49.9165%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   5, Average loss: 0.0286, Accuracy: 297/599 (49.5826%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   6, Average loss: 0.0268, Accuracy: 279/599 (46.5776%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   7, Average loss: 0.0273, Accuracy: 294/599 (49.0818%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   8, Average loss: 0.0263, Accuracy: 333/599 (55.5927%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   9, Average loss: 0.0272, Accuracy: 297/599 (49.5826%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch  10, Average loss: 0.0271, Accuracy: 294/599 (49.0818%), train_poison_data_count: 200
Global model norm: 322.8237352836684.
Norm before scaling: 322.7933259068409. Distance: 0.8251340222592866
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.3312, Accuracy: 56/10000 (0.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 83: Avg loss: 1.0044, Accuracy: 4313/9950 (43.3467%)
Scaling by  100
Scaled Norm after poisoning: 330.1405122254765, distance: 82.51340740960677
Total norm for 7 adversaries is: 330.1405122254765. distance: 82.51340740960677
___Test Local_ResNet_18 poisoned: True, epoch: 83: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   1, Avg loss: 0.1253, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   2, Avg loss: 0.0670, Accuracy: 93/466 (19.9571%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.3799, Accuracy: 53/10000 (0.5300%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   1, Avg loss: 0.0617, Accuracy: 534/2227 (23.9784%)
___Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   2, Avg loss: 0.0295, Accuracy: 981/2227 (44.0503%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.7971, Accuracy: 126/10000 (1.2600%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   1, Avg loss: 0.1072, Accuracy: 6/631 (0.9509%)
___Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   2, Avg loss: 0.0512, Accuracy: 208/631 (32.9635%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.2503, Accuracy: 76/10000 (0.7600%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.1171, Accuracy: 2/530 (0.3774%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0470, Accuracy: 253/530 (47.7358%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.1298, Accuracy: 67/10000 (0.6700%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   1, Avg loss: 0.0950, Accuracy: 53/861 (6.1556%)
___Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   2, Avg loss: 0.0251, Accuracy: 421/861 (48.8966%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 11.1761, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   1, Avg loss: 0.0881, Accuracy: 91/677 (13.4417%)
___Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   2, Avg loss: 0.0251, Accuracy: 469/677 (69.2762%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 12.9004, Accuracy: 58/10000 (0.5800%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.1069, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0497, Accuracy: 142/416 (34.1346%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.5884, Accuracy: 80/10000 (0.8000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   1, Avg loss: 0.0857, Accuracy: 178/1154 (15.4246%)
___Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   2, Avg loss: 0.0412, Accuracy: 441/1154 (38.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 10.1455, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   1, Avg loss: 0.0928, Accuracy: 160/896 (17.8571%)
___Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   2, Avg loss: 0.0425, Accuracy: 467/896 (52.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.2208, Accuracy: 62/10000 (0.6200%)
time spent on training: 321.00023317337036
___Test Target_ResNet_18 poisoned: False, epoch: 83: Avg loss: 11.1889, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Avg loss: 1.3295, Accuracy: 2787/9950 (28.0101%)
saving model
Done in 743.1265559196472 sec.
Server Epoch:84 choose agents : [61, 28, 35, 75, 74, 90, 55, 80, 23, 88].
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.2284, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.2066, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 9.3566, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0747, Accuracy: 257/1581 (16.2555%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0353, Accuracy: 563/1581 (35.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.7863, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.1580, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0868, Accuracy: 14/271 (5.1661%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.4554, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   1, Avg loss: 0.1076, Accuracy: 80/776 (10.3093%)
___Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   2, Avg loss: 0.0349, Accuracy: 415/776 (53.4794%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 10.0089, Accuracy: 65/10000 (0.6500%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   1, Avg loss: 0.0561, Accuracy: 421/1552 (27.1263%)
___Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 782/1552 (50.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 11.8544, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   1, Avg loss: 0.1012, Accuracy: 92/677 (13.5894%)
___Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   2, Avg loss: 0.0241, Accuracy: 461/677 (68.0945%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 12.6361, Accuracy: 55/10000 (0.5500%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0855, Accuracy: 164/1071 (15.3128%)
___Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0310, Accuracy: 490/1071 (45.7516%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 10.0187, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.1139, Accuracy: 30/682 (4.3988%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0463, Accuracy: 267/682 (39.1496%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.9050, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   1, Avg loss: 0.1141, Accuracy: 84/715 (11.7483%)
___Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   2, Avg loss: 0.0514, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.4231, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.1168, Accuracy: 18/603 (2.9851%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0541, Accuracy: 287/603 (47.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.9890, Accuracy: 65/10000 (0.6500%)
time spent on training: 225.96333622932434
___Test Target_ResNet_18 poisoned: False, epoch: 84: Avg loss: 10.5043, Accuracy: 44/10000 (0.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Avg loss: 1.2035, Accuracy: 3680/9950 (36.9849%)
saving model
Done in 645.7850604057312 sec.
Server Epoch:85 choose agents : [36, 56, 25, 90, 31, 70, 30, 21, 46, 64].
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   1, Avg loss: 0.1347, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   2, Avg loss: 0.0642, Accuracy: 80/408 (19.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.1162, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   1, Avg loss: 0.1495, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   2, Avg loss: 0.1175, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.4694, Accuracy: 53/10000 (0.5300%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   1, Avg loss: 0.0956, Accuracy: 118/690 (17.1014%)
___Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   2, Avg loss: 0.0374, Accuracy: 455/690 (65.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 10.4538, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   1, Avg loss: 0.0911, Accuracy: 105/677 (15.5096%)
___Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   2, Avg loss: 0.0236, Accuracy: 465/677 (68.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 12.4040, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.1196, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0410, Accuracy: 155/460 (33.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.5012, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   1, Avg loss: 0.0792, Accuracy: 284/1418 (20.0282%)
___Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   2, Avg loss: 0.0344, Accuracy: 617/1418 (43.5120%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.8629, Accuracy: 84/10000 (0.8400%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.1222, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0445, Accuracy: 188/486 (38.6831%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 9.1290, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   1, Avg loss: 0.0718, Accuracy: 299/1949 (15.3412%)
___Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   2, Avg loss: 0.0369, Accuracy: 569/1949 (29.1945%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.6851, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   1, Avg loss: 0.0729, Accuracy: 340/1904 (17.8571%)
___Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   2, Avg loss: 0.0330, Accuracy: 660/1904 (34.6639%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.4871, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.1018, Accuracy: 61/953 (6.4008%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0464, Accuracy: 299/953 (31.3746%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.3555, Accuracy: 72/10000 (0.7200%)
time spent on training: 242.09533715248108
___Test Target_ResNet_18 poisoned: False, epoch: 85: Avg loss: 10.0355, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Avg loss: 0.9205, Accuracy: 5543/9950 (55.7085%)
saving model
Done in 655.7399816513062 sec.
Server Epoch:86 choose agents : [94, 50, 2, 53, 86, 67, 12, 69, 24, 81].
___Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   1, Avg loss: 0.0800, Accuracy: 201/1662 (12.0939%)
___Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   2, Avg loss: 0.0371, Accuracy: 592/1662 (35.6197%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.8754, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   1, Avg loss: 0.0849, Accuracy: 57/809 (7.0457%)
___Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   2, Avg loss: 0.0304, Accuracy: 322/809 (39.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.4508, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.1179, Accuracy: 6/605 (0.9917%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0533, Accuracy: 322/605 (53.2231%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.8111, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   1, Avg loss: 0.0701, Accuracy: 146/813 (17.9582%)
___Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   2, Avg loss: 0.0209, Accuracy: 467/813 (57.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 13.4961, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   1, Avg loss: 0.0765, Accuracy: 219/1003 (21.8345%)
___Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   2, Avg loss: 0.0373, Accuracy: 412/1003 (41.0768%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.3140, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   1, Avg loss: 0.1225, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   2, Avg loss: 0.0577, Accuracy: 117/426 (27.4648%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.3274, Accuracy: 50/10000 (0.5000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   1, Avg loss: 0.1272, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   2, Avg loss: 0.0669, Accuracy: 73/338 (21.5976%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.0907, Accuracy: 62/10000 (0.6200%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   1, Avg loss: 0.1070, Accuracy: 48/590 (8.1356%)
___Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   2, Avg loss: 0.0361, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 13.7286, Accuracy: 50/10000 (0.5000%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.1214, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0612, Accuracy: 53/312 (16.9872%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.5074, Accuracy: 53/10000 (0.5300%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0891, Accuracy: 72/774 (9.3023%)
___Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0362, Accuracy: 348/774 (44.9612%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.7174, Accuracy: 76/10000 (0.7600%)
time spent on training: 231.01184463500977
___Test Target_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.1001, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Avg loss: 0.6674, Accuracy: 7569/9950 (76.0704%)
saving model
Done in 660.6267783641815 sec.
Server Epoch:87 choose agents : [39, 80, 90, 83, 43, 57, 67, 2, 23, 36].
___Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   1, Avg loss: 0.0844, Accuracy: 122/1013 (12.0434%)
___Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   2, Avg loss: 0.0292, Accuracy: 470/1013 (46.3968%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 10.9105, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   1, Avg loss: 0.0939, Accuracy: 42/682 (6.1584%)
___Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   2, Avg loss: 0.0443, Accuracy: 281/682 (41.2023%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.9836, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   1, Avg loss: 0.0819, Accuracy: 112/677 (16.5436%)
___Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   2, Avg loss: 0.0246, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 12.9030, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   1, Avg loss: 0.0708, Accuracy: 302/1953 (15.4634%)
___Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   2, Avg loss: 0.0361, Accuracy: 717/1953 (36.7127%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.2943, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0857, Accuracy: 150/946 (15.8562%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0427, Accuracy: 384/946 (40.5920%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.9034, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0847, Accuracy: 148/1154 (12.8250%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0334, Accuracy: 433/1154 (37.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 11.6148, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   1, Avg loss: 0.1175, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   2, Avg loss: 0.0584, Accuracy: 129/426 (30.2817%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.5037, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   1, Avg loss: 0.1136, Accuracy: 11/605 (1.8182%)
___Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   2, Avg loss: 0.0516, Accuracy: 322/605 (53.2231%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 9.5569, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0946, Accuracy: 115/715 (16.0839%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0489, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.1244, Accuracy: 57/10000 (0.5700%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   1, Avg loss: 0.1187, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   2, Avg loss: 0.0620, Accuracy: 87/408 (21.3235%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.9425, Accuracy: 54/10000 (0.5400%)
time spent on training: 215.80714392662048
___Test Target_ResNet_18 poisoned: False, epoch: 87: Avg loss: 10.0646, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Avg loss: 0.8131, Accuracy: 7273/9950 (73.0955%)
saving model
Done in 650.1797678470612 sec.
Server Epoch:88 choose agents : [4, 42, 28, 74, 13, 49, 24, 34, 87, 86].
___Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   1, Avg loss: 0.0903, Accuracy: 154/901 (17.0921%)
___Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   2, Avg loss: 0.0441, Accuracy: 429/901 (47.6138%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.1741, Accuracy: 57/10000 (0.5700%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   1, Avg loss: 0.0762, Accuracy: 172/1372 (12.5364%)
___Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   2, Avg loss: 0.0337, Accuracy: 491/1372 (35.7872%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.6490, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0680, Accuracy: 264/1581 (16.6983%)
___Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0368, Accuracy: 539/1581 (34.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.4824, Accuracy: 85/10000 (0.8500%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   1, Avg loss: 0.0467, Accuracy: 456/1552 (29.3814%)
___Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   2, Avg loss: 0.0218, Accuracy: 795/1552 (51.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 11.7880, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   1, Avg loss: 0.0770, Accuracy: 224/1645 (13.6170%)
___Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   2, Avg loss: 0.0362, Accuracy: 555/1645 (33.7386%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.8814, Accuracy: 104/10000 (1.0400%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   1, Avg loss: 0.1106, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   2, Avg loss: 0.0623, Accuracy: 75/440 (17.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.5166, Accuracy: 59/10000 (0.5900%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   1, Avg loss: 0.1032, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   2, Avg loss: 0.0545, Accuracy: 73/312 (23.3974%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.7057, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0742, Accuracy: 237/1427 (16.6083%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0348, Accuracy: 560/1427 (39.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.3817, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   1, Avg loss: 0.0787, Accuracy: 197/1131 (17.4182%)
___Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   2, Avg loss: 0.0368, Accuracy: 355/1131 (31.3882%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.0647, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0689, Accuracy: 239/1003 (23.8285%)
___Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0368, Accuracy: 411/1003 (40.9771%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 8.4852, Accuracy: 58/10000 (0.5800%)
time spent on training: 284.7409324645996
___Test Target_ResNet_18 poisoned: False, epoch: 88: Avg loss: 10.2334, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Avg loss: 1.0348, Accuracy: 6698/9950 (67.3166%)
saving model
Done in 696.1314752101898 sec.
Server Epoch:89 choose agents : [84, 89, 29, 52, 37, 30, 66, 62, 88, 42].
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0646, Accuracy: 227/1190 (19.0756%)
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0309, Accuracy: 472/1190 (39.6639%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.8151, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0800, Accuracy: 189/896 (21.0938%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0399, Accuracy: 463/896 (51.6741%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.2732, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   1, Avg loss: 0.0732, Accuracy: 299/1440 (20.7639%)
___Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   2, Avg loss: 0.0319, Accuracy: 635/1440 (44.0972%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.2997, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   1, Avg loss: 0.0762, Accuracy: 132/636 (20.7547%)
___Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   2, Avg loss: 0.0407, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 10.6846, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   1, Avg loss: 0.0710, Accuracy: 228/1129 (20.1949%)
___Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   2, Avg loss: 0.0284, Accuracy: 638/1129 (56.5102%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.9893, Accuracy: 97/10000 (0.9700%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   1, Avg loss: 0.0977, Accuracy: 4/486 (0.8230%)
___Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   2, Avg loss: 0.0429, Accuracy: 194/486 (39.9177%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.6886, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0820, Accuracy: 146/1402 (10.4137%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0415, Accuracy: 403/1402 (28.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.1488, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   1, Avg loss: 0.0933, Accuracy: 15/568 (2.6408%)
___Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   2, Avg loss: 0.0460, Accuracy: 253/568 (44.5423%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.5263, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   1, Avg loss: 0.0904, Accuracy: 40/603 (6.6335%)
___Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   2, Avg loss: 0.0514, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.9020, Accuracy: 58/10000 (0.5800%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0745, Accuracy: 171/1372 (12.4636%)
___Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0348, Accuracy: 480/1372 (34.9854%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.4000, Accuracy: 78/10000 (0.7800%)
time spent on training: 260.73203229904175
___Test Target_ResNet_18 poisoned: False, epoch: 89: Avg loss: 9.7802, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Avg loss: 1.4485, Accuracy: 5497/9950 (55.2462%)
saving model
Done in 684.5566754341125 sec.
Server Epoch:90 choose agents : [43, 80, 99, 44, 67, 39, 70, 50, 86, 91].
___Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   1, Avg loss: 0.0836, Accuracy: 142/946 (15.0106%)
___Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   2, Avg loss: 0.0444, Accuracy: 367/946 (38.7949%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.8832, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   1, Avg loss: 0.0798, Accuracy: 84/682 (12.3167%)
___Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   2, Avg loss: 0.0432, Accuracy: 269/682 (39.4428%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.6574, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   1, Avg loss: 0.0918, Accuracy: 76/773 (9.8318%)
___Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   2, Avg loss: 0.0352, Accuracy: 368/773 (47.6067%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.0430, Accuracy: 76/10000 (0.7600%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   1, Avg loss: 0.0684, Accuracy: 260/1750 (14.8571%)
___Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   2, Avg loss: 0.0370, Accuracy: 645/1750 (36.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.2834, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   1, Avg loss: 0.1014, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   2, Avg loss: 0.0535, Accuracy: 148/426 (34.7418%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.7934, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0785, Accuracy: 131/1013 (12.9319%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0285, Accuracy: 480/1013 (47.3840%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.5637, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0675, Accuracy: 286/1418 (20.1693%)
___Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0337, Accuracy: 600/1418 (42.3131%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.9159, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   1, Avg loss: 0.0769, Accuracy: 57/809 (7.0457%)
___Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   2, Avg loss: 0.0308, Accuracy: 331/809 (40.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.3506, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   1, Avg loss: 0.0661, Accuracy: 243/1003 (24.2273%)
___Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   2, Avg loss: 0.0376, Accuracy: 397/1003 (39.5813%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.1847, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   1, Avg loss: 0.0691, Accuracy: 206/1030 (20.0000%)
___Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   2, Avg loss: 0.0298, Accuracy: 596/1030 (57.8641%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 11.0690, Accuracy: 93/10000 (0.9300%)
time spent on training: 234.9080982208252
___Test Target_ResNet_18 poisoned: False, epoch: 90: Avg loss: 9.1245, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Avg loss: 1.6124, Accuracy: 5062/9950 (50.8744%)
saving model
Done in 661.4167232513428 sec.
Server Epoch:91 choose agents : [33, 37, 28, 92, 97, 43, 56, 44, 24, 64].
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0994, Accuracy: 15/515 (2.9126%)
___Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0635, Accuracy: 126/515 (24.4660%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.7953, Accuracy: 53/10000 (0.5300%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   1, Avg loss: 0.0664, Accuracy: 265/1129 (23.4721%)
___Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   2, Avg loss: 0.0269, Accuracy: 688/1129 (60.9389%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 9.8826, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   1, Avg loss: 0.0649, Accuracy: 251/1581 (15.8760%)
___Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   2, Avg loss: 0.0368, Accuracy: 509/1581 (32.1948%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.5595, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   1, Avg loss: 0.0653, Accuracy: 338/1715 (19.7085%)
___Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   2, Avg loss: 0.0330, Accuracy: 644/1715 (37.5510%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.8194, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   1, Avg loss: 0.0748, Accuracy: 188/1213 (15.4988%)
___Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   2, Avg loss: 0.0311, Accuracy: 507/1213 (41.7972%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 10.2516, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0814, Accuracy: 144/946 (15.2220%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0434, Accuracy: 361/946 (38.1607%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.9630, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   1, Avg loss: 0.1165, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   2, Avg loss: 0.0988, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.0312, Accuracy: 56/10000 (0.5600%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   1, Avg loss: 0.0668, Accuracy: 295/1750 (16.8571%)
___Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   2, Avg loss: 0.0369, Accuracy: 640/1750 (36.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.2332, Accuracy: 105/10000 (1.0500%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0972, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0553, Accuracy: 73/312 (23.3974%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.6539, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   1, Avg loss: 0.0875, Accuracy: 64/953 (6.7156%)
___Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   2, Avg loss: 0.0432, Accuracy: 303/953 (31.7943%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.4153, Accuracy: 72/10000 (0.7200%)
time spent on training: 273.17181968688965
___Test Target_ResNet_18 poisoned: False, epoch: 91: Avg loss: 9.0895, Accuracy: 67/10000 (0.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Avg loss: 2.0935, Accuracy: 3764/9950 (37.8291%)
saving model
Done in 703.2879934310913 sec.
Server Epoch:92 choose agents : [71, 40, 7, 67, 97, 72, 34, 58, 26, 38].
___Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   1, Avg loss: 0.0790, Accuracy: 115/818 (14.0587%)
___Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   2, Avg loss: 0.0348, Accuracy: 299/818 (36.5526%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.9102, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0713, Accuracy: 272/1573 (17.2918%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0389, Accuracy: 545/1573 (34.6472%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.0779, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   1, Avg loss: 0.0723, Accuracy: 190/891 (21.3244%)
___Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   2, Avg loss: 0.0314, Accuracy: 411/891 (46.1279%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.6464, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0988, Accuracy: 3/426 (0.7042%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0536, Accuracy: 133/426 (31.2207%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.3702, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   1, Avg loss: 0.0738, Accuracy: 180/1213 (14.8392%)
___Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   2, Avg loss: 0.0307, Accuracy: 519/1213 (42.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 10.1394, Accuracy: 72/10000 (0.7200%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 258/1241 (20.7897%)
___Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 408/1241 (32.8767%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.5870, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   1, Avg loss: 0.0687, Accuracy: 271/1427 (18.9909%)
___Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   2, Avg loss: 0.0350, Accuracy: 565/1427 (39.5936%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.4930, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0763, Accuracy: 176/803 (21.9178%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0419, Accuracy: 439/803 (54.6700%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.5046, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   1, Avg loss: 0.0675, Accuracy: 237/1446 (16.3900%)
___Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   2, Avg loss: 0.0384, Accuracy: 491/1446 (33.9557%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.1638, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0748, Accuracy: 163/1131 (14.4120%)
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0344, Accuracy: 464/1131 (41.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.5830, Accuracy: 90/10000 (0.9000%)
time spent on training: 253.56939315795898
___Test Target_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.1868, Accuracy: 59/10000 (0.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Avg loss: 2.3170, Accuracy: 3214/9950 (32.3015%)
saving model
Done in 671.8961281776428 sec.
Server Epoch:93 choose agents : [62, 58, 59, 51, 15, 43, 3, 13, 79, 53].
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.0883, Accuracy: 18/568 (3.1690%)
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0468, Accuracy: 263/568 (46.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.5609, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   1, Avg loss: 0.0771, Accuracy: 159/803 (19.8007%)
___Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   2, Avg loss: 0.0400, Accuracy: 438/803 (54.5455%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.3966, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0744, Accuracy: 193/1089 (17.7227%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0332, Accuracy: 483/1089 (44.3526%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.5237, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   1, Avg loss: 0.0797, Accuracy: 134/1049 (12.7741%)
___Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   2, Avg loss: 0.0324, Accuracy: 502/1049 (47.8551%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.2874, Accuracy: 106/10000 (1.0600%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0735, Accuracy: 235/1154 (20.3640%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0362, Accuracy: 424/1154 (36.7418%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 10.2985, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   1, Avg loss: 0.0778, Accuracy: 150/946 (15.8562%)
___Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   2, Avg loss: 0.0432, Accuracy: 354/946 (37.4207%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.9907, Accuracy: 72/10000 (0.7200%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   1, Avg loss: 0.0850, Accuracy: 22/781 (2.8169%)
___Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   2, Avg loss: 0.0385, Accuracy: 257/781 (32.9065%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.3156, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   1, Avg loss: 0.0704, Accuracy: 261/1645 (15.8663%)
___Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   2, Avg loss: 0.0354, Accuracy: 573/1645 (34.8328%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.8953, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   1, Avg loss: 0.1454, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   2, Avg loss: 0.1276, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 6.9846, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   1, Avg loss: 0.0631, Accuracy: 166/813 (20.4182%)
___Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   2, Avg loss: 0.0216, Accuracy: 441/813 (54.2435%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 13.3399, Accuracy: 58/10000 (0.5800%)
time spent on training: 242.19698309898376
___Test Target_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.5259, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Avg loss: 2.6387, Accuracy: 2842/9950 (28.5628%)
saving model
Done in 664.191239118576 sec.
Server Epoch:94 choose agents : [51, 3, 17, 5, 55, 92, 4, 75, 35, 60].
___Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0793, Accuracy: 127/1049 (12.1068%)
___Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0336, Accuracy: 451/1049 (42.9933%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.1048, Accuracy: 105/10000 (1.0500%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0825, Accuracy: 32/781 (4.0973%)
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0370, Accuracy: 264/781 (33.8028%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.6023, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   1, Avg loss: 0.0689, Accuracy: 249/1574 (15.8196%)
___Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   2, Avg loss: 0.0308, Accuracy: 584/1574 (37.1029%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.4442, Accuracy: 101/10000 (1.0100%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0640, Accuracy: 238/1628 (14.6192%)
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0284, Accuracy: 709/1628 (43.5504%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.0307, Accuracy: 123/10000 (1.2300%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   1, Avg loss: 0.0657, Accuracy: 182/1071 (16.9935%)
___Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   2, Avg loss: 0.0307, Accuracy: 493/1071 (46.0317%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 10.2704, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   1, Avg loss: 0.0620, Accuracy: 346/1715 (20.1749%)
___Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   2, Avg loss: 0.0322, Accuracy: 693/1715 (40.4082%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.0160, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0819, Accuracy: 162/901 (17.9800%)
___Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0427, Accuracy: 446/901 (49.5006%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.0572, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   1, Avg loss: 0.0825, Accuracy: 103/776 (13.2732%)
___Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   2, Avg loss: 0.0365, Accuracy: 401/776 (51.6753%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.7861, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.1051, Accuracy: 1/271 (0.3690%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0703, Accuracy: 40/271 (14.7601%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.8726, Accuracy: 54/10000 (0.5400%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   1, Avg loss: 0.0576, Accuracy: 540/2227 (24.2479%)
___Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   2, Avg loss: 0.0311, Accuracy: 941/2227 (42.2542%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.9286, Accuracy: 121/10000 (1.2100%)
time spent on training: 303.9229838848114
___Test Target_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.9110, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Avg loss: 2.9053, Accuracy: 2248/9950 (22.5930%)
saving model
Done in 721.1722271442413 sec.
Server Epoch:95 choose agents : [54, 15, 1, 87, 63, 69, 60, 22, 43, 45].
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   1, Avg loss: 0.0666, Accuracy: 303/1130 (26.8142%)
___Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   2, Avg loss: 0.0332, Accuracy: 432/1130 (38.2301%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.3948, Accuracy: 67/10000 (0.6700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   1, Avg loss: 0.0774, Accuracy: 228/1154 (19.7574%)
___Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   2, Avg loss: 0.0323, Accuracy: 416/1154 (36.0485%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.0888, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0665, Accuracy: 212/928 (22.8448%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0257, Accuracy: 576/928 (62.0690%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.7449, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   1, Avg loss: 0.0710, Accuracy: 204/1131 (18.0371%)
___Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   2, Avg loss: 0.0367, Accuracy: 384/1131 (33.9523%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.9912, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   1, Avg loss: 0.0869, Accuracy: 126/888 (14.1892%)
___Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   2, Avg loss: 0.0307, Accuracy: 387/888 (43.5811%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.1097, Accuracy: 64/10000 (0.6400%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   1, Avg loss: 0.0907, Accuracy: 84/590 (14.2373%)
___Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   2, Avg loss: 0.0323, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 13.2855, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   1, Avg loss: 0.0571, Accuracy: 533/2227 (23.9335%)
___Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   2, Avg loss: 0.0304, Accuracy: 941/2227 (42.2542%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.8490, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   1, Avg loss: 0.0645, Accuracy: 361/1470 (24.5578%)
___Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   2, Avg loss: 0.0268, Accuracy: 824/1470 (56.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.0455, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   1, Avg loss: 0.0775, Accuracy: 153/946 (16.1734%)
___Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   2, Avg loss: 0.0420, Accuracy: 361/946 (38.1607%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.0063, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   1, Avg loss: 0.0806, Accuracy: 72/669 (10.7623%)
___Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   2, Avg loss: 0.0476, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.4025, Accuracy: 66/10000 (0.6600%)
time spent on training: 329.1068630218506
___Test Target_ResNet_18 poisoned: False, epoch: 95: Avg loss: 9.1673, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Avg loss: 3.8980, Accuracy: 1034/9950 (10.3920%)
saving model
Done in 758.9816665649414 sec.
Server Epoch:96 choose agents : [12, 11, 52, 2, 65, 23, 68, 97, 82, 9].
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0959, Accuracy: 17/338 (5.0296%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0592, Accuracy: 124/338 (36.6864%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.4029, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0832, Accuracy: 108/712 (15.1685%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0311, Accuracy: 446/712 (62.6404%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 11.3059, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   1, Avg loss: 0.0722, Accuracy: 157/636 (24.6855%)
___Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   2, Avg loss: 0.0407, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 10.2441, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0935, Accuracy: 31/605 (5.1240%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0489, Accuracy: 324/605 (53.5537%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.0556, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   1, Avg loss: 0.0649, Accuracy: 306/1475 (20.7458%)
___Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   2, Avg loss: 0.0336, Accuracy: 624/1475 (42.3051%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.7319, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   1, Avg loss: 0.0868, Accuracy: 112/715 (15.6643%)
___Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   2, Avg loss: 0.0471, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.8237, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   1, Avg loss: 0.0756, Accuracy: 194/1163 (16.6810%)
___Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   2, Avg loss: 0.0417, Accuracy: 464/1163 (39.8968%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.4958, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   1, Avg loss: 0.0691, Accuracy: 195/1213 (16.0758%)
___Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   2, Avg loss: 0.0305, Accuracy: 504/1213 (41.5499%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 9.9099, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0857, Accuracy: 13/500 (2.6000%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0533, Accuracy: 187/500 (37.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.2601, Accuracy: 65/10000 (0.6500%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0551, Accuracy: 288/1275 (22.5882%)
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0207, Accuracy: 681/1275 (53.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 11.0841, Accuracy: 92/10000 (0.9200%)
time spent on training: 249.60393834114075
___Test Target_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.8903, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Avg loss: 4.1914, Accuracy: 652/9950 (6.5528%)
saving model
Done in 669.1776866912842 sec.
Server Epoch:97 choose agents : [80, 34, 72, 81, 41, 77, 71, 35, 7, 4].
___Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   1, Avg loss: 0.0737, Accuracy: 89/682 (13.0499%)
___Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   2, Avg loss: 0.0415, Accuracy: 285/682 (41.7889%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.9419, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0645, Accuracy: 266/1427 (18.6405%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0348, Accuracy: 581/1427 (40.7148%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.6925, Accuracy: 72/10000 (0.7200%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 251/1241 (20.2256%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 411/1241 (33.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.6043, Accuracy: 71/10000 (0.7100%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   1, Avg loss: 0.0772, Accuracy: 103/774 (13.3075%)
___Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   2, Avg loss: 0.0381, Accuracy: 346/774 (44.7028%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.5069, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0820, Accuracy: 131/719 (18.2197%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0383, Accuracy: 470/719 (65.3686%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.8724, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   1, Avg loss: 0.0666, Accuracy: 257/1340 (19.1791%)
___Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   2, Avg loss: 0.0315, Accuracy: 547/1340 (40.8209%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.8800, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   1, Avg loss: 0.0757, Accuracy: 132/818 (16.1369%)
___Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   2, Avg loss: 0.0355, Accuracy: 310/818 (37.8973%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.7625, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0989, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0681, Accuracy: 50/271 (18.4502%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.7102, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0707, Accuracy: 195/891 (21.8855%)
___Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0300, Accuracy: 450/891 (50.5051%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 10.0346, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   1, Avg loss: 0.0806, Accuracy: 179/901 (19.8668%)
___Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   2, Avg loss: 0.0395, Accuracy: 415/901 (46.0599%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.3423, Accuracy: 61/10000 (0.6100%)
time spent on training: 243.85813117027283
___Test Target_ResNet_18 poisoned: False, epoch: 97: Avg loss: 10.2433, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Avg loss: 4.8442, Accuracy: 378/9950 (3.7990%)
saving model
Done in 669.7387742996216 sec.
Server Epoch:98 choose agents : [24, 6, 1, 16, 62, 2, 87, 17, 43, 18].
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.0968, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0579, Accuracy: 104/312 (33.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.9253, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   1, Avg loss: 0.0628, Accuracy: 319/1956 (16.3088%)
___Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   2, Avg loss: 0.0334, Accuracy: 638/1956 (32.6176%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.2671, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   1, Avg loss: 0.0668, Accuracy: 211/928 (22.7371%)
___Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   2, Avg loss: 0.0257, Accuracy: 554/928 (59.6983%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.6570, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0700, Accuracy: 161/708 (22.7401%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0393, Accuracy: 428/708 (60.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.5145, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0825, Accuracy: 37/568 (6.5141%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0437, Accuracy: 259/568 (45.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.0116, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   1, Avg loss: 0.0916, Accuracy: 45/605 (7.4380%)
___Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   2, Avg loss: 0.0514, Accuracy: 325/605 (53.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.3854, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0705, Accuracy: 193/1131 (17.0645%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0362, Accuracy: 396/1131 (35.0133%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.1074, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   1, Avg loss: 0.0655, Accuracy: 294/1574 (18.6785%)
___Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   2, Avg loss: 0.0296, Accuracy: 644/1574 (40.9149%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.5322, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0754, Accuracy: 168/946 (17.7590%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0424, Accuracy: 352/946 (37.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.0906, Accuracy: 68/10000 (0.6800%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   1, Avg loss: 0.0815, Accuracy: 46/530 (8.6792%)
___Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   2, Avg loss: 0.0421, Accuracy: 279/530 (52.6415%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.9279, Accuracy: 66/10000 (0.6600%)
time spent on training: 247.77168774604797
___Test Target_ResNet_18 poisoned: False, epoch: 98: Avg loss: 6.3797, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Avg loss: 2.5767, Accuracy: 30/9950 (0.3015%)
saving model
Done in 660.4062724113464 sec.
Server Epoch:99 choose agents : [18, 14, 2, 45, 63, 95, 90, 4, 23, 8].
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   1, Avg loss: 0.0753, Accuracy: 67/530 (12.6415%)
___Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   2, Avg loss: 0.0422, Accuracy: 274/530 (51.6981%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.5853, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   1, Avg loss: 0.0905, Accuracy: 76/1013 (7.5025%)
___Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   2, Avg loss: 0.0407, Accuracy: 362/1013 (35.7354%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.0551, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   1, Avg loss: 0.0905, Accuracy: 40/605 (6.6116%)
___Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   2, Avg loss: 0.0504, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.5223, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   1, Avg loss: 0.0822, Accuracy: 80/669 (11.9581%)
___Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   2, Avg loss: 0.0449, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.9275, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   1, Avg loss: 0.0885, Accuracy: 135/888 (15.2027%)
___Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   2, Avg loss: 0.0304, Accuracy: 379/888 (42.6802%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 10.0113, Accuracy: 81/10000 (0.8100%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0384, Accuracy: 332/599 (55.4257%)
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0255, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 12.1048, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   1, Avg loss: 0.0781, Accuracy: 137/677 (20.2363%)
___Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   2, Avg loss: 0.0255, Accuracy: 453/677 (66.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 11.9753, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   1, Avg loss: 0.0759, Accuracy: 192/901 (21.3097%)
___Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   2, Avg loss: 0.0391, Accuracy: 434/901 (48.1687%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 9.1187, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0879, Accuracy: 112/715 (15.6643%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0459, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.0354, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   1, Avg loss: 0.0703, Accuracy: 172/1513 (11.3681%)
___Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   2, Avg loss: 0.0401, Accuracy: 434/1513 (28.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.3528, Accuracy: 89/10000 (0.8900%)
time spent on training: 233.08079314231873
___Test Target_ResNet_18 poisoned: False, epoch: 99: Avg loss: 6.3879, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Avg loss: 2.7205, Accuracy: 0/9950 (0.0000%)
saving model
Done in 657.2825353145599 sec.
Server Epoch:100 choose agents : [57, 53, 36, 10, 37, 13, 40, 62, 39, 80].
___Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0748, Accuracy: 184/1154 (15.9445%)
___Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0317, Accuracy: 432/1154 (37.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 11.4059, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0570, Accuracy: 201/813 (24.7232%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0207, Accuracy: 474/813 (58.3026%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 13.1576, Accuracy: 49/10000 (0.4900%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   1, Avg loss: 0.0986, Accuracy: 9/408 (2.2059%)
___Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   2, Avg loss: 0.0581, Accuracy: 131/408 (32.1078%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.2458, Accuracy: 49/10000 (0.4900%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   1, Avg loss: 0.0676, Accuracy: 126/861 (14.6341%)
___Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   2, Avg loss: 0.0240, Accuracy: 415/861 (48.1998%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 10.8791, Accuracy: 75/10000 (0.7500%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0644, Accuracy: 254/1129 (22.4978%)
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0294, Accuracy: 624/1129 (55.2702%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 10.1273, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   1, Avg loss: 0.0709, Accuracy: 281/1645 (17.0821%)
___Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   2, Avg loss: 0.0359, Accuracy: 544/1645 (33.0699%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.7665, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0652, Accuracy: 289/1573 (18.3725%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0383, Accuracy: 551/1573 (35.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.2532, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   1, Avg loss: 0.0809, Accuracy: 30/568 (5.2817%)
___Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   2, Avg loss: 0.0432, Accuracy: 259/568 (45.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.0694, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0672, Accuracy: 174/1013 (17.1767%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0289, Accuracy: 482/1013 (47.5814%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 10.2787, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   1, Avg loss: 0.0752, Accuracy: 85/682 (12.4633%)
___Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   2, Avg loss: 0.0413, Accuracy: 280/682 (41.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 9.2938, Accuracy: 51/10000 (0.5100%)
time spent on training: 267.02114272117615
___Test Target_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.3323, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Avg loss: 2.6736, Accuracy: 0/9950 (0.0000%)
saving model
Done in 694.0231459140778 sec.
Saving all the graphs.
This run has a label: Jun.12_14.23.19. Visdom environment: tiny
