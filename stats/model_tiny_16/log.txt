current path: saved_models/model_tiny_Jun.10_22.59.05
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 5, 10, 15, 25, 30, 37, 44, 49, 55, 61, 65, 85]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [98, 0, 77, 44, 66, 67, 33, 25, 19, 92].
___Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   1, Avg loss: 0.0833, Accuracy: 12/373 (3.2172%)
___Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   2, Avg loss: 0.0496, Accuracy: 153/373 (41.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.4270, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   1, Avg loss: 0.0585, Accuracy: 371/1657 (22.3899%)
___Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 490/1657 (29.5715%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.5977, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 312/1340 (23.2836%)
___Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 578/1340 (43.1343%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.7449, Accuracy: 68/10000 (0.6800%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 376/1750 (21.4857%)
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 662/1750 (37.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.5749, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   1, Avg loss: 0.0625, Accuracy: 250/1402 (17.8317%)
___Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 356/1402 (25.3923%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.1798, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   1, Avg loss: 0.0794, Accuracy: 46/426 (10.7981%)
___Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   2, Avg loss: 0.0421, Accuracy: 174/426 (40.8451%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.5562, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   1, Avg loss: 0.0802, Accuracy: 57/515 (11.0680%)
___Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   2, Avg loss: 0.0549, Accuracy: 127/515 (24.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.6750, Accuracy: 48/10000 (0.4800%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   1, Avg loss: 0.0575, Accuracy: 295/690 (42.7536%)
___Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 456/690 (66.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 6.2246, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   1, Avg loss: 0.0468, Accuracy: 382/1036 (36.8726%)
___Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   2, Avg loss: 0.0252, Accuracy: 642/1036 (61.9691%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 8.9583, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 484/1715 (28.2216%)
___Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 723/1715 (42.1574%)
___Test Local_ResNet_18 poisoned: False, epoch: 1: Avg loss: 7.6426, Accuracy: 91/10000 (0.9100%)
time spent on training: 164.63801407814026
___Test Target_ResNet_18 poisoned: False, epoch: 1: Avg loss: 5.3002, Accuracy: 42/10000 (0.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 1: Avg loss: 5.3439, Accuracy: 0/9950 (0.0000%)
saving model
Done in 402.06871700286865 sec.
Server Epoch:2 choose agents : [77, 57, 52, 28, 29, 61, 99, 34, 8, 85].
___Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   1, Avg loss: 0.0527, Accuracy: 335/1340 (25.0000%)
___Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 535/1340 (39.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.8726, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   1, Avg loss: 0.0570, Accuracy: 294/1154 (25.4766%)
___Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   2, Avg loss: 0.0266, Accuracy: 455/1154 (39.4281%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 8.7528, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 280/636 (44.0252%)
___Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   2, Avg loss: 0.0322, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.3789, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 371/1581 (23.4662%)
___Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0341, Accuracy: 570/1581 (36.0531%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.4918, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0494, Accuracy: 425/1440 (29.5139%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 668/1440 (46.3889%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.8533, Accuracy: 67/10000 (0.6700%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   1, Avg loss: 0.1259, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   2, Avg loss: 0.1181, Accuracy: 5/85 (5.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.3063, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0658, Accuracy: 173/773 (22.3803%)
___Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0319, Accuracy: 393/773 (50.8409%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.1974, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   1, Avg loss: 0.0587, Accuracy: 373/1427 (26.1388%)
___Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 575/1427 (40.2943%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 6.8767, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   1, Avg loss: 0.0605, Accuracy: 224/1513 (14.8050%)
___Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 480/1513 (31.7250%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.3632, Accuracy: 84/10000 (0.8400%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0547, Accuracy: 445/1988 (22.3843%)
___Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 675/1988 (33.9537%)
___Test Local_ResNet_18 poisoned: False, epoch: 2: Avg loss: 7.9696, Accuracy: 88/10000 (0.8800%)
time spent on training: 133.69994974136353
___Test Target_ResNet_18 poisoned: False, epoch: 2: Avg loss: 5.2997, Accuracy: 43/10000 (0.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 2: Avg loss: 5.3188, Accuracy: 0/9950 (0.0000%)
saving model
Done in 372.67471742630005 sec.
Server Epoch:3 choose agents : [89, 70, 9, 99, 37, 17, 4, 82, 30, 13].
___Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 328/896 (36.6071%)
___Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 447/896 (49.8884%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.3318, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0558, Accuracy: 343/1418 (24.1890%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0319, Accuracy: 597/1418 (42.1016%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.1345, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   1, Avg loss: 0.0491, Accuracy: 355/1275 (27.8431%)
___Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   2, Avg loss: 0.0192, Accuracy: 736/1275 (57.7255%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 9.4871, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   1, Avg loss: 0.0660, Accuracy: 175/773 (22.6391%)
___Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   2, Avg loss: 0.0309, Accuracy: 400/773 (51.7464%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.2194, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   1, Avg loss: 0.0531, Accuracy: 374/1129 (33.1267%)
___Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   2, Avg loss: 0.0253, Accuracy: 696/1129 (61.6475%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.9304, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0519, Accuracy: 400/1574 (25.4130%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0284, Accuracy: 644/1574 (40.9149%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 8.1237, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0635, Accuracy: 322/901 (35.7381%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0331, Accuracy: 421/901 (46.7259%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 6.9459, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   1, Avg loss: 0.0773, Accuracy: 65/500 (13.0000%)
___Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   2, Avg loss: 0.0493, Accuracy: 173/500 (34.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.7624, Accuracy: 51/10000 (0.5100%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   1, Avg loss: 0.0805, Accuracy: 72/486 (14.8148%)
___Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   2, Avg loss: 0.0420, Accuracy: 211/486 (43.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.9141, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 308/1645 (18.7234%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0334, Accuracy: 610/1645 (37.0821%)
___Test Local_ResNet_18 poisoned: False, epoch: 3: Avg loss: 7.9720, Accuracy: 116/10000 (1.1600%)
time spent on training: 135.4637894630432
___Test Target_ResNet_18 poisoned: False, epoch: 3: Avg loss: 5.3012, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 3: Avg loss: 5.3339, Accuracy: 0/9950 (0.0000%)
saving model
Done in 376.8232169151306 sec.
Server Epoch:4 choose agents : [24, 77, 38, 89, 8, 28, 48, 62, 16, 76].
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 37/312 (11.8590%)
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 167/312 (53.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.4337, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0528, Accuracy: 322/1340 (24.0299%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0267, Accuracy: 583/1340 (43.5075%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.8532, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   1, Avg loss: 0.0620, Accuracy: 242/1131 (21.3970%)
___Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 490/1131 (43.3245%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.3754, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 331/896 (36.9420%)
___Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 452/896 (50.4464%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.2772, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 254/1513 (16.7878%)
___Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 500/1513 (33.0469%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.6337, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 375/1581 (23.7192%)
___Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 588/1581 (37.1917%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 7.5710, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   1, Avg loss: 0.0716, Accuracy: 104/631 (16.4818%)
___Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   2, Avg loss: 0.0415, Accuracy: 212/631 (33.5975%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.8661, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0692, Accuracy: 140/568 (24.6479%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0410, Accuracy: 263/568 (46.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.8169, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   1, Avg loss: 0.0646, Accuracy: 275/708 (38.8418%)
___Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   2, Avg loss: 0.0358, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 6.1582, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0854, Accuracy: 46/466 (9.8712%)
___Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0482, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.7366, Accuracy: 50/10000 (0.5000%)
time spent on training: 109.64576148986816
___Test Target_ResNet_18 poisoned: False, epoch: 4: Avg loss: 5.3029, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 4: Avg loss: 5.3462, Accuracy: 0/9950 (0.0000%)
saving model
Done in 349.4374032020569 sec.
Server Epoch:5 choose agents : [73, 49, 66, 2, 62, 24, 56, 25, 10, 97].
___Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   1, Avg loss: 0.0658, Accuracy: 171/938 (18.2303%)
___Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   2, Avg loss: 0.0333, Accuracy: 317/938 (33.7953%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.4620, Accuracy: 55/10000 (0.5500%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   1, Avg loss: 0.0803, Accuracy: 27/440 (6.1364%)
___Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 153/440 (34.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.5880, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0615, Accuracy: 263/1402 (18.7589%)
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 372/1402 (26.5335%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.4708, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 231/605 (38.1818%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.9963, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0686, Accuracy: 150/568 (26.4085%)
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0409, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.8639, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   1, Avg loss: 0.0762, Accuracy: 34/312 (10.8974%)
___Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 169/312 (54.1667%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.4562, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0679, Accuracy: 71/186 (38.1720%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3252, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   1, Avg loss: 0.0573, Accuracy: 305/690 (44.2029%)
___Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   2, Avg loss: 0.0263, Accuracy: 465/690 (67.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 6.6281, Accuracy: 54/10000 (0.5400%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   1, Avg loss: 0.0580, Accuracy: 203/861 (23.5772%)
___Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 435/861 (50.5226%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 7.9564, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0530, Accuracy: 369/1213 (30.4204%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 486/1213 (40.0660%)
___Test Local_ResNet_18 poisoned: False, epoch: 5: Avg loss: 8.0079, Accuracy: 85/10000 (0.8500%)
time spent on training: 139.13631200790405
___Test Target_ResNet_18 poisoned: False, epoch: 5: Avg loss: 5.3047, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 5: Avg loss: 5.3362, Accuracy: 0/9950 (0.0000%)
saving model
Done in 378.27076721191406 sec.
Server Epoch:6 choose agents : [50, 99, 30, 37, 67, 0, 63, 39, 52, 44].
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 158/809 (19.5303%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 364/809 (44.9938%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.4195, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   1, Avg loss: 0.0639, Accuracy: 198/773 (25.6145%)
___Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   2, Avg loss: 0.0321, Accuracy: 411/773 (53.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.2904, Accuracy: 72/10000 (0.7200%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   1, Avg loss: 0.0792, Accuracy: 80/486 (16.4609%)
___Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   2, Avg loss: 0.0409, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.1786, Accuracy: 43/10000 (0.4300%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   1, Avg loss: 0.0514, Accuracy: 429/1129 (37.9982%)
___Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 729/1129 (64.5704%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.5889, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   1, Avg loss: 0.0777, Accuracy: 50/426 (11.7371%)
___Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   2, Avg loss: 0.0424, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.8027, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 371/1657 (22.3899%)
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0352, Accuracy: 487/1657 (29.3905%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.9348, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0542, Accuracy: 259/888 (29.1667%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 423/888 (47.6351%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 8.4685, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   1, Avg loss: 0.0549, Accuracy: 309/1013 (30.5035%)
___Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 455/1013 (44.9161%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.5344, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0562, Accuracy: 285/636 (44.8113%)
___Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 6.5325, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0593, Accuracy: 419/1750 (23.9429%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 658/1750 (37.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 6: Avg loss: 7.3586, Accuracy: 110/10000 (1.1000%)
time spent on training: 156.77424836158752
___Test Target_ResNet_18 poisoned: False, epoch: 6: Avg loss: 5.3065, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 6: Avg loss: 5.3458, Accuracy: 0/9950 (0.0000%)
saving model
Done in 392.1392312049866 sec.
Server Epoch:7 choose agents : [66, 72, 39, 28, 82, 63, 93, 98, 12, 10].
___Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   1, Avg loss: 0.0610, Accuracy: 275/1402 (19.6148%)
___Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 392/1402 (27.9601%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.3328, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   1, Avg loss: 0.0630, Accuracy: 243/1241 (19.5810%)
___Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 371/1241 (29.8952%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.1996, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 314/1013 (30.9970%)
___Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 503/1013 (49.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.7543, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   1, Avg loss: 0.0554, Accuracy: 410/1581 (25.9330%)
___Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 600/1581 (37.9507%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.6939, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 69/500 (13.8000%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 180/500 (36.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.9991, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   1, Avg loss: 0.0536, Accuracy: 273/888 (30.7432%)
___Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 447/888 (50.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.4983, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 451/1742 (25.8898%)
___Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 696/1742 (39.9541%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 7.6696, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   1, Avg loss: 0.0810, Accuracy: 29/373 (7.7748%)
___Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   2, Avg loss: 0.0474, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.5880, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   1, Avg loss: 0.0859, Accuracy: 28/338 (8.2840%)
___Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   2, Avg loss: 0.0459, Accuracy: 149/338 (44.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.5697, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 207/861 (24.0418%)
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0219, Accuracy: 440/861 (51.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 7: Avg loss: 8.0691, Accuracy: 51/10000 (0.5100%)
time spent on training: 127.21834397315979
___Test Target_ResNet_18 poisoned: False, epoch: 7: Avg loss: 5.3086, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 7: Avg loss: 5.3566, Accuracy: 0/9950 (0.0000%)
saving model
Done in 365.2957673072815 sec.
Server Epoch:8 choose agents : [77, 28, 16, 1, 70, 34, 54, 21, 14, 75].
___Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   1, Avg loss: 0.0511, Accuracy: 344/1340 (25.6716%)
___Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   2, Avg loss: 0.0266, Accuracy: 581/1340 (43.3582%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.1633, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0547, Accuracy: 406/1581 (25.6799%)
___Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 584/1581 (36.9386%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.9472, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0614, Accuracy: 284/708 (40.1130%)
___Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0381, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.9334, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0569, Accuracy: 293/928 (31.5733%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 531/928 (57.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.0614, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   1, Avg loss: 0.0550, Accuracy: 365/1418 (25.7405%)
___Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 669/1418 (47.1791%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.0366, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   1, Avg loss: 0.0574, Accuracy: 397/1427 (27.8206%)
___Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 600/1427 (42.0463%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.0880, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   1, Avg loss: 0.0553, Accuracy: 342/1130 (30.2655%)
___Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 463/1130 (40.9735%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.2741, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0540, Accuracy: 391/1949 (20.0616%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 624/1949 (32.0164%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 8.3965, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0619, Accuracy: 226/1013 (22.3100%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 333/1013 (32.8727%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 6.7848, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   1, Avg loss: 0.0666, Accuracy: 244/776 (31.4433%)
___Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   2, Avg loss: 0.0294, Accuracy: 402/776 (51.8041%)
___Test Local_ResNet_18 poisoned: False, epoch: 8: Avg loss: 7.0200, Accuracy: 51/10000 (0.5100%)
time spent on training: 123.80160021781921
___Test Target_ResNet_18 poisoned: False, epoch: 8: Avg loss: 5.3109, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 8: Avg loss: 5.3649, Accuracy: 0/9950 (0.0000%)
saving model
Done in 356.2821626663208 sec.
Server Epoch:9 choose agents : [45, 99, 72, 16, 74, 61, 62, 90, 43, 25].
___Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   1, Avg loss: 0.0662, Accuracy: 209/669 (31.2407%)
___Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   2, Avg loss: 0.0408, Accuracy: 353/669 (52.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.9648, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0638, Accuracy: 193/773 (24.9677%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0318, Accuracy: 417/773 (53.9457%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.4799, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   1, Avg loss: 0.0610, Accuracy: 259/1241 (20.8703%)
___Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 411/1241 (33.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.4634, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   1, Avg loss: 0.0600, Accuracy: 300/708 (42.3729%)
___Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   2, Avg loss: 0.0386, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.3206, Accuracy: 48/10000 (0.4800%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   1, Avg loss: 0.0438, Accuracy: 436/1552 (28.0928%)
___Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 765/1552 (49.2912%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 11.5279, Accuracy: 86/10000 (0.8600%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 10/85 (11.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3240, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   1, Avg loss: 0.0676, Accuracy: 159/568 (27.9930%)
___Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   2, Avg loss: 0.0409, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.0929, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0565, Accuracy: 318/677 (46.9719%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 459/677 (67.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.8838, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   1, Avg loss: 0.0621, Accuracy: 308/946 (32.5581%)
___Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 323/946 (34.1438%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 6.2292, Accuracy: 57/10000 (0.5700%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   1, Avg loss: 0.0551, Accuracy: 312/690 (45.2174%)
___Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   2, Avg loss: 0.0266, Accuracy: 460/690 (66.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 9: Avg loss: 7.1259, Accuracy: 67/10000 (0.6700%)
time spent on training: 144.50042390823364
___Test Target_ResNet_18 poisoned: False, epoch: 9: Avg loss: 5.3130, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 9: Avg loss: 5.3710, Accuracy: 0/9950 (0.0000%)
saving model
Done in 382.4848952293396 sec.
Server Epoch:10 choose agents : [84, 18, 67, 52, 95, 36, 68, 49, 61, 7].
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0632, Accuracy: 324/1190 (27.2269%)
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 464/1190 (38.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.5176, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   1, Avg loss: 0.0751, Accuracy: 124/530 (23.3962%)
___Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   2, Avg loss: 0.0392, Accuracy: 268/530 (50.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.5773, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   1, Avg loss: 0.0763, Accuracy: 67/426 (15.7277%)
___Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   2, Avg loss: 0.0421, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.0056, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   1, Avg loss: 0.0559, Accuracy: 291/636 (45.7547%)
___Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   2, Avg loss: 0.0299, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 6.8043, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0510, Accuracy: 332/599 (55.4257%)
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0329, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 8.9693, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   1, Avg loss: 0.0868, Accuracy: 70/408 (17.1569%)
___Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   2, Avg loss: 0.0531, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.7266, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   1, Avg loss: 0.0621, Accuracy: 375/1163 (32.2442%)
___Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 436/1163 (37.4893%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.7878, Accuracy: 71/10000 (0.7100%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   1, Avg loss: 0.0785, Accuracy: 27/440 (6.1364%)
___Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   2, Avg loss: 0.0471, Accuracy: 148/440 (33.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.8306, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1151, Accuracy: 8/85 (9.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3267, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 354/891 (39.7306%)
___Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 465/891 (52.1886%)
___Test Local_ResNet_18 poisoned: False, epoch: 10: Avg loss: 7.4422, Accuracy: 55/10000 (0.5500%)
time spent on training: 139.94756531715393
___Test Target_ResNet_18 poisoned: False, epoch: 10: Avg loss: 5.3150, Accuracy: 47/10000 (0.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 10: Avg loss: 5.3830, Accuracy: 0/9950 (0.0000%)
saving model
Done in 373.9126160144806 sec.
Server Epoch:11 choose agents : [29, 92, 35, 7, 25, 14, 74, 13, 32, 17].
___Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 418/1440 (29.0278%)
___Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 659/1440 (45.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.1564, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0512, Accuracy: 462/1715 (26.9388%)
___Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0300, Accuracy: 759/1715 (44.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.0078, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   1, Avg loss: 0.0871, Accuracy: 39/271 (14.3911%)
___Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   2, Avg loss: 0.0568, Accuracy: 104/271 (38.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.5347, Accuracy: 40/10000 (0.4000%)
___Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 348/891 (39.0572%)
___Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   2, Avg loss: 0.0254, Accuracy: 457/891 (51.2907%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 7.3695, Accuracy: 51/10000 (0.5100%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0537, Accuracy: 320/690 (46.3768%)
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0271, Accuracy: 463/690 (67.1014%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.9695, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0618, Accuracy: 223/1013 (22.0138%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 303/1013 (29.9112%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 6.9687, Accuracy: 57/10000 (0.5700%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 491/1552 (31.6366%)
___Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 784/1552 (50.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 11.1675, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0566, Accuracy: 352/1645 (21.3982%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0321, Accuracy: 663/1645 (40.3040%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.0087, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0607, Accuracy: 209/735 (28.4354%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 355/735 (48.2993%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 9.3016, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 414/1574 (26.3024%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 675/1574 (42.8844%)
___Test Local_ResNet_18 poisoned: False, epoch: 11: Avg loss: 8.1967, Accuracy: 97/10000 (0.9700%)
time spent on training: 147.01716470718384
___Test Target_ResNet_18 poisoned: False, epoch: 11: Avg loss: 5.3176, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 11: Avg loss: 5.3583, Accuracy: 0/9950 (0.0000%)
saving model
Done in 380.75048637390137 sec.
Server Epoch:12 choose agents : [43, 94, 30, 38, 40, 20, 75, 61, 26, 17].
___Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   1, Avg loss: 0.0610, Accuracy: 310/946 (32.7696%)
___Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   2, Avg loss: 0.0356, Accuracy: 362/946 (38.2664%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.2819, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 351/1662 (21.1191%)
___Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 622/1662 (37.4248%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.2339, Accuracy: 107/10000 (1.0700%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0769, Accuracy: 85/486 (17.4897%)
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0395, Accuracy: 210/486 (43.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 6.5598, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   1, Avg loss: 0.0595, Accuracy: 276/1131 (24.4032%)
___Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   2, Avg loss: 0.0297, Accuracy: 517/1131 (45.7118%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.9305, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 359/1573 (22.8226%)
___Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 592/1573 (37.6351%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.5958, Accuracy: 64/10000 (0.6400%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 340/807 (42.1314%)
___Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 405/807 (50.1859%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.4245, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   1, Avg loss: 0.0640, Accuracy: 254/776 (32.7320%)
___Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   2, Avg loss: 0.0303, Accuracy: 378/776 (48.7113%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.5233, Accuracy: 54/10000 (0.5400%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   1, Avg loss: 0.1251, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 10/85 (11.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3318, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 338/1446 (23.3748%)
___Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 505/1446 (34.9239%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 7.3226, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   1, Avg loss: 0.0502, Accuracy: 415/1574 (26.3659%)
___Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 674/1574 (42.8208%)
___Test Local_ResNet_18 poisoned: False, epoch: 12: Avg loss: 8.9572, Accuracy: 108/10000 (1.0800%)
time spent on training: 155.84319043159485
___Test Target_ResNet_18 poisoned: False, epoch: 12: Avg loss: 5.3203, Accuracy: 51/10000 (0.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 12: Avg loss: 5.3689, Accuracy: 0/9950 (0.0000%)
saving model
Done in 393.2120609283447 sec.
Server Epoch:13 choose agents : [42, 89, 83, 18, 67, 8, 21, 60, 56, 28].
___Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 345/1372 (25.1458%)
___Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 528/1372 (38.4840%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.1149, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   1, Avg loss: 0.0598, Accuracy: 334/896 (37.2768%)
___Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 435/896 (48.5491%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.5281, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0548, Accuracy: 445/1953 (22.7855%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 780/1953 (39.9386%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.4268, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0744, Accuracy: 132/530 (24.9057%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0388, Accuracy: 271/530 (51.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.8233, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   1, Avg loss: 0.0756, Accuracy: 67/426 (15.7277%)
___Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   2, Avg loss: 0.0408, Accuracy: 172/426 (40.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 6.1556, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   1, Avg loss: 0.0587, Accuracy: 262/1513 (17.3166%)
___Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   2, Avg loss: 0.0359, Accuracy: 483/1513 (31.9233%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 7.7319, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 386/1949 (19.8050%)
___Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 628/1949 (32.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.2388, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 594/2227 (26.6727%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1029/2227 (46.2057%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.6481, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0671, Accuracy: 75/186 (40.3226%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3588, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   1, Avg loss: 0.0538, Accuracy: 422/1581 (26.6920%)
___Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 607/1581 (38.3934%)
___Test Local_ResNet_18 poisoned: False, epoch: 13: Avg loss: 8.0876, Accuracy: 83/10000 (0.8300%)
time spent on training: 132.44472336769104
___Test Target_ResNet_18 poisoned: False, epoch: 13: Avg loss: 5.3229, Accuracy: 60/10000 (0.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 13: Avg loss: 5.3513, Accuracy: 0/9950 (0.0000%)
saving model
Done in 364.9716510772705 sec.
Server Epoch:14 choose agents : [82, 77, 78, 73, 40, 83, 97, 72, 98, 61].
___Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0756, Accuracy: 73/500 (14.6000%)
___Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0475, Accuracy: 175/500 (35.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.4485, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   1, Avg loss: 0.0507, Accuracy: 338/1340 (25.2239%)
___Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 567/1340 (42.3134%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.8665, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 46/416 (11.0577%)
___Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   2, Avg loss: 0.0467, Accuracy: 178/416 (42.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 6.1343, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   1, Avg loss: 0.0650, Accuracy: 176/938 (18.7633%)
___Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   2, Avg loss: 0.0333, Accuracy: 331/938 (35.2878%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.6972, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 392/1573 (24.9205%)
___Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 579/1573 (36.8086%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.8181, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 470/1953 (24.0655%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0331, Accuracy: 812/1953 (41.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.9684, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   1, Avg loss: 0.0518, Accuracy: 369/1213 (30.4204%)
___Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   2, Avg loss: 0.0267, Accuracy: 515/1213 (42.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 8.5218, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   1, Avg loss: 0.0606, Accuracy: 265/1241 (21.3537%)
___Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   2, Avg loss: 0.0358, Accuracy: 435/1241 (35.0524%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 7.6022, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0795, Accuracy: 40/373 (10.7239%)
___Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0475, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.9038, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1255, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1169, Accuracy: 9/85 (10.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.3370, Accuracy: 53/10000 (0.5300%)
time spent on training: 134.60472679138184
___Test Target_ResNet_18 poisoned: False, epoch: 14: Avg loss: 5.3252, Accuracy: 58/10000 (0.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 14: Avg loss: 5.3261, Accuracy: 0/9950 (0.0000%)
saving model
Done in 368.3207960128784 sec.
Server Epoch:15 choose agents : [82, 75, 98, 92, 31, 50, 22, 78, 46, 37].
___Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   1, Avg loss: 0.0745, Accuracy: 84/500 (16.8000%)
___Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 180/500 (36.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.1708, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0643, Accuracy: 260/776 (33.5052%)
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0280, Accuracy: 413/776 (53.2216%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.3364, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   1, Avg loss: 0.0794, Accuracy: 31/373 (8.3110%)
___Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   2, Avg loss: 0.0466, Accuracy: 153/373 (41.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.0644, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0511, Accuracy: 456/1715 (26.5889%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0301, Accuracy: 719/1715 (41.9242%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.6320, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   1, Avg loss: 0.0825, Accuracy: 51/460 (11.0870%)
___Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   2, Avg loss: 0.0383, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.5032, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   1, Avg loss: 0.0615, Accuracy: 163/809 (20.1483%)
___Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   2, Avg loss: 0.0262, Accuracy: 367/809 (45.3646%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.9039, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 521/1470 (35.4422%)
___Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 824/1470 (56.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 8.6367, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0826, Accuracy: 49/416 (11.7788%)
___Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0461, Accuracy: 180/416 (43.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 6.3068, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   1, Avg loss: 0.0554, Accuracy: 416/1904 (21.8487%)
___Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 663/1904 (34.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 7.5764, Accuracy: 108/10000 (1.0800%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0496, Accuracy: 447/1129 (39.5926%)
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0241, Accuracy: 744/1129 (65.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 15: Avg loss: 9.0344, Accuracy: 103/10000 (1.0300%)
time spent on training: 135.92181634902954
___Test Target_ResNet_18 poisoned: False, epoch: 15: Avg loss: 5.3272, Accuracy: 55/10000 (0.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 15: Avg loss: 5.3333, Accuracy: 0/9950 (0.0000%)
saving model
Done in 371.5674912929535 sec.
Server Epoch:16 choose agents : [28, 26, 83, 78, 93, 7, 76, 44, 70, 39].
___Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   1, Avg loss: 0.0535, Accuracy: 420/1581 (26.5655%)
___Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   2, Avg loss: 0.0330, Accuracy: 603/1581 (38.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1312, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   1, Avg loss: 0.0542, Accuracy: 355/1446 (24.5505%)
___Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 528/1446 (36.5145%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.9368, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   1, Avg loss: 0.0534, Accuracy: 433/1953 (22.1710%)
___Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   2, Avg loss: 0.0331, Accuracy: 797/1953 (40.8090%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.8112, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   1, Avg loss: 0.0811, Accuracy: 60/416 (14.4231%)
___Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   2, Avg loss: 0.0443, Accuracy: 175/416 (42.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.1863, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0546, Accuracy: 438/1742 (25.1435%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 724/1742 (41.5614%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.0851, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   1, Avg loss: 0.0523, Accuracy: 362/891 (40.6285%)
___Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   2, Avg loss: 0.0253, Accuracy: 444/891 (49.8316%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.8810, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0834, Accuracy: 62/466 (13.3047%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0468, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 6.2816, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   1, Avg loss: 0.0581, Accuracy: 406/1750 (23.2000%)
___Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   2, Avg loss: 0.0346, Accuracy: 678/1750 (38.7429%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 8.1444, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0545, Accuracy: 376/1418 (26.5162%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0297, Accuracy: 664/1418 (46.8265%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.9734, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 317/1013 (31.2932%)
___Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   2, Avg loss: 0.0256, Accuracy: 484/1013 (47.7789%)
___Test Local_ResNet_18 poisoned: False, epoch: 16: Avg loss: 7.9629, Accuracy: 60/10000 (0.6000%)
time spent on training: 149.1782524585724
___Test Target_ResNet_18 poisoned: False, epoch: 16: Avg loss: 5.3298, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 16: Avg loss: 5.3488, Accuracy: 0/9950 (0.0000%)
saving model
Done in 383.09478998184204 sec.
Server Epoch:17 choose agents : [42, 34, 33, 94, 66, 75, 39, 27, 6, 51].
___Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0525, Accuracy: 362/1372 (26.3848%)
___Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0305, Accuracy: 551/1372 (40.1603%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.4577, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0570, Accuracy: 394/1427 (27.6104%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 601/1427 (42.1163%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.5298, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0789, Accuracy: 86/515 (16.6990%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0530, Accuracy: 132/515 (25.6311%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 6.4167, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 358/1662 (21.5403%)
___Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 625/1662 (37.6053%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.0456, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   1, Avg loss: 0.0616, Accuracy: 259/1402 (18.4736%)
___Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 368/1402 (26.2482%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.7609, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 268/776 (34.5361%)
___Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   2, Avg loss: 0.0283, Accuracy: 419/776 (53.9948%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.2748, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   1, Avg loss: 0.0523, Accuracy: 327/1013 (32.2804%)
___Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   2, Avg loss: 0.0254, Accuracy: 532/1013 (52.5173%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.8941, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0539, Accuracy: 419/1587 (26.4020%)
___Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 639/1587 (40.2647%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.5774, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   1, Avg loss: 0.0540, Accuracy: 403/1956 (20.6033%)
___Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   2, Avg loss: 0.0314, Accuracy: 667/1956 (34.1002%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 8.6582, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   1, Avg loss: 0.0592, Accuracy: 230/1049 (21.9256%)
___Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   2, Avg loss: 0.0294, Accuracy: 516/1049 (49.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 17: Avg loss: 7.9346, Accuracy: 90/10000 (0.9000%)
time spent on training: 141.03281378746033
___Test Target_ResNet_18 poisoned: False, epoch: 17: Avg loss: 5.3322, Accuracy: 54/10000 (0.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 17: Avg loss: 5.3561, Accuracy: 0/9950 (0.0000%)
saving model
Done in 372.9892461299896 sec.
Server Epoch:18 choose agents : [90, 5, 3, 28, 2, 9, 92, 60, 86, 34].
___Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0568, Accuracy: 322/677 (47.5628%)
___Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 463/677 (68.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.4404, Accuracy: 54/10000 (0.5400%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   1, Avg loss: 0.0504, Accuracy: 410/1628 (25.1843%)
___Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   2, Avg loss: 0.0249, Accuracy: 840/1628 (51.5971%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 9.4367, Accuracy: 142/10000 (1.4200%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0726, Accuracy: 118/781 (15.1088%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0355, Accuracy: 235/781 (30.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.4248, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0534, Accuracy: 433/1581 (27.3877%)
___Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0325, Accuracy: 635/1581 (40.1645%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.8720, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 221/605 (36.5289%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0388, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 6.3806, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0493, Accuracy: 374/1275 (29.3333%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0190, Accuracy: 731/1275 (57.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 10.2581, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   1, Avg loss: 0.0501, Accuracy: 457/1715 (26.6472%)
___Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   2, Avg loss: 0.0300, Accuracy: 743/1715 (43.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.9900, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 588/2227 (26.4032%)
___Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1033/2227 (46.3853%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 8.7009, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   1, Avg loss: 0.0630, Accuracy: 361/1003 (35.9920%)
___Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   2, Avg loss: 0.0349, Accuracy: 356/1003 (35.4935%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.0346, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   1, Avg loss: 0.0565, Accuracy: 392/1427 (27.4702%)
___Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   2, Avg loss: 0.0323, Accuracy: 606/1427 (42.4667%)
___Test Local_ResNet_18 poisoned: False, epoch: 18: Avg loss: 7.8570, Accuracy: 73/10000 (0.7300%)
time spent on training: 155.80183339118958
___Test Target_ResNet_18 poisoned: False, epoch: 18: Avg loss: 5.3338, Accuracy: 56/10000 (0.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 18: Avg loss: 5.3329, Accuracy: 0/9950 (0.0000%)
saving model
Done in 390.62687063217163 sec.
Server Epoch:19 choose agents : [8, 20, 42, 21, 5, 25, 24, 71, 13, 18].
___Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   1, Avg loss: 0.0580, Accuracy: 270/1513 (17.8453%)
___Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   2, Avg loss: 0.0359, Accuracy: 484/1513 (31.9894%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.7436, Accuracy: 101/10000 (1.0100%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0585, Accuracy: 329/807 (40.7683%)
___Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 419/807 (51.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.4538, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   1, Avg loss: 0.0522, Accuracy: 354/1372 (25.8017%)
___Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   2, Avg loss: 0.0306, Accuracy: 553/1372 (40.3061%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.3029, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0527, Accuracy: 429/1949 (22.0113%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 617/1949 (31.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.2121, Accuracy: 91/10000 (0.9100%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 370/1628 (22.7273%)
___Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   2, Avg loss: 0.0251, Accuracy: 832/1628 (51.1057%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 9.1789, Accuracy: 147/10000 (1.4700%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   1, Avg loss: 0.0546, Accuracy: 324/690 (46.9565%)
___Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   2, Avg loss: 0.0256, Accuracy: 458/690 (66.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.4572, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   1, Avg loss: 0.0750, Accuracy: 49/312 (15.7051%)
___Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   2, Avg loss: 0.0385, Accuracy: 165/312 (52.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 6.0984, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 172/818 (21.0269%)
___Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   2, Avg loss: 0.0300, Accuracy: 388/818 (47.4328%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.9508, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   1, Avg loss: 0.0560, Accuracy: 349/1645 (21.2158%)
___Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   2, Avg loss: 0.0317, Accuracy: 689/1645 (41.8845%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 8.3756, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0739, Accuracy: 129/530 (24.3396%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0370, Accuracy: 272/530 (51.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 19: Avg loss: 7.1948, Accuracy: 63/10000 (0.6300%)
time spent on training: 171.75095009803772
___Test Target_ResNet_18 poisoned: False, epoch: 19: Avg loss: 5.3360, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 19: Avg loss: 5.3368, Accuracy: 0/9950 (0.0000%)
saving model
Done in 409.5923388004303 sec.
Server Epoch:20 choose agents : [89, 17, 66, 8, 76, 59, 83, 62, 70, 12].
___Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   1, Avg loss: 0.0591, Accuracy: 346/896 (38.6161%)
___Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   2, Avg loss: 0.0328, Accuracy: 460/896 (51.3393%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.6593, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   1, Avg loss: 0.0502, Accuracy: 426/1574 (27.0648%)
___Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   2, Avg loss: 0.0268, Accuracy: 705/1574 (44.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.5008, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   1, Avg loss: 0.0607, Accuracy: 280/1402 (19.9715%)
___Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 397/1402 (28.3167%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.0156, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   1, Avg loss: 0.0571, Accuracy: 304/1513 (20.0925%)
___Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   2, Avg loss: 0.0351, Accuracy: 537/1513 (35.4924%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.8592, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0818, Accuracy: 64/466 (13.7339%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0469, Accuracy: 180/466 (38.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.6649, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0541, Accuracy: 312/1089 (28.6501%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0290, Accuracy: 455/1089 (41.7815%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 10.5843, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   1, Avg loss: 0.0531, Accuracy: 443/1953 (22.6831%)
___Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   2, Avg loss: 0.0327, Accuracy: 762/1953 (39.0169%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 8.4281, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   1, Avg loss: 0.0675, Accuracy: 154/568 (27.1127%)
___Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   2, Avg loss: 0.0391, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.3995, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0543, Accuracy: 369/1418 (26.0226%)
___Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 645/1418 (45.4866%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 7.8903, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   1, Avg loss: 0.0857, Accuracy: 33/338 (9.7633%)
___Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   2, Avg loss: 0.0472, Accuracy: 136/338 (40.2367%)
___Test Local_ResNet_18 poisoned: False, epoch: 20: Avg loss: 6.1585, Accuracy: 50/10000 (0.5000%)
time spent on training: 140.41997003555298
___Test Target_ResNet_18 poisoned: False, epoch: 20: Avg loss: 5.3381, Accuracy: 48/10000 (0.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 20: Avg loss: 5.3493, Accuracy: 0/9950 (0.0000%)
saving model
Done in 378.2675359249115 sec.
Server Epoch:21 choose agents : [0, 21, 31, 56, 90, 65, 87, 37, 77, 26].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0565, Accuracy: 386/1657 (23.2951%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0345, Accuracy: 553/1657 (33.3736%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0313, Accuracy: 618/1657 (37.2963%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0308, Accuracy: 639/1657 (38.5637%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0298, Accuracy: 682/1657 (41.1587%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0294, Accuracy: 706/1657 (42.6071%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0288, Accuracy: 718/1657 (43.3313%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0281, Accuracy: 769/1657 (46.4092%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0281, Accuracy: 754/1657 (45.5039%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0278, Accuracy: 748/1657 (45.1418%), train_poison_data_count: 520
Global model norm: 112.0282121275708.
Norm before scaling: 112.00176128637442. Distance: 1.181663424689648
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.7695, Accuracy: 74/10000 (0.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: 0.8889, Accuracy: 9390/9950 (94.3719%)
Scaling by  100
Scaled Norm after poisoning: 160.5654741355532, distance: 118.16634114538496
Total norm for 3 adversaries is: 160.5654741355532. distance: 118.16634114538496
___Test Local_ResNet_18 poisoned: True, epoch: 21: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0526, Accuracy: 419/1949 (21.4982%)
___Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0324, Accuracy: 680/1949 (34.8897%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.5219, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   1, Avg loss: 0.0823, Accuracy: 67/460 (14.5652%)
___Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.6999, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 3/186 (1.6129%)
___Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 77/186 (41.3978%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 5.3961, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   1, Avg loss: 0.0551, Accuracy: 328/677 (48.4490%)
___Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   2, Avg loss: 0.0218, Accuracy: 450/677 (66.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 9.0008, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0558, Accuracy: 388/1475 (26.3051%)
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0312, Accuracy: 690/1475 (46.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.4165, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   1, Avg loss: 0.0582, Accuracy: 305/1131 (26.9673%)
___Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 436/1131 (38.5500%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.3859, Accuracy: 66/10000 (0.6600%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   1, Avg loss: 0.0495, Accuracy: 465/1129 (41.1869%)
___Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   2, Avg loss: 0.0227, Accuracy: 756/1129 (66.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 8.4407, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0504, Accuracy: 370/1340 (27.6119%)
___Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0265, Accuracy: 561/1340 (41.8657%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 9.4846, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 326/1446 (22.5450%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 495/1446 (34.2324%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Avg loss: 7.5144, Accuracy: 63/10000 (0.6300%)
time spent on training: 244.35069584846497
___Test Target_ResNet_18 poisoned: False, epoch: 21: Avg loss: 6.9034, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Avg loss: 1.8138, Accuracy: 30/9950 (0.3015%)
saving model
Done in 479.49742674827576 sec.
Server Epoch:22 choose agents : [13, 26, 58, 22, 88, 2, 65, 9, 90, 64].
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0670, Accuracy: 259/1645 (15.7447%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0312, Accuracy: 656/1645 (39.8784%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.8240, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   1, Avg loss: 0.0722, Accuracy: 246/1446 (17.0124%)
___Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   2, Avg loss: 0.0355, Accuracy: 518/1446 (35.8230%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.7302, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0852, Accuracy: 163/803 (20.2989%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0408, Accuracy: 407/803 (50.6849%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.0379, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0537, Accuracy: 433/1470 (29.4558%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 874/1470 (59.4558%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.7788, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   1, Avg loss: 0.0959, Accuracy: 23/603 (3.8143%)
___Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   2, Avg loss: 0.0479, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 10.3926, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0972, Accuracy: 50/605 (8.2645%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0492, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 8.5751, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   1, Avg loss: 0.0722, Accuracy: 278/1475 (18.8475%)
___Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 678/1475 (45.9661%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 7.9090, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   1, Avg loss: 0.0668, Accuracy: 234/1275 (18.3529%)
___Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   2, Avg loss: 0.0185, Accuracy: 751/1275 (58.9020%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 11.6160, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   1, Avg loss: 0.0620, Accuracy: 147/677 (21.7134%)
___Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   2, Avg loss: 0.0251, Accuracy: 465/677 (68.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 14.6768, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   1, Avg loss: 0.0809, Accuracy: 87/953 (9.1291%)
___Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   2, Avg loss: 0.0398, Accuracy: 324/953 (33.9979%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Avg loss: 9.0500, Accuracy: 67/10000 (0.6700%)
time spent on training: 152.54486179351807
___Test Target_ResNet_18 poisoned: False, epoch: 22: Avg loss: 6.6599, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Avg loss: 1.9892, Accuracy: 30/9950 (0.3015%)
saving model
Done in 385.26077365875244 sec.
Server Epoch:23 choose agents : [20, 11, 63, 44, 2, 74, 26, 89, 3, 6].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Average loss: 0.0629, Accuracy: 255/807 (31.5985%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Average loss: 0.0348, Accuracy: 338/807 (41.8835%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Average loss: 0.0277, Accuracy: 412/807 (51.0533%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Average loss: 0.0263, Accuracy: 453/807 (56.1338%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Average loss: 0.0266, Accuracy: 473/807 (58.6121%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Average loss: 0.0244, Accuracy: 463/807 (57.3730%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Average loss: 0.0241, Accuracy: 487/807 (60.3470%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Average loss: 0.0238, Accuracy: 501/807 (62.0818%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Average loss: 0.0233, Accuracy: 487/807 (60.3470%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Average loss: 0.0234, Accuracy: 502/807 (62.2057%), train_poison_data_count: 260
Global model norm: 111.99821688731254.
Norm before scaling: 111.98294809506713. Distance: 0.8395641837448562
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.5497, Accuracy: 66/10000 (0.6600%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.4365, Accuracy: 9628/9950 (96.7638%)
Scaling by  100
Scaled Norm after poisoning: 138.49132700732562, distance: 83.95642121995493
Total norm for 3 adversaries is: 138.49132700732562. distance: 83.95642121995493
___Test Local_ResNet_18 poisoned: True, epoch: 23: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   1, Avg loss: 0.0788, Accuracy: 154/712 (21.6292%)
___Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   2, Avg loss: 0.0310, Accuracy: 442/712 (62.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 11.6314, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   1, Avg loss: 0.0748, Accuracy: 131/888 (14.7523%)
___Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   2, Avg loss: 0.0267, Accuracy: 440/888 (49.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 11.3988, Accuracy: 88/10000 (0.8800%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   1, Avg loss: 0.0708, Accuracy: 310/1750 (17.7143%)
___Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   2, Avg loss: 0.0346, Accuracy: 698/1750 (39.8857%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.5598, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0927, Accuracy: 59/605 (9.7521%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0468, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.7314, Accuracy: 60/10000 (0.6000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0549, Accuracy: 398/1552 (25.6443%)
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0200, Accuracy: 828/1552 (53.3505%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 13.3843, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   1, Avg loss: 0.0688, Accuracy: 237/1446 (16.3900%)
___Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 532/1446 (36.7911%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.8332, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   1, Avg loss: 0.0804, Accuracy: 209/896 (23.3259%)
___Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   2, Avg loss: 0.0385, Accuracy: 413/896 (46.0938%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.8508, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0975, Accuracy: 18/781 (2.3047%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 232/781 (29.7055%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 9.4437, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   1, Avg loss: 0.0619, Accuracy: 339/1956 (17.3313%)
___Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   2, Avg loss: 0.0301, Accuracy: 715/1956 (36.5542%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Avg loss: 8.1968, Accuracy: 134/10000 (1.3400%)
time spent on training: 236.94027662277222
___Test Target_ResNet_18 poisoned: False, epoch: 23: Avg loss: 7.3241, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Avg loss: 0.7189, Accuracy: 8613/9950 (86.5628%)
saving model
Done in 465.05532217025757 sec.
Server Epoch:24 choose agents : [75, 96, 99, 97, 17, 80, 3, 13, 60, 83].
___Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   1, Avg loss: 0.0853, Accuracy: 130/776 (16.7526%)
___Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   2, Avg loss: 0.0314, Accuracy: 402/776 (51.8041%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.5695, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   1, Avg loss: 0.1224, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   2, Avg loss: 0.0742, Accuracy: 25/311 (8.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.5085, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   1, Avg loss: 0.0854, Accuracy: 96/773 (12.4191%)
___Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   2, Avg loss: 0.0340, Accuracy: 444/773 (57.4386%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 10.2443, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   1, Avg loss: 0.0697, Accuracy: 242/1213 (19.9505%)
___Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   2, Avg loss: 0.0282, Accuracy: 500/1213 (41.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.9904, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0646, Accuracy: 298/1574 (18.9327%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 661/1574 (41.9949%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.7829, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   1, Avg loss: 0.0914, Accuracy: 26/682 (3.8123%)
___Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   2, Avg loss: 0.0386, Accuracy: 264/682 (38.7097%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 9.0701, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0965, Accuracy: 24/781 (3.0730%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 234/781 (29.9616%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.5156, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0649, Accuracy: 270/1645 (16.4134%)
___Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0313, Accuracy: 652/1645 (39.6353%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.3437, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   1, Avg loss: 0.0583, Accuracy: 568/2227 (25.5052%)
___Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1101/2227 (49.4387%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 8.1222, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0645, Accuracy: 366/1953 (18.7404%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0328, Accuracy: 850/1953 (43.5228%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Avg loss: 7.8544, Accuracy: 124/10000 (1.2400%)
time spent on training: 154.4934802055359
___Test Target_ResNet_18 poisoned: False, epoch: 24: Avg loss: 6.8845, Accuracy: 66/10000 (0.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Avg loss: 0.8089, Accuracy: 8638/9950 (86.8141%)
saving model
Done in 381.6772651672363 sec.
Server Epoch:25 choose agents : [74, 18, 82, 53, 32, 64, 95, 19, 44, 38].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Average loss: 0.0482, Accuracy: 531/1552 (34.2139%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Average loss: 0.0199, Accuracy: 842/1552 (54.2526%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Average loss: 0.0165, Accuracy: 969/1552 (62.4356%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Average loss: 0.0162, Accuracy: 1007/1552 (64.8840%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Average loss: 0.0163, Accuracy: 1005/1552 (64.7552%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Average loss: 0.0158, Accuracy: 1030/1552 (66.3660%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Average loss: 0.0154, Accuracy: 1026/1552 (66.1082%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Average loss: 0.0155, Accuracy: 1026/1552 (66.1082%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Average loss: 0.0157, Accuracy: 1021/1552 (65.7861%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Average loss: 0.0154, Accuracy: 1013/1552 (65.2706%), train_poison_data_count: 496
Global model norm: 111.97857897132603.
Norm before scaling: 111.95083847106729. Distance: 1.2519276537513484
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.4503, Accuracy: 87/10000 (0.8700%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.1799, Accuracy: 9382/9950 (94.2915%)
Scaling by  100
Scaled Norm after poisoning: 165.632753356258, distance: 125.19277712916389
Total norm for 3 adversaries is: 165.632753356258. distance: 125.19277712916389
___Test Local_ResNet_18 poisoned: True, epoch: 25: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   1, Avg loss: 0.0999, Accuracy: 8/530 (1.5094%)
___Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   2, Avg loss: 0.0397, Accuracy: 261/530 (49.2453%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.9966, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   1, Avg loss: 0.1007, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   2, Avg loss: 0.0526, Accuracy: 142/500 (28.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.1593, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0685, Accuracy: 149/813 (18.3272%)
___Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0193, Accuracy: 495/813 (60.8856%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 12.9300, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0693, Accuracy: 121/735 (16.4626%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0258, Accuracy: 389/735 (52.9252%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 11.3497, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   1, Avg loss: 0.0750, Accuracy: 101/953 (10.5981%)
___Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   2, Avg loss: 0.0385, Accuracy: 343/953 (35.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.8952, Accuracy: 64/10000 (0.6400%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0760, Accuracy: 142/599 (23.7062%)
___Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0317, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 13.3065, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   1, Avg loss: 0.0614, Accuracy: 288/1036 (27.7992%)
___Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   2, Avg loss: 0.0258, Accuracy: 701/1036 (67.6641%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 12.6978, Accuracy: 78/10000 (0.7800%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0675, Accuracy: 302/1750 (17.2571%)
___Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0341, Accuracy: 722/1750 (41.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 7.6531, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   1, Avg loss: 0.0741, Accuracy: 191/1131 (16.8877%)
___Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 522/1131 (46.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Avg loss: 8.2435, Accuracy: 96/10000 (0.9600%)
time spent on training: 241.68953371047974
___Test Target_ResNet_18 poisoned: False, epoch: 25: Avg loss: 9.4297, Accuracy: 87/10000 (0.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Avg loss: 0.2543, Accuracy: 9118/9950 (91.6382%)
saving model
Done in 471.5475947856903 sec.
Server Epoch:26 choose agents : [19, 3, 96, 58, 94, 68, 87, 88, 54, 66].
___Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   1, Avg loss: 0.0813, Accuracy: 200/1036 (19.3050%)
___Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   2, Avg loss: 0.0272, Accuracy: 662/1036 (63.8996%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 14.3040, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.1208, Accuracy: 3/781 (0.3841%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0376, Accuracy: 224/781 (28.6812%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.4737, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   1, Avg loss: 0.1525, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   2, Avg loss: 0.0987, Accuracy: 0/311 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.0655, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   1, Avg loss: 0.0975, Accuracy: 144/803 (17.9328%)
___Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   2, Avg loss: 0.0438, Accuracy: 427/803 (53.1756%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.5122, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   1, Avg loss: 0.0797, Accuracy: 251/1662 (15.1023%)
___Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   2, Avg loss: 0.0322, Accuracy: 653/1662 (39.2900%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.1714, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0980, Accuracy: 206/1163 (17.7128%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 467/1163 (40.1548%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.8326, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.0952, Accuracy: 156/1131 (13.7931%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0335, Accuracy: 367/1131 (32.4492%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.9051, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   1, Avg loss: 0.1265, Accuracy: 0/603 (0.0000%)
___Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   2, Avg loss: 0.0500, Accuracy: 284/603 (47.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.5987, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0878, Accuracy: 188/1130 (16.6372%)
___Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 445/1130 (39.3805%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 9.9941, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   1, Avg loss: 0.0923, Accuracy: 151/1402 (10.7703%)
___Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 402/1402 (28.6733%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Avg loss: 7.9138, Accuracy: 66/10000 (0.6600%)
time spent on training: 147.3466284275055
___Test Target_ResNet_18 poisoned: False, epoch: 26: Avg loss: 8.6843, Accuracy: 87/10000 (0.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Avg loss: 0.4569, Accuracy: 8439/9950 (84.8141%)
saving model
Done in 378.1470181941986 sec.
Server Epoch:27 choose agents : [95, 51, 93, 9, 60, 99, 31, 17, 49, 65].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Average loss: 0.0764, Accuracy: 168/599 (28.0467%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Average loss: 0.0257, Accuracy: 426/599 (71.1185%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Average loss: 0.0208, Accuracy: 484/599 (80.8013%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Average loss: 0.0182, Accuracy: 502/599 (83.8063%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Average loss: 0.0198, Accuracy: 485/599 (80.9683%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Average loss: 0.0173, Accuracy: 492/599 (82.1369%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Average loss: 0.0168, Accuracy: 494/599 (82.4708%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Average loss: 0.0164, Accuracy: 495/599 (82.6377%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Average loss: 0.0153, Accuracy: 508/599 (84.8080%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Average loss: 0.0148, Accuracy: 509/599 (84.9750%), train_poison_data_count: 200
Global model norm: 111.94681267096219.
Norm before scaling: 111.93379216360447. Distance: 0.8493804974128945
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.6055, Accuracy: 49/10000 (0.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.0885, Accuracy: 9457/9950 (95.0452%)
Scaling by  100
Scaled Norm after poisoning: 139.2228289245338, distance: 84.9380518745868
Total norm for 3 adversaries is: 139.2228289245338. distance: 84.9380518745868
___Test Local_ResNet_18 poisoned: True, epoch: 27: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0882, Accuracy: 121/1049 (11.5348%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 523/1049 (49.8570%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.8685, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   1, Avg loss: 0.0752, Accuracy: 320/1742 (18.3697%)
___Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   2, Avg loss: 0.0312, Accuracy: 763/1742 (43.8002%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.1394, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Avg loss: 0.0738, Accuracy: 229/1275 (17.9608%)
___Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Avg loss: 0.0188, Accuracy: 736/1275 (57.7255%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 11.1416, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   1, Avg loss: 0.0633, Accuracy: 534/2227 (23.9784%)
___Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1053/2227 (47.2833%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.1006, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.1036, Accuracy: 55/773 (7.1151%)
___Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0306, Accuracy: 440/773 (56.9211%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 10.6154, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   1, Avg loss: 0.1166, Accuracy: 52/460 (11.3043%)
___Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   2, Avg loss: 0.0459, Accuracy: 166/460 (36.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.8191, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0718, Accuracy: 297/1574 (18.8691%)
___Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0269, Accuracy: 697/1574 (44.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.6644, Accuracy: 93/10000 (0.9300%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   1, Avg loss: 0.1318, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   2, Avg loss: 0.0639, Accuracy: 62/440 (14.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.2299, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   1, Avg loss: 0.0722, Accuracy: 305/1475 (20.6780%)
___Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   2, Avg loss: 0.0326, Accuracy: 641/1475 (43.4576%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Avg loss: 7.2388, Accuracy: 106/10000 (1.0600%)
time spent on training: 242.43832969665527
___Test Target_ResNet_18 poisoned: False, epoch: 27: Avg loss: 8.3707, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Avg loss: 0.1823, Accuracy: 8949/9950 (89.9397%)
saving model
Done in 473.0862617492676 sec.
Server Epoch:28 choose agents : [51, 19, 66, 24, 25, 80, 58, 15, 0, 90].
___Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   1, Avg loss: 0.0850, Accuracy: 141/1049 (13.4414%)
___Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   2, Avg loss: 0.0290, Accuracy: 520/1049 (49.5710%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.7775, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   1, Avg loss: 0.0730, Accuracy: 266/1036 (25.6757%)
___Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 716/1036 (69.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 12.4961, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   1, Avg loss: 0.0817, Accuracy: 180/1402 (12.8388%)
___Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 415/1402 (29.6006%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.6283, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   1, Avg loss: 0.1410, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   2, Avg loss: 0.0614, Accuracy: 45/312 (14.4231%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 6.4932, Accuracy: 52/10000 (0.5200%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   1, Avg loss: 0.0939, Accuracy: 117/690 (16.9565%)
___Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   2, Avg loss: 0.0303, Accuracy: 455/690 (65.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 11.1413, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   1, Avg loss: 0.1049, Accuracy: 39/682 (5.7185%)
___Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   2, Avg loss: 0.0384, Accuracy: 256/682 (37.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.5356, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   1, Avg loss: 0.0871, Accuracy: 179/803 (22.2914%)
___Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   2, Avg loss: 0.0385, Accuracy: 399/803 (49.6887%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.2831, Accuracy: 57/10000 (0.5700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   1, Avg loss: 0.0847, Accuracy: 210/1154 (18.1976%)
___Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   2, Avg loss: 0.0308, Accuracy: 401/1154 (34.7487%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 9.6095, Accuracy: 86/10000 (0.8600%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   1, Avg loss: 0.0602, Accuracy: 323/1657 (19.4931%)
___Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   2, Avg loss: 0.0309, Accuracy: 598/1657 (36.0893%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 8.3776, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   1, Avg loss: 0.0860, Accuracy: 121/677 (17.8730%)
___Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 462/677 (68.2422%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Avg loss: 10.7323, Accuracy: 67/10000 (0.6700%)
time spent on training: 181.18936586380005
___Test Target_ResNet_18 poisoned: False, epoch: 28: Avg loss: 7.4190, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Avg loss: 0.3153, Accuracy: 8366/9950 (84.0804%)
saving model
Done in 413.55166935920715 sec.
Server Epoch:29 choose agents : [5, 8, 98, 14, 70, 64, 74, 49, 75, 78].
poison local model 5 index 4 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   1, Average loss: 0.0482, Accuracy: 642/1628 (39.4349%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   2, Average loss: 0.0208, Accuracy: 960/1628 (58.9681%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   3, Average loss: 0.0188, Accuracy: 1067/1628 (65.5405%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   4, Average loss: 0.0185, Accuracy: 1116/1628 (68.5504%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   5, Average loss: 0.0178, Accuracy: 1133/1628 (69.5946%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   6, Average loss: 0.0171, Accuracy: 1145/1628 (70.3317%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   7, Average loss: 0.0168, Accuracy: 1155/1628 (70.9459%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   8, Average loss: 0.0159, Accuracy: 1171/1628 (71.9287%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   9, Average loss: 0.0165, Accuracy: 1161/1628 (71.3145%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch  10, Average loss: 0.0164, Accuracy: 1159/1628 (71.1916%), train_poison_data_count: 520
Global model norm: 111.92930333613491.
Norm before scaling: 111.89997102602395. Distance: 1.2627475193734161
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.1907, Accuracy: 141/10000 (1.4100%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.2783, Accuracy: 9228/9950 (92.7437%)
Scaling by  100
Scaled Norm after poisoning: 166.30540665068588, distance: 126.27476164969586
Total norm for 3 adversaries is: 166.30540665068588. distance: 126.27476164969586
___Test Local_ResNet_18 poisoned: True, epoch: 29: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   1, Avg loss: 0.0714, Accuracy: 241/1513 (15.9286%)
___Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   2, Avg loss: 0.0358, Accuracy: 532/1513 (35.1619%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.6622, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   1, Avg loss: 0.1244, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   2, Avg loss: 0.0575, Accuracy: 78/373 (20.9115%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.8824, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   1, Avg loss: 0.0834, Accuracy: 114/1013 (11.2537%)
___Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 349/1013 (34.4521%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.9873, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0704, Accuracy: 326/1418 (22.9901%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 672/1418 (47.3907%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.2634, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   1, Avg loss: 0.0795, Accuracy: 132/953 (13.8510%)
___Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   2, Avg loss: 0.0400, Accuracy: 328/953 (34.4176%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.4544, Accuracy: 76/10000 (0.7600%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0365, Accuracy: 562/1552 (36.2113%)
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0185, Accuracy: 849/1552 (54.7036%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 10.7215, Accuracy: 98/10000 (0.9800%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   1, Avg loss: 0.1165, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   2, Avg loss: 0.0537, Accuracy: 89/440 (20.2273%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 6.6573, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   1, Avg loss: 0.0891, Accuracy: 124/776 (15.9794%)
___Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   2, Avg loss: 0.0277, Accuracy: 422/776 (54.3814%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.4464, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.1266, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0530, Accuracy: 128/416 (30.7692%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Avg loss: 7.1394, Accuracy: 71/10000 (0.7100%)
time spent on training: 250.551340341568
___Test Target_ResNet_18 poisoned: False, epoch: 29: Avg loss: 8.1048, Accuracy: 150/10000 (1.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Avg loss: 0.7232, Accuracy: 7540/9950 (75.7789%)
saving model
Done in 480.71304273605347 sec.
Server Epoch:30 choose agents : [72, 69, 82, 58, 15, 79, 52, 28, 1, 17].
___Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   1, Avg loss: 0.0820, Accuracy: 164/1241 (13.2151%)
___Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 425/1241 (34.2466%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.9139, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.1008, Accuracy: 56/590 (9.4915%)
___Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0383, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 12.7654, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   1, Avg loss: 0.1226, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   2, Avg loss: 0.0593, Accuracy: 111/500 (22.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.7039, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   1, Avg loss: 0.0867, Accuracy: 153/803 (19.0535%)
___Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   2, Avg loss: 0.0423, Accuracy: 441/803 (54.9191%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.3363, Accuracy: 51/10000 (0.5100%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0857, Accuracy: 179/1154 (15.5113%)
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0307, Accuracy: 423/1154 (36.6551%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.7641, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   1, Avg loss: 0.1837, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   2, Avg loss: 0.1475, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 6.5733, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.0961, Accuracy: 73/636 (11.4780%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0376, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.7419, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   1, Avg loss: 0.0735, Accuracy: 261/1581 (16.5085%)
___Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   2, Avg loss: 0.0325, Accuracy: 609/1581 (38.5199%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.8974, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0730, Accuracy: 285/928 (30.7112%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0257, Accuracy: 573/928 (61.7457%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 9.5827, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   1, Avg loss: 0.0668, Accuracy: 345/1574 (21.9187%)
___Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 682/1574 (43.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Avg loss: 8.5120, Accuracy: 123/10000 (1.2300%)
time spent on training: 159.2248558998108
___Test Target_ResNet_18 poisoned: False, epoch: 30: Avg loss: 7.6471, Accuracy: 147/10000 (1.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Avg loss: 1.3710, Accuracy: 6111/9950 (61.4171%)
saving model
Done in 389.807893037796 sec.
Server Epoch:31 choose agents : [10, 79, 5, 85, 82, 35, 38, 44, 1, 72].
poison local model 10 index 5 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   1, Average loss: 0.0670, Accuracy: 230/861 (26.7131%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   2, Average loss: 0.0216, Accuracy: 481/861 (55.8653%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   3, Average loss: 0.0159, Accuracy: 575/861 (66.7828%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   4, Average loss: 0.0155, Accuracy: 594/861 (68.9895%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   5, Average loss: 0.0150, Accuracy: 597/861 (69.3380%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   6, Average loss: 0.0147, Accuracy: 613/861 (71.1963%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   7, Average loss: 0.0145, Accuracy: 613/861 (71.1963%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   8, Average loss: 0.0140, Accuracy: 622/861 (72.2416%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   9, Average loss: 0.0142, Accuracy: 611/861 (70.9640%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch  10, Average loss: 0.0132, Accuracy: 635/861 (73.7515%), train_poison_data_count: 280
Global model norm: 111.89638849316138.
Norm before scaling: 111.88069992462954. Distance: 1.1129156750544038
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.2762, Accuracy: 102/10000 (1.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.2777, Accuracy: 9160/9950 (92.0603%)
Scaling by  100
Scaled Norm after poisoning: 156.30660224779373, distance: 111.29156088148598
Total norm for 4 adversaries is: 156.30660224779373. distance: 111.29156088148598
___Test Local_ResNet_18 poisoned: True, epoch: 31: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   1, Avg loss: 0.1730, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   2, Avg loss: 0.1381, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 6.4765, Accuracy: 145/10000 (1.4500%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   1, Avg loss: 0.0217, Accuracy: 1003/1628 (61.6093%)
___Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   2, Avg loss: 0.0173, Accuracy: 1093/1628 (67.1376%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.3844, Accuracy: 164/10000 (1.6400%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   1, Avg loss: 0.0683, Accuracy: 341/1988 (17.1529%)
___Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   2, Avg loss: 0.0342, Accuracy: 764/1988 (38.4306%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.9083, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   1, Avg loss: 0.1148, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   2, Avg loss: 0.0566, Accuracy: 125/500 (25.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.7347, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   1, Avg loss: 0.1427, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   2, Avg loss: 0.0887, Accuracy: 1/271 (0.3690%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 6.9873, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   1, Avg loss: 0.0825, Accuracy: 153/1131 (13.5279%)
___Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   2, Avg loss: 0.0298, Accuracy: 535/1131 (47.3033%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.1768, Accuracy: 102/10000 (1.0200%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   1, Avg loss: 0.0720, Accuracy: 268/1750 (15.3143%)
___Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   2, Avg loss: 0.0341, Accuracy: 738/1750 (42.1714%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.5859, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0670, Accuracy: 308/928 (33.1897%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 605/928 (65.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 9.3361, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   1, Avg loss: 0.0784, Accuracy: 174/1241 (14.0210%)
___Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 400/1241 (32.2321%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Avg loss: 7.8204, Accuracy: 76/10000 (0.7600%)
time spent on training: 255.8119022846222
___Test Target_ResNet_18 poisoned: False, epoch: 31: Avg loss: 8.2036, Accuracy: 103/10000 (1.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Avg loss: 0.4926, Accuracy: 8405/9950 (84.4724%)
saving model
Done in 484.53753542900085 sec.
Server Epoch:32 choose agents : [72, 26, 61, 80, 49, 36, 32, 54, 23, 85].
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0827, Accuracy: 170/1241 (13.6986%)
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 439/1241 (35.3747%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.0092, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0772, Accuracy: 219/1446 (15.1452%)
___Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 501/1446 (34.6473%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.5913, Accuracy: 67/10000 (0.6700%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   1, Avg loss: 0.2165, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   2, Avg loss: 0.1975, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.7127, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.1083, Accuracy: 10/682 (1.4663%)
___Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0397, Accuracy: 266/682 (39.0029%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 8.5725, Accuracy: 73/10000 (0.7300%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.1210, Accuracy: 2/440 (0.4545%)
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0596, Accuracy: 63/440 (14.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.7455, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   1, Avg loss: 0.1412, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   2, Avg loss: 0.0685, Accuracy: 54/408 (13.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.1117, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0755, Accuracy: 92/735 (12.5170%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0234, Accuracy: 356/735 (48.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 10.8728, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   1, Avg loss: 0.0774, Accuracy: 217/1130 (19.2035%)
___Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   2, Avg loss: 0.0309, Accuracy: 464/1130 (41.0619%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 9.2492, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.1024, Accuracy: 89/715 (12.4476%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0504, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 6.8952, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0719, Accuracy: 354/1988 (17.8068%)
___Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0338, Accuracy: 757/1988 (38.0785%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.9668, Accuracy: 91/10000 (0.9100%)
time spent on training: 178.15751147270203
___Test Target_ResNet_18 poisoned: False, epoch: 32: Avg loss: 7.7006, Accuracy: 97/10000 (0.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Avg loss: 1.0358, Accuracy: 6961/9950 (69.9598%)
saving model
Done in 411.5993597507477 sec.
Server Epoch:33 choose agents : [15, 99, 11, 32, 10, 94, 70, 58, 16, 93].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Average loss: 0.0634, Accuracy: 391/1154 (33.8821%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Average loss: 0.0265, Accuracy: 633/1154 (54.8527%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Average loss: 0.0218, Accuracy: 665/1154 (57.6256%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Average loss: 0.0206, Accuracy: 707/1154 (61.2652%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Average loss: 0.0203, Accuracy: 727/1154 (62.9983%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Average loss: 0.0208, Accuracy: 701/1154 (60.7452%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Average loss: 0.0194, Accuracy: 725/1154 (62.8250%), train_poison_data_count: 362
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Average loss: 0.0190, Accuracy: 726/1154 (62.9116%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Average loss: 0.0191, Accuracy: 731/1154 (63.3449%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Average loss: 0.0193, Accuracy: 735/1154 (63.6915%), train_poison_data_count: 362
Global model norm: 111.87683744999454.
Norm before scaling: 111.85445429357071. Distance: 1.283211578852242
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.8496, Accuracy: 83/10000 (0.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.5532, Accuracy: 8015/9950 (80.5528%)
Scaling by  100
Scaled Norm after poisoning: 168.27781159439886, distance: 128.32114559280555
Total norm for 2 adversaries is: 168.27781159439886. distance: 128.32114559280555
___Test Local_ResNet_18 poisoned: True, epoch: 33: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   1, Avg loss: 0.0927, Accuracy: 62/773 (8.0207%)
___Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   2, Avg loss: 0.0335, Accuracy: 442/773 (57.1798%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 10.9956, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   1, Avg loss: 0.0892, Accuracy: 122/712 (17.1348%)
___Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 453/712 (63.6236%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.4520, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   1, Avg loss: 0.0691, Accuracy: 99/735 (13.4694%)
___Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   2, Avg loss: 0.0208, Accuracy: 366/735 (49.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 10.8972, Accuracy: 69/10000 (0.6900%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   1, Avg loss: 0.0191, Accuracy: 521/861 (60.5110%)
___Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   2, Avg loss: 0.0159, Accuracy: 569/861 (66.0859%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 9.6320, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   1, Avg loss: 0.0645, Accuracy: 347/1662 (20.8785%)
___Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   2, Avg loss: 0.0310, Accuracy: 699/1662 (42.0578%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.8755, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0747, Accuracy: 273/1418 (19.2525%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0298, Accuracy: 675/1418 (47.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.4464, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   1, Avg loss: 0.0792, Accuracy: 168/803 (20.9215%)
___Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   2, Avg loss: 0.0377, Accuracy: 443/803 (55.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.4056, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   1, Avg loss: 0.0870, Accuracy: 116/708 (16.3842%)
___Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   2, Avg loss: 0.0445, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.3738, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   1, Avg loss: 0.0707, Accuracy: 306/1742 (17.5660%)
___Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   2, Avg loss: 0.0308, Accuracy: 758/1742 (43.5132%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Avg loss: 8.5565, Accuracy: 81/10000 (0.8100%)
time spent on training: 242.18908071517944
___Test Target_ResNet_18 poisoned: False, epoch: 33: Avg loss: 7.8560, Accuracy: 81/10000 (0.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Avg loss: 0.7090, Accuracy: 7438/9950 (74.7538%)
saving model
Done in 473.7657096385956 sec.
Server Epoch:34 choose agents : [82, 57, 91, 67, 43, 97, 54, 71, 66, 14].
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.1184, Accuracy: 2/500 (0.4000%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0575, Accuracy: 103/500 (20.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.4225, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   1, Avg loss: 0.0827, Accuracy: 154/1154 (13.3449%)
___Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   2, Avg loss: 0.0282, Accuracy: 451/1154 (39.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 11.2521, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   1, Avg loss: 0.0708, Accuracy: 223/1030 (21.6505%)
___Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   2, Avg loss: 0.0254, Accuracy: 605/1030 (58.7379%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.0834, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   1, Avg loss: 0.1274, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   2, Avg loss: 0.0591, Accuracy: 78/426 (18.3099%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.1284, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   1, Avg loss: 0.0933, Accuracy: 134/946 (14.1649%)
___Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   2, Avg loss: 0.0401, Accuracy: 321/946 (33.9323%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.0566, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   1, Avg loss: 0.0785, Accuracy: 197/1213 (16.2407%)
___Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   2, Avg loss: 0.0284, Accuracy: 518/1213 (42.7040%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.1601, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0787, Accuracy: 203/1130 (17.9646%)
___Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 463/1130 (40.9735%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 9.6725, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.1016, Accuracy: 20/818 (2.4450%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0321, Accuracy: 403/818 (49.2665%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.9551, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   1, Avg loss: 0.0763, Accuracy: 233/1402 (16.6191%)
___Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 409/1402 (29.1726%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.4661, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0917, Accuracy: 80/1013 (7.8973%)
___Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0365, Accuracy: 360/1013 (35.5380%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Avg loss: 8.2356, Accuracy: 96/10000 (0.9600%)
time spent on training: 153.84960556030273
___Test Target_ResNet_18 poisoned: False, epoch: 34: Avg loss: 7.3357, Accuracy: 86/10000 (0.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Avg loss: 1.0935, Accuracy: 6337/9950 (63.6884%)
saving model
Done in 385.342777967453 sec.
Server Epoch:35 choose agents : [25, 59, 84, 17, 29, 58, 36, 90, 67, 70].
poison local model 25 index 7 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   1, Average loss: 0.0664, Accuracy: 200/690 (28.9855%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   2, Average loss: 0.0273, Accuracy: 451/690 (65.3623%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   3, Average loss: 0.0218, Accuracy: 478/690 (69.2754%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   4, Average loss: 0.0201, Accuracy: 480/690 (69.5652%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   5, Average loss: 0.0182, Accuracy: 481/690 (69.7101%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   6, Average loss: 0.0182, Accuracy: 492/690 (71.3043%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   7, Average loss: 0.0168, Accuracy: 490/690 (71.0145%), train_poison_data_count: 220
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   8, Average loss: 0.0156, Accuracy: 510/690 (73.9130%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   9, Average loss: 0.0161, Accuracy: 494/690 (71.5942%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch  10, Average loss: 0.0158, Accuracy: 507/690 (73.4783%), train_poison_data_count: 220
Global model norm: 111.8505166994659.
Norm before scaling: 111.83801763041046. Distance: 0.8486344279283747
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.1233, Accuracy: 47/10000 (0.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.2830, Accuracy: 8945/9950 (89.8995%)
Scaling by  100
Scaled Norm after poisoning: 139.1409259191019, distance: 84.863441545447
Total norm for 1 adversaries is: 139.1409259191019. distance: 84.863441545447
___Test Local_ResNet_18 poisoned: True, epoch: 35: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0713, Accuracy: 188/1089 (17.2635%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0264, Accuracy: 544/1089 (49.9541%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.7057, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   1, Avg loss: 0.0853, Accuracy: 193/1190 (16.2185%)
___Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 470/1190 (39.4958%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.8564, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   1, Avg loss: 0.0663, Accuracy: 284/1574 (18.0432%)
___Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   2, Avg loss: 0.0265, Accuracy: 702/1574 (44.5997%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.7862, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   1, Avg loss: 0.0689, Accuracy: 268/1440 (18.6111%)
___Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   2, Avg loss: 0.0283, Accuracy: 724/1440 (50.2778%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 9.3417, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0804, Accuracy: 160/803 (19.9253%)
___Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0388, Accuracy: 418/803 (52.0548%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.5946, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   1, Avg loss: 0.1272, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   2, Avg loss: 0.0649, Accuracy: 75/408 (18.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 6.8854, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   1, Avg loss: 0.0781, Accuracy: 113/677 (16.6913%)
___Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 467/677 (68.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 11.2335, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.1180, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0551, Accuracy: 97/426 (22.7700%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.1972, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   1, Avg loss: 0.0729, Accuracy: 261/1418 (18.4062%)
___Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   2, Avg loss: 0.0300, Accuracy: 698/1418 (49.2243%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Avg loss: 8.3921, Accuracy: 99/10000 (0.9900%)
time spent on training: 219.6936058998108
___Test Target_ResNet_18 poisoned: False, epoch: 35: Avg loss: 7.0119, Accuracy: 49/10000 (0.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Avg loss: 0.4863, Accuracy: 7801/9950 (78.4020%)
saving model
Done in 456.7216682434082 sec.
Server Epoch:36 choose agents : [14, 2, 79, 58, 84, 40, 16, 50, 8, 72].
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0801, Accuracy: 102/1013 (10.0691%)
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 367/1013 (36.2290%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 8.4178, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.1051, Accuracy: 12/605 (1.9835%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0468, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.1006, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   1, Avg loss: 0.1715, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   2, Avg loss: 0.1229, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 5.9120, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   1, Avg loss: 0.0805, Accuracy: 165/803 (20.5479%)
___Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   2, Avg loss: 0.0369, Accuracy: 447/803 (55.6663%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.1328, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   1, Avg loss: 0.0864, Accuracy: 177/1190 (14.8739%)
___Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 484/1190 (40.6723%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.6448, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   1, Avg loss: 0.0734, Accuracy: 243/1573 (15.4482%)
___Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   2, Avg loss: 0.0351, Accuracy: 615/1573 (39.0973%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.5131, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   1, Avg loss: 0.0895, Accuracy: 131/708 (18.5028%)
___Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   2, Avg loss: 0.0413, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 12.2469, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   1, Avg loss: 0.0947, Accuracy: 30/809 (3.7083%)
___Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   2, Avg loss: 0.0289, Accuracy: 333/809 (41.1619%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 10.0335, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   1, Avg loss: 0.0732, Accuracy: 194/1513 (12.8222%)
___Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   2, Avg loss: 0.0358, Accuracy: 526/1513 (34.7654%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.7419, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   1, Avg loss: 0.0784, Accuracy: 163/1241 (13.1346%)
___Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   2, Avg loss: 0.0373, Accuracy: 436/1241 (35.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Avg loss: 7.6927, Accuracy: 79/10000 (0.7900%)
time spent on training: 157.06029343605042
___Test Target_ResNet_18 poisoned: False, epoch: 36: Avg loss: 6.5189, Accuracy: 57/10000 (0.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Avg loss: 0.7932, Accuracy: 6805/9950 (68.3920%)
saving model
Done in 394.27851963043213 sec.
Server Epoch:37 choose agents : [30, 52, 90, 51, 62, 40, 15, 83, 13, 39].
poison local model 30 index 8 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   1, Average loss: 0.0801, Accuracy: 120/486 (24.6914%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   2, Average loss: 0.0460, Accuracy: 177/486 (36.4198%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   3, Average loss: 0.0316, Accuracy: 250/486 (51.4403%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   4, Average loss: 0.0314, Accuracy: 254/486 (52.2634%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   5, Average loss: 0.0308, Accuracy: 265/486 (54.5267%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   6, Average loss: 0.0275, Accuracy: 270/486 (55.5556%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   7, Average loss: 0.0276, Accuracy: 274/486 (56.3786%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   8, Average loss: 0.0267, Accuracy: 280/486 (57.6132%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   9, Average loss: 0.0268, Accuracy: 292/486 (60.0823%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch  10, Average loss: 0.0275, Accuracy: 281/486 (57.8189%), train_poison_data_count: 160
Global model norm: 111.83407509146083.
Norm before scaling: 111.8253818040654. Distance: 0.7429244548698176
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.9064, Accuracy: 48/10000 (0.4800%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.2647, Accuracy: 9057/9950 (91.0251%)
Scaling by  100
Scaled Norm after poisoning: 133.32873934143007, distance: 74.29244696320919
Total norm for 2 adversaries is: 133.32873934143007. distance: 74.29244696320919
___Test Local_ResNet_18 poisoned: True, epoch: 37: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0840, Accuracy: 83/636 (13.0503%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0333, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.1511, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   1, Avg loss: 0.0728, Accuracy: 135/677 (19.9409%)
___Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   2, Avg loss: 0.0224, Accuracy: 462/677 (68.2422%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 10.0596, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0786, Accuracy: 129/1049 (12.2974%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 529/1049 (50.4290%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.6640, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   1, Avg loss: 0.0899, Accuracy: 36/568 (6.3380%)
___Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   2, Avg loss: 0.0457, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.9507, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   1, Avg loss: 0.0686, Accuracy: 280/1573 (17.8004%)
___Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 642/1573 (40.8137%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.6532, Accuracy: 77/10000 (0.7700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   1, Avg loss: 0.0459, Accuracy: 341/1154 (29.5494%)
___Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   2, Avg loss: 0.0250, Accuracy: 582/1154 (50.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.5594, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0638, Accuracy: 377/1953 (19.3036%)
___Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0322, Accuracy: 895/1953 (45.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 7.6296, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   1, Avg loss: 0.0687, Accuracy: 269/1645 (16.3526%)
___Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   2, Avg loss: 0.0313, Accuracy: 655/1645 (39.8176%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 9.2003, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   1, Avg loss: 0.0712, Accuracy: 150/1013 (14.8075%)
___Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   2, Avg loss: 0.0264, Accuracy: 505/1013 (49.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Avg loss: 8.7146, Accuracy: 74/10000 (0.7400%)
time spent on training: 239.0752625465393
___Test Target_ResNet_18 poisoned: False, epoch: 37: Avg loss: 6.8965, Accuracy: 52/10000 (0.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Avg loss: 0.4534, Accuracy: 8195/9950 (82.3618%)
saving model
Done in 480.48666548728943 sec.
Server Epoch:38 choose agents : [70, 37, 62, 29, 91, 31, 56, 1, 98, 4].
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0658, Accuracy: 305/1418 (21.5092%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0302, Accuracy: 698/1418 (49.2243%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.4280, Accuracy: 90/10000 (0.9000%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0648, Accuracy: 299/1129 (26.4836%)
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0234, Accuracy: 750/1129 (66.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.7900, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   1, Avg loss: 0.0843, Accuracy: 39/568 (6.8662%)
___Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   2, Avg loss: 0.0444, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.5972, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   1, Avg loss: 0.0624, Accuracy: 325/1440 (22.5694%)
___Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 734/1440 (50.9722%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.8910, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   1, Avg loss: 0.0626, Accuracy: 208/1030 (20.1942%)
___Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   2, Avg loss: 0.0246, Accuracy: 652/1030 (63.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 9.2987, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   1, Avg loss: 0.1075, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   2, Avg loss: 0.0434, Accuracy: 155/460 (33.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 7.5584, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.1184, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.0956, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.0052, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0670, Accuracy: 209/928 (22.5216%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 634/928 (68.3190%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 10.5023, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   1, Avg loss: 0.0619, Accuracy: 120/373 (32.1716%)
___Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   2, Avg loss: 0.0423, Accuracy: 155/373 (41.5550%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.5128, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0778, Accuracy: 202/901 (22.4195%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0383, Accuracy: 379/901 (42.0644%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Avg loss: 8.2196, Accuracy: 60/10000 (0.6000%)
time spent on training: 161.90958428382874
___Test Target_ResNet_18 poisoned: False, epoch: 38: Avg loss: 6.4949, Accuracy: 53/10000 (0.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Avg loss: 0.6125, Accuracy: 7750/9950 (77.8894%)
saving model
Done in 400.01733350753784 sec.
Server Epoch:39 choose agents : [37, 46, 50, 70, 86, 40, 74, 51, 9, 21].
poison local model 37 index 9 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   1, Average loss: 0.0527, Accuracy: 406/1129 (35.9610%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   2, Average loss: 0.0220, Accuracy: 714/1129 (63.2418%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   3, Average loss: 0.0171, Accuracy: 815/1129 (72.1878%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   4, Average loss: 0.0172, Accuracy: 813/1129 (72.0106%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   5, Average loss: 0.0172, Accuracy: 797/1129 (70.5934%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   6, Average loss: 0.0163, Accuracy: 824/1129 (72.9849%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   7, Average loss: 0.0153, Accuracy: 838/1129 (74.2250%), train_poison_data_count: 360
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   8, Average loss: 0.0159, Accuracy: 819/1129 (72.5421%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   9, Average loss: 0.0153, Accuracy: 839/1129 (74.3136%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch  10, Average loss: 0.0157, Accuracy: 828/1129 (73.3392%), train_poison_data_count: 360
Global model norm: 111.82203704435902.
Norm before scaling: 111.80338577302791. Distance: 1.0355903147274386
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.6398, Accuracy: 106/10000 (1.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: 0.2000, Accuracy: 9101/9950 (91.4673%)
Scaling by  100
Scaled Norm after poisoning: 150.6792303827903, distance: 103.55902510012105
Total norm for 2 adversaries is: 150.6792303827903. distance: 103.55902510012105
___Test Local_ResNet_18 poisoned: True, epoch: 39: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0615, Accuracy: 322/1904 (16.9118%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0299, Accuracy: 787/1904 (41.3340%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.6946, Accuracy: 151/10000 (1.5100%)
___Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   1, Avg loss: 0.0806, Accuracy: 56/809 (6.9221%)
___Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 373/809 (46.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 9.6256, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0640, Accuracy: 303/1418 (21.3681%)
___Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 691/1418 (48.7306%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.2531, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   1, Avg loss: 0.0762, Accuracy: 202/1003 (20.1396%)
___Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   2, Avg loss: 0.0365, Accuracy: 393/1003 (39.1825%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.0537, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   1, Avg loss: 0.0649, Accuracy: 261/1573 (16.5925%)
___Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 608/1573 (38.6523%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.8318, Accuracy: 82/10000 (0.8200%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 507/1552 (32.6675%)
___Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   2, Avg loss: 0.0186, Accuracy: 878/1552 (56.5722%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 10.8609, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0652, Accuracy: 190/1049 (18.1125%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0281, Accuracy: 498/1049 (47.4738%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.2969, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0589, Accuracy: 253/1275 (19.8431%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0182, Accuracy: 767/1275 (60.1569%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 10.6497, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   1, Avg loss: 0.0600, Accuracy: 345/1949 (17.7014%)
___Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   2, Avg loss: 0.0320, Accuracy: 695/1949 (35.6593%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Avg loss: 8.2719, Accuracy: 95/10000 (0.9500%)
time spent on training: 268.78625750541687
___Test Target_ResNet_18 poisoned: False, epoch: 39: Avg loss: 7.5050, Accuracy: 108/10000 (1.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Avg loss: 0.3644, Accuracy: 8286/9950 (83.2764%)
saving model
Done in 506.8191862106323 sec.
Server Epoch:40 choose agents : [32, 70, 52, 38, 15, 78, 83, 84, 12, 92].
___Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   1, Avg loss: 0.0769, Accuracy: 67/735 (9.1156%)
___Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   2, Avg loss: 0.0245, Accuracy: 324/735 (44.0816%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 10.2006, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0743, Accuracy: 282/1418 (19.8872%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 692/1418 (48.8011%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.0818, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   1, Avg loss: 0.0959, Accuracy: 57/636 (8.9623%)
___Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   2, Avg loss: 0.0373, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.3815, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   1, Avg loss: 0.0841, Accuracy: 149/1131 (13.1742%)
___Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 552/1131 (48.8064%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.8203, Accuracy: 103/10000 (1.0300%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   1, Avg loss: 0.0585, Accuracy: 247/1154 (21.4038%)
___Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   2, Avg loss: 0.0255, Accuracy: 605/1154 (52.4263%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 9.3307, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.1362, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0662, Accuracy: 68/416 (16.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.5340, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0668, Accuracy: 357/1953 (18.2796%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0322, Accuracy: 862/1953 (44.1372%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.4586, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0822, Accuracy: 224/1190 (18.8235%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0332, Accuracy: 462/1190 (38.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 7.6169, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   1, Avg loss: 0.1463, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   2, Avg loss: 0.0736, Accuracy: 12/338 (3.5503%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.2393, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0696, Accuracy: 314/1715 (18.3090%)
___Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0299, Accuracy: 752/1715 (43.8484%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Avg loss: 8.4783, Accuracy: 112/10000 (1.1200%)
time spent on training: 181.0304844379425
___Test Target_ResNet_18 poisoned: False, epoch: 40: Avg loss: 6.9707, Accuracy: 111/10000 (1.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Avg loss: 0.7078, Accuracy: 7132/9950 (71.6784%)
saving model
Saving model on epoch 40
Done in 418.0898048877716 sec.
Server Epoch:41 choose agents : [44, 96, 66, 2, 76, 98, 52, 77, 99, 29].
poison local model 44 index 10 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Average loss: 0.0560, Accuracy: 612/1750 (34.9714%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Average loss: 0.0296, Accuracy: 948/1750 (54.1714%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   3, Average loss: 0.0253, Accuracy: 1016/1750 (58.0571%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   4, Average loss: 0.0252, Accuracy: 1005/1750 (57.4286%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   5, Average loss: 0.0249, Accuracy: 1002/1750 (57.2571%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   6, Average loss: 0.0245, Accuracy: 1011/1750 (57.7714%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   7, Average loss: 0.0241, Accuracy: 1036/1750 (59.2000%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   8, Average loss: 0.0238, Accuracy: 1042/1750 (59.5429%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   9, Average loss: 0.0238, Accuracy: 1026/1750 (58.6286%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch  10, Average loss: 0.0234, Accuracy: 1050/1750 (60.0000%), train_poison_data_count: 560
Global model norm: 111.79895722204881.
Norm before scaling: 111.76452733453714. Distance: 1.2701949981361524
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.0058, Accuracy: 118/10000 (1.1800%)
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.5483, Accuracy: 8321/9950 (83.6281%)
Scaling by  100
Scaled Norm after poisoning: 166.43959466387497, distance: 127.01949899523301
Total norm for 1 adversaries is: 166.43959466387497. distance: 127.01949899523301
___Test Local_ResNet_18 poisoned: True, epoch: 41: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.1277, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0822, Accuracy: 10/311 (3.2154%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.0533, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0744, Accuracy: 224/1402 (15.9772%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0394, Accuracy: 401/1402 (28.6020%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.4641, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0973, Accuracy: 29/605 (4.7934%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0449, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.2293, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   1, Avg loss: 0.1149, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   2, Avg loss: 0.0573, Accuracy: 159/466 (34.1202%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.7326, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   1, Avg loss: 0.1094, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   2, Avg loss: 0.0559, Accuracy: 57/373 (15.2815%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 6.5074, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   1, Avg loss: 0.0877, Accuracy: 75/636 (11.7925%)
___Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   2, Avg loss: 0.0350, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 9.0475, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   1, Avg loss: 0.0695, Accuracy: 205/1340 (15.2985%)
___Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 563/1340 (42.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 8.5156, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   1, Avg loss: 0.0916, Accuracy: 57/773 (7.3739%)
___Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   2, Avg loss: 0.0339, Accuracy: 424/773 (54.8512%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 10.6289, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   1, Avg loss: 0.0674, Accuracy: 274/1440 (19.0278%)
___Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   2, Avg loss: 0.0284, Accuracy: 736/1440 (51.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Avg loss: 9.7718, Accuracy: 85/10000 (0.8500%)
time spent on training: 234.7265179157257
___Test Target_ResNet_18 poisoned: False, epoch: 41: Avg loss: 7.0006, Accuracy: 120/10000 (1.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Avg loss: 0.7779, Accuracy: 7484/9950 (75.2161%)
saving model
Saving model on epoch 41
Done in 476.39429688453674 sec.
Server Epoch:42 choose agents : [5, 45, 88, 53, 24, 60, 19, 4, 51, 79].
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   1, Avg loss: 0.0534, Accuracy: 450/1628 (27.6413%)
___Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   2, Avg loss: 0.0203, Accuracy: 1033/1628 (63.4521%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 9.8711, Accuracy: 178/10000 (1.7800%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0923, Accuracy: 60/669 (8.9686%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0442, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.3393, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   1, Avg loss: 0.0671, Accuracy: 125/603 (20.7297%)
___Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   2, Avg loss: 0.0443, Accuracy: 300/603 (49.7512%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 7.5825, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   1, Avg loss: 0.0791, Accuracy: 107/813 (13.1611%)
___Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   2, Avg loss: 0.0200, Accuracy: 453/813 (55.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 12.8918, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   1, Avg loss: 0.1155, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   2, Avg loss: 0.0651, Accuracy: 31/312 (9.9359%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.5637, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0608, Accuracy: 518/2227 (23.2600%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0276, Accuracy: 1112/2227 (49.9326%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.1589, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   1, Avg loss: 0.0692, Accuracy: 212/1036 (20.4633%)
___Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   2, Avg loss: 0.0257, Accuracy: 712/1036 (68.7259%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 12.9390, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0852, Accuracy: 176/901 (19.5339%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0370, Accuracy: 432/901 (47.9467%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.1456, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   1, Avg loss: 0.0784, Accuracy: 149/1049 (14.2040%)
___Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   2, Avg loss: 0.0294, Accuracy: 516/1049 (49.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 8.2984, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   1, Avg loss: 0.1629, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   2, Avg loss: 0.1274, Accuracy: 0/197 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.4030, Accuracy: 113/10000 (1.1300%)
time spent on training: 175.95504188537598
___Test Target_ResNet_18 poisoned: False, epoch: 42: Avg loss: 6.7740, Accuracy: 120/10000 (1.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Avg loss: 1.1398, Accuracy: 6787/9950 (68.2111%)
saving model
Saving model on epoch 42
Done in 411.2009541988373 sec.
Server Epoch:43 choose agents : [49, 71, 38, 53, 30, 18, 45, 40, 35, 5].
poison local model 49 index 11 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   1, Average loss: 0.0711, Accuracy: 125/440 (28.4091%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   2, Average loss: 0.0506, Accuracy: 136/440 (30.9091%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   3, Average loss: 0.0388, Accuracy: 221/440 (50.2273%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   4, Average loss: 0.0365, Accuracy: 232/440 (52.7273%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   5, Average loss: 0.0334, Accuracy: 258/440 (58.6364%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   6, Average loss: 0.0328, Accuracy: 253/440 (57.5000%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   7, Average loss: 0.0323, Accuracy: 245/440 (55.6818%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   8, Average loss: 0.0315, Accuracy: 249/440 (56.5909%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   9, Average loss: 0.0303, Accuracy: 252/440 (57.2727%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch  10, Average loss: 0.0295, Accuracy: 265/440 (60.2273%), train_poison_data_count: 140
Global model norm: 111.7613292984765.
Norm before scaling: 111.75435621403086. Distance: 0.6012535292587274
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.3665, Accuracy: 68/10000 (0.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.2042, Accuracy: 9754/9950 (98.0302%)
Scaling by  100
Scaled Norm after poisoning: 126.1496120064386, distance: 60.12535123663
Total norm for 3 adversaries is: 126.1496120064386. distance: 60.12535123663
___Test Local_ResNet_18 poisoned: True, epoch: 43: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   1, Avg loss: 0.0919, Accuracy: 24/818 (2.9340%)
___Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   2, Avg loss: 0.0314, Accuracy: 419/818 (51.2225%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.6733, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   1, Avg loss: 0.0768, Accuracy: 170/1131 (15.0309%)
___Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 540/1131 (47.7454%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.7488, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   1, Avg loss: 0.0743, Accuracy: 119/813 (14.6371%)
___Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   2, Avg loss: 0.0193, Accuracy: 480/813 (59.0406%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 12.4544, Accuracy: 62/10000 (0.6200%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0989, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0428, Accuracy: 173/486 (35.5967%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.1259, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   1, Avg loss: 0.1035, Accuracy: 3/530 (0.5660%)
___Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   2, Avg loss: 0.0436, Accuracy: 263/530 (49.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 8.0070, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0879, Accuracy: 63/669 (9.4170%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0432, Accuracy: 356/669 (53.2138%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.2867, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0709, Accuracy: 264/1573 (16.7832%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0354, Accuracy: 604/1573 (38.3980%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 7.6845, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   1, Avg loss: 0.1234, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   2, Avg loss: 0.0797, Accuracy: 19/271 (7.0111%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.4209, Accuracy: 68/10000 (0.6800%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   1, Avg loss: 0.0507, Accuracy: 483/1628 (29.6683%)
___Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   2, Avg loss: 0.0204, Accuracy: 1053/1628 (64.6806%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Avg loss: 9.2696, Accuracy: 166/10000 (1.6600%)
time spent on training: 238.3975100517273
___Test Target_ResNet_18 poisoned: False, epoch: 43: Avg loss: 6.3168, Accuracy: 64/10000 (0.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Avg loss: 0.2575, Accuracy: 9513/9950 (95.6080%)
saving model
Done in 474.3139719963074 sec.
Server Epoch:44 choose agents : [91, 35, 89, 37, 4, 10, 47, 36, 24, 61].
___Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   1, Avg loss: 0.0653, Accuracy: 198/1030 (19.2233%)
___Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   2, Avg loss: 0.0241, Accuracy: 658/1030 (63.8835%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 10.0686, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.1158, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0769, Accuracy: 22/271 (8.1181%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.3553, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   1, Avg loss: 0.0731, Accuracy: 186/896 (20.7589%)
___Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   2, Avg loss: 0.0365, Accuracy: 458/896 (51.1161%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.5264, Accuracy: 59/10000 (0.5900%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   1, Avg loss: 0.0513, Accuracy: 367/1129 (32.5066%)
___Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   2, Avg loss: 0.0194, Accuracy: 779/1129 (68.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 9.2907, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0744, Accuracy: 202/901 (22.4195%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0364, Accuracy: 394/901 (43.7292%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 8.1354, Accuracy: 67/10000 (0.6700%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   1, Avg loss: 0.0678, Accuracy: 135/861 (15.6794%)
___Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   2, Avg loss: 0.0189, Accuracy: 511/861 (59.3496%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 10.1136, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   1, Avg loss: 0.1541, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   2, Avg loss: 0.1295, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.1646, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.1123, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0608, Accuracy: 84/408 (20.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.9032, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   1, Avg loss: 0.0733, Accuracy: 19/312 (6.0897%)
___Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   2, Avg loss: 0.0452, Accuracy: 153/312 (49.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 7.3095, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   1, Avg loss: 0.1676, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   2, Avg loss: 0.1542, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.1489, Accuracy: 76/10000 (0.7600%)
time spent on training: 170.9191117286682
___Test Target_ResNet_18 poisoned: False, epoch: 44: Avg loss: 6.1874, Accuracy: 65/10000 (0.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Avg loss: 0.3539, Accuracy: 9228/9950 (92.7437%)
saving model
Done in 406.496723651886 sec.
Server Epoch:45 choose agents : [55, 62, 30, 4, 18, 38, 76, 69, 42, 68].
poison local model 55 index 12 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Average loss: 0.0621, Accuracy: 304/1071 (28.3847%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Average loss: 0.0245, Accuracy: 604/1071 (56.3959%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   3, Average loss: 0.0208, Accuracy: 676/1071 (63.1186%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   4, Average loss: 0.0202, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   5, Average loss: 0.0201, Accuracy: 692/1071 (64.6125%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   6, Average loss: 0.0195, Accuracy: 692/1071 (64.6125%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   7, Average loss: 0.0192, Accuracy: 706/1071 (65.9197%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   8, Average loss: 0.0184, Accuracy: 707/1071 (66.0131%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   9, Average loss: 0.0192, Accuracy: 698/1071 (65.1727%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch  10, Average loss: 0.0196, Accuracy: 708/1071 (66.1064%), train_poison_data_count: 340
Global model norm: 111.75184824394405.
Norm before scaling: 111.73402430549076. Distance: 1.1038082308761459
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.9050, Accuracy: 92/10000 (0.9200%)
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.2260, Accuracy: 9264/9950 (93.1055%)
Scaling by  100
Scaled Norm after poisoning: 155.40975953708633, distance: 110.38082604244498
Total norm for 2 adversaries is: 155.40975953708633. distance: 110.38082604244498
___Test Local_ResNet_18 poisoned: True, epoch: 45: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0765, Accuracy: 85/568 (14.9648%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0476, Accuracy: 263/568 (46.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 6.8705, Accuracy: 55/10000 (0.5500%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   1, Avg loss: 0.0901, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 190/486 (39.0947%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.1519, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0740, Accuracy: 218/901 (24.1953%)
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0353, Accuracy: 419/901 (46.5039%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.4483, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   1, Avg loss: 0.0945, Accuracy: 9/530 (1.6981%)
___Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   2, Avg loss: 0.0422, Accuracy: 267/530 (50.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.8891, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0725, Accuracy: 165/1131 (14.5889%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0300, Accuracy: 546/1131 (48.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.3396, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0998, Accuracy: 3/466 (0.6438%)
___Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0543, Accuracy: 176/466 (37.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.1213, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   1, Avg loss: 0.0757, Accuracy: 119/590 (20.1695%)
___Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   2, Avg loss: 0.0340, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 11.9035, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   1, Avg loss: 0.0678, Accuracy: 193/1372 (14.0671%)
___Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   2, Avg loss: 0.0317, Accuracy: 557/1372 (40.5977%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 8.4561, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0771, Accuracy: 221/1163 (19.0026%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0376, Accuracy: 484/1163 (41.6165%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.3289, Accuracy: 69/10000 (0.6900%)
time spent on training: 235.03089022636414
___Test Target_ResNet_18 poisoned: False, epoch: 45: Avg loss: 7.8223, Accuracy: 93/10000 (0.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Avg loss: 0.3840, Accuracy: 8600/9950 (86.4322%)
saving model
Done in 480.2773931026459 sec.
Server Epoch:46 choose agents : [34, 94, 32, 2, 30, 67, 17, 61, 73, 89].
___Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   1, Avg loss: 0.0834, Accuracy: 250/1427 (17.5193%)
___Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 629/1427 (44.0785%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.5516, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   1, Avg loss: 0.0746, Accuracy: 234/1662 (14.0794%)
___Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   2, Avg loss: 0.0320, Accuracy: 655/1662 (39.4103%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.0650, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   1, Avg loss: 0.0810, Accuracy: 81/735 (11.0204%)
___Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   2, Avg loss: 0.0232, Accuracy: 372/735 (50.6122%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 10.8689, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.1087, Accuracy: 5/605 (0.8264%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0480, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.8521, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.1173, Accuracy: 0/486 (0.0000%)
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0458, Accuracy: 161/486 (33.1276%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.0171, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   1, Avg loss: 0.1252, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   2, Avg loss: 0.0581, Accuracy: 104/426 (24.4131%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 6.9562, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0724, Accuracy: 262/1574 (16.6455%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 676/1574 (42.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 8.5692, Accuracy: 122/10000 (1.2200%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   1, Avg loss: 0.2105, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   2, Avg loss: 0.1930, Accuracy: 1/85 (1.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.3642, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   1, Avg loss: 0.0882, Accuracy: 100/938 (10.6610%)
___Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   2, Avg loss: 0.0368, Accuracy: 317/938 (33.7953%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.8586, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0891, Accuracy: 146/896 (16.2946%)
___Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0372, Accuracy: 486/896 (54.2411%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.8684, Accuracy: 70/10000 (0.7000%)
time spent on training: 182.1640646457672
___Test Target_ResNet_18 poisoned: False, epoch: 46: Avg loss: 7.3263, Accuracy: 95/10000 (0.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Avg loss: 0.7108, Accuracy: 7631/9950 (76.6935%)
saving model
Done in 418.53590846061707 sec.
Server Epoch:47 choose agents : [61, 49, 64, 19, 88, 44, 5, 46, 59, 14].
poison local model 61 index 13 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   1, Average loss: 0.0902, Accuracy: 23/85 (27.0588%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   2, Average loss: 0.0870, Accuracy: 26/85 (30.5882%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   3, Average loss: 0.0789, Accuracy: 31/85 (36.4706%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   4, Average loss: 0.0736, Accuracy: 33/85 (38.8235%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   5, Average loss: 0.0751, Accuracy: 34/85 (40.0000%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   6, Average loss: 0.0723, Accuracy: 36/85 (42.3529%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   7, Average loss: 0.0726, Accuracy: 37/85 (43.5294%), train_poison_data_count: 40
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   8, Average loss: 0.0706, Accuracy: 38/85 (44.7059%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   9, Average loss: 0.0708, Accuracy: 37/85 (43.5294%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch  10, Average loss: 0.0732, Accuracy: 36/85 (42.3529%), train_poison_data_count: 40
Global model norm: 111.7307773246141.
Norm before scaling: 111.72929583092788. Distance: 0.15252433979330468
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.1688, Accuracy: 74/10000 (0.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.0813, Accuracy: 9930/9950 (99.7990%)
Scaling by  100
Scaled Norm after poisoning: 112.60913109623927, distance: 15.25243470814962
Total norm for 4 adversaries is: 112.60913109623927. distance: 15.25243470814962
___Test Local_ResNet_18 poisoned: True, epoch: 47: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   1, Avg loss: 0.0938, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   2, Avg loss: 0.0447, Accuracy: 98/440 (22.2727%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.0700, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   1, Avg loss: 0.0870, Accuracy: 71/953 (7.4502%)
___Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   2, Avg loss: 0.0403, Accuracy: 349/953 (36.6212%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.3386, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0688, Accuracy: 231/1036 (22.2973%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0227, Accuracy: 714/1036 (68.9189%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 12.3298, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   1, Avg loss: 0.0881, Accuracy: 39/603 (6.4677%)
___Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   2, Avg loss: 0.0476, Accuracy: 292/603 (48.4245%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.5842, Accuracy: 65/10000 (0.6500%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   1, Avg loss: 0.0531, Accuracy: 451/1750 (25.7714%)
___Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   2, Avg loss: 0.0298, Accuracy: 823/1750 (47.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.8841, Accuracy: 143/10000 (1.4300%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   1, Avg loss: 0.0544, Accuracy: 456/1628 (28.0098%)
___Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   2, Avg loss: 0.0200, Accuracy: 1032/1628 (63.3907%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 9.1421, Accuracy: 169/10000 (1.6900%)
___Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   1, Avg loss: 0.0703, Accuracy: 291/1904 (15.2836%)
___Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   2, Avg loss: 0.0300, Accuracy: 790/1904 (41.4916%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 7.9719, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   1, Avg loss: 0.0777, Accuracy: 156/1089 (14.3251%)
___Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 508/1089 (46.6483%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 9.5363, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   1, Avg loss: 0.0859, Accuracy: 86/1013 (8.4896%)
___Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 403/1013 (39.7828%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Avg loss: 8.0128, Accuracy: 102/10000 (1.0200%)
time spent on training: 266.2833077907562
___Test Target_ResNet_18 poisoned: False, epoch: 47: Avg loss: 6.7190, Accuracy: 69/10000 (0.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Avg loss: 0.1374, Accuracy: 9893/9950 (99.4271%)
saving model
Done in 502.8886923789978 sec.
Server Epoch:48 choose agents : [21, 78, 90, 85, 84, 38, 88, 31, 97, 66].
___Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   1, Avg loss: 0.0640, Accuracy: 330/1949 (16.9318%)
___Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   2, Avg loss: 0.0320, Accuracy: 703/1949 (36.0698%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.2876, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   1, Avg loss: 0.0863, Accuracy: 77/416 (18.5096%)
___Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   2, Avg loss: 0.0500, Accuracy: 151/416 (36.2981%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.6131, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0795, Accuracy: 114/677 (16.8390%)
___Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0237, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 10.3703, Accuracy: 56/10000 (0.5600%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   1, Avg loss: 0.0634, Accuracy: 367/1988 (18.4608%)
___Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   2, Avg loss: 0.0345, Accuracy: 780/1988 (39.2354%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.9390, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   1, Avg loss: 0.0790, Accuracy: 185/1190 (15.5462%)
___Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 476/1190 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.5258, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0773, Accuracy: 157/1131 (13.8815%)
___Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 550/1131 (48.6295%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.5399, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0814, Accuracy: 53/603 (8.7894%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0459, Accuracy: 293/603 (48.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.6364, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   1, Avg loss: 0.1174, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   2, Avg loss: 0.0502, Accuracy: 116/460 (25.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.5425, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   1, Avg loss: 0.0716, Accuracy: 216/1213 (17.8071%)
___Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   2, Avg loss: 0.0275, Accuracy: 532/1213 (43.8582%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 8.6504, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   1, Avg loss: 0.0775, Accuracy: 174/1402 (12.4108%)
___Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   2, Avg loss: 0.0397, Accuracy: 435/1402 (31.0271%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Avg loss: 7.3543, Accuracy: 80/10000 (0.8000%)
time spent on training: 192.02148342132568
___Test Target_ResNet_18 poisoned: False, epoch: 48: Avg loss: 6.3560, Accuracy: 72/10000 (0.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Avg loss: 0.2991, Accuracy: 9382/9950 (94.2915%)
saving model
Done in 432.3672921657562 sec.
Server Epoch:49 choose agents : [65, 16, 50, 5, 97, 4, 13, 23, 86, 72].
poison local model 65 index 14 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Average loss: 0.0546, Accuracy: 563/1475 (38.1695%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Average loss: 0.0256, Accuracy: 844/1475 (57.2203%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   3, Average loss: 0.0214, Accuracy: 924/1475 (62.6441%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   4, Average loss: 0.0209, Accuracy: 929/1475 (62.9831%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   5, Average loss: 0.0200, Accuracy: 948/1475 (64.2712%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   6, Average loss: 0.0206, Accuracy: 974/1475 (66.0339%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   7, Average loss: 0.0201, Accuracy: 961/1475 (65.1525%), train_poison_data_count: 463
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   8, Average loss: 0.0197, Accuracy: 971/1475 (65.8305%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   9, Average loss: 0.0187, Accuracy: 981/1475 (66.5085%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch  10, Average loss: 0.0193, Accuracy: 963/1475 (65.2881%), train_poison_data_count: 463
Global model norm: 111.7250566401736.
Norm before scaling: 111.69752420739907. Distance: 1.1762912189262582
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.1792, Accuracy: 109/10000 (1.0900%)
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.3468, Accuracy: 9122/9950 (91.6784%)
Scaling by  100
Scaled Norm after poisoning: 159.89323219925538, distance: 117.62912203856024
Total norm for 2 adversaries is: 159.89323219925538. distance: 117.62912203856024
___Test Local_ResNet_18 poisoned: True, epoch: 49: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   1, Avg loss: 0.0840, Accuracy: 121/708 (17.0904%)
___Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   2, Avg loss: 0.0389, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.8547, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   1, Avg loss: 0.0763, Accuracy: 72/809 (8.8999%)
___Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   2, Avg loss: 0.0283, Accuracy: 350/809 (43.2633%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.8594, Accuracy: 116/10000 (1.1600%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   1, Avg loss: 0.0485, Accuracy: 501/1628 (30.7740%)
___Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   2, Avg loss: 0.0199, Accuracy: 1026/1628 (63.0221%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 9.0925, Accuracy: 162/10000 (1.6200%)
___Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0677, Accuracy: 221/1213 (18.2193%)
___Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0268, Accuracy: 601/1213 (49.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.8395, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0770, Accuracy: 192/901 (21.3097%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0357, Accuracy: 432/901 (47.9467%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.9056, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   1, Avg loss: 0.0652, Accuracy: 310/1645 (18.8450%)
___Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   2, Avg loss: 0.0311, Accuracy: 734/1645 (44.6201%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 8.0057, Accuracy: 139/10000 (1.3900%)
___Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   1, Avg loss: 0.0850, Accuracy: 113/715 (15.8042%)
___Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   2, Avg loss: 0.0474, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.1033, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   1, Avg loss: 0.0793, Accuracy: 192/1003 (19.1426%)
___Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   2, Avg loss: 0.0378, Accuracy: 359/1003 (35.7926%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.3388, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   1, Avg loss: 0.0701, Accuracy: 190/1241 (15.3102%)
___Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 465/1241 (37.4698%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.6906, Accuracy: 83/10000 (0.8300%)
time spent on training: 271.3664288520813
___Test Target_ResNet_18 poisoned: False, epoch: 49: Avg loss: 7.1515, Accuracy: 109/10000 (1.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Avg loss: 0.5513, Accuracy: 8254/9950 (82.9548%)
saving model
Done in 502.1974823474884 sec.
Server Epoch:50 choose agents : [44, 46, 85, 2, 36, 48, 98, 55, 22, 81].
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 397/1750 (22.6857%)
___Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   2, Avg loss: 0.0309, Accuracy: 823/1750 (47.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.7955, Accuracy: 143/10000 (1.4300%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0702, Accuracy: 360/1904 (18.9076%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0300, Accuracy: 787/1904 (41.3340%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.8787, Accuracy: 120/10000 (1.2000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   1, Avg loss: 0.0682, Accuracy: 326/1988 (16.3984%)
___Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 722/1988 (36.3179%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.7088, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.1048, Accuracy: 8/605 (1.3223%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0466, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.5049, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   1, Avg loss: 0.1237, Accuracy: 1/408 (0.2451%)
___Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   2, Avg loss: 0.0661, Accuracy: 82/408 (20.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.7933, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.1145, Accuracy: 0/631 (0.0000%)
___Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0531, Accuracy: 188/631 (29.7940%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.0684, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   1, Avg loss: 0.1154, Accuracy: 2/373 (0.5362%)
___Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   2, Avg loss: 0.0635, Accuracy: 38/373 (10.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.5066, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   1, Avg loss: 0.0637, Accuracy: 216/1071 (20.1681%)
___Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   2, Avg loss: 0.0262, Accuracy: 579/1071 (54.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 8.9961, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   1, Avg loss: 0.0664, Accuracy: 391/1470 (26.5986%)
___Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   2, Avg loss: 0.0250, Accuracy: 910/1470 (61.9048%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 9.6255, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0958, Accuracy: 59/774 (7.6227%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0369, Accuracy: 417/774 (53.8760%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Avg loss: 7.9913, Accuracy: 80/10000 (0.8000%)
time spent on training: 216.0061056613922
___Test Target_ResNet_18 poisoned: False, epoch: 50: Avg loss: 6.8105, Accuracy: 107/10000 (1.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Avg loss: 0.7714, Accuracy: 7526/9950 (75.6382%)
saving model
Saving model on epoch 50
Done in 446.2602837085724 sec.
Server Epoch:51 choose agents : [85, 13, 26, 47, 58, 96, 62, 76, 7, 72].
poison local model 85 index 15 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   1, Average loss: 0.0534, Accuracy: 718/1988 (36.1167%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   2, Average loss: 0.0286, Accuracy: 1020/1988 (51.3078%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   3, Average loss: 0.0256, Accuracy: 1089/1988 (54.7787%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   4, Average loss: 0.0256, Accuracy: 1059/1988 (53.2696%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   5, Average loss: 0.0255, Accuracy: 1070/1988 (53.8229%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   6, Average loss: 0.0255, Accuracy: 1073/1988 (53.9738%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   7, Average loss: 0.0248, Accuracy: 1106/1988 (55.6338%), train_poison_data_count: 624
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   8, Average loss: 0.0246, Accuracy: 1098/1988 (55.2314%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   9, Average loss: 0.0247, Accuracy: 1114/1988 (56.0362%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch  10, Average loss: 0.0244, Accuracy: 1126/1988 (56.6398%), train_poison_data_count: 624
Global model norm: 111.69344556082957.
Norm before scaling: 111.65470629355487. Distance: 1.3111044412558206
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.3853, Accuracy: 88/10000 (0.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: 0.5513, Accuracy: 8465/9950 (85.0754%)
Scaling by  100
Scaled Norm after poisoning: 169.19882442706273, distance: 131.1104466423252
Total norm for 1 adversaries is: 169.19882442706273. distance: 131.1104466423252
___Test Local_ResNet_18 poisoned: True, epoch: 51: Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   1, Avg loss: 0.0662, Accuracy: 283/1645 (17.2036%)
___Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   2, Avg loss: 0.0309, Accuracy: 706/1645 (42.9179%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.9015, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   1, Avg loss: 0.0681, Accuracy: 221/1446 (15.2835%)
___Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 568/1446 (39.2808%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.6596, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   1, Avg loss: 0.1719, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   2, Avg loss: 0.1430, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 6.4262, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   1, Avg loss: 0.0745, Accuracy: 171/803 (21.2951%)
___Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   2, Avg loss: 0.0379, Accuracy: 437/803 (54.4209%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.2866, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   1, Avg loss: 0.1165, Accuracy: 1/311 (0.3215%)
___Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   2, Avg loss: 0.0785, Accuracy: 24/311 (7.7170%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 6.2704, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   1, Avg loss: 0.0935, Accuracy: 16/568 (2.8169%)
___Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   2, Avg loss: 0.0486, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.2491, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.1080, Accuracy: 0/466 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0543, Accuracy: 162/466 (34.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.4410, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0807, Accuracy: 157/891 (17.6207%)
___Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0298, Accuracy: 469/891 (52.6375%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 8.3381, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0762, Accuracy: 184/1241 (14.8268%)
___Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 463/1241 (37.3086%)
___Test Local_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.6208, Accuracy: 78/10000 (0.7800%)
time spent on training: 250.28193759918213
___Test Target_ResNet_18 poisoned: False, epoch: 51: Avg loss: 7.3793, Accuracy: 85/10000 (0.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 51: Avg loss: 0.7903, Accuracy: 7497/9950 (75.3467%)
saving model
Done in 490.39016819000244 sec.
Server Epoch:52 choose agents : [9, 47, 83, 58, 50, 6, 68, 26, 40, 71].
___Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   1, Avg loss: 0.0650, Accuracy: 234/1275 (18.3529%)
___Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   2, Avg loss: 0.0180, Accuracy: 755/1275 (59.2157%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 10.4238, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   1, Avg loss: 0.1907, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   2, Avg loss: 0.1639, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 6.9584, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0696, Accuracy: 353/1953 (18.0748%)
___Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0324, Accuracy: 926/1953 (47.4142%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.3165, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0787, Accuracy: 148/803 (18.4309%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0394, Accuracy: 435/803 (54.1719%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.6375, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   1, Avg loss: 0.0939, Accuracy: 28/809 (3.4611%)
___Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   2, Avg loss: 0.0294, Accuracy: 349/809 (43.1397%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 9.3410, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   1, Avg loss: 0.0716, Accuracy: 281/1956 (14.3661%)
___Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   2, Avg loss: 0.0301, Accuracy: 746/1956 (38.1391%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.0055, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   1, Avg loss: 0.0903, Accuracy: 179/1163 (15.3912%)
___Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   2, Avg loss: 0.0391, Accuracy: 492/1163 (42.3044%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.2653, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   1, Avg loss: 0.0683, Accuracy: 245/1446 (16.9433%)
___Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 520/1446 (35.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.6057, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   1, Avg loss: 0.0777, Accuracy: 217/1573 (13.7953%)
___Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   2, Avg loss: 0.0357, Accuracy: 601/1573 (38.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.7010, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   1, Avg loss: 0.0921, Accuracy: 50/818 (6.1125%)
___Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   2, Avg loss: 0.0339, Accuracy: 349/818 (42.6650%)
___Test Local_ResNet_18 poisoned: False, epoch: 52: Avg loss: 8.3376, Accuracy: 95/10000 (0.9500%)
time spent on training: 194.3068516254425
___Test Target_ResNet_18 poisoned: False, epoch: 52: Avg loss: 7.0578, Accuracy: 90/10000 (0.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 52: Avg loss: 1.1231, Accuracy: 6589/9950 (66.2211%)
saving model
Done in 431.681325674057 sec.
Server Epoch:53 choose agents : [50, 14, 84, 8, 25, 5, 40, 98, 72, 69].
___Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   1, Avg loss: 0.0877, Accuracy: 38/809 (4.6972%)
___Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   2, Avg loss: 0.0287, Accuracy: 340/809 (42.0272%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.1623, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   1, Avg loss: 0.0887, Accuracy: 65/1013 (6.4166%)
___Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   2, Avg loss: 0.0370, Accuracy: 406/1013 (40.0790%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.9625, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   1, Avg loss: 0.0820, Accuracy: 175/1190 (14.7059%)
___Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 477/1190 (40.0840%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.8624, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0794, Accuracy: 181/1513 (11.9630%)
___Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 524/1513 (34.6332%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.5340, Accuracy: 96/10000 (0.9600%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   1, Avg loss: 0.0833, Accuracy: 101/690 (14.6377%)
___Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 461/690 (66.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 10.3188, Accuracy: 69/10000 (0.6900%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0556, Accuracy: 428/1628 (26.2899%)
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0207, Accuracy: 1023/1628 (62.8378%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 9.0565, Accuracy: 158/10000 (1.5800%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0741, Accuracy: 244/1573 (15.5118%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0358, Accuracy: 587/1573 (37.3172%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.8024, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   1, Avg loss: 0.1116, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   2, Avg loss: 0.0663, Accuracy: 40/373 (10.7239%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 6.5726, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   1, Avg loss: 0.0788, Accuracy: 171/1241 (13.7792%)
___Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 474/1241 (38.1950%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 7.7302, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0904, Accuracy: 67/590 (11.3559%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0402, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 53: Avg loss: 12.4557, Accuracy: 50/10000 (0.5000%)
time spent on training: 206.44294357299805
___Test Target_ResNet_18 poisoned: False, epoch: 53: Avg loss: 6.7957, Accuracy: 98/10000 (0.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 53: Avg loss: 1.3084, Accuracy: 6252/9950 (62.8342%)
saving model
Done in 440.70215034484863 sec.
Server Epoch:54 choose agents : [72, 22, 50, 1, 38, 36, 52, 32, 73, 85].
___Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   1, Avg loss: 0.0756, Accuracy: 175/1241 (14.1015%)
___Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 475/1241 (38.2756%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 7.7317, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   1, Avg loss: 0.0624, Accuracy: 387/1470 (26.3265%)
___Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   2, Avg loss: 0.0249, Accuracy: 915/1470 (62.2449%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.4485, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   1, Avg loss: 0.0821, Accuracy: 45/809 (5.5624%)
___Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   2, Avg loss: 0.0279, Accuracy: 352/809 (43.5105%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.1914, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0746, Accuracy: 189/928 (20.3664%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0247, Accuracy: 607/928 (65.4095%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.3066, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0787, Accuracy: 151/1131 (13.3510%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0299, Accuracy: 536/1131 (47.3917%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.2135, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   1, Avg loss: 0.1147, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   2, Avg loss: 0.0651, Accuracy: 89/408 (21.8137%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.9013, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0860, Accuracy: 80/636 (12.5786%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0361, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 9.2456, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   1, Avg loss: 0.0527, Accuracy: 169/735 (22.9932%)
___Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   2, Avg loss: 0.0195, Accuracy: 378/735 (51.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 10.1313, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   1, Avg loss: 0.0802, Accuracy: 108/938 (11.5139%)
___Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   2, Avg loss: 0.0342, Accuracy: 364/938 (38.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.0983, Accuracy: 82/10000 (0.8200%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   1, Avg loss: 0.0329, Accuracy: 815/1988 (40.9960%)
___Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   2, Avg loss: 0.0289, Accuracy: 897/1988 (45.1207%)
___Test Local_ResNet_18 poisoned: False, epoch: 54: Avg loss: 8.1083, Accuracy: 109/10000 (1.0900%)
time spent on training: 193.50989294052124
___Test Target_ResNet_18 poisoned: False, epoch: 54: Avg loss: 6.6247, Accuracy: 92/10000 (0.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 54: Avg loss: 1.3820, Accuracy: 6186/9950 (62.1709%)
saving model
Done in 435.1334731578827 sec.
Server Epoch:55 choose agents : [33, 58, 47, 9, 19, 26, 45, 81, 95, 56].
___Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   1, Avg loss: 0.1075, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   2, Avg loss: 0.0617, Accuracy: 110/515 (21.3592%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.8719, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0690, Accuracy: 175/803 (21.7933%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0366, Accuracy: 442/803 (55.0436%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.3448, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   1, Avg loss: 0.1599, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   2, Avg loss: 0.1428, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.3447, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   1, Avg loss: 0.0569, Accuracy: 236/1275 (18.5098%)
___Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   2, Avg loss: 0.0172, Accuracy: 779/1275 (61.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 10.1525, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   1, Avg loss: 0.0659, Accuracy: 257/1036 (24.8069%)
___Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   2, Avg loss: 0.0226, Accuracy: 732/1036 (70.6564%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 11.9179, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0611, Accuracy: 265/1446 (18.3264%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0342, Accuracy: 547/1446 (37.8285%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.6710, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   1, Avg loss: 0.0901, Accuracy: 38/669 (5.6801%)
___Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   2, Avg loss: 0.0440, Accuracy: 354/669 (52.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.2875, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   1, Avg loss: 0.0829, Accuracy: 86/774 (11.1111%)
___Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   2, Avg loss: 0.0345, Accuracy: 398/774 (51.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 7.9293, Accuracy: 84/10000 (0.8400%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   1, Avg loss: 0.1071, Accuracy: 24/599 (4.0067%)
___Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   2, Avg loss: 0.0279, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 12.9399, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   1, Avg loss: 0.1170, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   2, Avg loss: 0.0997, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.3792, Accuracy: 102/10000 (1.0200%)
time spent on training: 169.7097852230072
___Test Target_ResNet_18 poisoned: False, epoch: 55: Avg loss: 6.4910, Accuracy: 96/10000 (0.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 55: Avg loss: 1.4618, Accuracy: 6099/9950 (61.2965%)
saving model
Done in 398.1796271800995 sec.
Server Epoch:56 choose agents : [98, 9, 8, 25, 64, 74, 90, 19, 66, 92].
___Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   1, Avg loss: 0.0985, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   2, Avg loss: 0.0596, Accuracy: 58/373 (15.5496%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.5017, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   1, Avg loss: 0.0544, Accuracy: 262/1275 (20.5490%)
___Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   2, Avg loss: 0.0172, Accuracy: 774/1275 (60.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 10.2000, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   1, Avg loss: 0.0728, Accuracy: 203/1513 (13.4171%)
___Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 539/1513 (35.6246%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.5507, Accuracy: 115/10000 (1.1500%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0726, Accuracy: 128/690 (18.5507%)
___Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0253, Accuracy: 467/690 (67.6812%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 9.5105, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   1, Avg loss: 0.0810, Accuracy: 67/953 (7.0304%)
___Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   2, Avg loss: 0.0396, Accuracy: 337/953 (35.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.3020, Accuracy: 72/10000 (0.7200%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   1, Avg loss: 0.0494, Accuracy: 451/1552 (29.0593%)
___Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   2, Avg loss: 0.0188, Accuracy: 862/1552 (55.5412%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 10.6024, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   1, Avg loss: 0.0770, Accuracy: 105/677 (15.5096%)
___Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   2, Avg loss: 0.0246, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 10.4268, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   1, Avg loss: 0.0623, Accuracy: 246/1036 (23.7452%)
___Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   2, Avg loss: 0.0219, Accuracy: 733/1036 (70.7529%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 11.7669, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   1, Avg loss: 0.0774, Accuracy: 171/1402 (12.1969%)
___Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   2, Avg loss: 0.0395, Accuracy: 452/1402 (32.2397%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 7.3973, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   1, Avg loss: 0.0637, Accuracy: 342/1715 (19.9417%)
___Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   2, Avg loss: 0.0291, Accuracy: 819/1715 (47.7551%)
___Test Local_ResNet_18 poisoned: False, epoch: 56: Avg loss: 8.2355, Accuracy: 118/10000 (1.1800%)
time spent on training: 211.87965989112854
___Test Target_ResNet_18 poisoned: False, epoch: 56: Avg loss: 6.3285, Accuracy: 98/10000 (0.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 56: Avg loss: 1.5098, Accuracy: 6093/9950 (61.2362%)
saving model
Done in 446.12565445899963 sec.
Server Epoch:57 choose agents : [16, 72, 14, 32, 55, 48, 98, 56, 85, 95].
___Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   1, Avg loss: 0.0781, Accuracy: 116/708 (16.3842%)
___Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   2, Avg loss: 0.0446, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.6054, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   1, Avg loss: 0.0698, Accuracy: 200/1241 (16.1160%)
___Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 482/1241 (38.8396%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.5547, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   1, Avg loss: 0.0781, Accuracy: 90/1013 (8.8845%)
___Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 412/1013 (40.6713%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.9919, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0480, Accuracy: 201/735 (27.3469%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0186, Accuracy: 393/735 (53.4694%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 9.8714, Accuracy: 82/10000 (0.8200%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 232/1071 (21.6620%)
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0255, Accuracy: 591/1071 (55.1821%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 8.8871, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.0948, Accuracy: 0/631 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0493, Accuracy: 222/631 (35.1823%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.1511, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   1, Avg loss: 0.0950, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   2, Avg loss: 0.0571, Accuracy: 68/373 (18.2306%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.4782, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.1086, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0930, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.1602, Accuracy: 95/10000 (0.9500%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   1, Avg loss: 0.0344, Accuracy: 780/1988 (39.2354%)
___Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   2, Avg loss: 0.0299, Accuracy: 886/1988 (44.5674%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 7.9035, Accuracy: 111/10000 (1.1100%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   1, Avg loss: 0.0994, Accuracy: 51/599 (8.5142%)
___Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   2, Avg loss: 0.0267, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 57: Avg loss: 12.5253, Accuracy: 50/10000 (0.5000%)
time spent on training: 202.10662055015564
___Test Target_ResNet_18 poisoned: False, epoch: 57: Avg loss: 6.2457, Accuracy: 100/10000 (1.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 57: Avg loss: 1.5221, Accuracy: 6139/9950 (61.6985%)
saving model
Done in 446.184287071228 sec.
Server Epoch:58 choose agents : [84, 53, 38, 31, 8, 47, 67, 4, 87, 88].
___Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   1, Avg loss: 0.0722, Accuracy: 201/1190 (16.8908%)
___Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   2, Avg loss: 0.0315, Accuracy: 495/1190 (41.5966%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.6674, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   1, Avg loss: 0.0617, Accuracy: 152/813 (18.6962%)
___Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 449/813 (55.2276%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 12.1089, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   1, Avg loss: 0.0711, Accuracy: 172/1131 (15.2078%)
___Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   2, Avg loss: 0.0295, Accuracy: 567/1131 (50.1326%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.1452, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.1075, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0487, Accuracy: 127/460 (27.6087%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.1755, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   1, Avg loss: 0.0697, Accuracy: 194/1513 (12.8222%)
___Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   2, Avg loss: 0.0358, Accuracy: 554/1513 (36.6160%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.5424, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1471, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1348, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.0723, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0959, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0515, Accuracy: 121/426 (28.4038%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.8683, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0773, Accuracy: 190/901 (21.0877%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0362, Accuracy: 446/901 (49.5006%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.2168, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   1, Avg loss: 0.0700, Accuracy: 197/1131 (17.4182%)
___Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   2, Avg loss: 0.0323, Accuracy: 415/1131 (36.6932%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 8.0213, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0817, Accuracy: 39/603 (6.4677%)
___Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 287/603 (47.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 58: Avg loss: 7.4310, Accuracy: 68/10000 (0.6800%)
time spent on training: 170.17476272583008
___Test Target_ResNet_18 poisoned: False, epoch: 58: Avg loss: 6.1375, Accuracy: 101/10000 (1.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 58: Avg loss: 1.5628, Accuracy: 6153/9950 (61.8392%)
saving model
Done in 407.5924804210663 sec.
Server Epoch:59 choose agents : [82, 74, 11, 41, 40, 36, 95, 87, 23, 32].
___Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0944, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0545, Accuracy: 143/500 (28.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.9086, Accuracy: 70/10000 (0.7000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0456, Accuracy: 467/1552 (30.0902%)
___Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0186, Accuracy: 871/1552 (56.1211%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 10.4377, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   1, Avg loss: 0.0749, Accuracy: 123/712 (17.2753%)
___Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 459/712 (64.4663%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.2189, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   1, Avg loss: 0.0781, Accuracy: 141/719 (19.6106%)
___Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   2, Avg loss: 0.0385, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.4235, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0655, Accuracy: 267/1573 (16.9739%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 615/1573 (39.0973%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 7.5627, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.0982, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0590, Accuracy: 107/408 (26.2255%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.7740, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   1, Avg loss: 0.0933, Accuracy: 62/599 (10.3506%)
___Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   2, Avg loss: 0.0314, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 12.9184, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   1, Avg loss: 0.0679, Accuracy: 208/1131 (18.3908%)
___Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 461/1131 (40.7604%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 8.1583, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0842, Accuracy: 119/715 (16.6434%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0436, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.5074, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   1, Avg loss: 0.0472, Accuracy: 194/735 (26.3946%)
___Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   2, Avg loss: 0.0191, Accuracy: 375/735 (51.0204%)
___Test Local_ResNet_18 poisoned: False, epoch: 59: Avg loss: 9.6535, Accuracy: 74/10000 (0.7400%)
time spent on training: 195.01140236854553
___Test Target_ResNet_18 poisoned: False, epoch: 59: Avg loss: 6.0491, Accuracy: 101/10000 (1.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 59: Avg loss: 1.5706, Accuracy: 6216/9950 (62.4724%)
saving model
Done in 430.9064314365387 sec.
Server Epoch:60 choose agents : [28, 39, 27, 81, 97, 7, 47, 24, 49, 88].
___Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   1, Avg loss: 0.0590, Accuracy: 306/1581 (19.3548%)
___Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   2, Avg loss: 0.0323, Accuracy: 634/1581 (40.1012%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.6105, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   1, Avg loss: 0.0675, Accuracy: 162/1013 (15.9921%)
___Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 501/1013 (49.4571%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 9.1969, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   1, Avg loss: 0.0657, Accuracy: 294/1587 (18.5255%)
___Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 662/1587 (41.7139%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.5192, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   1, Avg loss: 0.0740, Accuracy: 117/774 (15.1163%)
___Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   2, Avg loss: 0.0349, Accuracy: 408/774 (52.7132%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.1091, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0627, Accuracy: 222/1213 (18.3017%)
___Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 578/1213 (47.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.7649, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   1, Avg loss: 0.0692, Accuracy: 196/891 (21.9978%)
___Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   2, Avg loss: 0.0284, Accuracy: 473/891 (53.0864%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 8.6216, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   1, Avg loss: 0.1408, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   2, Avg loss: 0.1302, Accuracy: 1/134 (0.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 5.9273, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0870, Accuracy: 1/312 (0.3205%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0509, Accuracy: 85/312 (27.2436%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.5660, Accuracy: 50/10000 (0.5000%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   1, Avg loss: 0.0835, Accuracy: 0/440 (0.0000%)
___Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   2, Avg loss: 0.0491, Accuracy: 107/440 (24.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 6.4783, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0778, Accuracy: 63/603 (10.4478%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0479, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 60: Avg loss: 7.5450, Accuracy: 68/10000 (0.6800%)
time spent on training: 186.54009175300598
___Test Target_ResNet_18 poisoned: False, epoch: 60: Avg loss: 5.9770, Accuracy: 104/10000 (1.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 60: Avg loss: 1.6057, Accuracy: 6223/9950 (62.5427%)
saving model
Saving model on epoch 60
Done in 427.8820266723633 sec.
Server Epoch:61 choose agents : [63, 97, 61, 60, 55, 87, 50, 72, 14, 64].
___Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   1, Avg loss: 0.0696, Accuracy: 138/888 (15.5405%)
___Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 428/888 (48.1982%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 9.5042, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   1, Avg loss: 0.0612, Accuracy: 237/1213 (19.5383%)
___Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   2, Avg loss: 0.0268, Accuracy: 588/1213 (48.4749%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.8422, Accuracy: 93/10000 (0.9300%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   1, Avg loss: 0.1321, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   2, Avg loss: 0.1242, Accuracy: 1/85 (1.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 5.9473, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   1, Avg loss: 0.0573, Accuracy: 559/2227 (25.1010%)
___Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   2, Avg loss: 0.0273, Accuracy: 1086/2227 (48.7652%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.9280, Accuracy: 133/10000 (1.3300%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0526, Accuracy: 265/1071 (24.7432%)
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0253, Accuracy: 587/1071 (54.8086%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.6842, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   1, Avg loss: 0.0658, Accuracy: 217/1131 (19.1866%)
___Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   2, Avg loss: 0.0322, Accuracy: 412/1131 (36.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.1084, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0697, Accuracy: 75/809 (9.2707%)
___Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0268, Accuracy: 380/809 (46.9716%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 8.9887, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   1, Avg loss: 0.0654, Accuracy: 214/1241 (17.2442%)
___Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   2, Avg loss: 0.0357, Accuracy: 497/1241 (40.0483%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.6214, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   1, Avg loss: 0.0732, Accuracy: 109/1013 (10.7601%)
___Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   2, Avg loss: 0.0351, Accuracy: 410/1013 (40.4738%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.8898, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   1, Avg loss: 0.0737, Accuracy: 83/953 (8.7093%)
___Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   2, Avg loss: 0.0384, Accuracy: 349/953 (36.6212%)
___Test Local_ResNet_18 poisoned: False, epoch: 61: Avg loss: 7.4325, Accuracy: 83/10000 (0.8300%)
time spent on training: 215.6962616443634
___Test Target_ResNet_18 poisoned: False, epoch: 61: Avg loss: 5.8960, Accuracy: 105/10000 (1.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 61: Avg loss: 1.5999, Accuracy: 6365/9950 (63.9698%)
saving model
Done in 452.9817817211151 sec.
Server Epoch:62 choose agents : [82, 13, 98, 85, 60, 29, 45, 7, 66, 63].
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0897, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0523, Accuracy: 162/500 (32.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.7533, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0606, Accuracy: 322/1645 (19.5745%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0312, Accuracy: 709/1645 (43.1003%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.0411, Accuracy: 138/10000 (1.3800%)
___Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   1, Avg loss: 0.0856, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   2, Avg loss: 0.0534, Accuracy: 87/373 (23.3244%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 6.3849, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   1, Avg loss: 0.0346, Accuracy: 776/1988 (39.0342%)
___Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   2, Avg loss: 0.0293, Accuracy: 909/1988 (45.7243%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.8608, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0563, Accuracy: 533/2227 (23.9335%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0272, Accuracy: 1049/2227 (47.1037%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.9174, Accuracy: 135/10000 (1.3500%)
___Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0572, Accuracy: 327/1440 (22.7083%)
___Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0272, Accuracy: 808/1440 (56.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.6430, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   1, Avg loss: 0.0772, Accuracy: 79/669 (11.8087%)
___Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   2, Avg loss: 0.0413, Accuracy: 361/669 (53.9611%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.1238, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   1, Avg loss: 0.0670, Accuracy: 203/891 (22.7834%)
___Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   2, Avg loss: 0.0277, Accuracy: 484/891 (54.3210%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 8.5853, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   1, Avg loss: 0.0703, Accuracy: 211/1402 (15.0499%)
___Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   2, Avg loss: 0.0392, Accuracy: 436/1402 (31.0984%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 7.3539, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0674, Accuracy: 147/888 (16.5541%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 411/888 (46.2838%)
___Test Local_ResNet_18 poisoned: False, epoch: 62: Avg loss: 9.5399, Accuracy: 101/10000 (1.0100%)
time spent on training: 218.7289333343506
___Test Target_ResNet_18 poisoned: False, epoch: 62: Avg loss: 5.8392, Accuracy: 104/10000 (1.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 62: Avg loss: 1.6424, Accuracy: 6355/9950 (63.8693%)
saving model
Done in 453.8245196342468 sec.
Server Epoch:63 choose agents : [14, 81, 97, 91, 28, 94, 4, 35, 25, 39].
___Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   1, Avg loss: 0.0704, Accuracy: 127/1013 (12.5370%)
___Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   2, Avg loss: 0.0347, Accuracy: 423/1013 (41.7572%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.8673, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   1, Avg loss: 0.0709, Accuracy: 136/774 (17.5711%)
___Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   2, Avg loss: 0.0359, Accuracy: 390/774 (50.3876%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.0363, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   1, Avg loss: 0.0591, Accuracy: 256/1213 (21.1047%)
___Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   2, Avg loss: 0.0269, Accuracy: 574/1213 (47.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.2589, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   1, Avg loss: 0.0596, Accuracy: 288/1030 (27.9612%)
___Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   2, Avg loss: 0.0227, Accuracy: 683/1030 (66.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.5337, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   1, Avg loss: 0.0568, Accuracy: 327/1581 (20.6831%)
___Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   2, Avg loss: 0.0314, Accuracy: 669/1581 (42.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.5880, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0628, Accuracy: 290/1662 (17.4489%)
___Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0317, Accuracy: 696/1662 (41.8773%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.0185, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0685, Accuracy: 218/901 (24.1953%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0351, Accuracy: 422/901 (46.8368%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 7.9885, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.1030, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0698, Accuracy: 23/271 (8.4871%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 5.9183, Accuracy: 73/10000 (0.7300%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0630, Accuracy: 171/690 (24.7826%)
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0240, Accuracy: 466/690 (67.5362%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 9.4144, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   1, Avg loss: 0.0645, Accuracy: 174/1013 (17.1767%)
___Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   2, Avg loss: 0.0266, Accuracy: 493/1013 (48.6673%)
___Test Local_ResNet_18 poisoned: False, epoch: 63: Avg loss: 8.8947, Accuracy: 80/10000 (0.8000%)
time spent on training: 202.98417162895203
___Test Target_ResNet_18 poisoned: False, epoch: 63: Avg loss: 5.7826, Accuracy: 104/10000 (1.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 63: Avg loss: 1.6893, Accuracy: 6367/9950 (63.9899%)
saving model
Done in 440.5867850780487 sec.
Server Epoch:64 choose agents : [81, 71, 22, 76, 45, 30, 66, 5, 69, 70].
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0692, Accuracy: 146/774 (18.8630%)
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0350, Accuracy: 395/774 (51.0336%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.6876, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0681, Accuracy: 109/818 (13.3252%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0296, Accuracy: 403/818 (49.2665%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.3236, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0533, Accuracy: 437/1470 (29.7279%)
___Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 900/1470 (61.2245%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 9.2596, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 10/466 (2.1459%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 190/466 (40.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.1601, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.0754, Accuracy: 84/669 (12.5561%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0386, Accuracy: 356/669 (53.2138%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.0262, Accuracy: 80/10000 (0.8000%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.0781, Accuracy: 18/486 (3.7037%)
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0381, Accuracy: 209/486 (43.0041%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.8764, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   1, Avg loss: 0.0689, Accuracy: 204/1402 (14.5506%)
___Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 466/1402 (33.2382%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 7.4026, Accuracy: 86/10000 (0.8600%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   1, Avg loss: 0.0460, Accuracy: 513/1628 (31.5111%)
___Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   2, Avg loss: 0.0202, Accuracy: 1005/1628 (61.7322%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.9742, Accuracy: 172/10000 (1.7200%)
___Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   1, Avg loss: 0.0683, Accuracy: 148/590 (25.0847%)
___Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   2, Avg loss: 0.0322, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 10.7488, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0602, Accuracy: 334/1418 (23.5543%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0301, Accuracy: 745/1418 (52.5388%)
___Test Local_ResNet_18 poisoned: False, epoch: 64: Avg loss: 8.0915, Accuracy: 98/10000 (0.9800%)
time spent on training: 213.99458742141724
___Test Target_ResNet_18 poisoned: False, epoch: 64: Avg loss: 5.7317, Accuracy: 105/10000 (1.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 64: Avg loss: 1.7375, Accuracy: 6378/9950 (64.1005%)
saving model
Done in 448.07654309272766 sec.
Server Epoch:65 choose agents : [78, 89, 90, 16, 68, 76, 57, 27, 83, 41].
___Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   1, Avg loss: 0.0867, Accuracy: 8/416 (1.9231%)
___Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   2, Avg loss: 0.0487, Accuracy: 174/416 (41.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 6.5547, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   1, Avg loss: 0.0662, Accuracy: 216/896 (24.1071%)
___Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   2, Avg loss: 0.0351, Accuracy: 483/896 (53.9062%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.3663, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   1, Avg loss: 0.0653, Accuracy: 175/677 (25.8493%)
___Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 464/677 (68.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 10.1233, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   1, Avg loss: 0.0730, Accuracy: 153/708 (21.6102%)
___Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   2, Avg loss: 0.0395, Accuracy: 429/708 (60.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.3043, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0712, Accuracy: 241/1163 (20.7223%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0375, Accuracy: 491/1163 (42.2184%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.1951, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0831, Accuracy: 12/466 (2.5751%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0485, Accuracy: 187/466 (40.1288%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.1479, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0607, Accuracy: 217/1154 (18.8042%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0247, Accuracy: 578/1154 (50.0867%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 9.7571, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0626, Accuracy: 337/1587 (21.2350%)
___Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0331, Accuracy: 673/1587 (42.4071%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.4941, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0574, Accuracy: 409/1953 (20.9421%)
___Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0314, Accuracy: 923/1953 (47.2606%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 7.3453, Accuracy: 147/10000 (1.4700%)
___Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   1, Avg loss: 0.0710, Accuracy: 174/719 (24.2003%)
___Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   2, Avg loss: 0.0369, Accuracy: 468/719 (65.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 65: Avg loss: 8.4277, Accuracy: 50/10000 (0.5000%)
time spent on training: 191.59240198135376
___Test Target_ResNet_18 poisoned: False, epoch: 65: Avg loss: 5.6872, Accuracy: 105/10000 (1.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 65: Avg loss: 1.7743, Accuracy: 6400/9950 (64.3216%)
saving model
Done in 422.3946602344513 sec.
Server Epoch:66 choose agents : [38, 88, 33, 43, 14, 18, 98, 35, 78, 86].
___Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   1, Avg loss: 0.0643, Accuracy: 203/1131 (17.9487%)
___Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   2, Avg loss: 0.0292, Accuracy: 513/1131 (45.3581%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.9457, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0714, Accuracy: 88/603 (14.5937%)
___Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0452, Accuracy: 285/603 (47.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.4182, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   1, Avg loss: 0.0892, Accuracy: 12/515 (2.3301%)
___Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   2, Avg loss: 0.0618, Accuracy: 126/515 (24.4660%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.4269, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   1, Avg loss: 0.0706, Accuracy: 163/946 (17.2304%)
___Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   2, Avg loss: 0.0376, Accuracy: 360/946 (38.0550%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.1607, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   1, Avg loss: 0.0682, Accuracy: 122/1013 (12.0434%)
___Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   2, Avg loss: 0.0343, Accuracy: 422/1013 (41.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.8650, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0816, Accuracy: 19/530 (3.5849%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0381, Accuracy: 279/530 (52.6415%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 8.3394, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   1, Avg loss: 0.0812, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   2, Avg loss: 0.0508, Accuracy: 99/373 (26.5416%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.3177, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   1, Avg loss: 0.0987, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   2, Avg loss: 0.0684, Accuracy: 41/271 (15.1292%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.8839, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0855, Accuracy: 12/416 (2.8846%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0478, Accuracy: 186/416 (44.7115%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 6.5213, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0654, Accuracy: 238/1003 (23.7288%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0356, Accuracy: 400/1003 (39.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 66: Avg loss: 7.4159, Accuracy: 64/10000 (0.6400%)
time spent on training: 162.3541407585144
___Test Target_ResNet_18 poisoned: False, epoch: 66: Avg loss: 5.6557, Accuracy: 105/10000 (1.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 66: Avg loss: 1.7875, Accuracy: 6499/9950 (65.3166%)
saving model
Done in 393.1852355003357 sec.
Server Epoch:67 choose agents : [94, 13, 95, 73, 30, 22, 25, 10, 86, 8].
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0607, Accuracy: 295/1662 (17.7497%)
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0316, Accuracy: 673/1662 (40.4934%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.8221, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0577, Accuracy: 320/1645 (19.4529%)
___Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0303, Accuracy: 723/1645 (43.9514%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.0540, Accuracy: 127/10000 (1.2700%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0839, Accuracy: 108/599 (18.0301%)
___Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0301, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 12.7103, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0668, Accuracy: 147/938 (15.6716%)
___Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 344/938 (36.6738%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 8.4573, Accuracy: 83/10000 (0.8300%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   1, Avg loss: 0.0754, Accuracy: 32/486 (6.5844%)
___Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   2, Avg loss: 0.0376, Accuracy: 214/486 (44.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.7881, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   1, Avg loss: 0.0516, Accuracy: 429/1470 (29.1837%)
___Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 913/1470 (62.1088%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.0170, Accuracy: 119/10000 (1.1900%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   1, Avg loss: 0.0586, Accuracy: 189/690 (27.3913%)
___Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   2, Avg loss: 0.0233, Accuracy: 470/690 (68.1159%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.6238, Accuracy: 86/10000 (0.8600%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   1, Avg loss: 0.0638, Accuracy: 161/861 (18.6992%)
___Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   2, Avg loss: 0.0191, Accuracy: 514/861 (59.6980%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 9.7634, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0652, Accuracy: 236/1003 (23.5294%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0353, Accuracy: 410/1003 (40.8774%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.4294, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   1, Avg loss: 0.0637, Accuracy: 237/1513 (15.6642%)
___Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   2, Avg loss: 0.0354, Accuracy: 563/1513 (37.2108%)
___Test Local_ResNet_18 poisoned: False, epoch: 67: Avg loss: 7.5249, Accuracy: 114/10000 (1.1400%)
time spent on training: 245.75878715515137
___Test Target_ResNet_18 poisoned: False, epoch: 67: Avg loss: 5.6168, Accuracy: 106/10000 (1.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 67: Avg loss: 1.7928, Accuracy: 6639/9950 (66.7236%)
saving model
Done in 474.8680386543274 sec.
Server Epoch:68 choose agents : [83, 52, 97, 44, 67, 7, 87, 76, 46, 17].
___Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0561, Accuracy: 430/1953 (22.0174%)
___Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0308, Accuracy: 967/1953 (49.5136%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.5427, Accuracy: 151/10000 (1.5100%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0670, Accuracy: 154/636 (24.2138%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0314, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.9721, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   1, Avg loss: 0.0566, Accuracy: 278/1213 (22.9184%)
___Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   2, Avg loss: 0.0261, Accuracy: 612/1213 (50.4534%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.6819, Accuracy: 103/10000 (1.0300%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0511, Accuracy: 486/1750 (27.7714%)
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0305, Accuracy: 856/1750 (48.9143%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.5560, Accuracy: 147/10000 (1.4700%)
___Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   1, Avg loss: 0.0837, Accuracy: 1/426 (0.2347%)
___Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   2, Avg loss: 0.0474, Accuracy: 157/426 (36.8545%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 6.7712, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   1, Avg loss: 0.0623, Accuracy: 226/891 (25.3648%)
___Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 494/891 (55.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.6948, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0609, Accuracy: 247/1131 (21.8391%)
___Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0316, Accuracy: 413/1131 (36.5164%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.0983, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   1, Avg loss: 0.0808, Accuracy: 28/466 (6.0086%)
___Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   2, Avg loss: 0.0490, Accuracy: 187/466 (40.1288%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.3036, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   1, Avg loss: 0.0586, Accuracy: 411/1904 (21.5861%)
___Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   2, Avg loss: 0.0291, Accuracy: 848/1904 (44.5378%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 7.7309, Accuracy: 141/10000 (1.4100%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0575, Accuracy: 342/1574 (21.7281%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0259, Accuracy: 730/1574 (46.3787%)
___Test Local_ResNet_18 poisoned: False, epoch: 68: Avg loss: 8.5181, Accuracy: 144/10000 (1.4400%)
time spent on training: 226.49755215644836
___Test Target_ResNet_18 poisoned: False, epoch: 68: Avg loss: 5.5843, Accuracy: 105/10000 (1.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 68: Avg loss: 1.8199, Accuracy: 6723/9950 (67.5678%)
saving model
Done in 459.8764805793762 sec.
Server Epoch:69 choose agents : [90, 24, 28, 70, 52, 97, 11, 21, 20, 62].
___Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   1, Avg loss: 0.0626, Accuracy: 184/677 (27.1787%)
___Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 465/677 (68.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.9072, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   1, Avg loss: 0.0789, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   2, Avg loss: 0.0470, Accuracy: 119/312 (38.1410%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 6.4078, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   1, Avg loss: 0.0547, Accuracy: 382/1581 (24.1619%)
___Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   2, Avg loss: 0.0313, Accuracy: 716/1581 (45.2878%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.5877, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0582, Accuracy: 380/1418 (26.7983%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 714/1418 (50.3526%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.9158, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   1, Avg loss: 0.0658, Accuracy: 161/636 (25.3145%)
___Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   2, Avg loss: 0.0309, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.6700, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   1, Avg loss: 0.0553, Accuracy: 294/1213 (24.2374%)
___Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   2, Avg loss: 0.0261, Accuracy: 606/1213 (49.9588%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.7867, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   1, Avg loss: 0.0657, Accuracy: 181/712 (25.4213%)
___Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   2, Avg loss: 0.0255, Accuracy: 445/712 (62.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 9.4912, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0571, Accuracy: 377/1949 (19.3433%)
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0319, Accuracy: 693/1949 (35.5567%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 8.0459, Accuracy: 94/10000 (0.9400%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0711, Accuracy: 162/807 (20.0743%)
___Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0331, Accuracy: 434/807 (53.7794%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.5418, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   1, Avg loss: 0.0659, Accuracy: 100/568 (17.6056%)
___Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   2, Avg loss: 0.0409, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 69: Avg loss: 7.2909, Accuracy: 57/10000 (0.5700%)
time spent on training: 206.97280097007751
___Test Target_ResNet_18 poisoned: False, epoch: 69: Avg loss: 5.5631, Accuracy: 105/10000 (1.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 69: Avg loss: 1.8339, Accuracy: 6790/9950 (68.2412%)
saving model
Done in 439.7839639186859 sec.
Server Epoch:70 choose agents : [75, 24, 36, 52, 95, 82, 93, 97, 6, 81].
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0655, Accuracy: 159/776 (20.4897%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0268, Accuracy: 441/776 (56.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.3398, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   1, Avg loss: 0.0778, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   2, Avg loss: 0.0459, Accuracy: 134/312 (42.9487%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.4028, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.0862, Accuracy: 5/408 (1.2255%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0529, Accuracy: 145/408 (35.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.5769, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   1, Avg loss: 0.0640, Accuracy: 178/636 (27.9874%)
___Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   2, Avg loss: 0.0303, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.4406, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   1, Avg loss: 0.0807, Accuracy: 118/599 (19.6995%)
___Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   2, Avg loss: 0.0256, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 12.0363, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   1, Avg loss: 0.0818, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   2, Avg loss: 0.0497, Accuracy: 212/500 (42.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 6.9537, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   1, Avg loss: 0.0580, Accuracy: 420/1742 (24.1102%)
___Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   2, Avg loss: 0.0297, Accuracy: 776/1742 (44.5465%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.2531, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0547, Accuracy: 316/1213 (26.0511%)
___Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0261, Accuracy: 583/1213 (48.0627%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 8.7454, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0579, Accuracy: 371/1956 (18.9673%)
___Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0293, Accuracy: 791/1956 (40.4397%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.8998, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   1, Avg loss: 0.0675, Accuracy: 177/774 (22.8682%)
___Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   2, Avg loss: 0.0346, Accuracy: 404/774 (52.1964%)
___Test Local_ResNet_18 poisoned: False, epoch: 70: Avg loss: 7.7064, Accuracy: 76/10000 (0.7600%)
time spent on training: 198.15689253807068
___Test Target_ResNet_18 poisoned: False, epoch: 70: Avg loss: 5.5410, Accuracy: 112/10000 (1.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 70: Avg loss: 1.8474, Accuracy: 6858/9950 (68.9246%)
saving model
Done in 436.1953778266907 sec.
Server Epoch:71 choose agents : [88, 8, 87, 89, 65, 19, 11, 23, 49, 57].
___Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   1, Avg loss: 0.0707, Accuracy: 108/603 (17.9104%)
___Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   2, Avg loss: 0.0434, Accuracy: 286/603 (47.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.1494, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   1, Avg loss: 0.0613, Accuracy: 256/1513 (16.9200%)
___Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   2, Avg loss: 0.0349, Accuracy: 554/1513 (36.6160%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.6549, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   1, Avg loss: 0.0595, Accuracy: 262/1131 (23.1653%)
___Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   2, Avg loss: 0.0302, Accuracy: 468/1131 (41.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.9675, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0646, Accuracy: 234/896 (26.1161%)
___Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 488/896 (54.4643%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.2755, Accuracy: 64/10000 (0.6400%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   1, Avg loss: 0.0439, Accuracy: 536/1475 (36.3390%)
___Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   2, Avg loss: 0.0245, Accuracy: 840/1475 (56.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 7.7254, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   1, Avg loss: 0.0523, Accuracy: 353/1036 (34.0734%)
___Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   2, Avg loss: 0.0230, Accuracy: 716/1036 (69.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 11.3593, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   1, Avg loss: 0.0642, Accuracy: 190/712 (26.6854%)
___Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   2, Avg loss: 0.0253, Accuracy: 450/712 (63.2022%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 8.9012, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0742, Accuracy: 175/715 (24.4755%)
___Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0406, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 6.3339, Accuracy: 53/10000 (0.5300%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0737, Accuracy: 2/440 (0.4545%)
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0448, Accuracy: 161/440 (36.5909%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 6.4072, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   1, Avg loss: 0.0600, Accuracy: 250/1154 (21.6638%)
___Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   2, Avg loss: 0.0238, Accuracy: 574/1154 (49.7400%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Avg loss: 9.8707, Accuracy: 99/10000 (0.9900%)
time spent on training: 219.03692889213562
___Test Target_ResNet_18 poisoned: False, epoch: 71: Avg loss: 5.5206, Accuracy: 111/10000 (1.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Avg loss: 1.8586, Accuracy: 6952/9950 (69.8693%)
saving model
Done in 445.860000371933 sec.
Server Epoch:72 choose agents : [78, 58, 7, 87, 5, 96, 28, 39, 91, 22].
___Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   1, Avg loss: 0.0814, Accuracy: 23/416 (5.5288%)
___Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   2, Avg loss: 0.0452, Accuracy: 199/416 (47.8365%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.5021, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   1, Avg loss: 0.0567, Accuracy: 257/803 (32.0050%)
___Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   2, Avg loss: 0.0329, Accuracy: 452/803 (56.2889%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.1213, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0608, Accuracy: 236/891 (26.4871%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 481/891 (53.9843%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.5205, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0586, Accuracy: 273/1131 (24.1379%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0306, Accuracy: 485/1131 (42.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.0083, Accuracy: 62/10000 (0.6200%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   1, Avg loss: 0.0435, Accuracy: 587/1628 (36.0565%)
___Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   2, Avg loss: 0.0198, Accuracy: 1050/1628 (64.4963%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.6716, Accuracy: 170/10000 (1.7000%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0736, Accuracy: 72/311 (23.1511%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0551, Accuracy: 132/311 (42.4437%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 6.2225, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   1, Avg loss: 0.0541, Accuracy: 371/1581 (23.4662%)
___Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   2, Avg loss: 0.0310, Accuracy: 683/1581 (43.2005%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 7.5291, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   1, Avg loss: 0.0597, Accuracy: 214/1013 (21.1254%)
___Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   2, Avg loss: 0.0253, Accuracy: 517/1013 (51.0365%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.9528, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0526, Accuracy: 346/1030 (33.5922%)
___Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0238, Accuracy: 668/1030 (64.8544%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 9.3395, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0500, Accuracy: 508/1470 (34.5578%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0234, Accuracy: 932/1470 (63.4014%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Avg loss: 8.9537, Accuracy: 122/10000 (1.2200%)
time spent on training: 216.159441947937
___Test Target_ResNet_18 poisoned: False, epoch: 72: Avg loss: 5.5047, Accuracy: 111/10000 (1.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Avg loss: 1.8952, Accuracy: 6935/9950 (69.6985%)
saving model
Done in 457.48762822151184 sec.
Server Epoch:73 choose agents : [98, 36, 21, 76, 10, 40, 61, 4, 75, 26].
___Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   1, Avg loss: 0.0780, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   2, Avg loss: 0.0489, Accuracy: 127/373 (34.0483%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.3094, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.0853, Accuracy: 4/408 (0.9804%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0521, Accuracy: 149/408 (36.5196%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.6399, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0563, Accuracy: 382/1949 (19.5998%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0320, Accuracy: 703/1949 (36.0698%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.0533, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   1, Avg loss: 0.0790, Accuracy: 43/466 (9.2275%)
___Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   2, Avg loss: 0.0499, Accuracy: 191/466 (40.9871%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 6.9583, Accuracy: 64/10000 (0.6400%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0608, Accuracy: 176/861 (20.4413%)
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0188, Accuracy: 518/861 (60.1626%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 9.6275, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   1, Avg loss: 0.0594, Accuracy: 299/1573 (19.0083%)
___Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   2, Avg loss: 0.0341, Accuracy: 667/1573 (42.4031%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.6230, Accuracy: 84/10000 (0.8400%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   1, Avg loss: 0.1205, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   2, Avg loss: 0.1176, Accuracy: 4/85 (4.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.5071, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0669, Accuracy: 250/901 (27.7469%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 437/901 (48.5017%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 8.3002, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   1, Avg loss: 0.0658, Accuracy: 173/776 (22.2938%)
___Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   2, Avg loss: 0.0261, Accuracy: 456/776 (58.7629%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.9581, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 309/1446 (21.3693%)
___Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0331, Accuracy: 596/1446 (41.2172%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Avg loss: 7.4885, Accuracy: 95/10000 (0.9500%)
time spent on training: 212.44641947746277
___Test Target_ResNet_18 poisoned: False, epoch: 73: Avg loss: 5.4899, Accuracy: 117/10000 (1.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Avg loss: 1.9157, Accuracy: 6996/9950 (70.3116%)
saving model
Done in 449.260240316391 sec.
Server Epoch:74 choose agents : [23, 32, 65, 40, 44, 4, 84, 94, 14, 70].
___Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   1, Avg loss: 0.0706, Accuracy: 192/715 (26.8531%)
___Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   2, Avg loss: 0.0421, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 6.2333, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   1, Avg loss: 0.0482, Accuracy: 222/735 (30.2041%)
___Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   2, Avg loss: 0.0182, Accuracy: 397/735 (54.0136%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 10.7666, Accuracy: 72/10000 (0.7200%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   1, Avg loss: 0.0437, Accuracy: 572/1475 (38.7797%)
___Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   2, Avg loss: 0.0241, Accuracy: 851/1475 (57.6949%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.6798, Accuracy: 141/10000 (1.4100%)
___Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   1, Avg loss: 0.0591, Accuracy: 343/1573 (21.8055%)
___Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   2, Avg loss: 0.0337, Accuracy: 642/1573 (40.8137%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.3987, Accuracy: 93/10000 (0.9300%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0496, Accuracy: 521/1750 (29.7714%)
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0309, Accuracy: 823/1750 (47.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.5608, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0641, Accuracy: 247/901 (27.4140%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0337, Accuracy: 451/901 (50.0555%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.1660, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   1, Avg loss: 0.0643, Accuracy: 244/1190 (20.5042%)
___Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   2, Avg loss: 0.0297, Accuracy: 517/1190 (43.4454%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 7.6247, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   1, Avg loss: 0.0581, Accuracy: 355/1662 (21.3598%)
___Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   2, Avg loss: 0.0310, Accuracy: 720/1662 (43.3213%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.1156, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   1, Avg loss: 0.0653, Accuracy: 148/1013 (14.6101%)
___Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   2, Avg loss: 0.0336, Accuracy: 429/1013 (42.3495%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.0905, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 410/1418 (28.9140%)
___Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   2, Avg loss: 0.0287, Accuracy: 737/1418 (51.9746%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Avg loss: 8.0788, Accuracy: 110/10000 (1.1000%)
time spent on training: 252.9218351840973
___Test Target_ResNet_18 poisoned: False, epoch: 74: Avg loss: 5.4731, Accuracy: 119/10000 (1.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Avg loss: 1.8897, Accuracy: 7173/9950 (72.0905%)
saving model
Done in 492.72827792167664 sec.
Server Epoch:75 choose agents : [74, 11, 45, 65, 75, 59, 52, 1, 15, 25].
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0413, Accuracy: 545/1552 (35.1160%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0181, Accuracy: 874/1552 (56.3144%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 10.2838, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0623, Accuracy: 205/712 (28.7921%)
___Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0257, Accuracy: 459/712 (64.4663%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.1648, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   1, Avg loss: 0.0704, Accuracy: 123/669 (18.3857%)
___Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   2, Avg loss: 0.0380, Accuracy: 361/669 (53.9611%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.0038, Accuracy: 83/10000 (0.8300%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0439, Accuracy: 560/1475 (37.9661%)
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0241, Accuracy: 839/1475 (56.8814%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.8075, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   1, Avg loss: 0.0652, Accuracy: 170/776 (21.9072%)
___Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   2, Avg loss: 0.0255, Accuracy: 457/776 (58.8918%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 7.9161, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   1, Avg loss: 0.0670, Accuracy: 228/1089 (20.9366%)
___Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   2, Avg loss: 0.0241, Accuracy: 593/1089 (54.4536%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.1943, Accuracy: 138/10000 (1.3800%)
___Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   1, Avg loss: 0.0622, Accuracy: 190/636 (29.8742%)
___Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   2, Avg loss: 0.0300, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.3521, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0580, Accuracy: 293/928 (31.5733%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0220, Accuracy: 614/928 (66.1638%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.3734, Accuracy: 112/10000 (1.1200%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   1, Avg loss: 0.0558, Accuracy: 318/1154 (27.5563%)
___Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   2, Avg loss: 0.0260, Accuracy: 601/1154 (52.0797%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 8.5212, Accuracy: 103/10000 (1.0300%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   1, Avg loss: 0.0564, Accuracy: 226/690 (32.7536%)
___Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   2, Avg loss: 0.0228, Accuracy: 469/690 (67.9710%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Avg loss: 9.2613, Accuracy: 91/10000 (0.9100%)
time spent on training: 247.01909852027893
___Test Target_ResNet_18 poisoned: False, epoch: 75: Avg loss: 5.4599, Accuracy: 122/10000 (1.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Avg loss: 1.8954, Accuracy: 7276/9950 (73.1256%)
saving model
Done in 484.48429799079895 sec.
Server Epoch:76 choose agents : [63, 74, 77, 87, 99, 4, 66, 94, 14, 24].
___Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   1, Avg loss: 0.0610, Accuracy: 194/888 (21.8468%)
___Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   2, Avg loss: 0.0247, Accuracy: 461/888 (51.9144%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.4860, Accuracy: 89/10000 (0.8900%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   1, Avg loss: 0.0410, Accuracy: 552/1552 (35.5670%)
___Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   2, Avg loss: 0.0188, Accuracy: 869/1552 (55.9923%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 10.1450, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 297/1340 (22.1642%)
___Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   2, Avg loss: 0.0260, Accuracy: 637/1340 (47.5373%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.6459, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0582, Accuracy: 279/1131 (24.6684%)
___Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0302, Accuracy: 460/1131 (40.6720%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 8.0832, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   1, Avg loss: 0.0733, Accuracy: 144/773 (18.6287%)
___Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   2, Avg loss: 0.0279, Accuracy: 451/773 (58.3441%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 9.4488, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0629, Accuracy: 267/901 (29.6337%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0335, Accuracy: 465/901 (51.6093%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.9275, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   1, Avg loss: 0.0651, Accuracy: 261/1402 (18.6163%)
___Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 439/1402 (31.3124%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.3794, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   1, Avg loss: 0.0576, Accuracy: 348/1662 (20.9386%)
___Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   2, Avg loss: 0.0306, Accuracy: 730/1662 (43.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.8462, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0636, Accuracy: 180/1013 (17.7690%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0335, Accuracy: 422/1013 (41.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 7.9277, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   1, Avg loss: 0.0762, Accuracy: 2/312 (0.6410%)
___Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   2, Avg loss: 0.0453, Accuracy: 149/312 (47.7564%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Avg loss: 6.3961, Accuracy: 50/10000 (0.5000%)
time spent on training: 227.4495894908905
___Test Target_ResNet_18 poisoned: False, epoch: 76: Avg loss: 5.4445, Accuracy: 125/10000 (1.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Avg loss: 1.9292, Accuracy: 7319/9950 (73.5578%)
saving model
Done in 470.18174147605896 sec.
Server Epoch:77 choose agents : [76, 6, 84, 12, 66, 97, 46, 21, 74, 15].
___Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   1, Avg loss: 0.0779, Accuracy: 62/466 (13.3047%)
___Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   2, Avg loss: 0.0463, Accuracy: 202/466 (43.3476%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.0634, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   1, Avg loss: 0.0564, Accuracy: 383/1956 (19.5808%)
___Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   2, Avg loss: 0.0292, Accuracy: 773/1956 (39.5194%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.9520, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   1, Avg loss: 0.0632, Accuracy: 253/1190 (21.2605%)
___Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   2, Avg loss: 0.0295, Accuracy: 534/1190 (44.8739%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.8263, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   1, Avg loss: 0.0897, Accuracy: 10/338 (2.9586%)
___Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   2, Avg loss: 0.0539, Accuracy: 116/338 (34.3195%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 6.1795, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0644, Accuracy: 241/1402 (17.1897%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0377, Accuracy: 463/1402 (33.0243%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.4189, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   1, Avg loss: 0.0531, Accuracy: 303/1213 (24.9794%)
___Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   2, Avg loss: 0.0256, Accuracy: 620/1213 (51.1129%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.6186, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   1, Avg loss: 0.0561, Accuracy: 459/1904 (24.1071%)
___Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   2, Avg loss: 0.0286, Accuracy: 852/1904 (44.7479%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.7905, Accuracy: 150/10000 (1.5000%)
___Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   1, Avg loss: 0.0558, Accuracy: 376/1949 (19.2919%)
___Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   2, Avg loss: 0.0314, Accuracy: 727/1949 (37.3012%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 7.9039, Accuracy: 95/10000 (0.9500%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   1, Avg loss: 0.0404, Accuracy: 579/1552 (37.3067%)
___Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   2, Avg loss: 0.0182, Accuracy: 871/1552 (56.1211%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 10.1145, Accuracy: 100/10000 (1.0000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 356/1154 (30.8492%)
___Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   2, Avg loss: 0.0255, Accuracy: 626/1154 (54.2461%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Avg loss: 8.8324, Accuracy: 107/10000 (1.0700%)
time spent on training: 265.1662633419037
___Test Target_ResNet_18 poisoned: False, epoch: 77: Avg loss: 5.4296, Accuracy: 126/10000 (1.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Avg loss: 1.9824, Accuracy: 7318/9950 (73.5477%)
saving model
Done in 501.7624430656433 sec.
Server Epoch:78 choose agents : [41, 72, 21, 61, 36, 59, 95, 83, 71, 30].
___Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   1, Avg loss: 0.0659, Accuracy: 226/719 (31.4325%)
___Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   2, Avg loss: 0.0337, Accuracy: 467/719 (64.9513%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.1039, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   1, Avg loss: 0.0601, Accuracy: 286/1241 (23.0459%)
___Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   2, Avg loss: 0.0349, Accuracy: 508/1241 (40.9347%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.4910, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   1, Avg loss: 0.0550, Accuracy: 413/1949 (21.1904%)
___Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   2, Avg loss: 0.0316, Accuracy: 698/1949 (35.8132%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.9294, Accuracy: 96/10000 (0.9600%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   1, Avg loss: 0.1232, Accuracy: 3/85 (3.5294%)
___Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   2, Avg loss: 0.1140, Accuracy: 3/85 (3.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.4345, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0840, Accuracy: 9/408 (2.2059%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0520, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 6.5448, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   1, Avg loss: 0.0587, Accuracy: 263/1089 (24.1506%)
___Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   2, Avg loss: 0.0258, Accuracy: 570/1089 (52.3416%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.8179, Accuracy: 136/10000 (1.3600%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   1, Avg loss: 0.0778, Accuracy: 156/599 (26.0434%)
___Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   2, Avg loss: 0.0275, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 12.2793, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   1, Avg loss: 0.0554, Accuracy: 456/1953 (23.3487%)
___Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   2, Avg loss: 0.0307, Accuracy: 926/1953 (47.4142%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.3577, Accuracy: 155/10000 (1.5500%)
___Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   1, Avg loss: 0.0632, Accuracy: 148/818 (18.0929%)
___Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   2, Avg loss: 0.0281, Accuracy: 422/818 (51.5892%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 8.3376, Accuracy: 100/10000 (1.0000%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0713, Accuracy: 60/486 (12.3457%)
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0362, Accuracy: 212/486 (43.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Avg loss: 7.7294, Accuracy: 57/10000 (0.5700%)
time spent on training: 233.5221025943756
___Test Target_ResNet_18 poisoned: False, epoch: 78: Avg loss: 5.4195, Accuracy: 132/10000 (1.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Avg loss: 2.0103, Accuracy: 7328/9950 (73.6482%)
saving model
Done in 468.319730758667 sec.
Server Epoch:79 choose agents : [33, 1, 76, 57, 89, 55, 42, 31, 95, 22].
___Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0852, Accuracy: 38/515 (7.3786%)
___Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0526, Accuracy: 199/515 (38.6408%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.4183, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0568, Accuracy: 312/928 (33.6207%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0230, Accuracy: 611/928 (65.8405%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.4341, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   1, Avg loss: 0.0773, Accuracy: 70/466 (15.0215%)
___Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   2, Avg loss: 0.0451, Accuracy: 205/466 (43.9914%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 6.9440, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   1, Avg loss: 0.0555, Accuracy: 287/1154 (24.8700%)
___Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   2, Avg loss: 0.0244, Accuracy: 588/1154 (50.9532%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 10.0642, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   1, Avg loss: 0.0632, Accuracy: 261/896 (29.1295%)
___Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 474/896 (52.9018%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.1542, Accuracy: 70/10000 (0.7000%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   1, Avg loss: 0.0487, Accuracy: 368/1071 (34.3604%)
___Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   2, Avg loss: 0.0251, Accuracy: 597/1071 (55.7423%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.3931, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   1, Avg loss: 0.0613, Accuracy: 248/1372 (18.0758%)
___Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 574/1372 (41.8367%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 8.2591, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   1, Avg loss: 0.0906, Accuracy: 1/460 (0.2174%)
___Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   2, Avg loss: 0.0424, Accuracy: 185/460 (40.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 7.2426, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0759, Accuracy: 156/599 (26.0434%)
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0274, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 12.2999, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   1, Avg loss: 0.0484, Accuracy: 534/1470 (36.3265%)
___Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   2, Avg loss: 0.0231, Accuracy: 919/1470 (62.5170%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Avg loss: 9.0176, Accuracy: 117/10000 (1.1700%)
time spent on training: 220.90774130821228
___Test Target_ResNet_18 poisoned: False, epoch: 79: Avg loss: 5.4084, Accuracy: 134/10000 (1.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Avg loss: 2.0347, Accuracy: 7348/9950 (73.8492%)
saving model
Done in 455.37014174461365 sec.
Server Epoch:80 choose agents : [15, 82, 40, 18, 44, 37, 29, 63, 0, 22].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   1, Avg loss: 0.0546, Accuracy: 360/1154 (31.1958%)
___Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   2, Avg loss: 0.0252, Accuracy: 566/1154 (49.0468%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.6840, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   1, Avg loss: 0.0780, Accuracy: 19/500 (3.8000%)
___Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   2, Avg loss: 0.0468, Accuracy: 250/500 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 6.8896, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   1, Avg loss: 0.0579, Accuracy: 326/1573 (20.7247%)
___Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   2, Avg loss: 0.0338, Accuracy: 621/1573 (39.4787%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.4153, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   1, Avg loss: 0.0770, Accuracy: 80/530 (15.0943%)
___Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   2, Avg loss: 0.0357, Accuracy: 283/530 (53.3962%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.2800, Accuracy: 70/10000 (0.7000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   1, Avg loss: 0.0498, Accuracy: 546/1750 (31.2000%)
___Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   2, Avg loss: 0.0308, Accuracy: 854/1750 (48.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.4456, Accuracy: 145/10000 (1.4500%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   1, Avg loss: 0.0483, Accuracy: 477/1129 (42.2498%)
___Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   2, Avg loss: 0.0209, Accuracy: 765/1129 (67.7591%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.8284, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   1, Avg loss: 0.0534, Accuracy: 373/1440 (25.9028%)
___Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   2, Avg loss: 0.0262, Accuracy: 796/1440 (55.2778%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.6744, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   1, Avg loss: 0.0596, Accuracy: 192/888 (21.6216%)
___Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   2, Avg loss: 0.0241, Accuracy: 467/888 (52.5901%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 9.2821, Accuracy: 99/10000 (0.9900%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   1, Avg loss: 0.0592, Accuracy: 340/1657 (20.5190%)
___Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   2, Avg loss: 0.0321, Accuracy: 586/1657 (35.3651%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 7.6911, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   1, Avg loss: 0.0474, Accuracy: 558/1470 (37.9592%)
___Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   2, Avg loss: 0.0231, Accuracy: 937/1470 (63.7415%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Avg loss: 8.8950, Accuracy: 120/10000 (1.2000%)
time spent on training: 280.77534556388855
___Test Target_ResNet_18 poisoned: False, epoch: 80: Avg loss: 5.3965, Accuracy: 142/10000 (1.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Avg loss: 2.0864, Accuracy: 7374/9950 (74.1106%)
saving model
Done in 520.1318171024323 sec.
Server Epoch:81 choose agents : [62, 5, 56, 60, 10, 20, 90, 87, 72, 49].
___Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   1, Avg loss: 0.0660, Accuracy: 133/568 (23.4155%)
___Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 265/568 (46.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.1349, Accuracy: 59/10000 (0.5900%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   1, Avg loss: 0.0418, Accuracy: 689/1628 (42.3219%)
___Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   2, Avg loss: 0.0194, Accuracy: 1039/1628 (63.8206%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.7217, Accuracy: 152/10000 (1.5200%)
___Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   1, Avg loss: 0.0894, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   2, Avg loss: 0.0764, Accuracy: 6/186 (3.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.4140, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0522, Accuracy: 639/2227 (28.6933%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0265, Accuracy: 1112/2227 (49.9326%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 8.0852, Accuracy: 136/10000 (1.3600%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   1, Avg loss: 0.0582, Accuracy: 231/861 (26.8293%)
___Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   2, Avg loss: 0.0181, Accuracy: 520/861 (60.3949%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 9.7587, Accuracy: 109/10000 (1.0900%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   1, Avg loss: 0.0684, Accuracy: 175/807 (21.6853%)
___Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   2, Avg loss: 0.0315, Accuracy: 435/807 (53.9033%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.2999, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0598, Accuracy: 226/677 (33.3826%)
___Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0211, Accuracy: 466/677 (68.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 10.1786, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   1, Avg loss: 0.0572, Accuracy: 285/1131 (25.1989%)
___Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   2, Avg loss: 0.0301, Accuracy: 457/1131 (40.4067%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.9302, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   1, Avg loss: 0.0596, Accuracy: 296/1241 (23.8517%)
___Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   2, Avg loss: 0.0350, Accuracy: 485/1241 (39.0814%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 7.5539, Accuracy: 84/10000 (0.8400%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0709, Accuracy: 24/440 (5.4545%)
___Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0437, Accuracy: 176/440 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Avg loss: 6.3834, Accuracy: 56/10000 (0.5600%)
time spent on training: 255.53029346466064
___Test Target_ResNet_18 poisoned: False, epoch: 81: Avg loss: 5.3885, Accuracy: 144/10000 (1.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Avg loss: 2.0810, Accuracy: 7453/9950 (74.9045%)
saving model
Done in 492.1645393371582 sec.
Server Epoch:82 choose agents : [89, 71, 15, 22, 28, 59, 44, 72, 5, 64].
___Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   1, Avg loss: 0.0618, Accuracy: 262/896 (29.2411%)
___Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 489/896 (54.5759%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.1802, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   1, Avg loss: 0.0618, Accuracy: 172/818 (21.0269%)
___Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   2, Avg loss: 0.0271, Accuracy: 453/818 (55.3790%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.4936, Accuracy: 97/10000 (0.9700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   1, Avg loss: 0.0543, Accuracy: 376/1154 (32.5823%)
___Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   2, Avg loss: 0.0249, Accuracy: 638/1154 (55.2860%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.5070, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   1, Avg loss: 0.0472, Accuracy: 557/1470 (37.8912%)
___Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   2, Avg loss: 0.0226, Accuracy: 928/1470 (63.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.8633, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0536, Accuracy: 423/1581 (26.7552%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0309, Accuracy: 691/1581 (43.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.6381, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0621, Accuracy: 280/1089 (25.7117%)
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0269, Accuracy: 624/1089 (57.3003%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.7992, Accuracy: 122/10000 (1.2200%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0496, Accuracy: 573/1750 (32.7429%)
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0302, Accuracy: 842/1750 (48.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.5217, Accuracy: 147/10000 (1.4700%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0587, Accuracy: 275/1241 (22.1595%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0346, Accuracy: 520/1241 (41.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.4725, Accuracy: 82/10000 (0.8200%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   1, Avg loss: 0.0411, Accuracy: 692/1628 (42.5061%)
___Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   2, Avg loss: 0.0194, Accuracy: 1067/1628 (65.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 8.7454, Accuracy: 165/10000 (1.6500%)
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0661, Accuracy: 142/953 (14.9003%)
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0364, Accuracy: 355/953 (37.2508%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Avg loss: 7.2430, Accuracy: 88/10000 (0.8800%)
time spent on training: 279.09892678260803
___Test Target_ResNet_18 poisoned: False, epoch: 82: Avg loss: 5.3813, Accuracy: 158/10000 (1.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Avg loss: 2.1076, Accuracy: 7474/9950 (75.1156%)
saving model
Done in 514.433976650238 sec.
Server Epoch:83 choose agents : [44, 18, 70, 97, 43, 93, 72, 24, 56, 94].
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0491, Accuracy: 567/1750 (32.4000%)
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0307, Accuracy: 825/1750 (47.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.3772, Accuracy: 148/10000 (1.4800%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.0743, Accuracy: 91/530 (17.1698%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0368, Accuracy: 274/530 (51.6981%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.2737, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 428/1418 (30.1834%)
___Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   2, Avg loss: 0.0287, Accuracy: 741/1418 (52.2567%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.8864, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   1, Avg loss: 0.0527, Accuracy: 350/1213 (28.8541%)
___Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   2, Avg loss: 0.0252, Accuracy: 644/1213 (53.0915%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 8.4372, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0675, Accuracy: 199/946 (21.0359%)
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0350, Accuracy: 404/946 (42.7061%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.9826, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0559, Accuracy: 441/1742 (25.3157%)
___Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0293, Accuracy: 785/1742 (45.0631%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.8021, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   1, Avg loss: 0.0581, Accuracy: 296/1241 (23.8517%)
___Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   2, Avg loss: 0.0347, Accuracy: 512/1241 (41.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.4931, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   1, Avg loss: 0.0757, Accuracy: 13/312 (4.1667%)
___Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   2, Avg loss: 0.0444, Accuracy: 158/312 (50.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 6.3372, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0886, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0756, Accuracy: 8/186 (4.3011%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.4007, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0565, Accuracy: 382/1662 (22.9844%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0302, Accuracy: 749/1662 (45.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Avg loss: 7.6440, Accuracy: 114/10000 (1.1400%)
time spent on training: 239.99431562423706
___Test Target_ResNet_18 poisoned: False, epoch: 83: Avg loss: 5.3741, Accuracy: 163/10000 (1.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Avg loss: 2.1573, Accuracy: 7456/9950 (74.9347%)
saving model
Done in 485.9422538280487 sec.
Server Epoch:84 choose agents : [16, 36, 51, 77, 39, 2, 42, 68, 53, 88].
___Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   1, Avg loss: 0.0676, Accuracy: 217/708 (30.6497%)
___Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   2, Avg loss: 0.0373, Accuracy: 426/708 (60.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.3096, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   1, Avg loss: 0.0836, Accuracy: 23/408 (5.6373%)
___Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   2, Avg loss: 0.0506, Accuracy: 151/408 (37.0098%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 6.5264, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   1, Avg loss: 0.0617, Accuracy: 242/1049 (23.0696%)
___Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   2, Avg loss: 0.0258, Accuracy: 568/1049 (54.1468%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.2762, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   1, Avg loss: 0.0527, Accuracy: 324/1340 (24.1791%)
___Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   2, Avg loss: 0.0250, Accuracy: 686/1340 (51.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.7122, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   1, Avg loss: 0.0588, Accuracy: 227/1013 (22.4087%)
___Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 493/1013 (48.6673%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.5409, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0717, Accuracy: 126/605 (20.8264%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0416, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.0979, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   1, Avg loss: 0.0597, Accuracy: 249/1372 (18.1487%)
___Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   2, Avg loss: 0.0304, Accuracy: 589/1372 (42.9300%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 8.1875, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   1, Avg loss: 0.0664, Accuracy: 297/1163 (25.5374%)
___Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   2, Avg loss: 0.0360, Accuracy: 568/1163 (48.8392%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.0783, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0532, Accuracy: 253/813 (31.1193%)
___Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 492/813 (60.5166%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 11.7620, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.0689, Accuracy: 151/603 (25.0415%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0438, Accuracy: 288/603 (47.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Avg loss: 7.0030, Accuracy: 68/10000 (0.6800%)
time spent on training: 206.75030279159546
___Test Target_ResNet_18 poisoned: False, epoch: 84: Avg loss: 5.3659, Accuracy: 162/10000 (1.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Avg loss: 2.1910, Accuracy: 7459/9950 (74.9648%)
saving model
Done in 448.5025100708008 sec.
Server Epoch:85 choose agents : [30, 92, 55, 31, 64, 72, 67, 34, 45, 53].
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0708, Accuracy: 78/486 (16.0494%)
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0349, Accuracy: 216/486 (44.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.8012, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   1, Avg loss: 0.0537, Accuracy: 453/1715 (26.4140%)
___Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   2, Avg loss: 0.0278, Accuracy: 876/1715 (51.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.1425, Accuracy: 114/10000 (1.1400%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   1, Avg loss: 0.0484, Accuracy: 391/1071 (36.5079%)
___Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   2, Avg loss: 0.0253, Accuracy: 588/1071 (54.9020%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 8.4266, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0888, Accuracy: 13/460 (2.8261%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0444, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.2578, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0654, Accuracy: 141/953 (14.7954%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0368, Accuracy: 360/953 (37.7754%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.2766, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   1, Avg loss: 0.0579, Accuracy: 304/1241 (24.4964%)
___Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   2, Avg loss: 0.0346, Accuracy: 503/1241 (40.5318%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.6048, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   1, Avg loss: 0.0792, Accuracy: 28/426 (6.5728%)
___Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   2, Avg loss: 0.0455, Accuracy: 171/426 (40.1408%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.6844, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   1, Avg loss: 0.0631, Accuracy: 371/1427 (25.9986%)
___Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   2, Avg loss: 0.0316, Accuracy: 668/1427 (46.8115%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 7.4565, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   1, Avg loss: 0.0688, Accuracy: 149/669 (22.2720%)
___Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   2, Avg loss: 0.0368, Accuracy: 360/669 (53.8117%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 6.9566, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   1, Avg loss: 0.0518, Accuracy: 265/813 (32.5953%)
___Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   2, Avg loss: 0.0181, Accuracy: 494/813 (60.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Avg loss: 11.7410, Accuracy: 72/10000 (0.7200%)
time spent on training: 232.5837333202362
___Test Target_ResNet_18 poisoned: False, epoch: 85: Avg loss: 5.3601, Accuracy: 167/10000 (1.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Avg loss: 2.1899, Accuracy: 7548/9950 (75.8593%)
saving model
Done in 463.40169382095337 sec.
Server Epoch:86 choose agents : [2, 18, 97, 3, 99, 22, 44, 9, 74, 92].
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0707, Accuracy: 140/605 (23.1405%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0408, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.1328, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   1, Avg loss: 0.0737, Accuracy: 109/530 (20.5660%)
___Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   2, Avg loss: 0.0366, Accuracy: 286/530 (53.9623%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.3489, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   1, Avg loss: 0.0513, Accuracy: 386/1213 (31.8219%)
___Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   2, Avg loss: 0.0250, Accuracy: 626/1213 (51.6076%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.6230, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0678, Accuracy: 103/781 (13.1882%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0340, Accuracy: 296/781 (37.9001%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.8591, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0683, Accuracy: 171/773 (22.1216%)
___Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0289, Accuracy: 455/773 (58.8616%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.4012, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 583/1470 (39.6599%)
___Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   2, Avg loss: 0.0224, Accuracy: 930/1470 (63.2653%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 8.9169, Accuracy: 124/10000 (1.2400%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0489, Accuracy: 635/1750 (36.2857%)
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0302, Accuracy: 860/1750 (49.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.5163, Accuracy: 146/10000 (1.4600%)
___Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   1, Avg loss: 0.0469, Accuracy: 369/1275 (28.9412%)
___Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   2, Avg loss: 0.0169, Accuracy: 792/1275 (62.1176%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 9.8967, Accuracy: 126/10000 (1.2600%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0397, Accuracy: 626/1552 (40.3351%)
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0181, Accuracy: 893/1552 (57.5387%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 10.1970, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   1, Avg loss: 0.0532, Accuracy: 477/1715 (27.8134%)
___Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   2, Avg loss: 0.0273, Accuracy: 877/1715 (51.1370%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Avg loss: 7.8955, Accuracy: 113/10000 (1.1300%)
time spent on training: 262.8043055534363
___Test Target_ResNet_18 poisoned: False, epoch: 86: Avg loss: 5.3548, Accuracy: 165/10000 (1.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Avg loss: 2.2313, Accuracy: 7546/9950 (75.8392%)
saving model
Done in 503.08563566207886 sec.
Server Epoch:87 choose agents : [27, 69, 68, 61, 71, 23, 41, 98, 94, 52].
___Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   1, Avg loss: 0.0590, Accuracy: 390/1587 (24.5747%)
___Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   2, Avg loss: 0.0321, Accuracy: 695/1587 (43.7933%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.5988, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0644, Accuracy: 220/590 (37.2881%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0325, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 10.5649, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0658, Accuracy: 292/1163 (25.1075%)
___Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0362, Accuracy: 538/1163 (46.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.2781, Accuracy: 67/10000 (0.6700%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1212, Accuracy: 2/85 (2.3529%)
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1162, Accuracy: 2/85 (2.3529%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.3594, Accuracy: 156/10000 (1.5600%)
___Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   1, Avg loss: 0.0614, Accuracy: 214/818 (26.1614%)
___Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   2, Avg loss: 0.0274, Accuracy: 436/818 (53.3007%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.4039, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0703, Accuracy: 220/715 (30.7692%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0387, Accuracy: 438/715 (61.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.4445, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   1, Avg loss: 0.0642, Accuracy: 241/719 (33.5188%)
___Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   2, Avg loss: 0.0319, Accuracy: 467/719 (64.9513%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.9487, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   1, Avg loss: 0.0753, Accuracy: 23/373 (6.1662%)
___Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   2, Avg loss: 0.0473, Accuracy: 151/373 (40.4826%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 6.2886, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 398/1662 (23.9471%)
___Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   2, Avg loss: 0.0299, Accuracy: 723/1662 (43.5018%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 7.8802, Accuracy: 138/10000 (1.3800%)
___Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   1, Avg loss: 0.0600, Accuracy: 231/636 (36.3208%)
___Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   2, Avg loss: 0.0296, Accuracy: 427/636 (67.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Avg loss: 8.8550, Accuracy: 50/10000 (0.5000%)
time spent on training: 212.3456494808197
___Test Target_ResNet_18 poisoned: False, epoch: 87: Avg loss: 5.3473, Accuracy: 164/10000 (1.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Avg loss: 2.2528, Accuracy: 7563/9950 (76.0101%)
saving model
Done in 448.4848334789276 sec.
Server Epoch:88 choose agents : [48, 70, 99, 34, 64, 81, 0, 53, 31, 56].
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0763, Accuracy: 95/631 (15.0555%)
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0436, Accuracy: 283/631 (44.8494%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.0499, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   1, Avg loss: 0.0551, Accuracy: 441/1418 (31.1001%)
___Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   2, Avg loss: 0.0286, Accuracy: 740/1418 (52.1862%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.8227, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   1, Avg loss: 0.0661, Accuracy: 193/773 (24.9677%)
___Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   2, Avg loss: 0.0326, Accuracy: 441/773 (57.0505%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 9.6437, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0615, Accuracy: 373/1427 (26.1388%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0313, Accuracy: 674/1427 (47.2320%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.4054, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   1, Avg loss: 0.0646, Accuracy: 151/953 (15.8447%)
___Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   2, Avg loss: 0.0360, Accuracy: 361/953 (37.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.4666, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0643, Accuracy: 243/774 (31.3953%)
___Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0355, Accuracy: 397/774 (51.2920%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.5676, Accuracy: 78/10000 (0.7800%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 363/1657 (21.9071%)
___Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   2, Avg loss: 0.0319, Accuracy: 602/1657 (36.3307%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.5806, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   1, Avg loss: 0.0511, Accuracy: 271/813 (33.3333%)
___Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   2, Avg loss: 0.0175, Accuracy: 507/813 (62.3616%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 11.7434, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0873, Accuracy: 13/460 (2.8261%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0427, Accuracy: 184/460 (40.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 7.4927, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   1, Avg loss: 0.0875, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   2, Avg loss: 0.0746, Accuracy: 19/186 (10.2151%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.3747, Accuracy: 76/10000 (0.7600%)
time spent on training: 224.25992894172668
___Test Target_ResNet_18 poisoned: False, epoch: 88: Avg loss: 5.3399, Accuracy: 163/10000 (1.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Avg loss: 2.2519, Accuracy: 7617/9950 (76.5528%)
saving model
Done in 462.15176248550415 sec.
Server Epoch:89 choose agents : [39, 68, 73, 96, 98, 22, 75, 79, 34, 43].
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0570, Accuracy: 242/1013 (23.8894%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0254, Accuracy: 503/1013 (49.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.7239, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   1, Avg loss: 0.0649, Accuracy: 293/1163 (25.1935%)
___Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   2, Avg loss: 0.0354, Accuracy: 535/1163 (46.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.1519, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   1, Avg loss: 0.0638, Accuracy: 190/938 (20.2559%)
___Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   2, Avg loss: 0.0314, Accuracy: 399/938 (42.5373%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.3004, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   1, Avg loss: 0.0750, Accuracy: 65/311 (20.9003%)
___Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   2, Avg loss: 0.0534, Accuracy: 131/311 (42.1222%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.9911, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   1, Avg loss: 0.0752, Accuracy: 24/373 (6.4343%)
___Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   2, Avg loss: 0.0471, Accuracy: 154/373 (41.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 6.2462, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0452, Accuracy: 600/1470 (40.8163%)
___Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0223, Accuracy: 930/1470 (63.2653%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.7252, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   1, Avg loss: 0.0625, Accuracy: 220/776 (28.3505%)
___Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   2, Avg loss: 0.0274, Accuracy: 460/776 (59.2784%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 8.0625, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   1, Avg loss: 0.1152, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   2, Avg loss: 0.0989, Accuracy: 3/197 (1.5228%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.3620, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   1, Avg loss: 0.0608, Accuracy: 357/1427 (25.0175%)
___Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   2, Avg loss: 0.0313, Accuracy: 680/1427 (47.6524%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.4913, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0655, Accuracy: 230/946 (24.3129%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0348, Accuracy: 396/946 (41.8605%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Avg loss: 7.0698, Accuracy: 90/10000 (0.9000%)
time spent on training: 206.61278104782104
___Test Target_ResNet_18 poisoned: False, epoch: 89: Avg loss: 5.3342, Accuracy: 164/10000 (1.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Avg loss: 2.2279, Accuracy: 7701/9950 (77.3970%)
saving model
Done in 448.65258169174194 sec.
Server Epoch:90 choose agents : [0, 96, 92, 51, 57, 32, 6, 53, 79, 37].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   1, Avg loss: 0.0574, Accuracy: 363/1657 (21.9071%)
___Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   2, Avg loss: 0.0317, Accuracy: 593/1657 (35.7876%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.6733, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   1, Avg loss: 0.0747, Accuracy: 68/311 (21.8650%)
___Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 133/311 (42.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.9870, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   1, Avg loss: 0.0529, Accuracy: 494/1715 (28.8047%)
___Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   2, Avg loss: 0.0272, Accuracy: 891/1715 (51.9534%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.7643, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0604, Accuracy: 274/1049 (26.1201%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0262, Accuracy: 578/1049 (55.1001%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.1561, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   1, Avg loss: 0.0563, Accuracy: 278/1154 (24.0901%)
___Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   2, Avg loss: 0.0242, Accuracy: 582/1154 (50.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.7093, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   1, Avg loss: 0.0505, Accuracy: 246/735 (33.4694%)
___Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   2, Avg loss: 0.0181, Accuracy: 446/735 (60.6803%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 10.2273, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   1, Avg loss: 0.0547, Accuracy: 436/1956 (22.2904%)
___Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   2, Avg loss: 0.0290, Accuracy: 782/1956 (39.9796%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 7.9032, Accuracy: 135/10000 (1.3500%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0501, Accuracy: 304/813 (37.3924%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 472/813 (58.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 11.6266, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   1, Avg loss: 0.1155, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   2, Avg loss: 0.0969, Accuracy: 5/197 (2.5381%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.3535, Accuracy: 131/10000 (1.3100%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   1, Avg loss: 0.0468, Accuracy: 508/1129 (44.9956%)
___Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   2, Avg loss: 0.0199, Accuracy: 787/1129 (69.7077%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Avg loss: 8.5043, Accuracy: 120/10000 (1.2000%)
time spent on training: 258.00986433029175
___Test Target_ResNet_18 poisoned: False, epoch: 90: Avg loss: 5.3289, Accuracy: 169/10000 (1.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Avg loss: 2.2238, Accuracy: 7769/9950 (78.0804%)
saving model
Done in 493.9417564868927 sec.
Server Epoch:91 choose agents : [27, 46, 19, 29, 48, 47, 40, 89, 34, 83].
___Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   1, Avg loss: 0.0583, Accuracy: 385/1587 (24.2596%)
___Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   2, Avg loss: 0.0322, Accuracy: 686/1587 (43.2262%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.5742, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   1, Avg loss: 0.0543, Accuracy: 491/1904 (25.7878%)
___Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   2, Avg loss: 0.0280, Accuracy: 877/1904 (46.0609%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.7240, Accuracy: 165/10000 (1.6500%)
___Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   1, Avg loss: 0.0502, Accuracy: 437/1036 (42.1815%)
___Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   2, Avg loss: 0.0211, Accuracy: 744/1036 (71.8147%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 11.1276, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   1, Avg loss: 0.0518, Accuracy: 425/1440 (29.5139%)
___Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   2, Avg loss: 0.0266, Accuracy: 776/1440 (53.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 8.6045, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   1, Avg loss: 0.0747, Accuracy: 113/631 (17.9081%)
___Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   2, Avg loss: 0.0438, Accuracy: 279/631 (44.2155%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 6.9783, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   1, Avg loss: 0.1225, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   2, Avg loss: 0.1108, Accuracy: 6/134 (4.4776%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.3429, Accuracy: 146/10000 (1.4600%)
___Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   1, Avg loss: 0.0575, Accuracy: 337/1573 (21.4240%)
___Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   2, Avg loss: 0.0333, Accuracy: 650/1573 (41.3223%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.3412, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0605, Accuracy: 274/896 (30.5804%)
___Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 471/896 (52.5670%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.2771, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0595, Accuracy: 407/1427 (28.5214%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0311, Accuracy: 658/1427 (46.1107%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.4194, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 509/1953 (26.0625%)
___Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   2, Avg loss: 0.0303, Accuracy: 941/1953 (48.1823%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Avg loss: 7.3450, Accuracy: 165/10000 (1.6500%)
time spent on training: 260.920104265213
___Test Target_ResNet_18 poisoned: False, epoch: 91: Avg loss: 5.3205, Accuracy: 169/10000 (1.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Avg loss: 2.2629, Accuracy: 7738/9950 (77.7688%)
saving model
Done in 502.6250286102295 sec.
Server Epoch:92 choose agents : [9, 63, 42, 40, 83, 13, 84, 5, 75, 3].
___Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   1, Avg loss: 0.0460, Accuracy: 423/1275 (33.1765%)
___Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   2, Avg loss: 0.0161, Accuracy: 819/1275 (64.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 10.0036, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   1, Avg loss: 0.0584, Accuracy: 219/888 (24.6622%)
___Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   2, Avg loss: 0.0240, Accuracy: 454/888 (51.1261%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 9.4500, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0579, Accuracy: 291/1372 (21.2099%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0303, Accuracy: 589/1372 (42.9300%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.2010, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0565, Accuracy: 334/1573 (21.2333%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0331, Accuracy: 648/1573 (41.1952%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.2927, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   1, Avg loss: 0.0537, Accuracy: 524/1953 (26.8305%)
___Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   2, Avg loss: 0.0299, Accuracy: 946/1953 (48.4383%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.4641, Accuracy: 147/10000 (1.4700%)
___Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0537, Accuracy: 438/1645 (26.6261%)
___Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0301, Accuracy: 711/1645 (43.2219%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.0699, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   1, Avg loss: 0.0615, Accuracy: 284/1190 (23.8655%)
___Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   2, Avg loss: 0.0297, Accuracy: 516/1190 (43.3613%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 7.6763, Accuracy: 105/10000 (1.0500%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   1, Avg loss: 0.0406, Accuracy: 736/1628 (45.2088%)
___Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   2, Avg loss: 0.0190, Accuracy: 1040/1628 (63.8821%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.6479, Accuracy: 168/10000 (1.6800%)
___Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0602, Accuracy: 220/776 (28.3505%)
___Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0267, Accuracy: 446/776 (57.4742%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.2487, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0668, Accuracy: 124/781 (15.8771%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0335, Accuracy: 305/781 (39.0525%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Avg loss: 8.3161, Accuracy: 105/10000 (1.0500%)
time spent on training: 281.44100189208984
___Test Target_ResNet_18 poisoned: False, epoch: 92: Avg loss: 5.3143, Accuracy: 173/10000 (1.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Avg loss: 2.3202, Accuracy: 7670/9950 (77.0854%)
saving model
Done in 509.1051769256592 sec.
Server Epoch:93 choose agents : [59, 28, 10, 95, 89, 1, 69, 50, 30, 17].
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0561, Accuracy: 297/1089 (27.2727%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0244, Accuracy: 578/1089 (53.0762%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.7392, Accuracy: 153/10000 (1.5300%)
___Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   1, Avg loss: 0.0529, Accuracy: 432/1581 (27.3245%)
___Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   2, Avg loss: 0.0305, Accuracy: 713/1581 (45.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.5256, Accuracy: 107/10000 (1.0700%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   1, Avg loss: 0.0561, Accuracy: 278/861 (32.2880%)
___Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   2, Avg loss: 0.0174, Accuracy: 548/861 (63.6469%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 9.7440, Accuracy: 118/10000 (1.1800%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   1, Avg loss: 0.0725, Accuracy: 185/599 (30.8848%)
___Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   2, Avg loss: 0.0276, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 12.1118, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 287/896 (32.0312%)
___Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   2, Avg loss: 0.0323, Accuracy: 471/896 (52.5670%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.1250, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0546, Accuracy: 367/928 (39.5474%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0204, Accuracy: 655/928 (70.5819%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.1476, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   1, Avg loss: 0.0607, Accuracy: 243/590 (41.1864%)
___Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   2, Avg loss: 0.0310, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 11.4328, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   1, Avg loss: 0.0608, Accuracy: 190/809 (23.4858%)
___Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   2, Avg loss: 0.0245, Accuracy: 414/809 (51.1743%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.9710, Accuracy: 129/10000 (1.2900%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   1, Avg loss: 0.0698, Accuracy: 99/486 (20.3704%)
___Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   2, Avg loss: 0.0350, Accuracy: 220/486 (45.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 7.7752, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   1, Avg loss: 0.0539, Accuracy: 418/1574 (26.5565%)
___Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   2, Avg loss: 0.0251, Accuracy: 746/1574 (47.3952%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Avg loss: 8.3210, Accuracy: 147/10000 (1.4700%)
time spent on training: 254.04781913757324
___Test Target_ResNet_18 poisoned: False, epoch: 93: Avg loss: 5.3087, Accuracy: 178/10000 (1.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Avg loss: 2.3565, Accuracy: 7617/9950 (76.5528%)
saving model
Done in 480.48747420310974 sec.
Server Epoch:94 choose agents : [34, 35, 88, 8, 41, 2, 25, 18, 54, 79].
___Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   1, Avg loss: 0.0590, Accuracy: 413/1427 (28.9418%)
___Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   2, Avg loss: 0.0308, Accuracy: 703/1427 (49.2642%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.4086, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.0910, Accuracy: 2/271 (0.7380%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0618, Accuracy: 128/271 (47.2325%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.7851, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   1, Avg loss: 0.0683, Accuracy: 150/603 (24.8756%)
___Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   2, Avg loss: 0.0417, Accuracy: 287/603 (47.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.0848, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   1, Avg loss: 0.0588, Accuracy: 331/1513 (21.8771%)
___Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   2, Avg loss: 0.0340, Accuracy: 596/1513 (39.3919%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.5081, Accuracy: 136/10000 (1.3600%)
___Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   1, Avg loss: 0.0627, Accuracy: 256/719 (35.6050%)
___Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   2, Avg loss: 0.0317, Accuracy: 464/719 (64.5341%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.1607, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0686, Accuracy: 158/605 (26.1157%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0402, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 7.1393, Accuracy: 54/10000 (0.5400%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   1, Avg loss: 0.0538, Accuracy: 272/690 (39.4203%)
___Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   2, Avg loss: 0.0216, Accuracy: 474/690 (68.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 9.2956, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   1, Avg loss: 0.0711, Accuracy: 130/530 (24.5283%)
___Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   2, Avg loss: 0.0353, Accuracy: 278/530 (52.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.2995, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0595, Accuracy: 324/1130 (28.6726%)
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0282, Accuracy: 485/1130 (42.9204%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 8.5658, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   1, Avg loss: 0.1156, Accuracy: 0/197 (0.0000%)
___Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   2, Avg loss: 0.0968, Accuracy: 4/197 (2.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.3281, Accuracy: 126/10000 (1.2600%)
time spent on training: 210.56047677993774
___Test Target_ResNet_18 poisoned: False, epoch: 94: Avg loss: 5.3045, Accuracy: 176/10000 (1.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Avg loss: 2.3756, Accuracy: 7611/9950 (76.4925%)
saving model
Done in 439.41784262657166 sec.
Server Epoch:95 choose agents : [66, 86, 64, 27, 37, 55, 33, 62, 57, 28].
___Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   1, Avg loss: 0.0626, Accuracy: 303/1402 (21.6120%)
___Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   2, Avg loss: 0.0374, Accuracy: 472/1402 (33.6662%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.3474, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   1, Avg loss: 0.0612, Accuracy: 297/1003 (29.6112%)
___Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 409/1003 (40.7777%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.5053, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   1, Avg loss: 0.0634, Accuracy: 172/953 (18.0483%)
___Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   2, Avg loss: 0.0358, Accuracy: 348/953 (36.5163%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.3015, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   1, Avg loss: 0.0568, Accuracy: 430/1587 (27.0951%)
___Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   2, Avg loss: 0.0316, Accuracy: 699/1587 (44.0454%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.4327, Accuracy: 79/10000 (0.7900%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   1, Avg loss: 0.0461, Accuracy: 530/1129 (46.9442%)
___Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   2, Avg loss: 0.0196, Accuracy: 789/1129 (69.8849%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.3579, Accuracy: 123/10000 (1.2300%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   1, Avg loss: 0.0486, Accuracy: 428/1071 (39.9627%)
___Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   2, Avg loss: 0.0254, Accuracy: 609/1071 (56.8627%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 8.5167, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   1, Avg loss: 0.0814, Accuracy: 66/515 (12.8155%)
___Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   2, Avg loss: 0.0553, Accuracy: 207/515 (40.1942%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 6.4297, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   1, Avg loss: 0.0658, Accuracy: 160/568 (28.1690%)
___Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   2, Avg loss: 0.0394, Accuracy: 264/568 (46.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.1883, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0551, Accuracy: 327/1154 (28.3362%)
___Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0247, Accuracy: 572/1154 (49.5667%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 10.3924, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0526, Accuracy: 423/1581 (26.7552%)
___Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0303, Accuracy: 719/1581 (45.4775%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Avg loss: 7.4767, Accuracy: 107/10000 (1.0700%)
time spent on training: 265.6813313961029
___Test Target_ResNet_18 poisoned: False, epoch: 95: Avg loss: 5.3016, Accuracy: 178/10000 (1.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Avg loss: 2.4069, Accuracy: 7601/9950 (76.3920%)
saving model
Done in 509.3716080188751 sec.
Server Epoch:96 choose agents : [6, 3, 92, 4, 1, 12, 48, 2, 69, 13].
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0536, Accuracy: 433/1956 (22.1370%)
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0284, Accuracy: 830/1956 (42.4335%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.8805, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0661, Accuracy: 126/781 (16.1332%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0333, Accuracy: 296/781 (37.9001%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.1938, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 500/1715 (29.1545%)
___Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   2, Avg loss: 0.0268, Accuracy: 893/1715 (52.0700%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.7128, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0623, Accuracy: 302/901 (33.5183%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 432/901 (47.9467%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.9366, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0540, Accuracy: 378/928 (40.7328%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0207, Accuracy: 645/928 (69.5043%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 8.2800, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0884, Accuracy: 28/338 (8.2840%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0504, Accuracy: 144/338 (42.6036%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 6.1428, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   1, Avg loss: 0.0730, Accuracy: 136/631 (21.5531%)
___Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   2, Avg loss: 0.0436, Accuracy: 295/631 (46.7512%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.1150, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0684, Accuracy: 163/605 (26.9421%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0399, Accuracy: 327/605 (54.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.1443, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   1, Avg loss: 0.0610, Accuracy: 261/590 (44.2373%)
___Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   2, Avg loss: 0.0308, Accuracy: 450/590 (76.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 10.9659, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   1, Avg loss: 0.0537, Accuracy: 454/1645 (27.5988%)
___Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   2, Avg loss: 0.0296, Accuracy: 783/1645 (47.5988%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Avg loss: 7.6893, Accuracy: 170/10000 (1.7000%)
time spent on training: 235.0268988609314
___Test Target_ResNet_18 poisoned: False, epoch: 96: Avg loss: 5.2964, Accuracy: 184/10000 (1.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Avg loss: 2.4404, Accuracy: 7570/9950 (76.0804%)
saving model
Done in 480.30659198760986 sec.
Server Epoch:97 choose agents : [34, 90, 11, 2, 35, 50, 85, 72, 3, 18].
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0587, Accuracy: 397/1427 (27.8206%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0302, Accuracy: 685/1427 (48.0028%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.5099, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   1, Avg loss: 0.0588, Accuracy: 246/677 (36.3368%)
___Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   2, Avg loss: 0.0223, Accuracy: 466/677 (68.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.9382, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   1, Avg loss: 0.0606, Accuracy: 242/712 (33.9888%)
___Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   2, Avg loss: 0.0236, Accuracy: 451/712 (63.3427%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.9413, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0673, Accuracy: 174/605 (28.7603%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 326/605 (53.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.0610, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0910, Accuracy: 1/271 (0.3690%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0607, Accuracy: 131/271 (48.3395%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.8147, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   1, Avg loss: 0.0600, Accuracy: 180/809 (22.2497%)
___Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   2, Avg loss: 0.0244, Accuracy: 409/809 (50.5562%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 9.2075, Accuracy: 119/10000 (1.1900%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   1, Avg loss: 0.0440, Accuracy: 798/1988 (40.1408%)
___Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   2, Avg loss: 0.0299, Accuracy: 911/1988 (45.8249%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.6321, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0561, Accuracy: 337/1241 (27.1555%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0339, Accuracy: 495/1241 (39.8872%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 7.4214, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0648, Accuracy: 150/781 (19.2061%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0334, Accuracy: 298/781 (38.1562%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.0405, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   1, Avg loss: 0.0716, Accuracy: 132/530 (24.9057%)
___Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   2, Avg loss: 0.0346, Accuracy: 287/530 (54.1509%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Avg loss: 8.2793, Accuracy: 73/10000 (0.7300%)
time spent on training: 234.21140885353088
___Test Target_ResNet_18 poisoned: False, epoch: 97: Avg loss: 5.2967, Accuracy: 179/10000 (1.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Avg loss: 2.4662, Accuracy: 7490/9950 (75.2764%)
saving model
Done in 475.4809355735779 sec.
Server Epoch:98 choose agents : [7, 45, 42, 97, 87, 98, 9, 32, 48, 31].
___Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   1, Avg loss: 0.0571, Accuracy: 290/891 (32.5477%)
___Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 474/891 (53.1987%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.1177, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   1, Avg loss: 0.0666, Accuracy: 171/669 (25.5605%)
___Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   2, Avg loss: 0.0370, Accuracy: 363/669 (54.2601%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 6.8350, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   1, Avg loss: 0.0574, Accuracy: 304/1372 (22.1574%)
___Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   2, Avg loss: 0.0297, Accuracy: 589/1372 (42.9300%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.1862, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   1, Avg loss: 0.0500, Accuracy: 371/1213 (30.5853%)
___Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   2, Avg loss: 0.0248, Accuracy: 623/1213 (51.3603%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 8.6159, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0575, Accuracy: 300/1131 (26.5252%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0297, Accuracy: 464/1131 (41.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.9746, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   1, Avg loss: 0.0753, Accuracy: 36/373 (9.6515%)
___Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   2, Avg loss: 0.0470, Accuracy: 152/373 (40.7507%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 6.2319, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   1, Avg loss: 0.0459, Accuracy: 418/1275 (32.7843%)
___Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   2, Avg loss: 0.0162, Accuracy: 819/1275 (64.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.8646, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0515, Accuracy: 256/735 (34.8299%)
___Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0180, Accuracy: 430/735 (58.5034%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 9.9130, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   1, Avg loss: 0.0720, Accuracy: 148/631 (23.4548%)
___Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   2, Avg loss: 0.0420, Accuracy: 295/631 (46.7512%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.0684, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   1, Avg loss: 0.0856, Accuracy: 25/460 (5.4348%)
___Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   2, Avg loss: 0.0413, Accuracy: 188/460 (40.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Avg loss: 7.2799, Accuracy: 50/10000 (0.5000%)
time spent on training: 216.13656306266785
___Test Target_ResNet_18 poisoned: False, epoch: 98: Avg loss: 5.2949, Accuracy: 186/10000 (1.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Avg loss: 2.4340, Accuracy: 7607/9950 (76.4523%)
saving model
Done in 458.33524441719055 sec.
Server Epoch:99 choose agents : [64, 82, 67, 73, 95, 84, 19, 29, 39, 26].
___Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   1, Avg loss: 0.0625, Accuracy: 191/953 (20.0420%)
___Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   2, Avg loss: 0.0358, Accuracy: 368/953 (38.6149%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.3149, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 58/500 (11.6000%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2, Avg loss: 0.0460, Accuracy: 244/500 (48.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 6.8774, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   1, Avg loss: 0.0757, Accuracy: 51/426 (11.9718%)
___Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   2, Avg loss: 0.0422, Accuracy: 171/426 (40.1408%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 6.8176, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   1, Avg loss: 0.0633, Accuracy: 189/938 (20.1493%)
___Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   2, Avg loss: 0.0309, Accuracy: 419/938 (44.6695%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.1788, Accuracy: 85/10000 (0.8500%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0703, Accuracy: 205/599 (34.2237%)
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0252, Accuracy: 490/599 (81.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 11.9152, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   1, Avg loss: 0.0595, Accuracy: 300/1190 (25.2101%)
___Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   2, Avg loss: 0.0282, Accuracy: 568/1190 (47.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.6827, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   1, Avg loss: 0.0494, Accuracy: 424/1036 (40.9266%)
___Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   2, Avg loss: 0.0208, Accuracy: 750/1036 (72.3938%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 10.8996, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   1, Avg loss: 0.0516, Accuracy: 427/1440 (29.6528%)
___Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   2, Avg loss: 0.0253, Accuracy: 821/1440 (57.0139%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.5652, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   1, Avg loss: 0.0552, Accuracy: 268/1013 (26.4561%)
___Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   2, Avg loss: 0.0247, Accuracy: 526/1013 (51.9250%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 8.4669, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 327/1446 (22.6141%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0328, Accuracy: 577/1446 (39.9032%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Avg loss: 7.3555, Accuracy: 99/10000 (0.9900%)
time spent on training: 238.39048218727112
___Test Target_ResNet_18 poisoned: False, epoch: 99: Avg loss: 5.2906, Accuracy: 186/10000 (1.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Avg loss: 2.4027, Accuracy: 7727/9950 (77.6583%)
saving model
Done in 483.44028306007385 sec.
Server Epoch:100 choose agents : [68, 28, 58, 41, 78, 29, 94, 45, 73, 15].
___Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   1, Avg loss: 0.0638, Accuracy: 313/1163 (26.9132%)
___Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   2, Avg loss: 0.0354, Accuracy: 540/1163 (46.4316%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.0915, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   1, Avg loss: 0.0520, Accuracy: 477/1581 (30.1708%)
___Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   2, Avg loss: 0.0302, Accuracy: 716/1581 (45.2878%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.5330, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0587, Accuracy: 296/803 (36.8618%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0330, Accuracy: 457/803 (56.9116%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.9106, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   1, Avg loss: 0.0621, Accuracy: 263/719 (36.5786%)
___Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   2, Avg loss: 0.0313, Accuracy: 471/719 (65.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.2911, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   1, Avg loss: 0.0784, Accuracy: 56/416 (13.4615%)
___Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   2, Avg loss: 0.0433, Accuracy: 234/416 (56.2500%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.4865, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   1, Avg loss: 0.0517, Accuracy: 440/1440 (30.5556%)
___Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   2, Avg loss: 0.0256, Accuracy: 821/1440 (57.0139%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.2000, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 424/1662 (25.5114%)
___Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   2, Avg loss: 0.0298, Accuracy: 727/1662 (43.7425%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 7.8364, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   1, Avg loss: 0.0661, Accuracy: 180/669 (26.9058%)
___Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   2, Avg loss: 0.0365, Accuracy: 369/669 (55.1570%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 6.8851, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   1, Avg loss: 0.0631, Accuracy: 199/938 (21.2154%)
___Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   2, Avg loss: 0.0310, Accuracy: 403/938 (42.9638%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.2097, Accuracy: 86/10000 (0.8600%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   1, Avg loss: 0.0525, Accuracy: 393/1154 (34.0555%)
___Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   2, Avg loss: 0.0246, Accuracy: 633/1154 (54.8527%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Avg loss: 8.9426, Accuracy: 114/10000 (1.1400%)
time spent on training: 257.7325110435486
___Test Target_ResNet_18 poisoned: False, epoch: 100: Avg loss: 5.2869, Accuracy: 185/10000 (1.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Avg loss: 2.4009, Accuracy: 7784/9950 (78.2312%)
saving model
Done in 491.1456949710846 sec.
Saving all the graphs.
This run has a label: Jun.10_22.59.05. Visdom environment: tiny
