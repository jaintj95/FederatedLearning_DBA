current path: saved_models/model_tiny_Jun.26_07.44.57
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 3, 5, 9, 10, 12, 15, 18, 20, 24, 25, 30, 33, 36, 37, 42, 44, 48, 49, 54, 55, 60, 61, 65, 69, 72, 74, 78, 81, 84, 85, 95]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [37, 44, 94, 74, 82, 83, 41, 65, 26, 24].
poison local model 37 index 14 
_Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   1, Avg loss: 0.0528, Accuracy: 387/1129 (34.2781%)
_Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   2, Avg loss: 0.0253, Accuracy: 725/1129 (64.2161%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.2201, Accuracy: 96/10000 (0.9600%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 395/1750 (22.5714%)
_Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 663/1750 (37.8857%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7695, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   1, Avg loss: 0.0558, Accuracy: 343/1662 (20.6378%)
_Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   2, Avg loss: 0.0340, Accuracy: 587/1662 (35.3189%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6014, Accuracy: 107/10000 (1.0700%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 510/1552 (32.8608%)
_Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 741/1552 (47.7448%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 10.2263, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 57/500 (11.4000%)
_Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5812, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0549, Accuracy: 405/1953 (20.7373%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 770/1953 (39.4265%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.8809, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   1, Avg loss: 0.0630, Accuracy: 318/719 (44.2281%)
_Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   2, Avg loss: 0.0310, Accuracy: 441/719 (61.3352%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.1252, Accuracy: 51/10000 (0.5100%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0573, Accuracy: 378/1475 (25.6271%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0305, Accuracy: 715/1475 (48.4746%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.8658, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 324/1446 (22.4066%)
_Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 496/1446 (34.3015%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.1868, Accuracy: 65/10000 (0.6500%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 28/312 (8.9744%)
_Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3859, Accuracy: 50/10000 (0.5000%)
time spent on training: 159.0446925163269
[rfa agg] training data poison_ratio: 0.49751960313650184  data num: [1129, 1750, 1662, 1552, 500, 1953, 719, 1475, 1446, 312]
[rfa agg] considering poison per batch poison_fraction: 0.31094975196031366
[rfa agg] init. name: [37, 44, 94, 74, 82, 83, 41, 65, 26, 24], weight: tensor([0.0903, 0.1400, 0.1330, 0.1242, 0.0400, 0.1563, 0.0575, 0.1180, 0.1157,
        0.0250])
[rfa agg] iter:  0, prev_obj_val: 54.709083557128906, obj_val: 52.20087432861328, abs dis: 2.508209228515625
[rfa agg] iter: 0, weight: tensor([0.1301, 0.0899, 0.1187, 0.1370, 0.0139, 0.0707, 0.0289, 0.1685, 0.2352,
        0.0070])
[rfa agg] iter:  1, prev_obj_val: 52.20087432861328, obj_val: 52.19794464111328, abs dis: 0.0029296875
[rfa agg] iter: 1, weight: tensor([0.1009, 0.0859, 0.1167, 0.1386, 0.0120, 0.0661, 0.0244, 0.1772, 0.2722,
        0.0061])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3070, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.3667, Accuracy: 0/9950 (0.0000%)
saving model
Done in 592.0809187889099 sec.
Server Epoch:2 choose agents : [94, 71, 66, 35, 38, 84, 42, 43, 11, 95].
_Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   1, Avg loss: 0.0544, Accuracy: 345/1662 (20.7581%)
_Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 605/1662 (36.4019%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.8360, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   1, Avg loss: 0.0669, Accuracy: 131/818 (16.0147%)
_Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   2, Avg loss: 0.0312, Accuracy: 348/818 (42.5428%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.0819, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   1, Avg loss: 0.0628, Accuracy: 239/1402 (17.0471%)
_Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 356/1402 (25.3923%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.2887, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   1, Avg loss: 0.0882, Accuracy: 25/271 (9.2251%)
_Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   2, Avg loss: 0.0602, Accuracy: 95/271 (35.0554%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3840, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   1, Avg loss: 0.0633, Accuracy: 224/1131 (19.8055%)
_Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   2, Avg loss: 0.0314, Accuracy: 488/1131 (43.1477%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.2109, Accuracy: 75/10000 (0.7500%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0642, Accuracy: 305/1190 (25.6303%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 459/1190 (38.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.0195, Accuracy: 53/10000 (0.5300%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 336/1372 (24.4898%)
_Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   2, Avg loss: 0.0317, Accuracy: 465/1372 (33.8921%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6249, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0614, Accuracy: 300/946 (31.7125%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 348/946 (36.7865%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.2118, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   1, Avg loss: 0.0571, Accuracy: 305/712 (42.8371%)
_Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   2, Avg loss: 0.0290, Accuracy: 434/712 (60.9551%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8770, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   1, Avg loss: 0.0544, Accuracy: 294/599 (49.0818%)
_Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   2, Avg loss: 0.0307, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.4464, Accuracy: 50/10000 (0.5000%)
time spent on training: 154.5061366558075
[rfa agg] training data poison_ratio: 0.3128773631594576  data num: [1662, 818, 1402, 271, 1131, 1190, 1372, 946, 712, 599]
[rfa agg] considering poison per batch poison_fraction: 0.19554835197466097
[rfa agg] init. name: [94, 71, 66, 35, 38, 84, 42, 43, 11, 95], weight: tensor([0.1645, 0.0810, 0.1388, 0.0268, 0.1119, 0.1178, 0.1358, 0.0936, 0.0705,
        0.0593])
[rfa agg] iter:  0, prev_obj_val: 45.491661071777344, obj_val: 48.50692367553711, abs dis: 3.0152626037597656
[rfa agg] iter: 0, weight: tensor([0.0618, 0.0808, 0.0893, 0.0083, 0.2268, 0.1585, 0.0875, 0.1990, 0.0555,
        0.0325])
[rfa agg] iter:  1, prev_obj_val: 48.50692367553711, obj_val: 52.29914855957031, abs dis: 3.792224884033203
[rfa agg] iter: 1, weight: tensor([0.0509, 0.1008, 0.0691, 0.0082, 0.1394, 0.1066, 0.0677, 0.3581, 0.0644,
        0.0349])
[rfa agg] iter:  2, prev_obj_val: 52.29914855957031, obj_val: 54.59716033935547, abs dis: 2.2980117797851562
[rfa agg] iter: 2, weight: tensor([0.0439, 0.1465, 0.0566, 0.0086, 0.0956, 0.0790, 0.0554, 0.3909, 0.0835,
        0.0400])
[rfa agg] iter:  3, prev_obj_val: 54.59716033935547, obj_val: 59.56978225708008, abs dis: 4.972621917724609
[rfa agg] iter: 3, weight: tensor([0.0461, 0.2158, 0.0582, 0.0099, 0.0921, 0.0780, 0.0569, 0.2816, 0.1123,
        0.0492])
[rfa agg] iter:  4, prev_obj_val: 59.56978225708008, obj_val: 54.61201858520508, abs dis: 4.957763671875
[rfa agg] iter: 4, weight: tensor([0.0386, 0.3565, 0.0470, 0.0100, 0.0675, 0.0593, 0.0460, 0.1373, 0.1791,
        0.0587])
[rfa agg] iter:  5, prev_obj_val: 54.61201858520508, obj_val: 59.55668640136719, abs dis: 4.944667816162109
[rfa agg] iter: 5, weight: tensor([0.0463, 0.2402, 0.0584, 0.0099, 0.0924, 0.0783, 0.0571, 0.2542, 0.1139,
        0.0494])
[rfa agg] iter:  6, prev_obj_val: 59.55668640136719, obj_val: 59.51383972167969, abs dis: 0.0428466796875
[rfa agg] iter: 6, weight: tensor([0.0381, 0.3653, 0.0464, 0.0099, 0.0666, 0.0586, 0.0454, 0.1350, 0.1768,
        0.0580])
[rfa agg] iter:  7, prev_obj_val: 59.51383972167969, obj_val: 65.60697937011719, abs dis: 6.0931396484375
[rfa agg] iter: 7, weight: tensor([0.0352, 0.4135, 0.0428, 0.0092, 0.0615, 0.0541, 0.0419, 0.1225, 0.1656,
        0.0536])
[rfa agg] iter:  8, prev_obj_val: 65.60697937011719, obj_val: 69.00627136230469, abs dis: 3.3992919921875
[rfa agg] iter: 8, weight: tensor([0.0373, 0.2303, 0.0440, 0.0119, 0.0587, 0.0530, 0.0430, 0.0963, 0.3372,
        0.0883])
[rfa agg] iter:  9, prev_obj_val: 69.00627136230469, obj_val: 62.416236877441406, abs dis: 6.590034484863281
[rfa agg] iter: 9, weight: tensor([0.0397, 0.1731, 0.0462, 0.0141, 0.0598, 0.0546, 0.0452, 0.0918, 0.3500,
        0.1256])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3211, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.3696, Accuracy: 0/9950 (0.0000%)
saving model
Done in 586.3028674125671 sec.
Server Epoch:3 choose agents : [15, 88, 13, 42, 72, 22, 6, 0, 69, 17].
poison local model 15 index 6 
_Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0582, Accuracy: 319/1154 (27.6430%)
_Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0304, Accuracy: 412/1154 (35.7019%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.9645, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   1, Avg loss: 0.0767, Accuracy: 118/603 (19.5688%)
_Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   2, Avg loss: 0.0458, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.1136, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0594, Accuracy: 302/1645 (18.3587%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0334, Accuracy: 626/1645 (38.0547%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6609, Accuracy: 102/10000 (1.0200%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   1, Avg loss: 0.0543, Accuracy: 302/1372 (22.0117%)
_Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   2, Avg loss: 0.0321, Accuracy: 445/1372 (32.4344%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8212, Accuracy: 69/10000 (0.6900%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   1, Avg loss: 0.0608, Accuracy: 254/1241 (20.4674%)
_Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 388/1241 (31.2651%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.0449, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 507/1470 (34.4898%)
_Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   2, Avg loss: 0.0245, Accuracy: 826/1470 (56.1905%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.6346, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   1, Avg loss: 0.0564, Accuracy: 363/1956 (18.5583%)
_Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 618/1956 (31.5951%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.5228, Accuracy: 99/10000 (0.9900%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0583, Accuracy: 348/1657 (21.0018%)
_Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0355, Accuracy: 466/1657 (28.1231%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7569, Accuracy: 54/10000 (0.5400%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0546, Accuracy: 280/590 (47.4576%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.4163, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 400/1574 (25.4130%)
_Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 658/1574 (41.8043%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0341, Accuracy: 107/10000 (1.0700%)
time spent on training: 183.8999626636505
[rfa agg] training data poison_ratio: 0.4534760971195898  data num: [1154, 603, 1645, 1372, 1241, 1470, 1956, 1657, 590, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.28342256069974364
[rfa agg] init. name: [15, 88, 13, 42, 72, 22, 6, 0, 69, 17], weight: tensor([0.0870, 0.0455, 0.1240, 0.1035, 0.0936, 0.1108, 0.1475, 0.1249, 0.0445,
        0.1187])
[rfa agg] iter:  0, prev_obj_val: 46.46482849121094, obj_val: 54.30425262451172, abs dis: 7.839424133300781
[rfa agg] iter: 0, weight: tensor([0.1498, 0.0134, 0.0685, 0.1777, 0.2587, 0.1269, 0.0432, 0.0690, 0.0131,
        0.0798])
[rfa agg] iter:  1, prev_obj_val: 54.30425262451172, obj_val: 51.30710983276367, abs dis: 2.997142791748047
[rfa agg] iter: 1, weight: tensor([0.3019, 0.0168, 0.0585, 0.1102, 0.2407, 0.0899, 0.0410, 0.0590, 0.0165,
        0.0654])
[rfa agg] iter:  2, prev_obj_val: 51.30710983276367, obj_val: 51.30286407470703, abs dis: 0.004245758056640625
[rfa agg] iter: 2, weight: tensor([0.2772, 0.0142, 0.0560, 0.1139, 0.2768, 0.0902, 0.0380, 0.0565, 0.0139,
        0.0632])
[rfa agg] iter:  3, prev_obj_val: 51.30286407470703, obj_val: 51.30244445800781, abs dis: 0.00041961669921875
[rfa agg] iter: 3, weight: tensor([0.2678, 0.0142, 0.0559, 0.1138, 0.2870, 0.0901, 0.0380, 0.0563, 0.0139,
        0.0631])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3278, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.3655, Accuracy: 0/9950 (0.0000%)
saving model
Done in 618.3693051338196 sec.
Server Epoch:4 choose agents : [31, 94, 47, 15, 11, 35, 62, 77, 21, 93].
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0799, Accuracy: 66/460 (14.3478%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0368, Accuracy: 183/460 (39.7826%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.1597, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 340/1662 (20.4573%)
_Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   2, Avg loss: 0.0336, Accuracy: 581/1662 (34.9579%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.8960, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   1, Avg loss: 0.1272, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   2, Avg loss: 0.1116, Accuracy: 2/134 (1.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3444, Accuracy: 52/10000 (0.5200%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   1, Avg loss: 0.0559, Accuracy: 315/1154 (27.2964%)
_Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   2, Avg loss: 0.0310, Accuracy: 450/1154 (38.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.9949, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   1, Avg loss: 0.0540, Accuracy: 307/712 (43.1180%)
_Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   2, Avg loss: 0.0269, Accuracy: 396/712 (55.6180%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.9995, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   1, Avg loss: 0.0866, Accuracy: 20/271 (7.3801%)
_Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   2, Avg loss: 0.0568, Accuracy: 102/271 (37.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.4468, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0725, Accuracy: 101/568 (17.7817%)
_Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0426, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.9489, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0533, Accuracy: 339/1340 (25.2985%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 540/1340 (40.2985%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.7499, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0545, Accuracy: 390/1949 (20.0103%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0336, Accuracy: 596/1949 (30.5798%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.5417, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   1, Avg loss: 0.0585, Accuracy: 358/1742 (20.5511%)
_Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   2, Avg loss: 0.0324, Accuracy: 699/1742 (40.1263%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.9004, Accuracy: 77/10000 (0.7700%)
time spent on training: 131.03573775291443
[rfa agg] training data poison_ratio: 0.11549239391513211  data num: [460, 1662, 134, 1154, 712, 271, 568, 1340, 1949, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.07218274619695757
[rfa agg] init. name: [31, 94, 47, 15, 11, 35, 62, 77, 21, 93], weight: tensor([0.0460, 0.1663, 0.0134, 0.1155, 0.0713, 0.0271, 0.0568, 0.1341, 0.1951,
        0.1743])
[rfa agg] iter:  0, prev_obj_val: 65.56229400634766, obj_val: 66.9575424194336, abs dis: 1.3952484130859375
[rfa agg] iter: 0, weight: tensor([0.0145, 0.1026, 0.0029, 0.3028, 0.0335, 0.0068, 0.0195, 0.3692, 0.0666,
        0.0816])
[rfa agg] iter:  1, prev_obj_val: 66.9575424194336, obj_val: 68.71168518066406, abs dis: 1.7541427612304688
[rfa agg] iter: 1, weight: tensor([0.0141, 0.0889, 0.0028, 0.4164, 0.0334, 0.0066, 0.0191, 0.2869, 0.0597,
        0.0720])
[rfa agg] iter:  2, prev_obj_val: 68.71168518066406, obj_val: 70.82909393310547, abs dis: 2.1174087524414062
[rfa agg] iter: 2, weight: tensor([0.0135, 0.0758, 0.0027, 0.5344, 0.0328, 0.0062, 0.0184, 0.2014, 0.0524,
        0.0624])
[rfa agg] iter:  3, prev_obj_val: 70.82909393310547, obj_val: 73.22686767578125, abs dis: 2.3977737426757812
[rfa agg] iter: 3, weight: tensor([0.0153, 0.0767, 0.0030, 0.5444, 0.0381, 0.0070, 0.0209, 0.1761, 0.0545,
        0.0639])
[rfa agg] iter:  4, prev_obj_val: 73.22686767578125, obj_val: 68.6883544921875, abs dis: 4.53851318359375
[rfa agg] iter: 4, weight: tensor([0.0206, 0.0921, 0.0040, 0.4574, 0.0527, 0.0093, 0.0282, 0.1909, 0.0671,
        0.0777])
[rfa agg] iter:  5, prev_obj_val: 68.6883544921875, obj_val: 70.82852172851562, abs dis: 2.140167236328125
[rfa agg] iter: 5, weight: tensor([0.0129, 0.0721, 0.0026, 0.5607, 0.0312, 0.0059, 0.0175, 0.1879, 0.0499,
        0.0593])
[rfa agg] iter:  6, prev_obj_val: 70.82852172851562, obj_val: 73.22885131835938, abs dis: 2.40032958984375
[rfa agg] iter: 6, weight: tensor([0.0151, 0.0754, 0.0029, 0.5526, 0.0375, 0.0069, 0.0206, 0.1726, 0.0536,
        0.0629])
[rfa agg] iter:  7, prev_obj_val: 73.22885131835938, obj_val: 68.68793487548828, abs dis: 4.540916442871094
[rfa agg] iter: 7, weight: tensor([0.0205, 0.0919, 0.0040, 0.4585, 0.0526, 0.0093, 0.0282, 0.1905, 0.0669,
        0.0776])
[rfa agg] iter:  8, prev_obj_val: 68.68793487548828, obj_val: 70.82852172851562, abs dis: 2.1405868530273438
[rfa agg] iter: 8, weight: tensor([0.0129, 0.0720, 0.0026, 0.5612, 0.0312, 0.0059, 0.0175, 0.1877, 0.0498,
        0.0592])
[rfa agg] iter:  9, prev_obj_val: 70.82852172851562, obj_val: 70.82793426513672, abs dis: 0.00058746337890625
[rfa agg] iter: 9, weight: tensor([0.0151, 0.0754, 0.0029, 0.5528, 0.0375, 0.0069, 0.0206, 0.1725, 0.0536,
        0.0629])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3748, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.4925, Accuracy: 0/9950 (0.0000%)
saving model
Done in 586.1884088516235 sec.
Server Epoch:5 choose agents : [91, 78, 82, 2, 77, 31, 70, 65, 60, 36].
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0498, Accuracy: 336/1030 (32.6214%)
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0259, Accuracy: 627/1030 (60.8738%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.5549, Accuracy: 93/10000 (0.9300%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   1, Avg loss: 0.0826, Accuracy: 28/416 (6.7308%)
_Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   2, Avg loss: 0.0470, Accuracy: 164/416 (39.4231%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.9729, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0758, Accuracy: 66/500 (13.2000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.3231, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 215/605 (35.5372%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.1368, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   1, Avg loss: 0.0524, Accuracy: 344/1340 (25.6716%)
_Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   2, Avg loss: 0.0267, Accuracy: 579/1340 (43.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.0993, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   1, Avg loss: 0.0797, Accuracy: 52/460 (11.3043%)
_Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   2, Avg loss: 0.0357, Accuracy: 191/460 (41.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.4473, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   1, Avg loss: 0.0574, Accuracy: 319/1418 (22.4965%)
_Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   2, Avg loss: 0.0317, Accuracy: 646/1418 (45.5571%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1272, Accuracy: 83/10000 (0.8300%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   1, Avg loss: 0.0604, Accuracy: 358/1475 (24.2712%)
_Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 663/1475 (44.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.1698, Accuracy: 85/10000 (0.8500%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   1, Avg loss: 0.0506, Accuracy: 570/2227 (25.5950%)
_Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   2, Avg loss: 0.0287, Accuracy: 991/2227 (44.4993%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1864, Accuracy: 118/10000 (1.1800%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   1, Avg loss: 0.0946, Accuracy: 26/408 (6.3725%)
_Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   2, Avg loss: 0.0585, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7894, Accuracy: 50/10000 (0.5000%)
time spent on training: 156.64692950248718
[rfa agg] training data poison_ratio: 0.4581435367952222  data num: [1030, 416, 500, 605, 1340, 460, 1418, 1475, 2227, 408]
[rfa agg] considering poison per batch poison_fraction: 0.28633971049701384
[rfa agg] init. name: [91, 78, 82, 2, 77, 31, 70, 65, 60, 36], weight: tensor([0.1043, 0.0421, 0.0506, 0.0612, 0.1356, 0.0466, 0.1435, 0.1493, 0.2254,
        0.0413])
[rfa agg] iter:  0, prev_obj_val: 74.39251708984375, obj_val: 75.7176742553711, abs dis: 1.3251571655273438
[rfa agg] iter: 0, weight: tensor([0.2695, 0.0184, 0.0242, 0.0361, 0.2524, 0.0223, 0.1558, 0.1343, 0.0688,
        0.0180])
[rfa agg] iter:  1, prev_obj_val: 75.7176742553711, obj_val: 78.88837432861328, abs dis: 3.1707000732421875
[rfa agg] iter: 1, weight: tensor([0.3499, 0.0185, 0.0245, 0.0369, 0.2100, 0.0225, 0.1361, 0.1189, 0.0644,
        0.0182])
[rfa agg] iter:  2, prev_obj_val: 78.88837432861328, obj_val: 80.77108764648438, abs dis: 1.8827133178710938
[rfa agg] iter: 2, weight: tensor([0.4886, 0.0182, 0.0243, 0.0376, 0.1430, 0.0224, 0.1021, 0.0915, 0.0544,
        0.0178])
[rfa agg] iter:  3, prev_obj_val: 80.77108764648438, obj_val: 80.76860046386719, abs dis: 0.0024871826171875
[rfa agg] iter: 3, weight: tensor([0.5145, 0.0191, 0.0256, 0.0403, 0.1265, 0.0236, 0.0939, 0.0851, 0.0527,
        0.0187])
[rfa agg] iter:  4, prev_obj_val: 80.76860046386719, obj_val: 80.76834869384766, abs dis: 0.00025177001953125
[rfa agg] iter: 4, weight: tensor([0.5241, 0.0187, 0.0251, 0.0395, 0.1239, 0.0231, 0.0920, 0.0835, 0.0517,
        0.0183])
[rfa agg] iter:  5, prev_obj_val: 80.76834869384766, obj_val: 82.92295837402344, abs dis: 2.1546096801757812
[rfa agg] iter: 5, weight: tensor([0.5274, 0.0186, 0.0250, 0.0392, 0.1230, 0.0230, 0.0914, 0.0829, 0.0514,
        0.0182])
[rfa agg] iter:  6, prev_obj_val: 82.92295837402344, obj_val: 80.77748107910156, abs dis: 2.145477294921875
[rfa agg] iter: 6, weight: tensor([0.4457, 0.0238, 0.0322, 0.0515, 0.1353, 0.0296, 0.1033, 0.0946, 0.0608,
        0.0233])
[rfa agg] iter:  7, prev_obj_val: 80.77748107910156, obj_val: 80.76932525634766, abs dis: 0.00815582275390625
[rfa agg] iter: 7, weight: tensor([0.5018, 0.0196, 0.0263, 0.0413, 0.1299, 0.0242, 0.0963, 0.0873, 0.0541,
        0.0192])
[rfa agg] iter:  8, prev_obj_val: 80.76932525634766, obj_val: 80.7684326171875, abs dis: 0.00089263916015625
[rfa agg] iter: 8, weight: tensor([0.5198, 0.0189, 0.0253, 0.0399, 0.1251, 0.0233, 0.0928, 0.0842, 0.0522,
        0.0185])
[rfa agg] iter:  9, prev_obj_val: 80.7684326171875, obj_val: 82.92255401611328, abs dis: 2.1541213989257812
[rfa agg] iter: 9, weight: tensor([0.5259, 0.0186, 0.0250, 0.0394, 0.1234, 0.0230, 0.0917, 0.0832, 0.0515,
        0.0183])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.4113, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.5743, Accuracy: 0/9950 (0.0000%)
saving model
Done in 594.284520149231 sec.
Server Epoch:6 choose agents : [63, 42, 69, 72, 83, 44, 79, 50, 66, 74].
_Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0526, Accuracy: 285/888 (32.0946%)
_Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 425/888 (47.8604%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.5032, Accuracy: 53/10000 (0.5300%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0560, Accuracy: 264/1372 (19.2420%)
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0323, Accuracy: 493/1372 (35.9329%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8914, Accuracy: 68/10000 (0.6800%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   1, Avg loss: 0.0537, Accuracy: 281/590 (47.6271%)
_Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   2, Avg loss: 0.0282, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8370, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   1, Avg loss: 0.0623, Accuracy: 250/1241 (20.1450%)
_Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 369/1241 (29.7341%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.4923, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   1, Avg loss: 0.0556, Accuracy: 410/1953 (20.9933%)
_Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   2, Avg loss: 0.0343, Accuracy: 731/1953 (37.4296%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.5707, Accuracy: 90/10000 (0.9000%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0629, Accuracy: 321/1750 (18.3429%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0363, Accuracy: 616/1750 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.9545, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   1, Avg loss: 0.0973, Accuracy: 36/197 (18.2741%)
_Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   2, Avg loss: 0.0793, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.5021, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0679, Accuracy: 109/809 (13.4734%)
_Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0293, Accuracy: 302/809 (37.3300%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.9830, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   1, Avg loss: 0.0622, Accuracy: 257/1402 (18.3310%)
_Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 379/1402 (27.0328%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.4701, Accuracy: 77/10000 (0.7700%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0443, Accuracy: 468/1552 (30.1546%)
_Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 739/1552 (47.6160%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 10.7473, Accuracy: 87/10000 (0.8700%)
time spent on training: 184.62454962730408
[rfa agg] training data poison_ratio: 0.5534286200442402  data num: [888, 1372, 590, 1241, 1953, 1750, 197, 809, 1402, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.34589288752765013
[rfa agg] init. name: [63, 42, 69, 72, 83, 44, 79, 50, 66, 74], weight: tensor([0.0755, 0.1167, 0.0502, 0.1056, 0.1662, 0.1489, 0.0168, 0.0688, 0.1193,
        0.1320])
[rfa agg] iter:  0, prev_obj_val: 50.960548400878906, obj_val: 54.173240661621094, abs dis: 3.2126922607421875
[rfa agg] iter: 0, weight: tensor([0.0323, 0.2276, 0.0137, 0.2344, 0.0498, 0.0633, 0.0030, 0.0258, 0.2537,
        0.0962])
[rfa agg] iter:  1, prev_obj_val: 54.173240661621094, obj_val: 56.24821090698242, abs dis: 2.074970245361328
[rfa agg] iter: 1, weight: tensor([0.0388, 0.1606, 0.0156, 0.3972, 0.0467, 0.0572, 0.0032, 0.0304, 0.1701,
        0.0802])
[rfa agg] iter:  2, prev_obj_val: 56.24821090698242, obj_val: 58.629188537597656, abs dis: 2.3809776306152344
[rfa agg] iter: 2, weight: tensor([0.0448, 0.1400, 0.0174, 0.4304, 0.0474, 0.0572, 0.0035, 0.0347, 0.1469,
        0.0777])
[rfa agg] iter:  3, prev_obj_val: 58.629188537597656, obj_val: 58.62355041503906, abs dis: 0.00563812255859375
[rfa agg] iter: 3, weight: tensor([0.0596, 0.1451, 0.0223, 0.3639, 0.0552, 0.0657, 0.0044, 0.0455, 0.1514,
        0.0868])
[rfa agg] iter:  4, prev_obj_val: 58.62355041503906, obj_val: 58.62348175048828, abs dis: 6.866455078125e-05
[rfa agg] iter: 4, weight: tensor([0.0603, 0.1470, 0.0225, 0.3568, 0.0558, 0.0664, 0.0045, 0.0460, 0.1531,
        0.0877])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.5646, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.4249, Accuracy: 0/9950 (0.0000%)
saving model
Done in 615.0926859378815 sec.
Server Epoch:7 choose agents : [82, 90, 50, 35, 0, 79, 25, 37, 16, 60].
_Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0776, Accuracy: 61/500 (12.2000%)
_Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0495, Accuracy: 182/500 (36.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.3737, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0648, Accuracy: 246/677 (36.3368%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0242, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1901, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   1, Avg loss: 0.0661, Accuracy: 126/809 (15.5748%)
_Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   2, Avg loss: 0.0290, Accuracy: 328/809 (40.5439%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.9596, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0887, Accuracy: 31/271 (11.4391%)
_Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0609, Accuracy: 97/271 (35.7934%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6546, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   1, Avg loss: 0.0592, Accuracy: 353/1657 (21.3036%)
_Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   2, Avg loss: 0.0352, Accuracy: 511/1657 (30.8389%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.9580, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.0983, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0833, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.5008, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
_Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0577, Accuracy: 278/690 (40.2899%)
_Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.1601, Accuracy: 72/10000 (0.7200%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   1, Avg loss: 0.0555, Accuracy: 334/1129 (29.5837%)
_Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   2, Avg loss: 0.0255, Accuracy: 694/1129 (61.4703%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1606, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   1, Avg loss: 0.0627, Accuracy: 266/708 (37.5706%)
_Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   2, Avg loss: 0.0373, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.1846, Accuracy: 52/10000 (0.5200%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0509, Accuracy: 572/2227 (25.6848%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1028/2227 (46.1608%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.3472, Accuracy: 117/10000 (1.1700%)
time spent on training: 164.19638061523438
[rfa agg] training data poison_ratio: 0.6433164128595601  data num: [500, 677, 809, 271, 1657, 197, 690, 1129, 708, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.4020727580372251
[rfa agg] init. name: [82, 90, 50, 35, 0, 79, 25, 37, 16, 60], weight: tensor([0.0564, 0.0764, 0.0913, 0.0306, 0.1869, 0.0222, 0.0778, 0.1274, 0.0799,
        0.2512])
[rfa agg] iter:  0, prev_obj_val: 82.93567657470703, obj_val: 84.74801635742188, abs dis: 1.8123397827148438
[rfa agg] iter: 0, weight: tensor([0.0291, 0.0576, 0.0982, 0.0120, 0.1076, 0.0080, 0.0586, 0.4876, 0.0706,
        0.0706])
[rfa agg] iter:  1, prev_obj_val: 84.74801635742188, obj_val: 86.56224060058594, abs dis: 1.8142242431640625
[rfa agg] iter: 1, weight: tensor([0.0410, 0.0916, 0.1879, 0.0158, 0.0973, 0.0105, 0.0933, 0.2709, 0.1211,
        0.0707])
[rfa agg] iter:  2, prev_obj_val: 86.56224060058594, obj_val: 89.43521118164062, abs dis: 2.8729705810546875
[rfa agg] iter: 2, weight: tensor([0.0399, 0.1063, 0.3128, 0.0143, 0.0665, 0.0093, 0.1080, 0.1330, 0.1586,
        0.0512])
[rfa agg] iter:  3, prev_obj_val: 89.43521118164062, obj_val: 95.49769592285156, abs dis: 6.0624847412109375
[rfa agg] iter: 3, weight: tensor([0.0339, 0.1285, 0.3195, 0.0110, 0.0379, 0.0070, 0.1291, 0.0624, 0.2400,
        0.0307])
[rfa agg] iter:  4, prev_obj_val: 95.49769592285156, obj_val: 101.7128677368164, abs dis: 6.215171813964844
[rfa agg] iter: 4, weight: tensor([0.0443, 0.2942, 0.1069, 0.0121, 0.0304, 0.0075, 0.2748, 0.0439, 0.1605,
        0.0256])
[rfa agg] iter:  5, prev_obj_val: 101.7128677368164, obj_val: 95.39076232910156, abs dis: 6.322105407714844
[rfa agg] iter: 5, weight: tensor([0.0954, 0.2463, 0.1067, 0.0213, 0.0422, 0.0128, 0.2463, 0.0570, 0.1356,
        0.0363])
[rfa agg] iter:  6, prev_obj_val: 95.39076232910156, obj_val: 101.715087890625, abs dis: 6.3243255615234375
[rfa agg] iter: 6, weight: tensor([0.0403, 0.3133, 0.0936, 0.0109, 0.0273, 0.0068, 0.3054, 0.0395, 0.1399,
        0.0230])
[rfa agg] iter:  7, prev_obj_val: 101.715087890625, obj_val: 95.39055633544922, abs dis: 6.324531555175781
[rfa agg] iter: 7, weight: tensor([0.0951, 0.2465, 0.1064, 0.0212, 0.0421, 0.0128, 0.2479, 0.0569, 0.1348,
        0.0363])
[rfa agg] iter:  8, prev_obj_val: 95.39055633544922, obj_val: 101.71510314941406, abs dis: 6.324546813964844
[rfa agg] iter: 8, weight: tensor([0.0403, 0.3131, 0.0935, 0.0109, 0.0273, 0.0068, 0.3059, 0.0394, 0.1398,
        0.0230])
[rfa agg] iter:  9, prev_obj_val: 101.71510314941406, obj_val: 95.39054870605469, abs dis: 6.324554443359375
[rfa agg] iter: 9, weight: tensor([0.0951, 0.2465, 0.1064, 0.0212, 0.0421, 0.0128, 0.2479, 0.0569, 0.1348,
        0.0363])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.1656, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 6.8188, Accuracy: 0/9950 (0.0000%)
saving model
Done in 602.7854549884796 sec.
Server Epoch:8 choose agents : [94, 35, 21, 1, 88, 43, 68, 27, 19, 92].
_Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   1, Avg loss: 0.0537, Accuracy: 343/1662 (20.6378%)
_Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   2, Avg loss: 0.0336, Accuracy: 599/1662 (36.0409%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.5005, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   1, Avg loss: 0.0920, Accuracy: 9/271 (3.3210%)
_Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   2, Avg loss: 0.0607, Accuracy: 95/271 (35.0554%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.7918, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0553, Accuracy: 393/1949 (20.1642%)
_Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 656/1949 (33.6583%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.5097, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0600, Accuracy: 243/928 (26.1853%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0248, Accuracy: 532/928 (57.3276%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.1806, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   1, Avg loss: 0.0804, Accuracy: 104/603 (17.2471%)
_Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   2, Avg loss: 0.0478, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.6411, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   1, Avg loss: 0.0615, Accuracy: 308/946 (32.5581%)
_Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   2, Avg loss: 0.0354, Accuracy: 377/946 (39.8520%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.4545, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   1, Avg loss: 0.0628, Accuracy: 346/1163 (29.7506%)
_Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   2, Avg loss: 0.0367, Accuracy: 481/1163 (41.3586%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.0483, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   1, Avg loss: 0.0560, Accuracy: 350/1587 (22.0542%)
_Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 563/1587 (35.4757%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9307, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 340/1036 (32.8185%)
_Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   2, Avg loss: 0.0259, Accuracy: 607/1036 (58.5907%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 10.7188, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   1, Avg loss: 0.0535, Accuracy: 404/1715 (23.5569%)
_Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   2, Avg loss: 0.0315, Accuracy: 658/1715 (38.3673%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.7448, Accuracy: 74/10000 (0.7400%)
time spent on training: 132.49563455581665
[rfa agg] training data poison_ratio: 0.0  data num: [1662, 271, 1949, 928, 603, 946, 1163, 1587, 1036, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [94, 35, 21, 1, 88, 43, 68, 27, 19, 92], weight: tensor([0.1401, 0.0228, 0.1643, 0.0782, 0.0508, 0.0798, 0.0981, 0.1338, 0.0874,
        0.1446])
[rfa agg] iter:  0, prev_obj_val: 57.96044158935547, obj_val: 58.77680206298828, abs dis: 0.8163604736328125
[rfa agg] iter: 0, weight: tensor([0.1063, 0.0070, 0.0689, 0.0704, 0.0235, 0.0727, 0.3088, 0.1216, 0.1271,
        0.0938])
[rfa agg] iter:  1, prev_obj_val: 58.77680206298828, obj_val: 61.202552795410156, abs dis: 2.425750732421875
[rfa agg] iter: 1, weight: tensor([0.0842, 0.0062, 0.0565, 0.0663, 0.0212, 0.0689, 0.3985, 0.0949, 0.1282,
        0.0751])
[rfa agg] iter:  2, prev_obj_val: 61.202552795410156, obj_val: 64.53763580322266, abs dis: 3.3350830078125
[rfa agg] iter: 2, weight: tensor([0.0665, 0.0060, 0.0472, 0.0752, 0.0214, 0.0791, 0.3995, 0.0732, 0.1714,
        0.0604])
[rfa agg] iter:  3, prev_obj_val: 64.53763580322266, obj_val: 66.34691619873047, abs dis: 1.8092803955078125
[rfa agg] iter: 3, weight: tensor([0.0620, 0.0069, 0.0461, 0.1047, 0.0256, 0.1132, 0.2235, 0.0671, 0.2937,
        0.0572])
[rfa agg] iter:  4, prev_obj_val: 66.34691619873047, obj_val: 73.51751708984375, abs dis: 7.170600891113281
[rfa agg] iter: 4, weight: tensor([0.0539, 0.0066, 0.0408, 0.1146, 0.0251, 0.1278, 0.1542, 0.0579, 0.3692,
        0.0499])
[rfa agg] iter:  5, prev_obj_val: 73.51751708984375, obj_val: 73.41800689697266, abs dis: 0.09951019287109375
[rfa agg] iter: 5, weight: tensor([0.0477, 0.0077, 0.0380, 0.2012, 0.0328, 0.2923, 0.0965, 0.0504, 0.1885,
        0.0448])
[rfa agg] iter:  6, prev_obj_val: 73.41800689697266, obj_val: 73.41643524169922, abs dis: 0.0015716552734375
[rfa agg] iter: 6, weight: tensor([0.0453, 0.0073, 0.0362, 0.2142, 0.0312, 0.3149, 0.0912, 0.0479, 0.1692,
        0.0426])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.1234, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 7.2873, Accuracy: 0/9950 (0.0000%)
saving model
Done in 567.4519197940826 sec.
Server Epoch:9 choose agents : [57, 42, 90, 21, 49, 84, 77, 18, 56, 65].
_Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   1, Avg loss: 0.0584, Accuracy: 246/1154 (21.3172%)
_Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   2, Avg loss: 0.0277, Accuracy: 449/1154 (38.9081%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 11.5739, Accuracy: 52/10000 (0.5200%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   1, Avg loss: 0.0557, Accuracy: 266/1372 (19.3878%)
_Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 499/1372 (36.3703%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.0585, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0600, Accuracy: 285/677 (42.0975%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0246, Accuracy: 454/677 (67.0606%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.3069, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   1, Avg loss: 0.0555, Accuracy: 354/1949 (18.1632%)
_Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   2, Avg loss: 0.0335, Accuracy: 624/1949 (32.0164%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.4338, Accuracy: 73/10000 (0.7300%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   1, Avg loss: 0.0792, Accuracy: 23/440 (5.2273%)
_Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   2, Avg loss: 0.0488, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.3274, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0634, Accuracy: 294/1190 (24.7059%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 444/1190 (37.3109%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7417, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0536, Accuracy: 324/1340 (24.1791%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 527/1340 (39.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 9.1937, Accuracy: 86/10000 (0.8600%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   1, Avg loss: 0.0843, Accuracy: 58/530 (10.9434%)
_Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   2, Avg loss: 0.0396, Accuracy: 261/530 (49.2453%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.3007, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0917, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0763, Accuracy: 15/186 (8.0645%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.5649, Accuracy: 53/10000 (0.5300%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0583, Accuracy: 341/1475 (23.1186%)
_Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0327, Accuracy: 608/1475 (41.2203%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.4961, Accuracy: 88/10000 (0.8800%)
time spent on training: 183.20066165924072
[rfa agg] training data poison_ratio: 0.48550373315233203  data num: [1154, 1372, 677, 1949, 440, 1190, 1340, 530, 186, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.3034398332202075
[rfa agg] init. name: [57, 42, 90, 21, 49, 84, 77, 18, 56, 65], weight: tensor([0.1119, 0.1330, 0.0656, 0.1890, 0.0427, 0.1154, 0.1299, 0.0514, 0.0180,
        0.1430])
[rfa agg] iter:  0, prev_obj_val: 56.96103286743164, obj_val: 54.44339370727539, abs dis: 2.51763916015625
[rfa agg] iter: 0, weight: tensor([0.2533, 0.1182, 0.0344, 0.0535, 0.0142, 0.2665, 0.1488, 0.0209, 0.0044,
        0.0856])
[rfa agg] iter:  1, prev_obj_val: 54.44339370727539, obj_val: 56.785682678222656, abs dis: 2.3422889709472656
[rfa agg] iter: 1, weight: tensor([0.2704, 0.1088, 0.0262, 0.0453, 0.0111, 0.2999, 0.1431, 0.0162, 0.0034,
        0.0755])
[rfa agg] iter:  2, prev_obj_val: 56.785682678222656, obj_val: 62.01628112792969, abs dis: 5.230598449707031
[rfa agg] iter: 2, weight: tensor([0.2592, 0.1119, 0.0326, 0.0507, 0.0135, 0.2847, 0.1424, 0.0199, 0.0041,
        0.0810])
[rfa agg] iter:  3, prev_obj_val: 62.01628112792969, obj_val: 56.79207229614258, abs dis: 5.224208831787109
[rfa agg] iter: 3, weight: tensor([0.2280, 0.1215, 0.0507, 0.0630, 0.0198, 0.2409, 0.1468, 0.0298, 0.0059,
        0.0936])
[rfa agg] iter:  4, prev_obj_val: 56.79207229614258, obj_val: 59.342796325683594, abs dis: 2.5507240295410156
[rfa agg] iter: 4, weight: tensor([0.2591, 0.1134, 0.0330, 0.0513, 0.0137, 0.2792, 0.1440, 0.0201, 0.0042,
        0.0820])
[rfa agg] iter:  5, prev_obj_val: 59.342796325683594, obj_val: 56.786460876464844, abs dis: 2.55633544921875
[rfa agg] iter: 5, weight: tensor([0.2441, 0.1176, 0.0411, 0.0572, 0.0166, 0.2605, 0.1453, 0.0246, 0.0050,
        0.0880])
[rfa agg] iter:  6, prev_obj_val: 56.786460876464844, obj_val: 59.342960357666016, abs dis: 2.556499481201172
[rfa agg] iter: 6, weight: tensor([0.2595, 0.1129, 0.0329, 0.0511, 0.0136, 0.2809, 0.1434, 0.0200, 0.0042,
        0.0816])
[rfa agg] iter:  7, prev_obj_val: 59.342960357666016, obj_val: 56.78644943237305, abs dis: 2.5565109252929688
[rfa agg] iter: 7, weight: tensor([0.2441, 0.1176, 0.0411, 0.0572, 0.0166, 0.2606, 0.1453, 0.0246, 0.0050,
        0.0880])
[rfa agg] iter:  8, prev_obj_val: 56.78644943237305, obj_val: 59.34296798706055, abs dis: 2.5565185546875
[rfa agg] iter: 8, weight: tensor([0.2594, 0.1129, 0.0329, 0.0511, 0.0136, 0.2809, 0.1434, 0.0200, 0.0042,
        0.0816])
[rfa agg] iter:  9, prev_obj_val: 59.34296798706055, obj_val: 56.78644943237305, abs dis: 2.5565185546875
[rfa agg] iter: 9, weight: tensor([0.2441, 0.1176, 0.0411, 0.0572, 0.0166, 0.2606, 0.1453, 0.0246, 0.0050,
        0.0880])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.7398, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 9.8533, Accuracy: 0/9950 (0.0000%)
saving model
Done in 637.0324883460999 sec.
Server Epoch:10 choose agents : [5, 23, 83, 66, 54, 46, 86, 78, 84, 8].
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0526, Accuracy: 359/1628 (22.0516%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0277, Accuracy: 696/1628 (42.7518%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.8150, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   1, Avg loss: 0.0710, Accuracy: 276/715 (38.6014%)
_Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   2, Avg loss: 0.0389, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.0704, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   1, Avg loss: 0.0566, Accuracy: 376/1953 (19.2524%)
_Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   2, Avg loss: 0.0343, Accuracy: 728/1953 (37.2760%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.6849, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   1, Avg loss: 0.0640, Accuracy: 261/1402 (18.6163%)
_Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   2, Avg loss: 0.0400, Accuracy: 351/1402 (25.0357%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.0412, Accuracy: 75/10000 (0.7500%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   1, Avg loss: 0.0518, Accuracy: 371/1130 (32.8319%)
_Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   2, Avg loss: 0.0301, Accuracy: 458/1130 (40.5310%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 9.0589, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   1, Avg loss: 0.0561, Accuracy: 401/1904 (21.0609%)
_Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 690/1904 (36.2395%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.9443, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   1, Avg loss: 0.0652, Accuracy: 327/1003 (32.6022%)
_Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   2, Avg loss: 0.0366, Accuracy: 379/1003 (37.7866%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.0935, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   1, Avg loss: 0.0837, Accuracy: 16/416 (3.8462%)
_Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   2, Avg loss: 0.0480, Accuracy: 198/416 (47.5962%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.0469, Accuracy: 61/10000 (0.6100%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 299/1190 (25.1261%)
_Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 435/1190 (36.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.7306, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   1, Avg loss: 0.0629, Accuracy: 206/1513 (13.6153%)
_Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 460/1513 (30.4032%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.1397, Accuracy: 95/10000 (0.9500%)
time spent on training: 187.80838751792908
[rfa agg] training data poison_ratio: 0.3395052123852497  data num: [1628, 715, 1953, 1402, 1130, 1904, 1003, 416, 1190, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.21219075774078108
[rfa agg] init. name: [5, 23, 83, 66, 54, 46, 86, 78, 84, 8], weight: tensor([0.1267, 0.0556, 0.1519, 0.1091, 0.0879, 0.1481, 0.0780, 0.0324, 0.0926,
        0.1177])
[rfa agg] iter:  0, prev_obj_val: 54.62596130371094, obj_val: 59.205299377441406, abs dis: 4.579338073730469
[rfa agg] iter: 0, weight: tensor([0.0929, 0.0268, 0.0595, 0.2231, 0.1322, 0.0639, 0.0697, 0.0099, 0.1915,
        0.1305])
[rfa agg] iter:  1, prev_obj_val: 59.205299377441406, obj_val: 66.0285415649414, abs dis: 6.8232421875
[rfa agg] iter: 1, weight: tensor([0.0650, 0.0286, 0.0460, 0.1239, 0.2155, 0.0489, 0.0897, 0.0098, 0.2892,
        0.0834])
[rfa agg] iter:  2, prev_obj_val: 66.0285415649414, obj_val: 68.78823852539062, abs dis: 2.7596969604492188
[rfa agg] iter: 2, weight: tensor([0.0558, 0.0373, 0.0425, 0.0883, 0.2967, 0.0447, 0.1623, 0.0116, 0.1935,
        0.0673])
[rfa agg] iter:  3, prev_obj_val: 68.78823852539062, obj_val: 65.98370361328125, abs dis: 2.804534912109375
[rfa agg] iter: 3, weight: tensor([0.0554, 0.0429, 0.0430, 0.0838, 0.2654, 0.0451, 0.2268, 0.0127, 0.1592,
        0.0657])
[rfa agg] iter:  4, prev_obj_val: 65.98370361328125, obj_val: 68.78799438476562, abs dis: 2.804290771484375
[rfa agg] iter: 4, weight: tensor([0.0542, 0.0363, 0.0413, 0.0854, 0.3197, 0.0434, 0.1663, 0.0112, 0.1769,
        0.0653])
[rfa agg] iter:  5, prev_obj_val: 68.78799438476562, obj_val: 68.77997589111328, abs dis: 0.00801849365234375
[rfa agg] iter: 5, weight: tensor([0.0551, 0.0427, 0.0429, 0.0834, 0.2686, 0.0449, 0.2266, 0.0127, 0.1576,
        0.0655])
[rfa agg] iter:  6, prev_obj_val: 68.77997589111328, obj_val: 68.77984619140625, abs dis: 0.00012969970703125
[rfa agg] iter: 6, weight: tensor([0.0551, 0.0427, 0.0428, 0.0834, 0.2620, 0.0449, 0.2343, 0.0127, 0.1568,
        0.0654])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.8817, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 11.6239, Accuracy: 0/9950 (0.0000%)
saving model
Done in 625.217440366745 sec.
Server Epoch:11 choose agents : [38, 24, 45, 8, 65, 19, 49, 17, 40, 22].
_Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   1, Avg loss: 0.0680, Accuracy: 191/1131 (16.8877%)
_Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   2, Avg loss: 0.0324, Accuracy: 463/1131 (40.9372%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9766, Accuracy: 78/10000 (0.7800%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0675, Accuracy: 59/312 (18.9103%)
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0375, Accuracy: 155/312 (49.6795%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.8608, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   1, Avg loss: 0.0721, Accuracy: 174/669 (26.0090%)
_Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   2, Avg loss: 0.0452, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.1954, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   1, Avg loss: 0.0623, Accuracy: 232/1513 (15.3338%)
_Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 464/1513 (30.6675%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7112, Accuracy: 103/10000 (1.0300%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   1, Avg loss: 0.0588, Accuracy: 356/1475 (24.1356%)
_Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   2, Avg loss: 0.0325, Accuracy: 609/1475 (41.2881%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.8113, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   1, Avg loss: 0.0458, Accuracy: 387/1036 (37.3552%)
_Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   2, Avg loss: 0.0256, Accuracy: 642/1036 (61.9691%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 11.3619, Accuracy: 71/10000 (0.7100%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   1, Avg loss: 0.0767, Accuracy: 38/440 (8.6364%)
_Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 158/440 (35.9091%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.3178, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0534, Accuracy: 325/1574 (20.6480%)
_Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0287, Accuracy: 641/1574 (40.7243%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.6426, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   1, Avg loss: 0.0581, Accuracy: 308/1573 (19.5804%)
_Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   2, Avg loss: 0.0351, Accuracy: 582/1573 (36.9994%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6824, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   1, Avg loss: 0.0486, Accuracy: 467/1470 (31.7687%)
_Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   2, Avg loss: 0.0249, Accuracy: 814/1470 (55.3741%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.8298, Accuracy: 94/10000 (0.9400%)
time spent on training: 172.5377938747406
[rfa agg] training data poison_ratio: 0.19896363798802824  data num: [1131, 312, 669, 1513, 1475, 1036, 440, 1574, 1573, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.12435227374251764
[rfa agg] init. name: [38, 24, 45, 8, 65, 19, 49, 17, 40, 22], weight: tensor([0.1010, 0.0279, 0.0598, 0.1352, 0.1318, 0.0926, 0.0393, 0.1406, 0.1405,
        0.1313])
[rfa agg] iter:  0, prev_obj_val: 46.685218811035156, obj_val: 50.13107681274414, abs dis: 3.4458580017089844
[rfa agg] iter: 0, weight: tensor([0.2163, 0.0080, 0.0294, 0.1206, 0.1181, 0.1356, 0.0132, 0.1049, 0.1047,
        0.1491])
[rfa agg] iter:  1, prev_obj_val: 50.13107681274414, obj_val: 50.090309143066406, abs dis: 0.040767669677734375
[rfa agg] iter: 1, weight: tensor([0.3155, 0.0079, 0.0306, 0.0922, 0.0902, 0.1764, 0.0132, 0.0823, 0.0822,
        0.1095])
[rfa agg] iter:  2, prev_obj_val: 50.090309143066406, obj_val: 54.39977264404297, abs dis: 4.3094635009765625
[rfa agg] iter: 2, weight: tensor([0.3386, 0.0076, 0.0296, 0.0887, 0.0867, 0.1724, 0.0127, 0.0793, 0.0792,
        0.1053])
[rfa agg] iter:  3, prev_obj_val: 54.39977264404297, obj_val: 54.38368225097656, abs dis: 0.01609039306640625
[rfa agg] iter: 3, weight: tensor([0.3412, 0.0081, 0.0334, 0.0744, 0.0727, 0.2356, 0.0136, 0.0678, 0.0677,
        0.0855])
[rfa agg] iter:  4, prev_obj_val: 54.38368225097656, obj_val: 54.382877349853516, abs dis: 0.000804901123046875
[rfa agg] iter: 4, weight: tensor([0.3335, 0.0080, 0.0330, 0.0735, 0.0718, 0.2481, 0.0135, 0.0670, 0.0670,
        0.0846])
[rfa agg] iter:  5, prev_obj_val: 54.382877349853516, obj_val: 56.97787094116211, abs dis: 2.5949935913085938
[rfa agg] iter: 5, weight: tensor([0.3293, 0.0080, 0.0330, 0.0735, 0.0719, 0.2520, 0.0135, 0.0671, 0.0670,
        0.0846])
[rfa agg] iter:  6, prev_obj_val: 56.97787094116211, obj_val: 56.96444320678711, abs dis: 0.013427734375
[rfa agg] iter: 6, weight: tensor([0.2789, 0.0090, 0.0384, 0.0737, 0.0720, 0.2938, 0.0152, 0.0677, 0.0677,
        0.0837])
[rfa agg] iter:  7, prev_obj_val: 56.96444320678711, obj_val: 56.96263885498047, abs dis: 0.001804351806640625
[rfa agg] iter: 7, weight: tensor([0.2647, 0.0089, 0.0380, 0.0730, 0.0713, 0.3119, 0.0151, 0.0671, 0.0670,
        0.0830])
[rfa agg] iter:  8, prev_obj_val: 56.96263885498047, obj_val: 56.96236038208008, abs dis: 0.000278472900390625
[rfa agg] iter: 8, weight: tensor([0.2596, 0.0088, 0.0378, 0.0726, 0.0710, 0.3192, 0.0150, 0.0667, 0.0667,
        0.0825])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 11.0626, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 15.4744, Accuracy: 0/9950 (0.0000%)
saving model
Done in 613.4612145423889 sec.
Server Epoch:12 choose agents : [56, 30, 69, 47, 51, 48, 92, 84, 32, 22].
_Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   1, Avg loss: 0.0921, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   2, Avg loss: 0.0759, Accuracy: 24/186 (12.9032%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.8352, Accuracy: 48/10000 (0.4800%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0902, Accuracy: 23/486 (4.7325%)
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0428, Accuracy: 220/486 (45.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6283, Accuracy: 60/10000 (0.6000%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   1, Avg loss: 0.0545, Accuracy: 259/590 (43.8983%)
_Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   2, Avg loss: 0.0361, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.9868, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   1, Avg loss: 0.1293, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   2, Avg loss: 0.1112, Accuracy: 4/134 (2.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.8948, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   1, Avg loss: 0.0663, Accuracy: 197/1049 (18.7798%)
_Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   2, Avg loss: 0.0312, Accuracy: 502/1049 (47.8551%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.7250, Accuracy: 91/10000 (0.9100%)
poison local model 48 index 17 
_Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   1, Avg loss: 0.0801, Accuracy: 52/631 (8.2409%)
_Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   2, Avg loss: 0.0441, Accuracy: 204/631 (32.3296%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.8508, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0566, Accuracy: 440/1715 (25.6560%)
_Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0319, Accuracy: 650/1715 (37.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.9237, Accuracy: 91/10000 (0.9100%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   1, Avg loss: 0.0635, Accuracy: 281/1190 (23.6134%)
_Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 448/1190 (37.6471%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.2038, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0662, Accuracy: 156/735 (21.2245%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0241, Accuracy: 386/735 (52.5170%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.4081, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0465, Accuracy: 502/1470 (34.1497%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0251, Accuracy: 804/1470 (54.6939%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.9028, Accuracy: 98/10000 (0.9800%)
time spent on training: 173.27194118499756
[rfa agg] training data poison_ratio: 0.35389689714146105  data num: [186, 486, 590, 134, 1049, 631, 1715, 1190, 735, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.22118556071341317
[rfa agg] init. name: [56, 30, 69, 47, 51, 48, 92, 84, 32, 22], weight: tensor([0.0227, 0.0594, 0.0721, 0.0164, 0.1281, 0.0771, 0.2095, 0.1454, 0.0898,
        0.1796])
[rfa agg] iter:  0, prev_obj_val: 58.900787353515625, obj_val: 59.97863006591797, abs dis: 1.0778427124023438
[rfa agg] iter: 0, weight: tensor([0.0077, 0.0335, 0.0540, 0.0056, 0.3396, 0.0577, 0.0860, 0.2013, 0.0995,
        0.1149])
[rfa agg] iter:  1, prev_obj_val: 59.97863006591797, obj_val: 61.327877044677734, abs dis: 1.3492469787597656
[rfa agg] iter: 1, weight: tensor([0.0083, 0.0367, 0.0604, 0.0059, 0.3304, 0.0645, 0.0845, 0.1831, 0.1159,
        0.1104])
[rfa agg] iter:  2, prev_obj_val: 61.327877044677734, obj_val: 62.71112060546875, abs dis: 1.3832435607910156
[rfa agg] iter: 2, weight: tensor([0.0092, 0.0418, 0.0706, 0.0066, 0.2844, 0.0754, 0.0864, 0.1728, 0.1425,
        0.1105])
[rfa agg] iter:  3, prev_obj_val: 62.71112060546875, obj_val: 64.1240463256836, abs dis: 1.4129257202148438
[rfa agg] iter: 3, weight: tensor([0.0098, 0.0464, 0.0807, 0.0071, 0.2421, 0.0862, 0.0857, 0.1601, 0.1743,
        0.1076])
[rfa agg] iter:  4, prev_obj_val: 64.1240463256836, obj_val: 67.05974578857422, abs dis: 2.935699462890625
[rfa agg] iter: 4, weight: tensor([0.0102, 0.0501, 0.0902, 0.0074, 0.2050, 0.0963, 0.0822, 0.1446, 0.2126,
        0.1014])
[rfa agg] iter:  5, prev_obj_val: 67.05974578857422, obj_val: 68.57533264160156, abs dis: 1.5155868530273438
[rfa agg] iter: 5, weight: tensor([0.0099, 0.0527, 0.1044, 0.0071, 0.1392, 0.1114, 0.0674, 0.1073, 0.3198,
        0.0808])
[rfa agg] iter:  6, prev_obj_val: 68.57533264160156, obj_val: 72.31745910644531, abs dis: 3.74212646484375
[rfa agg] iter: 6, weight: tensor([0.0087, 0.0490, 0.1039, 0.0062, 0.1041, 0.1106, 0.0546, 0.0831, 0.4153,
        0.0645])
[rfa agg] iter:  7, prev_obj_val: 72.31745910644531, obj_val: 77.0030746459961, abs dis: 4.685615539550781
[rfa agg] iter: 7, weight: tensor([0.0085, 0.0547, 0.1407, 0.0061, 0.0758, 0.1486, 0.0450, 0.0637, 0.4050,
        0.0519])
[rfa agg] iter:  8, prev_obj_val: 77.0030746459961, obj_val: 72.36195373535156, abs dis: 4.641120910644531
[rfa agg] iter: 8, weight: tensor([0.0093, 0.0733, 0.2548, 0.0067, 0.0636, 0.2623, 0.0416, 0.0555, 0.1858,
        0.0471])
[rfa agg] iter:  9, prev_obj_val: 72.36195373535156, obj_val: 74.56035614013672, abs dis: 2.1984024047851562
[rfa agg] iter: 9, weight: tensor([0.0090, 0.0584, 0.1557, 0.0065, 0.0799, 0.1652, 0.0476, 0.0673, 0.3557,
        0.0549])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 11.6401, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 11.5743, Accuracy: 0/9950 (0.0000%)
saving model
Done in 609.7447779178619 sec.
Server Epoch:13 choose agents : [53, 15, 3, 23, 83, 11, 27, 76, 70, 35].
_Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   1, Avg loss: 0.0519, Accuracy: 272/813 (33.4563%)
_Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   2, Avg loss: 0.0199, Accuracy: 428/813 (52.6445%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 11.5219, Accuracy: 51/10000 (0.5100%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0578, Accuracy: 319/1154 (27.6430%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0333, Accuracy: 399/1154 (34.5754%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.7138, Accuracy: 65/10000 (0.6500%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   1, Avg loss: 0.0726, Accuracy: 114/781 (14.5967%)
_Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   2, Avg loss: 0.0370, Accuracy: 245/781 (31.3700%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.4878, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0628, Accuracy: 266/715 (37.2028%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0408, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.3853, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0555, Accuracy: 404/1953 (20.6861%)
_Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0344, Accuracy: 732/1953 (37.4808%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1174, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   1, Avg loss: 0.0580, Accuracy: 260/712 (36.5169%)
_Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   2, Avg loss: 0.0286, Accuracy: 441/712 (61.9382%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1798, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   1, Avg loss: 0.0593, Accuracy: 346/1587 (21.8021%)
_Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 581/1587 (36.6100%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1857, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0880, Accuracy: 14/466 (3.0043%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0504, Accuracy: 179/466 (38.4120%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.6399, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0617, Accuracy: 304/1418 (21.4386%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0321, Accuracy: 632/1418 (44.5698%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2770, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0927, Accuracy: 3/271 (1.1070%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0607, Accuracy: 101/271 (37.2694%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.3699, Accuracy: 52/10000 (0.5200%)
time spent on training: 157.61040139198303
[rfa agg] training data poison_ratio: 0.196048632218845  data num: [813, 1154, 781, 715, 1953, 712, 1587, 466, 1418, 271]
[rfa agg] considering poison per batch poison_fraction: 0.12253039513677813
[rfa agg] init. name: [53, 15, 3, 23, 83, 11, 27, 76, 70, 35], weight: tensor([0.0824, 0.1169, 0.0791, 0.0724, 0.1979, 0.0721, 0.1608, 0.0472, 0.1437,
        0.0275])
[rfa agg] iter:  0, prev_obj_val: 64.63088989257812, obj_val: 66.40509796142578, abs dis: 1.7742080688476562
[rfa agg] iter: 0, weight: tensor([0.0823, 0.3492, 0.0789, 0.0603, 0.0773, 0.0605, 0.1151, 0.0239, 0.1418,
        0.0106])
[rfa agg] iter:  1, prev_obj_val: 66.40509796142578, obj_val: 70.71698760986328, abs dis: 4.3118896484375
[rfa agg] iter: 1, weight: tensor([0.1082, 0.2842, 0.1037, 0.0760, 0.0764, 0.0767, 0.1075, 0.0282, 0.1269,
        0.0122])
[rfa agg] iter:  2, prev_obj_val: 70.71698760986328, obj_val: 74.43346405029297, abs dis: 3.7164764404296875
[rfa agg] iter: 2, weight: tensor([0.1837, 0.1409, 0.1753, 0.1106, 0.0615, 0.1136, 0.0795, 0.0331, 0.0884,
        0.0134])
[rfa agg] iter:  3, prev_obj_val: 74.43346405029297, obj_val: 78.33531951904297, abs dis: 3.90185546875
[rfa agg] iter: 3, weight: tensor([0.2649, 0.0667, 0.2483, 0.1216, 0.0363, 0.1320, 0.0447, 0.0270, 0.0483,
        0.0101])
[rfa agg] iter:  4, prev_obj_val: 78.33531951904297, obj_val: 87.72319793701172, abs dis: 9.38787841796875
[rfa agg] iter: 4, weight: tensor([0.2425, 0.0479, 0.2277, 0.1538, 0.0291, 0.1900, 0.0348, 0.0276, 0.0369,
        0.0096])
[rfa agg] iter:  5, prev_obj_val: 87.72319793701172, obj_val: 81.05999755859375, abs dis: 6.663200378417969
[rfa agg] iter: 5, weight: tensor([0.1567, 0.0590, 0.1502, 0.1955, 0.0404, 0.2249, 0.0468, 0.0600, 0.0487,
        0.0178])
[rfa agg] iter:  6, prev_obj_val: 81.05999755859375, obj_val: 87.70405578613281, abs dis: 6.6440582275390625
[rfa agg] iter: 6, weight: tensor([0.1791, 0.0477, 0.1713, 0.1963, 0.0303, 0.2575, 0.0358, 0.0331, 0.0378,
        0.0110])
[rfa agg] iter:  7, prev_obj_val: 87.70405578613281, obj_val: 84.22996520996094, abs dis: 3.474090576171875
[rfa agg] iter: 7, weight: tensor([0.1533, 0.0585, 0.1474, 0.1989, 0.0401, 0.2298, 0.0464, 0.0597, 0.0483,
        0.0177])
[rfa agg] iter:  8, prev_obj_val: 84.22996520996094, obj_val: 84.22827911376953, abs dis: 0.00168609619140625
[rfa agg] iter: 8, weight: tensor([0.1594, 0.0518, 0.1528, 0.2071, 0.0342, 0.2556, 0.0400, 0.0434, 0.0419,
        0.0137])
[rfa agg] iter:  9, prev_obj_val: 84.22827911376953, obj_val: 87.7011947631836, abs dis: 3.4729156494140625
[rfa agg] iter: 9, weight: tensor([0.1587, 0.0516, 0.1524, 0.2062, 0.0341, 0.2586, 0.0399, 0.0432, 0.0417,
        0.0136])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 12.4749, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 14.8329, Accuracy: 0/9950 (0.0000%)
saving model
Done in 589.0694913864136 sec.
Server Epoch:14 choose agents : [0, 94, 96, 91, 51, 3, 36, 90, 37, 84].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   1, Avg loss: 0.0612, Accuracy: 315/1657 (19.0103%)
_Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   2, Avg loss: 0.0355, Accuracy: 501/1657 (30.2354%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.7870, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   1, Avg loss: 0.0532, Accuracy: 348/1662 (20.9386%)
_Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   2, Avg loss: 0.0341, Accuracy: 585/1662 (35.1986%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.8687, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   1, Avg loss: 0.0804, Accuracy: 46/311 (14.7910%)
_Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   2, Avg loss: 0.0585, Accuracy: 134/311 (43.0868%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.6498, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   1, Avg loss: 0.0499, Accuracy: 314/1030 (30.4854%)
_Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   2, Avg loss: 0.0290, Accuracy: 623/1030 (60.4854%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 9.4821, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   1, Avg loss: 0.0672, Accuracy: 202/1049 (19.2564%)
_Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   2, Avg loss: 0.0318, Accuracy: 482/1049 (45.9485%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.2301, Accuracy: 88/10000 (0.8800%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   1, Avg loss: 0.0732, Accuracy: 111/781 (14.2125%)
_Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   2, Avg loss: 0.0378, Accuracy: 231/781 (29.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.5797, Accuracy: 63/10000 (0.6300%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0921, Accuracy: 49/408 (12.0098%)
_Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0606, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.2940, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   1, Avg loss: 0.0599, Accuracy: 279/677 (41.2112%)
_Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   2, Avg loss: 0.0247, Accuracy: 434/677 (64.1064%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 9.0375, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   1, Avg loss: 0.0597, Accuracy: 310/1129 (27.4579%)
_Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   2, Avg loss: 0.0273, Accuracy: 614/1129 (54.3844%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.4504, Accuracy: 107/10000 (1.0700%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0614, Accuracy: 290/1190 (24.3697%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 430/1190 (36.1345%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.2409, Accuracy: 59/10000 (0.5900%)
time spent on training: 201.2841877937317
[rfa agg] training data poison_ratio: 0.5220335556903174  data num: [1657, 1662, 311, 1030, 1049, 781, 408, 677, 1129, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.32627097230644836
[rfa agg] init. name: [0, 94, 96, 91, 51, 3, 36, 90, 37, 84], weight: tensor([0.1675, 0.1680, 0.0314, 0.1041, 0.1060, 0.0789, 0.0412, 0.0684, 0.1141,
        0.1203])
[rfa agg] iter:  0, prev_obj_val: 49.542755126953125, obj_val: 55.66892623901367, abs dis: 6.126171112060547
[rfa agg] iter: 0, weight: tensor([0.0547, 0.0551, 0.0084, 0.2071, 0.2505, 0.0680, 0.0134, 0.0384, 0.1752,
        0.1291])
[rfa agg] iter:  1, prev_obj_val: 55.66892623901367, obj_val: 53.371131896972656, abs dis: 2.2977943420410156
[rfa agg] iter: 1, weight: tensor([0.0621, 0.0625, 0.0126, 0.1793, 0.1927, 0.1418, 0.0208, 0.0680, 0.1443,
        0.1159])
[rfa agg] iter:  2, prev_obj_val: 53.371131896972656, obj_val: 53.36674880981445, abs dis: 0.004383087158203125
[rfa agg] iter: 2, weight: tensor([0.0598, 0.0602, 0.0111, 0.1955, 0.2147, 0.1112, 0.0181, 0.0563, 0.1533,
        0.1197])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 10.6784, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 11.1899, Accuracy: 0/9950 (0.0000%)
saving model
Done in 632.0669186115265 sec.
Server Epoch:15 choose agents : [0, 92, 37, 24, 39, 63, 28, 96, 58, 72].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   1, Avg loss: 0.0606, Accuracy: 322/1657 (19.4327%)
_Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   2, Avg loss: 0.0355, Accuracy: 476/1657 (28.7266%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9679, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0572, Accuracy: 410/1715 (23.9067%)
_Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 703/1715 (40.9913%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.2314, Accuracy: 76/10000 (0.7600%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0573, Accuracy: 311/1129 (27.5465%)
_Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0266, Accuracy: 647/1129 (57.3074%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.9943, Accuracy: 108/10000 (1.0800%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   1, Avg loss: 0.0735, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 158/312 (50.6410%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.3355, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0559, Accuracy: 284/1013 (28.0355%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0271, Accuracy: 452/1013 (44.6199%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.8940, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0586, Accuracy: 241/888 (27.1396%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0273, Accuracy: 421/888 (47.4099%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.7909, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   1, Avg loss: 0.0609, Accuracy: 350/1581 (22.1379%)
_Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   2, Avg loss: 0.0358, Accuracy: 505/1581 (31.9418%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.2257, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   1, Avg loss: 0.0813, Accuracy: 38/311 (12.2186%)
_Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   2, Avg loss: 0.0572, Accuracy: 134/311 (43.0868%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.8497, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   1, Avg loss: 0.0630, Accuracy: 314/803 (39.1034%)
_Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   2, Avg loss: 0.0374, Accuracy: 425/803 (52.9265%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.6469, Accuracy: 60/10000 (0.6000%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   1, Avg loss: 0.0577, Accuracy: 252/1241 (20.3062%)
_Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   2, Avg loss: 0.0361, Accuracy: 393/1241 (31.6680%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.8608, Accuracy: 65/10000 (0.6500%)
time spent on training: 184.79081630706787
[rfa agg] training data poison_ratio: 0.40741784037558687  data num: [1657, 1715, 1129, 312, 1013, 888, 1581, 311, 803, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.2546361502347418
[rfa agg] init. name: [0, 92, 37, 24, 39, 63, 28, 96, 58, 72], weight: tensor([0.1556, 0.1610, 0.1060, 0.0293, 0.0951, 0.0834, 0.1485, 0.0292, 0.0754,
        0.1165])
[rfa agg] iter:  0, prev_obj_val: 53.10974884033203, obj_val: 55.7672119140625, abs dis: 2.6574630737304688
[rfa agg] iter: 0, weight: tensor([0.0731, 0.0672, 0.2871, 0.0084, 0.1571, 0.0758, 0.0795, 0.0084, 0.0563,
        0.1871])
[rfa agg] iter:  1, prev_obj_val: 55.7672119140625, obj_val: 57.46438217163086, abs dis: 1.6971702575683594
[rfa agg] iter: 1, weight: tensor([0.0632, 0.0589, 0.2642, 0.0089, 0.2310, 0.0953, 0.0678, 0.0088, 0.0675,
        0.1344])
[rfa agg] iter:  2, prev_obj_val: 57.46438217163086, obj_val: 59.356964111328125, abs dis: 1.8925819396972656
[rfa agg] iter: 2, weight: tensor([0.0590, 0.0553, 0.2047, 0.0091, 0.3002, 0.1097, 0.0629, 0.0091, 0.0754,
        0.1147])
[rfa agg] iter:  3, prev_obj_val: 59.356964111328125, obj_val: 63.968563079833984, abs dis: 4.611598968505859
[rfa agg] iter: 3, weight: tensor([0.0538, 0.0506, 0.1568, 0.0091, 0.3578, 0.1254, 0.0570, 0.0091, 0.0833,
        0.0971])
[rfa agg] iter:  4, prev_obj_val: 63.968563079833984, obj_val: 66.51242065429688, abs dis: 2.5438575744628906
[rfa agg] iter: 4, weight: tensor([0.0532, 0.0505, 0.1225, 0.0108, 0.2769, 0.2055, 0.0559, 0.0108, 0.1281,
        0.0857])
[rfa agg] iter:  5, prev_obj_val: 66.51242065429688, obj_val: 66.48967742919922, abs dis: 0.02274322509765625
[rfa agg] iter: 5, weight: tensor([0.0509, 0.0484, 0.1069, 0.0114, 0.2042, 0.2732, 0.0532, 0.0113, 0.1623,
        0.0783])
[rfa agg] iter:  6, prev_obj_val: 66.48967742919922, obj_val: 63.951873779296875, abs dis: 2.5378036499023438
[rfa agg] iter: 6, weight: tensor([0.0499, 0.0475, 0.1046, 0.0111, 0.1942, 0.2915, 0.0522, 0.0111, 0.1611,
        0.0768])
[rfa agg] iter:  7, prev_obj_val: 63.951873779296875, obj_val: 66.50074768066406, abs dis: 2.5488739013671875
[rfa agg] iter: 7, weight: tensor([0.0531, 0.0504, 0.1213, 0.0108, 0.2483, 0.2333, 0.0558, 0.0108, 0.1307,
        0.0856])
[rfa agg] iter:  8, prev_obj_val: 66.50074768066406, obj_val: 66.4891586303711, abs dis: 0.01158905029296875
[rfa agg] iter: 8, weight: tensor([0.0505, 0.0481, 0.1062, 0.0113, 0.2003, 0.2804, 0.0528, 0.0112, 0.1615,
        0.0777])
[rfa agg] iter:  9, prev_obj_val: 66.4891586303711, obj_val: 63.9524040222168, abs dis: 2.536754608154297
[rfa agg] iter: 9, weight: tensor([0.0498, 0.0474, 0.1044, 0.0111, 0.1934, 0.2933, 0.0521, 0.0111, 0.1608,
        0.0766])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.2547, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 9.4937, Accuracy: 0/9950 (0.0000%)
saving model
Done in 617.4370255470276 sec.
Server Epoch:16 choose agents : [35, 32, 3, 96, 25, 8, 93, 74, 88, 50].
_Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0858, Accuracy: 13/271 (4.7970%)
_Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0547, Accuracy: 106/271 (39.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.4972, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0610, Accuracy: 154/735 (20.9524%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 362/735 (49.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.6451, Accuracy: 67/10000 (0.6700%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   1, Avg loss: 0.0741, Accuracy: 93/781 (11.9078%)
_Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   2, Avg loss: 0.0370, Accuracy: 269/781 (34.4430%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.6870, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0837, Accuracy: 18/311 (5.7878%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0583, Accuracy: 131/311 (42.1222%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.6735, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
_Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0544, Accuracy: 281/690 (40.7246%)
_Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1814, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   1, Avg loss: 0.0628, Accuracy: 209/1513 (13.8136%)
_Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   2, Avg loss: 0.0376, Accuracy: 433/1513 (28.6186%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.2590, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0599, Accuracy: 332/1742 (19.0586%)
_Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0323, Accuracy: 700/1742 (40.1837%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.4156, Accuracy: 95/10000 (0.9500%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0440, Accuracy: 486/1552 (31.3144%)
_Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0217, Accuracy: 732/1552 (47.1649%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 11.7917, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   1, Avg loss: 0.0791, Accuracy: 96/603 (15.9204%)
_Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   2, Avg loss: 0.0465, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.1710, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   1, Avg loss: 0.0689, Accuracy: 107/809 (13.2262%)
_Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   2, Avg loss: 0.0296, Accuracy: 315/809 (38.9370%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.7542, Accuracy: 81/10000 (0.8100%)
time spent on training: 164.79192113876343
[rfa agg] training data poison_ratio: 0.3356278450094371  data num: [271, 735, 781, 311, 690, 1513, 1742, 1552, 603, 809]
[rfa agg] considering poison per batch poison_fraction: 0.2097674031308982
[rfa agg] init. name: [35, 32, 3, 96, 25, 8, 93, 74, 88, 50], weight: tensor([0.0301, 0.0816, 0.0867, 0.0345, 0.0766, 0.1680, 0.1934, 0.1723, 0.0669,
        0.0898])
[rfa agg] iter:  0, prev_obj_val: 68.56531524658203, obj_val: 69.58626556396484, abs dis: 1.0209503173828125
[rfa agg] iter: 0, weight: tensor([0.0167, 0.1151, 0.1542, 0.0191, 0.0888, 0.1428, 0.1082, 0.1300, 0.0660,
        0.1591])
[rfa agg] iter:  1, prev_obj_val: 69.58626556396484, obj_val: 70.46223449707031, abs dis: 0.8759689331054688
[rfa agg] iter: 1, weight: tensor([0.0151, 0.1343, 0.2023, 0.0174, 0.0959, 0.0951, 0.0761, 0.0881, 0.0677,
        0.2079])
[rfa agg] iter:  2, prev_obj_val: 70.46223449707031, obj_val: 73.54813385009766, abs dis: 3.0858993530273438
[rfa agg] iter: 2, weight: tensor([0.0124, 0.1428, 0.2477, 0.0142, 0.0930, 0.0635, 0.0524, 0.0594, 0.0622,
        0.2522])
[rfa agg] iter:  3, prev_obj_val: 73.54813385009766, obj_val: 77.82886505126953, abs dis: 4.280731201171875
[rfa agg] iter: 3, weight: tensor([0.0103, 0.2151, 0.2351, 0.0118, 0.1155, 0.0388, 0.0332, 0.0366, 0.0667,
        0.2370])
[rfa agg] iter:  4, prev_obj_val: 77.82886505126953, obj_val: 86.84696197509766, abs dis: 9.018096923828125
[rfa agg] iter: 4, weight: tensor([0.0127, 0.2488, 0.1449, 0.0146, 0.2122, 0.0386, 0.0337, 0.0367, 0.1092,
        0.1485])
[rfa agg] iter:  5, prev_obj_val: 86.84696197509766, obj_val: 80.485595703125, abs dis: 6.361366271972656
[rfa agg] iter: 5, weight: tensor([0.0201, 0.1384, 0.0996, 0.0229, 0.2155, 0.0431, 0.0387, 0.0413, 0.2774,
        0.1029])
[rfa agg] iter:  6, prev_obj_val: 80.485595703125, obj_val: 83.48748016357422, abs dis: 3.0018844604492188
[rfa agg] iter: 6, weight: tensor([0.0140, 0.1859, 0.1143, 0.0161, 0.2840, 0.0378, 0.0334, 0.0361, 0.1616,
        0.1170])
[rfa agg] iter:  7, prev_obj_val: 83.48748016357422, obj_val: 86.80360412597656, abs dis: 3.3161239624023438
[rfa agg] iter: 7, weight: tensor([0.0162, 0.1520, 0.1020, 0.0185, 0.2747, 0.0391, 0.0348, 0.0374, 0.2199,
        0.1052])
[rfa agg] iter:  8, prev_obj_val: 86.80360412597656, obj_val: 83.48848724365234, abs dis: 3.3151168823242188
[rfa agg] iter: 8, weight: tensor([0.0193, 0.1308, 0.0950, 0.0221, 0.2141, 0.0413, 0.0371, 0.0396, 0.3026,
        0.0980])
[rfa agg] iter:  9, prev_obj_val: 83.48848724365234, obj_val: 90.3816909790039, abs dis: 6.8932037353515625
[rfa agg] iter: 9, weight: tensor([0.0161, 0.1490, 0.1006, 0.0184, 0.2542, 0.0386, 0.0344, 0.0370, 0.2483,
        0.1033])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.5608, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 7.4271, Accuracy: 0/9950 (0.0000%)
saving model
Done in 592.6250722408295 sec.
Server Epoch:17 choose agents : [53, 43, 41, 30, 82, 92, 50, 34, 7, 64].
_Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   1, Avg loss: 0.0532, Accuracy: 242/813 (29.7663%)
_Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   2, Avg loss: 0.0193, Accuracy: 446/813 (54.8585%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 12.1920, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 295/946 (31.1839%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0356, Accuracy: 375/946 (39.6406%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.9277, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   1, Avg loss: 0.0672, Accuracy: 241/719 (33.5188%)
_Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   2, Avg loss: 0.0371, Accuracy: 471/719 (65.5076%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.3540, Accuracy: 53/10000 (0.5300%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   1, Avg loss: 0.0861, Accuracy: 41/486 (8.4362%)
_Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   2, Avg loss: 0.0437, Accuracy: 216/486 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7352, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   1, Avg loss: 0.0799, Accuracy: 27/500 (5.4000%)
_Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.0483, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   1, Avg loss: 0.0584, Accuracy: 375/1715 (21.8659%)
_Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   2, Avg loss: 0.0315, Accuracy: 686/1715 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.3753, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   1, Avg loss: 0.0674, Accuracy: 110/809 (13.5970%)
_Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   2, Avg loss: 0.0298, Accuracy: 311/809 (38.4425%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.7390, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0586, Accuracy: 353/1427 (24.7372%)
_Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0346, Accuracy: 556/1427 (38.9629%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.9566, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   1, Avg loss: 0.0584, Accuracy: 302/891 (33.8945%)
_Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   2, Avg loss: 0.0273, Accuracy: 438/891 (49.1582%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.3874, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   1, Avg loss: 0.0700, Accuracy: 117/953 (12.2770%)
_Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   2, Avg loss: 0.0392, Accuracy: 309/953 (32.4239%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.4813, Accuracy: 56/10000 (0.5600%)
time spent on training: 158.31447196006775
[rfa agg] training data poison_ratio: 0.052489469705151746  data num: [813, 946, 719, 486, 500, 1715, 809, 1427, 891, 953]
[rfa agg] considering poison per batch poison_fraction: 0.03280591856571984
[rfa agg] init. name: [53, 43, 41, 30, 82, 92, 50, 34, 7, 64], weight: tensor([0.0878, 0.1022, 0.0777, 0.0525, 0.0540, 0.1852, 0.0874, 0.1541, 0.0962,
        0.1029])
[rfa agg] iter:  0, prev_obj_val: 47.26041030883789, obj_val: 50.45668411254883, abs dis: 3.1962738037109375
[rfa agg] iter: 0, weight: tensor([0.0973, 0.2294, 0.0589, 0.0184, 0.0190, 0.0383, 0.0953, 0.0474, 0.1619,
        0.2340])
[rfa agg] iter:  1, prev_obj_val: 50.45668411254883, obj_val: 58.20976638793945, abs dis: 7.753082275390625
[rfa agg] iter: 1, weight: tensor([0.1975, 0.1100, 0.1101, 0.0243, 0.0252, 0.0314, 0.1922, 0.0364, 0.1609,
        0.1119])
[rfa agg] iter:  2, prev_obj_val: 58.20976638793945, obj_val: 58.180660247802734, abs dis: 0.02910614013671875
[rfa agg] iter: 2, weight: tensor([0.1636, 0.0921, 0.1922, 0.0465, 0.0485, 0.0393, 0.1622, 0.0440, 0.1180,
        0.0936])
[rfa agg] iter:  3, prev_obj_val: 58.180660247802734, obj_val: 61.38934326171875, abs dis: 3.2086830139160156
[rfa agg] iter: 3, weight: tensor([0.1595, 0.0904, 0.2068, 0.0461, 0.0480, 0.0388, 0.1591, 0.0434, 0.1156,
        0.0923])
[rfa agg] iter:  4, prev_obj_val: 61.38934326171875, obj_val: 61.387481689453125, abs dis: 0.001861572265625
[rfa agg] iter: 4, weight: tensor([0.1468, 0.0915, 0.1953, 0.0602, 0.0630, 0.0430, 0.1464, 0.0476, 0.1129,
        0.0932])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.2926, Accuracy: 29/10000 (0.2900%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 7.4995, Accuracy: 0/9950 (0.0000%)
saving model
Done in 586.0556583404541 sec.
Server Epoch:18 choose agents : [18, 55, 4, 35, 2, 13, 24, 76, 9, 43].
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   1, Avg loss: 0.0787, Accuracy: 78/530 (14.7170%)
_Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   2, Avg loss: 0.0378, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.4498, Accuracy: 66/10000 (0.6600%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   1, Avg loss: 0.0603, Accuracy: 194/1071 (18.1139%)
_Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   2, Avg loss: 0.0320, Accuracy: 490/1071 (45.7516%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.9785, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   1, Avg loss: 0.0625, Accuracy: 280/901 (31.0766%)
_Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   2, Avg loss: 0.0352, Accuracy: 372/901 (41.2875%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.7296, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   1, Avg loss: 0.0842, Accuracy: 21/271 (7.7491%)
_Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   2, Avg loss: 0.0575, Accuracy: 104/271 (38.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.6320, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0615, Accuracy: 202/605 (33.3884%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0391, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.9579, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   1, Avg loss: 0.0622, Accuracy: 305/1645 (18.5410%)
_Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   2, Avg loss: 0.0347, Accuracy: 568/1645 (34.5289%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.6279, Accuracy: 100/10000 (1.0000%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0752, Accuracy: 24/312 (7.6923%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0422, Accuracy: 153/312 (49.0385%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.3030, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 17/466 (3.6481%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0476, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.9038, Accuracy: 50/10000 (0.5000%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0514, Accuracy: 345/1275 (27.0588%)
_Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0199, Accuracy: 671/1275 (52.6275%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 10.7828, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   1, Avg loss: 0.0599, Accuracy: 311/946 (32.8753%)
_Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   2, Avg loss: 0.0347, Accuracy: 373/946 (39.4292%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.9975, Accuracy: 79/10000 (0.7900%)
time spent on training: 182.20942521095276
[rfa agg] training data poison_ratio: 0.39740713039142356  data num: [530, 1071, 901, 271, 605, 1645, 312, 466, 1275, 946]
[rfa agg] considering poison per batch poison_fraction: 0.24837945649463972
[rfa agg] init. name: [18, 55, 4, 35, 2, 13, 24, 76, 9, 43], weight: tensor([0.0661, 0.1335, 0.1123, 0.0338, 0.0754, 0.2051, 0.0389, 0.0581, 0.1589,
        0.1179])
[rfa agg] iter:  0, prev_obj_val: 53.3131103515625, obj_val: 54.860321044921875, abs dis: 1.547210693359375
[rfa agg] iter: 0, weight: tensor([0.0471, 0.1491, 0.2432, 0.0133, 0.0667, 0.0622, 0.0154, 0.0347, 0.0947,
        0.2736])
[rfa agg] iter:  1, prev_obj_val: 54.860321044921875, obj_val: 56.72503662109375, abs dis: 1.864715576171875
[rfa agg] iter: 1, weight: tensor([0.0558, 0.1413, 0.2344, 0.0151, 0.0810, 0.0641, 0.0174, 0.0405, 0.0940,
        0.2563])
[rfa agg] iter:  2, prev_obj_val: 56.72503662109375, obj_val: 58.654151916503906, abs dis: 1.9291152954101562
[rfa agg] iter: 2, weight: tensor([0.0687, 0.1382, 0.2114, 0.0176, 0.1028, 0.0680, 0.0203, 0.0488, 0.0966,
        0.2275])
[rfa agg] iter:  3, prev_obj_val: 58.654151916503906, obj_val: 60.63044738769531, abs dis: 1.9762954711914062
[rfa agg] iter: 3, weight: tensor([0.0829, 0.1322, 0.1882, 0.0200, 0.1292, 0.0698, 0.0230, 0.0576, 0.0964,
        0.2009])
[rfa agg] iter:  4, prev_obj_val: 60.63044738769531, obj_val: 60.6242561340332, abs dis: 0.006191253662109375
[rfa agg] iter: 4, weight: tensor([0.0982, 0.1233, 0.1654, 0.0219, 0.1614, 0.0693, 0.0253, 0.0662, 0.0931,
        0.1758])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.0191, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 8.1306, Accuracy: 0/9950 (0.0000%)
saving model
Done in 613.4033930301666 sec.
Server Epoch:19 choose agents : [11, 48, 53, 27, 55, 65, 31, 89, 17, 23].
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0618, Accuracy: 235/712 (33.0056%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0273, Accuracy: 449/712 (63.0618%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.2704, Accuracy: 66/10000 (0.6600%)
poison local model 48 index 17 
_Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   1, Avg loss: 0.0808, Accuracy: 69/631 (10.9350%)
_Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   2, Avg loss: 0.0465, Accuracy: 207/631 (32.8051%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.1170, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   1, Avg loss: 0.0532, Accuracy: 246/813 (30.2583%)
_Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   2, Avg loss: 0.0198, Accuracy: 443/813 (54.4895%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 12.0263, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   1, Avg loss: 0.0576, Accuracy: 339/1587 (21.3611%)
_Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 588/1587 (37.0510%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.8131, Accuracy: 68/10000 (0.6800%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   1, Avg loss: 0.0586, Accuracy: 249/1071 (23.2493%)
_Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   2, Avg loss: 0.0314, Accuracy: 498/1071 (46.4986%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.6933, Accuracy: 63/10000 (0.6300%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   1, Avg loss: 0.0604, Accuracy: 334/1475 (22.6441%)
_Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   2, Avg loss: 0.0330, Accuracy: 667/1475 (45.2203%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1454, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   1, Avg loss: 0.0751, Accuracy: 70/460 (15.2174%)
_Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   2, Avg loss: 0.0347, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.5504, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0650, Accuracy: 311/896 (34.7098%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0354, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.1957, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0557, Accuracy: 310/1574 (19.6950%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0295, Accuracy: 619/1574 (39.3266%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.6318, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   1, Avg loss: 0.0578, Accuracy: 325/715 (45.4545%)
_Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   2, Avg loss: 0.0397, Accuracy: 440/715 (61.5385%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.6112, Accuracy: 47/10000 (0.4700%)
time spent on training: 185.5907266139984
[rfa agg] training data poison_ratio: 0.3198107509563117  data num: [712, 631, 813, 1587, 1071, 1475, 460, 896, 1574, 715]
[rfa agg] considering poison per batch poison_fraction: 0.1998817193476948
[rfa agg] init. name: [11, 48, 53, 27, 55, 65, 31, 89, 17, 23], weight: tensor([0.0717, 0.0635, 0.0818, 0.1598, 0.1078, 0.1485, 0.0463, 0.0902, 0.1584,
        0.0720])
[rfa agg] iter:  0, prev_obj_val: 55.739627838134766, obj_val: 61.52687454223633, abs dis: 5.7872467041015625
[rfa agg] iter: 0, weight: tensor([0.0832, 0.0486, 0.1270, 0.0717, 0.2211, 0.0739, 0.0261, 0.1952, 0.0711,
        0.0821])
[rfa agg] iter:  1, prev_obj_val: 61.52687454223633, obj_val: 61.36936569213867, abs dis: 0.15750885009765625
[rfa agg] iter: 1, weight: tensor([0.1431, 0.0629, 0.2322, 0.0423, 0.0821, 0.0427, 0.0285, 0.1884, 0.0419,
        0.1358])
[rfa agg] iter:  2, prev_obj_val: 61.36936569213867, obj_val: 68.86573791503906, abs dis: 7.496372222900391
[rfa agg] iter: 2, weight: tensor([0.1415, 0.0598, 0.2637, 0.0397, 0.0757, 0.0401, 0.0269, 0.1794, 0.0394,
        0.1338])
[rfa agg] iter:  3, prev_obj_val: 68.86573791503906, obj_val: 65.95511627197266, abs dis: 2.9106216430664062
[rfa agg] iter: 3, weight: tensor([0.1970, 0.1173, 0.1620, 0.0406, 0.0652, 0.0406, 0.0427, 0.1134, 0.0403,
        0.1809])
[rfa agg] iter:  4, prev_obj_val: 65.95511627197266, obj_val: 71.98045349121094, abs dis: 6.025337219238281
[rfa agg] iter: 4, weight: tensor([0.2135, 0.0882, 0.1802, 0.0382, 0.0644, 0.0383, 0.0345, 0.1197, 0.0378,
        0.1851])
[rfa agg] iter:  5, prev_obj_val: 71.98045349121094, obj_val: 65.96751403808594, abs dis: 6.012939453125
[rfa agg] iter: 5, weight: tensor([0.1849, 0.1609, 0.1366, 0.0422, 0.0648, 0.0421, 0.0528, 0.1034, 0.0419,
        0.1705])
[rfa agg] iter:  6, prev_obj_val: 65.96751403808594, obj_val: 71.97988891601562, abs dis: 6.0123748779296875
[rfa agg] iter: 6, weight: tensor([0.2144, 0.0896, 0.1786, 0.0383, 0.0646, 0.0384, 0.0347, 0.1199, 0.0380,
        0.1834])
[rfa agg] iter:  7, prev_obj_val: 71.97988891601562, obj_val: 65.96755981445312, abs dis: 6.0123291015625
[rfa agg] iter: 7, weight: tensor([0.1851, 0.1610, 0.1365, 0.0422, 0.0647, 0.0421, 0.0528, 0.1034, 0.0418,
        0.1702])
[rfa agg] iter:  8, prev_obj_val: 65.96755981445312, obj_val: 71.97988891601562, abs dis: 6.0123291015625
[rfa agg] iter: 8, weight: tensor([0.2145, 0.0896, 0.1786, 0.0383, 0.0646, 0.0384, 0.0347, 0.1199, 0.0380,
        0.1833])
[rfa agg] iter:  9, prev_obj_val: 71.97988891601562, obj_val: 65.96755981445312, abs dis: 6.0123291015625
[rfa agg] iter: 9, weight: tensor([0.1851, 0.1610, 0.1365, 0.0422, 0.0647, 0.0421, 0.0528, 0.1034, 0.0418,
        0.1702])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.1225, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 8.4734, Accuracy: 0/9950 (0.0000%)
saving model
Done in 618.9085659980774 sec.
Server Epoch:20 choose agents : [15, 22, 82, 11, 93, 75, 3, 77, 88, 16].
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0587, Accuracy: 305/1154 (26.4298%)
_Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 443/1154 (38.3882%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.0077, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   1, Avg loss: 0.0462, Accuracy: 482/1470 (32.7891%)
_Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   2, Avg loss: 0.0248, Accuracy: 821/1470 (55.8503%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.4232, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   1, Avg loss: 0.0796, Accuracy: 42/500 (8.4000%)
_Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   2, Avg loss: 0.0502, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.3227, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0627, Accuracy: 215/712 (30.1966%)
_Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0264, Accuracy: 449/712 (63.0618%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.2451, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   1, Avg loss: 0.0592, Accuracy: 380/1742 (21.8140%)
_Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 691/1742 (39.6670%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.8647, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0742, Accuracy: 174/776 (22.4227%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0306, Accuracy: 426/776 (54.8969%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8960, Accuracy: 78/10000 (0.7800%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   1, Avg loss: 0.0765, Accuracy: 87/781 (11.1396%)
_Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   2, Avg loss: 0.0371, Accuracy: 250/781 (32.0102%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.4944, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   1, Avg loss: 0.0547, Accuracy: 321/1340 (23.9552%)
_Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 553/1340 (41.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.2467, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   1, Avg loss: 0.0766, Accuracy: 110/603 (18.2421%)
_Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   2, Avg loss: 0.0481, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.3309, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   1, Avg loss: 0.0681, Accuracy: 223/708 (31.4972%)
_Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   2, Avg loss: 0.0376, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.0315, Accuracy: 56/10000 (0.5600%)
time spent on training: 168.676114320755
[rfa agg] training data poison_ratio: 0.19773145309625997  data num: [1154, 1470, 500, 712, 1742, 776, 781, 1340, 603, 708]
[rfa agg] considering poison per batch poison_fraction: 0.12358215818516248
[rfa agg] init. name: [15, 22, 82, 11, 93, 75, 3, 77, 88, 16], weight: tensor([0.1179, 0.1502, 0.0511, 0.0728, 0.1780, 0.0793, 0.0798, 0.1369, 0.0616,
        0.0723])
[rfa agg] iter:  0, prev_obj_val: 56.831642150878906, obj_val: 60.470706939697266, abs dis: 3.6390647888183594
[rfa agg] iter: 0, weight: tensor([0.1500, 0.0972, 0.0331, 0.0969, 0.0699, 0.1403, 0.1443, 0.1188, 0.0541,
        0.0953])
[rfa agg] iter:  1, prev_obj_val: 60.470706939697266, obj_val: 63.69932556152344, abs dis: 3.228618621826172
[rfa agg] iter: 1, weight: tensor([0.0681, 0.0516, 0.0298, 0.1260, 0.0403, 0.2116, 0.2376, 0.0592, 0.0554,
        0.1205])
[rfa agg] iter:  2, prev_obj_val: 63.69932556152344, obj_val: 72.01033782958984, abs dis: 8.311012268066406
[rfa agg] iter: 2, weight: tensor([0.0492, 0.0397, 0.0306, 0.1705, 0.0320, 0.1965, 0.2220, 0.0444, 0.0637,
        0.1514])
[rfa agg] iter:  3, prev_obj_val: 72.01033782958984, obj_val: 66.06739807128906, abs dis: 5.942939758300781
[rfa agg] iter: 3, weight: tensor([0.0517, 0.0446, 0.0564, 0.1829, 0.0374, 0.1266, 0.1309, 0.0486, 0.1538,
        0.1672])
[rfa agg] iter:  4, prev_obj_val: 66.06739807128906, obj_val: 71.98747253417969, abs dis: 5.920074462890625
[rfa agg] iter: 4, weight: tensor([0.0476, 0.0394, 0.0358, 0.2139, 0.0323, 0.1549, 0.1652, 0.0437, 0.0817,
        0.1856])
[rfa agg] iter:  5, prev_obj_val: 71.98747253417969, obj_val: 66.06749725341797, abs dis: 5.919975280761719
[rfa agg] iter: 5, weight: tensor([0.0512, 0.0441, 0.0560, 0.1866, 0.0371, 0.1240, 0.1279, 0.0481, 0.1542,
        0.1707])
[rfa agg] iter:  6, prev_obj_val: 66.06749725341797, obj_val: 71.98747253417969, abs dis: 5.919975280761719
[rfa agg] iter: 6, weight: tensor([0.0476, 0.0394, 0.0357, 0.2145, 0.0322, 0.1544, 0.1646, 0.0436, 0.0816,
        0.1863])
[rfa agg] iter:  7, prev_obj_val: 71.98747253417969, obj_val: 66.06749725341797, abs dis: 5.919975280761719
[rfa agg] iter: 7, weight: tensor([0.0512, 0.0441, 0.0560, 0.1866, 0.0371, 0.1240, 0.1279, 0.0481, 0.1542,
        0.1708])
[rfa agg] iter:  8, prev_obj_val: 66.06749725341797, obj_val: 71.98748016357422, abs dis: 5.91998291015625
[rfa agg] iter: 8, weight: tensor([0.0476, 0.0394, 0.0357, 0.2145, 0.0322, 0.1544, 0.1646, 0.0436, 0.0816,
        0.1863])
[rfa agg] iter:  9, prev_obj_val: 71.98748016357422, obj_val: 66.06749725341797, abs dis: 5.91998291015625
[rfa agg] iter: 9, weight: tensor([0.0512, 0.0441, 0.0560, 0.1866, 0.0371, 0.1240, 0.1279, 0.0481, 0.1542,
        0.1708])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.6669, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 9.1227, Accuracy: 0/9950 (0.0000%)
saving model
Done in 602.6218028068542 sec.
Server Epoch:21 choose agents : [0, 27, 39, 70, 20, 85, 12, 72, 94, 32].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0512, Accuracy: 826/1657 (49.8491%), train_poison_data_count: 1040
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0284, Accuracy: 983/1657 (59.3241%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0239, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0237, Accuracy: 1038/1657 (62.6433%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0234, Accuracy: 1038/1657 (62.6433%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0227, Accuracy: 1045/1657 (63.0658%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0224, Accuracy: 1045/1657 (63.0658%), train_poison_data_count: 1040
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0218, Accuracy: 1050/1657 (63.3675%), train_poison_data_count: 1040
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0213, Accuracy: 1048/1657 (63.2468%), train_poison_data_count: 1040
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0213, Accuracy: 1052/1657 (63.4882%), train_poison_data_count: 1040
Global model norm: 187.41274011189847.
Norm before scaling: 187.3587905763965. Distance: 1.1308175772682245
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6631, Accuracy: 46/10000 (0.4600%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.3542, Accuracy: 9935/9950 (99.8492%)
Scaling by  100
Scaled Norm after poisoning: 213.9188203939756, distance: 113.08176400977524
Total norm for 5 adversaries is: 213.9188203939756. distance: 113.08176400977524
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0576, Accuracy: 366/1587 (23.0624%)
_Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0343, Accuracy: 581/1587 (36.6100%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.1373, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   1, Avg loss: 0.0533, Accuracy: 264/1013 (26.0612%)
_Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 484/1013 (47.7789%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.4263, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   1, Avg loss: 0.0580, Accuracy: 322/1418 (22.7080%)
_Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   2, Avg loss: 0.0325, Accuracy: 593/1418 (41.8195%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.3690, Accuracy: 102/10000 (1.0200%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0596, Accuracy: 284/807 (35.1921%)
_Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0345, Accuracy: 398/807 (49.3185%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6154, Accuracy: 71/10000 (0.7100%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   1, Avg loss: 0.0579, Accuracy: 414/1988 (20.8249%)
_Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   2, Avg loss: 0.0369, Accuracy: 602/1988 (30.2817%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.0590, Accuracy: 74/10000 (0.7400%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   1, Avg loss: 0.1053, Accuracy: 6/338 (1.7751%)
_Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   2, Avg loss: 0.0626, Accuracy: 84/338 (24.8521%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.7802, Accuracy: 49/10000 (0.4900%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   1, Avg loss: 0.0579, Accuracy: 221/1241 (17.8082%)
_Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 387/1241 (31.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.6143, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0578, Accuracy: 321/1662 (19.3141%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0348, Accuracy: 558/1662 (33.5740%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.4148, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   1, Avg loss: 0.0613, Accuracy: 159/735 (21.6327%)
_Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 359/735 (48.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.9858, Accuracy: 64/10000 (0.6400%)
time spent on training: 343.3685600757599
[rfa agg] training data poison_ratio: 0.48457335690181585  data num: [1657, 1587, 1013, 1418, 807, 1988, 338, 1241, 1662, 735]
[rfa agg] considering poison per batch poison_fraction: 0.30285834806363493
[rfa agg] init. name: [0, 27, 39, 70, 20, 85, 12, 72, 94, 32], weight: tensor([0.1331, 0.1275, 0.0814, 0.1139, 0.0648, 0.1597, 0.0272, 0.0997, 0.1335,
        0.0591])
[rfa agg] iter:  0, prev_obj_val: 26832.34765625, obj_val: 17431.0, abs dis: 9401.34765625
[rfa agg] iter: 0, weight: tensor([0.0230, 0.1439, 0.0914, 0.1285, 0.0727, 0.1810, 0.0303, 0.1122, 0.1508,
        0.0662])
[rfa agg] iter:  1, prev_obj_val: 17431.0, obj_val: 15777.1494140625, abs dis: 1653.8505859375
[rfa agg] iter: 1, weight: tensor([0.0036, 0.1478, 0.0915, 0.1312, 0.0722, 0.1897, 0.0296, 0.1136, 0.1553,
        0.0655])
[rfa agg] iter:  2, prev_obj_val: 15777.1494140625, obj_val: 15535.64453125, abs dis: 241.5048828125
[rfa agg] iter: 2, weight: tensor([0.0005, 0.1527, 0.0801, 0.1302, 0.0603, 0.2297, 0.0223, 0.1066, 0.1638,
        0.0539])
[rfa agg] iter:  3, prev_obj_val: 15535.64453125, obj_val: 15530.9560546875, abs dis: 4.6884765625
[rfa agg] iter: 3, weight: tensor([5.3859e-05, 2.2380e-01, 3.6895e-02, 1.2524e-01, 2.3331e-02, 1.7319e-01,
        6.5872e-03, 6.8632e-02, 3.2235e-01, 1.9924e-02])
[rfa agg] iter:  4, prev_obj_val: 15530.9560546875, obj_val: 15533.6806640625, abs dis: 2.724609375
[rfa agg] iter: 4, weight: tensor([4.2415e-05, 2.4982e-01, 4.4023e-02, 2.7196e-01, 2.5186e-02, 7.5745e-02,
        6.3597e-03, 1.0877e-01, 1.9703e-01, 2.1064e-02])
[rfa agg] iter:  5, prev_obj_val: 15533.6806640625, obj_val: 15536.4599609375, abs dis: 2.779296875
[rfa agg] iter: 5, weight: tensor([4.6299e-05, 1.7399e-01, 5.9503e-02, 3.0472e-01, 3.1938e-02, 7.0528e-02,
        7.5820e-03, 1.8389e-01, 1.4141e-01, 2.6397e-02])
[rfa agg] iter:  6, prev_obj_val: 15536.4599609375, obj_val: 15537.9873046875, abs dis: 1.52734375
[rfa agg] iter: 6, weight: tensor([4.8780e-05, 1.4169e-01, 7.4470e-02, 2.2895e-01, 3.7713e-02, 6.7855e-02,
        8.5106e-03, 2.8861e-01, 1.2129e-01, 3.0856e-02])
[rfa agg] iter:  7, prev_obj_val: 15537.9873046875, obj_val: 15541.6904296875, abs dis: 3.703125
[rfa agg] iter: 7, weight: tensor([4.6694e-05, 1.2191e-01, 7.8681e-02, 1.8089e-01, 3.8413e-02, 6.2248e-02,
        8.4235e-03, 3.7181e-01, 1.0633e-01, 3.1253e-02])
[rfa agg] iter:  8, prev_obj_val: 15541.6904296875, obj_val: 15541.673828125, abs dis: 0.0166015625
[rfa agg] iter: 8, weight: tensor([4.7276e-05, 1.0269e-01, 9.9467e-02, 1.3789e-01, 4.4487e-02, 5.8131e-02,
        9.1425e-03, 4.2038e-01, 9.2044e-02, 3.5728e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 9.9178, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 8.3677, Accuracy: 0/9950 (0.0000%)
saving model
Done in 777.1747376918793 sec.
Server Epoch:22 choose agents : [17, 32, 73, 28, 12, 2, 85, 13, 18, 80].
_Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   1, Avg loss: 0.0544, Accuracy: 342/1574 (21.7281%)
_Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   2, Avg loss: 0.0291, Accuracy: 637/1574 (40.4701%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.8652, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   1, Avg loss: 0.0609, Accuracy: 167/735 (22.7211%)
_Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   2, Avg loss: 0.0236, Accuracy: 346/735 (47.0748%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.8960, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   1, Avg loss: 0.0647, Accuracy: 186/938 (19.8294%)
_Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   2, Avg loss: 0.0341, Accuracy: 344/938 (36.6738%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.8292, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   1, Avg loss: 0.0646, Accuracy: 322/1581 (20.3669%)
_Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   2, Avg loss: 0.0355, Accuracy: 553/1581 (34.9779%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.2549, Accuracy: 89/10000 (0.8900%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.1040, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0601, Accuracy: 89/338 (26.3314%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.8091, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0587, Accuracy: 268/605 (44.2975%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 322/605 (53.2231%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.2323, Accuracy: 58/10000 (0.5800%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   1, Avg loss: 0.0579, Accuracy: 386/1988 (19.4165%)
_Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   2, Avg loss: 0.0363, Accuracy: 636/1988 (31.9920%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.6796, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0619, Accuracy: 311/1645 (18.9058%)
_Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0344, Accuracy: 572/1645 (34.7720%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.6831, Accuracy: 107/10000 (1.0700%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0792, Accuracy: 79/530 (14.9057%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0377, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.6344, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0807, Accuracy: 100/682 (14.6628%)
_Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0398, Accuracy: 263/682 (38.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.0296, Accuracy: 54/10000 (0.5400%)
time spent on training: 197.4463174343109
[rfa agg] training data poison_ratio: 0.2690278824415976  data num: [1574, 735, 938, 1581, 338, 605, 1988, 1645, 530, 682]
[rfa agg] considering poison per batch poison_fraction: 0.16814242652599848
[rfa agg] init. name: [17, 32, 73, 28, 12, 2, 85, 13, 18, 80], weight: tensor([0.1483, 0.0692, 0.0884, 0.1489, 0.0318, 0.0570, 0.1873, 0.1550, 0.0499,
        0.0642])
[rfa agg] iter:  0, prev_obj_val: 74.0034408569336, obj_val: 76.42906188964844, abs dis: 2.4256210327148438
[rfa agg] iter: 0, weight: tensor([0.1757, 0.0717, 0.1521, 0.1767, 0.0179, 0.0464, 0.1055, 0.1589, 0.0366,
        0.0587])
[rfa agg] iter:  1, prev_obj_val: 76.42906188964844, obj_val: 77.66879272460938, abs dis: 1.2397308349609375
[rfa agg] iter: 1, weight: tensor([0.1522, 0.0831, 0.1954, 0.1532, 0.0193, 0.0519, 0.0978, 0.1399, 0.0405,
        0.0667])
[rfa agg] iter:  2, prev_obj_val: 77.66879272460938, obj_val: 78.93390655517578, abs dis: 1.2651138305664062
[rfa agg] iter: 2, weight: tensor([0.1392, 0.0886, 0.2243, 0.1403, 0.0197, 0.0542, 0.0925, 0.1291, 0.0420,
        0.0702])
[rfa agg] iter:  3, prev_obj_val: 78.93390655517578, obj_val: 78.9296875, abs dis: 0.00421905517578125
[rfa agg] iter: 3, weight: tensor([0.1260, 0.0935, 0.2580, 0.1271, 0.0198, 0.0558, 0.0862, 0.1176, 0.0429,
        0.0731])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.6654, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 8.9575, Accuracy: 0/9950 (0.0000%)
saving model
Done in 623.8655009269714 sec.
Server Epoch:23 choose agents : [3, 14, 79, 74, 2, 49, 32, 18, 4, 7].
poison local model 3 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0600, Accuracy: 294/781 (37.6440%), train_poison_data_count: 493
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0396, Accuracy: 489/781 (62.6120%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   3, Avg loss: 0.0292, Accuracy: 456/781 (58.3867%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   4, Avg loss: 0.0276, Accuracy: 483/781 (61.8438%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   5, Avg loss: 0.0256, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   6, Avg loss: 0.0259, Accuracy: 492/781 (62.9962%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   7, Avg loss: 0.0262, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   8, Avg loss: 0.0235, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   9, Avg loss: 0.0243, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch  10, Avg loss: 0.0249, Accuracy: 494/781 (63.2522%), train_poison_data_count: 493
Global model norm: 193.30464945261923.
Norm before scaling: 193.28046937999193. Distance: 0.7990613004804491
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7046, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.3546, Accuracy: 9923/9950 (99.7286%)
Scaling by  100
Scaled Norm after poisoning: 206.76910053849923, distance: 79.90613084171795
Total norm for 4 adversaries is: 206.76910053849923. distance: 79.90613084171795
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   1, Avg loss: 0.0754, Accuracy: 151/1013 (14.9062%)
_Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   2, Avg loss: 0.0382, Accuracy: 285/1013 (28.1343%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.7862, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   1, Avg loss: 0.1109, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   2, Avg loss: 0.0914, Accuracy: 32/197 (16.2437%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.2435, Accuracy: 48/10000 (0.4800%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0482, Accuracy: 429/1552 (27.6418%)
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0218, Accuracy: 735/1552 (47.3582%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 12.0605, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0579, Accuracy: 262/605 (43.3058%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0385, Accuracy: 322/605 (53.2231%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.1353, Accuracy: 59/10000 (0.5900%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   1, Avg loss: 0.0812, Accuracy: 31/440 (7.0455%)
_Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   2, Avg loss: 0.0502, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.8556, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   1, Avg loss: 0.0591, Accuracy: 154/735 (20.9524%)
_Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 351/735 (47.7551%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 11.4247, Accuracy: 64/10000 (0.6400%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   1, Avg loss: 0.0793, Accuracy: 66/530 (12.4528%)
_Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   2, Avg loss: 0.0375, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.6184, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0593, Accuracy: 290/901 (32.1865%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0324, Accuracy: 409/901 (45.3940%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.1212, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   1, Avg loss: 0.0586, Accuracy: 314/891 (35.2413%)
_Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   2, Avg loss: 0.0270, Accuracy: 445/891 (49.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.6862, Accuracy: 64/10000 (0.6400%)
time spent on training: 277.8203659057617
[rfa agg] training data poison_ratio: 0.43204708960104643  data num: [781, 1013, 197, 1552, 605, 440, 735, 530, 901, 891]
[rfa agg] considering poison per batch poison_fraction: 0.270029431000654
[rfa agg] init. name: [3, 14, 79, 74, 2, 49, 32, 18, 4, 7], weight: tensor([0.1022, 0.1325, 0.0258, 0.2030, 0.0791, 0.0576, 0.0961, 0.0693, 0.1179,
        0.1165])
[rfa agg] iter:  0, prev_obj_val: 10725.9072265625, obj_val: 6553.28564453125, abs dis: 4172.62158203125
[rfa agg] iter: 0, weight: tensor([0.0127, 0.1459, 0.0279, 0.2265, 0.0863, 0.0625, 0.1052, 0.0755, 0.1295,
        0.1279])
[rfa agg] iter:  1, prev_obj_val: 6553.28564453125, obj_val: 6041.01171875, abs dis: 512.27392578125
[rfa agg] iter: 1, weight: tensor([0.0014, 0.1480, 0.0249, 0.2554, 0.0822, 0.0577, 0.1022, 0.0711, 0.1300,
        0.1270])
[rfa agg] iter:  2, prev_obj_val: 6041.01171875, obj_val: 6022.27978515625, abs dis: 18.73193359375
[rfa agg] iter: 2, weight: tensor([1.1391e-04, 1.5529e-01, 1.0137e-02, 4.2990e-01, 4.7326e-02, 2.7489e-02,
        6.8723e-02, 3.8280e-02, 1.1914e-01, 1.0360e-01])
[rfa agg] iter:  3, prev_obj_val: 6022.27978515625, obj_val: 6024.0283203125, abs dis: 1.74853515625
[rfa agg] iter: 3, weight: tensor([5.7223e-05, 3.2547e-01, 7.5370e-03, 8.1913e-02, 4.6467e-02, 2.2806e-02,
        8.1210e-02, 3.5180e-02, 2.3669e-01, 1.6267e-01])
[rfa agg] iter:  4, prev_obj_val: 6024.0283203125, obj_val: 6029.12158203125, abs dis: 5.09326171875
[rfa agg] iter: 4, weight: tensor([5.5822e-05, 1.4887e-01, 9.5706e-03, 5.9698e-02, 8.4451e-02, 3.2737e-02,
        1.9239e-01, 5.7755e-02, 1.7941e-01, 2.3506e-01])
[rfa agg] iter:  5, prev_obj_val: 6029.12158203125, obj_val: 6033.7255859375, abs dis: 4.60400390625
[rfa agg] iter: 5, weight: tensor([5.8061e-05, 1.0473e-01, 1.1734e-02, 5.5312e-02, 1.4746e-01, 4.4516e-02,
        2.7461e-01, 8.9945e-02, 1.1680e-01, 1.5483e-01])
[rfa agg] iter:  6, prev_obj_val: 6033.7255859375, obj_val: 6039.197265625, abs dis: 5.4716796875
[rfa agg] iter: 6, weight: tensor([5.9668e-05, 8.8903e-02, 1.3685e-02, 5.2980e-02, 2.3752e-01, 5.7441e-02,
        2.0172e-01, 1.3402e-01, 9.5180e-02, 1.1848e-01])
[rfa agg] iter:  7, prev_obj_val: 6039.197265625, obj_val: 6036.28369140625, abs dis: 2.91357421875
[rfa agg] iter: 7, weight: tensor([5.9649e-05, 7.5870e-02, 1.5730e-02, 4.9604e-02, 2.6793e-01, 7.6043e-02,
        1.3405e-01, 2.0749e-01, 7.8937e-02, 9.4285e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.2972, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 10.4353, Accuracy: 0/9950 (0.0000%)
saving model
Done in 702.8852500915527 sec.
Server Epoch:24 choose agents : [92, 33, 42, 36, 22, 98, 4, 17, 76, 3].
_Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   1, Avg loss: 0.0576, Accuracy: 400/1715 (23.3236%)
_Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   2, Avg loss: 0.0322, Accuracy: 646/1715 (37.6676%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1829, Accuracy: 76/10000 (0.7600%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   1, Avg loss: 0.0826, Accuracy: 44/515 (8.5437%)
_Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   2, Avg loss: 0.0545, Accuracy: 142/515 (27.5728%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.9574, Accuracy: 58/10000 (0.5800%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   1, Avg loss: 0.0563, Accuracy: 262/1372 (19.0962%)
_Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   2, Avg loss: 0.0328, Accuracy: 489/1372 (35.6414%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.0054, Accuracy: 98/10000 (0.9800%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   1, Avg loss: 0.0943, Accuracy: 16/408 (3.9216%)
_Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   2, Avg loss: 0.0578, Accuracy: 149/408 (36.5196%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.0275, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   1, Avg loss: 0.0484, Accuracy: 457/1470 (31.0884%)
_Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   2, Avg loss: 0.0250, Accuracy: 817/1470 (55.5782%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.3454, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   1, Avg loss: 0.0886, Accuracy: 7/373 (1.8767%)
_Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   2, Avg loss: 0.0564, Accuracy: 146/373 (39.1421%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.6945, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   1, Avg loss: 0.0587, Accuracy: 289/901 (32.0755%)
_Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   2, Avg loss: 0.0321, Accuracy: 405/901 (44.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.3995, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0537, Accuracy: 340/1574 (21.6010%)
_Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0293, Accuracy: 626/1574 (39.7713%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.3482, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.0818, Accuracy: 38/466 (8.1545%)
_Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0476, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.4014, Accuracy: 53/10000 (0.5300%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0773, Accuracy: 68/781 (8.7068%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0387, Accuracy: 253/781 (32.3944%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.6631, Accuracy: 91/10000 (0.9100%)
time spent on training: 214.55942034721375
[rfa agg] training data poison_ratio: 0.3212532637075718  data num: [1715, 515, 1372, 408, 1470, 373, 901, 1574, 466, 781]
[rfa agg] considering poison per batch poison_fraction: 0.20078328981723237
[rfa agg] init. name: [92, 33, 42, 36, 22, 98, 4, 17, 76, 3], weight: tensor([0.1791, 0.0538, 0.1433, 0.0426, 0.1535, 0.0390, 0.0941, 0.1644, 0.0487,
        0.0816])
[rfa agg] iter:  0, prev_obj_val: 64.6245346069336, obj_val: 65.84902954101562, abs dis: 1.2244949340820312
[rfa agg] iter: 0, weight: tensor([0.1064, 0.0398, 0.1635, 0.0253, 0.1491, 0.0209, 0.2245, 0.1213, 0.0322,
        0.1170])
[rfa agg] iter:  1, prev_obj_val: 65.84902954101562, obj_val: 65.84137725830078, abs dis: 0.00765228271484375
[rfa agg] iter: 1, weight: tensor([0.0967, 0.0403, 0.1438, 0.0254, 0.1322, 0.0208, 0.2725, 0.1092, 0.0324,
        0.1265])
[rfa agg] iter:  2, prev_obj_val: 65.84137725830078, obj_val: 65.84129333496094, abs dis: 8.392333984375e-05
[rfa agg] iter: 2, weight: tensor([0.0959, 0.0400, 0.1425, 0.0252, 0.1311, 0.0207, 0.2783, 0.1084, 0.0322,
        0.1258])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 10.4427, Accuracy: 35/10000 (0.3500%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 11.3976, Accuracy: 0/9950 (0.0000%)
saving model
Done in 641.2362258434296 sec.
Server Epoch:25 choose agents : [5, 23, 0, 67, 40, 80, 54, 26, 74, 47].
poison local model 5 index 2 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   1, Avg loss: 0.0470, Accuracy: 827/1628 (50.7985%), train_poison_data_count: 1028
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   2, Avg loss: 0.0234, Accuracy: 992/1628 (60.9337%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   3, Avg loss: 0.0205, Accuracy: 1029/1628 (63.2064%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   4, Avg loss: 0.0200, Accuracy: 1026/1628 (63.0221%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   5, Avg loss: 0.0194, Accuracy: 1035/1628 (63.5749%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   6, Avg loss: 0.0183, Accuracy: 1033/1628 (63.4521%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   7, Avg loss: 0.0180, Accuracy: 1042/1628 (64.0049%), train_poison_data_count: 1028
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   8, Avg loss: 0.0180, Accuracy: 1049/1628 (64.4349%), train_poison_data_count: 1028
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   9, Avg loss: 0.0180, Accuracy: 1052/1628 (64.6192%), train_poison_data_count: 1028
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch  10, Avg loss: 0.0179, Accuracy: 1056/1628 (64.8649%), train_poison_data_count: 1028
Global model norm: 199.0617543157148.
Norm before scaling: 199.00481895861216. Distance: 1.1233885137624444
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.3403, Accuracy: 58/10000 (0.5800%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.4624, Accuracy: 9829/9950 (98.7839%)
Scaling by  100
Scaled Norm after poisoning: 223.2777925729516, distance: 112.3388472504614
Total norm for 4 adversaries is: 223.2777925729516. distance: 112.3388472504614
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   1, Avg loss: 0.0586, Accuracy: 319/715 (44.6154%)
_Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   2, Avg loss: 0.0381, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.6467, Accuracy: 63/10000 (0.6300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   1, Avg loss: 0.0625, Accuracy: 289/1657 (17.4412%)
_Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   2, Avg loss: 0.0354, Accuracy: 513/1657 (30.9596%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.8549, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   1, Avg loss: 0.0790, Accuracy: 17/426 (3.9906%)
_Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   2, Avg loss: 0.0410, Accuracy: 176/426 (41.3146%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.3142, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   1, Avg loss: 0.0589, Accuracy: 344/1573 (21.8690%)
_Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   2, Avg loss: 0.0362, Accuracy: 534/1573 (33.9479%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7074, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   1, Avg loss: 0.0818, Accuracy: 95/682 (13.9296%)
_Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   2, Avg loss: 0.0408, Accuracy: 255/682 (37.3900%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.4886, Accuracy: 59/10000 (0.5900%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0510, Accuracy: 334/1130 (29.5575%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 492/1130 (43.5398%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.7329, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0599, Accuracy: 304/1446 (21.0235%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0354, Accuracy: 480/1446 (33.1950%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.0027, Accuracy: 74/10000 (0.7400%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0472, Accuracy: 438/1552 (28.2216%)
_Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0221, Accuracy: 713/1552 (45.9407%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 11.8146, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   1, Avg loss: 0.1259, Accuracy: 6/134 (4.4776%)
_Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   2, Avg loss: 0.1115, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.4031, Accuracy: 50/10000 (0.5000%)
time spent on training: 318.29545855522156
[rfa agg] training data poison_ratio: 0.5452800877273143  data num: [1628, 715, 1657, 426, 1573, 682, 1130, 1446, 1552, 134]
[rfa agg] considering poison per batch poison_fraction: 0.34080005482957143
[rfa agg] init. name: [5, 23, 0, 67, 40, 80, 54, 26, 74, 47], weight: tensor([0.1488, 0.0653, 0.1514, 0.0389, 0.1437, 0.0623, 0.1033, 0.1321, 0.1418,
        0.0122])
[rfa agg] iter:  0, prev_obj_val: 29466.67578125, obj_val: 19722.080078125, abs dis: 9744.595703125
[rfa agg] iter: 0, weight: tensor([0.0296, 0.0741, 0.1731, 0.0441, 0.1642, 0.0707, 0.1175, 0.1508, 0.1620,
        0.0138])
[rfa agg] iter:  1, prev_obj_val: 19722.080078125, obj_val: 17734.859375, abs dis: 1987.220703125
[rfa agg] iter: 1, weight: tensor([0.0053, 0.0746, 0.1793, 0.0439, 0.1698, 0.0710, 0.1198, 0.1552, 0.1675,
        0.0137])
[rfa agg] iter:  2, prev_obj_val: 17734.859375, obj_val: 17377.244140625, abs dis: 357.615234375
[rfa agg] iter: 2, weight: tensor([0.0009, 0.0672, 0.1910, 0.0375, 0.1785, 0.0633, 0.1154, 0.1590, 0.1761,
        0.0112])
[rfa agg] iter:  3, prev_obj_val: 17377.244140625, obj_val: 17353.951171875, abs dis: 23.29296875
[rfa agg] iter: 3, weight: tensor([9.9960e-05, 3.0656e-02, 2.7375e-01, 1.4377e-02, 2.1610e-01, 2.7798e-02,
        7.1504e-02, 1.4980e-01, 2.1210e-01, 3.8196e-03])
[rfa agg] iter:  4, prev_obj_val: 17353.951171875, obj_val: 17357.10546875, abs dis: 3.154296875
[rfa agg] iter: 4, weight: tensor([5.1157e-05, 2.8701e-02, 1.5796e-01, 1.1481e-02, 1.8535e-01, 2.5089e-02,
        1.0627e-01, 3.0308e-01, 1.7922e-01, 2.7964e-03])
[rfa agg] iter:  5, prev_obj_val: 17357.10546875, obj_val: 17358.884765625, abs dis: 1.779296875
[rfa agg] iter: 5, weight: tensor([5.8823e-05, 3.6545e-02, 1.4726e-01, 1.4134e-02, 1.6858e-01, 3.1692e-02,
        1.5453e-01, 2.7973e-01, 1.6408e-01, 3.3856e-03])
[rfa agg] iter:  6, prev_obj_val: 17358.884765625, obj_val: 17360.7265625, abs dis: 1.841796875
[rfa agg] iter: 6, weight: tensor([6.2402e-05, 4.0987e-02, 1.4339e-01, 1.5541e-02, 1.6174e-01, 3.5375e-02,
        1.9073e-01, 2.5094e-01, 1.5755e-01, 3.6887e-03])
[rfa agg] iter:  7, prev_obj_val: 17360.7265625, obj_val: 17358.8828125, abs dis: 1.84375
[rfa agg] iter: 7, weight: tensor([6.4596e-05, 4.4977e-02, 1.3707e-01, 1.6694e-02, 1.5275e-01, 3.8620e-02,
        2.3359e-01, 2.2336e-01, 1.4895e-01, 3.9237e-03])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.7546, Accuracy: 36/10000 (0.3600%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 13.1260, Accuracy: 0/9950 (0.0000%)
saving model
Done in 746.9698729515076 sec.
Server Epoch:26 choose agents : [26, 4, 33, 73, 30, 86, 10, 12, 68, 82].
_Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   1, Avg loss: 0.0599, Accuracy: 294/1446 (20.3320%)
_Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   2, Avg loss: 0.0361, Accuracy: 491/1446 (33.9557%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.8025, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   1, Avg loss: 0.0610, Accuracy: 304/901 (33.7403%)
_Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   2, Avg loss: 0.0312, Accuracy: 396/901 (43.9512%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.6033, Accuracy: 49/10000 (0.4900%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   1, Avg loss: 0.0859, Accuracy: 20/515 (3.8835%)
_Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   2, Avg loss: 0.0551, Accuracy: 154/515 (29.9029%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.7387, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0632, Accuracy: 184/938 (19.6162%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 330/938 (35.1812%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.7556, Accuracy: 60/10000 (0.6000%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   1, Avg loss: 0.0841, Accuracy: 53/486 (10.9053%)
_Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   2, Avg loss: 0.0440, Accuracy: 208/486 (42.7984%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.0882, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.0677, Accuracy: 282/1003 (28.1157%)
_Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0364, Accuracy: 388/1003 (38.6839%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.8536, Accuracy: 49/10000 (0.4900%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 180/861 (20.9059%)
_Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   2, Avg loss: 0.0221, Accuracy: 454/861 (52.7294%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.3089, Accuracy: 92/10000 (0.9200%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   1, Avg loss: 0.1064, Accuracy: 6/338 (1.7751%)
_Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   2, Avg loss: 0.0587, Accuracy: 93/338 (27.5148%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.2346, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0636, Accuracy: 349/1163 (30.0086%)
_Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0392, Accuracy: 447/1163 (38.4351%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.1555, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0810, Accuracy: 41/500 (8.2000%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0517, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.0162, Accuracy: 59/10000 (0.5900%)
time spent on training: 202.86392426490784
[rfa agg] training data poison_ratio: 0.2699055330634278  data num: [1446, 901, 515, 938, 486, 1003, 861, 338, 1163, 500]
[rfa agg] considering poison per batch poison_fraction: 0.16869095816464236
[rfa agg] init. name: [26, 4, 33, 73, 30, 86, 10, 12, 68, 82], weight: tensor([0.1774, 0.1105, 0.0632, 0.1151, 0.0596, 0.1231, 0.1056, 0.0415, 0.1427,
        0.0613])
[rfa agg] iter:  0, prev_obj_val: 47.4107551574707, obj_val: 49.544681549072266, abs dis: 2.1339263916015625
[rfa agg] iter: 0, weight: tensor([0.0678, 0.1460, 0.0668, 0.1594, 0.0513, 0.1327, 0.2118, 0.0246, 0.0870,
        0.0526])
[rfa agg] iter:  1, prev_obj_val: 49.544681549072266, obj_val: 49.540836334228516, abs dis: 0.00384521484375
[rfa agg] iter: 1, weight: tensor([0.0690, 0.1391, 0.0808, 0.1500, 0.0608, 0.1263, 0.1970, 0.0282, 0.0864,
        0.0624])
[rfa agg] iter:  2, prev_obj_val: 49.540836334228516, obj_val: 47.31108856201172, abs dis: 2.229747772216797
[rfa agg] iter: 2, weight: tensor([0.0690, 0.1389, 0.0814, 0.1497, 0.0611, 0.1262, 0.1963, 0.0283, 0.0864,
        0.0627])
[rfa agg] iter:  3, prev_obj_val: 47.31108856201172, obj_val: 47.30591583251953, abs dis: 0.0051727294921875
[rfa agg] iter: 3, weight: tensor([0.0665, 0.1459, 0.0662, 0.1589, 0.0507, 0.1308, 0.2193, 0.0243, 0.0854,
        0.0520])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 11.2535, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 14.2067, Accuracy: 0/9950 (0.0000%)
saving model
Done in 629.3685643672943 sec.
Server Epoch:27 choose agents : [9, 64, 30, 13, 76, 44, 39, 22, 78, 85].
poison local model 9 index 3 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Avg loss: 0.0499, Accuracy: 617/1275 (48.3922%), train_poison_data_count: 800
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Avg loss: 0.0231, Accuracy: 739/1275 (57.9608%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   3, Avg loss: 0.0176, Accuracy: 806/1275 (63.2157%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   4, Avg loss: 0.0172, Accuracy: 806/1275 (63.2157%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   5, Avg loss: 0.0178, Accuracy: 811/1275 (63.6078%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   6, Avg loss: 0.0174, Accuracy: 822/1275 (64.4706%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   7, Avg loss: 0.0161, Accuracy: 829/1275 (65.0196%), train_poison_data_count: 800
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   8, Avg loss: 0.0163, Accuracy: 834/1275 (65.4118%), train_poison_data_count: 800
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   9, Avg loss: 0.0163, Accuracy: 839/1275 (65.8039%), train_poison_data_count: 800
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch  10, Avg loss: 0.0165, Accuracy: 823/1275 (64.5490%), train_poison_data_count: 800
Global model norm: 204.6384483210572.
Norm before scaling: 204.59559959832958. Distance: 1.0639504461903042
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.2378, Accuracy: 55/10000 (0.5500%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.2954, Accuracy: 9831/9950 (98.8040%)
Scaling by  100
Scaled Norm after poisoning: 226.56158620505374, distance: 106.3950388734127
Total norm for 5 adversaries is: 226.56158620505374. distance: 106.3950388734127
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   1, Avg loss: 0.0730, Accuracy: 131/953 (13.7461%)
_Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 291/953 (30.5352%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.1834, Accuracy: 62/10000 (0.6200%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   1, Avg loss: 0.0850, Accuracy: 49/486 (10.0823%)
_Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   2, Avg loss: 0.0451, Accuracy: 208/486 (42.7984%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.5904, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0622, Accuracy: 293/1645 (17.8116%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0341, Accuracy: 557/1645 (33.8602%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.6813, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   1, Avg loss: 0.0811, Accuracy: 46/466 (9.8712%)
_Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   2, Avg loss: 0.0482, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.5345, Accuracy: 55/10000 (0.5500%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0684, Accuracy: 297/1750 (16.9714%)
_Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0374, Accuracy: 625/1750 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.1424, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 251/1013 (24.7779%)
_Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 507/1013 (50.0494%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.4523, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   1, Avg loss: 0.0465, Accuracy: 486/1470 (33.0612%)
_Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   2, Avg loss: 0.0256, Accuracy: 772/1470 (52.5170%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.5911, Accuracy: 104/10000 (1.0400%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   1, Avg loss: 0.0841, Accuracy: 15/416 (3.6058%)
_Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   2, Avg loss: 0.0470, Accuracy: 192/416 (46.1538%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.7954, Accuracy: 77/10000 (0.7700%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0588, Accuracy: 388/1988 (19.5171%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0365, Accuracy: 603/1988 (30.3320%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.7955, Accuracy: 81/10000 (0.8100%)
time spent on training: 334.1239914894104
[rfa agg] training data poison_ratio: 0.5160530448438317  data num: [1275, 953, 486, 1645, 466, 1750, 1013, 1470, 416, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.3225331530273948
[rfa agg] init. name: [9, 64, 30, 13, 76, 44, 39, 22, 78, 85], weight: tensor([0.1112, 0.0831, 0.0424, 0.1435, 0.0407, 0.1527, 0.0884, 0.1282, 0.0363,
        0.1734])
[rfa agg] iter:  0, prev_obj_val: 17699.677734375, obj_val: 11023.1162109375, abs dis: 6676.5615234375
[rfa agg] iter: 0, weight: tensor([0.0154, 0.0915, 0.0464, 0.1595, 0.0445, 0.1700, 0.0973, 0.1421, 0.0396,
        0.1938])
[rfa agg] iter:  1, prev_obj_val: 11023.1162109375, obj_val: 10088.3115234375, abs dis: 934.8046875
[rfa agg] iter: 1, weight: tensor([0.0019, 0.0887, 0.0433, 0.1644, 0.0415, 0.1773, 0.0949, 0.1441, 0.0368,
        0.2071])
[rfa agg] iter:  2, prev_obj_val: 10088.3115234375, obj_val: 10022.177734375, abs dis: 66.1337890625
[rfa agg] iter: 2, weight: tensor([1.7387e-04, 5.2814e-02, 2.0925e-02, 1.6308e-01, 2.0065e-02, 2.0225e-01,
        5.8474e-02, 1.2047e-01, 1.7348e-02, 3.4439e-01])
[rfa agg] iter:  3, prev_obj_val: 10022.177734375, obj_val: 10022.513671875, abs dis: 0.3359375
[rfa agg] iter: 3, weight: tensor([5.4909e-05, 3.8631e-02, 1.1884e-02, 3.2701e-01, 1.1393e-02, 2.2442e-01,
        4.5194e-02, 2.0409e-01, 9.6111e-03, 1.2772e-01])
[rfa agg] iter:  4, prev_obj_val: 10022.513671875, obj_val: 10023.947265625, abs dis: 1.43359375
[rfa agg] iter: 4, weight: tensor([5.4064e-05, 4.1907e-02, 1.2406e-02, 3.0982e-01, 1.1893e-02, 1.8078e-01,
        4.9512e-02, 2.7589e-01, 1.0001e-02, 1.0774e-01])
[rfa agg] iter:  5, prev_obj_val: 10023.947265625, obj_val: 10026.109375, abs dis: 2.162109375
[rfa agg] iter: 5, weight: tensor([5.4077e-05, 4.6708e-02, 1.3196e-02, 2.3067e-01, 1.2652e-02, 1.4769e-01,
        5.5832e-02, 3.8668e-01, 1.0600e-02, 9.5918e-02])
[rfa agg] iter:  6, prev_obj_val: 10026.109375, obj_val: 10026.06640625, abs dis: 0.04296875
[rfa agg] iter: 6, weight: tensor([5.4132e-05, 5.2804e-02, 1.4100e-02, 1.7538e-01, 1.3519e-02, 1.2467e-01,
        6.3953e-02, 4.5777e-01, 1.1281e-02, 8.6474e-02])
[rfa agg] iter:  7, prev_obj_val: 10026.06640625, obj_val: 10027.5595703125, abs dis: 1.4931640625
[rfa agg] iter: 7, weight: tensor([5.1257e-05, 5.0038e-02, 1.3348e-02, 1.6307e-01, 1.2797e-02, 1.1757e-01,
        6.0538e-02, 4.9009e-01, 1.0680e-02, 8.1819e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 12.2720, Accuracy: 41/10000 (0.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 17.0907, Accuracy: 0/9950 (0.0000%)
saving model
Done in 763.6945626735687 sec.
Server Epoch:28 choose agents : [64, 26, 82, 31, 65, 98, 73, 61, 44, 18].
_Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   1, Avg loss: 0.0743, Accuracy: 117/953 (12.2770%)
_Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   2, Avg loss: 0.0386, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.4095, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   1, Avg loss: 0.0584, Accuracy: 301/1446 (20.8160%)
_Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   2, Avg loss: 0.0354, Accuracy: 479/1446 (33.1259%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.0839, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.0794, Accuracy: 40/500 (8.0000%)
_Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0504, Accuracy: 183/500 (36.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.4159, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   1, Avg loss: 0.0814, Accuracy: 38/460 (8.2609%)
_Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   2, Avg loss: 0.0400, Accuracy: 190/460 (41.3043%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.5223, Accuracy: 61/10000 (0.6100%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   1, Avg loss: 0.0597, Accuracy: 357/1475 (24.2034%)
_Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   2, Avg loss: 0.0337, Accuracy: 581/1475 (39.3898%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8465, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.0915, Accuracy: 9/373 (2.4129%)
_Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0564, Accuracy: 147/373 (39.4102%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.4047, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   1, Avg loss: 0.0617, Accuracy: 179/938 (19.0832%)
_Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 307/938 (32.7292%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.6306, Accuracy: 54/10000 (0.5400%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   1, Avg loss: 0.1310, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   2, Avg loss: 0.1206, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.1500, Accuracy: 44/10000 (0.4400%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   1, Avg loss: 0.0674, Accuracy: 309/1750 (17.6571%)
_Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   2, Avg loss: 0.0369, Accuracy: 616/1750 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9763, Accuracy: 110/10000 (1.1000%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   1, Avg loss: 0.0759, Accuracy: 77/530 (14.5283%)
_Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   2, Avg loss: 0.0368, Accuracy: 278/530 (52.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.5877, Accuracy: 75/10000 (0.7500%)
time spent on training: 205.21218919754028
[rfa agg] training data poison_ratio: 0.4512338425381904  data num: [953, 1446, 500, 460, 1475, 373, 938, 85, 1750, 530]
[rfa agg] considering poison per batch poison_fraction: 0.282021151586369
[rfa agg] init. name: [64, 26, 82, 31, 65, 98, 73, 61, 44, 18], weight: tensor([0.1120, 0.1699, 0.0588, 0.0541, 0.1733, 0.0438, 0.1102, 0.0100, 0.2056,
        0.0623])
[rfa agg] iter:  0, prev_obj_val: 66.6644058227539, obj_val: 69.15640258789062, abs dis: 2.4919967651367188
[rfa agg] iter: 0, weight: tensor([0.2783, 0.1283, 0.0347, 0.0319, 0.1139, 0.0208, 0.2570, 0.0033, 0.0902,
        0.0416])
[rfa agg] iter:  1, prev_obj_val: 69.15640258789062, obj_val: 70.69865417480469, abs dis: 1.5422515869140625
[rfa agg] iter: 1, weight: tensor([0.3706, 0.0748, 0.0296, 0.0273, 0.0680, 0.0170, 0.3171, 0.0026, 0.0566,
        0.0365])
[rfa agg] iter:  2, prev_obj_val: 70.69865417480469, obj_val: 70.69810485839844, abs dis: 0.00054931640625
[rfa agg] iter: 2, weight: tensor([0.3730, 0.0701, 0.0316, 0.0291, 0.0642, 0.0179, 0.3177, 0.0026, 0.0543,
        0.0394])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 11.6684, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 15.6114, Accuracy: 0/9950 (0.0000%)
saving model
Done in 630.4768271446228 sec.
Server Epoch:29 choose agents : [10, 11, 42, 19, 88, 80, 54, 78, 92, 96].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Avg loss: 0.0522, Accuracy: 367/861 (42.6249%), train_poison_data_count: 549
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Avg loss: 0.0302, Accuracy: 493/861 (57.2590%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Avg loss: 0.0223, Accuracy: 486/861 (56.4460%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Avg loss: 0.0201, Accuracy: 543/861 (63.0662%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Avg loss: 0.0197, Accuracy: 549/861 (63.7631%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Avg loss: 0.0197, Accuracy: 540/861 (62.7178%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Avg loss: 0.0196, Accuracy: 546/861 (63.4146%), train_poison_data_count: 549
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Avg loss: 0.0183, Accuracy: 551/861 (63.9954%), train_poison_data_count: 549
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Avg loss: 0.0186, Accuracy: 546/861 (63.4146%), train_poison_data_count: 549
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Avg loss: 0.0188, Accuracy: 541/861 (62.8339%), train_poison_data_count: 549
Global model norm: 210.10568397237614.
Norm before scaling: 210.07720864898695. Distance: 0.8556658374077474
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.6489, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: 0.4389, Accuracy: 9699/9950 (97.4774%)
Scaling by  100
Scaled Norm after poisoning: 224.04591988864692, distance: 85.5665859141289
Total norm for 4 adversaries is: 224.04591988864692. distance: 85.5665859141289
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0590, Accuracy: 224/712 (31.4607%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0281, Accuracy: 433/712 (60.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.2050, Accuracy: 71/10000 (0.7100%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   1, Avg loss: 0.0584, Accuracy: 247/1372 (18.0029%)
_Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   2, Avg loss: 0.0324, Accuracy: 496/1372 (36.1516%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.0076, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   1, Avg loss: 0.0538, Accuracy: 327/1036 (31.5637%)
_Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   2, Avg loss: 0.0246, Accuracy: 653/1036 (63.0309%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.3841, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.0735, Accuracy: 129/603 (21.3930%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0466, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.8245, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   1, Avg loss: 0.0798, Accuracy: 107/682 (15.6891%)
_Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   2, Avg loss: 0.0410, Accuracy: 261/682 (38.2698%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.7191, Accuracy: 52/10000 (0.5200%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0499, Accuracy: 358/1130 (31.6814%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 479/1130 (42.3894%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.8365, Accuracy: 53/10000 (0.5300%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.0838, Accuracy: 17/416 (4.0865%)
_Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0472, Accuracy: 169/416 (40.6250%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.8985, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   1, Avg loss: 0.0568, Accuracy: 400/1715 (23.3236%)
_Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   2, Avg loss: 0.0322, Accuracy: 648/1715 (37.7843%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.0190, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.0875, Accuracy: 3/311 (0.9646%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0585, Accuracy: 122/311 (39.2283%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.5760, Accuracy: 50/10000 (0.5000%)
time spent on training: 305.72715282440186
[rfa agg] training data poison_ratio: 0.42758542656709664  data num: [861, 712, 1372, 1036, 603, 682, 1130, 416, 1715, 311]
[rfa agg] considering poison per batch poison_fraction: 0.2672408916044354
[rfa agg] init. name: [10, 11, 42, 19, 88, 80, 54, 78, 92, 96], weight: tensor([0.0974, 0.0806, 0.1552, 0.1172, 0.0682, 0.0772, 0.1279, 0.0471, 0.1940,
        0.0352])
[rfa agg] iter:  0, prev_obj_val: 11059.880859375, obj_val: 6706.3115234375, abs dis: 4353.5693359375
[rfa agg] iter: 0, weight: tensor([0.0115, 0.0875, 0.1711, 0.1283, 0.0739, 0.0837, 0.1401, 0.0507, 0.2154,
        0.0378])
[rfa agg] iter:  1, prev_obj_val: 6706.3115234375, obj_val: 6199.30029296875, abs dis: 507.01123046875
[rfa agg] iter: 1, weight: tensor([0.0012, 0.0826, 0.1805, 0.1278, 0.0683, 0.0782, 0.1411, 0.0455, 0.2417,
        0.0332])
[rfa agg] iter:  2, prev_obj_val: 6199.30029296875, obj_val: 6189.43408203125, abs dis: 9.8662109375
[rfa agg] iter: 2, weight: tensor([8.1752e-05, 3.9126e-02, 3.3540e-01, 9.5610e-02, 2.8430e-02, 3.4647e-02,
        1.2021e-01, 1.6111e-02, 3.1969e-01, 1.0702e-02])
[rfa agg] iter:  3, prev_obj_val: 6189.43408203125, obj_val: 6191.2392578125, abs dis: 1.80517578125
[rfa agg] iter: 3, weight: tensor([6.8102e-05, 5.1518e-02, 2.6384e-01, 1.8583e-01, 3.4652e-02, 4.3791e-02,
        2.6616e-01, 1.8202e-02, 1.2429e-01, 1.1647e-02])
[rfa agg] iter:  4, prev_obj_val: 6191.2392578125, obj_val: 6193.8544921875, abs dis: 2.615234375
[rfa agg] iter: 4, weight: tensor([6.1834e-05, 7.5641e-02, 1.2157e-01, 3.0305e-01, 4.5433e-02, 6.0499e-02,
        2.7799e-01, 2.1572e-02, 8.0997e-02, 1.3187e-02])
[rfa agg] iter:  5, prev_obj_val: 6193.8544921875, obj_val: 6195.40380859375, abs dis: 1.54931640625
[rfa agg] iter: 5, weight: tensor([6.9255e-05, 1.0561e-01, 1.1499e-01, 2.8773e-01, 5.9755e-02, 8.1854e-02,
        2.2398e-01, 2.6910e-02, 8.3008e-02, 1.6097e-02])
[rfa agg] iter:  6, prev_obj_val: 6195.40380859375, obj_val: 6193.84619140625, abs dis: 1.5576171875
[rfa agg] iter: 6, weight: tensor([7.3380e-05, 1.2812e-01, 1.1375e-01, 2.5593e-01, 6.9345e-02, 9.6879e-02,
        2.0336e-01, 3.0240e-02, 8.4431e-02, 1.7868e-02])
[rfa agg] iter:  7, prev_obj_val: 6193.84619140625, obj_val: 6197.0419921875, abs dis: 3.19580078125
[rfa agg] iter: 7, weight: tensor([6.9648e-05, 1.0761e-01, 1.1571e-01, 2.8465e-01, 6.0389e-02, 8.2896e-02,
        2.2182e-01, 2.7140e-02, 8.3487e-02, 1.6232e-02])
[rfa agg] iter:  8, prev_obj_val: 6197.0419921875, obj_val: 6198.70458984375, abs dis: 1.66259765625
[rfa agg] iter: 8, weight: tensor([7.5773e-05, 1.5258e-01, 1.1012e-01, 2.2476e-01, 7.8811e-02, 1.1257e-01,
        1.8476e-01, 3.3169e-02, 8.3813e-02, 1.9336e-02])
[rfa agg] iter:  9, prev_obj_val: 6198.70458984375, obj_val: 6200.43017578125, abs dis: 1.7255859375
[rfa agg] iter: 9, weight: tensor([7.5979e-05, 1.8356e-01, 1.0395e-01, 1.9249e-01, 8.8305e-02, 1.3012e-01,
        1.6465e-01, 3.5559e-02, 8.0887e-02, 2.0412e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 12.9506, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 18.2906, Accuracy: 0/9950 (0.0000%)
saving model
Done in 734.3285105228424 sec.
Server Epoch:30 choose agents : [90, 87, 0, 73, 61, 97, 66, 35, 1, 22].
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0545, Accuracy: 297/677 (43.8700%)
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 10.1754, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   1, Avg loss: 0.0692, Accuracy: 237/1131 (20.9549%)
_Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   2, Avg loss: 0.0329, Accuracy: 395/1131 (34.9248%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.1615, Accuracy: 61/10000 (0.6100%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0608, Accuracy: 313/1657 (18.8896%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0355, Accuracy: 473/1657 (28.5456%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.4649, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   1, Avg loss: 0.0605, Accuracy: 182/938 (19.4030%)
_Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   2, Avg loss: 0.0327, Accuracy: 349/938 (37.2068%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 10.8298, Accuracy: 59/10000 (0.5900%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   1, Avg loss: 0.1274, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   2, Avg loss: 0.1240, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.3560, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   1, Avg loss: 0.0628, Accuracy: 223/1213 (18.3842%)
_Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   2, Avg loss: 0.0284, Accuracy: 485/1213 (39.9835%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.8281, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0704, Accuracy: 186/1402 (13.2668%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0419, Accuracy: 350/1402 (24.9643%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.0976, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   1, Avg loss: 0.0934, Accuracy: 11/271 (4.0590%)
_Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   2, Avg loss: 0.0602, Accuracy: 92/271 (33.9483%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.6083, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0651, Accuracy: 227/928 (24.4612%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0248, Accuracy: 557/928 (60.0216%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.6916, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   1, Avg loss: 0.0476, Accuracy: 456/1470 (31.0204%)
_Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   2, Avg loss: 0.0250, Accuracy: 774/1470 (52.6531%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 10.2426, Accuracy: 101/10000 (1.0100%)
time spent on training: 177.40969157218933
[rfa agg] training data poison_ratio: 0.17826442898076136  data num: [677, 1131, 1657, 938, 85, 1213, 1402, 271, 928, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.11141526811297585
[rfa agg] init. name: [90, 87, 0, 73, 61, 97, 66, 35, 1, 22], weight: tensor([0.0693, 0.1157, 0.1696, 0.0960, 0.0087, 0.1241, 0.1435, 0.0277, 0.0950,
        0.1504])
[rfa agg] iter:  0, prev_obj_val: 48.82546615600586, obj_val: 47.03660202026367, abs dis: 1.7888641357421875
[rfa agg] iter: 0, weight: tensor([0.0486, 0.1948, 0.0697, 0.1732, 0.0022, 0.1610, 0.0983, 0.0092, 0.1560,
        0.0870])
[rfa agg] iter:  1, prev_obj_val: 47.03660202026367, obj_val: 50.567726135253906, abs dis: 3.5311241149902344
[rfa agg] iter: 1, weight: tensor([0.0429, 0.2220, 0.0700, 0.1457, 0.0020, 0.1822, 0.1018, 0.0085, 0.1359,
        0.0889])
[rfa agg] iter:  2, prev_obj_val: 50.567726135253906, obj_val: 50.52264404296875, abs dis: 0.04508209228515625
[rfa agg] iter: 2, weight: tensor([0.0525, 0.1755, 0.0653, 0.2018, 0.0022, 0.1430, 0.0894, 0.0095, 0.1807,
        0.0800])
[rfa agg] iter:  3, prev_obj_val: 50.52264404296875, obj_val: 50.521602630615234, abs dis: 0.001041412353515625
[rfa agg] iter: 3, weight: tensor([0.0518, 0.1677, 0.0643, 0.2108, 0.0022, 0.1399, 0.0880, 0.0094, 0.1870,
        0.0789])
[rfa agg] iter:  4, prev_obj_val: 50.521602630615234, obj_val: 52.591590881347656, abs dis: 2.069988250732422
[rfa agg] iter: 4, weight: tensor([0.0517, 0.1665, 0.0642, 0.2122, 0.0022, 0.1395, 0.0877, 0.0094, 0.1879,
        0.0788])
[rfa agg] iter:  5, prev_obj_val: 52.591590881347656, obj_val: 50.5296745300293, abs dis: 2.0619163513183594
[rfa agg] iter: 5, weight: tensor([0.0564, 0.1439, 0.0607, 0.2425, 0.0023, 0.1224, 0.0808, 0.0097, 0.2079,
        0.0733])
[rfa agg] iter:  6, prev_obj_val: 50.5296745300293, obj_val: 52.588829040527344, abs dis: 2.059154510498047
[rfa agg] iter: 6, weight: tensor([0.0513, 0.1625, 0.0638, 0.2172, 0.0022, 0.1379, 0.0870, 0.0093, 0.1906,
        0.0782])
[rfa agg] iter:  7, prev_obj_val: 52.588829040527344, obj_val: 50.530113220214844, abs dis: 2.0587158203125
[rfa agg] iter: 7, weight: tensor([0.0563, 0.1433, 0.0606, 0.2436, 0.0022, 0.1221, 0.0807, 0.0097, 0.2083,
        0.0732])
[rfa agg] iter:  8, prev_obj_val: 50.530113220214844, obj_val: 52.58876037597656, abs dis: 2.0586471557617188
[rfa agg] iter: 8, weight: tensor([0.0513, 0.1624, 0.0637, 0.2174, 0.0022, 0.1379, 0.0870, 0.0093, 0.1906,
        0.0782])
[rfa agg] iter:  9, prev_obj_val: 52.58876037597656, obj_val: 50.530128479003906, abs dis: 2.0586318969726562
[rfa agg] iter: 9, weight: tensor([0.0563, 0.1433, 0.0606, 0.2436, 0.0022, 0.1221, 0.0807, 0.0097, 0.2083,
        0.0732])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 13.2667, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 15.6980, Accuracy: 0/9950 (0.0000%)
saving model
Done in 605.1663851737976 sec.
Server Epoch:31 choose agents : [12, 97, 60, 95, 0, 45, 47, 74, 1, 90].
poison local model 12 index 5 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   1, Avg loss: 0.0825, Accuracy: 42/338 (12.4260%), train_poison_data_count: 218
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   2, Avg loss: 0.0442, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   3, Avg loss: 0.0481, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   4, Avg loss: 0.0462, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   5, Avg loss: 0.0434, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   6, Avg loss: 0.0393, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   7, Avg loss: 0.0362, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   8, Avg loss: 0.0345, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   9, Avg loss: 0.0325, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch  10, Avg loss: 0.0330, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Global model norm: 215.39339917056418.
Norm before scaling: 215.38375997855547. Distance: 0.5219285195141853
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5870, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: 0.2158, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 220.62625707857168, distance: 52.19285152202359
Total norm for 5 adversaries is: 220.62625707857168. distance: 52.19285152202359
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0619, Accuracy: 246/1213 (20.2803%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0283, Accuracy: 517/1213 (42.6216%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.9714, Accuracy: 85/10000 (0.8500%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0555, Accuracy: 520/2227 (23.3498%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0291, Accuracy: 988/2227 (44.3646%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.9549, Accuracy: 115/10000 (1.1500%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.0707, Accuracy: 199/599 (33.2220%)
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0323, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 13.6742, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0594, Accuracy: 302/1657 (18.2257%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0354, Accuracy: 504/1657 (30.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.2184, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   1, Avg loss: 0.0748, Accuracy: 127/669 (18.9836%)
_Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   2, Avg loss: 0.0417, Accuracy: 352/669 (52.6158%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.1659, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   1, Avg loss: 0.1300, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   2, Avg loss: 0.1155, Accuracy: 5/134 (3.7313%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.7941, Accuracy: 48/10000 (0.4800%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   1, Avg loss: 0.0475, Accuracy: 416/1552 (26.8041%)
_Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   2, Avg loss: 0.0221, Accuracy: 716/1552 (46.1340%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 11.7553, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0624, Accuracy: 225/928 (24.2457%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0246, Accuracy: 556/928 (59.9138%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.4077, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   1, Avg loss: 0.0577, Accuracy: 278/677 (41.0635%)
_Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.3850, Accuracy: 55/10000 (0.5500%)
time spent on training: 305.32740235328674
[rfa agg] training data poison_ratio: 0.6376826095657394  data num: [338, 1213, 2227, 599, 1657, 669, 134, 1552, 928, 677]
[rfa agg] considering poison per batch poison_fraction: 0.39855163097858715
[rfa agg] init. name: [12, 97, 60, 95, 0, 45, 47, 74, 1, 90], weight: tensor([0.0338, 0.1214, 0.2228, 0.0599, 0.1658, 0.0669, 0.0134, 0.1553, 0.0929,
        0.0677])
[rfa agg] iter:  0, prev_obj_val: 1810.6044921875, obj_val: 1019.0233154296875, abs dis: 791.5811767578125
[rfa agg] iter: 0, weight: tensor([0.0012, 0.1207, 0.2586, 0.0551, 0.1758, 0.0620, 0.0115, 0.1632, 0.0892,
        0.0628])
[rfa agg] iter:  1, prev_obj_val: 1019.0233154296875, obj_val: 1017.4238891601562, abs dis: 1.59942626953125
[rfa agg] iter: 1, weight: tensor([5.5361e-05, 9.0187e-02, 1.1642e-01, 1.9559e-02, 3.5677e-01, 2.3302e-02,
        2.9470e-03, 3.2283e-01, 4.4300e-02, 2.3638e-02])
[rfa agg] iter:  2, prev_obj_val: 1017.4238891601562, obj_val: 1019.14306640625, abs dis: 1.71917724609375
[rfa agg] iter: 2, weight: tensor([6.0365e-05, 1.4946e-01, 1.0069e-01, 2.5473e-02, 2.7243e-01, 3.0742e-02,
        3.6288e-03, 3.2359e-01, 6.2699e-02, 3.1235e-02])
[rfa agg] iter:  3, prev_obj_val: 1019.14306640625, obj_val: 1020.5137939453125, abs dis: 1.3707275390625
[rfa agg] iter: 3, weight: tensor([6.7374e-05, 2.3704e-01, 1.0059e-01, 3.2083e-02, 2.1424e-01, 3.9119e-02,
        4.3610e-03, 2.4771e-01, 8.5014e-02, 3.9788e-02])
[rfa agg] iter:  4, prev_obj_val: 1020.5137939453125, obj_val: 1023.3233642578125, abs dis: 2.8095703125
[rfa agg] iter: 4, weight: tensor([6.5585e-05, 3.2201e-01, 9.1562e-02, 3.4171e-02, 1.7372e-01, 4.2027e-02,
        4.4750e-03, 1.9254e-01, 9.6644e-02, 4.2784e-02])
[rfa agg] iter:  5, prev_obj_val: 1023.3233642578125, obj_val: 1026.0528564453125, abs dis: 2.7294921875
[rfa agg] iter: 5, weight: tensor([5.7969e-05, 4.3217e-01, 7.3635e-02, 3.5079e-02, 1.2272e-01, 4.3832e-02,
        4.2986e-03, 1.3124e-01, 1.1224e-01, 4.4722e-02])
[rfa agg] iter:  6, prev_obj_val: 1026.0528564453125, obj_val: 1027.68701171875, abs dis: 1.6341552734375
[rfa agg] iter: 6, weight: tensor([5.8867e-05, 4.1677e-01, 7.0491e-02, 3.9858e-02, 1.0953e-01, 5.0481e-02,
        4.6323e-03, 1.1497e-01, 1.4158e-01, 5.1627e-02])
[rfa agg] iter:  7, prev_obj_val: 1027.68701171875, obj_val: 1027.6727294921875, abs dis: 0.0142822265625
[rfa agg] iter: 7, weight: tensor([6.2802e-05, 3.6130e-01, 7.3131e-02, 4.5249e-02, 1.1034e-01, 5.7777e-02,
        5.0979e-03, 1.1512e-01, 1.7275e-01, 5.9165e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 11.1415, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 11.4271, Accuracy: 0/9950 (0.0000%)
saving model
Done in 734.4063057899475 sec.
Server Epoch:32 choose agents : [90, 32, 84, 98, 78, 46, 40, 68, 29, 95].
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0560, Accuracy: 268/677 (39.5864%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 451/677 (66.6174%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 10.6729, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0619, Accuracy: 154/735 (20.9524%)
_Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 358/735 (48.7075%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 11.5187, Accuracy: 67/10000 (0.6700%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0659, Accuracy: 269/1190 (22.6050%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 432/1190 (36.3025%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.9253, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   1, Avg loss: 0.0904, Accuracy: 8/373 (2.1448%)
_Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   2, Avg loss: 0.0553, Accuracy: 143/373 (38.3378%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.7557, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   1, Avg loss: 0.0838, Accuracy: 24/416 (5.7692%)
_Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 204/416 (49.0385%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.0659, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0570, Accuracy: 439/1904 (23.0567%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0324, Accuracy: 681/1904 (35.7668%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9557, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   1, Avg loss: 0.0597, Accuracy: 339/1573 (21.5512%)
_Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   2, Avg loss: 0.0356, Accuracy: 532/1573 (33.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.4370, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   1, Avg loss: 0.0677, Accuracy: 315/1163 (27.0851%)
_Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   2, Avg loss: 0.0409, Accuracy: 429/1163 (36.8874%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9116, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   1, Avg loss: 0.0514, Accuracy: 353/1440 (24.5139%)
_Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 660/1440 (45.8333%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.2113, Accuracy: 85/10000 (0.8500%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0754, Accuracy: 181/599 (30.2170%)
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0329, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 13.5720, Accuracy: 50/10000 (0.5000%)
time spent on training: 204.82905912399292
[rfa agg] training data poison_ratio: 0.21896722939424032  data num: [677, 735, 1190, 373, 416, 1904, 1573, 1163, 1440, 599]
[rfa agg] considering poison per batch poison_fraction: 0.1368545183714002
[rfa agg] init. name: [90, 32, 84, 98, 78, 46, 40, 68, 29, 95], weight: tensor([0.0672, 0.0730, 0.1182, 0.0370, 0.0413, 0.1891, 0.1562, 0.1155, 0.1430,
        0.0595])
[rfa agg] iter:  0, prev_obj_val: 64.6991958618164, obj_val: 67.85698699951172, abs dis: 3.1577911376953125
[rfa agg] iter: 0, weight: tensor([0.0528, 0.0670, 0.2367, 0.0165, 0.0202, 0.0782, 0.1060, 0.2537, 0.1284,
        0.0405])
[rfa agg] iter:  1, prev_obj_val: 67.85698699951172, obj_val: 66.10269927978516, abs dis: 1.7542877197265625
[rfa agg] iter: 1, weight: tensor([0.0675, 0.0880, 0.2197, 0.0197, 0.0244, 0.0794, 0.1031, 0.2263, 0.1214,
        0.0507])
[rfa agg] iter:  2, prev_obj_val: 66.10269927978516, obj_val: 67.85282897949219, abs dis: 1.7501296997070312
[rfa agg] iter: 2, weight: tensor([0.0588, 0.0756, 0.2338, 0.0177, 0.0219, 0.0775, 0.1027, 0.2446, 0.1228,
        0.0446])
[rfa agg] iter:  3, prev_obj_val: 67.85282897949219, obj_val: 66.10281372070312, abs dis: 1.7500152587890625
[rfa agg] iter: 3, weight: tensor([0.0677, 0.0882, 0.2195, 0.0197, 0.0244, 0.0795, 0.1031, 0.2258, 0.1214,
        0.0507])
[rfa agg] iter:  4, prev_obj_val: 66.10281372070312, obj_val: 67.85282897949219, abs dis: 1.7500152587890625
[rfa agg] iter: 4, weight: tensor([0.0588, 0.0756, 0.2338, 0.0177, 0.0219, 0.0775, 0.1027, 0.2446, 0.1228,
        0.0446])
[rfa agg] iter:  5, prev_obj_val: 67.85282897949219, obj_val: 66.10281372070312, abs dis: 1.7500152587890625
[rfa agg] iter: 5, weight: tensor([0.0677, 0.0882, 0.2195, 0.0197, 0.0244, 0.0795, 0.1031, 0.2258, 0.1214,
        0.0507])
[rfa agg] iter:  6, prev_obj_val: 66.10281372070312, obj_val: 67.85282897949219, abs dis: 1.7500152587890625
[rfa agg] iter: 6, weight: tensor([0.0588, 0.0756, 0.2338, 0.0177, 0.0219, 0.0775, 0.1027, 0.2446, 0.1228,
        0.0446])
[rfa agg] iter:  7, prev_obj_val: 67.85282897949219, obj_val: 66.10281372070312, abs dis: 1.7500152587890625
[rfa agg] iter: 7, weight: tensor([0.0677, 0.0882, 0.2195, 0.0197, 0.0244, 0.0795, 0.1031, 0.2258, 0.1214,
        0.0507])
[rfa agg] iter:  8, prev_obj_val: 66.10281372070312, obj_val: 67.85282897949219, abs dis: 1.7500152587890625
[rfa agg] iter: 8, weight: tensor([0.0588, 0.0756, 0.2338, 0.0177, 0.0219, 0.0775, 0.1027, 0.2446, 0.1228,
        0.0446])
[rfa agg] iter:  9, prev_obj_val: 67.85282897949219, obj_val: 66.10281372070312, abs dis: 1.7500152587890625
[rfa agg] iter: 9, weight: tensor([0.0677, 0.0882, 0.2195, 0.0197, 0.0244, 0.0795, 0.1031, 0.2258, 0.1214,
        0.0507])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 10.7894, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 12.3710, Accuracy: 0/9950 (0.0000%)
saving model
Done in 635.0588719844818 sec.
Server Epoch:33 choose agents : [15, 44, 14, 40, 61, 33, 88, 73, 21, 30].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Avg loss: 0.0525, Accuracy: 569/1154 (49.3068%), train_poison_data_count: 722
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Avg loss: 0.0272, Accuracy: 642/1154 (55.6326%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Avg loss: 0.0231, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Avg loss: 0.0228, Accuracy: 721/1154 (62.4783%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Avg loss: 0.0221, Accuracy: 715/1154 (61.9584%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Avg loss: 0.0215, Accuracy: 717/1154 (62.1317%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Avg loss: 0.0212, Accuracy: 723/1154 (62.6516%), train_poison_data_count: 722
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Avg loss: 0.0211, Accuracy: 717/1154 (62.1317%), train_poison_data_count: 722
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Avg loss: 0.0212, Accuracy: 723/1154 (62.6516%), train_poison_data_count: 722
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Avg loss: 0.0207, Accuracy: 716/1154 (62.0451%), train_poison_data_count: 722
Global model norm: 220.56062268965871.
Norm before scaling: 220.51634186891908. Distance: 0.9692610038957221
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.6036, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: 0.4170, Accuracy: 9615/9950 (96.6332%)
Scaling by  100
Scaled Norm after poisoning: 236.63090985752473, distance: 96.92609539618317
Total norm for 5 adversaries is: 236.63090985752473. distance: 96.92609539618317
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Avg loss: 0.0661, Accuracy: 301/1750 (17.2000%)
_Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Avg loss: 0.0367, Accuracy: 604/1750 (34.5143%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8316, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0770, Accuracy: 122/1013 (12.0434%)
_Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0370, Accuracy: 339/1013 (33.4650%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.1657, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   1, Avg loss: 0.0587, Accuracy: 341/1573 (21.6783%)
_Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   2, Avg loss: 0.0363, Accuracy: 532/1573 (33.8207%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.7168, Accuracy: 74/10000 (0.7400%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   1, Avg loss: 0.1279, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   2, Avg loss: 0.1191, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.0614, Accuracy: 42/10000 (0.4200%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   1, Avg loss: 0.0875, Accuracy: 10/515 (1.9417%)
_Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   2, Avg loss: 0.0586, Accuracy: 140/515 (27.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.4174, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   1, Avg loss: 0.0715, Accuracy: 136/603 (22.5539%)
_Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   2, Avg loss: 0.0470, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.4948, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   1, Avg loss: 0.0579, Accuracy: 204/938 (21.7484%)
_Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   2, Avg loss: 0.0325, Accuracy: 334/938 (35.6077%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.0339, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   1, Avg loss: 0.0596, Accuracy: 302/1949 (15.4951%)
_Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   2, Avg loss: 0.0347, Accuracy: 560/1949 (28.7327%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.7758, Accuracy: 77/10000 (0.7700%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   1, Avg loss: 0.0861, Accuracy: 53/486 (10.9053%)
_Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   2, Avg loss: 0.0455, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.2431, Accuracy: 52/10000 (0.5200%)
time spent on training: 327.1360957622528
[rfa agg] training data poison_ratio: 0.3963838664812239  data num: [1154, 1750, 1013, 1573, 85, 515, 603, 938, 1949, 486]
[rfa agg] considering poison per batch poison_fraction: 0.24773991655076494
[rfa agg] init. name: [15, 44, 14, 40, 61, 33, 88, 73, 21, 30], weight: tensor([0.1146, 0.1739, 0.1006, 0.1563, 0.0084, 0.0512, 0.0599, 0.0932, 0.1936,
        0.0483])
[rfa agg] iter:  0, prev_obj_val: 17286.654296875, obj_val: 10837.62890625, abs dis: 6449.025390625
[rfa agg] iter: 0, weight: tensor([0.0165, 0.1942, 0.1112, 0.1741, 0.0092, 0.0562, 0.0658, 0.1029, 0.2169,
        0.0530])
[rfa agg] iter:  1, prev_obj_val: 10837.62890625, obj_val: 9899.6279296875, abs dis: 938.0009765625
[rfa agg] iter: 1, weight: tensor([0.0021, 0.2036, 0.1091, 0.1794, 0.0084, 0.0531, 0.0626, 0.1004, 0.2315,
        0.0498])
[rfa agg] iter:  2, prev_obj_val: 9899.6279296875, obj_val: 9830.8583984375, abs dis: 68.76953125
[rfa agg] iter: 2, weight: tensor([2.0731e-04, 2.4217e-01, 7.1587e-02, 1.7621e-01, 3.7389e-03, 2.8192e-02,
        3.4157e-02, 6.3737e-02, 3.5422e-01, 2.5775e-02])
[rfa agg] iter:  3, prev_obj_val: 9830.8583984375, obj_val: 9832.23046875, abs dis: 1.3720703125
[rfa agg] iter: 3, weight: tensor([7.4849e-05, 2.3846e-01, 7.4927e-02, 3.8919e-01, 2.2916e-03, 2.0931e-02,
        2.6357e-02, 6.2777e-02, 1.6642e-01, 1.8569e-02])
[rfa agg] iter:  4, prev_obj_val: 9832.23046875, obj_val: 9834.3857421875, abs dis: 2.1552734375
[rfa agg] iter: 4, weight: tensor([7.9172e-05, 2.1044e-01, 8.9590e-02, 3.9644e-01, 2.5327e-03, 2.3698e-02,
        2.9980e-02, 7.4098e-02, 1.5221e-01, 2.0932e-02])
[rfa agg] iter:  5, prev_obj_val: 9834.3857421875, obj_val: 9835.50390625, abs dis: 1.1181640625
[rfa agg] iter: 5, weight: tensor([8.9221e-05, 2.0169e-01, 1.1606e-01, 3.4025e-01, 2.9852e-03, 2.8710e-02,
        3.6552e-02, 9.4659e-02, 1.5376e-01, 2.5240e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 14.0894, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 18.1077, Accuracy: 0/9950 (0.0000%)
saving model
Done in 752.0816481113434 sec.
Server Epoch:34 choose agents : [0, 71, 20, 83, 56, 36, 68, 89, 82, 19].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   1, Avg loss: 0.0593, Accuracy: 309/1657 (18.6482%)
_Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   2, Avg loss: 0.0359, Accuracy: 468/1657 (28.2438%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.5097, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0690, Accuracy: 120/818 (14.6699%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0314, Accuracy: 353/818 (43.1540%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.3978, Accuracy: 79/10000 (0.7900%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   1, Avg loss: 0.0595, Accuracy: 253/807 (31.3507%)
_Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   2, Avg loss: 0.0346, Accuracy: 416/807 (51.5489%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.3105, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0583, Accuracy: 364/1953 (18.6380%)
_Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0360, Accuracy: 653/1953 (33.4357%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.4988, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 44/186 (23.6559%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.8776, Accuracy: 53/10000 (0.5300%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   1, Avg loss: 0.0991, Accuracy: 6/408 (1.4706%)
_Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   2, Avg loss: 0.0613, Accuracy: 145/408 (35.5392%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.8422, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   1, Avg loss: 0.0648, Accuracy: 323/1163 (27.7730%)
_Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   2, Avg loss: 0.0398, Accuracy: 475/1163 (40.8426%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.3834, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   1, Avg loss: 0.0654, Accuracy: 328/896 (36.6071%)
_Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   2, Avg loss: 0.0346, Accuracy: 460/896 (51.3393%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.8113, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.0787, Accuracy: 54/500 (10.8000%)
_Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0504, Accuracy: 186/500 (37.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.1618, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   1, Avg loss: 0.0493, Accuracy: 366/1036 (35.3282%)
_Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   2, Avg loss: 0.0264, Accuracy: 671/1036 (64.7683%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 12.9383, Accuracy: 70/10000 (0.7000%)
time spent on training: 230.77143955230713
[rfa agg] training data poison_ratio: 0.30475382003395585  data num: [1657, 818, 807, 1953, 186, 408, 1163, 896, 500, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.1904711375212224
[rfa agg] init. name: [0, 71, 20, 83, 56, 36, 68, 89, 82, 19], weight: tensor([0.1758, 0.0868, 0.0856, 0.2072, 0.0197, 0.0433, 0.1234, 0.0951, 0.0531,
        0.1099])
[rfa agg] iter:  0, prev_obj_val: 66.47373962402344, obj_val: 68.50238037109375, abs dis: 2.0286407470703125
[rfa agg] iter: 0, weight: tensor([0.0898, 0.0949, 0.0924, 0.0692, 0.0063, 0.0200, 0.1971, 0.1323, 0.0273,
        0.2707])
[rfa agg] iter:  1, prev_obj_val: 68.50238037109375, obj_val: 70.88394927978516, abs dis: 2.3815689086914062
[rfa agg] iter: 1, weight: tensor([0.0722, 0.1284, 0.1240, 0.0584, 0.0065, 0.0218, 0.1360, 0.1951, 0.0303,
        0.2274])
[rfa agg] iter:  2, prev_obj_val: 70.88394927978516, obj_val: 70.82508850097656, abs dis: 0.05886077880859375
[rfa agg] iter: 2, weight: tensor([0.0606, 0.1632, 0.1560, 0.0503, 0.0064, 0.0225, 0.1007, 0.2582, 0.0318,
        0.1502])
[rfa agg] iter:  3, prev_obj_val: 70.82508850097656, obj_val: 72.3591537475586, abs dis: 1.5340652465820312
[rfa agg] iter: 3, weight: tensor([0.0591, 0.1627, 0.1569, 0.0491, 0.0063, 0.0220, 0.0974, 0.2732, 0.0311,
        0.1422])
[rfa agg] iter:  4, prev_obj_val: 72.3591537475586, obj_val: 76.4707260131836, abs dis: 4.111572265625
[rfa agg] iter: 4, weight: tensor([0.0537, 0.1812, 0.1739, 0.0451, 0.0062, 0.0222, 0.0845, 0.2835, 0.0317,
        0.1180])
[rfa agg] iter:  5, prev_obj_val: 76.4707260131836, obj_val: 79.0339126586914, abs dis: 2.5631866455078125
[rfa agg] iter: 5, weight: tensor([0.0505, 0.2259, 0.2151, 0.0433, 0.0068, 0.0259, 0.0732, 0.2266, 0.0379,
        0.0949])
[rfa agg] iter:  6, prev_obj_val: 79.0339126586914, obj_val: 79.02731323242188, abs dis: 0.00659942626953125
[rfa agg] iter: 6, weight: tensor([0.0517, 0.2413, 0.2277, 0.0447, 0.0075, 0.0297, 0.0722, 0.1900, 0.0442,
        0.0909])
[rfa agg] iter:  7, prev_obj_val: 79.02731323242188, obj_val: 79.02711486816406, abs dis: 0.0001983642578125
[rfa agg] iter: 7, weight: tensor([0.0514, 0.2464, 0.2294, 0.0445, 0.0075, 0.0296, 0.0718, 0.1849, 0.0441,
        0.0904])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 11.8032, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 15.6542, Accuracy: 0/9950 (0.0000%)
saving model
Done in 661.3901927471161 sec.
Server Epoch:35 choose agents : [18, 75, 5, 22, 38, 73, 46, 20, 83, 88].
poison local model 18 index 7 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   1, Avg loss: 0.0633, Accuracy: 171/530 (32.2642%), train_poison_data_count: 338
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   2, Avg loss: 0.0410, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   3, Avg loss: 0.0314, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   4, Avg loss: 0.0271, Accuracy: 339/530 (63.9623%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   5, Avg loss: 0.0246, Accuracy: 329/530 (62.0755%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   6, Avg loss: 0.0242, Accuracy: 324/530 (61.1321%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   7, Avg loss: 0.0230, Accuracy: 326/530 (61.5094%), train_poison_data_count: 338
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   8, Avg loss: 0.0244, Accuracy: 325/530 (61.3208%), train_poison_data_count: 338
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   9, Avg loss: 0.0219, Accuracy: 327/530 (61.6981%), train_poison_data_count: 338
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch  10, Avg loss: 0.0226, Accuracy: 336/530 (63.3962%), train_poison_data_count: 338
Global model norm: 225.59418072060282.
Norm before scaling: 225.5766915042421. Distance: 0.6667110805816849
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.0524, Accuracy: 56/10000 (0.5600%)
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: 0.4364, Accuracy: 9622/9950 (96.7035%)
Scaling by  100
Scaled Norm after poisoning: 233.4624150023939, distance: 66.67111150547139
Total norm for 3 adversaries is: 233.4624150023939. distance: 66.67111150547139
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   1, Avg loss: 0.0732, Accuracy: 180/776 (23.1959%)
_Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   2, Avg loss: 0.0307, Accuracy: 420/776 (54.1237%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.8509, Accuracy: 74/10000 (0.7400%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   1, Avg loss: 0.0567, Accuracy: 290/1628 (17.8133%)
_Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   2, Avg loss: 0.0273, Accuracy: 729/1628 (44.7789%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.4580, Accuracy: 151/10000 (1.5100%)
_Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   1, Avg loss: 0.0523, Accuracy: 417/1470 (28.3673%)
_Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   2, Avg loss: 0.0254, Accuracy: 828/1470 (56.3265%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.7813, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   1, Avg loss: 0.0745, Accuracy: 188/1131 (16.6225%)
_Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   2, Avg loss: 0.0325, Accuracy: 497/1131 (43.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.5561, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   1, Avg loss: 0.0561, Accuracy: 221/938 (23.5608%)
_Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   2, Avg loss: 0.0320, Accuracy: 348/938 (37.1002%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 9.8846, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   1, Avg loss: 0.0569, Accuracy: 438/1904 (23.0042%)
_Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   2, Avg loss: 0.0321, Accuracy: 734/1904 (38.5504%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.1838, Accuracy: 129/10000 (1.2900%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   1, Avg loss: 0.0580, Accuracy: 255/807 (31.5985%)
_Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   2, Avg loss: 0.0344, Accuracy: 426/807 (52.7881%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.2032, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   1, Avg loss: 0.0575, Accuracy: 406/1953 (20.7885%)
_Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   2, Avg loss: 0.0355, Accuracy: 715/1953 (36.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.3957, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   1, Avg loss: 0.0740, Accuracy: 113/603 (18.7396%)
_Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   2, Avg loss: 0.0482, Accuracy: 290/603 (48.0929%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.8126, Accuracy: 57/10000 (0.5700%)
time spent on training: 326.94959807395935
[rfa agg] training data poison_ratio: 0.25255536626916525  data num: [530, 776, 1628, 1470, 1131, 938, 1904, 807, 1953, 603]
[rfa agg] considering poison per batch poison_fraction: 0.1578471039182283
[rfa agg] init. name: [18, 75, 5, 22, 38, 73, 46, 20, 83, 88], weight: tensor([0.0451, 0.0661, 0.1387, 0.1252, 0.0963, 0.0799, 0.1622, 0.0687, 0.1664,
        0.0514])
[rfa agg] iter:  0, prev_obj_val: 3515.552001953125, obj_val: 1925.068603515625, abs dis: 1590.4833984375
[rfa agg] iter: 0, weight: tensor([0.0022, 0.0659, 0.1471, 0.1309, 0.0983, 0.0804, 0.1754, 0.0685, 0.1808,
        0.0505])
[rfa agg] iter:  1, prev_obj_val: 1925.068603515625, obj_val: 1908.940185546875, abs dis: 16.12841796875
[rfa agg] iter: 1, weight: tensor([5.6180e-05, 2.1157e-02, 1.4783e-01, 8.8880e-02, 4.2510e-02, 2.8783e-02,
        3.1900e-01, 2.2007e-02, 3.1571e-01, 1.4058e-02])
[rfa agg] iter:  2, prev_obj_val: 1908.940185546875, obj_val: 1910.70654296875, abs dis: 1.766357421875
[rfa agg] iter: 2, weight: tensor([5.3035e-05, 2.9146e-02, 2.9203e-01, 2.1214e-01, 6.9857e-02, 4.1893e-02,
        1.6423e-01, 3.0306e-02, 1.4210e-01, 1.8240e-02])
[rfa agg] iter:  3, prev_obj_val: 1910.70654296875, obj_val: 1912.5960693359375, abs dis: 1.8895263671875
[rfa agg] iter: 3, weight: tensor([5.6101e-05, 4.0723e-02, 1.7996e-01, 3.1834e-01, 1.1944e-01, 6.2214e-02,
        1.1129e-01, 4.2314e-02, 1.0162e-01, 2.4044e-02])
[rfa agg] iter:  4, prev_obj_val: 1912.5960693359375, obj_val: 1914.9420166015625, abs dis: 2.345947265625
[rfa agg] iter: 4, weight: tensor([5.9015e-05, 4.7929e-02, 1.5353e-01, 2.8701e-01, 1.5753e-01, 7.5521e-02,
        1.0449e-01, 4.9799e-02, 9.6589e-02, 2.7542e-02])
[rfa agg] iter:  5, prev_obj_val: 1914.9420166015625, obj_val: 1917.535400390625, abs dis: 2.5933837890625
[rfa agg] iter: 5, weight: tensor([6.1207e-05, 5.6402e-02, 1.3545e-01, 2.2411e-01, 2.1201e-01, 9.2265e-02,
        9.8162e-02, 5.8589e-02, 9.1591e-02, 3.1358e-02])
[rfa agg] iter:  6, prev_obj_val: 1917.535400390625, obj_val: 1920.52978515625, abs dis: 2.994384765625
[rfa agg] iter: 6, weight: tensor([5.9278e-05, 6.3089e-02, 1.1401e-01, 1.7025e-01, 2.7662e-01, 1.0828e-01,
        8.6845e-02, 6.5505e-02, 8.1675e-02, 3.3663e-02])
[rfa agg] iter:  7, prev_obj_val: 1920.52978515625, obj_val: 1924.15234375, abs dis: 3.62255859375
[rfa agg] iter: 7, weight: tensor([5.5589e-05, 6.9745e-02, 9.4347e-02, 1.3096e-01, 3.2430e-01, 1.2706e-01,
        7.4890e-02, 7.2354e-02, 7.0911e-02, 3.5372e-02])
[rfa agg] iter:  8, prev_obj_val: 1924.15234375, obj_val: 1922.251953125, abs dis: 1.900390625
[rfa agg] iter: 8, weight: tensor([5.5524e-05, 8.4304e-02, 8.4274e-02, 1.1086e-01, 2.9342e-01, 1.6449e-01,
        6.9214e-02, 8.7350e-02, 6.5918e-02, 4.0118e-02])
[rfa agg] iter:  9, prev_obj_val: 1922.251953125, obj_val: 1922.2470703125, abs dis: 0.0048828125
[rfa agg] iter: 9, weight: tensor([5.5059e-05, 7.6130e-02, 8.8117e-02, 1.1831e-01, 3.1606e-01, 1.4603e-01,
        7.1272e-02, 7.9012e-02, 6.7695e-02, 3.7328e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 12.8346, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 12.1188, Accuracy: 0/9950 (0.0000%)
saving model
Done in 753.2416515350342 sec.
Server Epoch:36 choose agents : [19, 2, 97, 73, 5, 51, 21, 63, 11, 90].
_Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   1, Avg loss: 0.0495, Accuracy: 361/1036 (34.8456%)
_Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   2, Avg loss: 0.0257, Accuracy: 654/1036 (63.1274%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 13.0123, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 169/605 (27.9339%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0380, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.8517, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   1, Avg loss: 0.0584, Accuracy: 264/1213 (21.7642%)
_Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   2, Avg loss: 0.0282, Accuracy: 530/1213 (43.6933%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.9544, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   1, Avg loss: 0.0548, Accuracy: 212/938 (22.6013%)
_Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   2, Avg loss: 0.0316, Accuracy: 353/938 (37.6333%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.8150, Accuracy: 70/10000 (0.7000%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   1, Avg loss: 0.0554, Accuracy: 347/1628 (21.3145%)
_Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   2, Avg loss: 0.0268, Accuracy: 778/1628 (47.7887%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 10.2129, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0725, Accuracy: 185/1049 (17.6358%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0300, Accuracy: 498/1049 (47.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.5601, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   1, Avg loss: 0.0582, Accuracy: 317/1949 (16.2648%)
_Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   2, Avg loss: 0.0341, Accuracy: 594/1949 (30.4772%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.5857, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   1, Avg loss: 0.0694, Accuracy: 161/888 (18.1306%)
_Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   2, Avg loss: 0.0276, Accuracy: 446/888 (50.2252%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 11.4390, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0609, Accuracy: 230/712 (32.3034%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 429/712 (60.2528%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 10.3800, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   1, Avg loss: 0.0536, Accuracy: 254/677 (37.5185%)
_Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 467/677 (68.9808%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 12.5670, Accuracy: 63/10000 (0.6300%)
time spent on training: 200.54037308692932
[rfa agg] training data poison_ratio: 0.1522206638616176  data num: [1036, 605, 1213, 938, 1628, 1049, 1949, 888, 712, 677]
[rfa agg] considering poison per batch poison_fraction: 0.09513791491351099
[rfa agg] init. name: [19, 2, 97, 73, 5, 51, 21, 63, 11, 90], weight: tensor([0.0969, 0.0566, 0.1134, 0.0877, 0.1522, 0.0981, 0.1822, 0.0830, 0.0666,
        0.0633])
[rfa agg] iter:  0, prev_obj_val: 57.63688659667969, obj_val: 63.31819152832031, abs dis: 5.681304931640625
[rfa agg] iter: 0, weight: tensor([0.1999, 0.0314, 0.1954, 0.1263, 0.0747, 0.1358, 0.0568, 0.0902, 0.0492,
        0.0404])
[rfa agg] iter:  1, prev_obj_val: 63.31819152832031, obj_val: 67.40006256103516, abs dis: 4.081871032714844
[rfa agg] iter: 1, weight: tensor([0.1271, 0.0466, 0.0935, 0.2091, 0.0520, 0.1029, 0.0435, 0.1740, 0.0859,
        0.0655])
[rfa agg] iter:  2, prev_obj_val: 67.40006256103516, obj_val: 69.86334228515625, abs dis: 2.4632797241210938
[rfa agg] iter: 2, weight: tensor([0.1001, 0.0596, 0.0790, 0.1728, 0.0490, 0.0870, 0.0420, 0.2012, 0.1209,
        0.0884])
[rfa agg] iter:  3, prev_obj_val: 69.86334228515625, obj_val: 69.85472869873047, abs dis: 0.00861358642578125
[rfa agg] iter: 3, weight: tensor([0.0915, 0.0695, 0.0747, 0.1465, 0.0483, 0.0815, 0.0418, 0.1905, 0.1485,
        0.1073])
[rfa agg] iter:  4, prev_obj_val: 69.85472869873047, obj_val: 69.85465240478516, abs dis: 7.62939453125e-05
[rfa agg] iter: 4, weight: tensor([0.0910, 0.0695, 0.0744, 0.1444, 0.0481, 0.0810, 0.0416, 0.1895, 0.1524,
        0.1082])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 12.5487, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 10.2104, Accuracy: 0/9950 (0.0000%)
saving model
Done in 640.1662428379059 sec.
Server Epoch:37 choose agents : [20, 66, 18, 64, 77, 51, 65, 3, 17, 50].
poison local model 20 index 8 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   1, Avg loss: 0.0484, Accuracy: 380/807 (47.0880%), train_poison_data_count: 519
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   2, Avg loss: 0.0316, Accuracy: 439/807 (54.3990%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   3, Avg loss: 0.0230, Accuracy: 463/807 (57.3730%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   4, Avg loss: 0.0233, Accuracy: 511/807 (63.3209%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   5, Avg loss: 0.0234, Accuracy: 518/807 (64.1884%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   6, Avg loss: 0.0231, Accuracy: 509/807 (63.0731%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   7, Avg loss: 0.0230, Accuracy: 507/807 (62.8253%), train_poison_data_count: 519
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   8, Avg loss: 0.0221, Accuracy: 515/807 (63.8166%), train_poison_data_count: 519
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   9, Avg loss: 0.0219, Accuracy: 520/807 (64.4362%), train_poison_data_count: 519
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch  10, Avg loss: 0.0222, Accuracy: 519/807 (64.3123%), train_poison_data_count: 519
Global model norm: 230.5376951959267.
Norm before scaling: 230.5088121959766. Distance: 0.7409054977475601
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.3734, Accuracy: 59/10000 (0.5900%)
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: 0.4943, Accuracy: 9261/9950 (93.0754%)
Scaling by  100
Scaled Norm after poisoning: 239.27085691481525, distance: 74.09054716822855
Total norm for 4 adversaries is: 239.27085691481525. distance: 74.09054716822855
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   1, Avg loss: 0.0704, Accuracy: 192/1402 (13.6947%)
_Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   2, Avg loss: 0.0416, Accuracy: 365/1402 (26.0342%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.0463, Accuracy: 84/10000 (0.8400%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   1, Avg loss: 0.0877, Accuracy: 45/530 (8.4906%)
_Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   2, Avg loss: 0.0388, Accuracy: 291/530 (54.9057%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.8626, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   1, Avg loss: 0.0669, Accuracy: 146/953 (15.3200%)
_Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   2, Avg loss: 0.0370, Accuracy: 321/953 (33.6831%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.3240, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0579, Accuracy: 275/1340 (20.5224%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0285, Accuracy: 592/1340 (44.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.0811, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0717, Accuracy: 186/1049 (17.7312%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0315, Accuracy: 469/1049 (44.7092%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.3569, Accuracy: 113/10000 (1.1300%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   1, Avg loss: 0.0600, Accuracy: 338/1475 (22.9153%)
_Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   2, Avg loss: 0.0331, Accuracy: 579/1475 (39.2542%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1549, Accuracy: 82/10000 (0.8200%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   1, Avg loss: 0.0792, Accuracy: 69/781 (8.8348%)
_Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   2, Avg loss: 0.0372, Accuracy: 247/781 (31.6261%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.5518, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   1, Avg loss: 0.0540, Accuracy: 324/1574 (20.5845%)
_Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   2, Avg loss: 0.0294, Accuracy: 611/1574 (38.8183%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.1306, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   1, Avg loss: 0.0635, Accuracy: 126/809 (15.5748%)
_Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 336/809 (41.5328%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.7733, Accuracy: 90/10000 (0.9000%)
time spent on training: 362.3303987979889
[rfa agg] training data poison_ratio: 0.3351679104477612  data num: [807, 1402, 530, 953, 1340, 1049, 1475, 781, 1574, 809]
[rfa agg] considering poison per batch poison_fraction: 0.20947994402985073
[rfa agg] init. name: [20, 66, 18, 64, 77, 51, 65, 3, 17, 50], weight: tensor([0.0753, 0.1308, 0.0494, 0.0889, 0.1250, 0.0979, 0.1376, 0.0729, 0.1468,
        0.0755])
[rfa agg] iter:  0, prev_obj_val: 8136.35595703125, obj_val: 4718.22607421875, abs dis: 3418.1298828125
[rfa agg] iter: 0, weight: tensor([0.0065, 0.1413, 0.0520, 0.0947, 0.1348, 0.1046, 0.1492, 0.0773, 0.1596,
        0.0800])
[rfa agg] iter:  1, prev_obj_val: 4718.22607421875, obj_val: 4453.53466796875, abs dis: 264.69140625
[rfa agg] iter: 1, weight: tensor([0.0005, 0.1494, 0.0419, 0.0857, 0.1392, 0.0987, 0.1658, 0.0672, 0.1819,
        0.0696])
[rfa agg] iter:  2, prev_obj_val: 4453.53466796875, obj_val: 4455.90087890625, abs dis: 2.3662109375
[rfa agg] iter: 2, weight: tensor([5.3078e-05, 2.2365e-01, 2.0282e-02, 7.7021e-02, 2.2657e-01, 9.9780e-02,
        1.3473e-01, 4.6100e-02, 1.2392e-01, 4.7895e-02])
[rfa agg] iter:  3, prev_obj_val: 4455.90087890625, obj_val: 4459.669921875, abs dis: 3.76904296875
[rfa agg] iter: 3, weight: tensor([5.8713e-05, 1.7397e-01, 2.5880e-02, 1.1575e-01, 1.9639e-01, 1.3478e-01,
        1.1579e-01, 6.3394e-02, 1.0807e-01, 6.5927e-02])
[rfa agg] iter:  4, prev_obj_val: 4459.669921875, obj_val: 4461.142578125, abs dis: 1.47265625
[rfa agg] iter: 4, weight: tensor([5.9992e-05, 1.2957e-01, 3.1128e-02, 1.7684e-01, 1.4354e-01, 1.5731e-01,
        9.6062e-02, 8.5065e-02, 9.1749e-02, 8.8681e-02])
[rfa agg] iter:  5, prev_obj_val: 4461.142578125, obj_val: 4461.13623046875, abs dis: 0.00634765625
[rfa agg] iter: 5, weight: tensor([5.8538e-05, 1.1545e-01, 3.2335e-02, 2.0776e-01, 1.2587e-01, 1.5601e-01,
        8.7928e-02, 9.2849e-02, 8.4761e-02, 9.6986e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 12.3865, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 8.7902, Accuracy: 0/9950 (0.0000%)
saving model
Done in 793.0645010471344 sec.
Server Epoch:38 choose agents : [88, 72, 77, 38, 20, 39, 70, 1, 37, 6].
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0770, Accuracy: 120/603 (19.9005%)
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0488, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.9747, Accuracy: 57/10000 (0.5700%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 193/1241 (15.5520%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0375, Accuracy: 377/1241 (30.3787%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.6139, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0575, Accuracy: 295/1340 (22.0149%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0287, Accuracy: 562/1340 (41.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.4184, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0699, Accuracy: 185/1131 (16.3572%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0317, Accuracy: 507/1131 (44.8276%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.8322, Accuracy: 91/10000 (0.9100%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0609, Accuracy: 236/807 (29.2441%)
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0351, Accuracy: 417/807 (51.6729%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.3257, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0594, Accuracy: 228/1013 (22.5074%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0267, Accuracy: 508/1013 (50.1481%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.9064, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0621, Accuracy: 310/1418 (21.8618%)
_Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0332, Accuracy: 589/1418 (41.5374%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.8523, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 265/928 (28.5560%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0248, Accuracy: 610/928 (65.7328%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 11.1331, Accuracy: 106/10000 (1.0600%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0541, Accuracy: 370/1129 (32.7724%)
_Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0250, Accuracy: 738/1129 (65.3676%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.6370, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   1, Avg loss: 0.0601, Accuracy: 367/1956 (18.7628%)
_Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   2, Avg loss: 0.0331, Accuracy: 630/1956 (32.2086%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.6970, Accuracy: 99/10000 (0.9900%)
time spent on training: 227.72696352005005
[rfa agg] training data poison_ratio: 0.2746844198512883  data num: [603, 1241, 1340, 1131, 807, 1013, 1418, 928, 1129, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.17167776240705518
[rfa agg] init. name: [88, 72, 77, 38, 20, 39, 70, 1, 37, 6], weight: tensor([0.0521, 0.1073, 0.1159, 0.0978, 0.0698, 0.0876, 0.1226, 0.0802, 0.0976,
        0.1691])
[rfa agg] iter:  0, prev_obj_val: 49.37696075439453, obj_val: 56.564720153808594, abs dis: 7.1877593994140625
[rfa agg] iter: 0, weight: tensor([0.0258, 0.1307, 0.1081, 0.1637, 0.0553, 0.1481, 0.0787, 0.0864, 0.1562,
        0.0470])
[rfa agg] iter:  1, prev_obj_val: 56.564720153808594, obj_val: 61.815757751464844, abs dis: 5.25103759765625
[rfa agg] iter: 1, weight: tensor([0.0371, 0.0904, 0.0804, 0.1245, 0.0945, 0.2151, 0.0641, 0.1300, 0.1200,
        0.0440])
[rfa agg] iter:  2, prev_obj_val: 61.815757751464844, obj_val: 64.77037048339844, abs dis: 2.9546127319335938
[rfa agg] iter: 2, weight: tensor([0.0483, 0.0819, 0.0751, 0.1065, 0.1407, 0.1873, 0.0619, 0.1495, 0.1037,
        0.0450])
[rfa agg] iter:  3, prev_obj_val: 64.77037048339844, obj_val: 59.046607971191406, abs dis: 5.723762512207031
[rfa agg] iter: 3, weight: tensor([0.0558, 0.0786, 0.0730, 0.0997, 0.1765, 0.1629, 0.0610, 0.1493, 0.0975,
        0.0455])
[rfa agg] iter:  4, prev_obj_val: 59.046607971191406, obj_val: 59.02918243408203, abs dis: 0.017425537109375
[rfa agg] iter: 4, weight: tensor([0.0419, 0.0843, 0.0765, 0.1117, 0.1189, 0.2035, 0.0622, 0.1488, 0.1083,
        0.0440])
[rfa agg] iter:  5, prev_obj_val: 59.02918243408203, obj_val: 59.029052734375, abs dis: 0.00012969970703125
[rfa agg] iter: 5, weight: tensor([0.0417, 0.0841, 0.0762, 0.1118, 0.1154, 0.2086, 0.0620, 0.1481, 0.1082,
        0.0439])
[rfa agg] iter:  6, prev_obj_val: 59.029052734375, obj_val: 61.80435562133789, abs dis: 2.7753028869628906
[rfa agg] iter: 6, weight: tensor([0.0416, 0.0841, 0.0762, 0.1118, 0.1152, 0.2094, 0.0619, 0.1479, 0.1081,
        0.0439])
[rfa agg] iter:  7, prev_obj_val: 61.80435562133789, obj_val: 64.76998138427734, abs dis: 2.965625762939453
[rfa agg] iter: 7, weight: tensor([0.0482, 0.0815, 0.0748, 0.1057, 0.1419, 0.1863, 0.0617, 0.1522, 0.1029,
        0.0449])
[rfa agg] iter:  8, prev_obj_val: 64.76998138427734, obj_val: 59.046669006347656, abs dis: 5.7233123779296875
[rfa agg] iter: 8, weight: tensor([0.0558, 0.0786, 0.0730, 0.0996, 0.1766, 0.1627, 0.0610, 0.1497, 0.0975,
        0.0455])
[rfa agg] iter:  9, prev_obj_val: 59.046669006347656, obj_val: 59.02918243408203, abs dis: 0.017486572265625
[rfa agg] iter: 9, weight: tensor([0.0419, 0.0843, 0.0765, 0.1117, 0.1189, 0.2034, 0.0622, 0.1489, 0.1083,
        0.0440])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.8581, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 3.1229, Accuracy: 9920/9950 (99.6985%)
saving model
Done in 657.9520525932312 sec.
Server Epoch:39 choose agents : [24, 58, 63, 88, 9, 51, 54, 64, 13, 27].
poison local model 24 index 9 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   1, Avg loss: 0.0626, Accuracy: 85/312 (27.2436%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   2, Avg loss: 0.0355, Accuracy: 199/312 (63.7821%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   3, Avg loss: 0.0331, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   4, Avg loss: 0.0320, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   5, Avg loss: 0.0305, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   6, Avg loss: 0.0284, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   7, Avg loss: 0.0267, Accuracy: 199/312 (63.7821%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   8, Avg loss: 0.0261, Accuracy: 199/312 (63.7821%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   9, Avg loss: 0.0218, Accuracy: 204/312 (65.3846%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch  10, Avg loss: 0.0232, Accuracy: 194/312 (62.1795%), train_poison_data_count: 200
Global model norm: 235.3769251116175.
Norm before scaling: 235.36922457067323. Distance: 0.4459908655710917
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6755, Accuracy: 49/10000 (0.4900%)
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: 0.4547, Accuracy: 9435/9950 (94.8241%)
Scaling by  100
Scaled Norm after poisoning: 238.76627071521222, distance: 44.59908895203536
Total norm for 3 adversaries is: 238.76627071521222. distance: 44.59908895203536
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0673, Accuracy: 247/803 (30.7597%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0375, Accuracy: 444/803 (55.2927%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.8055, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0660, Accuracy: 176/888 (19.8198%)
_Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0266, Accuracy: 435/888 (48.9865%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 11.3006, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   1, Avg loss: 0.0774, Accuracy: 119/603 (19.7347%)
_Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   2, Avg loss: 0.0482, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.3592, Accuracy: 57/10000 (0.5700%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0530, Accuracy: 348/1275 (27.2941%)
_Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0203, Accuracy: 657/1275 (51.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 11.5484, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0725, Accuracy: 198/1049 (18.8751%)
_Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0309, Accuracy: 470/1049 (44.8046%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.7125, Accuracy: 103/10000 (1.0300%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 290/1130 (25.6637%)
_Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   2, Avg loss: 0.0294, Accuracy: 474/1130 (41.9469%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 10.2618, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   1, Avg loss: 0.0662, Accuracy: 141/953 (14.7954%)
_Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   2, Avg loss: 0.0366, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.5227, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   1, Avg loss: 0.0615, Accuracy: 307/1645 (18.6626%)
_Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   2, Avg loss: 0.0341, Accuracy: 622/1645 (37.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.7055, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0580, Accuracy: 361/1587 (22.7473%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0349, Accuracy: 559/1587 (35.2237%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.7443, Accuracy: 54/10000 (0.5400%)
time spent on training: 307.5037558078766
[rfa agg] training data poison_ratio: 0.2652025378233285  data num: [312, 803, 888, 603, 1275, 1049, 1130, 953, 1645, 1587]
[rfa agg] considering poison per batch poison_fraction: 0.1657515861395803
[rfa agg] init. name: [24, 58, 63, 88, 9, 51, 54, 64, 13, 27], weight: tensor([0.0305, 0.0784, 0.0867, 0.0589, 0.1245, 0.1024, 0.1103, 0.0930, 0.1606,
        0.1549])
[rfa agg] iter:  0, prev_obj_val: 1383.4622802734375, obj_val: 769.21484375, abs dis: 614.2474365234375
[rfa agg] iter: 0, weight: tensor([0.0010, 0.0750, 0.0838, 0.0544, 0.1292, 0.1028, 0.1119, 0.0911, 0.1796,
        0.1713])
[rfa agg] iter:  1, prev_obj_val: 769.21484375, obj_val: 769.9075317382812, abs dis: 0.69268798828125
[rfa agg] iter: 1, weight: tensor([5.2047e-05, 5.2557e-02, 6.5764e-02, 2.7378e-02, 2.3271e-01, 1.1003e-01,
        1.9899e-01, 8.6110e-02, 1.0619e-01, 1.2022e-01])
[rfa agg] iter:  2, prev_obj_val: 769.9075317382812, obj_val: 775.6520385742188, abs dis: 5.7445068359375
[rfa agg] iter: 2, weight: tensor([4.7190e-05, 7.5153e-02, 9.8553e-02, 3.3648e-02, 1.4355e-01, 1.2479e-01,
        2.2963e-01, 1.4604e-01, 7.1279e-02, 7.7300e-02])
[rfa agg] iter:  3, prev_obj_val: 775.6520385742188, obj_val: 777.6554565429688, abs dis: 2.00341796875
[rfa agg] iter: 3, weight: tensor([4.5493e-05, 1.2493e-01, 1.5360e-01, 4.4423e-02, 9.1043e-02, 1.0545e-01,
        1.2849e-01, 2.3500e-01, 5.6751e-02, 6.0262e-02])
[rfa agg] iter:  4, prev_obj_val: 777.6554565429688, obj_val: 782.8062744140625, abs dis: 5.15081787109375
[rfa agg] iter: 4, weight: tensor([4.4007e-05, 1.4650e-01, 1.7021e-01, 4.7480e-02, 8.0912e-02, 9.4209e-02,
        1.0773e-01, 2.4474e-01, 5.2592e-02, 5.5580e-02])
[rfa agg] iter:  5, prev_obj_val: 782.8062744140625, obj_val: 782.779541015625, abs dis: 0.0267333984375
[rfa agg] iter: 5, weight: tensor([4.6160e-05, 2.1595e-01, 1.8204e-01, 6.2043e-02, 7.3242e-02, 8.4751e-02,
        9.1588e-02, 1.8601e-01, 5.0924e-02, 5.3413e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.8440, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 3.9083, Accuracy: 0/9950 (0.0000%)
saving model
Done in 738.5766208171844 sec.
Server Epoch:40 choose agents : [40, 88, 66, 47, 61, 96, 3, 5, 16, 24].
_Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   1, Avg loss: 0.0606, Accuracy: 288/1573 (18.3090%)
_Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   2, Avg loss: 0.0361, Accuracy: 538/1573 (34.2022%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.8259, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   1, Avg loss: 0.0773, Accuracy: 103/603 (17.0813%)
_Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   2, Avg loss: 0.0490, Accuracy: 290/603 (48.0929%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.0804, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   1, Avg loss: 0.0704, Accuracy: 182/1402 (12.9815%)
_Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   2, Avg loss: 0.0414, Accuracy: 386/1402 (27.5321%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.3611, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1187, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1118, Accuracy: 7/134 (5.2239%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.3493, Accuracy: 56/10000 (0.5600%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   1, Avg loss: 0.1346, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   2, Avg loss: 0.1238, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.2796, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   1, Avg loss: 0.0997, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   2, Avg loss: 0.0685, Accuracy: 86/311 (27.6527%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.3065, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   1, Avg loss: 0.0768, Accuracy: 84/781 (10.7554%)
_Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   2, Avg loss: 0.0374, Accuracy: 240/781 (30.7298%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.9764, Accuracy: 92/10000 (0.9200%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   1, Avg loss: 0.0575, Accuracy: 294/1628 (18.0590%)
_Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   2, Avg loss: 0.0280, Accuracy: 710/1628 (43.6118%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.1109, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   1, Avg loss: 0.0639, Accuracy: 250/708 (35.3107%)
_Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   2, Avg loss: 0.0362, Accuracy: 430/708 (60.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.2064, Accuracy: 63/10000 (0.6300%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   1, Avg loss: 0.0701, Accuracy: 46/312 (14.7436%)
_Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   2, Avg loss: 0.0401, Accuracy: 157/312 (50.3205%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.8277, Accuracy: 50/10000 (0.5000%)
time spent on training: 248.64085459709167
[rfa agg] training data poison_ratio: 0.372296669762505  data num: [1573, 603, 1402, 134, 85, 311, 781, 1628, 708, 312]
[rfa agg] considering poison per batch poison_fraction: 0.2326854186015656
[rfa agg] init. name: [40, 88, 66, 47, 61, 96, 3, 5, 16, 24], weight: tensor([0.2087, 0.0800, 0.1860, 0.0178, 0.0113, 0.0413, 0.1036, 0.2160, 0.0939,
        0.0414])
[rfa agg] iter:  0, prev_obj_val: 68.97173309326172, obj_val: 69.91445922851562, abs dis: 0.9427261352539062
[rfa agg] iter: 0, weight: tensor([0.1750, 0.0774, 0.2399, 0.0084, 0.0049, 0.0231, 0.1649, 0.1620, 0.1212,
        0.0232])
[rfa agg] iter:  1, prev_obj_val: 69.91445922851562, obj_val: 70.9254379272461, abs dis: 1.0109786987304688
[rfa agg] iter: 1, weight: tensor([0.1641, 0.0825, 0.2216, 0.0086, 0.0050, 0.0239, 0.1854, 0.1528, 0.1324,
        0.0239])
[rfa agg] iter:  2, prev_obj_val: 70.9254379272461, obj_val: 71.96558380126953, abs dis: 1.0401458740234375
[rfa agg] iter: 2, weight: tensor([0.1530, 0.0877, 0.2012, 0.0087, 0.0050, 0.0245, 0.2080, 0.1432, 0.1442,
        0.0246])
[rfa agg] iter:  3, prev_obj_val: 71.96558380126953, obj_val: 73.04257202148438, abs dis: 1.0769882202148438
[rfa agg] iter: 3, weight: tensor([0.1409, 0.0923, 0.1809, 0.0088, 0.0051, 0.0248, 0.2337, 0.1325, 0.1562,
        0.0249])
[rfa agg] iter:  4, prev_obj_val: 73.04257202148438, obj_val: 73.03741455078125, abs dis: 0.005157470703125
[rfa agg] iter: 4, weight: tensor([0.1278, 0.0962, 0.1608, 0.0087, 0.0050, 0.0248, 0.2632, 0.1207, 0.1680,
        0.0249])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.7988, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 4.2892, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 676.530606508255 sec.
Server Epoch:41 choose agents : [25, 36, 82, 2, 93, 42, 66, 94, 44, 38].
poison local model 25 index 10 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Avg loss: 0.0521, Accuracy: 269/690 (38.9855%), train_poison_data_count: 440
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 394/690 (57.1014%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   3, Avg loss: 0.0246, Accuracy: 318/690 (46.0870%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   4, Avg loss: 0.0232, Accuracy: 401/690 (58.1159%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   5, Avg loss: 0.0217, Accuracy: 437/690 (63.3333%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   6, Avg loss: 0.0224, Accuracy: 421/690 (61.0145%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   7, Avg loss: 0.0214, Accuracy: 435/690 (63.0435%), train_poison_data_count: 440
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   8, Avg loss: 0.0219, Accuracy: 406/690 (58.8406%), train_poison_data_count: 440
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   9, Avg loss: 0.0210, Accuracy: 411/690 (59.5652%), train_poison_data_count: 440
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch  10, Avg loss: 0.0228, Accuracy: 420/690 (60.8696%), train_poison_data_count: 440
Global model norm: 240.12356844966303.
Norm before scaling: 240.09951550086475. Distance: 0.7717215644212013
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.0338, Accuracy: 63/10000 (0.6300%)
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: 0.5203, Accuracy: 7713/9950 (77.5176%)
Scaling by  100
Scaled Norm after poisoning: 249.79781668131128, distance: 77.17215497772658
Total norm for 4 adversaries is: 249.79781668131128. distance: 77.17215497772658
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   1, Avg loss: 0.0939, Accuracy: 24/408 (5.8824%)
_Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   2, Avg loss: 0.0607, Accuracy: 148/408 (36.2745%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.1751, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   1, Avg loss: 0.0783, Accuracy: 43/500 (8.6000%)
_Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   2, Avg loss: 0.0513, Accuracy: 186/500 (37.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.0531, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0652, Accuracy: 159/605 (26.2810%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.4647, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   1, Avg loss: 0.0602, Accuracy: 354/1742 (20.3215%)
_Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   2, Avg loss: 0.0328, Accuracy: 625/1742 (35.8783%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.4628, Accuracy: 71/10000 (0.7100%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   1, Avg loss: 0.0604, Accuracy: 249/1372 (18.1487%)
_Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   2, Avg loss: 0.0328, Accuracy: 478/1372 (34.8397%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.3801, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0694, Accuracy: 187/1402 (13.3381%)
_Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0414, Accuracy: 376/1402 (26.8188%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.3029, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   1, Avg loss: 0.0599, Accuracy: 297/1662 (17.8700%)
_Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   2, Avg loss: 0.0351, Accuracy: 544/1662 (32.7316%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.5671, Accuracy: 103/10000 (1.0300%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0669, Accuracy: 321/1750 (18.3429%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0371, Accuracy: 600/1750 (34.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.1818, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0683, Accuracy: 200/1131 (17.6835%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0319, Accuracy: 528/1131 (46.6844%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.7650, Accuracy: 91/10000 (0.9100%)
time spent on training: 366.3602111339569
[rfa agg] training data poison_ratio: 0.37471141893091814  data num: [690, 408, 500, 605, 1742, 1372, 1402, 1662, 1750, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.23419463683182384
[rfa agg] init. name: [25, 36, 82, 2, 93, 42, 66, 94, 44, 38], weight: tensor([0.0613, 0.0362, 0.0444, 0.0537, 0.1547, 0.1218, 0.1245, 0.1476, 0.1554,
        0.1004])
[rfa agg] iter:  0, prev_obj_val: 5703.5341796875, obj_val: 3216.81396484375, abs dis: 2486.72021484375
[rfa agg] iter: 0, weight: tensor([0.0042, 0.0367, 0.0452, 0.0550, 0.1668, 0.1291, 0.1319, 0.1582, 0.1676,
        0.1052])
[rfa agg] iter:  1, prev_obj_val: 3216.81396484375, obj_val: 3097.9091796875, abs dis: 118.90478515625
[rfa agg] iter: 1, weight: tensor([0.0002, 0.0209, 0.0264, 0.0339, 0.2074, 0.1194, 0.1223, 0.1772, 0.2090,
        0.0833])
[rfa agg] iter:  2, prev_obj_val: 3097.9091796875, obj_val: 3099.87109375, abs dis: 1.9619140625
[rfa agg] iter: 2, weight: tensor([4.8758e-05, 1.0209e-02, 1.3395e-02, 1.8763e-02, 1.1465e-01, 2.2480e-01,
        2.5324e-01, 1.5908e-01, 1.1641e-01, 8.9406e-02])
[rfa agg] iter:  3, prev_obj_val: 3099.87109375, obj_val: 3103.290771484375, abs dis: 3.419677734375
[rfa agg] iter: 3, weight: tensor([4.7432e-05, 1.0608e-02, 1.3985e-02, 1.9825e-02, 9.5072e-02, 2.4548e-01,
        2.8549e-01, 1.2717e-01, 9.6658e-02, 1.0567e-01])
[rfa agg] iter:  4, prev_obj_val: 3103.290771484375, obj_val: 3101.4501953125, abs dis: 1.840576171875
[rfa agg] iter: 4, weight: tensor([5.2865e-05, 1.2672e-02, 1.6799e-02, 2.4137e-02, 9.3250e-02, 2.3116e-01,
        2.6058e-01, 1.1915e-01, 9.4604e-02, 1.4760e-01])
[rfa agg] iter:  5, prev_obj_val: 3101.4501953125, obj_val: 3101.446533203125, abs dis: 0.003662109375
[rfa agg] iter: 5, weight: tensor([4.9767e-05, 1.1520e-02, 1.5228e-02, 2.1729e-02, 9.3383e-02, 2.3944e-01,
        2.7653e-01, 1.2143e-01, 9.4752e-02, 1.2595e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.8062, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 4.0894, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 801.2777194976807 sec.
Server Epoch:42 choose agents : [55, 57, 12, 67, 31, 76, 26, 6, 64, 97].
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   1, Avg loss: 0.0606, Accuracy: 219/1071 (20.4482%)
_Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   2, Avg loss: 0.0331, Accuracy: 496/1071 (46.3119%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.9043, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   1, Avg loss: 0.0648, Accuracy: 206/1154 (17.8510%)
_Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   2, Avg loss: 0.0283, Accuracy: 457/1154 (39.6014%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 13.4973, Accuracy: 58/10000 (0.5800%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   1, Avg loss: 0.1145, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   2, Avg loss: 0.0674, Accuracy: 76/338 (22.4852%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.1347, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0810, Accuracy: 11/426 (2.5822%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0421, Accuracy: 159/426 (37.3239%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.4016, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0801, Accuracy: 39/460 (8.4783%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0394, Accuracy: 193/460 (41.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.4029, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   1, Avg loss: 0.0845, Accuracy: 30/466 (6.4378%)
_Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   2, Avg loss: 0.0512, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.8921, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   1, Avg loss: 0.0630, Accuracy: 271/1446 (18.7414%)
_Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   2, Avg loss: 0.0364, Accuracy: 503/1446 (34.7856%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.6409, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   1, Avg loss: 0.0605, Accuracy: 321/1956 (16.4110%)
_Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   2, Avg loss: 0.0334, Accuracy: 625/1956 (31.9530%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.7447, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0680, Accuracy: 144/953 (15.1102%)
_Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0377, Accuracy: 299/953 (31.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.7310, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   1, Avg loss: 0.0621, Accuracy: 246/1213 (20.2803%)
_Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   2, Avg loss: 0.0283, Accuracy: 526/1213 (43.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.5298, Accuracy: 68/10000 (0.6800%)
time spent on training: 211.40346789360046
[rfa agg] training data poison_ratio: 0.14858167246651904  data num: [1071, 1154, 338, 426, 460, 466, 1446, 1956, 953, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0928635452915744
[rfa agg] init. name: [55, 57, 12, 67, 31, 76, 26, 6, 64, 97], weight: tensor([0.1129, 0.1217, 0.0356, 0.0449, 0.0485, 0.0491, 0.1525, 0.2063, 0.1005,
        0.1279])
[rfa agg] iter:  0, prev_obj_val: 63.686378479003906, obj_val: 66.5914535522461, abs dis: 2.9050750732421875
[rfa agg] iter: 0, weight: tensor([0.2295, 0.1428, 0.0147, 0.0206, 0.0249, 0.0252, 0.1002, 0.0629, 0.2053,
        0.1737])
[rfa agg] iter:  1, prev_obj_val: 66.5914535522461, obj_val: 68.52926635742188, abs dis: 1.9378128051757812
[rfa agg] iter: 1, weight: tensor([0.2089, 0.1177, 0.0158, 0.0223, 0.0274, 0.0277, 0.0857, 0.0573, 0.2973,
        0.1399])
[rfa agg] iter:  2, prev_obj_val: 68.52926635742188, obj_val: 68.51008605957031, abs dis: 0.0191802978515625
[rfa agg] iter: 2, weight: tensor([0.1800, 0.1061, 0.0164, 0.0234, 0.0289, 0.0292, 0.0798, 0.0550, 0.3571,
        0.1239])
[rfa agg] iter:  3, prev_obj_val: 68.51008605957031, obj_val: 70.74870300292969, abs dis: 2.238616943359375
[rfa agg] iter: 3, weight: tensor([0.1718, 0.1023, 0.0159, 0.0227, 0.0280, 0.0283, 0.0773, 0.0533, 0.3806,
        0.1196])
[rfa agg] iter:  4, prev_obj_val: 70.74870300292969, obj_val: 70.7473373413086, abs dis: 0.00136566162109375
[rfa agg] iter: 4, weight: tensor([0.1605, 0.1008, 0.0179, 0.0257, 0.0320, 0.0323, 0.0779, 0.0552, 0.3818,
        0.1159])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.8268, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 3.6579, Accuracy: 30/9950 (0.3015%)
saving model
Saving model on epoch 42
Done in 639.9981827735901 sec.
Server Epoch:43 choose agents : [30, 89, 47, 67, 72, 23, 57, 51, 45, 60].
poison local model 30 index 11 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0623, Accuracy: 168/486 (34.5679%), train_poison_data_count: 318
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0416, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   3, Avg loss: 0.0373, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   4, Avg loss: 0.0343, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   5, Avg loss: 0.0315, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   6, Avg loss: 0.0268, Accuracy: 314/486 (64.6091%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   7, Avg loss: 0.0269, Accuracy: 311/486 (63.9918%), train_poison_data_count: 318
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   8, Avg loss: 0.0274, Accuracy: 303/486 (62.3457%), train_poison_data_count: 318
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   9, Avg loss: 0.0259, Accuracy: 306/486 (62.9630%), train_poison_data_count: 318
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch  10, Avg loss: 0.0258, Accuracy: 307/486 (63.1687%), train_poison_data_count: 318
Global model norm: 244.77008504155486.
Norm before scaling: 244.7537506096689. Distance: 0.6005350479027322
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.7283, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: 0.4441, Accuracy: 9444/9950 (94.9146%)
Scaling by  100
Scaled Norm after poisoning: 250.36545944129355, distance: 60.05351007447962
Total norm for 3 adversaries is: 250.36545944129355. distance: 60.05351007447962
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0650, Accuracy: 305/896 (34.0402%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0368, Accuracy: 421/896 (46.9866%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.7173, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   1, Avg loss: 0.1292, Accuracy: 3/134 (2.2388%)
_Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   2, Avg loss: 0.1095, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.5990, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   1, Avg loss: 0.0821, Accuracy: 10/426 (2.3474%)
_Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   2, Avg loss: 0.0433, Accuracy: 165/426 (38.7324%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.9274, Accuracy: 55/10000 (0.5500%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   1, Avg loss: 0.0634, Accuracy: 191/1241 (15.3908%)
_Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   2, Avg loss: 0.0372, Accuracy: 391/1241 (31.5068%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.4942, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   1, Avg loss: 0.0634, Accuracy: 255/715 (35.6643%)
_Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   2, Avg loss: 0.0399, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.0220, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   1, Avg loss: 0.0633, Accuracy: 203/1154 (17.5910%)
_Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   2, Avg loss: 0.0305, Accuracy: 441/1154 (38.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 11.7999, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   1, Avg loss: 0.0667, Accuracy: 242/1049 (23.0696%)
_Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   2, Avg loss: 0.0307, Accuracy: 481/1049 (45.8532%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.3184, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0762, Accuracy: 97/669 (14.4993%)
_Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0397, Accuracy: 358/669 (53.5127%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.7281, Accuracy: 85/10000 (0.8500%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   1, Avg loss: 0.0560, Accuracy: 509/2227 (22.8559%)
_Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   2, Avg loss: 0.0289, Accuracy: 973/2227 (43.6911%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.0085, Accuracy: 134/10000 (1.3400%)
time spent on training: 299.7246367931366
[rfa agg] training data poison_ratio: 0.43947982660886964  data num: [486, 896, 134, 426, 1241, 715, 1154, 1049, 669, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.27467489163054354
[rfa agg] init. name: [30, 89, 47, 67, 72, 23, 57, 51, 45, 60], weight: tensor([0.0540, 0.0996, 0.0149, 0.0473, 0.1379, 0.0795, 0.1283, 0.1166, 0.0744,
        0.2475])
[rfa agg] iter:  0, prev_obj_val: 3729.70751953125, obj_val: 2091.688720703125, abs dis: 1638.018798828125
[rfa agg] iter: 0, weight: tensor([0.0032, 0.1018, 0.0145, 0.0469, 0.1448, 0.0805, 0.1341, 0.1208, 0.0750,
        0.2784])
[rfa agg] iter:  1, prev_obj_val: 2091.688720703125, obj_val: 2064.4091796875, abs dis: 27.279541015625
[rfa agg] iter: 1, weight: tensor([1.4495e-04, 6.2775e-02, 5.5949e-03, 2.1112e-02, 1.3025e-01, 4.4764e-02,
        1.1092e-01, 8.7272e-02, 3.9863e-02, 4.9731e-01])
[rfa agg] iter:  2, prev_obj_val: 2064.4091796875, obj_val: 2053.0390625, abs dis: 11.3701171875
[rfa agg] iter: 2, weight: tensor([1.1718e-04, 8.6225e-02, 6.0693e-03, 2.4298e-02, 2.5793e-01, 5.7073e-02,
        1.9102e-01, 1.3008e-01, 4.9709e-02, 1.9749e-01])
[rfa agg] iter:  3, prev_obj_val: 2053.0390625, obj_val: 2055.92041015625, abs dis: 2.88134765625
[rfa agg] iter: 3, weight: tensor([6.6259e-05, 9.4278e-02, 4.4251e-03, 1.9326e-02, 3.2004e-01, 5.3554e-02,
        2.4158e-01, 1.4514e-01, 4.4945e-02, 7.6645e-02])
[rfa agg] iter:  4, prev_obj_val: 2055.92041015625, obj_val: 2056.931396484375, abs dis: 1.010986328125
[rfa agg] iter: 4, weight: tensor([7.1642e-05, 1.7684e-01, 5.5650e-03, 2.6063e-02, 1.9128e-01, 8.3367e-02,
        1.9827e-01, 1.7881e-01, 6.8019e-02, 7.1718e-02])
[rfa agg] iter:  5, prev_obj_val: 2056.931396484375, obj_val: 2059.695068359375, abs dis: 2.763671875
[rfa agg] iter: 5, weight: tensor([7.1034e-05, 2.0973e-01, 5.7120e-03, 2.7251e-02, 1.6560e-01, 9.1854e-02,
        1.7420e-01, 1.8236e-01, 7.3920e-02, 6.9302e-02])
[rfa agg] iter:  6, prev_obj_val: 2059.695068359375, obj_val: 2061.280517578125, abs dis: 1.58544921875
[rfa agg] iter: 6, weight: tensor([6.8160e-05, 2.8103e-01, 5.8686e-03, 2.9149e-02, 1.3180e-01, 1.0772e-01,
        1.3802e-01, 1.5762e-01, 8.5460e-02, 6.3279e-02])
[rfa agg] iter:  7, prev_obj_val: 2061.280517578125, obj_val: 2063.099609375, abs dis: 1.819091796875
[rfa agg] iter: 7, weight: tensor([6.4282e-05, 3.3227e-01, 5.7471e-03, 2.9233e-02, 1.1428e-01, 1.1479e-01,
        1.1861e-01, 1.3643e-01, 9.0317e-02, 5.8259e-02])
[rfa agg] iter:  8, prev_obj_val: 2063.099609375, obj_val: 2063.086669921875, abs dis: 0.012939453125
[rfa agg] iter: 8, weight: tensor([6.1188e-05, 3.6663e-01, 5.6817e-03, 2.9654e-02, 1.0070e-01, 1.2312e-01,
        1.0396e-01, 1.1918e-01, 9.6845e-02, 5.4165e-02])
[rfa agg] iter:  9, prev_obj_val: 2063.086669921875, obj_val: 2067.553955078125, abs dis: 4.46728515625
[rfa agg] iter: 9, weight: tensor([5.9781e-05, 3.8118e-01, 5.5581e-03, 2.9021e-02, 9.8280e-02, 1.2141e-01,
        1.0121e-01, 1.1518e-01, 9.5196e-02, 5.2910e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 21.7937, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 23.0738, Accuracy: 0/9950 (0.0000%)
saving model
Done in 731.551353931427 sec.
Server Epoch:44 choose agents : [20, 45, 15, 72, 6, 60, 59, 46, 31, 84].
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0634, Accuracy: 252/807 (31.2268%)
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0362, Accuracy: 417/807 (51.6729%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.2988, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   1, Avg loss: 0.0726, Accuracy: 115/669 (17.1898%)
_Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   2, Avg loss: 0.0404, Accuracy: 356/669 (53.2138%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.9391, Accuracy: 82/10000 (0.8200%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0652, Accuracy: 268/1154 (23.2236%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0306, Accuracy: 444/1154 (38.4749%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.0712, Accuracy: 72/10000 (0.7200%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   1, Avg loss: 0.0620, Accuracy: 188/1241 (15.1491%)
_Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   2, Avg loss: 0.0379, Accuracy: 367/1241 (29.5729%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.8381, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   1, Avg loss: 0.0601, Accuracy: 336/1956 (17.1779%)
_Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   2, Avg loss: 0.0335, Accuracy: 633/1956 (32.3620%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.6165, Accuracy: 97/10000 (0.9700%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   1, Avg loss: 0.0563, Accuracy: 510/2227 (22.9008%)
_Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   2, Avg loss: 0.0292, Accuracy: 968/2227 (43.4665%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.7339, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   1, Avg loss: 0.0632, Accuracy: 231/1089 (21.2121%)
_Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   2, Avg loss: 0.0340, Accuracy: 514/1089 (47.1993%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 14.0703, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   1, Avg loss: 0.0562, Accuracy: 444/1904 (23.3193%)
_Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   2, Avg loss: 0.0331, Accuracy: 705/1904 (37.0273%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.0320, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0782, Accuracy: 57/460 (12.3913%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0389, Accuracy: 194/460 (42.1739%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.0684, Accuracy: 53/10000 (0.5300%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   1, Avg loss: 0.0653, Accuracy: 273/1190 (22.9412%)
_Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 470/1190 (39.4958%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.1420, Accuracy: 69/10000 (0.6900%)
time spent on training: 341.0406792163849
[rfa agg] training data poison_ratio: 0.521304245097267  data num: [807, 669, 1154, 1241, 1956, 2227, 1089, 1904, 460, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.3258151531857919
[rfa agg] init. name: [20, 45, 15, 72, 6, 60, 59, 46, 31, 84], weight: tensor([0.0636, 0.0527, 0.0909, 0.0977, 0.1541, 0.1754, 0.0858, 0.1500, 0.0362,
        0.0937])
[rfa agg] iter:  0, prev_obj_val: 74.30935668945312, obj_val: 74.9718017578125, abs dis: 0.662445068359375
[rfa agg] iter: 0, weight: tensor([0.0449, 0.0303, 0.1412, 0.2283, 0.0969, 0.0783, 0.1001, 0.1047, 0.0163,
        0.1591])
[rfa agg] iter:  1, prev_obj_val: 74.9718017578125, obj_val: 79.96156311035156, abs dis: 4.9897613525390625
[rfa agg] iter: 1, weight: tensor([0.0431, 0.0285, 0.1480, 0.2742, 0.0751, 0.0623, 0.0988, 0.0805, 0.0151,
        0.1745])
[rfa agg] iter:  2, prev_obj_val: 79.96156311035156, obj_val: 81.896484375, abs dis: 1.9349212646484375
[rfa agg] iter: 2, weight: tensor([0.0562, 0.0351, 0.1635, 0.2254, 0.0630, 0.0545, 0.1154, 0.0665, 0.0176,
        0.2027])
[rfa agg] iter:  3, prev_obj_val: 81.896484375, obj_val: 84.07402801513672, abs dis: 2.1775436401367188
[rfa agg] iter: 3, weight: tensor([0.0637, 0.0391, 0.1657, 0.1982, 0.0634, 0.0553, 0.1235, 0.0667, 0.0193,
        0.2050])
[rfa agg] iter:  4, prev_obj_val: 84.07402801513672, obj_val: 84.0714340209961, abs dis: 0.002593994140625
[rfa agg] iter: 4, weight: tensor([0.0734, 0.0440, 0.1638, 0.1807, 0.0645, 0.0568, 0.1301, 0.0677, 0.0213,
        0.1977])
[rfa agg] iter:  5, prev_obj_val: 84.0714340209961, obj_val: 81.89474487304688, abs dis: 2.1766891479492188
[rfa agg] iter: 5, weight: tensor([0.0736, 0.0441, 0.1637, 0.1797, 0.0646, 0.0569, 0.1313, 0.0678, 0.0214,
        0.1968])
[rfa agg] iter:  6, prev_obj_val: 81.89474487304688, obj_val: 84.0732192993164, abs dis: 2.1784744262695312
[rfa agg] iter: 6, weight: tensor([0.0642, 0.0393, 0.1660, 0.1943, 0.0637, 0.0556, 0.1261, 0.0670, 0.0194,
        0.2045])
[rfa agg] iter:  7, prev_obj_val: 84.0732192993164, obj_val: 84.07141876220703, abs dis: 0.001800537109375
[rfa agg] iter: 7, weight: tensor([0.0734, 0.0440, 0.1639, 0.1804, 0.0645, 0.0568, 0.1305, 0.0677, 0.0213,
        0.1975])
[rfa agg] iter:  8, prev_obj_val: 84.07141876220703, obj_val: 81.8947525024414, abs dis: 2.176666259765625
[rfa agg] iter: 8, weight: tensor([0.0736, 0.0441, 0.1637, 0.1797, 0.0646, 0.0569, 0.1313, 0.0678, 0.0214,
        0.1968])
[rfa agg] iter:  9, prev_obj_val: 81.8947525024414, obj_val: 84.07321166992188, abs dis: 2.1784591674804688
[rfa agg] iter: 9, weight: tensor([0.0642, 0.0393, 0.1660, 0.1943, 0.0637, 0.0556, 0.1261, 0.0670, 0.0194,
        0.2045])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 25.9109, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 21.1765, Accuracy: 0/9950 (0.0000%)
saving model
Done in 769.8137104511261 sec.
Server Epoch:45 choose agents : [33, 77, 72, 6, 23, 47, 93, 87, 53, 86].
poison local model 33 index 12 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   1, Avg loss: 0.0615, Accuracy: 174/515 (33.7864%), train_poison_data_count: 323
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   2, Avg loss: 0.0474, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   3, Avg loss: 0.0412, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   4, Avg loss: 0.0382, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   5, Avg loss: 0.0353, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   6, Avg loss: 0.0340, Accuracy: 322/515 (62.5243%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   7, Avg loss: 0.0326, Accuracy: 321/515 (62.3301%), train_poison_data_count: 323
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   8, Avg loss: 0.0327, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   9, Avg loss: 0.0312, Accuracy: 322/515 (62.5243%), train_poison_data_count: 323
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch  10, Avg loss: 0.0320, Accuracy: 322/515 (62.5243%), train_poison_data_count: 323
Global model norm: 249.287249598731.
Norm before scaling: 249.26757554633937. Distance: 0.5814615572196822
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.0671, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: 0.5120, Accuracy: 9877/9950 (99.2663%)
Scaling by  100
Scaled Norm after poisoning: 253.9885501233274, distance: 58.1461571037803
Total norm for 2 adversaries is: 253.9885501233274. distance: 58.1461571037803
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   1, Avg loss: 0.0596, Accuracy: 291/1340 (21.7164%)
_Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   2, Avg loss: 0.0295, Accuracy: 569/1340 (42.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.5658, Accuracy: 90/10000 (0.9000%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   1, Avg loss: 0.0612, Accuracy: 197/1241 (15.8743%)
_Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   2, Avg loss: 0.0381, Accuracy: 365/1241 (29.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.5097, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   1, Avg loss: 0.0601, Accuracy: 333/1956 (17.0245%)
_Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   2, Avg loss: 0.0341, Accuracy: 617/1956 (31.5440%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.1740, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   1, Avg loss: 0.0649, Accuracy: 249/715 (34.8252%)
_Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   2, Avg loss: 0.0391, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.2515, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   1, Avg loss: 0.1224, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   2, Avg loss: 0.1118, Accuracy: 9/134 (6.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.1807, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0614, Accuracy: 308/1742 (17.6808%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0326, Accuracy: 675/1742 (38.7486%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.4072, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   1, Avg loss: 0.0709, Accuracy: 202/1131 (17.8603%)
_Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   2, Avg loss: 0.0338, Accuracy: 405/1131 (35.8090%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.2600, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   1, Avg loss: 0.0603, Accuracy: 221/813 (27.1833%)
_Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   2, Avg loss: 0.0214, Accuracy: 424/813 (52.1525%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 13.6970, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0726, Accuracy: 280/1003 (27.9163%)
_Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0389, Accuracy: 399/1003 (39.7807%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.3052, Accuracy: 55/10000 (0.5500%)
time spent on training: 332.0255825519562
[rfa agg] training data poison_ratio: 0.16581680830972614  data num: [515, 1340, 1241, 1956, 715, 134, 1742, 1131, 813, 1003]
[rfa agg] considering poison per batch poison_fraction: 0.10363550519357884
[rfa agg] init. name: [33, 77, 72, 6, 23, 47, 93, 87, 53, 86], weight: tensor([0.0486, 0.1265, 0.1172, 0.1847, 0.0675, 0.0127, 0.1645, 0.1068, 0.0768,
        0.0947])
[rfa agg] iter:  0, prev_obj_val: 3781.07958984375, obj_val: 2082.78955078125, abs dis: 1698.2900390625
[rfa agg] iter: 0, weight: tensor([0.0026, 0.1322, 0.1219, 0.2018, 0.0678, 0.0122, 0.1773, 0.1101, 0.0774,
        0.0968])
[rfa agg] iter:  1, prev_obj_val: 2082.78955078125, obj_val: 2055.4423828125, abs dis: 27.34716796875
[rfa agg] iter: 1, weight: tensor([7.8652e-05, 8.9332e-02, 7.6039e-02, 4.0553e-01, 2.5771e-02, 3.2269e-03,
        2.6470e-01, 5.8750e-02, 3.1019e-02, 4.5558e-02])
[rfa agg] iter:  2, prev_obj_val: 2055.4423828125, obj_val: 2051.943359375, abs dis: 3.4990234375
[rfa agg] iter: 2, weight: tensor([6.7006e-05, 2.0105e-01, 1.6272e-01, 1.6060e-01, 3.4684e-02, 3.6781e-03,
        2.1812e-01, 1.0425e-01, 4.3254e-02, 7.1579e-02])
[rfa agg] iter:  3, prev_obj_val: 2051.943359375, obj_val: 2055.167236328125, abs dis: 3.223876953125
[rfa agg] iter: 3, weight: tensor([4.6942e-05, 2.5146e-01, 2.7388e-01, 7.5662e-02, 3.3706e-02, 3.0565e-03,
        9.2323e-02, 1.4183e-01, 4.3865e-02, 8.4167e-02])
[rfa agg] iter:  4, prev_obj_val: 2055.167236328125, obj_val: 2056.547607421875, abs dis: 1.38037109375
[rfa agg] iter: 4, weight: tensor([4.6635e-05, 1.7227e-01, 2.3920e-01, 6.3535e-02, 4.2616e-02, 3.3921e-03,
        7.3083e-02, 2.2062e-01, 5.8160e-02, 1.2707e-01])
[rfa agg] iter:  5, prev_obj_val: 2056.547607421875, obj_val: 2058.2607421875, abs dis: 1.713134765625
[rfa agg] iter: 5, weight: tensor([4.6579e-05, 1.4734e-01, 2.0267e-01, 6.1127e-02, 4.5868e-02, 3.4972e-03,
        6.9519e-02, 2.5834e-01, 6.3595e-02, 1.4799e-01])
[rfa agg] iter:  6, prev_obj_val: 2058.2607421875, obj_val: 2062.399658203125, abs dis: 4.138916015625
[rfa agg] iter: 6, weight: tensor([4.7229e-05, 1.3336e-01, 1.7466e-01, 5.9779e-02, 5.0162e-02, 3.6578e-03,
        6.7355e-02, 2.6716e-01, 7.0821e-02, 1.7300e-01])
[rfa agg] iter:  7, prev_obj_val: 2062.399658203125, obj_val: 2062.36669921875, abs dis: 0.032958984375
[rfa agg] iter: 7, weight: tensor([5.0069e-05, 1.1708e-01, 1.4246e-01, 5.9170e-02, 6.2679e-02, 4.1315e-03,
        6.5600e-02, 2.2443e-01, 9.2709e-02, 2.3169e-01])
[rfa agg] iter:  8, prev_obj_val: 2062.36669921875, obj_val: 2064.73095703125, abs dis: 2.3642578125
[rfa agg] iter: 8, weight: tensor([4.9500e-05, 1.1525e-01, 1.3996e-01, 5.8479e-02, 6.2218e-02, 4.0885e-03,
        6.4892e-02, 2.1594e-01, 9.1993e-02, 2.4712e-01])
[rfa agg] iter:  9, prev_obj_val: 2064.73095703125, obj_val: 2064.72412109375, abs dis: 0.0068359375
[rfa agg] iter: 9, weight: tensor([5.0735e-05, 1.0869e-01, 1.2853e-01, 5.8011e-02, 6.9778e-02, 4.3304e-03,
        6.3910e-02, 1.9114e-01, 1.0621e-01, 2.6935e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.9154, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 4.3170, Accuracy: 0/9950 (0.0000%)
saving model
Done in 756.8992133140564 sec.
Server Epoch:46 choose agents : [43, 30, 40, 2, 69, 83, 22, 84, 91, 15].
_Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   1, Avg loss: 0.0626, Accuracy: 306/946 (32.3467%)
_Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   2, Avg loss: 0.0376, Accuracy: 355/946 (37.5264%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.7123, Accuracy: 56/10000 (0.5600%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0962, Accuracy: 10/486 (2.0576%)
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0477, Accuracy: 206/486 (42.3868%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.4340, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   1, Avg loss: 0.0613, Accuracy: 290/1573 (18.4361%)
_Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   2, Avg loss: 0.0360, Accuracy: 522/1573 (33.1850%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.2112, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0678, Accuracy: 141/605 (23.3058%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0408, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.0726, Accuracy: 73/10000 (0.7300%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   1, Avg loss: 0.0575, Accuracy: 209/590 (35.4237%)
_Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   2, Avg loss: 0.0301, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 13.1658, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   1, Avg loss: 0.0621, Accuracy: 364/1953 (18.6380%)
_Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   2, Avg loss: 0.0361, Accuracy: 672/1953 (34.4086%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.2699, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   1, Avg loss: 0.0548, Accuracy: 407/1470 (27.6871%)
_Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   2, Avg loss: 0.0265, Accuracy: 793/1470 (53.9456%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.2423, Accuracy: 99/10000 (0.9900%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   1, Avg loss: 0.0663, Accuracy: 256/1190 (21.5126%)
_Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 454/1190 (38.1513%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.0706, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   1, Avg loss: 0.0649, Accuracy: 227/1030 (22.0388%)
_Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   2, Avg loss: 0.0266, Accuracy: 606/1030 (58.8350%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.5865, Accuracy: 89/10000 (0.8900%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0638, Accuracy: 287/1154 (24.8700%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0310, Accuracy: 430/1154 (37.2617%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.7294, Accuracy: 62/10000 (0.6200%)
time spent on training: 309.0231730937958
[rfa agg] training data poison_ratio: 0.3109939074292989  data num: [946, 486, 1573, 605, 590, 1953, 1470, 1190, 1030, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.1943711921433118
[rfa agg] init. name: [43, 30, 40, 2, 69, 83, 22, 84, 91, 15], weight: tensor([0.0860, 0.0442, 0.1430, 0.0550, 0.0537, 0.1776, 0.1337, 0.1082, 0.0937,
        0.1049])
[rfa agg] iter:  0, prev_obj_val: 58.1973991394043, obj_val: 60.99592971801758, abs dis: 2.7985305786132812
[rfa agg] iter: 0, weight: tensor([0.0947, 0.0191, 0.1079, 0.0288, 0.0283, 0.0706, 0.1391, 0.2168, 0.1313,
        0.1634])
[rfa agg] iter:  1, prev_obj_val: 60.99592971801758, obj_val: 68.15768432617188, abs dis: 7.161754608154297
[rfa agg] iter: 1, weight: tensor([0.1326, 0.0220, 0.0878, 0.0340, 0.0335, 0.0628, 0.1081, 0.2001, 0.1645,
        0.1546])
[rfa agg] iter:  2, prev_obj_val: 68.15768432617188, obj_val: 68.07135772705078, abs dis: 0.08632659912109375
[rfa agg] iter: 2, weight: tensor([0.2340, 0.0294, 0.0758, 0.0482, 0.0476, 0.0589, 0.0881, 0.1367, 0.1622,
        0.1192])
[rfa agg] iter:  3, prev_obj_val: 68.07135772705078, obj_val: 72.81446838378906, abs dis: 4.743110656738281
[rfa agg] iter: 3, weight: tensor([0.2595, 0.0287, 0.0736, 0.0472, 0.0465, 0.0572, 0.0855, 0.1305, 0.1573,
        0.1140])
[rfa agg] iter:  4, prev_obj_val: 72.81446838378906, obj_val: 70.33221435546875, abs dis: 2.4822540283203125
[rfa agg] iter: 4, weight: tensor([0.2834, 0.0346, 0.0709, 0.0592, 0.0586, 0.0570, 0.0807, 0.1144, 0.1381,
        0.1030])
[rfa agg] iter:  5, prev_obj_val: 70.33221435546875, obj_val: 70.33084106445312, abs dis: 0.001373291015625
[rfa agg] iter: 5, weight: tensor([0.2973, 0.0307, 0.0702, 0.0515, 0.0508, 0.0555, 0.0806, 0.1178, 0.1411,
        0.1046])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.9532, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 4.4875, Accuracy: 0/9950 (0.0000%)
saving model
Done in 733.9026851654053 sec.
Server Epoch:47 choose agents : [36, 81, 80, 26, 12, 78, 60, 58, 75, 19].
poison local model 36 index 13 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   1, Avg loss: 0.0691, Accuracy: 95/408 (23.2843%), train_poison_data_count: 264
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   2, Avg loss: 0.0426, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   3, Avg loss: 0.0448, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   4, Avg loss: 0.0420, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   5, Avg loss: 0.0380, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   6, Avg loss: 0.0326, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   7, Avg loss: 0.0334, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   8, Avg loss: 0.0316, Accuracy: 262/408 (64.2157%), train_poison_data_count: 264
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   9, Avg loss: 0.0315, Accuracy: 263/408 (64.4608%), train_poison_data_count: 264
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch  10, Avg loss: 0.0330, Accuracy: 257/408 (62.9902%), train_poison_data_count: 264
Global model norm: 253.74135607198525.
Norm before scaling: 253.72722342360112. Distance: 0.5343250864821946
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.7608, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: 0.3650, Accuracy: 9642/9950 (96.9045%)
Scaling by  100
Scaled Norm after poisoning: 257.8641236193977, distance: 53.43250844742716
Total norm for 5 adversaries is: 257.8641236193977. distance: 53.43250844742716
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   1, Avg loss: 0.0675, Accuracy: 166/774 (21.4470%)
_Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   2, Avg loss: 0.0375, Accuracy: 304/774 (39.2765%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.6146, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0774, Accuracy: 108/682 (15.8358%)
_Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0403, Accuracy: 260/682 (38.1232%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.5807, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0651, Accuracy: 227/1446 (15.6985%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0362, Accuracy: 499/1446 (34.5090%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.5274, Accuracy: 72/10000 (0.7200%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.1192, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0672, Accuracy: 67/338 (19.8225%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.4540, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   1, Avg loss: 0.0863, Accuracy: 8/416 (1.9231%)
_Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   2, Avg loss: 0.0486, Accuracy: 185/416 (44.4712%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.4585, Accuracy: 73/10000 (0.7300%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   1, Avg loss: 0.0571, Accuracy: 460/2227 (20.6556%)
_Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   2, Avg loss: 0.0291, Accuracy: 956/2227 (42.9277%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.1599, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   1, Avg loss: 0.0685, Accuracy: 242/803 (30.1370%)
_Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   2, Avg loss: 0.0373, Accuracy: 429/803 (53.4247%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.9938, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0848, Accuracy: 141/776 (18.1701%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0346, Accuracy: 429/776 (55.2835%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.2784, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0494, Accuracy: 326/1036 (31.4672%)
_Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0257, Accuracy: 621/1036 (59.9421%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 12.4401, Accuracy: 72/10000 (0.7200%)
time spent on training: 351.9136207103729
[rfa agg] training data poison_ratio: 0.46743768246126205  data num: [408, 774, 682, 1446, 338, 416, 2227, 803, 776, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.2921485515382888
[rfa agg] init. name: [36, 81, 80, 26, 12, 78, 60, 58, 75, 19], weight: tensor([0.0458, 0.0869, 0.0766, 0.1624, 0.0380, 0.0467, 0.2501, 0.0902, 0.0871,
        0.1163])
[rfa agg] iter:  0, prev_obj_val: 2815.414306640625, obj_val: 1578.2457275390625, abs dis: 1237.1685791015625
[rfa agg] iter: 0, weight: tensor([0.0023, 0.0869, 0.0757, 0.1721, 0.0364, 0.0451, 0.2855, 0.0901, 0.0871,
        0.1190])
[rfa agg] iter:  1, prev_obj_val: 1578.2457275390625, obj_val: 1563.4415283203125, abs dis: 14.80419921875
[rfa agg] iter: 1, weight: tensor([1.2039e-04, 6.1546e-02, 4.7438e-02, 3.5968e-01, 1.7516e-02, 2.2781e-02,
        2.4902e-01, 6.4149e-02, 6.1716e-02, 1.1603e-01])
[rfa agg] iter:  2, prev_obj_val: 1563.4415283203125, obj_val: 1562.3013916015625, abs dis: 1.14013671875
[rfa agg] iter: 2, weight: tensor([8.8284e-05, 8.1697e-02, 5.7926e-02, 3.2262e-01, 1.8457e-02, 2.4550e-02,
        1.1431e-01, 8.6495e-02, 8.2234e-02, 2.1162e-01])
[rfa agg] iter:  3, prev_obj_val: 1562.3013916015625, obj_val: 1563.7042236328125, abs dis: 1.40283203125
[rfa agg] iter: 3, weight: tensor([7.7096e-05, 9.6071e-02, 6.4562e-02, 1.8638e-01, 1.8732e-02, 2.5253e-02,
        8.8004e-02, 1.0385e-01, 9.7586e-02, 3.1948e-01])
[rfa agg] iter:  4, prev_obj_val: 1563.7042236328125, obj_val: 1566.396240234375, abs dis: 2.6920166015625
[rfa agg] iter: 4, weight: tensor([6.5220e-05, 1.3326e-01, 8.1713e-02, 1.0740e-01, 1.9740e-02, 2.7276e-02,
        6.5188e-02, 1.5643e-01, 1.3879e-01, 2.7014e-01])
[rfa agg] iter:  5, prev_obj_val: 1566.396240234375, obj_val: 1569.228271484375, abs dis: 2.83203125
[rfa agg] iter: 5, weight: tensor([5.6150e-05, 1.6584e-01, 9.9026e-02, 7.7608e-02, 1.9931e-02, 2.8154e-02,
        5.2223e-02, 2.2851e-01, 1.7899e-01, 1.4966e-01])
[rfa agg] iter:  6, prev_obj_val: 1569.228271484375, obj_val: 1571.24658203125, abs dis: 2.018310546875
[rfa agg] iter: 6, weight: tensor([4.8907e-05, 1.7057e-01, 1.1594e-01, 6.1115e-02, 1.9604e-02, 2.8241e-02,
        4.3481e-02, 2.7320e-01, 1.8695e-01, 1.0085e-01])
[rfa agg] iter:  7, prev_obj_val: 1571.24658203125, obj_val: 1571.24365234375, abs dis: 0.0029296875
[rfa agg] iter: 7, weight: tensor([4.8992e-05, 1.6740e-01, 1.3745e-01, 5.8396e-02, 2.0974e-02, 3.0569e-02,
        4.2609e-02, 2.6967e-01, 1.8199e-01, 9.0887e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.0112, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 4.1917, Accuracy: 0/9950 (0.0000%)
saving model
Done in 776.4614634513855 sec.
Server Epoch:48 choose agents : [27, 96, 18, 95, 5, 47, 12, 39, 36, 82].
_Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0592, Accuracy: 371/1587 (23.3774%)
_Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0353, Accuracy: 561/1587 (35.3497%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.3551, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0991, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0685, Accuracy: 79/311 (25.4019%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.8372, Accuracy: 50/10000 (0.5000%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   1, Avg loss: 0.0935, Accuracy: 24/530 (4.5283%)
_Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   2, Avg loss: 0.0392, Accuracy: 274/530 (51.6981%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 12.9296, Accuracy: 59/10000 (0.5900%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0876, Accuracy: 120/599 (20.0334%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0337, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 16.9660, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   1, Avg loss: 0.0608, Accuracy: 313/1628 (19.2260%)
_Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   2, Avg loss: 0.0265, Accuracy: 769/1628 (47.2359%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.7533, Accuracy: 148/10000 (1.4800%)
_Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   1, Avg loss: 0.1275, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   2, Avg loss: 0.1133, Accuracy: 3/134 (2.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 15.1508, Accuracy: 40/10000 (0.4000%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   1, Avg loss: 0.1165, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   2, Avg loss: 0.0667, Accuracy: 83/338 (24.5562%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.6820, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0625, Accuracy: 212/1013 (20.9279%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0279, Accuracy: 476/1013 (46.9891%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.2020, Accuracy: 75/10000 (0.7500%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   1, Avg loss: 0.0971, Accuracy: 15/408 (3.6765%)
_Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   2, Avg loss: 0.0621, Accuracy: 146/408 (35.7843%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.0922, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0795, Accuracy: 25/500 (5.0000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 200/500 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.5639, Accuracy: 60/10000 (0.6000%)
time spent on training: 245.60439085960388
[rfa agg] training data poison_ratio: 0.4970204313280363  data num: [1587, 311, 530, 599, 1628, 134, 338, 1013, 408, 500]
[rfa agg] considering poison per batch poison_fraction: 0.3106377695800227
[rfa agg] init. name: [27, 96, 18, 95, 5, 47, 12, 39, 36, 82], weight: tensor([0.2252, 0.0441, 0.0752, 0.0850, 0.2310, 0.0190, 0.0480, 0.1437, 0.0579,
        0.0709])
[rfa agg] iter:  0, prev_obj_val: 74.28190612792969, obj_val: 77.235595703125, abs dis: 2.9536895751953125
[rfa agg] iter: 0, weight: tensor([0.1361, 0.0261, 0.0739, 0.0989, 0.1271, 0.0091, 0.0316, 0.3935, 0.0432,
        0.0606])
[rfa agg] iter:  1, prev_obj_val: 77.235595703125, obj_val: 80.12081146240234, abs dis: 2.8852157592773438
[rfa agg] iter: 1, weight: tensor([0.1182, 0.0330, 0.1088, 0.1543, 0.1120, 0.0110, 0.0411, 0.2784, 0.0581,
        0.0851])
[rfa agg] iter:  2, prev_obj_val: 80.12081146240234, obj_val: 83.77600860595703, abs dis: 3.6551971435546875
[rfa agg] iter: 2, weight: tensor([0.0960, 0.0362, 0.1450, 0.2225, 0.0917, 0.0115, 0.0466, 0.1748, 0.0689,
        0.1068])
[rfa agg] iter:  3, prev_obj_val: 83.77600860595703, obj_val: 83.70169830322266, abs dis: 0.074310302734375
[rfa agg] iter: 3, weight: tensor([0.0686, 0.0359, 0.1881, 0.2693, 0.0660, 0.0106, 0.0483, 0.1056, 0.0768,
        0.1308])
[rfa agg] iter:  4, prev_obj_val: 83.70169830322266, obj_val: 83.70113372802734, abs dis: 0.0005645751953125
[rfa agg] iter: 4, weight: tensor([0.0663, 0.0351, 0.1919, 0.2785, 0.0638, 0.0104, 0.0474, 0.1011, 0.0757,
        0.1299])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.9688, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 4.5865, Accuracy: 0/9950 (0.0000%)
saving model
Done in 670.5567820072174 sec.
Server Epoch:49 choose agents : [37, 21, 63, 60, 36, 6, 17, 29, 9, 90].
poison local model 37 index 14 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   1, Avg loss: 0.0477, Accuracy: 566/1129 (50.1329%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   2, Avg loss: 0.0250, Accuracy: 641/1129 (56.7759%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   3, Avg loss: 0.0229, Accuracy: 711/1129 (62.9761%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   4, Avg loss: 0.0214, Accuracy: 702/1129 (62.1789%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   5, Avg loss: 0.0210, Accuracy: 679/1129 (60.1417%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   6, Avg loss: 0.0205, Accuracy: 715/1129 (63.3304%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   7, Avg loss: 0.0211, Accuracy: 692/1129 (61.2932%), train_poison_data_count: 720
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   8, Avg loss: 0.0198, Accuracy: 700/1129 (62.0018%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   9, Avg loss: 0.0200, Accuracy: 715/1129 (63.3304%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch  10, Avg loss: 0.0204, Accuracy: 694/1129 (61.4703%), train_poison_data_count: 720
Global model norm: 258.1379990673593.
Norm before scaling: 258.0891470257903. Distance: 0.9243418130340085
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.6028, Accuracy: 57/10000 (0.5700%)
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: 0.4289, Accuracy: 9381/9950 (94.2814%)
Scaling by  100
Scaled Norm after poisoning: 269.39045779314455, distance: 92.43418266528893
Total norm for 4 adversaries is: 269.39045779314455. distance: 92.43418266528893
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0577, Accuracy: 354/1949 (18.1632%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0348, Accuracy: 616/1949 (31.6060%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.8629, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   1, Avg loss: 0.0678, Accuracy: 158/888 (17.7928%)
_Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   2, Avg loss: 0.0276, Accuracy: 428/888 (48.1982%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 11.8041, Accuracy: 66/10000 (0.6600%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   1, Avg loss: 0.0565, Accuracy: 466/2227 (20.9250%)
_Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   2, Avg loss: 0.0296, Accuracy: 945/2227 (42.4338%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.9779, Accuracy: 112/10000 (1.1200%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   1, Avg loss: 0.0970, Accuracy: 13/408 (3.1863%)
_Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   2, Avg loss: 0.0620, Accuracy: 144/408 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.9600, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   1, Avg loss: 0.0602, Accuracy: 350/1956 (17.8937%)
_Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   2, Avg loss: 0.0339, Accuracy: 610/1956 (31.1861%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.7926, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0580, Accuracy: 277/1574 (17.5985%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0304, Accuracy: 567/1574 (36.0229%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.1189, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   1, Avg loss: 0.0562, Accuracy: 296/1440 (20.5556%)
_Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   2, Avg loss: 0.0301, Accuracy: 620/1440 (43.0556%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.2314, Accuracy: 86/10000 (0.8600%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   1, Avg loss: 0.0546, Accuracy: 303/1275 (23.7647%)
_Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   2, Avg loss: 0.0209, Accuracy: 640/1275 (50.1961%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 13.0304, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   1, Avg loss: 0.0541, Accuracy: 244/677 (36.0414%)
_Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 459/677 (67.7991%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 12.8783, Accuracy: 58/10000 (0.5800%)
time spent on training: 365.10345697402954
[rfa agg] training data poison_ratio: 0.3726244176588035  data num: [1129, 1949, 888, 2227, 408, 1956, 1574, 1440, 1275, 677]
[rfa agg] considering poison per batch poison_fraction: 0.2328902610367522
[rfa agg] init. name: [37, 21, 63, 60, 36, 6, 17, 29, 9, 90], weight: tensor([0.0835, 0.1441, 0.0657, 0.1647, 0.0302, 0.1446, 0.1164, 0.1065, 0.0943,
        0.0501])
[rfa agg] iter:  0, prev_obj_val: 12341.841796875, obj_val: 7282.126953125, abs dis: 5059.71484375
[rfa agg] iter: 0, weight: tensor([0.0082, 0.1570, 0.0700, 0.1804, 0.0318, 0.1576, 0.1258, 0.1148, 0.1012,
        0.0531])
[rfa agg] iter:  1, prev_obj_val: 7282.126953125, obj_val: 6807.8974609375, abs dis: 474.2294921875
[rfa agg] iter: 1, weight: tensor([0.0007, 0.1674, 0.0609, 0.2036, 0.0258, 0.1681, 0.1241, 0.1106, 0.0941,
        0.0448])
[rfa agg] iter:  2, prev_obj_val: 6807.8974609375, obj_val: 6806.59228515625, abs dis: 1.30517578125
[rfa agg] iter: 2, weight: tensor([5.4336e-05, 2.4728e-01, 2.3133e-02, 1.8254e-01, 7.4697e-03, 2.8238e-01,
        1.1247e-01, 7.8584e-02, 5.1116e-02, 1.4966e-02])
[rfa agg] iter:  3, prev_obj_val: 6806.59228515625, obj_val: 6807.84033203125, abs dis: 1.248046875
[rfa agg] iter: 3, weight: tensor([5.8822e-05, 1.8152e-01, 3.1589e-02, 1.2266e-01, 9.4943e-03, 1.9162e-01,
        2.2467e-01, 1.3939e-01, 7.9293e-02, 1.9708e-02])
[rfa agg] iter:  4, prev_obj_val: 6807.84033203125, obj_val: 6810.71435546875, abs dis: 2.8740234375
[rfa agg] iter: 4, weight: tensor([5.4233e-05, 1.3200e-01, 3.2852e-02, 9.6631e-02, 9.4578e-03, 1.3728e-01,
        3.0411e-01, 1.7719e-01, 9.0375e-02, 2.0051e-02])
[rfa agg] iter:  5, prev_obj_val: 6810.71435546875, obj_val: 6812.0654296875, abs dis: 1.35107421875
[rfa agg] iter: 5, weight: tensor([5.1733e-05, 1.0321e-01, 3.5825e-02, 8.0452e-02, 9.8001e-03, 1.0651e-01,
        3.0017e-01, 2.3252e-01, 1.1016e-01, 2.1298e-02])
[rfa agg] iter:  6, prev_obj_val: 6812.0654296875, obj_val: 6812.05029296875, abs dis: 0.01513671875
[rfa agg] iter: 6, weight: tensor([5.1873e-05, 9.7245e-02, 3.7708e-02, 7.7345e-02, 1.0117e-02, 1.0032e-01,
        2.6778e-01, 2.6546e-01, 1.2178e-01, 2.2192e-02])
[rfa agg] iter:  7, prev_obj_val: 6812.05029296875, obj_val: 6815.3984375, abs dis: 3.34814453125
[rfa agg] iter: 7, weight: tensor([5.1618e-05, 9.6621e-02, 3.7520e-02, 7.6965e-02, 1.0068e-02, 9.9772e-02,
        2.5872e-01, 2.7642e-01, 1.2178e-01, 2.2080e-02])
[rfa agg] iter:  8, prev_obj_val: 6815.3984375, obj_val: 6815.37744140625, abs dis: 0.02099609375
[rfa agg] iter: 8, weight: tensor([5.4116e-05, 9.1317e-02, 4.3657e-02, 7.4674e-02, 1.1216e-02, 9.3796e-02,
        2.1113e-01, 2.9418e-01, 1.5487e-01, 2.5102e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.9031, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 4.9887, Accuracy: 0/9950 (0.0000%)
saving model
Done in 792.4848666191101 sec.
Server Epoch:50 choose agents : [74, 58, 95, 2, 46, 62, 37, 81, 28, 99].
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   1, Avg loss: 0.0503, Accuracy: 363/1552 (23.3892%)
_Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   2, Avg loss: 0.0221, Accuracy: 737/1552 (47.4871%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 12.3602, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   1, Avg loss: 0.0704, Accuracy: 216/803 (26.8991%)
_Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   2, Avg loss: 0.0380, Accuracy: 430/803 (53.5492%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.6206, Accuracy: 59/10000 (0.5900%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   1, Avg loss: 0.0832, Accuracy: 137/599 (22.8715%)
_Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   2, Avg loss: 0.0323, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 16.1028, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.0668, Accuracy: 143/605 (23.6364%)
_Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0403, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.9835, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0570, Accuracy: 428/1904 (22.4790%)
_Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0332, Accuracy: 692/1904 (36.3445%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.1753, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   1, Avg loss: 0.0950, Accuracy: 21/568 (3.6972%)
_Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   2, Avg loss: 0.0501, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.1909, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   1, Avg loss: 0.0558, Accuracy: 341/1129 (30.2037%)
_Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 720/1129 (63.7733%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.8549, Accuracy: 100/10000 (1.0000%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0685, Accuracy: 186/774 (24.0310%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0382, Accuracy: 308/774 (39.7933%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.9170, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   1, Avg loss: 0.0721, Accuracy: 273/1581 (17.2676%)
_Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   2, Avg loss: 0.0376, Accuracy: 479/1581 (30.2973%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.6959, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   1, Avg loss: 0.0839, Accuracy: 97/773 (12.5485%)
_Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   2, Avg loss: 0.0364, Accuracy: 384/773 (49.6766%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 11.6939, Accuracy: 68/10000 (0.6800%)
time spent on training: 283.9127097129822
[rfa agg] training data poison_ratio: 0.3940513219284603  data num: [1552, 803, 599, 605, 1904, 568, 1129, 774, 1581, 773]
[rfa agg] considering poison per batch poison_fraction: 0.2462820762052877
[rfa agg] init. name: [74, 58, 95, 2, 46, 62, 37, 81, 28, 99], weight: tensor([0.1509, 0.0781, 0.0582, 0.0588, 0.1851, 0.0552, 0.1097, 0.0752, 0.1537,
        0.0751])
[rfa agg] iter:  0, prev_obj_val: 68.83369445800781, obj_val: 72.10690307617188, abs dis: 3.2732086181640625
[rfa agg] iter: 0, weight: tensor([0.1125, 0.1103, 0.0497, 0.0502, 0.0870, 0.0419, 0.2329, 0.1018, 0.1136,
        0.1000])
[rfa agg] iter:  1, prev_obj_val: 72.10690307617188, obj_val: 73.12920379638672, abs dis: 1.0223007202148438
[rfa agg] iter: 1, weight: tensor([0.0818, 0.1617, 0.0601, 0.0609, 0.0678, 0.0491, 0.1601, 0.1417, 0.0828,
        0.1340])
[rfa agg] iter:  2, prev_obj_val: 73.12920379638672, obj_val: 77.6129379272461, abs dis: 4.483734130859375
[rfa agg] iter: 2, weight: tensor([0.0732, 0.1840, 0.0622, 0.0629, 0.0615, 0.0501, 0.1316, 0.1559, 0.0741,
        0.1446])
[rfa agg] iter:  3, prev_obj_val: 77.6129379272461, obj_val: 81.97174835205078, abs dis: 4.3588104248046875
[rfa agg] iter: 3, weight: tensor([0.0557, 0.2229, 0.0738, 0.0747, 0.0486, 0.0573, 0.0874, 0.1710, 0.0564,
        0.1522])
[rfa agg] iter:  4, prev_obj_val: 81.97174835205078, obj_val: 84.54826354980469, abs dis: 2.5765151977539062
[rfa agg] iter: 4, weight: tensor([0.0524, 0.2004, 0.0975, 0.0986, 0.0467, 0.0739, 0.0760, 0.1586, 0.0531,
        0.1428])
[rfa agg] iter:  5, prev_obj_val: 84.54826354980469, obj_val: 84.54224395751953, abs dis: 0.00601959228515625
[rfa agg] iter: 5, weight: tensor([0.0521, 0.1745, 0.1167, 0.1179, 0.0468, 0.0878, 0.0732, 0.1447, 0.0528,
        0.1335])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.8921, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.2640, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 710.4537320137024 sec.
Server Epoch:51 choose agents : [42, 17, 32, 59, 73, 33, 77, 93, 8, 90].
poison local model 42 index 15 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0497, Accuracy: 701/1372 (51.0933%), train_poison_data_count: 868
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0270, Accuracy: 826/1372 (60.2041%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   3, Avg loss: 0.0240, Accuracy: 856/1372 (62.3907%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   4, Avg loss: 0.0238, Accuracy: 861/1372 (62.7551%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   5, Avg loss: 0.0235, Accuracy: 855/1372 (62.3178%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   6, Avg loss: 0.0236, Accuracy: 859/1372 (62.6093%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   7, Avg loss: 0.0228, Accuracy: 864/1372 (62.9738%), train_poison_data_count: 868
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   8, Avg loss: 0.0229, Accuracy: 855/1372 (62.3178%), train_poison_data_count: 868
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   9, Avg loss: 0.0228, Accuracy: 857/1372 (62.4636%), train_poison_data_count: 868
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch  10, Avg loss: 0.0227, Accuracy: 858/1372 (62.5364%), train_poison_data_count: 868
Global model norm: 262.4474352132251.
Norm before scaling: 262.38433463623545. Distance: 1.0349789449604931
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.8696, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: 0.4156, Accuracy: 9700/9950 (97.4874%)
Scaling by  100
Scaled Norm after poisoning: 275.9896255975938, distance: 103.49789588742856
Total norm for 2 adversaries is: 275.9896255975938. distance: 103.49789588742856
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   1, Avg loss: 0.0562, Accuracy: 334/1574 (21.2198%)
_Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   2, Avg loss: 0.0297, Accuracy: 594/1574 (37.7382%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.2154, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   1, Avg loss: 0.0646, Accuracy: 127/735 (17.2789%)
_Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   2, Avg loss: 0.0236, Accuracy: 341/735 (46.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 12.1647, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0623, Accuracy: 221/1089 (20.2938%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 489/1089 (44.9036%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.6304, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   1, Avg loss: 0.0635, Accuracy: 177/938 (18.8699%)
_Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   2, Avg loss: 0.0338, Accuracy: 312/938 (33.2623%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.5246, Accuracy: 61/10000 (0.6100%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0944, Accuracy: 30/515 (5.8252%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0597, Accuracy: 117/515 (22.7184%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.0247, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   1, Avg loss: 0.0583, Accuracy: 282/1340 (21.0448%)
_Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   2, Avg loss: 0.0302, Accuracy: 542/1340 (40.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 10.4178, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0590, Accuracy: 307/1742 (17.6234%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0329, Accuracy: 660/1742 (37.8875%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.0310, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0640, Accuracy: 197/1513 (13.0205%)
_Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0388, Accuracy: 445/1513 (29.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.4275, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   1, Avg loss: 0.0550, Accuracy: 239/677 (35.3028%)
_Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   2, Avg loss: 0.0207, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 11.9981, Accuracy: 62/10000 (0.6200%)
time spent on training: 347.17924880981445
[rfa agg] training data poison_ratio: 0.16415832970856895  data num: [1372, 1574, 735, 1089, 938, 515, 1340, 1742, 1513, 677]
[rfa agg] considering poison per batch poison_fraction: 0.10259895606785559
[rfa agg] init. name: [42, 17, 32, 59, 73, 33, 77, 93, 8, 90], weight: tensor([0.1194, 0.1369, 0.0639, 0.0947, 0.0816, 0.0448, 0.1166, 0.1515, 0.1316,
        0.0589])
[rfa agg] iter:  0, prev_obj_val: 20724.744140625, obj_val: 13109.513671875, abs dis: 7615.23046875
[rfa agg] iter: 0, weight: tensor([0.0180, 0.1532, 0.0708, 0.1054, 0.0906, 0.0495, 0.1300, 0.1700, 0.1472,
        0.0652])
[rfa agg] iter:  1, prev_obj_val: 13109.513671875, obj_val: 11940.6572265625, abs dis: 1168.8564453125
[rfa agg] iter: 1, weight: tensor([0.0024, 0.1586, 0.0694, 0.1059, 0.0898, 0.0479, 0.1323, 0.1784, 0.1517,
        0.0636])
[rfa agg] iter:  2, prev_obj_val: 11940.6572265625, obj_val: 11823.7197265625, abs dis: 116.9375
[rfa agg] iter: 2, weight: tensor([0.0003, 0.1802, 0.0505, 0.0913, 0.0711, 0.0323, 0.1277, 0.2362, 0.1652,
        0.0451])
[rfa agg] iter:  3, prev_obj_val: 11823.7197265625, obj_val: 11825.474609375, abs dis: 1.7548828125
[rfa agg] iter: 3, weight: tensor([5.6412e-05, 2.2117e-01, 2.9642e-02, 7.4631e-02, 5.1186e-02, 1.6281e-02,
        1.7676e-01, 1.4469e-01, 2.6049e-01, 2.5091e-02])
[rfa agg] iter:  4, prev_obj_val: 11825.474609375, obj_val: 11828.6748046875, abs dis: 3.2001953125
[rfa agg] iter: 4, weight: tensor([6.2026e-05, 1.6842e-01, 3.9397e-02, 1.0130e-01, 7.2729e-02, 2.0701e-02,
        2.4486e-01, 1.1692e-01, 2.0275e-01, 3.2861e-02])
[rfa agg] iter:  5, prev_obj_val: 11828.6748046875, obj_val: 11831.5625, abs dis: 2.8876953125
[rfa agg] iter: 5, weight: tensor([6.7003e-05, 1.3993e-01, 5.0388e-02, 1.2863e-01, 1.0021e-01, 2.5324e-02,
        2.4841e-01, 1.0582e-01, 1.5987e-01, 4.1350e-02])
[rfa agg] iter:  6, prev_obj_val: 11831.5625, obj_val: 11831.5439453125, abs dis: 0.0185546875
[rfa agg] iter: 6, weight: tensor([7.0543e-05, 1.2737e-01, 6.0421e-02, 1.4720e-01, 1.2850e-01, 2.9240e-02,
        2.1601e-01, 1.0045e-01, 1.4185e-01, 4.8883e-02])
[rfa agg] iter:  7, prev_obj_val: 11831.5439453125, obj_val: 11833.171875, abs dis: 1.6279296875
[rfa agg] iter: 7, weight: tensor([7.0543e-05, 1.2720e-01, 6.0565e-02, 1.5091e-01, 1.2989e-01, 2.9284e-02,
        2.1118e-01, 1.0042e-01, 1.4153e-01, 4.8958e-02])
[rfa agg] iter:  8, prev_obj_val: 11833.171875, obj_val: 11831.5478515625, abs dis: 1.6240234375
[rfa agg] iter: 8, weight: tensor([7.1743e-05, 1.2132e-01, 6.6111e-02, 1.5537e-01, 1.4717e-01, 3.1272e-02,
        1.9449e-01, 9.7345e-02, 1.3385e-01, 5.3012e-02])
[rfa agg] iter:  9, prev_obj_val: 11831.5478515625, obj_val: 11833.1708984375, abs dis: 1.623046875
[rfa agg] iter: 9, weight: tensor([7.0587e-05, 1.2719e-01, 6.0687e-02, 1.5273e-01, 1.3085e-01, 2.9327e-02,
        2.0817e-01, 1.0046e-01, 1.4148e-01, 4.9033e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.8952, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.8532, Accuracy: 0/9950 (0.0000%)
saving model
Done in 786.1770362854004 sec.
Server Epoch:52 choose agents : [13, 59, 3, 73, 63, 7, 86, 32, 51, 89].
_Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0600, Accuracy: 290/1645 (17.6292%)
_Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0351, Accuracy: 534/1645 (32.4620%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.3965, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   1, Avg loss: 0.0603, Accuracy: 225/1089 (20.6612%)
_Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 481/1089 (44.1690%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 11.8251, Accuracy: 72/10000 (0.7200%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   1, Avg loss: 0.0752, Accuracy: 79/781 (10.1152%)
_Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   2, Avg loss: 0.0378, Accuracy: 254/781 (32.5224%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.1507, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   1, Avg loss: 0.0620, Accuracy: 185/938 (19.7228%)
_Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   2, Avg loss: 0.0338, Accuracy: 337/938 (35.9275%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.8109, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   1, Avg loss: 0.0663, Accuracy: 163/888 (18.3559%)
_Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   2, Avg loss: 0.0276, Accuracy: 400/888 (45.0450%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 11.5254, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0708, Accuracy: 247/891 (27.7217%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0309, Accuracy: 425/891 (47.6992%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.0018, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   1, Avg loss: 0.0659, Accuracy: 286/1003 (28.5145%)
_Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   2, Avg loss: 0.0387, Accuracy: 391/1003 (38.9831%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.0126, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0630, Accuracy: 123/735 (16.7347%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0235, Accuracy: 343/735 (46.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 13.5832, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   1, Avg loss: 0.0709, Accuracy: 222/1049 (21.1630%)
_Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   2, Avg loss: 0.0313, Accuracy: 482/1049 (45.9485%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.6420, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0672, Accuracy: 284/896 (31.6964%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0370, Accuracy: 451/896 (50.3348%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.1916, Accuracy: 53/10000 (0.5300%)
time spent on training: 279.92503786087036
[rfa agg] training data poison_ratio: 0.07876954109934443  data num: [1645, 1089, 781, 938, 888, 891, 1003, 735, 1049, 896]
[rfa agg] considering poison per batch poison_fraction: 0.04923096318709027
[rfa agg] init. name: [13, 59, 3, 73, 63, 7, 86, 32, 51, 89], weight: tensor([0.1659, 0.1098, 0.0788, 0.0946, 0.0896, 0.0899, 0.1012, 0.0741, 0.1058,
        0.0904])
[rfa agg] iter:  0, prev_obj_val: 42.0772819519043, obj_val: 51.38229751586914, abs dis: 9.305015563964844
[rfa agg] iter: 0, weight: tensor([0.0436, 0.0615, 0.1105, 0.1307, 0.1317, 0.1256, 0.1091, 0.0829, 0.0717,
        0.1327])
[rfa agg] iter:  1, prev_obj_val: 51.38229751586914, obj_val: 48.26753616333008, abs dis: 3.1147613525390625
[rfa agg] iter: 1, weight: tensor([0.0443, 0.0566, 0.1386, 0.0999, 0.1205, 0.1191, 0.0857, 0.1483, 0.0639,
        0.1232])
[rfa agg] iter:  2, prev_obj_val: 48.26753616333008, obj_val: 48.26661682128906, abs dis: 0.000919342041015625
[rfa agg] iter: 2, weight: tensor([0.0417, 0.0543, 0.1414, 0.1010, 0.1244, 0.1220, 0.0859, 0.1403, 0.0620,
        0.1269])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.9055, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.7068, Accuracy: 0/9950 (0.0000%)
saving model
Done in 718.2828965187073 sec.
Server Epoch:53 choose agents : [44, 63, 19, 5, 11, 69, 60, 51, 37, 90].
poison local model 44 index 16 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Avg loss: 0.0500, Accuracy: 908/1750 (51.8857%), train_poison_data_count: 1102
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Avg loss: 0.0294, Accuracy: 1064/1750 (60.8000%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   3, Avg loss: 0.0265, Accuracy: 1090/1750 (62.2857%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   4, Avg loss: 0.0254, Accuracy: 1078/1750 (61.6000%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   5, Avg loss: 0.0260, Accuracy: 1087/1750 (62.1143%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   6, Avg loss: 0.0256, Accuracy: 1086/1750 (62.0571%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   7, Avg loss: 0.0250, Accuracy: 1090/1750 (62.2857%), train_poison_data_count: 1102
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   8, Avg loss: 0.0244, Accuracy: 1087/1750 (62.1143%), train_poison_data_count: 1102
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   9, Avg loss: 0.0246, Accuracy: 1101/1750 (62.9143%), train_poison_data_count: 1102
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch  10, Avg loss: 0.0252, Accuracy: 1093/1750 (62.4571%), train_poison_data_count: 1102
Global model norm: 266.6815311612336.
Norm before scaling: 266.5962244200019. Distance: 1.1734044076695356
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0876, Accuracy: 53/10000 (0.5300%)
_Test Local_ResNet_18 poisoned: True, epoch: 53, Avg loss: 0.5178, Accuracy: 9507/9950 (95.5477%)
Scaling by  100
Scaled Norm after poisoning: 283.1994245447896, distance: 117.3404377029185
Total norm for 5 adversaries is: 283.1994245447896. distance: 117.3404377029185
_Test Local_ResNet_18 poisoned: True, epoch: 53, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   1, Avg loss: 0.0631, Accuracy: 190/888 (21.3964%)
_Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   2, Avg loss: 0.0267, Accuracy: 457/888 (51.4640%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 12.2938, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0520, Accuracy: 327/1036 (31.5637%)
_Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0252, Accuracy: 592/1036 (57.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 13.6723, Accuracy: 63/10000 (0.6300%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0622, Accuracy: 322/1628 (19.7789%)
_Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0269, Accuracy: 773/1628 (47.4816%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.4377, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   1, Avg loss: 0.0749, Accuracy: 206/712 (28.9326%)
_Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   2, Avg loss: 0.0316, Accuracy: 429/712 (60.2528%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 10.3969, Accuracy: 64/10000 (0.6400%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0520, Accuracy: 253/590 (42.8814%)
_Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0283, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 12.0243, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   1, Avg loss: 0.0553, Accuracy: 488/2227 (21.9129%)
_Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   2, Avg loss: 0.0297, Accuracy: 948/2227 (42.5685%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.9686, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   1, Avg loss: 0.0703, Accuracy: 249/1049 (23.7369%)
_Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   2, Avg loss: 0.0309, Accuracy: 474/1049 (45.1859%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.4509, Accuracy: 104/10000 (1.0400%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   1, Avg loss: 0.0540, Accuracy: 339/1129 (30.0266%)
_Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   2, Avg loss: 0.0254, Accuracy: 720/1129 (63.7733%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.2994, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   1, Avg loss: 0.0586, Accuracy: 233/677 (34.4165%)
_Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 459/677 (67.7991%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 11.8434, Accuracy: 64/10000 (0.6400%)
time spent on training: 439.21728706359863
[rfa agg] training data poison_ratio: 0.626732842717782  data num: [1750, 888, 1036, 1628, 712, 590, 2227, 1049, 1129, 677]
[rfa agg] considering poison per batch poison_fraction: 0.3917080266986137
[rfa agg] init. name: [44, 63, 19, 5, 11, 69, 60, 51, 37, 90], weight: tensor([0.1498, 0.0760, 0.0887, 0.1393, 0.0609, 0.0505, 0.1906, 0.0898, 0.0966,
        0.0579])
[rfa agg] iter:  0, prev_obj_val: 31928.326171875, obj_val: 21405.53515625, abs dis: 10522.791015625
[rfa agg] iter: 0, weight: tensor([0.0301, 0.0864, 0.1009, 0.1593, 0.0692, 0.0573, 0.2188, 0.1022, 0.1100,
        0.0658])
[rfa agg] iter:  1, prev_obj_val: 21405.53515625, obj_val: 19244.076171875, abs dis: 2161.458984375
[rfa agg] iter: 1, weight: tensor([0.0054, 0.0874, 0.1026, 0.1648, 0.0697, 0.0575, 0.2304, 0.1039, 0.1121,
        0.0661])
[rfa agg] iter:  2, prev_obj_val: 19244.076171875, obj_val: 18863.138671875, abs dis: 380.9375
[rfa agg] iter: 2, weight: tensor([0.0009, 0.0802, 0.0972, 0.1726, 0.0628, 0.0508, 0.2710, 0.0983, 0.1073,
        0.0590])
[rfa agg] iter:  3, prev_obj_val: 18863.138671875, obj_val: 18847.009765625, abs dis: 16.12890625
[rfa agg] iter: 3, weight: tensor([1.0609e-04, 4.0313e-02, 5.5838e-02, 1.9656e-01, 2.9202e-02, 2.2088e-02,
        5.0898e-01, 5.5677e-02, 6.4714e-02, 2.6522e-02])
[rfa agg] iter:  4, prev_obj_val: 18847.009765625, obj_val: 18843.662109375, abs dis: 3.34765625
[rfa agg] iter: 4, weight: tensor([9.3079e-05, 5.3644e-02, 8.1287e-02, 4.1206e-01, 3.7047e-02, 2.7056e-02,
        1.8076e-01, 7.8488e-02, 9.6471e-02, 3.3092e-02])
[rfa agg] iter:  5, prev_obj_val: 18843.662109375, obj_val: 18843.974609375, abs dis: 0.3125
[rfa agg] iter: 5, weight: tensor([8.9066e-05, 7.9929e-02, 1.4033e-01, 2.3803e-01, 5.1454e-02, 3.5716e-02,
        1.1468e-01, 1.2379e-01, 1.7121e-01, 4.4777e-02])
[rfa agg] iter:  6, prev_obj_val: 18843.974609375, obj_val: 18845.517578125, abs dis: 1.54296875
[rfa agg] iter: 6, weight: tensor([7.6154e-05, 9.0706e-02, 1.7719e-01, 1.4331e-01, 5.5068e-02, 3.6739e-02,
        8.5797e-02, 1.4195e-01, 2.2221e-01, 4.6953e-02])
[rfa agg] iter:  7, prev_obj_val: 18845.517578125, obj_val: 18850.62890625, abs dis: 5.111328125
[rfa agg] iter: 7, weight: tensor([6.5656e-05, 1.0145e-01, 2.0270e-01, 1.0136e-01, 5.7979e-02, 3.7187e-02,
        6.7613e-02, 1.4519e-01, 2.3800e-01, 4.8455e-02])
[rfa agg] iter:  8, prev_obj_val: 18850.62890625, obj_val: 18852.396484375, abs dis: 1.767578125
[rfa agg] iter: 8, weight: tensor([6.3648e-05, 1.5027e-01, 1.9955e-01, 7.9854e-02, 7.8053e-02, 4.6643e-02,
        5.8838e-02, 1.4077e-01, 1.8291e-01, 6.3050e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.8772, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.8457, Accuracy: 0/9950 (0.0000%)
saving model
Done in 874.4063856601715 sec.
Server Epoch:54 choose agents : [87, 90, 28, 63, 1, 47, 46, 66, 40, 91].
_Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   1, Avg loss: 0.0686, Accuracy: 209/1131 (18.4792%)
_Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   2, Avg loss: 0.0338, Accuracy: 405/1131 (35.8090%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.6292, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   1, Avg loss: 0.0583, Accuracy: 213/677 (31.4623%)
_Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   2, Avg loss: 0.0218, Accuracy: 468/677 (69.1285%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 12.1313, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0689, Accuracy: 285/1581 (18.0266%)
_Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0371, Accuracy: 536/1581 (33.9026%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5628, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   1, Avg loss: 0.0620, Accuracy: 178/888 (20.0450%)
_Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   2, Avg loss: 0.0267, Accuracy: 418/888 (47.0721%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 11.2522, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0571, Accuracy: 271/928 (29.2026%)
_Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0249, Accuracy: 576/928 (62.0690%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 11.5481, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1203, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1066, Accuracy: 5/134 (3.7313%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 12.7458, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0566, Accuracy: 408/1904 (21.4286%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0328, Accuracy: 680/1904 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1772, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0699, Accuracy: 181/1402 (12.9101%)
_Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0419, Accuracy: 336/1402 (23.9658%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.7973, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   1, Avg loss: 0.0595, Accuracy: 293/1573 (18.6268%)
_Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   2, Avg loss: 0.0357, Accuracy: 559/1573 (35.5372%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.2647, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   1, Avg loss: 0.0606, Accuracy: 263/1030 (25.5340%)
_Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   2, Avg loss: 0.0259, Accuracy: 594/1030 (57.6699%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 11.2542, Accuracy: 102/10000 (1.0200%)
time spent on training: 228.41882371902466
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 677, 1581, 888, 928, 134, 1904, 1402, 1573, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 90, 28, 63, 1, 47, 46, 66, 40, 91], weight: tensor([0.1006, 0.0602, 0.1406, 0.0789, 0.0825, 0.0119, 0.1693, 0.1246, 0.1398,
        0.0916])
[rfa agg] iter:  0, prev_obj_val: 55.93168258666992, obj_val: 60.51316452026367, abs dis: 4.58148193359375
[rfa agg] iter: 0, weight: tensor([0.2022, 0.0347, 0.1162, 0.0676, 0.0777, 0.0035, 0.0787, 0.1886, 0.1172,
        0.1136])
[rfa agg] iter:  1, prev_obj_val: 60.51316452026367, obj_val: 62.179325103759766, abs dis: 1.6661605834960938
[rfa agg] iter: 1, weight: tensor([0.2601, 0.0425, 0.0855, 0.0933, 0.1033, 0.0037, 0.0637, 0.1226, 0.0858,
        0.1396])
[rfa agg] iter:  2, prev_obj_val: 62.179325103759766, obj_val: 60.44088363647461, abs dis: 1.7384414672851562
[rfa agg] iter: 2, weight: tensor([0.2506, 0.0457, 0.0806, 0.1048, 0.1141, 0.0038, 0.0615, 0.1111, 0.0807,
        0.1471])
[rfa agg] iter:  3, prev_obj_val: 60.44088363647461, obj_val: 62.17919921875, abs dis: 1.7383155822753906
[rfa agg] iter: 3, weight: tensor([0.2691, 0.0416, 0.0833, 0.0922, 0.1033, 0.0036, 0.0624, 0.1180, 0.0835,
        0.1431])
[rfa agg] iter:  4, prev_obj_val: 62.17919921875, obj_val: 60.44063949584961, abs dis: 1.7385597229003906
[rfa agg] iter: 4, weight: tensor([0.2520, 0.0456, 0.0804, 0.1045, 0.1137, 0.0038, 0.0614, 0.1107, 0.0805,
        0.1474])
[rfa agg] iter:  5, prev_obj_val: 60.44063949584961, obj_val: 62.17926025390625, abs dis: 1.7386207580566406
[rfa agg] iter: 5, weight: tensor([0.2694, 0.0416, 0.0832, 0.0921, 0.1032, 0.0036, 0.0623, 0.1179, 0.0834,
        0.1431])
[rfa agg] iter:  6, prev_obj_val: 62.17926025390625, obj_val: 60.44062423706055, abs dis: 1.7386360168457031
[rfa agg] iter: 6, weight: tensor([0.2521, 0.0456, 0.0804, 0.1045, 0.1137, 0.0038, 0.0614, 0.1107, 0.0805,
        0.1474])
[rfa agg] iter:  7, prev_obj_val: 60.44062423706055, obj_val: 62.17926788330078, abs dis: 1.7386436462402344
[rfa agg] iter: 7, weight: tensor([0.2695, 0.0416, 0.0832, 0.0921, 0.1032, 0.0036, 0.0623, 0.1179, 0.0834,
        0.1431])
[rfa agg] iter:  8, prev_obj_val: 62.17926788330078, obj_val: 60.44062042236328, abs dis: 1.7386474609375
[rfa agg] iter: 8, weight: tensor([0.2521, 0.0456, 0.0804, 0.1045, 0.1137, 0.0038, 0.0614, 0.1107, 0.0805,
        0.1474])
[rfa agg] iter:  9, prev_obj_val: 60.44062042236328, obj_val: 62.17926788330078, abs dis: 1.7386474609375
[rfa agg] iter: 9, weight: tensor([0.2695, 0.0416, 0.0832, 0.0921, 0.1032, 0.0036, 0.0623, 0.1179, 0.0834,
        0.1431])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.8526, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 6.0093, Accuracy: 0/9950 (0.0000%)
saving model
Done in 661.5065321922302 sec.
Server Epoch:55 choose agents : [48, 41, 73, 59, 13, 26, 32, 57, 99, 55].
poison local model 48 index 17 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   1, Avg loss: 0.0597, Accuracy: 228/631 (36.1331%), train_poison_data_count: 400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   3, Avg loss: 0.0332, Accuracy: 396/631 (62.7575%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   4, Avg loss: 0.0319, Accuracy: 389/631 (61.6482%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   5, Avg loss: 0.0309, Accuracy: 389/631 (61.6482%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   6, Avg loss: 0.0288, Accuracy: 377/631 (59.7464%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   7, Avg loss: 0.0292, Accuracy: 384/631 (60.8558%), train_poison_data_count: 400
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   8, Avg loss: 0.0276, Accuracy: 398/631 (63.0745%), train_poison_data_count: 400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   9, Avg loss: 0.0282, Accuracy: 387/631 (61.3312%), train_poison_data_count: 400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch  10, Avg loss: 0.0284, Accuracy: 392/631 (62.1236%), train_poison_data_count: 400
Global model norm: 270.86536669533814.
Norm before scaling: 270.84093579073306. Distance: 0.67076164972267
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7685, Accuracy: 55/10000 (0.5500%)
_Test Local_ResNet_18 poisoned: True, epoch: 55, Avg loss: 0.4835, Accuracy: 9513/9950 (95.6080%)
Scaling by  100
Scaled Norm after poisoning: 276.5828594201022, distance: 67.07616138227687
Total norm for 2 adversaries is: 276.5828594201022. distance: 67.07616138227687
_Test Local_ResNet_18 poisoned: True, epoch: 55, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   1, Avg loss: 0.0753, Accuracy: 188/719 (26.1474%)
_Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   2, Avg loss: 0.0365, Accuracy: 469/719 (65.2295%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.0023, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0607, Accuracy: 217/938 (23.1343%)
_Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 325/938 (34.6482%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.5143, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   1, Avg loss: 0.0628, Accuracy: 242/1089 (22.2222%)
_Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   2, Avg loss: 0.0294, Accuracy: 492/1089 (45.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 12.1911, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0574, Accuracy: 335/1645 (20.3647%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0358, Accuracy: 550/1645 (33.4347%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.1977, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0664, Accuracy: 252/1446 (17.4274%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0378, Accuracy: 515/1446 (35.6155%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.6261, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   1, Avg loss: 0.0637, Accuracy: 140/735 (19.0476%)
_Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   2, Avg loss: 0.0242, Accuracy: 353/735 (48.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 14.0805, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   1, Avg loss: 0.0641, Accuracy: 231/1154 (20.0173%)
_Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   2, Avg loss: 0.0301, Accuracy: 463/1154 (40.1213%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 15.1396, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0866, Accuracy: 108/773 (13.9715%)
_Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0349, Accuracy: 372/773 (48.1242%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.4973, Accuracy: 64/10000 (0.6400%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0627, Accuracy: 215/1071 (20.0747%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0327, Accuracy: 470/1071 (43.8842%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.9883, Accuracy: 72/10000 (0.7200%)
time spent on training: 326.47087717056274
[rfa agg] training data poison_ratio: 0.16684638760905793  data num: [631, 719, 938, 1089, 1645, 1446, 735, 1154, 773, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.1042789922556612
[rfa agg] init. name: [48, 41, 73, 59, 13, 26, 32, 57, 99, 55], weight: tensor([0.0619, 0.0705, 0.0920, 0.1068, 0.1613, 0.1418, 0.0721, 0.1131, 0.0758,
        0.1050])
[rfa agg] iter:  0, prev_obj_val: 5266.50537109375, obj_val: 2974.8916015625, abs dis: 2291.61376953125
[rfa agg] iter: 0, weight: tensor([0.0043, 0.0733, 0.0965, 0.1131, 0.1752, 0.1525, 0.0749, 0.1202, 0.0790,
        0.1109])
[rfa agg] iter:  1, prev_obj_val: 2974.8916015625, obj_val: 2864.857177734375, abs dis: 110.034423828125
[rfa agg] iter: 1, weight: tensor([2.4128e-04, 5.3422e-02, 7.8934e-02, 1.0390e-01, 2.5311e-01, 1.8196e-01,
        5.4621e-02, 1.1611e-01, 5.9658e-02, 9.8041e-02])
[rfa agg] iter:  2, prev_obj_val: 2864.857177734375, obj_val: 2866.68701171875, abs dis: 1.829833984375
[rfa agg] iter: 2, weight: tensor([6.4117e-05, 4.9441e-02, 1.0485e-01, 1.3044e-01, 1.1481e-01, 1.5923e-01,
        5.1869e-02, 1.6938e-01, 6.0318e-02, 1.5958e-01])
[rfa agg] iter:  3, prev_obj_val: 2866.68701171875, obj_val: 2869.168212890625, abs dis: 2.481201171875
[rfa agg] iter: 3, weight: tensor([5.8993e-05, 6.5277e-02, 1.6457e-01, 1.1894e-01, 7.8892e-02, 9.9185e-02,
        7.0311e-02, 1.3245e-01, 8.1901e-02, 1.8841e-01])
[rfa agg] iter:  4, prev_obj_val: 2869.168212890625, obj_val: 2872.73046875, abs dis: 3.562255859375
[rfa agg] iter: 4, weight: tensor([5.7581e-05, 7.6856e-02, 2.0421e-01, 1.0488e-01, 7.0121e-02, 8.4857e-02,
        8.4393e-02, 1.0909e-01, 9.7155e-02, 1.6838e-01])
[rfa agg] iter:  5, prev_obj_val: 2872.73046875, obj_val: 2872.705810546875, abs dis: 0.024658203125
[rfa agg] iter: 5, weight: tensor([5.7480e-05, 9.4271e-02, 2.1689e-01, 9.2763e-02, 6.4320e-02, 7.5576e-02,
        1.0715e-01, 9.3569e-02, 1.1725e-01, 1.3816e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.8306, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.4408, Accuracy: 0/9950 (0.0000%)
saving model
Done in 756.426766872406 sec.
Server Epoch:56 choose agents : [70, 37, 13, 11, 65, 80, 49, 18, 26, 82].
_Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   1, Avg loss: 0.0632, Accuracy: 291/1418 (20.5219%)
_Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   2, Avg loss: 0.0346, Accuracy: 611/1418 (43.0889%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.2947, Accuracy: 83/10000 (0.8300%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   1, Avg loss: 0.0531, Accuracy: 368/1129 (32.5952%)
_Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   2, Avg loss: 0.0249, Accuracy: 694/1129 (61.4703%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.0504, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0589, Accuracy: 309/1645 (18.7842%)
_Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0349, Accuracy: 601/1645 (36.5350%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.0846, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   1, Avg loss: 0.0669, Accuracy: 236/712 (33.1461%)
_Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   2, Avg loss: 0.0304, Accuracy: 452/712 (63.4831%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.0283, Accuracy: 70/10000 (0.7000%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0607, Accuracy: 289/1475 (19.5932%)
_Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0341, Accuracy: 586/1475 (39.7288%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1836, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   1, Avg loss: 0.0777, Accuracy: 93/682 (13.6364%)
_Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   2, Avg loss: 0.0407, Accuracy: 273/682 (40.0293%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.6465, Accuracy: 62/10000 (0.6200%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   1, Avg loss: 0.0918, Accuracy: 12/440 (2.7273%)
_Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   2, Avg loss: 0.0558, Accuracy: 114/440 (25.9091%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.7752, Accuracy: 67/10000 (0.6700%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   1, Avg loss: 0.1007, Accuracy: 23/530 (4.3396%)
_Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   2, Avg loss: 0.0428, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 11.0891, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0661, Accuracy: 239/1446 (16.5284%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0372, Accuracy: 479/1446 (33.1259%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.2560, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.0792, Accuracy: 26/500 (5.2000%)
_Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0495, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.6620, Accuracy: 43/10000 (0.4300%)
time spent on training: 253.50342106819153
[rfa agg] training data poison_ratio: 0.3582239150045104  data num: [1418, 1129, 1645, 712, 1475, 682, 440, 530, 1446, 500]
[rfa agg] considering poison per batch poison_fraction: 0.223889946877819
[rfa agg] init. name: [70, 37, 13, 11, 65, 80, 49, 18, 26, 82], weight: tensor([0.1421, 0.1132, 0.1649, 0.0714, 0.1478, 0.0684, 0.0441, 0.0531, 0.1449,
        0.0501])
[rfa agg] iter:  0, prev_obj_val: 65.11190032958984, obj_val: 64.96479797363281, abs dis: 0.14710235595703125
[rfa agg] iter: 0, weight: tensor([0.1311, 0.2301, 0.1080, 0.0919, 0.1186, 0.0762, 0.0292, 0.0439, 0.1341,
        0.0369])
[rfa agg] iter:  1, prev_obj_val: 64.96479797363281, obj_val: 66.5652847290039, abs dis: 1.6004867553710938
[rfa agg] iter: 1, weight: tensor([0.1274, 0.2515, 0.1045, 0.0900, 0.1152, 0.0742, 0.0283, 0.0426, 0.1304,
        0.0359])
[rfa agg] iter:  2, prev_obj_val: 66.5652847290039, obj_val: 68.24488830566406, abs dis: 1.6796035766601562
[rfa agg] iter: 2, weight: tensor([0.1226, 0.2381, 0.1023, 0.1012, 0.1118, 0.0827, 0.0306, 0.0464, 0.1254,
        0.0389])
[rfa agg] iter:  3, prev_obj_val: 68.24488830566406, obj_val: 68.2401123046875, abs dis: 0.0047760009765625
[rfa agg] iter: 3, weight: tensor([0.1183, 0.2179, 0.1002, 0.1149, 0.1086, 0.0930, 0.0330, 0.0508, 0.1209,
        0.0423])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.8481, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.7072, Accuracy: 0/9950 (0.0000%)
saving model
Done in 683.6002116203308 sec.
Server Epoch:57 choose agents : [49, 24, 21, 90, 19, 40, 84, 62, 37, 70].
poison local model 49 index 18 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   1, Avg loss: 0.0672, Accuracy: 131/440 (29.7727%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   2, Avg loss: 0.0467, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   3, Avg loss: 0.0451, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   4, Avg loss: 0.0420, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   5, Avg loss: 0.0398, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   6, Avg loss: 0.0361, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   7, Avg loss: 0.0344, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   8, Avg loss: 0.0324, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   9, Avg loss: 0.0327, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch  10, Avg loss: 0.0318, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Global model norm: 275.01303946358615.
Norm before scaling: 274.9975852166706. Distance: 0.5258426352684232
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2723, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 57, Avg loss: 0.4321, Accuracy: 9942/9950 (99.9196%)
Scaling by  100
Scaled Norm after poisoning: 278.42591867047867, distance: 52.58426552181508
Total norm for 4 adversaries is: 278.42591867047867. distance: 52.58426552181508
_Test Local_ResNet_18 poisoned: True, epoch: 57, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   1, Avg loss: 0.0821, Accuracy: 13/312 (4.1667%)
_Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   2, Avg loss: 0.0464, Accuracy: 146/312 (46.7949%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.0257, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   1, Avg loss: 0.0604, Accuracy: 334/1949 (17.1370%)
_Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   2, Avg loss: 0.0352, Accuracy: 599/1949 (30.7337%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.7704, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   1, Avg loss: 0.0608, Accuracy: 227/677 (33.5303%)
_Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   2, Avg loss: 0.0239, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.9076, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   1, Avg loss: 0.0485, Accuracy: 340/1036 (32.8185%)
_Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   2, Avg loss: 0.0254, Accuracy: 635/1036 (61.2934%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 12.3849, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0582, Accuracy: 321/1573 (20.4069%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0368, Accuracy: 530/1573 (33.6936%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.3955, Accuracy: 72/10000 (0.7200%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   1, Avg loss: 0.0633, Accuracy: 261/1190 (21.9328%)
_Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   2, Avg loss: 0.0315, Accuracy: 472/1190 (39.6639%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.3095, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   1, Avg loss: 0.0978, Accuracy: 16/568 (2.8169%)
_Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   2, Avg loss: 0.0498, Accuracy: 261/568 (45.9507%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.2098, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   1, Avg loss: 0.0493, Accuracy: 377/1129 (33.3924%)
_Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 703/1129 (62.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.5244, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0626, Accuracy: 295/1418 (20.8039%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0346, Accuracy: 574/1418 (40.4795%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.5893, Accuracy: 85/10000 (0.8500%)
time spent on training: 324.9794588088989
[rfa agg] training data poison_ratio: 0.29838709677419356  data num: [440, 312, 1949, 677, 1036, 1573, 1190, 568, 1129, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.18649193548387097
[rfa agg] init. name: [49, 24, 21, 90, 19, 40, 84, 62, 37, 70], weight: tensor([0.0428, 0.0303, 0.1894, 0.0658, 0.1007, 0.1528, 0.1156, 0.0552, 0.1097,
        0.1378])
[rfa agg] iter:  0, prev_obj_val: 2636.88134765625, obj_val: 1455.2545166015625, abs dis: 1181.6268310546875
[rfa agg] iter: 0, weight: tensor([0.0020, 0.0285, 0.2102, 0.0643, 0.1022, 0.1633, 0.1189, 0.0533, 0.1121,
        0.1452])
[rfa agg] iter:  1, prev_obj_val: 1455.2545166015625, obj_val: 1445.1981201171875, abs dis: 10.056396484375
[rfa agg] iter: 1, weight: tensor([7.5853e-05, 8.9799e-03, 1.9955e-01, 2.7452e-02, 6.8300e-02, 2.9564e-01,
        9.7350e-02, 2.0423e-02, 8.0192e-02, 2.0204e-01])
[rfa agg] iter:  2, prev_obj_val: 1445.1981201171875, obj_val: 1448.586669921875, abs dis: 3.3885498046875
[rfa agg] iter: 2, weight: tensor([6.3177e-05, 9.8608e-03, 9.7271e-02, 3.4234e-02, 1.1564e-01, 1.7652e-01,
        1.8239e-01, 2.4179e-02, 1.2665e-01, 2.3319e-01])
[rfa agg] iter:  3, prev_obj_val: 1448.586669921875, obj_val: 1451.5069580078125, abs dis: 2.9202880859375
[rfa agg] iter: 3, weight: tensor([5.9811e-05, 1.0965e-02, 7.4421e-02, 4.2538e-02, 1.8884e-01, 1.1033e-01,
        2.3893e-01, 2.8695e-02, 1.6653e-01, 1.3870e-01])
[rfa agg] iter:  4, prev_obj_val: 1451.5069580078125, obj_val: 1449.8160400390625, abs dis: 1.69091796875
[rfa agg] iter: 4, weight: tensor([5.9408e-05, 1.1701e-02, 6.8707e-02, 4.8129e-02, 2.3615e-01, 9.5889e-02,
        2.1994e-01, 3.1691e-02, 1.7323e-01, 1.1451e-01])
[rfa agg] iter:  5, prev_obj_val: 1449.8160400390625, obj_val: 1453.429931640625, abs dis: 3.6138916015625
[rfa agg] iter: 5, weight: tensor([5.7920e-05, 1.1011e-02, 6.9372e-02, 4.3952e-02, 2.2336e-01, 9.9009e-02,
        2.3246e-01, 2.9302e-02, 1.7162e-01, 1.1986e-01])
[rfa agg] iter:  6, prev_obj_val: 1453.429931640625, obj_val: 1451.4871826171875, abs dis: 1.9427490234375
[rfa agg] iter: 6, weight: tensor([6.0828e-05, 1.2440e-02, 6.7969e-02, 5.2896e-02, 2.5828e-01, 9.2683e-02,
        2.0097e-01, 3.4349e-02, 1.7164e-01, 1.0870e-01])
[rfa agg] iter:  7, prev_obj_val: 1451.4871826171875, obj_val: 1449.8206787109375, abs dis: 1.66650390625
[rfa agg] iter: 7, weight: tensor([5.8630e-05, 1.1561e-02, 6.7790e-02, 4.7600e-02, 2.5304e-01, 9.4479e-02,
        2.1083e-01, 3.1318e-02, 1.7094e-01, 1.1239e-01])
[rfa agg] iter:  8, prev_obj_val: 1449.8206787109375, obj_val: 1453.427978515625, abs dis: 3.6072998046875
[rfa agg] iter: 8, weight: tensor([5.7860e-05, 1.1001e-02, 6.9298e-02, 4.3913e-02, 2.2711e-01, 9.8913e-02,
        2.3010e-01, 2.9275e-02, 1.7065e-01, 1.1968e-01])
[rfa agg] iter:  9, prev_obj_val: 1453.427978515625, obj_val: 1453.41455078125, abs dis: 0.013427734375
[rfa agg] iter: 9, weight: tensor([6.0778e-05, 1.2430e-02, 6.7914e-02, 5.2857e-02, 2.5942e-01, 9.2613e-02,
        2.0050e-01, 3.4322e-02, 1.7127e-01, 1.0861e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.8903, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.8757, Accuracy: 0/9950 (0.0000%)
saving model
Done in 747.5819075107574 sec.
Server Epoch:58 choose agents : [95, 54, 5, 67, 47, 39, 11, 59, 83, 6].
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   1, Avg loss: 0.0811, Accuracy: 159/599 (26.5442%)
_Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   2, Avg loss: 0.0322, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 14.8720, Accuracy: 50/10000 (0.5000%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   1, Avg loss: 0.0609, Accuracy: 292/1130 (25.8407%)
_Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   2, Avg loss: 0.0306, Accuracy: 448/1130 (39.6460%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.7046, Accuracy: 55/10000 (0.5500%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   1, Avg loss: 0.0598, Accuracy: 323/1628 (19.8403%)
_Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   2, Avg loss: 0.0272, Accuracy: 763/1628 (46.8673%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.6520, Accuracy: 143/10000 (1.4300%)
_Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0808, Accuracy: 24/426 (5.6338%)
_Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0442, Accuracy: 167/426 (39.2019%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.4002, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1241, Accuracy: 4/134 (2.9851%)
_Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1044, Accuracy: 13/134 (9.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.9547, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   1, Avg loss: 0.0625, Accuracy: 216/1013 (21.3228%)
_Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   2, Avg loss: 0.0280, Accuracy: 494/1013 (48.7660%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 10.4357, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   1, Avg loss: 0.0658, Accuracy: 232/712 (32.5843%)
_Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   2, Avg loss: 0.0306, Accuracy: 448/712 (62.9213%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.7899, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   1, Avg loss: 0.0609, Accuracy: 230/1089 (21.1203%)
_Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   2, Avg loss: 0.0280, Accuracy: 522/1089 (47.9339%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.9817, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   1, Avg loss: 0.0629, Accuracy: 341/1953 (17.4603%)
_Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   2, Avg loss: 0.0364, Accuracy: 682/1953 (34.9206%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.1554, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   1, Avg loss: 0.0607, Accuracy: 359/1956 (18.3538%)
_Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   2, Avg loss: 0.0341, Accuracy: 583/1956 (29.8057%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.7569, Accuracy: 90/10000 (0.9000%)
time spent on training: 274.2963635921478
[rfa agg] training data poison_ratio: 0.31550751879699246  data num: [599, 1130, 1628, 426, 134, 1013, 712, 1089, 1953, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.1971921992481203
[rfa agg] init. name: [95, 54, 5, 67, 47, 39, 11, 59, 83, 6], weight: tensor([0.0563, 0.1062, 0.1530, 0.0400, 0.0126, 0.0952, 0.0669, 0.1023, 0.1836,
        0.1838])
[rfa agg] iter:  0, prev_obj_val: 75.10311889648438, obj_val: 77.2192153930664, abs dis: 2.1160964965820312
[rfa agg] iter: 0, weight: tensor([0.0375, 0.2168, 0.1605, 0.0207, 0.0048, 0.1438, 0.0547, 0.1403, 0.1103,
        0.1107])
[rfa agg] iter:  1, prev_obj_val: 77.2192153930664, obj_val: 78.26747131347656, abs dis: 1.0482559204101562
[rfa agg] iter: 1, weight: tensor([0.0387, 0.2674, 0.1174, 0.0206, 0.0046, 0.1772, 0.0582, 0.1429, 0.0864,
        0.0867])
[rfa agg] iter:  2, prev_obj_val: 78.26747131347656, obj_val: 81.09017944335938, abs dis: 2.8227081298828125
[rfa agg] iter: 2, weight: tensor([0.0391, 0.2803, 0.1053, 0.0205, 0.0046, 0.1933, 0.0596, 0.1382, 0.0795,
        0.0798])
[rfa agg] iter:  3, prev_obj_val: 81.09017944335938, obj_val: 82.79835510253906, abs dis: 1.7081756591796875
[rfa agg] iter: 3, weight: tensor([0.0432, 0.2538, 0.0925, 0.0219, 0.0047, 0.2402, 0.0676, 0.1310, 0.0725,
        0.0727])
[rfa agg] iter:  4, prev_obj_val: 82.79835510253906, obj_val: 82.78370666503906, abs dis: 0.0146484375
[rfa agg] iter: 4, weight: tensor([0.0460, 0.2239, 0.0876, 0.0229, 0.0049, 0.2761, 0.0733, 0.1256, 0.0698,
        0.0701])
[rfa agg] iter:  5, prev_obj_val: 82.78370666503906, obj_val: 82.7823486328125, abs dis: 0.0013580322265625
[rfa agg] iter: 5, weight: tensor([0.0456, 0.2161, 0.0867, 0.0228, 0.0048, 0.2888, 0.0729, 0.1237, 0.0692,
        0.0694])
[rfa agg] iter:  6, prev_obj_val: 82.7823486328125, obj_val: 82.78221130371094, abs dis: 0.0001373291015625
[rfa agg] iter: 6, weight: tensor([0.0454, 0.2138, 0.0864, 0.0227, 0.0048, 0.2930, 0.0727, 0.1231, 0.0689,
        0.0692])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.9301, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.8958, Accuracy: 0/9950 (0.0000%)
saving model
Done in 692.3393421173096 sec.
Server Epoch:59 choose agents : [54, 47, 10, 12, 0, 49, 14, 52, 51, 46].
poison local model 54 index 19 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   1, Avg loss: 0.0479, Accuracy: 554/1130 (49.0265%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   2, Avg loss: 0.0267, Accuracy: 661/1130 (58.4956%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   3, Avg loss: 0.0239, Accuracy: 701/1130 (62.0354%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   4, Avg loss: 0.0231, Accuracy: 699/1130 (61.8584%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   5, Avg loss: 0.0216, Accuracy: 685/1130 (60.6195%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   6, Avg loss: 0.0226, Accuracy: 702/1130 (62.1239%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   7, Avg loss: 0.0221, Accuracy: 712/1130 (63.0088%), train_poison_data_count: 720
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   8, Avg loss: 0.0216, Accuracy: 709/1130 (62.7434%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   9, Avg loss: 0.0218, Accuracy: 704/1130 (62.3009%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch  10, Avg loss: 0.0221, Accuracy: 701/1130 (62.0354%), train_poison_data_count: 720
Global model norm: 279.0614711627171.
Norm before scaling: 279.00851241494405. Distance: 0.9147164051739636
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.5411, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 59, Avg loss: 0.4959, Accuracy: 9300/9950 (93.4673%)
Scaling by  100
Scaled Norm after poisoning: 288.45031797087694, distance: 91.47164861310853
Total norm for 5 adversaries is: 288.45031797087694. distance: 91.47164861310853
_Test Local_ResNet_18 poisoned: True, epoch: 59, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   1, Avg loss: 0.1247, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   2, Avg loss: 0.1163, Accuracy: 5/134 (3.7313%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.6322, Accuracy: 53/10000 (0.5300%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   1, Avg loss: 0.0770, Accuracy: 149/861 (17.3055%)
_Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   2, Avg loss: 0.0243, Accuracy: 415/861 (48.1998%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.3723, Accuracy: 86/10000 (0.8600%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   1, Avg loss: 0.1157, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   2, Avg loss: 0.0665, Accuracy: 83/338 (24.5562%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.6971, Accuracy: 51/10000 (0.5100%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   1, Avg loss: 0.0638, Accuracy: 288/1657 (17.3808%)
_Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   2, Avg loss: 0.0379, Accuracy: 476/1657 (28.7266%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.6737, Accuracy: 69/10000 (0.6900%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   1, Avg loss: 0.0948, Accuracy: 5/440 (1.1364%)
_Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   2, Avg loss: 0.0560, Accuracy: 115/440 (26.1364%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.0549, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   1, Avg loss: 0.0813, Accuracy: 140/1013 (13.8203%)
_Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   2, Avg loss: 0.0392, Accuracy: 331/1013 (32.6752%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.9900, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0553, Accuracy: 265/636 (41.6667%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 426/636 (66.9811%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.2893, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   1, Avg loss: 0.0710, Accuracy: 211/1049 (20.1144%)
_Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   2, Avg loss: 0.0326, Accuracy: 443/1049 (42.2307%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.1011, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 403/1904 (21.1660%)
_Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   2, Avg loss: 0.0321, Accuracy: 691/1904 (36.2920%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1722, Accuracy: 113/10000 (1.1300%)
time spent on training: 336.28454756736755
[rfa agg] training data poison_ratio: 0.48308229644182493  data num: [1130, 134, 861, 338, 1657, 440, 1013, 636, 1049, 1904]
[rfa agg] considering poison per batch poison_fraction: 0.3019264352761406
[rfa agg] init. name: [54, 47, 10, 12, 0, 49, 14, 52, 51, 46], weight: tensor([0.1233, 0.0146, 0.0940, 0.0369, 0.1809, 0.0480, 0.1106, 0.0694, 0.1145,
        0.2078])
[rfa agg] iter:  0, prev_obj_val: 17475.62890625, obj_val: 11138.5576171875, abs dis: 6337.0712890625
[rfa agg] iter: 0, weight: tensor([0.0194, 0.0161, 0.1046, 0.0408, 0.2034, 0.0531, 0.1233, 0.0770, 0.1278,
        0.2346])
[rfa agg] iter:  1, prev_obj_val: 11138.5576171875, obj_val: 10132.1474609375, abs dis: 1006.41015625
[rfa agg] iter: 1, weight: tensor([0.0027, 0.0151, 0.1033, 0.0388, 0.2131, 0.0507, 0.1229, 0.0746, 0.1280,
        0.2508])
[rfa agg] iter:  2, prev_obj_val: 10132.1474609375, obj_val: 10038.40625, abs dis: 93.7412109375
[rfa agg] iter: 2, weight: tensor([3.1493e-04, 8.3544e-03, 7.5260e-02, 2.3015e-02, 2.4634e-01, 3.0839e-02,
        9.5219e-02, 4.8770e-02, 1.0210e-01, 3.6979e-01])
[rfa agg] iter:  3, prev_obj_val: 10038.40625, obj_val: 10038.4404296875, abs dis: 0.0341796875
[rfa agg] iter: 3, weight: tensor([1.0573e-04, 5.3029e-03, 7.3479e-02, 1.5984e-02, 3.7861e-01, 2.2117e-02,
        1.0724e-01, 3.8924e-02, 1.2234e-01, 2.3590e-01])
[rfa agg] iter:  4, prev_obj_val: 10038.4404296875, obj_val: 10039.2900390625, abs dis: 0.849609375
[rfa agg] iter: 4, weight: tensor([1.1176e-04, 6.1693e-03, 9.5955e-02, 1.8989e-02, 2.9519e-01, 2.6474e-02,
        1.4733e-01, 4.7916e-02, 1.7042e-01, 1.9144e-01])
[rfa agg] iter:  5, prev_obj_val: 10039.2900390625, obj_val: 10040.515625, abs dis: 1.2255859375
[rfa agg] iter: 5, weight: tensor([1.0470e-04, 6.4206e-03, 1.1819e-01, 2.0319e-02, 1.9916e-01, 2.8625e-02,
        1.9632e-01, 5.3873e-02, 2.2984e-01, 1.4715e-01])
[rfa agg] iter:  6, prev_obj_val: 10040.515625, obj_val: 10041.998046875, abs dis: 1.482421875
[rfa agg] iter: 6, weight: tensor([9.0149e-05, 6.0271e-03, 1.3190e-01, 1.9574e-02, 1.4057e-01, 2.7854e-02,
        2.3672e-01, 5.4510e-02, 2.7134e-01, 1.1142e-01])
[rfa agg] iter:  7, prev_obj_val: 10041.998046875, obj_val: 10043.064453125, abs dis: 1.06640625
[rfa agg] iter: 7, weight: tensor([8.0748e-05, 5.7376e-03, 1.4409e-01, 1.9013e-02, 1.1240e-01, 2.7272e-02,
        2.6567e-01, 5.5086e-02, 2.7837e-01, 9.2268e-02])
[rfa agg] iter:  8, prev_obj_val: 10043.064453125, obj_val: 10041.9833984375, abs dis: 1.0810546875
[rfa agg] iter: 8, weight: tensor([7.7817e-05, 5.7075e-03, 1.5468e-01, 1.9127e-02, 1.0283e-01, 2.7559e-02,
        2.8188e-01, 5.6664e-02, 2.6580e-01, 8.5680e-02])
[rfa agg] iter:  9, prev_obj_val: 10041.9833984375, obj_val: 10043.060546875, abs dis: 1.0771484375
[rfa agg] iter: 9, weight: tensor([7.9807e-05, 5.6758e-03, 1.4378e-01, 1.8808e-02, 1.1052e-01, 2.6978e-02,
        2.7487e-01, 5.4501e-02, 2.7375e-01, 9.1036e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.9200, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.7135, Accuracy: 0/9950 (0.0000%)
saving model
Done in 763.5742902755737 sec.
Server Epoch:60 choose agents : [54, 52, 10, 29, 40, 35, 50, 34, 99, 36].
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0588, Accuracy: 305/1130 (26.9912%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0304, Accuracy: 458/1130 (40.5310%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.5558, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0523, Accuracy: 271/636 (42.6101%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0290, Accuracy: 425/636 (66.8239%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.8275, Accuracy: 67/10000 (0.6700%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0762, Accuracy: 139/861 (16.1440%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0255, Accuracy: 390/861 (45.2962%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 11.2090, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   1, Avg loss: 0.0594, Accuracy: 332/1440 (23.0556%)
_Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   2, Avg loss: 0.0301, Accuracy: 647/1440 (44.9306%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.1910, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   1, Avg loss: 0.0595, Accuracy: 293/1573 (18.6268%)
_Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   2, Avg loss: 0.0356, Accuracy: 563/1573 (35.7915%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.2530, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   1, Avg loss: 0.1024, Accuracy: 4/271 (1.4760%)
_Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   2, Avg loss: 0.0722, Accuracy: 79/271 (29.1513%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.7501, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0641, Accuracy: 139/809 (17.1817%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0291, Accuracy: 333/809 (41.1619%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 11.7646, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   1, Avg loss: 0.0655, Accuracy: 299/1427 (20.9530%)
_Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   2, Avg loss: 0.0372, Accuracy: 548/1427 (38.4022%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.9707, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   1, Avg loss: 0.0813, Accuracy: 99/773 (12.8072%)
_Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   2, Avg loss: 0.0351, Accuracy: 364/773 (47.0893%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 11.2152, Accuracy: 62/10000 (0.6200%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   1, Avg loss: 0.1060, Accuracy: 5/408 (1.2255%)
_Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   2, Avg loss: 0.0631, Accuracy: 135/408 (33.0882%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.7361, Accuracy: 51/10000 (0.5100%)
time spent on training: 241.5987811088562
[rfa agg] training data poison_ratio: 0.2571826758147513  data num: [1130, 636, 861, 1440, 1573, 271, 809, 1427, 773, 408]
[rfa agg] considering poison per batch poison_fraction: 0.16073917238421956
[rfa agg] init. name: [54, 52, 10, 29, 40, 35, 50, 34, 99, 36], weight: tensor([0.1211, 0.0682, 0.0923, 0.1544, 0.1686, 0.0291, 0.0867, 0.1530, 0.0829,
        0.0437])
[rfa agg] iter:  0, prev_obj_val: 56.30905532836914, obj_val: 59.095462799072266, abs dis: 2.786407470703125
[rfa agg] iter: 0, weight: tensor([0.2335, 0.0513, 0.1409, 0.1135, 0.0992, 0.0126, 0.1125, 0.1140, 0.0992,
        0.0233])
[rfa agg] iter:  1, prev_obj_val: 59.095462799072266, obj_val: 59.03303527832031, abs dis: 0.062427520751953125
[rfa agg] iter: 1, weight: tensor([0.1689, 0.0610, 0.1897, 0.0901, 0.0811, 0.0137, 0.1538, 0.0900, 0.1256,
        0.0260])
[rfa agg] iter:  2, prev_obj_val: 59.03303527832031, obj_val: 60.30681228637695, abs dis: 1.2737770080566406
[rfa agg] iter: 2, weight: tensor([0.1630, 0.0605, 0.1969, 0.0887, 0.0800, 0.0135, 0.1562, 0.0886, 0.1269,
        0.0258])
[rfa agg] iter:  3, prev_obj_val: 60.30681228637695, obj_val: 63.54415512084961, abs dis: 3.2373428344726562
[rfa agg] iter: 3, weight: tensor([0.1418, 0.0638, 0.2079, 0.0817, 0.0742, 0.0137, 0.1736, 0.0815, 0.1353,
        0.0265])
[rfa agg] iter:  4, prev_obj_val: 63.54415512084961, obj_val: 63.52482604980469, abs dis: 0.019329071044921875
[rfa agg] iter: 4, weight: tensor([0.1117, 0.0738, 0.2023, 0.0711, 0.0656, 0.0146, 0.2111, 0.0709, 0.1500,
        0.0290])
[rfa agg] iter:  5, prev_obj_val: 63.52482604980469, obj_val: 65.5540771484375, abs dis: 2.0292510986328125
[rfa agg] iter: 5, weight: tensor([0.1099, 0.0734, 0.1980, 0.0703, 0.0649, 0.0145, 0.2185, 0.0700, 0.1518,
        0.0287])
[rfa agg] iter:  6, prev_obj_val: 65.5540771484375, obj_val: 61.797454833984375, abs dis: 3.756622314453125
[rfa agg] iter: 6, weight: tensor([0.1016, 0.0817, 0.1841, 0.0677, 0.0629, 0.0153, 0.2314, 0.0674, 0.1567,
        0.0311])
[rfa agg] iter:  7, prev_obj_val: 61.797454833984375, obj_val: 63.527198791503906, abs dis: 1.7297439575195312
[rfa agg] iter: 7, weight: tensor([0.1216, 0.0678, 0.2012, 0.0747, 0.0685, 0.0139, 0.2037, 0.0744, 0.1469,
        0.0273])
[rfa agg] iter:  8, prev_obj_val: 63.527198791503906, obj_val: 65.554443359375, abs dis: 2.0272445678710938
[rfa agg] iter: 8, weight: tensor([0.1104, 0.0734, 0.1986, 0.0705, 0.0651, 0.0145, 0.2171, 0.0703, 0.1514,
        0.0288])
[rfa agg] iter:  9, prev_obj_val: 65.554443359375, obj_val: 61.79732894897461, abs dis: 3.7571144104003906
[rfa agg] iter: 9, weight: tensor([0.1017, 0.0818, 0.1843, 0.0677, 0.0629, 0.0154, 0.2311, 0.0674, 0.1567,
        0.0311])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.8992, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.5572, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 666.7640635967255 sec.
Server Epoch:61 choose agents : [55, 8, 59, 31, 34, 81, 12, 79, 36, 85].
poison local model 55 index 20 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0528, Accuracy: 514/1071 (47.9925%), train_poison_data_count: 680
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 577/1071 (53.8749%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   3, Avg loss: 0.0242, Accuracy: 663/1071 (61.9048%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   4, Avg loss: 0.0232, Accuracy: 655/1071 (61.1578%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   5, Avg loss: 0.0237, Accuracy: 651/1071 (60.7843%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   6, Avg loss: 0.0234, Accuracy: 646/1071 (60.3175%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   7, Avg loss: 0.0224, Accuracy: 664/1071 (61.9981%), train_poison_data_count: 680
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   8, Avg loss: 0.0211, Accuracy: 672/1071 (62.7451%), train_poison_data_count: 680
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   9, Avg loss: 0.0217, Accuracy: 669/1071 (62.4650%), train_poison_data_count: 680
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch  10, Avg loss: 0.0220, Accuracy: 664/1071 (61.9981%), train_poison_data_count: 680
Global model norm: 283.058849888146.
Norm before scaling: 283.00862674572306. Distance: 0.9358381801376675
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.9317, Accuracy: 56/10000 (0.5600%)
_Test Local_ResNet_18 poisoned: True, epoch: 61, Avg loss: 0.3996, Accuracy: 9479/9950 (95.2663%)
Scaling by  100
Scaled Norm after poisoning: 293.1708519575232, distance: 93.58381625079467
Total norm for 5 adversaries is: 293.1708519575232. distance: 93.58381625079467
_Test Local_ResNet_18 poisoned: True, epoch: 61, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   1, Avg loss: 0.0651, Accuracy: 197/1513 (13.0205%)
_Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   2, Avg loss: 0.0388, Accuracy: 424/1513 (28.0238%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.4545, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   1, Avg loss: 0.0643, Accuracy: 275/1089 (25.2525%)
_Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 492/1089 (45.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 12.0632, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   1, Avg loss: 0.0818, Accuracy: 24/460 (5.2174%)
_Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   2, Avg loss: 0.0390, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.8272, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   1, Avg loss: 0.0643, Accuracy: 322/1427 (22.5648%)
_Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   2, Avg loss: 0.0375, Accuracy: 551/1427 (38.6125%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.9530, Accuracy: 85/10000 (0.8500%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   1, Avg loss: 0.0662, Accuracy: 178/774 (22.9974%)
_Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   2, Avg loss: 0.0413, Accuracy: 359/774 (46.3824%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.8688, Accuracy: 67/10000 (0.6700%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.1145, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0643, Accuracy: 87/338 (25.7396%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.5731, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1214, Accuracy: 2/197 (1.0152%)
_Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.1047, Accuracy: 20/197 (10.1523%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.4754, Accuracy: 54/10000 (0.5400%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   1, Avg loss: 0.1077, Accuracy: 3/408 (0.7353%)
_Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   2, Avg loss: 0.0654, Accuracy: 126/408 (30.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.9365, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   1, Avg loss: 0.0658, Accuracy: 358/1988 (18.0080%)
_Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   2, Avg loss: 0.0377, Accuracy: 566/1988 (28.4708%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.4587, Accuracy: 82/10000 (0.8200%)
time spent on training: 366.88694977760315
[rfa agg] training data poison_ratio: 0.494225580140313  data num: [1071, 1513, 1089, 460, 1427, 774, 338, 197, 408, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.3088909875876956
[rfa agg] init. name: [55, 8, 59, 31, 34, 81, 12, 79, 36, 85], weight: tensor([0.1156, 0.1633, 0.1175, 0.0496, 0.1540, 0.0835, 0.0365, 0.0213, 0.0440,
        0.2146])
[rfa agg] iter:  0, prev_obj_val: 15615.740234375, obj_val: 9800.841796875, abs dis: 5814.8984375
[rfa agg] iter: 0, weight: tensor([0.0168, 0.1821, 0.1303, 0.0545, 0.1716, 0.0921, 0.0399, 0.0232, 0.0483,
        0.2412])
[rfa agg] iter:  1, prev_obj_val: 9800.841796875, obj_val: 8954.787109375, abs dis: 846.0546875
[rfa agg] iter: 1, weight: tensor([0.0022, 0.1877, 0.1294, 0.0511, 0.1758, 0.0889, 0.0370, 0.0213, 0.0450,
        0.2617])
[rfa agg] iter:  2, prev_obj_val: 8954.787109375, obj_val: 8900.935546875, abs dis: 53.8515625
[rfa agg] iter: 2, weight: tensor([1.9775e-04, 1.7130e-01, 8.5098e-02, 2.4276e-02, 1.5110e-01, 4.9215e-02,
        1.6662e-02, 9.0891e-03, 2.0828e-02, 4.7224e-01])
[rfa agg] iter:  3, prev_obj_val: 8900.935546875, obj_val: 8898.3271484375, abs dis: 2.6083984375
[rfa agg] iter: 3, weight: tensor([9.4393e-05, 3.2531e-01, 8.9808e-02, 1.9435e-02, 2.6682e-01, 4.5169e-02,
        1.2782e-02, 6.7003e-03, 1.6302e-02, 2.1757e-01])
[rfa agg] iter:  4, prev_obj_val: 8898.3271484375, obj_val: 8899.798828125, abs dis: 1.4716796875
[rfa agg] iter: 4, weight: tensor([7.6689e-05, 3.3333e-01, 9.7699e-02, 1.8991e-02, 3.4733e-01, 4.7720e-02,
        1.2221e-02, 6.2869e-03, 1.5773e-02, 1.2057e-01])
[rfa agg] iter:  5, prev_obj_val: 8899.798828125, obj_val: 8899.7783203125, abs dis: 0.0205078125
[rfa agg] iter: 5, weight: tensor([8.2388e-05, 2.9370e-01, 1.1552e-01, 2.1843e-02, 3.5600e-01, 5.6790e-02,
        1.3930e-02, 7.1123e-03, 1.8069e-02, 1.1696e-01])
[rfa agg] iter:  6, prev_obj_val: 8899.7783203125, obj_val: 8900.87890625, abs dis: 1.1005859375
[rfa agg] iter: 6, weight: tensor([8.2505e-05, 2.8631e-01, 1.1744e-01, 2.1880e-02, 3.6104e-01, 5.6950e-02,
        1.3953e-02, 7.1235e-03, 1.8097e-02, 1.1713e-01])
[rfa agg] iter:  7, prev_obj_val: 8900.87890625, obj_val: 8902.1025390625, abs dis: 1.2236328125
[rfa agg] iter: 7, weight: tensor([8.7833e-05, 2.7395e-01, 1.3109e-01, 2.4143e-02, 3.4402e-01, 6.4023e-02,
        1.5321e-02, 7.7889e-03, 1.9920e-02, 1.1966e-01])
[rfa agg] iter:  8, prev_obj_val: 8902.1025390625, obj_val: 8903.4287109375, abs dis: 1.326171875
[rfa agg] iter: 8, weight: tensor([9.3379e-05, 2.6257e-01, 1.4745e-01, 2.6646e-02, 3.2152e-01, 7.2139e-02,
        1.6821e-02, 8.5132e-03, 2.1927e-02, 1.2232e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.8672, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.4651, Accuracy: 0/9950 (0.0000%)
saving model
Done in 791.2809138298035 sec.
Server Epoch:62 choose agents : [76, 81, 79, 10, 63, 90, 19, 80, 0, 17].
_Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   1, Avg loss: 0.0916, Accuracy: 12/466 (2.5751%)
_Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   2, Avg loss: 0.0518, Accuracy: 178/466 (38.1974%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.5464, Accuracy: 54/10000 (0.5400%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.0690, Accuracy: 171/774 (22.0930%)
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0401, Accuracy: 312/774 (40.3101%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.6380, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   1, Avg loss: 0.1206, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   2, Avg loss: 0.1035, Accuracy: 22/197 (11.1675%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.1975, Accuracy: 55/10000 (0.5500%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   1, Avg loss: 0.0734, Accuracy: 163/861 (18.9315%)
_Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   2, Avg loss: 0.0242, Accuracy: 395/861 (45.8769%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.9294, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0618, Accuracy: 195/888 (21.9595%)
_Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0268, Accuracy: 447/888 (50.3378%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 12.0872, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   1, Avg loss: 0.0633, Accuracy: 214/677 (31.6100%)
_Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   2, Avg loss: 0.0235, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 11.8189, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   1, Avg loss: 0.0484, Accuracy: 359/1036 (34.6525%)
_Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   2, Avg loss: 0.0274, Accuracy: 622/1036 (60.0386%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 12.5333, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0787, Accuracy: 70/682 (10.2639%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0405, Accuracy: 273/682 (40.0293%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.7589, Accuracy: 56/10000 (0.5600%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   1, Avg loss: 0.0643, Accuracy: 305/1657 (18.4068%)
_Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   2, Avg loss: 0.0377, Accuracy: 460/1657 (27.7610%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.5316, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   1, Avg loss: 0.0547, Accuracy: 291/1574 (18.4879%)
_Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   2, Avg loss: 0.0292, Accuracy: 587/1574 (37.2935%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.2771, Accuracy: 90/10000 (0.9000%)
time spent on training: 233.61580419540405
[rfa agg] training data poison_ratio: 0.37358147980027234  data num: [466, 774, 197, 861, 888, 677, 1036, 682, 1657, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.23348842487517021
[rfa agg] init. name: [76, 81, 79, 10, 63, 90, 19, 80, 0, 17], weight: tensor([0.0529, 0.0878, 0.0224, 0.0977, 0.1008, 0.0768, 0.1176, 0.0774, 0.1880,
        0.1786])
[rfa agg] iter:  0, prev_obj_val: 59.32124710083008, obj_val: 61.617820739746094, abs dis: 2.2965736389160156
[rfa agg] iter: 0, weight: tensor([0.0351, 0.1256, 0.0087, 0.2025, 0.1857, 0.0897, 0.1285, 0.0913, 0.0653,
        0.0675])
[rfa agg] iter:  1, prev_obj_val: 61.617820739746094, obj_val: 63.40026092529297, abs dis: 1.782440185546875
[rfa agg] iter: 1, weight: tensor([0.0396, 0.1343, 0.0092, 0.1933, 0.1791, 0.1106, 0.1032, 0.1132, 0.0580,
        0.0595])
[rfa agg] iter:  2, prev_obj_val: 63.40026092529297, obj_val: 70.47306823730469, abs dis: 7.072807312011719
[rfa agg] iter: 2, weight: tensor([0.0442, 0.1358, 0.0098, 0.1728, 0.1635, 0.1297, 0.0956, 0.1333, 0.0570,
        0.0583])
[rfa agg] iter:  3, prev_obj_val: 70.47306823730469, obj_val: 67.79167175292969, abs dis: 2.681396484375
[rfa agg] iter: 3, weight: tensor([0.0639, 0.1188, 0.0122, 0.1240, 0.1228, 0.1793, 0.0810, 0.1867, 0.0552,
        0.0561])
[rfa agg] iter:  4, prev_obj_val: 67.79167175292969, obj_val: 70.4143295288086, abs dis: 2.6226577758789062
[rfa agg] iter: 4, weight: tensor([0.0551, 0.1215, 0.0111, 0.1309, 0.1282, 0.1768, 0.0825, 0.1845, 0.0542,
        0.0552])
[rfa agg] iter:  5, prev_obj_val: 70.4143295288086, obj_val: 67.7939224243164, abs dis: 2.6204071044921875
[rfa agg] iter: 5, weight: tensor([0.0629, 0.1151, 0.0120, 0.1196, 0.1184, 0.1877, 0.0790, 0.1966, 0.0539,
        0.0548])
[rfa agg] iter:  6, prev_obj_val: 67.7939224243164, obj_val: 70.41378021240234, abs dis: 2.6198577880859375
[rfa agg] iter: 6, weight: tensor([0.0550, 0.1207, 0.0111, 0.1302, 0.1275, 0.1781, 0.0822, 0.1862, 0.0540,
        0.0550])
[rfa agg] iter:  7, prev_obj_val: 70.41378021240234, obj_val: 67.79402160644531, abs dis: 2.6197586059570312
[rfa agg] iter: 7, weight: tensor([0.0629, 0.1149, 0.0120, 0.1195, 0.1183, 0.1879, 0.0789, 0.1969, 0.0539,
        0.0548])
[rfa agg] iter:  8, prev_obj_val: 67.79402160644531, obj_val: 70.41375732421875, abs dis: 2.6197357177734375
[rfa agg] iter: 8, weight: tensor([0.0550, 0.1207, 0.0111, 0.1302, 0.1275, 0.1782, 0.0822, 0.1863, 0.0540,
        0.0550])
[rfa agg] iter:  9, prev_obj_val: 70.41375732421875, obj_val: 67.79402160644531, abs dis: 2.6197357177734375
[rfa agg] iter: 9, weight: tensor([0.0629, 0.1149, 0.0120, 0.1195, 0.1183, 0.1879, 0.0789, 0.1969, 0.0539,
        0.0548])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.8953, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.2288, Accuracy: 0/9950 (0.0000%)
saving model
Done in 653.417566537857 sec.
Server Epoch:63 choose agents : [60, 37, 76, 38, 57, 8, 82, 79, 19, 99].
poison local model 60 index 21 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   1, Avg loss: 0.0441, Accuracy: 1213/2227 (54.4679%), train_poison_data_count: 1400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   2, Avg loss: 0.0254, Accuracy: 1374/2227 (61.6974%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   3, Avg loss: 0.0231, Accuracy: 1371/2227 (61.5626%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   4, Avg loss: 0.0226, Accuracy: 1381/2227 (62.0117%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   5, Avg loss: 0.0223, Accuracy: 1387/2227 (62.2811%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   6, Avg loss: 0.0221, Accuracy: 1400/2227 (62.8648%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   7, Avg loss: 0.0217, Accuracy: 1385/2227 (62.1913%), train_poison_data_count: 1400
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   8, Avg loss: 0.0211, Accuracy: 1399/2227 (62.8199%), train_poison_data_count: 1400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   9, Avg loss: 0.0210, Accuracy: 1402/2227 (62.9546%), train_poison_data_count: 1400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch  10, Avg loss: 0.0212, Accuracy: 1405/2227 (63.0894%), train_poison_data_count: 1400
Global model norm: 287.0249608048053.
Norm before scaling: 286.9072013517611. Distance: 1.3432177443189393
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.9140, Accuracy: 62/10000 (0.6200%)
_Test Local_ResNet_18 poisoned: True, epoch: 63, Avg loss: 0.4315, Accuracy: 9437/9950 (94.8442%)
Scaling by  100
Scaled Norm after poisoning: 305.7561323996626, distance: 134.32178452088476
Total norm for 2 adversaries is: 305.7561323996626. distance: 134.32178452088476
_Test Local_ResNet_18 poisoned: True, epoch: 63, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0516, Accuracy: 349/1129 (30.9123%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0254, Accuracy: 704/1129 (62.3561%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.4105, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.0899, Accuracy: 12/466 (2.5751%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0533, Accuracy: 175/466 (37.5536%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.4544, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0709, Accuracy: 198/1131 (17.5066%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0338, Accuracy: 457/1131 (40.4067%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.2567, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0619, Accuracy: 237/1154 (20.5373%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0293, Accuracy: 454/1154 (39.3414%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 12.5060, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   1, Avg loss: 0.0653, Accuracy: 188/1513 (12.4256%)
_Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   2, Avg loss: 0.0386, Accuracy: 449/1513 (29.6761%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.4229, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   1, Avg loss: 0.0849, Accuracy: 28/500 (5.6000%)
_Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   2, Avg loss: 0.0531, Accuracy: 188/500 (37.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.5228, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   1, Avg loss: 0.1198, Accuracy: 2/197 (1.0152%)
_Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   2, Avg loss: 0.1008, Accuracy: 21/197 (10.6599%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.6108, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   1, Avg loss: 0.0461, Accuracy: 328/1036 (31.6602%)
_Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   2, Avg loss: 0.0276, Accuracy: 626/1036 (60.4247%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 14.2030, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.0845, Accuracy: 103/773 (13.3247%)
_Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0330, Accuracy: 374/773 (48.3829%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 11.7629, Accuracy: 61/10000 (0.6100%)
time spent on training: 334.7538058757782
[rfa agg] training data poison_ratio: 0.3314240568832708  data num: [2227, 1129, 466, 1131, 1154, 1513, 500, 197, 1036, 773]
[rfa agg] considering poison per batch poison_fraction: 0.20714003555204424
[rfa agg] init. name: [60, 37, 76, 38, 57, 8, 82, 79, 19, 99], weight: tensor([0.2199, 0.1115, 0.0460, 0.1117, 0.1140, 0.1494, 0.0494, 0.0195, 0.1023,
        0.0763])
[rfa agg] iter:  0, prev_obj_val: 53766.52734375, obj_val: 40916.4921875, abs dis: 12850.03515625
[rfa agg] iter: 0, weight: tensor([0.0736, 0.1324, 0.0545, 0.1327, 0.1354, 0.1778, 0.0585, 0.0230, 0.1215,
        0.0906])
[rfa agg] iter:  1, prev_obj_val: 40916.4921875, obj_val: 36377.08203125, abs dis: 4539.41015625
[rfa agg] iter: 1, weight: tensor([0.0219, 0.1399, 0.0573, 0.1401, 0.1431, 0.1884, 0.0615, 0.0241, 0.1283,
        0.0954])
[rfa agg] iter:  2, prev_obj_val: 36377.08203125, obj_val: 35003.9140625, abs dis: 1373.16796875
[rfa agg] iter: 2, weight: tensor([0.0062, 0.1424, 0.0572, 0.1426, 0.1459, 0.1938, 0.0614, 0.0239, 0.1303,
        0.0962])
[rfa agg] iter:  3, prev_obj_val: 35003.9140625, obj_val: 34610.5234375, abs dis: 393.390625
[rfa agg] iter: 3, weight: tensor([0.0017, 0.1436, 0.0541, 0.1438, 0.1482, 0.2040, 0.0581, 0.0221, 0.1305,
        0.0939])
[rfa agg] iter:  4, prev_obj_val: 34610.5234375, obj_val: 34509.1640625, abs dis: 101.359375
[rfa agg] iter: 4, weight: tensor([0.0004, 0.1430, 0.0432, 0.1434, 0.1514, 0.2464, 0.0463, 0.0164, 0.1268,
        0.0828])
[rfa agg] iter:  5, prev_obj_val: 34509.1640625, obj_val: 34503.55078125, abs dis: 5.61328125
[rfa agg] iter: 5, weight: tensor([8.4968e-05, 1.1896e-01, 1.9698e-02, 1.2264e-01, 1.3147e-01, 4.3406e-01,
        2.1143e-02, 6.5074e-03, 9.8254e-02, 4.7183e-02])
[rfa agg] iter:  6, prev_obj_val: 34503.55078125, obj_val: 34506.046875, abs dis: 2.49609375
[rfa agg] iter: 6, weight: tensor([7.1626e-05, 1.8213e-01, 2.2985e-02, 2.0683e-01, 1.6581e-01, 1.6093e-01,
        2.4666e-02, 6.9786e-03, 1.6575e-01, 6.3847e-02])
[rfa agg] iter:  7, prev_obj_val: 34506.046875, obj_val: 34506.00390625, abs dis: 0.04296875
[rfa agg] iter: 7, weight: tensor([6.6652e-05, 1.8604e-01, 2.5781e-02, 2.1487e-01, 1.4202e-01, 1.0625e-01,
        2.7725e-02, 7.3902e-03, 2.0974e-01, 8.0101e-02])
[rfa agg] iter:  8, prev_obj_val: 34506.00390625, obj_val: 34507.55859375, abs dis: 1.5546875
[rfa agg] iter: 8, weight: tensor([6.5772e-05, 1.8562e-01, 2.5482e-02, 2.1503e-01, 1.3684e-01, 1.0405e-01,
        2.7420e-02, 7.3049e-03, 2.1861e-01, 7.9581e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.8759, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.3868, Accuracy: 0/9950 (0.0000%)
saving model
Done in 756.9148511886597 sec.
Server Epoch:64 choose agents : [36, 20, 35, 30, 6, 45, 65, 50, 99, 89].
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   1, Avg loss: 0.1070, Accuracy: 2/408 (0.4902%)
_Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   2, Avg loss: 0.0652, Accuracy: 119/408 (29.1667%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.3998, Accuracy: 51/10000 (0.5100%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   1, Avg loss: 0.0646, Accuracy: 248/807 (30.7311%)
_Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   2, Avg loss: 0.0361, Accuracy: 419/807 (51.9207%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.2154, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.1035, Accuracy: 5/271 (1.8450%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0714, Accuracy: 68/271 (25.0923%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.3725, Accuracy: 52/10000 (0.5200%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.0949, Accuracy: 15/486 (3.0864%)
_Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0450, Accuracy: 221/486 (45.4733%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.8702, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   1, Avg loss: 0.0609, Accuracy: 340/1956 (17.3824%)
_Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   2, Avg loss: 0.0338, Accuracy: 632/1956 (32.3108%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.1267, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.0769, Accuracy: 107/669 (15.9940%)
_Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0418, Accuracy: 356/669 (53.2138%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.9615, Accuracy: 77/10000 (0.7700%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   1, Avg loss: 0.0602, Accuracy: 329/1475 (22.3051%)
_Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   2, Avg loss: 0.0328, Accuracy: 567/1475 (38.4407%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.4683, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   1, Avg loss: 0.0643, Accuracy: 148/809 (18.2942%)
_Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   2, Avg loss: 0.0286, Accuracy: 344/809 (42.5216%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.4877, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   1, Avg loss: 0.0785, Accuracy: 113/773 (14.6184%)
_Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   2, Avg loss: 0.0331, Accuracy: 374/773 (48.3829%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.3974, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   1, Avg loss: 0.0675, Accuracy: 303/896 (33.8170%)
_Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   2, Avg loss: 0.0378, Accuracy: 449/896 (50.1116%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.8364, Accuracy: 61/10000 (0.6100%)
time spent on training: 228.468275308609
[rfa agg] training data poison_ratio: 0.37146198830409355  data num: [408, 807, 271, 486, 1956, 669, 1475, 809, 773, 896]
[rfa agg] considering poison per batch poison_fraction: 0.23216374269005846
[rfa agg] init. name: [36, 20, 35, 30, 6, 45, 65, 50, 99, 89], weight: tensor([0.0477, 0.0944, 0.0317, 0.0568, 0.2288, 0.0782, 0.1725, 0.0946, 0.0904,
        0.1048])
[rfa agg] iter:  0, prev_obj_val: 73.47782897949219, obj_val: 73.68155670166016, abs dis: 0.20372772216796875
[rfa agg] iter: 0, weight: tensor([0.0312, 0.1551, 0.0166, 0.0421, 0.0847, 0.0891, 0.1093, 0.1579, 0.1227,
        0.1914])
[rfa agg] iter:  1, prev_obj_val: 73.68155670166016, obj_val: 75.84599304199219, abs dis: 2.1644363403320312
[rfa agg] iter: 1, weight: tensor([0.0304, 0.1808, 0.0153, 0.0425, 0.0575, 0.1031, 0.0691, 0.1942, 0.1229,
        0.1840])
[rfa agg] iter:  2, prev_obj_val: 75.84599304199219, obj_val: 79.46321868896484, abs dis: 3.6172256469726562
[rfa agg] iter: 2, weight: tensor([0.0342, 0.1826, 0.0166, 0.0490, 0.0531, 0.1270, 0.0619, 0.1986, 0.1210,
        0.1561])
[rfa agg] iter:  3, prev_obj_val: 79.46321868896484, obj_val: 79.44017028808594, abs dis: 0.02304840087890625
[rfa agg] iter: 3, weight: tensor([0.0428, 0.1662, 0.0199, 0.0632, 0.0537, 0.1642, 0.0611, 0.1755, 0.1185,
        0.1351])
[rfa agg] iter:  4, prev_obj_val: 79.44017028808594, obj_val: 79.4395980834961, abs dis: 0.00057220458984375
[rfa agg] iter: 4, weight: tensor([0.0429, 0.1645, 0.0199, 0.0636, 0.0535, 0.1723, 0.0608, 0.1715, 0.1182,
        0.1329])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8789, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.7576, Accuracy: 0/9950 (0.0000%)
saving model
Done in 650.8000979423523 sec.
Server Epoch:65 choose agents : [61, 28, 93, 57, 72, 82, 55, 87, 88, 96].
poison local model 61 index 22 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Avg loss: 0.1175, Accuracy: 1/85 (1.1765%), train_poison_data_count: 61
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Avg loss: 0.0963, Accuracy: 11/85 (12.9412%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   3, Avg loss: 0.0752, Accuracy: 41/85 (48.2353%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   4, Avg loss: 0.0710, Accuracy: 49/85 (57.6471%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   5, Avg loss: 0.0653, Accuracy: 51/85 (60.0000%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   6, Avg loss: 0.0605, Accuracy: 57/85 (67.0588%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   7, Avg loss: 0.0539, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   8, Avg loss: 0.0483, Accuracy: 58/85 (68.2353%), train_poison_data_count: 61
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   9, Avg loss: 0.0492, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch  10, Avg loss: 0.0483, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Global model norm: 290.9094709914065.
Norm before scaling: 290.9070405645075. Distance: 0.2457689078955299
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.3407, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 65, Avg loss: 0.6425, Accuracy: 9868/9950 (99.1759%)
Scaling by  100
Scaled Norm after poisoning: 291.6962916502368, distance: 24.57688952115699
Total norm for 3 adversaries is: 291.6962916502368. distance: 24.57688952115699
_Test Local_ResNet_18 poisoned: True, epoch: 65, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0698, Accuracy: 275/1581 (17.3941%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0378, Accuracy: 519/1581 (32.8273%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.4100, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   1, Avg loss: 0.0657, Accuracy: 318/1742 (18.2549%)
_Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   2, Avg loss: 0.0335, Accuracy: 621/1742 (35.6487%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.2736, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0590, Accuracy: 254/1154 (22.0104%)
_Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0297, Accuracy: 472/1154 (40.9012%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 11.4497, Accuracy: 66/10000 (0.6600%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0654, Accuracy: 207/1241 (16.6801%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0378, Accuracy: 399/1241 (32.1515%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.6379, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0862, Accuracy: 17/500 (3.4000%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0532, Accuracy: 180/500 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.1972, Accuracy: 69/10000 (0.6900%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   1, Avg loss: 0.0667, Accuracy: 204/1071 (19.0476%)
_Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   2, Avg loss: 0.0328, Accuracy: 477/1071 (44.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.5663, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   1, Avg loss: 0.0677, Accuracy: 211/1131 (18.6561%)
_Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   2, Avg loss: 0.0348, Accuracy: 384/1131 (33.9523%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.6297, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   1, Avg loss: 0.0858, Accuracy: 77/603 (12.7695%)
_Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   2, Avg loss: 0.0516, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.8625, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   1, Avg loss: 0.0970, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   2, Avg loss: 0.0639, Accuracy: 67/311 (21.5434%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.5475, Accuracy: 49/10000 (0.4900%)
time spent on training: 349.5359055995941
[rfa agg] training data poison_ratio: 0.254485614184096  data num: [85, 1581, 1742, 1154, 1241, 500, 1071, 1131, 603, 311]
[rfa agg] considering poison per batch poison_fraction: 0.15905350886505998
[rfa agg] init. name: [61, 28, 93, 57, 72, 82, 55, 87, 88, 96], weight: tensor([0.0090, 0.1679, 0.1849, 0.1225, 0.1318, 0.0531, 0.1137, 0.1201, 0.0640,
        0.0330])
[rfa agg] iter:  0, prev_obj_val: 228.12669372558594, obj_val: 169.9396209716797, abs dis: 58.18707275390625
[rfa agg] iter: 0, weight: tensor([7.6671e-05, 2.1224e-01, 2.3083e-01, 1.1882e-01, 1.3859e-01, 2.9700e-02,
        1.0021e-01, 1.1399e-01, 3.9645e-02, 1.5900e-02])
[rfa agg] iter:  1, prev_obj_val: 169.9396209716797, obj_val: 171.1923828125, abs dis: 1.2527618408203125
[rfa agg] iter: 1, weight: tensor([2.9415e-05, 1.1956e-01, 9.1488e-02, 1.4136e-01, 2.2598e-01, 2.1807e-02,
        1.5308e-01, 2.0405e-01, 3.2121e-02, 1.0526e-02])
[rfa agg] iter:  2, prev_obj_val: 171.1923828125, obj_val: 174.1912078857422, abs dis: 2.9988250732421875
[rfa agg] iter: 2, weight: tensor([2.8239e-05, 9.9082e-02, 7.8586e-02, 1.3626e-01, 1.9653e-01, 2.2908e-02,
        1.8213e-01, 2.3912e-01, 3.4525e-02, 1.0841e-02])
[rfa agg] iter:  3, prev_obj_val: 174.1912078857422, obj_val: 174.17393493652344, abs dis: 0.01727294921875
[rfa agg] iter: 3, weight: tensor([2.9868e-05, 9.3073e-02, 7.6162e-02, 1.3199e-01, 1.6454e-01, 2.6716e-02,
        2.1356e-01, 2.4026e-01, 4.1327e-02, 1.2339e-02])
[rfa agg] iter:  4, prev_obj_val: 174.17393493652344, obj_val: 176.12501525878906, abs dis: 1.951080322265625
[rfa agg] iter: 4, weight: tensor([2.9673e-05, 9.2381e-02, 7.5650e-02, 1.3064e-01, 1.6125e-01, 2.6555e-02,
        2.2103e-01, 2.3910e-01, 4.1089e-02, 1.2269e-02])
[rfa agg] iter:  5, prev_obj_val: 176.12501525878906, obj_val: 176.12271118164062, abs dis: 0.0023040771484375
[rfa agg] iter: 5, weight: tensor([3.1279e-05, 9.2322e-02, 7.6568e-02, 1.3026e-01, 1.5374e-01, 2.9492e-02,
        2.3032e-01, 2.2750e-01, 4.6324e-02, 1.3439e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 34.0371, Accuracy: 40/10000 (0.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 42.3965, Accuracy: 0/9950 (0.0000%)
saving model
Done in 773.4009070396423 sec.
Server Epoch:66 choose agents : [15, 18, 21, 86, 93, 71, 34, 3, 52, 47].
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   1, Avg loss: 0.0633, Accuracy: 275/1154 (23.8302%)
_Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   2, Avg loss: 0.0330, Accuracy: 426/1154 (36.9151%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 10.2705, Accuracy: 76/10000 (0.7600%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0963, Accuracy: 31/530 (5.8491%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0411, Accuracy: 274/530 (51.6981%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 10.7197, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   1, Avg loss: 0.0594, Accuracy: 351/1949 (18.0092%)
_Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   2, Avg loss: 0.0352, Accuracy: 608/1949 (31.1955%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.8841, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0591, Accuracy: 352/1003 (35.0947%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0339, Accuracy: 398/1003 (39.6810%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.4983, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0637, Accuracy: 328/1742 (18.8289%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0332, Accuracy: 645/1742 (37.0264%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.0620, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0731, Accuracy: 90/818 (11.0024%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0314, Accuracy: 354/818 (43.2763%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 10.5398, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   1, Avg loss: 0.0633, Accuracy: 311/1427 (21.7940%)
_Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   2, Avg loss: 0.0373, Accuracy: 547/1427 (38.3322%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.2551, Accuracy: 79/10000 (0.7900%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   1, Avg loss: 0.0791, Accuracy: 70/781 (8.9629%)
_Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   2, Avg loss: 0.0392, Accuracy: 260/781 (33.2907%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.9641, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   1, Avg loss: 0.0567, Accuracy: 258/636 (40.5660%)
_Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   2, Avg loss: 0.0326, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.8069, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   1, Avg loss: 0.1277, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   2, Avg loss: 0.1058, Accuracy: 4/134 (2.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.1517, Accuracy: 54/10000 (0.5400%)
time spent on training: 275.68778800964355
[rfa agg] training data poison_ratio: 0.24228425398073522  data num: [1154, 530, 1949, 1003, 1742, 818, 1427, 781, 636, 134]
[rfa agg] considering poison per batch poison_fraction: 0.15142765873795952
[rfa agg] init. name: [15, 18, 21, 86, 93, 71, 34, 3, 52, 47], weight: tensor([0.1134, 0.0521, 0.1916, 0.0986, 0.1712, 0.0804, 0.1403, 0.0768, 0.0625,
        0.0132])
[rfa agg] iter:  0, prev_obj_val: 71.36924743652344, obj_val: 73.68047332763672, abs dis: 2.3112258911132812
[rfa agg] iter: 0, weight: tensor([0.1877, 0.0345, 0.0968, 0.1789, 0.1114, 0.0876, 0.1702, 0.0823, 0.0455,
        0.0052])
[rfa agg] iter:  1, prev_obj_val: 73.68047332763672, obj_val: 76.07061004638672, abs dis: 2.39013671875
[rfa agg] iter: 1, weight: tensor([0.1681, 0.0375, 0.0806, 0.2353, 0.0906, 0.1053, 0.1291, 0.0979, 0.0503,
        0.0053])
[rfa agg] iter:  2, prev_obj_val: 76.07061004638672, obj_val: 77.51805114746094, abs dis: 1.4474411010742188
[rfa agg] iter: 2, weight: tensor([0.1388, 0.0404, 0.0720, 0.2642, 0.0797, 0.1237, 0.1076, 0.1134, 0.0547,
        0.0053])
[rfa agg] iter:  3, prev_obj_val: 77.51805114746094, obj_val: 77.5121841430664, abs dis: 0.00586700439453125
[rfa agg] iter: 3, weight: tensor([0.1249, 0.0425, 0.0685, 0.2651, 0.0752, 0.1369, 0.0993, 0.1244, 0.0577,
        0.0054])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.8836, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.9425, Accuracy: 0/9950 (0.0000%)
saving model
Done in 696.4691903591156 sec.
Server Epoch:67 choose agents : [65, 12, 41, 56, 19, 23, 37, 45, 96, 9].
poison local model 65 index 23 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   1, Avg loss: 0.0501, Accuracy: 727/1475 (49.2881%), train_poison_data_count: 923
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   2, Avg loss: 0.0270, Accuracy: 869/1475 (58.9153%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   3, Avg loss: 0.0234, Accuracy: 916/1475 (62.1017%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   4, Avg loss: 0.0234, Accuracy: 931/1475 (63.1186%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   5, Avg loss: 0.0238, Accuracy: 916/1475 (62.1017%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   6, Avg loss: 0.0234, Accuracy: 927/1475 (62.8475%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   7, Avg loss: 0.0220, Accuracy: 921/1475 (62.4407%), train_poison_data_count: 923
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   8, Avg loss: 0.0226, Accuracy: 919/1475 (62.3051%), train_poison_data_count: 923
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   9, Avg loss: 0.0223, Accuracy: 916/1475 (62.1017%), train_poison_data_count: 923
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch  10, Avg loss: 0.0215, Accuracy: 918/1475 (62.2373%), train_poison_data_count: 923
Global model norm: 294.7634512409909.
Norm before scaling: 294.68429876310006. Distance: 1.0924000720101958
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.4615, Accuracy: 59/10000 (0.5900%)
_Test Local_ResNet_18 poisoned: True, epoch: 67, Avg loss: 0.4607, Accuracy: 9573/9950 (96.2111%)
Scaling by  100
Scaled Norm after poisoning: 306.650605331214, distance: 109.24001491841257
Total norm for 4 adversaries is: 306.650605331214. distance: 109.24001491841257
_Test Local_ResNet_18 poisoned: True, epoch: 67, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   1, Avg loss: 0.1130, Accuracy: 0/338 (0.0000%)
_Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   2, Avg loss: 0.0676, Accuracy: 100/338 (29.5858%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.5755, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   1, Avg loss: 0.0799, Accuracy: 169/719 (23.5049%)
_Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   2, Avg loss: 0.0379, Accuracy: 459/719 (63.8387%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.7561, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.1005, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0841, Accuracy: 6/186 (3.2258%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.5191, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 360/1036 (34.7490%)
_Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0263, Accuracy: 614/1036 (59.2664%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 12.5581, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   1, Avg loss: 0.0641, Accuracy: 233/715 (32.5874%)
_Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   2, Avg loss: 0.0415, Accuracy: 436/715 (60.9790%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.3855, Accuracy: 67/10000 (0.6700%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   1, Avg loss: 0.0483, Accuracy: 367/1129 (32.5066%)
_Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   2, Avg loss: 0.0241, Accuracy: 698/1129 (61.8246%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.8652, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   1, Avg loss: 0.0734, Accuracy: 98/669 (14.6487%)
_Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   2, Avg loss: 0.0420, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.3160, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.0991, Accuracy: 1/311 (0.3215%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0669, Accuracy: 53/311 (17.0418%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.2064, Accuracy: 49/10000 (0.4900%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   1, Avg loss: 0.0540, Accuracy: 281/1275 (22.0392%)
_Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   2, Avg loss: 0.0212, Accuracy: 652/1275 (51.1373%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 11.7261, Accuracy: 98/10000 (0.9800%)
time spent on training: 326.96177101135254
[rfa agg] training data poison_ratio: 0.5369922322679231  data num: [1475, 338, 719, 186, 1036, 715, 1129, 669, 311, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.335620145167452
[rfa agg] init. name: [65, 12, 41, 56, 19, 23, 37, 45, 96, 9], weight: tensor([0.1878, 0.0430, 0.0916, 0.0237, 0.1319, 0.0910, 0.1438, 0.0852, 0.0396,
        0.1624])
[rfa agg] iter:  0, prev_obj_val: 32858.453125, obj_val: 23637.52734375, abs dis: 9220.92578125
[rfa agg] iter: 0, weight: tensor([0.0507, 0.0501, 0.1069, 0.0275, 0.1544, 0.1063, 0.1683, 0.0994, 0.0461,
        0.1902])
[rfa agg] iter:  1, prev_obj_val: 23637.52734375, obj_val: 21039.26953125, abs dis: 2598.2578125
[rfa agg] iter: 1, weight: tensor([0.0122, 0.0516, 0.1109, 0.0283, 0.1611, 0.1103, 0.1759, 0.1030, 0.0474,
        0.1993])
[rfa agg] iter:  2, prev_obj_val: 21039.26953125, obj_val: 20411.44140625, abs dis: 627.828125
[rfa agg] iter: 2, weight: tensor([0.0028, 0.0498, 0.1104, 0.0268, 0.1648, 0.1098, 0.1809, 0.1020, 0.0455,
        0.2072])
[rfa agg] iter:  3, prev_obj_val: 20411.44140625, obj_val: 20277.767578125, abs dis: 133.673828125
[rfa agg] iter: 3, weight: tensor([0.0006, 0.0407, 0.1023, 0.0206, 0.1731, 0.1016, 0.1950, 0.0924, 0.0364,
        0.2374])
[rfa agg] iter:  4, prev_obj_val: 20277.767578125, obj_val: 20272.306640625, abs dis: 5.4609375
[rfa agg] iter: 4, weight: tensor([9.7637e-05, 1.8016e-02, 6.4259e-02, 8.0071e-03, 1.9106e-01, 6.3415e-02,
        2.1655e-01, 5.3907e-02, 1.5405e-02, 3.6929e-01])
[rfa agg] iter:  5, prev_obj_val: 20272.306640625, obj_val: 20274.40234375, abs dis: 2.095703125
[rfa agg] iter: 5, weight: tensor([8.7270e-05, 2.2683e-02, 1.0391e-01, 9.2899e-03, 2.6037e-01, 1.0103e-01,
        2.0479e-01, 8.2302e-02, 1.8820e-02, 1.9672e-01])
[rfa agg] iter:  6, prev_obj_val: 20274.40234375, obj_val: 20274.326171875, abs dis: 0.076171875
[rfa agg] iter: 6, weight: tensor([8.9631e-05, 2.7055e-02, 1.4515e-01, 1.0605e-02, 2.2290e-01, 1.3917e-01,
        1.7079e-01, 1.1190e-01, 2.2075e-02, 1.5027e-01])
[rfa agg] iter:  7, prev_obj_val: 20274.326171875, obj_val: 20275.4296875, abs dis: 1.103515625
[rfa agg] iter: 7, weight: tensor([8.9044e-05, 2.7018e-02, 1.4902e-01, 1.0587e-02, 2.1882e-01, 1.4380e-01,
        1.6679e-01, 1.1408e-01, 2.2055e-02, 1.4774e-01])
[rfa agg] iter:  8, prev_obj_val: 20275.4296875, obj_val: 20278.125, abs dis: 2.6953125
[rfa agg] iter: 8, weight: tensor([8.8799e-05, 2.8408e-02, 1.6494e-01, 1.0947e-02, 1.9632e-01, 1.5836e-01,
        1.5449e-01, 1.2584e-01, 2.3042e-02, 1.3756e-01])
[rfa agg] iter:  9, prev_obj_val: 20278.125, obj_val: 20278.080078125, abs dis: 0.044921875
[rfa agg] iter: 9, weight: tensor([8.5924e-05, 3.0832e-02, 1.9444e-01, 1.1437e-02, 1.5527e-01, 1.8485e-01,
        1.2950e-01, 1.5184e-01, 2.4648e-02, 1.1710e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 28.8404, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 40.8015, Accuracy: 0/9950 (0.0000%)
saving model
Done in 749.1648650169373 sec.
Server Epoch:68 choose agents : [30, 17, 54, 91, 69, 28, 65, 60, 9, 11].
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   1, Avg loss: 0.0964, Accuracy: 8/486 (1.6461%)
_Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   2, Avg loss: 0.0487, Accuracy: 202/486 (41.5638%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.6284, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0539, Accuracy: 283/1574 (17.9797%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0309, Accuracy: 546/1574 (34.6887%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.7390, Accuracy: 83/10000 (0.8300%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   1, Avg loss: 0.0595, Accuracy: 298/1130 (26.3717%)
_Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   2, Avg loss: 0.0310, Accuracy: 445/1130 (39.3805%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.8416, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   1, Avg loss: 0.0649, Accuracy: 233/1030 (22.6214%)
_Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   2, Avg loss: 0.0278, Accuracy: 591/1030 (57.3786%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 11.4656, Accuracy: 97/10000 (0.9700%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   1, Avg loss: 0.0571, Accuracy: 234/590 (39.6610%)
_Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 12.7738, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   1, Avg loss: 0.0701, Accuracy: 313/1581 (19.7976%)
_Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   2, Avg loss: 0.0378, Accuracy: 510/1581 (32.2581%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.6189, Accuracy: 84/10000 (0.8400%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   1, Avg loss: 0.0628, Accuracy: 304/1475 (20.6102%)
_Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   2, Avg loss: 0.0330, Accuracy: 623/1475 (42.2373%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.5620, Accuracy: 79/10000 (0.7900%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0571, Accuracy: 521/2227 (23.3947%)
_Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0296, Accuracy: 960/2227 (43.1073%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.9387, Accuracy: 113/10000 (1.1300%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0522, Accuracy: 286/1275 (22.4314%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0205, Accuracy: 692/1275 (54.2745%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 12.6591, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   1, Avg loss: 0.0773, Accuracy: 171/712 (24.0169%)
_Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   2, Avg loss: 0.0301, Accuracy: 432/712 (60.6742%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 11.3667, Accuracy: 60/10000 (0.6000%)
time spent on training: 355.50993394851685
[rfa agg] training data poison_ratio: 0.5946192052980133  data num: [486, 1574, 1130, 1030, 590, 1581, 1475, 2227, 1275, 712]
[rfa agg] considering poison per batch poison_fraction: 0.37163700331125826
[rfa agg] init. name: [30, 17, 54, 91, 69, 28, 65, 60, 9, 11], weight: tensor([0.0402, 0.1303, 0.0935, 0.0853, 0.0488, 0.1309, 0.1221, 0.1844, 0.1055,
        0.0589])
[rfa agg] iter:  0, prev_obj_val: 69.60006713867188, obj_val: 70.71725463867188, abs dis: 1.1171875
[rfa agg] iter: 0, weight: tensor([0.0199, 0.1210, 0.1606, 0.1052, 0.0290, 0.1243, 0.1199, 0.0683, 0.2084,
        0.0434])
[rfa agg] iter:  1, prev_obj_val: 70.71725463867188, obj_val: 72.31938171386719, abs dis: 1.6021270751953125
[rfa agg] iter: 1, weight: tensor([0.0204, 0.1109, 0.1768, 0.1090, 0.0298, 0.1143, 0.1106, 0.0646, 0.2184,
        0.0452])
[rfa agg] iter:  2, prev_obj_val: 72.31938171386719, obj_val: 72.31471252441406, abs dis: 0.004669189453125
[rfa agg] iter: 2, weight: tensor([0.0217, 0.1056, 0.1904, 0.1161, 0.0319, 0.1086, 0.1054, 0.0638, 0.2075,
        0.0490])
[rfa agg] iter:  3, prev_obj_val: 72.31471252441406, obj_val: 72.3145523071289, abs dis: 0.00016021728515625
[rfa agg] iter: 3, weight: tensor([0.0217, 0.1054, 0.1933, 0.1168, 0.0319, 0.1084, 0.1051, 0.0637, 0.2048,
        0.0490])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 26.3508, Accuracy: 28/10000 (0.2800%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 44.7026, Accuracy: 0/9950 (0.0000%)
saving model
Done in 772.6216888427734 sec.
Server Epoch:69 choose agents : [69, 3, 66, 36, 78, 83, 8, 10, 93, 58].
poison local model 69 index 24 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0601, Accuracy: 168/590 (28.4746%), train_poison_data_count: 374
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0292, Accuracy: 363/590 (61.5254%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   3, Avg loss: 0.0255, Accuracy: 303/590 (51.3559%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   4, Avg loss: 0.0235, Accuracy: 341/590 (57.7966%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   5, Avg loss: 0.0229, Accuracy: 339/590 (57.4576%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   6, Avg loss: 0.0224, Accuracy: 348/590 (58.9831%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   7, Avg loss: 0.0240, Accuracy: 341/590 (57.7966%), train_poison_data_count: 374
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   8, Avg loss: 0.0206, Accuracy: 362/590 (61.3559%), train_poison_data_count: 374
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   9, Avg loss: 0.0225, Accuracy: 351/590 (59.4915%), train_poison_data_count: 374
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch  10, Avg loss: 0.0235, Accuracy: 341/590 (57.7966%), train_poison_data_count: 374
Global model norm: 298.57658408271067.
Norm before scaling: 298.55003768212794. Distance: 0.8174046156879626
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.5785, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 69, Avg loss: 0.4704, Accuracy: 8006/9950 (80.4623%)
Scaling by  100
Scaled Norm after poisoning: 306.88299378590534, distance: 81.74046078710042
Total norm for 5 adversaries is: 306.88299378590534. distance: 81.74046078710042
_Test Local_ResNet_18 poisoned: True, epoch: 69, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   1, Avg loss: 0.0809, Accuracy: 63/781 (8.0666%)
_Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   2, Avg loss: 0.0392, Accuracy: 251/781 (32.1383%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.4604, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   1, Avg loss: 0.0717, Accuracy: 199/1402 (14.1940%)
_Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   2, Avg loss: 0.0421, Accuracy: 344/1402 (24.5364%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.2454, Accuracy: 60/10000 (0.6000%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   1, Avg loss: 0.1060, Accuracy: 2/408 (0.4902%)
_Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   2, Avg loss: 0.0645, Accuracy: 111/408 (27.2059%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.9292, Accuracy: 46/10000 (0.4600%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   1, Avg loss: 0.0928, Accuracy: 15/416 (3.6058%)
_Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   2, Avg loss: 0.0503, Accuracy: 178/416 (42.7885%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.6418, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0675, Accuracy: 334/1953 (17.1019%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0372, Accuracy: 623/1953 (31.8996%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.0647, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   1, Avg loss: 0.0654, Accuracy: 211/1513 (13.9458%)
_Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   2, Avg loss: 0.0382, Accuracy: 448/1513 (29.6100%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.7144, Accuracy: 93/10000 (0.9300%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   1, Avg loss: 0.0729, Accuracy: 135/861 (15.6794%)
_Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   2, Avg loss: 0.0247, Accuracy: 382/861 (44.3670%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 11.3567, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   1, Avg loss: 0.0633, Accuracy: 330/1742 (18.9437%)
_Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   2, Avg loss: 0.0333, Accuracy: 646/1742 (37.0838%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.1279, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   1, Avg loss: 0.0588, Accuracy: 305/803 (37.9826%)
_Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   2, Avg loss: 0.0372, Accuracy: 407/803 (50.6849%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.9611, Accuracy: 54/10000 (0.5400%)
time spent on training: 360.0905649662018
[rfa agg] training data poison_ratio: 0.29190944693858056  data num: [590, 781, 1402, 408, 416, 1953, 1513, 861, 1742, 803]
[rfa agg] considering poison per batch poison_fraction: 0.18244340433661285
[rfa agg] init. name: [69, 3, 66, 36, 78, 83, 8, 10, 93, 58], weight: tensor([0.0564, 0.0746, 0.1339, 0.0390, 0.0397, 0.1866, 0.1445, 0.0822, 0.1664,
        0.0767])
[rfa agg] iter:  0, prev_obj_val: 4851.5224609375, obj_val: 2717.101318359375, abs dis: 2134.421142578125
[rfa agg] iter: 0, weight: tensor([0.0035, 0.0764, 0.1415, 0.0391, 0.0399, 0.2033, 0.1537, 0.0846, 0.1795,
        0.0786])
[rfa agg] iter:  1, prev_obj_val: 2717.101318359375, obj_val: 2646.873046875, abs dis: 70.228271484375
[rfa agg] iter: 1, weight: tensor([1.6064e-04, 4.3416e-02, 1.1958e-01, 1.8180e-02, 1.8544e-02, 3.3149e-01,
        1.4553e-01, 4.9814e-02, 2.2873e-01, 4.4556e-02])
[rfa agg] iter:  2, prev_obj_val: 2646.873046875, obj_val: 2647.423828125, abs dis: 0.55078125
[rfa agg] iter: 2, weight: tensor([6.8090e-05, 4.2528e-02, 2.3573e-01, 1.4310e-02, 1.4594e-02, 1.4564e-01,
        2.5908e-01, 5.1361e-02, 1.9288e-01, 4.3819e-02])
[rfa agg] iter:  3, prev_obj_val: 2647.423828125, obj_val: 2649.1328125, abs dis: 1.708984375
[rfa agg] iter: 3, weight: tensor([6.6437e-05, 4.8085e-02, 2.9630e-01, 1.5348e-02, 1.5646e-02, 1.1742e-01,
        2.4917e-01, 5.8998e-02, 1.4931e-01, 4.9646e-02])
[rfa agg] iter:  4, prev_obj_val: 2649.1328125, obj_val: 2652.86572265625, abs dis: 3.73291015625
[rfa agg] iter: 4, weight: tensor([6.9512e-05, 5.6063e-02, 3.1504e-01, 1.7167e-02, 1.7496e-02, 1.1147e-01,
        2.1865e-01, 6.9675e-02, 1.3645e-01, 5.7926e-02])
[rfa agg] iter:  5, prev_obj_val: 2652.86572265625, obj_val: 2652.845703125, abs dis: 0.02001953125
[rfa agg] iter: 5, weight: tensor([7.8170e-05, 7.5891e-02, 2.7531e-01, 2.1510e-02, 2.1918e-02, 1.1045e-01,
        1.8980e-01, 9.6529e-02, 1.2997e-01, 7.8533e-02])
[rfa agg] iter:  6, prev_obj_val: 2652.845703125, obj_val: 2654.269287109375, abs dis: 1.423583984375
[rfa agg] iter: 6, weight: tensor([7.8446e-05, 7.6563e-02, 2.7176e-01, 2.1618e-02, 2.2024e-02, 1.1092e-01,
        1.8963e-01, 9.7613e-02, 1.3057e-01, 7.9216e-02])
[rfa agg] iter:  7, prev_obj_val: 2654.269287109375, obj_val: 2652.84814453125, abs dis: 1.421142578125
[rfa agg] iter: 7, weight: tensor([8.0831e-05, 8.4569e-02, 2.5286e-01, 2.3151e-02, 2.3585e-02, 1.0992e-01,
        1.8144e-01, 1.0883e-01, 1.2798e-01, 8.7584e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 22.6873, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 32.0692, Accuracy: 0/9950 (0.0000%)
saving model
Done in 783.5857434272766 sec.
Server Epoch:70 choose agents : [22, 18, 31, 35, 88, 66, 36, 14, 27, 48].
_Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0576, Accuracy: 367/1470 (24.9660%)
_Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0255, Accuracy: 787/1470 (53.5374%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.9941, Accuracy: 95/10000 (0.9500%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   1, Avg loss: 0.0933, Accuracy: 31/530 (5.8491%)
_Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   2, Avg loss: 0.0413, Accuracy: 305/530 (57.5472%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 12.0882, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   1, Avg loss: 0.0838, Accuracy: 32/460 (6.9565%)
_Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   2, Avg loss: 0.0398, Accuracy: 178/460 (38.6957%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.9947, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   1, Avg loss: 0.1150, Accuracy: 1/271 (0.3690%)
_Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   2, Avg loss: 0.0773, Accuracy: 54/271 (19.9262%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.7371, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.0861, Accuracy: 90/603 (14.9254%)
_Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0533, Accuracy: 291/603 (48.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.1458, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0708, Accuracy: 190/1402 (13.5521%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0415, Accuracy: 359/1402 (25.6063%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3395, Accuracy: 70/10000 (0.7000%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.1063, Accuracy: 2/408 (0.4902%)
_Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0645, Accuracy: 125/408 (30.6373%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.9392, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   1, Avg loss: 0.0807, Accuracy: 130/1013 (12.8332%)
_Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   2, Avg loss: 0.0426, Accuracy: 296/1013 (29.2201%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.7127, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   1, Avg loss: 0.0639, Accuracy: 344/1587 (21.6761%)
_Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   2, Avg loss: 0.0362, Accuracy: 563/1587 (35.4757%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.6293, Accuracy: 65/10000 (0.6500%)
poison local model 48 index 17 
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0814, Accuracy: 49/631 (7.7655%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0469, Accuracy: 222/631 (35.1823%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.2420, Accuracy: 70/10000 (0.7000%)
time spent on training: 278.84367632865906
[rfa agg] training data poison_ratio: 0.18734328358208954  data num: [1470, 530, 460, 271, 603, 1402, 408, 1013, 1587, 631]
[rfa agg] considering poison per batch poison_fraction: 0.11708955223880596
[rfa agg] init. name: [22, 18, 31, 35, 88, 66, 36, 14, 27, 48], weight: tensor([0.1755, 0.0633, 0.0549, 0.0324, 0.0720, 0.1674, 0.0487, 0.1210, 0.1895,
        0.0753])
[rfa agg] iter:  0, prev_obj_val: 66.85735321044922, obj_val: 68.91029357910156, abs dis: 2.0529403686523438
[rfa agg] iter: 0, weight: tensor([0.1314, 0.0620, 0.0471, 0.0194, 0.0835, 0.1438, 0.0368, 0.2711, 0.1167,
        0.0881])
[rfa agg] iter:  1, prev_obj_val: 68.91029357910156, obj_val: 70.1653823852539, abs dis: 1.2550888061523438
[rfa agg] iter: 1, weight: tensor([0.1170, 0.0720, 0.0535, 0.0211, 0.0992, 0.1265, 0.0411, 0.2595, 0.1055,
        0.1046])
[rfa agg] iter:  2, prev_obj_val: 70.1653823852539, obj_val: 70.15634155273438, abs dis: 0.00904083251953125
[rfa agg] iter: 2, weight: tensor([0.1122, 0.0794, 0.0582, 0.0223, 0.1113, 0.1204, 0.0444, 0.2324, 0.1019,
        0.1175])
[rfa agg] iter:  3, prev_obj_val: 70.15634155273438, obj_val: 70.15625, abs dis: 9.1552734375e-05
[rfa agg] iter: 3, weight: tensor([0.1122, 0.0798, 0.0585, 0.0224, 0.1124, 0.1205, 0.0446, 0.2290, 0.1019,
        0.1186])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.9353, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 6.6535, Accuracy: 0/9950 (0.0000%)
saving model
Done in 699.5639083385468 sec.
Server Epoch:71 choose agents : [72, 77, 92, 31, 46, 66, 54, 0, 25, 36].
poison local model 72 index 25 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   1, Avg loss: 0.0553, Accuracy: 576/1241 (46.4142%), train_poison_data_count: 785
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   2, Avg loss: 0.0298, Accuracy: 716/1241 (57.6954%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   3, Avg loss: 0.0273, Accuracy: 778/1241 (62.6914%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   4, Avg loss: 0.0265, Accuracy: 762/1241 (61.4021%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   5, Avg loss: 0.0253, Accuracy: 768/1241 (61.8856%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   6, Avg loss: 0.0252, Accuracy: 770/1241 (62.0467%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   7, Avg loss: 0.0251, Accuracy: 764/1241 (61.5633%), train_poison_data_count: 785
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   8, Avg loss: 0.0253, Accuracy: 764/1241 (61.5633%), train_poison_data_count: 785
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   9, Avg loss: 0.0254, Accuracy: 750/1241 (60.4351%), train_poison_data_count: 785
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch  10, Avg loss: 0.0252, Accuracy: 757/1241 (60.9992%), train_poison_data_count: 785
Global model norm: 302.3239415345731.
Norm before scaling: 302.25823241476814. Distance: 0.978422118571366
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.4276, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 71, Avg loss: 0.5777, Accuracy: 9241/9950 (92.8744%)
Scaling by  100
Scaled Norm after poisoning: 311.29565428222736, distance: 97.84221792955738
Total norm for 5 adversaries is: 311.29565428222736. distance: 97.84221792955738
_Test Local_ResNet_18 poisoned: True, epoch: 71, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0603, Accuracy: 292/1340 (21.7910%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0307, Accuracy: 530/1340 (39.5522%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.4802, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   1, Avg loss: 0.0627, Accuracy: 362/1715 (21.1079%)
_Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   2, Avg loss: 0.0335, Accuracy: 702/1715 (40.9329%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.6777, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   1, Avg loss: 0.0785, Accuracy: 36/460 (7.8261%)
_Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   2, Avg loss: 0.0429, Accuracy: 194/460 (42.1739%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.8826, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   1, Avg loss: 0.0556, Accuracy: 384/1904 (20.1681%)
_Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   2, Avg loss: 0.0337, Accuracy: 610/1904 (32.0378%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.3064, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   1, Avg loss: 0.0704, Accuracy: 193/1402 (13.7660%)
_Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   2, Avg loss: 0.0423, Accuracy: 332/1402 (23.6805%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.3867, Accuracy: 68/10000 (0.6800%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   1, Avg loss: 0.0580, Accuracy: 314/1130 (27.7876%)
_Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   2, Avg loss: 0.0309, Accuracy: 441/1130 (39.0265%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.4525, Accuracy: 60/10000 (0.6000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   1, Avg loss: 0.0670, Accuracy: 318/1657 (19.1913%)
_Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   2, Avg loss: 0.0403, Accuracy: 413/1657 (24.9246%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.4740, Accuracy: 63/10000 (0.6300%)
poison local model 25 index 10 
_Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   1, Avg loss: 0.0615, Accuracy: 240/690 (34.7826%)
_Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   2, Avg loss: 0.0299, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.4341, Accuracy: 67/10000 (0.6700%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   1, Avg loss: 0.1053, Accuracy: 4/408 (0.9804%)
_Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   2, Avg loss: 0.0651, Accuracy: 132/408 (32.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.1072, Accuracy: 47/10000 (0.4700%)
time spent on training: 367.6578254699707
[rfa agg] training data poison_ratio: 0.4290616891269775  data num: [1241, 1340, 1715, 460, 1904, 1402, 1130, 1657, 690, 408]
[rfa agg] considering poison per batch poison_fraction: 0.26816355570436096
[rfa agg] init. name: [72, 77, 92, 31, 46, 66, 54, 0, 25, 36], weight: tensor([0.1039, 0.1122, 0.1436, 0.0385, 0.1594, 0.1174, 0.0946, 0.1387, 0.0578,
        0.0342])
[rfa agg] iter:  0, prev_obj_val: 16711.66015625, obj_val: 10255.16796875, abs dis: 6456.4921875
[rfa agg] iter: 0, weight: tensor([0.0132, 0.1233, 0.1588, 0.0418, 0.1768, 0.1292, 0.1037, 0.1532, 0.0629,
        0.0370])
[rfa agg] iter:  1, prev_obj_val: 10255.16796875, obj_val: 9431.2900390625, abs dis: 823.8779296875
[rfa agg] iter: 1, weight: tensor([0.0015, 0.1234, 0.1654, 0.0385, 0.1881, 0.1300, 0.1017, 0.1585, 0.0590,
        0.0339])
[rfa agg] iter:  2, prev_obj_val: 9431.2900390625, obj_val: 9385.078125, abs dis: 46.2119140625
[rfa agg] iter: 2, weight: tensor([1.3051e-04, 9.5003e-02, 1.9158e-01, 1.7437e-02, 3.0669e-01, 1.0628e-01,
        6.6642e-02, 1.7201e-01, 2.9322e-02, 1.4897e-02])
[rfa agg] iter:  3, prev_obj_val: 9385.078125, obj_val: 9387.9970703125, abs dis: 2.9189453125
[rfa agg] iter: 3, weight: tensor([6.1385e-05, 1.6174e-01, 1.6035e-01, 1.4390e-02, 1.3325e-01, 2.0221e-01,
        8.6232e-02, 2.0330e-01, 2.6490e-02, 1.1977e-02])
[rfa agg] iter:  4, prev_obj_val: 9387.9970703125, obj_val: 9389.28515625, abs dis: 1.2880859375
[rfa agg] iter: 4, weight: tensor([5.9654e-05, 2.1121e-01, 1.2154e-01, 1.5989e-02, 1.0014e-01, 2.4611e-01,
        1.1346e-01, 1.4800e-01, 3.0308e-02, 1.3187e-02])
[rfa agg] iter:  5, prev_obj_val: 9389.28515625, obj_val: 9390.9033203125, abs dis: 1.6181640625
[rfa agg] iter: 5, weight: tensor([5.9347e-05, 2.2530e-01, 1.1270e-01, 1.6502e-02, 9.4477e-02, 2.4757e-01,
        1.2404e-01, 1.3425e-01, 3.1532e-02, 1.3571e-02])
[rfa agg] iter:  6, prev_obj_val: 9390.9033203125, obj_val: 9392.7333984375, abs dis: 1.830078125
[rfa agg] iter: 6, weight: tensor([6.0846e-05, 2.3115e-01, 1.0904e-01, 1.7560e-02, 9.2359e-02, 2.3529e-01,
        1.3836e-01, 1.2792e-01, 3.3857e-02, 1.4399e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.9259, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 6.7897, Accuracy: 0/9950 (0.0000%)
saving model
Done in 808.048483133316 sec.
Server Epoch:72 choose agents : [7, 99, 12, 11, 10, 15, 85, 26, 14, 29].
_Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0670, Accuracy: 229/891 (25.7015%)
_Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0301, Accuracy: 435/891 (48.8215%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.6110, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0777, Accuracy: 117/773 (15.1358%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0328, Accuracy: 401/773 (51.8758%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.2354, Accuracy: 64/10000 (0.6400%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   1, Avg loss: 0.1153, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   2, Avg loss: 0.0682, Accuracy: 98/338 (28.9941%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.4119, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   1, Avg loss: 0.0763, Accuracy: 161/712 (22.6124%)
_Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   2, Avg loss: 0.0302, Accuracy: 429/712 (60.2528%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.9935, Accuracy: 62/10000 (0.6200%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   1, Avg loss: 0.0747, Accuracy: 124/861 (14.4019%)
_Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   2, Avg loss: 0.0240, Accuracy: 392/861 (45.5285%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 11.3086, Accuracy: 75/10000 (0.7500%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   1, Avg loss: 0.0625, Accuracy: 282/1154 (24.4367%)
_Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   2, Avg loss: 0.0325, Accuracy: 426/1154 (36.9151%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.0119, Accuracy: 60/10000 (0.6000%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   1, Avg loss: 0.0681, Accuracy: 334/1988 (16.8008%)
_Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   2, Avg loss: 0.0391, Accuracy: 542/1988 (27.2636%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.4595, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   1, Avg loss: 0.0665, Accuracy: 231/1446 (15.9751%)
_Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   2, Avg loss: 0.0375, Accuracy: 506/1446 (34.9931%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.0496, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   1, Avg loss: 0.0780, Accuracy: 130/1013 (12.8332%)
_Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   2, Avg loss: 0.0400, Accuracy: 338/1013 (33.3662%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.0325, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   1, Avg loss: 0.0616, Accuracy: 329/1440 (22.8472%)
_Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   2, Avg loss: 0.0310, Accuracy: 631/1440 (43.8194%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.6066, Accuracy: 77/10000 (0.7700%)
time spent on training: 251.73324990272522
[rfa agg] training data poison_ratio: 0.4089110776186888  data num: [891, 773, 338, 712, 861, 1154, 1988, 1446, 1013, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.2555694235116805
[rfa agg] init. name: [7, 99, 12, 11, 10, 15, 85, 26, 14, 29], weight: tensor([0.0839, 0.0728, 0.0318, 0.0671, 0.0811, 0.1087, 0.1873, 0.1362, 0.0954,
        0.1356])
[rfa agg] iter:  0, prev_obj_val: 64.7831039428711, obj_val: 67.3878173828125, abs dis: 2.6047134399414062
[rfa agg] iter: 0, weight: tensor([0.1011, 0.0719, 0.0150, 0.0591, 0.0975, 0.1435, 0.0748, 0.1370, 0.1631,
        0.1371])
[rfa agg] iter:  1, prev_obj_val: 67.3878173828125, obj_val: 70.05101013183594, abs dis: 2.6631927490234375
[rfa agg] iter: 1, weight: tensor([0.1325, 0.0883, 0.0158, 0.0719, 0.1275, 0.1101, 0.0584, 0.0941, 0.2071,
        0.0944])
[rfa agg] iter:  2, prev_obj_val: 70.05101013183594, obj_val: 71.79634857177734, abs dis: 1.7453384399414062
[rfa agg] iter: 2, weight: tensor([0.1534, 0.1004, 0.0166, 0.0826, 0.1474, 0.0918, 0.0527, 0.0798, 0.1955,
        0.0800])
[rfa agg] iter:  3, prev_obj_val: 71.79634857177734, obj_val: 71.79072570800781, abs dis: 0.00562286376953125
[rfa agg] iter: 3, weight: tensor([0.1637, 0.1081, 0.0173, 0.0905, 0.1579, 0.0852, 0.0509, 0.0750, 0.1762,
        0.0751])
[rfa agg] iter:  4, prev_obj_val: 71.79072570800781, obj_val: 71.7906494140625, abs dis: 7.62939453125e-05
[rfa agg] iter: 4, weight: tensor([0.1647, 0.1085, 0.0173, 0.0908, 0.1597, 0.0848, 0.0508, 0.0748, 0.1735,
        0.0750])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.9821, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 6.7101, Accuracy: 0/9950 (0.0000%)
saving model
Done in 685.8661057949066 sec.
Server Epoch:73 choose agents : [74, 81, 71, 96, 73, 8, 10, 55, 33, 35].
poison local model 74 index 26 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   1, Avg loss: 0.0518, Accuracy: 737/1552 (47.4871%), train_poison_data_count: 976
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   2, Avg loss: 0.0237, Accuracy: 900/1552 (57.9897%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   3, Avg loss: 0.0204, Accuracy: 948/1552 (61.0825%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   4, Avg loss: 0.0199, Accuracy: 944/1552 (60.8247%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   5, Avg loss: 0.0194, Accuracy: 948/1552 (61.0825%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   6, Avg loss: 0.0196, Accuracy: 964/1552 (62.1134%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   7, Avg loss: 0.0191, Accuracy: 942/1552 (60.6959%), train_poison_data_count: 976
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   8, Avg loss: 0.0188, Accuracy: 975/1552 (62.8222%), train_poison_data_count: 976
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   9, Avg loss: 0.0183, Accuracy: 967/1552 (62.3067%), train_poison_data_count: 976
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch  10, Avg loss: 0.0188, Accuracy: 966/1552 (62.2423%), train_poison_data_count: 976
Global model norm: 306.06138324280636.
Norm before scaling: 305.97538708203314. Distance: 1.208991720889057
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.7033, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 73, Avg loss: 0.5225, Accuracy: 8811/9950 (88.5528%)
Scaling by  100
Scaled Norm after poisoning: 320.750048713948, distance: 120.89917028251269
Total norm for 5 adversaries is: 320.750048713948. distance: 120.89917028251269
_Test Local_ResNet_18 poisoned: True, epoch: 73, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0727, Accuracy: 159/774 (20.5426%)
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0400, Accuracy: 321/774 (41.4729%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.9382, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0783, Accuracy: 96/818 (11.7359%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0325, Accuracy: 360/818 (44.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.3841, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.0951, Accuracy: 0/311 (0.0000%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0646, Accuracy: 75/311 (24.1158%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.7786, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   1, Avg loss: 0.0632, Accuracy: 166/938 (17.6972%)
_Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   2, Avg loss: 0.0339, Accuracy: 335/938 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.5561, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   1, Avg loss: 0.0637, Accuracy: 185/1513 (12.2274%)
_Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   2, Avg loss: 0.0384, Accuracy: 426/1513 (28.1560%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.6173, Accuracy: 93/10000 (0.9300%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0731, Accuracy: 129/861 (14.9826%)
_Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0240, Accuracy: 399/861 (46.3415%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.9075, Accuracy: 87/10000 (0.8700%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   1, Avg loss: 0.0677, Accuracy: 193/1071 (18.0205%)
_Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   2, Avg loss: 0.0329, Accuracy: 503/1071 (46.9655%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.8016, Accuracy: 72/10000 (0.7200%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0861, Accuracy: 27/515 (5.2427%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0581, Accuracy: 159/515 (30.8738%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.5834, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   1, Avg loss: 0.1113, Accuracy: 2/271 (0.7380%)
_Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   2, Avg loss: 0.0759, Accuracy: 47/271 (17.3432%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.0123, Accuracy: 49/10000 (0.4900%)
time spent on training: 329.15928745269775
[rfa agg] training data poison_ratio: 0.5534554730983302  data num: [1552, 774, 818, 311, 938, 1513, 861, 1071, 515, 271]
[rfa agg] considering poison per batch poison_fraction: 0.3459096706864564
[rfa agg] init. name: [74, 81, 71, 96, 73, 8, 10, 55, 33, 35], weight: tensor([0.1800, 0.0897, 0.0949, 0.0361, 0.1088, 0.1754, 0.0998, 0.1242, 0.0597,
        0.0314])
[rfa agg] iter:  0, prev_obj_val: 33099.32421875, obj_val: 23466.3046875, abs dis: 9633.01953125
[rfa agg] iter: 0, weight: tensor([0.0459, 0.1043, 0.1102, 0.0418, 0.1265, 0.2049, 0.1161, 0.1446, 0.0693,
        0.0364])
[rfa agg] iter:  1, prev_obj_val: 23466.3046875, obj_val: 20918.701171875, abs dis: 2547.603515625
[rfa agg] iter: 1, weight: tensor([0.0104, 0.1078, 0.1140, 0.0427, 0.1312, 0.2149, 0.1202, 0.1503, 0.0713,
        0.0372])
[rfa agg] iter:  2, prev_obj_val: 20918.701171875, obj_val: 20335.787109375, abs dis: 582.9140625
[rfa agg] iter: 2, weight: tensor([0.0022, 0.1070, 0.1131, 0.0404, 0.1317, 0.2285, 0.1200, 0.1528, 0.0690,
        0.0352])
[rfa agg] iter:  3, prev_obj_val: 20335.787109375, obj_val: 20229.77734375, abs dis: 106.009765625
[rfa agg] iter: 3, weight: tensor([0.0004, 0.0953, 0.1009, 0.0296, 0.1246, 0.3044, 0.1100, 0.1536, 0.0554,
        0.0258])
[rfa agg] iter:  4, prev_obj_val: 20229.77734375, obj_val: 20225.689453125, abs dis: 4.087890625
[rfa agg] iter: 4, weight: tensor([1.0069e-04, 8.7942e-02, 9.5263e-02, 1.6706e-02, 1.4987e-01, 2.4490e-01,
        1.1561e-01, 2.3740e-01, 3.7657e-02, 1.4548e-02])
[rfa agg] iter:  5, prev_obj_val: 20225.689453125, obj_val: 20228.447265625, abs dis: 2.7578125
[rfa agg] iter: 5, weight: tensor([7.1058e-05, 1.0547e-01, 1.2023e-01, 1.5215e-02, 2.1181e-01, 1.0374e-01,
        1.5436e-01, 2.3839e-01, 3.7486e-02, 1.3241e-02])
[rfa agg] iter:  6, prev_obj_val: 20228.447265625, obj_val: 20229.888671875, abs dis: 1.44140625
[rfa agg] iter: 6, weight: tensor([6.5382e-05, 1.3587e-01, 1.6793e-01, 1.6703e-02, 2.0638e-01, 7.6759e-02,
        1.8830e-01, 1.4922e-01, 4.4245e-02, 1.4523e-02])
[rfa agg] iter:  7, prev_obj_val: 20229.888671875, obj_val: 20233.966796875, abs dis: 4.078125
[rfa agg] iter: 7, weight: tensor([6.5357e-05, 1.4779e-01, 1.8909e-01, 1.7545e-02, 1.8696e-01, 7.3214e-02,
        1.9222e-01, 1.3017e-01, 4.7685e-02, 1.5248e-02])
[rfa agg] iter:  8, prev_obj_val: 20233.966796875, obj_val: 20231.755859375, abs dis: 2.2109375
[rfa agg] iter: 8, weight: tensor([7.0702e-05, 1.6207e-01, 2.1005e-01, 2.1014e-02, 1.5967e-01, 7.2740e-02,
        1.7904e-01, 1.1744e-01, 5.9651e-02, 1.8250e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.9316, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 6.6232, Accuracy: 0/9950 (0.0000%)
saving model
Done in 765.8231565952301 sec.
Server Epoch:74 choose agents : [50, 33, 10, 20, 28, 37, 46, 27, 93, 60].
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0651, Accuracy: 123/809 (15.2040%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0292, Accuracy: 328/809 (40.5439%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.5326, Accuracy: 89/10000 (0.8900%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   1, Avg loss: 0.0871, Accuracy: 29/515 (5.6311%)
_Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   2, Avg loss: 0.0547, Accuracy: 133/515 (25.8252%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.3417, Accuracy: 51/10000 (0.5100%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   1, Avg loss: 0.0684, Accuracy: 139/861 (16.1440%)
_Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   2, Avg loss: 0.0230, Accuracy: 404/861 (46.9222%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 11.1779, Accuracy: 87/10000 (0.8700%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   1, Avg loss: 0.0670, Accuracy: 227/807 (28.1289%)
_Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   2, Avg loss: 0.0396, Accuracy: 407/807 (50.4337%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.3715, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0699, Accuracy: 308/1581 (19.4813%)
_Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0382, Accuracy: 488/1581 (30.8665%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.4679, Accuracy: 73/10000 (0.7300%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0498, Accuracy: 373/1129 (33.0381%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0261, Accuracy: 668/1129 (59.1674%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.6452, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   1, Avg loss: 0.0567, Accuracy: 376/1904 (19.7479%)
_Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   2, Avg loss: 0.0337, Accuracy: 660/1904 (34.6639%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.2192, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   1, Avg loss: 0.0653, Accuracy: 315/1587 (19.8488%)
_Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   2, Avg loss: 0.0364, Accuracy: 527/1587 (33.2073%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.4125, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0638, Accuracy: 355/1742 (20.3789%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0337, Accuracy: 661/1742 (37.9449%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.9900, Accuracy: 81/10000 (0.8100%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   1, Avg loss: 0.0592, Accuracy: 491/2227 (22.0476%)
_Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   2, Avg loss: 0.0303, Accuracy: 955/2227 (42.8828%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.0366, Accuracy: 113/10000 (1.1300%)
time spent on training: 296.63485980033875
[rfa agg] training data poison_ratio: 0.4208327001975384  data num: [809, 515, 861, 807, 1581, 1129, 1904, 1587, 1742, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.2630204376234615
[rfa agg] init. name: [50, 33, 10, 20, 28, 37, 46, 27, 93, 60], weight: tensor([0.0615, 0.0391, 0.0654, 0.0613, 0.1201, 0.0858, 0.1447, 0.1206, 0.1324,
        0.1692])
[rfa agg] iter:  0, prev_obj_val: 73.32160949707031, obj_val: 73.08528900146484, abs dis: 0.23632049560546875
[rfa agg] iter: 0, weight: tensor([0.0454, 0.0201, 0.0531, 0.0447, 0.1889, 0.1150, 0.1155, 0.1969, 0.1341,
        0.0863])
[rfa agg] iter:  1, prev_obj_val: 73.08528900146484, obj_val: 73.08447265625, abs dis: 0.00081634521484375
[rfa agg] iter: 1, weight: tensor([0.0443, 0.0197, 0.0517, 0.0436, 0.1950, 0.1149, 0.1123, 0.2024, 0.1323,
        0.0836])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.8843, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.9586, Accuracy: 0/9950 (0.0000%)
saving model
Done in 738.2034938335419 sec.
Server Epoch:75 choose agents : [78, 51, 85, 6, 92, 32, 29, 40, 95, 74].
poison local model 78 index 27 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   1, Avg loss: 0.0732, Accuracy: 76/416 (18.2692%), train_poison_data_count: 272
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   2, Avg loss: 0.0428, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   3, Avg loss: 0.0438, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   4, Avg loss: 0.0421, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   5, Avg loss: 0.0367, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   6, Avg loss: 0.0335, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   7, Avg loss: 0.0313, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   8, Avg loss: 0.0286, Accuracy: 270/416 (64.9038%), train_poison_data_count: 272
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   9, Avg loss: 0.0287, Accuracy: 265/416 (63.7019%), train_poison_data_count: 272
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch  10, Avg loss: 0.0280, Accuracy: 270/416 (64.9038%), train_poison_data_count: 272
Global model norm: 309.72536978345835.
Norm before scaling: 309.70805305157955. Distance: 0.5792579375420019
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.7198, Accuracy: 48/10000 (0.4800%)
_Test Local_ResNet_18 poisoned: True, epoch: 75, Avg loss: 0.4091, Accuracy: 9676/9950 (97.2462%)
Scaling by  100
Scaled Norm after poisoning: 313.3338749441241, distance: 57.92579060139685
Total norm for 4 adversaries is: 313.3338749441241. distance: 57.92579060139685
_Test Local_ResNet_18 poisoned: True, epoch: 75, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   1, Avg loss: 0.0645, Accuracy: 231/1049 (22.0210%)
_Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   2, Avg loss: 0.0314, Accuracy: 491/1049 (46.8065%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.1220, Accuracy: 91/10000 (0.9100%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0686, Accuracy: 351/1988 (17.6559%)
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0389, Accuracy: 595/1988 (29.9296%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.9161, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   1, Avg loss: 0.0632, Accuracy: 360/1956 (18.4049%)
_Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   2, Avg loss: 0.0340, Accuracy: 612/1956 (31.2883%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.7792, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   1, Avg loss: 0.0611, Accuracy: 384/1715 (22.3907%)
_Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   2, Avg loss: 0.0341, Accuracy: 655/1715 (38.1924%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.6425, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   1, Avg loss: 0.0614, Accuracy: 136/735 (18.5034%)
_Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 382/735 (51.9728%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 12.2643, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   1, Avg loss: 0.0616, Accuracy: 330/1440 (22.9167%)
_Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   2, Avg loss: 0.0298, Accuracy: 642/1440 (44.5833%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.5008, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0577, Accuracy: 303/1573 (19.2626%)
_Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0369, Accuracy: 511/1573 (32.4857%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.6687, Accuracy: 90/10000 (0.9000%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   1, Avg loss: 0.0788, Accuracy: 167/599 (27.8798%)
_Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   2, Avg loss: 0.0334, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 14.6588, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0593, Accuracy: 363/1552 (23.3892%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0238, Accuracy: 687/1552 (44.2655%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.5889, Accuracy: 73/10000 (0.7300%)
time spent on training: 360.74167919158936
[rfa agg] training data poison_ratio: 0.3497657989710512  data num: [416, 1049, 1988, 1956, 1715, 735, 1440, 1573, 599, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.218603624356907
[rfa agg] init. name: [78, 51, 85, 6, 92, 32, 29, 40, 95, 74], weight: tensor([0.0319, 0.0805, 0.1527, 0.1502, 0.1317, 0.0564, 0.1106, 0.1208, 0.0460,
        0.1192])
[rfa agg] iter:  0, prev_obj_val: 2008.2923583984375, obj_val: 1103.9697265625, abs dis: 904.3226318359375
[rfa agg] iter: 0, weight: tensor([0.0011, 0.0777, 0.1669, 0.1628, 0.1379, 0.0524, 0.1121, 0.1244, 0.0420,
        0.1227])
[rfa agg] iter:  1, prev_obj_val: 1103.9697265625, obj_val: 1105.85107421875, abs dis: 1.88134765625
[rfa agg] iter: 1, weight: tensor([4.9271e-05, 4.1011e-02, 1.3686e-01, 1.5876e-01, 1.8161e-01, 2.0777e-02,
        1.1849e-01, 1.7496e-01, 1.4913e-02, 1.5257e-01])
[rfa agg] iter:  2, prev_obj_val: 1105.85107421875, obj_val: 1108.9281005859375, abs dis: 3.0770263671875
[rfa agg] iter: 2, weight: tensor([4.8853e-05, 5.5965e-02, 9.1671e-02, 1.0180e-01, 1.4387e-01, 2.6777e-02,
        1.9065e-01, 2.0224e-01, 1.8514e-02, 1.6847e-01])
[rfa agg] iter:  3, prev_obj_val: 1108.9281005859375, obj_val: 1107.1771240234375, abs dis: 1.7509765625
[rfa agg] iter: 3, weight: tensor([5.1446e-05, 6.5803e-02, 8.7152e-02, 9.5613e-02, 1.3013e-01, 3.0769e-02,
        2.1760e-01, 1.8918e-01, 2.0991e-02, 1.6271e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 13.4113, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 17.4598, Accuracy: 0/9950 (0.0000%)
saving model
Done in 805.6068243980408 sec.
Server Epoch:76 choose agents : [6, 5, 30, 19, 88, 49, 14, 57, 85, 92].
_Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   1, Avg loss: 0.0621, Accuracy: 364/1956 (18.6094%)
_Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   2, Avg loss: 0.0344, Accuracy: 606/1956 (30.9816%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.9390, Accuracy: 96/10000 (0.9600%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0632, Accuracy: 294/1628 (18.0590%)
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0291, Accuracy: 694/1628 (42.6290%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.6575, Accuracy: 141/10000 (1.4100%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   1, Avg loss: 0.0959, Accuracy: 10/486 (2.0576%)
_Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   2, Avg loss: 0.0493, Accuracy: 201/486 (41.3580%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.0991, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   1, Avg loss: 0.0461, Accuracy: 351/1036 (33.8803%)
_Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   2, Avg loss: 0.0255, Accuracy: 615/1036 (59.3629%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 12.4422, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0812, Accuracy: 113/603 (18.7396%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0537, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.4064, Accuracy: 62/10000 (0.6200%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   1, Avg loss: 0.1013, Accuracy: 4/440 (0.9091%)
_Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   2, Avg loss: 0.0633, Accuracy: 85/440 (19.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.0537, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0765, Accuracy: 116/1013 (11.4511%)
_Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0397, Accuracy: 330/1013 (32.5765%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.7647, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   1, Avg loss: 0.0646, Accuracy: 208/1154 (18.0243%)
_Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   2, Avg loss: 0.0290, Accuracy: 435/1154 (37.6950%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 12.5940, Accuracy: 61/10000 (0.6100%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   1, Avg loss: 0.0680, Accuracy: 334/1988 (16.8008%)
_Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   2, Avg loss: 0.0393, Accuracy: 533/1988 (26.8109%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.8550, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0613, Accuracy: 367/1715 (21.3994%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0334, Accuracy: 667/1715 (38.8921%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.8539, Accuracy: 86/10000 (0.8600%)
time spent on training: 277.07495617866516
[rfa agg] training data poison_ratio: 0.3779016557117897  data num: [1956, 1628, 486, 1036, 603, 440, 1013, 1154, 1988, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.23618853481986857
[rfa agg] init. name: [6, 5, 30, 19, 88, 49, 14, 57, 85, 92], weight: tensor([0.1627, 0.1355, 0.0404, 0.0862, 0.0502, 0.0366, 0.0843, 0.0960, 0.1654,
        0.1427])
[rfa agg] iter:  0, prev_obj_val: 76.88528442382812, obj_val: 77.78765106201172, abs dis: 0.9023666381835938
[rfa agg] iter: 0, weight: tensor([0.1158, 0.1672, 0.0228, 0.1263, 0.0335, 0.0192, 0.1065, 0.1542, 0.1040,
        0.1504])
[rfa agg] iter:  1, prev_obj_val: 77.78765106201172, obj_val: 78.95045471191406, abs dis: 1.1628036499023438
[rfa agg] iter: 1, weight: tensor([0.1086, 0.1562, 0.0234, 0.1385, 0.0344, 0.0196, 0.1137, 0.1674, 0.0975,
        0.1408])
[rfa agg] iter:  2, prev_obj_val: 78.95045471191406, obj_val: 80.22419738769531, abs dis: 1.27374267578125
[rfa agg] iter: 2, weight: tensor([0.1032, 0.1448, 0.0241, 0.1503, 0.0358, 0.0202, 0.1219, 0.1749, 0.0932,
        0.1317])
[rfa agg] iter:  3, prev_obj_val: 80.22419738769531, obj_val: 81.61842346191406, abs dis: 1.39422607421875
[rfa agg] iter: 3, weight: tensor([0.0981, 0.1343, 0.0248, 0.1630, 0.0371, 0.0207, 0.1308, 0.1790, 0.0890,
        0.1233])
[rfa agg] iter:  4, prev_obj_val: 81.61842346191406, obj_val: 81.614501953125, abs dis: 0.0039215087890625
[rfa agg] iter: 4, weight: tensor([0.0931, 0.1248, 0.0255, 0.1767, 0.0385, 0.0212, 0.1404, 0.1793, 0.0849,
        0.1155])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 17.2684, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 21.0467, Accuracy: 0/9950 (0.0000%)
saving model
Done in 718.1405236721039 sec.
Server Epoch:77 choose agents : [81, 75, 66, 1, 61, 65, 79, 49, 94, 10].
poison local model 81 index 28 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   1, Avg loss: 0.0543, Accuracy: 309/774 (39.9225%), train_poison_data_count: 486
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   2, Avg loss: 0.0356, Accuracy: 429/774 (55.4264%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   3, Avg loss: 0.0280, Accuracy: 390/774 (50.3876%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   4, Avg loss: 0.0280, Accuracy: 462/774 (59.6899%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   5, Avg loss: 0.0256, Accuracy: 479/774 (61.8863%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   6, Avg loss: 0.0256, Accuracy: 472/774 (60.9819%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   7, Avg loss: 0.0251, Accuracy: 463/774 (59.8191%), train_poison_data_count: 486
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   8, Avg loss: 0.0242, Accuracy: 470/774 (60.7235%), train_poison_data_count: 486
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   9, Avg loss: 0.0256, Accuracy: 465/774 (60.0775%), train_poison_data_count: 486
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch  10, Avg loss: 0.0246, Accuracy: 466/774 (60.2067%), train_poison_data_count: 486
Global model norm: 313.3586952280086.
Norm before scaling: 313.3187524311304. Distance: 0.7725892472794984
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.6391, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 77, Avg loss: 0.5901, Accuracy: 8275/9950 (83.1658%)
Scaling by  100
Scaled Norm after poisoning: 318.7479411698215, distance: 77.25892444404077
Total norm for 5 adversaries is: 318.7479411698215. distance: 77.25892444404077
_Test Local_ResNet_18 poisoned: True, epoch: 77, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   1, Avg loss: 0.0823, Accuracy: 161/776 (20.7474%)
_Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   2, Avg loss: 0.0340, Accuracy: 384/776 (49.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.4071, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0711, Accuracy: 163/1402 (11.6262%)
_Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0419, Accuracy: 342/1402 (24.3937%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.5522, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 258/928 (27.8017%)
_Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   2, Avg loss: 0.0258, Accuracy: 530/928 (57.1121%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.5978, Accuracy: 105/10000 (1.0500%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1546, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1406, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.2950, Accuracy: 46/10000 (0.4600%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   1, Avg loss: 0.0621, Accuracy: 344/1475 (23.3220%)
_Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 645/1475 (43.7288%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.5451, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   1, Avg loss: 0.1336, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   2, Avg loss: 0.1141, Accuracy: 3/197 (1.5228%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.0652, Accuracy: 50/10000 (0.5000%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.1018, Accuracy: 4/440 (0.9091%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0617, Accuracy: 92/440 (20.9091%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.0148, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0648, Accuracy: 257/1662 (15.4633%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0370, Accuracy: 523/1662 (31.4681%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.2637, Accuracy: 98/10000 (0.9800%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   1, Avg loss: 0.0694, Accuracy: 161/861 (18.6992%)
_Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   2, Avg loss: 0.0235, Accuracy: 388/861 (45.0639%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 11.2197, Accuracy: 87/10000 (0.8700%)
time spent on training: 328.85173296928406
[rfa agg] training data poison_ratio: 0.42267441860465116  data num: [774, 776, 1402, 928, 85, 1475, 197, 440, 1662, 861]
[rfa agg] considering poison per batch poison_fraction: 0.264171511627907
[rfa agg] init. name: [81, 75, 66, 1, 61, 65, 79, 49, 94, 10], weight: tensor([0.0900, 0.0902, 0.1630, 0.1079, 0.0099, 0.1715, 0.0229, 0.0512, 0.1933,
        0.1001])
[rfa agg] iter:  0, prev_obj_val: 9643.1455078125, obj_val: 5759.02734375, abs dis: 3884.1181640625
[rfa agg] iter: 0, weight: tensor([0.0097, 0.0972, 0.1783, 0.1166, 0.0104, 0.1882, 0.0243, 0.0545, 0.2128,
        0.1080])
[rfa agg] iter:  1, prev_obj_val: 5759.02734375, obj_val: 5359.1513671875, abs dis: 399.8759765625
[rfa agg] iter: 1, weight: tensor([0.0009, 0.0894, 0.1859, 0.1102, 0.0083, 0.2023, 0.0199, 0.0465, 0.2360,
        0.1007])
[rfa agg] iter:  2, prev_obj_val: 5359.1513671875, obj_val: 5356.84326171875, abs dis: 2.30810546875
[rfa agg] iter: 2, weight: tensor([7.6311e-05, 4.3882e-02, 2.3788e-01, 6.2815e-02, 2.3432e-03, 2.7364e-01,
        6.1359e-03, 1.6383e-02, 3.0331e-01, 5.3535e-02])
[rfa agg] iter:  3, prev_obj_val: 5356.84326171875, obj_val: 5357.86865234375, abs dis: 1.025390625
[rfa agg] iter: 3, weight: tensor([8.5104e-05, 6.8534e-02, 2.8608e-01, 1.0343e-01, 3.0695e-03, 2.2457e-01,
        8.2165e-03, 2.2881e-02, 1.9612e-01, 8.7017e-02])
[rfa agg] iter:  4, prev_obj_val: 5357.86865234375, obj_val: 5358.6455078125, abs dis: 0.77685546875
[rfa agg] iter: 4, weight: tensor([8.8589e-05, 8.1102e-02, 2.7894e-01, 1.2616e-01, 3.3568e-03, 1.9648e-01,
        9.0731e-03, 2.5664e-02, 1.7421e-01, 1.0493e-01])
[rfa agg] iter:  5, prev_obj_val: 5358.6455078125, obj_val: 5359.53271484375, abs dis: 0.88720703125
[rfa agg] iter: 5, weight: tensor([9.0400e-05, 8.8639e-02, 2.6243e-01, 1.4050e-01, 3.5132e-03, 1.8519e-01,
        9.5458e-03, 2.7232e-02, 1.6674e-01, 1.1612e-01])
[rfa agg] iter:  6, prev_obj_val: 5359.53271484375, obj_val: 5360.50732421875, abs dis: 0.974609375
[rfa agg] iter: 6, weight: tensor([9.1669e-05, 9.6430e-02, 2.4253e-01, 1.5557e-01, 3.6540e-03, 1.7541e-01,
        9.9828e-03, 2.8743e-02, 1.5951e-01, 1.2808e-01])
[rfa agg] iter:  7, prev_obj_val: 5360.50732421875, obj_val: 5362.74658203125, abs dis: 2.2392578125
[rfa agg] iter: 7, weight: tensor([9.2070e-05, 1.0430e-01, 2.2250e-01, 1.7144e-01, 3.7662e-03, 1.6515e-01,
        1.0349e-02, 3.0094e-02, 1.5155e-01, 1.4076e-01])
[rfa agg] iter:  8, prev_obj_val: 5362.74658203125, obj_val: 5362.7158203125, abs dis: 0.03076171875
[rfa agg] iter: 8, weight: tensor([9.0457e-05, 1.1989e-01, 1.8599e-01, 2.0148e-01, 3.9011e-03, 1.4400e-01,
        1.0855e-02, 3.2277e-02, 1.3423e-01, 1.6730e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 13.3777, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 18.0402, Accuracy: 0/9950 (0.0000%)
saving model
Done in 770.9370086193085 sec.
Server Epoch:78 choose agents : [42, 6, 82, 30, 19, 31, 93, 7, 5, 16].
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   1, Avg loss: 0.0660, Accuracy: 208/1372 (15.1603%)
_Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   2, Avg loss: 0.0339, Accuracy: 467/1372 (34.0379%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.1452, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   1, Avg loss: 0.0613, Accuracy: 356/1956 (18.2004%)
_Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   2, Avg loss: 0.0337, Accuracy: 594/1956 (30.3681%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.0385, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   1, Avg loss: 0.0868, Accuracy: 14/500 (2.8000%)
_Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   2, Avg loss: 0.0522, Accuracy: 180/500 (36.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.5975, Accuracy: 57/10000 (0.5700%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0922, Accuracy: 20/486 (4.1152%)
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0462, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.4727, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   1, Avg loss: 0.0473, Accuracy: 342/1036 (33.0116%)
_Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   2, Avg loss: 0.0263, Accuracy: 600/1036 (57.9151%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 13.2071, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   1, Avg loss: 0.0889, Accuracy: 14/460 (3.0435%)
_Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   2, Avg loss: 0.0427, Accuracy: 183/460 (39.7826%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.2638, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   1, Avg loss: 0.0645, Accuracy: 333/1742 (19.1160%)
_Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   2, Avg loss: 0.0333, Accuracy: 658/1742 (37.7727%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.4282, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   1, Avg loss: 0.0618, Accuracy: 261/891 (29.2929%)
_Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   2, Avg loss: 0.0291, Accuracy: 432/891 (48.4848%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.6121, Accuracy: 57/10000 (0.5700%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   1, Avg loss: 0.0633, Accuracy: 258/1628 (15.8477%)
_Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   2, Avg loss: 0.0290, Accuracy: 707/1628 (43.4275%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.0041, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   1, Avg loss: 0.0711, Accuracy: 196/708 (27.6836%)
_Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   2, Avg loss: 0.0388, Accuracy: 424/708 (59.8870%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.2660, Accuracy: 59/10000 (0.5900%)
time spent on training: 254.40562462806702
[rfa agg] training data poison_ratio: 0.32340662399109377  data num: [1372, 1956, 500, 486, 1036, 460, 1742, 891, 1628, 708]
[rfa agg] considering poison per batch poison_fraction: 0.2021291399944336
[rfa agg] init. name: [42, 6, 82, 30, 19, 31, 93, 7, 5, 16], weight: tensor([0.1273, 0.1815, 0.0464, 0.0451, 0.0961, 0.0427, 0.1616, 0.0827, 0.1510,
        0.0657])
[rfa agg] iter:  0, prev_obj_val: 75.32862854003906, obj_val: 76.27457427978516, abs dis: 0.9459457397460938
[rfa agg] iter: 0, weight: tensor([0.2046, 0.1048, 0.0293, 0.0284, 0.1803, 0.0268, 0.1214, 0.1043, 0.1402,
        0.0599])
[rfa agg] iter:  1, prev_obj_val: 76.27457427978516, obj_val: 77.47793579101562, abs dis: 1.2033615112304688
[rfa agg] iter: 1, weight: tensor([0.1940, 0.0987, 0.0301, 0.0291, 0.2032, 0.0275, 0.1135, 0.1116, 0.1300,
        0.0624])
[rfa agg] iter:  2, prev_obj_val: 77.47793579101562, obj_val: 78.78844451904297, abs dis: 1.3105087280273438
[rfa agg] iter: 2, weight: tensor([0.1773, 0.0947, 0.0314, 0.0303, 0.2204, 0.0286, 0.1078, 0.1211, 0.1224,
        0.0660])
[rfa agg] iter:  3, prev_obj_val: 78.78844451904297, obj_val: 81.78410339355469, abs dis: 2.9956588745117188
[rfa agg] iter: 3, weight: tensor([0.1619, 0.0908, 0.0327, 0.0315, 0.2337, 0.0298, 0.1025, 0.1320, 0.1153,
        0.0698])
[rfa agg] iter:  4, prev_obj_val: 81.78410339355469, obj_val: 80.21684265136719, abs dis: 1.5672607421875
[rfa agg] iter: 4, weight: tensor([0.1389, 0.0844, 0.0360, 0.0347, 0.2368, 0.0327, 0.0938, 0.1593, 0.1040,
        0.0794])
[rfa agg] iter:  5, prev_obj_val: 80.21684265136719, obj_val: 80.21438598632812, abs dis: 0.0024566650390625
[rfa agg] iter: 5, weight: tensor([0.1473, 0.0869, 0.0341, 0.0329, 0.2413, 0.0310, 0.0973, 0.1463, 0.1085,
        0.0743])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.8619, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 6.4515, Accuracy: 0/9950 (0.0000%)
saving model
Done in 693.2959260940552 sec.
Server Epoch:79 choose agents : [84, 82, 36, 58, 27, 49, 61, 52, 90, 85].
poison local model 84 index 29 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   1, Avg loss: 0.0560, Accuracy: 555/1190 (46.6387%), train_poison_data_count: 758
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   2, Avg loss: 0.0294, Accuracy: 679/1190 (57.0588%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   3, Avg loss: 0.0256, Accuracy: 755/1190 (63.4454%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   4, Avg loss: 0.0257, Accuracy: 720/1190 (60.5042%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   5, Avg loss: 0.0252, Accuracy: 722/1190 (60.6723%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   6, Avg loss: 0.0250, Accuracy: 727/1190 (61.0924%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   7, Avg loss: 0.0246, Accuracy: 723/1190 (60.7563%), train_poison_data_count: 758
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   8, Avg loss: 0.0241, Accuracy: 720/1190 (60.5042%), train_poison_data_count: 758
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   9, Avg loss: 0.0237, Accuracy: 727/1190 (61.0924%), train_poison_data_count: 758
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch  10, Avg loss: 0.0238, Accuracy: 708/1190 (59.4958%), train_poison_data_count: 758
Global model norm: 316.93234195171686.
Norm before scaling: 316.8674432037788. Distance: 0.9624756388863442
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.3105, Accuracy: 58/10000 (0.5800%)
_Test Local_ResNet_18 poisoned: True, epoch: 79, Avg loss: 0.5497, Accuracy: 9119/9950 (91.6482%)
Scaling by  100
Scaled Norm after poisoning: 324.81254209158857, distance: 96.24756490426134
Total norm for 5 adversaries is: 324.81254209158857. distance: 96.24756490426134
_Test Local_ResNet_18 poisoned: True, epoch: 79, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   1, Avg loss: 0.0864, Accuracy: 19/500 (3.8000%)
_Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   2, Avg loss: 0.0526, Accuracy: 185/500 (37.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.9553, Accuracy: 63/10000 (0.6300%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   1, Avg loss: 0.1081, Accuracy: 0/408 (0.0000%)
_Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   2, Avg loss: 0.0648, Accuracy: 113/408 (27.6961%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.7208, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   1, Avg loss: 0.0628, Accuracy: 266/803 (33.1258%)
_Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   2, Avg loss: 0.0374, Accuracy: 435/803 (54.1719%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.7034, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0671, Accuracy: 297/1587 (18.7146%)
_Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0374, Accuracy: 511/1587 (32.1991%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.3636, Accuracy: 63/10000 (0.6300%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   1, Avg loss: 0.1029, Accuracy: 2/440 (0.4545%)
_Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   2, Avg loss: 0.0630, Accuracy: 96/440 (21.8182%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.8476, Accuracy: 64/10000 (0.6400%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   1, Avg loss: 0.1425, Accuracy: 2/85 (2.3529%)
_Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   2, Avg loss: 0.1435, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 11.1791, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0641, Accuracy: 229/636 (36.0063%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0395, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 10.2806, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   1, Avg loss: 0.0627, Accuracy: 195/677 (28.8035%)
_Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 454/677 (67.0606%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 12.4882, Accuracy: 60/10000 (0.6000%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0668, Accuracy: 333/1988 (16.7505%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0395, Accuracy: 581/1988 (29.2254%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.6409, Accuracy: 82/10000 (0.8200%)
time spent on training: 327.9874608516693
[rfa agg] training data poison_ratio: 0.49446716382006256  data num: [1190, 500, 408, 803, 1587, 440, 85, 636, 677, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.3090419773875391
[rfa agg] init. name: [84, 82, 36, 58, 27, 49, 61, 52, 90, 85], weight: tensor([0.1431, 0.0601, 0.0491, 0.0966, 0.1909, 0.0529, 0.0102, 0.0765, 0.0814,
        0.2391])
[rfa agg] iter:  0, prev_obj_val: 20938.94921875, obj_val: 13863.9345703125, abs dis: 7075.0146484375
[rfa agg] iter: 0, weight: tensor([0.0271, 0.0677, 0.0552, 0.1092, 0.2176, 0.0595, 0.0115, 0.0863, 0.0919,
        0.2740])
[rfa agg] iter:  1, prev_obj_val: 13863.9345703125, obj_val: 12494.7685546875, abs dis: 1369.166015625
[rfa agg] iter: 1, weight: tensor([0.0046, 0.0668, 0.0543, 0.1094, 0.2265, 0.0585, 0.0111, 0.0856, 0.0915,
        0.2918])
[rfa agg] iter:  2, prev_obj_val: 12494.7685546875, obj_val: 12304.4267578125, abs dis: 190.341796875
[rfa agg] iter: 2, weight: tensor([0.0007, 0.0519, 0.0415, 0.0921, 0.2426, 0.0448, 0.0078, 0.0686, 0.0745,
        0.3755])
[rfa agg] iter:  3, prev_obj_val: 12304.4267578125, obj_val: 12302.48828125, abs dis: 1.9384765625
[rfa agg] iter: 3, weight: tensor([1.2619e-04, 2.6919e-02, 2.0782e-02, 5.8739e-02, 4.6842e-01, 2.2434e-02,
        3.3452e-03, 3.8101e-02, 4.3266e-02, 3.1787e-01])
[rfa agg] iter:  4, prev_obj_val: 12302.48828125, obj_val: 12303.1767578125, abs dis: 0.6884765625
[rfa agg] iter: 4, weight: tensor([1.2578e-04, 3.2881e-02, 2.5061e-02, 7.7470e-02, 5.2430e-01, 2.7079e-02,
        3.8473e-03, 4.7554e-02, 5.4907e-02, 2.0677e-01])
[rfa agg] iter:  5, prev_obj_val: 12303.1767578125, obj_val: 12304.240234375, abs dis: 1.0634765625
[rfa agg] iter: 5, weight: tensor([1.3514e-04, 3.7824e-02, 2.8686e-02, 9.2051e-02, 4.8779e-01, 3.1010e-02,
        4.3248e-03, 5.5200e-02, 6.4186e-02, 1.9879e-01])
[rfa agg] iter:  6, prev_obj_val: 12304.240234375, obj_val: 12306.005859375, abs dis: 1.765625
[rfa agg] iter: 6, weight: tensor([1.4816e-04, 4.4575e-02, 3.3626e-02, 1.1260e-01, 4.2418e-01, 3.6358e-02,
        4.9662e-03, 6.5692e-02, 7.7041e-02, 2.0081e-01])
[rfa agg] iter:  7, prev_obj_val: 12306.005859375, obj_val: 12306.5859375, abs dis: 0.580078125
[rfa agg] iter: 7, weight: tensor([1.5866e-04, 5.3738e-02, 4.0151e-02, 1.4549e-01, 3.4235e-01, 4.3432e-02,
        5.7204e-03, 8.0569e-02, 9.6028e-02, 1.9236e-01])
[rfa agg] iter:  8, prev_obj_val: 12306.5859375, obj_val: 12307.8876953125, abs dis: 1.3017578125
[rfa agg] iter: 8, weight: tensor([1.5984e-04, 5.6655e-02, 4.2182e-02, 1.5863e-01, 3.1526e-01, 4.5629e-02,
        5.9238e-03, 8.5578e-02, 1.0286e-01, 1.8712e-01])
[rfa agg] iter:  9, prev_obj_val: 12307.8876953125, obj_val: 12309.25, abs dis: 1.3623046875
[rfa agg] iter: 9, weight: tensor([1.5831e-04, 6.1452e-02, 4.5369e-02, 1.8371e-01, 2.7169e-01, 4.9099e-02,
        6.1827e-03, 9.4183e-02, 1.1500e-01, 1.7316e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 18.9145, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 25.5728, Accuracy: 0/9950 (0.0000%)
saving model
Done in 776.2848975658417 sec.
Server Epoch:80 choose agents : [46, 75, 54, 3, 89, 69, 41, 1, 93, 71].
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0587, Accuracy: 368/1904 (19.3277%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0340, Accuracy: 638/1904 (33.5084%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.3331, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0787, Accuracy: 156/776 (20.1031%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0350, Accuracy: 390/776 (50.2577%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.4095, Accuracy: 68/10000 (0.6800%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   1, Avg loss: 0.0634, Accuracy: 279/1130 (24.6903%)
_Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   2, Avg loss: 0.0320, Accuracy: 459/1130 (40.6195%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.8844, Accuracy: 53/10000 (0.5300%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   1, Avg loss: 0.0803, Accuracy: 63/781 (8.0666%)
_Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   2, Avg loss: 0.0377, Accuracy: 257/781 (32.9065%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.7449, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0672, Accuracy: 313/896 (34.9330%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0379, Accuracy: 455/896 (50.7812%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.0937, Accuracy: 73/10000 (0.7300%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   1, Avg loss: 0.0581, Accuracy: 212/590 (35.9322%)
_Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   2, Avg loss: 0.0334, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 12.8974, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   1, Avg loss: 0.0833, Accuracy: 153/719 (21.2796%)
_Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   2, Avg loss: 0.0390, Accuracy: 467/719 (64.9513%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.1797, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   1, Avg loss: 0.0546, Accuracy: 270/928 (29.0948%)
_Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   2, Avg loss: 0.0266, Accuracy: 554/928 (59.6983%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.8705, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   1, Avg loss: 0.0626, Accuracy: 353/1742 (20.2641%)
_Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   2, Avg loss: 0.0333, Accuracy: 658/1742 (37.7727%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.0114, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   1, Avg loss: 0.0755, Accuracy: 108/818 (13.2029%)
_Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   2, Avg loss: 0.0327, Accuracy: 347/818 (42.4205%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.4205, Accuracy: 63/10000 (0.6300%)
time spent on training: 249.92726063728333
[rfa agg] training data poison_ratio: 0.24319330999611047  data num: [1904, 776, 1130, 781, 896, 590, 719, 928, 1742, 818]
[rfa agg] considering poison per batch poison_fraction: 0.15199581874756904
[rfa agg] init. name: [46, 75, 54, 3, 89, 69, 41, 1, 93, 71], weight: tensor([0.1851, 0.0755, 0.1099, 0.0759, 0.0871, 0.0574, 0.0699, 0.0902, 0.1694,
        0.0795])
[rfa agg] iter:  0, prev_obj_val: 66.88040924072266, obj_val: 70.91771697998047, abs dis: 4.0373077392578125
[rfa agg] iter: 0, weight: tensor([0.0738, 0.0929, 0.1894, 0.0961, 0.1265, 0.0455, 0.0705, 0.1255, 0.0789,
        0.1008])
[rfa agg] iter:  1, prev_obj_val: 70.91771697998047, obj_val: 74.80138397216797, abs dis: 3.8836669921875
[rfa agg] iter: 1, weight: tensor([0.0495, 0.1230, 0.0967, 0.1346, 0.1417, 0.0596, 0.0926, 0.1094, 0.0515,
        0.1415])
[rfa agg] iter:  2, prev_obj_val: 74.80138397216797, obj_val: 80.20060729980469, abs dis: 5.399223327636719
[rfa agg] iter: 2, weight: tensor([0.0469, 0.1287, 0.0813, 0.1434, 0.1277, 0.0732, 0.1049, 0.0969, 0.0484,
        0.1487])
[rfa agg] iter:  3, prev_obj_val: 80.20060729980469, obj_val: 80.19178009033203, abs dis: 0.00882720947265625
[rfa agg] iter: 3, weight: tensor([0.0486, 0.1253, 0.0772, 0.1361, 0.1161, 0.0977, 0.1165, 0.0911, 0.0499,
        0.1417])
[rfa agg] iter:  4, prev_obj_val: 80.19178009033203, obj_val: 80.19166564941406, abs dis: 0.00011444091796875
[rfa agg] iter: 4, weight: tensor([0.0485, 0.1249, 0.0771, 0.1349, 0.1153, 0.0997, 0.1184, 0.0905, 0.0498,
        0.1408])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 12.5863, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 17.7348, Accuracy: 0/9950 (0.0000%)
saving model
Done in 693.5680842399597 sec.
Server Epoch:81 choose agents : [85, 15, 81, 53, 39, 54, 28, 61, 0, 51].
poison local model 85 index 30 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   1, Avg loss: 0.0514, Accuracy: 992/1988 (49.8994%), train_poison_data_count: 1244
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   2, Avg loss: 0.0296, Accuracy: 1182/1988 (59.4567%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   3, Avg loss: 0.0269, Accuracy: 1206/1988 (60.6640%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   4, Avg loss: 0.0266, Accuracy: 1187/1988 (59.7082%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   5, Avg loss: 0.0263, Accuracy: 1203/1988 (60.5131%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   6, Avg loss: 0.0262, Accuracy: 1199/1988 (60.3119%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   7, Avg loss: 0.0258, Accuracy: 1187/1988 (59.7082%), train_poison_data_count: 1244
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   8, Avg loss: 0.0257, Accuracy: 1196/1988 (60.1610%), train_poison_data_count: 1244
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   9, Avg loss: 0.0256, Accuracy: 1226/1988 (61.6700%), train_poison_data_count: 1244
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch  10, Avg loss: 0.0253, Accuracy: 1200/1988 (60.3622%), train_poison_data_count: 1244
Global model norm: 320.47235645215954.
Norm before scaling: 320.3525523739432. Distance: 1.3539835683820118
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.6618, Accuracy: 53/10000 (0.5300%)
_Test Local_ResNet_18 poisoned: True, epoch: 81, Avg loss: 0.5214, Accuracy: 9344/9950 (93.9095%)
Scaling by  100
Scaled Norm after poisoning: 336.41428375219147, distance: 135.39837777139354
Total norm for 6 adversaries is: 336.41428375219147. distance: 135.39837777139354
_Test Local_ResNet_18 poisoned: True, epoch: 81, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0655, Accuracy: 260/1154 (22.5303%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0328, Accuracy: 422/1154 (36.5685%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.7819, Accuracy: 65/10000 (0.6500%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0695, Accuracy: 165/774 (21.3178%)
_Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0391, Accuracy: 328/774 (42.3773%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.7997, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0520, Accuracy: 239/813 (29.3973%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0207, Accuracy: 447/813 (54.9815%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 13.0457, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   1, Avg loss: 0.0649, Accuracy: 198/1013 (19.5459%)
_Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   2, Avg loss: 0.0286, Accuracy: 468/1013 (46.1994%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.2470, Accuracy: 80/10000 (0.8000%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0627, Accuracy: 288/1130 (25.4867%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0323, Accuracy: 419/1130 (37.0796%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.6687, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   1, Avg loss: 0.0643, Accuracy: 314/1581 (19.8608%)
_Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   2, Avg loss: 0.0376, Accuracy: 499/1581 (31.5623%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.6337, Accuracy: 96/10000 (0.9600%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1619, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1469, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.9710, Accuracy: 57/10000 (0.5700%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   1, Avg loss: 0.0682, Accuracy: 267/1657 (16.1135%)
_Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   2, Avg loss: 0.0402, Accuracy: 447/1657 (26.9765%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.1539, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   1, Avg loss: 0.0676, Accuracy: 208/1049 (19.8284%)
_Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   2, Avg loss: 0.0309, Accuracy: 488/1049 (46.5205%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.2176, Accuracy: 111/10000 (1.1100%)
time spent on training: 388.4803876876831
[rfa agg] training data poison_ratio: 0.6036997509782995  data num: [1988, 1154, 774, 813, 1013, 1130, 1581, 85, 1657, 1049]
[rfa agg] considering poison per batch poison_fraction: 0.37731234436143724
[rfa agg] init. name: [85, 15, 81, 53, 39, 54, 28, 61, 0, 51], weight: tensor([0.1768, 0.1026, 0.0688, 0.0723, 0.0901, 0.1005, 0.1406, 0.0076, 0.1474,
        0.0933])
[rfa agg] iter:  0, prev_obj_val: 41716.80078125, obj_val: 29419.935546875, abs dis: 12296.865234375
[rfa agg] iter: 0, weight: tensor([0.0440, 0.1192, 0.0798, 0.0838, 0.1045, 0.1166, 0.1636, 0.0087, 0.1715,
        0.1082])
[rfa agg] iter:  1, prev_obj_val: 29419.935546875, obj_val: 26242.298828125, abs dis: 3177.63671875
[rfa agg] iter: 1, weight: tensor([0.0098, 0.1234, 0.0821, 0.0862, 0.1078, 0.1206, 0.1705, 0.0089, 0.1789,
        0.1118])
[rfa agg] iter:  2, prev_obj_val: 26242.298828125, obj_val: 25530.154296875, abs dis: 712.14453125
[rfa agg] iter: 2, weight: tensor([0.0021, 0.1240, 0.0800, 0.0841, 0.1067, 0.1206, 0.1766, 0.0082, 0.1864,
        0.1112])
[rfa agg] iter:  3, prev_obj_val: 25530.154296875, obj_val: 25394.015625, abs dis: 136.138671875
[rfa agg] iter: 3, weight: tensor([0.0004, 0.1195, 0.0677, 0.0712, 0.0964, 0.1140, 0.2020, 0.0057, 0.2207,
        0.1022])
[rfa agg] iter:  4, prev_obj_val: 25394.015625, obj_val: 25390.19140625, abs dis: 3.82421875
[rfa agg] iter: 4, weight: tensor([7.4543e-05, 9.2772e-02, 3.7192e-02, 3.9613e-02, 6.4767e-02, 8.9665e-02,
        2.9075e-01, 2.1022e-03, 3.1435e-01, 6.8716e-02])
[rfa agg] iter:  5, prev_obj_val: 25390.19140625, obj_val: 25390.357421875, abs dis: 0.166015625
[rfa agg] iter: 5, weight: tensor([7.6419e-05, 1.3448e-01, 5.1561e-02, 5.5620e-02, 1.0083e-01, 1.5087e-01,
        2.1164e-01, 2.5031e-03, 1.9304e-01, 9.9385e-02])
[rfa agg] iter:  6, prev_obj_val: 25390.357421875, obj_val: 25393.126953125, abs dis: 2.76953125
[rfa agg] iter: 6, weight: tensor([7.2044e-05, 1.4897e-01, 5.7294e-02, 6.2550e-02, 1.2333e-01, 1.9468e-01,
        1.5498e-01, 2.5319e-03, 1.4217e-01, 1.1342e-01])
[rfa agg] iter:  7, prev_obj_val: 25393.126953125, obj_val: 25393.0625, abs dis: 0.064453125
[rfa agg] iter: 7, weight: tensor([6.4515e-05, 1.3599e-01, 6.5793e-02, 7.3843e-02, 1.6447e-01, 2.3006e-01,
        1.0583e-01, 2.5041e-03, 9.9640e-02, 1.2181e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.8544, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.0633, Accuracy: 0/9950 (0.0000%)
saving model
Done in 827.8516283035278 sec.
Server Epoch:82 choose agents : [23, 74, 72, 38, 79, 44, 28, 77, 55, 70].
_Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   1, Avg loss: 0.0732, Accuracy: 181/715 (25.3147%)
_Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   2, Avg loss: 0.0395, Accuracy: 435/715 (60.8392%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.3118, Accuracy: 70/10000 (0.7000%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0573, Accuracy: 400/1552 (25.7732%)
_Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0227, Accuracy: 705/1552 (45.4253%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 12.2663, Accuracy: 90/10000 (0.9000%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0648, Accuracy: 193/1241 (15.5520%)
_Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0388, Accuracy: 414/1241 (33.3602%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.5614, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   1, Avg loss: 0.0729, Accuracy: 188/1131 (16.6225%)
_Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   2, Avg loss: 0.0345, Accuracy: 453/1131 (40.0531%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.1932, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1323, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.1137, Accuracy: 2/197 (1.0152%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.1457, Accuracy: 62/10000 (0.6200%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0720, Accuracy: 263/1750 (15.0286%)
_Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0398, Accuracy: 574/1750 (32.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.3307, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0643, Accuracy: 317/1581 (20.0506%)
_Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0381, Accuracy: 467/1581 (29.5383%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.6782, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   1, Avg loss: 0.0617, Accuracy: 282/1340 (21.0448%)
_Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   2, Avg loss: 0.0302, Accuracy: 550/1340 (41.0448%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.9385, Accuracy: 86/10000 (0.8600%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   1, Avg loss: 0.0660, Accuracy: 210/1071 (19.6078%)
_Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   2, Avg loss: 0.0338, Accuracy: 439/1071 (40.9897%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.1772, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   1, Avg loss: 0.0660, Accuracy: 294/1418 (20.7334%)
_Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   2, Avg loss: 0.0334, Accuracy: 595/1418 (41.9605%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.5142, Accuracy: 84/10000 (0.8400%)
time spent on training: 287.106436252594
[rfa agg] training data poison_ratio: 0.4679893297765922  data num: [715, 1552, 1241, 1131, 197, 1750, 1581, 1340, 1071, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.2924933311103701
[rfa agg] init. name: [23, 74, 72, 38, 79, 44, 28, 77, 55, 70], weight: tensor([0.0596, 0.1294, 0.1035, 0.0943, 0.0164, 0.1459, 0.1318, 0.1117, 0.0893,
        0.1182])
[rfa agg] iter:  0, prev_obj_val: 51.012420654296875, obj_val: 52.218017578125, abs dis: 1.205596923828125
[rfa agg] iter: 0, weight: tensor([0.0340, 0.1033, 0.1785, 0.1221, 0.0048, 0.0818, 0.1073, 0.1435, 0.0999,
        0.1247])
[rfa agg] iter:  1, prev_obj_val: 52.218017578125, obj_val: 57.835533142089844, abs dis: 5.617515563964844
[rfa agg] iter: 1, weight: tensor([0.0358, 0.0961, 0.1876, 0.1327, 0.0049, 0.0769, 0.0998, 0.1414, 0.1078,
        0.1170])
[rfa agg] iter:  2, prev_obj_val: 57.835533142089844, obj_val: 55.68308639526367, abs dis: 2.152446746826172
[rfa agg] iter: 2, weight: tensor([0.0464, 0.0869, 0.1659, 0.1610, 0.0058, 0.0724, 0.0897, 0.1269, 0.1422,
        0.1026])
[rfa agg] iter:  3, prev_obj_val: 55.68308639526367, obj_val: 55.68171310424805, abs dis: 0.001373291015625
[rfa agg] iter: 3, weight: tensor([0.0422, 0.0885, 0.1697, 0.1601, 0.0055, 0.0729, 0.0913, 0.1294, 0.1353,
        0.1051])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.7801, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 12.0792, Accuracy: 0/9950 (0.0000%)
saving model
Done in 727.6299207210541 sec.
Server Epoch:83 choose agents : [95, 76, 60, 48, 18, 10, 90, 78, 15, 89].
poison local model 95 index 31 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   1, Avg loss: 0.0694, Accuracy: 168/599 (28.0467%), train_poison_data_count: 383
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   2, Avg loss: 0.0309, Accuracy: 375/599 (62.6043%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   3, Avg loss: 0.0235, Accuracy: 307/599 (51.2521%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   4, Avg loss: 0.0220, Accuracy: 326/599 (54.4240%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   5, Avg loss: 0.0222, Accuracy: 342/599 (57.0952%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   6, Avg loss: 0.0213, Accuracy: 365/599 (60.9349%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   7, Avg loss: 0.0207, Accuracy: 363/599 (60.6010%), train_poison_data_count: 383
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   8, Avg loss: 0.0218, Accuracy: 346/599 (57.7629%), train_poison_data_count: 383
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   9, Avg loss: 0.0215, Accuracy: 358/599 (59.7663%), train_poison_data_count: 383
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch  10, Avg loss: 0.0208, Accuracy: 369/599 (61.6027%), train_poison_data_count: 383
Global model norm: 323.9494559341009.
Norm before scaling: 323.9202013999744. Distance: 0.8656535285077088
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.9175, Accuracy: 49/10000 (0.4900%)
_Test Local_ResNet_18 poisoned: True, epoch: 83, Avg loss: 0.5833, Accuracy: 7309/9950 (73.4573%)
Scaling by  100
Scaled Norm after poisoning: 332.3656448476587, distance: 86.56535137451792
Total norm for 7 adversaries is: 332.3656448476587. distance: 86.56535137451792
_Test Local_ResNet_18 poisoned: True, epoch: 83, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   1, Avg loss: 0.0913, Accuracy: 7/466 (1.5021%)
_Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   2, Avg loss: 0.0528, Accuracy: 161/466 (34.5494%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1754, Accuracy: 56/10000 (0.5600%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   1, Avg loss: 0.0594, Accuracy: 474/2227 (21.2842%)
_Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   2, Avg loss: 0.0308, Accuracy: 885/2227 (39.7396%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.3342, Accuracy: 111/10000 (1.1100%)
poison local model 48 index 17 
_Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   1, Avg loss: 0.0822, Accuracy: 69/631 (10.9350%)
_Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   2, Avg loss: 0.0491, Accuracy: 196/631 (31.0618%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1352, Accuracy: 68/10000 (0.6800%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.0945, Accuracy: 11/530 (2.0755%)
_Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0440, Accuracy: 286/530 (53.9623%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.9926, Accuracy: 67/10000 (0.6700%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   1, Avg loss: 0.0696, Accuracy: 153/861 (17.7700%)
_Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   2, Avg loss: 0.0230, Accuracy: 401/861 (46.5738%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 11.1507, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   1, Avg loss: 0.0579, Accuracy: 207/677 (30.5761%)
_Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 455/677 (67.2083%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 12.3018, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0915, Accuracy: 12/416 (2.8846%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0502, Accuracy: 185/416 (44.4712%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.7209, Accuracy: 73/10000 (0.7300%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   1, Avg loss: 0.0653, Accuracy: 239/1154 (20.7106%)
_Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   2, Avg loss: 0.0392, Accuracy: 440/1154 (38.1282%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.9900, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   1, Avg loss: 0.0695, Accuracy: 281/896 (31.3616%)
_Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   2, Avg loss: 0.0378, Accuracy: 462/896 (51.5625%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.7546, Accuracy: 65/10000 (0.6500%)
time spent on training: 354.80420422554016
[rfa agg] training data poison_ratio: 0.7588979543573371  data num: [599, 466, 2227, 631, 530, 861, 677, 416, 1154, 896]
[rfa agg] considering poison per batch poison_fraction: 0.4743112214733357
[rfa agg] init. name: [95, 76, 60, 48, 18, 10, 90, 78, 15, 89], weight: tensor([0.0708, 0.0551, 0.2633, 0.0746, 0.0627, 0.1018, 0.0801, 0.0492, 0.1365,
        0.1059])
[rfa agg] iter:  0, prev_obj_val: 6013.4169921875, obj_val: 3460.64892578125, abs dis: 2552.76806640625
[rfa agg] iter: 0, weight: tensor([0.0057, 0.0572, 0.2943, 0.0778, 0.0652, 0.1074, 0.0837, 0.0509, 0.1459,
        0.1118])
[rfa agg] iter:  1, prev_obj_val: 3460.64892578125, obj_val: 3342.84814453125, abs dis: 117.80078125
[rfa agg] iter: 1, weight: tensor([3.4073e-04, 3.5069e-02, 5.0859e-01, 5.0277e-02, 4.0970e-02, 7.7034e-02,
        5.5435e-02, 3.0492e-02, 1.2130e-01, 8.0491e-02])
[rfa agg] iter:  2, prev_obj_val: 3342.84814453125, obj_val: 3330.286376953125, abs dis: 12.561767578125
[rfa agg] iter: 2, weight: tensor([1.6568e-04, 4.0082e-02, 2.8019e-01, 6.1529e-02, 4.8397e-02, 1.1364e-01,
        7.1359e-02, 3.3650e-02, 2.3153e-01, 1.1946e-01])
[rfa agg] iter:  3, prev_obj_val: 3330.286376953125, obj_val: 3330.33203125, abs dis: 0.045654296875
[rfa agg] iter: 3, weight: tensor([1.1209e-04, 4.2259e-02, 1.2296e-01, 7.0192e-02, 5.2660e-02, 1.5857e-01,
        8.5561e-02, 3.4430e-02, 2.6224e-01, 1.7102e-01])
[rfa agg] iter:  4, prev_obj_val: 3330.33203125, obj_val: 3334.56494140625, abs dis: 4.23291015625
[rfa agg] iter: 4, weight: tensor([8.3729e-05, 4.8708e-02, 7.4456e-02, 9.1274e-02, 6.3095e-02, 2.0313e-01,
        1.1788e-01, 3.8214e-02, 1.3127e-01, 2.3189e-01])
[rfa agg] iter:  5, prev_obj_val: 3334.56494140625, obj_val: 3338.088623046875, abs dis: 3.523681640625
[rfa agg] iter: 5, weight: tensor([7.7681e-05, 6.1867e-02, 6.3237e-02, 1.2713e-01, 8.2378e-02, 1.7262e-01,
        1.6489e-01, 4.6779e-02, 9.2166e-02, 1.8886e-01])
[rfa agg] iter:  6, prev_obj_val: 3338.088623046875, obj_val: 3336.14306640625, abs dis: 1.945556640625
[rfa agg] iter: 6, weight: tensor([7.6116e-05, 7.3523e-02, 5.9468e-02, 1.5467e-01, 9.9040e-02, 1.3974e-01,
        1.9028e-01, 5.4305e-02, 8.0991e-02, 1.4790e-01])
[rfa agg] iter:  7, prev_obj_val: 3336.14306640625, obj_val: 3336.13916015625, abs dis: 0.00390625
[rfa agg] iter: 7, weight: tensor([7.5438e-05, 6.7717e-02, 6.0133e-02, 1.4545e-01, 9.2323e-02, 1.4934e-01,
        1.9383e-01, 5.0270e-02, 8.3758e-02, 1.5710e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.9186, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 11.7562, Accuracy: 0/9950 (0.0000%)
saving model
Done in 797.8991568088531 sec.
Server Epoch:84 choose agents : [61, 28, 35, 75, 74, 90, 55, 80, 23, 88].
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1519, Accuracy: 3/85 (3.5294%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1511, Accuracy: 3/85 (3.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.9910, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0634, Accuracy: 323/1581 (20.4301%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0376, Accuracy: 507/1581 (32.0683%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.5864, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.1032, Accuracy: 6/271 (2.2140%)
_Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0696, Accuracy: 71/271 (26.1993%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.3494, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   1, Avg loss: 0.0800, Accuracy: 146/776 (18.8144%)
_Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   2, Avg loss: 0.0341, Accuracy: 410/776 (52.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.8066, Accuracy: 73/10000 (0.7300%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   1, Avg loss: 0.0540, Accuracy: 378/1552 (24.3557%)
_Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   2, Avg loss: 0.0228, Accuracy: 738/1552 (47.5515%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 11.6251, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   1, Avg loss: 0.0570, Accuracy: 215/677 (31.7578%)
_Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 12.4336, Accuracy: 49/10000 (0.4900%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0646, Accuracy: 181/1071 (16.9001%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0327, Accuracy: 485/1071 (45.2848%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.8105, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.0828, Accuracy: 63/682 (9.2375%)
_Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0431, Accuracy: 267/682 (39.1496%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.6789, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   1, Avg loss: 0.0694, Accuracy: 177/715 (24.7552%)
_Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   2, Avg loss: 0.0440, Accuracy: 436/715 (60.9790%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.5794, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.0846, Accuracy: 89/603 (14.7595%)
_Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0547, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.5393, Accuracy: 61/10000 (0.6100%)
time spent on training: 231.90043807029724
[rfa agg] training data poison_ratio: 0.33795082990141023  data num: [85, 1581, 271, 776, 1552, 677, 1071, 682, 715, 603]
[rfa agg] considering poison per batch poison_fraction: 0.2112192686883814
[rfa agg] init. name: [61, 28, 35, 75, 74, 90, 55, 80, 23, 88], weight: tensor([0.0106, 0.1973, 0.0338, 0.0968, 0.1937, 0.0845, 0.1337, 0.0851, 0.0892,
        0.0753])
[rfa agg] iter:  0, prev_obj_val: 63.877410888671875, obj_val: 65.87196350097656, abs dis: 1.9945526123046875
[rfa agg] iter: 0, weight: tensor([0.0041, 0.1009, 0.0185, 0.1653, 0.0982, 0.1063, 0.1894, 0.1105, 0.1241,
        0.0827])
[rfa agg] iter:  1, prev_obj_val: 65.87196350097656, obj_val: 72.5401382446289, abs dis: 6.668174743652344
[rfa agg] iter: 1, weight: tensor([0.0040, 0.0783, 0.0189, 0.1826, 0.0763, 0.1258, 0.1363, 0.1357, 0.1445,
        0.0975])
[rfa agg] iter:  2, prev_obj_val: 72.5401382446289, obj_val: 70.32612609863281, abs dis: 2.2140121459960938
[rfa agg] iter: 2, weight: tensor([0.0044, 0.0643, 0.0226, 0.1407, 0.0627, 0.1552, 0.0943, 0.1755, 0.1399,
        0.1404])
[rfa agg] iter:  3, prev_obj_val: 70.32612609863281, obj_val: 70.3251953125, abs dis: 0.0009307861328125
[rfa agg] iter: 3, weight: tensor([0.0041, 0.0647, 0.0208, 0.1446, 0.0631, 0.1558, 0.0971, 0.1790, 0.1402,
        0.1306])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.2962, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 11.6866, Accuracy: 0/9950 (0.0000%)
saving model
Done in 672.2700254917145 sec.
Server Epoch:85 choose agents : [36, 56, 25, 90, 31, 70, 30, 21, 46, 64].
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   1, Avg loss: 0.1036, Accuracy: 1/408 (0.2451%)
_Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   2, Avg loss: 0.0616, Accuracy: 117/408 (28.6765%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.7542, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   1, Avg loss: 0.0925, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   2, Avg loss: 0.0758, Accuracy: 8/186 (4.3011%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.9975, Accuracy: 53/10000 (0.5300%)
poison local model 25 index 10 
_Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   1, Avg loss: 0.0661, Accuracy: 228/690 (33.0435%)
_Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   2, Avg loss: 0.0333, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.3905, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   1, Avg loss: 0.0558, Accuracy: 216/677 (31.9055%)
_Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   2, Avg loss: 0.0215, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 12.4739, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0875, Accuracy: 9/460 (1.9565%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0406, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.7174, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   1, Avg loss: 0.0663, Accuracy: 315/1418 (22.2144%)
_Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   2, Avg loss: 0.0348, Accuracy: 567/1418 (39.9859%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.8163, Accuracy: 75/10000 (0.7500%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0974, Accuracy: 7/486 (1.4403%)
_Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0465, Accuracy: 202/486 (41.5638%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.4199, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   1, Avg loss: 0.0626, Accuracy: 307/1949 (15.7517%)
_Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   2, Avg loss: 0.0367, Accuracy: 546/1949 (28.0144%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.3068, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   1, Avg loss: 0.0601, Accuracy: 346/1904 (18.1723%)
_Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   2, Avg loss: 0.0340, Accuracy: 649/1904 (34.0861%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.6311, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0775, Accuracy: 89/953 (9.3389%)
_Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0410, Accuracy: 299/953 (31.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.4164, Accuracy: 53/10000 (0.5300%)
time spent on training: 249.2018642425537
[rfa agg] training data poison_ratio: 0.17347497535866827  data num: [408, 186, 690, 677, 460, 1418, 486, 1949, 1904, 953]
[rfa agg] considering poison per batch poison_fraction: 0.10842185959916767
[rfa agg] init. name: [36, 56, 25, 90, 31, 70, 30, 21, 46, 64], weight: tensor([0.0447, 0.0204, 0.0756, 0.0741, 0.0504, 0.1553, 0.0532, 0.2134, 0.2085,
        0.1044])
[rfa agg] iter:  0, prev_obj_val: 88.7779541015625, obj_val: 90.6881103515625, abs dis: 1.91015625
[rfa agg] iter: 0, weight: tensor([0.0326, 0.0107, 0.0808, 0.0808, 0.0400, 0.2280, 0.0424, 0.1405, 0.1510,
        0.1932])
[rfa agg] iter:  1, prev_obj_val: 90.6881103515625, obj_val: 91.45303344726562, abs dis: 0.764923095703125
[rfa agg] iter: 1, weight: tensor([0.0348, 0.0110, 0.0919, 0.0924, 0.0433, 0.1841, 0.0461, 0.1182, 0.1264,
        0.2518])
[rfa agg] iter:  2, prev_obj_val: 91.45303344726562, obj_val: 92.33788299560547, abs dis: 0.8848495483398438
[rfa agg] iter: 2, weight: tensor([0.0351, 0.0109, 0.0949, 0.0960, 0.0438, 0.1643, 0.0467, 0.1096, 0.1169,
        0.2818])
[rfa agg] iter:  3, prev_obj_val: 92.33788299560547, obj_val: 93.32538604736328, abs dis: 0.9875030517578125
[rfa agg] iter: 3, weight: tensor([0.0354, 0.0108, 0.0981, 0.0998, 0.0445, 0.1482, 0.0474, 0.1020, 0.1084,
        0.3054])
[rfa agg] iter:  4, prev_obj_val: 93.32538604736328, obj_val: 94.43875885009766, abs dis: 1.113372802734375
[rfa agg] iter: 4, weight: tensor([0.0358, 0.0107, 0.1019, 0.1043, 0.0453, 0.1343, 0.0482, 0.0950, 0.1008,
        0.3236])
[rfa agg] iter:  5, prev_obj_val: 94.43875885009766, obj_val: 97.10018920898438, abs dis: 2.6614303588867188
[rfa agg] iter: 5, weight: tensor([0.0366, 0.0107, 0.1071, 0.1106, 0.0466, 0.1232, 0.0497, 0.0894, 0.0945,
        0.3316])
[rfa agg] iter:  6, prev_obj_val: 97.10018920898438, obj_val: 97.0846939086914, abs dis: 0.01549530029296875
[rfa agg] iter: 6, weight: tensor([0.0405, 0.0113, 0.1253, 0.1324, 0.0522, 0.1098, 0.0558, 0.0833, 0.0876,
        0.3017])
[rfa agg] iter:  7, prev_obj_val: 97.0846939086914, obj_val: 98.60284423828125, abs dis: 1.5181503295898438
[rfa agg] iter: 7, weight: tensor([0.0409, 0.0114, 0.1278, 0.1350, 0.0527, 0.1101, 0.0564, 0.0837, 0.0880,
        0.2942])
[rfa agg] iter:  8, prev_obj_val: 98.60284423828125, obj_val: 98.59427642822266, abs dis: 0.00856781005859375
[rfa agg] iter: 8, weight: tensor([0.0435, 0.0119, 0.1399, 0.1501, 0.0565, 0.1050, 0.0605, 0.0814, 0.0854,
        0.2658])
[rfa agg] iter:  9, prev_obj_val: 98.59427642822266, obj_val: 98.59397888183594, abs dis: 0.00029754638671875
[rfa agg] iter: 9, weight: tensor([0.0437, 0.0119, 0.1420, 0.1524, 0.0568, 0.1053, 0.0609, 0.0816, 0.0856,
        0.2598])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 10.1453, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 10.7095, Accuracy: 0/9950 (0.0000%)
saving model
Done in 690.7015504837036 sec.
Server Epoch:86 choose agents : [94, 50, 2, 53, 86, 67, 12, 69, 24, 81].
_Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   1, Avg loss: 0.0663, Accuracy: 254/1662 (15.2828%)
_Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   2, Avg loss: 0.0374, Accuracy: 553/1662 (33.2732%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.0095, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   1, Avg loss: 0.0634, Accuracy: 119/809 (14.7095%)
_Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   2, Avg loss: 0.0315, Accuracy: 293/809 (36.2176%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.6736, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0814, Accuracy: 65/605 (10.7438%)
_Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0457, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.3974, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   1, Avg loss: 0.0546, Accuracy: 233/813 (28.6593%)
_Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   2, Avg loss: 0.0207, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.6227, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   1, Avg loss: 0.0618, Accuracy: 319/1003 (31.8046%)
_Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   2, Avg loss: 0.0353, Accuracy: 381/1003 (37.9860%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.3749, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   1, Avg loss: 0.0875, Accuracy: 12/426 (2.8169%)
_Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   2, Avg loss: 0.0489, Accuracy: 161/426 (37.7934%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.0969, Accuracy: 48/10000 (0.4800%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   1, Avg loss: 0.1174, Accuracy: 1/338 (0.2959%)
_Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   2, Avg loss: 0.0706, Accuracy: 92/338 (27.2189%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.6496, Accuracy: 50/10000 (0.5000%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   1, Avg loss: 0.0611, Accuracy: 195/590 (33.0508%)
_Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   2, Avg loss: 0.0344, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 13.1854, Accuracy: 50/10000 (0.5000%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.1006, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0563, Accuracy: 97/312 (31.0897%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.6566, Accuracy: 59/10000 (0.5900%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0702, Accuracy: 169/774 (21.8346%)
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0407, Accuracy: 325/774 (41.9897%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.2732, Accuracy: 70/10000 (0.7000%)
time spent on training: 233.5473804473877
[rfa agg] training data poison_ratio: 0.2746863066012002  data num: [1662, 809, 605, 813, 1003, 426, 338, 590, 312, 774]
[rfa agg] considering poison per batch poison_fraction: 0.17167894162575012
[rfa agg] init. name: [94, 50, 2, 53, 86, 67, 12, 69, 24, 81], weight: tensor([0.2267, 0.1103, 0.0825, 0.1109, 0.1368, 0.0581, 0.0461, 0.0805, 0.0426,
        0.1056])
[rfa agg] iter:  0, prev_obj_val: 58.839229583740234, obj_val: 61.555335998535156, abs dis: 2.716106414794922
[rfa agg] iter: 0, weight: tensor([0.0697, 0.1658, 0.1221, 0.1627, 0.1172, 0.0501, 0.0328, 0.1168, 0.0259,
        0.1370])
[rfa agg] iter:  1, prev_obj_val: 61.555335998535156, obj_val: 65.75596618652344, abs dis: 4.200630187988281
[rfa agg] iter: 1, weight: tensor([0.0657, 0.1459, 0.1442, 0.1465, 0.1025, 0.0602, 0.0384, 0.1437, 0.0297,
        0.1233])
[rfa agg] iter:  2, prev_obj_val: 65.75596618652344, obj_val: 61.54587173461914, abs dis: 4.210094451904297
[rfa agg] iter: 2, weight: tensor([0.0657, 0.1258, 0.1578, 0.1268, 0.0947, 0.0776, 0.0480, 0.1569, 0.0362,
        0.1104])
[rfa agg] iter:  3, prev_obj_val: 61.54587173461914, obj_val: 63.5074462890625, abs dis: 1.9615745544433594
[rfa agg] iter: 3, weight: tensor([0.0652, 0.1412, 0.1515, 0.1426, 0.1013, 0.0612, 0.0389, 0.1485, 0.0299,
        0.1197])
[rfa agg] iter:  4, prev_obj_val: 63.5074462890625, obj_val: 63.503639221191406, abs dis: 0.00380706787109375
[rfa agg] iter: 4, weight: tensor([0.0652, 0.1331, 0.1565, 0.1343, 0.0975, 0.0682, 0.0428, 0.1549, 0.0326,
        0.1149])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.6983, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 10.9070, Accuracy: 1/9950 (0.0101%)
saving model
Done in 674.6931858062744 sec.
Server Epoch:87 choose agents : [39, 80, 90, 83, 43, 57, 67, 2, 23, 36].
_Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   1, Avg loss: 0.0641, Accuracy: 175/1013 (17.2754%)
_Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   2, Avg loss: 0.0281, Accuracy: 484/1013 (47.7789%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.6021, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   1, Avg loss: 0.0803, Accuracy: 56/682 (8.2111%)
_Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   2, Avg loss: 0.0429, Accuracy: 266/682 (39.0029%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.7317, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   1, Avg loss: 0.0563, Accuracy: 209/677 (30.8715%)
_Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 449/677 (66.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 12.8146, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   1, Avg loss: 0.0651, Accuracy: 339/1953 (17.3579%)
_Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   2, Avg loss: 0.0376, Accuracy: 653/1953 (33.4357%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.4706, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0677, Accuracy: 244/946 (25.7928%)
_Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0402, Accuracy: 366/946 (38.6892%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.1887, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0669, Accuracy: 209/1154 (18.1109%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0327, Accuracy: 440/1154 (38.1282%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 11.5062, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   1, Avg loss: 0.0888, Accuracy: 14/426 (3.2864%)
_Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   2, Avg loss: 0.0506, Accuracy: 158/426 (37.0892%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.8031, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   1, Avg loss: 0.0825, Accuracy: 76/605 (12.5620%)
_Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   2, Avg loss: 0.0447, Accuracy: 324/605 (53.5537%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.0218, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0705, Accuracy: 203/715 (28.3916%)
_Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0410, Accuracy: 440/715 (61.5385%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4604, Accuracy: 66/10000 (0.6600%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   1, Avg loss: 0.1049, Accuracy: 6/408 (1.4706%)
_Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   2, Avg loss: 0.0611, Accuracy: 113/408 (27.6961%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.6836, Accuracy: 56/10000 (0.5600%)
time spent on training: 219.065087556839
[rfa agg] training data poison_ratio: 0.04755799044177643  data num: [1013, 682, 677, 1953, 946, 1154, 426, 605, 715, 408]
[rfa agg] considering poison per batch poison_fraction: 0.02972374402611027
[rfa agg] init. name: [39, 80, 90, 83, 43, 57, 67, 2, 23, 36], weight: tensor([0.1181, 0.0795, 0.0789, 0.2276, 0.1103, 0.1345, 0.0497, 0.0705, 0.0833,
        0.0476])
[rfa agg] iter:  0, prev_obj_val: 68.99939727783203, obj_val: 73.1114273071289, abs dis: 4.112030029296875
[rfa agg] iter: 0, weight: tensor([0.2054, 0.0885, 0.0874, 0.0752, 0.1994, 0.1198, 0.0315, 0.0646, 0.0981,
        0.0302])
[rfa agg] iter:  1, prev_obj_val: 73.1114273071289, obj_val: 74.44223022460938, abs dis: 1.3308029174804688
[rfa agg] iter: 1, weight: tensor([0.1266, 0.1421, 0.1410, 0.0596, 0.1423, 0.0826, 0.0433, 0.0991, 0.1219,
        0.0416])
[rfa agg] iter:  2, prev_obj_val: 74.44223022460938, obj_val: 78.42566680908203, abs dis: 3.9834365844726562
[rfa agg] iter: 2, weight: tensor([0.1091, 0.1582, 0.1583, 0.0560, 0.1223, 0.0748, 0.0458, 0.1103, 0.1211,
        0.0442])
[rfa agg] iter:  3, prev_obj_val: 78.42566680908203, obj_val: 78.40904998779297, abs dis: 0.0166168212890625
[rfa agg] iter: 3, weight: tensor([0.0947, 0.1643, 0.1650, 0.0541, 0.1039, 0.0689, 0.0549, 0.1278, 0.1132,
        0.0531])
[rfa agg] iter:  4, prev_obj_val: 78.40904998779297, obj_val: 80.8380355834961, abs dis: 2.428985595703125
[rfa agg] iter: 4, weight: tensor([0.0935, 0.1654, 0.1668, 0.0536, 0.1023, 0.0682, 0.0549, 0.1306, 0.1115,
        0.0531])
[rfa agg] iter:  5, prev_obj_val: 80.8380355834961, obj_val: 83.5256576538086, abs dis: 2.6876220703125
[rfa agg] iter: 5, weight: tensor([0.0901, 0.1608, 0.1620, 0.0540, 0.0978, 0.0674, 0.0620, 0.1377, 0.1083,
        0.0600])
[rfa agg] iter:  6, prev_obj_val: 83.5256576538086, obj_val: 83.5230712890625, abs dis: 0.00258636474609375
[rfa agg] iter: 6, weight: tensor([0.0879, 0.1531, 0.1539, 0.0551, 0.0946, 0.0673, 0.0711, 0.1426, 0.1053,
        0.0690])
[rfa agg] iter:  7, prev_obj_val: 83.5230712890625, obj_val: 80.83808135986328, abs dis: 2.6849899291992188
[rfa agg] iter: 7, weight: tensor([0.0879, 0.1523, 0.1532, 0.0551, 0.0945, 0.0672, 0.0716, 0.1437, 0.1051,
        0.0695])
[rfa agg] iter:  8, prev_obj_val: 80.83808135986328, obj_val: 83.5250244140625, abs dis: 2.6869430541992188
[rfa agg] iter: 8, weight: tensor([0.0898, 0.1593, 0.1607, 0.0540, 0.0974, 0.0672, 0.0627, 0.1405, 0.1077,
        0.0607])
[rfa agg] iter:  9, prev_obj_val: 83.5250244140625, obj_val: 83.52306365966797, abs dis: 0.00196075439453125
[rfa agg] iter: 9, weight: tensor([0.0879, 0.1529, 0.1538, 0.0551, 0.0946, 0.0673, 0.0711, 0.1430, 0.1052,
        0.0690])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.5776, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 11.6770, Accuracy: 0/9950 (0.0000%)
saving model
Done in 659.6644825935364 sec.
Server Epoch:88 choose agents : [4, 42, 28, 74, 13, 49, 24, 34, 87, 86].
_Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   1, Avg loss: 0.0746, Accuracy: 206/901 (22.8635%)
_Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   2, Avg loss: 0.0417, Accuracy: 416/901 (46.1709%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.3473, Accuracy: 57/10000 (0.5700%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   1, Avg loss: 0.0699, Accuracy: 196/1372 (14.2857%)
_Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   2, Avg loss: 0.0345, Accuracy: 439/1372 (31.9971%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 10.4280, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0654, Accuracy: 303/1581 (19.1651%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0380, Accuracy: 489/1581 (30.9298%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.3964, Accuracy: 77/10000 (0.7700%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   1, Avg loss: 0.0546, Accuracy: 367/1552 (23.6469%)
_Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   2, Avg loss: 0.0236, Accuracy: 716/1552 (46.1340%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 11.9335, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   1, Avg loss: 0.0706, Accuracy: 260/1645 (15.8055%)
_Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   2, Avg loss: 0.0359, Accuracy: 558/1645 (33.9210%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.1928, Accuracy: 104/10000 (1.0400%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   1, Avg loss: 0.1082, Accuracy: 2/440 (0.4545%)
_Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   2, Avg loss: 0.0660, Accuracy: 78/440 (17.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.3621, Accuracy: 59/10000 (0.5900%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   1, Avg loss: 0.0977, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   2, Avg loss: 0.0542, Accuracy: 95/312 (30.4487%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.1597, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0669, Accuracy: 298/1427 (20.8830%)
_Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0361, Accuracy: 535/1427 (37.4912%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0771, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   1, Avg loss: 0.0704, Accuracy: 204/1131 (18.0371%)
_Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   2, Avg loss: 0.0356, Accuracy: 365/1131 (32.2723%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.2317, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0596, Accuracy: 335/1003 (33.3998%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 404/1003 (40.2792%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.2134, Accuracy: 54/10000 (0.5400%)
time spent on training: 286.44915986061096
[rfa agg] training data poison_ratio: 0.3234776487152411  data num: [901, 1372, 1581, 1552, 1645, 440, 312, 1427, 1131, 1003]
[rfa agg] considering poison per batch poison_fraction: 0.20217353044702568
[rfa agg] init. name: [4, 42, 28, 74, 13, 49, 24, 34, 87, 86], weight: tensor([0.0793, 0.1207, 0.1391, 0.1366, 0.1448, 0.0387, 0.0275, 0.1256, 0.0995,
        0.0883])
[rfa agg] iter:  0, prev_obj_val: 59.52081298828125, obj_val: 61.220184326171875, abs dis: 1.699371337890625
[rfa agg] iter: 0, weight: tensor([0.0945, 0.1267, 0.1003, 0.0964, 0.0899, 0.0190, 0.0113, 0.1211, 0.1923,
        0.1485])
[rfa agg] iter:  1, prev_obj_val: 61.220184326171875, obj_val: 57.67659378051758, abs dis: 3.543590545654297
[rfa agg] iter: 1, weight: tensor([0.1010, 0.1168, 0.0928, 0.0891, 0.0835, 0.0195, 0.0115, 0.1109, 0.2071,
        0.1678])
[rfa agg] iter:  2, prev_obj_val: 57.67659378051758, obj_val: 59.33926773071289, abs dis: 1.6626739501953125
[rfa agg] iter: 2, weight: tensor([0.0864, 0.1304, 0.1014, 0.0966, 0.0896, 0.0175, 0.0105, 0.1248, 0.2064,
        0.1365])
[rfa agg] iter:  3, prev_obj_val: 59.33926773071289, obj_val: 61.21542739868164, abs dis: 1.87615966796875
[rfa agg] iter: 3, weight: tensor([0.0927, 0.1238, 0.0968, 0.0927, 0.0864, 0.0184, 0.0109, 0.1176, 0.2112,
        0.1495])
[rfa agg] iter:  4, prev_obj_val: 61.21542739868164, obj_val: 57.677059173583984, abs dis: 3.5383682250976562
[rfa agg] iter: 4, weight: tensor([0.1006, 0.1162, 0.0924, 0.0886, 0.0831, 0.0194, 0.0114, 0.1103, 0.2110,
        0.1671])
[rfa agg] iter:  5, prev_obj_val: 57.677059173583984, obj_val: 59.33917236328125, abs dis: 1.6621131896972656
[rfa agg] iter: 5, weight: tensor([0.0863, 0.1302, 0.1013, 0.0965, 0.0895, 0.0175, 0.0105, 0.1247, 0.2072,
        0.1363])
[rfa agg] iter:  6, prev_obj_val: 59.33917236328125, obj_val: 61.215423583984375, abs dis: 1.876251220703125
[rfa agg] iter: 6, weight: tensor([0.0927, 0.1238, 0.0968, 0.0927, 0.0863, 0.0184, 0.0109, 0.1176, 0.2114,
        0.1494])
[rfa agg] iter:  7, prev_obj_val: 61.215423583984375, obj_val: 57.67706298828125, abs dis: 3.538360595703125
[rfa agg] iter: 7, weight: tensor([0.1006, 0.1162, 0.0924, 0.0886, 0.0831, 0.0194, 0.0114, 0.1103, 0.2110,
        0.1670])
[rfa agg] iter:  8, prev_obj_val: 57.67706298828125, obj_val: 59.33917236328125, abs dis: 1.662109375
[rfa agg] iter: 8, weight: tensor([0.0863, 0.1302, 0.1013, 0.0965, 0.0895, 0.0175, 0.0105, 0.1247, 0.2072,
        0.1363])
[rfa agg] iter:  9, prev_obj_val: 59.33917236328125, obj_val: 61.21542739868164, abs dis: 1.8762550354003906
[rfa agg] iter: 9, weight: tensor([0.0927, 0.1238, 0.0968, 0.0927, 0.0863, 0.0184, 0.0109, 0.1176, 0.2114,
        0.1494])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 10.8631, Accuracy: 56/10000 (0.5600%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 11.4586, Accuracy: 1/9950 (0.0101%)
saving model
Done in 727.1122448444366 sec.
Server Epoch:89 choose agents : [84, 89, 29, 52, 37, 30, 66, 62, 88, 42].
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0682, Accuracy: 221/1190 (18.5714%)
_Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0346, Accuracy: 448/1190 (37.6471%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.0175, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0670, Accuracy: 281/896 (31.3616%)
_Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0393, Accuracy: 445/896 (49.6652%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.1651, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   1, Avg loss: 0.0672, Accuracy: 364/1440 (25.2778%)
_Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   2, Avg loss: 0.0320, Accuracy: 623/1440 (43.2639%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.7369, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   1, Avg loss: 0.0647, Accuracy: 225/636 (35.3774%)
_Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   2, Avg loss: 0.0379, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.9389, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   1, Avg loss: 0.0572, Accuracy: 324/1129 (28.6980%)
_Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   2, Avg loss: 0.0270, Accuracy: 647/1129 (57.3074%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.7774, Accuracy: 98/10000 (0.9800%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   1, Avg loss: 0.0936, Accuracy: 8/486 (1.6461%)
_Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   2, Avg loss: 0.0447, Accuracy: 214/486 (44.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.8997, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0705, Accuracy: 167/1402 (11.9116%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0416, Accuracy: 378/1402 (26.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.9156, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   1, Avg loss: 0.1186, Accuracy: 0/568 (0.0000%)
_Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   2, Avg loss: 0.0566, Accuracy: 226/568 (39.7887%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.8215, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   1, Avg loss: 0.0835, Accuracy: 88/603 (14.5937%)
_Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   2, Avg loss: 0.0532, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.9287, Accuracy: 58/10000 (0.5800%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0693, Accuracy: 186/1372 (13.5569%)
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0349, Accuracy: 438/1372 (31.9242%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 10.3259, Accuracy: 84/10000 (0.8400%)
time spent on training: 263.60907888412476
[rfa agg] training data poison_ratio: 0.42964410615099774  data num: [1190, 896, 1440, 636, 1129, 486, 1402, 568, 603, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.2685275663443736
[rfa agg] init. name: [84, 89, 29, 52, 37, 30, 66, 62, 88, 42], weight: tensor([0.1224, 0.0922, 0.1481, 0.0654, 0.1161, 0.0500, 0.1442, 0.0584, 0.0620,
        0.1411])
[rfa agg] iter:  0, prev_obj_val: 57.41166305541992, obj_val: 57.32959747314453, abs dis: 0.08206558227539062
[rfa agg] iter: 0, weight: tensor([0.1336, 0.1474, 0.1080, 0.0621, 0.1701, 0.0369, 0.1179, 0.0500, 0.0597,
        0.1145])
[rfa agg] iter:  1, prev_obj_val: 57.32959747314453, obj_val: 58.69091796875, abs dis: 1.3613204956054688
[rfa agg] iter: 1, weight: tensor([0.1335, 0.1522, 0.1062, 0.0612, 0.1736, 0.0364, 0.1159, 0.0494, 0.0588,
        0.1128])
[rfa agg] iter:  2, prev_obj_val: 58.69091796875, obj_val: 63.649147033691406, abs dis: 4.958229064941406
[rfa agg] iter: 2, weight: tensor([0.1279, 0.1635, 0.1023, 0.0667, 0.1631, 0.0392, 0.1111, 0.0537, 0.0643,
        0.1082])
[rfa agg] iter:  3, prev_obj_val: 63.649147033691406, obj_val: 61.82993698120117, abs dis: 1.8192100524902344
[rfa agg] iter: 3, weight: tensor([0.1109, 0.1786, 0.0916, 0.0873, 0.1329, 0.0494, 0.0981, 0.0704, 0.0850,
        0.0958])
[rfa agg] iter:  4, prev_obj_val: 61.82993698120117, obj_val: 61.82721710205078, abs dis: 0.002719879150390625
[rfa agg] iter: 4, weight: tensor([0.1145, 0.1831, 0.0942, 0.0804, 0.1389, 0.0457, 0.1013, 0.0645, 0.0782,
        0.0992])
[rfa agg] iter:  5, prev_obj_val: 61.82721710205078, obj_val: 60.18928527832031, abs dis: 1.6379318237304688
[rfa agg] iter: 5, weight: tensor([0.1147, 0.1836, 0.0943, 0.0800, 0.1392, 0.0456, 0.1013, 0.0643, 0.0778,
        0.0992])
[rfa agg] iter:  6, prev_obj_val: 60.18928527832031, obj_val: 60.185211181640625, abs dis: 0.0040740966796875
[rfa agg] iter: 6, weight: tensor([0.1202, 0.1792, 0.0979, 0.0731, 0.1486, 0.0423, 0.1056, 0.0588, 0.0709,
        0.1034])
[rfa agg] iter:  7, prev_obj_val: 60.185211181640625, obj_val: 61.831199645996094, abs dis: 1.6459884643554688
[rfa agg] iter: 7, weight: tensor([0.1207, 0.1778, 0.0980, 0.0729, 0.1496, 0.0422, 0.1058, 0.0587, 0.0707,
        0.1035])
[rfa agg] iter:  8, prev_obj_val: 61.831199645996094, obj_val: 60.188682556152344, abs dis: 1.64251708984375
[rfa agg] iter: 8, weight: tensor([0.1153, 0.1820, 0.0945, 0.0798, 0.1402, 0.0456, 0.1016, 0.0642, 0.0775,
        0.0994])
[rfa agg] iter:  9, prev_obj_val: 60.188682556152344, obj_val: 60.18519973754883, abs dis: 0.003482818603515625
[rfa agg] iter: 9, weight: tensor([0.1203, 0.1788, 0.0979, 0.0732, 0.1488, 0.0423, 0.1057, 0.0588, 0.0709,
        0.1034])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 11.2171, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 12.4458, Accuracy: 0/9950 (0.0000%)
saving model
Done in 703.1667242050171 sec.
Server Epoch:90 choose agents : [43, 80, 99, 44, 67, 39, 70, 50, 86, 91].
_Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   1, Avg loss: 0.0707, Accuracy: 207/946 (21.8816%)
_Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   2, Avg loss: 0.0406, Accuracy: 381/946 (40.2748%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.9116, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   1, Avg loss: 0.0717, Accuracy: 111/682 (16.2757%)
_Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   2, Avg loss: 0.0409, Accuracy: 268/682 (39.2962%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.9958, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   1, Avg loss: 0.0829, Accuracy: 113/773 (14.6184%)
_Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   2, Avg loss: 0.0333, Accuracy: 363/773 (46.9599%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.0613, Accuracy: 69/10000 (0.6900%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   1, Avg loss: 0.0715, Accuracy: 266/1750 (15.2000%)
_Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   2, Avg loss: 0.0393, Accuracy: 591/1750 (33.7714%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.2643, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   1, Avg loss: 0.0830, Accuracy: 31/426 (7.2770%)
_Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   2, Avg loss: 0.0470, Accuracy: 167/426 (39.2019%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.2699, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0629, Accuracy: 186/1013 (18.3613%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0280, Accuracy: 479/1013 (47.2853%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.6994, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0629, Accuracy: 343/1418 (24.1890%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0335, Accuracy: 584/1418 (41.1848%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.9461, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   1, Avg loss: 0.0657, Accuracy: 106/809 (13.1026%)
_Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   2, Avg loss: 0.0313, Accuracy: 291/809 (35.9703%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.5088, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   1, Avg loss: 0.0600, Accuracy: 344/1003 (34.2971%)
_Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   2, Avg loss: 0.0349, Accuracy: 408/1003 (40.6780%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.4552, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   1, Avg loss: 0.0695, Accuracy: 218/1030 (21.1650%)
_Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   2, Avg loss: 0.0299, Accuracy: 591/1030 (57.3786%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 11.8601, Accuracy: 91/10000 (0.9100%)
time spent on training: 233.5765779018402
[rfa agg] training data poison_ratio: 0.17766497461928935  data num: [946, 682, 773, 1750, 426, 1013, 1418, 809, 1003, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.11104060913705584
[rfa agg] init. name: [43, 80, 99, 44, 67, 39, 70, 50, 86, 91], weight: tensor([0.0960, 0.0692, 0.0785, 0.1777, 0.0432, 0.1028, 0.1440, 0.0821, 0.1018,
        0.1046])
[rfa agg] iter:  0, prev_obj_val: 56.65964126586914, obj_val: 59.80596923828125, abs dis: 3.1463279724121094
[rfa agg] iter: 0, weight: tensor([0.1510, 0.0613, 0.0795, 0.0639, 0.0221, 0.1625, 0.0795, 0.1044, 0.1759,
        0.0999])
[rfa agg] iter:  1, prev_obj_val: 59.80596923828125, obj_val: 63.72018814086914, abs dis: 3.9142189025878906
[rfa agg] iter: 1, weight: tensor([0.1550, 0.0787, 0.0915, 0.0566, 0.0260, 0.1436, 0.0672, 0.1423, 0.1520,
        0.0871])
[rfa agg] iter:  2, prev_obj_val: 63.72018814086914, obj_val: 63.702789306640625, abs dis: 0.017398834228515625
[rfa agg] iter: 2, weight: tensor([0.1416, 0.1004, 0.1009, 0.0559, 0.0311, 0.1244, 0.0648, 0.1695, 0.1292,
        0.0822])
[rfa agg] iter:  3, prev_obj_val: 63.702789306640625, obj_val: 63.70259475708008, abs dis: 0.000194549560546875
[rfa agg] iter: 3, weight: tensor([0.1402, 0.1016, 0.1014, 0.0556, 0.0310, 0.1228, 0.0644, 0.1738, 0.1275,
        0.0817])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.8807, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 10.0271, Accuracy: 0/9950 (0.0000%)
saving model
Done in 673.4697551727295 sec.
Server Epoch:91 choose agents : [33, 37, 28, 92, 97, 43, 56, 44, 24, 64].
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0896, Accuracy: 22/515 (4.2718%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0583, Accuracy: 148/515 (28.7379%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.9769, Accuracy: 56/10000 (0.5600%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   1, Avg loss: 0.0549, Accuracy: 340/1129 (30.1151%)
_Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   2, Avg loss: 0.0269, Accuracy: 653/1129 (57.8388%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.7564, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   1, Avg loss: 0.0637, Accuracy: 316/1581 (19.9873%)
_Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   2, Avg loss: 0.0372, Accuracy: 546/1581 (34.5351%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.8271, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   1, Avg loss: 0.0589, Accuracy: 396/1715 (23.0904%)
_Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   2, Avg loss: 0.0335, Accuracy: 655/1715 (38.1924%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.7591, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   1, Avg loss: 0.0685, Accuracy: 205/1213 (16.9002%)
_Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   2, Avg loss: 0.0306, Accuracy: 502/1213 (41.3850%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.3494, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0697, Accuracy: 230/946 (24.3129%)
_Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0409, Accuracy: 358/946 (37.8436%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.1943, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   1, Avg loss: 0.0952, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   2, Avg loss: 0.0757, Accuracy: 11/186 (5.9140%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.1657, Accuracy: 52/10000 (0.5200%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   1, Avg loss: 0.0703, Accuracy: 290/1750 (16.5714%)
_Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   2, Avg loss: 0.0388, Accuracy: 621/1750 (35.4857%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.2595, Accuracy: 111/10000 (1.1100%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.1008, Accuracy: 1/312 (0.3205%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0571, Accuracy: 85/312 (27.2436%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.6925, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   1, Avg loss: 0.0742, Accuracy: 91/953 (9.5488%)
_Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   2, Avg loss: 0.0405, Accuracy: 298/953 (31.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.7438, Accuracy: 67/10000 (0.6700%)
time spent on training: 273.2282221317291
[rfa agg] training data poison_ratio: 0.3598058252427184  data num: [515, 1129, 1581, 1715, 1213, 946, 186, 1750, 312, 953]
[rfa agg] considering poison per batch poison_fraction: 0.224878640776699
[rfa agg] init. name: [33, 37, 28, 92, 97, 43, 56, 44, 24, 64], weight: tensor([0.0500, 0.1096, 0.1535, 0.1665, 0.1178, 0.0918, 0.0181, 0.1699, 0.0303,
        0.0925])
[rfa agg] iter:  0, prev_obj_val: 67.68985748291016, obj_val: 66.12863159179688, abs dis: 1.5612258911132812
[rfa agg] iter: 0, weight: tensor([0.0315, 0.1688, 0.1117, 0.0952, 0.1973, 0.1402, 0.0068, 0.0909, 0.0135,
        0.1439])
[rfa agg] iter:  1, prev_obj_val: 66.12863159179688, obj_val: 67.39766693115234, abs dis: 1.2690353393554688
[rfa agg] iter: 1, weight: tensor([0.0289, 0.1742, 0.1137, 0.0950, 0.2208, 0.1279, 0.0064, 0.0908, 0.0126,
        0.1298])
[rfa agg] iter:  2, prev_obj_val: 67.39766693115234, obj_val: 67.39430236816406, abs dis: 0.00336456298828125
[rfa agg] iter: 2, weight: tensor([0.0303, 0.1739, 0.1075, 0.0910, 0.2120, 0.1383, 0.0066, 0.0870, 0.0131,
        0.1404])
[rfa agg] iter:  3, prev_obj_val: 67.39430236816406, obj_val: 68.87702941894531, abs dis: 1.48272705078125
[rfa agg] iter: 3, weight: tensor([0.0303, 0.1735, 0.1074, 0.0909, 0.2104, 0.1394, 0.0066, 0.0870, 0.0131,
        0.1414])
[rfa agg] iter:  4, prev_obj_val: 68.87702941894531, obj_val: 68.87053680419922, abs dis: 0.00649261474609375
[rfa agg] iter: 4, weight: tensor([0.0320, 0.1697, 0.1023, 0.0877, 0.1954, 0.1530, 0.0068, 0.0840, 0.0136,
        0.1555])
[rfa agg] iter:  5, prev_obj_val: 68.87053680419922, obj_val: 68.8703842163086, abs dis: 0.000152587890625
[rfa agg] iter: 5, weight: tensor([0.0320, 0.1685, 0.1021, 0.0876, 0.1931, 0.1550, 0.0068, 0.0839, 0.0136,
        0.1574])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.7813, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 10.6786, Accuracy: 1/9950 (0.0101%)
saving model
Done in 714.0750284194946 sec.
Server Epoch:92 choose agents : [71, 40, 7, 67, 97, 72, 34, 58, 26, 38].
_Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   1, Avg loss: 0.0756, Accuracy: 104/818 (12.7139%)
_Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   2, Avg loss: 0.0337, Accuracy: 326/818 (39.8533%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.5826, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0622, Accuracy: 315/1573 (20.0254%)
_Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0374, Accuracy: 576/1573 (36.6179%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.3010, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   1, Avg loss: 0.0630, Accuracy: 255/891 (28.6195%)
_Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   2, Avg loss: 0.0290, Accuracy: 433/891 (48.5971%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.5236, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0847, Accuracy: 25/426 (5.8685%)
_Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0482, Accuracy: 162/426 (38.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.7337, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   1, Avg loss: 0.0665, Accuracy: 202/1213 (16.6529%)
_Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   2, Avg loss: 0.0308, Accuracy: 511/1213 (42.1270%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.1278, Accuracy: 73/10000 (0.7300%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   1, Avg loss: 0.0645, Accuracy: 191/1241 (15.3908%)
_Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   2, Avg loss: 0.0395, Accuracy: 410/1241 (33.0379%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.7641, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   1, Avg loss: 0.0641, Accuracy: 308/1427 (21.5837%)
_Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   2, Avg loss: 0.0361, Accuracy: 561/1427 (39.3132%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.6390, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0664, Accuracy: 235/803 (29.2653%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0382, Accuracy: 428/803 (53.3001%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.5445, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   1, Avg loss: 0.0678, Accuracy: 244/1446 (16.8741%)
_Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   2, Avg loss: 0.0385, Accuracy: 455/1446 (31.4661%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.3410, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0671, Accuracy: 237/1131 (20.9549%)
_Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0336, Accuracy: 461/1131 (40.7604%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.3437, Accuracy: 86/10000 (0.8600%)
time spent on training: 250.7063045501709
[rfa agg] training data poison_ratio: 0.11313702251800528  data num: [818, 1573, 891, 426, 1213, 1241, 1427, 803, 1446, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0707106390737533
[rfa agg] init. name: [71, 40, 7, 67, 97, 72, 34, 58, 26, 38], weight: tensor([0.0746, 0.1434, 0.0812, 0.0388, 0.1106, 0.1131, 0.1301, 0.0732, 0.1318,
        0.1031])
[rfa agg] iter:  0, prev_obj_val: 55.05265808105469, obj_val: 56.56645202636719, abs dis: 1.5137939453125
[rfa agg] iter: 0, weight: tensor([0.0882, 0.0850, 0.1069, 0.0214, 0.1456, 0.1268, 0.0998, 0.0910, 0.1002,
        0.1350])
[rfa agg] iter:  1, prev_obj_val: 56.56645202636719, obj_val: 56.561767578125, abs dis: 0.0046844482421875
[rfa agg] iter: 1, weight: tensor([0.0970, 0.0805, 0.1169, 0.0226, 0.1407, 0.1195, 0.0938, 0.1006, 0.0944,
        0.1339])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 11.0432, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 11.1325, Accuracy: 0/9950 (0.0000%)
saving model
Done in 689.898313999176 sec.
Server Epoch:93 choose agents : [62, 58, 59, 51, 15, 43, 3, 13, 79, 53].
_Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.1173, Accuracy: 0/568 (0.0000%)
_Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0577, Accuracy: 225/568 (39.6127%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.4076, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   1, Avg loss: 0.0677, Accuracy: 225/803 (28.0199%)
_Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   2, Avg loss: 0.0390, Accuracy: 426/803 (53.0511%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.7842, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0622, Accuracy: 244/1089 (22.4059%)
_Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0300, Accuracy: 508/1089 (46.6483%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 11.2390, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   1, Avg loss: 0.0700, Accuracy: 159/1049 (15.1573%)
_Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   2, Avg loss: 0.0328, Accuracy: 451/1049 (42.9933%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.5818, Accuracy: 96/10000 (0.9600%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0678, Accuracy: 258/1154 (22.3570%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0351, Accuracy: 421/1154 (36.4818%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.9428, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   1, Avg loss: 0.0664, Accuracy: 234/946 (24.7357%)
_Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   2, Avg loss: 0.0406, Accuracy: 344/946 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.9233, Accuracy: 56/10000 (0.5600%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   1, Avg loss: 0.0782, Accuracy: 50/781 (6.4020%)
_Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   2, Avg loss: 0.0382, Accuracy: 253/781 (32.3944%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.8291, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   1, Avg loss: 0.0670, Accuracy: 295/1645 (17.9331%)
_Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   2, Avg loss: 0.0359, Accuracy: 565/1645 (34.3465%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.9813, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   1, Avg loss: 0.1353, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   2, Avg loss: 0.1110, Accuracy: 2/197 (1.0152%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.8527, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   1, Avg loss: 0.0586, Accuracy: 223/813 (27.4293%)
_Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   2, Avg loss: 0.0208, Accuracy: 443/813 (54.4895%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 13.1995, Accuracy: 54/10000 (0.5400%)
time spent on training: 240.1627926826477
[rfa agg] training data poison_ratio: 0.21393034825870647  data num: [568, 803, 1089, 1049, 1154, 946, 781, 1645, 197, 813]
[rfa agg] considering poison per batch poison_fraction: 0.13370646766169153
[rfa agg] init. name: [62, 58, 59, 51, 15, 43, 3, 13, 79, 53], weight: tensor([0.0628, 0.0888, 0.1204, 0.1160, 0.1276, 0.1046, 0.0863, 0.1819, 0.0218,
        0.0899])
[rfa agg] iter:  0, prev_obj_val: 58.500389099121094, obj_val: 60.891841888427734, abs dis: 2.3914527893066406
[rfa agg] iter: 0, weight: tensor([0.0497, 0.1335, 0.0829, 0.1266, 0.0994, 0.1682, 0.1237, 0.0814, 0.0094,
        0.1252])
[rfa agg] iter:  1, prev_obj_val: 60.891841888427734, obj_val: 62.41111755371094, abs dis: 1.5192756652832031
[rfa agg] iter: 1, weight: tensor([0.0584, 0.1658, 0.0683, 0.1023, 0.0799, 0.1559, 0.1472, 0.0665, 0.0098,
        0.1459])
[rfa agg] iter:  2, prev_obj_val: 62.41111755371094, obj_val: 62.40369415283203, abs dis: 0.00742340087890625
[rfa agg] iter: 2, weight: tensor([0.0635, 0.1779, 0.0648, 0.0944, 0.0750, 0.1440, 0.1544, 0.0634, 0.0101,
        0.1525])
[rfa agg] iter:  3, prev_obj_val: 62.40369415283203, obj_val: 62.403541564941406, abs dis: 0.000152587890625
[rfa agg] iter: 3, weight: tensor([0.0634, 0.1803, 0.0642, 0.0934, 0.0744, 0.1423, 0.1553, 0.0630, 0.0101,
        0.1537])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 11.6462, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 11.9519, Accuracy: 0/9950 (0.0000%)
saving model
Done in 676.1694371700287 sec.
Server Epoch:94 choose agents : [51, 3, 17, 5, 55, 92, 4, 75, 35, 60].
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0687, Accuracy: 174/1049 (16.5872%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0334, Accuracy: 451/1049 (42.9933%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.3889, Accuracy: 104/10000 (1.0400%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0756, Accuracy: 67/781 (8.5787%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0369, Accuracy: 258/781 (33.0346%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.7754, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   1, Avg loss: 0.0597, Accuracy: 293/1574 (18.6150%)
_Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   2, Avg loss: 0.0313, Accuracy: 564/1574 (35.8323%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.0502, Accuracy: 93/10000 (0.9300%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0648, Accuracy: 279/1628 (17.1376%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0300, Accuracy: 699/1628 (42.9361%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.5761, Accuracy: 128/10000 (1.2800%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   1, Avg loss: 0.0649, Accuracy: 200/1071 (18.6741%)
_Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   2, Avg loss: 0.0326, Accuracy: 503/1071 (46.9655%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.3078, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   1, Avg loss: 0.0574, Accuracy: 374/1715 (21.8076%)
_Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   2, Avg loss: 0.0335, Accuracy: 659/1715 (38.4257%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.8543, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0713, Accuracy: 199/901 (22.0866%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0419, Accuracy: 430/901 (47.7248%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.5812, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   1, Avg loss: 0.0786, Accuracy: 161/776 (20.7474%)
_Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   2, Avg loss: 0.0335, Accuracy: 406/776 (52.3196%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.2473, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.1037, Accuracy: 9/271 (3.3210%)
_Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0725, Accuracy: 68/271 (25.0923%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.4729, Accuracy: 53/10000 (0.5300%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   1, Avg loss: 0.0606, Accuracy: 496/2227 (22.2721%)
_Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   2, Avg loss: 0.0316, Accuracy: 891/2227 (40.0090%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.9984, Accuracy: 105/10000 (1.0500%)
time spent on training: 300.8310480117798
[rfa agg] training data poison_ratio: 0.47586091886934045  data num: [1049, 781, 1574, 1628, 1071, 1715, 901, 776, 271, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.2974130742933378
[rfa agg] init. name: [51, 3, 17, 5, 55, 92, 4, 75, 35, 60], weight: tensor([0.0875, 0.0651, 0.1312, 0.1357, 0.0893, 0.1430, 0.0751, 0.0647, 0.0226,
        0.1857])
[rfa agg] iter:  0, prev_obj_val: 76.52273559570312, obj_val: 78.26805877685547, abs dis: 1.7453231811523438
[rfa agg] iter: 0, weight: tensor([0.1152, 0.0595, 0.1734, 0.1529, 0.1244, 0.1322, 0.0830, 0.0575, 0.0104,
        0.0915])
[rfa agg] iter:  1, prev_obj_val: 78.26805877685547, obj_val: 80.62528991699219, abs dis: 2.3572311401367188
[rfa agg] iter: 1, weight: tensor([0.1309, 0.0664, 0.1524, 0.1352, 0.1434, 0.1184, 0.0939, 0.0640, 0.0110,
        0.0844])
[rfa agg] iter:  2, prev_obj_val: 80.62528991699219, obj_val: 81.98229217529297, abs dis: 1.3570022583007812
[rfa agg] iter: 2, weight: tensor([0.1436, 0.0744, 0.1311, 0.1182, 0.1600, 0.1059, 0.1057, 0.0712, 0.0115,
        0.0783])
[rfa agg] iter:  3, prev_obj_val: 81.98229217529297, obj_val: 80.60843658447266, abs dis: 1.3738555908203125
[rfa agg] iter: 3, weight: tensor([0.1490, 0.0788, 0.1212, 0.1102, 0.1675, 0.0996, 0.1119, 0.0750, 0.0117,
        0.0750])
[rfa agg] iter:  4, prev_obj_val: 80.60843658447266, obj_val: 81.98063659667969, abs dis: 1.3722000122070312
[rfa agg] iter: 4, weight: tensor([0.1462, 0.0741, 0.1293, 0.1167, 0.1633, 0.1045, 0.1059, 0.0710, 0.0114,
        0.0776])
[rfa agg] iter:  5, prev_obj_val: 81.98063659667969, obj_val: 80.60855865478516, abs dis: 1.3720779418945312
[rfa agg] iter: 5, weight: tensor([0.1494, 0.0787, 0.1211, 0.1100, 0.1680, 0.0994, 0.1118, 0.0749, 0.0117,
        0.0749])
[rfa agg] iter:  6, prev_obj_val: 80.60855865478516, obj_val: 81.98062896728516, abs dis: 1.3720703125
[rfa agg] iter: 6, weight: tensor([0.1462, 0.0741, 0.1293, 0.1167, 0.1634, 0.1045, 0.1059, 0.0710, 0.0114,
        0.0776])
[rfa agg] iter:  7, prev_obj_val: 81.98062896728516, obj_val: 80.60856628417969, abs dis: 1.3720626831054688
[rfa agg] iter: 7, weight: tensor([0.1494, 0.0787, 0.1211, 0.1100, 0.1681, 0.0994, 0.1118, 0.0749, 0.0117,
        0.0749])
[rfa agg] iter:  8, prev_obj_val: 80.60856628417969, obj_val: 81.98062133789062, abs dis: 1.3720550537109375
[rfa agg] iter: 8, weight: tensor([0.1462, 0.0741, 0.1293, 0.1167, 0.1634, 0.1045, 0.1059, 0.0710, 0.0114,
        0.0776])
[rfa agg] iter:  9, prev_obj_val: 81.98062133789062, obj_val: 80.60856628417969, abs dis: 1.3720550537109375
[rfa agg] iter: 9, weight: tensor([0.1494, 0.0787, 0.1211, 0.1100, 0.1681, 0.0994, 0.1118, 0.0749, 0.0117,
        0.0749])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 11.3971, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 11.2102, Accuracy: 0/9950 (0.0000%)
saving model
Done in 738.9367249011993 sec.
Server Epoch:95 choose agents : [54, 15, 1, 87, 63, 69, 60, 22, 43, 45].
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   1, Avg loss: 0.0628, Accuracy: 320/1130 (28.3186%)
_Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   2, Avg loss: 0.0332, Accuracy: 434/1130 (38.4071%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.0937, Accuracy: 57/10000 (0.5700%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   1, Avg loss: 0.0716, Accuracy: 247/1154 (21.4038%)
_Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   2, Avg loss: 0.0329, Accuracy: 398/1154 (34.4887%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.1662, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0580, Accuracy: 263/928 (28.3405%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0251, Accuracy: 563/928 (60.6681%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.3536, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   1, Avg loss: 0.0665, Accuracy: 215/1131 (19.0097%)
_Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   2, Avg loss: 0.0361, Accuracy: 341/1131 (30.1503%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.6166, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   1, Avg loss: 0.0737, Accuracy: 174/888 (19.5946%)
_Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   2, Avg loss: 0.0286, Accuracy: 385/888 (43.3559%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.5530, Accuracy: 68/10000 (0.6800%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   1, Avg loss: 0.0616, Accuracy: 208/590 (35.2542%)
_Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   2, Avg loss: 0.0311, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 13.3357, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   1, Avg loss: 0.0606, Accuracy: 527/2227 (23.6641%)
_Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   2, Avg loss: 0.0319, Accuracy: 873/2227 (39.2007%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.5339, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   1, Avg loss: 0.0589, Accuracy: 375/1470 (25.5102%)
_Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   2, Avg loss: 0.0271, Accuracy: 774/1470 (52.6531%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.7648, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   1, Avg loss: 0.0690, Accuracy: 223/946 (23.5729%)
_Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   2, Avg loss: 0.0394, Accuracy: 359/946 (37.9493%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.1677, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   1, Avg loss: 0.0719, Accuracy: 132/669 (19.7309%)
_Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   2, Avg loss: 0.0435, Accuracy: 358/669 (53.5127%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.1497, Accuracy: 79/10000 (0.7900%)
time spent on training: 289.05786991119385
[rfa agg] training data poison_ratio: 0.4581873708793677  data num: [1130, 1154, 928, 1131, 888, 590, 2227, 1470, 946, 669]
[rfa agg] considering poison per batch poison_fraction: 0.2863671067996048
[rfa agg] init. name: [54, 15, 1, 87, 63, 69, 60, 22, 43, 45], weight: tensor([0.1015, 0.1037, 0.0834, 0.1016, 0.0798, 0.0530, 0.2000, 0.1320, 0.0850,
        0.0601])
[rfa agg] iter:  0, prev_obj_val: 70.70177459716797, obj_val: 76.19522857666016, abs dis: 5.4934539794921875
[rfa agg] iter: 0, weight: tensor([0.1640, 0.1197, 0.0905, 0.1581, 0.0846, 0.0350, 0.0712, 0.1275, 0.1060,
        0.0435])
[rfa agg] iter:  1, prev_obj_val: 76.19522857666016, obj_val: 77.9177017211914, abs dis: 1.72247314453125
[rfa agg] iter: 1, weight: tensor([0.1313, 0.0936, 0.1113, 0.1267, 0.1315, 0.0504, 0.0563, 0.0837, 0.1521,
        0.0630])
[rfa agg] iter:  2, prev_obj_val: 77.9177017211914, obj_val: 76.04486846923828, abs dis: 1.872833251953125
[rfa agg] iter: 2, weight: tensor([0.1204, 0.0876, 0.1143, 0.1160, 0.1453, 0.0545, 0.0549, 0.0790, 0.1594,
        0.0687])
[rfa agg] iter:  3, prev_obj_val: 76.04486846923828, obj_val: 80.03471374511719, abs dis: 3.9898452758789062
[rfa agg] iter: 3, weight: tensor([0.1263, 0.0898, 0.1138, 0.1208, 0.1400, 0.0500, 0.0551, 0.0811, 0.1599,
        0.0632])
[rfa agg] iter:  4, prev_obj_val: 80.03471374511719, obj_val: 77.91097259521484, abs dis: 2.1237411499023438
[rfa agg] iter: 4, weight: tensor([0.1140, 0.0850, 0.1147, 0.1102, 0.1518, 0.0597, 0.0547, 0.0771, 0.1577,
        0.0751])
[rfa agg] iter:  5, prev_obj_val: 77.91097259521484, obj_val: 76.04606628417969, abs dis: 1.8649063110351562
[rfa agg] iter: 5, weight: tensor([0.1188, 0.0867, 0.1150, 0.1143, 0.1486, 0.0545, 0.0546, 0.0786, 0.1600,
        0.0690])
[rfa agg] iter:  6, prev_obj_val: 76.04606628417969, obj_val: 80.03446960449219, abs dis: 3.9884033203125
[rfa agg] iter: 6, weight: tensor([0.1261, 0.0897, 0.1139, 0.1206, 0.1404, 0.0500, 0.0551, 0.0811, 0.1600,
        0.0632])
[rfa agg] iter:  7, prev_obj_val: 80.03446960449219, obj_val: 77.9109878540039, abs dis: 2.1234817504882812
[rfa agg] iter: 7, weight: tensor([0.1139, 0.0850, 0.1147, 0.1102, 0.1519, 0.0597, 0.0547, 0.0771, 0.1577,
        0.0750])
[rfa agg] iter:  8, prev_obj_val: 77.9109878540039, obj_val: 76.04606628417969, abs dis: 1.8649215698242188
[rfa agg] iter: 8, weight: tensor([0.1188, 0.0867, 0.1150, 0.1143, 0.1486, 0.0545, 0.0546, 0.0786, 0.1600,
        0.0690])
[rfa agg] iter:  9, prev_obj_val: 76.04606628417969, obj_val: 80.03446197509766, abs dis: 3.9883956909179688
[rfa agg] iter: 9, weight: tensor([0.1261, 0.0897, 0.1139, 0.1206, 0.1404, 0.0500, 0.0551, 0.0811, 0.1600,
        0.0632])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 12.3915, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 13.4611, Accuracy: 0/9950 (0.0000%)
saving model
Done in 727.7110478878021 sec.
Server Epoch:96 choose agents : [12, 11, 52, 2, 65, 23, 68, 97, 82, 9].
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.1039, Accuracy: 12/338 (3.5503%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0645, Accuracy: 111/338 (32.8402%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.7261, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0787, Accuracy: 145/712 (20.3652%)
_Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0315, Accuracy: 437/712 (61.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.8552, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   1, Avg loss: 0.0667, Accuracy: 205/636 (32.2327%)
_Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   2, Avg loss: 0.0383, Accuracy: 429/636 (67.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.3919, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0788, Accuracy: 106/605 (17.5207%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0458, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.0394, Accuracy: 55/10000 (0.5500%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   1, Avg loss: 0.0674, Accuracy: 293/1475 (19.8644%)
_Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   2, Avg loss: 0.0354, Accuracy: 574/1475 (38.9153%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.6242, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   1, Avg loss: 0.0745, Accuracy: 175/715 (24.4755%)
_Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   2, Avg loss: 0.0427, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.8535, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   1, Avg loss: 0.0719, Accuracy: 240/1163 (20.6363%)
_Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   2, Avg loss: 0.0436, Accuracy: 419/1163 (36.0275%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.0232, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   1, Avg loss: 0.0624, Accuracy: 253/1213 (20.8574%)
_Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   2, Avg loss: 0.0316, Accuracy: 449/1213 (37.0157%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.2324, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0797, Accuracy: 32/500 (6.4000%)
_Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 203/500 (40.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.5524, Accuracy: 62/10000 (0.6200%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0577, Accuracy: 289/1275 (22.6667%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0219, Accuracy: 617/1275 (48.3922%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 11.9706, Accuracy: 93/10000 (0.9300%)
time spent on training: 245.01790118217468
[rfa agg] training data poison_ratio: 0.3577386468952734  data num: [338, 712, 636, 605, 1475, 715, 1163, 1213, 500, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.22358665430954588
[rfa agg] init. name: [12, 11, 52, 2, 65, 23, 68, 97, 82, 9], weight: tensor([0.0392, 0.0825, 0.0737, 0.0701, 0.1709, 0.0828, 0.1347, 0.1405, 0.0579,
        0.1477])
[rfa agg] iter:  0, prev_obj_val: 62.563995361328125, obj_val: 66.50333404541016, abs dis: 3.9393386840820312
[rfa agg] iter: 0, weight: tensor([0.0290, 0.1407, 0.0889, 0.0891, 0.0910, 0.1276, 0.1269, 0.1285, 0.0564,
        0.1220])
[rfa agg] iter:  1, prev_obj_val: 66.50333404541016, obj_val: 68.2425537109375, abs dis: 1.7392196655273438
[rfa agg] iter: 1, weight: tensor([0.0333, 0.1586, 0.1067, 0.1099, 0.0769, 0.1412, 0.1018, 0.1043, 0.0681,
        0.0991])
[rfa agg] iter:  2, prev_obj_val: 68.2425537109375, obj_val: 68.23811340332031, abs dis: 0.0044403076171875
[rfa agg] iter: 2, weight: tensor([0.0354, 0.1581, 0.1137, 0.1191, 0.0733, 0.1412, 0.0948, 0.0973, 0.0739,
        0.0930])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 13.7322, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 16.1506, Accuracy: 0/9950 (0.0000%)
saving model
Done in 680.6657748222351 sec.
Server Epoch:97 choose agents : [80, 34, 72, 81, 41, 77, 71, 35, 7, 4].
_Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   1, Avg loss: 0.0713, Accuracy: 105/682 (15.3959%)
_Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   2, Avg loss: 0.0419, Accuracy: 267/682 (39.1496%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.3974, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0615, Accuracy: 309/1427 (21.6538%)
_Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0366, Accuracy: 517/1427 (36.2299%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.5096, Accuracy: 76/10000 (0.7600%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0642, Accuracy: 205/1241 (16.5189%)
_Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0390, Accuracy: 414/1241 (33.3602%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.7081, Accuracy: 75/10000 (0.7500%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   1, Avg loss: 0.0738, Accuracy: 137/774 (17.7003%)
_Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   2, Avg loss: 0.0422, Accuracy: 324/774 (41.8605%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.4855, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0802, Accuracy: 153/719 (21.2796%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0383, Accuracy: 465/719 (64.6732%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.7236, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   1, Avg loss: 0.0637, Accuracy: 269/1340 (20.0746%)
_Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   2, Avg loss: 0.0310, Accuracy: 558/1340 (41.6418%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.1675, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   1, Avg loss: 0.0763, Accuracy: 99/818 (12.1027%)
_Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   2, Avg loss: 0.0355, Accuracy: 307/818 (37.5306%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.3322, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.1053, Accuracy: 2/271 (0.7380%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0694, Accuracy: 67/271 (24.7232%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.3911, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0636, Accuracy: 225/891 (25.2525%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0291, Accuracy: 454/891 (50.9540%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.4992, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   1, Avg loss: 0.0708, Accuracy: 210/901 (23.3074%)
_Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   2, Avg loss: 0.0387, Accuracy: 416/901 (46.1709%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.4756, Accuracy: 60/10000 (0.6000%)
time spent on training: 242.0145287513733
[rfa agg] training data poison_ratio: 0.2223080317740512  data num: [682, 1427, 1241, 774, 719, 1340, 818, 271, 891, 901]
[rfa agg] considering poison per batch poison_fraction: 0.138942519858782
[rfa agg] init. name: [80, 34, 72, 81, 41, 77, 71, 35, 7, 4], weight: tensor([0.0752, 0.1574, 0.1369, 0.0854, 0.0793, 0.1478, 0.0902, 0.0299, 0.0983,
        0.0994])
[rfa agg] iter:  0, prev_obj_val: 53.03040313720703, obj_val: 55.620689392089844, abs dis: 2.5902862548828125
[rfa agg] iter: 0, weight: tensor([0.0929, 0.0816, 0.1015, 0.1066, 0.0976, 0.0934, 0.1327, 0.0151, 0.1461,
        0.1325])
[rfa agg] iter:  1, prev_obj_val: 55.620689392089844, obj_val: 57.484344482421875, abs dis: 1.8636550903320312
[rfa agg] iter: 1, weight: tensor([0.1126, 0.0722, 0.0875, 0.1123, 0.1090, 0.0816, 0.1399, 0.0163, 0.1456,
        0.1230])
[rfa agg] iter:  2, prev_obj_val: 57.484344482421875, obj_val: 59.65991973876953, abs dis: 2.1755752563476562
[rfa agg] iter: 2, weight: tensor([0.1267, 0.0698, 0.0833, 0.1137, 0.1153, 0.0783, 0.1403, 0.0174, 0.1395,
        0.1158])
[rfa agg] iter:  3, prev_obj_val: 59.65991973876953, obj_val: 57.48237228393555, abs dis: 2.1775474548339844
[rfa agg] iter: 3, weight: tensor([0.1419, 0.0684, 0.0805, 0.1136, 0.1200, 0.0763, 0.1382, 0.0187, 0.1326,
        0.1098])
[rfa agg] iter:  4, prev_obj_val: 57.48237228393555, obj_val: 59.658592224121094, abs dis: 2.176219940185547
[rfa agg] iter: 4, weight: tensor([0.1299, 0.0695, 0.0830, 0.1142, 0.1168, 0.0780, 0.1394, 0.0174, 0.1374,
        0.1145])
[rfa agg] iter:  5, prev_obj_val: 59.658592224121094, obj_val: 57.48252868652344, abs dis: 2.1760635375976562
[rfa agg] iter: 5, weight: tensor([0.1423, 0.0684, 0.0805, 0.1137, 0.1202, 0.0762, 0.1380, 0.0187, 0.1323,
        0.1097])
[rfa agg] iter:  6, prev_obj_val: 57.48252868652344, obj_val: 59.658573150634766, abs dis: 2.176044464111328
[rfa agg] iter: 6, weight: tensor([0.1300, 0.0695, 0.0830, 0.1142, 0.1168, 0.0780, 0.1394, 0.0174, 0.1373,
        0.1145])
[rfa agg] iter:  7, prev_obj_val: 59.658573150634766, obj_val: 57.4825325012207, abs dis: 2.1760406494140625
[rfa agg] iter: 7, weight: tensor([0.1423, 0.0684, 0.0805, 0.1137, 0.1202, 0.0762, 0.1380, 0.0187, 0.1323,
        0.1097])
[rfa agg] iter:  8, prev_obj_val: 57.4825325012207, obj_val: 59.658573150634766, abs dis: 2.1760406494140625
[rfa agg] iter: 8, weight: tensor([0.1300, 0.0695, 0.0830, 0.1142, 0.1168, 0.0780, 0.1394, 0.0174, 0.1373,
        0.1145])
[rfa agg] iter:  9, prev_obj_val: 59.658573150634766, obj_val: 57.4825325012207, abs dis: 2.1760406494140625
[rfa agg] iter: 9, weight: tensor([0.1423, 0.0684, 0.0805, 0.1137, 0.1202, 0.0762, 0.1380, 0.0187, 0.1323,
        0.1097])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 13.9054, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 15.6413, Accuracy: 0/9950 (0.0000%)
saving model
Done in 680.8014373779297 sec.
Server Epoch:98 choose agents : [24, 6, 1, 16, 62, 2, 87, 17, 43, 18].
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.1060, Accuracy: 0/312 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0609, Accuracy: 77/312 (24.6795%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.5837, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   1, Avg loss: 0.0612, Accuracy: 319/1956 (16.3088%)
_Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   2, Avg loss: 0.0344, Accuracy: 628/1956 (32.1063%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.1572, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   1, Avg loss: 0.0576, Accuracy: 250/928 (26.9397%)
_Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   2, Avg loss: 0.0259, Accuracy: 532/928 (57.3276%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 11.1773, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0653, Accuracy: 217/708 (30.6497%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0394, Accuracy: 419/708 (59.1808%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.4820, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.1112, Accuracy: 4/568 (0.7042%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0561, Accuracy: 239/568 (42.0775%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.5553, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   1, Avg loss: 0.0780, Accuracy: 108/605 (17.8512%)
_Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   2, Avg loss: 0.0474, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.7536, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0653, Accuracy: 212/1131 (18.7445%)
_Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0356, Accuracy: 369/1131 (32.6260%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.3383, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   1, Avg loss: 0.0580, Accuracy: 288/1574 (18.2973%)
_Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   2, Avg loss: 0.0311, Accuracy: 580/1574 (36.8488%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.1532, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0667, Accuracy: 238/946 (25.1586%)
_Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0401, Accuracy: 336/946 (35.5180%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.2646, Accuracy: 64/10000 (0.6400%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   1, Avg loss: 0.0812, Accuracy: 50/530 (9.4340%)
_Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   2, Avg loss: 0.0419, Accuracy: 291/530 (54.9057%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.4881, Accuracy: 63/10000 (0.6300%)
time spent on training: 244.69250965118408
[rfa agg] training data poison_ratio: 0.09094836897818104  data num: [312, 1956, 928, 708, 568, 605, 1131, 1574, 946, 530]
[rfa agg] considering poison per batch poison_fraction: 0.05684273061136315
[rfa agg] init. name: [24, 6, 1, 16, 62, 2, 87, 17, 43, 18], weight: tensor([0.0337, 0.2113, 0.1002, 0.0765, 0.0614, 0.0653, 0.1222, 0.1700, 0.1022,
        0.0572])
[rfa agg] iter:  0, prev_obj_val: 74.80113983154297, obj_val: 76.69998168945312, abs dis: 1.8988418579101562
[rfa agg] iter: 0, weight: tensor([0.0173, 0.1022, 0.1284, 0.0757, 0.0465, 0.0546, 0.2283, 0.1406, 0.1636,
        0.0426])
[rfa agg] iter:  1, prev_obj_val: 76.69998168945312, obj_val: 77.63873291015625, abs dis: 0.938751220703125
[rfa agg] iter: 1, weight: tensor([0.0195, 0.0803, 0.1393, 0.0952, 0.0584, 0.0687, 0.1788, 0.1017, 0.2058,
        0.0523])
[rfa agg] iter:  2, prev_obj_val: 77.63873291015625, obj_val: 78.85308837890625, abs dis: 1.21435546875
[rfa agg] iter: 2, weight: tensor([0.0202, 0.0773, 0.1393, 0.1026, 0.0624, 0.0739, 0.1591, 0.0961, 0.2132,
        0.0559])
[rfa agg] iter:  3, prev_obj_val: 78.85308837890625, obj_val: 78.8487319946289, abs dis: 0.00435638427734375
[rfa agg] iter: 3, weight: tensor([0.0213, 0.0755, 0.1375, 0.1100, 0.0677, 0.0803, 0.1469, 0.0925, 0.2079,
        0.0603])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 13.3175, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 14.5839, Accuracy: 0/9950 (0.0000%)
saving model
Done in 681.3936874866486 sec.
Server Epoch:99 choose agents : [18, 14, 2, 45, 63, 95, 90, 4, 23, 8].
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   1, Avg loss: 0.0767, Accuracy: 72/530 (13.5849%)
_Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   2, Avg loss: 0.0431, Accuracy: 280/530 (52.8302%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.3567, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   1, Avg loss: 0.0813, Accuracy: 106/1013 (10.4640%)
_Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   2, Avg loss: 0.0406, Accuracy: 351/1013 (34.6496%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.3297, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   1, Avg loss: 0.0776, Accuracy: 93/605 (15.3719%)
_Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   2, Avg loss: 0.0466, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.8736, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   1, Avg loss: 0.0768, Accuracy: 122/669 (18.2362%)
_Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   2, Avg loss: 0.0437, Accuracy: 359/669 (53.6622%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.0645, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   1, Avg loss: 0.0782, Accuracy: 162/888 (18.2432%)
_Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   2, Avg loss: 0.0290, Accuracy: 377/888 (42.4550%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 10.7285, Accuracy: 60/10000 (0.6000%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0807, Accuracy: 131/599 (21.8698%)
_Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0332, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 15.7301, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   1, Avg loss: 0.0656, Accuracy: 185/677 (27.3264%)
_Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 11.9907, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   1, Avg loss: 0.0700, Accuracy: 229/901 (25.4162%)
_Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   2, Avg loss: 0.0372, Accuracy: 405/901 (44.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.3274, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0746, Accuracy: 174/715 (24.3357%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0420, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.7347, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   1, Avg loss: 0.0640, Accuracy: 205/1513 (13.5492%)
_Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   2, Avg loss: 0.0399, Accuracy: 398/1513 (26.3054%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.6691, Accuracy: 83/10000 (0.8300%)
time spent on training: 231.83382320404053
[rfa agg] training data poison_ratio: 0.13921085080147966  data num: [530, 1013, 605, 669, 888, 599, 677, 901, 715, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.08700678175092479
[rfa agg] init. name: [18, 14, 2, 45, 63, 95, 90, 4, 23, 8], weight: tensor([0.0654, 0.1249, 0.0746, 0.0825, 0.1095, 0.0739, 0.0835, 0.1111, 0.0882,
        0.1866])
[rfa agg] iter:  0, prev_obj_val: 51.779579162597656, obj_val: 55.907135009765625, abs dis: 4.127555847167969
[rfa agg] iter: 0, weight: tensor([0.0722, 0.1129, 0.0884, 0.1081, 0.1258, 0.0842, 0.1280, 0.1034, 0.1077,
        0.0694])
[rfa agg] iter:  1, prev_obj_val: 55.907135009765625, obj_val: 60.57234191894531, abs dis: 4.6652069091796875
[rfa agg] iter: 1, weight: tensor([0.0939, 0.0910, 0.1052, 0.1172, 0.1033, 0.0966, 0.1430, 0.0858, 0.1027,
        0.0612])
[rfa agg] iter:  2, prev_obj_val: 60.57234191894531, obj_val: 55.86957550048828, abs dis: 4.702766418457031
[rfa agg] iter: 2, weight: tensor([0.1146, 0.0841, 0.1131, 0.1156, 0.0939, 0.1036, 0.1377, 0.0798, 0.0970,
        0.0606])
[rfa agg] iter:  3, prev_obj_val: 55.86957550048828, obj_val: 60.56914520263672, abs dis: 4.6995697021484375
[rfa agg] iter: 3, weight: tensor([0.0976, 0.0889, 0.1064, 0.1181, 0.1002, 0.0975, 0.1465, 0.0836, 0.1007,
        0.0604])
[rfa agg] iter:  4, prev_obj_val: 60.56914520263672, obj_val: 55.869850158691406, abs dis: 4.6992950439453125
[rfa agg] iter: 4, weight: tensor([0.1151, 0.0839, 0.1131, 0.1156, 0.0936, 0.1037, 0.1382, 0.0796, 0.0967,
        0.0605])
[rfa agg] iter:  5, prev_obj_val: 55.869850158691406, obj_val: 60.569114685058594, abs dis: 4.6992645263671875
[rfa agg] iter: 5, weight: tensor([0.0977, 0.0889, 0.1064, 0.1181, 0.1002, 0.0975, 0.1466, 0.0836, 0.1007,
        0.0603])
[rfa agg] iter:  6, prev_obj_val: 60.569114685058594, obj_val: 55.86985397338867, abs dis: 4.699260711669922
[rfa agg] iter: 6, weight: tensor([0.1151, 0.0839, 0.1131, 0.1156, 0.0936, 0.1037, 0.1382, 0.0796, 0.0967,
        0.0605])
[rfa agg] iter:  7, prev_obj_val: 55.86985397338867, obj_val: 60.569114685058594, abs dis: 4.699260711669922
[rfa agg] iter: 7, weight: tensor([0.0977, 0.0889, 0.1064, 0.1181, 0.1002, 0.0975, 0.1466, 0.0836, 0.1007,
        0.0603])
[rfa agg] iter:  8, prev_obj_val: 60.569114685058594, obj_val: 55.86985397338867, abs dis: 4.699260711669922
[rfa agg] iter: 8, weight: tensor([0.1151, 0.0839, 0.1131, 0.1156, 0.0936, 0.1037, 0.1382, 0.0796, 0.0967,
        0.0605])
[rfa agg] iter:  9, prev_obj_val: 55.86985397338867, obj_val: 60.569122314453125, abs dis: 4.699268341064453
[rfa agg] iter: 9, weight: tensor([0.0977, 0.0889, 0.1064, 0.1181, 0.1002, 0.0975, 0.1466, 0.0836, 0.1007,
        0.0603])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 11.8809, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 14.3775, Accuracy: 0/9950 (0.0000%)
saving model
Done in 668.2593972682953 sec.
Server Epoch:100 choose agents : [57, 53, 36, 10, 37, 13, 40, 62, 39, 80].
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0648, Accuracy: 232/1154 (20.1040%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0312, Accuracy: 426/1154 (36.9151%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.0252, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0556, Accuracy: 207/813 (25.4613%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0208, Accuracy: 447/813 (54.9815%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 13.0137, Accuracy: 55/10000 (0.5500%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   1, Avg loss: 0.1031, Accuracy: 1/408 (0.2451%)
_Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   2, Avg loss: 0.0595, Accuracy: 118/408 (28.9216%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.7398, Accuracy: 56/10000 (0.5600%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   1, Avg loss: 0.0631, Accuracy: 150/861 (17.4216%)
_Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   2, Avg loss: 0.0247, Accuracy: 379/861 (44.0186%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.1286, Accuracy: 68/10000 (0.6800%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0560, Accuracy: 310/1129 (27.4579%)
_Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0281, Accuracy: 652/1129 (57.7502%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.2541, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   1, Avg loss: 0.0689, Accuracy: 300/1645 (18.2371%)
_Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   2, Avg loss: 0.0359, Accuracy: 571/1645 (34.7112%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.1971, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0615, Accuracy: 343/1573 (21.8055%)
_Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0374, Accuracy: 534/1573 (33.9479%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.6404, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   1, Avg loss: 0.1131, Accuracy: 2/568 (0.3521%)
_Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   2, Avg loss: 0.0558, Accuracy: 238/568 (41.9014%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.3236, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0574, Accuracy: 210/1013 (20.7305%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0282, Accuracy: 487/1013 (48.0750%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.3639, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   1, Avg loss: 0.0734, Accuracy: 77/682 (11.2903%)
_Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   2, Avg loss: 0.0403, Accuracy: 262/682 (38.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.9456, Accuracy: 51/10000 (0.5100%)
time spent on training: 267.9575698375702
[rfa agg] training data poison_ratio: 0.2435506804793825  data num: [1154, 813, 408, 861, 1129, 1645, 1573, 568, 1013, 682]
[rfa agg] considering poison per batch poison_fraction: 0.15221917529961407
[rfa agg] init. name: [57, 53, 36, 10, 37, 13, 40, 62, 39, 80], weight: tensor([0.1172, 0.0826, 0.0414, 0.0874, 0.1147, 0.1671, 0.1598, 0.0577, 0.1029,
        0.0693])
[rfa agg] iter:  0, prev_obj_val: 62.070518493652344, obj_val: 68.00688934326172, abs dis: 5.936370849609375
[rfa agg] iter: 0, weight: tensor([0.1018, 0.1115, 0.0248, 0.1328, 0.1456, 0.0896, 0.0940, 0.0436, 0.1873,
        0.0689])
[rfa agg] iter:  1, prev_obj_val: 68.00688934326172, obj_val: 67.89314270019531, abs dis: 0.11374664306640625
[rfa agg] iter: 1, weight: tensor([0.0815, 0.1595, 0.0317, 0.1577, 0.1091, 0.0713, 0.0737, 0.0602, 0.1544,
        0.1009])
[rfa agg] iter:  2, prev_obj_val: 67.89314270019531, obj_val: 67.8910903930664, abs dis: 0.00205230712890625
[rfa agg] iter: 2, weight: tensor([0.0790, 0.1693, 0.0314, 0.1622, 0.1052, 0.0697, 0.0721, 0.0601, 0.1485,
        0.1025])
[rfa agg] iter:  3, prev_obj_val: 67.8910903930664, obj_val: 69.81690979003906, abs dis: 1.9258193969726562
[rfa agg] iter: 3, weight: tensor([0.0786, 0.1710, 0.0313, 0.1628, 0.1047, 0.0695, 0.0719, 0.0600, 0.1475,
        0.1025])
[rfa agg] iter:  4, prev_obj_val: 69.81690979003906, obj_val: 69.81287384033203, abs dis: 0.00403594970703125
[rfa agg] iter: 4, weight: tensor([0.0765, 0.1768, 0.0338, 0.1585, 0.0998, 0.0680, 0.0702, 0.0660, 0.1372,
        0.1133])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 11.4947, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 14.2733, Accuracy: 0/9950 (0.0000%)
saving model
Done in 703.7113857269287 sec.
Saving all the graphs.
This run has a label: Jun.26_07.44.57. Visdom environment: tiny
