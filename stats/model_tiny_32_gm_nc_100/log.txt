current path: saved_models/model_tiny_Jun.29_22.06.36
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 3, 5, 9, 10, 12, 15, 18, 20, 24, 25, 30, 33, 36, 37, 42, 44, 48, 49, 54, 55, 60, 61, 65, 69, 72, 74, 78, 81, 84, 85, 95]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [37, 44, 94, 74, 82, 83, 41, 65, 26, 24].
poison local model 37 index 14 
_Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   1, Avg loss: 0.0529, Accuracy: 382/1129 (33.8353%)
_Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   2, Avg loss: 0.0254, Accuracy: 719/1129 (63.6847%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.2589, Accuracy: 103/10000 (1.0300%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 381/1750 (21.7714%)
_Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0358, Accuracy: 656/1750 (37.4857%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5301, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 346/1662 (20.8183%)
_Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 581/1662 (34.9579%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7741, Accuracy: 98/10000 (0.9800%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 506/1552 (32.6031%)
_Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 753/1552 (48.5180%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 10.2009, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 56/500 (11.2000%)
_Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   2, Avg loss: 0.0493, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5979, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0549, Accuracy: 394/1953 (20.1741%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 743/1953 (38.0440%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.8581, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   1, Avg loss: 0.0630, Accuracy: 318/719 (44.2281%)
_Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   2, Avg loss: 0.0308, Accuracy: 437/719 (60.7789%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.1926, Accuracy: 48/10000 (0.4800%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0574, Accuracy: 389/1475 (26.3729%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0308, Accuracy: 697/1475 (47.2542%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.7598, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 325/1446 (22.4758%)
_Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 493/1446 (34.0941%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.3148, Accuracy: 62/10000 (0.6200%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 27/312 (8.6538%)
_Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 168/312 (53.8462%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3861, Accuracy: 50/10000 (0.5000%)
time spent on training: 160.08244371414185
[rfa agg] training data poison_ratio: 0.49751960313650184  data num: [1129, 1750, 1662, 1552, 500, 1953, 719, 1475, 1446, 312]
[rfa agg] considering poison per batch poison_fraction: 0.31094975196031366
[rfa agg] init. name: [37, 44, 94, 74, 82, 83, 41, 65, 26, 24], weight: tensor([0.0903, 0.1400, 0.1330, 0.1242, 0.0400, 0.1563, 0.0575, 0.1180, 0.1157,
        0.0250])
[rfa agg] iter:  0, prev_obj_val: 54.72013473510742, obj_val: 52.21126937866211, abs dis: 2.5088653564453125
[rfa agg] iter: 0, weight: tensor([0.1289, 0.0899, 0.1186, 0.1367, 0.0139, 0.0707, 0.0289, 0.1693, 0.2359,
        0.0070])
[rfa agg] iter:  1, prev_obj_val: 52.21126937866211, obj_val: 52.20795440673828, abs dis: 0.003314971923828125
[rfa agg] iter: 1, weight: tensor([0.1001, 0.0859, 0.1166, 0.1379, 0.0119, 0.0661, 0.0244, 0.1788, 0.2722,
        0.0061])
			Update norm = 199.52327950016257 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 589.0038933753967 sec.
Server Epoch:2 choose agents : [94, 71, 66, 35, 38, 84, 42, 43, 11, 95].
_Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 342/1662 (20.5776%)
_Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 578/1662 (34.7774%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.7052, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   1, Avg loss: 0.0650, Accuracy: 154/818 (18.8264%)
_Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 370/818 (45.2323%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9572, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 250/1402 (17.8317%)
_Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   2, Avg loss: 0.0383, Accuracy: 372/1402 (26.5335%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9867, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   1, Avg loss: 0.0862, Accuracy: 36/271 (13.2841%)
_Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   2, Avg loss: 0.0569, Accuracy: 102/271 (37.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3587, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   1, Avg loss: 0.0625, Accuracy: 234/1131 (20.6897%)
_Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   2, Avg loss: 0.0318, Accuracy: 454/1131 (40.1415%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.3350, Accuracy: 70/10000 (0.7000%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0636, Accuracy: 314/1190 (26.3866%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 427/1190 (35.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8578, Accuracy: 58/10000 (0.5800%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 352/1372 (25.6560%)
_Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 504/1372 (36.7347%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6871, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0620, Accuracy: 295/946 (31.1839%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 362/946 (38.2664%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.9676, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   1, Avg loss: 0.0576, Accuracy: 348/712 (48.8764%)
_Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 403/712 (56.6011%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.3613, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   1, Avg loss: 0.0519, Accuracy: 328/599 (54.7579%)
_Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   2, Avg loss: 0.0301, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.8791, Accuracy: 50/10000 (0.5000%)
time spent on training: 152.81114411354065
[rfa agg] training data poison_ratio: 0.3128773631594576  data num: [1662, 818, 1402, 271, 1131, 1190, 1372, 946, 712, 599]
[rfa agg] considering poison per batch poison_fraction: 0.19554835197466097
[rfa agg] init. name: [94, 71, 66, 35, 38, 84, 42, 43, 11, 95], weight: tensor([0.1645, 0.0810, 0.1388, 0.0268, 0.1119, 0.1178, 0.1358, 0.0936, 0.0705,
        0.0593])
[rfa agg] iter:  0, prev_obj_val: 45.57881164550781, obj_val: 50.36916732788086, abs dis: 4.790355682373047
[rfa agg] iter: 0, weight: tensor([0.0622, 0.0816, 0.0898, 0.0083, 0.2286, 0.1547, 0.0875, 0.1991, 0.0556,
        0.0327])
[rfa agg] iter:  1, prev_obj_val: 50.36916732788086, obj_val: 54.65523147583008, abs dis: 4.286064147949219
[rfa agg] iter: 1, weight: tensor([0.0465, 0.1176, 0.0612, 0.0082, 0.1125, 0.0888, 0.0597, 0.3983, 0.0706,
        0.0365])
[rfa agg] iter:  2, prev_obj_val: 54.65523147583008, obj_val: 59.600990295410156, abs dis: 4.945758819580078
[rfa agg] iter: 2, weight: tensor([0.0463, 0.2185, 0.0583, 0.0099, 0.0922, 0.0776, 0.0569, 0.2803, 0.1107,
        0.0493])
[rfa agg] iter:  3, prev_obj_val: 59.600990295410156, obj_val: 59.539825439453125, abs dis: 0.06116485595703125
[rfa agg] iter: 3, weight: tensor([0.0379, 0.3754, 0.0460, 0.0098, 0.0660, 0.0578, 0.0450, 0.1342, 0.1701,
        0.0578])
[rfa agg] iter:  4, prev_obj_val: 59.539825439453125, obj_val: 65.65603637695312, abs dis: 6.1162109375
[rfa agg] iter: 4, weight: tensor([0.0342, 0.4361, 0.0415, 0.0089, 0.0594, 0.0521, 0.0405, 0.1183, 0.1569,
        0.0521])
[rfa agg] iter:  5, prev_obj_val: 65.65603637695312, obj_val: 69.04541015625, abs dis: 3.389373779296875
[rfa agg] iter: 5, weight: tensor([0.0380, 0.2393, 0.0448, 0.0120, 0.0597, 0.0538, 0.0438, 0.0979, 0.3201,
        0.0906])
[rfa agg] iter:  6, prev_obj_val: 69.04541015625, obj_val: 59.6117057800293, abs dis: 9.433704376220703
[rfa agg] iter: 6, weight: tensor([0.0402, 0.1773, 0.0468, 0.0142, 0.0605, 0.0551, 0.0457, 0.0928, 0.3382,
        0.1292])
[rfa agg] iter:  7, prev_obj_val: 59.6117057800293, obj_val: 62.44150161743164, abs dis: 2.8297958374023438
[rfa agg] iter: 7, weight: tensor([0.0379, 0.3611, 0.0460, 0.0098, 0.0658, 0.0577, 0.0449, 0.1307, 0.1879,
        0.0581])
[rfa agg] iter:  8, prev_obj_val: 62.44150161743164, obj_val: 65.6116943359375, abs dis: 3.1701927185058594
[rfa agg] iter: 8, weight: tensor([0.0360, 0.3344, 0.0431, 0.0103, 0.0593, 0.0528, 0.0421, 0.1061, 0.2483,
        0.0677])
[rfa agg] iter:  9, prev_obj_val: 65.6116943359375, obj_val: 72.66829681396484, abs dis: 7.056602478027344
[rfa agg] iter: 9, weight: tensor([0.0366, 0.2223, 0.0431, 0.0116, 0.0574, 0.0517, 0.0421, 0.0942, 0.3536,
        0.0876])
			Update norm = 110.58178446149032 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 598.7742414474487 sec.
Server Epoch:3 choose agents : [15, 88, 13, 42, 72, 22, 6, 0, 69, 17].
poison local model 15 index 6 
_Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0565, Accuracy: 317/1154 (27.4697%)
_Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0299, Accuracy: 397/1154 (34.4021%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7902, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   1, Avg loss: 0.0746, Accuracy: 132/603 (21.8905%)
_Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   2, Avg loss: 0.0465, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.8774, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0586, Accuracy: 295/1645 (17.9331%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 590/1645 (35.8663%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0698, Accuracy: 107/10000 (1.0700%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   1, Avg loss: 0.0538, Accuracy: 349/1372 (25.4373%)
_Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 504/1372 (36.7347%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8038, Accuracy: 70/10000 (0.7000%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   1, Avg loss: 0.0623, Accuracy: 265/1241 (21.3537%)
_Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 432/1241 (34.8106%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1078, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 514/1470 (34.9660%)
_Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 839/1470 (57.0748%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0900, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   1, Avg loss: 0.0551, Accuracy: 385/1956 (19.6830%)
_Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 655/1956 (33.4867%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.1550, Accuracy: 96/10000 (0.9600%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0583, Accuracy: 344/1657 (20.7604%)
_Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 526/1657 (31.7441%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5100, Accuracy: 56/10000 (0.5600%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0587, Accuracy: 270/590 (45.7627%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0308, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.6932, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 361/1574 (22.9352%)
_Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0283, Accuracy: 648/1574 (41.1690%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.3122, Accuracy: 87/10000 (0.8700%)
time spent on training: 186.70178413391113
[rfa agg] training data poison_ratio: 0.4534760971195898  data num: [1154, 603, 1645, 1372, 1241, 1470, 1956, 1657, 590, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.28342256069974364
[rfa agg] init. name: [15, 88, 13, 42, 72, 22, 6, 0, 69, 17], weight: tensor([0.0870, 0.0455, 0.1240, 0.1035, 0.0936, 0.1108, 0.1475, 0.1249, 0.0445,
        0.1187])
[rfa agg] iter:  0, prev_obj_val: 46.321006774902344, obj_val: 51.16694641113281, abs dis: 4.845939636230469
[rfa agg] iter: 0, weight: tensor([0.1437, 0.0129, 0.0665, 0.1744, 0.2808, 0.1230, 0.0419, 0.0669, 0.0126,
        0.0773])
[rfa agg] iter:  1, prev_obj_val: 51.16694641113281, obj_val: 51.13911056518555, abs dis: 0.027835845947265625
[rfa agg] iter: 1, weight: tensor([0.2366, 0.0138, 0.0547, 0.1137, 0.3252, 0.0885, 0.0371, 0.0550, 0.0135,
        0.0617])
[rfa agg] iter:  2, prev_obj_val: 51.13911056518555, obj_val: 54.13420104980469, abs dis: 2.9950904846191406
[rfa agg] iter: 2, weight: tensor([0.2500, 0.0134, 0.0532, 0.1094, 0.3255, 0.0858, 0.0360, 0.0534, 0.0132,
        0.0600])
[rfa agg] iter:  3, prev_obj_val: 54.13420104980469, obj_val: 57.3967399597168, abs dis: 3.2625389099121094
[rfa agg] iter: 3, weight: tensor([0.3267, 0.0157, 0.0548, 0.1029, 0.2463, 0.0839, 0.0383, 0.0550, 0.0154,
        0.0611])
[rfa agg] iter:  4, prev_obj_val: 57.3967399597168, obj_val: 51.160831451416016, abs dis: 6.235908508300781
[rfa agg] iter: 4, weight: tensor([0.3487, 0.0190, 0.0587, 0.1021, 0.2010, 0.0861, 0.0421, 0.0590, 0.0186,
        0.0647])
[rfa agg] iter:  5, prev_obj_val: 51.160831451416016, obj_val: 57.405677795410156, abs dis: 6.244846343994141
[rfa agg] iter: 5, weight: tensor([0.2842, 0.0136, 0.0536, 0.1097, 0.2884, 0.0866, 0.0363, 0.0538, 0.0133,
        0.0605])
[rfa agg] iter:  6, prev_obj_val: 57.405677795410156, obj_val: 51.15776443481445, abs dis: 6.247913360595703
[rfa agg] iter: 6, weight: tensor([0.3374, 0.0193, 0.0595, 0.1036, 0.2062, 0.0872, 0.0427, 0.0597, 0.0189,
        0.0656])
[rfa agg] iter:  7, prev_obj_val: 51.15776443481445, obj_val: 57.40643310546875, abs dis: 6.248668670654297
[rfa agg] iter: 7, weight: tensor([0.2812, 0.0136, 0.0537, 0.1099, 0.2908, 0.0867, 0.0364, 0.0539, 0.0133,
        0.0606])
[rfa agg] iter:  8, prev_obj_val: 57.40643310546875, obj_val: 51.15756607055664, abs dis: 6.248867034912109
[rfa agg] iter: 8, weight: tensor([0.3367, 0.0193, 0.0595, 0.1037, 0.2066, 0.0873, 0.0427, 0.0598, 0.0189,
        0.0656])
[rfa agg] iter:  9, prev_obj_val: 51.15756607055664, obj_val: 57.40648651123047, abs dis: 6.248920440673828
[rfa agg] iter: 9, weight: tensor([0.2810, 0.0136, 0.0537, 0.1099, 0.2909, 0.0867, 0.0364, 0.0539, 0.0133,
        0.0606])
			Update norm = 173.78504592599444 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 611.3554027080536 sec.
Server Epoch:4 choose agents : [31, 94, 47, 15, 11, 35, 62, 77, 21, 93].
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0822, Accuracy: 49/460 (10.6522%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0377, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.6846, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 348/1662 (20.9386%)
_Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 636/1662 (38.2671%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.6972, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   1, Avg loss: 0.1250, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   2, Avg loss: 0.1119, Accuracy: 10/134 (7.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3120, Accuracy: 50/10000 (0.5000%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   1, Avg loss: 0.0577, Accuracy: 313/1154 (27.1231%)
_Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 368/1154 (31.8891%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.6305, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   1, Avg loss: 0.0550, Accuracy: 342/712 (48.0337%)
_Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 408/712 (57.3034%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.2518, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   1, Avg loss: 0.0864, Accuracy: 39/271 (14.3911%)
_Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   2, Avg loss: 0.0570, Accuracy: 99/271 (36.5314%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3566, Accuracy: 36/10000 (0.3600%)
_Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0693, Accuracy: 135/568 (23.7676%)
_Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0418, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.6917, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 310/1340 (23.1343%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 556/1340 (41.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.4585, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 401/1949 (20.5747%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 632/1949 (32.4269%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.0738, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   1, Avg loss: 0.0565, Accuracy: 404/1742 (23.1917%)
_Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 711/1742 (40.8152%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.7043, Accuracy: 78/10000 (0.7800%)
time spent on training: 133.64240384101868
[rfa agg] training data poison_ratio: 0.11549239391513211  data num: [460, 1662, 134, 1154, 712, 271, 568, 1340, 1949, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.07218274619695757
[rfa agg] init. name: [31, 94, 47, 15, 11, 35, 62, 77, 21, 93], weight: tensor([0.0460, 0.1663, 0.0134, 0.1155, 0.0713, 0.0271, 0.0568, 0.1341, 0.1951,
        0.1743])
[rfa agg] iter:  0, prev_obj_val: 65.49801635742188, obj_val: 66.91680908203125, abs dis: 1.418792724609375
[rfa agg] iter: 0, weight: tensor([0.0145, 0.1039, 0.0030, 0.3071, 0.0337, 0.0068, 0.0196, 0.3624, 0.0670,
        0.0821])
[rfa agg] iter:  1, prev_obj_val: 66.91680908203125, obj_val: 68.67756652832031, abs dis: 1.7607574462890625
[rfa agg] iter: 1, weight: tensor([0.0143, 0.0908, 0.0029, 0.4126, 0.0339, 0.0067, 0.0194, 0.2859, 0.0605,
        0.0731])
[rfa agg] iter:  2, prev_obj_val: 68.67756652832031, obj_val: 70.78903198242188, abs dis: 2.1114654541015625
[rfa agg] iter: 2, weight: tensor([0.0138, 0.0781, 0.0027, 0.5257, 0.0335, 0.0064, 0.0188, 0.2034, 0.0537,
        0.0639])
[rfa agg] iter:  3, prev_obj_val: 70.78903198242188, obj_val: 70.78743743896484, abs dis: 0.00159454345703125
[rfa agg] iter: 3, weight: tensor([0.0155, 0.0783, 0.0030, 0.5389, 0.0387, 0.0071, 0.0212, 0.1769, 0.0554,
        0.0650])
[rfa agg] iter:  4, prev_obj_val: 70.78743743896484, obj_val: 70.78733825683594, abs dis: 9.918212890625e-05
[rfa agg] iter: 4, weight: tensor([0.0154, 0.0773, 0.0030, 0.5451, 0.0382, 0.0070, 0.0210, 0.1740, 0.0547,
        0.0643])
			Update norm = 173.68162998357082 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 555.2784404754639 sec.
Server Epoch:5 choose agents : [91, 78, 82, 2, 77, 31, 70, 65, 60, 36].
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0535, Accuracy: 340/1030 (33.0097%)
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0263, Accuracy: 639/1030 (62.0388%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.2361, Accuracy: 77/10000 (0.7700%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   1, Avg loss: 0.0846, Accuracy: 25/416 (6.0096%)
_Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   2, Avg loss: 0.0468, Accuracy: 182/416 (43.7500%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.5600, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 61/500 (12.2000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.6448, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0629, Accuracy: 224/605 (37.0248%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0387, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7725, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   1, Avg loss: 0.0545, Accuracy: 316/1340 (23.5821%)
_Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 544/1340 (40.5970%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.7118, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   1, Avg loss: 0.0820, Accuracy: 57/460 (12.3913%)
_Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   2, Avg loss: 0.0388, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.6954, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 330/1418 (23.2722%)
_Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 652/1418 (45.9803%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5296, Accuracy: 86/10000 (0.8600%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 384/1475 (26.0339%)
_Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   2, Avg loss: 0.0314, Accuracy: 656/1475 (44.4746%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.1222, Accuracy: 80/10000 (0.8000%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 534/2227 (23.9784%)
_Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   2, Avg loss: 0.0286, Accuracy: 995/2227 (44.6789%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.1228, Accuracy: 126/10000 (1.2600%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   1, Avg loss: 0.0880, Accuracy: 74/408 (18.1373%)
_Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   2, Avg loss: 0.0560, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.4720, Accuracy: 50/10000 (0.5000%)
time spent on training: 170.16310739517212
[rfa agg] training data poison_ratio: 0.4581435367952222  data num: [1030, 416, 500, 605, 1340, 460, 1418, 1475, 2227, 408]
[rfa agg] considering poison per batch poison_fraction: 0.28633971049701384
[rfa agg] init. name: [91, 78, 82, 2, 77, 31, 70, 65, 60, 36], weight: tensor([0.1043, 0.0421, 0.0506, 0.0612, 0.1356, 0.0466, 0.1435, 0.1493, 0.2254,
        0.0413])
[rfa agg] iter:  0, prev_obj_val: 74.15135955810547, obj_val: 75.46907806396484, abs dis: 1.317718505859375
[rfa agg] iter: 0, weight: tensor([0.2852, 0.0179, 0.0236, 0.0353, 0.2469, 0.0217, 0.1535, 0.1312, 0.0671,
        0.0176])
[rfa agg] iter:  1, prev_obj_val: 75.46907806396484, obj_val: 76.91970825195312, abs dis: 1.4506301879882812
[rfa agg] iter: 1, weight: tensor([0.3768, 0.0177, 0.0234, 0.0354, 0.2010, 0.0215, 0.1312, 0.1140, 0.0616,
        0.0174])
[rfa agg] iter:  2, prev_obj_val: 76.91970825195312, obj_val: 80.5123062133789, abs dis: 3.5925979614257812
[rfa agg] iter: 2, weight: tensor([0.4923, 0.0162, 0.0216, 0.0330, 0.1518, 0.0198, 0.1047, 0.0923, 0.0524,
        0.0159])
[rfa agg] iter:  3, prev_obj_val: 80.5123062133789, obj_val: 82.70610809326172, abs dis: 2.1938018798828125
[rfa agg] iter: 3, weight: tensor([0.5506, 0.0176, 0.0236, 0.0373, 0.1172, 0.0217, 0.0873, 0.0787, 0.0487,
        0.0172])
[rfa agg] iter:  4, prev_obj_val: 82.70610809326172, obj_val: 80.51644134521484, abs dis: 2.189666748046875
[rfa agg] iter: 4, weight: tensor([0.4627, 0.0230, 0.0311, 0.0500, 0.1312, 0.0286, 0.1006, 0.0916, 0.0588,
        0.0225])
[rfa agg] iter:  5, prev_obj_val: 80.51644134521484, obj_val: 82.7048110961914, abs dis: 2.1883697509765625
[rfa agg] iter: 5, weight: tensor([0.5437, 0.0179, 0.0240, 0.0379, 0.1190, 0.0221, 0.0886, 0.0799, 0.0494,
        0.0175])
[rfa agg] iter:  6, prev_obj_val: 82.7048110961914, obj_val: 80.51660919189453, abs dis: 2.188201904296875
[rfa agg] iter: 6, weight: tensor([0.4619, 0.0230, 0.0311, 0.0501, 0.1314, 0.0286, 0.1008, 0.0917, 0.0588,
        0.0226])
[rfa agg] iter:  7, prev_obj_val: 80.51660919189453, obj_val: 82.70477294921875, abs dis: 2.1881637573242188
[rfa agg] iter: 7, weight: tensor([0.5434, 0.0179, 0.0240, 0.0379, 0.1190, 0.0221, 0.0887, 0.0800, 0.0494,
        0.0175])
[rfa agg] iter:  8, prev_obj_val: 82.70477294921875, obj_val: 80.51661682128906, abs dis: 2.1881561279296875
[rfa agg] iter: 8, weight: tensor([0.4619, 0.0230, 0.0311, 0.0501, 0.1314, 0.0286, 0.1008, 0.0917, 0.0588,
        0.0226])
[rfa agg] iter:  9, prev_obj_val: 80.51661682128906, obj_val: 82.70475769042969, abs dis: 2.188140869140625
[rfa agg] iter: 9, weight: tensor([0.5434, 0.0179, 0.0240, 0.0379, 0.1190, 0.0221, 0.0887, 0.0800, 0.0494,
        0.0175])
			Update norm = 152.17106559108075 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 593.7447166442871 sec.
Server Epoch:6 choose agents : [63, 42, 69, 72, 83, 44, 79, 50, 66, 74].
_Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 258/888 (29.0541%)
_Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 414/888 (46.6216%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0318, Accuracy: 52/10000 (0.5200%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 347/1372 (25.2915%)
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 511/1372 (37.2449%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0286, Accuracy: 65/10000 (0.6500%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   1, Avg loss: 0.0572, Accuracy: 279/590 (47.2881%)
_Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.7721, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   1, Avg loss: 0.0621, Accuracy: 247/1241 (19.9033%)
_Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 416/1241 (33.5214%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.1133, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 440/1953 (22.5294%)
_Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 774/1953 (39.6313%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.3217, Accuracy: 79/10000 (0.7900%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0593, Accuracy: 369/1750 (21.0857%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 653/1750 (37.3143%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5629, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   1, Avg loss: 0.1015, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   2, Avg loss: 0.0781, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3223, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0636, Accuracy: 139/809 (17.1817%)
_Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0276, Accuracy: 335/809 (41.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.9278, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 256/1402 (18.2596%)
_Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 380/1402 (27.1041%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.2713, Accuracy: 72/10000 (0.7200%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 476/1552 (30.6701%)
_Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 768/1552 (49.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 10.5157, Accuracy: 82/10000 (0.8200%)
time spent on training: 187.582772731781
[rfa agg] training data poison_ratio: 0.5534286200442402  data num: [888, 1372, 590, 1241, 1953, 1750, 197, 809, 1402, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.34589288752765013
[rfa agg] init. name: [63, 42, 69, 72, 83, 44, 79, 50, 66, 74], weight: tensor([0.0755, 0.1167, 0.0502, 0.1056, 0.1662, 0.1489, 0.0168, 0.0688, 0.1193,
        0.1320])
[rfa agg] iter:  0, prev_obj_val: 50.62055206298828, obj_val: 56.17637634277344, abs dis: 5.555824279785156
[rfa agg] iter: 0, weight: tensor([0.0311, 0.2513, 0.0132, 0.2140, 0.0480, 0.0613, 0.0028, 0.0248, 0.2602,
        0.0931])
[rfa agg] iter:  1, prev_obj_val: 56.17637634277344, obj_val: 56.10769271850586, abs dis: 0.06868362426757812
[rfa agg] iter: 1, weight: tensor([0.0494, 0.1624, 0.0192, 0.3583, 0.0524, 0.0635, 0.0039, 0.0382, 0.1667,
        0.0860])
[rfa agg] iter:  2, prev_obj_val: 56.10769271850586, obj_val: 56.103477478027344, abs dis: 0.004215240478515625
[rfa agg] iter: 2, weight: tensor([0.0466, 0.1505, 0.0181, 0.4005, 0.0494, 0.0598, 0.0037, 0.0360, 0.1546,
        0.0809])
[rfa agg] iter:  3, prev_obj_val: 56.103477478027344, obj_val: 58.49098587036133, abs dis: 2.3875083923339844
[rfa agg] iter: 3, weight: tensor([0.0457, 0.1472, 0.0177, 0.4123, 0.0485, 0.0587, 0.0036, 0.0353, 0.1514,
        0.0795])
[rfa agg] iter:  4, prev_obj_val: 58.49098587036133, obj_val: 58.485164642333984, abs dis: 0.00582122802734375
[rfa agg] iter: 4, weight: tensor([0.0603, 0.1502, 0.0225, 0.3522, 0.0559, 0.0667, 0.0045, 0.0459, 0.1542,
        0.0878])
[rfa agg] iter:  5, prev_obj_val: 58.485164642333984, obj_val: 60.95405197143555, abs dis: 2.4688873291015625
[rfa agg] iter: 5, weight: tensor([0.0609, 0.1521, 0.0227, 0.3448, 0.0564, 0.0674, 0.0045, 0.0464, 0.1561,
        0.0887])
[rfa agg] iter:  6, prev_obj_val: 60.95405197143555, obj_val: 60.95063400268555, abs dis: 0.00341796875
[rfa agg] iter: 6, weight: tensor([0.0775, 0.1516, 0.0276, 0.2948, 0.0622, 0.0733, 0.0054, 0.0579, 0.1554,
        0.0943])
			Update norm = 173.62016844429394 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 605.9410157203674 sec.
Server Epoch:7 choose agents : [82, 90, 50, 35, 0, 79, 25, 37, 16, 60].
_Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0774, Accuracy: 62/500 (12.4000%)
_Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.5969, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0582, Accuracy: 310/677 (45.7903%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 449/677 (66.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.9416, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   1, Avg loss: 0.0639, Accuracy: 132/809 (16.3164%)
_Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 330/809 (40.7911%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.1004, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0856, Accuracy: 38/271 (14.0221%)
_Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0562, Accuracy: 98/271 (36.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3596, Accuracy: 47/10000 (0.4700%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   1, Avg loss: 0.0583, Accuracy: 364/1657 (21.9674%)
_Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 520/1657 (31.3820%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7958, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.1012, Accuracy: 16/197 (8.1218%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0854, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3212, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
_Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0571, Accuracy: 301/690 (43.6232%)
_Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.2957, Accuracy: 77/10000 (0.7700%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 404/1129 (35.7839%)
_Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 740/1129 (65.5447%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.5429, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   1, Avg loss: 0.0616, Accuracy: 270/708 (38.1356%)
_Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   2, Avg loss: 0.0386, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.7248, Accuracy: 55/10000 (0.5500%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 573/2227 (25.7297%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0285, Accuracy: 1010/2227 (45.3525%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.3033, Accuracy: 125/10000 (1.2500%)
time spent on training: 174.2896270751953
[rfa agg] training data poison_ratio: 0.6433164128595601  data num: [500, 677, 809, 271, 1657, 197, 690, 1129, 708, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.4020727580372251
[rfa agg] init. name: [82, 90, 50, 35, 0, 79, 25, 37, 16, 60], weight: tensor([0.0564, 0.0764, 0.0913, 0.0306, 0.1869, 0.0222, 0.0778, 0.1274, 0.0799,
        0.2512])
[rfa agg] iter:  0, prev_obj_val: 82.70502471923828, obj_val: 84.0260009765625, abs dis: 1.3209762573242188
[rfa agg] iter: 0, weight: tensor([0.0276, 0.0547, 0.0934, 0.0113, 0.1022, 0.0076, 0.0557, 0.5133, 0.0671,
        0.0670])
[rfa agg] iter:  1, prev_obj_val: 84.0260009765625, obj_val: 85.17524719238281, abs dis: 1.1492462158203125
[rfa agg] iter: 1, weight: tensor([0.0381, 0.0821, 0.1592, 0.0149, 0.1013, 0.0099, 0.0837, 0.3334, 0.1056,
        0.0720])
[rfa agg] iter:  2, prev_obj_val: 85.17524719238281, obj_val: 87.16139221191406, abs dis: 1.98614501953125
[rfa agg] iter: 2, weight: tensor([0.0421, 0.0991, 0.2254, 0.0158, 0.0891, 0.0104, 0.1009, 0.2163, 0.1348,
        0.0661])
[rfa agg] iter:  3, prev_obj_val: 87.16139221191406, obj_val: 92.99465942382812, abs dis: 5.8332672119140625
[rfa agg] iter: 3, weight: tensor([0.0353, 0.1032, 0.3841, 0.0123, 0.0519, 0.0079, 0.1047, 0.0966, 0.1633,
        0.0407])
[rfa agg] iter:  4, prev_obj_val: 92.99465942382812, obj_val: 98.29862213134766, abs dis: 5.303962707519531
[rfa agg] iter: 4, weight: tensor([0.0396, 0.2427, 0.1449, 0.0115, 0.0325, 0.0072, 0.2321, 0.0488, 0.2139,
        0.0270])
[rfa agg] iter:  5, prev_obj_val: 98.29862213134766, obj_val: 101.62860870361328, abs dis: 3.329986572265625
[rfa agg] iter: 5, weight: tensor([0.0594, 0.2989, 0.0961, 0.0146, 0.0330, 0.0089, 0.2829, 0.0461, 0.1320,
        0.0281])
[rfa agg] iter:  6, prev_obj_val: 101.62860870361328, obj_val: 95.26708221435547, abs dis: 6.3615264892578125
[rfa agg] iter: 6, weight: tensor([0.0950, 0.2499, 0.1057, 0.0209, 0.0418, 0.0125, 0.2482, 0.0565, 0.1334,
        0.0360])
[rfa agg] iter:  7, prev_obj_val: 95.26708221435547, obj_val: 98.2842025756836, abs dis: 3.017120361328125
[rfa agg] iter: 7, weight: tensor([0.0381, 0.3365, 0.0887, 0.0103, 0.0259, 0.0063, 0.3032, 0.0374, 0.1319,
        0.0218])
[rfa agg] iter:  8, prev_obj_val: 98.2842025756836, obj_val: 101.62957000732422, abs dis: 3.345367431640625
[rfa agg] iter: 8, weight: tensor([0.0575, 0.3071, 0.0927, 0.0142, 0.0320, 0.0087, 0.2906, 0.0446, 0.1253,
        0.0273])
[rfa agg] iter:  9, prev_obj_val: 101.62957000732422, obj_val: 95.26698303222656, abs dis: 6.362586975097656
[rfa agg] iter: 9, weight: tensor([0.0949, 0.2501, 0.1056, 0.0209, 0.0418, 0.0125, 0.2486, 0.0565, 0.1332,
        0.0360])
			Update norm = 109.85577814656587 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 594.5001769065857 sec.
Server Epoch:8 choose agents : [94, 35, 21, 1, 88, 43, 68, 27, 19, 92].
_Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 310/1662 (18.6522%)
_Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 611/1662 (36.7629%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.7158, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   1, Avg loss: 0.0859, Accuracy: 34/271 (12.5461%)
_Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   2, Avg loss: 0.0541, Accuracy: 103/271 (38.0074%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3607, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 408/1949 (20.9338%)
_Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 589/1949 (30.2206%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2388, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0580, Accuracy: 276/928 (29.7414%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 548/928 (59.0517%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.5740, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   1, Avg loss: 0.0749, Accuracy: 132/603 (21.8905%)
_Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   2, Avg loss: 0.0462, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.7875, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   1, Avg loss: 0.0617, Accuracy: 309/946 (32.6638%)
_Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 345/946 (36.4693%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.9401, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   1, Avg loss: 0.0627, Accuracy: 361/1163 (31.0404%)
_Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   2, Avg loss: 0.0369, Accuracy: 434/1163 (37.3173%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.6067, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 409/1587 (25.7719%)
_Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 611/1587 (38.5003%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.2288, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 373/1036 (36.0039%)
_Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   2, Avg loss: 0.0252, Accuracy: 656/1036 (63.3205%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 9.1448, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   1, Avg loss: 0.0525, Accuracy: 449/1715 (26.1808%)
_Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   2, Avg loss: 0.0313, Accuracy: 665/1715 (38.7755%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.4508, Accuracy: 88/10000 (0.8800%)
time spent on training: 145.1006965637207
[rfa agg] training data poison_ratio: 0.0  data num: [1662, 271, 1949, 928, 603, 946, 1163, 1587, 1036, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [94, 35, 21, 1, 88, 43, 68, 27, 19, 92], weight: tensor([0.1401, 0.0228, 0.1643, 0.0782, 0.0508, 0.0798, 0.0981, 0.1338, 0.0874,
        0.1446])
[rfa agg] iter:  0, prev_obj_val: 57.53213882446289, obj_val: 59.39300537109375, abs dis: 1.8608665466308594
[rfa agg] iter: 0, weight: tensor([0.1032, 0.0067, 0.0664, 0.0686, 0.0226, 0.0701, 0.3297, 0.1173, 0.1242,
        0.0912])
[rfa agg] iter:  1, prev_obj_val: 59.39300537109375, obj_val: 64.15767669677734, abs dis: 4.764671325683594
[rfa agg] iter: 1, weight: tensor([0.0647, 0.0053, 0.0444, 0.0619, 0.0183, 0.0632, 0.4827, 0.0718, 0.1294,
        0.0584])
[rfa agg] iter:  2, prev_obj_val: 64.15767669677734, obj_val: 64.02666473388672, abs dis: 0.131011962890625
[rfa agg] iter: 2, weight: tensor([0.0605, 0.0067, 0.0448, 0.1072, 0.0249, 0.1093, 0.2284, 0.0653, 0.2971,
        0.0559])
[rfa agg] iter:  3, prev_obj_val: 64.02666473388672, obj_val: 68.07719421386719, abs dis: 4.050529479980469
[rfa agg] iter: 3, weight: tensor([0.0573, 0.0063, 0.0424, 0.1026, 0.0236, 0.1053, 0.2014, 0.0619, 0.3463,
        0.0529])
[rfa agg] iter:  4, prev_obj_val: 68.07719421386719, obj_val: 73.02438354492188, abs dis: 4.9471893310546875
[rfa agg] iter: 4, weight: tensor([0.0496, 0.0066, 0.0381, 0.1490, 0.0262, 0.1547, 0.1254, 0.0528, 0.3514,
        0.0462])
[rfa agg] iter:  5, prev_obj_val: 73.02438354492188, obj_val: 72.9339828491211, abs dis: 0.09040069580078125
[rfa agg] iter: 5, weight: tensor([0.0440, 0.0071, 0.0350, 0.2538, 0.0302, 0.2761, 0.0897, 0.0464, 0.1762,
        0.0414])
[rfa agg] iter:  6, prev_obj_val: 72.9339828491211, obj_val: 70.44535827636719, abs dis: 2.4886245727539062
[rfa agg] iter: 6, weight: tensor([0.0411, 0.0066, 0.0327, 0.2734, 0.0283, 0.2963, 0.0835, 0.0434, 0.1559,
        0.0387])
[rfa agg] iter:  7, prev_obj_val: 70.44535827636719, obj_val: 72.94898986816406, abs dis: 2.503631591796875
[rfa agg] iter: 7, weight: tensor([0.0481, 0.0071, 0.0377, 0.2202, 0.0289, 0.2310, 0.1071, 0.0510, 0.2239,
        0.0451])
[rfa agg] iter:  8, prev_obj_val: 72.94898986816406, obj_val: 70.4422378540039, abs dis: 2.5067520141601562
[rfa agg] iter: 8, weight: tensor([0.0420, 0.0068, 0.0334, 0.2681, 0.0289, 0.2892, 0.0856, 0.0443, 0.1621,
        0.0396])
[rfa agg] iter:  9, prev_obj_val: 70.4422378540039, obj_val: 72.9493408203125, abs dis: 2.5071029663085938
[rfa agg] iter: 9, weight: tensor([0.0481, 0.0071, 0.0377, 0.2196, 0.0290, 0.2304, 0.1071, 0.0510, 0.2250,
        0.0451])
			Update norm = 148.12218483611764 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 561.4280967712402 sec.
Server Epoch:9 choose agents : [57, 42, 90, 21, 49, 84, 77, 18, 56, 65].
_Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   1, Avg loss: 0.0546, Accuracy: 302/1154 (26.1698%)
_Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   2, Avg loss: 0.0262, Accuracy: 487/1154 (42.2010%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.9318, Accuracy: 65/10000 (0.6500%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 354/1372 (25.8017%)
_Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 488/1372 (35.5685%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.9119, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0574, Accuracy: 312/677 (46.0857%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0236, Accuracy: 451/677 (66.6174%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.1998, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   1, Avg loss: 0.0542, Accuracy: 378/1949 (19.3946%)
_Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   2, Avg loss: 0.0336, Accuracy: 608/1949 (31.1955%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.0763, Accuracy: 73/10000 (0.7300%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   1, Avg loss: 0.0814, Accuracy: 16/440 (3.6364%)
_Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   2, Avg loss: 0.0486, Accuracy: 151/440 (34.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4939, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0631, Accuracy: 322/1190 (27.0588%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 442/1190 (37.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.8644, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 321/1340 (23.9552%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 523/1340 (39.0299%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.4713, Accuracy: 55/10000 (0.5500%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   1, Avg loss: 0.0772, Accuracy: 106/530 (20.0000%)
_Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   2, Avg loss: 0.0397, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.9329, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0682, Accuracy: 54/186 (29.0323%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3124, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0568, Accuracy: 386/1475 (26.1695%)
_Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0312, Accuracy: 684/1475 (46.3729%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.0829, Accuracy: 76/10000 (0.7600%)
time spent on training: 200.07959961891174
[rfa agg] training data poison_ratio: 0.48550373315233203  data num: [1154, 1372, 677, 1949, 440, 1190, 1340, 530, 186, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.3034398332202075
[rfa agg] init. name: [57, 42, 90, 21, 49, 84, 77, 18, 56, 65], weight: tensor([0.1119, 0.1330, 0.0656, 0.1890, 0.0427, 0.1154, 0.1299, 0.0514, 0.0180,
        0.1430])
[rfa agg] iter:  0, prev_obj_val: 56.28111267089844, obj_val: 58.81101989746094, abs dis: 2.5299072265625
[rfa agg] iter: 0, weight: tensor([0.2790, 0.1102, 0.0318, 0.0494, 0.0131, 0.2736, 0.1396, 0.0194, 0.0040,
        0.0799])
[rfa agg] iter:  1, prev_obj_val: 58.81101989746094, obj_val: 58.810211181640625, abs dis: 0.0008087158203125
[rfa agg] iter: 1, weight: tensor([0.2584, 0.1140, 0.0395, 0.0551, 0.0159, 0.2623, 0.1408, 0.0237, 0.0048,
        0.0855])
			Update norm = 165.13350422839696 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 618.0483593940735 sec.
Server Epoch:10 choose agents : [5, 23, 83, 66, 54, 46, 86, 78, 84, 8].
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0510, Accuracy: 429/1628 (26.3514%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 820/1628 (50.3686%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.2004, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   1, Avg loss: 0.0596, Accuracy: 313/715 (43.7762%)
_Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   2, Avg loss: 0.0391, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.7342, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 429/1953 (21.9662%)
_Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 742/1953 (37.9928%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.8876, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   1, Avg loss: 0.0622, Accuracy: 263/1402 (18.7589%)
_Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 384/1402 (27.3894%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.2160, Accuracy: 73/10000 (0.7300%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   1, Avg loss: 0.0555, Accuracy: 332/1130 (29.3805%)
_Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 475/1130 (42.0354%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6907, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   1, Avg loss: 0.0556, Accuracy: 402/1904 (21.1134%)
_Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 675/1904 (35.4517%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6752, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   1, Avg loss: 0.0644, Accuracy: 350/1003 (34.8953%)
_Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   2, Avg loss: 0.0358, Accuracy: 340/1003 (33.8983%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.7944, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   1, Avg loss: 0.0843, Accuracy: 27/416 (6.4904%)
_Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   2, Avg loss: 0.0479, Accuracy: 182/416 (43.7500%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.5433, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0632, Accuracy: 314/1190 (26.3866%)
_Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0329, Accuracy: 443/1190 (37.2269%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.0471, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 246/1513 (16.2591%)
_Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   2, Avg loss: 0.0369, Accuracy: 489/1513 (32.3199%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.1839, Accuracy: 86/10000 (0.8600%)
time spent on training: 197.5565528869629
[rfa agg] training data poison_ratio: 0.3395052123852497  data num: [1628, 715, 1953, 1402, 1130, 1904, 1003, 416, 1190, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.21219075774078108
[rfa agg] init. name: [5, 23, 83, 66, 54, 46, 86, 78, 84, 8], weight: tensor([0.1267, 0.0556, 0.1519, 0.1091, 0.0879, 0.1481, 0.0780, 0.0324, 0.0926,
        0.1177])
[rfa agg] iter:  0, prev_obj_val: 53.9135627746582, obj_val: 56.803531646728516, abs dis: 2.8899688720703125
[rfa agg] iter: 0, weight: tensor([0.0887, 0.0255, 0.0565, 0.2413, 0.1295, 0.0608, 0.0665, 0.0094, 0.1941,
        0.1277])
[rfa agg] iter:  1, prev_obj_val: 56.803531646728516, obj_val: 60.485511779785156, abs dis: 3.6819801330566406
[rfa agg] iter: 1, weight: tensor([0.0690, 0.0264, 0.0472, 0.1489, 0.1818, 0.0504, 0.0771, 0.0092, 0.2978,
        0.0922])
[rfa agg] iter:  2, prev_obj_val: 60.485511779785156, obj_val: 62.7851448059082, abs dis: 2.299633026123047
[rfa agg] iter: 2, weight: tensor([0.0528, 0.0268, 0.0383, 0.0953, 0.2838, 0.0406, 0.0922, 0.0088, 0.2945,
        0.0668])
[rfa agg] iter:  3, prev_obj_val: 62.7851448059082, obj_val: 65.41082763671875, abs dis: 2.625682830810547
[rfa agg] iter: 3, weight: tensor([0.0490, 0.0286, 0.0364, 0.0827, 0.3665, 0.0384, 0.1103, 0.0091, 0.2183,
        0.0606])
[rfa agg] iter:  4, prev_obj_val: 65.41082763671875, obj_val: 68.28074645996094, abs dis: 2.8699188232421875
[rfa agg] iter: 4, weight: tensor([0.0499, 0.0337, 0.0379, 0.0799, 0.3634, 0.0399, 0.1497, 0.0103, 0.1749,
        0.0606])
[rfa agg] iter:  5, prev_obj_val: 68.28074645996094, obj_val: 65.41668701171875, abs dis: 2.8640594482421875
[rfa agg] iter: 5, weight: tensor([0.0532, 0.0417, 0.0412, 0.0815, 0.2828, 0.0433, 0.2233, 0.0122, 0.1572,
        0.0636])
[rfa agg] iter:  6, prev_obj_val: 65.41668701171875, obj_val: 68.27743530273438, abs dis: 2.860748291015625
[rfa agg] iter: 6, weight: tensor([0.0509, 0.0344, 0.0386, 0.0815, 0.3478, 0.0407, 0.1585, 0.0105, 0.1753,
        0.0618])
[rfa agg] iter:  7, prev_obj_val: 68.27743530273438, obj_val: 65.41709899902344, abs dis: 2.8603363037109375
[rfa agg] iter: 7, weight: tensor([0.0532, 0.0417, 0.0413, 0.0816, 0.2810, 0.0433, 0.2247, 0.0122, 0.1574,
        0.0636])
[rfa agg] iter:  8, prev_obj_val: 65.41709899902344, obj_val: 68.27737426757812, abs dis: 2.8602752685546875
[rfa agg] iter: 8, weight: tensor([0.0509, 0.0344, 0.0387, 0.0816, 0.3473, 0.0407, 0.1586, 0.0105, 0.1754,
        0.0619])
[rfa agg] iter:  9, prev_obj_val: 68.27737426757812, obj_val: 65.4171142578125, abs dis: 2.860260009765625
[rfa agg] iter: 9, weight: tensor([0.0532, 0.0417, 0.0413, 0.0816, 0.2810, 0.0433, 0.2247, 0.0122, 0.1574,
        0.0636])
			Update norm = 165.13362250386805 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 617.2211174964905 sec.
Server Epoch:11 choose agents : [38, 24, 45, 8, 65, 19, 49, 17, 40, 22].
_Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   1, Avg loss: 0.0624, Accuracy: 239/1131 (21.1317%)
_Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 484/1131 (42.7940%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.2005, Accuracy: 79/10000 (0.7900%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0772, Accuracy: 27/312 (8.6538%)
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0414, Accuracy: 163/312 (52.2436%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3846, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   1, Avg loss: 0.0687, Accuracy: 195/669 (29.1480%)
_Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   2, Avg loss: 0.0413, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.8065, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   1, Avg loss: 0.0607, Accuracy: 227/1513 (15.0033%)
_Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 471/1513 (31.1302%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.2376, Accuracy: 106/10000 (1.0600%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   1, Avg loss: 0.0570, Accuracy: 383/1475 (25.9661%)
_Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   2, Avg loss: 0.0309, Accuracy: 697/1475 (47.2542%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.7868, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   1, Avg loss: 0.0472, Accuracy: 388/1036 (37.4517%)
_Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   2, Avg loss: 0.0240, Accuracy: 674/1036 (65.0579%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.9832, Accuracy: 55/10000 (0.5500%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   1, Avg loss: 0.0809, Accuracy: 27/440 (6.1364%)
_Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   2, Avg loss: 0.0484, Accuracy: 151/440 (34.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.4810, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 371/1574 (23.5705%)
_Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 676/1574 (42.9479%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.4104, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 359/1573 (22.8226%)
_Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   2, Avg loss: 0.0351, Accuracy: 555/1573 (35.2829%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.4128, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   1, Avg loss: 0.0466, Accuracy: 488/1470 (33.1973%)
_Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   2, Avg loss: 0.0234, Accuracy: 867/1470 (58.9796%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9534, Accuracy: 81/10000 (0.8100%)
time spent on training: 191.43685364723206
[rfa agg] training data poison_ratio: 0.19896363798802824  data num: [1131, 312, 669, 1513, 1475, 1036, 440, 1574, 1573, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.12435227374251764
[rfa agg] init. name: [38, 24, 45, 8, 65, 19, 49, 17, 40, 22], weight: tensor([0.1010, 0.0279, 0.0598, 0.1352, 0.1318, 0.0926, 0.0393, 0.1406, 0.1405,
        0.1313])
[rfa agg] iter:  0, prev_obj_val: 45.781211853027344, obj_val: 47.39044952392578, abs dis: 1.6092376708984375
[rfa agg] iter: 0, weight: tensor([0.2294, 0.0077, 0.0281, 0.1178, 0.1142, 0.1413, 0.0126, 0.1019, 0.1012,
        0.1458])
[rfa agg] iter:  1, prev_obj_val: 47.39044952392578, obj_val: 51.046566009521484, abs dis: 3.656116485595703
[rfa agg] iter: 1, weight: tensor([0.2960, 0.0075, 0.0281, 0.1001, 0.0971, 0.1626, 0.0123, 0.0879, 0.0873,
        0.1210])
[rfa agg] iter:  2, prev_obj_val: 51.046566009521484, obj_val: 53.30908966064453, abs dis: 2.262523651123047
[rfa agg] iter: 2, weight: tensor([0.4089, 0.0064, 0.0255, 0.0669, 0.0649, 0.2188, 0.0107, 0.0602, 0.0599,
        0.0778])
[rfa agg] iter:  3, prev_obj_val: 53.30908966064453, obj_val: 58.903202056884766, abs dis: 5.594112396240234
[rfa agg] iter: 3, weight: tensor([0.3684, 0.0064, 0.0265, 0.0599, 0.0581, 0.2926, 0.0109, 0.0544, 0.0541,
        0.0686])
[rfa agg] iter:  4, prev_obj_val: 58.903202056884766, obj_val: 53.31248474121094, abs dis: 5.590717315673828
[rfa agg] iter: 4, weight: tensor([0.2244, 0.0087, 0.0390, 0.0651, 0.0632, 0.3917, 0.0150, 0.0601, 0.0599,
        0.0729])
[rfa agg] iter:  5, prev_obj_val: 53.31248474121094, obj_val: 58.87746810913086, abs dis: 5.564983367919922
[rfa agg] iter: 5, weight: tensor([0.3039, 0.0065, 0.0266, 0.0601, 0.0583, 0.3559, 0.0109, 0.0546, 0.0543,
        0.0689])
[rfa agg] iter:  6, prev_obj_val: 58.87746810913086, obj_val: 62.04521942138672, abs dis: 3.1677513122558594
[rfa agg] iter: 6, weight: tensor([0.2147, 0.0085, 0.0381, 0.0635, 0.0617, 0.4106, 0.0146, 0.0587, 0.0584,
        0.0711])
[rfa agg] iter:  7, prev_obj_val: 62.04521942138672, obj_val: 53.3188591003418, abs dis: 8.726360321044922
[rfa agg] iter: 7, weight: tensor([0.2035, 0.0109, 0.0513, 0.0732, 0.0712, 0.3539, 0.0189, 0.0680, 0.0678,
        0.0813])
[rfa agg] iter:  8, prev_obj_val: 53.3188591003418, obj_val: 62.05289840698242, abs dis: 8.734039306640625
[rfa agg] iter: 8, weight: tensor([0.3046, 0.0066, 0.0270, 0.0609, 0.0591, 0.3506, 0.0110, 0.0553, 0.0551,
        0.0698])
[rfa agg] iter:  9, prev_obj_val: 62.05289840698242, obj_val: 55.904903411865234, abs dis: 6.1479949951171875
[rfa agg] iter: 9, weight: tensor([0.2088, 0.0110, 0.0517, 0.0738, 0.0718, 0.3450, 0.0191, 0.0686, 0.0684,
        0.0819])
			Update norm = 160.73854814379467 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 613.4534199237823 sec.
Server Epoch:12 choose agents : [56, 30, 69, 47, 51, 48, 92, 84, 32, 22].
_Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 60/186 (32.2581%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3122, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0823, Accuracy: 59/486 (12.1399%)
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7483, Accuracy: 47/10000 (0.4700%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   1, Avg loss: 0.0564, Accuracy: 276/590 (46.7797%)
_Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.7578, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   1, Avg loss: 0.1273, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   2, Avg loss: 0.1083, Accuracy: 5/134 (3.7313%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3093, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   1, Avg loss: 0.0606, Accuracy: 217/1049 (20.6864%)
_Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   2, Avg loss: 0.0312, Accuracy: 488/1049 (46.5205%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.3918, Accuracy: 66/10000 (0.6600%)
poison local model 48 index 17 
_Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   1, Avg loss: 0.0711, Accuracy: 94/631 (14.8970%)
_Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   2, Avg loss: 0.0414, Accuracy: 213/631 (33.7559%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7605, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 445/1715 (25.9475%)
_Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 680/1715 (39.6501%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.4201, Accuracy: 101/10000 (1.0100%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   1, Avg loss: 0.0626, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 440/1190 (36.9748%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.9099, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0613, Accuracy: 196/735 (26.6667%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 332/735 (45.1701%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.7562, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 521/1470 (35.4422%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 850/1470 (57.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0466, Accuracy: 62/10000 (0.6200%)
time spent on training: 172.91668105125427
[rfa agg] training data poison_ratio: 0.35389689714146105  data num: [186, 486, 590, 134, 1049, 631, 1715, 1190, 735, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.22118556071341317
[rfa agg] init. name: [56, 30, 69, 47, 51, 48, 92, 84, 32, 22], weight: tensor([0.0227, 0.0594, 0.0721, 0.0164, 0.1281, 0.0771, 0.2095, 0.1454, 0.0898,
        0.1796])
[rfa agg] iter:  0, prev_obj_val: 57.96764373779297, obj_val: 59.219322204589844, abs dis: 1.251678466796875
[rfa agg] iter: 0, weight: tensor([0.0070, 0.0304, 0.0491, 0.0051, 0.3933, 0.0525, 0.0783, 0.1883, 0.0911,
        0.1048])
[rfa agg] iter:  1, prev_obj_val: 59.219322204589844, obj_val: 60.624603271484375, abs dis: 1.4052810668945312
[rfa agg] iter: 1, weight: tensor([0.0079, 0.0352, 0.0579, 0.0057, 0.3533, 0.0619, 0.0812, 0.1786, 0.1121,
        0.1061])
[rfa agg] iter:  2, prev_obj_val: 60.624603271484375, obj_val: 62.04804992675781, abs dis: 1.4234466552734375
[rfa agg] iter: 2, weight: tensor([0.0090, 0.0409, 0.0691, 0.0065, 0.2958, 0.0739, 0.0845, 0.1712, 0.1413,
        0.1081])
[rfa agg] iter:  3, prev_obj_val: 62.04804992675781, obj_val: 63.48796844482422, abs dis: 1.4399185180664062
[rfa agg] iter: 3, weight: tensor([0.0097, 0.0457, 0.0796, 0.0070, 0.2489, 0.0851, 0.0843, 0.1590, 0.1748,
        0.1058])
[rfa agg] iter:  4, prev_obj_val: 63.48796844482422, obj_val: 64.94365692138672, abs dis: 1.4556884765625
[rfa agg] iter: 4, weight: tensor([0.0101, 0.0494, 0.0892, 0.0073, 0.2088, 0.0954, 0.0810, 0.1435, 0.2154,
        0.0999])
[rfa agg] iter:  5, prev_obj_val: 64.94365692138672, obj_val: 66.41986083984375, abs dis: 1.4762039184570312
[rfa agg] iter: 5, weight: tensor([0.0101, 0.0515, 0.0971, 0.0073, 0.1721, 0.1039, 0.0746, 0.1251, 0.2679,
        0.0905])
[rfa agg] iter:  6, prev_obj_val: 66.41986083984375, obj_val: 67.93669128417969, abs dis: 1.5168304443359375
[rfa agg] iter: 6, weight: tensor([0.0095, 0.0509, 0.1014, 0.0068, 0.1360, 0.1085, 0.0647, 0.1034, 0.3414,
        0.0774])
[rfa agg] iter:  7, prev_obj_val: 67.93669128417969, obj_val: 73.97185516357422, abs dis: 6.035163879394531
[rfa agg] iter: 7, weight: tensor([0.0081, 0.0457, 0.0975, 0.0058, 0.0981, 0.1044, 0.0506, 0.0774, 0.4526,
        0.0597])
[rfa agg] iter:  8, prev_obj_val: 73.97185516357422, obj_val: 73.9256591796875, abs dis: 0.04619598388671875
[rfa agg] iter: 8, weight: tensor([0.0091, 0.0648, 0.1992, 0.0065, 0.0711, 0.2134, 0.0440, 0.0606, 0.2811,
        0.0502])
[rfa agg] iter:  9, prev_obj_val: 73.9256591796875, obj_val: 71.69905090332031, abs dis: 2.2266082763671875
[rfa agg] iter: 9, weight: tensor([0.0090, 0.0644, 0.2089, 0.0065, 0.0702, 0.2239, 0.0434, 0.0598, 0.2644,
        0.0496])
			Update norm = 113.80271357567666 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 590.6163370609283 sec.
Server Epoch:13 choose agents : [53, 15, 3, 23, 83, 11, 27, 76, 70, 35].
_Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   1, Avg loss: 0.0499, Accuracy: 282/813 (34.6863%)
_Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 459/813 (56.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.9855, Accuracy: 54/10000 (0.5400%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0578, Accuracy: 312/1154 (27.0364%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 432/1154 (37.4350%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.9604, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   1, Avg loss: 0.0755, Accuracy: 104/781 (13.3163%)
_Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 221/781 (28.2971%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.5753, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0603, Accuracy: 310/715 (43.3566%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.7297, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 420/1953 (21.5054%)
_Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 740/1953 (37.8904%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.6761, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   1, Avg loss: 0.0547, Accuracy: 348/712 (48.8764%)
_Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   2, Avg loss: 0.0258, Accuracy: 428/712 (60.1124%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.4050, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 432/1587 (27.2212%)
_Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 594/1587 (37.4291%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.0333, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0867, Accuracy: 31/466 (6.6524%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0518, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.5957, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0559, Accuracy: 340/1418 (23.9774%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0320, Accuracy: 613/1418 (43.2299%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.5850, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0852, Accuracy: 38/271 (14.0221%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0584, Accuracy: 101/271 (37.2694%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3607, Accuracy: 54/10000 (0.5400%)
time spent on training: 174.0406792163849
[rfa agg] training data poison_ratio: 0.196048632218845  data num: [813, 1154, 781, 715, 1953, 712, 1587, 466, 1418, 271]
[rfa agg] considering poison per batch poison_fraction: 0.12253039513677813
[rfa agg] init. name: [53, 15, 3, 23, 83, 11, 27, 76, 70, 35], weight: tensor([0.0824, 0.1169, 0.0791, 0.0724, 0.1979, 0.0721, 0.1608, 0.0472, 0.1437,
        0.0275])
[rfa agg] iter:  0, prev_obj_val: 63.84996032714844, obj_val: 65.78936004638672, abs dis: 1.9393997192382812
[rfa agg] iter: 0, weight: tensor([0.0759, 0.4007, 0.0727, 0.0557, 0.0707, 0.0556, 0.1060, 0.0219, 0.1309,
        0.0097])
[rfa agg] iter:  1, prev_obj_val: 65.78936004638672, obj_val: 68.98226928710938, abs dis: 3.1929092407226562
[rfa agg] iter: 1, weight: tensor([0.1067, 0.2957, 0.1022, 0.0755, 0.0746, 0.0754, 0.1056, 0.0276, 0.1247,
        0.0120])
[rfa agg] iter:  2, prev_obj_val: 68.98226928710938, obj_val: 70.05162811279297, abs dis: 1.0693588256835938
[rfa agg] iter: 2, weight: tensor([0.1643, 0.1705, 0.1566, 0.1049, 0.0664, 0.1050, 0.0877, 0.0325, 0.0988,
        0.0134])
[rfa agg] iter:  3, prev_obj_val: 70.05162811279297, obj_val: 75.258544921875, abs dis: 5.206916809082031
[rfa agg] iter: 3, weight: tensor([0.1888, 0.1379, 0.1794, 0.1128, 0.0596, 0.1132, 0.0772, 0.0323, 0.0859,
        0.0130])
[rfa agg] iter:  4, prev_obj_val: 75.258544921875, obj_val: 83.50048065185547, abs dis: 8.241935729980469
[rfa agg] iter: 4, weight: tensor([0.3031, 0.0448, 0.2619, 0.1326, 0.0255, 0.1387, 0.0310, 0.0215, 0.0332,
        0.0078])
[rfa agg] iter:  5, prev_obj_val: 83.50048065185547, obj_val: 87.03594207763672, abs dis: 3.53546142578125
[rfa agg] iter: 5, weight: tensor([0.1565, 0.0467, 0.1475, 0.2337, 0.0306, 0.2597, 0.0359, 0.0395, 0.0376,
        0.0123])
[rfa agg] iter:  6, prev_obj_val: 87.03594207763672, obj_val: 80.1563491821289, abs dis: 6.8795928955078125
[rfa agg] iter: 6, weight: tensor([0.1471, 0.0545, 0.1398, 0.2251, 0.0371, 0.2353, 0.0430, 0.0568, 0.0448,
        0.0166])
[rfa agg] iter:  7, prev_obj_val: 80.1563491821289, obj_val: 87.03831481933594, abs dis: 6.881965637207031
[rfa agg] iter: 7, weight: tensor([0.1598, 0.0384, 0.1486, 0.2481, 0.0242, 0.2863, 0.0287, 0.0268, 0.0302,
        0.0089])
[rfa agg] iter:  8, prev_obj_val: 87.03831481933594, obj_val: 80.15625762939453, abs dis: 6.882057189941406
[rfa agg] iter: 8, weight: tensor([0.1468, 0.0544, 0.1395, 0.2252, 0.0371, 0.2363, 0.0430, 0.0566, 0.0447,
        0.0165])
[rfa agg] iter:  9, prev_obj_val: 80.15625762939453, obj_val: 87.038330078125, abs dis: 6.882072448730469
[rfa agg] iter: 9, weight: tensor([0.1598, 0.0384, 0.1486, 0.2480, 0.0242, 0.2866, 0.0286, 0.0268, 0.0302,
        0.0089])
			Update norm = 110.33180603015161 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 599.4562902450562 sec.
Server Epoch:14 choose agents : [0, 94, 96, 91, 51, 3, 36, 90, 37, 84].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   1, Avg loss: 0.0586, Accuracy: 368/1657 (22.2088%)
_Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 485/1657 (29.2698%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.7925, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 353/1662 (21.2395%)
_Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 566/1662 (34.0554%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.7061, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 43/311 (13.8264%)
_Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3423, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   1, Avg loss: 0.0535, Accuracy: 320/1030 (31.0680%)
_Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   2, Avg loss: 0.0256, Accuracy: 625/1030 (60.6796%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.0666, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 221/1049 (21.0677%)
_Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   2, Avg loss: 0.0313, Accuracy: 501/1049 (47.7598%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.4219, Accuracy: 66/10000 (0.6600%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   1, Avg loss: 0.0756, Accuracy: 103/781 (13.1882%)
_Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   2, Avg loss: 0.0370, Accuracy: 229/781 (29.3214%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.4278, Accuracy: 63/10000 (0.6300%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0882, Accuracy: 73/408 (17.8922%)
_Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0557, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.4709, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   1, Avg loss: 0.0576, Accuracy: 304/677 (44.9040%)
_Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.1351, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   1, Avg loss: 0.0526, Accuracy: 371/1129 (32.8609%)
_Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   2, Avg loss: 0.0258, Accuracy: 715/1129 (63.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.7248, Accuracy: 99/10000 (0.9900%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0632, Accuracy: 318/1190 (26.7227%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 451/1190 (37.8992%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8091, Accuracy: 52/10000 (0.5200%)
time spent on training: 201.66187167167664
[rfa agg] training data poison_ratio: 0.5220335556903174  data num: [1657, 1662, 311, 1030, 1049, 781, 408, 677, 1129, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.32627097230644836
[rfa agg] init. name: [0, 94, 96, 91, 51, 3, 36, 90, 37, 84], weight: tensor([0.1675, 0.1680, 0.0314, 0.1041, 0.1060, 0.0789, 0.0412, 0.0684, 0.1141,
        0.1203])
[rfa agg] iter:  0, prev_obj_val: 48.22753143310547, obj_val: 54.82956314086914, abs dis: 6.602031707763672
[rfa agg] iter: 0, weight: tensor([0.0467, 0.0467, 0.0072, 0.2558, 0.2599, 0.0583, 0.0114, 0.0328, 0.1627,
        0.1186])
[rfa agg] iter:  1, prev_obj_val: 54.82956314086914, obj_val: 52.429664611816406, abs dis: 2.3998985290527344
[rfa agg] iter: 1, weight: tensor([0.0598, 0.0599, 0.0122, 0.1909, 0.1941, 0.1409, 0.0201, 0.0661, 0.1412,
        0.1150])
[rfa agg] iter:  2, prev_obj_val: 52.429664611816406, obj_val: 54.809608459472656, abs dis: 2.37994384765625
[rfa agg] iter: 2, weight: tensor([0.0565, 0.0566, 0.0105, 0.2145, 0.2183, 0.1067, 0.0171, 0.0534, 0.1490,
        0.1175])
[rfa agg] iter:  3, prev_obj_val: 54.809608459472656, obj_val: 52.42999267578125, abs dis: 2.3796157836914062
[rfa agg] iter: 3, weight: tensor([0.0598, 0.0599, 0.0122, 0.1897, 0.1930, 0.1428, 0.0201, 0.0663, 0.1412,
        0.1151])
[rfa agg] iter:  4, prev_obj_val: 52.42999267578125, obj_val: 54.809593200683594, abs dis: 2.3796005249023438
[rfa agg] iter: 4, weight: tensor([0.0565, 0.0566, 0.0105, 0.2145, 0.2183, 0.1067, 0.0171, 0.0534, 0.1490,
        0.1175])
[rfa agg] iter:  5, prev_obj_val: 54.809593200683594, obj_val: 52.429996490478516, abs dis: 2.379596710205078
[rfa agg] iter: 5, weight: tensor([0.0598, 0.0599, 0.0122, 0.1897, 0.1930, 0.1428, 0.0201, 0.0663, 0.1412,
        0.1151])
[rfa agg] iter:  6, prev_obj_val: 52.429996490478516, obj_val: 54.809593200683594, abs dis: 2.379596710205078
[rfa agg] iter: 6, weight: tensor([0.0565, 0.0566, 0.0105, 0.2145, 0.2183, 0.1067, 0.0171, 0.0534, 0.1490,
        0.1175])
[rfa agg] iter:  7, prev_obj_val: 54.809593200683594, obj_val: 52.429996490478516, abs dis: 2.379596710205078
[rfa agg] iter: 7, weight: tensor([0.0598, 0.0599, 0.0122, 0.1897, 0.1930, 0.1428, 0.0201, 0.0663, 0.1412,
        0.1151])
[rfa agg] iter:  8, prev_obj_val: 52.429996490478516, obj_val: 54.809593200683594, abs dis: 2.379596710205078
[rfa agg] iter: 8, weight: tensor([0.0565, 0.0566, 0.0105, 0.2145, 0.2183, 0.1067, 0.0171, 0.0534, 0.1490,
        0.1175])
[rfa agg] iter:  9, prev_obj_val: 54.809593200683594, obj_val: 52.429996490478516, abs dis: 2.379596710205078
[rfa agg] iter: 9, weight: tensor([0.0598, 0.0599, 0.0122, 0.1897, 0.1930, 0.1428, 0.0201, 0.0663, 0.1412,
        0.1151])
			Update norm = 147.86806566581575 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 625.1971995830536 sec.
Server Epoch:15 choose agents : [0, 92, 37, 24, 39, 63, 28, 96, 58, 72].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   1, Avg loss: 0.0589, Accuracy: 366/1657 (22.0881%)
_Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 513/1657 (30.9596%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.8005, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 465/1715 (27.1137%)
_Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 735/1715 (42.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5497, Accuracy: 83/10000 (0.8300%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0524, Accuracy: 387/1129 (34.2781%)
_Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0252, Accuracy: 734/1129 (65.0133%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5773, Accuracy: 107/10000 (1.0700%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3811, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0543, Accuracy: 305/1013 (30.1086%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0264, Accuracy: 482/1013 (47.5814%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.3496, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 255/888 (28.7162%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 419/888 (47.1847%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.0590, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   1, Avg loss: 0.0567, Accuracy: 396/1581 (25.0474%)
_Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   2, Avg loss: 0.0343, Accuracy: 560/1581 (35.4206%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.6509, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 39/311 (12.5402%)
_Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3443, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   1, Avg loss: 0.0589, Accuracy: 339/803 (42.2167%)
_Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   2, Avg loss: 0.0345, Accuracy: 387/803 (48.1943%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.9152, Accuracy: 49/10000 (0.4900%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   1, Avg loss: 0.0623, Accuracy: 222/1241 (17.8888%)
_Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 404/1241 (32.5544%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.0786, Accuracy: 54/10000 (0.5400%)
time spent on training: 198.34948801994324
[rfa agg] training data poison_ratio: 0.40741784037558687  data num: [1657, 1715, 1129, 312, 1013, 888, 1581, 311, 803, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.2546361502347418
[rfa agg] init. name: [0, 92, 37, 24, 39, 63, 28, 96, 58, 72], weight: tensor([0.1556, 0.1610, 0.1060, 0.0293, 0.0951, 0.0834, 0.1485, 0.0292, 0.0754,
        0.1165])
[rfa agg] iter:  0, prev_obj_val: 52.0667724609375, obj_val: 56.5363655090332, abs dis: 4.469593048095703
[rfa agg] iter: 0, weight: tensor([0.0639, 0.0587, 0.3561, 0.0074, 0.1475, 0.0677, 0.0695, 0.0073, 0.0493,
        0.1725])
[rfa agg] iter:  1, prev_obj_val: 56.5363655090332, obj_val: 60.614501953125, abs dis: 4.078136444091797
[rfa agg] iter: 1, weight: tensor([0.0524, 0.0490, 0.2058, 0.0081, 0.3489, 0.1015, 0.0558, 0.0080, 0.0672,
        0.1033])
[rfa agg] iter:  2, prev_obj_val: 60.614501953125, obj_val: 60.59712600708008, abs dis: 0.017375946044921875
[rfa agg] iter: 2, weight: tensor([0.0456, 0.0431, 0.1241, 0.0085, 0.4041, 0.1516, 0.0481, 0.0084, 0.0885,
        0.0781])
[rfa agg] iter:  3, prev_obj_val: 60.59712600708008, obj_val: 58.32733917236328, abs dis: 2.269786834716797
[rfa agg] iter: 3, weight: tensor([0.0447, 0.0422, 0.1202, 0.0083, 0.4152, 0.1504, 0.0471, 0.0083, 0.0871,
        0.0765])
[rfa agg] iter:  4, prev_obj_val: 58.32733917236328, obj_val: 60.606292724609375, abs dis: 2.2789535522460938
[rfa agg] iter: 4, weight: tensor([0.0395, 0.0371, 0.1221, 0.0067, 0.5129, 0.0994, 0.0418, 0.0067, 0.0620,
        0.0719])
[rfa agg] iter:  5, prev_obj_val: 60.606292724609375, obj_val: 60.59730911254883, abs dis: 0.008983612060546875
[rfa agg] iter: 5, weight: tensor([0.0432, 0.0408, 0.1161, 0.0080, 0.4384, 0.1425, 0.0455, 0.0080, 0.0837,
        0.0738])
[rfa agg] iter:  6, prev_obj_val: 60.59730911254883, obj_val: 58.325679779052734, abs dis: 2.2716293334960938
[rfa agg] iter: 6, weight: tensor([0.0442, 0.0417, 0.1188, 0.0082, 0.4223, 0.1482, 0.0466, 0.0082, 0.0861,
        0.0756])
[rfa agg] iter:  7, prev_obj_val: 58.325679779052734, obj_val: 63.12282180786133, abs dis: 4.797142028808594
[rfa agg] iter: 7, weight: tensor([0.0392, 0.0369, 0.1213, 0.0067, 0.5160, 0.0988, 0.0416, 0.0066, 0.0616,
        0.0715])
[rfa agg] iter:  8, prev_obj_val: 63.12282180786133, obj_val: 60.61105728149414, abs dis: 2.5117645263671875
[rfa agg] iter: 8, weight: tensor([0.0482, 0.0457, 0.1154, 0.0099, 0.3037, 0.2197, 0.0506, 0.0098, 0.1189,
        0.0781])
[rfa agg] iter:  9, prev_obj_val: 60.61105728149414, obj_val: 60.597496032714844, abs dis: 0.013561248779296875
[rfa agg] iter: 9, weight: tensor([0.0462, 0.0436, 0.1238, 0.0086, 0.3927, 0.1586, 0.0486, 0.0086, 0.0904,
        0.0790])
			Update norm = 148.07932444512636 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 619.0676846504211 sec.
Server Epoch:16 choose agents : [35, 32, 3, 96, 25, 8, 93, 74, 88, 50].
_Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0852, Accuracy: 41/271 (15.1292%)
_Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0567, Accuracy: 103/271 (38.0074%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3603, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0611, Accuracy: 185/735 (25.1701%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0231, Accuracy: 347/735 (47.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.5966, Accuracy: 55/10000 (0.5500%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   1, Avg loss: 0.0755, Accuracy: 100/781 (12.8041%)
_Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 230/781 (29.4494%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.6290, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 49/311 (15.7556%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0538, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3480, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
_Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0573, Accuracy: 299/690 (43.3333%)
_Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.5479, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   1, Avg loss: 0.0605, Accuracy: 230/1513 (15.2016%)
_Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 457/1513 (30.2049%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.3974, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0556, Accuracy: 400/1742 (22.9621%)
_Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 726/1742 (41.6762%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.6331, Accuracy: 86/10000 (0.8600%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0436, Accuracy: 447/1552 (28.8015%)
_Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 772/1552 (49.7423%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.6466, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   1, Avg loss: 0.0749, Accuracy: 128/603 (21.2272%)
_Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   2, Avg loss: 0.0469, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.8954, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   1, Avg loss: 0.0639, Accuracy: 140/809 (17.3053%)
_Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   2, Avg loss: 0.0279, Accuracy: 351/809 (43.3869%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.9947, Accuracy: 58/10000 (0.5800%)
time spent on training: 179.84098386764526
[rfa agg] training data poison_ratio: 0.3356278450094371  data num: [271, 735, 781, 311, 690, 1513, 1742, 1552, 603, 809]
[rfa agg] considering poison per batch poison_fraction: 0.2097674031308982
[rfa agg] init. name: [35, 32, 3, 96, 25, 8, 93, 74, 88, 50], weight: tensor([0.0301, 0.0816, 0.0867, 0.0345, 0.0766, 0.1680, 0.1934, 0.1723, 0.0669,
        0.0898])
[rfa agg] iter:  0, prev_obj_val: 67.95826721191406, obj_val: 68.93793487548828, abs dis: 0.9796676635742188
[rfa agg] iter: 0, weight: tensor([0.0166, 0.1149, 0.1549, 0.0190, 0.0888, 0.1426, 0.1076, 0.1292, 0.0657,
        0.1607])
[rfa agg] iter:  1, prev_obj_val: 68.93793487548828, obj_val: 69.70616912841797, abs dis: 0.7682342529296875
[rfa agg] iter: 1, weight: tensor([0.0149, 0.1335, 0.2051, 0.0171, 0.0952, 0.0934, 0.0747, 0.0863, 0.0667,
        0.2132])
[rfa agg] iter:  2, prev_obj_val: 69.70616912841797, obj_val: 76.98128509521484, abs dis: 7.275115966796875
[rfa agg] iter: 2, weight: tensor([0.0117, 0.1380, 0.2575, 0.0134, 0.0891, 0.0595, 0.0491, 0.0555, 0.0587,
        0.2675])
[rfa agg] iter:  3, prev_obj_val: 76.98128509521484, obj_val: 79.59919738769531, abs dis: 2.6179122924804688
[rfa agg] iter: 3, weight: tensor([0.0116, 0.2516, 0.1386, 0.0133, 0.2401, 0.0347, 0.0303, 0.0329, 0.1034,
        0.1435])
[rfa agg] iter:  4, prev_obj_val: 79.59919738769531, obj_val: 82.67604064941406, abs dis: 3.07684326171875
[rfa agg] iter: 4, weight: tensor([0.0118, 0.1750, 0.0998, 0.0136, 0.3706, 0.0315, 0.0278, 0.0300, 0.1370,
        0.1029])
[rfa agg] iter:  5, prev_obj_val: 82.67604064941406, obj_val: 82.6661605834961, abs dis: 0.00988006591796875
[rfa agg] iter: 5, weight: tensor([0.0143, 0.1371, 0.0901, 0.0164, 0.3238, 0.0337, 0.0300, 0.0322, 0.2294,
        0.0930])
[rfa agg] iter:  6, prev_obj_val: 82.6661605834961, obj_val: 86.04435729980469, abs dis: 3.3781967163085938
[rfa agg] iter: 6, weight: tensor([0.0142, 0.1350, 0.0893, 0.0162, 0.3143, 0.0334, 0.0297, 0.0319, 0.2438,
        0.0921])
[rfa agg] iter:  7, prev_obj_val: 86.04435729980469, obj_val: 86.0242919921875, abs dis: 0.0200653076171875
[rfa agg] iter: 7, weight: tensor([0.0170, 0.1152, 0.0829, 0.0195, 0.2084, 0.0355, 0.0318, 0.0340, 0.3701,
        0.0856])
[rfa agg] iter:  8, prev_obj_val: 86.0242919921875, obj_val: 82.6886978149414, abs dis: 3.3355941772460938
[rfa agg] iter: 8, weight: tensor([0.0159, 0.1072, 0.0774, 0.0182, 0.1894, 0.0331, 0.0297, 0.0317, 0.4174,
        0.0799])
[rfa agg] iter:  9, prev_obj_val: 82.6886978149414, obj_val: 82.66673278808594, abs dis: 0.02196502685546875
[rfa agg] iter: 9, weight: tensor([0.0141, 0.1329, 0.0886, 0.0162, 0.2843, 0.0333, 0.0296, 0.0318, 0.2778,
        0.0913])
			Update norm = 105.866310889017 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 604.8465721607208 sec.
Server Epoch:17 choose agents : [53, 43, 41, 30, 82, 92, 50, 34, 7, 64].
_Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   1, Avg loss: 0.0496, Accuracy: 274/813 (33.7023%)
_Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 458/813 (56.3346%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.3911, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0620, Accuracy: 306/946 (32.3467%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0370, Accuracy: 339/946 (35.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.9937, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   1, Avg loss: 0.0590, Accuracy: 325/719 (45.2017%)
_Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   2, Avg loss: 0.0308, Accuracy: 467/719 (64.9513%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.1221, Accuracy: 64/10000 (0.6400%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   1, Avg loss: 0.0815, Accuracy: 63/486 (12.9630%)
_Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   2, Avg loss: 0.0417, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.7836, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   1, Avg loss: 0.0776, Accuracy: 56/500 (11.2000%)
_Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   2, Avg loss: 0.0493, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.6121, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 437/1715 (25.4810%)
_Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 713/1715 (41.5743%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.5813, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   1, Avg loss: 0.0639, Accuracy: 149/809 (18.4178%)
_Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   2, Avg loss: 0.0277, Accuracy: 346/809 (42.7689%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.1687, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0589, Accuracy: 375/1427 (26.2789%)
_Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 600/1427 (42.0463%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.8677, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 341/891 (38.2716%)
_Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 438/891 (49.1582%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.0534, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   1, Avg loss: 0.0649, Accuracy: 161/953 (16.8940%)
_Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 307/953 (32.2141%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.3272, Accuracy: 74/10000 (0.7400%)
time spent on training: 163.9335582256317
[rfa agg] training data poison_ratio: 0.052489469705151746  data num: [813, 946, 719, 486, 500, 1715, 809, 1427, 891, 953]
[rfa agg] considering poison per batch poison_fraction: 0.03280591856571984
[rfa agg] init. name: [53, 43, 41, 30, 82, 92, 50, 34, 7, 64], weight: tensor([0.0878, 0.1022, 0.0777, 0.0525, 0.0540, 0.1852, 0.0874, 0.1541, 0.0962,
        0.1029])
[rfa agg] iter:  0, prev_obj_val: 45.829463958740234, obj_val: 49.102909088134766, abs dis: 3.2734451293945312
[rfa agg] iter: 0, weight: tensor([0.0829, 0.2519, 0.0495, 0.0150, 0.0154, 0.0310, 0.0820, 0.0386, 0.1532,
        0.2806])
[rfa agg] iter:  1, prev_obj_val: 49.102909088134766, obj_val: 57.23210525512695, abs dis: 8.129196166992188
[rfa agg] iter: 1, weight: tensor([0.2362, 0.0952, 0.1085, 0.0204, 0.0210, 0.0260, 0.2122, 0.0303, 0.1533,
        0.0970])
[rfa agg] iter:  2, prev_obj_val: 57.23210525512695, obj_val: 60.516929626464844, abs dis: 3.2848243713378906
[rfa agg] iter: 2, weight: tensor([0.1661, 0.0865, 0.2182, 0.0443, 0.0456, 0.0363, 0.1620, 0.0407, 0.1130,
        0.0874])
[rfa agg] iter:  3, prev_obj_val: 60.516929626464844, obj_val: 60.515987396240234, abs dis: 0.000942230224609375
[rfa agg] iter: 3, weight: tensor([0.1477, 0.0884, 0.2118, 0.0597, 0.0613, 0.0409, 0.1453, 0.0453, 0.1102,
        0.0895])
			Update norm = 110.29661712854116 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 583.9358222484589 sec.
Server Epoch:18 choose agents : [18, 55, 4, 35, 2, 13, 24, 76, 9, 43].
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   1, Avg loss: 0.0775, Accuracy: 109/530 (20.5660%)
_Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   2, Avg loss: 0.0387, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.0361, Accuracy: 57/10000 (0.5700%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   1, Avg loss: 0.0572, Accuracy: 237/1071 (22.1289%)
_Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 481/1071 (44.9113%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.7727, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   1, Avg loss: 0.0623, Accuracy: 321/901 (35.6271%)
_Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   2, Avg loss: 0.0336, Accuracy: 417/901 (46.2819%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.0098, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   1, Avg loss: 0.0854, Accuracy: 33/271 (12.1771%)
_Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   2, Avg loss: 0.0554, Accuracy: 100/271 (36.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3616, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0634, Accuracy: 227/605 (37.5207%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.7708, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 306/1645 (18.6018%)
_Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 611/1645 (37.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.8547, Accuracy: 117/10000 (1.1700%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 25/312 (8.0128%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3828, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0860, Accuracy: 38/466 (8.1545%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0491, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.6091, Accuracy: 50/10000 (0.5000%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0502, Accuracy: 340/1275 (26.6667%)
_Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0203, Accuracy: 637/1275 (49.9608%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.0956, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 302/946 (31.9239%)
_Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   2, Avg loss: 0.0366, Accuracy: 311/946 (32.8753%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.9461, Accuracy: 62/10000 (0.6200%)
time spent on training: 195.5477683544159
[rfa agg] training data poison_ratio: 0.39740713039142356  data num: [530, 1071, 901, 271, 605, 1645, 312, 466, 1275, 946]
[rfa agg] considering poison per batch poison_fraction: 0.24837945649463972
[rfa agg] init. name: [18, 55, 4, 35, 2, 13, 24, 76, 9, 43], weight: tensor([0.0661, 0.1335, 0.1123, 0.0338, 0.0754, 0.2051, 0.0389, 0.0581, 0.1589,
        0.1179])
[rfa agg] iter:  0, prev_obj_val: 51.91014099121094, obj_val: 55.67747497558594, abs dis: 3.767333984375
[rfa agg] iter: 0, weight: tensor([0.0416, 0.1352, 0.2796, 0.0117, 0.0588, 0.0541, 0.0135, 0.0304, 0.0833,
        0.2918])
[rfa agg] iter:  1, prev_obj_val: 55.67747497558594, obj_val: 57.66419982910156, abs dis: 1.986724853515625
[rfa agg] iter: 1, weight: tensor([0.0673, 0.1350, 0.2216, 0.0171, 0.1005, 0.0652, 0.0197, 0.0473, 0.0935,
        0.2328])
[rfa agg] iter:  2, prev_obj_val: 57.66419982910156, obj_val: 59.680198669433594, abs dis: 2.0159988403320312
[rfa agg] iter: 2, weight: tensor([0.0829, 0.1301, 0.1936, 0.0197, 0.1292, 0.0677, 0.0227, 0.0566, 0.0942,
        0.2034])
[rfa agg] iter:  3, prev_obj_val: 59.680198669433594, obj_val: 57.66427230834961, abs dis: 2.0159263610839844
[rfa agg] iter: 3, weight: tensor([0.0994, 0.1213, 0.1680, 0.0217, 0.1640, 0.0674, 0.0250, 0.0655, 0.0912,
        0.1765])
[rfa agg] iter:  4, prev_obj_val: 57.66427230834961, obj_val: 59.679962158203125, abs dis: 2.0156898498535156
[rfa agg] iter: 4, weight: tensor([0.0833, 0.1301, 0.1925, 0.0197, 0.1305, 0.0678, 0.0227, 0.0568, 0.0942,
        0.2024])
[rfa agg] iter:  5, prev_obj_val: 59.679962158203125, obj_val: 57.66427230834961, abs dis: 2.0156898498535156
[rfa agg] iter: 5, weight: tensor([0.0994, 0.1213, 0.1680, 0.0217, 0.1640, 0.0674, 0.0250, 0.0655, 0.0912,
        0.1765])
[rfa agg] iter:  6, prev_obj_val: 57.66427230834961, obj_val: 59.67996597290039, abs dis: 2.0156936645507812
[rfa agg] iter: 6, weight: tensor([0.0833, 0.1301, 0.1925, 0.0197, 0.1305, 0.0678, 0.0227, 0.0568, 0.0942,
        0.2024])
[rfa agg] iter:  7, prev_obj_val: 59.67996597290039, obj_val: 57.66427230834961, abs dis: 2.0156936645507812
[rfa agg] iter: 7, weight: tensor([0.0994, 0.1213, 0.1680, 0.0217, 0.1640, 0.0674, 0.0250, 0.0655, 0.0912,
        0.1765])
[rfa agg] iter:  8, prev_obj_val: 57.66427230834961, obj_val: 59.67996597290039, abs dis: 2.0156936645507812
[rfa agg] iter: 8, weight: tensor([0.0833, 0.1301, 0.1925, 0.0197, 0.1305, 0.0678, 0.0227, 0.0568, 0.0942,
        0.2024])
[rfa agg] iter:  9, prev_obj_val: 59.67996597290039, obj_val: 57.66427230834961, abs dis: 2.0156936645507812
[rfa agg] iter: 9, weight: tensor([0.0994, 0.1213, 0.1680, 0.0217, 0.1640, 0.0674, 0.0250, 0.0655, 0.0912,
        0.1765])
			Update norm = 122.2258371762595 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 619.3949162960052 sec.
Server Epoch:19 choose agents : [11, 48, 53, 27, 55, 65, 31, 89, 17, 23].
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0535, Accuracy: 345/712 (48.4551%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0260, Accuracy: 430/712 (60.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.3484, Accuracy: 49/10000 (0.4900%)
poison local model 48 index 17 
_Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   1, Avg loss: 0.0716, Accuracy: 88/631 (13.9461%)
_Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   2, Avg loss: 0.0415, Accuracy: 211/631 (33.4390%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.7883, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   1, Avg loss: 0.0501, Accuracy: 288/813 (35.4244%)
_Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 452/813 (55.5966%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.9876, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 436/1587 (27.4732%)
_Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 601/1587 (37.8702%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.0744, Accuracy: 64/10000 (0.6400%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 262/1071 (24.4631%)
_Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 483/1071 (45.0980%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4297, Accuracy: 81/10000 (0.8100%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 379/1475 (25.6949%)
_Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 659/1475 (44.6780%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.9630, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   1, Avg loss: 0.0822, Accuracy: 52/460 (11.3043%)
_Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.7496, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 329/896 (36.7188%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0344, Accuracy: 426/896 (47.5446%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.2256, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 376/1574 (23.8882%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 680/1574 (43.2020%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.0539, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   1, Avg loss: 0.0597, Accuracy: 319/715 (44.6154%)
_Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   2, Avg loss: 0.0389, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.7874, Accuracy: 50/10000 (0.5000%)
time spent on training: 187.8177969455719
[rfa agg] training data poison_ratio: 0.3198107509563117  data num: [712, 631, 813, 1587, 1071, 1475, 460, 896, 1574, 715]
[rfa agg] considering poison per batch poison_fraction: 0.1998817193476948
[rfa agg] init. name: [11, 48, 53, 27, 55, 65, 31, 89, 17, 23], weight: tensor([0.0717, 0.0635, 0.0818, 0.1598, 0.1078, 0.1485, 0.0463, 0.0902, 0.1584,
        0.0720])
[rfa agg] iter:  0, prev_obj_val: 54.406227111816406, obj_val: 58.2408447265625, abs dis: 3.8346176147460938
[rfa agg] iter: 0, weight: tensor([0.0786, 0.0449, 0.1222, 0.0658, 0.2442, 0.0681, 0.0240, 0.2089, 0.0652,
        0.0781])
[rfa agg] iter:  1, prev_obj_val: 58.2408447265625, obj_val: 70.81976318359375, abs dis: 12.57891845703125
[rfa agg] iter: 1, weight: tensor([0.1129, 0.0468, 0.2394, 0.0366, 0.0798, 0.0372, 0.0219, 0.2813, 0.0363,
        0.1077])
[rfa agg] iter:  2, prev_obj_val: 70.81976318359375, obj_val: 74.19084167480469, abs dis: 3.3710784912109375
[rfa agg] iter: 2, weight: tensor([0.1961, 0.1696, 0.1308, 0.0382, 0.0597, 0.0382, 0.0494, 0.0988, 0.0379,
        0.1812])
[rfa agg] iter:  3, prev_obj_val: 74.19084167480469, obj_val: 81.61843872070312, abs dis: 7.4275970458984375
[rfa agg] iter: 3, weight: tensor([0.1522, 0.2729, 0.1091, 0.0380, 0.0568, 0.0379, 0.0607, 0.0869, 0.0377,
        0.1478])
[rfa agg] iter:  4, prev_obj_val: 81.61843872070312, obj_val: 77.7605972290039, abs dis: 3.8578414916992188
[rfa agg] iter: 4, weight: tensor([0.1084, 0.3353, 0.0897, 0.0403, 0.0558, 0.0399, 0.1061, 0.0772, 0.0399,
        0.1075])
[rfa agg] iter:  5, prev_obj_val: 77.7605972290039, obj_val: 77.75460052490234, abs dis: 0.0059967041015625
[rfa agg] iter: 5, weight: tensor([0.1071, 0.4155, 0.0841, 0.0337, 0.0484, 0.0335, 0.0686, 0.0700, 0.0334,
        0.1056])
[rfa agg] iter:  6, prev_obj_val: 77.75460052490234, obj_val: 77.75372314453125, abs dis: 0.00087738037109375
[rfa agg] iter: 6, weight: tensor([0.1019, 0.4429, 0.0802, 0.0322, 0.0462, 0.0320, 0.0653, 0.0667, 0.0319,
        0.1006])
[rfa agg] iter:  7, prev_obj_val: 77.75372314453125, obj_val: 74.19798278808594, abs dis: 3.5557403564453125
[rfa agg] iter: 7, weight: tensor([0.0996, 0.4550, 0.0785, 0.0315, 0.0452, 0.0313, 0.0639, 0.0653, 0.0312,
        0.0984])
[rfa agg] iter:  8, prev_obj_val: 74.19798278808594, obj_val: 77.7645034790039, abs dis: 3.5665206909179688
[rfa agg] iter: 8, weight: tensor([0.1395, 0.3220, 0.1022, 0.0358, 0.0535, 0.0357, 0.0576, 0.0815, 0.0355,
        0.1365])
[rfa agg] iter:  9, prev_obj_val: 77.7645034790039, obj_val: 74.18856811523438, abs dis: 3.5759353637695312
[rfa agg] iter: 9, weight: tensor([0.1097, 0.4031, 0.0859, 0.0344, 0.0494, 0.0342, 0.0695, 0.0715, 0.0341,
        0.1082])
			Update norm = 106.06766063608879 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3170, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.6230, Accuracy: 0/9950 (0.0000%)
saving model
Done in 604.7188496589661 sec.
Server Epoch:20 choose agents : [15, 22, 82, 11, 93, 75, 3, 77, 88, 16].
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0587, Accuracy: 320/1154 (27.7296%)
_Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0285, Accuracy: 407/1154 (35.2686%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.7299, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 506/1470 (34.4218%)
_Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 821/1470 (55.8503%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.1126, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   1, Avg loss: 0.0772, Accuracy: 56/500 (11.2000%)
_Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   2, Avg loss: 0.0496, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.6150, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0543, Accuracy: 345/712 (48.4551%)
_Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 431/712 (60.5337%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.5238, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 417/1742 (23.9380%)
_Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 686/1742 (39.3800%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.7529, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0640, Accuracy: 240/776 (30.9278%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0286, Accuracy: 427/776 (55.0258%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.8508, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   1, Avg loss: 0.0757, Accuracy: 101/781 (12.9321%)
_Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   2, Avg loss: 0.0367, Accuracy: 235/781 (30.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.6121, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 328/1340 (24.4776%)
_Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 563/1340 (42.0149%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.5740, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   1, Avg loss: 0.0758, Accuracy: 126/603 (20.8955%)
_Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   2, Avg loss: 0.0465, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.8725, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   1, Avg loss: 0.0640, Accuracy: 274/708 (38.7006%)
_Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   2, Avg loss: 0.0366, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.7907, Accuracy: 67/10000 (0.6700%)
time spent on training: 189.40234994888306
[rfa agg] training data poison_ratio: 0.19773145309625997  data num: [1154, 1470, 500, 712, 1742, 776, 781, 1340, 603, 708]
[rfa agg] considering poison per batch poison_fraction: 0.12358215818516248
[rfa agg] init. name: [15, 22, 82, 11, 93, 75, 3, 77, 88, 16], weight: tensor([0.1179, 0.1502, 0.0511, 0.0728, 0.1780, 0.0793, 0.0798, 0.1369, 0.0616,
        0.0723])
[rfa agg] iter:  0, prev_obj_val: 55.665401458740234, obj_val: 59.0491828918457, abs dis: 3.3837814331054688
[rfa agg] iter: 0, weight: tensor([0.1540, 0.0946, 0.0321, 0.0968, 0.0676, 0.1439, 0.1451, 0.1169, 0.0528,
        0.0962])
[rfa agg] iter:  1, prev_obj_val: 59.0491828918457, obj_val: 67.5052261352539, abs dis: 8.456043243408203
[rfa agg] iter: 1, weight: tensor([0.0586, 0.0436, 0.0254, 0.1225, 0.0340, 0.2436, 0.2530, 0.0502, 0.0478,
        0.1212])
[rfa agg] iter:  2, prev_obj_val: 67.5052261352539, obj_val: 74.17083740234375, abs dis: 6.665611267089844
[rfa agg] iter: 2, weight: tensor([0.0414, 0.0346, 0.0377, 0.2289, 0.0286, 0.1283, 0.1307, 0.0381, 0.0998,
        0.2320])
[rfa agg] iter:  3, prev_obj_val: 74.17083740234375, obj_val: 77.70990753173828, abs dis: 3.5390701293945312
[rfa agg] iter: 3, weight: tensor([0.0463, 0.0403, 0.0654, 0.1524, 0.0341, 0.1019, 0.1034, 0.0436, 0.2603,
        0.1523])
[rfa agg] iter:  4, prev_obj_val: 77.70990753173828, obj_val: 77.69143676757812, abs dis: 0.01847076416015625
[rfa agg] iter: 4, weight: tensor([0.0413, 0.0366, 0.0759, 0.1103, 0.0314, 0.0812, 0.0823, 0.0394, 0.3917,
        0.1100])
[rfa agg] iter:  5, prev_obj_val: 77.69143676757812, obj_val: 81.52659606933594, abs dis: 3.8351593017578125
[rfa agg] iter: 5, weight: tensor([0.0379, 0.0335, 0.0699, 0.1004, 0.0287, 0.0743, 0.0753, 0.0361, 0.4436,
        0.1003])
[rfa agg] iter:  6, prev_obj_val: 81.52659606933594, obj_val: 77.69354248046875, abs dis: 3.8330535888671875
[rfa agg] iter: 6, weight: tensor([0.0448, 0.0403, 0.1115, 0.1020, 0.0349, 0.0802, 0.0812, 0.0431, 0.3602,
        0.1018])
[rfa agg] iter:  7, prev_obj_val: 77.69354248046875, obj_val: 81.52609252929688, abs dis: 3.832550048828125
[rfa agg] iter: 7, weight: tensor([0.0383, 0.0339, 0.0710, 0.1016, 0.0291, 0.0752, 0.0763, 0.0365, 0.4366,
        0.1015])
[rfa agg] iter:  8, prev_obj_val: 81.52609252929688, obj_val: 77.6936264038086, abs dis: 3.8324661254882812
[rfa agg] iter: 8, weight: tensor([0.0449, 0.0404, 0.1117, 0.1022, 0.0350, 0.0803, 0.0813, 0.0432, 0.3592,
        0.1019])
[rfa agg] iter:  9, prev_obj_val: 77.6936264038086, obj_val: 81.52608489990234, abs dis: 3.83245849609375
[rfa agg] iter: 9, weight: tensor([0.0383, 0.0340, 0.0710, 0.1016, 0.0291, 0.0753, 0.0763, 0.0365, 0.4362,
        0.1016])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3001, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.3518, Accuracy: 0/9950 (0.0000%)
saving model
Done in 610.8861045837402 sec.
Server Epoch:21 choose agents : [0, 27, 39, 70, 20, 85, 12, 72, 94, 32].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0483, Accuracy: 845/1657 (50.9958%), train_poison_data_count: 1040
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1009/1657 (60.8932%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0251, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0240, Accuracy: 1041/1657 (62.8244%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0239, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0233, Accuracy: 1041/1657 (62.8244%), train_poison_data_count: 1040
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0234, Accuracy: 1039/1657 (62.7037%), train_poison_data_count: 1040
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0224, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0223, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0219, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Global model norm: 112.05536264220022.
Norm before scaling: 112.0253528782659. Distance: 1.0320290021850225
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.4415, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.4655, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 149.76068148466072, distance: 103.20289671625017
Total norm for 5 adversaries is: 149.76068148466072. distance: 103.20289671625017
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0528, Accuracy: 456/1587 (28.7335%)
_Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 606/1587 (38.1853%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.5535, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 309/1013 (30.5035%)
_Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 474/1013 (46.7917%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7352, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   1, Avg loss: 0.0568, Accuracy: 346/1418 (24.4006%)
_Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 635/1418 (44.7814%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.3569, Accuracy: 96/10000 (0.9600%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0556, Accuracy: 343/807 (42.5031%)
_Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0330, Accuracy: 418/807 (51.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.0552, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   1, Avg loss: 0.0547, Accuracy: 454/1988 (22.8370%)
_Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   2, Avg loss: 0.0345, Accuracy: 714/1988 (35.9155%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7817, Accuracy: 77/10000 (0.7700%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   1, Avg loss: 0.0875, Accuracy: 16/338 (4.7337%)
_Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   2, Avg loss: 0.0469, Accuracy: 147/338 (43.4911%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.4840, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   1, Avg loss: 0.0626, Accuracy: 250/1241 (20.1450%)
_Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 398/1241 (32.0709%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.1257, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 346/1662 (20.8183%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 593/1662 (35.6799%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6152, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   1, Avg loss: 0.0615, Accuracy: 186/735 (25.3061%)
_Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 344/735 (46.8027%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6838, Accuracy: 53/10000 (0.5300%)
time spent on training: 349.89068579673767
[rfa agg] training data poison_ratio: 0.48457335690181585  data num: [1657, 1587, 1013, 1418, 807, 1988, 338, 1241, 1662, 735]
[rfa agg] considering poison per batch poison_fraction: 0.30285834806363493
[rfa agg] init. name: [0, 27, 39, 70, 20, 85, 12, 72, 94, 32], weight: tensor([0.1331, 0.1275, 0.0814, 0.1139, 0.0648, 0.1597, 0.0272, 0.0997, 0.1335,
        0.0591])
[rfa agg] iter:  0, prev_obj_val: 26798.4296875, obj_val: 17408.93359375, abs dis: 9389.49609375
[rfa agg] iter: 0, weight: tensor([0.0230, 0.1439, 0.0914, 0.1285, 0.0727, 0.1810, 0.0303, 0.1122, 0.1508,
        0.0662])
[rfa agg] iter:  1, prev_obj_val: 17408.93359375, obj_val: 15757.048828125, abs dis: 1651.884765625
[rfa agg] iter: 1, weight: tensor([0.0036, 0.1478, 0.0915, 0.1312, 0.0722, 0.1897, 0.0296, 0.1136, 0.1553,
        0.0655])
[rfa agg] iter:  2, prev_obj_val: 15757.048828125, obj_val: 15514.541015625, abs dis: 242.5078125
[rfa agg] iter: 2, weight: tensor([0.0005, 0.1526, 0.0801, 0.1301, 0.0602, 0.2299, 0.0223, 0.1066, 0.1638,
        0.0539])
[rfa agg] iter:  3, prev_obj_val: 15514.541015625, obj_val: 15509.0302734375, abs dis: 5.5107421875
[rfa agg] iter: 3, weight: tensor([4.8267e-05, 2.2256e-01, 3.3213e-02, 1.1632e-01, 2.0995e-02, 1.6248e-01,
        5.9262e-03, 6.2113e-02, 3.5845e-01, 1.7900e-02])
[rfa agg] iter:  4, prev_obj_val: 15509.0302734375, obj_val: 15511.3525390625, abs dis: 2.322265625
[rfa agg] iter: 4, weight: tensor([3.4005e-05, 3.0918e-01, 3.3521e-02, 2.6151e-01, 1.9470e-02, 6.5509e-02,
        4.9852e-03, 8.0372e-02, 2.0914e-01, 1.6279e-02])
[rfa agg] iter:  5, prev_obj_val: 15511.3525390625, obj_val: 15517.2255859375, abs dis: 5.873046875
[rfa agg] iter: 5, weight: tensor([3.6848e-05, 1.7415e-01, 4.4588e-02, 4.0381e-01, 2.4399e-02, 5.9862e-02,
        5.8895e-03, 1.3399e-01, 1.3313e-01, 2.0147e-02])
[rfa agg] iter:  6, prev_obj_val: 15517.2255859375, obj_val: 15520.8857421875, abs dis: 3.66015625
[rfa agg] iter: 6, weight: tensor([4.2930e-05, 1.1585e-01, 7.4402e-02, 1.8405e-01, 3.5891e-02, 5.7792e-02,
        7.7989e-03, 3.9503e-01, 1.0021e-01, 2.8937e-02])
[rfa agg] iter:  7, prev_obj_val: 15520.8857421875, obj_val: 15520.8681640625, abs dis: 0.017578125
[rfa agg] iter: 7, weight: tensor([4.0041e-05, 8.9067e-02, 8.8389e-02, 1.2264e-01, 3.8554e-02, 4.9650e-02,
        7.8078e-03, 4.9389e-01, 7.9409e-02, 3.0558e-02])
[rfa agg] iter:  8, prev_obj_val: 15520.8681640625, obj_val: 15525.5205078125, abs dis: 4.65234375
[rfa agg] iter: 8, weight: tensor([3.7917e-05, 8.4225e-02, 8.3604e-02, 1.1533e-01, 3.6496e-02, 4.7005e-02,
        7.3930e-03, 5.2186e-01, 7.5125e-02, 2.8926e-02])
[rfa agg] iter:  9, prev_obj_val: 15525.5205078125, obj_val: 15523.158203125, abs dis: 2.3623046875
[rfa agg] iter: 9, weight: tensor([5.3836e-05, 1.0169e-01, 1.6163e-01, 1.2939e-01, 6.0955e-02, 6.1847e-02,
        1.1324e-02, 3.3314e-01, 9.2697e-02, 4.7270e-02])
			Update norm = 176.66729743892898 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3001, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.3518, Accuracy: 0/9950 (0.0000%)
saving model
Done in 769.811235666275 sec.
Server Epoch:22 choose agents : [17, 32, 73, 28, 12, 2, 85, 13, 18, 80].
_Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 379/1574 (24.0788%)
_Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 664/1574 (42.1855%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.4223, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   1, Avg loss: 0.0607, Accuracy: 195/735 (26.5306%)
_Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   2, Avg loss: 0.0235, Accuracy: 327/735 (44.4898%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.9434, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   1, Avg loss: 0.0661, Accuracy: 173/938 (18.4435%)
_Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 320/938 (34.1151%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.2688, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 382/1581 (24.1619%)
_Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 588/1581 (37.1917%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.8906, Accuracy: 85/10000 (0.8500%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.0876, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0465, Accuracy: 142/338 (42.0118%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.4752, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0639, Accuracy: 231/605 (38.1818%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.8632, Accuracy: 54/10000 (0.5400%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 427/1988 (21.4789%)
_Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 662/1988 (33.2998%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.2242, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0581, Accuracy: 322/1645 (19.5745%)
_Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 599/1645 (36.4134%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.9207, Accuracy: 121/10000 (1.2100%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0772, Accuracy: 110/530 (20.7547%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0378, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.9786, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0697, Accuracy: 151/682 (22.1408%)
_Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0376, Accuracy: 270/682 (39.5894%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.3809, Accuracy: 56/10000 (0.5600%)
time spent on training: 205.60183191299438
[rfa agg] training data poison_ratio: 0.2690278824415976  data num: [1574, 735, 938, 1581, 338, 605, 1988, 1645, 530, 682]
[rfa agg] considering poison per batch poison_fraction: 0.16814242652599848
[rfa agg] init. name: [17, 32, 73, 28, 12, 2, 85, 13, 18, 80], weight: tensor([0.1483, 0.0692, 0.0884, 0.1489, 0.0318, 0.0570, 0.1873, 0.1550, 0.0499,
        0.0642])
[rfa agg] iter:  0, prev_obj_val: 72.8314208984375, obj_val: 75.30391693115234, abs dis: 2.4724960327148438
[rfa agg] iter: 0, weight: tensor([0.1764, 0.0711, 0.1558, 0.1774, 0.0176, 0.0456, 0.1037, 0.1586, 0.0360,
        0.0578])
[rfa agg] iter:  1, prev_obj_val: 75.30391693115234, obj_val: 75.3005599975586, abs dis: 0.00335693359375
[rfa agg] iter: 1, weight: tensor([0.1513, 0.0824, 0.2044, 0.1520, 0.0190, 0.0510, 0.0959, 0.1385, 0.0398,
        0.0657])
			Update norm = 167.62068297013647 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3001, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.3518, Accuracy: 0/9950 (0.0000%)
saving model
Done in 625.3032159805298 sec.
Server Epoch:23 choose agents : [3, 14, 79, 74, 2, 49, 32, 18, 4, 7].
poison local model 3 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0602, Accuracy: 331/781 (42.3816%), train_poison_data_count: 493
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0396, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   3, Avg loss: 0.0273, Accuracy: 476/781 (60.9475%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   4, Avg loss: 0.0254, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   5, Avg loss: 0.0247, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   6, Avg loss: 0.0248, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   7, Avg loss: 0.0240, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   8, Avg loss: 0.0235, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   9, Avg loss: 0.0237, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch  10, Avg loss: 0.0235, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Global model norm: 112.05536264220022.
Norm before scaling: 112.04259879756673. Distance: 0.7788144485110065
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.1885, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.4293, Accuracy: 9946/9950 (99.9598%)
Scaling by  100
Scaled Norm after poisoning: 135.18630084997517, distance: 77.88144535927668
Total norm for 4 adversaries is: 135.18630084997517. distance: 77.88144535927668
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 334/1013 (32.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.6139, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   1, Avg loss: 0.1005, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   2, Avg loss: 0.0837, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3267, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 438/1552 (28.2216%)
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0203, Accuracy: 790/1552 (50.9021%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.8182, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0638, Accuracy: 229/605 (37.8512%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0392, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.8581, Accuracy: 52/10000 (0.5200%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   1, Avg loss: 0.0804, Accuracy: 22/440 (5.0000%)
_Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   2, Avg loss: 0.0489, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.5176, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   1, Avg loss: 0.0611, Accuracy: 187/735 (25.4422%)
_Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   2, Avg loss: 0.0234, Accuracy: 339/735 (46.1224%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.1129, Accuracy: 50/10000 (0.5000%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   1, Avg loss: 0.0758, Accuracy: 114/530 (21.5094%)
_Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   2, Avg loss: 0.0420, Accuracy: 263/530 (49.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.0088, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0635, Accuracy: 326/901 (36.1820%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0317, Accuracy: 399/901 (44.2841%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.0677, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 355/891 (39.8429%)
_Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 460/891 (51.6274%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.9068, Accuracy: 52/10000 (0.5200%)
time spent on training: 283.2347629070282
[rfa agg] training data poison_ratio: 0.43204708960104643  data num: [781, 1013, 197, 1552, 605, 440, 735, 530, 901, 891]
[rfa agg] considering poison per batch poison_fraction: 0.270029431000654
[rfa agg] init. name: [3, 14, 79, 74, 2, 49, 32, 18, 4, 7], weight: tensor([0.1022, 0.1325, 0.0258, 0.2030, 0.0791, 0.0576, 0.0961, 0.0693, 0.1179,
        0.1165])
[rfa agg] iter:  0, prev_obj_val: 10665.2412109375, obj_val: 6515.99462890625, abs dis: 4149.24658203125
[rfa agg] iter: 0, weight: tensor([0.0127, 0.1459, 0.0279, 0.2265, 0.0863, 0.0625, 0.1052, 0.0755, 0.1295,
        0.1279])
[rfa agg] iter:  1, prev_obj_val: 6515.99462890625, obj_val: 6005.88330078125, abs dis: 510.111328125
[rfa agg] iter: 1, weight: tensor([0.0014, 0.1480, 0.0250, 0.2556, 0.0821, 0.0577, 0.1022, 0.0711, 0.1300,
        0.1269])
[rfa agg] iter:  2, prev_obj_val: 6005.88330078125, obj_val: 5987.24755859375, abs dis: 18.6357421875
[rfa agg] iter: 2, weight: tensor([1.0911e-04, 1.5162e-01, 9.8278e-03, 4.4719e-01, 4.5537e-02, 2.6493e-02,
        6.6356e-02, 3.6845e-02, 1.1568e-01, 1.0034e-01])
[rfa agg] iter:  3, prev_obj_val: 5987.24755859375, obj_val: 5988.27001953125, abs dis: 1.0224609375
[rfa agg] iter: 3, weight: tensor([4.8233e-05, 4.2917e-01, 6.2356e-03, 7.3144e-02, 3.6983e-02, 1.8474e-02,
        6.4359e-02, 2.8183e-02, 2.0890e-01, 1.3451e-01])
[rfa agg] iter:  4, prev_obj_val: 5988.27001953125, obj_val: 5993.57275390625, abs dis: 5.302734375
[rfa agg] iter: 4, weight: tensor([4.6782e-05, 1.2995e-01, 8.3078e-03, 5.0212e-02, 7.5597e-02, 2.8183e-02,
        2.2397e-01, 5.0704e-02, 1.6615e-01, 2.6688e-01])
[rfa agg] iter:  5, prev_obj_val: 5993.57275390625, obj_val: 6000.9306640625, abs dis: 7.35791015625
[rfa agg] iter: 5, weight: tensor([4.7218e-05, 8.7366e-02, 9.9875e-03, 4.5088e-02, 1.4315e-01, 3.7699e-02,
        3.6139e-01, 8.0422e-02, 9.9397e-02, 1.3545e-01])
[rfa agg] iter:  6, prev_obj_val: 6000.9306640625, obj_val: 6000.818359375, abs dis: 0.1123046875
[rfa agg] iter: 6, weight: tensor([4.5884e-05, 6.4007e-02, 1.1965e-02, 3.9461e-02, 3.6962e-01, 5.3989e-02,
        1.3679e-01, 1.7248e-01, 6.8148e-02, 8.3500e-02])
[rfa agg] iter:  7, prev_obj_val: 6000.818359375, obj_val: 6010.52392578125, abs dis: 9.70556640625
[rfa agg] iter: 7, weight: tensor([3.9000e-05, 5.4337e-02, 1.0231e-02, 3.3530e-02, 4.5910e-01, 4.6365e-02,
        1.1387e-01, 1.5396e-01, 5.7801e-02, 7.0763e-02])
[rfa agg] iter:  8, prev_obj_val: 6010.52392578125, obj_val: 6006.9306640625, abs dis: 3.59326171875
[rfa agg] iter: 8, weight: tensor([5.5458e-05, 6.2028e-02, 1.8830e-02, 4.3377e-02, 1.8123e-01, 1.2216e-01,
        9.5432e-02, 3.3938e-01, 6.3559e-02, 7.3948e-02])
[rfa agg] iter:  9, prev_obj_val: 6006.9306640625, obj_val: 6014.16455078125, abs dis: 7.23388671875
[rfa agg] iter: 9, weight: tensor([3.9543e-05, 4.7364e-02, 1.2286e-02, 3.1890e-02, 1.7572e-01, 6.9213e-02,
        7.8796e-02, 4.7784e-01, 4.9023e-02, 5.7831e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 719.280252456665 sec.
Server Epoch:24 choose agents : [92, 33, 42, 36, 22, 98, 4, 17, 76, 3].
_Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 419/1715 (24.4315%)
_Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 724/1715 (42.2157%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.5897, Accuracy: 91/10000 (0.9100%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   1, Avg loss: 0.0791, Accuracy: 66/515 (12.8155%)
_Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   2, Avg loss: 0.0521, Accuracy: 117/515 (22.7184%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.7421, Accuracy: 42/10000 (0.4200%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 356/1372 (25.9475%)
_Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 508/1372 (37.0262%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1024, Accuracy: 96/10000 (0.9600%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   1, Avg loss: 0.0877, Accuracy: 66/408 (16.1765%)
_Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   2, Avg loss: 0.0566, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.5186, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 514/1470 (34.9660%)
_Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   2, Avg loss: 0.0243, Accuracy: 839/1470 (57.0748%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1039, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   1, Avg loss: 0.0830, Accuracy: 14/373 (3.7534%)
_Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.4675, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   1, Avg loss: 0.0591, Accuracy: 328/901 (36.4040%)
_Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 409/901 (45.3940%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.7563, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 392/1574 (24.9047%)
_Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0282, Accuracy: 667/1574 (42.3761%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.0030, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.0868, Accuracy: 36/466 (7.7253%)
_Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0496, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.7048, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0749, Accuracy: 112/781 (14.3406%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0362, Accuracy: 231/781 (29.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5910, Accuracy: 64/10000 (0.6400%)
time spent on training: 215.36372303962708
[rfa agg] training data poison_ratio: 0.3212532637075718  data num: [1715, 515, 1372, 408, 1470, 373, 901, 1574, 466, 781]
[rfa agg] considering poison per batch poison_fraction: 0.20078328981723237
[rfa agg] init. name: [92, 33, 42, 36, 22, 98, 4, 17, 76, 3], weight: tensor([0.1791, 0.0538, 0.1433, 0.0426, 0.1535, 0.0390, 0.0941, 0.1644, 0.0487,
        0.0816])
[rfa agg] iter:  0, prev_obj_val: 63.10075378417969, obj_val: 65.6410140991211, abs dis: 2.5402603149414062
[rfa agg] iter: 0, weight: tensor([0.1018, 0.0382, 0.1611, 0.0242, 0.1442, 0.0201, 0.2491, 0.1164, 0.0307,
        0.1142])
[rfa agg] iter:  1, prev_obj_val: 65.6410140991211, obj_val: 66.95532989501953, abs dis: 1.3143157958984375
[rfa agg] iter: 1, weight: tensor([0.0785, 0.0369, 0.1144, 0.0228, 0.1051, 0.0187, 0.3791, 0.0878, 0.0293,
        0.1275])
[rfa agg] iter:  2, prev_obj_val: 66.95532989501953, obj_val: 70.31086730957031, abs dis: 3.3555374145507812
[rfa agg] iter: 2, weight: tensor([0.0602, 0.0318, 0.0846, 0.0193, 0.0786, 0.0158, 0.4967, 0.0667, 0.0250,
        0.1213])
[rfa agg] iter:  3, prev_obj_val: 70.31086730957031, obj_val: 76.88944244384766, abs dis: 6.578575134277344
[rfa agg] iter: 3, weight: tensor([0.0501, 0.0340, 0.0665, 0.0198, 0.0629, 0.0159, 0.5000, 0.0546, 0.0260,
        0.1702])
[rfa agg] iter:  4, prev_obj_val: 76.88944244384766, obj_val: 82.10364532470703, abs dis: 5.214202880859375
[rfa agg] iter: 4, weight: tensor([0.0507, 0.0524, 0.0629, 0.0279, 0.0607, 0.0218, 0.1831, 0.0542, 0.0381,
        0.4480])
[rfa agg] iter:  5, prev_obj_val: 82.10364532470703, obj_val: 76.76397705078125, abs dis: 5.339668273925781
[rfa agg] iter: 5, weight: tensor([0.0591, 0.0860, 0.0708, 0.0416, 0.0689, 0.0317, 0.1516, 0.0625, 0.0591,
        0.3687])
[rfa agg] iter:  6, prev_obj_val: 76.76397705078125, obj_val: 79.34336853027344, abs dis: 2.5793914794921875
[rfa agg] iter: 6, weight: tensor([0.0432, 0.0448, 0.0536, 0.0238, 0.0516, 0.0186, 0.1499, 0.0462, 0.0326,
        0.5358])
[rfa agg] iter:  7, prev_obj_val: 79.34336853027344, obj_val: 79.3416976928711, abs dis: 0.00167083740234375
[rfa agg] iter: 7, weight: tensor([0.0474, 0.0576, 0.0577, 0.0294, 0.0559, 0.0227, 0.1387, 0.0504, 0.0409,
        0.4992])
			Update norm = 119.28042719784332 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 646.7304210662842 sec.
Server Epoch:25 choose agents : [5, 23, 0, 67, 40, 80, 54, 26, 74, 47].
poison local model 5 index 2 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   1, Avg loss: 0.0472, Accuracy: 863/1628 (53.0098%), train_poison_data_count: 1028
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   2, Avg loss: 0.0229, Accuracy: 1008/1628 (61.9165%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   3, Avg loss: 0.0206, Accuracy: 1028/1628 (63.1450%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   4, Avg loss: 0.0195, Accuracy: 1028/1628 (63.1450%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   5, Avg loss: 0.0190, Accuracy: 1028/1628 (63.1450%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   6, Avg loss: 0.0185, Accuracy: 1030/1628 (63.2678%), train_poison_data_count: 1028
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   7, Avg loss: 0.0181, Accuracy: 1031/1628 (63.3292%), train_poison_data_count: 1028
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   8, Avg loss: 0.0172, Accuracy: 1031/1628 (63.3292%), train_poison_data_count: 1028
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   9, Avg loss: 0.0176, Accuracy: 1033/1628 (63.4521%), train_poison_data_count: 1028
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch  10, Avg loss: 0.0177, Accuracy: 1039/1628 (63.8206%), train_poison_data_count: 1028
Global model norm: 112.0545957195643.
Norm before scaling: 112.02577566820281. Distance: 1.0881702330870653
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.0377, Accuracy: 53/10000 (0.5300%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.4550, Accuracy: 9946/9950 (99.9598%)
Scaling by  100
Scaled Norm after poisoning: 153.73048656658835, distance: 108.8170276556592
Total norm for 4 adversaries is: 153.73048656658835. distance: 108.8170276556592
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   1, Avg loss: 0.0642, Accuracy: 318/715 (44.4755%)
_Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   2, Avg loss: 0.0376, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.8538, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   1, Avg loss: 0.0588, Accuracy: 330/1657 (19.9155%)
_Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 505/1657 (30.4768%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.5876, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   1, Avg loss: 0.0785, Accuracy: 38/426 (8.9202%)
_Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   2, Avg loss: 0.0412, Accuracy: 176/426 (41.3146%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.6203, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 330/1573 (20.9790%)
_Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   2, Avg loss: 0.0351, Accuracy: 541/1573 (34.3929%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.3690, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   1, Avg loss: 0.0699, Accuracy: 153/682 (22.4340%)
_Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   2, Avg loss: 0.0384, Accuracy: 255/682 (37.3900%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.2594, Accuracy: 49/10000 (0.4900%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0554, Accuracy: 346/1130 (30.6195%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 483/1130 (42.7434%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8185, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0553, Accuracy: 350/1446 (24.2047%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 510/1446 (35.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.0558, Accuracy: 63/10000 (0.6300%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 511/1552 (32.9253%)
_Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 772/1552 (49.7423%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 11.8156, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   1, Avg loss: 0.1185, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   2, Avg loss: 0.1061, Accuracy: 24/134 (17.9104%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3183, Accuracy: 50/10000 (0.5000%)
time spent on training: 320.85118532180786
[rfa agg] training data poison_ratio: 0.5452800877273143  data num: [1628, 715, 1657, 426, 1573, 682, 1130, 1446, 1552, 134]
[rfa agg] considering poison per batch poison_fraction: 0.34080005482957143
[rfa agg] init. name: [5, 23, 0, 67, 40, 80, 54, 26, 74, 47], weight: tensor([0.1488, 0.0653, 0.1514, 0.0389, 0.1437, 0.0623, 0.1033, 0.1321, 0.1418,
        0.0122])
[rfa agg] iter:  0, prev_obj_val: 29414.833984375, obj_val: 19687.349609375, abs dis: 9727.484375
[rfa agg] iter: 0, weight: tensor([0.0296, 0.0741, 0.1731, 0.0441, 0.1642, 0.0707, 0.1175, 0.1508, 0.1620,
        0.0138])
[rfa agg] iter:  1, prev_obj_val: 19687.349609375, obj_val: 17703.52734375, abs dis: 1983.822265625
[rfa agg] iter: 1, weight: tensor([0.0053, 0.0746, 0.1793, 0.0439, 0.1698, 0.0710, 0.1197, 0.1552, 0.1675,
        0.0137])
[rfa agg] iter:  2, prev_obj_val: 17703.52734375, obj_val: 17345.5703125, abs dis: 357.95703125
[rfa agg] iter: 2, weight: tensor([0.0009, 0.0672, 0.1911, 0.0375, 0.1785, 0.0632, 0.1153, 0.1590, 0.1761,
        0.0112])
[rfa agg] iter:  3, prev_obj_val: 17345.5703125, obj_val: 17321.396484375, abs dis: 24.173828125
[rfa agg] iter: 3, weight: tensor([9.6836e-05, 2.9792e-02, 2.7720e-01, 1.3969e-02, 2.1742e-01, 2.6963e-02,
        6.9597e-02, 1.4715e-01, 2.1408e-01, 3.7409e-03])
[rfa agg] iter:  4, prev_obj_val: 17321.396484375, obj_val: 17324.908203125, abs dis: 3.51171875
[rfa agg] iter: 4, weight: tensor([4.4790e-05, 2.5440e-02, 1.4450e-01, 1.0115e-02, 1.7930e-01, 2.2081e-02,
        9.8416e-02, 3.4178e-01, 1.7582e-01, 2.4965e-03])
			Update norm = 192.89678060753113 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 736.343626499176 sec.
Server Epoch:26 choose agents : [26, 4, 33, 73, 30, 86, 10, 12, 68, 82].
_Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   1, Avg loss: 0.0555, Accuracy: 327/1446 (22.6141%)
_Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 474/1446 (32.7801%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.3830, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   1, Avg loss: 0.0630, Accuracy: 324/901 (35.9600%)
_Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   2, Avg loss: 0.0340, Accuracy: 364/901 (40.3996%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.8966, Accuracy: 50/10000 (0.5000%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   1, Avg loss: 0.0769, Accuracy: 63/515 (12.2330%)
_Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   2, Avg loss: 0.0533, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.8028, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0659, Accuracy: 168/938 (17.9104%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0338, Accuracy: 341/938 (36.3539%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.1891, Accuracy: 72/10000 (0.7200%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   1, Avg loss: 0.0804, Accuracy: 67/486 (13.7860%)
_Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   2, Avg loss: 0.0416, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.8009, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.0632, Accuracy: 346/1003 (34.4965%)
_Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0342, Accuracy: 392/1003 (39.0828%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.5130, Accuracy: 51/10000 (0.5100%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   1, Avg loss: 0.0564, Accuracy: 213/861 (24.7387%)
_Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 449/861 (52.1487%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.2174, Accuracy: 50/10000 (0.5000%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   1, Avg loss: 0.0889, Accuracy: 15/338 (4.4379%)
_Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   2, Avg loss: 0.0505, Accuracy: 137/338 (40.5325%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.4790, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0633, Accuracy: 365/1163 (31.3844%)
_Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0368, Accuracy: 446/1163 (38.3491%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.6517, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 60/500 (12.0000%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0497, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.6913, Accuracy: 45/10000 (0.4500%)
time spent on training: 208.81474614143372
[rfa agg] training data poison_ratio: 0.2699055330634278  data num: [1446, 901, 515, 938, 486, 1003, 861, 338, 1163, 500]
[rfa agg] considering poison per batch poison_fraction: 0.16869095816464236
[rfa agg] init. name: [26, 4, 33, 73, 30, 86, 10, 12, 68, 82], weight: tensor([0.1774, 0.1105, 0.0632, 0.1151, 0.0596, 0.1231, 0.1056, 0.0415, 0.1427,
        0.0613])
[rfa agg] iter:  0, prev_obj_val: 45.38835144042969, obj_val: 47.73112869262695, abs dis: 2.3427772521972656
[rfa agg] iter: 0, weight: tensor([0.0618, 0.1566, 0.0650, 0.1594, 0.0480, 0.1254, 0.2318, 0.0231, 0.0798,
        0.0492])
[rfa agg] iter:  1, prev_obj_val: 47.73112869262695, obj_val: 52.57356262207031, abs dis: 4.842433929443359
[rfa agg] iter: 1, weight: tensor([0.0651, 0.1463, 0.0830, 0.1502, 0.0594, 0.1220, 0.2036, 0.0276, 0.0818,
        0.0610])
[rfa agg] iter:  2, prev_obj_val: 52.57356262207031, obj_val: 50.13959503173828, abs dis: 2.4339675903320312
[rfa agg] iter: 2, weight: tensor([0.0659, 0.1221, 0.1334, 0.1261, 0.0864, 0.1086, 0.1537, 0.0362, 0.0792,
        0.0885])
[rfa agg] iter:  3, prev_obj_val: 50.13959503173828, obj_val: 47.73161315917969, abs dis: 2.4079818725585938
[rfa agg] iter: 3, weight: tensor([0.0666, 0.1346, 0.1064, 0.1386, 0.0726, 0.1166, 0.1761, 0.0322, 0.0818,
        0.0745])
[rfa agg] iter:  4, prev_obj_val: 47.73161315917969, obj_val: 52.5733642578125, abs dis: 4.8417510986328125
[rfa agg] iter: 4, weight: tensor([0.0652, 0.1462, 0.0835, 0.1501, 0.0596, 0.1222, 0.2024, 0.0276, 0.0819,
        0.0612])
[rfa agg] iter:  5, prev_obj_val: 52.5733642578125, obj_val: 50.13960266113281, abs dis: 2.4337615966796875
[rfa agg] iter: 5, weight: tensor([0.0659, 0.1221, 0.1334, 0.1261, 0.0864, 0.1086, 0.1537, 0.0362, 0.0792,
        0.0885])
[rfa agg] iter:  6, prev_obj_val: 50.13960266113281, obj_val: 47.73161315917969, abs dis: 2.407989501953125
[rfa agg] iter: 6, weight: tensor([0.0666, 0.1346, 0.1064, 0.1386, 0.0726, 0.1166, 0.1761, 0.0322, 0.0818,
        0.0745])
[rfa agg] iter:  7, prev_obj_val: 47.73161315917969, obj_val: 52.5733642578125, abs dis: 4.8417510986328125
[rfa agg] iter: 7, weight: tensor([0.0652, 0.1462, 0.0835, 0.1501, 0.0596, 0.1222, 0.2024, 0.0276, 0.0819,
        0.0612])
[rfa agg] iter:  8, prev_obj_val: 52.5733642578125, obj_val: 50.13960266113281, abs dis: 2.4337615966796875
[rfa agg] iter: 8, weight: tensor([0.0659, 0.1221, 0.1334, 0.1261, 0.0864, 0.1086, 0.1537, 0.0362, 0.0792,
        0.0885])
[rfa agg] iter:  9, prev_obj_val: 50.13960266113281, obj_val: 47.73161315917969, abs dis: 2.407989501953125
[rfa agg] iter: 9, weight: tensor([0.0666, 0.1346, 0.1064, 0.1386, 0.0726, 0.1166, 0.1761, 0.0322, 0.0818,
        0.0745])
			Update norm = 114.97475521147022 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 627.4130465984344 sec.
Server Epoch:27 choose agents : [9, 64, 30, 13, 76, 44, 39, 22, 78, 85].
poison local model 9 index 3 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Avg loss: 0.0500, Accuracy: 641/1275 (50.2745%), train_poison_data_count: 800
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Avg loss: 0.0219, Accuracy: 725/1275 (56.8627%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   3, Avg loss: 0.0187, Accuracy: 800/1275 (62.7451%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   4, Avg loss: 0.0179, Accuracy: 800/1275 (62.7451%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   5, Avg loss: 0.0171, Accuracy: 804/1275 (63.0588%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   6, Avg loss: 0.0171, Accuracy: 805/1275 (63.1373%), train_poison_data_count: 800
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   7, Avg loss: 0.0169, Accuracy: 805/1275 (63.1373%), train_poison_data_count: 800
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   8, Avg loss: 0.0164, Accuracy: 811/1275 (63.6078%), train_poison_data_count: 800
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   9, Avg loss: 0.0158, Accuracy: 811/1275 (63.6078%), train_poison_data_count: 800
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch  10, Avg loss: 0.0162, Accuracy: 815/1275 (63.9216%), train_poison_data_count: 800
Global model norm: 112.0545957195643.
Norm before scaling: 112.03379094050152. Distance: 1.007742413589967
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.5422, Accuracy: 55/10000 (0.5500%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.3348, Accuracy: 9949/9950 (99.9899%)
Scaling by  100
Scaled Norm after poisoning: 148.8075322039345, distance: 100.77424878782277
Total norm for 5 adversaries is: 148.8075322039345. distance: 100.77424878782277
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   1, Avg loss: 0.0650, Accuracy: 176/953 (18.4680%)
_Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 326/953 (34.2078%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.5296, Accuracy: 62/10000 (0.6200%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   1, Avg loss: 0.0808, Accuracy: 64/486 (13.1687%)
_Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   2, Avg loss: 0.0409, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.8319, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 318/1645 (19.3313%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 613/1645 (37.2644%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8535, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   1, Avg loss: 0.0862, Accuracy: 42/466 (9.0129%)
_Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   2, Avg loss: 0.0497, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.6307, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 385/1750 (22.0000%)
_Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 685/1750 (39.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.5861, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   1, Avg loss: 0.0547, Accuracy: 315/1013 (31.0958%)
_Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   2, Avg loss: 0.0264, Accuracy: 485/1013 (47.8776%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.6978, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 508/1470 (34.5578%)
_Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 898/1470 (61.0884%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0831, Accuracy: 77/10000 (0.7700%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   1, Avg loss: 0.0845, Accuracy: 33/416 (7.9327%)
_Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   2, Avg loss: 0.0475, Accuracy: 166/416 (39.9038%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.5650, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0544, Accuracy: 418/1988 (21.0262%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 700/1988 (35.2113%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.7104, Accuracy: 87/10000 (0.8700%)
time spent on training: 325.9907326698303
[rfa agg] training data poison_ratio: 0.5160530448438317  data num: [1275, 953, 486, 1645, 466, 1750, 1013, 1470, 416, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.3225331530273948
[rfa agg] init. name: [9, 64, 30, 13, 76, 44, 39, 22, 78, 85], weight: tensor([0.1112, 0.0831, 0.0424, 0.1435, 0.0407, 0.1527, 0.0884, 0.1282, 0.0363,
        0.1734])
[rfa agg] iter:  0, prev_obj_val: 17646.88671875, obj_val: 10990.1455078125, abs dis: 6656.7412109375
[rfa agg] iter: 0, weight: tensor([0.0154, 0.0915, 0.0464, 0.1595, 0.0445, 0.1700, 0.0973, 0.1421, 0.0396,
        0.1938])
[rfa agg] iter:  1, prev_obj_val: 10990.1455078125, obj_val: 10057.3671875, abs dis: 932.7783203125
[rfa agg] iter: 1, weight: tensor([0.0019, 0.0887, 0.0433, 0.1644, 0.0415, 0.1773, 0.0948, 0.1440, 0.0368,
        0.2071])
[rfa agg] iter:  2, prev_obj_val: 10057.3671875, obj_val: 9989.4462890625, abs dis: 67.9208984375
[rfa agg] iter: 2, weight: tensor([1.7111e-04, 5.1986e-02, 2.0617e-02, 1.6227e-01, 1.9768e-02, 2.0237e-01,
        5.7617e-02, 1.1891e-01, 1.7100e-02, 3.4918e-01])
[rfa agg] iter:  3, prev_obj_val: 9989.4462890625, obj_val: 9991.9931640625, abs dis: 2.546875
[rfa agg] iter: 3, weight: tensor([4.1774e-05, 2.9561e-02, 9.0684e-03, 4.1844e-01, 8.6948e-03, 2.1422e-01,
        3.4736e-02, 1.7871e-01, 7.3393e-03, 9.9188e-02])
[rfa agg] iter:  4, prev_obj_val: 9991.9931640625, obj_val: 9994.25, abs dis: 2.2568359375
[rfa agg] iter: 4, weight: tensor([4.4653e-05, 3.8920e-02, 1.0942e-02, 2.1919e-01, 1.0490e-02, 1.3302e-01,
        4.6902e-02, 4.5080e-01, 8.7930e-03, 8.0898e-02])
[rfa agg] iter:  5, prev_obj_val: 9994.25, obj_val: 9995.9345703125, abs dis: 1.6845703125
[rfa agg] iter: 5, weight: tensor([4.0595e-05, 4.0043e-02, 1.0632e-02, 1.4239e-01, 1.0193e-02, 9.9477e-02,
        4.9136e-02, 5.7359e-01, 8.5093e-03, 6.5992e-02])
[rfa agg] iter:  6, prev_obj_val: 9995.9345703125, obj_val: 9997.71875, abs dis: 1.7841796875
[rfa agg] iter: 6, weight: tensor([4.9145e-05, 5.1833e-02, 1.3326e-02, 1.5104e-01, 1.2777e-02, 1.1047e-01,
        6.4291e-02, 5.0964e-01, 1.0642e-02, 7.5932e-02])
			Update norm = 197.32133928569408 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 745.8209567070007 sec.
Server Epoch:28 choose agents : [64, 26, 82, 31, 65, 98, 73, 61, 44, 18].
_Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 166/953 (17.4187%)
_Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 315/953 (33.0535%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.4995, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   1, Avg loss: 0.0557, Accuracy: 342/1446 (23.6515%)
_Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 505/1446 (34.9239%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.1473, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 61/500 (12.2000%)
_Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0496, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.7499, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   1, Avg loss: 0.0826, Accuracy: 45/460 (9.7826%)
_Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.7945, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   1, Avg loss: 0.0562, Accuracy: 380/1475 (25.7627%)
_Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   2, Avg loss: 0.0319, Accuracy: 585/1475 (39.6610%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.9757, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.0827, Accuracy: 16/373 (4.2895%)
_Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0495, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.4639, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   1, Avg loss: 0.0659, Accuracy: 175/938 (18.6567%)
_Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 313/938 (33.3689%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.1371, Accuracy: 68/10000 (0.6800%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   1, Avg loss: 0.1265, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   2, Avg loss: 0.1183, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3087, Accuracy: 44/10000 (0.4400%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 387/1750 (22.1143%)
_Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 688/1750 (39.3143%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.7112, Accuracy: 116/10000 (1.1600%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   1, Avg loss: 0.0719, Accuracy: 136/530 (25.6604%)
_Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   2, Avg loss: 0.0386, Accuracy: 264/530 (49.8113%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.1285, Accuracy: 62/10000 (0.6200%)
time spent on training: 212.42109155654907
[rfa agg] training data poison_ratio: 0.4512338425381904  data num: [953, 1446, 500, 460, 1475, 373, 938, 85, 1750, 530]
[rfa agg] considering poison per batch poison_fraction: 0.282021151586369
[rfa agg] init. name: [64, 26, 82, 31, 65, 98, 73, 61, 44, 18], weight: tensor([0.1120, 0.1699, 0.0588, 0.0541, 0.1733, 0.0438, 0.1102, 0.0100, 0.2056,
        0.0623])
[rfa agg] iter:  0, prev_obj_val: 64.67476654052734, obj_val: 68.63754272460938, abs dis: 3.9627761840820312
[rfa agg] iter: 0, weight: tensor([0.2929, 0.1170, 0.0312, 0.0287, 0.1038, 0.0188, 0.2863, 0.0031, 0.0808,
        0.0374])
[rfa agg] iter:  1, prev_obj_val: 68.63754272460938, obj_val: 70.78922271728516, abs dis: 2.1516799926757812
[rfa agg] iter: 1, weight: tensor([0.3837, 0.0557, 0.0252, 0.0232, 0.0509, 0.0143, 0.3707, 0.0022, 0.0427,
        0.0315])
[rfa agg] iter:  2, prev_obj_val: 70.78922271728516, obj_val: 73.10611724853516, abs dis: 2.31689453125
[rfa agg] iter: 2, weight: tensor([0.3475, 0.0669, 0.0347, 0.0319, 0.0616, 0.0194, 0.3390, 0.0029, 0.0524,
        0.0439])
[rfa agg] iter:  3, prev_obj_val: 73.10611724853516, obj_val: 70.78999328613281, abs dis: 2.3161239624023438
[rfa agg] iter: 3, weight: tensor([0.3067, 0.0785, 0.0467, 0.0430, 0.0725, 0.0255, 0.3007, 0.0037, 0.0625,
        0.0602])
[rfa agg] iter:  4, prev_obj_val: 70.78999328613281, obj_val: 70.78501892089844, abs dis: 0.004974365234375
[rfa agg] iter: 4, weight: tensor([0.3443, 0.0680, 0.0353, 0.0325, 0.0626, 0.0197, 0.3367, 0.0029, 0.0532,
        0.0447])
[rfa agg] iter:  5, prev_obj_val: 70.78501892089844, obj_val: 73.1058349609375, abs dis: 2.3208160400390625
[rfa agg] iter: 5, weight: tensor([0.3459, 0.0674, 0.0350, 0.0321, 0.0620, 0.0195, 0.3381, 0.0029, 0.0527,
        0.0443])
[rfa agg] iter:  6, prev_obj_val: 73.1058349609375, obj_val: 70.79000091552734, abs dis: 2.3158340454101562
[rfa agg] iter: 6, weight: tensor([0.3066, 0.0785, 0.0467, 0.0430, 0.0726, 0.0255, 0.3007, 0.0037, 0.0625,
        0.0602])
[rfa agg] iter:  7, prev_obj_val: 70.79000091552734, obj_val: 70.78501892089844, abs dis: 0.00498199462890625
[rfa agg] iter: 7, weight: tensor([0.3443, 0.0680, 0.0353, 0.0325, 0.0626, 0.0197, 0.3367, 0.0029, 0.0532,
        0.0447])
[rfa agg] iter:  8, prev_obj_val: 70.78501892089844, obj_val: 73.1058349609375, abs dis: 2.3208160400390625
[rfa agg] iter: 8, weight: tensor([0.3459, 0.0674, 0.0350, 0.0321, 0.0620, 0.0195, 0.3381, 0.0029, 0.0527,
        0.0443])
[rfa agg] iter:  9, prev_obj_val: 73.1058349609375, obj_val: 70.79000091552734, abs dis: 2.3158340454101562
[rfa agg] iter: 9, weight: tensor([0.3066, 0.0785, 0.0467, 0.0430, 0.0726, 0.0255, 0.3007, 0.0037, 0.0625,
        0.0602])
			Update norm = 132.13329266785868 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 630.4095063209534 sec.
Server Epoch:29 choose agents : [10, 11, 42, 19, 88, 80, 54, 78, 92, 96].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Avg loss: 0.0534, Accuracy: 388/861 (45.0639%), train_poison_data_count: 549
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Avg loss: 0.0301, Accuracy: 507/861 (58.8850%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Avg loss: 0.0209, Accuracy: 516/861 (59.9303%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Avg loss: 0.0182, Accuracy: 550/861 (63.8792%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Avg loss: 0.0184, Accuracy: 549/861 (63.7631%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Avg loss: 0.0180, Accuracy: 549/861 (63.7631%), train_poison_data_count: 549
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Avg loss: 0.0181, Accuracy: 549/861 (63.7631%), train_poison_data_count: 549
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Avg loss: 0.0174, Accuracy: 551/861 (63.9954%), train_poison_data_count: 549
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Avg loss: 0.0178, Accuracy: 551/861 (63.9954%), train_poison_data_count: 549
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Avg loss: 0.0168, Accuracy: 551/861 (63.9954%), train_poison_data_count: 549
Global model norm: 112.0545957195643.
Norm before scaling: 112.04154851549491. Distance: 0.836437147322712
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.9600, Accuracy: 54/10000 (0.5400%)
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: 0.4028, Accuracy: 9948/9950 (99.9799%)
Scaling by  100
Scaled Norm after poisoning: 138.5283138928645, distance: 83.64371170513955
Total norm for 4 adversaries is: 138.5283138928645. distance: 83.64371170513955
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0528, Accuracy: 356/712 (50.0000%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 426/712 (59.8315%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.5137, Accuracy: 50/10000 (0.5000%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 358/1372 (26.0933%)
_Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 475/1372 (34.6210%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.7655, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 390/1036 (37.6448%)
_Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   2, Avg loss: 0.0247, Accuracy: 666/1036 (64.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.2099, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.0720, Accuracy: 152/603 (25.2073%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0446, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.8922, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   1, Avg loss: 0.0702, Accuracy: 150/682 (21.9941%)
_Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 233/682 (34.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.2892, Accuracy: 52/10000 (0.5200%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 345/1130 (30.5310%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 485/1130 (42.9204%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.4650, Accuracy: 51/10000 (0.5100%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.0837, Accuracy: 38/416 (9.1346%)
_Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0482, Accuracy: 167/416 (40.1442%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.5794, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   1, Avg loss: 0.0519, Accuracy: 460/1715 (26.8222%)
_Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 721/1715 (42.0408%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.7231, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.0794, Accuracy: 41/311 (13.1833%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0547, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3609, Accuracy: 50/10000 (0.5000%)
time spent on training: 313.1909713745117
[rfa agg] training data poison_ratio: 0.42758542656709664  data num: [861, 712, 1372, 1036, 603, 682, 1130, 416, 1715, 311]
[rfa agg] considering poison per batch poison_fraction: 0.2672408916044354
[rfa agg] init. name: [10, 11, 42, 19, 88, 80, 54, 78, 92, 96], weight: tensor([0.0974, 0.0806, 0.1552, 0.1172, 0.0682, 0.0772, 0.1279, 0.0471, 0.1940,
        0.0352])
[rfa agg] iter:  0, prev_obj_val: 10987.3291015625, obj_val: 6662.19970703125, abs dis: 4325.12939453125
[rfa agg] iter: 0, weight: tensor([0.0115, 0.0875, 0.1711, 0.1282, 0.0739, 0.0837, 0.1401, 0.0507, 0.2155,
        0.0378])
[rfa agg] iter:  1, prev_obj_val: 6662.19970703125, obj_val: 6157.01318359375, abs dis: 505.1865234375
[rfa agg] iter: 1, weight: tensor([0.0012, 0.0825, 0.1805, 0.1277, 0.0682, 0.0781, 0.1411, 0.0455, 0.2420,
        0.0332])
[rfa agg] iter:  2, prev_obj_val: 6157.01318359375, obj_val: 6146.98681640625, abs dis: 10.0263671875
[rfa agg] iter: 2, weight: tensor([7.3159e-05, 3.5128e-02, 3.6311e-01, 8.7110e-02, 2.5506e-02, 3.1076e-02,
        1.1011e-01, 1.4487e-02, 3.2373e-01, 9.6662e-03])
[rfa agg] iter:  3, prev_obj_val: 6146.98681640625, obj_val: 6147.67333984375, abs dis: 0.6865234375
[rfa agg] iter: 3, weight: tensor([5.6756e-05, 4.6473e-02, 2.0529e-01, 2.1422e-01, 3.0713e-02, 3.9101e-02,
        3.3965e-01, 1.5916e-02, 9.8410e-02, 1.0169e-02])
[rfa agg] iter:  4, prev_obj_val: 6147.67333984375, obj_val: 6153.71533203125, abs dis: 6.0419921875
[rfa agg] iter: 4, weight: tensor([3.9618e-05, 4.5181e-02, 8.6802e-02, 4.3977e-01, 2.7525e-02, 3.6320e-02,
        2.8788e-01, 1.3319e-02, 5.4898e-02, 8.2660e-03])
[rfa agg] iter:  5, prev_obj_val: 6153.71533203125, obj_val: 6153.67529296875, abs dis: 0.0400390625
[rfa agg] iter: 5, weight: tensor([6.8495e-05, 1.2679e-01, 1.0782e-01, 2.7858e-01, 6.6085e-02, 9.3207e-02,
        2.0249e-01, 2.8688e-02, 7.9205e-02, 1.7076e-02])
			Update norm = 140.80710431295716 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 735.6417570114136 sec.
Server Epoch:30 choose agents : [90, 87, 0, 73, 61, 97, 66, 35, 1, 22].
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0575, Accuracy: 311/677 (45.9380%)
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 467/677 (68.9808%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.9922, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   1, Avg loss: 0.0583, Accuracy: 291/1131 (25.7294%)
_Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   2, Avg loss: 0.0311, Accuracy: 425/1131 (37.5774%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8639, Accuracy: 55/10000 (0.5500%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 385/1657 (23.2348%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 525/1657 (31.6838%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.2895, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   1, Avg loss: 0.0668, Accuracy: 165/938 (17.5906%)
_Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 313/938 (33.3689%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.0214, Accuracy: 62/10000 (0.6200%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3089, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   1, Avg loss: 0.0520, Accuracy: 350/1213 (28.8541%)
_Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 479/1213 (39.4889%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8445, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0615, Accuracy: 255/1402 (18.1883%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 392/1402 (27.9601%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.1626, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   1, Avg loss: 0.0859, Accuracy: 36/271 (13.2841%)
_Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   2, Avg loss: 0.0577, Accuracy: 96/271 (35.4244%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3800, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0561, Accuracy: 293/928 (31.5733%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0231, Accuracy: 589/928 (63.4698%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.5272, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 504/1470 (34.2857%)
_Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 872/1470 (59.3197%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.4785, Accuracy: 102/10000 (1.0200%)
time spent on training: 217.9379017353058
[rfa agg] training data poison_ratio: 0.17826442898076136  data num: [677, 1131, 1657, 938, 85, 1213, 1402, 271, 928, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.11141526811297585
[rfa agg] init. name: [90, 87, 0, 73, 61, 97, 66, 35, 1, 22], weight: tensor([0.0693, 0.1157, 0.1696, 0.0960, 0.0087, 0.1241, 0.1435, 0.0277, 0.0950,
        0.1504])
[rfa agg] iter:  0, prev_obj_val: 45.579071044921875, obj_val: 51.79202651977539, abs dis: 6.212955474853516
[rfa agg] iter: 0, weight: tensor([0.0406, 0.2209, 0.0576, 0.1846, 0.0019, 0.1514, 0.0837, 0.0078, 0.1773,
        0.0743])
[rfa agg] iter:  1, prev_obj_val: 51.79202651977539, obj_val: 51.67659378051758, abs dis: 0.1154327392578125
[rfa agg] iter: 1, weight: tensor([0.0434, 0.0955, 0.0390, 0.3350, 0.0017, 0.0772, 0.0517, 0.0070, 0.3021,
        0.0474])
[rfa agg] iter:  2, prev_obj_val: 51.67659378051758, obj_val: 57.893959045410156, abs dis: 6.217365264892578
[rfa agg] iter: 2, weight: tensor([0.0386, 0.0835, 0.0346, 0.3630, 0.0015, 0.0680, 0.0459, 0.0062, 0.3166,
        0.0421])
[rfa agg] iter:  3, prev_obj_val: 57.893959045410156, obj_val: 54.6082763671875, abs dis: 3.2856826782226562
[rfa agg] iter: 3, weight: tensor([0.0777, 0.0975, 0.0486, 0.2872, 0.0024, 0.0842, 0.0616, 0.0105, 0.2728,
        0.0574])
[rfa agg] iter:  4, prev_obj_val: 54.6082763671875, obj_val: 51.67655563354492, abs dis: 2.931720733642578
[rfa agg] iter: 4, weight: tensor([0.0534, 0.0880, 0.0403, 0.3290, 0.0019, 0.0740, 0.0521, 0.0079, 0.3054,
        0.0482])
[rfa agg] iter:  5, prev_obj_val: 51.67655563354492, obj_val: 57.893924713134766, abs dis: 6.217369079589844
[rfa agg] iter: 5, weight: tensor([0.0385, 0.0834, 0.0346, 0.3605, 0.0015, 0.0680, 0.0459, 0.0062, 0.3193,
        0.0421])
[rfa agg] iter:  6, prev_obj_val: 57.893924713134766, obj_val: 54.608280181884766, abs dis: 3.28564453125
[rfa agg] iter: 6, weight: tensor([0.0777, 0.0975, 0.0486, 0.2869, 0.0024, 0.0842, 0.0616, 0.0105, 0.2732,
        0.0574])
[rfa agg] iter:  7, prev_obj_val: 54.608280181884766, obj_val: 51.67655944824219, abs dis: 2.931720733642578
[rfa agg] iter: 7, weight: tensor([0.0534, 0.0880, 0.0403, 0.3289, 0.0019, 0.0740, 0.0521, 0.0079, 0.3055,
        0.0482])
[rfa agg] iter:  8, prev_obj_val: 51.67655944824219, obj_val: 57.89392852783203, abs dis: 6.217369079589844
[rfa agg] iter: 8, weight: tensor([0.0385, 0.0834, 0.0346, 0.3604, 0.0015, 0.0680, 0.0459, 0.0062, 0.3194,
        0.0421])
[rfa agg] iter:  9, prev_obj_val: 57.89392852783203, obj_val: 54.608280181884766, abs dis: 3.2856483459472656
[rfa agg] iter: 9, weight: tensor([0.0777, 0.0975, 0.0486, 0.2869, 0.0024, 0.0842, 0.0616, 0.0105, 0.2732,
        0.0574])
			Update norm = 136.4988839240087 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 638.4837739467621 sec.
Server Epoch:31 choose agents : [12, 97, 60, 95, 0, 45, 47, 74, 1, 90].
poison local model 12 index 5 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   1, Avg loss: 0.0832, Accuracy: 54/338 (15.9763%), train_poison_data_count: 218
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   2, Avg loss: 0.0390, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   3, Avg loss: 0.0407, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   4, Avg loss: 0.0408, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   5, Avg loss: 0.0378, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   6, Avg loss: 0.0352, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   7, Avg loss: 0.0312, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   8, Avg loss: 0.0291, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   9, Avg loss: 0.0267, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch  10, Avg loss: 0.0277, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Global model norm: 112.0545957195643.
Norm before scaling: 112.05044291662796. Distance: 0.5307696358547345
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.8245, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: 0.2879, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 123.49863596792274, distance: 53.07696127661582
Total norm for 5 adversaries is: 123.49863596792274. distance: 53.07696127661582
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0515, Accuracy: 356/1213 (29.3487%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 492/1213 (40.5606%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.7710, Accuracy: 89/10000 (0.8900%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 552/2227 (24.7867%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1034/2227 (46.4302%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.4138, Accuracy: 125/10000 (1.2500%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.0535, Accuracy: 323/599 (53.9232%)
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0298, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8105, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0585, Accuracy: 363/1657 (21.9071%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0351, Accuracy: 505/1657 (30.4768%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8580, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   1, Avg loss: 0.0690, Accuracy: 191/669 (28.5501%)
_Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   2, Avg loss: 0.0404, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.8612, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   1, Avg loss: 0.1238, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   2, Avg loss: 0.1087, Accuracy: 12/134 (8.9552%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3156, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 514/1552 (33.1186%)
_Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 772/1552 (49.7423%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.5928, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 288/928 (31.0345%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 554/928 (59.6983%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8176, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 316/677 (46.6765%)
_Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 460/677 (67.9468%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.1493, Accuracy: 53/10000 (0.5300%)
time spent on training: 323.08558416366577
[rfa agg] training data poison_ratio: 0.6376826095657394  data num: [338, 1213, 2227, 599, 1657, 669, 134, 1552, 928, 677]
[rfa agg] considering poison per batch poison_fraction: 0.39855163097858715
[rfa agg] init. name: [12, 97, 60, 95, 0, 45, 47, 74, 1, 90], weight: tensor([0.0338, 0.1214, 0.2228, 0.0599, 0.1658, 0.0669, 0.0134, 0.1553, 0.0929,
        0.0677])
[rfa agg] iter:  0, prev_obj_val: 1742.4993896484375, obj_val: 979.8433837890625, abs dis: 762.656005859375
[rfa agg] iter: 0, weight: tensor([0.0012, 0.1202, 0.2607, 0.0546, 0.1761, 0.0616, 0.0115, 0.1633, 0.0886,
        0.0623])
[rfa agg] iter:  1, prev_obj_val: 979.8433837890625, obj_val: 979.608154296875, abs dis: 0.2352294921875
[rfa agg] iter: 1, weight: tensor([3.5850e-05, 5.8919e-02, 7.4531e-02, 1.2328e-02, 4.1048e-01, 1.4710e-02,
        1.8885e-03, 3.8409e-01, 2.8123e-02, 1.4897e-02])
[rfa agg] iter:  2, prev_obj_val: 979.608154296875, obj_val: 981.4894409179688, abs dis: 1.88128662109375
[rfa agg] iter: 2, weight: tensor([4.9929e-05, 1.1673e-01, 8.5744e-02, 1.9722e-02, 2.8029e-01, 2.3771e-02,
        2.8912e-03, 3.9847e-01, 4.8248e-02, 2.4079e-02])
[rfa agg] iter:  3, prev_obj_val: 981.4894409179688, obj_val: 983.5595703125, abs dis: 2.07012939453125
[rfa agg] iter: 3, weight: tensor([6.3399e-05, 2.1697e-01, 9.6562e-02, 2.8174e-02, 2.2789e-01, 3.4298e-02,
        3.9586e-03, 2.8310e-01, 7.4232e-02, 3.4745e-02])
[rfa agg] iter:  4, prev_obj_val: 983.5595703125, obj_val: 986.1203002929688, abs dis: 2.56072998046875
[rfa agg] iter: 4, weight: tensor([6.0120e-05, 3.7726e-01, 8.2255e-02, 3.0534e-02, 1.5928e-01, 3.7658e-02,
        4.0725e-03, 1.8149e-01, 8.9235e-02, 3.8156e-02])
[rfa agg] iter:  5, prev_obj_val: 986.1203002929688, obj_val: 989.1732177734375, abs dis: 3.05291748046875
[rfa agg] iter: 5, weight: tensor([3.8156e-05, 6.2646e-01, 4.7368e-02, 2.2591e-02, 7.9828e-02, 2.8355e-02,
        2.8232e-03, 8.6889e-02, 7.6915e-02, 2.8737e-02])
[rfa agg] iter:  6, prev_obj_val: 989.1732177734375, obj_val: 992.6842041015625, abs dis: 3.510986328125
[rfa agg] iter: 6, weight: tensor([4.9696e-05, 5.0266e-01, 5.8082e-02, 3.3023e-02, 9.1011e-02, 4.2090e-02,
        3.9161e-03, 9.7017e-02, 1.2948e-01, 4.2664e-02])
[rfa agg] iter:  7, prev_obj_val: 992.6842041015625, obj_val: 992.6497192382812, abs dis: 0.03448486328125
[rfa agg] iter: 7, weight: tensor([6.1422e-05, 3.2285e-01, 6.7857e-02, 4.6614e-02, 1.0034e-01, 6.0608e-02,
        5.1791e-03, 1.0545e-01, 2.2957e-01, 6.1467e-02])
			Update norm = 158.02907787215935 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 739.3705043792725 sec.
Server Epoch:32 choose agents : [90, 32, 84, 98, 78, 46, 40, 68, 29, 95].
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0579, Accuracy: 317/677 (46.8242%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0224, Accuracy: 455/677 (67.2083%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.4472, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 200/735 (27.2109%)
_Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0238, Accuracy: 321/735 (43.6735%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.6758, Accuracy: 56/10000 (0.5600%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0624, Accuracy: 321/1190 (26.9748%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 435/1190 (36.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.0544, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   1, Avg loss: 0.0828, Accuracy: 10/373 (2.6810%)
_Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   2, Avg loss: 0.0494, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.4703, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   1, Avg loss: 0.0841, Accuracy: 36/416 (8.6538%)
_Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   2, Avg loss: 0.0462, Accuracy: 174/416 (41.8269%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.6306, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0550, Accuracy: 445/1904 (23.3718%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 671/1904 (35.2416%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.6001, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   1, Avg loss: 0.0554, Accuracy: 377/1573 (23.9669%)
_Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 566/1573 (35.9822%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.6251, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   1, Avg loss: 0.0629, Accuracy: 363/1163 (31.2124%)
_Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   2, Avg loss: 0.0375, Accuracy: 418/1163 (35.9415%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.8937, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 399/1440 (27.7083%)
_Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 673/1440 (46.7361%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.4093, Accuracy: 78/10000 (0.7800%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0522, Accuracy: 333/599 (55.5927%)
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0288, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.0891, Accuracy: 50/10000 (0.5000%)
time spent on training: 213.10817527770996
[rfa agg] training data poison_ratio: 0.21896722939424032  data num: [677, 735, 1190, 373, 416, 1904, 1573, 1163, 1440, 599]
[rfa agg] considering poison per batch poison_fraction: 0.1368545183714002
[rfa agg] init. name: [90, 32, 84, 98, 78, 46, 40, 68, 29, 95], weight: tensor([0.0672, 0.0730, 0.1182, 0.0370, 0.0413, 0.1891, 0.1562, 0.1155, 0.1430,
        0.0595])
[rfa agg] iter:  0, prev_obj_val: 61.95549011230469, obj_val: 63.729732513427734, abs dis: 1.7742424011230469
[rfa agg] iter: 0, weight: tensor([0.0447, 0.0571, 0.2760, 0.0139, 0.0170, 0.0655, 0.0898, 0.2904, 0.1112,
        0.0343])
[rfa agg] iter:  1, prev_obj_val: 63.729732513427734, obj_val: 65.6428451538086, abs dis: 1.9131126403808594
[rfa agg] iter: 1, weight: tensor([0.0537, 0.0695, 0.2602, 0.0162, 0.0198, 0.0700, 0.0935, 0.2628, 0.1136,
        0.0408])
[rfa agg] iter:  2, prev_obj_val: 65.6428451538086, obj_val: 67.57715606689453, abs dis: 1.9343109130859375
[rfa agg] iter: 2, weight: tensor([0.0646, 0.0851, 0.2365, 0.0187, 0.0230, 0.0743, 0.0972, 0.2363, 0.1159,
        0.0484])
[rfa agg] iter:  3, prev_obj_val: 67.57715606689453, obj_val: 65.64256286621094, abs dis: 1.9345932006835938
[rfa agg] iter: 3, weight: tensor([0.0760, 0.1022, 0.2145, 0.0210, 0.0260, 0.0768, 0.0984, 0.2133, 0.1155,
        0.0561])
[rfa agg] iter:  4, prev_obj_val: 65.64256286621094, obj_val: 67.57707214355469, abs dis: 1.93450927734375
[rfa agg] iter: 4, weight: tensor([0.0648, 0.0854, 0.2353, 0.0187, 0.0231, 0.0745, 0.0974, 0.2360, 0.1162,
        0.0486])
[rfa agg] iter:  5, prev_obj_val: 67.57707214355469, obj_val: 65.64256286621094, abs dis: 1.93450927734375
[rfa agg] iter: 5, weight: tensor([0.0760, 0.1023, 0.2145, 0.0210, 0.0260, 0.0768, 0.0984, 0.2133, 0.1155,
        0.0562])
[rfa agg] iter:  6, prev_obj_val: 65.64256286621094, obj_val: 67.57707214355469, abs dis: 1.93450927734375
[rfa agg] iter: 6, weight: tensor([0.0648, 0.0854, 0.2353, 0.0187, 0.0231, 0.0745, 0.0974, 0.2360, 0.1162,
        0.0486])
[rfa agg] iter:  7, prev_obj_val: 67.57707214355469, obj_val: 65.64256286621094, abs dis: 1.93450927734375
[rfa agg] iter: 7, weight: tensor([0.0760, 0.1023, 0.2145, 0.0210, 0.0260, 0.0768, 0.0984, 0.2133, 0.1155,
        0.0562])
[rfa agg] iter:  8, prev_obj_val: 65.64256286621094, obj_val: 67.57707214355469, abs dis: 1.93450927734375
[rfa agg] iter: 8, weight: tensor([0.0648, 0.0854, 0.2353, 0.0187, 0.0231, 0.0745, 0.0974, 0.2360, 0.1162,
        0.0486])
[rfa agg] iter:  9, prev_obj_val: 67.57707214355469, obj_val: 65.64256286621094, abs dis: 1.93450927734375
[rfa agg] iter: 9, weight: tensor([0.0760, 0.1023, 0.2145, 0.0210, 0.0260, 0.0768, 0.0984, 0.2133, 0.1155,
        0.0562])
			Update norm = 153.63929576486936 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 633.9106738567352 sec.
Server Epoch:33 choose agents : [15, 44, 14, 40, 61, 33, 88, 73, 21, 30].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Avg loss: 0.0518, Accuracy: 556/1154 (48.1802%), train_poison_data_count: 722
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Avg loss: 0.0262, Accuracy: 670/1154 (58.0589%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Avg loss: 0.0220, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Avg loss: 0.0212, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Avg loss: 0.0216, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Avg loss: 0.0209, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Avg loss: 0.0207, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Avg loss: 0.0207, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Avg loss: 0.0204, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Avg loss: 0.0198, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Global model norm: 112.0545957195643.
Norm before scaling: 112.03434880651558. Distance: 0.8943652536219704
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.2325, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: 0.3985, Accuracy: 9940/9950 (99.8995%)
Scaling by  100
Scaled Norm after poisoning: 141.4967355520084, distance: 89.43653093901982
Total norm for 5 adversaries is: 141.4967355520084. distance: 89.43653093901982
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Avg loss: 0.0593, Accuracy: 397/1750 (22.6857%)
_Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 659/1750 (37.6571%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.5372, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0618, Accuracy: 220/1013 (21.7177%)
_Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 324/1013 (31.9842%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.7504, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 341/1573 (21.6783%)
_Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 575/1573 (36.5544%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.3848, Accuracy: 73/10000 (0.7300%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   1, Avg loss: 0.1253, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   2, Avg loss: 0.1190, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3089, Accuracy: 49/10000 (0.4900%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   1, Avg loss: 0.0788, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   2, Avg loss: 0.0499, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.7304, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   1, Avg loss: 0.0722, Accuracy: 148/603 (24.5439%)
_Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   2, Avg loss: 0.0445, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.8488, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   1, Avg loss: 0.0661, Accuracy: 179/938 (19.0832%)
_Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   2, Avg loss: 0.0337, Accuracy: 323/938 (34.4350%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.1408, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 422/1949 (21.6521%)
_Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 589/1949 (30.2206%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.1187, Accuracy: 84/10000 (0.8400%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   1, Avg loss: 0.0807, Accuracy: 68/486 (13.9918%)
_Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.8122, Accuracy: 45/10000 (0.4500%)
time spent on training: 318.01773285865784
[rfa agg] training data poison_ratio: 0.3963838664812239  data num: [1154, 1750, 1013, 1573, 85, 515, 603, 938, 1949, 486]
[rfa agg] considering poison per batch poison_fraction: 0.24773991655076494
[rfa agg] init. name: [15, 44, 14, 40, 61, 33, 88, 73, 21, 30], weight: tensor([0.1146, 0.1739, 0.1006, 0.1563, 0.0084, 0.0512, 0.0599, 0.0932, 0.1936,
        0.0483])
[rfa agg] iter:  0, prev_obj_val: 17218.279296875, obj_val: 10794.6328125, abs dis: 6423.646484375
[rfa agg] iter: 0, weight: tensor([0.0165, 0.1942, 0.1112, 0.1741, 0.0092, 0.0562, 0.0658, 0.1029, 0.2169,
        0.0530])
[rfa agg] iter:  1, prev_obj_val: 10794.6328125, obj_val: 9859.4384765625, abs dis: 935.1943359375
[rfa agg] iter: 1, weight: tensor([0.0021, 0.2037, 0.1090, 0.1794, 0.0084, 0.0531, 0.0626, 0.1003, 0.2315,
        0.0498])
[rfa agg] iter:  2, prev_obj_val: 9859.4384765625, obj_val: 9788.12109375, abs dis: 71.3173828125
[rfa agg] iter: 2, weight: tensor([2.0388e-04, 2.4262e-01, 7.0547e-02, 1.7488e-01, 3.7221e-03, 2.7762e-02,
        3.3591e-02, 6.2697e-02, 3.5860e-01, 2.5379e-02])
[rfa agg] iter:  3, prev_obj_val: 9788.12109375, obj_val: 9790.0224609375, abs dis: 1.9013671875
[rfa agg] iter: 3, weight: tensor([4.6930e-05, 1.8640e-01, 4.5720e-02, 5.7344e-01, 1.4428e-03, 1.2791e-02,
        1.6007e-02, 3.7887e-02, 1.1492e-01, 1.1341e-02])
			Update norm = 214.7526374983553 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 737.1281287670135 sec.
Server Epoch:34 choose agents : [0, 71, 20, 83, 56, 36, 68, 89, 82, 19].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 352/1657 (21.2432%)
_Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 519/1657 (31.3217%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.8300, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0652, Accuracy: 161/818 (19.6822%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0314, Accuracy: 335/818 (40.9535%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.0017, Accuracy: 61/10000 (0.6100%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   1, Avg loss: 0.0563, Accuracy: 345/807 (42.7509%)
_Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 426/807 (52.7881%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.2413, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 434/1953 (22.2222%)
_Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0332, Accuracy: 800/1953 (40.9626%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.0194, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   1, Avg loss: 0.0836, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   2, Avg loss: 0.0684, Accuracy: 62/186 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3188, Accuracy: 50/10000 (0.5000%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   1, Avg loss: 0.0878, Accuracy: 69/408 (16.9118%)
_Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   2, Avg loss: 0.0567, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.5051, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   1, Avg loss: 0.0637, Accuracy: 371/1163 (31.9003%)
_Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   2, Avg loss: 0.0379, Accuracy: 407/1163 (34.9957%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.6090, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   1, Avg loss: 0.0617, Accuracy: 321/896 (35.8259%)
_Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   2, Avg loss: 0.0339, Accuracy: 448/896 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.2873, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 65/500 (13.0000%)
_Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.6816, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   1, Avg loss: 0.0463, Accuracy: 363/1036 (35.0386%)
_Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 670/1036 (64.6718%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.0961, Accuracy: 54/10000 (0.5400%)
time spent on training: 217.22813963890076
[rfa agg] training data poison_ratio: 0.30475382003395585  data num: [1657, 818, 807, 1953, 186, 408, 1163, 896, 500, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.1904711375212224
[rfa agg] init. name: [0, 71, 20, 83, 56, 36, 68, 89, 82, 19], weight: tensor([0.1758, 0.0868, 0.0856, 0.2072, 0.0197, 0.0433, 0.1234, 0.0951, 0.0531,
        0.1099])
[rfa agg] iter:  0, prev_obj_val: 63.17611312866211, obj_val: 66.77948760986328, abs dis: 3.603374481201172
[rfa agg] iter: 0, weight: tensor([0.0666, 0.0732, 0.0716, 0.0506, 0.0048, 0.0148, 0.1956, 0.1047, 0.0201,
        0.3981])
[rfa agg] iter:  1, prev_obj_val: 66.77948760986328, obj_val: 71.08635711669922, abs dis: 4.3068695068359375
[rfa agg] iter: 1, weight: tensor([0.0570, 0.1445, 0.1379, 0.0462, 0.0058, 0.0192, 0.1085, 0.2657, 0.0269,
        0.1882])
[rfa agg] iter:  2, prev_obj_val: 71.08635711669922, obj_val: 76.16749572753906, abs dis: 5.081138610839844
[rfa agg] iter: 2, weight: tensor([0.0345, 0.2576, 0.2137, 0.0291, 0.0045, 0.0162, 0.0547, 0.2909, 0.0235,
        0.0753])
[rfa agg] iter:  3, prev_obj_val: 76.16749572753906, obj_val: 79.34883880615234, abs dis: 3.1813430786132812
[rfa agg] iter: 3, weight: tensor([0.0367, 0.3224, 0.2637, 0.0316, 0.0057, 0.0219, 0.0531, 0.1648, 0.0328,
        0.0674])
[rfa agg] iter:  4, prev_obj_val: 79.34883880615234, obj_val: 76.14303588867188, abs dis: 3.2058029174804688
[rfa agg] iter: 4, weight: tensor([0.0451, 0.2779, 0.2522, 0.0392, 0.0076, 0.0306, 0.0629, 0.1600, 0.0468,
        0.0776])
[rfa agg] iter:  5, prev_obj_val: 76.14303588867188, obj_val: 79.34951782226562, abs dis: 3.20648193359375
[rfa agg] iter: 5, weight: tensor([0.0359, 0.3267, 0.2728, 0.0309, 0.0056, 0.0215, 0.0520, 0.1566, 0.0321,
        0.0660])
[rfa agg] iter:  6, prev_obj_val: 79.34951782226562, obj_val: 76.1429672241211, abs dis: 3.2065505981445312
[rfa agg] iter: 6, weight: tensor([0.0450, 0.2778, 0.2530, 0.0391, 0.0076, 0.0306, 0.0629, 0.1596, 0.0468,
        0.0775])
[rfa agg] iter:  7, prev_obj_val: 76.1429672241211, obj_val: 79.34952545166016, abs dis: 3.2065582275390625
[rfa agg] iter: 7, weight: tensor([0.0359, 0.3266, 0.2729, 0.0309, 0.0056, 0.0214, 0.0520, 0.1566, 0.0321,
        0.0660])
[rfa agg] iter:  8, prev_obj_val: 79.34952545166016, obj_val: 76.1429672241211, abs dis: 3.2065582275390625
[rfa agg] iter: 8, weight: tensor([0.0450, 0.2778, 0.2530, 0.0391, 0.0076, 0.0306, 0.0629, 0.1596, 0.0468,
        0.0775])
[rfa agg] iter:  9, prev_obj_val: 76.1429672241211, obj_val: 79.34953308105469, abs dis: 3.2065658569335938
[rfa agg] iter: 9, weight: tensor([0.0359, 0.3266, 0.2729, 0.0309, 0.0056, 0.0214, 0.0520, 0.1566, 0.0321,
        0.0660])
			Update norm = 115.16428482824004 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 634.2323663234711 sec.
Server Epoch:35 choose agents : [18, 75, 5, 22, 38, 73, 46, 20, 83, 88].
poison local model 18 index 7 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   1, Avg loss: 0.0655, Accuracy: 177/530 (33.3962%), train_poison_data_count: 338
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   2, Avg loss: 0.0381, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   3, Avg loss: 0.0305, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   4, Avg loss: 0.0267, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   5, Avg loss: 0.0258, Accuracy: 339/530 (63.9623%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   6, Avg loss: 0.0247, Accuracy: 339/530 (63.9623%), train_poison_data_count: 338
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   7, Avg loss: 0.0240, Accuracy: 342/530 (64.5283%), train_poison_data_count: 338
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   8, Avg loss: 0.0224, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   9, Avg loss: 0.0237, Accuracy: 339/530 (63.9623%), train_poison_data_count: 338
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch  10, Avg loss: 0.0233, Accuracy: 337/530 (63.5849%), train_poison_data_count: 338
Global model norm: 112.0545957195643.
Norm before scaling: 112.04719638951258. Distance: 0.6660356490629293
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.8453, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: 0.3288, Accuracy: 9949/9950 (99.9899%)
Scaling by  100
Scaled Norm after poisoning: 129.54581115381538, distance: 66.60357080916346
Total norm for 3 adversaries is: 129.54581115381538. distance: 66.60357080916346
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   1, Avg loss: 0.0623, Accuracy: 250/776 (32.2165%)
_Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 430/776 (55.4124%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.8248, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   1, Avg loss: 0.0508, Accuracy: 377/1628 (23.1572%)
_Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   2, Avg loss: 0.0260, Accuracy: 823/1628 (50.5528%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.2081, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 519/1470 (35.3061%)
_Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 857/1470 (58.2993%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.9501, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   1, Avg loss: 0.0623, Accuracy: 238/1131 (21.0433%)
_Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   2, Avg loss: 0.0316, Accuracy: 432/1131 (38.1963%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.1691, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   1, Avg loss: 0.0660, Accuracy: 178/938 (18.9765%)
_Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   2, Avg loss: 0.0337, Accuracy: 318/938 (33.9019%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.1388, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 393/1904 (20.6408%)
_Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 677/1904 (35.5567%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.7173, Accuracy: 100/10000 (1.0000%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   1, Avg loss: 0.0580, Accuracy: 335/807 (41.5118%)
_Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 414/807 (51.3011%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.8121, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 400/1953 (20.4813%)
_Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 724/1953 (37.0712%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.3374, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   1, Avg loss: 0.0720, Accuracy: 149/603 (24.7098%)
_Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   2, Avg loss: 0.0448, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.8934, Accuracy: 63/10000 (0.6300%)
time spent on training: 340.58128690719604
[rfa agg] training data poison_ratio: 0.25255536626916525  data num: [530, 776, 1628, 1470, 1131, 938, 1904, 807, 1953, 603]
[rfa agg] considering poison per batch poison_fraction: 0.1578471039182283
[rfa agg] init. name: [18, 75, 5, 22, 38, 73, 46, 20, 83, 88], weight: tensor([0.0451, 0.0661, 0.1387, 0.1252, 0.0963, 0.0799, 0.1622, 0.0687, 0.1664,
        0.0514])
[rfa agg] iter:  0, prev_obj_val: 3454.62939453125, obj_val: 1886.9453125, abs dis: 1567.68408203125
[rfa agg] iter: 0, weight: tensor([0.0022, 0.0658, 0.1471, 0.1309, 0.0982, 0.0803, 0.1756, 0.0684, 0.1810,
        0.0504])
[rfa agg] iter:  1, prev_obj_val: 1886.9453125, obj_val: 1874.543701171875, abs dis: 12.401611328125
[rfa agg] iter: 1, weight: tensor([3.3477e-05, 1.2553e-02, 9.8323e-02, 5.4784e-02, 2.5520e-02, 1.7113e-02,
        3.8049e-01, 1.3043e-02, 3.8981e-01, 8.3261e-03])
[rfa agg] iter:  2, prev_obj_val: 1874.543701171875, obj_val: 1873.736328125, abs dis: 0.807373046875
[rfa agg] iter: 2, weight: tensor([3.7751e-05, 1.8390e-02, 4.4653e-01, 1.2885e-01, 4.2305e-02, 2.6061e-02,
        1.6995e-01, 1.9098e-02, 1.3709e-01, 1.1691e-02])
[rfa agg] iter:  3, prev_obj_val: 1873.736328125, obj_val: 1877.06103515625, abs dis: 3.32470703125
[rfa agg] iter: 3, weight: tensor([3.8612e-05, 2.4170e-02, 2.0756e-01, 4.4679e-01, 6.6138e-02, 3.5989e-02,
        9.4979e-02, 2.5082e-02, 8.4639e-02, 1.4612e-02])
[rfa agg] iter:  4, prev_obj_val: 1877.06103515625, obj_val: 1880.7122802734375, abs dis: 3.6512451171875
[rfa agg] iter: 4, weight: tensor([4.9343e-05, 3.8117e-02, 1.4879e-01, 3.8318e-01, 1.2958e-01, 5.9927e-02,
        9.3230e-02, 3.9533e-02, 8.5686e-02, 2.1910e-02])
[rfa agg] iter:  5, prev_obj_val: 1880.7122802734375, obj_val: 1883.2115478515625, abs dis: 2.499267578125
[rfa agg] iter: 5, weight: tensor([5.6222e-05, 5.2688e-02, 1.2814e-01, 2.2910e-01, 2.4329e-01, 8.8391e-02,
        9.0533e-02, 5.4590e-02, 8.4516e-02, 2.8699e-02])
[rfa agg] iter:  6, prev_obj_val: 1883.2115478515625, obj_val: 1886.02197265625, abs dis: 2.8104248046875
[rfa agg] iter: 6, weight: tensor([4.9672e-05, 5.4271e-02, 9.7339e-02, 1.5213e-01, 3.7331e-01, 9.7225e-02,
        7.2799e-02, 5.6172e-02, 6.8532e-02, 2.8168e-02])
[rfa agg] iter:  7, prev_obj_val: 1886.02197265625, obj_val: 1889.8487548828125, abs dis: 3.8267822265625
[rfa agg] iter: 7, weight: tensor([3.6259e-05, 4.7394e-02, 6.2256e-02, 8.9152e-02, 5.4079e-01, 9.3340e-02,
        4.8741e-02, 4.8976e-02, 4.6207e-02, 2.3108e-02])
[rfa agg] iter:  8, prev_obj_val: 1889.8487548828125, obj_val: 1891.897705078125, abs dis: 2.0489501953125
[rfa agg] iter: 8, weight: tensor([4.4566e-05, 7.2200e-02, 6.8053e-02, 9.1478e-02, 3.8926e-01, 1.6411e-01,
        5.5313e-02, 7.4408e-02, 5.2752e-02, 3.2381e-02])
[rfa agg] iter:  9, prev_obj_val: 1891.897705078125, obj_val: 1891.88623046875, abs dis: 0.011474609375
[rfa agg] iter: 9, weight: tensor([4.7702e-05, 8.8235e-02, 6.9124e-02, 9.0730e-02, 2.8384e-01, 2.2839e-01,
        5.7055e-02, 9.0711e-02, 5.4546e-02, 3.7322e-02])
			Update norm = 153.77283875086653 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 768.8999981880188 sec.
Server Epoch:36 choose agents : [19, 2, 97, 73, 5, 51, 21, 63, 11, 90].
_Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 383/1036 (36.9691%)
_Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   2, Avg loss: 0.0245, Accuracy: 679/1036 (65.5405%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.0404, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0627, Accuracy: 231/605 (38.1818%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0383, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.9075, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   1, Avg loss: 0.0519, Accuracy: 368/1213 (30.3380%)
_Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 489/1213 (40.3133%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.8667, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   1, Avg loss: 0.0663, Accuracy: 172/938 (18.3369%)
_Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 337/938 (35.9275%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.9978, Accuracy: 54/10000 (0.5400%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 384/1628 (23.5872%)
_Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   2, Avg loss: 0.0258, Accuracy: 819/1628 (50.3071%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.3719, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0604, Accuracy: 225/1049 (21.4490%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0316, Accuracy: 455/1049 (43.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.7102, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 431/1949 (22.1139%)
_Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   2, Avg loss: 0.0334, Accuracy: 601/1949 (30.8363%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.7362, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   1, Avg loss: 0.0551, Accuracy: 257/888 (28.9414%)
_Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 423/888 (47.6351%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.3986, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0552, Accuracy: 351/712 (49.2978%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0266, Accuracy: 433/712 (60.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.4632, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   1, Avg loss: 0.0569, Accuracy: 322/677 (47.5628%)
_Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 453/677 (66.9129%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.0735, Accuracy: 52/10000 (0.5200%)
time spent on training: 198.87399768829346
[rfa agg] training data poison_ratio: 0.1522206638616176  data num: [1036, 605, 1213, 938, 1628, 1049, 1949, 888, 712, 677]
[rfa agg] considering poison per batch poison_fraction: 0.09513791491351099
[rfa agg] init. name: [19, 2, 97, 73, 5, 51, 21, 63, 11, 90], weight: tensor([0.0969, 0.0566, 0.1134, 0.0877, 0.1522, 0.0981, 0.1822, 0.0830, 0.0666,
        0.0633])
[rfa agg] iter:  0, prev_obj_val: 52.769561767578125, obj_val: 57.45710372924805, abs dis: 4.687541961669922
[rfa agg] iter: 0, weight: tensor([0.2556, 0.0194, 0.1647, 0.0859, 0.0461, 0.2772, 0.0349, 0.0599, 0.0311,
        0.0251])
[rfa agg] iter:  1, prev_obj_val: 57.45710372924805, obj_val: 63.875823974609375, abs dis: 6.418720245361328
[rfa agg] iter: 1, weight: tensor([0.1281, 0.0315, 0.0781, 0.2739, 0.0389, 0.1318, 0.0321, 0.1810, 0.0606,
        0.0440])
[rfa agg] iter:  2, prev_obj_val: 63.875823974609375, obj_val: 75.60231018066406, abs dis: 11.726486206054688
[rfa agg] iter: 2, weight: tensor([0.0840, 0.0490, 0.0632, 0.1643, 0.0378, 0.0852, 0.0323, 0.2851, 0.1232,
        0.0759])
[rfa agg] iter:  3, prev_obj_val: 75.60231018066406, obj_val: 82.82452392578125, abs dis: 7.2222137451171875
[rfa agg] iter: 3, weight: tensor([0.0556, 0.1060, 0.0478, 0.0778, 0.0334, 0.0563, 0.0298, 0.1027, 0.2427,
        0.2479])
[rfa agg] iter:  4, prev_obj_val: 82.82452392578125, obj_val: 82.80313110351562, abs dis: 0.021392822265625
[rfa agg] iter: 4, weight: tensor([0.0496, 0.2169, 0.0445, 0.0643, 0.0329, 0.0504, 0.0298, 0.0778, 0.1385,
        0.2953])
[rfa agg] iter:  5, prev_obj_val: 82.80313110351562, obj_val: 82.80289459228516, abs dis: 0.00023651123046875
[rfa agg] iter: 5, weight: tensor([0.0482, 0.2297, 0.0432, 0.0623, 0.0319, 0.0489, 0.0289, 0.0754, 0.1316,
        0.2998])
			Update norm = 102.53798362527664 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 616.9691667556763 sec.
Server Epoch:37 choose agents : [20, 66, 18, 64, 77, 51, 65, 3, 17, 50].
poison local model 20 index 8 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   1, Avg loss: 0.0510, Accuracy: 361/807 (44.7336%), train_poison_data_count: 519
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   2, Avg loss: 0.0317, Accuracy: 447/807 (55.3903%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   3, Avg loss: 0.0254, Accuracy: 502/807 (62.2057%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   4, Avg loss: 0.0238, Accuracy: 516/807 (63.9405%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   5, Avg loss: 0.0237, Accuracy: 517/807 (64.0644%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   6, Avg loss: 0.0228, Accuracy: 510/807 (63.1970%), train_poison_data_count: 519
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   7, Avg loss: 0.0228, Accuracy: 515/807 (63.8166%), train_poison_data_count: 519
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   8, Avg loss: 0.0219, Accuracy: 519/807 (64.3123%), train_poison_data_count: 519
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   9, Avg loss: 0.0212, Accuracy: 522/807 (64.6840%), train_poison_data_count: 519
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch  10, Avg loss: 0.0214, Accuracy: 522/807 (64.6840%), train_poison_data_count: 519
Global model norm: 112.0545957195643.
Norm before scaling: 112.0419886763998. Distance: 0.7508806780058593
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.8159, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: 0.3762, Accuracy: 9942/9950 (99.9196%)
Scaling by  100
Scaled Norm after poisoning: 133.62404261817932, distance: 75.08806353313588
Total norm for 4 adversaries is: 133.62404261817932. distance: 75.08806353313588
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   1, Avg loss: 0.0627, Accuracy: 255/1402 (18.1883%)
_Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 374/1402 (26.6762%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.3104, Accuracy: 70/10000 (0.7000%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   1, Avg loss: 0.0725, Accuracy: 132/530 (24.9057%)
_Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   2, Avg loss: 0.0389, Accuracy: 275/530 (51.8868%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.0957, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 156/953 (16.3694%)
_Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 300/953 (31.4795%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.4483, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0536, Accuracy: 317/1340 (23.6567%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 521/1340 (38.8806%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.6831, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0608, Accuracy: 218/1049 (20.7817%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0301, Accuracy: 513/1049 (48.9037%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.3477, Accuracy: 81/10000 (0.8100%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   1, Avg loss: 0.0570, Accuracy: 374/1475 (25.3559%)
_Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   2, Avg loss: 0.0317, Accuracy: 643/1475 (43.5932%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.1649, Accuracy: 61/10000 (0.6100%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   1, Avg loss: 0.0744, Accuracy: 117/781 (14.9808%)
_Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   2, Avg loss: 0.0368, Accuracy: 244/781 (31.2420%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.5623, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 380/1574 (24.1423%)
_Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 692/1574 (43.9644%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.9887, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   1, Avg loss: 0.0636, Accuracy: 132/809 (16.3164%)
_Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   2, Avg loss: 0.0274, Accuracy: 350/809 (43.2633%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.1307, Accuracy: 80/10000 (0.8000%)
time spent on training: 322.88629603385925
[rfa agg] training data poison_ratio: 0.3351679104477612  data num: [807, 1402, 530, 953, 1340, 1049, 1475, 781, 1574, 809]
[rfa agg] considering poison per batch poison_fraction: 0.20947994402985073
[rfa agg] init. name: [20, 66, 18, 64, 77, 51, 65, 3, 17, 50], weight: tensor([0.0753, 0.1308, 0.0494, 0.0889, 0.1250, 0.0979, 0.1376, 0.0729, 0.1468,
        0.0755])
[rfa agg] iter:  0, prev_obj_val: 8069.78857421875, obj_val: 4679.05810546875, abs dis: 3390.73046875
[rfa agg] iter: 0, weight: tensor([0.0065, 0.1413, 0.0520, 0.0947, 0.1348, 0.1046, 0.1493, 0.0773, 0.1596,
        0.0800])
[rfa agg] iter:  1, prev_obj_val: 4679.05810546875, obj_val: 4412.7529296875, abs dis: 266.30517578125
[rfa agg] iter: 1, weight: tensor([0.0005, 0.1494, 0.0418, 0.0855, 0.1391, 0.0985, 0.1662, 0.0670, 0.1825,
        0.0694])
[rfa agg] iter:  2, prev_obj_val: 4412.7529296875, obj_val: 4416.6923828125, abs dis: 3.939453125
[rfa agg] iter: 2, weight: tensor([4.0448e-05, 2.0963e-01, 1.5622e-02, 6.1173e-02, 3.1526e-01, 1.0758e-01,
        1.1641e-01, 3.6082e-02, 1.0090e-01, 3.7308e-02])
[rfa agg] iter:  3, prev_obj_val: 4416.6923828125, obj_val: 4420.7119140625, abs dis: 4.01953125
[rfa agg] iter: 3, weight: tensor([4.6847e-05, 1.2964e-01, 2.2103e-02, 1.1536e-01, 1.6335e-01, 2.7600e-01,
        9.1284e-02, 5.8202e-02, 8.3947e-02, 6.0070e-02])
[rfa agg] iter:  4, prev_obj_val: 4420.7119140625, obj_val: 4429.12353515625, abs dis: 8.41162109375
[rfa agg] iter: 4, weight: tensor([3.9841e-05, 8.0846e-02, 2.2531e-02, 1.8099e-01, 9.3535e-02, 3.5876e-01,
        6.2417e-02, 6.9894e-02, 5.9041e-02, 7.1947e-02])
[rfa agg] iter:  5, prev_obj_val: 4429.12353515625, obj_val: 4431.6884765625, abs dis: 2.56494140625
[rfa agg] iter: 5, weight: tensor([3.9048e-05, 5.8388e-02, 2.9958e-02, 3.3487e-01, 6.4058e-02, 1.2733e-01,
        4.8474e-02, 1.4410e-01, 4.6957e-02, 1.4583e-01])
[rfa agg] iter:  6, prev_obj_val: 4431.6884765625, obj_val: 4431.6748046875, abs dis: 0.013671875
[rfa agg] iter: 6, weight: tensor([3.8937e-05, 5.4623e-02, 3.2810e-02, 2.5800e-01, 5.9489e-02, 1.0478e-01,
        4.5964e-02, 1.9918e-01, 4.4710e-02, 2.0041e-01])
			Update norm = 132.34587144108426 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 745.3851344585419 sec.
Server Epoch:38 choose agents : [88, 72, 77, 38, 20, 39, 70, 1, 37, 6].
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0724, Accuracy: 145/603 (24.0464%)
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 273/603 (45.2736%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.0434, Accuracy: 51/10000 (0.5100%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0620, Accuracy: 247/1241 (19.9033%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 431/1241 (34.7301%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.0521, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 346/1340 (25.8209%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0280, Accuracy: 529/1340 (39.4776%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7556, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0626, Accuracy: 241/1131 (21.3086%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0312, Accuracy: 444/1131 (39.2573%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4037, Accuracy: 70/10000 (0.7000%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0574, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 431/807 (53.4077%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.7865, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0543, Accuracy: 313/1013 (30.8983%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0264, Accuracy: 462/1013 (45.6071%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4200, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0565, Accuracy: 345/1418 (24.3300%)
_Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 635/1418 (44.7814%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.5835, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0569, Accuracy: 288/928 (31.0345%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0249, Accuracy: 548/928 (59.0517%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.5851, Accuracy: 67/10000 (0.6700%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0522, Accuracy: 381/1129 (33.7467%)
_Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0256, Accuracy: 720/1129 (63.7733%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.9198, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 407/1956 (20.8078%)
_Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   2, Avg loss: 0.0326, Accuracy: 623/1956 (31.8507%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0273, Accuracy: 109/10000 (1.0900%)
time spent on training: 280.9798512458801
[rfa agg] training data poison_ratio: 0.2746844198512883  data num: [603, 1241, 1340, 1131, 807, 1013, 1418, 928, 1129, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.17167776240705518
[rfa agg] init. name: [88, 72, 77, 38, 20, 39, 70, 1, 37, 6], weight: tensor([0.0521, 0.1073, 0.1159, 0.0978, 0.0698, 0.0876, 0.1226, 0.0802, 0.0976,
        0.1691])
[rfa agg] iter:  0, prev_obj_val: 44.38319396972656, obj_val: 47.730384826660156, abs dis: 3.3471908569335938
[rfa agg] iter: 0, weight: tensor([0.0177, 0.1041, 0.0817, 0.2368, 0.0389, 0.1327, 0.0562, 0.0771, 0.2229,
        0.0320])
[rfa agg] iter:  1, prev_obj_val: 47.730384826660156, obj_val: 55.04354476928711, abs dis: 7.313159942626953
[rfa agg] iter: 1, weight: tensor([0.0215, 0.0801, 0.0677, 0.1565, 0.0519, 0.2647, 0.0503, 0.1222, 0.1537,
        0.0314])
[rfa agg] iter:  2, prev_obj_val: 55.04354476928711, obj_val: 54.97997283935547, abs dis: 0.06357192993164062
[rfa agg] iter: 2, weight: tensor([0.0307, 0.0629, 0.0567, 0.0934, 0.0941, 0.2218, 0.0453, 0.2708, 0.0929,
        0.0314])
[rfa agg] iter:  3, prev_obj_val: 54.97997283935547, obj_val: 58.04453659057617, abs dis: 3.064563751220703
[rfa agg] iter: 3, weight: tensor([0.0291, 0.0594, 0.0536, 0.0877, 0.0900, 0.2040, 0.0428, 0.3167, 0.0871,
        0.0297])
[rfa agg] iter:  4, prev_obj_val: 58.04453659057617, obj_val: 52.244232177734375, abs dis: 5.800304412841797
[rfa agg] iter: 4, weight: tensor([0.0362, 0.0609, 0.0557, 0.0854, 0.1271, 0.1673, 0.0453, 0.3046, 0.0850,
        0.0324])
[rfa agg] iter:  5, prev_obj_val: 52.244232177734375, obj_val: 61.327903747558594, abs dis: 9.083671569824219
[rfa agg] iter: 5, weight: tensor([0.0251, 0.0624, 0.0553, 0.0978, 0.0708, 0.2626, 0.0433, 0.2565, 0.0969,
        0.0291])
[rfa agg] iter:  6, prev_obj_val: 61.327903747558594, obj_val: 58.04874801635742, abs dis: 3.279155731201172
[rfa agg] iter: 6, weight: tensor([0.0465, 0.0641, 0.0594, 0.0863, 0.1875, 0.1512, 0.0491, 0.2341, 0.0860,
        0.0360])
[rfa agg] iter:  7, prev_obj_val: 58.04874801635742, obj_val: 54.98036193847656, abs dis: 3.0683860778808594
[rfa agg] iter: 7, weight: tensor([0.0368, 0.0619, 0.0566, 0.0868, 0.1329, 0.1682, 0.0461, 0.2914, 0.0863,
        0.0329])
[rfa agg] iter:  8, prev_obj_val: 54.98036193847656, obj_val: 58.04432678222656, abs dis: 3.06396484375
[rfa agg] iter: 8, weight: tensor([0.0288, 0.0588, 0.0531, 0.0868, 0.0899, 0.1969, 0.0424, 0.3279, 0.0861,
        0.0294])
[rfa agg] iter:  9, prev_obj_val: 58.04432678222656, obj_val: 52.244808197021484, abs dis: 5.799518585205078
[rfa agg] iter: 9, weight: tensor([0.0361, 0.0607, 0.0556, 0.0852, 0.1267, 0.1664, 0.0452, 0.3071, 0.0847,
        0.0323])
			Update norm = 145.12769834916077 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 700.1407222747803 sec.
Server Epoch:39 choose agents : [24, 58, 63, 88, 9, 51, 54, 64, 13, 27].
poison local model 24 index 9 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   1, Avg loss: 0.0791, Accuracy: 35/312 (11.2179%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   3, Avg loss: 0.0329, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   4, Avg loss: 0.0327, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   5, Avg loss: 0.0313, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   6, Avg loss: 0.0290, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   7, Avg loss: 0.0271, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   8, Avg loss: 0.0256, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   9, Avg loss: 0.0243, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch  10, Avg loss: 0.0248, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Global model norm: 112.0545957195643.
Norm before scaling: 112.05178071989754. Distance: 0.4944892075974164
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.3335, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: 0.5482, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 122.12190934548764, distance: 49.44891865997299
Total norm for 3 adversaries is: 122.12190934548764. distance: 49.44891865997299
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0583, Accuracy: 339/803 (42.2167%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 401/803 (49.9377%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.9664, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 432/888 (48.6486%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2191, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   1, Avg loss: 0.0710, Accuracy: 147/603 (24.3781%)
_Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.9409, Accuracy: 52/10000 (0.5200%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0497, Accuracy: 369/1275 (28.9412%)
_Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 701/1275 (54.9804%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.5189, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 239/1049 (22.7836%)
_Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0304, Accuracy: 507/1049 (48.3317%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.4992, Accuracy: 93/10000 (0.9300%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   1, Avg loss: 0.0552, Accuracy: 344/1130 (30.4425%)
_Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 472/1130 (41.7699%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.5238, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   1, Avg loss: 0.0646, Accuracy: 166/953 (17.4187%)
_Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 307/953 (32.2141%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.6184, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 319/1645 (19.3921%)
_Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 619/1645 (37.6292%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.8714, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0525, Accuracy: 473/1587 (29.8047%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 609/1587 (38.3743%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.4236, Accuracy: 62/10000 (0.6200%)
time spent on training: 303.51536417007446
[rfa agg] training data poison_ratio: 0.2652025378233285  data num: [312, 803, 888, 603, 1275, 1049, 1130, 953, 1645, 1587]
[rfa agg] considering poison per batch poison_fraction: 0.1657515861395803
[rfa agg] init. name: [24, 58, 63, 88, 9, 51, 54, 64, 13, 27], weight: tensor([0.0305, 0.0784, 0.0867, 0.0589, 0.1245, 0.1024, 0.1103, 0.0930, 0.1606,
        0.1549])
[rfa agg] iter:  0, prev_obj_val: 1316.076171875, obj_val: 730.131103515625, abs dis: 585.945068359375
[rfa agg] iter: 0, weight: tensor([0.0009, 0.0744, 0.0834, 0.0539, 0.1293, 0.1022, 0.1116, 0.0906, 0.1812,
        0.1724])
[rfa agg] iter:  1, prev_obj_val: 730.131103515625, obj_val: 732.2265625, abs dis: 2.095458984375
[rfa agg] iter: 1, weight: tensor([3.7952e-05, 3.7535e-02, 4.8941e-02, 1.9418e-02, 3.6099e-01, 1.1737e-01,
        1.8709e-01, 6.3882e-02, 7.7120e-02, 8.7607e-02])
[rfa agg] iter:  2, prev_obj_val: 732.2265625, obj_val: 737.1895751953125, abs dis: 4.9630126953125
[rfa agg] iter: 2, weight: tensor([3.5095e-05, 6.3064e-02, 9.5411e-02, 2.6223e-02, 1.0210e-01, 2.7499e-01,
        1.7936e-01, 1.5686e-01, 4.9091e-02, 5.2858e-02])
[rfa agg] iter:  3, prev_obj_val: 737.1895751953125, obj_val: 739.3257446289062, abs dis: 2.13616943359375
[rfa agg] iter: 3, weight: tensor([3.2115e-05, 9.6346e-02, 1.7905e-01, 3.1099e-02, 6.5501e-02, 1.2688e-01,
        9.3593e-02, 3.2743e-01, 3.8863e-02, 4.1209e-02])
[rfa agg] iter:  4, prev_obj_val: 739.3257446289062, obj_val: 748.3018798828125, abs dis: 8.97613525390625
[rfa agg] iter: 4, weight: tensor([2.9747e-05, 1.1444e-01, 2.4868e-01, 3.2002e-02, 5.5209e-02, 9.4201e-02,
        7.4858e-02, 3.0975e-01, 3.4451e-02, 3.6371e-02])
[rfa agg] iter:  5, prev_obj_val: 748.3018798828125, obj_val: 748.2356567382812, abs dis: 0.06622314453125
[rfa agg] iter: 5, weight: tensor([3.6814e-05, 3.0675e-01, 2.2370e-01, 5.8574e-02, 5.4008e-02, 7.6003e-02,
        6.6207e-02, 1.3750e-01, 3.7769e-02, 3.9451e-02])
[rfa agg] iter:  6, prev_obj_val: 748.2356567382812, obj_val: 748.2303466796875, abs dis: 0.00531005859375
[rfa agg] iter: 6, weight: tensor([3.4195e-05, 3.6188e-01, 2.0407e-01, 5.4531e-02, 5.0154e-02, 7.0668e-02,
        6.1429e-02, 1.2551e-01, 3.5078e-02, 3.6644e-02])
[rfa agg] iter:  7, prev_obj_val: 748.2303466796875, obj_val: 751.8585205078125, abs dis: 3.628173828125
[rfa agg] iter: 7, weight: tensor([3.3258e-05, 3.8252e-01, 1.9572e-01, 5.3015e-02, 4.8764e-02, 6.8706e-02,
        5.9707e-02, 1.2179e-01, 3.4113e-02, 3.5636e-02])
[rfa agg] iter:  8, prev_obj_val: 751.8585205078125, obj_val: 744.9500122070312, abs dis: 6.90850830078125
[rfa agg] iter: 8, weight: tensor([4.0179e-05, 3.5341e-01, 1.7428e-01, 7.6025e-02, 5.5064e-02, 7.4274e-02,
        6.5840e-02, 1.2001e-01, 3.9703e-02, 4.1350e-02])
[rfa agg] iter:  9, prev_obj_val: 744.9500122070312, obj_val: 748.2424926757812, abs dis: 3.29248046875
[rfa agg] iter: 9, weight: tensor([3.2346e-05, 2.7862e-01, 2.6369e-01, 4.4512e-02, 5.0994e-02, 7.5691e-02,
        6.4188e-02, 1.5163e-01, 3.4492e-02, 3.6150e-02])
			Update norm = 123.91171173334465 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 722.4677126407623 sec.
Server Epoch:40 choose agents : [40, 88, 66, 47, 61, 96, 3, 5, 16, 24].
_Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 342/1573 (21.7419%)
_Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 598/1573 (38.0165%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.3606, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   1, Avg loss: 0.0717, Accuracy: 153/603 (25.3731%)
_Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   2, Avg loss: 0.0467, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.0448, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 263/1402 (18.7589%)
_Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 376/1402 (26.8188%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.3524, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1227, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1099, Accuracy: 17/134 (12.6866%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3161, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   2, Avg loss: 0.1167, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3088, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   1, Avg loss: 0.0790, Accuracy: 48/311 (15.4341%)
_Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3596, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   1, Avg loss: 0.0751, Accuracy: 100/781 (12.8041%)
_Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   2, Avg loss: 0.0359, Accuracy: 246/781 (31.4981%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.6597, Accuracy: 54/10000 (0.5400%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   1, Avg loss: 0.0514, Accuracy: 383/1628 (23.5258%)
_Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 817/1628 (50.1843%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.3330, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   1, Avg loss: 0.0603, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   2, Avg loss: 0.0365, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.8263, Accuracy: 64/10000 (0.6400%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 22/312 (7.0513%)
_Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   2, Avg loss: 0.0415, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.4095, Accuracy: 50/10000 (0.5000%)
time spent on training: 229.98805332183838
[rfa agg] training data poison_ratio: 0.372296669762505  data num: [1573, 603, 1402, 134, 85, 311, 781, 1628, 708, 312]
[rfa agg] considering poison per batch poison_fraction: 0.2326854186015656
[rfa agg] init. name: [40, 88, 66, 47, 61, 96, 3, 5, 16, 24], weight: tensor([0.2087, 0.0800, 0.1860, 0.0178, 0.0113, 0.0413, 0.1036, 0.2160, 0.0939,
        0.0414])
[rfa agg] iter:  0, prev_obj_val: 66.77877807617188, obj_val: 67.7531509399414, abs dis: 0.9743728637695312
[rfa agg] iter: 0, weight: tensor([0.1719, 0.0755, 0.2427, 0.0083, 0.0049, 0.0226, 0.1696, 0.1582, 0.1234,
        0.0227])
[rfa agg] iter:  1, prev_obj_val: 67.7531509399414, obj_val: 68.74182891845703, abs dis: 0.988677978515625
[rfa agg] iter: 1, weight: tensor([0.1610, 0.0808, 0.2204, 0.0086, 0.0050, 0.0235, 0.1923, 0.1490, 0.1359,
        0.0236])
[rfa agg] iter:  2, prev_obj_val: 68.74182891845703, obj_val: 69.73595428466797, abs dis: 0.9941253662109375
[rfa agg] iter: 2, weight: tensor([0.1487, 0.0855, 0.1978, 0.0087, 0.0051, 0.0240, 0.2185, 0.1385, 0.1492,
        0.0241])
[rfa agg] iter:  3, prev_obj_val: 69.73595428466797, obj_val: 71.75353240966797, abs dis: 2.017578125
[rfa agg] iter: 3, weight: tensor([0.1350, 0.0893, 0.1751, 0.0086, 0.0050, 0.0240, 0.2497, 0.1264, 0.1627,
        0.0241])
[rfa agg] iter:  4, prev_obj_val: 71.75353240966797, obj_val: 72.77644348144531, abs dis: 1.0229110717773438
[rfa agg] iter: 4, weight: tensor([0.1025, 0.0913, 0.1275, 0.0079, 0.0046, 0.0222, 0.3368, 0.0968, 0.1882,
        0.0223])
[rfa agg] iter:  5, prev_obj_val: 72.77644348144531, obj_val: 73.8464584350586, abs dis: 1.0700149536132812
[rfa agg] iter: 5, weight: tensor([0.0821, 0.0860, 0.1003, 0.0069, 0.0040, 0.0197, 0.4084, 0.0779, 0.1949,
        0.0198])
[rfa agg] iter:  6, prev_obj_val: 73.8464584350586, obj_val: 76.90145111083984, abs dis: 3.05499267578125
[rfa agg] iter: 6, weight: tensor([0.0584, 0.0729, 0.0702, 0.0054, 0.0031, 0.0155, 0.5162, 0.0556, 0.1871,
        0.0155])
[rfa agg] iter:  7, prev_obj_val: 76.90145111083984, obj_val: 76.88169860839844, abs dis: 0.01975250244140625
[rfa agg] iter: 7, weight: tensor([0.0433, 0.0809, 0.0507, 0.0047, 0.0027, 0.0141, 0.4467, 0.0415, 0.3012,
        0.0141])
[rfa agg] iter:  8, prev_obj_val: 76.88169860839844, obj_val: 78.9940185546875, abs dis: 2.1123199462890625
[rfa agg] iter: 8, weight: tensor([0.0432, 0.0809, 0.0505, 0.0047, 0.0027, 0.0140, 0.4192, 0.0414, 0.3293,
        0.0141])
[rfa agg] iter:  9, prev_obj_val: 78.9940185546875, obj_val: 76.90055847167969, abs dis: 2.0934600830078125
[rfa agg] iter: 9, weight: tensor([0.0423, 0.1016, 0.0489, 0.0051, 0.0029, 0.0153, 0.2523, 0.0407, 0.4757,
        0.0154])
			Update norm = 119.14373049231335 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 648.7319855690002 sec.
Server Epoch:41 choose agents : [25, 36, 82, 2, 93, 42, 66, 94, 44, 38].
poison local model 25 index 10 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Avg loss: 0.0572, Accuracy: 281/690 (40.7246%), train_poison_data_count: 440
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Avg loss: 0.0288, Accuracy: 385/690 (55.7971%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   3, Avg loss: 0.0241, Accuracy: 289/690 (41.8841%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   4, Avg loss: 0.0220, Accuracy: 437/690 (63.3333%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   5, Avg loss: 0.0226, Accuracy: 441/690 (63.9130%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   6, Avg loss: 0.0201, Accuracy: 440/690 (63.7681%), train_poison_data_count: 440
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   7, Avg loss: 0.0198, Accuracy: 437/690 (63.3333%), train_poison_data_count: 440
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   8, Avg loss: 0.0192, Accuracy: 435/690 (63.0435%), train_poison_data_count: 440
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   9, Avg loss: 0.0201, Accuracy: 432/690 (62.6087%), train_poison_data_count: 440
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch  10, Avg loss: 0.0193, Accuracy: 438/690 (63.4783%), train_poison_data_count: 440
Global model norm: 112.0545957195643.
Norm before scaling: 112.04497388046909. Distance: 0.7717054605585184
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.9929, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: 0.3558, Accuracy: 9816/9950 (98.6533%)
Scaling by  100
Scaled Norm after poisoning: 135.04150837566573, distance: 77.17054786012116
Total norm for 4 adversaries is: 135.04150837566573. distance: 77.17054786012116
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   1, Avg loss: 0.0885, Accuracy: 70/408 (17.1569%)
_Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   2, Avg loss: 0.0564, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.5163, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   1, Avg loss: 0.0767, Accuracy: 64/500 (12.8000%)
_Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   2, Avg loss: 0.0497, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.6983, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 236/605 (39.0083%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.8351, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 404/1742 (23.1917%)
_Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 704/1742 (40.4133%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.8090, Accuracy: 73/10000 (0.7300%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   1, Avg loss: 0.0536, Accuracy: 360/1372 (26.2391%)
_Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 528/1372 (38.4840%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.8839, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0628, Accuracy: 245/1402 (17.4750%)
_Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 406/1402 (28.9586%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.0115, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 326/1662 (19.6149%)
_Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 603/1662 (36.2816%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.9630, Accuracy: 109/10000 (1.0900%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 370/1750 (21.1429%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 634/1750 (36.2286%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.7301, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0623, Accuracy: 246/1131 (21.7507%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0317, Accuracy: 466/1131 (41.2025%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.5098, Accuracy: 72/10000 (0.7200%)
time spent on training: 325.27167677879333
[rfa agg] training data poison_ratio: 0.37471141893091814  data num: [690, 408, 500, 605, 1742, 1372, 1402, 1662, 1750, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.23419463683182384
[rfa agg] init. name: [25, 36, 82, 2, 93, 42, 66, 94, 44, 38], weight: tensor([0.0613, 0.0362, 0.0444, 0.0537, 0.1547, 0.1218, 0.1245, 0.1476, 0.1554,
        0.1004])
[rfa agg] iter:  0, prev_obj_val: 5636.48388671875, obj_val: 3177.96240234375, abs dis: 2458.521484375
[rfa agg] iter: 0, weight: tensor([0.0042, 0.0367, 0.0452, 0.0550, 0.1669, 0.1291, 0.1319, 0.1583, 0.1676,
        0.1052])
[rfa agg] iter:  1, prev_obj_val: 3177.96240234375, obj_val: 3057.586669921875, abs dis: 120.375732421875
[rfa agg] iter: 1, weight: tensor([0.0002, 0.0206, 0.0260, 0.0334, 0.2100, 0.1186, 0.1212, 0.1770, 0.2107,
        0.0823])
[rfa agg] iter:  2, prev_obj_val: 3057.586669921875, obj_val: 3061.826904296875, abs dis: 4.240234375
[rfa agg] iter: 2, weight: tensor([3.1372e-05, 6.5602e-03, 8.5994e-03, 1.2068e-02, 7.8117e-02, 3.2843e-01,
        3.1194e-01, 1.1439e-01, 7.8405e-02, 6.1462e-02])
[rfa agg] iter:  3, prev_obj_val: 3061.826904296875, obj_val: 3068.6572265625, abs dis: 6.830322265625
[rfa agg] iter: 3, weight: tensor([3.5729e-05, 8.2718e-03, 1.0923e-02, 1.5615e-02, 7.0001e-02, 3.1655e-01,
        3.1338e-01, 9.2589e-02, 7.0271e-02, 1.0236e-01])
[rfa agg] iter:  4, prev_obj_val: 3068.6572265625, obj_val: 3066.301025390625, abs dis: 2.356201171875
[rfa agg] iter: 4, weight: tensor([5.0046e-05, 1.2969e-02, 1.7286e-02, 2.5305e-02, 8.1087e-02, 2.1011e-01,
        2.1382e-01, 1.0063e-01, 8.1410e-02, 2.5734e-01])
[rfa agg] iter:  5, prev_obj_val: 3066.301025390625, obj_val: 3066.296875, abs dis: 0.004150390625
[rfa agg] iter: 5, weight: tensor([4.7354e-05, 1.1805e-02, 1.5682e-02, 2.2762e-02, 8.1476e-02, 2.3927e-01,
        2.4397e-01, 1.0297e-01, 8.1774e-02, 2.0025e-01])
			Update norm = 184.1438169271507 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 742.2513411045074 sec.
Server Epoch:42 choose agents : [55, 57, 12, 67, 31, 76, 26, 6, 64, 97].
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   1, Avg loss: 0.0567, Accuracy: 252/1071 (23.5294%)
_Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 501/1071 (46.7787%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.0831, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   1, Avg loss: 0.0561, Accuracy: 296/1154 (25.6499%)
_Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   2, Avg loss: 0.0256, Accuracy: 475/1154 (41.1612%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.2233, Accuracy: 77/10000 (0.7700%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   1, Avg loss: 0.0884, Accuracy: 20/338 (5.9172%)
_Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   2, Avg loss: 0.0486, Accuracy: 135/338 (39.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.4660, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0781, Accuracy: 53/426 (12.4413%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0423, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.6304, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0834, Accuracy: 46/460 (10.0000%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0392, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.8238, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   1, Avg loss: 0.0867, Accuracy: 35/466 (7.5107%)
_Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   2, Avg loss: 0.0496, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.6938, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 350/1446 (24.2047%)
_Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 512/1446 (35.4080%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.3310, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   1, Avg loss: 0.0555, Accuracy: 393/1956 (20.0920%)
_Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 629/1956 (32.1575%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.9760, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0649, Accuracy: 161/953 (16.8940%)
_Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 304/953 (31.8993%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.4159, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   1, Avg loss: 0.0518, Accuracy: 354/1213 (29.1838%)
_Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 484/1213 (39.9011%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.9375, Accuracy: 73/10000 (0.7300%)
time spent on training: 229.61387848854065
[rfa agg] training data poison_ratio: 0.14858167246651904  data num: [1071, 1154, 338, 426, 460, 466, 1446, 1956, 953, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0928635452915744
[rfa agg] init. name: [55, 57, 12, 67, 31, 76, 26, 6, 64, 97], weight: tensor([0.1129, 0.1217, 0.0356, 0.0449, 0.0485, 0.0491, 0.1525, 0.2063, 0.1005,
        0.1279])
[rfa agg] iter:  0, prev_obj_val: 59.079742431640625, obj_val: 62.7626838684082, abs dis: 3.682941436767578
[rfa agg] iter: 0, weight: tensor([0.3441, 0.1415, 0.0107, 0.0149, 0.0180, 0.0182, 0.0735, 0.0449, 0.1827,
        0.1516])
[rfa agg] iter:  1, prev_obj_val: 62.7626838684082, obj_val: 64.88623809814453, abs dis: 2.123554229736328
[rfa agg] iter: 1, weight: tensor([0.2306, 0.1119, 0.0125, 0.0176, 0.0215, 0.0218, 0.0675, 0.0445, 0.3535,
        0.1185])
[rfa agg] iter:  2, prev_obj_val: 64.88623809814453, obj_val: 67.38883972167969, abs dis: 2.5026016235351562
[rfa agg] iter: 2, weight: tensor([0.1601, 0.0899, 0.0120, 0.0170, 0.0210, 0.0213, 0.0576, 0.0392, 0.4871,
        0.0948])
[rfa agg] iter:  3, prev_obj_val: 67.38883972167969, obj_val: 70.1349105834961, abs dis: 2.7460708618164062
[rfa agg] iter: 3, weight: tensor([0.1443, 0.0892, 0.0141, 0.0201, 0.0251, 0.0254, 0.0603, 0.0423, 0.4852,
        0.0940])
[rfa agg] iter:  4, prev_obj_val: 70.1349105834961, obj_val: 67.39608764648438, abs dis: 2.7388229370117188
[rfa agg] iter: 4, weight: tensor([0.1561, 0.1031, 0.0191, 0.0275, 0.0346, 0.0351, 0.0728, 0.0524, 0.3908,
        0.1085])
[rfa agg] iter:  5, prev_obj_val: 67.39608764648438, obj_val: 70.1317367553711, abs dis: 2.7356491088867188
[rfa agg] iter: 5, weight: tensor([0.1504, 0.0929, 0.0146, 0.0209, 0.0261, 0.0264, 0.0627, 0.0440, 0.4641,
        0.0979])
[rfa agg] iter:  6, prev_obj_val: 70.1317367553711, obj_val: 67.39640808105469, abs dis: 2.7353286743164062
[rfa agg] iter: 6, weight: tensor([0.1567, 0.1034, 0.0191, 0.0276, 0.0347, 0.0352, 0.0730, 0.0526, 0.3887,
        0.1089])
[rfa agg] iter:  7, prev_obj_val: 67.39640808105469, obj_val: 70.13166809082031, abs dis: 2.735260009765625
[rfa agg] iter: 7, weight: tensor([0.1505, 0.0930, 0.0147, 0.0210, 0.0261, 0.0265, 0.0628, 0.0440, 0.4636,
        0.0980])
[rfa agg] iter:  8, prev_obj_val: 70.13166809082031, obj_val: 67.39641571044922, abs dis: 2.7352523803710938
[rfa agg] iter: 8, weight: tensor([0.1567, 0.1034, 0.0191, 0.0276, 0.0347, 0.0352, 0.0730, 0.0526, 0.3887,
        0.1089])
[rfa agg] iter:  9, prev_obj_val: 67.39641571044922, obj_val: 70.13166809082031, abs dis: 2.7352523803710938
[rfa agg] iter: 9, weight: tensor([0.1505, 0.0930, 0.0147, 0.0210, 0.0261, 0.0265, 0.0628, 0.0440, 0.4636,
        0.0980])
			Update norm = 132.21029649766314 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 652.3322021961212 sec.
Server Epoch:43 choose agents : [30, 89, 47, 67, 72, 23, 57, 51, 45, 60].
poison local model 30 index 11 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0696, Accuracy: 162/486 (33.3333%), train_poison_data_count: 318
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0395, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   3, Avg loss: 0.0370, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   4, Avg loss: 0.0331, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   5, Avg loss: 0.0302, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   6, Avg loss: 0.0260, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   7, Avg loss: 0.0244, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   8, Avg loss: 0.0244, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   9, Avg loss: 0.0250, Accuracy: 317/486 (65.2263%), train_poison_data_count: 318
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch  10, Avg loss: 0.0227, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Global model norm: 112.0545957195643.
Norm before scaling: 112.04802437180675. Distance: 0.6306088307314361
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.2730, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: 0.4426, Accuracy: 9912/9950 (99.6181%)
Scaling by  100
Scaled Norm after poisoning: 127.85073159865962, distance: 63.06088753823066
Total norm for 3 adversaries is: 127.85073159865962. distance: 63.06088753823066
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0620, Accuracy: 328/896 (36.6071%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0327, Accuracy: 459/896 (51.2277%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.2575, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   1, Avg loss: 0.1244, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   2, Avg loss: 0.1075, Accuracy: 13/134 (9.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3160, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   1, Avg loss: 0.0784, Accuracy: 49/426 (11.5023%)
_Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   2, Avg loss: 0.0422, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.6306, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   1, Avg loss: 0.0621, Accuracy: 246/1241 (19.8227%)
_Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 383/1241 (30.8622%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.0397, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   1, Avg loss: 0.0612, Accuracy: 323/715 (45.1748%)
_Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   2, Avg loss: 0.0385, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.7759, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   1, Avg loss: 0.0554, Accuracy: 304/1154 (26.3432%)
_Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   2, Avg loss: 0.0269, Accuracy: 460/1154 (39.8614%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.5059, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 222/1049 (21.1630%)
_Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 494/1049 (47.0925%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.4914, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0691, Accuracy: 191/669 (28.5501%)
_Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0412, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.7881, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 557/2227 (25.0112%)
_Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 1000/2227 (44.9035%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.2700, Accuracy: 129/10000 (1.2900%)
time spent on training: 329.60131764411926
[rfa agg] training data poison_ratio: 0.43947982660886964  data num: [486, 896, 134, 426, 1241, 715, 1154, 1049, 669, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.27467489163054354
[rfa agg] init. name: [30, 89, 47, 67, 72, 23, 57, 51, 45, 60], weight: tensor([0.0540, 0.0996, 0.0149, 0.0473, 0.1379, 0.0795, 0.1283, 0.1166, 0.0744,
        0.2475])
[rfa agg] iter:  0, prev_obj_val: 3642.91943359375, obj_val: 2040.8201904296875, abs dis: 1602.0992431640625
[rfa agg] iter: 0, weight: tensor([0.0032, 0.1017, 0.0145, 0.0468, 0.1448, 0.0804, 0.1340, 0.1207, 0.0749,
        0.2791])
[rfa agg] iter:  1, prev_obj_val: 2040.8201904296875, obj_val: 2016.8486328125, abs dis: 23.9715576171875
[rfa agg] iter: 1, weight: tensor([1.2947e-04, 5.5852e-02, 5.0497e-03, 1.8815e-02, 1.1894e-01, 3.9895e-02,
        1.0138e-01, 7.9202e-02, 3.5473e-02, 5.4526e-01])
[rfa agg] iter:  2, prev_obj_val: 2016.8486328125, obj_val: 2001.2840576171875, abs dis: 15.5645751953125
[rfa agg] iter: 2, weight: tensor([1.1593e-04, 8.1112e-02, 5.9131e-03, 2.3201e-02, 2.5673e-01, 5.4450e-02,
        1.9644e-01, 1.3243e-01, 4.7218e-02, 2.0239e-01])
[rfa agg] iter:  3, prev_obj_val: 2001.2840576171875, obj_val: 2004.5560302734375, abs dis: 3.27197265625
[rfa agg] iter: 3, weight: tensor([3.5525e-05, 4.7177e-02, 2.3543e-03, 9.9517e-03, 3.9806e-01, 2.7738e-02,
        3.3375e-01, 1.1593e-01, 2.2971e-02, 4.2038e-02])
[rfa agg] iter:  4, prev_obj_val: 2004.5560302734375, obj_val: 2007.4307861328125, abs dis: 2.874755859375
[rfa agg] iter: 4, weight: tensor([4.7960e-05, 1.3336e-01, 3.8652e-03, 1.7627e-02, 1.3807e-01, 6.1409e-02,
        1.7500e-01, 3.7546e-01, 4.7583e-02, 4.7580e-02])
[rfa agg] iter:  5, prev_obj_val: 2007.4307861328125, obj_val: 2009.0672607421875, abs dis: 1.636474609375
[rfa agg] iter: 5, weight: tensor([5.3239e-05, 2.2935e-01, 4.6279e-03, 2.1869e-02, 1.1886e-01, 8.7181e-02,
        1.4032e-01, 2.8309e-01, 6.4497e-02, 5.0140e-02])
[rfa agg] iter:  6, prev_obj_val: 2009.0672607421875, obj_val: 2010.7779541015625, abs dis: 1.710693359375
[rfa agg] iter: 6, weight: tensor([5.2309e-05, 3.1377e-01, 4.7319e-03, 2.2824e-02, 1.0557e-01, 9.9277e-02,
        1.2144e-01, 2.1307e-01, 7.1220e-02, 4.8042e-02])
[rfa agg] iter:  7, prev_obj_val: 2010.7779541015625, obj_val: 2014.937744140625, abs dis: 4.1597900390625
[rfa agg] iter: 7, weight: tensor([4.6155e-05, 4.2462e-01, 4.3507e-03, 2.1464e-02, 8.4921e-02, 1.0364e-01,
        9.5702e-02, 1.5231e-01, 7.1591e-02, 4.1362e-02])
[rfa agg] iter:  8, prev_obj_val: 2014.937744140625, obj_val: 2017.43212890625, abs dis: 2.494384765625
[rfa agg] iter: 8, weight: tensor([4.3479e-05, 4.4605e-01, 4.4717e-03, 2.3263e-02, 6.7929e-02, 1.4964e-01,
        7.4215e-02, 1.0438e-01, 9.2846e-02, 3.7163e-02])
[rfa agg] iter:  9, prev_obj_val: 2017.43212890625, obj_val: 2020.0, abs dis: 2.56787109375
[rfa agg] iter: 9, weight: tensor([4.8685e-05, 3.2332e-01, 5.2474e-03, 2.8176e-02, 7.0705e-02, 2.2474e-01,
        7.6313e-02, 1.0277e-01, 1.2800e-01, 4.0674e-02])
			Update norm = 119.4332850185094 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 755.8707902431488 sec.
Server Epoch:44 choose agents : [20, 45, 15, 72, 6, 60, 59, 46, 31, 84].
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0575, Accuracy: 344/807 (42.6270%)
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0325, Accuracy: 406/807 (50.3098%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.7190, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   1, Avg loss: 0.0691, Accuracy: 188/669 (28.1016%)
_Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   2, Avg loss: 0.0399, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.7150, Accuracy: 50/10000 (0.5000%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0580, Accuracy: 324/1154 (28.0763%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0316, Accuracy: 381/1154 (33.0156%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.9768, Accuracy: 52/10000 (0.5200%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   1, Avg loss: 0.0619, Accuracy: 247/1241 (19.9033%)
_Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 425/1241 (34.2466%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.2626, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 393/1956 (20.0920%)
_Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 649/1956 (33.1800%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.2950, Accuracy: 86/10000 (0.8600%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 523/2227 (23.4845%)
_Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   2, Avg loss: 0.0287, Accuracy: 983/2227 (44.1401%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.2820, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   1, Avg loss: 0.0535, Accuracy: 310/1089 (28.4665%)
_Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 477/1089 (43.8017%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.5959, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   1, Avg loss: 0.0558, Accuracy: 435/1904 (22.8466%)
_Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   2, Avg loss: 0.0321, Accuracy: 641/1904 (33.6660%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.6830, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0833, Accuracy: 59/460 (12.8261%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0377, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.9088, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   1, Avg loss: 0.0630, Accuracy: 320/1190 (26.8908%)
_Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 453/1190 (38.0672%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.1382, Accuracy: 57/10000 (0.5700%)
time spent on training: 312.4945652484894
[rfa agg] training data poison_ratio: 0.521304245097267  data num: [807, 669, 1154, 1241, 1956, 2227, 1089, 1904, 460, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.3258151531857919
[rfa agg] init. name: [20, 45, 15, 72, 6, 60, 59, 46, 31, 84], weight: tensor([0.0636, 0.0527, 0.0909, 0.0977, 0.1541, 0.1754, 0.0858, 0.1500, 0.0362,
        0.0937])
[rfa agg] iter:  0, prev_obj_val: 68.892822265625, obj_val: 73.06388854980469, abs dis: 4.1710662841796875
[rfa agg] iter: 0, weight: tensor([0.0353, 0.0237, 0.1615, 0.2729, 0.0765, 0.0614, 0.1095, 0.0833, 0.0127,
        0.1632])
[rfa agg] iter:  1, prev_obj_val: 73.06388854980469, obj_val: 77.94281005859375, abs dis: 4.8789215087890625
[rfa agg] iter: 1, weight: tensor([0.0318, 0.0195, 0.2514, 0.1679, 0.0343, 0.0296, 0.1837, 0.0363, 0.0096,
        0.2359])
[rfa agg] iter:  2, prev_obj_val: 77.94281005859375, obj_val: 77.92182159423828, abs dis: 0.02098846435546875
[rfa agg] iter: 2, weight: tensor([0.0506, 0.0294, 0.1950, 0.1374, 0.0417, 0.0366, 0.2583, 0.0438, 0.0139,
        0.1932])
[rfa agg] iter:  3, prev_obj_val: 77.92182159423828, obj_val: 77.92088317871094, abs dis: 0.00093841552734375
[rfa agg] iter: 3, weight: tensor([0.0499, 0.0290, 0.1894, 0.1347, 0.0410, 0.0361, 0.2762, 0.0432, 0.0137,
        0.1869])
[rfa agg] iter:  4, prev_obj_val: 77.92088317871094, obj_val: 75.30021667480469, abs dis: 2.62066650390625
[rfa agg] iter: 4, weight: tensor([0.0496, 0.0289, 0.1882, 0.1340, 0.0409, 0.0359, 0.2806, 0.0430, 0.0136,
        0.1854])
[rfa agg] iter:  5, prev_obj_val: 75.30021667480469, obj_val: 80.76229858398438, abs dis: 5.4620819091796875
[rfa agg] iter: 5, weight: tensor([0.0384, 0.0229, 0.2101, 0.1396, 0.0363, 0.0316, 0.2711, 0.0383, 0.0111,
        0.2007])
[rfa agg] iter:  6, prev_obj_val: 80.76229858398438, obj_val: 83.70849609375, abs dis: 2.946197509765625
[rfa agg] iter: 6, weight: tensor([0.0653, 0.0367, 0.1766, 0.1333, 0.0464, 0.0411, 0.2582, 0.0487, 0.0169,
        0.1768])
[rfa agg] iter:  7, prev_obj_val: 83.70849609375, obj_val: 73.03437805175781, abs dis: 10.674118041992188
[rfa agg] iter: 7, weight: tensor([0.0851, 0.0459, 0.1664, 0.1322, 0.0514, 0.0459, 0.2307, 0.0537, 0.0205,
        0.1682])
[rfa agg] iter:  8, prev_obj_val: 73.03437805175781, obj_val: 75.30638885498047, abs dis: 2.2720108032226562
[rfa agg] iter: 8, weight: tensor([0.0315, 0.0193, 0.2488, 0.1597, 0.0338, 0.0292, 0.2055, 0.0358, 0.0095,
        0.2269])
[rfa agg] iter:  9, prev_obj_val: 75.30638885498047, obj_val: 77.92433166503906, abs dis: 2.6179428100585938
[rfa agg] iter: 9, weight: tensor([0.0389, 0.0233, 0.2191, 0.1425, 0.0368, 0.0321, 0.2477, 0.0388, 0.0112,
        0.2096])
			Update norm = 162.4613776217289 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 741.9905841350555 sec.
Server Epoch:45 choose agents : [33, 77, 72, 6, 23, 47, 93, 87, 53, 86].
poison local model 33 index 12 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   1, Avg loss: 0.0668, Accuracy: 167/515 (32.4272%), train_poison_data_count: 323
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   2, Avg loss: 0.0445, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   3, Avg loss: 0.0400, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   4, Avg loss: 0.0370, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   5, Avg loss: 0.0335, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   6, Avg loss: 0.0313, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   7, Avg loss: 0.0291, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   8, Avg loss: 0.0293, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   9, Avg loss: 0.0289, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch  10, Avg loss: 0.0287, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Global model norm: 112.0545957195643.
Norm before scaling: 112.04675189123066. Distance: 0.5943460484301855
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.6745, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: 0.4901, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 126.00550273202357, distance: 59.43460412898155
Total norm for 2 adversaries is: 126.00550273202357. distance: 59.43460412898155
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 337/1340 (25.1493%)
_Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   2, Avg loss: 0.0277, Accuracy: 548/1340 (40.8955%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.9524, Accuracy: 71/10000 (0.7100%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   1, Avg loss: 0.0623, Accuracy: 243/1241 (19.5810%)
_Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 411/1241 (33.1185%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.1482, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   1, Avg loss: 0.0556, Accuracy: 402/1956 (20.5521%)
_Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   2, Avg loss: 0.0325, Accuracy: 620/1956 (31.6973%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.2727, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   1, Avg loss: 0.0619, Accuracy: 313/715 (43.7762%)
_Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   2, Avg loss: 0.0375, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.7895, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   1, Avg loss: 0.1228, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   2, Avg loss: 0.1096, Accuracy: 15/134 (11.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3169, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0561, Accuracy: 414/1742 (23.7658%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 708/1742 (40.6429%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.7129, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   1, Avg loss: 0.0584, Accuracy: 298/1131 (26.3484%)
_Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   2, Avg loss: 0.0323, Accuracy: 370/1131 (32.7144%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.5750, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 295/813 (36.2854%)
_Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   2, Avg loss: 0.0192, Accuracy: 413/813 (50.7995%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.2612, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0628, Accuracy: 356/1003 (35.4935%)
_Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0338, Accuracy: 425/1003 (42.3729%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.9162, Accuracy: 50/10000 (0.5000%)
time spent on training: 301.77440428733826
[rfa agg] training data poison_ratio: 0.16581680830972614  data num: [515, 1340, 1241, 1956, 715, 134, 1742, 1131, 813, 1003]
[rfa agg] considering poison per batch poison_fraction: 0.10363550519357884
[rfa agg] init. name: [33, 77, 72, 6, 23, 47, 93, 87, 53, 86], weight: tensor([0.0486, 0.1265, 0.1172, 0.1847, 0.0675, 0.0127, 0.1645, 0.1068, 0.0768,
        0.0947])
[rfa agg] iter:  0, prev_obj_val: 3710.9375, obj_val: 2039.6436767578125, abs dis: 1671.2938232421875
[rfa agg] iter: 0, weight: tensor([0.0026, 0.1321, 0.1218, 0.2021, 0.0677, 0.0122, 0.1775, 0.1100, 0.0773,
        0.0967])
[rfa agg] iter:  1, prev_obj_val: 2039.6436767578125, obj_val: 2017.9267578125, abs dis: 21.7169189453125
[rfa agg] iter: 1, weight: tensor([5.1784e-05, 6.0017e-02, 5.0499e-02, 5.4422e-01, 1.6948e-02, 2.1448e-03,
        2.3665e-01, 3.9066e-02, 2.0341e-02, 3.0062e-02])
[rfa agg] iter:  2, prev_obj_val: 2017.9267578125, obj_val: 2011.0526123046875, abs dis: 6.8741455078125
[rfa agg] iter: 2, weight: tensor([6.0511e-05, 1.5308e-01, 1.1663e-01, 1.8705e-01, 2.7941e-02, 3.1294e-03,
        3.4336e-01, 7.8969e-02, 3.4310e-02, 5.5462e-02])
[rfa agg] iter:  3, prev_obj_val: 2011.0526123046875, obj_val: 2015.953857421875, abs dis: 4.9012451171875
[rfa agg] iter: 3, weight: tensor([3.5663e-05, 4.2782e-01, 2.1601e-01, 6.3865e-02, 2.3381e-02, 2.2386e-03,
        8.3205e-02, 9.7832e-02, 2.9705e-02, 5.5910e-02])
[rfa agg] iter:  4, prev_obj_val: 2015.953857421875, obj_val: 2022.138671875, abs dis: 6.184814453125
[rfa agg] iter: 4, weight: tensor([3.3899e-05, 1.3035e-01, 1.6929e-01, 4.4470e-02, 3.4943e-02, 2.6133e-03,
        5.1496e-02, 3.8824e-01, 4.7575e-02, 1.3098e-01])
[rfa agg] iter:  5, prev_obj_val: 2022.138671875, obj_val: 2024.5233154296875, abs dis: 2.3846435546875
[rfa agg] iter: 5, weight: tensor([3.9126e-05, 1.0019e-01, 1.1807e-01, 4.6075e-02, 5.3453e-02, 3.3445e-03,
        5.1745e-02, 2.4267e-01, 7.7723e-02, 3.0670e-01])
[rfa agg] iter:  6, prev_obj_val: 2024.5233154296875, obj_val: 2024.4913330078125, abs dis: 0.031982421875
[rfa agg] iter: 6, weight: tensor([3.6747e-05, 8.4936e-02, 9.7262e-02, 4.1857e-02, 5.6246e-02, 3.2585e-03,
        4.6592e-02, 1.7136e-01, 8.4525e-02, 4.1393e-01])
[rfa agg] iter:  7, prev_obj_val: 2024.4913330078125, obj_val: 2024.486083984375, abs dis: 0.0052490234375
[rfa agg] iter: 7, weight: tensor([3.4118e-05, 7.8744e-02, 8.9987e-02, 3.8860e-02, 5.2133e-02, 3.0250e-03,
        4.3248e-02, 1.5628e-01, 7.8235e-02, 4.5945e-01])
			Update norm = 149.58342545842103 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 733.8833951950073 sec.
Server Epoch:46 choose agents : [43, 30, 40, 2, 69, 83, 22, 84, 91, 15].
_Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 297/946 (31.3953%)
_Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 359/946 (37.9493%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.0213, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0810, Accuracy: 67/486 (13.7860%)
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8540, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 347/1573 (22.0598%)
_Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 570/1573 (36.2365%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.1966, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0621, Accuracy: 235/605 (38.8430%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0399, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.9130, Accuracy: 50/10000 (0.5000%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   1, Avg loss: 0.0568, Accuracy: 282/590 (47.7966%)
_Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   2, Avg loss: 0.0300, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.1015, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   1, Avg loss: 0.0550, Accuracy: 389/1953 (19.9181%)
_Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 748/1953 (38.3001%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.7307, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   1, Avg loss: 0.0460, Accuracy: 497/1470 (33.8095%)
_Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 859/1470 (58.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.2011, Accuracy: 87/10000 (0.8700%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 316/1190 (26.5546%)
_Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 431/1190 (36.2185%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.1889, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   1, Avg loss: 0.0532, Accuracy: 332/1030 (32.2330%)
_Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   2, Avg loss: 0.0259, Accuracy: 637/1030 (61.8447%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.0373, Accuracy: 84/10000 (0.8400%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0570, Accuracy: 317/1154 (27.4697%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0297, Accuracy: 371/1154 (32.1490%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.0414, Accuracy: 57/10000 (0.5700%)
time spent on training: 282.3222496509552
[rfa agg] training data poison_ratio: 0.3109939074292989  data num: [946, 486, 1573, 605, 590, 1953, 1470, 1190, 1030, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.1943711921433118
[rfa agg] init. name: [43, 30, 40, 2, 69, 83, 22, 84, 91, 15], weight: tensor([0.0860, 0.0442, 0.1430, 0.0550, 0.0537, 0.1776, 0.1337, 0.1082, 0.0937,
        0.1049])
[rfa agg] iter:  0, prev_obj_val: 51.89579391479492, obj_val: 55.24763107299805, abs dis: 3.351837158203125
[rfa agg] iter: 0, weight: tensor([0.0590, 0.0112, 0.0658, 0.0170, 0.0166, 0.0412, 0.0905, 0.3018, 0.1186,
        0.2784])
[rfa agg] iter:  1, prev_obj_val: 55.24763107299805, obj_val: 58.85881805419922, abs dis: 3.611186981201172
[rfa agg] iter: 1, weight: tensor([0.1024, 0.0145, 0.0593, 0.0229, 0.0223, 0.0411, 0.0748, 0.1995, 0.2734,
        0.1898])
[rfa agg] iter:  2, prev_obj_val: 58.85881805419922, obj_val: 63.39988327026367, abs dis: 4.541065216064453
[rfa agg] iter: 2, weight: tensor([0.1666, 0.0170, 0.0551, 0.0277, 0.0269, 0.0402, 0.0668, 0.1344, 0.3362,
        0.1290])
[rfa agg] iter:  3, prev_obj_val: 63.39988327026367, obj_val: 68.64215850830078, abs dis: 5.242275238037109
[rfa agg] iter: 3, weight: tensor([0.3379, 0.0210, 0.0537, 0.0355, 0.0346, 0.0410, 0.0633, 0.1070, 0.2029,
        0.1031])
[rfa agg] iter:  4, prev_obj_val: 68.64215850830078, obj_val: 71.62211608886719, abs dis: 2.9799575805664062
[rfa agg] iter: 4, weight: tensor([0.4263, 0.0254, 0.0512, 0.0454, 0.0443, 0.0405, 0.0589, 0.0886, 0.1336,
        0.0858])
[rfa agg] iter:  5, prev_obj_val: 71.62211608886719, obj_val: 68.63190460205078, abs dis: 2.9902114868164062
[rfa agg] iter: 5, weight: tensor([0.3510, 0.0329, 0.0585, 0.0609, 0.0596, 0.0471, 0.0667, 0.0958, 0.1345,
        0.0929])
[rfa agg] iter:  6, prev_obj_val: 68.63190460205078, obj_val: 68.62542724609375, abs dis: 0.00647735595703125
[rfa agg] iter: 6, weight: tensor([0.4371, 0.0250, 0.0503, 0.0447, 0.0436, 0.0398, 0.0579, 0.0870, 0.1302,
        0.0843])
[rfa agg] iter:  7, prev_obj_val: 68.62542724609375, obj_val: 68.6251449584961, abs dis: 0.00028228759765625
[rfa agg] iter: 7, weight: tensor([0.4532, 0.0243, 0.0489, 0.0434, 0.0424, 0.0388, 0.0563, 0.0846, 0.1262,
        0.0820])
			Update norm = 136.65958362615848 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 709.606607913971 sec.
Server Epoch:47 choose agents : [36, 81, 80, 26, 12, 78, 60, 58, 75, 19].
poison local model 36 index 13 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   1, Avg loss: 0.0773, Accuracy: 100/408 (24.5098%), train_poison_data_count: 264
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   2, Avg loss: 0.0406, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   3, Avg loss: 0.0433, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   4, Avg loss: 0.0423, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   5, Avg loss: 0.0385, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   6, Avg loss: 0.0364, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   7, Avg loss: 0.0334, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   8, Avg loss: 0.0301, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   9, Avg loss: 0.0283, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch  10, Avg loss: 0.0300, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Global model norm: 112.0545957195643.
Norm before scaling: 112.04898308050367. Distance: 0.551754166582603
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.0673, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: 0.2739, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 124.27497548279783, distance: 55.17541938487532
Total norm for 5 adversaries is: 124.27497548279783. distance: 55.17541938487532
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   1, Avg loss: 0.0686, Accuracy: 231/774 (29.8450%)
_Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   2, Avg loss: 0.0378, Accuracy: 299/774 (38.6305%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.2927, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0701, Accuracy: 149/682 (21.8475%)
_Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 246/682 (36.0704%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.3986, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0556, Accuracy: 323/1446 (22.3375%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 501/1446 (34.6473%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.1384, Accuracy: 62/10000 (0.6200%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0882, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0495, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.4789, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 38/416 (9.1346%)
_Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   2, Avg loss: 0.0473, Accuracy: 163/416 (39.1827%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.6145, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 616/2227 (27.6605%)
_Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1034/2227 (46.4302%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.5045, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   1, Avg loss: 0.0580, Accuracy: 346/803 (43.0884%)
_Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 393/803 (48.9415%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.9909, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0645, Accuracy: 245/776 (31.5722%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0284, Accuracy: 410/776 (52.8351%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.0411, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0475, Accuracy: 401/1036 (38.7066%)
_Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0248, Accuracy: 665/1036 (64.1892%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.3009, Accuracy: 55/10000 (0.5500%)
time spent on training: 358.9434700012207
[rfa agg] training data poison_ratio: 0.46743768246126205  data num: [408, 774, 682, 1446, 338, 416, 2227, 803, 776, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.2921485515382888
[rfa agg] init. name: [36, 81, 80, 26, 12, 78, 60, 58, 75, 19], weight: tensor([0.0458, 0.0869, 0.0766, 0.1624, 0.0380, 0.0467, 0.2501, 0.0902, 0.0871,
        0.1163])
[rfa agg] iter:  0, prev_obj_val: 2727.791015625, obj_val: 1530.4173583984375, abs dis: 1197.3736572265625
[rfa agg] iter: 0, weight: tensor([0.0023, 0.0866, 0.0754, 0.1721, 0.0363, 0.0449, 0.2869, 0.0899, 0.0868,
        0.1188])
[rfa agg] iter:  1, prev_obj_val: 1530.4173583984375, obj_val: 1514.9857177734375, abs dis: 15.431640625
[rfa agg] iter: 1, weight: tensor([1.1522e-04, 5.6487e-02, 4.3398e-02, 3.8393e-01, 1.6241e-02, 2.1028e-02,
        2.5642e-01, 5.8658e-02, 5.6676e-02, 1.0705e-01])
[rfa agg] iter:  2, prev_obj_val: 1514.9857177734375, obj_val: 1513.5986328125, abs dis: 1.3870849609375
[rfa agg] iter: 2, weight: tensor([8.2110e-05, 7.7550e-02, 5.3378e-02, 3.3219e-01, 1.6998e-02, 2.2545e-02,
        1.0480e-01, 8.0613e-02, 7.7832e-02, 2.3401e-01])
[rfa agg] iter:  3, prev_obj_val: 1513.5986328125, obj_val: 1513.5887451171875, abs dis: 0.0098876953125
[rfa agg] iter: 3, weight: tensor([6.1670e-05, 8.1096e-02, 5.1469e-02, 1.5228e-01, 1.4885e-02, 2.0005e-02,
        6.9476e-02, 8.4453e-02, 8.1482e-02, 4.4480e-01])
[rfa agg] iter:  4, prev_obj_val: 1513.5887451171875, obj_val: 1514.884765625, abs dis: 1.2960205078125
[rfa agg] iter: 4, weight: tensor([4.3916e-05, 8.1338e-02, 4.6470e-02, 8.3463e-02, 1.2099e-02, 1.6476e-02,
        4.5490e-02, 8.4997e-02, 8.1905e-02, 5.4772e-01])
[rfa agg] iter:  5, prev_obj_val: 1514.884765625, obj_val: 1518.0660400390625, abs dis: 3.1812744140625
[rfa agg] iter: 5, weight: tensor([5.5282e-05, 1.3913e-01, 7.1035e-02, 9.1161e-02, 1.6806e-02, 2.3142e-02,
        5.4344e-02, 1.4627e-01, 1.4065e-01, 3.1741e-01])
[rfa agg] iter:  6, prev_obj_val: 1518.0660400390625, obj_val: 1527.4139404296875, abs dis: 9.347900390625
[rfa agg] iter: 6, weight: tensor([3.1798e-05, 2.3360e-01, 7.1975e-02, 4.1571e-02, 1.2208e-02, 1.7351e-02,
        2.8384e-02, 2.6891e-01, 2.4601e-01, 7.9962e-02])
[rfa agg] iter:  7, prev_obj_val: 1527.4139404296875, obj_val: 1524.4212646484375, abs dis: 2.99267578125
[rfa agg] iter: 7, weight: tensor([4.0824e-05, 1.6692e-01, 2.9124e-01, 4.4158e-02, 2.1209e-02, 3.1855e-02,
        3.3367e-02, 1.7742e-01, 1.6817e-01, 6.5611e-02])
[rfa agg] iter:  8, prev_obj_val: 1524.4212646484375, obj_val: 1524.41162109375, abs dis: 0.0096435546875
[rfa agg] iter: 8, weight: tensor([3.6731e-05, 2.0181e-01, 1.9428e-01, 4.1513e-02, 1.7589e-02, 2.5959e-02,
        3.0669e-02, 2.1812e-01, 2.0534e-01, 6.4692e-02])
			Update norm = 115.1239820801904 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.2999, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.3073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 781.5609135627747 sec.
Server Epoch:48 choose agents : [27, 96, 18, 95, 5, 47, 12, 39, 36, 82].
_Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 426/1587 (26.8431%)
_Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 592/1587 (37.3031%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.3043, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 47/311 (15.1125%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3645, Accuracy: 50/10000 (0.5000%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   1, Avg loss: 0.0716, Accuracy: 131/530 (24.7170%)
_Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   2, Avg loss: 0.0398, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.1419, Accuracy: 62/10000 (0.6200%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0542, Accuracy: 317/599 (52.9215%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0288, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.4067, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   1, Avg loss: 0.0514, Accuracy: 395/1628 (24.2629%)
_Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 805/1628 (49.4472%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.8551, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   1, Avg loss: 0.1273, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   2, Avg loss: 0.1049, Accuracy: 12/134 (8.9552%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3151, Accuracy: 48/10000 (0.4800%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   1, Avg loss: 0.0883, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   2, Avg loss: 0.0478, Accuracy: 131/338 (38.7574%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.4794, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 311/1013 (30.7009%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 498/1013 (49.1609%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.8172, Accuracy: 78/10000 (0.7800%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   1, Avg loss: 0.0886, Accuracy: 74/408 (18.1373%)
_Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   2, Avg loss: 0.0559, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.5176, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 67/500 (13.4000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0495, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.7537, Accuracy: 45/10000 (0.4500%)
time spent on training: 245.61494207382202
[rfa agg] training data poison_ratio: 0.4970204313280363  data num: [1587, 311, 530, 599, 1628, 134, 338, 1013, 408, 500]
[rfa agg] considering poison per batch poison_fraction: 0.3106377695800227
[rfa agg] init. name: [27, 96, 18, 95, 5, 47, 12, 39, 36, 82], weight: tensor([0.2252, 0.0441, 0.0752, 0.0850, 0.2310, 0.0190, 0.0480, 0.1437, 0.0579,
        0.0709])
[rfa agg] iter:  0, prev_obj_val: 71.2327651977539, obj_val: 72.80270385742188, abs dis: 1.5699386596679688
[rfa agg] iter: 0, weight: tensor([0.1075, 0.0210, 0.0598, 0.0809, 0.1005, 0.0075, 0.0254, 0.5145, 0.0345,
        0.0484])
[rfa agg] iter:  1, prev_obj_val: 72.80270385742188, obj_val: 74.561279296875, abs dis: 1.758575439453125
[rfa agg] iter: 1, weight: tensor([0.1149, 0.0273, 0.0838, 0.1177, 0.1083, 0.0095, 0.0335, 0.3929, 0.0462,
        0.0660])
[rfa agg] iter:  2, prev_obj_val: 74.561279296875, obj_val: 77.26630401611328, abs dis: 2.7050247192382812
[rfa agg] iter: 2, weight: tensor([0.1118, 0.0325, 0.1109, 0.1655, 0.1061, 0.0111, 0.0405, 0.2804, 0.0572,
        0.0840])
[rfa agg] iter:  3, prev_obj_val: 77.26630401611328, obj_val: 79.13371276855469, abs dis: 1.8674087524414062
[rfa agg] iter: 3, weight: tensor([0.0847, 0.0339, 0.1490, 0.2697, 0.0810, 0.0111, 0.0438, 0.1605, 0.0646,
        0.1016])
[rfa agg] iter:  4, prev_obj_val: 79.13371276855469, obj_val: 85.81847381591797, abs dis: 6.684761047363281
[rfa agg] iter: 4, weight: tensor([0.0527, 0.0266, 0.1613, 0.4275, 0.0506, 0.0083, 0.0356, 0.0877, 0.0552,
        0.0945])
[rfa agg] iter:  5, prev_obj_val: 85.81847381591797, obj_val: 91.03901672363281, abs dis: 5.220542907714844
[rfa agg] iter: 5, weight: tensor([0.0361, 0.0316, 0.2803, 0.1464, 0.0349, 0.0086, 0.0483, 0.0503, 0.0934,
        0.2701])
[rfa agg] iter:  6, prev_obj_val: 91.03901672363281, obj_val: 97.46971893310547, abs dis: 6.430702209472656
[rfa agg] iter: 6, weight: tensor([0.0350, 0.0442, 0.1320, 0.0908, 0.0340, 0.0106, 0.0795, 0.0457, 0.2159,
        0.3123])
[rfa agg] iter:  7, prev_obj_val: 97.46971893310547, obj_val: 101.02362060546875, abs dis: 3.5539016723632812
[rfa agg] iter: 7, weight: tensor([0.0380, 0.0772, 0.0923, 0.0749, 0.0370, 0.0152, 0.1976, 0.0470, 0.2765,
        0.1446])
[rfa agg] iter:  8, prev_obj_val: 101.02362060546875, obj_val: 101.00706481933594, abs dis: 0.0165557861328125
[rfa agg] iter: 8, weight: tensor([0.0373, 0.1058, 0.0778, 0.0661, 0.0364, 0.0175, 0.3309, 0.0450, 0.1736,
        0.1096])
[rfa agg] iter:  9, prev_obj_val: 101.00706481933594, obj_val: 97.4519271850586, abs dis: 3.5551376342773438
[rfa agg] iter: 9, weight: tensor([0.0345, 0.1014, 0.0718, 0.0611, 0.0337, 0.0164, 0.3787, 0.0416, 0.1598,
        0.1010])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3009, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.3179, Accuracy: 0/9950 (0.0000%)
saving model
Done in 684.6625022888184 sec.
Server Epoch:49 choose agents : [37, 21, 63, 60, 36, 6, 17, 29, 9, 90].
poison local model 37 index 14 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   1, Avg loss: 0.0505, Accuracy: 554/1129 (49.0700%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 664/1129 (58.8131%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   3, Avg loss: 0.0222, Accuracy: 720/1129 (63.7733%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   4, Avg loss: 0.0203, Accuracy: 721/1129 (63.8618%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   5, Avg loss: 0.0195, Accuracy: 719/1129 (63.6847%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   6, Avg loss: 0.0196, Accuracy: 718/1129 (63.5961%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   7, Avg loss: 0.0191, Accuracy: 717/1129 (63.5075%), train_poison_data_count: 720
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   8, Avg loss: 0.0193, Accuracy: 716/1129 (63.4190%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   9, Avg loss: 0.0193, Accuracy: 720/1129 (63.7733%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch  10, Avg loss: 0.0193, Accuracy: 722/1129 (63.9504%), train_poison_data_count: 720
Global model norm: 112.05405974210618.
Norm before scaling: 112.03487180338094. Distance: 0.8967477249593088
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1024, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: 0.4007, Accuracy: 9938/9950 (99.8794%)
Scaling by  100
Scaled Norm after poisoning: 141.72977148432858, distance: 89.6747677155829
Total norm for 4 adversaries is: 141.72977148432858. distance: 89.6747677155829
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 389/1949 (19.9590%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 627/1949 (32.1703%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.3282, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   1, Avg loss: 0.0550, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 414/888 (46.6216%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.0771, Accuracy: 51/10000 (0.5100%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 605/2227 (27.1666%)
_Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 1034/2227 (46.4302%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1339, Accuracy: 125/10000 (1.2500%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   1, Avg loss: 0.0864, Accuracy: 76/408 (18.6275%)
_Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   2, Avg loss: 0.0548, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.5467, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 396/1956 (20.2454%)
_Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 641/1956 (32.7710%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.2722, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 411/1574 (26.1118%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 681/1574 (43.2656%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.0933, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 390/1440 (27.0833%)
_Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 637/1440 (44.2361%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.7406, Accuracy: 68/10000 (0.6800%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   1, Avg loss: 0.0503, Accuracy: 359/1275 (28.1569%)
_Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 687/1275 (53.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.5291, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   1, Avg loss: 0.0580, Accuracy: 315/677 (46.5288%)
_Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   2, Avg loss: 0.0237, Accuracy: 444/677 (65.5835%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.3189, Accuracy: 53/10000 (0.5300%)
time spent on training: 409.64403200149536
[rfa agg] training data poison_ratio: 0.3726244176588035  data num: [1129, 1949, 888, 2227, 408, 1956, 1574, 1440, 1275, 677]
[rfa agg] considering poison per batch poison_fraction: 0.2328902610367522
[rfa agg] init. name: [37, 21, 63, 60, 36, 6, 17, 29, 9, 90], weight: tensor([0.0835, 0.1441, 0.0657, 0.1647, 0.0302, 0.1446, 0.1164, 0.1065, 0.0943,
        0.0501])
[rfa agg] iter:  0, prev_obj_val: 12274.1982421875, obj_val: 7241.8291015625, abs dis: 5032.369140625
[rfa agg] iter: 0, weight: tensor([0.0082, 0.1570, 0.0699, 0.1804, 0.0318, 0.1576, 0.1258, 0.1148, 0.1012,
        0.0531])
[rfa agg] iter:  1, prev_obj_val: 7241.8291015625, obj_val: 6763.6796875, abs dis: 478.1494140625
[rfa agg] iter: 1, weight: tensor([0.0007, 0.1676, 0.0607, 0.2038, 0.0257, 0.1682, 0.1241, 0.1105, 0.0940,
        0.0447])
[rfa agg] iter:  2, prev_obj_val: 6763.6796875, obj_val: 6763.69091796875, abs dis: 0.01123046875
[rfa agg] iter: 2, weight: tensor([2.8874e-05, 3.4803e-01, 1.2341e-02, 1.1044e-01, 3.9808e-03, 3.8113e-01,
        6.4635e-02, 4.3683e-02, 2.7762e-02, 7.9655e-03])
[rfa agg] iter:  3, prev_obj_val: 6763.69091796875, obj_val: 6764.96923828125, abs dis: 1.2783203125
[rfa agg] iter: 3, weight: tensor([4.5624e-05, 2.6396e-01, 2.2179e-02, 1.2194e-01, 6.8767e-03, 2.6870e-01,
        1.5516e-01, 9.3151e-02, 5.3965e-02, 1.4026e-02])
[rfa agg] iter:  4, prev_obj_val: 6764.96923828125, obj_val: 6768.87646484375, abs dis: 3.9072265625
[rfa agg] iter: 4, weight: tensor([4.6449e-05, 1.5605e-01, 2.6186e-02, 9.5866e-02, 7.7194e-03, 1.5734e-01,
        3.2320e-01, 1.4589e-01, 7.1584e-02, 1.6123e-02])
[rfa agg] iter:  5, prev_obj_val: 6768.87646484375, obj_val: 6773.9208984375, abs dis: 5.04443359375
[rfa agg] iter: 5, weight: tensor([3.6011e-05, 7.8722e-02, 2.5340e-02, 5.7687e-02, 6.8633e-03, 7.9237e-02,
        3.5633e-01, 2.9217e-01, 8.8710e-02, 1.4900e-02])
[rfa agg] iter:  6, prev_obj_val: 6773.9208984375, obj_val: 6776.033203125, abs dis: 2.1123046875
[rfa agg] iter: 6, weight: tensor([3.7631e-05, 6.7962e-02, 3.1091e-02, 5.3111e-02, 7.8640e-03, 6.8340e-02,
        1.8041e-01, 4.3151e-01, 1.4209e-01, 1.7593e-02])
			Update norm = 200.8872215479372 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3009, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.3179, Accuracy: 0/9950 (0.0000%)
saving model
Done in 843.1123569011688 sec.
Server Epoch:50 choose agents : [74, 58, 95, 2, 46, 62, 37, 81, 28, 99].
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 507/1552 (32.6675%)
_Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 763/1552 (49.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 10.3115, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 349/803 (43.4620%)
_Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   2, Avg loss: 0.0348, Accuracy: 385/803 (47.9452%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.0030, Accuracy: 56/10000 (0.5600%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   1, Avg loss: 0.0515, Accuracy: 329/599 (54.9249%)
_Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.7877, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.0625, Accuracy: 231/605 (38.1818%)
_Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0392, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.8768, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 428/1904 (22.4790%)
_Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 672/1904 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.2012, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   1, Avg loss: 0.0692, Accuracy: 135/568 (23.7676%)
_Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.7993, Accuracy: 51/10000 (0.5100%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   1, Avg loss: 0.0530, Accuracy: 364/1129 (32.2409%)
_Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   2, Avg loss: 0.0249, Accuracy: 720/1129 (63.7733%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.5376, Accuracy: 100/10000 (1.0000%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0680, Accuracy: 235/774 (30.3618%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0358, Accuracy: 295/774 (38.1137%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.2958, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 394/1581 (24.9209%)
_Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   2, Avg loss: 0.0343, Accuracy: 557/1581 (35.2309%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.8461, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   1, Avg loss: 0.0659, Accuracy: 183/773 (23.6740%)
_Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   2, Avg loss: 0.0308, Accuracy: 411/773 (53.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.5545, Accuracy: 50/10000 (0.5000%)
time spent on training: 261.4883677959442
[rfa agg] training data poison_ratio: 0.3940513219284603  data num: [1552, 803, 599, 605, 1904, 568, 1129, 774, 1581, 773]
[rfa agg] considering poison per batch poison_fraction: 0.2462820762052877
[rfa agg] init. name: [74, 58, 95, 2, 46, 62, 37, 81, 28, 99], weight: tensor([0.1509, 0.0781, 0.0582, 0.0588, 0.1851, 0.0552, 0.1097, 0.0752, 0.1537,
        0.0751])
[rfa agg] iter:  0, prev_obj_val: 64.57992553710938, obj_val: 67.10308837890625, abs dis: 2.523162841796875
[rfa agg] iter: 0, weight: tensor([0.0893, 0.0918, 0.0395, 0.0399, 0.0678, 0.0328, 0.3718, 0.0878, 0.0911,
        0.0880])
[rfa agg] iter:  1, prev_obj_val: 67.10308837890625, obj_val: 71.1374282836914, abs dis: 4.034339904785156
[rfa agg] iter: 1, weight: tensor([0.0778, 0.1473, 0.0517, 0.0521, 0.0627, 0.0416, 0.2084, 0.1385, 0.0792,
        0.1409])
[rfa agg] iter:  2, prev_obj_val: 71.1374282836914, obj_val: 83.32980346679688, abs dis: 12.192375183105469
[rfa agg] iter: 2, weight: tensor([0.0359, 0.2603, 0.0449, 0.0452, 0.0308, 0.0334, 0.0658, 0.2125, 0.0366,
        0.2346])
[rfa agg] iter:  3, prev_obj_val: 83.32980346679688, obj_val: 83.27735900878906, abs dis: 0.0524444580078125
[rfa agg] iter: 3, weight: tensor([0.0387, 0.1352, 0.1746, 0.1712, 0.0351, 0.0944, 0.0559, 0.1271, 0.0395,
        0.1285])
[rfa agg] iter:  4, prev_obj_val: 83.27735900878906, obj_val: 86.26685333251953, abs dis: 2.9894943237304688
[rfa agg] iter: 4, weight: tensor([0.0379, 0.1313, 0.1814, 0.1794, 0.0344, 0.0941, 0.0547, 0.1237, 0.0387,
        0.1244])
[rfa agg] iter:  5, prev_obj_val: 86.26685333251953, obj_val: 93.14537811279297, abs dis: 6.8785247802734375
[rfa agg] iter: 5, weight: tensor([0.0320, 0.0932, 0.2466, 0.2377, 0.0292, 0.1067, 0.0447, 0.0885, 0.0326,
        0.0888])
[rfa agg] iter:  6, prev_obj_val: 93.14537811279297, obj_val: 97.1262435913086, abs dis: 3.980865478515625
[rfa agg] iter: 6, weight: tensor([0.0279, 0.0630, 0.2416, 0.2336, 0.0259, 0.2222, 0.0368, 0.0602, 0.0285,
        0.0603])
[rfa agg] iter:  7, prev_obj_val: 97.1262435913086, obj_val: 93.14468383789062, abs dis: 3.9815597534179688
[rfa agg] iter: 7, weight: tensor([0.0288, 0.0589, 0.1611, 0.1607, 0.0269, 0.3845, 0.0371, 0.0563, 0.0293,
        0.0563])
[rfa agg] iter:  8, prev_obj_val: 93.14468383789062, obj_val: 93.13444519042969, abs dis: 0.0102386474609375
[rfa agg] iter: 8, weight: tensor([0.0273, 0.0615, 0.2273, 0.2247, 0.0253, 0.2528, 0.0360, 0.0586, 0.0278,
        0.0587])
[rfa agg] iter:  9, prev_obj_val: 93.13444519042969, obj_val: 93.13429260253906, abs dis: 0.000152587890625
[rfa agg] iter: 9, weight: tensor([0.0273, 0.0615, 0.2359, 0.2320, 0.0253, 0.2370, 0.0360, 0.0587, 0.0278,
        0.0587])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 682.4114696979523 sec.
Server Epoch:51 choose agents : [42, 17, 32, 59, 73, 33, 77, 93, 8, 90].
poison local model 42 index 15 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0479, Accuracy: 709/1372 (51.6764%), train_poison_data_count: 868
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0244, Accuracy: 846/1372 (61.6618%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   3, Avg loss: 0.0230, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   4, Avg loss: 0.0225, Accuracy: 869/1372 (63.3382%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   5, Avg loss: 0.0221, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   6, Avg loss: 0.0223, Accuracy: 866/1372 (63.1195%), train_poison_data_count: 868
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   7, Avg loss: 0.0216, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   8, Avg loss: 0.0218, Accuracy: 867/1372 (63.1924%), train_poison_data_count: 868
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   9, Avg loss: 0.0218, Accuracy: 869/1372 (63.3382%), train_poison_data_count: 868
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch  10, Avg loss: 0.0214, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Global model norm: 112.05317515581609.
Norm before scaling: 112.02921459099407. Distance: 0.9418111539792221
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.2038, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: 0.4095, Accuracy: 9947/9950 (99.9698%)
Scaling by  100
Scaled Norm after poisoning: 144.2245495854468, distance: 94.18111810661678
Total norm for 2 adversaries is: 144.2245495854468. distance: 94.18111810661678
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 394/1574 (25.0318%)
_Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 667/1574 (42.3761%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.4463, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   1, Avg loss: 0.0608, Accuracy: 203/735 (27.6190%)
_Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   2, Avg loss: 0.0220, Accuracy: 365/735 (49.6599%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.0418, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0534, Accuracy: 319/1089 (29.2929%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 463/1089 (42.5161%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.5423, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   1, Avg loss: 0.0657, Accuracy: 167/938 (17.8038%)
_Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   2, Avg loss: 0.0339, Accuracy: 310/938 (33.0490%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.3084, Accuracy: 62/10000 (0.6200%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0782, Accuracy: 68/515 (13.2039%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0537, Accuracy: 120/515 (23.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.7670, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 314/1340 (23.4328%)
_Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 548/1340 (40.8955%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.7668, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0556, Accuracy: 439/1742 (25.2009%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 737/1742 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.2024, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0606, Accuracy: 230/1513 (15.2016%)
_Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0373, Accuracy: 468/1513 (30.9319%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.4556, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   1, Avg loss: 0.0593, Accuracy: 309/677 (45.6425%)
_Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.4541, Accuracy: 50/10000 (0.5000%)
time spent on training: 410.3663420677185
[rfa agg] training data poison_ratio: 0.16415832970856895  data num: [1372, 1574, 735, 1089, 938, 515, 1340, 1742, 1513, 677]
[rfa agg] considering poison per batch poison_fraction: 0.10259895606785559
[rfa agg] init. name: [42, 17, 32, 59, 73, 33, 77, 93, 8, 90], weight: tensor([0.1194, 0.1369, 0.0639, 0.0947, 0.0816, 0.0448, 0.1166, 0.1515, 0.1316,
        0.0589])
[rfa agg] iter:  0, prev_obj_val: 20640.03125, obj_val: 13055.7490234375, abs dis: 7584.2822265625
[rfa agg] iter: 0, weight: tensor([0.0180, 0.1532, 0.0708, 0.1054, 0.0906, 0.0495, 0.1300, 0.1700, 0.1472,
        0.0652])
[rfa agg] iter:  1, prev_obj_val: 13055.7490234375, obj_val: 11890.642578125, abs dis: 1165.1064453125
[rfa agg] iter: 1, weight: tensor([0.0024, 0.1587, 0.0693, 0.1059, 0.0898, 0.0479, 0.1323, 0.1784, 0.1517,
        0.0636])
[rfa agg] iter:  2, prev_obj_val: 11890.642578125, obj_val: 11769.283203125, abs dis: 121.359375
[rfa agg] iter: 2, weight: tensor([0.0003, 0.1807, 0.0502, 0.0915, 0.0707, 0.0322, 0.1273, 0.2373, 0.1651,
        0.0448])
[rfa agg] iter:  3, prev_obj_val: 11769.283203125, obj_val: 11772.0712890625, abs dis: 2.7880859375
[rfa agg] iter: 3, weight: tensor([3.7879e-05, 2.1423e-01, 2.0204e-02, 6.4515e-02, 3.5384e-02, 1.1130e-02,
        1.8641e-01, 1.0401e-01, 3.4700e-01, 1.7069e-02])
[rfa agg] iter:  4, prev_obj_val: 11772.0712890625, obj_val: 11776.0458984375, abs dis: 3.974609375
[rfa agg] iter: 4, weight: tensor([3.9633e-05, 1.0848e-01, 2.7308e-02, 1.2585e-01, 5.3516e-02, 1.4160e-02,
        4.4048e-01, 7.2967e-02, 1.3466e-01, 2.2532e-02])
[rfa agg] iter:  5, prev_obj_val: 11776.0458984375, obj_val: 11779.16015625, abs dis: 3.1142578125
[rfa agg] iter: 5, weight: tensor([4.7639e-05, 9.8386e-02, 3.9785e-02, 2.8881e-01, 8.7577e-02, 1.9555e-02,
        2.4684e-01, 7.3261e-02, 1.1364e-01, 3.2097e-02])
[rfa agg] iter:  6, prev_obj_val: 11779.16015625, obj_val: 11783.1845703125, abs dis: 4.0244140625
[rfa agg] iter: 6, weight: tensor([4.2018e-05, 7.4737e-02, 4.0862e-02, 4.4299e-01, 1.0172e-01, 1.9155e-02,
        1.4603e-01, 5.8257e-02, 8.3881e-02, 3.2317e-02])
[rfa agg] iter:  7, prev_obj_val: 11783.1845703125, obj_val: 11783.1689453125, abs dis: 0.015625
[rfa agg] iter: 7, weight: tensor([4.8742e-05, 7.6002e-02, 5.6571e-02, 3.5729e-01, 1.6875e-01, 2.4955e-02,
        1.2781e-01, 6.1474e-02, 8.3525e-02, 4.3571e-02])
			Update norm = 156.3919105564607 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Done in 833.5123138427734 sec.
Server Epoch:52 choose agents : [13, 59, 3, 73, 63, 7, 86, 32, 51, 89].
_Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0589, Accuracy: 299/1645 (18.1763%)
_Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 626/1645 (38.0547%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.4060, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 286/1089 (26.2626%)
_Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   2, Avg loss: 0.0288, Accuracy: 443/1089 (40.6795%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.0848, Accuracy: 80/10000 (0.8000%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   1, Avg loss: 0.0752, Accuracy: 105/781 (13.4443%)
_Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 225/781 (28.8092%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.7254, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   1, Avg loss: 0.0663, Accuracy: 166/938 (17.6972%)
_Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   2, Avg loss: 0.0341, Accuracy: 301/938 (32.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.5861, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 257/888 (28.9414%)
_Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 420/888 (47.2973%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.6010, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 357/891 (40.0673%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 430/891 (48.2604%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.5418, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   1, Avg loss: 0.0629, Accuracy: 354/1003 (35.2941%)
_Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   2, Avg loss: 0.0347, Accuracy: 386/1003 (38.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.6095, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0612, Accuracy: 205/735 (27.8912%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 349/735 (47.4830%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.1166, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   1, Avg loss: 0.0601, Accuracy: 236/1049 (22.4976%)
_Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 503/1049 (47.9504%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.5353, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0600, Accuracy: 341/896 (38.0580%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0339, Accuracy: 437/896 (48.7723%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.4395, Accuracy: 51/10000 (0.5100%)
time spent on training: 239.28941941261292
[rfa agg] training data poison_ratio: 0.07876954109934443  data num: [1645, 1089, 781, 938, 888, 891, 1003, 735, 1049, 896]
[rfa agg] considering poison per batch poison_fraction: 0.04923096318709027
[rfa agg] init. name: [13, 59, 3, 73, 63, 7, 86, 32, 51, 89], weight: tensor([0.1659, 0.1098, 0.0788, 0.0946, 0.0896, 0.0899, 0.1012, 0.0741, 0.1058,
        0.0904])
[rfa agg] iter:  0, prev_obj_val: 32.25273513793945, obj_val: 40.717613220214844, abs dis: 8.46487808227539
[rfa agg] iter: 0, weight: tensor([0.0222, 0.0428, 0.0960, 0.1216, 0.1969, 0.1515, 0.0742, 0.0568, 0.0548,
        0.1830])
[rfa agg] iter:  1, prev_obj_val: 40.717613220214844, obj_val: 48.53818130493164, abs dis: 7.820568084716797
[rfa agg] iter: 1, weight: tensor([0.0271, 0.0432, 0.1854, 0.0800, 0.1198, 0.1137, 0.0617, 0.1979, 0.0509,
        0.1204])
[rfa agg] iter:  2, prev_obj_val: 48.53818130493164, obj_val: 52.828453063964844, abs dis: 4.290271759033203
[rfa agg] iter: 2, weight: tensor([0.0332, 0.0485, 0.1377, 0.0768, 0.0999, 0.0987, 0.0641, 0.2849, 0.0552,
        0.1009])
[rfa agg] iter:  3, prev_obj_val: 52.828453063964844, obj_val: 44.422908782958984, abs dis: 8.40554428100586
[rfa agg] iter: 3, weight: tensor([0.0399, 0.0559, 0.1326, 0.0838, 0.1045, 0.1037, 0.0718, 0.2393, 0.0630,
        0.1055])
[rfa agg] iter:  4, prev_obj_val: 44.422908782958984, obj_val: 52.83192443847656, abs dis: 8.409015655517578
[rfa agg] iter: 4, weight: tensor([0.0273, 0.0416, 0.1438, 0.0707, 0.0969, 0.0949, 0.0570, 0.3217, 0.0482,
        0.0979])
[rfa agg] iter:  5, prev_obj_val: 52.83192443847656, obj_val: 44.422630310058594, abs dis: 8.409294128417969
[rfa agg] iter: 5, weight: tensor([0.0398, 0.0558, 0.1324, 0.0836, 0.1042, 0.1035, 0.0716, 0.2410, 0.0628,
        0.1053])
[rfa agg] iter:  6, prev_obj_val: 44.422630310058594, obj_val: 52.83196258544922, abs dis: 8.409332275390625
[rfa agg] iter: 6, weight: tensor([0.0273, 0.0416, 0.1437, 0.0706, 0.0968, 0.0949, 0.0569, 0.3222, 0.0482,
        0.0978])
[rfa agg] iter:  7, prev_obj_val: 52.83196258544922, obj_val: 44.42263412475586, abs dis: 8.40932846069336
[rfa agg] iter: 7, weight: tensor([0.0398, 0.0558, 0.1324, 0.0836, 0.1042, 0.1035, 0.0716, 0.2410, 0.0628,
        0.1053])
[rfa agg] iter:  8, prev_obj_val: 44.42263412475586, obj_val: 52.83196258544922, abs dis: 8.40932846069336
[rfa agg] iter: 8, weight: tensor([0.0273, 0.0416, 0.1437, 0.0706, 0.0968, 0.0949, 0.0569, 0.3222, 0.0482,
        0.0978])
[rfa agg] iter:  9, prev_obj_val: 52.83196258544922, obj_val: 44.42263412475586, abs dis: 8.40932846069336
[rfa agg] iter: 9, weight: tensor([0.0398, 0.0558, 0.1324, 0.0836, 0.1042, 0.1035, 0.0716, 0.2410, 0.0628,
        0.1053])
			Update norm = 113.01280693465675 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Done in 657.4912135601044 sec.
Server Epoch:53 choose agents : [44, 63, 19, 5, 11, 69, 60, 51, 37, 90].
poison local model 44 index 16 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Avg loss: 0.0489, Accuracy: 914/1750 (52.2286%), train_poison_data_count: 1102
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Avg loss: 0.0269, Accuracy: 1095/1750 (62.5714%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   3, Avg loss: 0.0246, Accuracy: 1102/1750 (62.9714%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   4, Avg loss: 0.0242, Accuracy: 1102/1750 (62.9714%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   5, Avg loss: 0.0234, Accuracy: 1104/1750 (63.0857%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   6, Avg loss: 0.0232, Accuracy: 1105/1750 (63.1429%), train_poison_data_count: 1102
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   7, Avg loss: 0.0223, Accuracy: 1104/1750 (63.0857%), train_poison_data_count: 1102
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   8, Avg loss: 0.0225, Accuracy: 1108/1750 (63.3143%), train_poison_data_count: 1102
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   9, Avg loss: 0.0221, Accuracy: 1110/1750 (63.4286%), train_poison_data_count: 1102
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch  10, Avg loss: 0.0220, Accuracy: 1110/1750 (63.4286%), train_poison_data_count: 1102
Global model norm: 112.05317515581609.
Norm before scaling: 112.02081977248693. Distance: 1.07579019912621
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.4105, Accuracy: 55/10000 (0.5500%)
_Test Local_ResNet_18 poisoned: True, epoch: 53, Avg loss: 0.4796, Accuracy: 9948/9950 (99.9799%)
Scaling by  100
Scaled Norm after poisoning: 152.60617461705147, distance: 107.57902255435305
Total norm for 5 adversaries is: 152.60617461705147. distance: 107.57902255435305
_Test Local_ResNet_18 poisoned: True, epoch: 53, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 259/888 (29.1667%)
_Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 407/888 (45.8333%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.1073, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0474, Accuracy: 391/1036 (37.7413%)
_Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0258, Accuracy: 621/1036 (59.9421%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.9953, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 374/1628 (22.9730%)
_Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 825/1628 (50.6757%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3855, Accuracy: 140/10000 (1.4000%)
_Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   1, Avg loss: 0.0529, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 422/712 (59.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.9505, Accuracy: 48/10000 (0.4800%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0555, Accuracy: 285/590 (48.3051%)
_Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3542, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 557/2227 (25.0112%)
_Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1030/2227 (46.2506%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.4775, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   1, Avg loss: 0.0610, Accuracy: 221/1049 (21.0677%)
_Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   2, Avg loss: 0.0311, Accuracy: 454/1049 (43.2793%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.6375, Accuracy: 61/10000 (0.6100%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 405/1129 (35.8725%)
_Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   2, Avg loss: 0.0247, Accuracy: 743/1129 (65.8105%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.4845, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   1, Avg loss: 0.0585, Accuracy: 306/677 (45.1994%)
_Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 447/677 (66.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.5355, Accuracy: 54/10000 (0.5400%)
time spent on training: 445.85597681999207
[rfa agg] training data poison_ratio: 0.626732842717782  data num: [1750, 888, 1036, 1628, 712, 590, 2227, 1049, 1129, 677]
[rfa agg] considering poison per batch poison_fraction: 0.3917080266986137
[rfa agg] init. name: [44, 63, 19, 5, 11, 69, 60, 51, 37, 90], weight: tensor([0.1498, 0.0760, 0.0887, 0.1393, 0.0609, 0.0505, 0.1906, 0.0898, 0.0966,
        0.0579])
[rfa agg] iter:  0, prev_obj_val: 31847.904296875, obj_val: 21351.501953125, abs dis: 10496.40234375
[rfa agg] iter: 0, weight: tensor([0.0301, 0.0864, 0.1009, 0.1593, 0.0692, 0.0573, 0.2188, 0.1022, 0.1100,
        0.0658])
[rfa agg] iter:  1, prev_obj_val: 21351.501953125, obj_val: 19195.22265625, abs dis: 2156.279296875
[rfa agg] iter: 1, weight: tensor([0.0054, 0.0874, 0.1026, 0.1648, 0.0697, 0.0575, 0.2304, 0.1039, 0.1121,
        0.0661])
[rfa agg] iter:  2, prev_obj_val: 19195.22265625, obj_val: 18812.486328125, abs dis: 382.736328125
[rfa agg] iter: 2, weight: tensor([0.0009, 0.0802, 0.0971, 0.1725, 0.0627, 0.0508, 0.2713, 0.0983, 0.1072,
        0.0589])
[rfa agg] iter:  3, prev_obj_val: 18812.486328125, obj_val: 18797.25, abs dis: 15.236328125
[rfa agg] iter: 3, weight: tensor([8.8270e-05, 3.3787e-02, 4.7009e-02, 1.7412e-01, 2.4457e-02, 1.8463e-02,
        5.7758e-01, 4.7573e-02, 5.4757e-02, 2.2169e-02])
[rfa agg] iter:  4, prev_obj_val: 18797.25, obj_val: 18792.46875, abs dis: 4.78125
[rfa agg] iter: 4, weight: tensor([6.9491e-05, 3.7799e-02, 5.7094e-02, 5.5516e-01, 2.6291e-02, 1.9229e-02,
        1.5409e-01, 5.7806e-02, 6.9029e-02, 2.3435e-02])
[rfa agg] iter:  5, prev_obj_val: 18792.46875, obj_val: 18791.654296875, abs dis: 0.814453125
[rfa agg] iter: 5, weight: tensor([8.1100e-05, 7.1338e-02, 1.3138e-01, 2.6099e-01, 4.5950e-02, 3.1749e-02,
        1.1045e-01, 1.3157e-01, 1.7679e-01, 3.9701e-02])
[rfa agg] iter:  6, prev_obj_val: 18791.654296875, obj_val: 18795.408203125, abs dis: 3.75390625
[rfa agg] iter: 6, weight: tensor([4.8181e-05, 6.7343e-02, 1.8228e-01, 8.8797e-02, 3.8948e-02, 2.5129e-02,
        5.3443e-02, 1.7789e-01, 3.3373e-01, 3.2382e-02])
[rfa agg] iter:  7, prev_obj_val: 18795.408203125, obj_val: 18801.75, abs dis: 6.341796875
[rfa agg] iter: 7, weight: tensor([3.4147e-05, 9.1014e-02, 2.8769e-01, 4.6449e-02, 4.2575e-02, 2.4552e-02,
        3.2780e-02, 2.5376e-01, 1.8801e-01, 3.3140e-02])
[rfa agg] iter:  8, prev_obj_val: 18801.75, obj_val: 18806.494140625, abs dis: 4.744140625
[rfa agg] iter: 8, weight: tensor([4.5404e-05, 2.4060e-01, 1.7540e-01, 5.3412e-02, 8.3512e-02, 4.2212e-02,
        4.0337e-02, 1.7274e-01, 1.3184e-01, 5.9907e-02])
[rfa agg] iter:  9, prev_obj_val: 18806.494140625, obj_val: 18806.4375, abs dis: 0.056640625
[rfa agg] iter: 9, weight: tensor([3.9910e-05, 3.9999e-01, 1.0589e-01, 4.3089e-02, 1.0761e-01, 4.6185e-02,
        3.3782e-02, 1.0606e-01, 8.7987e-02, 6.9370e-02])
			Update norm = 130.24571130175457 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Done in 878.0789692401886 sec.
Server Epoch:54 choose agents : [87, 90, 28, 63, 1, 47, 46, 66, 40, 91].
_Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   1, Avg loss: 0.0589, Accuracy: 296/1131 (26.1715%)
_Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   2, Avg loss: 0.0324, Accuracy: 374/1131 (33.0681%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.6622, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   1, Avg loss: 0.0572, Accuracy: 313/677 (46.2334%)
_Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.2175, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 409/1581 (25.8697%)
_Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 616/1581 (38.9627%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.7221, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   1, Avg loss: 0.0548, Accuracy: 257/888 (28.9414%)
_Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   2, Avg loss: 0.0261, Accuracy: 406/888 (45.7207%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.6652, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0573, Accuracy: 276/928 (29.7414%)
_Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 564/928 (60.7759%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.9990, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1259, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1049, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3216, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0552, Accuracy: 414/1904 (21.7437%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 687/1904 (36.0819%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.7743, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 262/1402 (18.6876%)
_Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 377/1402 (26.8902%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.3687, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   1, Avg loss: 0.0544, Accuracy: 355/1573 (22.5683%)
_Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 571/1573 (36.3001%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.5970, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   1, Avg loss: 0.0540, Accuracy: 327/1030 (31.7476%)
_Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   2, Avg loss: 0.0257, Accuracy: 632/1030 (61.3592%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.2508, Accuracy: 103/10000 (1.0300%)
time spent on training: 233.02323269844055
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 677, 1581, 888, 928, 134, 1904, 1402, 1573, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [87, 90, 28, 63, 1, 47, 46, 66, 40, 91], weight: tensor([0.1006, 0.0602, 0.1406, 0.0789, 0.0825, 0.0119, 0.1693, 0.1246, 0.1398,
        0.0916])
[rfa agg] iter:  0, prev_obj_val: 50.38712692260742, obj_val: 52.91560745239258, abs dis: 2.5284805297851562
[rfa agg] iter: 0, weight: tensor([0.2404, 0.0288, 0.1025, 0.0580, 0.0735, 0.0029, 0.0654, 0.1876, 0.1021,
        0.1387])
[rfa agg] iter:  1, prev_obj_val: 52.91560745239258, obj_val: 60.40164566040039, abs dis: 7.4860382080078125
[rfa agg] iter: 1, weight: tensor([0.4102, 0.0245, 0.0570, 0.0556, 0.0760, 0.0023, 0.0403, 0.0869, 0.0568,
        0.1903])
[rfa agg] iter:  2, prev_obj_val: 60.40164566040039, obj_val: 65.33113861083984, abs dis: 4.929492950439453
[rfa agg] iter: 2, weight: tensor([0.1663, 0.0409, 0.0533, 0.1257, 0.2155, 0.0031, 0.0414, 0.0702, 0.0530,
        0.2309])
[rfa agg] iter:  3, prev_obj_val: 65.33113861083984, obj_val: 65.27752685546875, abs dis: 0.05361175537109375
[rfa agg] iter: 3, weight: tensor([0.0984, 0.0450, 0.0424, 0.1931, 0.3598, 0.0030, 0.0342, 0.0534, 0.0422,
        0.1284])
[rfa agg] iter:  4, prev_obj_val: 65.27752685546875, obj_val: 71.46605682373047, abs dis: 6.188529968261719
[rfa agg] iter: 4, weight: tensor([0.0901, 0.0414, 0.0390, 0.1815, 0.4103, 0.0027, 0.0314, 0.0491, 0.0388,
        0.1156])
[rfa agg] iter:  5, prev_obj_val: 71.46605682373047, obj_val: 62.749996185302734, abs dis: 8.716060638427734
[rfa agg] iter: 5, weight: tensor([0.0793, 0.0631, 0.0410, 0.3582, 0.2365, 0.0034, 0.0341, 0.0498, 0.0408,
        0.0938])
[rfa agg] iter:  6, prev_obj_val: 62.749996185302734, obj_val: 65.28843688964844, abs dis: 2.538440704345703
[rfa agg] iter: 6, weight: tensor([0.1229, 0.0427, 0.0474, 0.1600, 0.3137, 0.0030, 0.0375, 0.0609, 0.0472,
        0.1646])
[rfa agg] iter:  7, prev_obj_val: 65.28843688964844, obj_val: 68.21282196044922, abs dis: 2.9243850708007812
[rfa agg] iter: 7, weight: tensor([0.0929, 0.0427, 0.0402, 0.1851, 0.3935, 0.0028, 0.0323, 0.0505, 0.0400,
        0.1200])
[rfa agg] iter:  8, prev_obj_val: 68.21282196044922, obj_val: 71.42363739013672, abs dis: 3.2108154296875
[rfa agg] iter: 8, weight: tensor([0.0825, 0.0499, 0.0394, 0.2702, 0.3340, 0.0030, 0.0322, 0.0486, 0.0392,
        0.1011])
[rfa agg] iter:  9, prev_obj_val: 71.42363739013672, obj_val: 74.92879486083984, abs dis: 3.505157470703125
[rfa agg] iter: 9, weight: tensor([0.0760, 0.0606, 0.0393, 0.3919, 0.2196, 0.0033, 0.0326, 0.0477, 0.0391,
        0.0898])
			Update norm = 125.9299392891738 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Done in 661.6666283607483 sec.
Server Epoch:55 choose agents : [48, 41, 73, 59, 13, 26, 32, 57, 99, 55].
poison local model 48 index 17 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   1, Avg loss: 0.0624, Accuracy: 235/631 (37.2425%), train_poison_data_count: 400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   3, Avg loss: 0.0306, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   4, Avg loss: 0.0274, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   5, Avg loss: 0.0266, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   6, Avg loss: 0.0267, Accuracy: 399/631 (63.2330%), train_poison_data_count: 400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   7, Avg loss: 0.0260, Accuracy: 399/631 (63.2330%), train_poison_data_count: 400
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   8, Avg loss: 0.0262, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   9, Avg loss: 0.0246, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch  10, Avg loss: 0.0250, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Global model norm: 112.05317515581609.
Norm before scaling: 112.04426353985062. Distance: 0.6538537645867958
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.0788, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 55, Avg loss: 0.4269, Accuracy: 9942/9950 (99.9196%)
Scaling by  100
Scaled Norm after poisoning: 128.79751853684914, distance: 65.38537725358592
Total norm for 2 adversaries is: 128.79751853684914. distance: 65.38537725358592
_Test Local_ResNet_18 poisoned: True, epoch: 55, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   1, Avg loss: 0.0599, Accuracy: 327/719 (45.4798%)
_Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   2, Avg loss: 0.0308, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.3496, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0659, Accuracy: 168/938 (17.9104%)
_Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 322/938 (34.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.5912, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 297/1089 (27.2727%)
_Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   2, Avg loss: 0.0277, Accuracy: 449/1089 (41.2305%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.5613, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 324/1645 (19.6960%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 640/1645 (38.9058%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1023, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 336/1446 (23.2365%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 482/1446 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.3653, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   1, Avg loss: 0.0605, Accuracy: 200/735 (27.2109%)
_Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 347/735 (47.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7444, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   1, Avg loss: 0.0560, Accuracy: 294/1154 (25.4766%)
_Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   2, Avg loss: 0.0256, Accuracy: 482/1154 (41.7678%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.5140, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0686, Accuracy: 177/773 (22.8978%)
_Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0294, Accuracy: 406/773 (52.5226%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.9541, Accuracy: 65/10000 (0.6500%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 253/1071 (23.6228%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 483/1071 (45.0980%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1251, Accuracy: 78/10000 (0.7800%)
time spent on training: 368.8361613750458
[rfa agg] training data poison_ratio: 0.16684638760905793  data num: [631, 719, 938, 1089, 1645, 1446, 735, 1154, 773, 1071]
[rfa agg] considering poison per batch poison_fraction: 0.1042789922556612
[rfa agg] init. name: [48, 41, 73, 59, 13, 26, 32, 57, 99, 55], weight: tensor([0.0619, 0.0705, 0.0920, 0.1068, 0.1613, 0.1418, 0.0721, 0.1131, 0.0758,
        0.1050])
[rfa agg] iter:  0, prev_obj_val: 5165.33984375, obj_val: 2915.73583984375, abs dis: 2249.60400390625
[rfa agg] iter: 0, weight: tensor([0.0043, 0.0732, 0.0965, 0.1131, 0.1754, 0.1526, 0.0749, 0.1202, 0.0790,
        0.1109])
[rfa agg] iter:  1, prev_obj_val: 2915.73583984375, obj_val: 2802.124755859375, abs dis: 113.611083984375
[rfa agg] iter: 1, weight: tensor([2.3494e-04, 5.2087e-02, 7.7019e-02, 1.0302e-01, 2.6150e-01, 1.8318e-01,
        5.3266e-02, 1.1498e-01, 5.8318e-02, 9.6399e-02])
[rfa agg] iter:  2, prev_obj_val: 2802.124755859375, obj_val: 2807.6015625, abs dis: 5.476806640625
[rfa agg] iter: 2, weight: tensor([3.5461e-05, 2.8585e-02, 6.4542e-02, 2.2102e-01, 6.5536e-02, 9.8807e-02,
        2.9304e-02, 3.1977e-01, 3.5889e-02, 1.3651e-01])
[rfa agg] iter:  3, prev_obj_val: 2807.6015625, obj_val: 2811.577392578125, abs dis: 3.975830078125
[rfa agg] iter: 3, weight: tensor([3.7486e-05, 5.8906e-02, 2.8905e-01, 1.2250e-01, 4.6300e-02, 5.6723e-02,
        6.0749e-02, 9.5676e-02, 8.7425e-02, 1.8263e-01])
[rfa agg] iter:  4, prev_obj_val: 2811.577392578125, obj_val: 2816.611572265625, abs dis: 5.0341796875
[rfa agg] iter: 4, weight: tensor([3.5999e-05, 7.7417e-02, 3.4661e-01, 8.6079e-02, 4.0647e-02, 4.8159e-02,
        8.0578e-02, 7.1443e-02, 1.3269e-01, 1.1634e-01])
[rfa agg] iter:  5, prev_obj_val: 2816.611572265625, obj_val: 2816.563720703125, abs dis: 0.0478515625
[rfa agg] iter: 5, weight: tensor([3.7224e-05, 1.2242e-01, 1.7412e-01, 7.0005e-02, 3.8702e-02, 4.4624e-02,
        1.3101e-01, 6.0878e-02, 2.7059e-01, 8.7614e-02])
[rfa agg] iter:  6, prev_obj_val: 2816.563720703125, obj_val: 2825.9697265625, abs dis: 9.406005859375
[rfa agg] iter: 6, weight: tensor([3.6063e-05, 1.2036e-01, 1.6345e-01, 6.7814e-02, 3.7495e-02, 4.3244e-02,
        1.2890e-01, 5.8959e-02, 2.9502e-01, 8.4736e-02])
[rfa agg] iter:  7, prev_obj_val: 2825.9697265625, obj_val: 2829.883056640625, abs dis: 3.913330078125
[rfa agg] iter: 7, weight: tensor([3.3135e-05, 2.2967e-01, 8.0181e-02, 4.7159e-02, 3.0793e-02, 3.4383e-02,
        3.0069e-01, 4.2860e-02, 1.7884e-01, 5.5398e-02])
[rfa agg] iter:  8, prev_obj_val: 2829.883056640625, obj_val: 2834.15478515625, abs dis: 4.271728515625
[rfa agg] iter: 8, weight: tensor([3.7763e-05, 2.4888e-01, 7.8480e-02, 4.9653e-02, 3.3888e-02, 3.7497e-02,
        3.0671e-01, 4.5632e-02, 1.4171e-01, 5.7509e-02])
[rfa agg] iter:  9, prev_obj_val: 2834.15478515625, obj_val: 2819.3525390625, abs dis: 14.80224609375
[rfa agg] iter: 9, weight: tensor([4.9512e-05, 2.3285e-01, 9.0499e-02, 6.0545e-02, 4.2964e-02, 4.7138e-02,
        2.5673e-01, 5.6166e-02, 1.4377e-01, 6.9288e-02])
			Update norm = 121.5286545107264 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Done in 798.266946554184 sec.
Server Epoch:56 choose agents : [70, 37, 13, 11, 65, 80, 49, 18, 26, 82].
_Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   1, Avg loss: 0.0570, Accuracy: 321/1418 (22.6375%)
_Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   2, Avg loss: 0.0317, Accuracy: 610/1418 (43.0183%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.5701, Accuracy: 96/10000 (0.9600%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   1, Avg loss: 0.0518, Accuracy: 389/1129 (34.4553%)
_Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   2, Avg loss: 0.0241, Accuracy: 730/1129 (64.6590%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.5521, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 290/1645 (17.6292%)
_Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 617/1645 (37.5076%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1062, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   1, Avg loss: 0.0547, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   2, Avg loss: 0.0264, Accuracy: 393/712 (55.1966%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.8404, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0563, Accuracy: 415/1475 (28.1356%)
_Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0314, Accuracy: 667/1475 (45.2203%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.3069, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   1, Avg loss: 0.0703, Accuracy: 149/682 (21.8475%)
_Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 246/682 (36.0704%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.3869, Accuracy: 55/10000 (0.5500%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   1, Avg loss: 0.0794, Accuracy: 28/440 (6.3636%)
_Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.6129, Accuracy: 50/10000 (0.5000%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   1, Avg loss: 0.0720, Accuracy: 137/530 (25.8491%)
_Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   2, Avg loss: 0.0381, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.2671, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0553, Accuracy: 345/1446 (23.8589%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 472/1446 (32.6418%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4820, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.0758, Accuracy: 73/500 (14.6000%)
_Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.7432, Accuracy: 57/10000 (0.5700%)
time spent on training: 343.22504138946533
[rfa agg] training data poison_ratio: 0.3582239150045104  data num: [1418, 1129, 1645, 712, 1475, 682, 440, 530, 1446, 500]
[rfa agg] considering poison per batch poison_fraction: 0.223889946877819
[rfa agg] init. name: [70, 37, 13, 11, 65, 80, 49, 18, 26, 82], weight: tensor([0.1421, 0.1132, 0.1649, 0.0714, 0.1478, 0.0684, 0.0441, 0.0531, 0.1449,
        0.0501])
[rfa agg] iter:  0, prev_obj_val: 60.21613311767578, obj_val: 62.012420654296875, abs dis: 1.7962875366210938
[rfa agg] iter: 0, weight: tensor([0.1140, 0.3356, 0.0910, 0.0827, 0.1030, 0.0649, 0.0244, 0.0372, 0.1162,
        0.0309])
[rfa agg] iter:  1, prev_obj_val: 62.012420654296875, obj_val: 63.880027770996094, abs dis: 1.8676071166992188
[rfa agg] iter: 1, weight: tensor([0.1126, 0.2989, 0.0919, 0.0987, 0.1028, 0.0758, 0.0273, 0.0423, 0.1148,
        0.0349])
[rfa agg] iter:  2, prev_obj_val: 63.880027770996094, obj_val: 65.75768280029297, abs dis: 1.877655029296875
[rfa agg] iter: 2, weight: tensor([0.1110, 0.2564, 0.0923, 0.1187, 0.1021, 0.0886, 0.0305, 0.0480, 0.1132,
        0.0393])
[rfa agg] iter:  3, prev_obj_val: 65.75768280029297, obj_val: 67.64420318603516, abs dis: 1.8865203857421875
[rfa agg] iter: 3, weight: tensor([0.1069, 0.2213, 0.0905, 0.1416, 0.0990, 0.1021, 0.0332, 0.0533, 0.1090,
        0.0431])
[rfa agg] iter:  4, prev_obj_val: 67.64420318603516, obj_val: 67.64282989501953, abs dis: 0.001373291015625
[rfa agg] iter: 4, weight: tensor([0.1007, 0.1909, 0.0866, 0.1690, 0.0939, 0.1163, 0.0354, 0.0581, 0.1027,
        0.0464])
			Update norm = 134.40482953794853 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Done in 768.4737451076508 sec.
Server Epoch:57 choose agents : [49, 24, 21, 90, 19, 40, 84, 62, 37, 70].
poison local model 49 index 18 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   1, Avg loss: 0.0725, Accuracy: 119/440 (27.0455%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   2, Avg loss: 0.0405, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   3, Avg loss: 0.0434, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   4, Avg loss: 0.0398, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   5, Avg loss: 0.0364, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   6, Avg loss: 0.0331, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   7, Avg loss: 0.0306, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   8, Avg loss: 0.0286, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   9, Avg loss: 0.0281, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch  10, Avg loss: 0.0279, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Global model norm: 112.05317515581609.
Norm before scaling: 112.04763217043009. Distance: 0.5404596605112808
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.6444, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 57, Avg loss: 0.4186, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 123.78778226894002, distance: 54.04596477623237
Total norm for 4 adversaries is: 123.78778226894002. distance: 54.04596477623237
_Test Local_ResNet_18 poisoned: True, epoch: 57, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   1, Avg loss: 0.0775, Accuracy: 29/312 (9.2949%)
_Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   2, Avg loss: 0.0408, Accuracy: 175/312 (56.0897%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.4412, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 414/1949 (21.2417%)
_Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 661/1949 (33.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.1684, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   1, Avg loss: 0.0578, Accuracy: 313/677 (46.2334%)
_Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 438/677 (64.6972%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.4390, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   1, Avg loss: 0.0462, Accuracy: 400/1036 (38.6100%)
_Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   2, Avg loss: 0.0244, Accuracy: 662/1036 (63.8996%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.5185, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 376/1573 (23.9034%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 586/1573 (37.2537%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.5832, Accuracy: 55/10000 (0.5500%)
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   1, Avg loss: 0.0626, Accuracy: 320/1190 (26.8908%)
_Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 421/1190 (35.3782%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2904, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   1, Avg loss: 0.0673, Accuracy: 149/568 (26.2324%)
_Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.8312, Accuracy: 51/10000 (0.5100%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   1, Avg loss: 0.0527, Accuracy: 383/1129 (33.9238%)
_Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   2, Avg loss: 0.0240, Accuracy: 735/1129 (65.1019%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.6747, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0569, Accuracy: 337/1418 (23.7659%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 636/1418 (44.8519%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.7966, Accuracy: 82/10000 (0.8200%)
time spent on training: 306.3288950920105
[rfa agg] training data poison_ratio: 0.29838709677419356  data num: [440, 312, 1949, 677, 1036, 1573, 1190, 568, 1129, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.18649193548387097
[rfa agg] init. name: [49, 24, 21, 90, 19, 40, 84, 62, 37, 70], weight: tensor([0.0428, 0.0303, 0.1894, 0.0658, 0.1007, 0.1528, 0.1156, 0.0552, 0.1097,
        0.1378])
[rfa agg] iter:  0, prev_obj_val: 2544.515380859375, obj_val: 1400.066650390625, abs dis: 1144.44873046875
[rfa agg] iter: 0, weight: tensor([0.0019, 0.0284, 0.2112, 0.0641, 0.1020, 0.1634, 0.1187, 0.0531, 0.1119,
        0.1453])
[rfa agg] iter:  1, prev_obj_val: 1400.066650390625, obj_val: 1391.1605224609375, abs dis: 8.9061279296875
[rfa agg] iter: 1, weight: tensor([5.2885e-05, 6.2202e-03, 1.5837e-01, 1.8930e-02, 4.8030e-02, 4.4181e-01,
        7.0398e-02, 1.4013e-02, 5.8586e-02, 1.8359e-01])
[rfa agg] iter:  2, prev_obj_val: 1391.1605224609375, obj_val: 1391.98779296875, abs dis: 0.8272705078125
[rfa agg] iter: 2, weight: tensor([4.6543e-05, 6.7790e-03, 7.9641e-02, 2.2761e-02, 7.5389e-02, 1.9035e-01,
        1.3844e-01, 1.6164e-02, 9.9893e-02, 3.7054e-01])
[rfa agg] iter:  3, prev_obj_val: 1391.98779296875, obj_val: 1395.5726318359375, abs dis: 3.5848388671875
[rfa agg] iter: 3, weight: tensor([4.5552e-05, 7.5163e-03, 6.3932e-02, 2.7208e-02, 1.1918e-01, 1.1235e-01,
        3.0674e-01, 1.8689e-02, 1.7774e-01, 1.6659e-01])
[rfa agg] iter:  4, prev_obj_val: 1395.5726318359375, obj_val: 1399.7265625, abs dis: 4.1539306640625
[rfa agg] iter: 4, weight: tensor([3.4288e-05, 6.5231e-03, 4.0804e-02, 2.6298e-02, 2.0587e-01, 6.0863e-02,
        2.5989e-01, 1.7183e-02, 3.0650e-01, 7.6038e-02])
[rfa agg] iter:  5, prev_obj_val: 1399.7265625, obj_val: 1402.314208984375, abs dis: 2.587646484375
[rfa agg] iter: 5, weight: tensor([3.7609e-05, 7.7449e-03, 4.1579e-02, 3.3571e-02, 3.4499e-01, 5.8499e-02,
        1.6528e-01, 2.1181e-02, 2.5742e-01, 6.9699e-02])
[rfa agg] iter:  6, prev_obj_val: 1402.314208984375, obj_val: 1402.3048095703125, abs dis: 0.0093994140625
[rfa agg] iter: 6, weight: tensor([4.1575e-05, 8.9324e-03, 4.4402e-02, 4.0454e-02, 3.8963e-01, 6.0959e-02,
        1.4796e-01, 2.4976e-02, 2.1132e-01, 7.1317e-02])
[rfa agg] iter:  7, prev_obj_val: 1402.3048095703125, obj_val: 1405.200927734375, abs dis: 2.8961181640625
[rfa agg] iter: 7, weight: tensor([4.0729e-05, 8.7518e-03, 4.3501e-02, 3.9643e-02, 4.0675e-01, 5.9732e-02,
        1.4444e-01, 2.4474e-02, 2.0280e-01, 6.9871e-02])
[rfa agg] iter:  8, prev_obj_val: 1405.200927734375, obj_val: 1402.3079833984375, abs dis: 2.8929443359375
[rfa agg] iter: 8, weight: tensor([5.0160e-05, 1.1262e-02, 5.1809e-02, 5.3608e-02, 3.4927e-01, 6.9536e-02,
        1.5111e-01, 3.2272e-02, 2.0102e-01, 8.0065e-02])
[rfa agg] iter:  9, prev_obj_val: 1402.3079833984375, obj_val: 1402.3040771484375, abs dis: 0.00390625
[rfa agg] iter: 9, weight: tensor([4.1179e-05, 8.8496e-03, 4.3987e-02, 4.0104e-02, 3.9987e-01, 6.0406e-02,
        1.4635e-01, 2.4750e-02, 2.0497e-01, 7.0678e-02])
			Update norm = 152.05630253503142 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Done in 722.0857331752777 sec.
Server Epoch:58 choose agents : [95, 54, 5, 67, 47, 39, 11, 59, 83, 6].
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   1, Avg loss: 0.0486, Accuracy: 348/599 (58.0968%)
_Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.1687, Accuracy: 50/10000 (0.5000%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   1, Avg loss: 0.0555, Accuracy: 341/1130 (30.1770%)
_Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 462/1130 (40.8850%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.9123, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   1, Avg loss: 0.0509, Accuracy: 383/1628 (23.5258%)
_Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 813/1628 (49.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.2960, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0773, Accuracy: 59/426 (13.8498%)
_Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0415, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.7091, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1237, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1112, Accuracy: 19/134 (14.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3224, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 317/1013 (31.2932%)
_Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 497/1013 (49.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.8910, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   1, Avg loss: 0.0537, Accuracy: 357/712 (50.1404%)
_Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   2, Avg loss: 0.0293, Accuracy: 414/712 (58.1461%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.7323, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 306/1089 (28.0992%)
_Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   2, Avg loss: 0.0293, Accuracy: 413/1089 (37.9247%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.8569, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 420/1953 (21.5054%)
_Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   2, Avg loss: 0.0348, Accuracy: 666/1953 (34.1014%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.3527, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   1, Avg loss: 0.0554, Accuracy: 404/1956 (20.6544%)
_Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   2, Avg loss: 0.0327, Accuracy: 620/1956 (31.6973%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.0825, Accuracy: 88/10000 (0.8800%)
time spent on training: 260.77877831459045
[rfa agg] training data poison_ratio: 0.31550751879699246  data num: [599, 1130, 1628, 426, 134, 1013, 712, 1089, 1953, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.1971921992481203
[rfa agg] init. name: [95, 54, 5, 67, 47, 39, 11, 59, 83, 6], weight: tensor([0.0563, 0.1062, 0.1530, 0.0400, 0.0126, 0.0952, 0.0669, 0.1023, 0.1836,
        0.1838])
[rfa agg] iter:  0, prev_obj_val: 68.66971588134766, obj_val: 69.74543762207031, abs dis: 1.0757217407226562
[rfa agg] iter: 0, weight: tensor([0.0290, 0.2549, 0.1302, 0.0159, 0.0038, 0.1202, 0.0430, 0.2312, 0.0858,
        0.0860])
[rfa agg] iter:  1, prev_obj_val: 69.74543762207031, obj_val: 75.90586853027344, abs dis: 6.160430908203125
[rfa agg] iter: 1, weight: tensor([0.0203, 0.3815, 0.0624, 0.0107, 0.0025, 0.1110, 0.0315, 0.2899, 0.0451,
        0.0452])
[rfa agg] iter:  2, prev_obj_val: 75.90586853027344, obj_val: 78.0419921875, abs dis: 2.1361236572265625
[rfa agg] iter: 2, weight: tensor([0.0302, 0.2289, 0.0561, 0.0147, 0.0032, 0.3238, 0.0512, 0.2033, 0.0442,
        0.0443])
[rfa agg] iter:  3, prev_obj_val: 78.0419921875, obj_val: 80.56719207763672, abs dis: 2.5251998901367188
[rfa agg] iter: 3, weight: tensor([0.0301, 0.1617, 0.0493, 0.0143, 0.0031, 0.4626, 0.0531, 0.1467, 0.0395,
        0.0395])
[rfa agg] iter:  4, prev_obj_val: 80.56719207763672, obj_val: 83.33815002441406, abs dis: 2.7709579467773438
[rfa agg] iter: 4, weight: tensor([0.0359, 0.1435, 0.0514, 0.0166, 0.0035, 0.4676, 0.0661, 0.1318, 0.0418,
        0.0419])
[rfa agg] iter:  5, prev_obj_val: 83.33815002441406, obj_val: 75.81444549560547, abs dis: 7.523704528808594
[rfa agg] iter: 5, weight: tensor([0.0492, 0.1511, 0.0612, 0.0219, 0.0046, 0.3751, 0.0954, 0.1405, 0.0505,
        0.0506])
[rfa agg] iter:  6, prev_obj_val: 75.81444549560547, obj_val: 78.01514434814453, abs dis: 2.2006988525390625
[rfa agg] iter: 6, weight: tensor([0.0277, 0.2026, 0.0515, 0.0135, 0.0030, 0.3975, 0.0472, 0.1757, 0.0406,
        0.0407])
[rfa agg] iter:  7, prev_obj_val: 78.01514434814453, obj_val: 80.5669937133789, abs dis: 2.551849365234375
[rfa agg] iter: 7, weight: tensor([0.0285, 0.1524, 0.0466, 0.0135, 0.0029, 0.4936, 0.0503, 0.1374, 0.0373,
        0.0374])
[rfa agg] iter:  8, prev_obj_val: 80.5669937133789, obj_val: 80.56626892089844, abs dis: 0.00072479248046875
[rfa agg] iter: 8, weight: tensor([0.0354, 0.1413, 0.0507, 0.0163, 0.0035, 0.4755, 0.0652, 0.1296, 0.0412,
        0.0413])
			Update norm = 143.29527943856002 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Done in 672.9234192371368 sec.
Server Epoch:59 choose agents : [54, 47, 10, 12, 0, 49, 14, 52, 51, 46].
poison local model 54 index 19 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   1, Avg loss: 0.0511, Accuracy: 557/1130 (49.2920%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   2, Avg loss: 0.0259, Accuracy: 664/1130 (58.7611%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   3, Avg loss: 0.0220, Accuracy: 720/1130 (63.7168%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   4, Avg loss: 0.0215, Accuracy: 720/1130 (63.7168%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   5, Avg loss: 0.0205, Accuracy: 721/1130 (63.8053%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   6, Avg loss: 0.0210, Accuracy: 720/1130 (63.7168%), train_poison_data_count: 720
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   7, Avg loss: 0.0199, Accuracy: 721/1130 (63.8053%), train_poison_data_count: 720
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   8, Avg loss: 0.0204, Accuracy: 721/1130 (63.8053%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   9, Avg loss: 0.0200, Accuracy: 720/1130 (63.7168%), train_poison_data_count: 720
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch  10, Avg loss: 0.0201, Accuracy: 720/1130 (63.7168%), train_poison_data_count: 720
Global model norm: 112.05317515581609.
Norm before scaling: 112.0341221737824. Distance: 0.8856852890632033
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.0424, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 59, Avg loss: 0.4072, Accuracy: 9946/9950 (99.9598%)
Scaling by  100
Scaled Norm after poisoning: 141.0493527878629, distance: 88.56853146363555
Total norm for 5 adversaries is: 141.0493527878629. distance: 88.56853146363555
_Test Local_ResNet_18 poisoned: True, epoch: 59, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   1, Avg loss: 0.1211, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   2, Avg loss: 0.1078, Accuracy: 23/134 (17.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3249, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 205/861 (23.8095%)
_Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 450/861 (52.2648%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.9510, Accuracy: 52/10000 (0.5200%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   1, Avg loss: 0.0846, Accuracy: 29/338 (8.5799%)
_Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   2, Avg loss: 0.0449, Accuracy: 147/338 (43.4911%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.5822, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   1, Avg loss: 0.0580, Accuracy: 376/1657 (22.6916%)
_Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 510/1657 (30.7785%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.5022, Accuracy: 74/10000 (0.7400%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   1, Avg loss: 0.0799, Accuracy: 27/440 (6.1364%)
_Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   2, Avg loss: 0.0484, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.6580, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 224/1013 (22.1125%)
_Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 306/1013 (30.2073%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.7434, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0571, Accuracy: 278/636 (43.7107%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0323, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.4911, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 232/1049 (22.1163%)
_Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 506/1049 (48.2364%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.9331, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 422/1904 (22.1639%)
_Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 659/1904 (34.6113%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.0502, Accuracy: 85/10000 (0.8500%)
time spent on training: 340.1150963306427
[rfa agg] training data poison_ratio: 0.48308229644182493  data num: [1130, 134, 861, 338, 1657, 440, 1013, 636, 1049, 1904]
[rfa agg] considering poison per batch poison_fraction: 0.3019264352761406
[rfa agg] init. name: [54, 47, 10, 12, 0, 49, 14, 52, 51, 46], weight: tensor([0.1233, 0.0146, 0.0940, 0.0369, 0.1809, 0.0480, 0.1106, 0.0694, 0.1145,
        0.2078])
[rfa agg] iter:  0, prev_obj_val: 17373.166015625, obj_val: 11073.0244140625, abs dis: 6300.1416015625
[rfa agg] iter: 0, weight: tensor([0.0194, 0.0161, 0.1046, 0.0408, 0.2035, 0.0531, 0.1233, 0.0770, 0.1278,
        0.2346])
[rfa agg] iter:  1, prev_obj_val: 11073.0244140625, obj_val: 10071.4716796875, abs dis: 1001.552734375
[rfa agg] iter: 1, weight: tensor([0.0027, 0.0151, 0.1032, 0.0388, 0.2131, 0.0507, 0.1229, 0.0746, 0.1279,
        0.2509])
[rfa agg] iter:  2, prev_obj_val: 10071.4716796875, obj_val: 9975.9306640625, abs dis: 95.541015625
[rfa agg] iter: 2, weight: tensor([3.1054e-04, 8.3345e-03, 7.4362e-02, 2.2782e-02, 2.4661e-01, 3.0502e-02,
        9.4097e-02, 4.8167e-02, 1.0119e-01, 3.7364e-01])
[rfa agg] iter:  3, prev_obj_val: 9975.9306640625, obj_val: 9976.2890625, abs dis: 0.3583984375
[rfa agg] iter: 3, weight: tensor([9.0090e-05, 4.6559e-03, 6.4637e-02, 1.3800e-02, 4.4542e-01, 1.9065e-02,
        9.6159e-02, 3.3663e-02, 1.1391e-01, 2.0860e-01])
[rfa agg] iter:  4, prev_obj_val: 9976.2890625, obj_val: 9976.94140625, abs dis: 0.65234375
[rfa agg] iter: 4, weight: tensor([1.0278e-04, 5.8820e-03, 9.3129e-02, 1.7770e-02, 2.9783e-01, 2.4745e-02,
        1.4846e-01, 4.5051e-02, 1.8507e-01, 1.8196e-01])
[rfa agg] iter:  5, prev_obj_val: 9976.94140625, obj_val: 9978.1767578125, abs dis: 1.2353515625
[rfa agg] iter: 5, weight: tensor([8.2961e-05, 5.4811e-03, 1.1211e-01, 1.7092e-02, 1.5516e-01, 2.4126e-02,
        2.1493e-01, 4.6419e-02, 3.1078e-01, 1.1383e-01])
[rfa agg] iter:  6, prev_obj_val: 9978.1767578125, obj_val: 9982.1884765625, abs dis: 4.01171875
[rfa agg] iter: 6, weight: tensor([4.3874e-05, 3.3062e-03, 9.6944e-02, 1.0671e-02, 6.3878e-02, 1.5298e-02,
        2.7980e-01, 3.1495e-02, 4.4758e-01, 5.0977e-02])
[rfa agg] iter:  7, prev_obj_val: 9982.1884765625, obj_val: 9986.224609375, abs dis: 4.0361328125
[rfa agg] iter: 7, weight: tensor([4.6370e-05, 3.9034e-03, 1.8531e-01, 1.3033e-02, 5.7894e-02, 1.8984e-02,
        3.9510e-01, 4.2145e-02, 2.3527e-01, 4.8314e-02])
[rfa agg] iter:  8, prev_obj_val: 9986.224609375, obj_val: 9988.470703125, abs dis: 2.24609375
[rfa agg] iter: 8, weight: tensor([4.9476e-05, 4.5176e-03, 3.9503e-01, 1.5523e-02, 5.6465e-02, 2.2938e-02,
        2.4782e-01, 5.4720e-02, 1.5467e-01, 4.8263e-02])
[rfa agg] iter:  9, prev_obj_val: 9988.470703125, obj_val: 9988.42578125, abs dis: 0.044921875
[rfa agg] iter: 9, weight: tensor([4.1460e-05, 3.9545e-03, 5.5807e-01, 1.3814e-02, 4.5367e-02, 2.0584e-02,
        1.5820e-01, 5.1379e-02, 1.0941e-01, 3.9184e-02])
			Update norm = 130.17834821409434 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Done in 755.2568881511688 sec.
Server Epoch:60 choose agents : [54, 52, 10, 29, 40, 35, 50, 34, 99, 36].
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0561, Accuracy: 345/1130 (30.5310%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0296, Accuracy: 444/1130 (39.2920%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.1959, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0574, Accuracy: 280/636 (44.0252%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0315, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.5279, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0567, Accuracy: 188/861 (21.8351%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 412/861 (47.8513%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.0560, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   1, Avg loss: 0.0500, Accuracy: 393/1440 (27.2917%)
_Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 671/1440 (46.5972%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.8389, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 350/1573 (22.2505%)
_Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   2, Avg loss: 0.0354, Accuracy: 537/1573 (34.1386%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.3147, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 37/271 (13.6531%)
_Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   2, Avg loss: 0.0550, Accuracy: 97/271 (35.7934%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.4107, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0638, Accuracy: 148/809 (18.2942%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0279, Accuracy: 327/809 (40.4203%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.4978, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   1, Avg loss: 0.0585, Accuracy: 417/1427 (29.2221%)
_Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   2, Avg loss: 0.0339, Accuracy: 563/1427 (39.4534%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.1298, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   1, Avg loss: 0.0666, Accuracy: 188/773 (24.3208%)
_Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   2, Avg loss: 0.0306, Accuracy: 387/773 (50.0647%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.1931, Accuracy: 54/10000 (0.5400%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   1, Avg loss: 0.0875, Accuracy: 80/408 (19.6078%)
_Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   2, Avg loss: 0.0544, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.5654, Accuracy: 50/10000 (0.5000%)
time spent on training: 218.2160894870758
[rfa agg] training data poison_ratio: 0.2571826758147513  data num: [1130, 636, 861, 1440, 1573, 271, 809, 1427, 773, 408]
[rfa agg] considering poison per batch poison_fraction: 0.16073917238421956
[rfa agg] init. name: [54, 52, 10, 29, 40, 35, 50, 34, 99, 36], weight: tensor([0.1211, 0.0682, 0.0923, 0.1544, 0.1686, 0.0291, 0.0867, 0.1530, 0.0829,
        0.0437])
[rfa agg] iter:  0, prev_obj_val: 51.10207748413086, obj_val: 53.772579193115234, abs dis: 2.670501708984375
[rfa agg] iter: 0, weight: tensor([0.3010, 0.0437, 0.1483, 0.0986, 0.0827, 0.0105, 0.1013, 0.0977, 0.0969,
        0.0192])
[rfa agg] iter:  1, prev_obj_val: 53.772579193115234, obj_val: 57.60161590576172, abs dis: 3.8290367126464844
[rfa agg] iter: 1, weight: tensor([0.1466, 0.0499, 0.2765, 0.0710, 0.0622, 0.0107, 0.1490, 0.0704, 0.1437,
        0.0201])
[rfa agg] iter:  2, prev_obj_val: 57.60161590576172, obj_val: 65.32176208496094, abs dis: 7.720146179199219
[rfa agg] iter: 2, weight: tensor([0.0645, 0.0462, 0.2889, 0.0392, 0.0355, 0.0082, 0.2337, 0.0389, 0.2288,
        0.0162])
[rfa agg] iter:  3, prev_obj_val: 65.32176208496094, obj_val: 59.66661834716797, abs dis: 5.655143737792969
[rfa agg] iter: 3, weight: tensor([0.0691, 0.1101, 0.1530, 0.0483, 0.0447, 0.0141, 0.2467, 0.0479, 0.2364,
        0.0298])
[rfa agg] iter:  4, prev_obj_val: 59.66661834716797, obj_val: 68.43614196777344, abs dis: 8.769523620605469
[rfa agg] iter: 4, weight: tensor([0.0552, 0.0511, 0.1753, 0.0355, 0.0323, 0.0083, 0.3052, 0.0351, 0.2853,
        0.0167])
[rfa agg] iter:  5, prev_obj_val: 68.43614196777344, obj_val: 65.30825805664062, abs dis: 3.1278839111328125
[rfa agg] iter: 5, weight: tensor([0.0735, 0.1612, 0.1414, 0.0531, 0.0495, 0.0174, 0.2117, 0.0526, 0.2016,
        0.0379])
[rfa agg] iter:  6, prev_obj_val: 65.30825805664062, obj_val: 59.666839599609375, abs dis: 5.64141845703125
[rfa agg] iter: 6, weight: tensor([0.0691, 0.1118, 0.1506, 0.0483, 0.0447, 0.0141, 0.2489, 0.0478, 0.2350,
        0.0298])
[rfa agg] iter:  7, prev_obj_val: 59.666839599609375, obj_val: 68.43614196777344, abs dis: 8.769302368164062
[rfa agg] iter: 7, weight: tensor([0.0552, 0.0511, 0.1751, 0.0354, 0.0323, 0.0083, 0.3063, 0.0351, 0.2845,
        0.0167])
[rfa agg] iter:  8, prev_obj_val: 68.43614196777344, obj_val: 65.30826568603516, abs dis: 3.1278762817382812
[rfa agg] iter: 8, weight: tensor([0.0735, 0.1612, 0.1414, 0.0531, 0.0495, 0.0174, 0.2118, 0.0526, 0.2015,
        0.0379])
[rfa agg] iter:  9, prev_obj_val: 65.30826568603516, obj_val: 59.666847229003906, abs dis: 5.64141845703125
[rfa agg] iter: 9, weight: tensor([0.0691, 0.1118, 0.1506, 0.0483, 0.0447, 0.0141, 0.2489, 0.0478, 0.2350,
        0.0298])
			Update norm = 121.48084098557476 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 632.8894608020782 sec.
Server Epoch:61 choose agents : [55, 8, 59, 31, 34, 81, 12, 79, 36, 85].
poison local model 55 index 20 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0534, Accuracy: 519/1071 (48.4594%), train_poison_data_count: 680
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0268, Accuracy: 624/1071 (58.2633%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   3, Avg loss: 0.0220, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   4, Avg loss: 0.0214, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   5, Avg loss: 0.0206, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   6, Avg loss: 0.0205, Accuracy: 679/1071 (63.3987%), train_poison_data_count: 680
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   7, Avg loss: 0.0207, Accuracy: 679/1071 (63.3987%), train_poison_data_count: 680
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   8, Avg loss: 0.0200, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 680
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   9, Avg loss: 0.0197, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 680
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch  10, Avg loss: 0.0202, Accuracy: 679/1071 (63.3987%), train_poison_data_count: 680
Global model norm: 112.05317515581609.
Norm before scaling: 112.03552118775768. Distance: 0.8937321054227758
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2432, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 61, Avg loss: 0.4334, Accuracy: 9947/9950 (99.9698%)
Scaling by  100
Scaled Norm after poisoning: 141.6629127872747, distance: 89.37321348738949
Total norm for 5 adversaries is: 141.6629127872747. distance: 89.37321348738949
_Test Local_ResNet_18 poisoned: True, epoch: 61, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 249/1513 (16.4574%)
_Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   2, Avg loss: 0.0372, Accuracy: 437/1513 (28.8830%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.3510, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 332/1089 (30.4867%)
_Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 471/1089 (43.2507%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.6437, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   1, Avg loss: 0.0828, Accuracy: 52/460 (11.3043%)
_Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   2, Avg loss: 0.0373, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.0071, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   1, Avg loss: 0.0589, Accuracy: 366/1427 (25.6482%)
_Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 595/1427 (41.6959%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.8855, Accuracy: 61/10000 (0.6100%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   1, Avg loss: 0.0686, Accuracy: 237/774 (30.6202%)
_Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   2, Avg loss: 0.0359, Accuracy: 299/774 (38.6305%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.2992, Accuracy: 71/10000 (0.7100%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0845, Accuracy: 23/338 (6.8047%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0468, Accuracy: 146/338 (43.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.5333, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1015, Accuracy: 10/197 (5.0761%)
_Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.0870, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3362, Accuracy: 50/10000 (0.5000%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   1, Avg loss: 0.0869, Accuracy: 77/408 (18.8725%)
_Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   2, Avg loss: 0.0550, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.5729, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 447/1988 (22.4849%)
_Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 662/1988 (33.2998%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.7675, Accuracy: 77/10000 (0.7700%)
time spent on training: 372.2329213619232
[rfa agg] training data poison_ratio: 0.494225580140313  data num: [1071, 1513, 1089, 460, 1427, 774, 338, 197, 408, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.3088909875876956
[rfa agg] init. name: [55, 8, 59, 31, 34, 81, 12, 79, 36, 85], weight: tensor([0.1156, 0.1633, 0.1175, 0.0496, 0.1540, 0.0835, 0.0365, 0.0213, 0.0440,
        0.2146])
[rfa agg] iter:  0, prev_obj_val: 15511.6796875, obj_val: 9735.1201171875, abs dis: 5776.5595703125
[rfa agg] iter: 0, weight: tensor([0.0168, 0.1821, 0.1303, 0.0545, 0.1716, 0.0921, 0.0399, 0.0232, 0.0483,
        0.2413])
[rfa agg] iter:  1, prev_obj_val: 9735.1201171875, obj_val: 8892.0029296875, abs dis: 843.1171875
[rfa agg] iter: 1, weight: tensor([0.0022, 0.1877, 0.1294, 0.0511, 0.1757, 0.0888, 0.0370, 0.0213, 0.0450,
        0.2619])
[rfa agg] iter:  2, prev_obj_val: 8892.0029296875, obj_val: 8834.951171875, abs dis: 57.0517578125
[rfa agg] iter: 2, weight: tensor([1.8189e-04, 1.6067e-01, 8.0185e-02, 2.2409e-02, 1.4120e-01, 4.5399e-02,
        1.5413e-02, 8.4384e-03, 1.9221e-02, 5.0688e-01])
[rfa agg] iter:  3, prev_obj_val: 8834.951171875, obj_val: 8831.7939453125, abs dis: 3.1572265625
[rfa agg] iter: 3, weight: tensor([6.5347e-05, 4.2517e-01, 7.4251e-02, 1.3582e-02, 2.7241e-01, 3.1946e-02,
        8.9520e-03, 4.7255e-03, 1.1394e-02, 1.5751e-01])
[rfa agg] iter:  4, prev_obj_val: 8831.7939453125, obj_val: 8835.2646484375, abs dis: 3.470703125
[rfa agg] iter: 4, weight: tensor([4.2133e-05, 3.0743e-01, 7.8409e-02, 1.0569e-02, 4.8801e-01, 2.7066e-02,
        6.8196e-03, 3.5383e-03, 8.7679e-03, 6.9346e-02])
[rfa agg] iter:  5, prev_obj_val: 8835.2646484375, obj_val: 8835.23828125, abs dis: 0.0263671875
[rfa agg] iter: 5, weight: tensor([6.6972e-05, 2.5762e-01, 1.8040e-01, 1.8729e-02, 3.6347e-01, 5.0995e-02,
        1.1916e-02, 6.1149e-03, 1.5423e-02, 9.5273e-02])
			Update norm = 191.38013342233305 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Done in 805.5086846351624 sec.
Server Epoch:62 choose agents : [76, 81, 79, 10, 63, 90, 19, 80, 0, 17].
_Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 44/466 (9.4421%)
_Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   2, Avg loss: 0.0474, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.7563, Accuracy: 50/10000 (0.5000%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.0652, Accuracy: 242/774 (31.2661%)
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0374, Accuracy: 283/774 (36.5633%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.2882, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   1, Avg loss: 0.1050, Accuracy: 14/197 (7.1066%)
_Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   2, Avg loss: 0.0817, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3351, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   1, Avg loss: 0.0564, Accuracy: 205/861 (23.8095%)
_Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 443/861 (51.4518%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.1191, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0553, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 404/888 (45.4955%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.3579, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   1, Avg loss: 0.0573, Accuracy: 314/677 (46.3811%)
_Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.3445, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   1, Avg loss: 0.0479, Accuracy: 391/1036 (37.7413%)
_Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 668/1036 (64.4788%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.0034, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 156/682 (22.8739%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 258/682 (37.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.6400, Accuracy: 51/10000 (0.5100%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   1, Avg loss: 0.0587, Accuracy: 365/1657 (22.0278%)
_Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 504/1657 (30.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.6180, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 398/1574 (25.2859%)
_Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 694/1574 (44.0915%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.2313, Accuracy: 98/10000 (0.9800%)
time spent on training: 237.7860448360443
[rfa agg] training data poison_ratio: 0.37358147980027234  data num: [466, 774, 197, 861, 888, 677, 1036, 682, 1657, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.23348842487517021
[rfa agg] init. name: [76, 81, 79, 10, 63, 90, 19, 80, 0, 17], weight: tensor([0.0529, 0.0878, 0.0224, 0.0977, 0.1008, 0.0768, 0.1176, 0.0774, 0.1880,
        0.1786])
[rfa agg] iter:  0, prev_obj_val: 52.651580810546875, obj_val: 57.3670768737793, abs dis: 4.715496063232422
[rfa agg] iter: 0, weight: tensor([0.0191, 0.1546, 0.0048, 0.2929, 0.2671, 0.0549, 0.0819, 0.0550, 0.0341,
        0.0354])
[rfa agg] iter:  1, prev_obj_val: 57.3670768737793, obj_val: 64.90292358398438, abs dis: 7.535846710205078
[rfa agg] iter: 1, weight: tensor([0.0298, 0.2668, 0.0067, 0.1568, 0.1582, 0.1219, 0.0659, 0.1214, 0.0358,
        0.0367])
[rfa agg] iter:  2, prev_obj_val: 64.90292358398438, obj_val: 71.84393310546875, abs dis: 6.941009521484375
[rfa agg] iter: 2, weight: tensor([0.0385, 0.0951, 0.0070, 0.0713, 0.0731, 0.3067, 0.0434, 0.3084, 0.0281,
        0.0285])
[rfa agg] iter:  3, prev_obj_val: 71.84393310546875, obj_val: 64.81990051269531, abs dis: 7.0240325927734375
[rfa agg] iter: 3, weight: tensor([0.0875, 0.0999, 0.0126, 0.0838, 0.0861, 0.2447, 0.0580, 0.2451, 0.0409,
        0.0414])
[rfa agg] iter:  4, prev_obj_val: 64.81990051269531, obj_val: 68.17969512939453, abs dis: 3.3597946166992188
[rfa agg] iter: 4, weight: tensor([0.0349, 0.0848, 0.0063, 0.0641, 0.0657, 0.3349, 0.0392, 0.3190, 0.0253,
        0.0258])
[rfa agg] iter:  5, prev_obj_val: 68.17969512939453, obj_val: 71.84235382080078, abs dis: 3.66265869140625
[rfa agg] iter: 5, weight: tensor([0.0531, 0.0884, 0.0087, 0.0709, 0.0727, 0.3012, 0.0464, 0.2953, 0.0314,
        0.0319])
[rfa agg] iter:  6, prev_obj_val: 71.84235382080078, obj_val: 64.8199462890625, abs dis: 7.022407531738281
[rfa agg] iter: 6, weight: tensor([0.0877, 0.0999, 0.0126, 0.0838, 0.0861, 0.2450, 0.0580, 0.2445, 0.0409,
        0.0415])
[rfa agg] iter:  7, prev_obj_val: 64.8199462890625, obj_val: 68.1796875, abs dis: 3.3597412109375
[rfa agg] iter: 7, weight: tensor([0.0349, 0.0848, 0.0063, 0.0641, 0.0657, 0.3351, 0.0392, 0.3188, 0.0253,
        0.0258])
[rfa agg] iter:  8, prev_obj_val: 68.1796875, obj_val: 71.84235382080078, abs dis: 3.6626663208007812
[rfa agg] iter: 8, weight: tensor([0.0531, 0.0884, 0.0087, 0.0709, 0.0727, 0.3013, 0.0464, 0.2953, 0.0314,
        0.0319])
[rfa agg] iter:  9, prev_obj_val: 71.84235382080078, obj_val: 64.8199462890625, abs dis: 7.022407531738281
[rfa agg] iter: 9, weight: tensor([0.0877, 0.0999, 0.0126, 0.0838, 0.0861, 0.2450, 0.0580, 0.2445, 0.0409,
        0.0415])
			Update norm = 104.17861389819889 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Done in 666.3750042915344 sec.
Server Epoch:63 choose agents : [60, 37, 76, 38, 57, 8, 82, 79, 19, 99].
poison local model 60 index 21 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   1, Avg loss: 0.0426, Accuracy: 1245/2227 (55.9048%), train_poison_data_count: 1400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   2, Avg loss: 0.0226, Accuracy: 1427/2227 (64.0772%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   3, Avg loss: 0.0207, Accuracy: 1428/2227 (64.1221%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   4, Avg loss: 0.0209, Accuracy: 1427/2227 (64.0772%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   5, Avg loss: 0.0203, Accuracy: 1433/2227 (64.3467%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   6, Avg loss: 0.0201, Accuracy: 1423/2227 (63.8976%), train_poison_data_count: 1400
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   7, Avg loss: 0.0197, Accuracy: 1431/2227 (64.2568%), train_poison_data_count: 1400
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   8, Avg loss: 0.0194, Accuracy: 1430/2227 (64.2119%), train_poison_data_count: 1400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   9, Avg loss: 0.0195, Accuracy: 1430/2227 (64.2119%), train_poison_data_count: 1400
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch  10, Avg loss: 0.0196, Accuracy: 1432/2227 (64.3018%), train_poison_data_count: 1400
Global model norm: 112.05317515581609.
Norm before scaling: 112.01234150055743. Distance: 1.1762383165093422
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.3224, Accuracy: 55/10000 (0.5500%)
_Test Local_ResNet_18 poisoned: True, epoch: 63, Avg loss: 0.3674, Accuracy: 9945/9950 (99.9497%)
Scaling by  100
Scaled Norm after poisoning: 159.17945111178767, distance: 117.6238252133151
Total norm for 2 adversaries is: 159.17945111178767. distance: 117.6238252133151
_Test Local_ResNet_18 poisoned: True, epoch: 63, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0529, Accuracy: 415/1129 (36.7582%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0247, Accuracy: 731/1129 (64.7476%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.3393, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.0866, Accuracy: 39/466 (8.3691%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0495, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.7517, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0618, Accuracy: 252/1131 (22.2812%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 470/1131 (41.5561%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.3857, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0549, Accuracy: 300/1154 (25.9965%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0250, Accuracy: 525/1154 (45.4939%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.1541, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 252/1513 (16.6557%)
_Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 501/1513 (33.1130%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.6339, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   1, Avg loss: 0.0756, Accuracy: 75/500 (15.0000%)
_Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.8291, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   1, Avg loss: 0.0996, Accuracy: 15/197 (7.6142%)
_Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   2, Avg loss: 0.0870, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3390, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   1, Avg loss: 0.0469, Accuracy: 406/1036 (39.1892%)
_Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   2, Avg loss: 0.0242, Accuracy: 671/1036 (64.7683%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.4893, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.0638, Accuracy: 183/773 (23.6740%)
_Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0334, Accuracy: 413/773 (53.4282%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.3479, Accuracy: 50/10000 (0.5000%)
time spent on training: 390.05055260658264
[rfa agg] training data poison_ratio: 0.3314240568832708  data num: [2227, 1129, 466, 1131, 1154, 1513, 500, 197, 1036, 773]
[rfa agg] considering poison per batch poison_fraction: 0.20714003555204424
[rfa agg] init. name: [60, 37, 76, 38, 57, 8, 82, 79, 19, 99], weight: tensor([0.2199, 0.1115, 0.0460, 0.1117, 0.1140, 0.1494, 0.0494, 0.0195, 0.1023,
        0.0763])
[rfa agg] iter:  0, prev_obj_val: 53659.8203125, obj_val: 40835.25, abs dis: 12824.5703125
[rfa agg] iter: 0, weight: tensor([0.0736, 0.1324, 0.0545, 0.1327, 0.1354, 0.1778, 0.0585, 0.0230, 0.1215,
        0.0906])
[rfa agg] iter:  1, prev_obj_val: 40835.25, obj_val: 36304.8046875, abs dis: 4530.4453125
[rfa agg] iter: 1, weight: tensor([0.0219, 0.1399, 0.0573, 0.1401, 0.1431, 0.1884, 0.0615, 0.0241, 0.1283,
        0.0954])
[rfa agg] iter:  2, prev_obj_val: 36304.8046875, obj_val: 34934.16796875, abs dis: 1370.63671875
[rfa agg] iter: 2, weight: tensor([0.0062, 0.1424, 0.0572, 0.1426, 0.1459, 0.1938, 0.0614, 0.0240, 0.1303,
        0.0962])
[rfa agg] iter:  3, prev_obj_val: 34934.16796875, obj_val: 34540.828125, abs dis: 393.33984375
[rfa agg] iter: 3, weight: tensor([0.0017, 0.1436, 0.0541, 0.1438, 0.1482, 0.2040, 0.0581, 0.0221, 0.1305,
        0.0939])
[rfa agg] iter:  4, prev_obj_val: 34540.828125, obj_val: 34435.29296875, abs dis: 105.53515625
[rfa agg] iter: 4, weight: tensor([0.0004, 0.1431, 0.0431, 0.1433, 0.1518, 0.2463, 0.0462, 0.0164, 0.1266,
        0.0827])
[rfa agg] iter:  5, prev_obj_val: 34435.29296875, obj_val: 34426.6875, abs dis: 8.60546875
[rfa agg] iter: 5, weight: tensor([5.1154e-05, 8.1247e-02, 1.2049e-02, 8.1462e-02, 1.0123e-01, 6.1409e-01,
        1.2930e-02, 4.0389e-03, 6.3438e-02, 2.9465e-02])
[rfa agg] iter:  6, prev_obj_val: 34426.6875, obj_val: 34429.03125, abs dis: 2.34375
[rfa agg] iter: 6, weight: tensor([4.0185e-05, 1.8710e-01, 1.2732e-02, 1.8993e-01, 3.2965e-01, 1.0559e-01,
        1.3661e-02, 3.9824e-03, 1.2028e-01, 3.7034e-02])
[rfa agg] iter:  7, prev_obj_val: 34429.03125, obj_val: 34433.640625, abs dis: 4.609375
[rfa agg] iter: 7, weight: tensor([3.2772e-05, 2.1640e-01, 1.3254e-02, 2.1894e-01, 1.4050e-01, 5.5052e-02,
        1.4228e-02, 3.8648e-03, 2.8916e-01, 4.8581e-02])
			Update norm = 147.6870569714049 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3027, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.3233, Accuracy: 0/9950 (0.0000%)
saving model
Done in 818.7671678066254 sec.
Server Epoch:64 choose agents : [36, 20, 35, 30, 6, 45, 65, 50, 99, 89].
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   1, Avg loss: 0.0869, Accuracy: 78/408 (19.1176%)
_Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   2, Avg loss: 0.0543, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.5508, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   1, Avg loss: 0.0582, Accuracy: 344/807 (42.6270%)
_Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 412/807 (51.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.7948, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.0861, Accuracy: 36/271 (13.2841%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0560, Accuracy: 104/271 (38.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.4051, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.0805, Accuracy: 69/486 (14.1975%)
_Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0426, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.9631, Accuracy: 41/10000 (0.4100%)
_Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 397/1956 (20.2965%)
_Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 678/1956 (34.6626%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.0613, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.0676, Accuracy: 195/669 (29.1480%)
_Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0418, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8540, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   1, Avg loss: 0.0561, Accuracy: 388/1475 (26.3051%)
_Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   2, Avg loss: 0.0313, Accuracy: 697/1475 (47.2542%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.0824, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   1, Avg loss: 0.0639, Accuracy: 143/809 (17.6761%)
_Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 339/809 (41.9036%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.4306, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   1, Avg loss: 0.0651, Accuracy: 194/773 (25.0970%)
_Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   2, Avg loss: 0.0320, Accuracy: 389/773 (50.3234%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.1539, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   1, Avg loss: 0.0614, Accuracy: 328/896 (36.6071%)
_Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   2, Avg loss: 0.0330, Accuracy: 464/896 (51.7857%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.2371, Accuracy: 50/10000 (0.5000%)
time spent on training: 243.5017466545105
[rfa agg] training data poison_ratio: 0.37146198830409355  data num: [408, 807, 271, 486, 1956, 669, 1475, 809, 773, 896]
[rfa agg] considering poison per batch poison_fraction: 0.23216374269005846
[rfa agg] init. name: [36, 20, 35, 30, 6, 45, 65, 50, 99, 89], weight: tensor([0.0477, 0.0944, 0.0317, 0.0568, 0.2288, 0.0782, 0.1725, 0.0946, 0.0904,
        0.1048])
[rfa agg] iter:  0, prev_obj_val: 66.8665542602539, obj_val: 69.72588348388672, abs dis: 2.8593292236328125
[rfa agg] iter: 0, weight: tensor([0.0238, 0.1520, 0.0128, 0.0321, 0.0628, 0.0731, 0.0859, 0.1534, 0.1486,
        0.2556])
[rfa agg] iter:  1, prev_obj_val: 69.72588348388672, obj_val: 74.8516845703125, abs dis: 5.125801086425781
[rfa agg] iter: 1, weight: tensor([0.0238, 0.1913, 0.0113, 0.0353, 0.0304, 0.1581, 0.0362, 0.1940, 0.1943,
        0.1254])
[rfa agg] iter:  2, prev_obj_val: 74.8516845703125, obj_val: 77.77173614501953, abs dis: 2.9200515747070312
[rfa agg] iter: 2, weight: tensor([0.0342, 0.1301, 0.0151, 0.0536, 0.0333, 0.3396, 0.0386, 0.1305, 0.1264,
        0.0986])
[rfa agg] iter:  3, prev_obj_val: 77.77173614501953, obj_val: 77.77007293701172, abs dis: 0.0016632080078125
[rfa agg] iter: 3, weight: tensor([0.0430, 0.1161, 0.0181, 0.0705, 0.0358, 0.3526, 0.0409, 0.1164, 0.1128,
        0.0937])
[rfa agg] iter:  4, prev_obj_val: 77.77007293701172, obj_val: 84.1317138671875, abs dis: 6.361640930175781
[rfa agg] iter: 4, weight: tensor([0.0427, 0.1151, 0.0180, 0.0702, 0.0356, 0.3573, 0.0407, 0.1154, 0.1119,
        0.0930])
[rfa agg] iter:  5, prev_obj_val: 84.1317138671875, obj_val: 84.1182861328125, abs dis: 0.013427734375
[rfa agg] iter: 5, weight: tensor([0.0789, 0.1129, 0.0293, 0.1487, 0.0456, 0.2131, 0.0509, 0.1132, 0.1091,
        0.0983])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3046, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.3291, Accuracy: 0/9950 (0.0000%)
saving model
Done in 673.3324892520905 sec.
Server Epoch:65 choose agents : [61, 28, 93, 57, 72, 82, 55, 87, 88, 96].
poison local model 61 index 22 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Avg loss: 0.1295, Accuracy: 0/85 (0.0000%), train_poison_data_count: 61
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Avg loss: 0.1091, Accuracy: 8/85 (9.4118%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   3, Avg loss: 0.0833, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   4, Avg loss: 0.0777, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   5, Avg loss: 0.0713, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   6, Avg loss: 0.0666, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   7, Avg loss: 0.0595, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   8, Avg loss: 0.0546, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   9, Avg loss: 0.0504, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch  10, Avg loss: 0.0492, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Global model norm: 112.05219905249517.
Norm before scaling: 112.05155848006979. Distance: 0.25511448295817346
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.4206, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 65, Avg loss: 2.6052, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 114.8285364072777, distance: 25.511449300464218
Total norm for 3 adversaries is: 114.8285364072777. distance: 25.511449300464218
_Test Local_ResNet_18 poisoned: True, epoch: 65, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0566, Accuracy: 371/1581 (23.4662%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0341, Accuracy: 567/1581 (35.8634%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.9579, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   1, Avg loss: 0.0557, Accuracy: 410/1742 (23.5362%)
_Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 717/1742 (41.1596%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.2918, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0554, Accuracy: 288/1154 (24.9567%)
_Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0282, Accuracy: 428/1154 (37.0884%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.6005, Accuracy: 69/10000 (0.6900%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 256/1241 (20.6285%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 402/1241 (32.3932%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.3966, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0761, Accuracy: 73/500 (14.6000%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.8757, Accuracy: 49/10000 (0.4900%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   1, Avg loss: 0.0570, Accuracy: 245/1071 (22.8758%)
_Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/1071 (45.7516%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.1006, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   1, Avg loss: 0.0593, Accuracy: 287/1131 (25.3758%)
_Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 394/1131 (34.8364%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.8658, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   1, Avg loss: 0.0719, Accuracy: 149/603 (24.7098%)
_Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   2, Avg loss: 0.0452, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.0022, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   1, Avg loss: 0.0782, Accuracy: 56/311 (18.0064%)
_Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   2, Avg loss: 0.0533, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.4015, Accuracy: 50/10000 (0.5000%)
time spent on training: 346.02336740493774
[rfa agg] training data poison_ratio: 0.254485614184096  data num: [85, 1581, 1742, 1154, 1241, 500, 1071, 1131, 603, 311]
[rfa agg] considering poison per batch poison_fraction: 0.15905350886505998
[rfa agg] init. name: [61, 28, 93, 57, 72, 82, 55, 87, 88, 96], weight: tensor([0.0090, 0.1679, 0.1849, 0.1225, 0.1318, 0.0531, 0.1137, 0.1201, 0.0640,
        0.0330])
[rfa agg] iter:  0, prev_obj_val: 156.43093872070312, obj_val: 131.42234802246094, abs dis: 25.008590698242188
[rfa agg] iter: 0, weight: tensor([5.2058e-05, 2.8409e-01, 3.2270e-01, 8.9485e-02, 1.0897e-01, 1.6750e-02,
        6.7379e-02, 7.9027e-02, 2.2594e-02, 8.9562e-03])
[rfa agg] iter:  1, prev_obj_val: 131.42234802246094, obj_val: 129.3977813720703, abs dis: 2.024566650390625
[rfa agg] iter: 1, weight: tensor([3.3054e-05, 1.7740e-01, 1.0712e-01, 1.7156e-01, 2.8103e-01, 1.4889e-02,
        9.3902e-02, 1.2544e-01, 2.1070e-02, 7.5666e-03])
[rfa agg] iter:  2, prev_obj_val: 129.3977813720703, obj_val: 132.29104614257812, abs dis: 2.8932647705078125
[rfa agg] iter: 2, weight: tensor([1.9742e-05, 5.8162e-02, 4.3968e-02, 2.6500e-01, 1.7890e-01, 1.1455e-02,
        1.4828e-01, 2.7164e-01, 1.7043e-02, 5.5299e-03])
[rfa agg] iter:  3, prev_obj_val: 132.29104614257812, obj_val: 134.4478759765625, abs dis: 2.156829833984375
[rfa agg] iter: 3, weight: tensor([2.0281e-05, 5.1835e-02, 4.0913e-02, 1.6747e-01, 1.1637e-01, 1.3009e-02,
        2.6622e-01, 3.1819e-01, 1.9833e-02, 6.1356e-03])
[rfa agg] iter:  4, prev_obj_val: 134.4478759765625, obj_val: 137.04837036132812, abs dis: 2.600494384765625
[rfa agg] iter: 4, weight: tensor([2.1425e-05, 5.1416e-02, 4.1295e-02, 1.3706e-01, 1.0363e-01, 1.4508e-02,
        3.7766e-01, 2.4521e-01, 2.2448e-02, 6.7529e-03])
[rfa agg] iter:  5, prev_obj_val: 137.04837036132812, obj_val: 139.9523468017578, abs dis: 2.9039764404296875
[rfa agg] iter: 5, weight: tensor([2.4760e-05, 5.6011e-02, 4.5691e-02, 1.3032e-01, 1.0374e-01, 1.7750e-02,
        4.0703e-01, 2.0337e-01, 2.7928e-02, 8.1438e-03])
[rfa agg] iter:  6, prev_obj_val: 139.9523468017578, obj_val: 137.04884338378906, abs dis: 2.90350341796875
[rfa agg] iter: 6, weight: tensor([3.1099e-05, 6.6527e-02, 5.5046e-02, 1.3917e-01, 1.1497e-01, 2.3683e-02,
        3.5238e-01, 1.9953e-01, 3.7977e-02, 1.0692e-02])
[rfa agg] iter:  7, prev_obj_val: 137.04884338378906, obj_val: 139.95211791992188, abs dis: 2.9032745361328125
[rfa agg] iter: 7, weight: tensor([2.4886e-05, 5.6313e-02, 4.5933e-02, 1.3117e-01, 1.0444e-01, 1.7845e-02,
        4.0541e-01, 2.0260e-01, 2.8083e-02, 8.1865e-03])
[rfa agg] iter:  8, prev_obj_val: 139.95211791992188, obj_val: 137.04885864257812, abs dis: 2.90325927734375
[rfa agg] iter: 8, weight: tensor([3.1105e-05, 6.6540e-02, 5.5058e-02, 1.3921e-01, 1.1500e-01, 2.3688e-02,
        3.5223e-01, 1.9956e-01, 3.7985e-02, 1.0694e-02])
[rfa agg] iter:  9, prev_obj_val: 137.04885864257812, obj_val: 139.95211791992188, abs dis: 2.90325927734375
[rfa agg] iter: 9, weight: tensor([2.4887e-05, 5.6316e-02, 4.5936e-02, 1.3118e-01, 1.0444e-01, 1.7846e-02,
        4.0537e-01, 2.0262e-01, 2.8084e-02, 8.1869e-03])
			Update norm = 146.87266620486264 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3046, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.3291, Accuracy: 0/9950 (0.0000%)
saving model
Done in 771.7844772338867 sec.
Server Epoch:66 choose agents : [15, 18, 21, 86, 93, 71, 34, 3, 52, 47].
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   1, Avg loss: 0.0577, Accuracy: 318/1154 (27.5563%)
_Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   2, Avg loss: 0.0291, Accuracy: 435/1154 (37.6950%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1859, Accuracy: 51/10000 (0.5100%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0708, Accuracy: 134/530 (25.2830%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0367, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.5533, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   1, Avg loss: 0.0544, Accuracy: 393/1949 (20.1642%)
_Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 628/1949 (32.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.3126, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0635, Accuracy: 359/1003 (35.7926%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0348, Accuracy: 367/1003 (36.5902%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.7864, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 423/1742 (24.2824%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0322, Accuracy: 718/1742 (41.2170%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.8732, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0647, Accuracy: 164/818 (20.0489%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 353/818 (43.1540%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.8742, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   1, Avg loss: 0.0572, Accuracy: 400/1427 (28.0308%)
_Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   2, Avg loss: 0.0327, Accuracy: 610/1427 (42.7470%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.9958, Accuracy: 61/10000 (0.6100%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   1, Avg loss: 0.0735, Accuracy: 110/781 (14.0845%)
_Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   2, Avg loss: 0.0364, Accuracy: 242/781 (30.9859%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.7446, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   1, Avg loss: 0.0565, Accuracy: 290/636 (45.5975%)
_Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   2, Avg loss: 0.0319, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.7478, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   1, Avg loss: 0.1198, Accuracy: 4/134 (2.9851%)
_Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   2, Avg loss: 0.1064, Accuracy: 21/134 (15.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3264, Accuracy: 50/10000 (0.5000%)
time spent on training: 324.7119405269623
[rfa agg] training data poison_ratio: 0.24228425398073522  data num: [1154, 530, 1949, 1003, 1742, 818, 1427, 781, 636, 134]
[rfa agg] considering poison per batch poison_fraction: 0.15142765873795952
[rfa agg] init. name: [15, 18, 21, 86, 93, 71, 34, 3, 52, 47], weight: tensor([0.1134, 0.0521, 0.1916, 0.0986, 0.1712, 0.0804, 0.1403, 0.0768, 0.0625,
        0.0132])
[rfa agg] iter:  0, prev_obj_val: 64.24117279052734, obj_val: 67.16126251220703, abs dis: 2.9200897216796875
[rfa agg] iter: 0, weight: tensor([0.4265, 0.0221, 0.0618, 0.1463, 0.0726, 0.0586, 0.1231, 0.0559, 0.0296,
        0.0034])
[rfa agg] iter:  1, prev_obj_val: 67.16126251220703, obj_val: 71.20223236083984, abs dis: 4.0409698486328125
[rfa agg] iter: 1, weight: tensor([0.2360, 0.0283, 0.0595, 0.2977, 0.0677, 0.0859, 0.1003, 0.0820, 0.0387,
        0.0041])
[rfa agg] iter:  2, prev_obj_val: 71.20223236083984, obj_val: 76.88312530517578, abs dis: 5.6808929443359375
[rfa agg] iter: 2, weight: tensor([0.1220, 0.0308, 0.0477, 0.3951, 0.0529, 0.1185, 0.0717, 0.1137, 0.0436,
        0.0040])
[rfa agg] iter:  3, prev_obj_val: 76.88312530517578, obj_val: 78.8379135131836, abs dis: 1.9547882080078125
[rfa agg] iter: 3, weight: tensor([0.0863, 0.0399, 0.0436, 0.1804, 0.0473, 0.2409, 0.0600, 0.2378, 0.0594,
        0.0046])
[rfa agg] iter:  4, prev_obj_val: 78.8379135131836, obj_val: 78.8206558227539, abs dis: 0.0172576904296875
[rfa agg] iter: 4, weight: tensor([0.0629, 0.0355, 0.0338, 0.1143, 0.0365, 0.3085, 0.0455, 0.3048, 0.0543,
        0.0038])
[rfa agg] iter:  5, prev_obj_val: 78.8206558227539, obj_val: 78.82052612304688, abs dis: 0.00012969970703125
[rfa agg] iter: 5, weight: tensor([0.0610, 0.0344, 0.0328, 0.1097, 0.0354, 0.3170, 0.0441, 0.3091, 0.0527,
        0.0037])
			Update norm = 124.93715216935072 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3046, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.3291, Accuracy: 0/9950 (0.0000%)
saving model
Done in 750.8777749538422 sec.
Server Epoch:67 choose agents : [65, 12, 41, 56, 19, 23, 37, 45, 96, 9].
poison local model 65 index 23 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   1, Avg loss: 0.0485, Accuracy: 787/1475 (53.3559%), train_poison_data_count: 923
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   2, Avg loss: 0.0249, Accuracy: 901/1475 (61.0847%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   3, Avg loss: 0.0211, Accuracy: 944/1475 (64.0000%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   4, Avg loss: 0.0218, Accuracy: 939/1475 (63.6610%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   5, Avg loss: 0.0215, Accuracy: 941/1475 (63.7966%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   6, Avg loss: 0.0209, Accuracy: 945/1475 (64.0678%), train_poison_data_count: 923
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   7, Avg loss: 0.0210, Accuracy: 935/1475 (63.3898%), train_poison_data_count: 923
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   8, Avg loss: 0.0204, Accuracy: 957/1475 (64.8814%), train_poison_data_count: 923
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   9, Avg loss: 0.0201, Accuracy: 943/1475 (63.9322%), train_poison_data_count: 923
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch  10, Avg loss: 0.0205, Accuracy: 943/1475 (63.9322%), train_poison_data_count: 923
Global model norm: 112.05219905249517.
Norm before scaling: 112.02508699924093. Distance: 0.9817338358065913
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.8551, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 67, Avg loss: 0.4037, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 146.5947459196611, distance: 98.17337581416868
Total norm for 4 adversaries is: 146.5947459196611. distance: 98.17337581416868
_Test Local_ResNet_18 poisoned: True, epoch: 67, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   1, Avg loss: 0.0845, Accuracy: 26/338 (7.6923%)
_Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   2, Avg loss: 0.0459, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.5666, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   1, Avg loss: 0.0581, Accuracy: 334/719 (46.4534%)
_Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   2, Avg loss: 0.0332, Accuracy: 467/719 (64.9513%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.7202, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0680, Accuracy: 73/186 (39.2473%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3290, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0481, Accuracy: 386/1036 (37.2587%)
_Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0240, Accuracy: 713/1036 (68.8224%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.0296, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   1, Avg loss: 0.0621, Accuracy: 321/715 (44.8951%)
_Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   2, Avg loss: 0.0395, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.7902, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   1, Avg loss: 0.0523, Accuracy: 382/1129 (33.8353%)
_Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   2, Avg loss: 0.0254, Accuracy: 711/1129 (62.9761%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.9406, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   1, Avg loss: 0.0666, Accuracy: 207/669 (30.9417%)
_Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   2, Avg loss: 0.0406, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.8429, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 45/311 (14.4695%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0539, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3959, Accuracy: 50/10000 (0.5000%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   1, Avg loss: 0.0503, Accuracy: 351/1275 (27.5294%)
_Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 711/1275 (55.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.6994, Accuracy: 91/10000 (0.9100%)
time spent on training: 326.22464990615845
[rfa agg] training data poison_ratio: 0.5369922322679231  data num: [1475, 338, 719, 186, 1036, 715, 1129, 669, 311, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.335620145167452
[rfa agg] init. name: [65, 12, 41, 56, 19, 23, 37, 45, 96, 9], weight: tensor([0.1878, 0.0430, 0.0916, 0.0237, 0.1319, 0.0910, 0.1438, 0.0852, 0.0396,
        0.1624])
[rfa agg] iter:  0, prev_obj_val: 32713.86328125, obj_val: 23533.46484375, abs dis: 9180.3984375
[rfa agg] iter: 0, weight: tensor([0.0507, 0.0501, 0.1069, 0.0275, 0.1544, 0.1063, 0.1683, 0.0994, 0.0461,
        0.1902])
[rfa agg] iter:  1, prev_obj_val: 23533.46484375, obj_val: 20946.435546875, abs dis: 2587.029296875
[rfa agg] iter: 1, weight: tensor([0.0122, 0.0516, 0.1109, 0.0283, 0.1611, 0.1103, 0.1759, 0.1030, 0.0474,
        0.1993])
[rfa agg] iter:  2, prev_obj_val: 20946.435546875, obj_val: 20320.693359375, abs dis: 625.7421875
[rfa agg] iter: 2, weight: tensor([0.0028, 0.0498, 0.1104, 0.0269, 0.1647, 0.1098, 0.1808, 0.1020, 0.0456,
        0.2072])
[rfa agg] iter:  3, prev_obj_val: 20320.693359375, obj_val: 20181.98828125, abs dis: 138.705078125
[rfa agg] iter: 3, weight: tensor([0.0006, 0.0407, 0.1021, 0.0208, 0.1728, 0.1015, 0.1952, 0.0922, 0.0365,
        0.2377])
[rfa agg] iter:  4, prev_obj_val: 20181.98828125, obj_val: 20174.7265625, abs dis: 7.26171875
[rfa agg] iter: 4, weight: tensor([5.1707e-05, 9.7669e-03, 3.5374e-02, 4.4382e-03, 1.2115e-01, 3.5166e-02,
        1.7662e-01, 2.9486e-02, 8.3977e-03, 5.7955e-01])
[rfa agg] iter:  5, prev_obj_val: 20174.7265625, obj_val: 20176.837890625, abs dis: 2.111328125
[rfa agg] iter: 5, weight: tensor([4.5381e-05, 1.1272e-02, 5.2165e-02, 4.8534e-03, 3.9787e-01, 5.1756e-02,
        2.7697e-01, 4.0622e-02, 9.4953e-03, 1.5495e-01])
[rfa agg] iter:  6, prev_obj_val: 20176.837890625, obj_val: 20178.99609375, abs dis: 2.158203125
[rfa agg] iter: 6, weight: tensor([6.2810e-05, 1.8056e-02, 1.0161e-01, 7.5119e-03, 3.2476e-01, 1.0063e-01,
        2.1611e-01, 7.4570e-02, 1.5004e-02, 1.4168e-01])
[rfa agg] iter:  7, prev_obj_val: 20178.99609375, obj_val: 20181.275390625, abs dis: 2.279296875
[rfa agg] iter: 7, weight: tensor([6.9959e-05, 2.2468e-02, 1.5562e-01, 9.0848e-03, 2.2762e-01, 1.5379e-01,
        1.7660e-01, 1.0617e-01, 1.8459e-02, 1.3012e-01])
[rfa agg] iter:  8, prev_obj_val: 20181.275390625, obj_val: 20182.46484375, abs dis: 1.189453125
[rfa agg] iter: 8, weight: tensor([6.3445e-05, 2.3073e-02, 2.2217e-01, 9.0097e-03, 1.4926e-01, 2.1837e-01,
        1.2617e-01, 1.3292e-01, 1.8689e-02, 1.0026e-01])
[rfa agg] iter:  9, prev_obj_val: 20182.46484375, obj_val: 20183.7890625, abs dis: 1.32421875
[rfa agg] iter: 9, weight: tensor([5.4340e-05, 2.1167e-02, 2.6470e-01, 8.0978e-03, 1.1202e-01, 2.5912e-01,
        9.7447e-02, 1.4057e-01, 1.7001e-02, 7.9813e-02])
			Update norm = 116.13179474200852 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3046, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.3291, Accuracy: 0/9950 (0.0000%)
saving model
Done in 758.7401821613312 sec.
Server Epoch:68 choose agents : [30, 17, 54, 91, 69, 28, 65, 60, 9, 11].
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   1, Avg loss: 0.0782, Accuracy: 79/486 (16.2551%)
_Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   2, Avg loss: 0.0407, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.0856, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 405/1574 (25.7306%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 672/1574 (42.6938%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1576, Accuracy: 85/10000 (0.8500%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   1, Avg loss: 0.0553, Accuracy: 335/1130 (29.6460%)
_Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 463/1130 (40.9735%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.7409, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   1, Avg loss: 0.0528, Accuracy: 346/1030 (33.5922%)
_Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   2, Avg loss: 0.0301, Accuracy: 540/1030 (52.4272%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.9497, Accuracy: 82/10000 (0.8200%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   1, Avg loss: 0.0569, Accuracy: 285/590 (48.3051%)
_Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   2, Avg loss: 0.0289, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.0188, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   1, Avg loss: 0.0556, Accuracy: 420/1581 (26.5655%)
_Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 605/1581 (38.2669%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.7099, Accuracy: 98/10000 (0.9800%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   1, Avg loss: 0.0560, Accuracy: 412/1475 (27.9322%)
_Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   2, Avg loss: 0.0306, Accuracy: 677/1475 (45.8983%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.1676, Accuracy: 87/10000 (0.8700%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0502, Accuracy: 542/2227 (24.3377%)
_Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0285, Accuracy: 983/2227 (44.1401%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3053, Accuracy: 118/10000 (1.1800%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0500, Accuracy: 364/1275 (28.5490%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 735/1275 (57.6471%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.6393, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   1, Avg loss: 0.0532, Accuracy: 352/712 (49.4382%)
_Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 437/712 (61.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.8420, Accuracy: 50/10000 (0.5000%)
time spent on training: 367.670832157135
[rfa agg] training data poison_ratio: 0.5946192052980133  data num: [486, 1574, 1130, 1030, 590, 1581, 1475, 2227, 1275, 712]
[rfa agg] considering poison per batch poison_fraction: 0.37163700331125826
[rfa agg] init. name: [30, 17, 54, 91, 69, 28, 65, 60, 9, 11], weight: tensor([0.0402, 0.1303, 0.0935, 0.0853, 0.0488, 0.1309, 0.1221, 0.1844, 0.1055,
        0.0589])
[rfa agg] iter:  0, prev_obj_val: 60.538185119628906, obj_val: 63.5737190246582, abs dis: 3.035533905029297
[rfa agg] iter: 0, weight: tensor([0.0121, 0.0805, 0.1859, 0.1079, 0.0177, 0.0809, 0.0911, 0.0410, 0.3559,
        0.0270])
[rfa agg] iter:  1, prev_obj_val: 63.5737190246582, obj_val: 67.57108306884766, abs dis: 3.997364044189453
[rfa agg] iter: 1, weight: tensor([0.0128, 0.0665, 0.3226, 0.1541, 0.0192, 0.0669, 0.0731, 0.0375, 0.2170,
        0.0303])
[rfa agg] iter:  2, prev_obj_val: 67.57108306884766, obj_val: 72.84332275390625, abs dis: 5.272239685058594
[rfa agg] iter: 2, weight: tensor([0.0136, 0.0552, 0.3582, 0.2404, 0.0208, 0.0555, 0.0594, 0.0338, 0.1290,
        0.0341])
[rfa agg] iter:  3, prev_obj_val: 72.84332275390625, obj_val: 67.5557632446289, abs dis: 5.287559509277344
[rfa agg] iter: 3, weight: tensor([0.0189, 0.0609, 0.2299, 0.3264, 0.0299, 0.0612, 0.0644, 0.0399, 0.1168,
        0.0517])
[rfa agg] iter:  4, prev_obj_val: 67.5557632446289, obj_val: 72.82835388183594, abs dis: 5.272590637207031
[rfa agg] iter: 4, weight: tensor([0.0134, 0.0544, 0.3214, 0.2852, 0.0205, 0.0547, 0.0584, 0.0333, 0.1251,
        0.0336])
[rfa agg] iter:  5, prev_obj_val: 72.82835388183594, obj_val: 67.55850219726562, abs dis: 5.2698516845703125
[rfa agg] iter: 5, weight: tensor([0.0186, 0.0601, 0.2243, 0.3379, 0.0295, 0.0604, 0.0635, 0.0394, 0.1152,
        0.0510])
[rfa agg] iter:  6, prev_obj_val: 67.55850219726562, obj_val: 75.7859878540039, abs dis: 8.227485656738281
[rfa agg] iter: 6, weight: tensor([0.0134, 0.0544, 0.3185, 0.2886, 0.0205, 0.0547, 0.0584, 0.0333, 0.1249,
        0.0336])
[rfa agg] iter:  7, prev_obj_val: 75.7859878540039, obj_val: 70.04454040527344, abs dis: 5.741447448730469
[rfa agg] iter: 7, weight: tensor([0.0232, 0.0666, 0.2051, 0.2999, 0.0374, 0.0669, 0.0699, 0.0449, 0.1191,
        0.0670])
[rfa agg] iter:  8, prev_obj_val: 70.04454040527344, obj_val: 75.78079223632812, abs dis: 5.7362518310546875
[rfa agg] iter: 8, weight: tensor([0.0152, 0.0552, 0.2518, 0.3501, 0.0237, 0.0555, 0.0587, 0.0350, 0.1150,
        0.0398])
[rfa agg] iter:  9, prev_obj_val: 75.78079223632812, obj_val: 70.04329681396484, abs dis: 5.737495422363281
[rfa agg] iter: 9, weight: tensor([0.0230, 0.0660, 0.2007, 0.3090, 0.0371, 0.0663, 0.0692, 0.0445, 0.1179,
        0.0663])
			Update norm = 155.6193334811745 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3046, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.3291, Accuracy: 0/9950 (0.0000%)
saving model
Done in 797.210795879364 sec.
Server Epoch:69 choose agents : [69, 3, 66, 36, 78, 83, 8, 10, 93, 58].
poison local model 69 index 24 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0605, Accuracy: 216/590 (36.6102%), train_poison_data_count: 374
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0269, Accuracy: 364/590 (61.6949%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   3, Avg loss: 0.0259, Accuracy: 258/590 (43.7288%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   4, Avg loss: 0.0199, Accuracy: 363/590 (61.5254%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   5, Avg loss: 0.0230, Accuracy: 373/590 (63.2203%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   6, Avg loss: 0.0219, Accuracy: 375/590 (63.5593%), train_poison_data_count: 374
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   7, Avg loss: 0.0215, Accuracy: 374/590 (63.3898%), train_poison_data_count: 374
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   8, Avg loss: 0.0199, Accuracy: 380/590 (64.4068%), train_poison_data_count: 374
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   9, Avg loss: 0.0207, Accuracy: 375/590 (63.5593%), train_poison_data_count: 374
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch  10, Avg loss: 0.0200, Accuracy: 371/590 (62.8814%), train_poison_data_count: 374
Global model norm: 112.05219905249517.
Norm before scaling: 112.04452065752703. Distance: 0.7982867581977693
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.5872, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 69, Avg loss: 0.3354, Accuracy: 9876/9950 (99.2563%)
Scaling by  100
Scaled Norm after poisoning: 136.72106783749533, distance: 79.82867702637473
Total norm for 5 adversaries is: 136.72106783749533. distance: 79.82867702637473
_Test Local_ResNet_18 poisoned: True, epoch: 69, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   1, Avg loss: 0.0740, Accuracy: 106/781 (13.5723%)
_Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   2, Avg loss: 0.0354, Accuracy: 241/781 (30.8579%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.8459, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   1, Avg loss: 0.0628, Accuracy: 251/1402 (17.9030%)
_Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 367/1402 (26.1769%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.2378, Accuracy: 79/10000 (0.7900%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   1, Avg loss: 0.0858, Accuracy: 86/408 (21.0784%)
_Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   2, Avg loss: 0.0532, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.6359, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   1, Avg loss: 0.0838, Accuracy: 47/416 (11.2981%)
_Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   2, Avg loss: 0.0466, Accuracy: 171/416 (41.1058%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.7518, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 425/1953 (21.7614%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 774/1953 (39.6313%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8714, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   1, Avg loss: 0.0608, Accuracy: 216/1513 (14.2763%)
_Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 475/1513 (31.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.4164, Accuracy: 95/10000 (0.9500%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   1, Avg loss: 0.0566, Accuracy: 209/861 (24.2741%)
_Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   2, Avg loss: 0.0217, Accuracy: 436/861 (50.6388%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.9866, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   1, Avg loss: 0.0556, Accuracy: 435/1742 (24.9713%)
_Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 716/1742 (41.1022%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.9406, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   1, Avg loss: 0.0584, Accuracy: 350/803 (43.5866%)
_Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 378/803 (47.0735%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.0247, Accuracy: 48/10000 (0.4800%)
time spent on training: 359.57994532585144
[rfa agg] training data poison_ratio: 0.29190944693858056  data num: [590, 781, 1402, 408, 416, 1953, 1513, 861, 1742, 803]
[rfa agg] considering poison per batch poison_fraction: 0.18244340433661285
[rfa agg] init. name: [69, 3, 66, 36, 78, 83, 8, 10, 93, 58], weight: tensor([0.0564, 0.0746, 0.1339, 0.0390, 0.0397, 0.1866, 0.1445, 0.0822, 0.1664,
        0.0767])
[rfa agg] iter:  0, prev_obj_val: 4723.93408203125, obj_val: 2642.723876953125, abs dis: 2081.210205078125
[rfa agg] iter: 0, weight: tensor([0.0035, 0.0763, 0.1414, 0.0391, 0.0398, 0.2036, 0.1537, 0.0844, 0.1796,
        0.0785])
[rfa agg] iter:  1, prev_obj_val: 2642.723876953125, obj_val: 2571.991943359375, abs dis: 70.73193359375
[rfa agg] iter: 1, weight: tensor([1.4769e-04, 3.9629e-02, 1.1208e-01, 1.6627e-02, 1.6955e-02, 3.6386e-01,
        1.3862e-01, 4.5543e-02, 2.2578e-01, 4.0755e-02])
[rfa agg] iter:  2, prev_obj_val: 2571.991943359375, obj_val: 2576.248779296875, abs dis: 4.2568359375
[rfa agg] iter: 2, weight: tensor([3.8735e-05, 2.3183e-02, 2.0332e-01, 7.8491e-03, 8.0033e-03, 9.0853e-02,
        4.7572e-01, 2.8097e-02, 1.3909e-01, 2.3845e-02])
[rfa agg] iter:  3, prev_obj_val: 2576.248779296875, obj_val: 2577.664794921875, abs dis: 1.416015625
[rfa agg] iter: 3, weight: tensor([5.1367e-05, 4.2153e-02, 4.2992e-01, 1.2634e-02, 1.2880e-02, 8.4336e-02,
        2.1465e-01, 5.2975e-02, 1.0705e-01, 4.3350e-02])
			Update norm = 186.38924115610857 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3046, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.3291, Accuracy: 0/9950 (0.0000%)
saving model
Done in 785.8608384132385 sec.
Server Epoch:70 choose agents : [22, 18, 31, 35, 88, 66, 36, 14, 27, 48].
_Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 523/1470 (35.5782%)
_Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 854/1470 (58.0952%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.4363, Accuracy: 90/10000 (0.9000%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   1, Avg loss: 0.0720, Accuracy: 136/530 (25.6604%)
_Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   2, Avg loss: 0.0367, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.4854, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   1, Avg loss: 0.0838, Accuracy: 56/460 (12.1739%)
_Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   2, Avg loss: 0.0371, Accuracy: 189/460 (41.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.0070, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   1, Avg loss: 0.0858, Accuracy: 35/271 (12.9151%)
_Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   2, Avg loss: 0.0571, Accuracy: 104/271 (38.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.4274, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.0722, Accuracy: 157/603 (26.0365%)
_Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0449, Accuracy: 278/603 (46.1028%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.0788, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 257/1402 (18.3310%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 401/1402 (28.6020%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.4461, Accuracy: 66/10000 (0.6600%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.0872, Accuracy: 78/408 (19.1176%)
_Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0539, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.5863, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 220/1013 (21.7177%)
_Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   2, Avg loss: 0.0350, Accuracy: 331/1013 (32.6752%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.6707, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 442/1587 (27.8513%)
_Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 612/1587 (38.5633%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.4250, Accuracy: 67/10000 (0.6700%)
poison local model 48 index 17 
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0715, Accuracy: 100/631 (15.8479%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0414, Accuracy: 223/631 (35.3407%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.9303, Accuracy: 50/10000 (0.5000%)
time spent on training: 272.5044324398041
[rfa agg] training data poison_ratio: 0.18734328358208954  data num: [1470, 530, 460, 271, 603, 1402, 408, 1013, 1587, 631]
[rfa agg] considering poison per batch poison_fraction: 0.11708955223880596
[rfa agg] init. name: [22, 18, 31, 35, 88, 66, 36, 14, 27, 48], weight: tensor([0.1755, 0.0633, 0.0549, 0.0324, 0.0720, 0.1674, 0.0487, 0.1210, 0.1895,
        0.0753])
[rfa agg] iter:  0, prev_obj_val: 61.5223503112793, obj_val: 64.10531616210938, abs dis: 2.582965850830078
[rfa agg] iter: 0, weight: tensor([0.1008, 0.0485, 0.0361, 0.0149, 0.0661, 0.1098, 0.0280, 0.4394, 0.0873,
        0.0691])
[rfa agg] iter:  1, prev_obj_val: 64.10531616210938, obj_val: 66.8204345703125, abs dis: 2.715118408203125
[rfa agg] iter: 1, weight: tensor([0.1050, 0.0678, 0.0492, 0.0193, 0.0965, 0.1127, 0.0375, 0.3184, 0.0930,
        0.1006])
[rfa agg] iter:  2, prev_obj_val: 66.8204345703125, obj_val: 69.57003784179688, abs dis: 2.749603271484375
[rfa agg] iter: 2, weight: tensor([0.0981, 0.0876, 0.0612, 0.0225, 0.1326, 0.1040, 0.0453, 0.2223, 0.0884,
        0.1381])
[rfa agg] iter:  3, prev_obj_val: 69.57003784179688, obj_val: 73.8868637084961, abs dis: 4.316825866699219
[rfa agg] iter: 3, weight: tensor([0.0809, 0.1051, 0.0691, 0.0233, 0.1777, 0.0849, 0.0491, 0.1519, 0.0740,
        0.1840])
[rfa agg] iter:  4, prev_obj_val: 73.8868637084961, obj_val: 83.8990707397461, abs dis: 10.01220703125
[rfa agg] iter: 4, weight: tensor([0.0399, 0.1119, 0.0611, 0.0165, 0.3007, 0.0414, 0.0390, 0.0621, 0.0372,
        0.2902])
[rfa agg] iter:  5, prev_obj_val: 83.8990707397461, obj_val: 87.15547943115234, abs dis: 3.25640869140625
[rfa agg] iter: 5, weight: tensor([0.0352, 0.2412, 0.2181, 0.0260, 0.1355, 0.0361, 0.0876, 0.0468, 0.0335,
        0.1398])
[rfa agg] iter:  6, prev_obj_val: 87.15547943115234, obj_val: 94.59891510009766, abs dis: 7.4434356689453125
[rfa agg] iter: 6, weight: tensor([0.0316, 0.1572, 0.3705, 0.0281, 0.0948, 0.0323, 0.1169, 0.0407, 0.0301,
        0.0978])
[rfa agg] iter:  7, prev_obj_val: 94.59891510009766, obj_val: 98.6153335571289, abs dis: 4.01641845703125
[rfa agg] iter: 7, weight: tensor([0.0377, 0.1060, 0.1802, 0.0515, 0.0814, 0.0383, 0.3382, 0.0460, 0.0362,
        0.0846])
[rfa agg] iter:  8, prev_obj_val: 98.6153335571289, obj_val: 90.7716293334961, abs dis: 7.8437042236328125
[rfa agg] iter: 8, weight: tensor([0.0436, 0.1021, 0.1453, 0.0790, 0.0837, 0.0443, 0.3210, 0.0521, 0.0420,
        0.0870])
[rfa agg] iter:  9, prev_obj_val: 90.7716293334961, obj_val: 90.76351928710938, abs dis: 0.00811004638671875
[rfa agg] iter: 9, weight: tensor([0.0353, 0.1253, 0.2631, 0.0388, 0.0883, 0.0360, 0.2437, 0.0443, 0.0338,
        0.0913])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 706.2901675701141 sec.
Server Epoch:71 choose agents : [72, 77, 92, 31, 46, 66, 54, 0, 25, 36].
poison local model 72 index 25 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   1, Avg loss: 0.0527, Accuracy: 628/1241 (50.6044%), train_poison_data_count: 785
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   2, Avg loss: 0.0271, Accuracy: 750/1241 (60.4351%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   3, Avg loss: 0.0244, Accuracy: 786/1241 (63.3360%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   4, Avg loss: 0.0240, Accuracy: 784/1241 (63.1749%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   5, Avg loss: 0.0244, Accuracy: 784/1241 (63.1749%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   6, Avg loss: 0.0240, Accuracy: 784/1241 (63.1749%), train_poison_data_count: 785
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   7, Avg loss: 0.0236, Accuracy: 786/1241 (63.3360%), train_poison_data_count: 785
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   8, Avg loss: 0.0238, Accuracy: 786/1241 (63.3360%), train_poison_data_count: 785
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   9, Avg loss: 0.0230, Accuracy: 786/1241 (63.3360%), train_poison_data_count: 785
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch  10, Avg loss: 0.0231, Accuracy: 783/1241 (63.0943%), train_poison_data_count: 785
Global model norm: 112.05150618828155.
Norm before scaling: 112.0295589133176. Distance: 0.9232980122564142
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.7594, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 71, Avg loss: 0.4053, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 143.1901598399834, distance: 92.32979484232054
Total norm for 5 adversaries is: 143.1901598399834. distance: 92.32979484232054
_Test Local_ResNet_18 poisoned: True, epoch: 71, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 311/1340 (23.2090%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 531/1340 (39.6269%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.5912, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 439/1715 (25.5977%)
_Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 713/1715 (41.5743%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.8285, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   1, Avg loss: 0.0803, Accuracy: 66/460 (14.3478%)
_Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   2, Avg loss: 0.0357, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.9951, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 415/1904 (21.7962%)
_Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 677/1904 (35.5567%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.3844, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   1, Avg loss: 0.0627, Accuracy: 252/1402 (17.9743%)
_Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   2, Avg loss: 0.0393, Accuracy: 348/1402 (24.8217%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.2465, Accuracy: 76/10000 (0.7600%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 339/1130 (30.0000%)
_Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 485/1130 (42.9204%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.1168, Accuracy: 65/10000 (0.6500%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 362/1657 (21.8467%)
_Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 534/1657 (32.2269%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.8154, Accuracy: 83/10000 (0.8300%)
poison local model 25 index 10 
_Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 310/690 (44.9275%)
_Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.7623, Accuracy: 51/10000 (0.5100%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   1, Avg loss: 0.0839, Accuracy: 98/408 (24.0196%)
_Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   2, Avg loss: 0.0545, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.6209, Accuracy: 50/10000 (0.5000%)
time spent on training: 400.0445213317871
[rfa agg] training data poison_ratio: 0.4290616891269775  data num: [1241, 1340, 1715, 460, 1904, 1402, 1130, 1657, 690, 408]
[rfa agg] considering poison per batch poison_fraction: 0.26816355570436096
[rfa agg] init. name: [72, 77, 92, 31, 46, 66, 54, 0, 25, 36], weight: tensor([0.1039, 0.1122, 0.1436, 0.0385, 0.1594, 0.1174, 0.0946, 0.1387, 0.0578,
        0.0342])
[rfa agg] iter:  0, prev_obj_val: 16608.9609375, obj_val: 10191.740234375, abs dis: 6417.220703125
[rfa agg] iter: 0, weight: tensor([0.0132, 0.1233, 0.1588, 0.0418, 0.1768, 0.1292, 0.1037, 0.1533, 0.0629,
        0.0371])
[rfa agg] iter:  1, prev_obj_val: 10191.740234375, obj_val: 9369.5185546875, abs dis: 822.2216796875
[rfa agg] iter: 1, weight: tensor([0.0015, 0.1233, 0.1654, 0.0385, 0.1882, 0.1300, 0.1017, 0.1585, 0.0590,
        0.0339])
[rfa agg] iter:  2, prev_obj_val: 9369.5185546875, obj_val: 9318.515625, abs dis: 51.0029296875
[rfa agg] iter: 2, weight: tensor([1.2040e-04, 8.9124e-02, 1.9347e-01, 1.6166e-02, 3.2996e-01, 1.0007e-01,
        6.2343e-02, 1.6770e-01, 2.7219e-02, 1.3833e-02])
[rfa agg] iter:  3, prev_obj_val: 9318.515625, obj_val: 9320.07421875, abs dis: 1.55859375
[rfa agg] iter: 3, weight: tensor([4.2484e-05, 1.4348e-01, 1.8508e-01, 9.8093e-03, 1.0767e-01, 2.0671e-01,
        6.3433e-02, 2.5749e-01, 1.8097e-02, 8.1871e-03])
[rfa agg] iter:  4, prev_obj_val: 9320.07421875, obj_val: 9323.779296875, abs dis: 3.705078125
[rfa agg] iter: 4, weight: tensor([3.6389e-05, 2.1247e-01, 1.0879e-01, 9.2703e-03, 7.3705e-02, 3.6378e-01,
        7.1639e-02, 1.3511e-01, 1.7515e-02, 7.6904e-03])
[rfa agg] iter:  5, prev_obj_val: 9323.779296875, obj_val: 9327.919921875, abs dis: 4.140625
[rfa agg] iter: 5, weight: tensor([3.3671e-05, 3.5401e-01, 7.6029e-02, 9.5634e-03, 5.6941e-02, 2.9244e-01,
        9.6321e-02, 8.8180e-02, 1.8616e-02, 7.8736e-03])
[rfa agg] iter:  6, prev_obj_val: 9327.919921875, obj_val: 9327.9033203125, abs dis: 0.0166015625
[rfa agg] iter: 6, weight: tensor([4.1189e-05, 3.4219e-01, 8.0021e-02, 1.2671e-02, 6.2776e-02, 2.0907e-01,
        1.6740e-01, 9.0186e-02, 2.5281e-02, 1.0368e-02])
[rfa agg] iter:  7, prev_obj_val: 9327.9033203125, obj_val: 9330.2607421875, abs dis: 2.357421875
[rfa agg] iter: 7, weight: tensor([4.1028e-05, 3.4573e-01, 7.9752e-02, 1.2625e-02, 6.2548e-02, 2.0404e-01,
        1.6990e-01, 8.9844e-02, 2.5192e-02, 1.0330e-02])
			Update norm = 177.15236093367483 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 825.5300395488739 sec.
Server Epoch:72 choose agents : [7, 99, 12, 11, 10, 15, 85, 26, 14, 29].
_Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0532, Accuracy: 345/891 (38.7205%)
_Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 457/891 (51.2907%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.1530, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0623, Accuracy: 182/773 (23.5446%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0349, Accuracy: 400/773 (51.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.1830, Accuracy: 57/10000 (0.5700%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   1, Avg loss: 0.0843, Accuracy: 34/338 (10.0592%)
_Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   2, Avg loss: 0.0462, Accuracy: 137/338 (40.5325%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.6102, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   1, Avg loss: 0.0521, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   2, Avg loss: 0.0270, Accuracy: 439/712 (61.6573%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.8063, Accuracy: 51/10000 (0.5100%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 202/861 (23.4611%)
_Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 463/861 (53.7747%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2170, Accuracy: 51/10000 (0.5100%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   1, Avg loss: 0.0575, Accuracy: 330/1154 (28.5962%)
_Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 420/1154 (36.3951%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.3899, Accuracy: 53/10000 (0.5300%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   1, Avg loss: 0.0543, Accuracy: 436/1988 (21.9316%)
_Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 630/1988 (31.6901%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.6884, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   1, Avg loss: 0.0553, Accuracy: 349/1446 (24.1355%)
_Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 518/1446 (35.8230%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.3686, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   1, Avg loss: 0.0619, Accuracy: 216/1013 (21.3228%)
_Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 310/1013 (30.6022%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.7558, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 405/1440 (28.1250%)
_Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 659/1440 (45.7639%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.7990, Accuracy: 73/10000 (0.7300%)
time spent on training: 274.46800351142883
[rfa agg] training data poison_ratio: 0.4089110776186888  data num: [891, 773, 338, 712, 861, 1154, 1988, 1446, 1013, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.2555694235116805
[rfa agg] init. name: [7, 99, 12, 11, 10, 15, 85, 26, 14, 29], weight: tensor([0.0839, 0.0728, 0.0318, 0.0671, 0.0811, 0.1087, 0.1873, 0.1362, 0.0954,
        0.1356])
[rfa agg] iter:  0, prev_obj_val: 55.450408935546875, obj_val: 57.367122650146484, abs dis: 1.9167137145996094
[rfa agg] iter: 0, weight: tensor([0.0787, 0.0555, 0.0102, 0.0428, 0.0769, 0.3076, 0.0515, 0.1029, 0.1706,
        0.1032])
[rfa agg] iter:  1, prev_obj_val: 57.367122650146484, obj_val: 62.607086181640625, abs dis: 5.239963531494141
[rfa agg] iter: 1, weight: tensor([0.1052, 0.0683, 0.0102, 0.0496, 0.1042, 0.1406, 0.0407, 0.0697, 0.3418,
        0.0697])
[rfa agg] iter:  2, prev_obj_val: 62.607086181640625, obj_val: 64.46382904052734, abs dis: 1.8567428588867188
[rfa agg] iter: 2, weight: tensor([0.2156, 0.1190, 0.0102, 0.0705, 0.2414, 0.0648, 0.0293, 0.0436, 0.1622,
        0.0435])
[rfa agg] iter:  3, prev_obj_val: 64.46382904052734, obj_val: 73.2607421875, abs dis: 8.796913146972656
[rfa agg] iter: 3, weight: tensor([0.2429, 0.1378, 0.0091, 0.0726, 0.2927, 0.0491, 0.0239, 0.0346, 0.1027,
        0.0345])
[rfa agg] iter:  4, prev_obj_val: 73.2607421875, obj_val: 73.20055389404297, abs dis: 0.06018829345703125
[rfa agg] iter: 4, weight: tensor([0.1448, 0.2485, 0.0141, 0.2186, 0.1460, 0.0480, 0.0279, 0.0375, 0.0772,
        0.0374])
[rfa agg] iter:  5, prev_obj_val: 73.20055389404297, obj_val: 80.7220458984375, abs dis: 7.521492004394531
[rfa agg] iter: 5, weight: tensor([0.1355, 0.2601, 0.0135, 0.2362, 0.1363, 0.0460, 0.0267, 0.0359, 0.0740,
        0.0358])
[rfa agg] iter:  6, prev_obj_val: 80.7220458984375, obj_val: 67.02986145019531, abs dis: 13.692184448242188
[rfa agg] iter: 6, weight: tensor([0.1186, 0.1688, 0.0213, 0.3209, 0.1166, 0.0536, 0.0341, 0.0440, 0.0780,
        0.0439])
[rfa agg] iter:  7, prev_obj_val: 67.02986145019531, obj_val: 76.86137390136719, abs dis: 9.831512451171875
[rfa agg] iter: 7, weight: tensor([0.2057, 0.2160, 0.0105, 0.1051, 0.2281, 0.0483, 0.0251, 0.0354, 0.0904,
        0.0353])
[rfa agg] iter:  8, prev_obj_val: 76.86137390136719, obj_val: 76.80392456054688, abs dis: 0.0574493408203125
[rfa agg] iter: 8, weight: tensor([0.1249, 0.1979, 0.0168, 0.3041, 0.1236, 0.0492, 0.0299, 0.0394, 0.0749,
        0.0393])
[rfa agg] iter:  9, prev_obj_val: 76.80392456054688, obj_val: 76.79906463623047, abs dis: 0.00485992431640625
[rfa agg] iter: 9, weight: tensor([0.1131, 0.1798, 0.0154, 0.3657, 0.1122, 0.0452, 0.0275, 0.0362, 0.0688,
        0.0361])
			Update norm = 111.33105368954791 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 685.7506980895996 sec.
Server Epoch:73 choose agents : [74, 81, 71, 96, 73, 8, 10, 55, 33, 35].
poison local model 74 index 26 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   1, Avg loss: 0.0449, Accuracy: 803/1552 (51.7397%), train_poison_data_count: 976
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   2, Avg loss: 0.0203, Accuracy: 955/1552 (61.5335%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   3, Avg loss: 0.0184, Accuracy: 970/1552 (62.5000%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   4, Avg loss: 0.0180, Accuracy: 975/1552 (62.8222%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   5, Avg loss: 0.0180, Accuracy: 976/1552 (62.8866%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   6, Avg loss: 0.0177, Accuracy: 969/1552 (62.4356%), train_poison_data_count: 976
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   7, Avg loss: 0.0175, Accuracy: 976/1552 (62.8866%), train_poison_data_count: 976
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   8, Avg loss: 0.0176, Accuracy: 977/1552 (62.9510%), train_poison_data_count: 976
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   9, Avg loss: 0.0170, Accuracy: 979/1552 (63.0799%), train_poison_data_count: 976
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch  10, Avg loss: 0.0171, Accuracy: 977/1552 (62.9510%), train_poison_data_count: 976
Global model norm: 112.05150618828155.
Norm before scaling: 112.02435473899192. Distance: 1.0568424391735995
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.0735, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 73, Avg loss: 0.4300, Accuracy: 9932/9950 (99.8191%)
Scaling by  100
Scaled Norm after poisoning: 151.67314260441762, distance: 105.68424281645538
Total norm for 5 adversaries is: 151.67314260441762. distance: 105.68424281645538
_Test Local_ResNet_18 poisoned: True, epoch: 73, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0657, Accuracy: 241/774 (31.1370%)
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0394, Accuracy: 289/774 (37.3385%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.4377, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0651, Accuracy: 154/818 (18.8264%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0316, Accuracy: 322/818 (39.3643%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.4527, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.0780, Accuracy: 48/311 (15.4341%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0532, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.4084, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   1, Avg loss: 0.0660, Accuracy: 174/938 (18.5501%)
_Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 310/938 (33.0490%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3649, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 240/1513 (15.8625%)
_Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 477/1513 (31.5268%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.9539, Accuracy: 95/10000 (0.9500%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0562, Accuracy: 211/861 (24.5064%)
_Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 455/861 (52.8455%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.1834, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   1, Avg loss: 0.0560, Accuracy: 250/1071 (23.3427%)
_Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   2, Avg loss: 0.0297, Accuracy: 473/1071 (44.1643%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.1315, Accuracy: 57/10000 (0.5700%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0810, Accuracy: 67/515 (13.0097%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0522, Accuracy: 114/515 (22.1359%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.7818, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   1, Avg loss: 0.0860, Accuracy: 32/271 (11.8081%)
_Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   2, Avg loss: 0.0577, Accuracy: 108/271 (39.8524%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.4400, Accuracy: 50/10000 (0.5000%)
time spent on training: 342.45729207992554
[rfa agg] training data poison_ratio: 0.5534554730983302  data num: [1552, 774, 818, 311, 938, 1513, 861, 1071, 515, 271]
[rfa agg] considering poison per batch poison_fraction: 0.3459096706864564
[rfa agg] init. name: [74, 81, 71, 96, 73, 8, 10, 55, 33, 35], weight: tensor([0.1800, 0.0897, 0.0949, 0.0361, 0.1088, 0.1754, 0.0998, 0.1242, 0.0597,
        0.0314])
[rfa agg] iter:  0, prev_obj_val: 32962.53515625, obj_val: 23369.20703125, abs dis: 9593.328125
[rfa agg] iter: 0, weight: tensor([0.0459, 0.1043, 0.1102, 0.0418, 0.1265, 0.2049, 0.1161, 0.1446, 0.0693,
        0.0364])
[rfa agg] iter:  1, prev_obj_val: 23369.20703125, obj_val: 20831.99609375, abs dis: 2537.2109375
[rfa agg] iter: 1, weight: tensor([0.0104, 0.1078, 0.1140, 0.0427, 0.1312, 0.2149, 0.1202, 0.1503, 0.0713,
        0.0372])
[rfa agg] iter:  2, prev_obj_val: 20831.99609375, obj_val: 20250.736328125, abs dis: 581.259765625
[rfa agg] iter: 2, weight: tensor([0.0022, 0.1070, 0.1131, 0.0405, 0.1317, 0.2285, 0.1199, 0.1528, 0.0690,
        0.0353])
[rfa agg] iter:  3, prev_obj_val: 20250.736328125, obj_val: 20142.076171875, abs dis: 108.66015625
[rfa agg] iter: 3, weight: tensor([0.0004, 0.0951, 0.1005, 0.0297, 0.1241, 0.3058, 0.1097, 0.1535, 0.0554,
        0.0259])
[rfa agg] iter:  4, prev_obj_val: 20142.076171875, obj_val: 20135.87890625, abs dis: 6.197265625
[rfa agg] iter: 4, weight: tensor([8.6821e-05, 8.2526e-02, 8.7359e-02, 1.4922e-02, 1.4357e-01, 2.3162e-01,
        1.0839e-01, 2.8436e-01, 3.4157e-02, 1.3006e-02])
[rfa agg] iter:  5, prev_obj_val: 20135.87890625, obj_val: 20136.48046875, abs dis: 0.6015625
[rfa agg] iter: 5, weight: tensor([4.2653e-05, 7.3923e-02, 7.8612e-02, 9.2299e-03, 1.9196e-01, 6.8801e-02,
        1.1361e-01, 4.3234e-01, 2.3437e-02, 8.0456e-03])
[rfa agg] iter:  6, prev_obj_val: 20136.48046875, obj_val: 20140.998046875, abs dis: 4.517578125
[rfa agg] iter: 6, weight: tensor([3.3637e-05, 1.2167e-01, 1.3271e-01, 8.7895e-03, 2.8408e-01, 4.2857e-02,
        2.6381e-01, 1.1332e-01, 2.5073e-02, 7.6629e-03])
[rfa agg] iter:  7, prev_obj_val: 20140.998046875, obj_val: 20143.630859375, abs dis: 2.6328125
[rfa agg] iter: 7, weight: tensor([3.0446e-05, 2.4945e-01, 3.1031e-01, 9.4295e-03, 1.1031e-01, 3.3552e-02,
        1.8348e-01, 6.4173e-02, 3.1043e-02, 8.2218e-03])
[rfa agg] iter:  8, prev_obj_val: 20143.630859375, obj_val: 20146.7265625, abs dis: 3.095703125
[rfa agg] iter: 8, weight: tensor([3.5390e-05, 2.6474e-01, 3.1461e-01, 1.1683e-02, 1.0280e-01, 3.7319e-02,
        1.5102e-01, 6.6512e-02, 4.1087e-02, 1.0188e-02])
[rfa agg] iter:  9, prev_obj_val: 20146.7265625, obj_val: 20140.91015625, abs dis: 5.81640625
[rfa agg] iter: 9, weight: tensor([4.6596e-05, 2.4304e-01, 2.6945e-01, 1.6458e-02, 1.1407e-01, 4.7109e-02,
        1.5366e-01, 7.9105e-02, 6.2706e-02, 1.4353e-02])
			Update norm = 119.87873104204098 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 763.6148734092712 sec.
Server Epoch:74 choose agents : [50, 33, 10, 20, 28, 37, 46, 27, 93, 60].
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0625, Accuracy: 157/809 (19.4067%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 364/809 (44.9938%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.4237, Accuracy: 76/10000 (0.7600%)
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   1, Avg loss: 0.0793, Accuracy: 69/515 (13.3981%)
_Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   2, Avg loss: 0.0509, Accuracy: 119/515 (23.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.8574, Accuracy: 44/10000 (0.4400%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   1, Avg loss: 0.0562, Accuracy: 215/861 (24.9710%)
_Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 462/861 (53.6585%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.3319, Accuracy: 51/10000 (0.5100%)
poison local model 20 index 8 
_Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   1, Avg loss: 0.0564, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   2, Avg loss: 0.0315, Accuracy: 422/807 (52.2924%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.2718, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0568, Accuracy: 403/1581 (25.4902%)
_Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0341, Accuracy: 568/1581 (35.9266%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6272, Accuracy: 88/10000 (0.8800%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0524, Accuracy: 418/1129 (37.0239%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0248, Accuracy: 747/1129 (66.1647%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.8968, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   1, Avg loss: 0.0547, Accuracy: 407/1904 (21.3761%)
_Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 683/1904 (35.8718%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.7832, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 449/1587 (28.2924%)
_Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 618/1587 (38.9414%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.2008, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 427/1742 (24.5121%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 708/1742 (40.6429%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.9473, Accuracy: 101/10000 (1.0100%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 534/2227 (23.9784%)
_Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1017/2227 (45.6668%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.0882, Accuracy: 127/10000 (1.2700%)
time spent on training: 311.5582547187805
[rfa agg] training data poison_ratio: 0.4208327001975384  data num: [809, 515, 861, 807, 1581, 1129, 1904, 1587, 1742, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.2630204376234615
[rfa agg] init. name: [50, 33, 10, 20, 28, 37, 46, 27, 93, 60], weight: tensor([0.0615, 0.0391, 0.0654, 0.0613, 0.1201, 0.0858, 0.1447, 0.1206, 0.1324,
        0.1692])
[rfa agg] iter:  0, prev_obj_val: 66.54830932617188, obj_val: 66.51797485351562, abs dis: 0.03033447265625
[rfa agg] iter: 0, weight: tensor([0.0391, 0.0172, 0.0467, 0.0389, 0.2183, 0.1187, 0.1030, 0.2192, 0.1245,
        0.0745])
[rfa agg] iter:  1, prev_obj_val: 66.51797485351562, obj_val: 64.90181732177734, abs dis: 1.6161575317382812
[rfa agg] iter: 1, weight: tensor([0.0389, 0.0172, 0.0465, 0.0387, 0.2195, 0.1183, 0.1025, 0.2204, 0.1240,
        0.0741])
[rfa agg] iter:  2, prev_obj_val: 64.90181732177734, obj_val: 68.157958984375, abs dis: 3.2561416625976562
[rfa agg] iter: 2, weight: tensor([0.0341, 0.0153, 0.0406, 0.0340, 0.2398, 0.0981, 0.1012, 0.2407, 0.1249,
        0.0714])
[rfa agg] iter:  3, prev_obj_val: 68.157958984375, obj_val: 64.90579223632812, abs dis: 3.252166748046875
[rfa agg] iter: 3, weight: tensor([0.0434, 0.0189, 0.0523, 0.0433, 0.2010, 0.1409, 0.1019, 0.2018, 0.1211,
        0.0753])
[rfa agg] iter:  4, prev_obj_val: 64.90579223632812, obj_val: 68.15788269042969, abs dis: 3.2520904541015625
[rfa agg] iter: 4, weight: tensor([0.0342, 0.0153, 0.0406, 0.0340, 0.2394, 0.0983, 0.1013, 0.2404, 0.1250,
        0.0714])
[rfa agg] iter:  5, prev_obj_val: 68.15788269042969, obj_val: 64.90579223632812, abs dis: 3.2520904541015625
[rfa agg] iter: 5, weight: tensor([0.0434, 0.0189, 0.0523, 0.0433, 0.2010, 0.1409, 0.1019, 0.2018, 0.1211,
        0.0753])
[rfa agg] iter:  6, prev_obj_val: 64.90579223632812, obj_val: 68.15788269042969, abs dis: 3.2520904541015625
[rfa agg] iter: 6, weight: tensor([0.0342, 0.0153, 0.0406, 0.0340, 0.2394, 0.0983, 0.1013, 0.2404, 0.1250,
        0.0714])
[rfa agg] iter:  7, prev_obj_val: 68.15788269042969, obj_val: 64.90579223632812, abs dis: 3.2520904541015625
[rfa agg] iter: 7, weight: tensor([0.0434, 0.0189, 0.0523, 0.0433, 0.2010, 0.1409, 0.1019, 0.2018, 0.1211,
        0.0753])
[rfa agg] iter:  8, prev_obj_val: 64.90579223632812, obj_val: 68.15788269042969, abs dis: 3.2520904541015625
[rfa agg] iter: 8, weight: tensor([0.0342, 0.0153, 0.0406, 0.0340, 0.2394, 0.0983, 0.1013, 0.2404, 0.1250,
        0.0714])
[rfa agg] iter:  9, prev_obj_val: 68.15788269042969, obj_val: 64.90579223632812, abs dis: 3.2520904541015625
[rfa agg] iter: 9, weight: tensor([0.0434, 0.0189, 0.0523, 0.0433, 0.2010, 0.1409, 0.1019, 0.2018, 0.1211,
        0.0753])
			Update norm = 203.60009823180343 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 716.1756818294525 sec.
Server Epoch:75 choose agents : [78, 51, 85, 6, 92, 32, 29, 40, 95, 74].
poison local model 78 index 27 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   1, Avg loss: 0.0750, Accuracy: 118/416 (28.3654%), train_poison_data_count: 272
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   2, Avg loss: 0.0387, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   3, Avg loss: 0.0418, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   4, Avg loss: 0.0387, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   5, Avg loss: 0.0359, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   6, Avg loss: 0.0330, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   7, Avg loss: 0.0285, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   8, Avg loss: 0.0281, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   9, Avg loss: 0.0262, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch  10, Avg loss: 0.0269, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Global model norm: 112.05150618828155.
Norm before scaling: 112.04601541470585. Distance: 0.5545563341251755
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.9688, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 75, Avg loss: 0.2911, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 124.40745493639037, distance: 55.455634452940174
Total norm for 4 adversaries is: 124.40745493639037. distance: 55.455634452940174
_Test Local_ResNet_18 poisoned: True, epoch: 75, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   1, Avg loss: 0.0599, Accuracy: 230/1049 (21.9256%)
_Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 518/1049 (49.3804%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.7463, Accuracy: 93/10000 (0.9300%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 448/1988 (22.5352%)
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 679/1988 (34.1549%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.4920, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   1, Avg loss: 0.0550, Accuracy: 392/1956 (20.0409%)
_Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   2, Avg loss: 0.0325, Accuracy: 627/1956 (32.0552%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2671, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   1, Avg loss: 0.0524, Accuracy: 441/1715 (25.7143%)
_Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 681/1715 (39.7085%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.6928, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   1, Avg loss: 0.0608, Accuracy: 202/735 (27.4830%)
_Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 344/735 (46.8027%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.3496, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   1, Avg loss: 0.0488, Accuracy: 429/1440 (29.7917%)
_Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 668/1440 (46.3889%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.1163, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0551, Accuracy: 382/1573 (24.2848%)
_Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 589/1573 (37.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.5425, Accuracy: 77/10000 (0.7700%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   1, Avg loss: 0.0499, Accuracy: 356/599 (59.4324%)
_Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   2, Avg loss: 0.0289, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.4236, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 511/1552 (32.9253%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0217, Accuracy: 761/1552 (49.0335%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.9545, Accuracy: 85/10000 (0.8500%)
time spent on training: 376.56945848464966
[rfa agg] training data poison_ratio: 0.3497657989710512  data num: [416, 1049, 1988, 1956, 1715, 735, 1440, 1573, 599, 1552]
[rfa agg] considering poison per batch poison_fraction: 0.218603624356907
[rfa agg] init. name: [78, 51, 85, 6, 92, 32, 29, 40, 95, 74], weight: tensor([0.0319, 0.0805, 0.1527, 0.1502, 0.1317, 0.0564, 0.1106, 0.1208, 0.0460,
        0.1192])
[rfa agg] iter:  0, prev_obj_val: 1912.296630859375, obj_val: 1042.1024169921875, abs dis: 870.1942138671875
[rfa agg] iter: 0, weight: tensor([0.0011, 0.0773, 0.1678, 0.1635, 0.1381, 0.0519, 0.1118, 0.1243, 0.0416,
        0.1227])
[rfa agg] iter:  1, prev_obj_val: 1042.1024169921875, obj_val: 1044.113037109375, abs dis: 2.0106201171875
[rfa agg] iter: 1, weight: tensor([2.6520e-05, 2.3216e-02, 8.6424e-02, 1.0516e-01, 3.7875e-01, 1.0888e-02,
        7.7005e-02, 1.5652e-01, 7.8300e-03, 1.5418e-01])
[rfa agg] iter:  2, prev_obj_val: 1044.113037109375, obj_val: 1047.8525390625, abs dis: 3.739501953125
[rfa agg] iter: 2, weight: tensor([2.6387e-05, 3.2850e-02, 5.4491e-02, 6.1187e-02, 1.2349e-01, 1.3547e-02,
        2.0328e-01, 2.5328e-01, 9.4638e-03, 2.4838e-01])
[rfa agg] iter:  3, prev_obj_val: 1047.8525390625, obj_val: 1052.7294921875, abs dis: 4.876953125
[rfa agg] iter: 3, weight: tensor([2.9849e-05, 4.3283e-02, 5.4914e-02, 6.0714e-02, 1.0438e-01, 1.6717e-02,
        3.4747e-01, 1.8157e-01, 1.1531e-02, 1.7939e-01])
[rfa agg] iter:  4, prev_obj_val: 1052.7294921875, obj_val: 1055.420654296875, abs dis: 2.691162109375
[rfa agg] iter: 4, weight: tensor([3.7489e-05, 6.4889e-02, 6.2194e-02, 6.7913e-02, 1.0580e-01, 2.3080e-02,
        3.4766e-01, 1.5727e-01, 1.5685e-02, 1.5547e-01])
[rfa agg] iter:  5, prev_obj_val: 1055.420654296875, obj_val: 1052.7305908203125, abs dis: 2.6900634765625
[rfa agg] iter: 5, weight: tensor([4.3150e-05, 8.2722e-02, 6.8240e-02, 7.4137e-02, 1.1113e-01, 2.7959e-02,
        3.0495e-01, 1.5693e-01, 1.8837e-02, 1.5506e-01])
[rfa agg] iter:  6, prev_obj_val: 1052.7305908203125, obj_val: 1052.72802734375, abs dis: 0.0025634765625
[rfa agg] iter: 6, weight: tensor([3.7719e-05, 6.5400e-02, 6.2596e-02, 6.8361e-02, 1.0654e-01, 2.3228e-02,
        3.4339e-01, 1.5827e-01, 1.5784e-02, 1.5639e-01])
			Update norm = 199.19319689060669 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 774.4628963470459 sec.
Server Epoch:76 choose agents : [6, 5, 30, 19, 88, 49, 14, 57, 85, 92].
_Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 426/1956 (21.7791%)
_Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 620/1956 (31.6973%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1092, Accuracy: 108/10000 (1.0800%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0511, Accuracy: 374/1628 (22.9730%)
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 810/1628 (49.7543%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2949, Accuracy: 132/10000 (1.3200%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   1, Avg loss: 0.0780, Accuracy: 84/486 (17.2840%)
_Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 207/486 (42.5926%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.1668, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   1, Avg loss: 0.0479, Accuracy: 412/1036 (39.7683%)
_Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 670/1036 (64.6718%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.4608, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0712, Accuracy: 161/603 (26.6998%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0453, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.2294, Accuracy: 52/10000 (0.5200%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   1, Avg loss: 0.0801, Accuracy: 28/440 (6.3636%)
_Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   2, Avg loss: 0.0477, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.6340, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0622, Accuracy: 224/1013 (22.1125%)
_Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0351, Accuracy: 334/1013 (32.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.8560, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   1, Avg loss: 0.0568, Accuracy: 294/1154 (25.4766%)
_Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   2, Avg loss: 0.0273, Accuracy: 415/1154 (35.9619%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.3295, Accuracy: 75/10000 (0.7500%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 425/1988 (21.3783%)
_Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 672/1988 (33.8028%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.8236, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 457/1715 (26.6472%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 700/1715 (40.8163%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.9228, Accuracy: 90/10000 (0.9000%)
time spent on training: 293.33250188827515
[rfa agg] training data poison_ratio: 0.3779016557117897  data num: [1956, 1628, 486, 1036, 603, 440, 1013, 1154, 1988, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.23618853481986857
[rfa agg] init. name: [6, 5, 30, 19, 88, 49, 14, 57, 85, 92], weight: tensor([0.1627, 0.1355, 0.0404, 0.0862, 0.0502, 0.0366, 0.0843, 0.0960, 0.1654,
        0.1427])
[rfa agg] iter:  0, prev_obj_val: 68.0806884765625, obj_val: 70.03892517089844, abs dis: 1.9582366943359375
[rfa agg] iter: 0, weight: tensor([0.0940, 0.1537, 0.0180, 0.1226, 0.0264, 0.0151, 0.0967, 0.2507, 0.0868,
        0.1360])
[rfa agg] iter:  1, prev_obj_val: 70.03892517089844, obj_val: 72.34231567382812, abs dis: 2.3033905029296875
[rfa agg] iter: 1, weight: tensor([0.0718, 0.1085, 0.0164, 0.1354, 0.0244, 0.0137, 0.1011, 0.3637, 0.0668,
        0.0983])
[rfa agg] iter:  2, prev_obj_val: 72.34231567382812, obj_val: 77.62244415283203, abs dis: 5.280128479003906
[rfa agg] iter: 2, weight: tensor([0.0478, 0.0676, 0.0130, 0.1411, 0.0197, 0.0108, 0.0964, 0.4964, 0.0448,
        0.0625])
[rfa agg] iter:  3, prev_obj_val: 77.62244415283203, obj_val: 81.9310302734375, abs dis: 4.308586120605469
[rfa agg] iter: 3, weight: tensor([0.0457, 0.0600, 0.0161, 0.3234, 0.0253, 0.0132, 0.1873, 0.2290, 0.0432,
        0.0567])
[rfa agg] iter:  4, prev_obj_val: 81.9310302734375, obj_val: 81.8978271484375, abs dis: 0.033203125
[rfa agg] iter: 4, weight: tensor([0.0363, 0.0459, 0.0154, 0.3483, 0.0249, 0.0125, 0.3204, 0.1181, 0.0345,
        0.0439])
[rfa agg] iter:  5, prev_obj_val: 81.8978271484375, obj_val: 81.8973617553711, abs dis: 0.00046539306640625
[rfa agg] iter: 5, weight: tensor([0.0349, 0.0442, 0.0148, 0.3432, 0.0239, 0.0120, 0.3398, 0.1118, 0.0332,
        0.0422])
[rfa agg] iter:  6, prev_obj_val: 81.8973617553711, obj_val: 79.53094482421875, abs dis: 2.3664169311523438
[rfa agg] iter: 6, weight: tensor([0.0349, 0.0441, 0.0148, 0.3397, 0.0239, 0.0120, 0.3442, 0.1114, 0.0331,
        0.0421])
[rfa agg] iter:  7, prev_obj_val: 79.53094482421875, obj_val: 79.50428009033203, abs dis: 0.02666473388671875
[rfa agg] iter: 7, weight: tensor([0.0358, 0.0462, 0.0139, 0.4330, 0.0220, 0.0113, 0.2264, 0.1335, 0.0340,
        0.0439])
[rfa agg] iter:  8, prev_obj_val: 79.50428009033203, obj_val: 79.49976348876953, abs dis: 0.0045166015625
[rfa agg] iter: 8, weight: tensor([0.0336, 0.0432, 0.0130, 0.4797, 0.0206, 0.0106, 0.2013, 0.1252, 0.0318,
        0.0411])
[rfa agg] iter:  9, prev_obj_val: 79.49976348876953, obj_val: 79.49858093261719, abs dis: 0.00118255615234375
[rfa agg] iter: 9, weight: tensor([0.0323, 0.0416, 0.0125, 0.5033, 0.0198, 0.0102, 0.1904, 0.1199, 0.0306,
        0.0395])
			Update norm = 155.08389236756665 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 701.9639840126038 sec.
Server Epoch:77 choose agents : [81, 75, 66, 1, 61, 65, 79, 49, 94, 10].
poison local model 81 index 28 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   1, Avg loss: 0.0583, Accuracy: 329/774 (42.5065%), train_poison_data_count: 486
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   2, Avg loss: 0.0353, Accuracy: 433/774 (55.9432%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   3, Avg loss: 0.0268, Accuracy: 380/774 (49.0956%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   4, Avg loss: 0.0247, Accuracy: 487/774 (62.9199%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   5, Avg loss: 0.0240, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   6, Avg loss: 0.0244, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   7, Avg loss: 0.0233, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   8, Avg loss: 0.0229, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   9, Avg loss: 0.0227, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch  10, Avg loss: 0.0227, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Global model norm: 112.05150618828155.
Norm before scaling: 112.03853271308046. Distance: 0.7596809320389518
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.4584, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 77, Avg loss: 0.4027, Accuracy: 9946/9950 (99.9598%)
Scaling by  100
Scaled Norm after poisoning: 134.08324431579808, distance: 75.9680879753137
Total norm for 5 adversaries is: 134.08324431579808. distance: 75.9680879753137
_Test Local_ResNet_18 poisoned: True, epoch: 77, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   1, Avg loss: 0.0643, Accuracy: 257/776 (33.1186%)
_Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 415/776 (53.4794%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.1890, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 257/1402 (18.3310%)
_Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 393/1402 (28.0314%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.2622, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   1, Avg loss: 0.0566, Accuracy: 286/928 (30.8190%)
_Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 535/928 (57.6509%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.0698, Accuracy: 93/10000 (0.9300%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1254, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1152, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3188, Accuracy: 49/10000 (0.4900%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   1, Avg loss: 0.0549, Accuracy: 405/1475 (27.4576%)
_Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 661/1475 (44.8136%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.0842, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   1, Avg loss: 0.1015, Accuracy: 15/197 (7.6142%)
_Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   2, Avg loss: 0.0853, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3434, Accuracy: 50/10000 (0.5000%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0799, Accuracy: 30/440 (6.8182%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0481, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.6700, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 319/1662 (19.1937%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 606/1662 (36.4621%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.7967, Accuracy: 110/10000 (1.1000%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   1, Avg loss: 0.0560, Accuracy: 204/861 (23.6934%)
_Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   2, Avg loss: 0.0213, Accuracy: 471/861 (54.7038%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.1115, Accuracy: 58/10000 (0.5800%)
time spent on training: 342.4040005207062
[rfa agg] training data poison_ratio: 0.42267441860465116  data num: [774, 776, 1402, 928, 85, 1475, 197, 440, 1662, 861]
[rfa agg] considering poison per batch poison_fraction: 0.264171511627907
[rfa agg] init. name: [81, 75, 66, 1, 61, 65, 79, 49, 94, 10], weight: tensor([0.0900, 0.0902, 0.1630, 0.1079, 0.0099, 0.1715, 0.0229, 0.0512, 0.1933,
        0.1001])
[rfa agg] iter:  0, prev_obj_val: 9498.7841796875, obj_val: 5672.0390625, abs dis: 3826.7451171875
[rfa agg] iter: 0, weight: tensor([0.0097, 0.0972, 0.1783, 0.1166, 0.0104, 0.1882, 0.0243, 0.0545, 0.2128,
        0.1080])
[rfa agg] iter:  1, prev_obj_val: 5672.0390625, obj_val: 5269.83203125, abs dis: 402.20703125
[rfa agg] iter: 1, weight: tensor([0.0009, 0.0891, 0.1859, 0.1098, 0.0084, 0.2026, 0.0199, 0.0464, 0.2366,
        0.1004])
[rfa agg] iter:  2, prev_obj_val: 5269.83203125, obj_val: 5270.0517578125, abs dis: 0.2197265625
[rfa agg] iter: 2, weight: tensor([3.8308e-05, 2.2583e-02, 2.0164e-01, 3.2921e-02, 1.2324e-03, 4.5581e-01,
        3.1496e-03, 8.2922e-03, 2.4681e-01, 2.7523e-02])
[rfa agg] iter:  3, prev_obj_val: 5270.0517578125, obj_val: 5271.8388671875, abs dis: 1.787109375
[rfa agg] iter: 3, weight: tensor([6.2361e-05, 5.3699e-02, 3.9423e-01, 8.6672e-02, 2.3826e-03, 2.1542e-01,
        6.2096e-03, 1.6990e-02, 1.5600e-01, 6.8337e-02])
[rfa agg] iter:  4, prev_obj_val: 5271.8388671875, obj_val: 5273.8857421875, abs dis: 2.046875
[rfa agg] iter: 4, weight: tensor([7.2834e-05, 7.2352e-02, 3.2875e-01, 1.2349e-01, 2.9420e-03, 1.9431e-01,
        7.7234e-03, 2.1438e-02, 1.5461e-01, 9.4319e-02])
[rfa agg] iter:  5, prev_obj_val: 5273.8857421875, obj_val: 5273.87841796875, abs dis: 0.00732421875
[rfa agg] iter: 5, weight: tensor([7.8658e-05, 9.2170e-02, 2.5791e-01, 1.6995e-01, 3.3675e-03, 1.7338e-01,
        8.9132e-03, 2.5163e-02, 1.4514e-01, 1.2393e-01])
			Update norm = 168.23230195736787 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 747.488587141037 sec.
Server Epoch:78 choose agents : [42, 6, 82, 30, 19, 31, 93, 7, 5, 16].
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   1, Avg loss: 0.0528, Accuracy: 349/1372 (25.4373%)
_Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 526/1372 (38.3382%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.0679, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   1, Avg loss: 0.0541, Accuracy: 391/1956 (19.9898%)
_Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   2, Avg loss: 0.0324, Accuracy: 631/1956 (32.2597%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.3473, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   1, Avg loss: 0.0757, Accuracy: 76/500 (15.2000%)
_Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.7858, Accuracy: 52/10000 (0.5200%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0777, Accuracy: 89/486 (18.3128%)
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0409, Accuracy: 215/486 (44.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.1313, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 387/1036 (37.3552%)
_Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   2, Avg loss: 0.0237, Accuracy: 667/1036 (64.3822%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.3206, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   1, Avg loss: 0.0804, Accuracy: 67/460 (14.5652%)
_Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   2, Avg loss: 0.0363, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.9944, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 412/1742 (23.6510%)
_Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 698/1742 (40.0689%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.2458, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   1, Avg loss: 0.0527, Accuracy: 358/891 (40.1796%)
_Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 443/891 (49.7194%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.3726, Accuracy: 54/10000 (0.5400%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 396/1628 (24.3243%)
_Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   2, Avg loss: 0.0260, Accuracy: 807/1628 (49.5700%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.2549, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   1, Avg loss: 0.0622, Accuracy: 285/708 (40.2542%)
_Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   2, Avg loss: 0.0383, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.9572, Accuracy: 56/10000 (0.5600%)
time spent on training: 283.7678551673889
[rfa agg] training data poison_ratio: 0.32340662399109377  data num: [1372, 1956, 500, 486, 1036, 460, 1742, 891, 1628, 708]
[rfa agg] considering poison per batch poison_fraction: 0.2021291399944336
[rfa agg] init. name: [42, 6, 82, 30, 19, 31, 93, 7, 5, 16], weight: tensor([0.1273, 0.1815, 0.0464, 0.0451, 0.0961, 0.0427, 0.1616, 0.0827, 0.1510,
        0.0657])
[rfa agg] iter:  0, prev_obj_val: 68.75809478759766, obj_val: 69.80561065673828, abs dis: 1.047515869140625
[rfa agg] iter: 0, weight: tensor([0.2275, 0.0852, 0.0238, 0.0231, 0.2525, 0.0219, 0.1009, 0.0916, 0.1208,
        0.0527])
[rfa agg] iter:  1, prev_obj_val: 69.80561065673828, obj_val: 72.08087158203125, abs dis: 2.2752609252929688
[rfa agg] iter: 1, weight: tensor([0.1894, 0.0776, 0.0237, 0.0230, 0.3160, 0.0218, 0.0909, 0.0966, 0.1072,
        0.0539])
[rfa agg] iter:  2, prev_obj_val: 72.08087158203125, obj_val: 75.06421661376953, abs dis: 2.9833450317382812
[rfa agg] iter: 2, weight: tensor([0.1117, 0.0540, 0.0196, 0.0191, 0.5046, 0.0181, 0.0618, 0.0922, 0.0711,
        0.0477])
[rfa agg] iter:  3, prev_obj_val: 75.06421661376953, obj_val: 78.9272689819336, abs dis: 3.8630523681640625
[rfa agg] iter: 3, weight: tensor([0.0827, 0.0454, 0.0198, 0.0192, 0.5407, 0.0182, 0.0509, 0.1133, 0.0575,
        0.0523])
[rfa agg] iter:  4, prev_obj_val: 78.9272689819336, obj_val: 78.89183044433594, abs dis: 0.03543853759765625
[rfa agg] iter: 4, weight: tensor([0.0946, 0.0572, 0.0301, 0.0293, 0.3047, 0.0277, 0.0631, 0.2335, 0.0701,
        0.0897])
[rfa agg] iter:  5, prev_obj_val: 78.89183044433594, obj_val: 78.89173889160156, abs dis: 9.1552734375e-05
[rfa agg] iter: 5, weight: tensor([0.0949, 0.0573, 0.0302, 0.0293, 0.2951, 0.0278, 0.0632, 0.2417, 0.0702,
        0.0903])
			Update norm = 141.90905428301608 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 682.760580778122 sec.
Server Epoch:79 choose agents : [84, 82, 36, 58, 27, 49, 61, 52, 90, 85].
poison local model 84 index 29 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   1, Avg loss: 0.0519, Accuracy: 602/1190 (50.5882%), train_poison_data_count: 758
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   2, Avg loss: 0.0292, Accuracy: 699/1190 (58.7395%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   3, Avg loss: 0.0250, Accuracy: 758/1190 (63.6975%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   4, Avg loss: 0.0236, Accuracy: 757/1190 (63.6134%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   5, Avg loss: 0.0235, Accuracy: 757/1190 (63.6134%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   6, Avg loss: 0.0232, Accuracy: 759/1190 (63.7815%), train_poison_data_count: 758
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   7, Avg loss: 0.0230, Accuracy: 751/1190 (63.1092%), train_poison_data_count: 758
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   8, Avg loss: 0.0230, Accuracy: 758/1190 (63.6975%), train_poison_data_count: 758
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   9, Avg loss: 0.0226, Accuracy: 757/1190 (63.6134%), train_poison_data_count: 758
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch  10, Avg loss: 0.0221, Accuracy: 756/1190 (63.5294%), train_poison_data_count: 758
Global model norm: 112.05150618828155.
Norm before scaling: 112.03060059086535. Distance: 0.8942831436639992
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.3985, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 79, Avg loss: 0.3985, Accuracy: 9935/9950 (99.8492%)
Scaling by  100
Scaled Norm after poisoning: 141.4370788217326, distance: 89.42831943185699
Total norm for 5 adversaries is: 141.4370788217326. distance: 89.42831943185699
_Test Local_ResNet_18 poisoned: True, epoch: 79, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 64/500 (12.8000%)
_Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.9014, Accuracy: 46/10000 (0.4600%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   1, Avg loss: 0.0851, Accuracy: 88/408 (21.5686%)
_Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   2, Avg loss: 0.0534, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.6194, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 352/803 (43.8356%)
_Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   2, Avg loss: 0.0345, Accuracy: 406/803 (50.5604%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.0336, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 447/1587 (28.1664%)
_Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 592/1587 (37.3031%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.6298, Accuracy: 64/10000 (0.6400%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   1, Avg loss: 0.0797, Accuracy: 34/440 (7.7273%)
_Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   2, Avg loss: 0.0476, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.6488, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   1, Avg loss: 0.1242, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   2, Avg loss: 0.1174, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3189, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0575, Accuracy: 278/636 (43.7107%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0328, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.7278, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   1, Avg loss: 0.0573, Accuracy: 319/677 (47.1196%)
_Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 438/677 (64.6972%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.4513, Accuracy: 61/10000 (0.6100%)
poison local model 85 index 30 
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 419/1988 (21.0765%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0365, Accuracy: 661/1988 (33.2495%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.1884, Accuracy: 82/10000 (0.8200%)
time spent on training: 338.0320494174957
[rfa agg] training data poison_ratio: 0.49446716382006256  data num: [1190, 500, 408, 803, 1587, 440, 85, 636, 677, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.3090419773875391
[rfa agg] init. name: [84, 82, 36, 58, 27, 49, 61, 52, 90, 85], weight: tensor([0.1431, 0.0601, 0.0491, 0.0966, 0.1909, 0.0529, 0.0102, 0.0765, 0.0814,
        0.2391])
[rfa agg] iter:  0, prev_obj_val: 20796.671875, obj_val: 13769.5498046875, abs dis: 7027.1220703125
[rfa agg] iter: 0, weight: tensor([0.0271, 0.0677, 0.0552, 0.1092, 0.2176, 0.0595, 0.0115, 0.0863, 0.0919,
        0.2740])
[rfa agg] iter:  1, prev_obj_val: 13769.5498046875, obj_val: 12408.904296875, abs dis: 1360.6455078125
[rfa agg] iter: 1, weight: tensor([0.0046, 0.0668, 0.0543, 0.1093, 0.2265, 0.0585, 0.0111, 0.0856, 0.0915,
        0.2919])
[rfa agg] iter:  2, prev_obj_val: 12408.904296875, obj_val: 12214.873046875, abs dis: 194.03125
[rfa agg] iter: 2, weight: tensor([0.0007, 0.0516, 0.0413, 0.0916, 0.2422, 0.0446, 0.0079, 0.0683, 0.0741,
        0.3777])
[rfa agg] iter:  3, prev_obj_val: 12214.873046875, obj_val: 12214.333984375, abs dis: 0.5390625
[rfa agg] iter: 3, weight: tensor([7.2834e-05, 1.6098e-02, 1.2441e-02, 3.5759e-02, 6.8055e-01, 1.3419e-02,
        2.0453e-03, 2.3026e-02, 2.6151e-02, 1.9044e-01])
[rfa agg] iter:  4, prev_obj_val: 12214.333984375, obj_val: 12216.2431640625, abs dis: 1.9091796875
[rfa agg] iter: 4, weight: tensor([8.2687e-05, 2.1210e-02, 1.6255e-02, 5.0138e-02, 6.7309e-01, 1.7533e-02,
        2.5899e-03, 3.0945e-02, 3.5588e-02, 1.5256e-01])
[rfa agg] iter:  5, prev_obj_val: 12216.2431640625, obj_val: 12216.86328125, abs dis: 0.6201171875
[rfa agg] iter: 5, weight: tensor([1.2289e-04, 3.4893e-02, 2.6569e-02, 8.6820e-02, 5.1380e-01, 2.8658e-02,
        4.1352e-03, 5.1715e-02, 6.0077e-02, 1.9321e-01])
[rfa agg] iter:  6, prev_obj_val: 12216.86328125, obj_val: 12218.15234375, abs dis: 1.2890625
[rfa agg] iter: 6, weight: tensor([1.3221e-04, 3.8948e-02, 2.9582e-02, 9.8990e-02, 4.7166e-01, 3.1909e-02,
        4.5635e-03, 5.8090e-02, 6.7752e-02, 1.9837e-01])
[rfa agg] iter:  7, prev_obj_val: 12218.15234375, obj_val: 12219.447265625, abs dis: 1.294921875
[rfa agg] iter: 7, weight: tensor([1.4477e-04, 4.6058e-02, 3.4790e-02, 1.2273e-01, 4.0328e-01, 3.7528e-02,
        5.2647e-03, 6.9648e-02, 8.1978e-02, 1.9858e-01])
[rfa agg] iter:  8, prev_obj_val: 12219.447265625, obj_val: 12220.7490234375, abs dis: 1.3017578125
[rfa agg] iter: 8, weight: tensor([1.5123e-04, 5.2299e-02, 3.9251e-02, 1.4779e-01, 3.4523e-01, 4.2341e-02,
        5.8112e-03, 8.0399e-02, 9.5695e-02, 1.9103e-01])
[rfa agg] iter:  9, prev_obj_val: 12220.7490234375, obj_val: 12222.71484375, abs dis: 1.9658203125
[rfa agg] iter: 9, weight: tensor([1.5209e-04, 5.7602e-02, 4.2903e-02, 1.7536e-01, 2.9414e-01, 4.6283e-02,
        6.1944e-03, 9.0333e-02, 1.0903e-01, 1.7800e-01])
			Update norm = 154.90719247746375 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 745.348119020462 sec.
Server Epoch:80 choose agents : [46, 75, 54, 3, 89, 69, 41, 1, 93, 71].
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0545, Accuracy: 432/1904 (22.6891%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 708/1904 (37.1849%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.8107, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0640, Accuracy: 248/776 (31.9588%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0295, Accuracy: 414/776 (53.3505%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.2496, Accuracy: 49/10000 (0.4900%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 356/1130 (31.5044%)
_Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 496/1130 (43.8938%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.8833, Accuracy: 51/10000 (0.5100%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   1, Avg loss: 0.0735, Accuracy: 114/781 (14.5967%)
_Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   2, Avg loss: 0.0372, Accuracy: 229/781 (29.3214%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.8644, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 338/896 (37.7232%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 442/896 (49.3304%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.3535, Accuracy: 50/10000 (0.5000%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   1, Avg loss: 0.0567, Accuracy: 286/590 (48.4746%)
_Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   2, Avg loss: 0.0314, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.6605, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   1, Avg loss: 0.0590, Accuracy: 342/719 (47.5661%)
_Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   2, Avg loss: 0.0334, Accuracy: 438/719 (60.9179%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.6197, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   1, Avg loss: 0.0568, Accuracy: 283/928 (30.4957%)
_Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   2, Avg loss: 0.0234, Accuracy: 591/928 (63.6853%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.7535, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 406/1742 (23.3065%)
_Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 726/1742 (41.6762%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.0216, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 154/818 (18.8264%)
_Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   2, Avg loss: 0.0314, Accuracy: 335/818 (40.9535%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.4733, Accuracy: 68/10000 (0.6800%)
time spent on training: 267.76519680023193
[rfa agg] training data poison_ratio: 0.24319330999611047  data num: [1904, 776, 1130, 781, 896, 590, 719, 928, 1742, 818]
[rfa agg] considering poison per batch poison_fraction: 0.15199581874756904
[rfa agg] init. name: [46, 75, 54, 3, 89, 69, 41, 1, 93, 71], weight: tensor([0.1851, 0.0755, 0.1099, 0.0759, 0.0871, 0.0574, 0.0699, 0.0902, 0.1694,
        0.0795])
[rfa agg] iter:  0, prev_obj_val: 58.60491943359375, obj_val: 58.59062194824219, abs dis: 0.0142974853515625
[rfa agg] iter: 0, weight: tensor([0.0514, 0.0791, 0.2372, 0.0798, 0.1249, 0.0330, 0.0576, 0.1984, 0.0551,
        0.0836])
[rfa agg] iter:  1, prev_obj_val: 58.59062194824219, obj_val: 68.32782745361328, abs dis: 9.737205505371094
[rfa agg] iter: 1, weight: tensor([0.0276, 0.1030, 0.0712, 0.1060, 0.2251, 0.0292, 0.0626, 0.2363, 0.0290,
        0.1101])
[rfa agg] iter:  2, prev_obj_val: 68.32782745361328, obj_val: 75.64522552490234, abs dis: 7.3173980712890625
[rfa agg] iter: 2, weight: tensor([0.0244, 0.1416, 0.0429, 0.1473, 0.0984, 0.0644, 0.2342, 0.0696, 0.0250,
        0.1522])
[rfa agg] iter:  3, prev_obj_val: 75.64522552490234, obj_val: 71.83097076416016, abs dis: 3.8142547607421875
[rfa agg] iter: 3, weight: tensor([0.0319, 0.1162, 0.0511, 0.1184, 0.0924, 0.1615, 0.1996, 0.0725, 0.0326,
        0.1239])
[rfa agg] iter:  4, prev_obj_val: 71.83097076416016, obj_val: 71.82701873779297, abs dis: 0.0039520263671875
[rfa agg] iter: 4, weight: tensor([0.0275, 0.1240, 0.0462, 0.1275, 0.0919, 0.0992, 0.2533, 0.0691, 0.0282,
        0.1331])
			Update norm = 106.82596645654557 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 668.5054903030396 sec.
Server Epoch:81 choose agents : [85, 15, 81, 53, 39, 54, 28, 61, 0, 51].
poison local model 85 index 30 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   1, Avg loss: 0.0452, Accuracy: 1056/1988 (53.1187%), train_poison_data_count: 1244
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   2, Avg loss: 0.0259, Accuracy: 1241/1988 (62.4245%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   3, Avg loss: 0.0244, Accuracy: 1244/1988 (62.5755%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   4, Avg loss: 0.0244, Accuracy: 1242/1988 (62.4748%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   5, Avg loss: 0.0239, Accuracy: 1243/1988 (62.5252%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   6, Avg loss: 0.0238, Accuracy: 1242/1988 (62.4748%), train_poison_data_count: 1244
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   7, Avg loss: 0.0231, Accuracy: 1244/1988 (62.5755%), train_poison_data_count: 1244
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   8, Avg loss: 0.0228, Accuracy: 1242/1988 (62.4748%), train_poison_data_count: 1244
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   9, Avg loss: 0.0230, Accuracy: 1242/1988 (62.4748%), train_poison_data_count: 1244
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch  10, Avg loss: 0.0230, Accuracy: 1243/1988 (62.5252%), train_poison_data_count: 1244
Global model norm: 112.05150618828155.
Norm before scaling: 112.01400669252261. Distance: 1.1050533956684818
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.0074, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 81, Avg loss: 0.4231, Accuracy: 9940/9950 (99.8995%)
Scaling by  100
Scaled Norm after poisoning: 154.28816510226895, distance: 110.50535107942737
Total norm for 6 adversaries is: 154.28816510226895. distance: 110.50535107942737
_Test Local_ResNet_18 poisoned: True, epoch: 81, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0578, Accuracy: 314/1154 (27.2097%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0288, Accuracy: 402/1154 (34.8354%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.3218, Accuracy: 50/10000 (0.5000%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0676, Accuracy: 233/774 (30.1034%)
_Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0366, Accuracy: 297/774 (38.3721%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.4324, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0506, Accuracy: 271/813 (33.3333%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 453/813 (55.7196%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.7962, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   1, Avg loss: 0.0545, Accuracy: 313/1013 (30.8983%)
_Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 472/1013 (46.5943%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.5866, Accuracy: 59/10000 (0.5900%)
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 355/1130 (31.4159%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 493/1130 (43.6283%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.3023, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 383/1581 (24.2252%)
_Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 590/1581 (37.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.8407, Accuracy: 93/10000 (0.9300%)
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1251, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1193, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3190, Accuracy: 53/10000 (0.5300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 366/1657 (22.0881%)
_Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 547/1657 (33.0115%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.7119, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 233/1049 (22.2116%)
_Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 508/1049 (48.4271%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.5968, Accuracy: 76/10000 (0.7600%)
time spent on training: 401.7182765007019
[rfa agg] training data poison_ratio: 0.6036997509782995  data num: [1988, 1154, 774, 813, 1013, 1130, 1581, 85, 1657, 1049]
[rfa agg] considering poison per batch poison_fraction: 0.37731234436143724
[rfa agg] init. name: [85, 15, 81, 53, 39, 54, 28, 61, 0, 51], weight: tensor([0.1768, 0.1026, 0.0688, 0.0723, 0.0901, 0.1005, 0.1406, 0.0076, 0.1474,
        0.0933])
[rfa agg] iter:  0, prev_obj_val: 41601.47265625, obj_val: 29338.560546875, abs dis: 12262.912109375
[rfa agg] iter: 0, weight: tensor([0.0440, 0.1192, 0.0798, 0.0838, 0.1045, 0.1166, 0.1636, 0.0087, 0.1715,
        0.1082])
[rfa agg] iter:  1, prev_obj_val: 29338.560546875, obj_val: 26169.48046875, abs dis: 3169.080078125
[rfa agg] iter: 1, weight: tensor([0.0098, 0.1234, 0.0821, 0.0862, 0.1078, 0.1206, 0.1705, 0.0089, 0.1789,
        0.1118])
[rfa agg] iter:  2, prev_obj_val: 26169.48046875, obj_val: 25458.251953125, abs dis: 711.228515625
[rfa agg] iter: 2, weight: tensor([0.0021, 0.1240, 0.0800, 0.0841, 0.1067, 0.1206, 0.1767, 0.0082, 0.1864,
        0.1112])
[rfa agg] iter:  3, prev_obj_val: 25458.251953125, obj_val: 25315.201171875, abs dis: 143.05078125
[rfa agg] iter: 3, weight: tensor([0.0004, 0.1198, 0.0675, 0.0709, 0.0960, 0.1137, 0.2026, 0.0057, 0.2210,
        0.1024])
[rfa agg] iter:  4, prev_obj_val: 25315.201171875, obj_val: 25312.27734375, abs dis: 2.923828125
[rfa agg] iter: 4, weight: tensor([3.4322e-05, 5.2308e-02, 1.7746e-02, 1.8634e-02, 3.0918e-02, 4.4050e-02,
        4.5019e-01, 1.0144e-03, 3.4916e-01, 3.5946e-02])
[rfa agg] iter:  5, prev_obj_val: 25312.27734375, obj_val: 25311.19921875, abs dis: 1.078125
[rfa agg] iter: 5, weight: tensor([5.9345e-05, 1.6971e-01, 4.0737e-02, 4.2762e-02, 7.9388e-02, 1.2832e-01,
        2.4516e-01, 2.0143e-03, 1.9402e-01, 9.7834e-02])
[rfa agg] iter:  6, prev_obj_val: 25311.19921875, obj_val: 25312.52734375, abs dis: 1.328125
[rfa agg] iter: 6, weight: tensor([4.5560e-05, 3.0442e-01, 4.0181e-02, 4.2146e-02, 9.0606e-02, 1.8420e-01,
        1.1392e-01, 1.7167e-03, 1.0009e-01, 1.2268e-01])
[rfa agg] iter:  7, prev_obj_val: 25312.52734375, obj_val: 25322.7421875, abs dis: 10.21484375
[rfa agg] iter: 7, weight: tensor([2.9880e-05, 2.1999e-01, 3.6647e-02, 3.8362e-02, 1.1089e-01, 3.0121e-01,
        5.3578e-02, 1.2643e-03, 4.9358e-02, 1.8866e-01])
[rfa agg] iter:  8, prev_obj_val: 25322.7421875, obj_val: 25322.58984375, abs dis: 0.15234375
[rfa agg] iter: 8, weight: tensor([3.8008e-05, 9.7915e-02, 8.9515e-02, 9.2756e-02, 3.0087e-01, 1.3208e-01,
        5.0456e-02, 1.8994e-03, 4.7975e-02, 1.8650e-01])
[rfa agg] iter:  9, prev_obj_val: 25322.58984375, obj_val: 25319.8125, abs dis: 2.77734375
[rfa agg] iter: 9, weight: tensor([3.5135e-05, 8.9380e-02, 8.3706e-02, 8.7013e-02, 3.5339e-01, 1.1887e-01,
        4.6669e-02, 1.7565e-03, 4.4375e-02, 1.7480e-01])
			Update norm = 146.2640885308147 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 801.3986477851868 sec.
Server Epoch:82 choose agents : [23, 74, 72, 38, 79, 44, 28, 77, 55, 70].
_Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   1, Avg loss: 0.0625, Accuracy: 323/715 (45.1748%)
_Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   2, Avg loss: 0.0395, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.8017, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 459/1552 (29.5747%)
_Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 787/1552 (50.7088%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 11.2689, Accuracy: 78/10000 (0.7800%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0625, Accuracy: 258/1241 (20.7897%)
_Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 394/1241 (31.7486%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.1499, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   1, Avg loss: 0.0611, Accuracy: 255/1131 (22.5464%)
_Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   2, Avg loss: 0.0312, Accuracy: 501/1131 (44.2971%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.4485, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1004, Accuracy: 16/197 (8.1218%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.0861, Accuracy: 58/197 (29.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3503, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 396/1750 (22.6286%)
_Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0358, Accuracy: 645/1750 (36.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.8801, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 374/1581 (23.6559%)
_Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 597/1581 (37.7609%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.8034, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   1, Avg loss: 0.0541, Accuracy: 322/1340 (24.0299%)
_Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 550/1340 (41.0448%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.8386, Accuracy: 65/10000 (0.6500%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 253/1071 (23.6228%)
_Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 477/1071 (44.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.9426, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   1, Avg loss: 0.0566, Accuracy: 320/1418 (22.5670%)
_Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 658/1418 (46.4034%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.9852, Accuracy: 84/10000 (0.8400%)
time spent on training: 303.28698325157166
[rfa agg] training data poison_ratio: 0.4679893297765922  data num: [715, 1552, 1241, 1131, 197, 1750, 1581, 1340, 1071, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.2924933311103701
[rfa agg] init. name: [23, 74, 72, 38, 79, 44, 28, 77, 55, 70], weight: tensor([0.0596, 0.1294, 0.1035, 0.0943, 0.0164, 0.1459, 0.1318, 0.1117, 0.0893,
        0.1182])
[rfa agg] iter:  0, prev_obj_val: 38.77180862426758, obj_val: 42.48188781738281, abs dis: 3.7100791931152344
[rfa agg] iter: 0, weight: tensor([0.0185, 0.0630, 0.3174, 0.1078, 0.0026, 0.0452, 0.0646, 0.2149, 0.0718,
        0.0941])
[rfa agg] iter:  1, prev_obj_val: 42.48188781738281, obj_val: 47.078243255615234, abs dis: 4.596355438232422
[rfa agg] iter: 1, weight: tensor([0.0242, 0.0604, 0.2497, 0.2049, 0.0031, 0.0461, 0.0620, 0.1498, 0.1174,
        0.0823])
[rfa agg] iter:  2, prev_obj_val: 47.078243255615234, obj_val: 49.78656005859375, abs dis: 2.7083168029785156
[rfa agg] iter: 2, weight: tensor([0.0270, 0.0499, 0.1338, 0.3421, 0.0032, 0.0398, 0.0510, 0.0987, 0.1909,
        0.0637])
[rfa agg] iter:  3, prev_obj_val: 49.78656005859375, obj_val: 49.77558135986328, abs dis: 0.01097869873046875
[rfa agg] iter: 3, weight: tensor([0.0290, 0.0460, 0.1062, 0.3199, 0.0033, 0.0374, 0.0471, 0.0839, 0.2699,
        0.0573])
[rfa agg] iter:  4, prev_obj_val: 49.77558135986328, obj_val: 49.77499008178711, abs dis: 0.000591278076171875
[rfa agg] iter: 4, weight: tensor([0.0288, 0.0456, 0.1048, 0.3081, 0.0032, 0.0370, 0.0466, 0.0830, 0.2862,
        0.0567])
[rfa agg] iter:  5, prev_obj_val: 49.77499008178711, obj_val: 52.865997314453125, abs dis: 3.0910072326660156
[rfa agg] iter: 5, weight: tensor([0.0287, 0.0455, 0.1047, 0.3041, 0.0032, 0.0370, 0.0466, 0.0830, 0.2905,
        0.0567])
[rfa agg] iter:  6, prev_obj_val: 52.865997314453125, obj_val: 52.84052658081055, abs dis: 0.025470733642578125
[rfa agg] iter: 6, weight: tensor([0.0332, 0.0451, 0.0935, 0.2213, 0.0035, 0.0372, 0.0461, 0.0770, 0.3881,
        0.0549])
[rfa agg] iter:  7, prev_obj_val: 52.84052658081055, obj_val: 52.8364143371582, abs dis: 0.00411224365234375
[rfa agg] iter: 7, weight: tensor([0.0314, 0.0425, 0.0880, 0.1998, 0.0033, 0.0351, 0.0434, 0.0726, 0.4322,
        0.0517])
[rfa agg] iter:  8, prev_obj_val: 52.8364143371582, obj_val: 56.282066345214844, abs dis: 3.4456520080566406
[rfa agg] iter: 8, weight: tensor([0.0304, 0.0412, 0.0852, 0.1910, 0.0032, 0.0340, 0.0421, 0.0703, 0.4523,
        0.0502])
[rfa agg] iter:  9, prev_obj_val: 56.282066345214844, obj_val: 52.83869171142578, abs dis: 3.4433746337890625
[rfa agg] iter: 9, weight: tensor([0.0420, 0.0484, 0.0919, 0.1781, 0.0042, 0.0406, 0.0494, 0.0782, 0.4095,
        0.0578])
			Update norm = 155.07223619171808 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3064, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.3382, Accuracy: 0/9950 (0.0000%)
saving model
Done in 707.7948973178864 sec.
Server Epoch:83 choose agents : [95, 76, 60, 48, 18, 10, 90, 78, 15, 89].
poison local model 95 index 31 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   1, Avg loss: 0.0568, Accuracy: 230/599 (38.3973%), train_poison_data_count: 383
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   2, Avg loss: 0.0235, Accuracy: 367/599 (61.2688%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   3, Avg loss: 0.0211, Accuracy: 297/599 (49.5826%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   4, Avg loss: 0.0228, Accuracy: 376/599 (62.7713%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   5, Avg loss: 0.0202, Accuracy: 381/599 (63.6060%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   6, Avg loss: 0.0190, Accuracy: 385/599 (64.2738%), train_poison_data_count: 383
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   7, Avg loss: 0.0192, Accuracy: 381/599 (63.6060%), train_poison_data_count: 383
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   8, Avg loss: 0.0196, Accuracy: 379/599 (63.2721%), train_poison_data_count: 383
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   9, Avg loss: 0.0211, Accuracy: 383/599 (63.9399%), train_poison_data_count: 383
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch  10, Avg loss: 0.0169, Accuracy: 385/599 (64.2738%), train_poison_data_count: 383
Global model norm: 112.05150618828155.
Norm before scaling: 112.0442853295071. Distance: 0.8221960695255826
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.8382, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 83, Avg loss: 0.3440, Accuracy: 9829/9950 (98.7839%)
Scaling by  100
Scaled Norm after poisoning: 138.15323523627669, distance: 82.21960221432144
Total norm for 7 adversaries is: 138.15323523627669. distance: 82.21960221432144
_Test Local_ResNet_18 poisoned: True, epoch: 83, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   1, Avg loss: 0.0861, Accuracy: 44/466 (9.4421%)
_Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   2, Avg loss: 0.0489, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.8706, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 560/2227 (25.1459%)
_Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1037/2227 (46.5649%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.4143, Accuracy: 123/10000 (1.2300%)
poison local model 48 index 17 
_Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   1, Avg loss: 0.0707, Accuracy: 97/631 (15.3724%)
_Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 221/631 (35.0238%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.9852, Accuracy: 50/10000 (0.5000%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.0708, Accuracy: 141/530 (26.6038%)
_Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0374, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.3196, Accuracy: 65/10000 (0.6500%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   1, Avg loss: 0.0561, Accuracy: 215/861 (24.9710%)
_Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 433/861 (50.2904%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.2957, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   1, Avg loss: 0.0582, Accuracy: 308/677 (45.4948%)
_Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   2, Avg loss: 0.0239, Accuracy: 423/677 (62.4815%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.5074, Accuracy: 53/10000 (0.5300%)
poison local model 78 index 27 
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0841, Accuracy: 44/416 (10.5769%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0461, Accuracy: 172/416 (41.3462%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.7506, Accuracy: 50/10000 (0.5000%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   1, Avg loss: 0.0553, Accuracy: 341/1154 (29.5494%)
_Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   2, Avg loss: 0.0273, Accuracy: 531/1154 (46.0139%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1059, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 335/896 (37.3884%)
_Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 449/896 (50.1116%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.4374, Accuracy: 50/10000 (0.5000%)
time spent on training: 365.21059823036194
[rfa agg] training data poison_ratio: 0.7588979543573371  data num: [599, 466, 2227, 631, 530, 861, 677, 416, 1154, 896]
[rfa agg] considering poison per batch poison_fraction: 0.4743112214733357
[rfa agg] init. name: [95, 76, 60, 48, 18, 10, 90, 78, 15, 89], weight: tensor([0.0708, 0.0551, 0.2633, 0.0746, 0.0627, 0.1018, 0.0801, 0.0492, 0.1365,
        0.1059])
[rfa agg] iter:  0, prev_obj_val: 5857.603515625, obj_val: 3367.764404296875, abs dis: 2489.839111328125
[rfa agg] iter: 0, weight: tensor([0.0057, 0.0571, 0.2949, 0.0778, 0.0651, 0.1073, 0.0837, 0.0508, 0.1459,
        0.1117])
[rfa agg] iter:  1, prev_obj_val: 3367.764404296875, obj_val: 3255.420654296875, abs dis: 112.34375
[rfa agg] iter: 1, weight: tensor([3.1551e-04, 3.2443e-02, 5.4428e-01, 4.6412e-02, 3.7910e-02, 7.1357e-02,
        5.1238e-02, 2.8207e-02, 1.1359e-01, 7.4247e-02])
[rfa agg] iter:  2, prev_obj_val: 3255.420654296875, obj_val: 3239.24951171875, abs dis: 16.171142578125
[rfa agg] iter: 2, weight: tensor([1.5709e-04, 3.6882e-02, 2.7706e-01, 5.6801e-02, 4.4652e-02, 1.0690e-01,
        6.5477e-02, 3.1035e-02, 2.6987e-01, 1.1117e-01])
[rfa agg] iter:  3, prev_obj_val: 3239.24951171875, obj_val: 3237.615478515625, abs dis: 1.634033203125
[rfa agg] iter: 3, weight: tensor([5.6389e-05, 2.0807e-02, 6.3361e-02, 3.4762e-02, 2.6153e-02, 8.8824e-02,
        4.2299e-02, 1.6954e-02, 6.1445e-01, 9.2328e-02])
[rfa agg] iter:  4, prev_obj_val: 3237.615478515625, obj_val: 3239.937744140625, abs dis: 2.322265625
[rfa agg] iter: 4, weight: tensor([6.2424e-05, 3.2146e-02, 5.9354e-02, 5.9077e-02, 4.2133e-02, 2.5990e-01,
        7.7487e-02, 2.5320e-02, 1.7084e-01, 2.7368e-01])
[rfa agg] iter:  5, prev_obj_val: 3239.937744140625, obj_val: 3246.55712890625, abs dis: 6.619384765625
[rfa agg] iter: 5, weight: tensor([4.5389e-05, 3.4928e-02, 3.8297e-02, 7.7882e-02, 4.9581e-02, 2.8201e-01,
        1.2390e-01, 2.6026e-02, 7.2279e-02, 2.9505e-01])
[rfa agg] iter:  6, prev_obj_val: 3246.55712890625, obj_val: 3251.138427734375, abs dis: 4.581298828125
[rfa agg] iter: 6, weight: tensor([3.7770e-05, 4.7605e-02, 2.9230e-02, 1.6918e-01, 7.9949e-02, 8.9013e-02,
        4.1493e-01, 3.2178e-02, 4.5239e-02, 9.2637e-02])
[rfa agg] iter:  7, prev_obj_val: 3251.138427734375, obj_val: 3257.031494140625, abs dis: 5.89306640625
[rfa agg] iter: 7, weight: tensor([3.6395e-05, 6.7400e-02, 2.7045e-02, 3.5699e-01, 1.4078e-01, 6.4526e-02,
        1.9635e-01, 4.1017e-02, 3.8800e-02, 6.7057e-02])
[rfa agg] iter:  8, prev_obj_val: 3257.031494140625, obj_val: 3264.03759765625, abs dis: 7.006103515625
[rfa agg] iter: 8, weight: tensor([3.8891e-05, 1.2899e-01, 2.7795e-02, 1.9003e-01, 3.3138e-01, 5.5390e-02,
        1.0731e-01, 6.4087e-02, 3.7342e-02, 5.7644e-02])
[rfa agg] iter:  9, prev_obj_val: 3264.03759765625, obj_val: 3260.388671875, abs dis: 3.64892578125
[rfa agg] iter: 9, weight: tensor([4.4116e-05, 3.1617e-01, 3.0371e-02, 1.1253e-01, 1.8278e-01, 5.2502e-02,
        8.2082e-02, 1.3032e-01, 3.8538e-02, 5.4658e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3082, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.3422, Accuracy: 0/9950 (0.0000%)
saving model
Done in 763.6436927318573 sec.
Server Epoch:84 choose agents : [61, 28, 35, 75, 74, 90, 55, 80, 23, 88].
poison local model 61 index 22 
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1251, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1165, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3210, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 401/1581 (25.3637%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 587/1581 (37.1284%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.7066, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.0851, Accuracy: 36/271 (13.2841%)
_Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0548, Accuracy: 106/271 (39.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.4574, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   1, Avg loss: 0.0632, Accuracy: 255/776 (32.8608%)
_Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   2, Avg loss: 0.0300, Accuracy: 395/776 (50.9021%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.2532, Accuracy: 53/10000 (0.5300%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 481/1552 (30.9923%)
_Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 767/1552 (49.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.6437, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   1, Avg loss: 0.0556, Accuracy: 328/677 (48.4490%)
_Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 476/677 (70.3102%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.5969, Accuracy: 59/10000 (0.5900%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 245/1071 (22.8758%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 523/1071 (48.8329%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.2016, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.0694, Accuracy: 164/682 (24.0469%)
_Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0381, Accuracy: 238/682 (34.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.7264, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   1, Avg loss: 0.0612, Accuracy: 325/715 (45.4545%)
_Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   2, Avg loss: 0.0391, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.9895, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.0712, Accuracy: 156/603 (25.8706%)
_Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0444, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.2534, Accuracy: 51/10000 (0.5100%)
time spent on training: 254.95592975616455
[rfa agg] training data poison_ratio: 0.33795082990141023  data num: [85, 1581, 271, 776, 1552, 677, 1071, 682, 715, 603]
[rfa agg] considering poison per batch poison_fraction: 0.2112192686883814
[rfa agg] init. name: [61, 28, 35, 75, 74, 90, 55, 80, 23, 88], weight: tensor([0.0106, 0.1973, 0.0338, 0.0968, 0.1937, 0.0845, 0.1337, 0.0851, 0.0892,
        0.0753])
[rfa agg] iter:  0, prev_obj_val: 56.06086730957031, obj_val: 57.1737174987793, abs dis: 1.1128501892089844
[rfa agg] iter: 0, weight: tensor([0.0034, 0.0751, 0.0142, 0.2370, 0.0736, 0.0954, 0.2037, 0.0956, 0.1359,
        0.0662])
[rfa agg] iter:  1, prev_obj_val: 57.1737174987793, obj_val: 61.29065704345703, abs dis: 4.116939544677734
[rfa agg] iter: 1, weight: tensor([0.0022, 0.0383, 0.0098, 0.4204, 0.0376, 0.0950, 0.0768, 0.0943, 0.1680,
        0.0574])
[rfa agg] iter:  2, prev_obj_val: 61.29065704345703, obj_val: 69.77759552001953, abs dis: 8.4869384765625
[rfa agg] iter: 2, weight: tensor([0.0023, 0.0304, 0.0107, 0.1303, 0.0299, 0.2259, 0.0501, 0.2085, 0.2150,
        0.0969])
[rfa agg] iter:  3, prev_obj_val: 69.77759552001953, obj_val: 69.72039031982422, abs dis: 0.0572052001953125
[rfa agg] iter: 3, weight: tensor([0.0032, 0.0321, 0.0163, 0.0774, 0.0315, 0.1855, 0.0463, 0.1813, 0.1034,
        0.3231])
[rfa agg] iter:  4, prev_obj_val: 69.72039031982422, obj_val: 73.51762390136719, abs dis: 3.7972335815429688
[rfa agg] iter: 4, weight: tensor([0.0029, 0.0290, 0.0147, 0.0699, 0.0285, 0.1690, 0.0419, 0.1625, 0.0921,
        0.3895])
[rfa agg] iter:  5, prev_obj_val: 73.51762390136719, obj_val: 69.7186050415039, abs dis: 3.7990188598632812
[rfa agg] iter: 5, weight: tensor([0.0041, 0.0375, 0.0218, 0.0805, 0.0368, 0.1585, 0.0523, 0.1555, 0.1007,
        0.3524])
[rfa agg] iter:  6, prev_obj_val: 69.7186050415039, obj_val: 69.71493530273438, abs dis: 0.00366973876953125
[rfa agg] iter: 6, weight: tensor([0.0028, 0.0286, 0.0145, 0.0689, 0.0281, 0.1657, 0.0413, 0.1588, 0.0908,
        0.4004])
[rfa agg] iter:  7, prev_obj_val: 69.71493530273438, obj_val: 69.7144546508789, abs dis: 0.00048065185546875
[rfa agg] iter: 7, weight: tensor([0.0027, 0.0277, 0.0141, 0.0667, 0.0272, 0.1605, 0.0400, 0.1533, 0.0877,
        0.4201])
[rfa agg] iter:  8, prev_obj_val: 69.7144546508789, obj_val: 69.71436309814453, abs dis: 9.1552734375e-05
[rfa agg] iter: 8, weight: tensor([0.0027, 0.0273, 0.0139, 0.0658, 0.0268, 0.1581, 0.0394, 0.1508, 0.0865,
        0.4286])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3102, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.3535, Accuracy: 0/9950 (0.0000%)
saving model
Done in 656.6557312011719 sec.
Server Epoch:85 choose agents : [36, 56, 25, 90, 31, 70, 30, 21, 46, 64].
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   1, Avg loss: 0.0837, Accuracy: 94/408 (23.0392%)
_Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   2, Avg loss: 0.0522, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.7319, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3429, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
_Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   1, Avg loss: 0.0575, Accuracy: 311/690 (45.0725%)
_Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.6472, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   1, Avg loss: 0.0548, Accuracy: 332/677 (49.0399%)
_Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   2, Avg loss: 0.0225, Accuracy: 434/677 (64.1064%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.9792, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0804, Accuracy: 67/460 (14.5652%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0367, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.1638, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   1, Avg loss: 0.0558, Accuracy: 364/1418 (25.6700%)
_Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 589/1418 (41.5374%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.8594, Accuracy: 108/10000 (1.0800%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0774, Accuracy: 94/486 (19.3416%)
_Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0409, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.1211, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 402/1949 (20.6260%)
_Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   2, Avg loss: 0.0333, Accuracy: 606/1949 (31.0929%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.4072, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   1, Avg loss: 0.0545, Accuracy: 441/1904 (23.1618%)
_Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 673/1904 (35.3466%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.7566, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0642, Accuracy: 169/953 (17.7335%)
_Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0383, Accuracy: 296/953 (31.0598%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.8719, Accuracy: 72/10000 (0.7200%)
time spent on training: 270.01770663261414
[rfa agg] training data poison_ratio: 0.17347497535866827  data num: [408, 186, 690, 677, 460, 1418, 486, 1949, 1904, 953]
[rfa agg] considering poison per batch poison_fraction: 0.10842185959916767
[rfa agg] init. name: [36, 56, 25, 90, 31, 70, 30, 21, 46, 64], weight: tensor([0.0447, 0.0204, 0.0756, 0.0741, 0.0504, 0.1553, 0.0532, 0.2134, 0.2085,
        0.1044])
[rfa agg] iter:  0, prev_obj_val: 82.54803466796875, obj_val: 84.62407684326172, abs dis: 2.0760421752929688
[rfa agg] iter: 0, weight: tensor([0.0293, 0.0099, 0.0757, 0.0743, 0.0361, 0.2540, 0.0382, 0.1285, 0.1364,
        0.2176])
[rfa agg] iter:  1, prev_obj_val: 84.62407684326172, obj_val: 87.88642120361328, abs dis: 3.2623443603515625
[rfa agg] iter: 1, weight: tensor([0.0302, 0.0098, 0.0849, 0.0833, 0.0379, 0.1738, 0.0400, 0.1032, 0.1085,
        0.3283])
[rfa agg] iter:  2, prev_obj_val: 87.88642120361328, obj_val: 90.70372009277344, abs dis: 2.8172988891601562
[rfa agg] iter: 2, weight: tensor([0.0214, 0.0065, 0.0718, 0.0704, 0.0276, 0.0742, 0.0292, 0.0513, 0.0534,
        0.5942])
[rfa agg] iter:  3, prev_obj_val: 90.70372009277344, obj_val: 93.91941833496094, abs dis: 3.2156982421875
[rfa agg] iter: 3, weight: tensor([0.0297, 0.0086, 0.1143, 0.1121, 0.0390, 0.0802, 0.0413, 0.0587, 0.0609,
        0.4551])
[rfa agg] iter:  4, prev_obj_val: 93.91941833496094, obj_val: 97.19982147216797, abs dis: 3.2804031372070312
[rfa agg] iter: 4, weight: tensor([0.0388, 0.0106, 0.1874, 0.1836, 0.0522, 0.0809, 0.0554, 0.0621, 0.0642,
        0.2648])
[rfa agg] iter:  5, prev_obj_val: 97.19982147216797, obj_val: 103.49557495117188, abs dis: 6.295753479003906
[rfa agg] iter: 5, weight: tensor([0.0374, 0.0095, 0.2768, 0.2695, 0.0525, 0.0593, 0.0557, 0.0474, 0.0488,
        0.1431])
[rfa agg] iter:  6, prev_obj_val: 103.49557495117188, obj_val: 103.48403930664062, abs dis: 0.01153564453125
[rfa agg] iter: 6, weight: tensor([0.0392, 0.0083, 0.3328, 0.3185, 0.0609, 0.0386, 0.0648, 0.0324, 0.0333,
        0.0712])
[rfa agg] iter:  7, prev_obj_val: 103.48403930664062, obj_val: 106.33942413330078, abs dis: 2.8553848266601562
[rfa agg] iter: 7, weight: tensor([0.0385, 0.0082, 0.3380, 0.3201, 0.0599, 0.0378, 0.0636, 0.0318, 0.0326,
        0.0696])
[rfa agg] iter:  8, prev_obj_val: 106.33942413330078, obj_val: 106.33502197265625, abs dis: 0.00440216064453125
[rfa agg] iter: 8, weight: tensor([0.0573, 0.0112, 0.2688, 0.2598, 0.0945, 0.0466, 0.1006, 0.0398, 0.0408,
        0.0806])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3122, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.3449, Accuracy: 0/9950 (0.0000%)
saving model
Done in 672.6905896663666 sec.
Server Epoch:86 choose agents : [94, 50, 2, 53, 86, 67, 12, 69, 24, 81].
_Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 333/1662 (20.0361%)
_Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 616/1662 (37.0638%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.2530, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   1, Avg loss: 0.0625, Accuracy: 165/809 (20.3956%)
_Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 351/809 (43.3869%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.6381, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0605, Accuracy: 256/605 (42.3140%)
_Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0391, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.0748, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   1, Avg loss: 0.0495, Accuracy: 285/813 (35.0554%)
_Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   2, Avg loss: 0.0193, Accuracy: 432/813 (53.1365%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.1772, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   1, Avg loss: 0.0639, Accuracy: 352/1003 (35.0947%)
_Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 380/1003 (37.8863%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.8293, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   1, Avg loss: 0.0775, Accuracy: 58/426 (13.6150%)
_Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   2, Avg loss: 0.0417, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.0179, Accuracy: 50/10000 (0.5000%)
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   1, Avg loss: 0.0845, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   2, Avg loss: 0.0450, Accuracy: 147/338 (43.4911%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.7103, Accuracy: 50/10000 (0.5000%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   1, Avg loss: 0.0570, Accuracy: 288/590 (48.8136%)
_Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   2, Avg loss: 0.0324, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.1170, Accuracy: 50/10000 (0.5000%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.0778, Accuracy: 34/312 (10.8974%)
_Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0418, Accuracy: 168/312 (53.8462%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.5690, Accuracy: 50/10000 (0.5000%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0648, Accuracy: 238/774 (30.7494%)
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0377, Accuracy: 313/774 (40.4393%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.4788, Accuracy: 63/10000 (0.6300%)
time spent on training: 261.8772509098053
[rfa agg] training data poison_ratio: 0.2746863066012002  data num: [1662, 809, 605, 813, 1003, 426, 338, 590, 312, 774]
[rfa agg] considering poison per batch poison_fraction: 0.17167894162575012
[rfa agg] init. name: [94, 50, 2, 53, 86, 67, 12, 69, 24, 81], weight: tensor([0.2267, 0.1103, 0.0825, 0.1109, 0.1368, 0.0581, 0.0461, 0.0805, 0.0426,
        0.1056])
[rfa agg] iter:  0, prev_obj_val: 49.34380340576172, obj_val: 54.82246398925781, abs dis: 5.478660583496094
[rfa agg] iter: 0, weight: tensor([0.0420, 0.1787, 0.1369, 0.1796, 0.0806, 0.0344, 0.0224, 0.1361, 0.0175,
        0.1717])
[rfa agg] iter:  1, prev_obj_val: 54.82246398925781, obj_val: 66.75264739990234, abs dis: 11.930183410644531
[rfa agg] iter: 1, weight: tensor([0.0288, 0.0733, 0.2931, 0.0736, 0.0460, 0.0387, 0.0232, 0.3359, 0.0172,
        0.0701])
[rfa agg] iter:  2, prev_obj_val: 66.75264739990234, obj_val: 57.48668670654297, abs dis: 9.265960693359375
[rfa agg] iter: 2, weight: tensor([0.0481, 0.0835, 0.1536, 0.0840, 0.0651, 0.1966, 0.0851, 0.1512, 0.0530,
        0.0799])
[rfa agg] iter:  3, prev_obj_val: 57.48668670654297, obj_val: 66.7467041015625, abs dis: 9.260017395019531
[rfa agg] iter: 3, weight: tensor([0.0337, 0.0759, 0.2756, 0.0764, 0.0514, 0.0563, 0.0321, 0.3028, 0.0231,
        0.0727])
[rfa agg] iter:  4, prev_obj_val: 66.7467041015625, obj_val: 57.48685073852539, abs dis: 9.25985336303711
[rfa agg] iter: 4, weight: tensor([0.0480, 0.0834, 0.1534, 0.0839, 0.0650, 0.1974, 0.0851, 0.1509, 0.0530,
        0.0799])
[rfa agg] iter:  5, prev_obj_val: 57.48685073852539, obj_val: 66.74669647216797, abs dis: 9.259845733642578
[rfa agg] iter: 5, weight: tensor([0.0337, 0.0759, 0.2756, 0.0764, 0.0514, 0.0564, 0.0321, 0.3028, 0.0231,
        0.0727])
[rfa agg] iter:  6, prev_obj_val: 66.74669647216797, obj_val: 57.48685073852539, abs dis: 9.259845733642578
[rfa agg] iter: 6, weight: tensor([0.0480, 0.0834, 0.1534, 0.0839, 0.0650, 0.1974, 0.0851, 0.1509, 0.0530,
        0.0799])
[rfa agg] iter:  7, prev_obj_val: 57.48685073852539, obj_val: 66.74669647216797, abs dis: 9.259845733642578
[rfa agg] iter: 7, weight: tensor([0.0337, 0.0759, 0.2756, 0.0764, 0.0514, 0.0564, 0.0321, 0.3028, 0.0231,
        0.0727])
[rfa agg] iter:  8, prev_obj_val: 66.74669647216797, obj_val: 57.48685073852539, abs dis: 9.259845733642578
[rfa agg] iter: 8, weight: tensor([0.0480, 0.0834, 0.1534, 0.0839, 0.0650, 0.1974, 0.0851, 0.1509, 0.0530,
        0.0799])
[rfa agg] iter:  9, prev_obj_val: 57.48685073852539, obj_val: 66.74669647216797, abs dis: 9.259845733642578
[rfa agg] iter: 9, weight: tensor([0.0337, 0.0759, 0.2756, 0.0764, 0.0514, 0.0564, 0.0321, 0.3028, 0.0231,
        0.0727])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3147, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.3570, Accuracy: 0/9950 (0.0000%)
saving model
Done in 662.8408930301666 sec.
Server Epoch:87 choose agents : [39, 80, 90, 83, 43, 57, 67, 2, 23, 36].
_Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 310/1013 (30.6022%)
_Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 498/1013 (49.1609%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.9566, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   1, Avg loss: 0.0667, Accuracy: 182/682 (26.6862%)
_Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   2, Avg loss: 0.0372, Accuracy: 261/682 (38.2698%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.6485, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   1, Avg loss: 0.0520, Accuracy: 348/677 (51.4032%)
_Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 429/677 (63.3678%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.0174, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 408/1953 (20.8909%)
_Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   2, Avg loss: 0.0331, Accuracy: 799/1953 (40.9114%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.9722, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 308/946 (32.5581%)
_Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 355/946 (37.5264%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.1999, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0548, Accuracy: 309/1154 (26.7764%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0264, Accuracy: 467/1154 (40.4679%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 10.0854, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   1, Avg loss: 0.0764, Accuracy: 67/426 (15.7277%)
_Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   2, Avg loss: 0.0406, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.9591, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   1, Avg loss: 0.0608, Accuracy: 269/605 (44.4628%)
_Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   2, Avg loss: 0.0376, Accuracy: 329/605 (54.3802%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.2533, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0616, Accuracy: 325/715 (45.4545%)
_Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.8644, Accuracy: 50/10000 (0.5000%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   1, Avg loss: 0.0833, Accuracy: 90/408 (22.0588%)
_Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   2, Avg loss: 0.0531, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.6997, Accuracy: 50/10000 (0.5000%)
time spent on training: 255.83626413345337
[rfa agg] training data poison_ratio: 0.04755799044177643  data num: [1013, 682, 677, 1953, 946, 1154, 426, 605, 715, 408]
[rfa agg] considering poison per batch poison_fraction: 0.02972374402611027
[rfa agg] init. name: [39, 80, 90, 83, 43, 57, 67, 2, 23, 36], weight: tensor([0.1181, 0.0795, 0.0789, 0.2276, 0.1103, 0.1345, 0.0497, 0.0705, 0.0833,
        0.0476])
[rfa agg] iter:  0, prev_obj_val: 57.85930633544922, obj_val: 59.611045837402344, abs dis: 1.751739501953125
[rfa agg] iter: 0, weight: tensor([0.2572, 0.0526, 0.0522, 0.0380, 0.3711, 0.0875, 0.0165, 0.0374, 0.0716,
        0.0158])
[rfa agg] iter:  1, prev_obj_val: 59.611045837402344, obj_val: 63.88877868652344, abs dis: 4.277732849121094
[rfa agg] iter: 1, weight: tensor([0.1546, 0.1042, 0.1034, 0.0438, 0.2320, 0.0812, 0.0257, 0.0664, 0.1640,
        0.0246])
[rfa agg] iter:  2, prev_obj_val: 63.88877868652344, obj_val: 71.31275177001953, abs dis: 7.423973083496094
[rfa agg] iter: 2, weight: tensor([0.0566, 0.2322, 0.2331, 0.0254, 0.0675, 0.0388, 0.0239, 0.0927, 0.2070,
        0.0229])
[rfa agg] iter:  3, prev_obj_val: 71.31275177001953, obj_val: 74.59349060058594, abs dis: 3.2807388305664062
[rfa agg] iter: 3, weight: tensor([0.0505, 0.1851, 0.1858, 0.0280, 0.0563, 0.0384, 0.0420, 0.2716, 0.1020,
        0.0403])
[rfa agg] iter:  4, prev_obj_val: 74.59349060058594, obj_val: 81.65379333496094, abs dis: 7.060302734375
[rfa agg] iter: 4, weight: tensor([0.0546, 0.1526, 0.1512, 0.0320, 0.0600, 0.0426, 0.0587, 0.2958, 0.0963,
        0.0563])
[rfa agg] iter:  5, prev_obj_val: 81.65379333496094, obj_val: 78.09368896484375, abs dis: 3.5601043701171875
[rfa agg] iter: 5, weight: tensor([0.0636, 0.1266, 0.1255, 0.0410, 0.0683, 0.0518, 0.1264, 0.1811, 0.0943,
        0.1214])
[rfa agg] iter:  6, prev_obj_val: 78.09368896484375, obj_val: 71.264892578125, abs dis: 6.82879638671875
[rfa agg] iter: 6, weight: tensor([0.0619, 0.1423, 0.1409, 0.0381, 0.0672, 0.0494, 0.0890, 0.2265, 0.0993,
        0.0854])
[rfa agg] iter:  7, prev_obj_val: 71.264892578125, obj_val: 78.09788513183594, abs dis: 6.8329925537109375
[rfa agg] iter: 7, weight: tensor([0.0477, 0.1739, 0.1715, 0.0264, 0.0531, 0.0362, 0.0398, 0.3182, 0.0949,
        0.0382])
[rfa agg] iter:  8, prev_obj_val: 78.09788513183594, obj_val: 71.26394653320312, abs dis: 6.8339385986328125
[rfa agg] iter: 8, weight: tensor([0.0615, 0.1415, 0.1402, 0.0379, 0.0668, 0.0491, 0.0877, 0.2326, 0.0985,
        0.0842])
[rfa agg] iter:  9, prev_obj_val: 71.26394653320312, obj_val: 78.09803009033203, abs dis: 6.834083557128906
[rfa agg] iter: 9, weight: tensor([0.0475, 0.1734, 0.1711, 0.0264, 0.0530, 0.0362, 0.0397, 0.3200, 0.0946,
        0.0381])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3175, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.3637, Accuracy: 0/9950 (0.0000%)
saving model
Done in 657.954681634903 sec.
Server Epoch:88 choose agents : [4, 42, 28, 74, 13, 49, 24, 34, 87, 86].
_Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   1, Avg loss: 0.0585, Accuracy: 342/901 (37.9578%)
_Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   2, Avg loss: 0.0326, Accuracy: 388/901 (43.0633%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.3933, Accuracy: 53/10000 (0.5300%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   1, Avg loss: 0.0523, Accuracy: 352/1372 (25.6560%)
_Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 539/1372 (39.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.2661, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0554, Accuracy: 386/1581 (24.4149%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 593/1581 (37.5079%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.8732, Accuracy: 95/10000 (0.9500%)
poison local model 74 index 26 
_Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 471/1552 (30.3479%)
_Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 779/1552 (50.1933%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 11.6475, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   1, Avg loss: 0.0587, Accuracy: 297/1645 (18.0547%)
_Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 568/1645 (34.5289%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.1842, Accuracy: 100/10000 (1.0000%)
poison local model 49 index 18 
_Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   1, Avg loss: 0.0797, Accuracy: 29/440 (6.5909%)
_Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   2, Avg loss: 0.0473, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.9375, Accuracy: 50/10000 (0.5000%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   1, Avg loss: 0.0781, Accuracy: 36/312 (11.5385%)
_Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   2, Avg loss: 0.0408, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.6666, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 381/1427 (26.6994%)
_Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 585/1427 (40.9951%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.2678, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   1, Avg loss: 0.0584, Accuracy: 299/1131 (26.4368%)
_Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   2, Avg loss: 0.0322, Accuracy: 399/1131 (35.2785%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.2479, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0629, Accuracy: 361/1003 (35.9920%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0349, Accuracy: 379/1003 (37.7866%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.7227, Accuracy: 50/10000 (0.5000%)
time spent on training: 314.4351055622101
[rfa agg] training data poison_ratio: 0.3234776487152411  data num: [901, 1372, 1581, 1552, 1645, 440, 312, 1427, 1131, 1003]
[rfa agg] considering poison per batch poison_fraction: 0.20217353044702568
[rfa agg] init. name: [4, 42, 28, 74, 13, 49, 24, 34, 87, 86], weight: tensor([0.0793, 0.1207, 0.1391, 0.1366, 0.1448, 0.0387, 0.0275, 0.1256, 0.0995,
        0.0883])
[rfa agg] iter:  0, prev_obj_val: 49.684837341308594, obj_val: 51.64012908935547, abs dis: 1.955291748046875
[rfa agg] iter: 0, weight: tensor([0.0873, 0.1003, 0.0672, 0.0660, 0.0614, 0.0120, 0.0072, 0.0844, 0.3746,
        0.1397])
[rfa agg] iter:  1, prev_obj_val: 51.64012908935547, obj_val: 56.42347717285156, abs dis: 4.783348083496094
[rfa agg] iter: 1, weight: tensor([0.0960, 0.0835, 0.0588, 0.0577, 0.0541, 0.0118, 0.0070, 0.0719, 0.3926,
        0.1667])
[rfa agg] iter:  2, prev_obj_val: 56.42347717285156, obj_val: 58.964111328125, abs dis: 2.5406341552734375
[rfa agg] iter: 2, weight: tensor([0.1543, 0.0722, 0.0545, 0.0534, 0.0508, 0.0136, 0.0080, 0.0640, 0.2055,
        0.3237])
[rfa agg] iter:  3, prev_obj_val: 58.964111328125, obj_val: 58.9378547668457, abs dis: 0.026256561279296875
[rfa agg] iter: 3, weight: tensor([0.1822, 0.0570, 0.0442, 0.0434, 0.0414, 0.0123, 0.0072, 0.0511, 0.1325,
        0.4286])
[rfa agg] iter:  4, prev_obj_val: 58.9378547668457, obj_val: 56.356998443603516, abs dis: 2.5808563232421875
[rfa agg] iter: 4, weight: tensor([0.1698, 0.0528, 0.0409, 0.0402, 0.0384, 0.0114, 0.0066, 0.0474, 0.1207,
        0.4718])
[rfa agg] iter:  5, prev_obj_val: 56.356998443603516, obj_val: 58.94633865356445, abs dis: 2.5893402099609375
[rfa agg] iter: 5, weight: tensor([0.1438, 0.0657, 0.0496, 0.0486, 0.0462, 0.0124, 0.0073, 0.0583, 0.1721,
        0.3960])
[rfa agg] iter:  6, prev_obj_val: 58.94633865356445, obj_val: 56.3546142578125, abs dis: 2.591724395751953
[rfa agg] iter: 6, weight: tensor([0.1722, 0.0543, 0.0421, 0.0413, 0.0395, 0.0117, 0.0068, 0.0487, 0.1252,
        0.4582])
[rfa agg] iter:  7, prev_obj_val: 56.3546142578125, obj_val: 58.94685745239258, abs dis: 2.592243194580078
[rfa agg] iter: 7, weight: tensor([0.1446, 0.0660, 0.0498, 0.0488, 0.0464, 0.0124, 0.0073, 0.0585, 0.1732,
        0.3930])
[rfa agg] iter:  8, prev_obj_val: 58.94685745239258, obj_val: 56.35443878173828, abs dis: 2.592418670654297
[rfa agg] iter: 8, weight: tensor([0.1727, 0.0544, 0.0422, 0.0414, 0.0395, 0.0118, 0.0068, 0.0488, 0.1255,
        0.4569])
[rfa agg] iter:  9, prev_obj_val: 56.35443878173828, obj_val: 58.94690704345703, abs dis: 2.59246826171875
[rfa agg] iter: 9, weight: tensor([0.1447, 0.0660, 0.0498, 0.0489, 0.0464, 0.0124, 0.0073, 0.0586, 0.1733,
        0.3927])
			Update norm = 144.35070818366287 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3175, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.3637, Accuracy: 0/9950 (0.0000%)
saving model
Done in 719.5476424694061 sec.
Server Epoch:89 choose agents : [84, 89, 29, 52, 37, 30, 66, 62, 88, 42].
poison local model 84 index 29 
_Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 318/1190 (26.7227%)
_Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 448/1190 (37.6471%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.3394, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0608, Accuracy: 337/896 (37.6116%)
_Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 435/896 (48.5491%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.5421, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 447/1440 (31.0417%)
_Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 692/1440 (48.0556%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.4126, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   1, Avg loss: 0.0573, Accuracy: 282/636 (44.3396%)
_Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   2, Avg loss: 0.0321, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.1737, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   1, Avg loss: 0.0524, Accuracy: 380/1129 (33.6581%)
_Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   2, Avg loss: 0.0243, Accuracy: 722/1129 (63.9504%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.2301, Accuracy: 107/10000 (1.0700%)
poison local model 30 index 11 
_Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   1, Avg loss: 0.0766, Accuracy: 91/486 (18.7243%)
_Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 214/486 (44.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.3394, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 260/1402 (18.5449%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 401/1402 (28.6020%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.2951, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 144/568 (25.3521%)
_Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   2, Avg loss: 0.0398, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.0024, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   1, Avg loss: 0.0685, Accuracy: 181/603 (30.0166%)
_Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   2, Avg loss: 0.0442, Accuracy: 280/603 (46.4345%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.6534, Accuracy: 53/10000 (0.5300%)
poison local model 42 index 15 
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 348/1372 (25.3644%)
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0307, Accuracy: 546/1372 (39.7959%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.3560, Accuracy: 84/10000 (0.8400%)
time spent on training: 288.2041013240814
[rfa agg] training data poison_ratio: 0.42964410615099774  data num: [1190, 896, 1440, 636, 1129, 486, 1402, 568, 603, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.2685275663443736
[rfa agg] init. name: [84, 89, 29, 52, 37, 30, 66, 62, 88, 42], weight: tensor([0.1224, 0.0922, 0.1481, 0.0654, 0.1161, 0.0500, 0.1442, 0.0584, 0.0620,
        0.1411])
[rfa agg] iter:  0, prev_obj_val: 48.072357177734375, obj_val: 51.20648956298828, abs dis: 3.1341323852539062
[rfa agg] iter: 0, weight: tensor([0.1453, 0.2302, 0.0847, 0.0510, 0.1856, 0.0287, 0.0949, 0.0386, 0.0483,
        0.0928])
[rfa agg] iter:  1, prev_obj_val: 51.20648956298828, obj_val: 52.92839431762695, abs dis: 1.7219047546386719
[rfa agg] iter: 1, weight: tensor([0.1016, 0.3893, 0.0662, 0.0549, 0.1223, 0.0293, 0.0729, 0.0403, 0.0519,
        0.0714])
[rfa agg] iter:  2, prev_obj_val: 52.92839431762695, obj_val: 57.282493591308594, abs dis: 4.354099273681641
[rfa agg] iter: 2, weight: tensor([0.0769, 0.5025, 0.0525, 0.0517, 0.0901, 0.0266, 0.0574, 0.0372, 0.0488,
        0.0563])
[rfa agg] iter:  3, prev_obj_val: 57.282493591308594, obj_val: 61.91936111450195, abs dis: 4.636867523193359
[rfa agg] iter: 3, weight: tensor([0.0845, 0.3504, 0.0620, 0.0890, 0.0954, 0.0417, 0.0670, 0.0605, 0.0837,
        0.0657])
[rfa agg] iter:  4, prev_obj_val: 61.91936111450195, obj_val: 66.65702056884766, abs dis: 4.737659454345703
[rfa agg] iter: 4, weight: tensor([0.0809, 0.2061, 0.0628, 0.1451, 0.0892, 0.0579, 0.0671, 0.0892, 0.1359,
        0.0658])
[rfa agg] iter:  5, prev_obj_val: 66.65702056884766, obj_val: 61.912269592285156, abs dis: 4.7447509765625
[rfa agg] iter: 5, weight: tensor([0.0601, 0.1179, 0.0487, 0.2232, 0.0649, 0.0650, 0.0517, 0.1114, 0.2066,
        0.0506])
[rfa agg] iter:  6, prev_obj_val: 61.912269592285156, obj_val: 66.65485382080078, abs dis: 4.742584228515625
[rfa agg] iter: 6, weight: tensor([0.0809, 0.1984, 0.0627, 0.1483, 0.0891, 0.0580, 0.0671, 0.0898, 0.1399,
        0.0657])
[rfa agg] iter:  7, prev_obj_val: 66.65485382080078, obj_val: 61.912353515625, abs dis: 4.742500305175781
[rfa agg] iter: 7, weight: tensor([0.0600, 0.1177, 0.0486, 0.2234, 0.0649, 0.0649, 0.0516, 0.1113, 0.2070,
        0.0505])
[rfa agg] iter:  8, prev_obj_val: 61.912353515625, obj_val: 66.65485382080078, abs dis: 4.742500305175781
[rfa agg] iter: 8, weight: tensor([0.0809, 0.1983, 0.0627, 0.1483, 0.0891, 0.0580, 0.0671, 0.0898, 0.1399,
        0.0657])
[rfa agg] iter:  9, prev_obj_val: 66.65485382080078, obj_val: 61.912357330322266, abs dis: 4.742496490478516
[rfa agg] iter: 9, weight: tensor([0.0600, 0.1177, 0.0486, 0.2234, 0.0649, 0.0649, 0.0516, 0.1113, 0.2070,
        0.0505])
			Update norm = 108.83719564675488 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3175, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.3637, Accuracy: 0/9950 (0.0000%)
saving model
Done in 689.9199454784393 sec.
Server Epoch:90 choose agents : [43, 80, 99, 44, 67, 39, 70, 50, 86, 91].
_Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   1, Avg loss: 0.0617, Accuracy: 306/946 (32.3467%)
_Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 334/946 (35.3066%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.2152, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   1, Avg loss: 0.0654, Accuracy: 189/682 (27.7126%)
_Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   2, Avg loss: 0.0372, Accuracy: 244/682 (35.7771%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.8606, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   1, Avg loss: 0.0656, Accuracy: 195/773 (25.2264%)
_Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   2, Avg loss: 0.0312, Accuracy: 379/773 (49.0298%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.3668, Accuracy: 65/10000 (0.6500%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   1, Avg loss: 0.0584, Accuracy: 386/1750 (22.0571%)
_Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 699/1750 (39.9429%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.6512, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   1, Avg loss: 0.0758, Accuracy: 67/426 (15.7277%)
_Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   2, Avg loss: 0.0405, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.9681, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0539, Accuracy: 311/1013 (30.7009%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 501/1013 (49.4571%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.8342, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 355/1418 (25.0353%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 634/1418 (44.7109%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.9159, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   1, Avg loss: 0.0620, Accuracy: 151/809 (18.6650%)
_Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 345/809 (42.6452%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.8784, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   1, Avg loss: 0.0629, Accuracy: 363/1003 (36.1914%)
_Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 373/1003 (37.1884%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.8750, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   1, Avg loss: 0.0515, Accuracy: 336/1030 (32.6214%)
_Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   2, Avg loss: 0.0282, Accuracy: 636/1030 (61.7476%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.5123, Accuracy: 89/10000 (0.8900%)
time spent on training: 256.4491822719574
[rfa agg] training data poison_ratio: 0.17766497461928935  data num: [946, 682, 773, 1750, 426, 1013, 1418, 809, 1003, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.11104060913705584
[rfa agg] init. name: [43, 80, 99, 44, 67, 39, 70, 50, 86, 91], weight: tensor([0.0960, 0.0692, 0.0785, 0.1777, 0.0432, 0.1028, 0.1440, 0.0821, 0.1018,
        0.1046])
[rfa agg] iter:  0, prev_obj_val: 43.49794006347656, obj_val: 50.24250793457031, abs dis: 6.74456787109375
[rfa agg] iter: 0, weight: tensor([0.2065, 0.0298, 0.0588, 0.0277, 0.0099, 0.2261, 0.0373, 0.0624, 0.2243,
        0.1172])
[rfa agg] iter:  1, prev_obj_val: 50.24250793457031, obj_val: 52.54257583618164, abs dis: 2.300067901611328
[rfa agg] iter: 1, weight: tensor([0.1392, 0.0641, 0.2108, 0.0291, 0.0158, 0.0949, 0.0359, 0.2475, 0.0939,
        0.0689])
[rfa agg] iter:  2, prev_obj_val: 52.54257583618164, obj_val: 58.844635009765625, abs dis: 6.302059173583984
[rfa agg] iter: 2, weight: tensor([0.0897, 0.0661, 0.2583, 0.0234, 0.0142, 0.0660, 0.0284, 0.3384, 0.0653,
        0.0504])
[rfa agg] iter:  3, prev_obj_val: 58.844635009765625, obj_val: 62.25366973876953, abs dis: 3.4090347290039062
[rfa agg] iter: 3, weight: tensor([0.0917, 0.1786, 0.2010, 0.0327, 0.0254, 0.0746, 0.0385, 0.2228, 0.0739,
        0.0606])
[rfa agg] iter:  4, prev_obj_val: 62.25366973876953, obj_val: 65.80670166015625, abs dis: 3.5530319213867188
[rfa agg] iter: 4, weight: tensor([0.0831, 0.3073, 0.1500, 0.0332, 0.0295, 0.0698, 0.0386, 0.1614, 0.0691,
        0.0580])
[rfa agg] iter:  5, prev_obj_val: 65.80670166015625, obj_val: 73.70380401611328, abs dis: 7.897102355957031
[rfa agg] iter: 5, weight: tensor([0.0654, 0.4695, 0.1034, 0.0289, 0.0297, 0.0564, 0.0331, 0.1102, 0.0558,
        0.0477])
[rfa agg] iter:  6, prev_obj_val: 73.70380401611328, obj_val: 62.245635986328125, abs dis: 11.458168029785156
[rfa agg] iter: 6, weight: tensor([0.0858, 0.2988, 0.1152, 0.0445, 0.0641, 0.0769, 0.0499, 0.1218, 0.0761,
        0.0669])
[rfa agg] iter:  7, prev_obj_val: 62.245635986328125, obj_val: 62.242488861083984, abs dis: 0.003147125244140625
[rfa agg] iter: 7, weight: tensor([0.0815, 0.3244, 0.1448, 0.0326, 0.0290, 0.0685, 0.0379, 0.1567, 0.0678,
        0.0569])
			Update norm = 104.515123942961 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3175, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.3637, Accuracy: 0/9950 (0.0000%)
saving model
Done in 656.002950668335 sec.
Server Epoch:91 choose agents : [33, 37, 28, 92, 97, 43, 56, 44, 24, 64].
poison local model 33 index 12 
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0789, Accuracy: 52/515 (10.0971%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0521, Accuracy: 120/515 (23.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.0628, Accuracy: 48/10000 (0.4800%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   1, Avg loss: 0.0520, Accuracy: 398/1129 (35.2524%)
_Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 686/1129 (60.7617%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.9272, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 405/1581 (25.6167%)
_Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 575/1581 (36.3694%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.9349, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 466/1715 (27.1720%)
_Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 724/1715 (42.2157%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.9466, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   1, Avg loss: 0.0514, Accuracy: 367/1213 (30.2556%)
_Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 499/1213 (41.1377%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.5748, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 304/946 (32.1353%)
_Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 342/946 (36.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.3148, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   1, Avg loss: 0.0817, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   2, Avg loss: 0.0666, Accuracy: 73/186 (39.2473%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3559, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 16 
_Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 398/1750 (22.7429%)
_Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   2, Avg loss: 0.0349, Accuracy: 665/1750 (38.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.5993, Accuracy: 116/10000 (1.1600%)
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0777, Accuracy: 28/312 (8.9744%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.6678, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   1, Avg loss: 0.0640, Accuracy: 167/953 (17.5236%)
_Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   2, Avg loss: 0.0383, Accuracy: 311/953 (32.6338%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.8035, Accuracy: 67/10000 (0.6700%)
time spent on training: 299.4030203819275
[rfa agg] training data poison_ratio: 0.3598058252427184  data num: [515, 1129, 1581, 1715, 1213, 946, 186, 1750, 312, 953]
[rfa agg] considering poison per batch poison_fraction: 0.224878640776699
[rfa agg] init. name: [33, 37, 28, 92, 97, 43, 56, 44, 24, 64], weight: tensor([0.0500, 0.1096, 0.1535, 0.1665, 0.1178, 0.0918, 0.0181, 0.1699, 0.0303,
        0.0925])
[rfa agg] iter:  0, prev_obj_val: 57.44677734375, obj_val: 59.054351806640625, abs dis: 1.607574462890625
[rfa agg] iter: 0, weight: tensor([0.0196, 0.3249, 0.0680, 0.0584, 0.2285, 0.1172, 0.0042, 0.0540, 0.0081,
        0.1172])
[rfa agg] iter:  1, prev_obj_val: 59.054351806640625, obj_val: 60.9428825378418, abs dis: 1.8885307312011719
[rfa agg] iter: 1, weight: tensor([0.0216, 0.3025, 0.0659, 0.0574, 0.1896, 0.1481, 0.0045, 0.0533, 0.0087,
        0.1484])
[rfa agg] iter:  2, prev_obj_val: 60.9428825378418, obj_val: 62.89897537231445, abs dis: 1.9560928344726562
[rfa agg] iter: 2, weight: tensor([0.0239, 0.2334, 0.0644, 0.0567, 0.1608, 0.1970, 0.0048, 0.0529, 0.0094,
        0.1967])
[rfa agg] iter:  3, prev_obj_val: 62.89897537231445, obj_val: 67.40544891357422, abs dis: 4.506473541259766
[rfa agg] iter: 3, weight: tensor([0.0240, 0.1702, 0.0571, 0.0508, 0.1275, 0.2555, 0.0047, 0.0476, 0.0093,
        0.2533])
[rfa agg] iter:  4, prev_obj_val: 67.40544891357422, obj_val: 73.77311706542969, abs dis: 6.367668151855469
[rfa agg] iter: 4, weight: tensor([0.0204, 0.0859, 0.0375, 0.0340, 0.0707, 0.3623, 0.0037, 0.0320, 0.0074,
        0.3461])
[rfa agg] iter:  5, prev_obj_val: 73.77311706542969, obj_val: 67.3642807006836, abs dis: 6.408836364746094
[rfa agg] iter: 5, weight: tensor([0.0375, 0.1005, 0.0525, 0.0483, 0.0876, 0.3060, 0.0062, 0.0458, 0.0127,
        0.3031])
[rfa agg] iter:  6, prev_obj_val: 67.3642807006836, obj_val: 73.77547454833984, abs dis: 6.41119384765625
[rfa agg] iter: 6, weight: tensor([0.0193, 0.0806, 0.0355, 0.0321, 0.0667, 0.3727, 0.0035, 0.0303, 0.0070,
        0.3525])
[rfa agg] iter:  7, prev_obj_val: 73.77547454833984, obj_val: 67.36416625976562, abs dis: 6.411308288574219
[rfa agg] iter: 7, weight: tensor([0.0375, 0.1003, 0.0525, 0.0482, 0.0874, 0.3064, 0.0062, 0.0457, 0.0127,
        0.3032])
[rfa agg] iter:  8, prev_obj_val: 67.36416625976562, obj_val: 73.77548217773438, abs dis: 6.41131591796875
[rfa agg] iter: 8, weight: tensor([0.0193, 0.0806, 0.0354, 0.0321, 0.0667, 0.3728, 0.0035, 0.0302, 0.0070,
        0.3524])
[rfa agg] iter:  9, prev_obj_val: 73.77548217773438, obj_val: 67.36415100097656, abs dis: 6.4113311767578125
[rfa agg] iter: 9, weight: tensor([0.0375, 0.1003, 0.0525, 0.0482, 0.0874, 0.3065, 0.0062, 0.0457, 0.0127,
        0.3032])
			Update norm = 135.52777332986034 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3175, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.3637, Accuracy: 0/9950 (0.0000%)
saving model
Done in 699.5701274871826 sec.
Server Epoch:92 choose agents : [71, 40, 7, 67, 97, 72, 34, 58, 26, 38].
_Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   1, Avg loss: 0.0651, Accuracy: 169/818 (20.6601%)
_Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 380/818 (46.4548%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.5267, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 376/1573 (23.9034%)
_Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 575/1573 (36.5544%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.9955, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   1, Avg loss: 0.0528, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 423/891 (47.4747%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.6808, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0758, Accuracy: 59/426 (13.8498%)
_Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0406, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.9305, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   1, Avg loss: 0.0518, Accuracy: 365/1213 (30.0907%)
_Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   2, Avg loss: 0.0269, Accuracy: 526/1213 (43.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.5408, Accuracy: 88/10000 (0.8800%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 268/1241 (21.5955%)
_Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 413/1241 (33.2796%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.3732, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   1, Avg loss: 0.0571, Accuracy: 373/1427 (26.1388%)
_Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 597/1427 (41.8360%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.2432, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0593, Accuracy: 343/803 (42.7148%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 400/803 (49.8132%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.2467, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 336/1446 (23.2365%)
_Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 481/1446 (33.2642%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.7570, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0613, Accuracy: 245/1131 (21.6622%)
_Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 523/1131 (46.2423%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.6022, Accuracy: 83/10000 (0.8300%)
time spent on training: 282.5268666744232
[rfa agg] training data poison_ratio: 0.11313702251800528  data num: [818, 1573, 891, 426, 1213, 1241, 1427, 803, 1446, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.0707106390737533
[rfa agg] init. name: [71, 40, 7, 67, 97, 72, 34, 58, 26, 38], weight: tensor([0.0746, 0.1434, 0.0812, 0.0388, 0.1106, 0.1131, 0.1301, 0.0732, 0.1318,
        0.1031])
[rfa agg] iter:  0, prev_obj_val: 44.064937591552734, obj_val: 46.08563995361328, abs dis: 2.020702362060547
[rfa agg] iter: 0, weight: tensor([0.0783, 0.0627, 0.1132, 0.0152, 0.1572, 0.1186, 0.0742, 0.0766, 0.0751,
        0.2289])
[rfa agg] iter:  1, prev_obj_val: 46.08563995361328, obj_val: 46.08251190185547, abs dis: 0.0031280517578125
[rfa agg] iter: 1, weight: tensor([0.0954, 0.0623, 0.1443, 0.0169, 0.1403, 0.1096, 0.0725, 0.0932, 0.0734,
        0.1923])
			Update norm = 144.35392838653544 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3175, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.3637, Accuracy: 0/9950 (0.0000%)
saving model
Done in 680.384357213974 sec.
Server Epoch:93 choose agents : [62, 58, 59, 51, 15, 43, 3, 13, 79, 53].
_Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.0685, Accuracy: 152/568 (26.7606%)
_Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.1676, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   1, Avg loss: 0.0583, Accuracy: 346/803 (43.0884%)
_Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 385/803 (47.9452%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.2937, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 336/1089 (30.8540%)
_Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 464/1089 (42.6079%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.1809, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   1, Avg loss: 0.0595, Accuracy: 228/1049 (21.7350%)
_Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   2, Avg loss: 0.0295, Accuracy: 531/1049 (50.6196%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.8815, Accuracy: 85/10000 (0.8500%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0596, Accuracy: 320/1154 (27.7296%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0290, Accuracy: 437/1154 (37.8683%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.1503, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   1, Avg loss: 0.0614, Accuracy: 302/946 (31.9239%)
_Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 351/946 (37.1036%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.3234, Accuracy: 62/10000 (0.6200%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   1, Avg loss: 0.0738, Accuracy: 115/781 (14.7247%)
_Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 222/781 (28.4251%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.4385, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 325/1645 (19.7568%)
_Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 610/1645 (37.0821%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.9492, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   1, Avg loss: 0.1001, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   2, Avg loss: 0.0799, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3841, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   1, Avg loss: 0.0487, Accuracy: 291/813 (35.7934%)
_Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 438/813 (53.8745%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.3025, Accuracy: 51/10000 (0.5100%)
time spent on training: 288.73228192329407
[rfa agg] training data poison_ratio: 0.21393034825870647  data num: [568, 803, 1089, 1049, 1154, 946, 781, 1645, 197, 813]
[rfa agg] considering poison per batch poison_fraction: 0.13370646766169153
[rfa agg] init. name: [62, 58, 59, 51, 15, 43, 3, 13, 79, 53], weight: tensor([0.0628, 0.0888, 0.1204, 0.1160, 0.1276, 0.1046, 0.0863, 0.1819, 0.0218,
        0.0899])
[rfa agg] iter:  0, prev_obj_val: 39.566490173339844, obj_val: 43.415645599365234, abs dis: 3.8491554260253906
[rfa agg] iter: 0, weight: tensor([0.0250, 0.1018, 0.0919, 0.1276, 0.0744, 0.3345, 0.0988, 0.0396, 0.0047,
        0.1017])
[rfa agg] iter:  1, prev_obj_val: 43.415645599365234, obj_val: 55.23523712158203, abs dis: 11.819591522216797
[rfa agg] iter: 1, weight: tensor([0.0281, 0.2207, 0.0532, 0.0652, 0.0463, 0.1330, 0.2125, 0.0295, 0.0046,
        0.2070])
[rfa agg] iter:  2, prev_obj_val: 55.23523712158203, obj_val: 48.234352111816406, abs dis: 7.000885009765625
[rfa agg] iter: 2, weight: tensor([0.0839, 0.1924, 0.0631, 0.0716, 0.0580, 0.1008, 0.1859, 0.0431, 0.0099,
        0.1912])
[rfa agg] iter:  3, prev_obj_val: 48.234352111816406, obj_val: 51.655818939208984, abs dis: 3.421466827392578
[rfa agg] iter: 3, weight: tensor([0.0362, 0.2470, 0.0441, 0.0517, 0.0397, 0.0821, 0.2332, 0.0275, 0.0052,
        0.2332])
[rfa agg] iter:  4, prev_obj_val: 51.655818939208984, obj_val: 55.23335266113281, abs dis: 3.577533721923828
[rfa agg] iter: 4, weight: tensor([0.0565, 0.2180, 0.0546, 0.0629, 0.0497, 0.0931, 0.2087, 0.0357, 0.0075,
        0.2133])
[rfa agg] iter:  5, prev_obj_val: 55.23335266113281, obj_val: 48.23430633544922, abs dis: 6.999046325683594
[rfa agg] iter: 5, weight: tensor([0.0840, 0.1923, 0.0631, 0.0716, 0.0580, 0.1006, 0.1858, 0.0431, 0.0099,
        0.1916])
[rfa agg] iter:  6, prev_obj_val: 48.23430633544922, obj_val: 51.655818939208984, abs dis: 3.4215126037597656
[rfa agg] iter: 6, weight: tensor([0.0362, 0.2470, 0.0441, 0.0517, 0.0397, 0.0821, 0.2332, 0.0275, 0.0052,
        0.2333])
[rfa agg] iter:  7, prev_obj_val: 51.655818939208984, obj_val: 55.23335266113281, abs dis: 3.577533721923828
[rfa agg] iter: 7, weight: tensor([0.0565, 0.2180, 0.0546, 0.0629, 0.0497, 0.0931, 0.2087, 0.0357, 0.0075,
        0.2134])
[rfa agg] iter:  8, prev_obj_val: 55.23335266113281, obj_val: 48.23430633544922, abs dis: 6.999046325683594
[rfa agg] iter: 8, weight: tensor([0.0840, 0.1923, 0.0631, 0.0716, 0.0580, 0.1006, 0.1858, 0.0431, 0.0099,
        0.1916])
[rfa agg] iter:  9, prev_obj_val: 48.23430633544922, obj_val: 51.655818939208984, abs dis: 3.4215126037597656
[rfa agg] iter: 9, weight: tensor([0.0362, 0.2470, 0.0441, 0.0517, 0.0397, 0.0821, 0.2332, 0.0275, 0.0052,
        0.2333])
			Update norm = 108.91284951309694 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3175, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.3637, Accuracy: 0/9950 (0.0000%)
saving model
Done in 691.0891718864441 sec.
Server Epoch:94 choose agents : [51, 3, 17, 5, 55, 92, 4, 75, 35, 60].
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0596, Accuracy: 235/1049 (22.4023%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 519/1049 (49.4757%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.8401, Accuracy: 94/10000 (0.9400%)
poison local model 3 index 1 
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0730, Accuracy: 109/781 (13.9565%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0362, Accuracy: 231/781 (29.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.2628, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 421/1574 (26.7471%)
_Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 665/1574 (42.2490%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.5187, Accuracy: 94/10000 (0.9400%)
poison local model 5 index 2 
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0504, Accuracy: 392/1628 (24.0786%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 787/1628 (48.3415%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.3417, Accuracy: 113/10000 (1.1300%)
poison local model 55 index 20 
_Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   1, Avg loss: 0.0561, Accuracy: 247/1071 (23.0626%)
_Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   2, Avg loss: 0.0294, Accuracy: 489/1071 (45.6583%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.4469, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 468/1715 (27.2886%)
_Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 715/1715 (41.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.6124, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0603, Accuracy: 339/901 (37.6249%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0316, Accuracy: 415/901 (46.0599%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.5688, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   1, Avg loss: 0.0625, Accuracy: 262/776 (33.7629%)
_Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   2, Avg loss: 0.0300, Accuracy: 408/776 (52.5773%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.0701, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.0859, Accuracy: 29/271 (10.7011%)
_Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0552, Accuracy: 119/271 (43.9114%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.5656, Accuracy: 47/10000 (0.4700%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 596/2227 (26.7625%)
_Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1052/2227 (47.2384%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.3948, Accuracy: 127/10000 (1.2700%)
time spent on training: 349.06224274635315
[rfa agg] training data poison_ratio: 0.47586091886934045  data num: [1049, 781, 1574, 1628, 1071, 1715, 901, 776, 271, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.2974130742933378
[rfa agg] init. name: [51, 3, 17, 5, 55, 92, 4, 75, 35, 60], weight: tensor([0.0875, 0.0651, 0.1312, 0.1357, 0.0893, 0.1430, 0.0751, 0.0647, 0.0226,
        0.1857])
[rfa agg] iter:  0, prev_obj_val: 66.15685272216797, obj_val: 67.85962677001953, abs dis: 1.7027740478515625
[rfa agg] iter: 0, weight: tensor([0.1440, 0.0514, 0.1683, 0.1444, 0.1472, 0.1288, 0.0803, 0.0510, 0.0087,
        0.0760])
[rfa agg] iter:  1, prev_obj_val: 67.85962677001953, obj_val: 70.62220764160156, abs dis: 2.7625808715820312
[rfa agg] iter: 1, weight: tensor([0.1846, 0.0554, 0.1303, 0.1149, 0.1887, 0.1048, 0.0913, 0.0550, 0.0087,
        0.0665])
[rfa agg] iter:  2, prev_obj_val: 70.62220764160156, obj_val: 73.06800079345703, abs dis: 2.4457931518554688
[rfa agg] iter: 2, weight: tensor([0.2714, 0.0509, 0.0732, 0.0665, 0.2797, 0.0622, 0.0956, 0.0506, 0.0069,
        0.0431])
[rfa agg] iter:  3, prev_obj_val: 73.06800079345703, obj_val: 74.98934173583984, abs dis: 1.9213409423828125
[rfa agg] iter: 3, weight: tensor([0.3239, 0.0423, 0.0428, 0.0395, 0.3478, 0.0375, 0.0922, 0.0419, 0.0050,
        0.0272])
[rfa agg] iter:  4, prev_obj_val: 74.98934173583984, obj_val: 74.98571014404297, abs dis: 0.003631591796875
[rfa agg] iter: 4, weight: tensor([0.2952, 0.0519, 0.0437, 0.0406, 0.3183, 0.0386, 0.1260, 0.0514, 0.0056,
        0.0286])
[rfa agg] iter:  5, prev_obj_val: 74.98571014404297, obj_val: 77.26322937011719, abs dis: 2.2775192260742188
[rfa agg] iter: 5, weight: tensor([0.2917, 0.0524, 0.0440, 0.0409, 0.3172, 0.0390, 0.1284, 0.0519, 0.0056,
        0.0289])
[rfa agg] iter:  6, prev_obj_val: 77.26322937011719, obj_val: 79.67790985107422, abs dis: 2.4146804809570312
[rfa agg] iter: 6, weight: tensor([0.2374, 0.0700, 0.0480, 0.0449, 0.2502, 0.0429, 0.1980, 0.0693, 0.0068,
        0.0324])
[rfa agg] iter:  7, prev_obj_val: 79.67790985107422, obj_val: 77.26287078857422, abs dis: 2.4150390625
[rfa agg] iter: 7, weight: tensor([0.1769, 0.0850, 0.0465, 0.0436, 0.1840, 0.0419, 0.2985, 0.0840, 0.0073,
        0.0323])
[rfa agg] iter:  8, prev_obj_val: 77.26287078857422, obj_val: 79.67276763916016, abs dis: 2.4098968505859375
[rfa agg] iter: 8, weight: tensor([0.2261, 0.0708, 0.0483, 0.0451, 0.2410, 0.0432, 0.2160, 0.0700, 0.0069,
        0.0326])
[rfa agg] iter:  9, prev_obj_val: 79.67276763916016, obj_val: 77.26361083984375, abs dis: 2.4091567993164062
[rfa agg] iter: 9, weight: tensor([0.1755, 0.0847, 0.0463, 0.0435, 0.1830, 0.0418, 0.3022, 0.0837, 0.0073,
        0.0321])
			Update norm = 144.33658850495948 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3175, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.3637, Accuracy: 0/9950 (0.0000%)
saving model
Done in 749.0188641548157 sec.
Server Epoch:95 choose agents : [54, 15, 1, 87, 63, 69, 60, 22, 43, 45].
poison local model 54 index 19 
_Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 350/1130 (30.9735%)
_Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 463/1130 (40.9735%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.9005, Accuracy: 54/10000 (0.5400%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   1, Avg loss: 0.0559, Accuracy: 330/1154 (28.5962%)
_Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   2, Avg loss: 0.0290, Accuracy: 451/1154 (39.0815%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.4850, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0581, Accuracy: 288/928 (31.0345%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0233, Accuracy: 574/928 (61.8534%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.9284, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   1, Avg loss: 0.0578, Accuracy: 302/1131 (26.7020%)
_Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 419/1131 (37.0469%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.8347, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   1, Avg loss: 0.0557, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 389/888 (43.8063%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.8448, Accuracy: 50/10000 (0.5000%)
poison local model 69 index 24 
_Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   1, Avg loss: 0.0537, Accuracy: 298/590 (50.5085%)
_Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   2, Avg loss: 0.0325, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.7175, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
_Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 566/2227 (25.4154%)
_Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1066/2227 (47.8671%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.4190, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 546/1470 (37.1429%)
_Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 854/1470 (58.0952%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.4243, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 303/946 (32.0296%)
_Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 322/946 (34.0381%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.2938, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   1, Avg loss: 0.0652, Accuracy: 222/669 (33.1839%)
_Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   2, Avg loss: 0.0408, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.1502, Accuracy: 50/10000 (0.5000%)
time spent on training: 341.517062664032
[rfa agg] training data poison_ratio: 0.4581873708793677  data num: [1130, 1154, 928, 1131, 888, 590, 2227, 1470, 946, 669]
[rfa agg] considering poison per batch poison_fraction: 0.2863671067996048
[rfa agg] init. name: [54, 15, 1, 87, 63, 69, 60, 22, 43, 45], weight: tensor([0.1015, 0.1037, 0.0834, 0.1016, 0.0798, 0.0530, 0.2000, 0.1320, 0.0850,
        0.0601])
[rfa agg] iter:  0, prev_obj_val: 54.557003021240234, obj_val: 56.99543762207031, abs dis: 2.438434600830078
[rfa agg] iter: 0, weight: tensor([0.2386, 0.2250, 0.0549, 0.2537, 0.0414, 0.0147, 0.0287, 0.0681, 0.0560,
        0.0189])
[rfa agg] iter:  1, prev_obj_val: 56.99543762207031, obj_val: 61.40190124511719, abs dis: 4.406463623046875
[rfa agg] iter: 1, weight: tensor([0.1777, 0.1163, 0.1409, 0.1837, 0.0896, 0.0240, 0.0319, 0.0593, 0.1448,
        0.0319])
[rfa agg] iter:  2, prev_obj_val: 61.40190124511719, obj_val: 69.47219848632812, abs dis: 8.070297241210938
[rfa agg] iter: 2, weight: tensor([0.0763, 0.0587, 0.2472, 0.0768, 0.1515, 0.0245, 0.0233, 0.0382, 0.2692,
        0.0344])
[rfa agg] iter:  3, prev_obj_val: 69.47219848632812, obj_val: 72.7618637084961, abs dis: 3.2896652221679688
[rfa agg] iter: 3, weight: tensor([0.0683, 0.0570, 0.1552, 0.0684, 0.3016, 0.0459, 0.0286, 0.0426, 0.1614,
        0.0711])
[rfa agg] iter:  4, prev_obj_val: 72.7618637084961, obj_val: 66.32613372802734, abs dis: 6.43572998046875
[rfa agg] iter: 4, weight: tensor([0.0728, 0.0618, 0.1414, 0.0729, 0.2574, 0.0630, 0.0330, 0.0478, 0.1465,
        0.1033])
[rfa agg] iter:  5, prev_obj_val: 66.32613372802734, obj_val: 72.76931762695312, abs dis: 6.443183898925781
[rfa agg] iter: 5, weight: tensor([0.0609, 0.0497, 0.1617, 0.0610, 0.3556, 0.0321, 0.0233, 0.0358, 0.1720,
        0.0480])
[rfa agg] iter:  6, prev_obj_val: 72.76931762695312, obj_val: 66.32552337646484, abs dis: 6.443794250488281
[rfa agg] iter: 6, weight: tensor([0.0725, 0.0616, 0.1408, 0.0726, 0.2605, 0.0627, 0.0329, 0.0476, 0.1462,
        0.1026])
[rfa agg] iter:  7, prev_obj_val: 66.32552337646484, obj_val: 72.76941680908203, abs dis: 6.4438934326171875
[rfa agg] iter: 7, weight: tensor([0.0608, 0.0496, 0.1614, 0.0609, 0.3566, 0.0321, 0.0233, 0.0357, 0.1717,
        0.0479])
[rfa agg] iter:  8, prev_obj_val: 72.76941680908203, obj_val: 66.32550811767578, abs dis: 6.44390869140625
[rfa agg] iter: 8, weight: tensor([0.0725, 0.0616, 0.1408, 0.0726, 0.2605, 0.0627, 0.0329, 0.0476, 0.1461,
        0.1026])
[rfa agg] iter:  9, prev_obj_val: 66.32550811767578, obj_val: 72.76942443847656, abs dis: 6.443916320800781
[rfa agg] iter: 9, weight: tensor([0.0608, 0.0496, 0.1614, 0.0609, 0.3566, 0.0321, 0.0233, 0.0357, 0.1717,
        0.0479])
			Update norm = 117.80446341952626 is too large. Update rejected
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3175, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.3637, Accuracy: 0/9950 (0.0000%)
saving model
Done in 737.1930246353149 sec.
Server Epoch:96 choose agents : [12, 11, 52, 2, 65, 23, 68, 97, 82, 9].
poison local model 12 index 5 
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0851, Accuracy: 27/338 (7.9882%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0477, Accuracy: 151/338 (44.6746%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.6969, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0573, Accuracy: 342/712 (48.0337%)
_Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0236, Accuracy: 460/712 (64.6067%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.0595, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   1, Avg loss: 0.0575, Accuracy: 286/636 (44.9686%)
_Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   2, Avg loss: 0.0316, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.9815, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0579, Accuracy: 276/605 (45.6198%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0383, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.2976, Accuracy: 61/10000 (0.6100%)
poison local model 65 index 23 
_Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   1, Avg loss: 0.0558, Accuracy: 401/1475 (27.1864%)
_Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   2, Avg loss: 0.0338, Accuracy: 665/1475 (45.0847%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.3034, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   1, Avg loss: 0.0604, Accuracy: 330/715 (46.1538%)
_Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   2, Avg loss: 0.0396, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.8991, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   1, Avg loss: 0.0631, Accuracy: 367/1163 (31.5563%)
_Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 426/1163 (36.6294%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.3555, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   1, Avg loss: 0.0517, Accuracy: 362/1213 (29.8434%)
_Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 491/1213 (40.4782%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.2539, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0748, Accuracy: 81/500 (16.2000%)
_Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.1079, Accuracy: 50/10000 (0.5000%)
poison local model 9 index 3 
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0500, Accuracy: 365/1275 (28.6275%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 705/1275 (55.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.8924, Accuracy: 90/10000 (0.9000%)
time spent on training: 278.22927594184875
[rfa agg] training data poison_ratio: 0.3577386468952734  data num: [338, 712, 636, 605, 1475, 715, 1163, 1213, 500, 1275]
[rfa agg] considering poison per batch poison_fraction: 0.22358665430954588
[rfa agg] init. name: [12, 11, 52, 2, 65, 23, 68, 97, 82, 9], weight: tensor([0.0392, 0.0825, 0.0737, 0.0701, 0.1709, 0.0828, 0.1347, 0.1405, 0.0579,
        0.1477])
[rfa agg] iter:  0, prev_obj_val: 51.035804748535156, obj_val: 58.30364990234375, abs dis: 7.267845153808594
[rfa agg] iter: 0, weight: tensor([0.0213, 0.2053, 0.0844, 0.0805, 0.0663, 0.2049, 0.0987, 0.1035, 0.0428,
        0.0922])
[rfa agg] iter:  1, prev_obj_val: 58.30364990234375, obj_val: 69.97714233398438, abs dis: 11.673492431640625
[rfa agg] iter: 1, weight: tensor([0.0219, 0.2022, 0.1747, 0.1662, 0.0369, 0.2021, 0.0471, 0.0493, 0.0535,
        0.0460])
[rfa agg] iter:  2, prev_obj_val: 69.97714233398438, obj_val: 69.95439910888672, abs dis: 0.02274322509765625
[rfa agg] iter: 2, weight: tensor([0.0435, 0.0917, 0.2178, 0.2054, 0.0385, 0.0920, 0.0454, 0.0475, 0.1729,
        0.0454])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3203, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.3677, Accuracy: 0/9950 (0.0000%)
saving model
Done in 678.6892528533936 sec.
Server Epoch:97 choose agents : [80, 34, 72, 81, 41, 77, 71, 35, 7, 4].
_Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   1, Avg loss: 0.0659, Accuracy: 180/682 (26.3930%)
_Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 245/682 (35.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.9329, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 367/1427 (25.7183%)
_Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0337, Accuracy: 553/1427 (38.7526%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.3723, Accuracy: 69/10000 (0.6900%)
poison local model 72 index 25 
_Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 248/1241 (19.9839%)
_Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0372, Accuracy: 399/1241 (32.1515%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.5920, Accuracy: 65/10000 (0.6500%)
poison local model 81 index 28 
_Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   1, Avg loss: 0.0685, Accuracy: 241/774 (31.1370%)
_Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   2, Avg loss: 0.0343, Accuracy: 321/774 (41.4729%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.8805, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0608, Accuracy: 331/719 (46.0362%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0323, Accuracy: 453/719 (63.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.6909, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   1, Avg loss: 0.0528, Accuracy: 349/1340 (26.0448%)
_Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 531/1340 (39.6269%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.7462, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   1, Avg loss: 0.0652, Accuracy: 154/818 (18.8264%)
_Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   2, Avg loss: 0.0311, Accuracy: 320/818 (39.1198%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.5745, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0854, Accuracy: 29/271 (10.7011%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0555, Accuracy: 110/271 (40.5904%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.5820, Accuracy: 40/10000 (0.4000%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0541, Accuracy: 349/891 (39.1695%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 440/891 (49.3827%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.7716, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   1, Avg loss: 0.0633, Accuracy: 323/901 (35.8491%)
_Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   2, Avg loss: 0.0310, Accuracy: 399/901 (44.2841%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.0740, Accuracy: 50/10000 (0.5000%)
time spent on training: 275.2460925579071
[rfa agg] training data poison_ratio: 0.2223080317740512  data num: [682, 1427, 1241, 774, 719, 1340, 818, 271, 891, 901]
[rfa agg] considering poison per batch poison_fraction: 0.138942519858782
[rfa agg] init. name: [80, 34, 72, 81, 41, 77, 71, 35, 7, 4], weight: tensor([0.0752, 0.1574, 0.1369, 0.0854, 0.0793, 0.1478, 0.0902, 0.0299, 0.0983,
        0.0994])
[rfa agg] iter:  0, prev_obj_val: 39.397274017333984, obj_val: 47.1837043762207, abs dis: 7.786430358886719
[rfa agg] iter: 0, weight: tensor([0.0544, 0.0385, 0.0501, 0.1473, 0.0818, 0.0464, 0.1557, 0.0073, 0.2434,
        0.1750])
[rfa agg] iter:  1, prev_obj_val: 47.1837043762207, obj_val: 50.32388687133789, abs dis: 3.1401824951171875
[rfa agg] iter: 1, weight: tensor([0.1408, 0.0322, 0.0384, 0.1550, 0.2454, 0.0369, 0.1648, 0.0096, 0.1041,
        0.0729])
[rfa agg] iter:  2, prev_obj_val: 50.32388687133789, obj_val: 57.76309585571289, abs dis: 7.439208984375
[rfa agg] iter: 2, weight: tensor([0.2257, 0.0326, 0.0383, 0.1239, 0.2471, 0.0370, 0.1295, 0.0109, 0.0886,
        0.0663])
[rfa agg] iter:  3, prev_obj_val: 57.76309585571289, obj_val: 57.74634552001953, abs dis: 0.016750335693359375
[rfa agg] iter: 3, weight: tensor([0.3220, 0.0401, 0.0459, 0.1052, 0.1575, 0.0448, 0.1105, 0.0173, 0.0870,
        0.0696])
[rfa agg] iter:  4, prev_obj_val: 57.74634552001953, obj_val: 57.74598693847656, abs dis: 0.00035858154296875
[rfa agg] iter: 4, weight: tensor([0.3425, 0.0392, 0.0448, 0.1022, 0.1506, 0.0437, 0.1074, 0.0168, 0.0849,
        0.0679])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3231, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.3830, Accuracy: 0/9950 (0.0000%)
saving model
Done in 677.4347302913666 sec.
Server Epoch:98 choose agents : [24, 6, 1, 16, 62, 2, 87, 17, 43, 18].
poison local model 24 index 9 
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.0784, Accuracy: 25/312 (8.0128%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.6937, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 382/1956 (19.5297%)
_Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   2, Avg loss: 0.0315, Accuracy: 658/1956 (33.6401%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.1761, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   1, Avg loss: 0.0575, Accuracy: 283/928 (30.4957%)
_Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 565/928 (60.8836%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.3819, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0592, Accuracy: 287/708 (40.5367%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0399, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.3351, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0686, Accuracy: 151/568 (26.5845%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0409, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.2797, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   1, Avg loss: 0.0566, Accuracy: 292/605 (48.2645%)
_Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   2, Avg loss: 0.0388, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.4696, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0575, Accuracy: 299/1131 (26.4368%)
_Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 426/1131 (37.6658%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.0921, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 390/1574 (24.7776%)
_Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 667/1574 (42.3761%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.4396, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 298/946 (31.5011%)
_Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 332/946 (35.0951%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.3207, Accuracy: 55/10000 (0.5500%)
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   1, Avg loss: 0.0706, Accuracy: 152/530 (28.6792%)
_Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   2, Avg loss: 0.0369, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.8214, Accuracy: 66/10000 (0.6600%)
time spent on training: 290.9252989292145
[rfa agg] training data poison_ratio: 0.09094836897818104  data num: [312, 1956, 928, 708, 568, 605, 1131, 1574, 946, 530]
[rfa agg] considering poison per batch poison_fraction: 0.05684273061136315
[rfa agg] init. name: [24, 6, 1, 16, 62, 2, 87, 17, 43, 18], weight: tensor([0.0337, 0.2113, 0.1002, 0.0765, 0.0614, 0.0653, 0.1222, 0.1700, 0.1022,
        0.0572])
[rfa agg] iter:  0, prev_obj_val: 63.83580780029297, obj_val: 64.89723205566406, abs dis: 1.0614242553710938
[rfa agg] iter: 0, weight: tensor([0.0094, 0.0543, 0.1306, 0.0480, 0.0251, 0.0302, 0.4638, 0.0784, 0.1369,
        0.0234])
[rfa agg] iter:  1, prev_obj_val: 64.89723205566406, obj_val: 69.2794418334961, abs dis: 4.382209777832031
[rfa agg] iter: 1, weight: tensor([0.0087, 0.0342, 0.2752, 0.0642, 0.0264, 0.0336, 0.1046, 0.0440, 0.3846,
        0.0246])
[rfa agg] iter:  2, prev_obj_val: 69.2794418334961, obj_val: 72.9507827758789, abs dis: 3.6713409423828125
[rfa agg] iter: 2, weight: tensor([0.0145, 0.0443, 0.2194, 0.1689, 0.0496, 0.0672, 0.0983, 0.0541, 0.2373,
        0.0463])
[rfa agg] iter:  3, prev_obj_val: 72.9507827758789, obj_val: 72.91337585449219, abs dis: 0.03740692138671875
[rfa agg] iter: 3, weight: tensor([0.0157, 0.0400, 0.1342, 0.3401, 0.0606, 0.0887, 0.0771, 0.0476, 0.1395,
        0.0566])
[rfa agg] iter:  4, prev_obj_val: 72.91337585449219, obj_val: 79.74469757080078, abs dis: 6.831321716308594
[rfa agg] iter: 4, weight: tensor([0.0149, 0.0380, 0.1264, 0.3739, 0.0577, 0.0847, 0.0733, 0.0452, 0.1318,
        0.0539])
[rfa agg] iter:  5, prev_obj_val: 79.74469757080078, obj_val: 79.72632598876953, abs dis: 0.01837158203125
[rfa agg] iter: 5, weight: tensor([0.0201, 0.0380, 0.0881, 0.2518, 0.1061, 0.2003, 0.0624, 0.0436, 0.0906,
        0.0991])
[rfa agg] iter:  6, prev_obj_val: 79.72632598876953, obj_val: 82.28038024902344, abs dis: 2.5540542602539062
[rfa agg] iter: 6, weight: tensor([0.0201, 0.0378, 0.0877, 0.2448, 0.1063, 0.2078, 0.0622, 0.0435, 0.0903,
        0.0996])
[rfa agg] iter:  7, prev_obj_val: 82.28038024902344, obj_val: 82.27085876464844, abs dis: 0.009521484375
[rfa agg] iter: 7, weight: tensor([0.0201, 0.0340, 0.0722, 0.1596, 0.1273, 0.3006, 0.0535, 0.0387, 0.0742,
        0.1197])
[rfa agg] iter:  8, prev_obj_val: 82.27085876464844, obj_val: 82.27072143554688, abs dis: 0.0001373291015625
[rfa agg] iter: 8, weight: tensor([0.0198, 0.0334, 0.0708, 0.1548, 0.1250, 0.3148, 0.0526, 0.0380, 0.0728,
        0.1181])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3267, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.3946, Accuracy: 0/9950 (0.0000%)
saving model
Done in 689.7123355865479 sec.
Server Epoch:99 choose agents : [18, 14, 2, 45, 63, 95, 90, 4, 23, 8].
poison local model 18 index 7 
_Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   1, Avg loss: 0.0681, Accuracy: 145/530 (27.3585%)
_Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   2, Avg loss: 0.0371, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.7788, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 216/1013 (21.3228%)
_Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 321/1013 (31.6881%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.9807, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   1, Avg loss: 0.0570, Accuracy: 300/605 (49.5868%)
_Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   2, Avg loss: 0.0366, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.6049, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   1, Avg loss: 0.0660, Accuracy: 210/669 (31.3901%)
_Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   2, Avg loss: 0.0401, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.1100, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   1, Avg loss: 0.0556, Accuracy: 258/888 (29.0541%)
_Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 405/888 (45.6081%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.8215, Accuracy: 52/10000 (0.5200%)
poison local model 95 index 31 
_Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0519, Accuracy: 338/599 (56.4274%)
_Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0281, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.1330, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   1, Avg loss: 0.0506, Accuracy: 346/677 (51.1078%)
_Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   2, Avg loss: 0.0236, Accuracy: 401/677 (59.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.1896, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   1, Avg loss: 0.0594, Accuracy: 338/901 (37.5139%)
_Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   2, Avg loss: 0.0309, Accuracy: 422/901 (46.8368%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.6881, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0590, Accuracy: 319/715 (44.6154%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0405, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.9974, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 252/1513 (16.6557%)
_Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 481/1513 (31.7911%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.1299, Accuracy: 80/10000 (0.8000%)
time spent on training: 281.38067841529846
[rfa agg] training data poison_ratio: 0.13921085080147966  data num: [530, 1013, 605, 669, 888, 599, 677, 901, 715, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.08700678175092479
[rfa agg] init. name: [18, 14, 2, 45, 63, 95, 90, 4, 23, 8], weight: tensor([0.0654, 0.1249, 0.0746, 0.0825, 0.1095, 0.0739, 0.0835, 0.1111, 0.0882,
        0.1866])
[rfa agg] iter:  0, prev_obj_val: 36.56846618652344, obj_val: 44.018714904785156, abs dis: 7.450248718261719
[rfa agg] iter: 0, weight: tensor([0.0427, 0.0614, 0.0701, 0.1387, 0.1040, 0.0707, 0.1433, 0.0720, 0.2662,
        0.0309])
[rfa agg] iter:  1, prev_obj_val: 44.018714904785156, obj_val: 55.41913604736328, abs dis: 11.400421142578125
[rfa agg] iter: 1, weight: tensor([0.1030, 0.0369, 0.1862, 0.1276, 0.0482, 0.2284, 0.1306, 0.0393, 0.0761,
        0.0237])
[rfa agg] iter:  2, prev_obj_val: 55.41913604736328, obj_val: 55.400386810302734, abs dis: 0.018749237060546875
[rfa agg] iter: 2, weight: tensor([0.2711, 0.0487, 0.1353, 0.0946, 0.0581, 0.1381, 0.0961, 0.0499, 0.0727,
        0.0353])
[rfa agg] iter:  3, prev_obj_val: 55.400386810302734, obj_val: 51.18785858154297, abs dis: 4.212528228759766
[rfa agg] iter: 3, weight: tensor([0.2908, 0.0476, 0.1311, 0.0922, 0.0568, 0.1335, 0.0937, 0.0488, 0.0711,
        0.0345])
[rfa agg] iter:  4, prev_obj_val: 51.18785858154297, obj_val: 55.40192413330078, abs dis: 4.2140655517578125
[rfa agg] iter: 4, weight: tensor([0.3493, 0.0377, 0.1326, 0.0838, 0.0461, 0.1387, 0.0855, 0.0390, 0.0610,
        0.0263])
[rfa agg] iter:  5, prev_obj_val: 55.40192413330078, obj_val: 51.18720626831055, abs dis: 4.214717864990234
[rfa agg] iter: 5, weight: tensor([0.2997, 0.0470, 0.1293, 0.0910, 0.0561, 0.1318, 0.0926, 0.0482, 0.0703,
        0.0341])
[rfa agg] iter:  6, prev_obj_val: 51.18720626831055, obj_val: 55.402069091796875, abs dis: 4.214862823486328
[rfa agg] iter: 6, weight: tensor([0.3522, 0.0375, 0.1319, 0.0835, 0.0459, 0.1381, 0.0852, 0.0388, 0.0607,
        0.0262])
[rfa agg] iter:  7, prev_obj_val: 55.402069091796875, obj_val: 51.18718338012695, abs dis: 4.214885711669922
[rfa agg] iter: 7, weight: tensor([0.3001, 0.0470, 0.1292, 0.0909, 0.0561, 0.1317, 0.0925, 0.0482, 0.0702,
        0.0341])
[rfa agg] iter:  8, prev_obj_val: 51.18718338012695, obj_val: 55.402076721191406, abs dis: 4.214893341064453
[rfa agg] iter: 8, weight: tensor([0.3524, 0.0375, 0.1319, 0.0834, 0.0459, 0.1381, 0.0851, 0.0388, 0.0607,
        0.0262])
[rfa agg] iter:  9, prev_obj_val: 55.402076721191406, obj_val: 51.18718719482422, abs dis: 4.2148895263671875
[rfa agg] iter: 9, weight: tensor([0.3001, 0.0470, 0.1292, 0.0909, 0.0561, 0.1317, 0.0925, 0.0482, 0.0702,
        0.0341])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3297, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.4100, Accuracy: 0/9950 (0.0000%)
saving model
Done in 679.4858682155609 sec.
Server Epoch:100 choose agents : [57, 53, 36, 10, 37, 13, 40, 62, 39, 80].
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0556, Accuracy: 301/1154 (26.0832%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0270, Accuracy: 496/1154 (42.9809%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.6970, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 263/813 (32.3493%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 448/813 (55.1046%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.3622, Accuracy: 50/10000 (0.5000%)
poison local model 36 index 13 
_Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   1, Avg loss: 0.0829, Accuracy: 79/408 (19.3627%)
_Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   2, Avg loss: 0.0499, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.0257, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
_Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   1, Avg loss: 0.0552, Accuracy: 209/861 (24.2741%)
_Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   2, Avg loss: 0.0208, Accuracy: 469/861 (54.4715%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.8864, Accuracy: 72/10000 (0.7200%)
poison local model 37 index 14 
_Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0514, Accuracy: 402/1129 (35.6067%)
_Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 756/1129 (66.9619%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4279, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   1, Avg loss: 0.0586, Accuracy: 292/1645 (17.7508%)
_Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 643/1645 (39.0881%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.8493, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0554, Accuracy: 338/1573 (21.4876%)
_Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0343, Accuracy: 581/1573 (36.9358%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7978, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   1, Avg loss: 0.0680, Accuracy: 144/568 (25.3521%)
_Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   2, Avg loss: 0.0411, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.2461, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0543, Accuracy: 307/1013 (30.3060%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0263, Accuracy: 484/1013 (47.7789%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7349, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   1, Avg loss: 0.0635, Accuracy: 187/682 (27.4194%)
_Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   2, Avg loss: 0.0374, Accuracy: 229/682 (33.5777%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.9845, Accuracy: 65/10000 (0.6500%)
time spent on training: 311.65379667282104
[rfa agg] training data poison_ratio: 0.2435506804793825  data num: [1154, 813, 408, 861, 1129, 1645, 1573, 568, 1013, 682]
[rfa agg] considering poison per batch poison_fraction: 0.15221917529961407
[rfa agg] init. name: [57, 53, 36, 10, 37, 13, 40, 62, 39, 80], weight: tensor([0.1172, 0.0826, 0.0414, 0.0874, 0.1147, 0.1671, 0.1598, 0.0577, 0.1029,
        0.0693])
[rfa agg] iter:  0, prev_obj_val: 48.200836181640625, obj_val: 52.09550476074219, abs dis: 3.8946685791015625
[rfa agg] iter: 0, weight: tensor([0.1067, 0.0760, 0.0131, 0.1174, 0.1486, 0.0473, 0.0502, 0.0234, 0.3783,
        0.0391])
[rfa agg] iter:  1, prev_obj_val: 52.09550476074219, obj_val: 55.743892669677734, abs dis: 3.648387908935547
[rfa agg] iter: 1, weight: tensor([0.0755, 0.1443, 0.0163, 0.3033, 0.0939, 0.0428, 0.0448, 0.0308, 0.1912,
        0.0572])
[rfa agg] iter:  2, prev_obj_val: 55.743892669677734, obj_val: 63.65456771850586, abs dis: 7.910675048828125
[rfa agg] iter: 2, weight: tensor([0.0556, 0.2588, 0.0168, 0.3213, 0.0661, 0.0353, 0.0366, 0.0337, 0.1050,
        0.0708])
[rfa agg] iter:  3, prev_obj_val: 63.65456771850586, obj_val: 60.75453567504883, abs dis: 2.9000320434570312
[rfa agg] iter: 3, weight: tensor([0.0584, 0.2513, 0.0290, 0.1492, 0.0665, 0.0419, 0.0431, 0.0666, 0.0889,
        0.2051])
[rfa agg] iter:  4, prev_obj_val: 60.75453567504883, obj_val: 69.73172760009766, abs dis: 8.977191925048828
[rfa agg] iter: 4, weight: tensor([0.0550, 0.3432, 0.0231, 0.1654, 0.0633, 0.0380, 0.0392, 0.0503, 0.0883,
        0.1342])
[rfa agg] iter:  5, prev_obj_val: 69.73172760009766, obj_val: 76.58853912353516, abs dis: 6.8568115234375
[rfa agg] iter: 5, weight: tensor([0.0485, 0.1337, 0.0342, 0.0951, 0.0541, 0.0370, 0.0379, 0.0929, 0.0677,
        0.3987])
[rfa agg] iter:  6, prev_obj_val: 76.58853912353516, obj_val: 69.67960357666016, abs dis: 6.908935546875
[rfa agg] iter: 6, weight: tensor([0.0532, 0.1107, 0.0559, 0.0885, 0.0584, 0.0428, 0.0436, 0.2125, 0.0698,
        0.2647])
[rfa agg] iter:  7, prev_obj_val: 69.67960357666016, obj_val: 76.59479522705078, abs dis: 6.915191650390625
[rfa agg] iter: 7, weight: tensor([0.0446, 0.1207, 0.0316, 0.0872, 0.0498, 0.0341, 0.0349, 0.0866, 0.0623,
        0.4482])
[rfa agg] iter:  8, prev_obj_val: 76.59479522705078, obj_val: 69.67906188964844, abs dis: 6.915733337402344
[rfa agg] iter: 8, weight: tensor([0.0531, 0.1104, 0.0558, 0.0883, 0.0583, 0.0427, 0.0436, 0.2112, 0.0696,
        0.2671])
[rfa agg] iter:  9, prev_obj_val: 69.67906188964844, obj_val: 76.59492492675781, abs dis: 6.915863037109375
[rfa agg] iter: 9, weight: tensor([0.0446, 0.1205, 0.0315, 0.0871, 0.0497, 0.0340, 0.0349, 0.0865, 0.0622,
        0.4490])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3331, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.4189, Accuracy: 0/9950 (0.0000%)
saving model
Done in 713.747456073761 sec.
Saving all the graphs.
This run has a label: Jun.29_22.06.36. Visdom environment: tiny
