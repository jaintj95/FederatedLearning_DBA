current path: saved_models/model_tiny_Jun.27_07.37.31
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [84, 86, 65, 96, 55, 56, 28, 93, 16, 79].
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 317/1190 (26.6387%)
_Train Local_ResNet_18, epoch   1, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 460/1190 (38.6555%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.9694, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   1, local model 86, internal_epoch   1, Avg loss: 0.0630, Accuracy: 355/1003 (35.3938%)
_Train Local_ResNet_18, epoch   1, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 371/1003 (36.9890%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.5912, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0562, Accuracy: 370/1475 (25.0847%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0313, Accuracy: 656/1475 (44.4746%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.0317, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch   1, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 47/311 (15.1125%)
_Train Local_ResNet_18, epoch   1, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3427, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0574, Accuracy: 224/1071 (20.9150%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 493/1071 (46.0317%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9797, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   1, Avg loss: 0.0836, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   2, Avg loss: 0.0680, Accuracy: 63/186 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3125, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 410/1581 (25.9330%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 572/1581 (36.1796%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.8022, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch   1, local model 93, internal_epoch   1, Avg loss: 0.0559, Accuracy: 393/1742 (22.5603%)
_Train Local_ResNet_18, epoch   1, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 698/1742 (40.0689%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6635, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   1, Avg loss: 0.0661, Accuracy: 274/708 (38.7006%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   2, Avg loss: 0.0366, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.7650, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   1, local model 79, internal_epoch   1, Avg loss: 0.1018, Accuracy: 16/197 (8.1218%)
_Train Local_ResNet_18, epoch   1, local model 79, internal_epoch   2, Avg loss: 0.0832, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3233, Accuracy: 50/10000 (0.5000%)
time spent on training: 95.25790977478027
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 1003, 1475, 311, 1071, 186, 1581, 1742, 708, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 86, 65, 96, 55, 56, 28, 93, 16, 79], weight: tensor([0.1257, 0.1060, 0.1559, 0.0329, 0.1132, 0.0197, 0.1671, 0.1841, 0.0748,
        0.0208])
[rfa agg] iter:  0, prev_obj_val: 53.83039093017578, obj_val: 58.573486328125, abs dis: 4.743095397949219
[rfa agg] iter: 0, weight: tensor([0.2919, 0.1554, 0.0829, 0.0081, 0.2767, 0.0042, 0.0767, 0.0594, 0.0400,
        0.0048])
[rfa agg] iter:  1, prev_obj_val: 58.573486328125, obj_val: 60.84571075439453, abs dis: 2.2722244262695312
[rfa agg] iter: 1, weight: tensor([0.1372, 0.2865, 0.0590, 0.0081, 0.3519, 0.0041, 0.0560, 0.0457, 0.0468,
        0.0047])
[rfa agg] iter:  2, prev_obj_val: 60.84571075439453, obj_val: 60.8104133605957, abs dis: 0.035297393798828125
[rfa agg] iter: 2, weight: tensor([0.1161, 0.3860, 0.0564, 0.0086, 0.2716, 0.0043, 0.0539, 0.0447, 0.0534,
        0.0050])
[rfa agg] iter:  3, prev_obj_val: 60.8104133605957, obj_val: 60.80366897583008, abs dis: 0.006744384765625
[rfa agg] iter: 3, weight: tensor([0.1097, 0.4317, 0.0534, 0.0081, 0.2445, 0.0041, 0.0510, 0.0423, 0.0505,
        0.0047])
[rfa agg] iter:  4, prev_obj_val: 60.80366897583008, obj_val: 60.80205154418945, abs dis: 0.001617431640625
[rfa agg] iter: 4, weight: tensor([0.1063, 0.4538, 0.0517, 0.0079, 0.2322, 0.0040, 0.0495, 0.0410, 0.0490,
        0.0046])
[rfa agg] iter:  5, prev_obj_val: 60.80205154418945, obj_val: 63.527191162109375, abs dis: 2.725139617919922
[rfa agg] iter: 5, weight: tensor([0.1044, 0.4651, 0.0509, 0.0078, 0.2261, 0.0039, 0.0487, 0.0404, 0.0482,
        0.0045])
[rfa agg] iter:  6, prev_obj_val: 63.527191162109375, obj_val: 63.525089263916016, abs dis: 0.002101898193359375
[rfa agg] iter: 6, weight: tensor([0.1095, 0.4367, 0.0578, 0.0098, 0.2075, 0.0049, 0.0556, 0.0467, 0.0659,
        0.0056])
[rfa agg] iter:  7, prev_obj_val: 63.525089263916016, obj_val: 63.5250244140625, abs dis: 6.4849853515625e-05
[rfa agg] iter: 7, weight: tensor([0.1106, 0.4313, 0.0584, 0.0099, 0.2093, 0.0049, 0.0562, 0.0472, 0.0666,
        0.0057])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3003, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.3466, Accuracy: 0/9950 (0.0000%)
saving model
Done in 199.34139323234558 sec.
Server Epoch:2 choose agents : [65, 48, 44, 24, 25, 99, 85, 29, 7, 20].
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   1, Avg loss: 0.0564, Accuracy: 370/1475 (25.0847%)
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 643/1475 (43.5932%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.0859, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   1, Avg loss: 0.0716, Accuracy: 94/631 (14.8970%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   2, Avg loss: 0.0420, Accuracy: 211/631 (33.4390%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.8056, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 408/1750 (23.3143%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 663/1750 (37.8857%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.7302, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0775, Accuracy: 30/312 (9.6154%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.4079, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 303/690 (43.9130%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0292, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.4173, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0665, Accuracy: 168/773 (21.7335%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0341, Accuracy: 389/773 (50.3234%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.1480, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 448/1988 (22.5352%)
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 660/1988 (33.1992%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.2250, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 432/1440 (30.0000%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 691/1440 (47.9861%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.7619, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 344/891 (38.6083%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0249, Accuracy: 475/891 (53.3109%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.0532, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 351/807 (43.4944%)
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   2, Avg loss: 0.0330, Accuracy: 392/807 (48.5750%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.7130, Accuracy: 50/10000 (0.5000%)
time spent on training: 136.2559893131256
[rfa agg] training data poison_ratio: 0.07502091661243841  data num: [1475, 631, 1750, 312, 690, 773, 1988, 1440, 891, 807]
[rfa agg] considering poison per batch poison_fraction: 0.023444036441387005
[rfa agg] init. name: [65, 48, 44, 24, 25, 99, 85, 29, 7, 20], weight: tensor([0.1371, 0.0587, 0.1627, 0.0290, 0.0641, 0.0719, 0.1848, 0.1339, 0.0828,
        0.0750])
[rfa agg] iter:  0, prev_obj_val: 70.71495056152344, obj_val: 70.69535064697266, abs dis: 0.01959991455078125
[rfa agg] iter: 0, weight: tensor([0.1796, 0.0437, 0.1210, 0.0139, 0.0538, 0.0801, 0.0955, 0.2198, 0.1094,
        0.0833])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.2999, Accuracy: 42/10000 (0.4200%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.3085, Accuracy: 0/9950 (0.0000%)
saving model
Done in 233.11714839935303 sec.
Server Epoch:3 choose agents : [76, 59, 8, 85, 95, 14, 4, 70, 94, 11].
_Train Local_ResNet_18, epoch   3, local model 76, internal_epoch   1, Avg loss: 0.0868, Accuracy: 37/466 (7.9399%)
_Train Local_ResNet_18, epoch   3, local model 76, internal_epoch   2, Avg loss: 0.0490, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.6968, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   1, Avg loss: 0.0533, Accuracy: 311/1089 (28.5583%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 479/1089 (43.9853%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.2024, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0606, Accuracy: 239/1513 (15.7964%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 482/1513 (31.8572%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5126, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch   3, local model 85, internal_epoch   1, Avg loss: 0.0533, Accuracy: 448/1988 (22.5352%)
_Train Local_ResNet_18, epoch   3, local model 85, internal_epoch   2, Avg loss: 0.0349, Accuracy: 676/1988 (34.0040%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8551, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   3, local model 95, internal_epoch   1, Avg loss: 0.0527, Accuracy: 321/599 (53.5893%)
_Train Local_ResNet_18, epoch   3, local model 95, internal_epoch   2, Avg loss: 0.0283, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.2925, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 229/1013 (22.6061%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 314/1013 (30.9970%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.6506, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0608, Accuracy: 326/901 (36.1820%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0348, Accuracy: 415/901 (46.0599%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.9153, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0565, Accuracy: 327/1418 (23.0606%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0313, Accuracy: 619/1418 (43.6530%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8337, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 355/1662 (21.3598%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 615/1662 (37.0036%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7707, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   1, Avg loss: 0.0545, Accuracy: 341/712 (47.8933%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   2, Avg loss: 0.0269, Accuracy: 412/712 (57.8652%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.5549, Accuracy: 50/10000 (0.5000%)
time spent on training: 129.26568913459778
[rfa agg] training data poison_ratio: 0.0  data num: [466, 1089, 1513, 1988, 599, 1013, 901, 1418, 1662, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 59, 8, 85, 95, 14, 4, 70, 94, 11], weight: tensor([0.0410, 0.0959, 0.1332, 0.1750, 0.0527, 0.0892, 0.0793, 0.1248, 0.1463,
        0.0627])
[rfa agg] iter:  0, prev_obj_val: 59.2199592590332, obj_val: 63.8375358581543, abs dis: 4.617576599121094
[rfa agg] iter: 0, weight: tensor([0.0168, 0.2921, 0.1179, 0.0605, 0.0263, 0.1281, 0.0875, 0.1372, 0.0935,
        0.0401])
[rfa agg] iter:  1, prev_obj_val: 63.8375358581543, obj_val: 67.30030059814453, abs dis: 3.4627647399902344
[rfa agg] iter: 1, weight: tensor([0.0170, 0.2724, 0.0706, 0.0436, 0.0280, 0.2484, 0.1361, 0.0770, 0.0606,
        0.0464])
[rfa agg] iter:  2, prev_obj_val: 67.30030059814453, obj_val: 71.89482879638672, abs dis: 4.5945281982421875
[rfa agg] iter: 2, weight: tensor([0.0166, 0.1429, 0.0538, 0.0355, 0.0284, 0.3710, 0.1969, 0.0575, 0.0474,
        0.0500])
[rfa agg] iter:  3, prev_obj_val: 71.89482879638672, obj_val: 71.84037017822266, abs dis: 0.0544586181640625
[rfa agg] iter: 3, weight: tensor([0.0197, 0.1026, 0.0500, 0.0349, 0.0355, 0.2547, 0.3363, 0.0526, 0.0450,
        0.0686])
[rfa agg] iter:  4, prev_obj_val: 71.84037017822266, obj_val: 71.83295440673828, abs dis: 0.007415771484375
[rfa agg] iter: 4, weight: tensor([0.0184, 0.0953, 0.0466, 0.0326, 0.0331, 0.2229, 0.3956, 0.0491, 0.0420,
        0.0643])
[rfa agg] iter:  5, prev_obj_val: 71.83295440673828, obj_val: 71.83151245117188, abs dis: 0.00144195556640625
[rfa agg] iter: 5, weight: tensor([0.0178, 0.0918, 0.0450, 0.0315, 0.0320, 0.2103, 0.4216, 0.0474, 0.0406,
        0.0620])
[rfa agg] iter:  6, prev_obj_val: 71.83151245117188, obj_val: 71.83120727539062, abs dis: 0.00030517578125
[rfa agg] iter: 6, weight: tensor([0.0175, 0.0902, 0.0442, 0.0309, 0.0314, 0.2046, 0.4337, 0.0466, 0.0399,
        0.0610])
[rfa agg] iter:  7, prev_obj_val: 71.83120727539062, obj_val: 71.83113098144531, abs dis: 7.62939453125e-05
[rfa agg] iter: 7, weight: tensor([0.0173, 0.0894, 0.0439, 0.0307, 0.0311, 0.2020, 0.4395, 0.0462, 0.0395,
        0.0604])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3015, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.3235, Accuracy: 0/9950 (0.0000%)
saving model
Done in 227.67781567573547 sec.
Server Epoch:4 choose agents : [21, 65, 32, 76, 7, 24, 41, 52, 13, 64].
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 397/1949 (20.3694%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 656/1949 (33.6583%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.2776, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   1, Avg loss: 0.0553, Accuracy: 384/1475 (26.0339%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   2, Avg loss: 0.0320, Accuracy: 634/1475 (42.9831%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.0658, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   1, Avg loss: 0.0613, Accuracy: 196/735 (26.6667%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 345/735 (46.9388%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.9253, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0858, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0495, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7841, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 359/891 (40.2918%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 428/891 (48.0359%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.1761, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0773, Accuracy: 31/312 (9.9359%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0420, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.4596, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   1, Avg loss: 0.0579, Accuracy: 336/719 (46.7316%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   2, Avg loss: 0.0328, Accuracy: 458/719 (63.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.4494, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 276/636 (43.3962%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.6340, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   1, Avg loss: 0.0583, Accuracy: 319/1645 (19.3921%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 606/1645 (36.8389%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.1031, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 174/953 (18.2581%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0388, Accuracy: 317/953 (33.2634%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.5774, Accuracy: 63/10000 (0.6300%)
time spent on training: 124.41928672790527
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 1475, 735, 466, 891, 312, 719, 636, 1645, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 65, 32, 76, 7, 24, 41, 52, 13, 64], weight: tensor([0.1993, 0.1508, 0.0751, 0.0476, 0.0911, 0.0319, 0.0735, 0.0650, 0.1682,
        0.0974])
[rfa agg] iter:  0, prev_obj_val: 70.81694793701172, obj_val: 72.05357360839844, abs dis: 1.2366256713867188
[rfa agg] iter: 0, weight: tensor([0.0816, 0.1226, 0.0853, 0.0303, 0.1684, 0.0152, 0.0832, 0.0531, 0.1070,
        0.2534])
[rfa agg] iter:  1, prev_obj_val: 72.05357360839844, obj_val: 77.55940246582031, abs dis: 5.505828857421875
[rfa agg] iter: 1, weight: tensor([0.0382, 0.0512, 0.0746, 0.0208, 0.2308, 0.0097, 0.0726, 0.0396, 0.0469,
        0.4157])
[rfa agg] iter:  2, prev_obj_val: 77.55940246582031, obj_val: 79.43794250488281, abs dis: 1.8785400390625
[rfa agg] iter: 2, weight: tensor([0.0357, 0.0441, 0.1862, 0.0304, 0.2463, 0.0127, 0.1829, 0.0678, 0.0417,
        0.1521])
[rfa agg] iter:  3, prev_obj_val: 79.43794250488281, obj_val: 87.41683197021484, abs dis: 7.978889465332031
[rfa agg] iter: 3, weight: tensor([0.0315, 0.0382, 0.2589, 0.0307, 0.1648, 0.0123, 0.2445, 0.0735, 0.0364,
        0.1091])
[rfa agg] iter:  4, prev_obj_val: 87.41683197021484, obj_val: 87.40320587158203, abs dis: 0.0136260986328125
[rfa agg] iter: 4, weight: tensor([0.0348, 0.0405, 0.2229, 0.0543, 0.1038, 0.0183, 0.2140, 0.1884, 0.0392,
        0.0837])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3032, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.2773, Accuracy: 0/9950 (0.0000%)
saving model
Done in 225.92586016654968 sec.
Server Epoch:5 choose agents : [62, 97, 55, 2, 52, 21, 47, 93, 91, 83].
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0694, Accuracy: 139/568 (24.4718%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.9307, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0524, Accuracy: 354/1213 (29.1838%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 483/1213 (39.8186%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.7623, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   1, Avg loss: 0.0552, Accuracy: 250/1071 (23.3427%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 504/1071 (47.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.0601, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0634, Accuracy: 238/605 (39.3388%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 324/605 (53.5537%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.9170, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   1, Avg loss: 0.0555, Accuracy: 292/636 (45.9119%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   2, Avg loss: 0.0317, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.6583, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 382/1949 (19.5998%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   2, Avg loss: 0.0334, Accuracy: 623/1949 (31.9651%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.4838, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   1, Avg loss: 0.1242, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   2, Avg loss: 0.1093, Accuracy: 19/134 (14.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3237, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 400/1742 (22.9621%)
_Train Local_ResNet_18, epoch   5, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 724/1742 (41.5614%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.0008, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0524, Accuracy: 337/1030 (32.7184%)
_Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0265, Accuracy: 606/1030 (58.8350%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.5130, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   5, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 431/1953 (22.0686%)
_Train Local_ResNet_18, epoch   5, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 756/1953 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.4469, Accuracy: 93/10000 (0.9300%)
time spent on training: 129.50901055335999
[rfa agg] training data poison_ratio: 0.0  data num: [568, 1213, 1071, 605, 636, 1949, 134, 1742, 1030, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [62, 97, 55, 2, 52, 21, 47, 93, 91, 83], weight: tensor([0.0521, 0.1113, 0.0982, 0.0555, 0.0583, 0.1788, 0.0123, 0.1598, 0.0945,
        0.1792])
[rfa agg] iter:  0, prev_obj_val: 70.39108276367188, obj_val: 71.70489501953125, abs dis: 1.313812255859375
[rfa agg] iter: 0, weight: tensor([0.0253, 0.2950, 0.1406, 0.0294, 0.0309, 0.1039, 0.0040, 0.1324, 0.1342,
        0.1043])
[rfa agg] iter:  1, prev_obj_val: 71.70489501953125, obj_val: 73.77995300292969, abs dis: 2.0750579833984375
[rfa agg] iter: 1, weight: tensor([0.0171, 0.4939, 0.1489, 0.0202, 0.0212, 0.0487, 0.0025, 0.0581, 0.1406,
        0.0489])
[rfa agg] iter:  2, prev_obj_val: 73.77995300292969, obj_val: 79.03913116455078, abs dis: 5.259178161621094
[rfa agg] iter: 2, weight: tensor([0.0191, 0.3247, 0.2406, 0.0229, 0.0240, 0.0453, 0.0027, 0.0526, 0.2227,
        0.0454])
[rfa agg] iter:  3, prev_obj_val: 79.03913116455078, obj_val: 81.56639862060547, abs dis: 2.5272674560546875
[rfa agg] iter: 3, weight: tensor([0.0224, 0.1388, 0.3464, 0.0275, 0.0289, 0.0399, 0.0029, 0.0450, 0.3081,
        0.0400])
[rfa agg] iter:  4, prev_obj_val: 81.56639862060547, obj_val: 87.1016845703125, abs dis: 5.535285949707031
[rfa agg] iter: 4, weight: tensor([0.0288, 0.1379, 0.3201, 0.0357, 0.0375, 0.0463, 0.0036, 0.0517, 0.2919,
        0.0464])
[rfa agg] iter:  5, prev_obj_val: 87.1016845703125, obj_val: 81.57366180419922, abs dis: 5.528022766113281
[rfa agg] iter: 5, weight: tensor([0.0467, 0.1469, 0.2528, 0.0595, 0.0624, 0.0604, 0.0055, 0.0665, 0.2388,
        0.0606])
[rfa agg] iter:  6, prev_obj_val: 81.57366180419922, obj_val: 87.10101318359375, abs dis: 5.527351379394531
[rfa agg] iter: 6, weight: tensor([0.0292, 0.1405, 0.3179, 0.0363, 0.0381, 0.0469, 0.0037, 0.0524, 0.2878,
        0.0471])
[rfa agg] iter:  7, prev_obj_val: 87.10101318359375, obj_val: 81.57367706298828, abs dis: 5.527336120605469
[rfa agg] iter: 7, weight: tensor([0.0467, 0.1470, 0.2528, 0.0595, 0.0624, 0.0604, 0.0055, 0.0665, 0.2386,
        0.0606])
[rfa agg] iter:  8, prev_obj_val: 81.57367706298828, obj_val: 87.10100555419922, abs dis: 5.5273284912109375
[rfa agg] iter: 8, weight: tensor([0.0292, 0.1405, 0.3179, 0.0363, 0.0381, 0.0469, 0.0037, 0.0524, 0.2878,
        0.0471])
[rfa agg] iter:  9, prev_obj_val: 87.10100555419922, obj_val: 81.57367706298828, abs dis: 5.5273284912109375
[rfa agg] iter: 9, weight: tensor([0.0467, 0.1470, 0.2528, 0.0595, 0.0624, 0.0604, 0.0055, 0.0665, 0.2386,
        0.0606])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3053, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.2735, Accuracy: 0/9950 (0.0000%)
saving model
Done in 231.64980506896973 sec.
Server Epoch:6 choose agents : [42, 85, 94, 95, 56, 86, 53, 33, 44, 96].
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 342/1372 (24.9271%)
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 534/1372 (38.9213%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0069, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0532, Accuracy: 454/1988 (22.8370%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 671/1988 (33.7525%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.0308, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 326/1662 (19.6149%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 601/1662 (36.1613%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.2868, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0525, Accuracy: 339/599 (56.5943%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.6437, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   1, Avg loss: 0.0839, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   2, Avg loss: 0.0679, Accuracy: 70/186 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3319, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   1, Avg loss: 0.0589, Accuracy: 376/1003 (37.4875%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   2, Avg loss: 0.0335, Accuracy: 440/1003 (43.8684%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.8862, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 283/813 (34.8093%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   2, Avg loss: 0.0192, Accuracy: 458/813 (56.3346%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 10.0941, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   1, Avg loss: 0.0783, Accuracy: 70/515 (13.5922%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   2, Avg loss: 0.0527, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.9118, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0588, Accuracy: 410/1750 (23.4286%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 638/1750 (36.4571%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5742, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   1, Avg loss: 0.0778, Accuracy: 49/311 (15.7556%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   2, Avg loss: 0.0534, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.4205, Accuracy: 50/10000 (0.5000%)
time spent on training: 128.99411153793335
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1988, 1662, 599, 186, 1003, 813, 515, 1750, 311]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 85, 94, 95, 56, 86, 53, 33, 44, 96], weight: tensor([0.1345, 0.1949, 0.1630, 0.0587, 0.0182, 0.0983, 0.0797, 0.0505, 0.1716,
        0.0305])
[rfa agg] iter:  0, prev_obj_val: 70.67884063720703, obj_val: 72.05229187011719, abs dis: 1.3734512329101562
[rfa agg] iter: 0, weight: tensor([0.3491, 0.0929, 0.1543, 0.0336, 0.0061, 0.1386, 0.0650, 0.0263, 0.1222,
        0.0116])
[rfa agg] iter:  1, prev_obj_val: 72.05229187011719, obj_val: 74.9533462524414, abs dis: 2.9010543823242188
[rfa agg] iter: 1, weight: tensor([0.3123, 0.0935, 0.1496, 0.0371, 0.0066, 0.1653, 0.0734, 0.0289, 0.1206,
        0.0126])
[rfa agg] iter:  2, prev_obj_val: 74.9533462524414, obj_val: 74.94644927978516, abs dis: 0.00689697265625
[rfa agg] iter: 2, weight: tensor([0.2364, 0.0904, 0.1355, 0.0432, 0.0073, 0.2368, 0.0902, 0.0333, 0.1127,
        0.0141])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3078, Accuracy: 60/10000 (0.6000%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.2752, Accuracy: 0/9950 (0.0000%)
saving model
Done in 223.67030096054077 sec.
Server Epoch:7 choose agents : [55, 61, 33, 24, 70, 53, 80, 84, 10, 91].
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   1, Avg loss: 0.0533, Accuracy: 283/1071 (26.4239%)
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   2, Avg loss: 0.0284, Accuracy: 517/1071 (48.2726%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1766, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   1, Avg loss: 0.1244, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   2, Avg loss: 0.1144, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3215, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   1, Avg loss: 0.0790, Accuracy: 72/515 (13.9806%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   2, Avg loss: 0.0552, Accuracy: 125/515 (24.2718%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.9525, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   1, Avg loss: 0.0775, Accuracy: 36/312 (11.5385%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   2, Avg loss: 0.0408, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.5453, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   1, Avg loss: 0.0566, Accuracy: 369/1418 (26.0226%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   2, Avg loss: 0.0311, Accuracy: 658/1418 (46.4034%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.5268, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   1, Avg loss: 0.0484, Accuracy: 293/813 (36.0394%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 477/813 (58.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 10.1815, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   7, local model 80, internal_epoch   1, Avg loss: 0.0705, Accuracy: 146/682 (21.4076%)
_Train Local_ResNet_18, epoch   7, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 260/682 (38.1232%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.6370, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   7, local model 84, internal_epoch   1, Avg loss: 0.0622, Accuracy: 315/1190 (26.4706%)
_Train Local_ResNet_18, epoch   7, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 440/1190 (36.9748%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.1279, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0578, Accuracy: 223/861 (25.9001%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 456/861 (52.9617%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.5165, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 91, internal_epoch   1, Avg loss: 0.0508, Accuracy: 339/1030 (32.9126%)
_Train Local_ResNet_18, epoch   7, local model 91, internal_epoch   2, Avg loss: 0.0242, Accuracy: 641/1030 (62.2330%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.5118, Accuracy: 97/10000 (0.9700%)
time spent on training: 122.70193433761597
[rfa agg] training data poison_ratio: 0.0  data num: [1071, 85, 515, 312, 1418, 813, 682, 1190, 861, 1030]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [55, 61, 33, 24, 70, 53, 80, 84, 10, 91], weight: tensor([0.1343, 0.0107, 0.0646, 0.0391, 0.1778, 0.1019, 0.0855, 0.1492, 0.1079,
        0.1291])
[rfa agg] iter:  0, prev_obj_val: 40.131343841552734, obj_val: 45.77073669433594, abs dis: 5.639392852783203
[rfa agg] iter: 0, weight: tensor([0.1109, 0.0023, 0.0330, 0.0112, 0.0508, 0.2134, 0.0716, 0.0757, 0.3252,
        0.1060])
[rfa agg] iter:  1, prev_obj_val: 45.77073669433594, obj_val: 48.2779541015625, abs dis: 2.5072174072265625
[rfa agg] iter: 1, weight: tensor([0.0816, 0.0028, 0.0504, 0.0144, 0.0470, 0.3358, 0.1427, 0.0632, 0.1839,
        0.0782])
[rfa agg] iter:  2, prev_obj_val: 48.2779541015625, obj_val: 48.2701530456543, abs dis: 0.007801055908203125
[rfa agg] iter: 2, weight: tensor([0.0806, 0.0032, 0.0639, 0.0169, 0.0491, 0.2739, 0.2182, 0.0643, 0.1528,
        0.0772])
[rfa agg] iter:  3, prev_obj_val: 48.2701530456543, obj_val: 50.94798278808594, abs dis: 2.6778297424316406
[rfa agg] iter: 3, weight: tensor([0.0804, 0.0032, 0.0639, 0.0169, 0.0490, 0.2692, 0.2241, 0.0642, 0.1520,
        0.0771])
[rfa agg] iter:  4, prev_obj_val: 50.94798278808594, obj_val: 48.28238296508789, abs dis: 2.665599822998047
[rfa agg] iter: 4, weight: tensor([0.0731, 0.0033, 0.0755, 0.0181, 0.0467, 0.1925, 0.3364, 0.0598, 0.1245,
        0.0701])
[rfa agg] iter:  5, prev_obj_val: 48.28238296508789, obj_val: 48.270179748535156, abs dis: 0.012203216552734375
[rfa agg] iter: 5, weight: tensor([0.0803, 0.0032, 0.0639, 0.0169, 0.0489, 0.2618, 0.2328, 0.0641, 0.1512,
        0.0769])
[rfa agg] iter:  6, prev_obj_val: 48.270179748535156, obj_val: 50.947715759277344, abs dis: 2.6775360107421875
[rfa agg] iter: 6, weight: tensor([0.0804, 0.0032, 0.0639, 0.0169, 0.0490, 0.2682, 0.2252, 0.0642, 0.1520,
        0.0771])
[rfa agg] iter:  7, prev_obj_val: 50.947715759277344, obj_val: 48.28242492675781, abs dis: 2.6652908325195312
[rfa agg] iter: 7, weight: tensor([0.0731, 0.0033, 0.0755, 0.0181, 0.0467, 0.1924, 0.3366, 0.0598, 0.1245,
        0.0700])
[rfa agg] iter:  8, prev_obj_val: 48.28242492675781, obj_val: 48.270179748535156, abs dis: 0.01224517822265625
[rfa agg] iter: 8, weight: tensor([0.0803, 0.0032, 0.0639, 0.0169, 0.0489, 0.2618, 0.2329, 0.0641, 0.1512,
        0.0769])
[rfa agg] iter:  9, prev_obj_val: 48.270179748535156, obj_val: 50.94771194458008, abs dis: 2.677532196044922
[rfa agg] iter: 9, weight: tensor([0.0804, 0.0032, 0.0639, 0.0169, 0.0490, 0.2682, 0.2252, 0.0642, 0.1520,
        0.0771])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3097, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.2800, Accuracy: 0/9950 (0.0000%)
saving model
Done in 228.1812400817871 sec.
Server Epoch:8 choose agents : [65, 24, 13, 1, 59, 29, 46, 17, 12, 63].
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   1, Avg loss: 0.0547, Accuracy: 365/1475 (24.7458%)
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   2, Avg loss: 0.0309, Accuracy: 716/1475 (48.5424%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.2809, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   1, Avg loss: 0.0776, Accuracy: 31/312 (9.9359%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.5978, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 315/1645 (19.1489%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0324, Accuracy: 625/1645 (37.9939%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.8985, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0562, Accuracy: 291/928 (31.3578%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 562/928 (60.5603%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0345, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   1, Avg loss: 0.0512, Accuracy: 337/1089 (30.9458%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   2, Avg loss: 0.0277, Accuracy: 488/1089 (44.8118%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0509, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   1, Avg loss: 0.0477, Accuracy: 430/1440 (29.8611%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 682/1440 (47.3611%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9931, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   1, Avg loss: 0.0556, Accuracy: 397/1904 (20.8508%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 711/1904 (37.3424%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.6711, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 399/1574 (25.3494%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 660/1574 (41.9314%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.4233, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0870, Accuracy: 29/338 (8.5799%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0472, Accuracy: 147/338 (43.4911%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.6964, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 273/888 (30.7432%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 454/888 (51.1261%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.5810, Accuracy: 65/10000 (0.6500%)
time spent on training: 140.1427779197693
[rfa agg] training data poison_ratio: 0.0  data num: [1475, 312, 1645, 928, 1089, 1440, 1904, 1574, 338, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [65, 24, 13, 1, 59, 29, 46, 17, 12, 63], weight: tensor([0.1272, 0.0269, 0.1419, 0.0800, 0.0939, 0.1242, 0.1642, 0.1358, 0.0292,
        0.0766])
[rfa agg] iter:  0, prev_obj_val: 53.75016403198242, obj_val: 53.72367858886719, abs dis: 0.026485443115234375
[rfa agg] iter: 0, weight: tensor([0.1465, 0.0085, 0.1108, 0.0749, 0.1988, 0.1863, 0.0775, 0.1269, 0.0098,
        0.0599])
[rfa agg] iter:  1, prev_obj_val: 53.72367858886719, obj_val: 55.4541015625, abs dis: 1.7304229736328125
[rfa agg] iter: 1, weight: tensor([0.1457, 0.0084, 0.1101, 0.0745, 0.2020, 0.1867, 0.0770, 0.1261, 0.0098,
        0.0596])
[rfa agg] iter:  2, prev_obj_val: 55.4541015625, obj_val: 55.449974060058594, abs dis: 0.00412750244140625
[rfa agg] iter: 2, weight: tensor([0.1300, 0.0087, 0.1016, 0.0823, 0.2530, 0.1615, 0.0732, 0.1147, 0.0101,
        0.0648])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3121, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.2604, Accuracy: 0/9950 (0.0000%)
saving model
Done in 236.2729606628418 sec.
Server Epoch:9 choose agents : [38, 85, 61, 13, 88, 99, 52, 77, 37, 93].
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   1, Avg loss: 0.0610, Accuracy: 257/1131 (22.7233%)
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 458/1131 (40.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.5980, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   9, local model 85, internal_epoch   1, Avg loss: 0.0527, Accuracy: 471/1988 (23.6922%)
_Train Local_ResNet_18, epoch   9, local model 85, internal_epoch   2, Avg loss: 0.0350, Accuracy: 671/1988 (33.7525%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.8069, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1237, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1159, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3257, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   1, Avg loss: 0.0570, Accuracy: 305/1645 (18.5410%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   2, Avg loss: 0.0323, Accuracy: 633/1645 (38.4802%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.2585, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch   9, local model 88, internal_epoch   1, Avg loss: 0.0735, Accuracy: 147/603 (24.3781%)
_Train Local_ResNet_18, epoch   9, local model 88, internal_epoch   2, Avg loss: 0.0458, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.3227, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0680, Accuracy: 181/773 (23.4153%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0300, Accuracy: 392/773 (50.7115%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.6181, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   1, Avg loss: 0.0559, Accuracy: 292/636 (45.9119%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.1096, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0541, Accuracy: 332/1340 (24.7761%)
_Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 551/1340 (41.1194%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.2237, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 444/1129 (39.3268%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 732/1129 (64.8361%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.0364, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   1, Avg loss: 0.0542, Accuracy: 423/1742 (24.2824%)
_Train Local_ResNet_18, epoch   9, local model 93, internal_epoch   2, Avg loss: 0.0308, Accuracy: 751/1742 (43.1114%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.1478, Accuracy: 82/10000 (0.8200%)
time spent on training: 142.05292582511902
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 1988, 85, 1645, 603, 773, 636, 1340, 1129, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 85, 61, 13, 88, 99, 52, 77, 37, 93], weight: tensor([0.1021, 0.1796, 0.0077, 0.1486, 0.0545, 0.0698, 0.0574, 0.1210, 0.1020,
        0.1573])
[rfa agg] iter:  0, prev_obj_val: 59.92443084716797, obj_val: 63.11513137817383, abs dis: 3.1907005310058594
[rfa agg] iter: 0, weight: tensor([0.1774, 0.0566, 0.0016, 0.0930, 0.0206, 0.0376, 0.0218, 0.3429, 0.1743,
        0.0741])
[rfa agg] iter:  1, prev_obj_val: 63.11513137817383, obj_val: 66.67074584960938, abs dis: 3.555614471435547
[rfa agg] iter: 1, weight: tensor([0.3243, 0.0410, 0.0014, 0.0609, 0.0198, 0.0389, 0.0209, 0.1448, 0.2969,
        0.0510])
[rfa agg] iter:  2, prev_obj_val: 66.67074584960938, obj_val: 69.1565933227539, abs dis: 2.4858474731445312
[rfa agg] iter: 2, weight: tensor([0.3539, 0.0368, 0.0015, 0.0518, 0.0216, 0.0454, 0.0227, 0.0998, 0.3221,
        0.0444])
[rfa agg] iter:  3, prev_obj_val: 69.1565933227539, obj_val: 71.78670501708984, abs dis: 2.6301116943359375
[rfa agg] iter: 3, weight: tensor([0.3124, 0.0441, 0.0019, 0.0607, 0.0286, 0.0630, 0.0302, 0.1089, 0.2976,
        0.0527])
[rfa agg] iter:  4, prev_obj_val: 71.78670501708984, obj_val: 71.78369140625, abs dis: 0.00301361083984375
[rfa agg] iter: 4, weight: tensor([0.2729, 0.0511, 0.0023, 0.0689, 0.0369, 0.0858, 0.0389, 0.1166, 0.2663,
        0.0603])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3143, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.2651, Accuracy: 0/9950 (0.0000%)
saving model
Done in 240.57181549072266 sec.
Server Epoch:10 choose agents : [72, 15, 56, 44, 89, 31, 57, 97, 99, 6].
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   1, Avg loss: 0.0615, Accuracy: 254/1241 (20.4674%)
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 429/1241 (34.5689%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.7943, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   1, Avg loss: 0.0553, Accuracy: 337/1154 (29.2028%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   2, Avg loss: 0.0277, Accuracy: 496/1154 (42.9809%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.6866, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0839, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 69/186 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3487, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   1, Avg loss: 0.0583, Accuracy: 402/1750 (22.9714%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 685/1750 (39.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.8421, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  10, local model 89, internal_epoch   1, Avg loss: 0.0608, Accuracy: 336/896 (37.5000%)
_Train Local_ResNet_18, epoch  10, local model 89, internal_epoch   2, Avg loss: 0.0347, Accuracy: 407/896 (45.4241%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.4626, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   1, Avg loss: 0.0830, Accuracy: 62/460 (13.4783%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   2, Avg loss: 0.0383, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.2987, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   1, Avg loss: 0.0540, Accuracy: 309/1154 (26.7764%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   2, Avg loss: 0.0255, Accuracy: 484/1154 (41.9411%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 10.6886, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  10, local model 97, internal_epoch   1, Avg loss: 0.0512, Accuracy: 371/1213 (30.5853%)
_Train Local_ResNet_18, epoch  10, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 490/1213 (40.3957%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 9.1210, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   1, Avg loss: 0.0660, Accuracy: 185/773 (23.9327%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   2, Avg loss: 0.0323, Accuracy: 379/773 (49.0298%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.4690, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0554, Accuracy: 399/1956 (20.3988%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 673/1956 (34.4070%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.2853, Accuracy: 128/10000 (1.2800%)
time spent on training: 143.00095438957214
[rfa agg] training data poison_ratio: 0.0  data num: [1241, 1154, 186, 1750, 896, 460, 1154, 1213, 773, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [72, 15, 56, 44, 89, 31, 57, 97, 99, 6], weight: tensor([0.1151, 0.1070, 0.0172, 0.1623, 0.0831, 0.0427, 0.1070, 0.1125, 0.0717,
        0.1814])
[rfa agg] iter:  0, prev_obj_val: 50.662208557128906, obj_val: 59.03654098510742, abs dis: 8.374332427978516
[rfa agg] iter: 0, weight: tensor([0.2471, 0.1818, 0.0022, 0.0392, 0.0309, 0.0077, 0.2084, 0.2276, 0.0226,
        0.0325])
[rfa agg] iter:  1, prev_obj_val: 59.03654098510742, obj_val: 59.02129364013672, abs dis: 0.015247344970703125
[rfa agg] iter: 1, weight: tensor([0.1416, 0.1813, 0.0047, 0.0557, 0.1005, 0.0179, 0.1851, 0.1977, 0.0665,
        0.0491])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3165, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.2674, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.05499863624573 sec.
Server Epoch:11 choose agents : [25, 79, 30, 6, 93, 12, 88, 11, 27, 14].
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0563, Accuracy: 313/690 (45.3623%)
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.3398, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  11, local model 79, internal_epoch   1, Avg loss: 0.1026, Accuracy: 10/197 (5.0761%)
_Train Local_ResNet_18, epoch  11, local model 79, internal_epoch   2, Avg loss: 0.0844, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3659, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   1, Avg loss: 0.0810, Accuracy: 66/486 (13.5802%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   2, Avg loss: 0.0407, Accuracy: 208/486 (42.7984%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.6873, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 395/1956 (20.1943%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 665/1956 (33.9980%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1812, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   1, Avg loss: 0.0540, Accuracy: 402/1742 (23.0769%)
_Train Local_ResNet_18, epoch  11, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 690/1742 (39.6096%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.8576, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0864, Accuracy: 23/338 (6.8047%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0478, Accuracy: 149/338 (44.0828%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.8058, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 88, internal_epoch   1, Avg loss: 0.0730, Accuracy: 146/603 (24.2123%)
_Train Local_ResNet_18, epoch  11, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.7138, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0567, Accuracy: 338/712 (47.4719%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0251, Accuracy: 415/712 (58.2865%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.0549, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   1, Avg loss: 0.0540, Accuracy: 426/1587 (26.8431%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   2, Avg loss: 0.0333, Accuracy: 639/1587 (40.2647%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.3664, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0618, Accuracy: 229/1013 (22.6061%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0347, Accuracy: 338/1013 (33.3662%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.9747, Accuracy: 71/10000 (0.7100%)
time spent on training: 140.33276224136353
[rfa agg] training data poison_ratio: 0.0  data num: [690, 197, 486, 1956, 1742, 338, 603, 712, 1587, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 79, 30, 6, 93, 12, 88, 11, 27, 14], weight: tensor([0.0740, 0.0211, 0.0521, 0.2098, 0.1868, 0.0363, 0.0647, 0.0764, 0.1702,
        0.1086])
[rfa agg] iter:  0, prev_obj_val: 78.04756927490234, obj_val: 79.25019073486328, abs dis: 1.2026214599609375
[rfa agg] iter: 0, weight: tensor([0.0690, 0.0102, 0.0348, 0.1175, 0.1374, 0.0203, 0.0532, 0.0819, 0.1822,
        0.2935])
[rfa agg] iter:  1, prev_obj_val: 79.25019073486328, obj_val: 82.71115112304688, abs dis: 3.4609603881835938
[rfa agg] iter: 1, weight: tensor([0.0677, 0.0093, 0.0327, 0.0925, 0.1058, 0.0188, 0.0513, 0.0823, 0.1347,
        0.4050])
[rfa agg] iter:  2, prev_obj_val: 82.71115112304688, obj_val: 84.21024322509766, abs dis: 1.4990921020507812
[rfa agg] iter: 2, weight: tensor([0.0609, 0.0068, 0.0259, 0.0505, 0.0557, 0.0142, 0.0437, 0.0801, 0.0667,
        0.5956])
[rfa agg] iter:  3, prev_obj_val: 84.21024322509766, obj_val: 87.33551025390625, abs dis: 3.1252670288085938
[rfa agg] iter: 3, weight: tensor([0.0839, 0.0088, 0.0341, 0.0602, 0.0659, 0.0185, 0.0589, 0.1140, 0.0779,
        0.4779])
[rfa agg] iter:  4, prev_obj_val: 87.33551025390625, obj_val: 87.31776428222656, abs dis: 0.0177459716796875
[rfa agg] iter: 4, weight: tensor([0.1299, 0.0113, 0.0464, 0.0662, 0.0716, 0.0243, 0.0858, 0.1950, 0.0829,
        0.2866])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3191, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.2680, Accuracy: 0/9950 (0.0000%)
saving model
Done in 239.44014024734497 sec.
Server Epoch:12 choose agents : [37, 81, 94, 32, 34, 87, 63, 99, 22, 14].
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   1, Avg loss: 0.0503, Accuracy: 482/1129 (42.6926%)
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   2, Avg loss: 0.0239, Accuracy: 746/1129 (66.0762%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0644, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  12, local model 81, internal_epoch   1, Avg loss: 0.0683, Accuracy: 238/774 (30.7494%)
_Train Local_ResNet_18, epoch  12, local model 81, internal_epoch   2, Avg loss: 0.0347, Accuracy: 306/774 (39.5349%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.5676, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0539, Accuracy: 373/1662 (22.4428%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 608/1662 (36.5824%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.3334, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0578, Accuracy: 217/735 (29.5238%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0218, Accuracy: 362/735 (49.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.9981, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 381/1427 (26.6994%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0328, Accuracy: 608/1427 (42.6069%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.2573, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  12, local model 87, internal_epoch   1, Avg loss: 0.0584, Accuracy: 305/1131 (26.9673%)
_Train Local_ResNet_18, epoch  12, local model 87, internal_epoch   2, Avg loss: 0.0319, Accuracy: 391/1131 (34.5712%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.2905, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   1, Avg loss: 0.0540, Accuracy: 260/888 (29.2793%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 485/888 (54.6171%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 9.2219, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  12, local model 99, internal_epoch   1, Avg loss: 0.0629, Accuracy: 195/773 (25.2264%)
_Train Local_ResNet_18, epoch  12, local model 99, internal_epoch   2, Avg loss: 0.0297, Accuracy: 426/773 (55.1100%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8164, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0462, Accuracy: 525/1470 (35.7143%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 826/1470 (56.1905%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.5788, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   1, Avg loss: 0.0599, Accuracy: 241/1013 (23.7907%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   2, Avg loss: 0.0343, Accuracy: 375/1013 (37.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.1584, Accuracy: 79/10000 (0.7900%)
time spent on training: 150.80521750450134
[rfa agg] training data poison_ratio: 0.0  data num: [1129, 774, 1662, 735, 1427, 1131, 888, 773, 1470, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 81, 94, 32, 34, 87, 63, 99, 22, 14], weight: tensor([0.1026, 0.0704, 0.1511, 0.0668, 0.1297, 0.1028, 0.0807, 0.0703, 0.1336,
        0.0921])
[rfa agg] iter:  0, prev_obj_val: 44.390682220458984, obj_val: 48.123233795166016, abs dis: 3.7325515747070312
[rfa agg] iter: 0, weight: tensor([0.1095, 0.0768, 0.0414, 0.0541, 0.0496, 0.1126, 0.1383, 0.0771, 0.0511,
        0.2895])
[rfa agg] iter:  1, prev_obj_val: 48.123233795166016, obj_val: 59.232826232910156, abs dis: 11.10959243774414
[rfa agg] iter: 1, weight: tensor([0.0788, 0.1130, 0.0367, 0.0721, 0.0425, 0.0802, 0.2578, 0.1152, 0.0438,
        0.1598])
[rfa agg] iter:  2, prev_obj_val: 59.232826232910156, obj_val: 62.981536865234375, abs dis: 3.7487106323242188
[rfa agg] iter: 2, weight: tensor([0.0490, 0.1908, 0.0298, 0.2123, 0.0329, 0.0494, 0.1333, 0.1996, 0.0339,
        0.0689])
[rfa agg] iter:  3, prev_obj_val: 62.981536865234375, obj_val: 62.966068267822266, abs dis: 0.015468597412109375
[rfa agg] iter: 3, weight: tensor([0.0471, 0.1563, 0.0301, 0.3246, 0.0329, 0.0474, 0.1063, 0.1584, 0.0338,
        0.0631])
[rfa agg] iter:  4, prev_obj_val: 62.966068267822266, obj_val: 71.45502471923828, abs dis: 8.488956451416016
[rfa agg] iter: 4, weight: tensor([0.0448, 0.1472, 0.0287, 0.3615, 0.0313, 0.0452, 0.1009, 0.1480, 0.0322,
        0.0601])
[rfa agg] iter:  5, prev_obj_val: 71.45502471923828, obj_val: 52.8361930847168, abs dis: 18.618831634521484
[rfa agg] iter: 5, weight: tensor([0.0626, 0.1414, 0.0434, 0.2620, 0.0466, 0.0630, 0.1130, 0.1414, 0.0480,
        0.0786])
[rfa agg] iter:  6, prev_obj_val: 52.8361930847168, obj_val: 63.01359558105469, abs dis: 10.17740249633789
[rfa agg] iter: 6, weight: tensor([0.0549, 0.1849, 0.0298, 0.1039, 0.0336, 0.0556, 0.2271, 0.1886, 0.0346,
        0.0869])
[rfa agg] iter:  7, prev_obj_val: 63.01359558105469, obj_val: 59.17354202270508, abs dis: 3.8400535583496094
[rfa agg] iter: 7, weight: tensor([0.0489, 0.1612, 0.0313, 0.2987, 0.0342, 0.0493, 0.1117, 0.1638, 0.0352,
        0.0657])
[rfa agg] iter:  8, prev_obj_val: 59.17354202270508, obj_val: 59.16800308227539, abs dis: 0.0055389404296875
[rfa agg] iter: 8, weight: tensor([0.0466, 0.1926, 0.0284, 0.2380, 0.0313, 0.0470, 0.1232, 0.1954, 0.0323,
        0.0653])
[rfa agg] iter:  9, prev_obj_val: 59.16800308227539, obj_val: 59.1678581237793, abs dis: 0.00014495849609375
[rfa agg] iter: 9, weight: tensor([0.0467, 0.1970, 0.0285, 0.2276, 0.0314, 0.0471, 0.1236, 0.2005, 0.0323,
        0.0654])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3212, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.1869, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.0028727054596 sec.
Server Epoch:13 choose agents : [36, 76, 71, 15, 56, 7, 17, 51, 47, 24].
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   1, Avg loss: 0.0869, Accuracy: 80/408 (19.6078%)
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   2, Avg loss: 0.0547, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.9404, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 49/466 (10.5150%)
_Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0471, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.1917, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   1, Avg loss: 0.0631, Accuracy: 187/818 (22.8606%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 356/818 (43.5208%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.9847, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0542, Accuracy: 356/1154 (30.8492%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0308, Accuracy: 476/1154 (41.2478%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.7913, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0842, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0687, Accuracy: 65/186 (34.9462%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3631, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 368/891 (41.3019%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 436/891 (48.9338%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.8043, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   1, Avg loss: 0.0507, Accuracy: 399/1574 (25.3494%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   2, Avg loss: 0.0268, Accuracy: 700/1574 (44.4727%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2691, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 225/1049 (21.4490%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   2, Avg loss: 0.0291, Accuracy: 518/1049 (49.3804%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.7590, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   1, Avg loss: 0.1249, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   2, Avg loss: 0.1084, Accuracy: 13/134 (9.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3493, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   1, Avg loss: 0.0780, Accuracy: 35/312 (11.2179%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 170/312 (54.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.8784, Accuracy: 50/10000 (0.5000%)
time spent on training: 134.92419838905334
[rfa agg] training data poison_ratio: 0.0  data num: [408, 466, 818, 1154, 186, 891, 1574, 1049, 134, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 76, 71, 15, 56, 7, 17, 51, 47, 24], weight: tensor([0.0584, 0.0666, 0.1170, 0.1650, 0.0266, 0.1274, 0.2251, 0.1500, 0.0192,
        0.0446])
[rfa agg] iter:  0, prev_obj_val: 50.582374572753906, obj_val: 54.17728042602539, abs dis: 3.5949058532714844
[rfa agg] iter: 0, weight: tensor([0.0217, 0.0285, 0.1953, 0.1008, 0.0064, 0.4115, 0.0598, 0.1582, 0.0046,
        0.0131])
[rfa agg] iter:  1, prev_obj_val: 54.17728042602539, obj_val: 56.2235107421875, abs dis: 2.0462303161621094
[rfa agg] iter: 1, weight: tensor([0.0244, 0.0335, 0.4197, 0.0688, 0.0067, 0.2881, 0.0473, 0.0926, 0.0048,
        0.0141])
[rfa agg] iter:  2, prev_obj_val: 56.2235107421875, obj_val: 56.2163200378418, abs dis: 0.007190704345703125
[rfa agg] iter: 2, weight: tensor([0.0297, 0.0413, 0.4651, 0.0708, 0.0079, 0.2205, 0.0506, 0.0919, 0.0057,
        0.0167])
[rfa agg] iter:  3, prev_obj_val: 56.2163200378418, obj_val: 58.6264533996582, abs dis: 2.4101333618164062
[rfa agg] iter: 3, weight: tensor([0.0291, 0.0405, 0.4791, 0.0693, 0.0077, 0.2128, 0.0496, 0.0900, 0.0055,
        0.0164])
[rfa agg] iter:  4, prev_obj_val: 58.6264533996582, obj_val: 56.2237663269043, abs dis: 2.4026870727539062
[rfa agg] iter: 4, weight: tensor([0.0418, 0.0595, 0.3870, 0.0844, 0.0106, 0.2172, 0.0624, 0.1065, 0.0077,
        0.0229])
[rfa agg] iter:  5, prev_obj_val: 56.2237663269043, obj_val: 56.216346740722656, abs dis: 0.007419586181640625
[rfa agg] iter: 5, weight: tensor([0.0299, 0.0416, 0.4640, 0.0712, 0.0079, 0.2196, 0.0509, 0.0925, 0.0057,
        0.0168])
[rfa agg] iter:  6, prev_obj_val: 56.216346740722656, obj_val: 58.626426696777344, abs dis: 2.4100799560546875
[rfa agg] iter: 6, weight: tensor([0.0291, 0.0405, 0.4789, 0.0694, 0.0077, 0.2129, 0.0496, 0.0900, 0.0055,
        0.0164])
[rfa agg] iter:  7, prev_obj_val: 58.626426696777344, obj_val: 56.2237663269043, abs dis: 2.402660369873047
[rfa agg] iter: 7, weight: tensor([0.0418, 0.0595, 0.3870, 0.0844, 0.0106, 0.2172, 0.0624, 0.1065, 0.0077,
        0.0229])
[rfa agg] iter:  8, prev_obj_val: 56.2237663269043, obj_val: 56.21634292602539, abs dis: 0.00742340087890625
[rfa agg] iter: 8, weight: tensor([0.0299, 0.0416, 0.4640, 0.0712, 0.0079, 0.2196, 0.0509, 0.0925, 0.0057,
        0.0168])
[rfa agg] iter:  9, prev_obj_val: 56.21634292602539, obj_val: 58.626426696777344, abs dis: 2.410083770751953
[rfa agg] iter: 9, weight: tensor([0.0291, 0.0405, 0.4789, 0.0694, 0.0077, 0.2129, 0.0496, 0.0900, 0.0055,
        0.0164])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3245, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.1858, Accuracy: 0/9950 (0.0000%)
saving model
Done in 234.1805157661438 sec.
Server Epoch:14 choose agents : [70, 65, 66, 62, 34, 71, 83, 61, 84, 99].
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 362/1418 (25.5289%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 608/1418 (42.8773%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8197, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0539, Accuracy: 421/1475 (28.5424%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0301, Accuracy: 695/1475 (47.1186%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.5844, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0618, Accuracy: 255/1402 (18.1883%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 365/1402 (26.0342%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.1578, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   1, Avg loss: 0.0687, Accuracy: 149/568 (26.2324%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.5106, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   1, Avg loss: 0.0592, Accuracy: 383/1427 (26.8395%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 559/1427 (39.1731%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.2744, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   1, Avg loss: 0.0591, Accuracy: 185/818 (22.6161%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   2, Avg loss: 0.0290, Accuracy: 380/818 (46.4548%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8689, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 425/1953 (21.7614%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0331, Accuracy: 756/1953 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.7855, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1249, Accuracy: 2/85 (2.3529%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1169, Accuracy: 12/85 (14.1176%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3391, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0596, Accuracy: 328/1190 (27.5630%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0317, Accuracy: 449/1190 (37.7311%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.6286, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  14, local model 99, internal_epoch   1, Avg loss: 0.0602, Accuracy: 219/773 (28.3312%)
_Train Local_ResNet_18, epoch  14, local model 99, internal_epoch   2, Avg loss: 0.0320, Accuracy: 387/773 (50.0647%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.9140, Accuracy: 52/10000 (0.5200%)
time spent on training: 150.94455695152283
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 1475, 1402, 568, 1427, 818, 1953, 85, 1190, 773]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 65, 66, 62, 34, 71, 83, 61, 84, 99], weight: tensor([0.1276, 0.1328, 0.1262, 0.0511, 0.1285, 0.0736, 0.1758, 0.0077, 0.1071,
        0.0696])
[rfa agg] iter:  0, prev_obj_val: 54.72643280029297, obj_val: 52.32529067993164, abs dis: 2.401142120361328
[rfa agg] iter: 0, weight: tensor([0.1123, 0.0958, 0.1413, 0.0217, 0.1127, 0.0537, 0.0567, 0.0019, 0.3532,
        0.0507])
[rfa agg] iter:  1, prev_obj_val: 52.32529067993164, obj_val: 57.048526763916016, abs dis: 4.723236083984375
[rfa agg] iter: 1, weight: tensor([0.1023, 0.0854, 0.1327, 0.0168, 0.1025, 0.0401, 0.0481, 0.0015, 0.4325,
        0.0380])
[rfa agg] iter:  2, prev_obj_val: 57.048526763916016, obj_val: 59.59125518798828, abs dis: 2.5427284240722656
[rfa agg] iter: 2, weight: tensor([0.1054, 0.0915, 0.1292, 0.0239, 0.1058, 0.0611, 0.0568, 0.0020, 0.3664,
        0.0579])
[rfa agg] iter:  3, prev_obj_val: 59.59125518798828, obj_val: 57.044002532958984, abs dis: 2.547252655029297
[rfa agg] iter: 3, weight: tensor([0.1102, 0.0970, 0.1325, 0.0289, 0.1107, 0.0777, 0.0626, 0.0024, 0.3043,
        0.0736])
[rfa agg] iter:  4, prev_obj_val: 57.044002532958984, obj_val: 57.04045104980469, abs dis: 0.003551483154296875
[rfa agg] iter: 4, weight: tensor([0.1083, 0.0940, 0.1330, 0.0245, 0.1087, 0.0629, 0.0582, 0.0021, 0.3488,
        0.0595])
[rfa agg] iter:  5, prev_obj_val: 57.04045104980469, obj_val: 59.58943557739258, abs dis: 2.5489845275878906
[rfa agg] iter: 5, weight: tensor([0.1073, 0.0931, 0.1317, 0.0243, 0.1077, 0.0623, 0.0577, 0.0020, 0.3549,
        0.0590])
[rfa agg] iter:  6, prev_obj_val: 59.58943557739258, obj_val: 57.044124603271484, abs dis: 2.5453109741210938
[rfa agg] iter: 6, weight: tensor([0.1104, 0.0972, 0.1327, 0.0290, 0.1108, 0.0778, 0.0627, 0.0024, 0.3034,
        0.0737])
[rfa agg] iter:  7, prev_obj_val: 57.044124603271484, obj_val: 57.04045104980469, abs dis: 0.003673553466796875
[rfa agg] iter: 7, weight: tensor([0.1083, 0.0940, 0.1330, 0.0245, 0.1087, 0.0629, 0.0582, 0.0021, 0.3487,
        0.0595])
[rfa agg] iter:  8, prev_obj_val: 57.04045104980469, obj_val: 59.58942794799805, abs dis: 2.5489768981933594
[rfa agg] iter: 8, weight: tensor([0.1073, 0.0931, 0.1317, 0.0243, 0.1077, 0.0623, 0.0577, 0.0020, 0.3549,
        0.0590])
[rfa agg] iter:  9, prev_obj_val: 59.58942794799805, obj_val: 57.044124603271484, abs dis: 2.5453033447265625
[rfa agg] iter: 9, weight: tensor([0.1104, 0.0972, 0.1327, 0.0290, 0.1108, 0.0778, 0.0627, 0.0024, 0.3034,
        0.0737])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3268, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.1678, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.05708765983582 sec.
Server Epoch:15 choose agents : [70, 63, 84, 79, 26, 42, 18, 66, 39, 95].
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0549, Accuracy: 394/1418 (27.7856%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0301, Accuracy: 689/1418 (48.5896%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.0318, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0520, Accuracy: 275/888 (30.9685%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0252, Accuracy: 447/888 (50.3378%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.2852, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   1, Avg loss: 0.0580, Accuracy: 331/1190 (27.8151%)
_Train Local_ResNet_18, epoch  15, local model 84, internal_epoch   2, Avg loss: 0.0304, Accuracy: 488/1190 (41.0084%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5562, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  15, local model 79, internal_epoch   1, Avg loss: 0.1023, Accuracy: 6/197 (3.0457%)
_Train Local_ResNet_18, epoch  15, local model 79, internal_epoch   2, Avg loss: 0.0849, Accuracy: 64/197 (32.4873%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3869, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   1, Avg loss: 0.0553, Accuracy: 335/1446 (23.1674%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 498/1446 (34.4398%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.4663, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   1, Avg loss: 0.0526, Accuracy: 351/1372 (25.5831%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 533/1372 (38.8484%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1995, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0759, Accuracy: 124/530 (23.3962%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0389, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.7149, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   1, Avg loss: 0.0607, Accuracy: 287/1402 (20.4708%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   2, Avg loss: 0.0378, Accuracy: 416/1402 (29.6719%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.3992, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 323/1013 (31.8855%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 513/1013 (50.6417%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1401, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  15, local model 95, internal_epoch   1, Avg loss: 0.0538, Accuracy: 327/599 (54.5910%)
_Train Local_ResNet_18, epoch  15, local model 95, internal_epoch   2, Avg loss: 0.0284, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.0911, Accuracy: 50/10000 (0.5000%)
time spent on training: 150.4743137359619
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 888, 1190, 197, 1446, 1372, 530, 1402, 1013, 599]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 63, 84, 79, 26, 42, 18, 66, 39, 95], weight: tensor([0.1410, 0.0883, 0.1183, 0.0196, 0.1438, 0.1364, 0.0527, 0.1394, 0.1007,
        0.0596])
[rfa agg] iter:  0, prev_obj_val: 43.820777893066406, obj_val: 47.298423767089844, abs dis: 3.4776458740234375
[rfa agg] iter: 0, weight: tensor([0.0834, 0.1023, 0.1938, 0.0054, 0.0853, 0.0959, 0.0236, 0.0981, 0.2819,
        0.0304])
[rfa agg] iter:  1, prev_obj_val: 47.298423767089844, obj_val: 54.47233200073242, abs dis: 7.173908233642578
[rfa agg] iter: 1, weight: tensor([0.0593, 0.1220, 0.1129, 0.0048, 0.0605, 0.0663, 0.0223, 0.0679, 0.4547,
        0.0293])
[rfa agg] iter:  2, prev_obj_val: 54.47233200073242, obj_val: 60.07341384887695, abs dis: 5.601081848144531
[rfa agg] iter: 2, weight: tensor([0.0595, 0.3366, 0.0930, 0.0067, 0.0608, 0.0649, 0.0344, 0.0664, 0.2306,
        0.0472])
[rfa agg] iter:  3, prev_obj_val: 60.07341384887695, obj_val: 57.04180145263672, abs dis: 3.0316123962402344
[rfa agg] iter: 3, weight: tensor([0.0551, 0.4308, 0.0793, 0.0077, 0.0563, 0.0594, 0.0434, 0.0608, 0.1449,
        0.0623])
[rfa agg] iter:  4, prev_obj_val: 57.04180145263672, obj_val: 57.026649475097656, abs dis: 0.0151519775390625
[rfa agg] iter: 4, weight: tensor([0.0453, 0.5259, 0.0677, 0.0057, 0.0463, 0.0492, 0.0305, 0.0503, 0.1364,
        0.0427])
[rfa agg] iter:  5, prev_obj_val: 57.026649475097656, obj_val: 66.52921295166016, abs dis: 9.5025634765625
[rfa agg] iter: 5, weight: tensor([0.0412, 0.5703, 0.0615, 0.0052, 0.0420, 0.0446, 0.0277, 0.0457, 0.1231,
        0.0387])
[rfa agg] iter:  6, prev_obj_val: 66.52921295166016, obj_val: 51.8976936340332, abs dis: 14.631519317626953
[rfa agg] iter: 6, weight: tensor([0.0672, 0.2877, 0.0906, 0.0115, 0.0686, 0.0717, 0.0745, 0.0733, 0.1407,
        0.1142])
[rfa agg] iter:  7, prev_obj_val: 51.8976936340332, obj_val: 54.39299011230469, abs dis: 2.4952964782714844
[rfa agg] iter: 7, weight: tensor([0.0622, 0.2687, 0.1026, 0.0063, 0.0636, 0.0684, 0.0311, 0.0700, 0.2850,
        0.0420])
[rfa agg] iter:  8, prev_obj_val: 54.39299011230469, obj_val: 60.06663131713867, abs dis: 5.673641204833984
[rfa agg] iter: 8, weight: tensor([0.0569, 0.3733, 0.0890, 0.0064, 0.0581, 0.0620, 0.0329, 0.0635, 0.2128,
        0.0451])
[rfa agg] iter:  9, prev_obj_val: 60.06663131713867, obj_val: 60.057884216308594, abs dis: 0.008747100830078125
[rfa agg] iter: 9, weight: tensor([0.0544, 0.4390, 0.0782, 0.0076, 0.0555, 0.0586, 0.0428, 0.0599, 0.1426,
        0.0614])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3307, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.1788, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.54592490196228 sec.
Server Epoch:16 choose agents : [24, 22, 71, 66, 80, 6, 64, 96, 59, 33].
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   1, Avg loss: 0.0777, Accuracy: 38/312 (12.1795%)
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   2, Avg loss: 0.0414, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.9508, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   1, Avg loss: 0.0462, Accuracy: 530/1470 (36.0544%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 871/1470 (59.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.4337, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   1, Avg loss: 0.0567, Accuracy: 220/818 (26.8949%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   2, Avg loss: 0.0293, Accuracy: 393/818 (48.0440%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.8944, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   1, Avg loss: 0.0599, Accuracy: 270/1402 (19.2582%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 397/1402 (28.3167%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.6588, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  16, local model 80, internal_epoch   1, Avg loss: 0.0683, Accuracy: 164/682 (24.0469%)
_Train Local_ResNet_18, epoch  16, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 258/682 (37.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.6689, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0543, Accuracy: 401/1956 (20.5010%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0314, Accuracy: 649/1956 (33.1800%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1228, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   1, Avg loss: 0.0639, Accuracy: 171/953 (17.9433%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   2, Avg loss: 0.0374, Accuracy: 314/953 (32.9486%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.8188, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0779, Accuracy: 54/311 (17.3633%)
_Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0528, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.6354, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   1, Avg loss: 0.0506, Accuracy: 345/1089 (31.6804%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 481/1089 (44.1690%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 9.8997, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   1, Avg loss: 0.0772, Accuracy: 75/515 (14.5631%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   2, Avg loss: 0.0536, Accuracy: 137/515 (26.6019%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.3700, Accuracy: 59/10000 (0.5900%)
time spent on training: 146.31745147705078
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1470, 818, 1402, 682, 1956, 953, 311, 1089, 515]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 22, 71, 66, 80, 6, 64, 96, 59, 33], weight: tensor([0.0328, 0.1546, 0.0860, 0.1475, 0.0717, 0.2057, 0.1002, 0.0327, 0.1145,
        0.0542])
[rfa agg] iter:  0, prev_obj_val: 61.503665924072266, obj_val: 64.3747787475586, abs dis: 2.871112823486328
[rfa agg] iter: 0, weight: tensor([0.0107, 0.1129, 0.0770, 0.1305, 0.0448, 0.0620, 0.1566, 0.0107, 0.3690,
        0.0259])
[rfa agg] iter:  1, prev_obj_val: 64.3747787475586, obj_val: 66.80615234375, abs dis: 2.4313735961914062
[rfa agg] iter: 1, weight: tensor([0.0120, 0.0879, 0.1116, 0.0974, 0.0571, 0.0551, 0.3227, 0.0120, 0.2133,
        0.0310])
[rfa agg] iter:  2, prev_obj_val: 66.80615234375, obj_val: 70.44464874267578, abs dis: 3.6384963989257812
[rfa agg] iter: 2, weight: tensor([0.0096, 0.0563, 0.1189, 0.0612, 0.0519, 0.0377, 0.5222, 0.0096, 0.1064,
        0.0263])
[rfa agg] iter:  3, prev_obj_val: 70.44464874267578, obj_val: 74.6337661743164, abs dis: 4.189117431640625
[rfa agg] iter: 3, weight: tensor([0.0130, 0.0611, 0.2481, 0.0654, 0.0835, 0.0433, 0.3353, 0.0130, 0.0987,
        0.0384])
[rfa agg] iter:  4, prev_obj_val: 74.6337661743164, obj_val: 77.08798217773438, abs dis: 2.4542160034179688
[rfa agg] iter: 4, weight: tensor([0.0130, 0.0490, 0.4595, 0.0518, 0.1091, 0.0364, 0.1543, 0.0130, 0.0712,
        0.0426])
[rfa agg] iter:  5, prev_obj_val: 77.08798217773438, obj_val: 77.0865478515625, abs dis: 0.001434326171875
[rfa agg] iter: 5, weight: tensor([0.0145, 0.0486, 0.4417, 0.0511, 0.1470, 0.0368, 0.1280, 0.0144, 0.0675,
        0.0504])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3352, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.1465, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.43277168273926 sec.
Server Epoch:17 choose agents : [36, 29, 28, 81, 55, 63, 33, 23, 5, 43].
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   1, Avg loss: 0.0870, Accuracy: 75/408 (18.3824%)
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   2, Avg loss: 0.0529, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.0460, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0480, Accuracy: 420/1440 (29.1667%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0274, Accuracy: 697/1440 (48.4028%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.5331, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 376/1581 (23.7824%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 606/1581 (38.3302%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7835, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  17, local model 81, internal_epoch   1, Avg loss: 0.0666, Accuracy: 233/774 (30.1034%)
_Train Local_ResNet_18, epoch  17, local model 81, internal_epoch   2, Avg loss: 0.0370, Accuracy: 293/774 (37.8553%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.9094, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   1, Avg loss: 0.0540, Accuracy: 276/1071 (25.7703%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 507/1071 (47.3389%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.4933, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   1, Avg loss: 0.0474, Accuracy: 324/888 (36.4865%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   2, Avg loss: 0.0245, Accuracy: 478/888 (53.8288%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.9878, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0749, Accuracy: 91/515 (17.6699%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0505, Accuracy: 142/515 (27.5728%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.5463, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   1, Avg loss: 0.0579, Accuracy: 326/715 (45.5944%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   2, Avg loss: 0.0397, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.1412, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0509, Accuracy: 397/1628 (24.3857%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0253, Accuracy: 822/1628 (50.4914%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.9988, Accuracy: 137/10000 (1.3700%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0636, Accuracy: 289/946 (30.5497%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 322/946 (34.0381%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.5066, Accuracy: 54/10000 (0.5400%)
time spent on training: 149.48322248458862
[rfa agg] training data poison_ratio: 0.0  data num: [408, 1440, 1581, 774, 1071, 888, 515, 715, 1628, 946]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 29, 28, 81, 55, 63, 33, 23, 5, 43], weight: tensor([0.0409, 0.1445, 0.1586, 0.0777, 0.1075, 0.0891, 0.0517, 0.0717, 0.1634,
        0.0949])
[rfa agg] iter:  0, prev_obj_val: 52.76689910888672, obj_val: 56.718441009521484, abs dis: 3.9515419006347656
[rfa agg] iter: 0, weight: tensor([0.0147, 0.0585, 0.0508, 0.0914, 0.1886, 0.1610, 0.0242, 0.0612, 0.0474,
        0.3022])
[rfa agg] iter:  1, prev_obj_val: 56.718441009521484, obj_val: 61.12932205200195, abs dis: 4.410881042480469
[rfa agg] iter: 1, weight: tensor([0.0151, 0.0414, 0.0372, 0.1636, 0.0893, 0.3015, 0.0266, 0.0865, 0.0351,
        0.2038])
[rfa agg] iter:  2, prev_obj_val: 61.12932205200195, obj_val: 66.9798355102539, abs dis: 5.850513458251953
[rfa agg] iter: 2, weight: tensor([0.0174, 0.0369, 0.0338, 0.3229, 0.0670, 0.1965, 0.0328, 0.1475, 0.0321,
        0.1131])
[rfa agg] iter:  3, prev_obj_val: 66.9798355102539, obj_val: 73.83834075927734, abs dis: 6.8585052490234375
[rfa agg] iter: 3, weight: tensor([0.0248, 0.0398, 0.0370, 0.2121, 0.0642, 0.1291, 0.0515, 0.3136, 0.0354,
        0.0924])
[rfa agg] iter:  4, prev_obj_val: 73.83834075927734, obj_val: 66.9444351196289, abs dis: 6.8939056396484375
[rfa agg] iter: 4, weight: tensor([0.0425, 0.0502, 0.0473, 0.1559, 0.0741, 0.1211, 0.1037, 0.2629, 0.0455,
        0.0969])
[rfa agg] iter:  5, prev_obj_val: 66.9444351196289, obj_val: 70.30532836914062, abs dis: 3.3608932495117188
[rfa agg] iter: 5, weight: tensor([0.0237, 0.0380, 0.0353, 0.1924, 0.0615, 0.1222, 0.0492, 0.3557, 0.0338,
        0.0883])
[rfa agg] iter:  6, prev_obj_val: 70.30532836914062, obj_val: 63.8846435546875, abs dis: 6.420684814453125
[rfa agg] iter: 6, weight: tensor([0.0310, 0.0429, 0.0401, 0.1641, 0.0660, 0.1174, 0.0688, 0.3414, 0.0385,
        0.0899])
[rfa agg] iter:  7, prev_obj_val: 63.8846435546875, obj_val: 70.31330108642578, abs dis: 6.428657531738281
[rfa agg] iter: 7, weight: tensor([0.0201, 0.0371, 0.0343, 0.2626, 0.0634, 0.1455, 0.0395, 0.2680, 0.0327,
        0.0968])
[rfa agg] iter:  8, prev_obj_val: 70.31330108642578, obj_val: 63.88160705566406, abs dis: 6.431694030761719
[rfa agg] iter: 8, weight: tensor([0.0317, 0.0438, 0.0410, 0.1703, 0.0674, 0.1204, 0.0704, 0.3236, 0.0393,
        0.0920])
[rfa agg] iter:  9, prev_obj_val: 63.88160705566406, obj_val: 70.31385040283203, abs dis: 6.432243347167969
[rfa agg] iter: 9, weight: tensor([0.0201, 0.0372, 0.0343, 0.2651, 0.0635, 0.1458, 0.0395, 0.2646, 0.0327,
        0.0970])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3381, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.1558, Accuracy: 0/9950 (0.0000%)
saving model
Done in 249.65261363983154 sec.
Server Epoch:18 choose agents : [77, 90, 3, 24, 2, 8, 79, 51, 73, 29].
_Train Local_ResNet_18, epoch  18, local model 77, internal_epoch   1, Avg loss: 0.0533, Accuracy: 336/1340 (25.0746%)
_Train Local_ResNet_18, epoch  18, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 531/1340 (39.6269%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.6150, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0594, Accuracy: 305/677 (45.0517%)
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0241, Accuracy: 437/677 (64.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.4450, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0731, Accuracy: 128/781 (16.3892%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0360, Accuracy: 246/781 (31.4981%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.7311, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0780, Accuracy: 35/312 (11.2179%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.1049, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0629, Accuracy: 240/605 (39.6694%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.4479, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 259/1513 (17.1183%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0359, Accuracy: 493/1513 (32.5843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.8063, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  18, local model 79, internal_epoch   1, Avg loss: 0.1046, Accuracy: 2/197 (1.0152%)
_Train Local_ResNet_18, epoch  18, local model 79, internal_epoch   2, Avg loss: 0.0871, Accuracy: 53/197 (26.9036%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.4253, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   1, Avg loss: 0.0593, Accuracy: 235/1049 (22.4023%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   2, Avg loss: 0.0290, Accuracy: 544/1049 (51.8589%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.0203, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   1, Avg loss: 0.0647, Accuracy: 182/938 (19.4030%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 313/938 (33.3689%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.0618, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   1, Avg loss: 0.0475, Accuracy: 415/1440 (28.8194%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   2, Avg loss: 0.0270, Accuracy: 727/1440 (50.4861%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.8245, Accuracy: 87/10000 (0.8700%)
time spent on training: 142.94338130950928
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 677, 781, 312, 605, 1513, 197, 1049, 938, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 90, 3, 24, 2, 8, 79, 51, 73, 29], weight: tensor([0.1514, 0.0765, 0.0882, 0.0352, 0.0683, 0.1709, 0.0223, 0.1185, 0.1060,
        0.1627])
[rfa agg] iter:  0, prev_obj_val: 47.4703483581543, obj_val: 49.52654266357422, abs dis: 2.056194305419922
[rfa agg] iter: 0, weight: tensor([0.0976, 0.0496, 0.0942, 0.0105, 0.0371, 0.0694, 0.0061, 0.2824, 0.2776,
        0.0756])
[rfa agg] iter:  1, prev_obj_val: 49.52654266357422, obj_val: 54.769287109375, abs dis: 5.242744445800781
[rfa agg] iter: 1, weight: tensor([0.0682, 0.0516, 0.1146, 0.0096, 0.0371, 0.0516, 0.0055, 0.1511, 0.4554,
        0.0553])
[rfa agg] iter:  2, prev_obj_val: 54.769287109375, obj_val: 56.73080825805664, abs dis: 1.9615211486816406
[rfa agg] iter: 2, weight: tensor([0.0637, 0.0936, 0.3367, 0.0132, 0.0611, 0.0514, 0.0074, 0.1040, 0.2147,
        0.0542])
[rfa agg] iter:  3, prev_obj_val: 56.73080825805664, obj_val: 61.7866325378418, abs dis: 5.055824279785156
[rfa agg] iter: 3, weight: tensor([0.0483, 0.0939, 0.4975, 0.0113, 0.0576, 0.0398, 0.0063, 0.0741, 0.1295,
        0.0417])
[rfa agg] iter:  4, prev_obj_val: 61.7866325378418, obj_val: 61.75634765625, abs dis: 0.030284881591796875
[rfa agg] iter: 4, weight: tensor([0.0573, 0.2205, 0.2866, 0.0172, 0.1125, 0.0486, 0.0095, 0.0797, 0.1175,
        0.0506])
[rfa agg] iter:  5, prev_obj_val: 61.75634765625, obj_val: 59.158355712890625, abs dis: 2.597991943359375
[rfa agg] iter: 5, weight: tensor([0.0574, 0.2318, 0.2740, 0.0172, 0.1132, 0.0487, 0.0095, 0.0798, 0.1178,
        0.0506])
[rfa agg] iter:  6, prev_obj_val: 59.158355712890625, obj_val: 59.145774841308594, abs dis: 0.01258087158203125
[rfa agg] iter: 6, weight: tensor([0.0546, 0.1486, 0.3933, 0.0145, 0.0825, 0.0457, 0.0081, 0.0795, 0.1257,
        0.0477])
[rfa agg] iter:  7, prev_obj_val: 59.145774841308594, obj_val: 59.14548873901367, abs dis: 0.000286102294921875
[rfa agg] iter: 7, weight: tensor([0.0531, 0.1423, 0.4126, 0.0141, 0.0801, 0.0444, 0.0078, 0.0772, 0.1220,
        0.0463])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3393, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.1146, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.94983458518982 sec.
Server Epoch:19 choose agents : [7, 87, 36, 17, 90, 93, 21, 60, 11, 15].
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0519, Accuracy: 382/891 (42.8732%)
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 444/891 (49.8316%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.9417, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  19, local model 87, internal_epoch   1, Avg loss: 0.0564, Accuracy: 306/1131 (27.0557%)
_Train Local_ResNet_18, epoch  19, local model 87, internal_epoch   2, Avg loss: 0.0311, Accuracy: 406/1131 (35.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1422, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   1, Avg loss: 0.0861, Accuracy: 75/408 (18.3824%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   2, Avg loss: 0.0541, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.2672, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0501, Accuracy: 452/1574 (28.7166%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0266, Accuracy: 700/1574 (44.4727%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.8158, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  19, local model 90, internal_epoch   1, Avg loss: 0.0570, Accuracy: 320/677 (47.2674%)
_Train Local_ResNet_18, epoch  19, local model 90, internal_epoch   2, Avg loss: 0.0219, Accuracy: 474/677 (70.0148%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.8420, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  19, local model 93, internal_epoch   1, Avg loss: 0.0546, Accuracy: 419/1742 (24.0528%)
_Train Local_ResNet_18, epoch  19, local model 93, internal_epoch   2, Avg loss: 0.0308, Accuracy: 698/1742 (40.0689%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1432, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 416/1949 (21.3443%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0323, Accuracy: 669/1949 (34.3253%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.4450, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 651/2227 (29.2322%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   2, Avg loss: 0.0272, Accuracy: 1057/2227 (47.4630%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.4882, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0536, Accuracy: 344/712 (48.3146%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0253, Accuracy: 420/712 (58.9888%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.7239, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   1, Avg loss: 0.0556, Accuracy: 342/1154 (29.6360%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   2, Avg loss: 0.0266, Accuracy: 510/1154 (44.1941%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.1271, Accuracy: 71/10000 (0.7100%)
time spent on training: 162.65597200393677
[rfa agg] training data poison_ratio: 0.0  data num: [891, 1131, 408, 1574, 677, 1742, 1949, 2227, 712, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 87, 36, 17, 90, 93, 21, 60, 11, 15], weight: tensor([0.0715, 0.0907, 0.0327, 0.1263, 0.0543, 0.1398, 0.1564, 0.1787, 0.0571,
        0.0926])
[rfa agg] iter:  0, prev_obj_val: 70.60295104980469, obj_val: 74.2919921875, abs dis: 3.6890411376953125
[rfa agg] iter: 0, weight: tensor([0.0531, 0.1331, 0.0130, 0.2375, 0.0295, 0.1376, 0.1032, 0.0819, 0.0340,
        0.1771])
[rfa agg] iter:  1, prev_obj_val: 74.2919921875, obj_val: 78.0326919555664, abs dis: 3.7406997680664062
[rfa agg] iter: 1, weight: tensor([0.0560, 0.2020, 0.0120, 0.1182, 0.0286, 0.0825, 0.0672, 0.0565, 0.0338,
        0.3432])
[rfa agg] iter:  2, prev_obj_val: 78.0326919555664, obj_val: 79.88945770263672, abs dis: 1.8567657470703125
[rfa agg] iter: 2, weight: tensor([0.0497, 0.3381, 0.0091, 0.0611, 0.0230, 0.0466, 0.0397, 0.0344, 0.0278,
        0.3706])
[rfa agg] iter:  3, prev_obj_val: 79.88945770263672, obj_val: 84.54315185546875, abs dis: 4.653694152832031
[rfa agg] iter: 3, weight: tensor([0.0542, 0.4699, 0.0092, 0.0552, 0.0240, 0.0431, 0.0371, 0.0325, 0.0293,
        0.2455])
[rfa agg] iter:  4, prev_obj_val: 84.54315185546875, obj_val: 82.10134887695312, abs dis: 2.441802978515625
[rfa agg] iter: 4, weight: tensor([0.1032, 0.3719, 0.0147, 0.0706, 0.0407, 0.0571, 0.0502, 0.0447, 0.0510,
        0.1959])
[rfa agg] iter:  5, prev_obj_val: 82.10134887695312, obj_val: 84.53898620605469, abs dis: 2.4376373291015625
[rfa agg] iter: 5, weight: tensor([0.0726, 0.4583, 0.0114, 0.0608, 0.0304, 0.0483, 0.0421, 0.0372, 0.0376,
        0.2013])
[rfa agg] iter:  6, prev_obj_val: 84.53898620605469, obj_val: 82.10128784179688, abs dis: 2.4376983642578125
[rfa agg] iter: 6, weight: tensor([0.1034, 0.3726, 0.0148, 0.0706, 0.0407, 0.0571, 0.0502, 0.0447, 0.0510,
        0.1950])
[rfa agg] iter:  7, prev_obj_val: 82.10128784179688, obj_val: 84.53900909423828, abs dis: 2.4377212524414062
[rfa agg] iter: 7, weight: tensor([0.0726, 0.4585, 0.0114, 0.0608, 0.0304, 0.0483, 0.0421, 0.0372, 0.0376,
        0.2012])
[rfa agg] iter:  8, prev_obj_val: 84.53900909423828, obj_val: 82.10128784179688, abs dis: 2.4377212524414062
[rfa agg] iter: 8, weight: tensor([0.1034, 0.3726, 0.0148, 0.0706, 0.0407, 0.0571, 0.0502, 0.0447, 0.0510,
        0.1950])
[rfa agg] iter:  9, prev_obj_val: 82.10128784179688, obj_val: 84.53900909423828, abs dis: 2.4377212524414062
[rfa agg] iter: 9, weight: tensor([0.0726, 0.4585, 0.0114, 0.0608, 0.0304, 0.0483, 0.0421, 0.0372, 0.0376,
        0.2012])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3431, Accuracy: 53/10000 (0.5300%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.1104, Accuracy: 0/9950 (0.0000%)
saving model
Done in 260.6659791469574 sec.
Server Epoch:20 choose agents : [76, 14, 55, 7, 64, 50, 71, 52, 59, 10].
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0846, Accuracy: 49/466 (10.5150%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0490, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.5388, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   1, Avg loss: 0.0586, Accuracy: 247/1013 (24.3830%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   2, Avg loss: 0.0344, Accuracy: 371/1013 (36.6239%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8250, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   1, Avg loss: 0.0537, Accuracy: 293/1071 (27.3576%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   2, Avg loss: 0.0280, Accuracy: 543/1071 (50.7003%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.8049, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0527, Accuracy: 363/891 (40.7407%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0254, Accuracy: 432/891 (48.4848%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.9294, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   1, Avg loss: 0.0633, Accuracy: 168/953 (17.6285%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   2, Avg loss: 0.0370, Accuracy: 332/953 (34.8374%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.1043, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   1, Avg loss: 0.0634, Accuracy: 161/809 (19.9011%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   2, Avg loss: 0.0264, Accuracy: 351/809 (43.3869%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.8322, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   1, Avg loss: 0.0538, Accuracy: 261/818 (31.9071%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   2, Avg loss: 0.0285, Accuracy: 392/818 (47.9218%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.3140, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   1, Avg loss: 0.0547, Accuracy: 308/636 (48.4277%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   2, Avg loss: 0.0300, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.5027, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0512, Accuracy: 338/1089 (31.0376%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0324, Accuracy: 481/1089 (44.1690%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 13.0298, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   1, Avg loss: 0.0573, Accuracy: 205/861 (23.8095%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   2, Avg loss: 0.0203, Accuracy: 469/861 (54.4715%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.9433, Accuracy: 74/10000 (0.7400%)
time spent on training: 145.49752020835876
[rfa agg] training data poison_ratio: 0.0  data num: [466, 1013, 1071, 891, 953, 809, 818, 636, 1089, 861]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [76, 14, 55, 7, 64, 50, 71, 52, 59, 10], weight: tensor([0.0541, 0.1177, 0.1244, 0.1035, 0.1107, 0.0940, 0.0950, 0.0739, 0.1265,
        0.1000])
[rfa agg] iter:  0, prev_obj_val: 32.32883834838867, obj_val: 32.29864501953125, abs dis: 0.030193328857421875
[rfa agg] iter: 0, weight: tensor([0.0435, 0.0736, 0.0637, 0.1124, 0.0884, 0.1614, 0.1646, 0.1280, 0.0547,
        0.1098])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3460, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.1035, Accuracy: 0/9950 (0.0000%)
saving model
Done in 245.5162832736969 sec.
Server Epoch:21 choose agents : [0, 17, 26, 47, 77, 99, 74, 94, 65, 22].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0556, Accuracy: 462/1657 (27.8817%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0302, Accuracy: 784/1657 (47.3144%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0255, Accuracy: 850/1657 (51.2975%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0250, Accuracy: 869/1657 (52.4442%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0247, Accuracy: 869/1657 (52.4442%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0240, Accuracy: 883/1657 (53.2891%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0237, Accuracy: 904/1657 (54.5564%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0234, Accuracy: 892/1657 (53.8322%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0232, Accuracy: 908/1657 (54.7978%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0233, Accuracy: 900/1657 (54.3150%), train_poison_data_count: 520
Global model norm: 112.02862618963735.
Norm before scaling: 112.00290349194078. Distance: 1.233160797929743
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.4179, Accuracy: 67/10000 (0.6700%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.2175, Accuracy: 9880/9950 (99.2965%)
Scaling by  100
Scaled Norm after poisoning: 164.40478579941035, distance: 123.31607952229912
Total norm for 1 adversaries is: 164.40478579941035. distance: 123.31607952229912
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   1, Avg loss: 0.0503, Accuracy: 415/1574 (26.3659%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   2, Avg loss: 0.0264, Accuracy: 696/1574 (44.2186%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.2158, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 337/1446 (23.3057%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0340, Accuracy: 535/1446 (36.9986%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6109, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   1, Avg loss: 0.1230, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   2, Avg loss: 0.1088, Accuracy: 4/134 (2.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3714, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0518, Accuracy: 342/1340 (25.5224%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 564/1340 (42.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.1387, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  21, local model 99, internal_epoch   1, Avg loss: 0.0621, Accuracy: 201/773 (26.0026%)
_Train Local_ResNet_18, epoch  21, local model 99, internal_epoch   2, Avg loss: 0.0301, Accuracy: 400/773 (51.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.6891, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   1, Avg loss: 0.0441, Accuracy: 525/1552 (33.8273%)
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   2, Avg loss: 0.0204, Accuracy: 801/1552 (51.6108%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 11.7999, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0542, Accuracy: 354/1662 (21.2996%)
_Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0319, Accuracy: 664/1662 (39.9519%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.0820, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0529, Accuracy: 415/1475 (28.1356%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0292, Accuracy: 700/1475 (47.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.4087, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   1, Avg loss: 0.0461, Accuracy: 518/1470 (35.2381%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 870/1470 (59.1837%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.8188, Accuracy: 103/10000 (1.0300%)
time spent on training: 305.5980303287506
[rfa agg] training data poison_ratio: 0.12665290835435297  data num: [1657, 1574, 1446, 134, 1340, 773, 1552, 1662, 1475, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.0395790338607353
[rfa agg] init. name: [0, 17, 26, 47, 77, 99, 74, 94, 65, 22], weight: tensor([0.1267, 0.1203, 0.1105, 0.0102, 0.1024, 0.0591, 0.1186, 0.1270, 0.1127,
        0.1124])
[rfa agg] iter:  0, prev_obj_val: 25665.931640625, obj_val: 16465.3671875, abs dis: 9200.564453125
[rfa agg] iter: 0, weight: tensor([0.0206, 0.1351, 0.1240, 0.0113, 0.1147, 0.0659, 0.1332, 0.1427, 0.1265,
        0.1260])
[rfa agg] iter:  1, prev_obj_val: 16465.3671875, obj_val: 14942.59765625, abs dis: 1522.76953125
[rfa agg] iter: 1, weight: tensor([0.0030, 0.1384, 0.1262, 0.0109, 0.1160, 0.0650, 0.1364, 0.1467, 0.1292,
        0.1283])
[rfa agg] iter:  2, prev_obj_val: 14942.59765625, obj_val: 14727.048828125, abs dis: 215.548828125
[rfa agg] iter: 2, weight: tensor([0.0004, 0.1446, 0.1255, 0.0075, 0.1102, 0.0525, 0.1426, 0.1574, 0.1317,
        0.1276])
[rfa agg] iter:  3, prev_obj_val: 14727.048828125, obj_val: 14724.7470703125, abs dis: 2.3017578125
[rfa agg] iter: 3, weight: tensor([2.4666e-05, 1.7397e-01, 7.7523e-02, 1.1009e-03, 4.6151e-02, 1.1037e-02,
        1.6830e-01, 3.3818e-01, 1.0565e-01, 7.8063e-02])
[rfa agg] iter:  4, prev_obj_val: 14724.7470703125, obj_val: 14729.9384765625, abs dis: 5.19140625
[rfa agg] iter: 4, weight: tensor([2.1782e-05, 1.0124e-01, 2.3653e-01, 1.1717e-03, 1.1943e-01, 1.3819e-02,
        9.9007e-02, 7.9715e-02, 1.3672e-01, 2.1235e-01])
[rfa agg] iter:  5, prev_obj_val: 14729.9384765625, obj_val: 14732.9873046875, abs dis: 3.048828125
[rfa agg] iter: 5, weight: tensor([2.7356e-05, 9.3103e-02, 1.8394e-01, 1.5512e-03, 2.3650e-01, 1.9384e-02,
        9.1291e-02, 7.7595e-02, 1.1712e-01, 1.7949e-01])
[rfa agg] iter:  6, prev_obj_val: 14732.9873046875, obj_val: 14732.9638671875, abs dis: 0.0234375
[rfa agg] iter: 6, weight: tensor([2.9106e-05, 8.7197e-02, 1.5235e-01, 1.6962e-03, 3.1971e-01, 2.1898e-02,
        8.5783e-02, 7.4563e-02, 1.0576e-01, 1.5101e-01])
[rfa agg] iter:  7, prev_obj_val: 14732.9638671875, obj_val: 14736.3408203125, abs dis: 3.376953125
[rfa agg] iter: 7, weight: tensor([2.8081e-05, 8.3945e-02, 1.4566e-01, 1.6364e-03, 3.4726e-01, 2.1121e-02,
        8.2705e-02, 7.1884e-02, 1.0164e-01, 1.4412e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3484, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.0947, Accuracy: 0/9950 (0.0000%)
saving model
Done in 402.44906735420227 sec.
Server Epoch:22 choose agents : [11, 22, 49, 18, 75, 2, 0, 8, 77, 54].
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 330/712 (46.3483%)
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   2, Avg loss: 0.0258, Accuracy: 416/712 (58.4270%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.0543, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0451, Accuracy: 547/1470 (37.2109%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0233, Accuracy: 860/1470 (58.5034%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.8400, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   1, Avg loss: 0.0792, Accuracy: 41/440 (9.3182%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   2, Avg loss: 0.0475, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.2798, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0738, Accuracy: 120/530 (22.6415%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0389, Accuracy: 276/530 (52.0755%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.5668, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  22, local model 75, internal_epoch   1, Avg loss: 0.0632, Accuracy: 261/776 (33.6340%)
_Train Local_ResNet_18, epoch  22, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 407/776 (52.4485%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.8992, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 229/605 (37.8512%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.7714, Accuracy: 59/10000 (0.5900%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  22, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 377/1657 (22.7520%)
_Train Local_ResNet_18, epoch  22, local model 0, internal_epoch   2, Avg loss: 0.0337, Accuracy: 565/1657 (34.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.2892, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0593, Accuracy: 282/1513 (18.6385%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0356, Accuracy: 500/1513 (33.0469%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.6994, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  22, local model 77, internal_epoch   1, Avg loss: 0.0498, Accuracy: 342/1340 (25.5224%)
_Train Local_ResNet_18, epoch  22, local model 77, internal_epoch   2, Avg loss: 0.0260, Accuracy: 576/1340 (42.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.0287, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   1, Avg loss: 0.0558, Accuracy: 347/1130 (30.7080%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 457/1130 (40.4425%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.5469, Accuracy: 60/10000 (0.6000%)
time spent on training: 185.06505918502808
[rfa agg] training data poison_ratio: 0.16288213899537993  data num: [712, 1470, 440, 530, 776, 605, 1657, 1513, 1340, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.05090066843605623
[rfa agg] init. name: [11, 22, 49, 18, 75, 2, 0, 8, 77, 54], weight: tensor([0.0700, 0.1445, 0.0433, 0.0521, 0.0763, 0.0595, 0.1629, 0.1487, 0.1317,
        0.1111])
[rfa agg] iter:  0, prev_obj_val: 57.174869537353516, obj_val: 57.15196990966797, abs dis: 0.022899627685546875
[rfa agg] iter: 0, weight: tensor([0.0879, 0.1042, 0.0244, 0.0377, 0.1257, 0.0501, 0.0825, 0.0940, 0.1321,
        0.2613])
[rfa agg] iter:  1, prev_obj_val: 57.15196990966797, obj_val: 58.90756607055664, abs dis: 1.7555961608886719
[rfa agg] iter: 1, weight: tensor([0.0874, 0.1035, 0.0243, 0.0375, 0.1253, 0.0498, 0.0820, 0.0934, 0.1312,
        0.2657])
[rfa agg] iter:  2, prev_obj_val: 58.90756607055664, obj_val: 58.905887603759766, abs dis: 0.001678466796875
[rfa agg] iter: 2, weight: tensor([0.1028, 0.1000, 0.0265, 0.0417, 0.1536, 0.0561, 0.0808, 0.0909, 0.1236,
        0.2240])
[rfa agg] iter:  3, prev_obj_val: 58.905887603759766, obj_val: 57.1536865234375, abs dis: 1.7522010803222656
[rfa agg] iter: 3, weight: tensor([0.1030, 0.1000, 0.0266, 0.0417, 0.1542, 0.0561, 0.0808, 0.0909, 0.1236,
        0.2232])
[rfa agg] iter:  4, prev_obj_val: 57.1536865234375, obj_val: 58.907501220703125, abs dis: 1.753814697265625
[rfa agg] iter: 4, weight: tensor([0.0875, 0.1036, 0.0243, 0.0375, 0.1257, 0.0498, 0.0821, 0.0935, 0.1313,
        0.2646])
[rfa agg] iter:  5, prev_obj_val: 58.907501220703125, obj_val: 58.905887603759766, abs dis: 0.001613616943359375
[rfa agg] iter: 5, weight: tensor([0.1028, 0.1000, 0.0265, 0.0417, 0.1537, 0.0561, 0.0808, 0.0909, 0.1236,
        0.2240])
[rfa agg] iter:  6, prev_obj_val: 58.905887603759766, obj_val: 57.1536865234375, abs dis: 1.7522010803222656
[rfa agg] iter: 6, weight: tensor([0.1030, 0.1000, 0.0266, 0.0417, 0.1542, 0.0561, 0.0808, 0.0909, 0.1236,
        0.2232])
[rfa agg] iter:  7, prev_obj_val: 57.1536865234375, obj_val: 58.907501220703125, abs dis: 1.753814697265625
[rfa agg] iter: 7, weight: tensor([0.0875, 0.1036, 0.0243, 0.0375, 0.1257, 0.0498, 0.0821, 0.0935, 0.1313,
        0.2646])
[rfa agg] iter:  8, prev_obj_val: 58.907501220703125, obj_val: 58.905887603759766, abs dis: 0.001613616943359375
[rfa agg] iter: 8, weight: tensor([0.1028, 0.1000, 0.0265, 0.0417, 0.1537, 0.0561, 0.0808, 0.0909, 0.1236,
        0.2240])
[rfa agg] iter:  9, prev_obj_val: 58.905887603759766, obj_val: 57.1536865234375, abs dis: 1.7522010803222656
[rfa agg] iter: 9, weight: tensor([0.1030, 0.1000, 0.0266, 0.0417, 0.1542, 0.0561, 0.0808, 0.0909, 0.1236,
        0.2232])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3493, Accuracy: 55/10000 (0.5500%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.1091, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.8318955898285 sec.
Server Epoch:23 choose agents : [20, 9, 53, 95, 2, 87, 22, 76, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0603, Accuracy: 224/807 (27.7571%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0344, Accuracy: 410/807 (50.8055%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0273, Accuracy: 497/807 (61.5861%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0247, Accuracy: 516/807 (63.9405%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0243, Accuracy: 519/807 (64.3123%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0223, Accuracy: 523/807 (64.8079%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0217, Accuracy: 530/807 (65.6753%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0207, Accuracy: 531/807 (65.7993%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0207, Accuracy: 544/807 (67.4102%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0213, Accuracy: 512/807 (63.4449%), train_poison_data_count: 260
Global model norm: 112.02515673806263.
Norm before scaling: 112.0143684979744. Distance: 0.8614974428560693
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.1673, Accuracy: 61/10000 (0.6100%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.5221, Accuracy: 9620/9950 (96.6834%)
Scaling by  100
Scaled Norm after poisoning: 140.1983109964239, distance: 86.1497492560193
Total norm for 1 adversaries is: 140.1983109964239. distance: 86.1497492560193
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0493, Accuracy: 363/1275 (28.4706%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0193, Accuracy: 688/1275 (53.9608%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.2297, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   1, Avg loss: 0.0474, Accuracy: 311/813 (38.2534%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 466/813 (57.3186%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 11.2989, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  23, local model 95, internal_epoch   1, Avg loss: 0.0524, Accuracy: 331/599 (55.2588%)
_Train Local_ResNet_18, epoch  23, local model 95, internal_epoch   2, Avg loss: 0.0279, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.2037, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0638, Accuracy: 229/605 (37.8512%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0394, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.4436, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  23, local model 87, internal_epoch   1, Avg loss: 0.0538, Accuracy: 338/1131 (29.8851%)
_Train Local_ResNet_18, epoch  23, local model 87, internal_epoch   2, Avg loss: 0.0305, Accuracy: 454/1131 (40.1415%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.3649, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   1, Avg loss: 0.0441, Accuracy: 561/1470 (38.1633%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   2, Avg loss: 0.0234, Accuracy: 870/1470 (59.1837%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.0514, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  23, local model 76, internal_epoch   1, Avg loss: 0.0829, Accuracy: 53/466 (11.3734%)
_Train Local_ResNet_18, epoch  23, local model 76, internal_epoch   2, Avg loss: 0.0451, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.6104, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0689, Accuracy: 150/781 (19.2061%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0347, Accuracy: 240/781 (30.7298%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.5742, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0505, Accuracy: 394/1628 (24.2015%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0247, Accuracy: 872/1628 (53.5627%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.3066, Accuracy: 157/10000 (1.5700%)
time spent on training: 255.86179757118225
[rfa agg] training data poison_ratio: 0.08428198433420366  data num: [807, 1275, 813, 599, 605, 1131, 1470, 466, 781, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.02633812010443864
[rfa agg] init. name: [20, 9, 53, 95, 2, 87, 22, 76, 3, 5], weight: tensor([0.0843, 0.1332, 0.0849, 0.0626, 0.0632, 0.1181, 0.1535, 0.0487, 0.0816,
        0.1700])
[rfa agg] iter:  0, prev_obj_val: 8936.865234375, obj_val: 5269.91015625, abs dis: 3666.955078125
[rfa agg] iter: 0, weight: tensor([0.0084, 0.1447, 0.0911, 0.0667, 0.0674, 0.1279, 0.1677, 0.0517, 0.0875,
        0.1868])
[rfa agg] iter:  1, prev_obj_val: 5269.91015625, obj_val: 4931.36279296875, abs dis: 338.54736328125
[rfa agg] iter: 1, weight: tensor([0.0007, 0.1490, 0.0832, 0.0582, 0.0588, 0.1270, 0.1828, 0.0438, 0.0799,
        0.2164])
[rfa agg] iter:  2, prev_obj_val: 4931.36279296875, obj_val: 4930.1572265625, abs dis: 1.20556640625
[rfa agg] iter: 2, weight: tensor([4.7385e-05, 2.8726e-01, 3.6230e-02, 1.9787e-02, 1.9980e-02, 1.2032e-01,
        3.3281e-01, 1.3121e-02, 3.4826e-02, 1.3563e-01])
[rfa agg] iter:  3, prev_obj_val: 4930.1572265625, obj_val: 4934.41259765625, abs dis: 4.25537109375
[rfa agg] iter: 3, weight: tensor([4.1237e-05, 2.5692e-01, 4.8312e-02, 2.3259e-02, 2.3481e-02, 4.0823e-01,
        1.0718e-01, 1.4673e-02, 4.6519e-02, 7.1383e-02])
[rfa agg] iter:  4, prev_obj_val: 4934.41259765625, obj_val: 4940.1298828125, abs dis: 5.71728515625
[rfa agg] iter: 4, weight: tensor([5.7944e-05, 1.6627e-01, 1.0506e-01, 4.2625e-02, 4.3064e-02, 3.3232e-01,
        1.0442e-01, 2.5454e-02, 1.0135e-01, 7.9383e-02])
[rfa agg] iter:  5, prev_obj_val: 4940.1298828125, obj_val: 4943.15576171875, abs dis: 3.02587890625
[rfa agg] iter: 5, weight: tensor([5.7834e-05, 1.0675e-01, 2.2441e-01, 6.1181e-02, 6.1798e-02, 1.4840e-01,
        8.0007e-02, 3.3195e-02, 2.1861e-01, 6.5599e-02])
[rfa agg] iter:  6, prev_obj_val: 4943.15576171875, obj_val: 4944.99169921875, abs dis: 1.8359375
[rfa agg] iter: 6, weight: tensor([3.9123e-05, 6.1220e-02, 3.1936e-01, 5.3054e-02, 5.3482e-02, 7.8084e-02,
        4.8457e-02, 2.6523e-02, 3.1893e-01, 4.0851e-02])
[rfa agg] iter:  7, prev_obj_val: 4944.99169921875, obj_val: 4956.06103515625, abs dis: 11.0693359375
[rfa agg] iter: 7, weight: tensor([3.0046e-05, 4.3653e-02, 3.5730e-01, 4.7262e-02, 4.7553e-02, 5.3959e-02,
        3.5345e-02, 2.2371e-02, 3.6236e-01, 3.0166e-02])
[rfa agg] iter:  8, prev_obj_val: 4956.06103515625, obj_val: 4950.2431640625, abs dis: 5.81787109375
[rfa agg] iter: 8, weight: tensor([5.0503e-05, 5.7244e-02, 1.5964e-01, 2.0614e-01, 2.0242e-01, 6.5164e-02,
        4.9583e-02, 6.1914e-02, 1.5386e-01, 4.3984e-02])
[rfa agg] iter:  9, prev_obj_val: 4950.2431640625, obj_val: 4950.22265625, abs dis: 0.0205078125
[rfa agg] iter: 9, weight: tensor([4.7070e-05, 5.9988e-02, 2.5891e-01, 1.1011e-01, 1.1056e-01, 7.0738e-02,
        5.0406e-02, 4.3735e-02, 2.5158e-01, 4.3915e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3505, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.1177, Accuracy: 0/9950 (0.0000%)
saving model
Done in 356.7529454231262 sec.
Server Epoch:24 choose agents : [63, 82, 85, 83, 14, 68, 3, 11, 51, 71].
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   1, Avg loss: 0.0481, Accuracy: 320/888 (36.0360%)
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   2, Avg loss: 0.0246, Accuracy: 446/888 (50.2252%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.1106, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 77/500 (15.4000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 184/500 (36.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.7019, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  24, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 447/1988 (22.4849%)
_Train Local_ResNet_18, epoch  24, local model 85, internal_epoch   2, Avg loss: 0.0346, Accuracy: 716/1988 (36.0161%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.2140, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0548, Accuracy: 423/1953 (21.6590%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 703/1953 (35.9959%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.2321, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0584, Accuracy: 233/1013 (23.0010%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0336, Accuracy: 378/1013 (37.3149%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.6093, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   1, Avg loss: 0.0633, Accuracy: 359/1163 (30.8684%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   2, Avg loss: 0.0366, Accuracy: 424/1163 (36.4574%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.5011, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0678, Accuracy: 151/781 (19.3342%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0342, Accuracy: 259/781 (33.1626%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.0199, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   1, Avg loss: 0.0526, Accuracy: 340/712 (47.7528%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 415/712 (58.2865%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.9438, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   1, Avg loss: 0.0581, Accuracy: 237/1049 (22.5929%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   2, Avg loss: 0.0287, Accuracy: 553/1049 (52.7169%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.0704, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   1, Avg loss: 0.0535, Accuracy: 268/818 (32.7628%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   2, Avg loss: 0.0281, Accuracy: 388/818 (47.4328%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.5517, Accuracy: 88/10000 (0.8800%)
time spent on training: 170.27805733680725
[rfa agg] training data poison_ratio: 0.0  data num: [888, 500, 1988, 1953, 1013, 1163, 781, 712, 1049, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 82, 85, 83, 14, 68, 3, 11, 51, 71], weight: tensor([0.0817, 0.0460, 0.1830, 0.1798, 0.0932, 0.1070, 0.0719, 0.0655, 0.0965,
        0.0753])
[rfa agg] iter:  0, prev_obj_val: 65.47389221191406, obj_val: 68.89453887939453, abs dis: 3.4206466674804688
[rfa agg] iter: 0, weight: tensor([0.0707, 0.0162, 0.0459, 0.0485, 0.1533, 0.2809, 0.0501, 0.0382, 0.2437,
        0.0525])
[rfa agg] iter:  1, prev_obj_val: 68.89453887939453, obj_val: 71.96211242675781, abs dis: 3.0675735473632812
[rfa agg] iter: 1, weight: tensor([0.1948, 0.0199, 0.0326, 0.0340, 0.2292, 0.0800, 0.1023, 0.0646, 0.1356,
        0.1070])
[rfa agg] iter:  2, prev_obj_val: 71.96211242675781, obj_val: 83.01972198486328, abs dis: 11.057609558105469
[rfa agg] iter: 2, weight: tensor([0.3196, 0.0186, 0.0247, 0.0257, 0.1085, 0.0514, 0.1455, 0.0763, 0.0750,
        0.1546])
[rfa agg] iter:  3, prev_obj_val: 83.01972198486328, obj_val: 82.94332885742188, abs dis: 0.07639312744140625
[rfa agg] iter: 3, weight: tensor([0.1107, 0.0319, 0.0255, 0.0264, 0.0641, 0.0424, 0.1677, 0.2967, 0.0529,
        0.1818])
[rfa agg] iter:  4, prev_obj_val: 82.94332885742188, obj_val: 86.73963928222656, abs dis: 3.7963104248046875
[rfa agg] iter: 4, weight: tensor([0.0981, 0.0289, 0.0231, 0.0239, 0.0579, 0.0383, 0.1556, 0.3629, 0.0479,
        0.1634])
[rfa agg] iter:  5, prev_obj_val: 86.73963928222656, obj_val: 94.69465637207031, abs dis: 7.95501708984375
[rfa agg] iter: 5, weight: tensor([0.1030, 0.0425, 0.0291, 0.0300, 0.0667, 0.0462, 0.1448, 0.3298, 0.0564,
        0.1514])
[rfa agg] iter:  6, prev_obj_val: 94.69465637207031, obj_val: 79.51238250732422, abs dis: 15.182273864746094
[rfa agg] iter: 6, weight: tensor([0.1139, 0.0896, 0.0422, 0.0435, 0.0834, 0.0622, 0.1387, 0.2085, 0.0729,
        0.1452])
[rfa agg] iter:  7, prev_obj_val: 79.51238250732422, obj_val: 86.74848175048828, abs dis: 7.2360992431640625
[rfa agg] iter: 7, weight: tensor([0.1185, 0.0242, 0.0222, 0.0230, 0.0619, 0.0387, 0.2161, 0.2187, 0.0498,
        0.2268])
[rfa agg] iter:  8, prev_obj_val: 86.74848175048828, obj_val: 90.69241333007812, abs dis: 3.9439315795898438
[rfa agg] iter: 8, weight: tensor([0.1062, 0.0437, 0.0299, 0.0309, 0.0686, 0.0475, 0.1501, 0.3075, 0.0580,
        0.1577])
[rfa agg] iter:  9, prev_obj_val: 90.69241333007812, obj_val: 76.47908782958984, abs dis: 14.213325500488281
[rfa agg] iter: 9, weight: tensor([0.1121, 0.0638, 0.0367, 0.0378, 0.0778, 0.0560, 0.1449, 0.2523, 0.0669,
        0.1517])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3542, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.1304, Accuracy: 0/9950 (0.0000%)
saving model
Done in 270.82237243652344 sec.
Server Epoch:25 choose agents : [15, 70, 45, 27, 54, 88, 16, 95, 32, 3].
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0546, Accuracy: 352/1154 (30.5026%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 431/1154 (37.3484%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.5584, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   1, Avg loss: 0.0553, Accuracy: 416/1418 (29.3371%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 638/1418 (44.9929%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.2482, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   1, Avg loss: 0.0657, Accuracy: 209/669 (31.2407%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   2, Avg loss: 0.0386, Accuracy: 360/669 (53.8117%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.4173, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   1, Avg loss: 0.0546, Accuracy: 400/1587 (25.2048%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   2, Avg loss: 0.0332, Accuracy: 616/1587 (38.8154%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7488, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0538, Accuracy: 350/1130 (30.9735%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0284, Accuracy: 474/1130 (41.9469%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.5905, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  25, local model 88, internal_epoch   1, Avg loss: 0.0725, Accuracy: 146/603 (24.2123%)
_Train Local_ResNet_18, epoch  25, local model 88, internal_epoch   2, Avg loss: 0.0445, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.7729, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0655, Accuracy: 275/708 (38.8418%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0327, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.8756, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0519, Accuracy: 326/599 (54.4240%)
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.3896, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0565, Accuracy: 221/735 (30.0680%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0213, Accuracy: 366/735 (49.7959%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.4606, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  25, local model 3, internal_epoch   1, Avg loss: 0.0656, Accuracy: 160/781 (20.4866%)
_Train Local_ResNet_18, epoch  25, local model 3, internal_epoch   2, Avg loss: 0.0338, Accuracy: 257/781 (32.9065%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8414, Accuracy: 92/10000 (0.9200%)
time spent on training: 165.52734470367432
[rfa agg] training data poison_ratio: 0.0  data num: [1154, 1418, 669, 1587, 1130, 603, 708, 599, 735, 781]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [15, 70, 45, 27, 54, 88, 16, 95, 32, 3], weight: tensor([0.1230, 0.1511, 0.0713, 0.1691, 0.1204, 0.0643, 0.0754, 0.0638, 0.0783,
        0.0832])
[rfa agg] iter:  0, prev_obj_val: 48.68576431274414, obj_val: 50.81184768676758, abs dis: 2.1260833740234375
[rfa agg] iter: 0, weight: tensor([0.1056, 0.0700, 0.0790, 0.0636, 0.1330, 0.0560, 0.1155, 0.0557, 0.1201,
        0.2016])
[rfa agg] iter:  1, prev_obj_val: 50.81184768676758, obj_val: 65.59223937988281, abs dis: 14.780391693115234
[rfa agg] iter: 1, weight: tensor([0.0471, 0.0350, 0.0785, 0.0327, 0.0554, 0.0490, 0.1493, 0.0486, 0.1572,
        0.3471])
[rfa agg] iter:  2, prev_obj_val: 65.59223937988281, obj_val: 61.95326614379883, abs dis: 3.6389732360839844
[rfa agg] iter: 2, weight: tensor([0.0319, 0.0272, 0.1378, 0.0264, 0.0352, 0.2612, 0.0846, 0.2427, 0.0886,
        0.0645])
[rfa agg] iter:  3, prev_obj_val: 61.95326614379883, obj_val: 61.945648193359375, abs dis: 0.007617950439453125
[rfa agg] iter: 3, weight: tensor([0.0315, 0.0264, 0.1945, 0.0256, 0.0350, 0.2071, 0.1014, 0.2010, 0.1065,
        0.0709])
[rfa agg] iter:  4, prev_obj_val: 61.945648193359375, obj_val: 65.48110961914062, abs dis: 3.53546142578125
[rfa agg] iter: 4, weight: tensor([0.0316, 0.0265, 0.2039, 0.0256, 0.0351, 0.2011, 0.1020, 0.1961, 0.1071,
        0.0711])
[rfa agg] iter:  5, prev_obj_val: 65.48110961914062, obj_val: 69.5351791381836, abs dis: 4.054069519042969
[rfa agg] iter: 5, weight: tensor([0.0291, 0.0248, 0.1324, 0.0241, 0.0321, 0.2765, 0.0771, 0.2649, 0.0807,
        0.0582])
[rfa agg] iter:  6, prev_obj_val: 69.5351791381836, obj_val: 65.46659851074219, abs dis: 4.068580627441406
[rfa agg] iter: 6, weight: tensor([0.0354, 0.0307, 0.1204, 0.0300, 0.0388, 0.2613, 0.0804, 0.2548, 0.0838,
        0.0644])
[rfa agg] iter:  7, prev_obj_val: 65.46659851074219, obj_val: 69.53558349609375, abs dis: 4.0689849853515625
[rfa agg] iter: 7, weight: tensor([0.0280, 0.0239, 0.1237, 0.0232, 0.0309, 0.2861, 0.0741, 0.2765, 0.0774,
        0.0561])
[rfa agg] iter:  8, prev_obj_val: 69.53558349609375, obj_val: 65.46653747558594, abs dis: 4.0690460205078125
[rfa agg] iter: 8, weight: tensor([0.0353, 0.0306, 0.1199, 0.0299, 0.0387, 0.2618, 0.0802, 0.2558, 0.0836,
        0.0643])
[rfa agg] iter:  9, prev_obj_val: 65.46653747558594, obj_val: 69.53559112548828, abs dis: 4.069053649902344
[rfa agg] iter: 9, weight: tensor([0.0280, 0.0239, 0.1237, 0.0232, 0.0309, 0.2861, 0.0741, 0.2767, 0.0774,
        0.0561])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3555, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.1024, Accuracy: 0/9950 (0.0000%)
saving model
Done in 270.3579454421997 sec.
Server Epoch:26 choose agents : [16, 82, 49, 81, 57, 74, 75, 46, 55, 43].
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   1, Avg loss: 0.0629, Accuracy: 274/708 (38.7006%)
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   2, Avg loss: 0.0355, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.4771, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 77/500 (15.4000%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0495, Accuracy: 193/500 (38.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.6568, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0776, Accuracy: 58/440 (13.1818%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0468, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.3518, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 81, internal_epoch   1, Avg loss: 0.0650, Accuracy: 242/774 (31.2661%)
_Train Local_ResNet_18, epoch  26, local model 81, internal_epoch   2, Avg loss: 0.0333, Accuracy: 306/774 (39.5349%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.4644, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   1, Avg loss: 0.0519, Accuracy: 316/1154 (27.3830%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   2, Avg loss: 0.0244, Accuracy: 544/1154 (47.1404%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.3513, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 538/1552 (34.6649%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 784/1552 (50.5155%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 11.0744, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   1, Avg loss: 0.0624, Accuracy: 264/776 (34.0206%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   2, Avg loss: 0.0271, Accuracy: 433/776 (55.7990%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.6951, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   1, Avg loss: 0.0545, Accuracy: 412/1904 (21.6387%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   2, Avg loss: 0.0306, Accuracy: 719/1904 (37.7626%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.9969, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   1, Avg loss: 0.0538, Accuracy: 297/1071 (27.7311%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   2, Avg loss: 0.0280, Accuracy: 535/1071 (49.9533%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.6352, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  26, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 299/946 (31.6068%)
_Train Local_ResNet_18, epoch  26, local model 43, internal_epoch   2, Avg loss: 0.0349, Accuracy: 351/946 (37.1036%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.8297, Accuracy: 64/10000 (0.6400%)
time spent on training: 163.1069622039795
[rfa agg] training data poison_ratio: 0.0  data num: [708, 500, 440, 774, 1154, 1552, 776, 1904, 1071, 946]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 82, 49, 81, 57, 74, 75, 46, 55, 43], weight: tensor([0.0721, 0.0509, 0.0448, 0.0788, 0.1175, 0.1580, 0.0790, 0.1938, 0.1090,
        0.0963])
[rfa agg] iter:  0, prev_obj_val: 57.041748046875, obj_val: 60.0015869140625, abs dis: 2.9598388671875
[rfa agg] iter: 0, weight: tensor([0.0581, 0.0209, 0.0163, 0.0836, 0.1234, 0.0574, 0.0840, 0.0454, 0.2668,
        0.2442])
[rfa agg] iter:  1, prev_obj_val: 60.0015869140625, obj_val: 65.25643920898438, abs dis: 5.254852294921875
[rfa agg] iter: 1, weight: tensor([0.0812, 0.0230, 0.0176, 0.1368, 0.0756, 0.0442, 0.1387, 0.0368, 0.1230,
        0.3232])
[rfa agg] iter:  2, prev_obj_val: 65.25643920898438, obj_val: 70.67415618896484, abs dis: 5.417716979980469
[rfa agg] iter: 2, weight: tensor([0.1440, 0.0250, 0.0183, 0.2544, 0.0478, 0.0324, 0.2708, 0.0281, 0.0656,
        0.1135])
[rfa agg] iter:  3, prev_obj_val: 70.67415618896484, obj_val: 77.4303207397461, abs dis: 6.75616455078125
[rfa agg] iter: 3, weight: tensor([0.3029, 0.0356, 0.0251, 0.1861, 0.0468, 0.0341, 0.1917, 0.0303, 0.0603,
        0.0871])
[rfa agg] iter:  4, prev_obj_val: 77.4303207397461, obj_val: 70.64745330810547, abs dis: 6.782867431640625
[rfa agg] iter: 4, weight: tensor([0.2600, 0.0689, 0.0456, 0.1526, 0.0599, 0.0462, 0.1546, 0.0418, 0.0736,
        0.0968])
[rfa agg] iter:  5, prev_obj_val: 70.64745330810547, obj_val: 77.43265533447266, abs dis: 6.7852020263671875
[rfa agg] iter: 5, weight: tensor([0.3400, 0.0342, 0.0241, 0.1734, 0.0450, 0.0328, 0.1794, 0.0291, 0.0580,
        0.0839])
[rfa agg] iter:  6, prev_obj_val: 77.43265533447266, obj_val: 70.64708709716797, abs dis: 6.7855682373046875
[rfa agg] iter: 6, weight: tensor([0.2625, 0.0687, 0.0454, 0.1518, 0.0597, 0.0461, 0.1540, 0.0417, 0.0734,
        0.0966])
[rfa agg] iter:  7, prev_obj_val: 70.64708709716797, obj_val: 77.43272399902344, abs dis: 6.785636901855469
[rfa agg] iter: 7, weight: tensor([0.3408, 0.0342, 0.0241, 0.1731, 0.0450, 0.0328, 0.1792, 0.0291, 0.0579,
        0.0838])
[rfa agg] iter:  8, prev_obj_val: 77.43272399902344, obj_val: 70.6470718383789, abs dis: 6.785652160644531
[rfa agg] iter: 8, weight: tensor([0.2626, 0.0687, 0.0454, 0.1518, 0.0597, 0.0461, 0.1540, 0.0417, 0.0734,
        0.0965])
[rfa agg] iter:  9, prev_obj_val: 70.6470718383789, obj_val: 77.43272399902344, abs dis: 6.785652160644531
[rfa agg] iter: 9, weight: tensor([0.3409, 0.0342, 0.0241, 0.1731, 0.0450, 0.0328, 0.1792, 0.0291, 0.0579,
        0.0838])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3565, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.1115, Accuracy: 0/9950 (0.0000%)
saving model
Done in 269.4233205318451 sec.
Server Epoch:27 choose agents : [80, 8, 51, 85, 26, 14, 96, 99, 43, 16].
_Train Local_ResNet_18, epoch  27, local model 80, internal_epoch   1, Avg loss: 0.0663, Accuracy: 162/682 (23.7537%)
_Train Local_ResNet_18, epoch  27, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 237/682 (34.7507%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.7918, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0592, Accuracy: 281/1513 (18.5724%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0350, Accuracy: 527/1513 (34.8315%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.1236, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0580, Accuracy: 260/1049 (24.7855%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0283, Accuracy: 536/1049 (51.0963%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.1503, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0534, Accuracy: 476/1988 (23.9437%)
_Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0347, Accuracy: 709/1988 (35.6640%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0816, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 332/1446 (22.9599%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   2, Avg loss: 0.0340, Accuracy: 526/1446 (36.3762%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9263, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   1, Avg loss: 0.0572, Accuracy: 266/1013 (26.2586%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   2, Avg loss: 0.0334, Accuracy: 402/1013 (39.6841%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0115, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  27, local model 96, internal_epoch   1, Avg loss: 0.0792, Accuracy: 37/311 (11.8971%)
_Train Local_ResNet_18, epoch  27, local model 96, internal_epoch   2, Avg loss: 0.0532, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.8411, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.0589, Accuracy: 251/773 (32.4709%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0317, Accuracy: 447/773 (57.8266%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.2302, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   1, Avg loss: 0.0601, Accuracy: 309/946 (32.6638%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   2, Avg loss: 0.0342, Accuracy: 350/946 (36.9979%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.9070, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  27, local model 16, internal_epoch   1, Avg loss: 0.0610, Accuracy: 292/708 (41.2429%)
_Train Local_ResNet_18, epoch  27, local model 16, internal_epoch   2, Avg loss: 0.0354, Accuracy: 425/708 (60.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.1855, Accuracy: 66/10000 (0.6600%)
time spent on training: 175.00476264953613
[rfa agg] training data poison_ratio: 0.0  data num: [682, 1513, 1049, 1988, 1446, 1013, 311, 773, 946, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 8, 51, 85, 26, 14, 96, 99, 43, 16], weight: tensor([0.0654, 0.1451, 0.1006, 0.1906, 0.1387, 0.0971, 0.0298, 0.0741, 0.0907,
        0.0679])
[rfa agg] iter:  0, prev_obj_val: 58.267581939697266, obj_val: 62.772987365722656, abs dis: 4.505405426025391
[rfa agg] iter: 0, weight: tensor([0.0345, 0.0762, 0.3300, 0.0452, 0.0861, 0.2024, 0.0082, 0.0561, 0.1190,
        0.0421])
[rfa agg] iter:  1, prev_obj_val: 62.772987365722656, obj_val: 64.65196990966797, abs dis: 1.8789825439453125
[rfa agg] iter: 1, weight: tensor([0.0451, 0.0450, 0.1331, 0.0314, 0.0484, 0.2304, 0.0084, 0.0969, 0.3003,
        0.0611])
[rfa agg] iter:  2, prev_obj_val: 64.65196990966797, obj_val: 69.29804992675781, abs dis: 4.646080017089844
[rfa agg] iter: 2, weight: tensor([0.0528, 0.0436, 0.1078, 0.0312, 0.0466, 0.1739, 0.0090, 0.1285, 0.3320,
        0.0746])
[rfa agg] iter:  3, prev_obj_val: 69.29804992675781, obj_val: 69.25045013427734, abs dis: 0.04759979248046875
[rfa agg] iter: 3, weight: tensor([0.0799, 0.0432, 0.0868, 0.0323, 0.0457, 0.1186, 0.0110, 0.2768, 0.1778,
        0.1279])
[rfa agg] iter:  4, prev_obj_val: 69.25045013427734, obj_val: 77.79078674316406, abs dis: 8.540336608886719
[rfa agg] iter: 4, weight: tensor([0.0771, 0.0416, 0.0835, 0.0311, 0.0440, 0.1137, 0.0106, 0.3069, 0.1662,
        0.1253])
[rfa agg] iter:  5, prev_obj_val: 77.79078674316406, obj_val: 81.17390441894531, abs dis: 3.38311767578125
[rfa agg] iter: 5, weight: tensor([0.1673, 0.0358, 0.0586, 0.0283, 0.0374, 0.0712, 0.0126, 0.1964, 0.0875,
        0.3049])
[rfa agg] iter:  6, prev_obj_val: 81.17390441894531, obj_val: 84.8473129272461, abs dis: 3.6734085083007812
[rfa agg] iter: 6, weight: tensor([0.2688, 0.0349, 0.0541, 0.0280, 0.0362, 0.0643, 0.0138, 0.1391, 0.0765,
        0.2844])
[rfa agg] iter:  7, prev_obj_val: 84.8473129272461, obj_val: 84.82158660888672, abs dis: 0.025726318359375
[rfa agg] iter: 7, weight: tensor([0.4228, 0.0338, 0.0502, 0.0275, 0.0350, 0.0584, 0.0151, 0.1075, 0.0678,
        0.1819])
[rfa agg] iter:  8, prev_obj_val: 84.82158660888672, obj_val: 88.8182373046875, abs dis: 3.9966506958007812
[rfa agg] iter: 8, weight: tensor([0.4879, 0.0304, 0.0451, 0.0247, 0.0315, 0.0525, 0.0135, 0.0961, 0.0609,
        0.1576])
[rfa agg] iter:  9, prev_obj_val: 88.8182373046875, obj_val: 84.82350158691406, abs dis: 3.9947357177734375
[rfa agg] iter: 9, weight: tensor([0.4085, 0.0399, 0.0568, 0.0329, 0.0412, 0.0651, 0.0201, 0.1065, 0.0741,
        0.1549])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3583, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.1317, Accuracy: 0/9950 (0.0000%)
saving model
Done in 279.6501922607422 sec.
Server Epoch:28 choose agents : [55, 21, 93, 68, 49, 92, 86, 77, 7, 84].
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   1, Avg loss: 0.0532, Accuracy: 298/1071 (27.8245%)
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   2, Avg loss: 0.0280, Accuracy: 534/1071 (49.8599%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.9566, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 417/1949 (21.3956%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 641/1949 (32.8887%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.4864, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   1, Avg loss: 0.0537, Accuracy: 412/1742 (23.6510%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   2, Avg loss: 0.0310, Accuracy: 686/1742 (39.3800%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.3071, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   1, Avg loss: 0.0615, Accuracy: 363/1163 (31.2124%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   2, Avg loss: 0.0353, Accuracy: 453/1163 (38.9510%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.5027, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   1, Avg loss: 0.0771, Accuracy: 62/440 (14.0909%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   2, Avg loss: 0.0468, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.5597, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0534, Accuracy: 444/1715 (25.8892%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0301, Accuracy: 757/1715 (44.1399%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.5715, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  28, local model 86, internal_epoch   1, Avg loss: 0.0586, Accuracy: 366/1003 (36.4905%)
_Train Local_ResNet_18, epoch  28, local model 86, internal_epoch   2, Avg loss: 0.0338, Accuracy: 374/1003 (37.2881%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.6652, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 77, internal_epoch   1, Avg loss: 0.0495, Accuracy: 368/1340 (27.4627%)
_Train Local_ResNet_18, epoch  28, local model 77, internal_epoch   2, Avg loss: 0.0258, Accuracy: 597/1340 (44.5522%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.6745, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  28, local model 7, internal_epoch   1, Avg loss: 0.0527, Accuracy: 365/891 (40.9652%)
_Train Local_ResNet_18, epoch  28, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 412/891 (46.2402%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.6256, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  28, local model 84, internal_epoch   1, Avg loss: 0.0583, Accuracy: 337/1190 (28.3193%)
_Train Local_ResNet_18, epoch  28, local model 84, internal_epoch   2, Avg loss: 0.0304, Accuracy: 512/1190 (43.0252%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.7778, Accuracy: 103/10000 (1.0300%)
time spent on training: 187.9253695011139
[rfa agg] training data poison_ratio: 0.0  data num: [1071, 1949, 1742, 1163, 440, 1715, 1003, 1340, 891, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [55, 21, 93, 68, 49, 92, 86, 77, 7, 84], weight: tensor([0.0857, 0.1559, 0.1393, 0.0930, 0.0352, 0.1372, 0.0802, 0.1072, 0.0713,
        0.0952])
[rfa agg] iter:  0, prev_obj_val: 52.383338928222656, obj_val: 57.676998138427734, abs dis: 5.293659210205078
[rfa agg] iter: 0, weight: tensor([0.0954, 0.0317, 0.0377, 0.3248, 0.0072, 0.0418, 0.0631, 0.1184, 0.0344,
        0.2455])
[rfa agg] iter:  1, prev_obj_val: 57.676998138427734, obj_val: 59.89145278930664, abs dis: 2.2144546508789062
[rfa agg] iter: 1, weight: tensor([0.2460, 0.0345, 0.0396, 0.1739, 0.0100, 0.0431, 0.1389, 0.0883, 0.0594,
        0.1662])
[rfa agg] iter:  2, prev_obj_val: 59.89145278930664, obj_val: 65.3917007446289, abs dis: 5.500247955322266
[rfa agg] iter: 2, weight: tensor([0.3179, 0.0316, 0.0359, 0.1260, 0.0100, 0.0389, 0.1774, 0.0738, 0.0652,
        0.1233])
[rfa agg] iter:  3, prev_obj_val: 65.3917007446289, obj_val: 68.54786682128906, abs dis: 3.1561660766601562
[rfa agg] iter: 3, weight: tensor([0.2169, 0.0320, 0.0357, 0.0934, 0.0121, 0.0384, 0.3119, 0.0648, 0.1015,
        0.0933])
[rfa agg] iter:  4, prev_obj_val: 68.54786682128906, obj_val: 65.34151458740234, abs dis: 3.2063522338867188
[rfa agg] iter: 4, weight: tensor([0.1676, 0.0336, 0.0372, 0.0873, 0.0138, 0.0398, 0.3287, 0.0641, 0.1402,
        0.0877])
[rfa agg] iter:  5, prev_obj_val: 65.34151458740234, obj_val: 71.96308898925781, abs dis: 6.621574401855469
[rfa agg] iter: 5, weight: tensor([0.1858, 0.0299, 0.0334, 0.0870, 0.0113, 0.0359, 0.3732, 0.0606, 0.0960,
        0.0870])
[rfa agg] iter:  6, prev_obj_val: 71.96308898925781, obj_val: 65.36214447021484, abs dis: 6.600944519042969
[rfa agg] iter: 6, weight: tensor([0.1491, 0.0369, 0.0405, 0.0869, 0.0167, 0.0433, 0.2628, 0.0668, 0.2095,
        0.0877])
[rfa agg] iter:  7, prev_obj_val: 65.36214447021484, obj_val: 71.95938873291016, abs dis: 6.5972442626953125
[rfa agg] iter: 7, weight: tensor([0.1910, 0.0309, 0.0345, 0.0898, 0.0116, 0.0370, 0.3525, 0.0626, 0.1002,
        0.0900])
[rfa agg] iter:  8, prev_obj_val: 71.95938873291016, obj_val: 65.3626480102539, abs dis: 6.59674072265625
[rfa agg] iter: 8, weight: tensor([0.1495, 0.0369, 0.0406, 0.0870, 0.0167, 0.0433, 0.2608, 0.0669, 0.2104,
        0.0878])
[rfa agg] iter:  9, prev_obj_val: 65.3626480102539, obj_val: 68.54505157470703, abs dis: 3.182403564453125
[rfa agg] iter: 9, weight: tensor([0.1912, 0.0309, 0.0345, 0.0899, 0.0116, 0.0371, 0.3519, 0.0626, 0.1003,
        0.0901])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3601, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.1486, Accuracy: 0/9950 (0.0000%)
saving model
Done in 287.6885464191437 sec.
Server Epoch:29 choose agents : [20, 12, 59, 54, 88, 96, 63, 66, 61, 58].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  29, local model 20, internal_epoch   1, Avg loss: 0.0588, Accuracy: 307/807 (38.0421%)
_Train Local_ResNet_18, epoch  29, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 410/807 (50.8055%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.1997, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   1, Avg loss: 0.0841, Accuracy: 40/338 (11.8343%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   2, Avg loss: 0.0464, Accuracy: 140/338 (41.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.3366, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   1, Avg loss: 0.0511, Accuracy: 333/1089 (30.5785%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   2, Avg loss: 0.0274, Accuracy: 477/1089 (43.8017%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.4381, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0545, Accuracy: 356/1130 (31.5044%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 466/1130 (41.2389%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.8358, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.0709, Accuracy: 150/603 (24.8756%)
_Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0432, Accuracy: 290/603 (48.0929%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.1779, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 41/311 (13.1833%)
_Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0523, Accuracy: 137/311 (44.0514%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.9608, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0479, Accuracy: 308/888 (34.6847%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0241, Accuracy: 481/888 (54.1667%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.3556, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   1, Avg loss: 0.0598, Accuracy: 279/1402 (19.9001%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   2, Avg loss: 0.0374, Accuracy: 433/1402 (30.8845%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.6772, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  29, local model 61, internal_epoch   1, Avg loss: 0.1258, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 61, internal_epoch   2, Avg loss: 0.1190, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3662, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0583, Accuracy: 329/803 (40.9714%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 398/803 (49.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.7743, Accuracy: 65/10000 (0.6500%)
time spent on training: 161.35782504081726
[rfa agg] training data poison_ratio: 0.10823497854077253  data num: [807, 338, 1089, 1130, 603, 311, 888, 1402, 85, 803]
[rfa agg] considering poison per batch poison_fraction: 0.033823430793991416
[rfa agg] init. name: [20, 12, 59, 54, 88, 96, 63, 66, 61, 58], weight: tensor([0.1082, 0.0453, 0.1461, 0.1516, 0.0809, 0.0417, 0.1191, 0.1880, 0.0114,
        0.1077])
[rfa agg] iter:  0, prev_obj_val: 40.55498123168945, obj_val: 42.562198638916016, abs dis: 2.0072174072265625
[rfa agg] iter: 0, weight: tensor([0.2408, 0.0123, 0.0543, 0.0570, 0.0505, 0.0099, 0.1862, 0.0396, 0.0020,
        0.3474])
[rfa agg] iter:  1, prev_obj_val: 42.562198638916016, obj_val: 47.90553665161133, abs dis: 5.3433380126953125
[rfa agg] iter: 1, weight: tensor([0.2586, 0.0148, 0.0552, 0.0580, 0.0673, 0.0118, 0.1543, 0.0419, 0.0023,
        0.3358])
[rfa agg] iter:  2, prev_obj_val: 47.90553665161133, obj_val: 47.89298629760742, abs dis: 0.01255035400390625
[rfa agg] iter: 2, weight: tensor([0.2106, 0.0265, 0.0715, 0.0749, 0.1642, 0.0207, 0.1485, 0.0577, 0.0039,
        0.2215])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3632, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.1588, Accuracy: 0/9950 (0.0000%)
saving model
Done in 261.2508988380432 sec.
Server Epoch:30 choose agents : [70, 49, 92, 67, 44, 24, 1, 14, 90, 0].
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   1, Avg loss: 0.0542, Accuracy: 438/1418 (30.8886%)
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   2, Avg loss: 0.0300, Accuracy: 668/1418 (47.1086%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.3595, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   1, Avg loss: 0.0772, Accuracy: 58/440 (13.1818%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   2, Avg loss: 0.0466, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.3642, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 472/1715 (27.5219%)
_Train Local_ResNet_18, epoch  30, local model 92, internal_epoch   2, Avg loss: 0.0299, Accuracy: 772/1715 (45.0146%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.2920, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   1, Avg loss: 0.0770, Accuracy: 70/426 (16.4319%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   2, Avg loss: 0.0406, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.7231, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   1, Avg loss: 0.0570, Accuracy: 406/1750 (23.2000%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   2, Avg loss: 0.0344, Accuracy: 715/1750 (40.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.9264, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   1, Avg loss: 0.0793, Accuracy: 28/312 (8.9744%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   2, Avg loss: 0.0423, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.3938, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0561, Accuracy: 290/928 (31.2500%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0231, Accuracy: 586/928 (63.1466%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.1241, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   1, Avg loss: 0.0580, Accuracy: 240/1013 (23.6920%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   2, Avg loss: 0.0333, Accuracy: 349/1013 (34.4521%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8901, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 310/677 (45.7903%)
_Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 449/677 (66.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.4741, Accuracy: 67/10000 (0.6700%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0575, Accuracy: 373/1657 (22.5106%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0338, Accuracy: 551/1657 (33.2529%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.9749, Accuracy: 78/10000 (0.7800%)
time spent on training: 192.00950264930725
[rfa agg] training data poison_ratio: 0.16031346749226005  data num: [1418, 440, 1715, 426, 1750, 312, 928, 1013, 677, 1657]
[rfa agg] considering poison per batch poison_fraction: 0.05009795859133127
[rfa agg] init. name: [70, 49, 92, 67, 44, 24, 1, 14, 90, 0], weight: tensor([0.1372, 0.0426, 0.1659, 0.0412, 0.1693, 0.0302, 0.0898, 0.0980, 0.0655,
        0.1603])
[rfa agg] iter:  0, prev_obj_val: 65.53299713134766, obj_val: 65.5153579711914, abs dis: 0.01763916015625
[rfa agg] iter: 0, weight: tensor([0.1761, 0.0219, 0.1150, 0.0212, 0.1051, 0.0132, 0.1477, 0.2223, 0.0516,
        0.1258])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3623, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.1697, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.5233962535858 sec.
Server Epoch:31 choose agents : [70, 30, 32, 95, 1, 61, 22, 99, 68, 97].
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   1, Avg loss: 0.0536, Accuracy: 431/1418 (30.3949%)
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   2, Avg loss: 0.0293, Accuracy: 693/1418 (48.8717%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.2699, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0790, Accuracy: 70/486 (14.4033%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0381, Accuracy: 217/486 (44.6502%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5812, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0567, Accuracy: 208/735 (28.2993%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0210, Accuracy: 366/735 (49.7959%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.3205, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.0494, Accuracy: 347/599 (57.9299%)
_Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0277, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.3335, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0543, Accuracy: 303/928 (32.6509%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0218, Accuracy: 613/928 (66.0560%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.0728, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   1, Avg loss: 0.1274, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   2, Avg loss: 0.1173, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3703, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   1, Avg loss: 0.0445, Accuracy: 590/1470 (40.1361%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 879/1470 (59.7959%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.4813, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  31, local model 99, internal_epoch   1, Avg loss: 0.0604, Accuracy: 247/773 (31.9534%)
_Train Local_ResNet_18, epoch  31, local model 99, internal_epoch   2, Avg loss: 0.0289, Accuracy: 419/773 (54.2044%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.5723, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  31, local model 68, internal_epoch   1, Avg loss: 0.0619, Accuracy: 360/1163 (30.9544%)
_Train Local_ResNet_18, epoch  31, local model 68, internal_epoch   2, Avg loss: 0.0355, Accuracy: 472/1163 (40.5847%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.6730, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 344/1213 (28.3594%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 505/1213 (41.6323%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.1621, Accuracy: 97/10000 (0.9700%)
time spent on training: 162.68189358711243
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 486, 735, 599, 928, 85, 1470, 773, 1163, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 30, 32, 95, 1, 61, 22, 99, 68, 97], weight: tensor([0.1599, 0.0548, 0.0829, 0.0675, 0.1046, 0.0096, 0.1657, 0.0871, 0.1311,
        0.1368])
[rfa agg] iter:  0, prev_obj_val: 45.587581634521484, obj_val: 52.534034729003906, abs dis: 6.946453094482422
[rfa agg] iter: 0, weight: tensor([0.0616, 0.0242, 0.0839, 0.0416, 0.3928, 0.0023, 0.0638, 0.1269, 0.0997,
        0.1032])
[rfa agg] iter:  1, prev_obj_val: 52.534034729003906, obj_val: 54.73741912841797, abs dis: 2.2033843994140625
[rfa agg] iter: 1, weight: tensor([0.0462, 0.0317, 0.2025, 0.0640, 0.1465, 0.0025, 0.0479, 0.3302, 0.0629,
        0.0654])
[rfa agg] iter:  2, prev_obj_val: 54.73741912841797, obj_val: 54.72871017456055, abs dis: 0.008708953857421875
[rfa agg] iter: 2, weight: tensor([0.0399, 0.0319, 0.2938, 0.0690, 0.1050, 0.0024, 0.0414, 0.3092, 0.0527,
        0.0547])
[rfa agg] iter:  3, prev_obj_val: 54.72871017456055, obj_val: 60.41157150268555, abs dis: 5.682861328125
[rfa agg] iter: 3, weight: tensor([0.0394, 0.0315, 0.3085, 0.0682, 0.1033, 0.0024, 0.0409, 0.2997, 0.0521,
        0.0541])
[rfa agg] iter:  4, prev_obj_val: 60.41157150268555, obj_val: 60.391326904296875, abs dis: 0.020244598388671875
[rfa agg] iter: 4, weight: tensor([0.0426, 0.0477, 0.3689, 0.1282, 0.0895, 0.0031, 0.0442, 0.1669, 0.0535,
        0.0556])
[rfa agg] iter:  5, prev_obj_val: 60.391326904296875, obj_val: 63.61384201049805, abs dis: 3.222515106201172
[rfa agg] iter: 5, weight: tensor([0.0416, 0.0466, 0.3859, 0.1267, 0.0875, 0.0030, 0.0431, 0.1589, 0.0522,
        0.0543])
[rfa agg] iter:  6, prev_obj_val: 63.61384201049805, obj_val: 57.382606506347656, abs dis: 6.231235504150391
[rfa agg] iter: 6, weight: tensor([0.0471, 0.0640, 0.2732, 0.2084, 0.0908, 0.0038, 0.0488, 0.1461, 0.0578,
        0.0601])
[rfa agg] iter:  7, prev_obj_val: 57.382606506347656, obj_val: 66.93684387207031, abs dis: 9.554237365722656
[rfa agg] iter: 7, weight: tensor([0.0363, 0.0341, 0.4485, 0.0821, 0.0843, 0.0024, 0.0376, 0.1797, 0.0466,
        0.0485])
[rfa agg] iter:  8, prev_obj_val: 66.93684387207031, obj_val: 57.42243957519531, abs dis: 9.514404296875
[rfa agg] iter: 8, weight: tensor([0.0461, 0.0778, 0.1944, 0.3119, 0.0827, 0.0041, 0.0478, 0.1217, 0.0556,
        0.0578])
[rfa agg] iter:  9, prev_obj_val: 57.42243957519531, obj_val: 66.93180847167969, abs dis: 9.509368896484375
[rfa agg] iter: 9, weight: tensor([0.0380, 0.0357, 0.4237, 0.0866, 0.0883, 0.0025, 0.0394, 0.1863, 0.0488,
        0.0508])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3628, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 4.8845, Accuracy: 11/9950 (0.1106%)
saving model
Done in 266.9721796512604 sec.
Server Epoch:32 choose agents : [31, 27, 46, 19, 20, 85, 9, 91, 81, 59].
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   1, Avg loss: 0.0811, Accuracy: 77/460 (16.7391%)
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   2, Avg loss: 0.0388, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.7110, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   1, Avg loss: 0.0546, Accuracy: 421/1587 (26.5280%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   2, Avg loss: 0.0331, Accuracy: 624/1587 (39.3195%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.2746, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0543, Accuracy: 439/1904 (23.0567%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0304, Accuracy: 719/1904 (37.7626%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.6979, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0491, Accuracy: 384/1036 (37.0656%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 693/1036 (66.8919%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 12.3069, Accuracy: 66/10000 (0.6600%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   1, Avg loss: 0.0580, Accuracy: 315/807 (39.0335%)
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   2, Avg loss: 0.0315, Accuracy: 412/807 (51.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.4857, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0530, Accuracy: 497/1988 (25.0000%)
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0348, Accuracy: 680/1988 (34.2052%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.2430, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   1, Avg loss: 0.0482, Accuracy: 365/1275 (28.6275%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   2, Avg loss: 0.0181, Accuracy: 777/1275 (60.9412%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 11.1597, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  32, local model 91, internal_epoch   1, Avg loss: 0.0495, Accuracy: 407/1030 (39.5146%)
_Train Local_ResNet_18, epoch  32, local model 91, internal_epoch   2, Avg loss: 0.0232, Accuracy: 664/1030 (64.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.7442, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  32, local model 81, internal_epoch   1, Avg loss: 0.0629, Accuracy: 258/774 (33.3333%)
_Train Local_ResNet_18, epoch  32, local model 81, internal_epoch   2, Avg loss: 0.0349, Accuracy: 285/774 (36.8217%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.5920, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  32, local model 59, internal_epoch   1, Avg loss: 0.0518, Accuracy: 334/1089 (30.6703%)
_Train Local_ResNet_18, epoch  32, local model 59, internal_epoch   2, Avg loss: 0.0262, Accuracy: 521/1089 (47.8421%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 10.7828, Accuracy: 72/10000 (0.7200%)
time spent on training: 200.56385469436646
[rfa agg] training data poison_ratio: 0.06753138075313808  data num: [460, 1587, 1904, 1036, 807, 1988, 1275, 1030, 774, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.02110355648535565
[rfa agg] init. name: [31, 27, 46, 19, 20, 85, 9, 91, 81, 59], weight: tensor([0.0385, 0.1328, 0.1593, 0.0867, 0.0675, 0.1664, 0.1067, 0.0862, 0.0648,
        0.0911])
[rfa agg] iter:  0, prev_obj_val: 59.11874771118164, obj_val: 68.84194946289062, abs dis: 9.723201751708984
[rfa agg] iter: 0, weight: tensor([0.0116, 0.0731, 0.0481, 0.1314, 0.0371, 0.0425, 0.2718, 0.1270, 0.0357,
        0.2217])
[rfa agg] iter:  1, prev_obj_val: 68.84194946289062, obj_val: 71.57929229736328, abs dis: 2.7373428344726562
[rfa agg] iter: 1, weight: tensor([0.0172, 0.0526, 0.0406, 0.2348, 0.0772, 0.0371, 0.0941, 0.2207, 0.0749,
        0.1507])
[rfa agg] iter:  2, prev_obj_val: 71.57929229736328, obj_val: 74.443603515625, abs dis: 2.8643112182617188
[rfa agg] iter: 2, weight: tensor([0.0205, 0.0558, 0.0440, 0.2069, 0.1023, 0.0404, 0.0936, 0.1992, 0.0996,
        0.1378])
[rfa agg] iter:  3, prev_obj_val: 74.443603515625, obj_val: 77.35433959960938, abs dis: 2.910736083984375
[rfa agg] iter: 3, weight: tensor([0.0238, 0.0574, 0.0459, 0.1751, 0.1350, 0.0424, 0.0913, 0.1707, 0.1322,
        0.1262])
[rfa agg] iter:  4, prev_obj_val: 77.35433959960938, obj_val: 80.31330108642578, abs dis: 2.9589614868164062
[rfa agg] iter: 4, weight: tensor([0.0260, 0.0555, 0.0452, 0.1454, 0.1748, 0.0418, 0.0846, 0.1426, 0.1730,
        0.1111])
[rfa agg] iter:  5, prev_obj_val: 80.31330108642578, obj_val: 83.3573226928711, abs dis: 3.0440216064453125
[rfa agg] iter: 5, weight: tensor([0.0265, 0.0500, 0.0413, 0.1156, 0.2232, 0.0383, 0.0732, 0.1139, 0.2257,
        0.0922])
[rfa agg] iter:  6, prev_obj_val: 83.3573226928711, obj_val: 80.3137435913086, abs dis: 3.0435791015625
[rfa agg] iter: 6, weight: tensor([0.0248, 0.0410, 0.0343, 0.0856, 0.2759, 0.0320, 0.0580, 0.0845, 0.2931,
        0.0706])
[rfa agg] iter:  7, prev_obj_val: 80.3137435913086, obj_val: 83.35578155517578, abs dis: 3.0420379638671875
[rfa agg] iter: 7, weight: tensor([0.0261, 0.0492, 0.0406, 0.1129, 0.2294, 0.0377, 0.0720, 0.1113, 0.2305,
        0.0904])
[rfa agg] iter:  8, prev_obj_val: 83.35578155517578, obj_val: 80.31385803222656, abs dis: 3.0419235229492188
[rfa agg] iter: 8, weight: tensor([0.0247, 0.0409, 0.0342, 0.0854, 0.2768, 0.0319, 0.0579, 0.0843, 0.2933,
        0.0705])
[rfa agg] iter:  9, prev_obj_val: 80.31385803222656, obj_val: 83.35577392578125, abs dis: 3.0419158935546875
[rfa agg] iter: 9, weight: tensor([0.0261, 0.0492, 0.0406, 0.1129, 0.2294, 0.0377, 0.0720, 0.1112, 0.2304,
        0.0904])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3638, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 4.8922, Accuracy: 12/9950 (0.1206%)
saving model
Done in 301.2737011909485 sec.
Server Epoch:33 choose agents : [49, 13, 80, 70, 48, 78, 56, 37, 83, 46].
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   1, Avg loss: 0.0768, Accuracy: 65/440 (14.7727%)
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   2, Avg loss: 0.0465, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.5833, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   1, Avg loss: 0.0544, Accuracy: 358/1645 (21.7629%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   2, Avg loss: 0.0309, Accuracy: 686/1645 (41.7021%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.4054, Accuracy: 138/10000 (1.3800%)
_Train Local_ResNet_18, epoch  33, local model 80, internal_epoch   1, Avg loss: 0.0624, Accuracy: 192/682 (28.1525%)
_Train Local_ResNet_18, epoch  33, local model 80, internal_epoch   2, Avg loss: 0.0364, Accuracy: 267/682 (39.1496%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.7691, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0539, Accuracy: 446/1418 (31.4528%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0291, Accuracy: 699/1418 (49.2948%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.3238, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   1, Avg loss: 0.0726, Accuracy: 113/631 (17.9081%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 239/631 (37.8764%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.0904, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  33, local model 78, internal_epoch   1, Avg loss: 0.0816, Accuracy: 66/416 (15.8654%)
_Train Local_ResNet_18, epoch  33, local model 78, internal_epoch   2, Avg loss: 0.0436, Accuracy: 223/416 (53.6058%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.8128, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  33, local model 56, internal_epoch   1, Avg loss: 0.0849, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  33, local model 56, internal_epoch   2, Avg loss: 0.0691, Accuracy: 70/186 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.4246, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 37, internal_epoch   1, Avg loss: 0.0498, Accuracy: 483/1129 (42.7812%)
_Train Local_ResNet_18, epoch  33, local model 37, internal_epoch   2, Avg loss: 0.0228, Accuracy: 761/1129 (67.4048%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.2817, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  33, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 445/1953 (22.7855%)
_Train Local_ResNet_18, epoch  33, local model 83, internal_epoch   2, Avg loss: 0.0331, Accuracy: 800/1953 (40.9626%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.0793, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  33, local model 46, internal_epoch   1, Avg loss: 0.0547, Accuracy: 403/1904 (21.1660%)
_Train Local_ResNet_18, epoch  33, local model 46, internal_epoch   2, Avg loss: 0.0305, Accuracy: 711/1904 (37.3424%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.4527, Accuracy: 120/10000 (1.2000%)
time spent on training: 177.67632722854614
[rfa agg] training data poison_ratio: 0.0  data num: [440, 1645, 682, 1418, 631, 416, 186, 1129, 1953, 1904]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [49, 13, 80, 70, 48, 78, 56, 37, 83, 46], weight: tensor([0.0423, 0.1581, 0.0656, 0.1363, 0.0606, 0.0400, 0.0179, 0.1085, 0.1877,
        0.1830])
[rfa agg] iter:  0, prev_obj_val: 72.54646301269531, obj_val: 72.48884582519531, abs dis: 0.0576171875
[rfa agg] iter: 0, weight: tensor([0.0186, 0.1496, 0.0416, 0.2488, 0.0347, 0.0176, 0.0060, 0.2812, 0.0975,
        0.1044])
[rfa agg] iter:  1, prev_obj_val: 72.48884582519531, obj_val: 73.97525787353516, abs dis: 1.4864120483398438
[rfa agg] iter: 1, weight: tensor([0.0184, 0.1476, 0.0411, 0.2487, 0.0342, 0.0174, 0.0059, 0.2875, 0.0962,
        0.1030])
[rfa agg] iter:  2, prev_obj_val: 73.97525787353516, obj_val: 77.06664276123047, abs dis: 3.0913848876953125
[rfa agg] iter: 2, weight: tensor([0.0185, 0.1323, 0.0421, 0.2085, 0.0349, 0.0175, 0.0059, 0.3557, 0.0892,
        0.0951])
[rfa agg] iter:  3, prev_obj_val: 77.06664276123047, obj_val: 80.89616394042969, abs dis: 3.8295211791992188
[rfa agg] iter: 3, weight: tensor([0.0156, 0.0890, 0.0370, 0.1267, 0.0302, 0.0148, 0.0049, 0.5509, 0.0636,
        0.0674])
[rfa agg] iter:  4, prev_obj_val: 80.89616394042969, obj_val: 80.8890380859375, abs dis: 0.0071258544921875
[rfa agg] iter: 4, weight: tensor([0.0156, 0.0720, 0.0389, 0.0951, 0.0313, 0.0148, 0.0048, 0.6168, 0.0540,
        0.0568])
[rfa agg] iter:  5, prev_obj_val: 80.8890380859375, obj_val: 80.88863372802734, abs dis: 0.00040435791015625
[rfa agg] iter: 5, weight: tensor([0.0150, 0.0690, 0.0373, 0.0910, 0.0300, 0.0142, 0.0046, 0.6328, 0.0517,
        0.0544])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3614, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 4.9019, Accuracy: 16/9950 (0.1608%)
saving model
Done in 276.3678593635559 sec.
Server Epoch:34 choose agents : [60, 55, 12, 50, 72, 14, 25, 49, 31, 77].
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 667/2227 (29.9506%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0272, Accuracy: 1059/2227 (47.5528%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.4837, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0518, Accuracy: 339/1071 (31.6527%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0277, Accuracy: 536/1071 (50.0467%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.9715, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   1, Avg loss: 0.0842, Accuracy: 20/338 (5.9172%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   2, Avg loss: 0.0472, Accuracy: 154/338 (45.5621%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.3800, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   1, Avg loss: 0.0612, Accuracy: 190/809 (23.4858%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   2, Avg loss: 0.0260, Accuracy: 355/809 (43.8813%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.3032, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   1, Avg loss: 0.0589, Accuracy: 307/1241 (24.7381%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   2, Avg loss: 0.0357, Accuracy: 461/1241 (37.1475%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.8408, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0563, Accuracy: 268/1013 (26.4561%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0332, Accuracy: 383/1013 (37.8085%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.0206, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  34, local model 25, internal_epoch   1, Avg loss: 0.0546, Accuracy: 303/690 (43.9130%)
_Train Local_ResNet_18, epoch  34, local model 25, internal_epoch   2, Avg loss: 0.0257, Accuracy: 468/690 (67.8261%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.1542, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0763, Accuracy: 65/440 (14.7727%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0464, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.4286, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 31, internal_epoch   1, Avg loss: 0.0819, Accuracy: 64/460 (13.9130%)
_Train Local_ResNet_18, epoch  34, local model 31, internal_epoch   2, Avg loss: 0.0377, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3110, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  34, local model 77, internal_epoch   1, Avg loss: 0.0493, Accuracy: 362/1340 (27.0149%)
_Train Local_ResNet_18, epoch  34, local model 77, internal_epoch   2, Avg loss: 0.0257, Accuracy: 588/1340 (43.8806%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.1733, Accuracy: 94/10000 (0.9400%)
time spent on training: 179.7023937702179
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 1071, 338, 809, 1241, 1013, 690, 440, 460, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 55, 12, 50, 72, 14, 25, 49, 31, 77], weight: tensor([0.2313, 0.1112, 0.0351, 0.0840, 0.1289, 0.1052, 0.0717, 0.0457, 0.0478,
        0.1392])
[rfa agg] iter:  0, prev_obj_val: 65.80661010742188, obj_val: 67.9979476928711, abs dis: 2.1913375854492188
[rfa agg] iter: 0, weight: tensor([0.0405, 0.3695, 0.0094, 0.0568, 0.1515, 0.1906, 0.0337, 0.0133, 0.0154,
        0.1192])
[rfa agg] iter:  1, prev_obj_val: 67.9979476928711, obj_val: 73.17890167236328, abs dis: 5.1809539794921875
[rfa agg] iter: 1, weight: tensor([0.0331, 0.2642, 0.0095, 0.0742, 0.0861, 0.3895, 0.0387, 0.0138, 0.0162,
        0.0747])
[rfa agg] iter:  2, prev_obj_val: 73.17890167236328, obj_val: 75.06428527832031, abs dis: 1.8853836059570312
[rfa agg] iter: 2, weight: tensor([0.0445, 0.1697, 0.0163, 0.2008, 0.0916, 0.2605, 0.0796, 0.0240, 0.0290,
        0.0840])
[rfa agg] iter:  3, prev_obj_val: 75.06428527832031, obj_val: 75.05650329589844, abs dis: 0.007781982421875
[rfa agg] iter: 3, weight: tensor([0.0434, 0.1421, 0.0173, 0.2884, 0.0839, 0.1976, 0.0925, 0.0257, 0.0313,
        0.0779])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3614, Accuracy: 65/10000 (0.6500%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 4.9104, Accuracy: 16/9950 (0.1608%)
saving model
Done in 280.61048674583435 sec.
Server Epoch:35 choose agents : [56, 59, 12, 2, 67, 49, 72, 34, 13, 42].
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   1, Avg loss: 0.0845, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   2, Avg loss: 0.0686, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.4160, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0560, Accuracy: 352/1089 (32.3232%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0270, Accuracy: 532/1089 (48.8522%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.9507, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0845, Accuracy: 33/338 (9.7633%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0453, Accuracy: 137/338 (40.5325%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.4402, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   1, Avg loss: 0.0634, Accuracy: 231/605 (38.1818%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   2, Avg loss: 0.0394, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.0777, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0757, Accuracy: 86/426 (20.1878%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0409, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.7843, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   1, Avg loss: 0.0764, Accuracy: 69/440 (15.6818%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   2, Avg loss: 0.0460, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.5268, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 72, internal_epoch   1, Avg loss: 0.0588, Accuracy: 289/1241 (23.2877%)
_Train Local_ResNet_18, epoch  35, local model 72, internal_epoch   2, Avg loss: 0.0352, Accuracy: 487/1241 (39.2425%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.8042, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  35, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 394/1427 (27.6104%)
_Train Local_ResNet_18, epoch  35, local model 34, internal_epoch   2, Avg loss: 0.0325, Accuracy: 611/1427 (42.8171%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.6198, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  35, local model 13, internal_epoch   1, Avg loss: 0.0541, Accuracy: 375/1645 (22.7964%)
_Train Local_ResNet_18, epoch  35, local model 13, internal_epoch   2, Avg loss: 0.0311, Accuracy: 686/1645 (41.7021%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.6500, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  35, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 338/1372 (24.6356%)
_Train Local_ResNet_18, epoch  35, local model 42, internal_epoch   2, Avg loss: 0.0307, Accuracy: 544/1372 (39.6501%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.7220, Accuracy: 96/10000 (0.9600%)
time spent on training: 184.87339043617249
[rfa agg] training data poison_ratio: 0.0  data num: [186, 1089, 338, 605, 426, 440, 1241, 1427, 1645, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [56, 59, 12, 2, 67, 49, 72, 34, 13, 42], weight: tensor([0.0212, 0.1242, 0.0385, 0.0690, 0.0486, 0.0502, 0.1415, 0.1627, 0.1876,
        0.1565])
[rfa agg] iter:  0, prev_obj_val: 61.03688049316406, obj_val: 56.3984375, abs dis: 4.6384429931640625
[rfa agg] iter: 0, weight: tensor([0.0090, 0.2867, 0.0211, 0.0627, 0.0296, 0.0305, 0.1895, 0.1267, 0.1025,
        0.1416])
[rfa agg] iter:  1, prev_obj_val: 56.3984375, obj_val: 56.381771087646484, abs dis: 0.016666412353515625
[rfa agg] iter: 1, weight: tensor([0.0065, 0.3663, 0.0150, 0.0419, 0.0207, 0.0214, 0.1933, 0.1149, 0.0886,
        0.1315])
[rfa agg] iter:  2, prev_obj_val: 56.381771087646484, obj_val: 56.38124084472656, abs dis: 0.000530242919921875
[rfa agg] iter: 2, weight: tensor([0.0064, 0.3800, 0.0147, 0.0411, 0.0203, 0.0210, 0.1886, 0.1125, 0.0868,
        0.1286])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3615, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 4.9260, Accuracy: 21/9950 (0.2111%)
saving model
Done in 281.5997085571289 sec.
Server Epoch:36 choose agents : [7, 12, 61, 44, 77, 43, 52, 34, 92, 71].
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0521, Accuracy: 368/891 (41.3019%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0252, Accuracy: 464/891 (52.0763%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.8548, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   1, Avg loss: 0.0842, Accuracy: 37/338 (10.9467%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   2, Avg loss: 0.0466, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.5893, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   1, Avg loss: 0.1263, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   2, Avg loss: 0.1186, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3657, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   1, Avg loss: 0.0572, Accuracy: 409/1750 (23.3714%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   2, Avg loss: 0.0337, Accuracy: 725/1750 (41.4286%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.4850, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   1, Avg loss: 0.0481, Accuracy: 360/1340 (26.8657%)
_Train Local_ResNet_18, epoch  36, local model 77, internal_epoch   2, Avg loss: 0.0259, Accuracy: 594/1340 (44.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.4451, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0602, Accuracy: 301/946 (31.8182%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0347, Accuracy: 331/946 (34.9894%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.4591, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   1, Avg loss: 0.0548, Accuracy: 312/636 (49.0566%)
_Train Local_ResNet_18, epoch  36, local model 52, internal_epoch   2, Avg loss: 0.0295, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.1068, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 376/1427 (26.3490%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   2, Avg loss: 0.0326, Accuracy: 623/1427 (43.6580%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9386, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  36, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 494/1715 (28.8047%)
_Train Local_ResNet_18, epoch  36, local model 92, internal_epoch   2, Avg loss: 0.0293, Accuracy: 771/1715 (44.9563%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.0514, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   1, Avg loss: 0.0545, Accuracy: 242/818 (29.5844%)
_Train Local_ResNet_18, epoch  36, local model 71, internal_epoch   2, Avg loss: 0.0274, Accuracy: 420/818 (51.3447%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.6637, Accuracy: 98/10000 (0.9800%)
time spent on training: 195.9973921775818
[rfa agg] training data poison_ratio: 0.0  data num: [891, 338, 85, 1750, 1340, 946, 636, 1427, 1715, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 12, 61, 44, 77, 43, 52, 34, 92, 71], weight: tensor([0.0896, 0.0340, 0.0085, 0.1760, 0.1347, 0.0951, 0.0639, 0.1435, 0.1724,
        0.0822])
[rfa agg] iter:  0, prev_obj_val: 59.00785827636719, obj_val: 61.27350616455078, abs dis: 2.2656478881835938
[rfa agg] iter: 0, weight: tensor([0.1161, 0.0150, 0.0028, 0.0928, 0.2318, 0.1621, 0.0422, 0.1500, 0.1009,
        0.0863])
[rfa agg] iter:  1, prev_obj_val: 61.27350616455078, obj_val: 63.625267028808594, abs dis: 2.3517608642578125
[rfa agg] iter: 1, weight: tensor([0.1467, 0.0157, 0.0029, 0.0810, 0.1693, 0.2277, 0.0462, 0.1205, 0.0872,
        0.1030])
[rfa agg] iter:  2, prev_obj_val: 63.625267028808594, obj_val: 70.3730239868164, abs dis: 6.7477569580078125
[rfa agg] iter: 2, weight: tensor([0.1745, 0.0141, 0.0025, 0.0608, 0.1111, 0.3320, 0.0440, 0.0847, 0.0649,
        0.1113])
[rfa agg] iter:  3, prev_obj_val: 70.3730239868164, obj_val: 79.00883483886719, abs dis: 8.635810852050781
[rfa agg] iter: 3, weight: tensor([0.3484, 0.0119, 0.0020, 0.0350, 0.0535, 0.2322, 0.0440, 0.0444, 0.0370,
        0.1916])
[rfa agg] iter:  4, prev_obj_val: 79.00883483886719, obj_val: 75.7150650024414, abs dis: 3.2937698364257812
[rfa agg] iter: 4, weight: tensor([0.2008, 0.0187, 0.0029, 0.0407, 0.0566, 0.1320, 0.0886, 0.0489, 0.0426,
        0.3682])
[rfa agg] iter:  5, prev_obj_val: 75.7150650024414, obj_val: 78.95512390136719, abs dis: 3.2400588989257812
[rfa agg] iter: 5, weight: tensor([0.1938, 0.0128, 0.0020, 0.0308, 0.0441, 0.1174, 0.0550, 0.0376, 0.0323,
        0.4740])
[rfa agg] iter:  6, prev_obj_val: 78.95512390136719, obj_val: 72.88420104980469, abs dis: 6.0709228515625
[rfa agg] iter: 6, weight: tensor([0.1774, 0.0172, 0.0027, 0.0374, 0.0520, 0.1199, 0.0816, 0.0449, 0.0391,
        0.4278])
[rfa agg] iter:  7, prev_obj_val: 72.88420104980469, obj_val: 78.96505737304688, abs dis: 6.0808563232421875
[rfa agg] iter: 7, weight: tensor([0.2781, 0.0124, 0.0020, 0.0331, 0.0488, 0.1544, 0.0491, 0.0411, 0.0348,
        0.3464])
[rfa agg] iter:  8, prev_obj_val: 78.96505737304688, obj_val: 72.8788070678711, abs dis: 6.086250305175781
[rfa agg] iter: 8, weight: tensor([0.1888, 0.0179, 0.0028, 0.0389, 0.0541, 0.1254, 0.0849, 0.0467, 0.0407,
        0.3998])
[rfa agg] iter:  9, prev_obj_val: 72.8788070678711, obj_val: 82.38566589355469, abs dis: 9.506858825683594
[rfa agg] iter: 9, weight: tensor([0.2827, 0.0124, 0.0020, 0.0332, 0.0489, 0.1552, 0.0493, 0.0412, 0.0349,
        0.3403])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3643, Accuracy: 67/10000 (0.6700%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 4.9510, Accuracy: 5/9950 (0.0503%)
saving model
Done in 298.0851573944092 sec.
Server Epoch:37 choose agents : [11, 33, 59, 95, 52, 25, 78, 26, 47, 1].
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   1, Avg loss: 0.0522, Accuracy: 322/712 (45.2247%)
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   2, Avg loss: 0.0257, Accuracy: 440/712 (61.7978%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.0247, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   1, Avg loss: 0.0762, Accuracy: 100/515 (19.4175%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   2, Avg loss: 0.0499, Accuracy: 156/515 (30.2913%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.6343, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   1, Avg loss: 0.0482, Accuracy: 358/1089 (32.8742%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   2, Avg loss: 0.0276, Accuracy: 518/1089 (47.5666%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.9707, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  37, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 348/599 (58.0968%)
_Train Local_ResNet_18, epoch  37, local model 95, internal_epoch   2, Avg loss: 0.0277, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.2735, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0531, Accuracy: 303/636 (47.6415%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0281, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.8890, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0538, Accuracy: 311/690 (45.0725%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0250, Accuracy: 464/690 (67.2464%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.7825, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  37, local model 78, internal_epoch   1, Avg loss: 0.0806, Accuracy: 55/416 (13.2212%)
_Train Local_ResNet_18, epoch  37, local model 78, internal_epoch   2, Avg loss: 0.0430, Accuracy: 224/416 (53.8462%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.8433, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  37, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 350/1446 (24.2047%)
_Train Local_ResNet_18, epoch  37, local model 26, internal_epoch   2, Avg loss: 0.0335, Accuracy: 514/1446 (35.5463%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.7558, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   1, Avg loss: 0.1233, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 47, internal_epoch   2, Avg loss: 0.1062, Accuracy: 9/134 (6.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3829, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  37, local model 1, internal_epoch   1, Avg loss: 0.0530, Accuracy: 311/928 (33.5129%)
_Train Local_ResNet_18, epoch  37, local model 1, internal_epoch   2, Avg loss: 0.0219, Accuracy: 613/928 (66.0560%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.4426, Accuracy: 112/10000 (1.1200%)
time spent on training: 170.59303832054138
[rfa agg] training data poison_ratio: 0.0  data num: [712, 515, 1089, 599, 636, 690, 416, 1446, 134, 928]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [11, 33, 59, 95, 52, 25, 78, 26, 47, 1], weight: tensor([0.0994, 0.0719, 0.1520, 0.0836, 0.0888, 0.0963, 0.0581, 0.2018, 0.0187,
        0.1295])
[rfa agg] iter:  0, prev_obj_val: 42.63401794433594, obj_val: 50.28819274902344, abs dis: 7.6541748046875
[rfa agg] iter: 0, weight: tensor([0.3577, 0.0528, 0.0560, 0.0901, 0.0943, 0.1841, 0.0259, 0.0410, 0.0046,
        0.0935])
[rfa agg] iter:  1, prev_obj_val: 50.28819274902344, obj_val: 56.804969787597656, abs dis: 6.516777038574219
[rfa agg] iter: 1, weight: tensor([0.0800, 0.1963, 0.0361, 0.2274, 0.2060, 0.1243, 0.0462, 0.0304, 0.0059,
        0.0475])
[rfa agg] iter:  2, prev_obj_val: 56.804969787597656, obj_val: 60.49475860595703, abs dis: 3.689788818359375
[rfa agg] iter: 2, weight: tensor([0.0754, 0.2884, 0.0428, 0.1444, 0.1485, 0.1011, 0.0995, 0.0374, 0.0091,
        0.0533])
[rfa agg] iter:  3, prev_obj_val: 60.49475860595703, obj_val: 64.25038146972656, abs dis: 3.7556228637695312
[rfa agg] iter: 3, weight: tensor([0.0793, 0.2162, 0.0488, 0.1315, 0.1368, 0.1017, 0.1710, 0.0434, 0.0121,
        0.0593])
[rfa agg] iter:  4, prev_obj_val: 64.25038146972656, obj_val: 64.24370574951172, abs dis: 0.00667572021484375
[rfa agg] iter: 4, weight: tensor([0.0727, 0.1532, 0.0479, 0.1093, 0.1146, 0.0902, 0.2981, 0.0432, 0.0138,
        0.0571])
[rfa agg] iter:  5, prev_obj_val: 64.24370574951172, obj_val: 64.24363708496094, abs dis: 6.866455078125e-05
[rfa agg] iter: 5, weight: tensor([0.0714, 0.1495, 0.0470, 0.1072, 0.1126, 0.0885, 0.3115, 0.0425, 0.0135,
        0.0561])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3655, Accuracy: 64/10000 (0.6400%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 4.9668, Accuracy: 6/9950 (0.0603%)
saving model
Done in 266.4740831851959 sec.
Server Epoch:38 choose agents : [84, 78, 4, 39, 42, 59, 73, 34, 20, 88].
_Train Local_ResNet_18, epoch  38, local model 84, internal_epoch   1, Avg loss: 0.0561, Accuracy: 357/1190 (30.0000%)
_Train Local_ResNet_18, epoch  38, local model 84, internal_epoch   2, Avg loss: 0.0302, Accuracy: 483/1190 (40.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.3819, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  38, local model 78, internal_epoch   1, Avg loss: 0.0777, Accuracy: 73/416 (17.5481%)
_Train Local_ResNet_18, epoch  38, local model 78, internal_epoch   2, Avg loss: 0.0419, Accuracy: 228/416 (54.8077%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.8579, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0611, Accuracy: 331/901 (36.7370%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0317, Accuracy: 364/901 (40.3996%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.2181, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0516, Accuracy: 316/1013 (31.1945%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0254, Accuracy: 519/1013 (51.2340%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.9839, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 340/1372 (24.7813%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 544/1372 (39.6501%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.4307, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   1, Avg loss: 0.0485, Accuracy: 338/1089 (31.0376%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   2, Avg loss: 0.0266, Accuracy: 457/1089 (41.9651%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 10.1407, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   1, Avg loss: 0.0629, Accuracy: 194/938 (20.6823%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   2, Avg loss: 0.0329, Accuracy: 340/938 (36.2473%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.7389, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  38, local model 34, internal_epoch   1, Avg loss: 0.0566, Accuracy: 420/1427 (29.4324%)
_Train Local_ResNet_18, epoch  38, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 592/1427 (41.4856%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.1744, Accuracy: 83/10000 (0.8300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0586, Accuracy: 316/807 (39.1574%)
_Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0300, Accuracy: 432/807 (53.5316%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.0390, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0701, Accuracy: 164/603 (27.1973%)
_Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0426, Accuracy: 277/603 (45.9370%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.5151, Accuracy: 54/10000 (0.5400%)
time spent on training: 198.2878293991089
[rfa agg] training data poison_ratio: 0.08271832718327184  data num: [1190, 416, 901, 1013, 1372, 1089, 938, 1427, 807, 603]
[rfa agg] considering poison per batch poison_fraction: 0.025849477244772448
[rfa agg] init. name: [84, 78, 4, 39, 42, 59, 73, 34, 20, 88], weight: tensor([0.1220, 0.0426, 0.0924, 0.1038, 0.1406, 0.1116, 0.0961, 0.1463, 0.0827,
        0.0618])
[rfa agg] iter:  0, prev_obj_val: 37.02916717529297, obj_val: 44.35588455200195, abs dis: 7.326717376708984
[rfa agg] iter: 0, weight: tensor([0.0618, 0.0110, 0.2409, 0.1636, 0.0414, 0.0731, 0.2657, 0.0377, 0.0793,
        0.0255])
[rfa agg] iter:  1, prev_obj_val: 44.35588455200195, obj_val: 44.30776596069336, abs dis: 0.04811859130859375
[rfa agg] iter: 1, weight: tensor([0.0638, 0.0191, 0.1640, 0.1152, 0.0479, 0.0703, 0.1712, 0.0447, 0.2530,
        0.0508])
[rfa agg] iter:  2, prev_obj_val: 44.30776596069336, obj_val: 50.4593391418457, abs dis: 6.151573181152344
[rfa agg] iter: 2, weight: tensor([0.0617, 0.0184, 0.1562, 0.1107, 0.0463, 0.0680, 0.1638, 0.0432, 0.2825,
        0.0491])
[rfa agg] iter:  3, prev_obj_val: 50.4593391418457, obj_val: 47.22603225708008, abs dis: 3.233306884765625
[rfa agg] iter: 3, weight: tensor([0.0613, 0.0255, 0.1170, 0.0951, 0.0486, 0.0658, 0.1223, 0.0458, 0.3393,
        0.0794])
[rfa agg] iter:  4, prev_obj_val: 47.22603225708008, obj_val: 50.45503234863281, abs dis: 3.2290000915527344
[rfa agg] iter: 4, weight: tensor([0.0553, 0.0195, 0.1187, 0.0914, 0.0428, 0.0601, 0.1244, 0.0401, 0.3921,
        0.0557])
[rfa agg] iter:  5, prev_obj_val: 50.45503234863281, obj_val: 47.22345733642578, abs dis: 3.2315750122070312
[rfa agg] iter: 5, weight: tensor([0.0594, 0.0247, 0.1128, 0.0919, 0.0471, 0.0637, 0.1180, 0.0444, 0.3615,
        0.0767])
[rfa agg] iter:  6, prev_obj_val: 47.22345733642578, obj_val: 50.45563888549805, abs dis: 3.2321815490722656
[rfa agg] iter: 6, weight: tensor([0.0546, 0.0192, 0.1170, 0.0902, 0.0422, 0.0593, 0.1226, 0.0396, 0.4004,
        0.0549])
[rfa agg] iter:  7, prev_obj_val: 50.45563888549805, obj_val: 47.223289489746094, abs dis: 3.232349395751953
[rfa agg] iter: 7, weight: tensor([0.0592, 0.0246, 0.1125, 0.0916, 0.0470, 0.0635, 0.1177, 0.0442, 0.3633,
        0.0765])
[rfa agg] iter:  8, prev_obj_val: 47.223289489746094, obj_val: 50.455692291259766, abs dis: 3.232402801513672
[rfa agg] iter: 8, weight: tensor([0.0545, 0.0192, 0.1169, 0.0901, 0.0422, 0.0592, 0.1225, 0.0395, 0.4011,
        0.0548])
[rfa agg] iter:  9, prev_obj_val: 50.455692291259766, obj_val: 47.2232780456543, abs dis: 3.2324142456054688
[rfa agg] iter: 9, weight: tensor([0.0592, 0.0246, 0.1124, 0.0916, 0.0470, 0.0635, 0.1177, 0.0442, 0.3634,
        0.0764])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3659, Accuracy: 64/10000 (0.6400%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 4.9133, Accuracy: 13/9950 (0.1307%)
saving model
Done in 299.552757024765 sec.
Server Epoch:39 choose agents : [43, 8, 17, 27, 59, 44, 32, 92, 66, 71].
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0600, Accuracy: 302/946 (31.9239%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0334, Accuracy: 351/946 (37.1036%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.1854, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0586, Accuracy: 323/1513 (21.3483%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0351, Accuracy: 530/1513 (35.0297%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.9406, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   1, Avg loss: 0.0504, Accuracy: 447/1574 (28.3990%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   2, Avg loss: 0.0258, Accuracy: 740/1574 (47.0140%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.4816, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0556, Accuracy: 430/1587 (27.0951%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0331, Accuracy: 593/1587 (37.3661%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.9763, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   1, Avg loss: 0.0479, Accuracy: 377/1089 (34.6189%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   2, Avg loss: 0.0267, Accuracy: 483/1089 (44.3526%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 11.9221, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   1, Avg loss: 0.0573, Accuracy: 414/1750 (23.6571%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   2, Avg loss: 0.0340, Accuracy: 729/1750 (41.6571%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.5486, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   1, Avg loss: 0.0530, Accuracy: 234/735 (31.8367%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   2, Avg loss: 0.0212, Accuracy: 366/735 (49.7959%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 11.7197, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  39, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 496/1715 (28.9213%)
_Train Local_ResNet_18, epoch  39, local model 92, internal_epoch   2, Avg loss: 0.0295, Accuracy: 778/1715 (45.3644%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.0174, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  39, local model 66, internal_epoch   1, Avg loss: 0.0601, Accuracy: 263/1402 (18.7589%)
_Train Local_ResNet_18, epoch  39, local model 66, internal_epoch   2, Avg loss: 0.0378, Accuracy: 389/1402 (27.7461%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.8792, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0524, Accuracy: 302/818 (36.9193%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0269, Accuracy: 418/818 (51.1002%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.9218, Accuracy: 83/10000 (0.8300%)
time spent on training: 228.16399836540222
[rfa agg] training data poison_ratio: 0.0  data num: [946, 1513, 1574, 1587, 1089, 1750, 735, 1715, 1402, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 8, 17, 27, 59, 44, 32, 92, 66, 71], weight: tensor([0.0721, 0.1152, 0.1199, 0.1209, 0.0829, 0.1333, 0.0560, 0.1306, 0.1068,
        0.0623])
[rfa agg] iter:  0, prev_obj_val: 47.895687103271484, obj_val: 49.90785598754883, abs dis: 2.0121688842773438
[rfa agg] iter: 0, weight: tensor([0.0627, 0.1239, 0.1042, 0.1051, 0.1591, 0.0729, 0.0307, 0.0814, 0.2210,
        0.0390])
[rfa agg] iter:  1, prev_obj_val: 49.90785598754883, obj_val: 51.97734069824219, abs dis: 2.0694847106933594
[rfa agg] iter: 1, weight: tensor([0.0714, 0.1139, 0.0976, 0.0984, 0.2061, 0.0705, 0.0337, 0.0781, 0.1872,
        0.0431])
[rfa agg] iter:  2, prev_obj_val: 51.97734069824219, obj_val: 56.39451599121094, abs dis: 4.41717529296875
[rfa agg] iter: 2, weight: tensor([0.0792, 0.1016, 0.0886, 0.0893, 0.2659, 0.0659, 0.0356, 0.0725, 0.1553,
        0.0461])
[rfa agg] iter:  3, prev_obj_val: 56.39451599121094, obj_val: 58.864192962646484, abs dis: 2.469676971435547
[rfa agg] iter: 3, weight: tensor([0.0953, 0.0778, 0.0696, 0.0702, 0.3779, 0.0543, 0.0380, 0.0590, 0.1076,
        0.0504])
[rfa agg] iter:  4, prev_obj_val: 58.864192962646484, obj_val: 56.36497116088867, abs dis: 2.4992218017578125
[rfa agg] iter: 4, weight: tensor([0.1137, 0.0727, 0.0658, 0.0663, 0.3776, 0.0524, 0.0418, 0.0566, 0.0968,
        0.0563])
[rfa agg] iter:  5, prev_obj_val: 56.36497116088867, obj_val: 58.86613464355469, abs dis: 2.5011634826660156
[rfa agg] iter: 5, weight: tensor([0.0891, 0.0727, 0.0652, 0.0657, 0.4182, 0.0509, 0.0355, 0.0553, 0.1003,
        0.0471])
[rfa agg] iter:  6, prev_obj_val: 58.86613464355469, obj_val: 58.86400604248047, abs dis: 0.00212860107421875
[rfa agg] iter: 6, weight: tensor([0.1114, 0.0714, 0.0647, 0.0652, 0.3887, 0.0515, 0.0411, 0.0557, 0.0950,
        0.0553])
[rfa agg] iter:  7, prev_obj_val: 58.86400604248047, obj_val: 58.863861083984375, abs dis: 0.00014495849609375
[rfa agg] iter: 7, weight: tensor([0.1132, 0.0723, 0.0655, 0.0660, 0.3805, 0.0521, 0.0416, 0.0564, 0.0963,
        0.0561])
[rfa agg] iter:  8, prev_obj_val: 58.863861083984375, obj_val: 56.36488342285156, abs dis: 2.4989776611328125
[rfa agg] iter: 8, weight: tensor([0.1137, 0.0726, 0.0657, 0.0663, 0.3783, 0.0523, 0.0418, 0.0566, 0.0966,
        0.0563])
[rfa agg] iter:  9, prev_obj_val: 56.36488342285156, obj_val: 58.86616134643555, abs dis: 2.5012779235839844
[rfa agg] iter: 9, weight: tensor([0.0891, 0.0727, 0.0651, 0.0657, 0.4184, 0.0508, 0.0355, 0.0553, 0.1003,
        0.0471])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3643, Accuracy: 62/10000 (0.6200%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 4.9038, Accuracy: 15/9950 (0.1508%)
saving model
Done in 323.9464387893677 sec.
Server Epoch:40 choose agents : [72, 92, 10, 79, 82, 55, 2, 64, 84, 44].
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   1, Avg loss: 0.0581, Accuracy: 298/1241 (24.0129%)
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   2, Avg loss: 0.0356, Accuracy: 440/1241 (35.4553%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.0540, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0515, Accuracy: 449/1715 (26.1808%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0290, Accuracy: 806/1715 (46.9971%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.9818, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   1, Avg loss: 0.0571, Accuracy: 243/861 (28.2230%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   2, Avg loss: 0.0201, Accuracy: 444/861 (51.5679%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 10.4354, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  40, local model 79, internal_epoch   1, Avg loss: 0.1040, Accuracy: 9/197 (4.5685%)
_Train Local_ResNet_18, epoch  40, local model 79, internal_epoch   2, Avg loss: 0.0830, Accuracy: 64/197 (32.4873%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.5201, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 82, internal_epoch   1, Avg loss: 0.0752, Accuracy: 90/500 (18.0000%)
_Train Local_ResNet_18, epoch  40, local model 82, internal_epoch   2, Avg loss: 0.0470, Accuracy: 186/500 (37.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.2401, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   1, Avg loss: 0.0509, Accuracy: 321/1071 (29.9720%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   2, Avg loss: 0.0279, Accuracy: 537/1071 (50.1401%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.3360, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   1, Avg loss: 0.0611, Accuracy: 266/605 (43.9669%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   2, Avg loss: 0.0388, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.6764, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0629, Accuracy: 188/953 (19.7272%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0371, Accuracy: 327/953 (34.3127%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.7834, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0565, Accuracy: 355/1190 (29.8319%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0302, Accuracy: 495/1190 (41.5966%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.9519, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  40, local model 44, internal_epoch   1, Avg loss: 0.0571, Accuracy: 404/1750 (23.0857%)
_Train Local_ResNet_18, epoch  40, local model 44, internal_epoch   2, Avg loss: 0.0336, Accuracy: 742/1750 (42.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8767, Accuracy: 124/10000 (1.2400%)
time spent on training: 197.67397212982178
[rfa agg] training data poison_ratio: 0.0  data num: [1241, 1715, 861, 197, 500, 1071, 605, 953, 1190, 1750]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [72, 92, 10, 79, 82, 55, 2, 64, 84, 44], weight: tensor([0.1231, 0.1701, 0.0854, 0.0195, 0.0496, 0.1062, 0.0600, 0.0945, 0.1180,
        0.1736])
[rfa agg] iter:  0, prev_obj_val: 53.117008209228516, obj_val: 59.847206115722656, abs dis: 6.730197906494141
[rfa agg] iter: 0, weight: tensor([0.1141, 0.0491, 0.0796, 0.0044, 0.0159, 0.3813, 0.0247, 0.1277, 0.1575,
        0.0456])
[rfa agg] iter:  1, prev_obj_val: 59.847206115722656, obj_val: 62.054283142089844, abs dis: 2.2070770263671875
[rfa agg] iter: 1, weight: tensor([0.0719, 0.0419, 0.1958, 0.0053, 0.0210, 0.1519, 0.0353, 0.3516, 0.0858,
        0.0395])
[rfa agg] iter:  2, prev_obj_val: 62.054283142089844, obj_val: 64.72443389892578, abs dis: 2.6701507568359375
[rfa agg] iter: 2, weight: tensor([0.0618, 0.0380, 0.2680, 0.0052, 0.0213, 0.1137, 0.0370, 0.3471, 0.0721,
        0.0359])
[rfa agg] iter:  3, prev_obj_val: 64.72443389892578, obj_val: 64.69365692138672, abs dis: 0.0307769775390625
[rfa agg] iter: 3, weight: tensor([0.0605, 0.0390, 0.3744, 0.0058, 0.0246, 0.1021, 0.0442, 0.2430, 0.0694,
        0.0369])
[rfa agg] iter:  4, prev_obj_val: 64.69365692138672, obj_val: 70.8798828125, abs dis: 6.186225891113281
[rfa agg] iter: 4, weight: tensor([0.0569, 0.0367, 0.4225, 0.0055, 0.0231, 0.0961, 0.0416, 0.2175, 0.0653,
        0.0348])
[rfa agg] iter:  5, prev_obj_val: 70.8798828125, obj_val: 70.86936950683594, abs dis: 0.0105133056640625
[rfa agg] iter: 5, weight: tensor([0.0731, 0.0509, 0.3178, 0.0091, 0.0414, 0.1093, 0.0820, 0.1862, 0.0816,
        0.0485])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3620, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 4.8574, Accuracy: 56/9950 (0.5628%)
saving model
Saving model on epoch 40
Done in 298.40121507644653 sec.
Server Epoch:41 choose agents : [65, 85, 25, 90, 38, 75, 45, 21, 51, 16].
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   1, Avg loss: 0.0521, Accuracy: 425/1475 (28.8136%)
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   2, Avg loss: 0.0294, Accuracy: 686/1475 (46.5085%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.4627, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 485/1988 (24.3964%)
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   2, Avg loss: 0.0344, Accuracy: 730/1988 (36.7203%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.5022, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Avg loss: 0.0537, Accuracy: 304/690 (44.0580%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Avg loss: 0.0246, Accuracy: 471/690 (68.2609%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.4400, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   1, Avg loss: 0.0586, Accuracy: 299/677 (44.1654%)
_Train Local_ResNet_18, epoch  41, local model 90, internal_epoch   2, Avg loss: 0.0224, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.8352, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0575, Accuracy: 303/1131 (26.7905%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0283, Accuracy: 551/1131 (48.7179%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.5529, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  41, local model 75, internal_epoch   1, Avg loss: 0.0584, Accuracy: 281/776 (36.2113%)
_Train Local_ResNet_18, epoch  41, local model 75, internal_epoch   2, Avg loss: 0.0270, Accuracy: 407/776 (52.4485%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.5746, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   1, Avg loss: 0.0656, Accuracy: 215/669 (32.1375%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   2, Avg loss: 0.0377, Accuracy: 360/669 (53.8117%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.5831, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   1, Avg loss: 0.0532, Accuracy: 401/1949 (20.5747%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   2, Avg loss: 0.0323, Accuracy: 634/1949 (32.5295%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.4105, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  41, local model 51, internal_epoch   1, Avg loss: 0.0572, Accuracy: 246/1049 (23.4509%)
_Train Local_ResNet_18, epoch  41, local model 51, internal_epoch   2, Avg loss: 0.0275, Accuracy: 564/1049 (53.7655%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.3567, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  41, local model 16, internal_epoch   1, Avg loss: 0.0625, Accuracy: 286/708 (40.3955%)
_Train Local_ResNet_18, epoch  41, local model 16, internal_epoch   2, Avg loss: 0.0330, Accuracy: 431/708 (60.8757%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.8745, Accuracy: 68/10000 (0.6800%)
time spent on training: 224.11527109146118
[rfa agg] training data poison_ratio: 0.0  data num: [1475, 1988, 690, 677, 1131, 776, 669, 1949, 1049, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [65, 85, 25, 90, 38, 75, 45, 21, 51, 16], weight: tensor([0.1327, 0.1789, 0.0621, 0.0609, 0.1018, 0.0698, 0.0602, 0.1754, 0.0944,
        0.0637])
[rfa agg] iter:  0, prev_obj_val: 69.73020935058594, obj_val: 74.3318099975586, abs dis: 4.601600646972656
[rfa agg] iter: 0, weight: tensor([0.1174, 0.0618, 0.0348, 0.0342, 0.3659, 0.0520, 0.0338, 0.0656, 0.1938,
        0.0408])
[rfa agg] iter:  1, prev_obj_val: 74.3318099975586, obj_val: 74.29916381835938, abs dis: 0.03264617919921875
[rfa agg] iter: 1, weight: tensor([0.0698, 0.0472, 0.0521, 0.0511, 0.2083, 0.0953, 0.0506, 0.0494, 0.3100,
        0.0662])
[rfa agg] iter:  2, prev_obj_val: 74.29916381835938, obj_val: 74.29890441894531, abs dis: 0.0002593994140625
[rfa agg] iter: 2, weight: tensor([0.0686, 0.0465, 0.0513, 0.0503, 0.2011, 0.0940, 0.0498, 0.0486, 0.3246,
        0.0652])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3592, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 4.8632, Accuracy: 52/9950 (0.5226%)
saving model
Saving model on epoch 41
Done in 324.4638614654541 sec.
Server Epoch:42 choose agents : [4, 43, 67, 60, 32, 45, 94, 15, 38, 34].
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0596, Accuracy: 337/901 (37.4029%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0331, Accuracy: 376/901 (41.7314%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.6510, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   1, Avg loss: 0.0596, Accuracy: 295/946 (31.1839%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   2, Avg loss: 0.0335, Accuracy: 337/946 (35.6237%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.1953, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0758, Accuracy: 95/426 (22.3005%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0413, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.8542, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 664/2227 (29.8159%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0269, Accuracy: 1052/2227 (47.2384%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.5671, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   1, Avg loss: 0.0530, Accuracy: 243/735 (33.0612%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   2, Avg loss: 0.0200, Accuracy: 404/735 (54.9660%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 10.5757, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0649, Accuracy: 220/669 (32.8849%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0376, Accuracy: 359/669 (53.6622%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.7549, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  42, local model 94, internal_epoch   1, Avg loss: 0.0545, Accuracy: 416/1662 (25.0301%)
_Train Local_ResNet_18, epoch  42, local model 94, internal_epoch   2, Avg loss: 0.0318, Accuracy: 660/1662 (39.7112%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.4015, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   1, Avg loss: 0.0564, Accuracy: 350/1154 (30.3293%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   2, Avg loss: 0.0270, Accuracy: 518/1154 (44.8873%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 11.4712, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  42, local model 38, internal_epoch   1, Avg loss: 0.0563, Accuracy: 341/1131 (30.1503%)
_Train Local_ResNet_18, epoch  42, local model 38, internal_epoch   2, Avg loss: 0.0279, Accuracy: 554/1131 (48.9832%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.4612, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   1, Avg loss: 0.0568, Accuracy: 389/1427 (27.2600%)
_Train Local_ResNet_18, epoch  42, local model 34, internal_epoch   2, Avg loss: 0.0319, Accuracy: 611/1427 (42.8171%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.4470, Accuracy: 76/10000 (0.7600%)
time spent on training: 228.1674997806549
[rfa agg] training data poison_ratio: 0.0  data num: [901, 946, 426, 2227, 735, 669, 1662, 1154, 1131, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 43, 67, 60, 32, 45, 94, 15, 38, 34], weight: tensor([0.0799, 0.0839, 0.0378, 0.1975, 0.0652, 0.0593, 0.1474, 0.1023, 0.1003,
        0.1265])
[rfa agg] iter:  0, prev_obj_val: 63.02181625366211, obj_val: 67.9107894897461, abs dis: 4.888973236083984
[rfa agg] iter: 0, weight: tensor([0.0658, 0.0697, 0.0097, 0.0354, 0.0296, 0.0233, 0.0578, 0.2953, 0.3317,
        0.0817])
[rfa agg] iter:  1, prev_obj_val: 67.9107894897461, obj_val: 71.16768646240234, abs dis: 3.25689697265625
[rfa agg] iter: 1, weight: tensor([0.1686, 0.1847, 0.0146, 0.0392, 0.0526, 0.0394, 0.0568, 0.1449, 0.2283,
        0.0709])
[rfa agg] iter:  2, prev_obj_val: 71.16768646240234, obj_val: 73.10860443115234, abs dis: 1.94091796875
[rfa agg] iter: 2, weight: tensor([0.2604, 0.3154, 0.0131, 0.0298, 0.0539, 0.0384, 0.0412, 0.0838, 0.1144,
        0.0494])
[rfa agg] iter:  3, prev_obj_val: 73.10860443115234, obj_val: 81.48091888427734, abs dis: 8.372314453125
[rfa agg] iter: 3, weight: tensor([0.2859, 0.3897, 0.0112, 0.0234, 0.0503, 0.0346, 0.0317, 0.0592, 0.0768,
        0.0373])
[rfa agg] iter:  4, prev_obj_val: 81.48091888427734, obj_val: 81.44818115234375, abs dis: 0.03273773193359375
[rfa agg] iter: 4, weight: tensor([0.2000, 0.2184, 0.0237, 0.0375, 0.1608, 0.0927, 0.0481, 0.0750, 0.0896,
        0.0542])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3580, Accuracy: 70/10000 (0.7000%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 4.7499, Accuracy: 280/9950 (2.8141%)
saving model
Saving model on epoch 42
Done in 324.2519609928131 sec.
Server Epoch:43 choose agents : [30, 90, 78, 76, 95, 4, 91, 40, 31, 21].
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0775, Accuracy: 77/486 (15.8436%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0383, Accuracy: 217/486 (44.6502%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.2654, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0576, Accuracy: 312/677 (46.0857%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0219, Accuracy: 442/677 (65.2880%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.9909, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  43, local model 78, internal_epoch   1, Avg loss: 0.0782, Accuracy: 81/416 (19.4712%)
_Train Local_ResNet_18, epoch  43, local model 78, internal_epoch   2, Avg loss: 0.0429, Accuracy: 240/416 (57.6923%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.1531, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  43, local model 76, internal_epoch   1, Avg loss: 0.0837, Accuracy: 56/466 (12.0172%)
_Train Local_ResNet_18, epoch  43, local model 76, internal_epoch   2, Avg loss: 0.0446, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.9638, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 95, internal_epoch   1, Avg loss: 0.0494, Accuracy: 353/599 (58.9316%)
_Train Local_ResNet_18, epoch  43, local model 95, internal_epoch   2, Avg loss: 0.0294, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 11.3639, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   1, Avg loss: 0.0562, Accuracy: 347/901 (38.5128%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   2, Avg loss: 0.0304, Accuracy: 413/901 (45.8380%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.0536, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   1, Avg loss: 0.0516, Accuracy: 441/1030 (42.8155%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   2, Avg loss: 0.0230, Accuracy: 669/1030 (64.9515%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.5514, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0567, Accuracy: 365/1573 (23.2041%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 576/1573 (36.6179%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.0362, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  43, local model 31, internal_epoch   1, Avg loss: 0.0815, Accuracy: 64/460 (13.9130%)
_Train Local_ResNet_18, epoch  43, local model 31, internal_epoch   2, Avg loss: 0.0364, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.7315, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  43, local model 21, internal_epoch   1, Avg loss: 0.0528, Accuracy: 427/1949 (21.9087%)
_Train Local_ResNet_18, epoch  43, local model 21, internal_epoch   2, Avg loss: 0.0322, Accuracy: 633/1949 (32.4782%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.4080, Accuracy: 81/10000 (0.8100%)
time spent on training: 211.331618309021
[rfa agg] training data poison_ratio: 0.0  data num: [486, 677, 416, 466, 599, 901, 1030, 1573, 460, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [30, 90, 78, 76, 95, 4, 91, 40, 31, 21], weight: tensor([0.0568, 0.0791, 0.0486, 0.0545, 0.0700, 0.1053, 0.1204, 0.1838, 0.0538,
        0.2278])
[rfa agg] iter:  0, prev_obj_val: 71.30873107910156, obj_val: 75.21467590332031, abs dis: 3.90594482421875
[rfa agg] iter: 0, weight: tensor([0.0276, 0.0611, 0.0210, 0.0264, 0.0452, 0.3211, 0.3332, 0.0792, 0.0261,
        0.0590])
[rfa agg] iter:  1, prev_obj_val: 75.21467590332031, obj_val: 80.17109680175781, abs dis: 4.9564208984375
[rfa agg] iter: 1, weight: tensor([0.0481, 0.1421, 0.0348, 0.0461, 0.0918, 0.2989, 0.1571, 0.0746, 0.0455,
        0.0609])
[rfa agg] iter:  2, prev_obj_val: 80.17109680175781, obj_val: 87.77549743652344, abs dis: 7.604400634765625
[rfa agg] iter: 2, weight: tensor([0.0579, 0.3625, 0.0386, 0.0554, 0.1555, 0.1068, 0.0776, 0.0489, 0.0547,
        0.0420])
[rfa agg] iter:  3, prev_obj_val: 87.77549743652344, obj_val: 95.86701965332031, abs dis: 8.091522216796875
[rfa agg] iter: 3, weight: tensor([0.1106, 0.1555, 0.0582, 0.1064, 0.2901, 0.0579, 0.0486, 0.0362, 0.1042,
        0.0323])
[rfa agg] iter:  4, prev_obj_val: 95.86701965332031, obj_val: 99.482177734375, abs dis: 3.6151580810546875
[rfa agg] iter: 4, weight: tensor([0.2509, 0.0486, 0.0817, 0.2409, 0.0641, 0.0280, 0.0249, 0.0202, 0.2222,
        0.0185])
[rfa agg] iter:  5, prev_obj_val: 99.482177734375, obj_val: 99.47763061523438, abs dis: 0.004547119140625
[rfa agg] iter: 5, weight: tensor([0.2181, 0.0517, 0.1636, 0.2006, 0.0633, 0.0323, 0.0291, 0.0243, 0.1947,
        0.0224])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3549, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 4.7653, Accuracy: 253/9950 (2.5427%)
saving model
Done in 306.65292263031006 sec.
Server Epoch:44 choose agents : [99, 52, 94, 4, 15, 32, 64, 58, 36, 57].
_Train Local_ResNet_18, epoch  44, local model 99, internal_epoch   1, Avg loss: 0.0575, Accuracy: 235/773 (30.4010%)
_Train Local_ResNet_18, epoch  44, local model 99, internal_epoch   2, Avg loss: 0.0279, Accuracy: 439/773 (56.7917%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.5461, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   1, Avg loss: 0.0528, Accuracy: 313/636 (49.2138%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   2, Avg loss: 0.0281, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.9788, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  44, local model 94, internal_epoch   1, Avg loss: 0.0541, Accuracy: 398/1662 (23.9471%)
_Train Local_ResNet_18, epoch  44, local model 94, internal_epoch   2, Avg loss: 0.0312, Accuracy: 681/1662 (40.9747%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.1957, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0622, Accuracy: 348/901 (38.6238%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0290, Accuracy: 401/901 (44.5061%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.9268, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0550, Accuracy: 359/1154 (31.1092%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0275, Accuracy: 469/1154 (40.6412%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.4278, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0515, Accuracy: 241/735 (32.7891%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0202, Accuracy: 385/735 (52.3810%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 11.4201, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   1, Avg loss: 0.0626, Accuracy: 182/953 (19.0976%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   2, Avg loss: 0.0366, Accuracy: 305/953 (32.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.8057, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 334/803 (41.5940%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 396/803 (49.3151%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.3953, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.0833, Accuracy: 85/408 (20.8333%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0489, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.7729, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0533, Accuracy: 327/1154 (28.3362%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0282, Accuracy: 534/1154 (46.2738%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.5938, Accuracy: 73/10000 (0.7300%)
time spent on training: 225.1751093864441
[rfa agg] training data poison_ratio: 0.0  data num: [773, 636, 1662, 901, 1154, 735, 953, 803, 408, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [99, 52, 94, 4, 15, 32, 64, 58, 36, 57], weight: tensor([0.0842, 0.0693, 0.1811, 0.0982, 0.1257, 0.0801, 0.1038, 0.0875, 0.0444,
        0.1257])
[rfa agg] iter:  0, prev_obj_val: 41.83113098144531, obj_val: 44.70016098022461, abs dis: 2.869029998779297
[rfa agg] iter: 0, weight: tensor([0.1609, 0.0398, 0.0351, 0.1720, 0.0576, 0.0890, 0.2038, 0.1695, 0.0148,
        0.0576])
[rfa agg] iter:  1, prev_obj_val: 44.70016098022461, obj_val: 52.85566711425781, abs dis: 8.155506134033203
[rfa agg] iter: 1, weight: tensor([0.2476, 0.0430, 0.0265, 0.0871, 0.0395, 0.1287, 0.0954, 0.2786, 0.0141,
        0.0395])
[rfa agg] iter:  2, prev_obj_val: 52.85566711425781, obj_val: 59.61079788208008, abs dis: 6.755130767822266
[rfa agg] iter: 2, weight: tensor([0.1448, 0.1170, 0.0344, 0.0749, 0.0458, 0.2776, 0.0804, 0.1522, 0.0271,
        0.0458])
[rfa agg] iter:  3, prev_obj_val: 59.61079788208008, obj_val: 67.01676940917969, abs dis: 7.405971527099609
[rfa agg] iter: 3, weight: tensor([0.1072, 0.2929, 0.0383, 0.0702, 0.0483, 0.1666, 0.0750, 0.1118, 0.0414,
        0.0482])
[rfa agg] iter:  4, prev_obj_val: 67.01676940917969, obj_val: 63.1469612121582, abs dis: 3.8698081970214844
[rfa agg] iter: 4, weight: tensor([0.0872, 0.3705, 0.0404, 0.0649, 0.0486, 0.1152, 0.0691, 0.0908, 0.0647,
        0.0485])
[rfa agg] iter:  5, prev_obj_val: 63.1469612121582, obj_val: 63.13740921020508, abs dis: 0.009552001953125
[rfa agg] iter: 5, weight: tensor([0.0779, 0.4660, 0.0321, 0.0549, 0.0395, 0.1090, 0.0585, 0.0811, 0.0417,
        0.0394])
[rfa agg] iter:  6, prev_obj_val: 63.13740921020508, obj_val: 67.01902770996094, abs dis: 3.8816184997558594
[rfa agg] iter: 6, weight: tensor([0.0719, 0.5072, 0.0297, 0.0506, 0.0365, 0.1004, 0.0540, 0.0748, 0.0385,
        0.0364])
[rfa agg] iter:  7, prev_obj_val: 67.01902770996094, obj_val: 67.01200866699219, abs dis: 0.00701904296875
[rfa agg] iter: 7, weight: tensor([0.0826, 0.4043, 0.0383, 0.0615, 0.0461, 0.1086, 0.0655, 0.0859, 0.0611,
        0.0460])
[rfa agg] iter:  8, prev_obj_val: 67.01200866699219, obj_val: 63.144676208496094, abs dis: 3.8673324584960938
[rfa agg] iter: 8, weight: tensor([0.0848, 0.3884, 0.0393, 0.0631, 0.0472, 0.1116, 0.0672, 0.0882, 0.0629,
        0.0472])
[rfa agg] iter:  9, prev_obj_val: 63.144676208496094, obj_val: 67.01560974121094, abs dis: 3.8709335327148438
[rfa agg] iter: 9, weight: tensor([0.0768, 0.4732, 0.0317, 0.0541, 0.0390, 0.1074, 0.0577, 0.0800, 0.0411,
        0.0389])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3544, Accuracy: 72/10000 (0.7200%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 4.6801, Accuracy: 651/9950 (6.5427%)
saving model
Done in 326.22918796539307 sec.
Server Epoch:45 choose agents : [29, 81, 27, 2, 94, 56, 14, 99, 62, 76].
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   1, Avg loss: 0.0505, Accuracy: 409/1440 (28.4028%)
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   2, Avg loss: 0.0270, Accuracy: 694/1440 (48.1944%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.3424, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  45, local model 81, internal_epoch   1, Avg loss: 0.0632, Accuracy: 253/774 (32.6873%)
_Train Local_ResNet_18, epoch  45, local model 81, internal_epoch   2, Avg loss: 0.0340, Accuracy: 331/774 (42.7649%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.0047, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   1, Avg loss: 0.0550, Accuracy: 378/1587 (23.8185%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   2, Avg loss: 0.0332, Accuracy: 605/1587 (38.1222%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.8999, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   1, Avg loss: 0.0604, Accuracy: 266/605 (43.9669%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   2, Avg loss: 0.0388, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.8106, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  45, local model 94, internal_epoch   1, Avg loss: 0.0541, Accuracy: 361/1662 (21.7208%)
_Train Local_ResNet_18, epoch  45, local model 94, internal_epoch   2, Avg loss: 0.0311, Accuracy: 668/1662 (40.1925%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.8374, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   1, Avg loss: 0.0848, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   2, Avg loss: 0.0683, Accuracy: 75/186 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.4170, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   1, Avg loss: 0.0567, Accuracy: 249/1013 (24.5805%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   2, Avg loss: 0.0326, Accuracy: 404/1013 (39.8815%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.2434, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  45, local model 99, internal_epoch   1, Avg loss: 0.0569, Accuracy: 261/773 (33.7646%)
_Train Local_ResNet_18, epoch  45, local model 99, internal_epoch   2, Avg loss: 0.0277, Accuracy: 445/773 (57.5679%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.1473, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0696, Accuracy: 147/568 (25.8803%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.0641, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0811, Accuracy: 71/466 (15.2361%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0434, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.2231, Accuracy: 51/10000 (0.5100%)
time spent on training: 204.1474633216858
[rfa agg] training data poison_ratio: 0.0  data num: [1440, 774, 1587, 605, 1662, 186, 1013, 773, 568, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [29, 81, 27, 2, 94, 56, 14, 99, 62, 76], weight: tensor([0.1587, 0.0853, 0.1749, 0.0667, 0.1832, 0.0205, 0.1116, 0.0852, 0.0626,
        0.0514])
[rfa agg] iter:  0, prev_obj_val: 59.08430862426758, obj_val: 62.54966354370117, abs dis: 3.4653549194335938
[rfa agg] iter: 0, weight: tensor([0.0904, 0.0893, 0.0763, 0.0381, 0.0717, 0.0057, 0.4858, 0.0892, 0.0311,
        0.0225])
[rfa agg] iter:  1, prev_obj_val: 62.54966354370117, obj_val: 63.70585250854492, abs dis: 1.15618896484375
[rfa agg] iter: 1, weight: tensor([0.0711, 0.1954, 0.0635, 0.0562, 0.0608, 0.0068, 0.2753, 0.1973, 0.0434,
        0.0301])
[rfa agg] iter:  2, prev_obj_val: 63.70585250854492, obj_val: 71.29815673828125, abs dis: 7.592304229736328
[rfa agg] iter: 2, weight: tensor([0.0610, 0.2521, 0.0550, 0.0573, 0.0529, 0.0065, 0.1867, 0.2556, 0.0433,
        0.0296])
[rfa agg] iter:  3, prev_obj_val: 71.29815673828125, obj_val: 71.29190826416016, abs dis: 0.00624847412109375
[rfa agg] iter: 3, weight: tensor([0.0505, 0.2600, 0.0471, 0.1121, 0.0458, 0.0080, 0.0967, 0.2628, 0.0723,
        0.0447])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3535, Accuracy: 69/10000 (0.6900%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 4.7063, Accuracy: 500/9950 (5.0251%)
saving model
Done in 299.0547981262207 sec.
Server Epoch:46 choose agents : [97, 54, 16, 75, 96, 90, 39, 50, 12, 17].
_Train Local_ResNet_18, epoch  46, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 363/1213 (29.9258%)
_Train Local_ResNet_18, epoch  46, local model 97, internal_epoch   2, Avg loss: 0.0266, Accuracy: 538/1213 (44.3528%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.8057, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   1, Avg loss: 0.0541, Accuracy: 345/1130 (30.5310%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   2, Avg loss: 0.0278, Accuracy: 505/1130 (44.6903%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.1012, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0665, Accuracy: 287/708 (40.5367%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0300, Accuracy: 432/708 (61.0169%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8821, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  46, local model 75, internal_epoch   1, Avg loss: 0.0599, Accuracy: 294/776 (37.8866%)
_Train Local_ResNet_18, epoch  46, local model 75, internal_epoch   2, Avg loss: 0.0262, Accuracy: 419/776 (53.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.8579, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0806, Accuracy: 27/311 (8.6817%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0533, Accuracy: 136/311 (43.7299%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.0616, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 90, internal_epoch   1, Avg loss: 0.0574, Accuracy: 303/677 (44.7563%)
_Train Local_ResNet_18, epoch  46, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 447/677 (66.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.9147, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   1, Avg loss: 0.0510, Accuracy: 317/1013 (31.2932%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   2, Avg loss: 0.0245, Accuracy: 550/1013 (54.2942%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.4370, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  46, local model 50, internal_epoch   1, Avg loss: 0.0592, Accuracy: 204/809 (25.2163%)
_Train Local_ResNet_18, epoch  46, local model 50, internal_epoch   2, Avg loss: 0.0247, Accuracy: 414/809 (51.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.7722, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  46, local model 12, internal_epoch   1, Avg loss: 0.0822, Accuracy: 39/338 (11.5385%)
_Train Local_ResNet_18, epoch  46, local model 12, internal_epoch   2, Avg loss: 0.0433, Accuracy: 141/338 (41.7160%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.9315, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0500, Accuracy: 481/1574 (30.5591%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0251, Accuracy: 743/1574 (47.2046%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.5548, Accuracy: 114/10000 (1.1400%)
time spent on training: 201.08220791816711
[rfa agg] training data poison_ratio: 0.0  data num: [1213, 1130, 708, 776, 311, 677, 1013, 809, 338, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [97, 54, 16, 75, 96, 90, 39, 50, 12, 17], weight: tensor([0.1419, 0.1322, 0.0828, 0.0908, 0.0364, 0.0792, 0.1185, 0.0946, 0.0395,
        0.1841])
[rfa agg] iter:  0, prev_obj_val: 43.95722579956055, obj_val: 52.257774353027344, abs dis: 8.300548553466797
[rfa agg] iter: 0, weight: tensor([0.0586, 0.0665, 0.1151, 0.2614, 0.0098, 0.0710, 0.1052, 0.2635, 0.0121,
        0.0366])
[rfa agg] iter:  1, prev_obj_val: 52.257774353027344, obj_val: 62.56730651855469, abs dis: 10.309532165527344
[rfa agg] iter: 1, weight: tensor([0.0451, 0.0484, 0.2405, 0.1372, 0.0134, 0.2609, 0.0624, 0.1424, 0.0172,
        0.0326])
[rfa agg] iter:  2, prev_obj_val: 62.56730651855469, obj_val: 52.216880798339844, abs dis: 10.350425720214844
[rfa agg] iter: 2, weight: tensor([0.0618, 0.0648, 0.1568, 0.1170, 0.0285, 0.2850, 0.0773, 0.1217, 0.0387,
        0.0482])
[rfa agg] iter:  3, prev_obj_val: 52.216880798339844, obj_val: 58.872169494628906, abs dis: 6.6552886962890625
[rfa agg] iter: 3, weight: tensor([0.0436, 0.0468, 0.2396, 0.1306, 0.0129, 0.2828, 0.0603, 0.1353, 0.0166,
        0.0315])
[rfa agg] iter:  4, prev_obj_val: 58.872169494628906, obj_val: 62.564308166503906, abs dis: 3.692138671875
[rfa agg] iter: 4, weight: tensor([0.0508, 0.0536, 0.1577, 0.1082, 0.0202, 0.3663, 0.0654, 0.1124, 0.0268,
        0.0387])
[rfa agg] iter:  5, prev_obj_val: 62.564308166503906, obj_val: 52.21726989746094, abs dis: 10.347038269042969
[rfa agg] iter: 5, weight: tensor([0.0615, 0.0644, 0.1545, 0.1162, 0.0284, 0.2908, 0.0768, 0.1210, 0.0385,
        0.0480])
[rfa agg] iter:  6, prev_obj_val: 52.21726989746094, obj_val: 58.87202453613281, abs dis: 6.654754638671875
[rfa agg] iter: 6, weight: tensor([0.0435, 0.0467, 0.2390, 0.1306, 0.0129, 0.2837, 0.0603, 0.1352, 0.0166,
        0.0315])
[rfa agg] iter:  7, prev_obj_val: 58.87202453613281, obj_val: 62.56431579589844, abs dis: 3.692291259765625
[rfa agg] iter: 7, weight: tensor([0.0508, 0.0536, 0.1577, 0.1081, 0.0202, 0.3665, 0.0653, 0.1124, 0.0267,
        0.0387])
[rfa agg] iter:  8, prev_obj_val: 62.56431579589844, obj_val: 52.2172737121582, abs dis: 10.347042083740234
[rfa agg] iter: 8, weight: tensor([0.0615, 0.0644, 0.1545, 0.1162, 0.0284, 0.2909, 0.0768, 0.1210, 0.0385,
        0.0480])
[rfa agg] iter:  9, prev_obj_val: 52.2172737121582, obj_val: 58.87202453613281, abs dis: 6.654750823974609
[rfa agg] iter: 9, weight: tensor([0.0435, 0.0467, 0.2390, 0.1306, 0.0129, 0.2837, 0.0603, 0.1352, 0.0166,
        0.0315])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3523, Accuracy: 67/10000 (0.6700%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 4.7280, Accuracy: 431/9950 (4.3317%)
saving model
Done in 301.43573021888733 sec.
Server Epoch:47 choose agents : [66, 77, 20, 72, 32, 75, 26, 83, 55, 13].
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   1, Avg loss: 0.0599, Accuracy: 272/1402 (19.4009%)
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   2, Avg loss: 0.0373, Accuracy: 419/1402 (29.8859%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.2816, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  47, local model 77, internal_epoch   1, Avg loss: 0.0483, Accuracy: 358/1340 (26.7164%)
_Train Local_ResNet_18, epoch  47, local model 77, internal_epoch   2, Avg loss: 0.0259, Accuracy: 579/1340 (43.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.4421, Accuracy: 79/10000 (0.7900%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  47, local model 20, internal_epoch   1, Avg loss: 0.0552, Accuracy: 320/807 (39.6530%)
_Train Local_ResNet_18, epoch  47, local model 20, internal_epoch   2, Avg loss: 0.0305, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.4366, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   1, Avg loss: 0.0579, Accuracy: 291/1241 (23.4488%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   2, Avg loss: 0.0351, Accuracy: 449/1241 (36.1805%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.1430, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   1, Avg loss: 0.0509, Accuracy: 249/735 (33.8776%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   2, Avg loss: 0.0204, Accuracy: 414/735 (56.3265%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 11.4115, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0580, Accuracy: 299/776 (38.5309%)
_Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0264, Accuracy: 436/776 (56.1856%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.8105, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0553, Accuracy: 341/1446 (23.5823%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0341, Accuracy: 512/1446 (35.4080%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.7544, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  47, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 433/1953 (22.1710%)
_Train Local_ResNet_18, epoch  47, local model 83, internal_epoch   2, Avg loss: 0.0324, Accuracy: 830/1953 (42.4987%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.4525, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  47, local model 55, internal_epoch   1, Avg loss: 0.0503, Accuracy: 340/1071 (31.7460%)
_Train Local_ResNet_18, epoch  47, local model 55, internal_epoch   2, Avg loss: 0.0275, Accuracy: 561/1071 (52.3810%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.7420, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   1, Avg loss: 0.0536, Accuracy: 366/1645 (22.2492%)
_Train Local_ResNet_18, epoch  47, local model 13, internal_epoch   2, Avg loss: 0.0304, Accuracy: 720/1645 (43.7690%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.4131, Accuracy: 124/10000 (1.2400%)
time spent on training: 252.46297001838684
[rfa agg] training data poison_ratio: 0.06499677835051547  data num: [1402, 1340, 807, 1241, 735, 776, 1446, 1953, 1071, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.020311493234536085
[rfa agg] init. name: [66, 77, 20, 72, 32, 75, 26, 83, 55, 13], weight: tensor([0.1129, 0.1079, 0.0650, 0.1000, 0.0592, 0.0625, 0.1165, 0.1573, 0.0863,
        0.1325])
[rfa agg] iter:  0, prev_obj_val: 52.234642028808594, obj_val: 56.490745544433594, abs dis: 4.256103515625
[rfa agg] iter: 0, weight: tensor([0.1054, 0.1304, 0.0489, 0.1745, 0.0374, 0.0473, 0.0873, 0.0460, 0.2600,
        0.0628])
[rfa agg] iter:  1, prev_obj_val: 56.490745544433594, obj_val: 58.98231887817383, abs dis: 2.4915733337402344
[rfa agg] iter: 1, weight: tensor([0.0737, 0.0870, 0.0526, 0.1066, 0.0389, 0.0510, 0.0634, 0.0371, 0.4414,
        0.0485])
[rfa agg] iter:  2, prev_obj_val: 58.98231887817383, obj_val: 61.698116302490234, abs dis: 2.7157974243164062
[rfa agg] iter: 2, weight: tensor([0.0707, 0.0817, 0.0628, 0.0965, 0.0454, 0.0611, 0.0618, 0.0377, 0.4339,
        0.0485])
[rfa agg] iter:  3, prev_obj_val: 61.698116302490234, obj_val: 58.99025344848633, abs dis: 2.7078628540039062
[rfa agg] iter: 3, weight: tensor([0.0783, 0.0891, 0.0875, 0.1026, 0.0614, 0.0854, 0.0693, 0.0440, 0.3267,
        0.0556])
[rfa agg] iter:  4, prev_obj_val: 58.99025344848633, obj_val: 61.69467544555664, abs dis: 2.7044219970703125
[rfa agg] iter: 4, weight: tensor([0.0736, 0.0850, 0.0656, 0.1005, 0.0473, 0.0637, 0.0642, 0.0392, 0.4105,
        0.0504])
[rfa agg] iter:  5, prev_obj_val: 61.69467544555664, obj_val: 58.99052429199219, abs dis: 2.704151153564453
[rfa agg] iter: 5, weight: tensor([0.0785, 0.0893, 0.0878, 0.1029, 0.0616, 0.0857, 0.0695, 0.0441, 0.3249,
        0.0557])
[rfa agg] iter:  6, prev_obj_val: 58.99052429199219, obj_val: 61.69462585449219, abs dis: 2.7041015625
[rfa agg] iter: 6, weight: tensor([0.0736, 0.0850, 0.0656, 0.1006, 0.0473, 0.0638, 0.0643, 0.0393, 0.4101,
        0.0504])
[rfa agg] iter:  7, prev_obj_val: 61.69462585449219, obj_val: 58.99053192138672, abs dis: 2.7040939331054688
[rfa agg] iter: 7, weight: tensor([0.0785, 0.0893, 0.0878, 0.1029, 0.0616, 0.0857, 0.0695, 0.0441, 0.3249,
        0.0557])
[rfa agg] iter:  8, prev_obj_val: 58.99053192138672, obj_val: 61.69462585449219, abs dis: 2.7040939331054688
[rfa agg] iter: 8, weight: tensor([0.0736, 0.0850, 0.0656, 0.1006, 0.0473, 0.0638, 0.0643, 0.0393, 0.4101,
        0.0504])
[rfa agg] iter:  9, prev_obj_val: 61.69462585449219, obj_val: 58.99053192138672, abs dis: 2.7040939331054688
[rfa agg] iter: 9, weight: tensor([0.0785, 0.0893, 0.0878, 0.1029, 0.0616, 0.0857, 0.0695, 0.0441, 0.3249,
        0.0557])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3526, Accuracy: 73/10000 (0.7300%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 4.7156, Accuracy: 496/9950 (4.9849%)
saving model
Done in 355.3834156990051 sec.
Server Epoch:48 choose agents : [42, 90, 83, 4, 11, 19, 73, 61, 96, 39].
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 340/1372 (24.7813%)
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   2, Avg loss: 0.0303, Accuracy: 567/1372 (41.3265%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.2517, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0545, Accuracy: 326/677 (48.1536%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0211, Accuracy: 462/677 (68.2422%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.2498, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  48, local model 83, internal_epoch   1, Avg loss: 0.0532, Accuracy: 471/1953 (24.1167%)
_Train Local_ResNet_18, epoch  48, local model 83, internal_epoch   2, Avg loss: 0.0320, Accuracy: 854/1953 (43.7276%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.9711, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   1, Avg loss: 0.0579, Accuracy: 351/901 (38.9567%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   2, Avg loss: 0.0313, Accuracy: 415/901 (46.0599%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.9046, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   1, Avg loss: 0.0517, Accuracy: 310/712 (43.5393%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   2, Avg loss: 0.0243, Accuracy: 451/712 (63.3427%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.1852, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0479, Accuracy: 417/1036 (40.2510%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0230, Accuracy: 717/1036 (69.2085%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 11.8099, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   1, Avg loss: 0.0614, Accuracy: 202/938 (21.5352%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   2, Avg loss: 0.0321, Accuracy: 358/938 (38.1663%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.8865, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   1, Avg loss: 0.1289, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   2, Avg loss: 0.1199, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3539, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0804, Accuracy: 30/311 (9.6463%)
_Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0527, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.1804, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0505, Accuracy: 313/1013 (30.8983%)
_Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0245, Accuracy: 554/1013 (54.6890%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.6415, Accuracy: 71/10000 (0.7100%)
time spent on training: 217.0498025417328
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 677, 1953, 901, 712, 1036, 938, 85, 311, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 90, 83, 4, 11, 19, 73, 61, 96, 39], weight: tensor([0.1525, 0.0752, 0.2170, 0.1001, 0.0791, 0.1151, 0.1042, 0.0094, 0.0346,
        0.1126])
[rfa agg] iter:  0, prev_obj_val: 52.380496978759766, obj_val: 58.93374252319336, abs dis: 6.553245544433594
[rfa agg] iter: 0, weight: tensor([0.0602, 0.0299, 0.0328, 0.1313, 0.0382, 0.2923, 0.1372, 0.0014, 0.0066,
        0.2699])
[rfa agg] iter:  1, prev_obj_val: 58.93374252319336, obj_val: 61.45653533935547, abs dis: 2.5227928161621094
[rfa agg] iter: 1, weight: tensor([0.0533, 0.0689, 0.0359, 0.2274, 0.1045, 0.1062, 0.2401, 0.0022, 0.0108,
        0.1507])
[rfa agg] iter:  2, prev_obj_val: 61.45653533935547, obj_val: 61.451988220214844, abs dis: 0.004547119140625
[rfa agg] iter: 2, weight: tensor([0.0568, 0.0931, 0.0395, 0.1953, 0.1538, 0.1029, 0.2056, 0.0026, 0.0129,
        0.1375])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3514, Accuracy: 77/10000 (0.7700%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 4.6226, Accuracy: 1261/9950 (12.6734%)
saving model
Done in 314.55610966682434 sec.
Server Epoch:49 choose agents : [20, 2, 31, 41, 84, 98, 18, 69, 11, 22].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  49, local model 20, internal_epoch   1, Avg loss: 0.0548, Accuracy: 343/807 (42.5031%)
_Train Local_ResNet_18, epoch  49, local model 20, internal_epoch   2, Avg loss: 0.0303, Accuracy: 416/807 (51.5489%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.4551, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 262/605 (43.3058%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0371, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.8073, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   1, Avg loss: 0.0806, Accuracy: 63/460 (13.6957%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   2, Avg loss: 0.0350, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.3242, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0601, Accuracy: 318/719 (44.2281%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0300, Accuracy: 465/719 (64.6732%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.5604, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  49, local model 84, internal_epoch   1, Avg loss: 0.0576, Accuracy: 337/1190 (28.3193%)
_Train Local_ResNet_18, epoch  49, local model 84, internal_epoch   2, Avg loss: 0.0303, Accuracy: 506/1190 (42.5210%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.4904, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   1, Avg loss: 0.0812, Accuracy: 34/373 (9.1153%)
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   2, Avg loss: 0.0474, Accuracy: 157/373 (42.0912%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.0100, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0756, Accuracy: 133/530 (25.0943%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0378, Accuracy: 277/530 (52.2642%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.3309, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   1, Avg loss: 0.0578, Accuracy: 270/590 (45.7627%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   2, Avg loss: 0.0351, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 11.3316, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 11, internal_epoch   1, Avg loss: 0.0517, Accuracy: 335/712 (47.0506%)
_Train Local_ResNet_18, epoch  49, local model 11, internal_epoch   2, Avg loss: 0.0236, Accuracy: 420/712 (58.9888%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.4838, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  49, local model 22, internal_epoch   1, Avg loss: 0.0448, Accuracy: 567/1470 (38.5714%)
_Train Local_ResNet_18, epoch  49, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 878/1470 (59.7279%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.7849, Accuracy: 103/10000 (1.0300%)
time spent on training: 196.47827339172363
[rfa agg] training data poison_ratio: 0.10823497854077253  data num: [807, 605, 460, 719, 1190, 373, 530, 590, 712, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.033823430793991416
[rfa agg] init. name: [20, 2, 31, 41, 84, 98, 18, 69, 11, 22], weight: tensor([0.1082, 0.0811, 0.0617, 0.0964, 0.1596, 0.0500, 0.0711, 0.0791, 0.0955,
        0.1972])
[rfa agg] iter:  0, prev_obj_val: 41.75865936279297, obj_val: 49.47908020019531, abs dis: 7.720420837402344
[rfa agg] iter: 0, weight: tensor([0.1626, 0.0727, 0.0287, 0.2400, 0.0424, 0.0156, 0.0438, 0.0710, 0.2898,
        0.0335])
[rfa agg] iter:  1, prev_obj_val: 49.47908020019531, obj_val: 58.94469451904297, abs dis: 9.465614318847656
[rfa agg] iter: 1, weight: tensor([0.0638, 0.2026, 0.0805, 0.0788, 0.0350, 0.0296, 0.2011, 0.1993, 0.0789,
        0.0305])
[rfa agg] iter:  2, prev_obj_val: 58.94469451904297, obj_val: 66.71115112304688, abs dis: 7.766456604003906
[rfa agg] iter: 2, weight: tensor([0.0538, 0.0987, 0.3347, 0.0596, 0.0364, 0.0616, 0.1664, 0.0965, 0.0594,
        0.0330])
[rfa agg] iter:  3, prev_obj_val: 66.71115112304688, obj_val: 62.74432373046875, abs dis: 3.966827392578125
[rfa agg] iter: 3, weight: tensor([0.0653, 0.0968, 0.2138, 0.0695, 0.0484, 0.1703, 0.1272, 0.0946, 0.0692,
        0.0449])
[rfa agg] iter:  4, prev_obj_val: 62.74432373046875, obj_val: 66.70735168457031, abs dis: 3.9630279541015625
[rfa agg] iter: 4, weight: tensor([0.0597, 0.0967, 0.2992, 0.0647, 0.0423, 0.0995, 0.1399, 0.0946, 0.0644,
        0.0388])
[rfa agg] iter:  5, prev_obj_val: 66.70735168457031, obj_val: 62.74439239501953, abs dis: 3.9629592895507812
[rfa agg] iter: 5, weight: tensor([0.0653, 0.0969, 0.2127, 0.0696, 0.0484, 0.1713, 0.1271, 0.0947, 0.0692,
        0.0449])
[rfa agg] iter:  6, prev_obj_val: 62.74439239501953, obj_val: 66.70734405517578, abs dis: 3.96295166015625
[rfa agg] iter: 6, weight: tensor([0.0597, 0.0968, 0.2991, 0.0647, 0.0423, 0.0996, 0.1399, 0.0946, 0.0644,
        0.0388])
[rfa agg] iter:  7, prev_obj_val: 66.70734405517578, obj_val: 62.74439239501953, abs dis: 3.96295166015625
[rfa agg] iter: 7, weight: tensor([0.0653, 0.0969, 0.2127, 0.0696, 0.0484, 0.1713, 0.1271, 0.0947, 0.0692,
        0.0449])
[rfa agg] iter:  8, prev_obj_val: 62.74439239501953, obj_val: 66.70734405517578, abs dis: 3.96295166015625
[rfa agg] iter: 8, weight: tensor([0.0597, 0.0968, 0.2991, 0.0647, 0.0423, 0.0996, 0.1399, 0.0946, 0.0644,
        0.0388])
[rfa agg] iter:  9, prev_obj_val: 66.70734405517578, obj_val: 62.74439239501953, abs dis: 3.96295166015625
[rfa agg] iter: 9, weight: tensor([0.0653, 0.0969, 0.2127, 0.0696, 0.0484, 0.1713, 0.1271, 0.0947, 0.0692,
        0.0449])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3493, Accuracy: 84/10000 (0.8400%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 4.6427, Accuracy: 1042/9950 (10.4724%)
saving model
Done in 297.8322410583496 sec.
Server Epoch:50 choose agents : [40, 49, 82, 52, 64, 6, 61, 8, 71, 42].
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   1, Avg loss: 0.0560, Accuracy: 364/1573 (23.1405%)
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   2, Avg loss: 0.0340, Accuracy: 615/1573 (39.0973%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.9930, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   1, Avg loss: 0.0757, Accuracy: 72/440 (16.3636%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   2, Avg loss: 0.0458, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.4593, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 82, internal_epoch   1, Avg loss: 0.0744, Accuracy: 87/500 (17.4000%)
_Train Local_ResNet_18, epoch  50, local model 82, internal_epoch   2, Avg loss: 0.0474, Accuracy: 203/500 (40.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.4839, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0508, Accuracy: 336/636 (52.8302%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0264, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.9591, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   1, Avg loss: 0.0624, Accuracy: 192/953 (20.1469%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   2, Avg loss: 0.0363, Accuracy: 334/953 (35.0472%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.5617, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   1, Avg loss: 0.0535, Accuracy: 435/1956 (22.2393%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   2, Avg loss: 0.0303, Accuracy: 715/1956 (36.5542%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.4475, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   1, Avg loss: 0.1291, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   2, Avg loss: 0.1196, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3545, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   1, Avg loss: 0.0582, Accuracy: 314/1513 (20.7535%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   2, Avg loss: 0.0346, Accuracy: 536/1513 (35.4263%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.8142, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  50, local model 71, internal_epoch   1, Avg loss: 0.0543, Accuracy: 270/818 (33.0073%)
_Train Local_ResNet_18, epoch  50, local model 71, internal_epoch   2, Avg loss: 0.0267, Accuracy: 418/818 (51.1002%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.0962, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   1, Avg loss: 0.0525, Accuracy: 342/1372 (24.9271%)
_Train Local_ResNet_18, epoch  50, local model 42, internal_epoch   2, Avg loss: 0.0305, Accuracy: 579/1372 (42.2012%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.0222, Accuracy: 85/10000 (0.8500%)
time spent on training: 205.8623275756836
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 440, 500, 636, 953, 1956, 85, 1513, 818, 1372]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 49, 82, 52, 64, 6, 61, 8, 71, 42], weight: tensor([0.1598, 0.0447, 0.0508, 0.0646, 0.0968, 0.1987, 0.0086, 0.1537, 0.0831,
        0.1393])
[rfa agg] iter:  0, prev_obj_val: 66.5434341430664, obj_val: 67.86849212646484, abs dis: 1.3250579833984375
[rfa agg] iter: 0, weight: tensor([0.1473, 0.0234, 0.0292, 0.0457, 0.1638, 0.0957, 0.0032, 0.1669, 0.0904,
        0.2346])
[rfa agg] iter:  1, prev_obj_val: 67.86849212646484, obj_val: 70.57640075683594, abs dis: 2.7079086303710938
[rfa agg] iter: 1, weight: tensor([0.1388, 0.0248, 0.0310, 0.0493, 0.1932, 0.0932, 0.0033, 0.1554, 0.1006,
        0.2103])
[rfa agg] iter:  2, prev_obj_val: 70.57640075683594, obj_val: 69.21751403808594, abs dis: 1.35888671875
[rfa agg] iter: 2, weight: tensor([0.1169, 0.0263, 0.0331, 0.0541, 0.2722, 0.0832, 0.0034, 0.1283, 0.1201,
        0.1624])
[rfa agg] iter:  3, prev_obj_val: 69.21751403808594, obj_val: 70.5732650756836, abs dis: 1.3557510375976562
[rfa agg] iter: 3, weight: tensor([0.1286, 0.0258, 0.0324, 0.0521, 0.2297, 0.0891, 0.0034, 0.1425, 0.1107,
        0.1856])
[rfa agg] iter:  4, prev_obj_val: 70.5732650756836, obj_val: 69.21754455566406, abs dis: 1.3557205200195312
[rfa agg] iter: 4, weight: tensor([0.1168, 0.0262, 0.0331, 0.0540, 0.2730, 0.0832, 0.0034, 0.1282, 0.1201,
        0.1621])
[rfa agg] iter:  5, prev_obj_val: 69.21754455566406, obj_val: 70.5732650756836, abs dis: 1.3557205200195312
[rfa agg] iter: 5, weight: tensor([0.1286, 0.0258, 0.0324, 0.0521, 0.2297, 0.0891, 0.0034, 0.1425, 0.1107,
        0.1856])
[rfa agg] iter:  6, prev_obj_val: 70.5732650756836, obj_val: 69.21754455566406, abs dis: 1.3557205200195312
[rfa agg] iter: 6, weight: tensor([0.1168, 0.0262, 0.0331, 0.0540, 0.2730, 0.0832, 0.0034, 0.1282, 0.1201,
        0.1621])
[rfa agg] iter:  7, prev_obj_val: 69.21754455566406, obj_val: 70.5732650756836, abs dis: 1.3557205200195312
[rfa agg] iter: 7, weight: tensor([0.1286, 0.0258, 0.0324, 0.0521, 0.2297, 0.0891, 0.0034, 0.1425, 0.1107,
        0.1856])
[rfa agg] iter:  8, prev_obj_val: 70.5732650756836, obj_val: 69.21754455566406, abs dis: 1.3557205200195312
[rfa agg] iter: 8, weight: tensor([0.1168, 0.0262, 0.0331, 0.0540, 0.2730, 0.0832, 0.0034, 0.1282, 0.1201,
        0.1621])
[rfa agg] iter:  9, prev_obj_val: 69.21754455566406, obj_val: 70.5732650756836, abs dis: 1.3557205200195312
[rfa agg] iter: 9, weight: tensor([0.1286, 0.0258, 0.0324, 0.0521, 0.2297, 0.0891, 0.0034, 0.1425, 0.1107,
        0.1856])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3472, Accuracy: 81/10000 (0.8100%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 4.5813, Accuracy: 1716/9950 (17.2462%)
saving model
Saving model on epoch 50
Done in 309.19230341911316 sec.
Server Epoch:51 choose agents : [5, 57, 22, 34, 60, 42, 12, 72, 7, 93].
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   1, Avg loss: 0.0486, Accuracy: 407/1628 (25.0000%)
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   2, Avg loss: 0.0234, Accuracy: 896/1628 (55.0369%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.2027, Accuracy: 156/10000 (1.5600%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   1, Avg loss: 0.0549, Accuracy: 313/1154 (27.1231%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   2, Avg loss: 0.0246, Accuracy: 546/1154 (47.3137%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 12.2630, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 527/1470 (35.8503%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   2, Avg loss: 0.0232, Accuracy: 886/1470 (60.2721%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.3637, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   1, Avg loss: 0.0562, Accuracy: 412/1427 (28.8718%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   2, Avg loss: 0.0317, Accuracy: 621/1427 (43.5179%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.7736, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 640/2227 (28.7382%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   2, Avg loss: 0.0268, Accuracy: 1070/2227 (48.0467%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.6722, Accuracy: 136/10000 (1.3600%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0522, Accuracy: 333/1372 (24.2711%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 528/1372 (38.4840%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.5831, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   1, Avg loss: 0.0828, Accuracy: 34/338 (10.0592%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   2, Avg loss: 0.0431, Accuracy: 140/338 (41.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.6469, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0577, Accuracy: 331/1241 (26.6720%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0351, Accuracy: 473/1241 (38.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9558, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0520, Accuracy: 366/891 (41.0774%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0245, Accuracy: 453/891 (50.8418%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.8327, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0532, Accuracy: 443/1742 (25.4305%)
_Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0304, Accuracy: 782/1742 (44.8909%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3534, Accuracy: 98/10000 (0.9800%)
time spent on training: 263.0260384082794
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 1154, 1470, 1427, 2227, 1372, 338, 1241, 891, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 57, 22, 34, 60, 42, 12, 72, 7, 93], weight: tensor([0.1207, 0.0855, 0.1090, 0.1058, 0.1651, 0.1017, 0.0251, 0.0920, 0.0660,
        0.1291])
[rfa agg] iter:  0, prev_obj_val: 46.57292175292969, obj_val: 52.07130432128906, abs dis: 5.498382568359375
[rfa agg] iter: 0, weight: tensor([0.0698, 0.0648, 0.1919, 0.1836, 0.0301, 0.2837, 0.0037, 0.1025, 0.0195,
        0.0505])
[rfa agg] iter:  1, prev_obj_val: 52.07130432128906, obj_val: 54.29948043823242, abs dis: 2.2281761169433594
[rfa agg] iter: 1, weight: tensor([0.0611, 0.1358, 0.1171, 0.1132, 0.0321, 0.1730, 0.0049, 0.2861, 0.0285,
        0.0482])
[rfa agg] iter:  2, prev_obj_val: 54.29948043823242, obj_val: 60.02394485473633, abs dis: 5.724464416503906
[rfa agg] iter: 2, weight: tensor([0.0504, 0.1626, 0.0886, 0.0857, 0.0279, 0.1197, 0.0045, 0.3922, 0.0277,
        0.0407])
[rfa agg] iter:  3, prev_obj_val: 60.02394485473633, obj_val: 59.96697998046875, abs dis: 0.056964874267578125
[rfa agg] iter: 3, weight: tensor([0.0532, 0.3039, 0.0828, 0.0802, 0.0321, 0.1015, 0.0060, 0.2553, 0.0406,
        0.0444])
[rfa agg] iter:  4, prev_obj_val: 59.96697998046875, obj_val: 56.989341735839844, abs dis: 2.9776382446289062
[rfa agg] iter: 4, weight: tensor([0.0505, 0.3542, 0.0785, 0.0761, 0.0305, 0.0963, 0.0057, 0.2276, 0.0385,
        0.0422])
[rfa agg] iter:  5, prev_obj_val: 56.989341735839844, obj_val: 63.27630615234375, abs dis: 6.286964416503906
[rfa agg] iter: 5, weight: tensor([0.0501, 0.2821, 0.0821, 0.0797, 0.0290, 0.1048, 0.0051, 0.2934, 0.0324,
        0.0412])
[rfa agg] iter:  6, prev_obj_val: 63.27630615234375, obj_val: 63.26401138305664, abs dis: 0.012294769287109375
[rfa agg] iter: 6, weight: tensor([0.0563, 0.3376, 0.0838, 0.0813, 0.0353, 0.0996, 0.0071, 0.2003, 0.0509,
        0.0478])
[rfa agg] iter:  7, prev_obj_val: 63.26401138305664, obj_val: 63.26353454589844, abs dis: 0.000476837158203125
[rfa agg] iter: 7, weight: tensor([0.0553, 0.3541, 0.0822, 0.0798, 0.0346, 0.0978, 0.0069, 0.1924, 0.0500,
        0.0469])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3461, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 4.5834, Accuracy: 1645/9950 (16.5327%)
saving model
Done in 366.7573971748352 sec.
Server Epoch:52 choose agents : [90, 34, 84, 61, 58, 18, 42, 1, 32, 31].
_Train Local_ResNet_18, epoch  52, local model 90, internal_epoch   1, Avg loss: 0.0533, Accuracy: 337/677 (49.7784%)
_Train Local_ResNet_18, epoch  52, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 432/677 (63.8109%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 11.4740, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   1, Avg loss: 0.0559, Accuracy: 434/1427 (30.4135%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   2, Avg loss: 0.0315, Accuracy: 656/1427 (45.9706%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.1019, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  52, local model 84, internal_epoch   1, Avg loss: 0.0561, Accuracy: 347/1190 (29.1597%)
_Train Local_ResNet_18, epoch  52, local model 84, internal_epoch   2, Avg loss: 0.0297, Accuracy: 512/1190 (43.0252%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.2737, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1296, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1211, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3477, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0583, Accuracy: 327/803 (40.7223%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0345, Accuracy: 389/803 (48.4433%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.4379, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0746, Accuracy: 133/530 (25.0943%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0382, Accuracy: 276/530 (52.0755%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3480, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   1, Avg loss: 0.0517, Accuracy: 342/1372 (24.9271%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   2, Avg loss: 0.0306, Accuracy: 559/1372 (40.7434%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.4283, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  52, local model 1, internal_epoch   1, Avg loss: 0.0525, Accuracy: 335/928 (36.0991%)
_Train Local_ResNet_18, epoch  52, local model 1, internal_epoch   2, Avg loss: 0.0219, Accuracy: 607/928 (65.4095%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.4748, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0511, Accuracy: 257/735 (34.9660%)
_Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0200, Accuracy: 400/735 (54.4218%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.8713, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0777, Accuracy: 89/460 (19.3478%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0348, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.0578, Accuracy: 53/10000 (0.5300%)
time spent on training: 186.88784956932068
[rfa agg] training data poison_ratio: 0.0  data num: [677, 1427, 1190, 85, 803, 530, 1372, 928, 735, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 34, 84, 61, 58, 18, 42, 1, 32, 31], weight: tensor([0.0825, 0.1739, 0.1450, 0.0104, 0.0978, 0.0646, 0.1672, 0.1131, 0.0896,
        0.0560])
[rfa agg] iter:  0, prev_obj_val: 45.98956298828125, obj_val: 51.454444885253906, abs dis: 5.464881896972656
[rfa agg] iter: 0, weight: tensor([0.0826, 0.0586, 0.0872, 0.0026, 0.2532, 0.0391, 0.0634, 0.2536, 0.1313,
        0.0284])
[rfa agg] iter:  1, prev_obj_val: 51.454444885253906, obj_val: 62.667945861816406, abs dis: 11.2135009765625
[rfa agg] iter: 1, weight: tensor([0.1658, 0.0356, 0.0464, 0.0023, 0.1917, 0.0480, 0.0376, 0.0825, 0.3589,
        0.0313])
[rfa agg] iter:  2, prev_obj_val: 62.667945861816406, obj_val: 56.34648132324219, abs dis: 6.321464538574219
[rfa agg] iter: 2, weight: tensor([0.2479, 0.0441, 0.0530, 0.0043, 0.1056, 0.1906, 0.0459, 0.0735, 0.1450,
        0.0901])
[rfa agg] iter:  3, prev_obj_val: 56.34648132324219, obj_val: 59.4022216796875, abs dis: 3.0557403564453125
[rfa agg] iter: 3, weight: tensor([0.4589, 0.0309, 0.0385, 0.0025, 0.0998, 0.0676, 0.0324, 0.0591, 0.1709,
        0.0395])
[rfa agg] iter:  4, prev_obj_val: 59.4022216796875, obj_val: 69.40861511230469, abs dis: 10.006393432617188
[rfa agg] iter: 4, weight: tensor([0.3857, 0.0373, 0.0456, 0.0033, 0.1018, 0.1099, 0.0390, 0.0663, 0.1518,
        0.0593])
[rfa agg] iter:  5, prev_obj_val: 69.40861511230469, obj_val: 69.34378051757812, abs dis: 0.0648345947265625
[rfa agg] iter: 5, weight: tensor([0.1189, 0.0362, 0.0422, 0.0043, 0.0705, 0.4015, 0.0375, 0.0544, 0.0859,
        0.1485])
[rfa agg] iter:  6, prev_obj_val: 69.34378051757812, obj_val: 69.33614349365234, abs dis: 0.00763702392578125
[rfa agg] iter: 6, weight: tensor([0.0982, 0.0303, 0.0353, 0.0036, 0.0589, 0.5013, 0.0313, 0.0455, 0.0717,
        0.1239])
[rfa agg] iter:  7, prev_obj_val: 69.33614349365234, obj_val: 73.12237548828125, abs dis: 3.7862319946289062
[rfa agg] iter: 7, weight: tensor([0.0891, 0.0275, 0.0321, 0.0033, 0.0536, 0.5479, 0.0285, 0.0415, 0.0652,
        0.1113])
[rfa agg] iter:  8, prev_obj_val: 73.12237548828125, obj_val: 73.09915924072266, abs dis: 0.02321624755859375
[rfa agg] iter: 8, weight: tensor([0.0980, 0.0362, 0.0416, 0.0048, 0.0651, 0.3533, 0.0374, 0.0522, 0.0764,
        0.2349])
[rfa agg] iter:  9, prev_obj_val: 73.09915924072266, obj_val: 73.09843444824219, abs dis: 0.00072479248046875
[rfa agg] iter: 9, weight: tensor([0.0990, 0.0365, 0.0420, 0.0049, 0.0656, 0.3230, 0.0377, 0.0526, 0.0772,
        0.2615])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3444, Accuracy: 73/10000 (0.7300%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 4.5430, Accuracy: 2238/9950 (22.4925%)
saving model
Done in 289.12125062942505 sec.
Server Epoch:53 choose agents : [44, 27, 62, 20, 28, 49, 40, 8, 16, 22].
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Avg loss: 0.0567, Accuracy: 436/1750 (24.9143%)
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Avg loss: 0.0338, Accuracy: 734/1750 (41.9429%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.6912, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0553, Accuracy: 392/1587 (24.7007%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0329, Accuracy: 606/1587 (38.1853%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0729, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0689, Accuracy: 163/568 (28.6972%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0397, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.2799, Accuracy: 61/10000 (0.6100%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  53, local model 20, internal_epoch   1, Avg loss: 0.0545, Accuracy: 330/807 (40.8922%)
_Train Local_ResNet_18, epoch  53, local model 20, internal_epoch   2, Avg loss: 0.0302, Accuracy: 418/807 (51.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0193, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 415/1581 (26.2492%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   2, Avg loss: 0.0324, Accuracy: 650/1581 (41.1132%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.8702, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   1, Avg loss: 0.0758, Accuracy: 72/440 (16.3636%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   2, Avg loss: 0.0459, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.7779, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0543, Accuracy: 394/1573 (25.0477%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0337, Accuracy: 616/1573 (39.1608%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.8446, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0578, Accuracy: 331/1513 (21.8771%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0348, Accuracy: 538/1513 (35.5585%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0560, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  53, local model 16, internal_epoch   1, Avg loss: 0.0577, Accuracy: 300/708 (42.3729%)
_Train Local_ResNet_18, epoch  53, local model 16, internal_epoch   2, Avg loss: 0.0331, Accuracy: 438/708 (61.8644%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.7724, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  53, local model 22, internal_epoch   1, Avg loss: 0.0450, Accuracy: 589/1470 (40.0680%)
_Train Local_ResNet_18, epoch  53, local model 22, internal_epoch   2, Avg loss: 0.0230, Accuracy: 896/1470 (60.9524%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.5098, Accuracy: 107/10000 (1.0700%)
time spent on training: 264.5255527496338
[rfa agg] training data poison_ratio: 0.06726681670417604  data num: [1750, 1587, 568, 807, 1581, 440, 1573, 1513, 708, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.021020880220055015
[rfa agg] init. name: [44, 27, 62, 20, 28, 49, 40, 8, 16, 22], weight: tensor([0.1459, 0.1323, 0.0473, 0.0673, 0.1318, 0.0367, 0.1311, 0.1261, 0.0590,
        0.1225])
[rfa agg] iter:  0, prev_obj_val: 56.431312561035156, obj_val: 53.88728713989258, abs dis: 2.544025421142578
[rfa agg] iter: 0, weight: tensor([0.0976, 0.1361, 0.0257, 0.0587, 0.1352, 0.0168, 0.1346, 0.1565, 0.0448,
        0.1940])
[rfa agg] iter:  1, prev_obj_val: 53.88728713989258, obj_val: 53.88706970214844, abs dis: 0.000217437744140625
[rfa agg] iter: 1, weight: tensor([0.0953, 0.1375, 0.0226, 0.0502, 0.1365, 0.0148, 0.1359, 0.1613, 0.0386,
        0.2073])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3409, Accuracy: 82/10000 (0.8200%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 4.5823, Accuracy: 1872/9950 (18.8141%)
saving model
Done in 364.41411328315735 sec.
Server Epoch:54 choose agents : [38, 69, 16, 89, 47, 84, 8, 7, 93, 54].
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0562, Accuracy: 323/1131 (28.5588%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0278, Accuracy: 519/1131 (45.8886%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.2459, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   1, Avg loss: 0.0579, Accuracy: 280/590 (47.4576%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   2, Avg loss: 0.0329, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 12.7512, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   1, Avg loss: 0.0583, Accuracy: 292/708 (41.2429%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   2, Avg loss: 0.0330, Accuracy: 431/708 (60.8757%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.1526, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  54, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 318/896 (35.4911%)
_Train Local_ResNet_18, epoch  54, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 432/896 (48.2143%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.0764, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1178, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1028, Accuracy: 17/134 (12.6866%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3809, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  54, local model 84, internal_epoch   1, Avg loss: 0.0557, Accuracy: 345/1190 (28.9916%)
_Train Local_ResNet_18, epoch  54, local model 84, internal_epoch   2, Avg loss: 0.0296, Accuracy: 504/1190 (42.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.3411, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0564, Accuracy: 350/1513 (23.1328%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0342, Accuracy: 573/1513 (37.8718%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1648, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0515, Accuracy: 370/891 (41.5264%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0237, Accuracy: 478/891 (53.6476%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.7434, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  54, local model 93, internal_epoch   1, Avg loss: 0.0538, Accuracy: 427/1742 (24.5121%)
_Train Local_ResNet_18, epoch  54, local model 93, internal_epoch   2, Avg loss: 0.0296, Accuracy: 762/1742 (43.7428%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.2207, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  54, local model 54, internal_epoch   1, Avg loss: 0.0534, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  54, local model 54, internal_epoch   2, Avg loss: 0.0280, Accuracy: 463/1130 (40.9735%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.3341, Accuracy: 61/10000 (0.6100%)
time spent on training: 221.71882224082947
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 590, 708, 896, 134, 1190, 1513, 891, 1742, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 69, 16, 89, 47, 84, 8, 7, 93, 54], weight: tensor([0.1140, 0.0594, 0.0713, 0.0903, 0.0135, 0.1199, 0.1524, 0.0898, 0.1755,
        0.1139])
[rfa agg] iter:  0, prev_obj_val: 45.534297943115234, obj_val: 51.65227508544922, abs dis: 6.117977142333984
[rfa agg] iter: 0, weight: tensor([0.2498, 0.0241, 0.0401, 0.0826, 0.0027, 0.1567, 0.0613, 0.0822, 0.0452,
        0.2553])
[rfa agg] iter:  1, prev_obj_val: 51.65227508544922, obj_val: 55.42878341674805, abs dis: 3.776508331298828
[rfa agg] iter: 1, weight: tensor([0.1194, 0.0382, 0.0747, 0.2208, 0.0036, 0.0950, 0.0544, 0.2306, 0.0435,
        0.1197])
[rfa agg] iter:  2, prev_obj_val: 55.42878341674805, obj_val: 61.037879943847656, abs dis: 5.609096527099609
[rfa agg] iter: 2, weight: tensor([0.0667, 0.0353, 0.0809, 0.3014, 0.0029, 0.0566, 0.0363, 0.3230, 0.0299,
        0.0670])
[rfa agg] iter:  3, prev_obj_val: 61.037879943847656, obj_val: 58.04936218261719, abs dis: 2.9885177612304688
[rfa agg] iter: 3, weight: tensor([0.0698, 0.0607, 0.1834, 0.2341, 0.0042, 0.0615, 0.0429, 0.2371, 0.0364,
        0.0700])
[rfa agg] iter:  4, prev_obj_val: 58.04936218261719, obj_val: 64.1776123046875, abs dis: 6.1282501220703125
[rfa agg] iter: 4, weight: tensor([0.0664, 0.0450, 0.1184, 0.2864, 0.0034, 0.0576, 0.0387, 0.2849, 0.0323,
        0.0668])
[rfa agg] iter:  5, prev_obj_val: 64.1776123046875, obj_val: 58.079254150390625, abs dis: 6.098358154296875
[rfa agg] iter: 5, weight: tensor([0.0669, 0.0762, 0.2852, 0.1804, 0.0046, 0.0598, 0.0432, 0.1797, 0.0370,
        0.0671])
[rfa agg] iter:  6, prev_obj_val: 58.079254150390625, obj_val: 67.50096130371094, abs dis: 9.421707153320312
[rfa agg] iter: 6, weight: tensor([0.0676, 0.0458, 0.1226, 0.2846, 0.0035, 0.0586, 0.0393, 0.2772, 0.0329,
        0.0680])
[rfa agg] iter:  7, prev_obj_val: 67.50096130371094, obj_val: 67.42166137695312, abs dis: 0.0792999267578125
[rfa agg] iter: 7, weight: tensor([0.0616, 0.0944, 0.3636, 0.1407, 0.0049, 0.0557, 0.0415, 0.1399, 0.0359,
        0.0617])
[rfa agg] iter:  8, prev_obj_val: 67.42166137695312, obj_val: 74.76962280273438, abs dis: 7.34796142578125
[rfa agg] iter: 8, weight: tensor([0.0535, 0.0825, 0.4503, 0.1208, 0.0043, 0.0484, 0.0360, 0.1194, 0.0312,
        0.0536])
[rfa agg] iter:  9, prev_obj_val: 74.76962280273438, obj_val: 61.0501823425293, abs dis: 13.719440460205078
[rfa agg] iter: 9, weight: tensor([0.0648, 0.2148, 0.2671, 0.1173, 0.0068, 0.0598, 0.0469, 0.1162, 0.0414,
        0.0650])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3401, Accuracy: 86/10000 (0.8600%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 4.6114, Accuracy: 1470/9950 (14.7739%)
saving model
Done in 321.98151779174805 sec.
Server Epoch:55 choose agents : [88, 77, 16, 55, 79, 13, 61, 12, 27, 98].
_Train Local_ResNet_18, epoch  55, local model 88, internal_epoch   1, Avg loss: 0.0695, Accuracy: 168/603 (27.8607%)
_Train Local_ResNet_18, epoch  55, local model 88, internal_epoch   2, Avg loss: 0.0430, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.4946, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  55, local model 77, internal_epoch   1, Avg loss: 0.0482, Accuracy: 372/1340 (27.7612%)
_Train Local_ResNet_18, epoch  55, local model 77, internal_epoch   2, Avg loss: 0.0250, Accuracy: 627/1340 (46.7910%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.3231, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   1, Avg loss: 0.0551, Accuracy: 320/708 (45.1977%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   2, Avg loss: 0.0331, Accuracy: 433/708 (61.1582%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1110, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0493, Accuracy: 385/1071 (35.9477%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0268, Accuracy: 553/1071 (51.6340%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.0150, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  55, local model 79, internal_epoch   1, Avg loss: 0.1053, Accuracy: 7/197 (3.5533%)
_Train Local_ResNet_18, epoch  55, local model 79, internal_epoch   2, Avg loss: 0.0834, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.4797, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0535, Accuracy: 371/1645 (22.5532%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0302, Accuracy: 687/1645 (41.7629%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1925, Accuracy: 140/10000 (1.4000%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   1, Avg loss: 0.1303, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   2, Avg loss: 0.1220, Accuracy: 2/85 (2.3529%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3444, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0843, Accuracy: 35/338 (10.3550%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0460, Accuracy: 135/338 (39.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.9119, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 461/1587 (29.0485%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   2, Avg loss: 0.0318, Accuracy: 676/1587 (42.5961%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.8004, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  55, local model 98, internal_epoch   1, Avg loss: 0.0809, Accuracy: 33/373 (8.8472%)
_Train Local_ResNet_18, epoch  55, local model 98, internal_epoch   2, Avg loss: 0.0466, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.8707, Accuracy: 50/10000 (0.5000%)
time spent on training: 213.65470266342163
[rfa agg] training data poison_ratio: 0.0  data num: [603, 1340, 708, 1071, 197, 1645, 85, 338, 1587, 373]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 77, 16, 55, 79, 13, 61, 12, 27, 98], weight: tensor([0.0759, 0.1686, 0.0891, 0.1348, 0.0248, 0.2070, 0.0107, 0.0425, 0.1997,
        0.0469])
[rfa agg] iter:  0, prev_obj_val: 61.48930740356445, obj_val: 63.07744216918945, abs dis: 1.588134765625
[rfa agg] iter: 0, weight: tensor([0.0425, 0.1347, 0.0713, 0.5461, 0.0072, 0.0792, 0.0027, 0.0148, 0.0854,
        0.0163])
[rfa agg] iter:  1, prev_obj_val: 63.07744216918945, obj_val: 61.294254302978516, abs dis: 1.7831878662109375
[rfa agg] iter: 1, weight: tensor([0.0509, 0.1343, 0.0881, 0.5064, 0.0083, 0.0833, 0.0031, 0.0172, 0.0893,
        0.0189])
[rfa agg] iter:  2, prev_obj_val: 61.294254302978516, obj_val: 63.0867805480957, abs dis: 1.7925262451171875
[rfa agg] iter: 2, weight: tensor([0.0354, 0.1120, 0.0593, 0.6219, 0.0060, 0.0660, 0.0022, 0.0123, 0.0712,
        0.0136])
[rfa agg] iter:  3, prev_obj_val: 63.0867805480957, obj_val: 61.29285430908203, abs dis: 1.7939262390136719
[rfa agg] iter: 3, weight: tensor([0.0504, 0.1327, 0.0870, 0.5120, 0.0083, 0.0824, 0.0031, 0.0170, 0.0884,
        0.0187])
[rfa agg] iter:  4, prev_obj_val: 61.29285430908203, obj_val: 63.086997985839844, abs dis: 1.7941436767578125
[rfa agg] iter: 4, weight: tensor([0.0353, 0.1117, 0.0591, 0.6231, 0.0060, 0.0658, 0.0022, 0.0123, 0.0710,
        0.0135])
[rfa agg] iter:  5, prev_obj_val: 63.086997985839844, obj_val: 61.2928352355957, abs dis: 1.7941627502441406
[rfa agg] iter: 5, weight: tensor([0.0504, 0.1327, 0.0870, 0.5121, 0.0083, 0.0824, 0.0031, 0.0170, 0.0884,
        0.0187])
[rfa agg] iter:  6, prev_obj_val: 61.2928352355957, obj_val: 63.08699417114258, abs dis: 1.794158935546875
[rfa agg] iter: 6, weight: tensor([0.0353, 0.1117, 0.0591, 0.6231, 0.0060, 0.0658, 0.0022, 0.0123, 0.0710,
        0.0135])
[rfa agg] iter:  7, prev_obj_val: 63.08699417114258, obj_val: 61.2928352355957, abs dis: 1.794158935546875
[rfa agg] iter: 7, weight: tensor([0.0504, 0.1327, 0.0870, 0.5121, 0.0083, 0.0824, 0.0031, 0.0170, 0.0884,
        0.0187])
[rfa agg] iter:  8, prev_obj_val: 61.2928352355957, obj_val: 63.08699417114258, abs dis: 1.794158935546875
[rfa agg] iter: 8, weight: tensor([0.0353, 0.1117, 0.0591, 0.6231, 0.0060, 0.0658, 0.0022, 0.0123, 0.0710,
        0.0135])
[rfa agg] iter:  9, prev_obj_val: 63.08699417114258, obj_val: 61.2928352355957, abs dis: 1.794158935546875
[rfa agg] iter: 9, weight: tensor([0.0504, 0.1327, 0.0870, 0.5121, 0.0083, 0.0824, 0.0031, 0.0170, 0.0884,
        0.0187])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3425, Accuracy: 86/10000 (0.8600%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 4.6488, Accuracy: 971/9950 (9.7588%)
saving model
Done in 316.4114830493927 sec.
Server Epoch:56 choose agents : [41, 84, 47, 20, 89, 72, 45, 32, 26, 7].
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   1, Avg loss: 0.0587, Accuracy: 323/719 (44.9235%)
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   2, Avg loss: 0.0305, Accuracy: 467/719 (64.9513%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.3972, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   1, Avg loss: 0.0558, Accuracy: 349/1190 (29.3277%)
_Train Local_ResNet_18, epoch  56, local model 84, internal_epoch   2, Avg loss: 0.0292, Accuracy: 522/1190 (43.8655%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.7610, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   1, Avg loss: 0.1163, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   2, Avg loss: 0.1061, Accuracy: 8/134 (5.9701%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3732, Accuracy: 56/10000 (0.5600%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  56, local model 20, internal_epoch   1, Avg loss: 0.0553, Accuracy: 329/807 (40.7683%)
_Train Local_ResNet_18, epoch  56, local model 20, internal_epoch   2, Avg loss: 0.0305, Accuracy: 412/807 (51.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.2203, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  56, local model 89, internal_epoch   1, Avg loss: 0.0585, Accuracy: 331/896 (36.9420%)
_Train Local_ResNet_18, epoch  56, local model 89, internal_epoch   2, Avg loss: 0.0327, Accuracy: 463/896 (51.6741%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4509, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   1, Avg loss: 0.0565, Accuracy: 314/1241 (25.3022%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   2, Avg loss: 0.0348, Accuracy: 462/1241 (37.2280%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1315, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   1, Avg loss: 0.0639, Accuracy: 224/669 (33.4828%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   2, Avg loss: 0.0370, Accuracy: 365/669 (54.5590%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.1924, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   1, Avg loss: 0.0517, Accuracy: 265/735 (36.0544%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   2, Avg loss: 0.0196, Accuracy: 421/735 (57.2789%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 11.5916, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0544, Accuracy: 375/1446 (25.9336%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0332, Accuracy: 530/1446 (36.6528%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.5378, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  56, local model 7, internal_epoch   1, Avg loss: 0.0508, Accuracy: 365/891 (40.9652%)
_Train Local_ResNet_18, epoch  56, local model 7, internal_epoch   2, Avg loss: 0.0242, Accuracy: 466/891 (52.3008%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.8919, Accuracy: 76/10000 (0.7600%)
time spent on training: 242.34094882011414
[rfa agg] training data poison_ratio: 0.09246104491292392  data num: [719, 1190, 134, 807, 896, 1241, 669, 735, 1446, 891]
[rfa agg] considering poison per batch poison_fraction: 0.028894076535288728
[rfa agg] init. name: [41, 84, 47, 20, 89, 72, 45, 32, 26, 7], weight: tensor([0.0824, 0.1363, 0.0154, 0.0925, 0.1027, 0.1422, 0.0766, 0.0842, 0.1657,
        0.1021])
[rfa agg] iter:  0, prev_obj_val: 37.324485778808594, obj_val: 43.06065368652344, abs dis: 5.736167907714844
[rfa agg] iter: 0, weight: tensor([0.0947, 0.0468, 0.0028, 0.1986, 0.2031, 0.0415, 0.0566, 0.1010, 0.0332,
        0.2218])
[rfa agg] iter:  1, prev_obj_val: 43.06065368652344, obj_val: 46.14375305175781, abs dis: 3.083099365234375
[rfa agg] iter: 1, weight: tensor([0.2166, 0.0339, 0.0030, 0.1350, 0.0851, 0.0311, 0.1113, 0.2721, 0.0264,
        0.0856])
[rfa agg] iter:  2, prev_obj_val: 46.14375305175781, obj_val: 49.78771209716797, abs dis: 3.6439590454101562
[rfa agg] iter: 2, weight: tensor([0.2079, 0.0351, 0.0035, 0.1099, 0.0761, 0.0324, 0.1835, 0.2476, 0.0279,
        0.0761])
[rfa agg] iter:  3, prev_obj_val: 49.78771209716797, obj_val: 49.767059326171875, abs dis: 0.02065277099609375
[rfa agg] iter: 3, weight: tensor([0.1620, 0.0388, 0.0044, 0.1005, 0.0758, 0.0361, 0.2986, 0.1766, 0.0316,
        0.0758])
[rfa agg] iter:  4, prev_obj_val: 49.767059326171875, obj_val: 49.765174865722656, abs dis: 0.00188446044921875
[rfa agg] iter: 4, weight: tensor([0.1518, 0.0371, 0.0042, 0.0958, 0.0725, 0.0345, 0.3347, 0.1666, 0.0302,
        0.0726])
[rfa agg] iter:  5, prev_obj_val: 49.765174865722656, obj_val: 57.97686767578125, abs dis: 8.211692810058594
[rfa agg] iter: 5, weight: tensor([0.1483, 0.0365, 0.0041, 0.0941, 0.0712, 0.0340, 0.3473, 0.1633, 0.0297,
        0.0714])
[rfa agg] iter:  6, prev_obj_val: 57.97686767578125, obj_val: 46.15040588378906, abs dis: 11.826461791992188
[rfa agg] iter: 6, weight: tensor([0.1427, 0.0550, 0.0080, 0.1095, 0.0918, 0.0517, 0.2537, 0.1493, 0.0464,
        0.0917])
[rfa agg] iter:  7, prev_obj_val: 46.15040588378906, obj_val: 49.78186798095703, abs dis: 3.6314620971679688
[rfa agg] iter: 7, weight: tensor([0.1961, 0.0353, 0.0035, 0.1095, 0.0765, 0.0326, 0.2056, 0.2358, 0.0281,
        0.0769])
[rfa agg] iter:  8, prev_obj_val: 49.78186798095703, obj_val: 49.76658630371094, abs dis: 0.01528167724609375
[rfa agg] iter: 8, weight: tensor([0.1600, 0.0385, 0.0044, 0.0996, 0.0752, 0.0358, 0.3051, 0.1749, 0.0313,
        0.0752])
[rfa agg] iter:  9, prev_obj_val: 49.76658630371094, obj_val: 49.765113830566406, abs dis: 0.00147247314453125
[rfa agg] iter: 9, weight: tensor([0.1512, 0.0370, 0.0042, 0.0955, 0.0722, 0.0344, 0.3369, 0.1660, 0.0301,
        0.0724])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3421, Accuracy: 80/10000 (0.8000%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 4.5504, Accuracy: 1875/9950 (18.8442%)
saving model
Done in 337.4982886314392 sec.
Server Epoch:57 choose agents : [40, 56, 4, 32, 74, 75, 70, 88, 9, 35].
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 405/1573 (25.7470%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0340, Accuracy: 611/1573 (38.8430%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.8136, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.0836, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 67/186 (36.0215%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.4310, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   1, Avg loss: 0.0563, Accuracy: 353/901 (39.1787%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   2, Avg loss: 0.0332, Accuracy: 404/901 (44.8391%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.1756, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0497, Accuracy: 267/735 (36.3265%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0195, Accuracy: 410/735 (55.7823%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.4129, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0438, Accuracy: 538/1552 (34.6649%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0196, Accuracy: 858/1552 (55.2835%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.3320, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   1, Avg loss: 0.0602, Accuracy: 288/776 (37.1134%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   2, Avg loss: 0.0264, Accuracy: 426/776 (54.8969%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.3663, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0540, Accuracy: 466/1418 (32.8632%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0287, Accuracy: 702/1418 (49.5063%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.2036, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  57, local model 88, internal_epoch   1, Avg loss: 0.0690, Accuracy: 163/603 (27.0315%)
_Train Local_ResNet_18, epoch  57, local model 88, internal_epoch   2, Avg loss: 0.0438, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.8906, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   1, Avg loss: 0.0488, Accuracy: 382/1275 (29.9608%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   2, Avg loss: 0.0175, Accuracy: 752/1275 (58.9804%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.9743, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  57, local model 35, internal_epoch   1, Avg loss: 0.0884, Accuracy: 21/271 (7.7491%)
_Train Local_ResNet_18, epoch  57, local model 35, internal_epoch   2, Avg loss: 0.0540, Accuracy: 138/271 (50.9225%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.3519, Accuracy: 56/10000 (0.5600%)
time spent on training: 247.8126769065857
[rfa agg] training data poison_ratio: 0.0  data num: [1573, 186, 901, 735, 1552, 776, 1418, 603, 1275, 271]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [40, 56, 4, 32, 74, 75, 70, 88, 9, 35], weight: tensor([0.1693, 0.0200, 0.0970, 0.0791, 0.1671, 0.0835, 0.1526, 0.0649, 0.1372,
        0.0292])
[rfa agg] iter:  0, prev_obj_val: 54.444602966308594, obj_val: 56.742488861083984, abs dis: 2.2978858947753906
[rfa agg] iter: 0, weight: tensor([0.1024, 0.0070, 0.2187, 0.0764, 0.1011, 0.1001, 0.1227, 0.0450, 0.2148,
        0.0118])
[rfa agg] iter:  1, prev_obj_val: 56.742488861083984, obj_val: 57.94554901123047, abs dis: 1.2030601501464844
[rfa agg] iter: 1, weight: tensor([0.0802, 0.0066, 0.3392, 0.0837, 0.0792, 0.1162, 0.0928, 0.0461, 0.1445,
        0.0114])
[rfa agg] iter:  2, prev_obj_val: 57.94554901123047, obj_val: 61.08339309692383, abs dis: 3.1378440856933594
[rfa agg] iter: 2, weight: tensor([0.0630, 0.0057, 0.4456, 0.0790, 0.0622, 0.1145, 0.0719, 0.0417, 0.1065,
        0.0099])
[rfa agg] iter:  3, prev_obj_val: 61.08339309692383, obj_val: 63.04706573486328, abs dis: 1.9636726379394531
[rfa agg] iter: 3, weight: tensor([0.0514, 0.0056, 0.4421, 0.0977, 0.0507, 0.1612, 0.0571, 0.0457, 0.0788,
        0.0098])
[rfa agg] iter:  4, prev_obj_val: 63.04706573486328, obj_val: 63.02336883544922, abs dis: 0.0236968994140625
[rfa agg] iter: 4, weight: tensor([0.0538, 0.0064, 0.3051, 0.1317, 0.0531, 0.2436, 0.0592, 0.0563, 0.0794,
        0.0114])
[rfa agg] iter:  5, prev_obj_val: 63.02336883544922, obj_val: 65.05770111083984, abs dis: 2.034332275390625
[rfa agg] iter: 5, weight: tensor([0.0540, 0.0064, 0.2903, 0.1335, 0.0533, 0.2554, 0.0594, 0.0566, 0.0796,
        0.0114])
[rfa agg] iter:  6, prev_obj_val: 65.05770111083984, obj_val: 67.23469543457031, abs dis: 2.1769943237304688
[rfa agg] iter: 6, weight: tensor([0.0474, 0.0062, 0.1923, 0.1584, 0.0468, 0.3596, 0.0516, 0.0592, 0.0675,
        0.0111])
[rfa agg] iter:  7, prev_obj_val: 67.23469543457031, obj_val: 69.8090591430664, abs dis: 2.5743637084960938
[rfa agg] iter: 7, weight: tensor([0.0366, 0.0052, 0.1187, 0.1797, 0.0362, 0.4683, 0.0396, 0.0555, 0.0506,
        0.0095])
[rfa agg] iter:  8, prev_obj_val: 69.8090591430664, obj_val: 75.8760986328125, abs dis: 6.067039489746094
[rfa agg] iter: 8, weight: tensor([0.0369, 0.0057, 0.1007, 0.2874, 0.0364, 0.3638, 0.0395, 0.0694, 0.0496,
        0.0106])
[rfa agg] iter:  9, prev_obj_val: 75.8760986328125, obj_val: 69.80528259277344, abs dis: 6.0708160400390625
[rfa agg] iter: 9, weight: tensor([0.0421, 0.0079, 0.0909, 0.3861, 0.0416, 0.1796, 0.0446, 0.1380, 0.0541,
        0.0151])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3448, Accuracy: 73/10000 (0.7300%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 4.2806, Accuracy: 5263/9950 (52.8945%)
saving model
Done in 342.3827838897705 sec.
Server Epoch:58 choose agents : [34, 31, 89, 35, 74, 19, 27, 24, 33, 23].
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0555, Accuracy: 421/1427 (29.5025%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0314, Accuracy: 638/1427 (44.7092%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.2938, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0762, Accuracy: 81/460 (17.6087%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0354, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.3124, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  58, local model 89, internal_epoch   1, Avg loss: 0.0589, Accuracy: 339/896 (37.8348%)
_Train Local_ResNet_18, epoch  58, local model 89, internal_epoch   2, Avg loss: 0.0325, Accuracy: 445/896 (49.6652%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.1636, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   1, Avg loss: 0.0892, Accuracy: 9/271 (3.3210%)
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   2, Avg loss: 0.0536, Accuracy: 138/271 (50.9225%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.2016, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  58, local model 74, internal_epoch   1, Avg loss: 0.0440, Accuracy: 538/1552 (34.6649%)
_Train Local_ResNet_18, epoch  58, local model 74, internal_epoch   2, Avg loss: 0.0204, Accuracy: 816/1552 (52.5773%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 12.0874, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0468, Accuracy: 373/1036 (36.0039%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0244, Accuracy: 695/1036 (67.0849%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 12.0165, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   1, Avg loss: 0.0539, Accuracy: 424/1587 (26.7171%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   2, Avg loss: 0.0318, Accuracy: 673/1587 (42.4071%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.8148, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   1, Avg loss: 0.0794, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   2, Avg loss: 0.0403, Accuracy: 173/312 (55.4487%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.9400, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0786, Accuracy: 73/515 (14.1748%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0504, Accuracy: 158/515 (30.6796%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.4524, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0612, Accuracy: 289/715 (40.4196%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0372, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.2036, Accuracy: 68/10000 (0.6800%)
time spent on training: 243.72432661056519
[rfa agg] training data poison_ratio: 0.0  data num: [1427, 460, 896, 271, 1552, 1036, 1587, 312, 515, 715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [34, 31, 89, 35, 74, 19, 27, 24, 33, 23], weight: tensor([0.1627, 0.0524, 0.1022, 0.0309, 0.1769, 0.1181, 0.1809, 0.0356, 0.0587,
        0.0815])
[rfa agg] iter:  0, prev_obj_val: 59.32322311401367, obj_val: 61.74443054199219, abs dis: 2.4212074279785156
[rfa agg] iter: 0, weight: tensor([0.0928, 0.0263, 0.1964, 0.0113, 0.0787, 0.3870, 0.0805, 0.0130, 0.0336,
        0.0805])
[rfa agg] iter:  1, prev_obj_val: 61.74443054199219, obj_val: 66.42306518554688, abs dis: 4.6786346435546875
[rfa agg] iter: 1, weight: tensor([0.0804, 0.0297, 0.3504, 0.0123, 0.0701, 0.2281, 0.0717, 0.0141, 0.0387,
        0.1045])
[rfa agg] iter:  2, prev_obj_val: 66.42306518554688, obj_val: 70.77088928222656, abs dis: 4.3478240966796875
[rfa agg] iter: 2, weight: tensor([0.0547, 0.0305, 0.4864, 0.0117, 0.0492, 0.1065, 0.0504, 0.0134, 0.0414,
        0.1558])
[rfa agg] iter:  3, prev_obj_val: 70.77088928222656, obj_val: 73.05803680419922, abs dis: 2.2871475219726562
[rfa agg] iter: 3, weight: tensor([0.0580, 0.0436, 0.2491, 0.0155, 0.0531, 0.0973, 0.0543, 0.0178, 0.0618,
        0.3496])
[rfa agg] iter:  4, prev_obj_val: 73.05803680419922, obj_val: 73.02564239501953, abs dis: 0.0323944091796875
[rfa agg] iter: 4, weight: tensor([0.0476, 0.0421, 0.1594, 0.0142, 0.0439, 0.0755, 0.0449, 0.0164, 0.0618,
        0.4941])
[rfa agg] iter:  5, prev_obj_val: 73.02564239501953, obj_val: 81.41480255126953, abs dis: 8.38916015625
[rfa agg] iter: 5, weight: tensor([0.0416, 0.0367, 0.1373, 0.0124, 0.0383, 0.0658, 0.0392, 0.0143, 0.0538,
        0.5606])
[rfa agg] iter:  6, prev_obj_val: 81.41480255126953, obj_val: 78.51121520996094, abs dis: 2.9035873413085938
[rfa agg] iter: 6, weight: tensor([0.0633, 0.0999, 0.1398, 0.0273, 0.0594, 0.0879, 0.0608, 0.0314, 0.1722,
        0.2579])
[rfa agg] iter:  7, prev_obj_val: 78.51121520996094, obj_val: 75.7061767578125, abs dis: 2.8050384521484375
[rfa agg] iter: 7, weight: tensor([0.0618, 0.0791, 0.1527, 0.0235, 0.0577, 0.0893, 0.0590, 0.0270, 0.1293,
        0.3207])
[rfa agg] iter:  8, prev_obj_val: 75.7061767578125, obj_val: 75.69641876220703, abs dis: 0.00975799560546875
[rfa agg] iter: 8, weight: tensor([0.0542, 0.0572, 0.1530, 0.0183, 0.0503, 0.0819, 0.0515, 0.0210, 0.0879,
        0.4247])
[rfa agg] iter:  9, prev_obj_val: 75.69641876220703, obj_val: 75.69603729248047, abs dis: 0.0003814697265625
[rfa agg] iter: 9, weight: tensor([0.0524, 0.0552, 0.1475, 0.0176, 0.0487, 0.0791, 0.0498, 0.0203, 0.0845,
        0.4449])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3426, Accuracy: 74/10000 (0.7400%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 4.3059, Accuracy: 5000/9950 (50.2513%)
saving model
Done in 346.3815791606903 sec.
Server Epoch:59 choose agents : [69, 83, 6, 40, 21, 23, 97, 75, 53, 99].
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   1, Avg loss: 0.0591, Accuracy: 274/590 (46.4407%)
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   2, Avg loss: 0.0313, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.8153, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 465/1953 (23.8095%)
_Train Local_ResNet_18, epoch  59, local model 83, internal_epoch   2, Avg loss: 0.0317, Accuracy: 845/1953 (43.2668%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.7549, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   1, Avg loss: 0.0534, Accuracy: 419/1956 (21.4213%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   2, Avg loss: 0.0300, Accuracy: 706/1956 (36.0941%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.5834, Accuracy: 138/10000 (1.3800%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0541, Accuracy: 407/1573 (25.8741%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0337, Accuracy: 614/1573 (39.0337%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.4086, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0527, Accuracy: 418/1949 (21.4469%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0317, Accuracy: 679/1949 (34.8384%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3617, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0605, Accuracy: 303/715 (42.3776%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0366, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.4322, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  59, local model 97, internal_epoch   1, Avg loss: 0.0517, Accuracy: 349/1213 (28.7716%)
_Train Local_ResNet_18, epoch  59, local model 97, internal_epoch   2, Avg loss: 0.0258, Accuracy: 606/1213 (49.9588%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.1311, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  59, local model 75, internal_epoch   1, Avg loss: 0.0595, Accuracy: 289/776 (37.2423%)
_Train Local_ResNet_18, epoch  59, local model 75, internal_epoch   2, Avg loss: 0.0264, Accuracy: 438/776 (56.4433%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3383, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   1, Avg loss: 0.0474, Accuracy: 289/813 (35.5474%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 486/813 (59.7786%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 12.9612, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   1, Avg loss: 0.0555, Accuracy: 277/773 (35.8344%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   2, Avg loss: 0.0269, Accuracy: 444/773 (57.4386%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.1469, Accuracy: 96/10000 (0.9600%)
time spent on training: 285.9610483646393
[rfa agg] training data poison_ratio: 0.0  data num: [590, 1953, 1956, 1573, 1949, 715, 1213, 776, 813, 773]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [69, 83, 6, 40, 21, 23, 97, 75, 53, 99], weight: tensor([0.0479, 0.1586, 0.1589, 0.1278, 0.1583, 0.0581, 0.0985, 0.0630, 0.0660,
        0.0628])
[rfa agg] iter:  0, prev_obj_val: 74.37798309326172, obj_val: 78.02310943603516, abs dis: 3.6451263427734375
[rfa agg] iter: 0, weight: tensor([0.0256, 0.0769, 0.0769, 0.1349, 0.0767, 0.0386, 0.4246, 0.0479, 0.0503,
        0.0477])
[rfa agg] iter:  1, prev_obj_val: 78.02310943603516, obj_val: 79.7626953125, abs dis: 1.7395858764648438
[rfa agg] iter: 1, weight: tensor([0.0225, 0.0506, 0.0507, 0.0780, 0.0505, 0.0355, 0.5737, 0.0455, 0.0478,
        0.0452])
[rfa agg] iter:  2, prev_obj_val: 79.7626953125, obj_val: 83.3399429321289, abs dis: 3.5772476196289062
[rfa agg] iter: 2, weight: tensor([0.0297, 0.0605, 0.0605, 0.0899, 0.0603, 0.0476, 0.4630, 0.0620, 0.0652,
        0.0615])
[rfa agg] iter:  3, prev_obj_val: 83.3399429321289, obj_val: 83.32696533203125, abs dis: 0.01297760009765625
[rfa agg] iter: 3, weight: tensor([0.0417, 0.0691, 0.0692, 0.0971, 0.0690, 0.0702, 0.2945, 0.0950, 0.1000,
        0.0942])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3391, Accuracy: 78/10000 (0.7800%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 4.3499, Accuracy: 4602/9950 (46.2513%)
saving model
Done in 380.54339957237244 sec.
Server Epoch:60 choose agents : [51, 98, 53, 74, 42, 61, 12, 54, 70, 11].
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   1, Avg loss: 0.0553, Accuracy: 299/1049 (28.5033%)
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   2, Avg loss: 0.0267, Accuracy: 575/1049 (54.8141%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.8318, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  60, local model 98, internal_epoch   1, Avg loss: 0.0807, Accuracy: 32/373 (8.5791%)
_Train Local_ResNet_18, epoch  60, local model 98, internal_epoch   2, Avg loss: 0.0461, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.8184, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0474, Accuracy: 288/813 (35.4244%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 472/813 (58.0566%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 12.7712, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  60, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 577/1552 (37.1778%)
_Train Local_ResNet_18, epoch  60, local model 74, internal_epoch   2, Avg loss: 0.0196, Accuracy: 819/1552 (52.7706%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 11.5373, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0519, Accuracy: 339/1372 (24.7085%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0299, Accuracy: 577/1372 (42.0554%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.5797, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   1, Avg loss: 0.1310, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   2, Avg loss: 0.1223, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3430, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   1, Avg loss: 0.0844, Accuracy: 35/338 (10.3550%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   2, Avg loss: 0.0434, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.1768, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0529, Accuracy: 339/1130 (30.0000%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0279, Accuracy: 509/1130 (45.0442%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 10.3616, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   1, Avg loss: 0.0530, Accuracy: 457/1418 (32.2285%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   2, Avg loss: 0.0287, Accuracy: 712/1418 (50.2116%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.2598, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0516, Accuracy: 323/712 (45.3652%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0249, Accuracy: 433/712 (60.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.0145, Accuracy: 73/10000 (0.7300%)
time spent on training: 239.26551914215088
[rfa agg] training data poison_ratio: 0.0  data num: [1049, 373, 813, 1552, 1372, 85, 338, 1130, 1418, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [51, 98, 53, 74, 42, 61, 12, 54, 70, 11], weight: tensor([0.1186, 0.0422, 0.0919, 0.1755, 0.1552, 0.0096, 0.0382, 0.1278, 0.1604,
        0.0805])
[rfa agg] iter:  0, prev_obj_val: 50.41843795776367, obj_val: 52.372955322265625, abs dis: 1.9545173645019531
[rfa agg] iter: 0, weight: tensor([0.3248, 0.0153, 0.1090, 0.0705, 0.0931, 0.0025, 0.0139, 0.2163, 0.0824,
        0.0722])
[rfa agg] iter:  1, prev_obj_val: 52.372955322265625, obj_val: 52.37046813964844, abs dis: 0.0024871826171875
[rfa agg] iter: 1, weight: tensor([0.2859, 0.0176, 0.1414, 0.0731, 0.0941, 0.0028, 0.0160, 0.1952, 0.0842,
        0.0897])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3373, Accuracy: 84/10000 (0.8400%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 4.3883, Accuracy: 4290/9950 (43.1156%)
saving model
Saving model on epoch 60
Done in 345.87472796440125 sec.
Server Epoch:61 choose agents : [84, 20, 51, 25, 38, 6, 55, 53, 12, 69].
_Train Local_ResNet_18, epoch  61, local model 84, internal_epoch   1, Avg loss: 0.0568, Accuracy: 347/1190 (29.1597%)
_Train Local_ResNet_18, epoch  61, local model 84, internal_epoch   2, Avg loss: 0.0290, Accuracy: 540/1190 (45.3782%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.0634, Accuracy: 104/10000 (1.0400%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  61, local model 20, internal_epoch   1, Avg loss: 0.0540, Accuracy: 334/807 (41.3879%)
_Train Local_ResNet_18, epoch  61, local model 20, internal_epoch   2, Avg loss: 0.0299, Accuracy: 432/807 (53.5316%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.5027, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   1, Avg loss: 0.0529, Accuracy: 338/1049 (32.2212%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   2, Avg loss: 0.0256, Accuracy: 578/1049 (55.1001%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2636, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   1, Avg loss: 0.0545, Accuracy: 296/690 (42.8986%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   2, Avg loss: 0.0241, Accuracy: 470/690 (68.1159%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.0515, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   1, Avg loss: 0.0552, Accuracy: 330/1131 (29.1777%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   2, Avg loss: 0.0278, Accuracy: 549/1131 (48.5411%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.3587, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   1, Avg loss: 0.0523, Accuracy: 447/1956 (22.8528%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   2, Avg loss: 0.0297, Accuracy: 745/1956 (38.0879%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1856, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0463, Accuracy: 425/1071 (39.6825%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0261, Accuracy: 577/1071 (53.8749%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.7201, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   1, Avg loss: 0.0449, Accuracy: 336/813 (41.3284%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   2, Avg loss: 0.0178, Accuracy: 504/813 (61.9926%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 13.6675, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0840, Accuracy: 33/338 (9.7633%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0443, Accuracy: 141/338 (41.7160%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.1851, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   1, Avg loss: 0.0571, Accuracy: 292/590 (49.4915%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   2, Avg loss: 0.0294, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 11.5661, Accuracy: 50/10000 (0.5000%)
time spent on training: 256.82894587516785
[rfa agg] training data poison_ratio: 0.08375713544369487  data num: [1190, 807, 1049, 690, 1131, 1956, 1071, 813, 338, 590]
[rfa agg] considering poison per batch poison_fraction: 0.02617410482615465
[rfa agg] init. name: [84, 20, 51, 25, 38, 6, 55, 53, 12, 69], weight: tensor([0.1235, 0.0838, 0.1089, 0.0716, 0.1174, 0.2030, 0.1112, 0.0844, 0.0351,
        0.0612])
[rfa agg] iter:  0, prev_obj_val: 49.89582061767578, obj_val: 53.95266342163086, abs dis: 4.056842803955078
[rfa agg] iter: 0, weight: tensor([0.1110, 0.0763, 0.2234, 0.0399, 0.1529, 0.0379, 0.2433, 0.0769, 0.0098,
        0.0285])
[rfa agg] iter:  1, prev_obj_val: 53.95266342163086, obj_val: 58.94358444213867, abs dis: 4.9909210205078125
[rfa agg] iter: 1, weight: tensor([0.0915, 0.1708, 0.1402, 0.0681, 0.1113, 0.0417, 0.1452, 0.1715, 0.0140,
        0.0457])
[rfa agg] iter:  2, prev_obj_val: 58.94358444213867, obj_val: 64.20384979248047, abs dis: 5.260265350341797
[rfa agg] iter: 2, weight: tensor([0.0464, 0.3094, 0.0605, 0.0779, 0.0528, 0.0257, 0.0621, 0.3083, 0.0114,
        0.0455])
[rfa agg] iter:  3, prev_obj_val: 64.20384979248047, obj_val: 67.14106750488281, abs dis: 2.9372177124023438
[rfa agg] iter: 3, weight: tensor([0.0519, 0.2211, 0.0635, 0.1830, 0.0575, 0.0317, 0.0650, 0.2221, 0.0173,
        0.0869])
[rfa agg] iter:  4, prev_obj_val: 67.14106750488281, obj_val: 70.23867797851562, abs dis: 3.0976104736328125
[rfa agg] iter: 4, weight: tensor([0.0491, 0.1574, 0.0585, 0.2985, 0.0538, 0.0312, 0.0599, 0.1581, 0.0191,
        0.1144])
[rfa agg] iter:  5, prev_obj_val: 70.23867797851562, obj_val: 77.395263671875, abs dis: 7.156585693359375
[rfa agg] iter: 5, weight: tensor([0.0404, 0.1058, 0.0471, 0.4233, 0.0438, 0.0267, 0.0482, 0.1062, 0.0184,
        0.1401])
[rfa agg] iter:  6, prev_obj_val: 77.395263671875, obj_val: 81.30023193359375, abs dis: 3.90496826171875
[rfa agg] iter: 6, weight: tensor([0.0445, 0.0891, 0.0501, 0.2190, 0.0475, 0.0315, 0.0513, 0.0896, 0.0284,
        0.3490])
[rfa agg] iter:  7, prev_obj_val: 81.30023193359375, obj_val: 77.33949279785156, abs dis: 3.9607391357421875
[rfa agg] iter: 7, weight: tensor([0.0494, 0.0898, 0.0549, 0.1724, 0.0525, 0.0360, 0.0562, 0.0906, 0.0380,
        0.3600])
[rfa agg] iter:  8, prev_obj_val: 77.33949279785156, obj_val: 77.33421325683594, abs dis: 0.005279541015625
[rfa agg] iter: 8, weight: tensor([0.0393, 0.0784, 0.0443, 0.1807, 0.0420, 0.0278, 0.0454, 0.0792, 0.0251,
        0.4379])
[rfa agg] iter:  9, prev_obj_val: 77.33421325683594, obj_val: 81.3034896850586, abs dis: 3.9692764282226562
[rfa agg] iter: 9, weight: tensor([0.0373, 0.0743, 0.0419, 0.1706, 0.0398, 0.0263, 0.0430, 0.0751, 0.0238,
        0.4679])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3363, Accuracy: 79/10000 (0.7900%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 4.4109, Accuracy: 3936/9950 (39.5578%)
saving model
Done in 360.07195138931274 sec.
Server Epoch:62 choose agents : [83, 78, 24, 81, 4, 30, 93, 33, 69, 60].
_Train Local_ResNet_18, epoch  62, local model 83, internal_epoch   1, Avg loss: 0.0534, Accuracy: 471/1953 (24.1167%)
_Train Local_ResNet_18, epoch  62, local model 83, internal_epoch   2, Avg loss: 0.0315, Accuracy: 877/1953 (44.9053%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.8166, Accuracy: 143/10000 (1.4300%)
_Train Local_ResNet_18, epoch  62, local model 78, internal_epoch   1, Avg loss: 0.0754, Accuracy: 97/416 (23.3173%)
_Train Local_ResNet_18, epoch  62, local model 78, internal_epoch   2, Avg loss: 0.0402, Accuracy: 214/416 (51.4423%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.2777, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   1, Avg loss: 0.0795, Accuracy: 37/312 (11.8590%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 175/312 (56.0897%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.7213, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.0598, Accuracy: 261/774 (33.7209%)
_Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0328, Accuracy: 308/774 (39.7933%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.7623, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   1, Avg loss: 0.0587, Accuracy: 346/901 (38.4018%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 399/901 (44.2841%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.3062, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   1, Avg loss: 0.0731, Accuracy: 100/486 (20.5761%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   2, Avg loss: 0.0376, Accuracy: 216/486 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.5940, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  62, local model 93, internal_epoch   1, Avg loss: 0.0539, Accuracy: 433/1742 (24.8565%)
_Train Local_ResNet_18, epoch  62, local model 93, internal_epoch   2, Avg loss: 0.0297, Accuracy: 749/1742 (42.9966%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.3277, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   1, Avg loss: 0.0788, Accuracy: 71/515 (13.7864%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   2, Avg loss: 0.0514, Accuracy: 164/515 (31.8447%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.7984, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   1, Avg loss: 0.0505, Accuracy: 327/590 (55.4237%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 11.3335, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 662/2227 (29.7261%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0270, Accuracy: 1051/2227 (47.1935%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.4853, Accuracy: 123/10000 (1.2300%)
time spent on training: 270.3434808254242
[rfa agg] training data poison_ratio: 0.0  data num: [1953, 416, 312, 774, 901, 486, 1742, 515, 590, 2227]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [83, 78, 24, 81, 4, 30, 93, 33, 69, 60], weight: tensor([0.1970, 0.0420, 0.0315, 0.0781, 0.0909, 0.0490, 0.1757, 0.0519, 0.0595,
        0.2246])
[rfa agg] iter:  0, prev_obj_val: 95.23163604736328, obj_val: 96.09471893310547, abs dis: 0.8630828857421875
[rfa agg] iter: 0, weight: tensor([0.1809, 0.0300, 0.0196, 0.1001, 0.1583, 0.0379, 0.2253, 0.0436, 0.0547,
        0.1495])
[rfa agg] iter:  1, prev_obj_val: 96.09471893310547, obj_val: 96.96394348144531, abs dis: 0.8692245483398438
[rfa agg] iter: 1, weight: tensor([0.1720, 0.0311, 0.0202, 0.1068, 0.1733, 0.0393, 0.2107, 0.0454, 0.0572,
        0.1440])
[rfa agg] iter:  2, prev_obj_val: 96.96394348144531, obj_val: 98.70869445800781, abs dis: 1.7447509765625
[rfa agg] iter: 2, weight: tensor([0.1627, 0.0319, 0.0207, 0.1136, 0.1901, 0.0406, 0.1961, 0.0470, 0.0596,
        0.1378])
[rfa agg] iter:  3, prev_obj_val: 98.70869445800781, obj_val: 100.46328735351562, abs dis: 1.7545928955078125
[rfa agg] iter: 3, weight: tensor([0.1424, 0.0330, 0.0211, 0.1274, 0.2309, 0.0422, 0.1670, 0.0494, 0.0633,
        0.1231])
[rfa agg] iter:  4, prev_obj_val: 100.46328735351562, obj_val: 102.23934936523438, abs dis: 1.77606201171875
[rfa agg] iter: 4, weight: tensor([0.1193, 0.0327, 0.0206, 0.1403, 0.2885, 0.0422, 0.1367, 0.0499, 0.0648,
        0.1050])
[rfa agg] iter:  5, prev_obj_val: 102.23934936523438, obj_val: 105.21957397460938, abs dis: 2.980224609375
[rfa agg] iter: 5, weight: tensor([0.0915, 0.0298, 0.0185, 0.1475, 0.3809, 0.0389, 0.1029, 0.0466, 0.0616,
        0.0819])
[rfa agg] iter:  6, prev_obj_val: 105.21957397460938, obj_val: 110.16984558105469, abs dis: 4.9502716064453125
[rfa agg] iter: 6, weight: tensor([0.0426, 0.0181, 0.0109, 0.1273, 0.6202, 0.0242, 0.0468, 0.0299, 0.0410,
        0.0389])
[rfa agg] iter:  7, prev_obj_val: 110.16984558105469, obj_val: 110.04325866699219, abs dis: 0.1265869140625
[rfa agg] iter: 7, weight: tensor([0.0507, 0.0290, 0.0167, 0.3679, 0.2675, 0.0399, 0.0545, 0.0514, 0.0755,
        0.0471])
[rfa agg] iter:  8, prev_obj_val: 110.04325866699219, obj_val: 116.3918228149414, abs dis: 6.348564147949219
[rfa agg] iter: 8, weight: tensor([0.0460, 0.0263, 0.0151, 0.4393, 0.2288, 0.0364, 0.0495, 0.0469, 0.0688,
        0.0428])
[rfa agg] iter:  9, prev_obj_val: 116.3918228149414, obj_val: 114.07144165039062, abs dis: 2.3203811645507812
[rfa agg] iter: 9, weight: tensor([0.0513, 0.0412, 0.0222, 0.3504, 0.1464, 0.0602, 0.0543, 0.0840, 0.1416,
        0.0483])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3357, Accuracy: 83/10000 (0.8300%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 4.4248, Accuracy: 3754/9950 (37.7286%)
saving model
Done in 375.1897644996643 sec.
Server Epoch:63 choose agents : [18, 64, 38, 94, 55, 90, 58, 59, 66, 76].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0714, Accuracy: 137/530 (25.8491%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0367, Accuracy: 279/530 (52.6415%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.6041, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0606, Accuracy: 197/953 (20.6716%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0359, Accuracy: 340/953 (35.6768%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.7097, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0553, Accuracy: 343/1131 (30.3271%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0280, Accuracy: 505/1131 (44.6508%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.6016, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0532, Accuracy: 398/1662 (23.9471%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0308, Accuracy: 719/1662 (43.2611%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.4045, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   1, Avg loss: 0.0470, Accuracy: 396/1071 (36.9748%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   2, Avg loss: 0.0265, Accuracy: 541/1071 (50.5135%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.7610, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  63, local model 90, internal_epoch   1, Avg loss: 0.0559, Accuracy: 321/677 (47.4151%)
_Train Local_ResNet_18, epoch  63, local model 90, internal_epoch   2, Avg loss: 0.0205, Accuracy: 454/677 (67.0606%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 10.8588, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0588, Accuracy: 322/803 (40.0996%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 387/803 (48.1943%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.4679, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   1, Avg loss: 0.0487, Accuracy: 385/1089 (35.3535%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   2, Avg loss: 0.0252, Accuracy: 546/1089 (50.1377%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 11.0169, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   1, Avg loss: 0.0597, Accuracy: 263/1402 (18.7589%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   2, Avg loss: 0.0370, Accuracy: 427/1402 (30.4565%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.9426, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.0802, Accuracy: 76/466 (16.3090%)
_Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0442, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.2385, Accuracy: 51/10000 (0.5100%)
time spent on training: 286.9000587463379
[rfa agg] training data poison_ratio: 0.0  data num: [530, 953, 1131, 1662, 1071, 677, 803, 1089, 1402, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [18, 64, 38, 94, 55, 90, 58, 59, 66, 76], weight: tensor([0.0542, 0.0974, 0.1156, 0.1699, 0.1095, 0.0692, 0.0821, 0.1113, 0.1433,
        0.0476])
[rfa agg] iter:  0, prev_obj_val: 44.734615325927734, obj_val: 50.890357971191406, abs dis: 6.155742645263672
[rfa agg] iter: 0, weight: tensor([0.0238, 0.3868, 0.0986, 0.0407, 0.1360, 0.0454, 0.1036, 0.0934, 0.0538,
        0.0179])
[rfa agg] iter:  1, prev_obj_val: 50.890357971191406, obj_val: 55.917545318603516, abs dis: 5.027187347412109
[rfa agg] iter: 1, weight: tensor([0.0366, 0.1908, 0.0775, 0.0416, 0.0940, 0.0828, 0.3248, 0.0741, 0.0514,
        0.0264])
[rfa agg] iter:  2, prev_obj_val: 55.917545318603516, obj_val: 58.79924011230469, abs dis: 2.881694793701172
[rfa agg] iter: 2, weight: tensor([0.0472, 0.1171, 0.0641, 0.0387, 0.0741, 0.1351, 0.3835, 0.0614, 0.0463,
        0.0324])
[rfa agg] iter:  3, prev_obj_val: 58.79924011230469, obj_val: 58.79134750366211, abs dis: 0.007892608642578125
[rfa agg] iter: 3, weight: tensor([0.0621, 0.1111, 0.0666, 0.0423, 0.0757, 0.2194, 0.2677, 0.0639, 0.0499,
        0.0412])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3342, Accuracy: 84/10000 (0.8400%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 4.4109, Accuracy: 4019/9950 (40.3920%)
saving model
Done in 391.6149311065674 sec.
Server Epoch:64 choose agents : [77, 13, 57, 64, 48, 23, 71, 35, 32, 75].
_Train Local_ResNet_18, epoch  64, local model 77, internal_epoch   1, Avg loss: 0.0486, Accuracy: 360/1340 (26.8657%)
_Train Local_ResNet_18, epoch  64, local model 77, internal_epoch   2, Avg loss: 0.0248, Accuracy: 632/1340 (47.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.0338, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   1, Avg loss: 0.0538, Accuracy: 407/1645 (24.7416%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   2, Avg loss: 0.0302, Accuracy: 707/1645 (42.9787%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.1866, Accuracy: 142/10000 (1.4200%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   1, Avg loss: 0.0513, Accuracy: 327/1154 (28.3362%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   2, Avg loss: 0.0244, Accuracy: 528/1154 (45.7539%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.5731, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   1, Avg loss: 0.0604, Accuracy: 201/953 (21.0913%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   2, Avg loss: 0.0355, Accuracy: 351/953 (36.8311%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.8071, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   1, Avg loss: 0.0702, Accuracy: 136/631 (21.5531%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   2, Avg loss: 0.0400, Accuracy: 264/631 (41.8384%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.1569, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   1, Avg loss: 0.0599, Accuracy: 314/715 (43.9161%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   2, Avg loss: 0.0354, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.2983, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0557, Accuracy: 264/818 (32.2738%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0264, Accuracy: 456/818 (55.7457%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.2838, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.0879, Accuracy: 23/271 (8.4871%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0572, Accuracy: 121/271 (44.6494%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.1741, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   1, Avg loss: 0.0477, Accuracy: 295/735 (40.1361%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   2, Avg loss: 0.0193, Accuracy: 413/735 (56.1905%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.8894, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  64, local model 75, internal_epoch   1, Avg loss: 0.0564, Accuracy: 288/776 (37.1134%)
_Train Local_ResNet_18, epoch  64, local model 75, internal_epoch   2, Avg loss: 0.0265, Accuracy: 436/776 (56.1856%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.9113, Accuracy: 91/10000 (0.9100%)
time spent on training: 259.40794491767883
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 1645, 1154, 953, 631, 715, 818, 271, 735, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 13, 57, 64, 48, 23, 71, 35, 32, 75], weight: tensor([0.1483, 0.1820, 0.1277, 0.1054, 0.0698, 0.0791, 0.0905, 0.0300, 0.0813,
        0.0859])
[rfa agg] iter:  0, prev_obj_val: 45.06679916381836, obj_val: 51.65555953979492, abs dis: 6.5887603759765625
[rfa agg] iter: 0, weight: tensor([0.0571, 0.0399, 0.0702, 0.3529, 0.0390, 0.0770, 0.1410, 0.0080, 0.0803,
        0.1345])
[rfa agg] iter:  1, prev_obj_val: 51.65555953979492, obj_val: 58.02959060668945, abs dis: 6.374031066894531
[rfa agg] iter: 1, weight: tensor([0.0306, 0.0242, 0.0337, 0.0651, 0.0634, 0.2142, 0.1458, 0.0080, 0.2752,
        0.1398])
[rfa agg] iter:  2, prev_obj_val: 58.02959060668945, obj_val: 61.547271728515625, abs dis: 3.517681121826172
[rfa agg] iter: 2, weight: tensor([0.0407, 0.0334, 0.0437, 0.0719, 0.1718, 0.1852, 0.1204, 0.0138, 0.2048,
        0.1144])
[rfa agg] iter:  3, prev_obj_val: 61.547271728515625, obj_val: 61.53704833984375, abs dis: 0.010223388671875
[rfa agg] iter: 3, weight: tensor([0.0410, 0.0341, 0.0435, 0.0677, 0.3048, 0.1414, 0.1030, 0.0159, 0.1508,
        0.0977])
[rfa agg] iter:  4, prev_obj_val: 61.53704833984375, obj_val: 65.20246887207031, abs dis: 3.6654205322265625
[rfa agg] iter: 4, weight: tensor([0.0401, 0.0334, 0.0426, 0.0664, 0.3213, 0.1372, 0.1007, 0.0155, 0.1472,
        0.0956])
[rfa agg] iter:  5, prev_obj_val: 65.20246887207031, obj_val: 69.20845794677734, abs dis: 4.005989074707031
[rfa agg] iter: 5, weight: tensor([0.0340, 0.0287, 0.0357, 0.0530, 0.4929, 0.0947, 0.0749, 0.0151, 0.0999,
        0.0711])
[rfa agg] iter:  6, prev_obj_val: 69.20845794677734, obj_val: 65.18736267089844, abs dis: 4.021095275878906
[rfa agg] iter: 6, weight: tensor([0.0431, 0.0369, 0.0448, 0.0640, 0.4137, 0.1019, 0.0855, 0.0223, 0.1068,
        0.0810])
[rfa agg] iter:  7, prev_obj_val: 65.18736267089844, obj_val: 65.17637634277344, abs dis: 0.010986328125
[rfa agg] iter: 7, weight: tensor([0.0313, 0.0264, 0.0329, 0.0488, 0.5338, 0.0868, 0.0689, 0.0139, 0.0918,
        0.0654])
[rfa agg] iter:  8, prev_obj_val: 65.17637634277344, obj_val: 69.2168197631836, abs dis: 4.040443420410156
[rfa agg] iter: 8, weight: tensor([0.0276, 0.0234, 0.0290, 0.0431, 0.5890, 0.0763, 0.0608, 0.0123, 0.0809,
        0.0577])
[rfa agg] iter:  9, prev_obj_val: 69.2168197631836, obj_val: 65.18618774414062, abs dis: 4.030632019042969
[rfa agg] iter: 9, weight: tensor([0.0424, 0.0364, 0.0441, 0.0630, 0.4236, 0.0999, 0.0840, 0.0219, 0.1050,
        0.0797])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3348, Accuracy: 86/10000 (0.8600%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 4.3429, Accuracy: 4896/9950 (49.2060%)
saving model
Done in 363.8342390060425 sec.
Server Epoch:65 choose agents : [28, 37, 12, 15, 84, 30, 66, 73, 81, 11].
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 392/1581 (24.7944%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0317, Accuracy: 656/1581 (41.4927%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.8105, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0460, Accuracy: 557/1129 (49.3357%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0213, Accuracy: 784/1129 (69.4420%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.3617, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   1, Avg loss: 0.0842, Accuracy: 37/338 (10.9467%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   2, Avg loss: 0.0442, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.0884, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   1, Avg loss: 0.0556, Accuracy: 346/1154 (29.9827%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   2, Avg loss: 0.0277, Accuracy: 490/1154 (42.4610%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.4040, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  65, local model 84, internal_epoch   1, Avg loss: 0.0565, Accuracy: 337/1190 (28.3193%)
_Train Local_ResNet_18, epoch  65, local model 84, internal_epoch   2, Avg loss: 0.0289, Accuracy: 507/1190 (42.6050%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.2234, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   1, Avg loss: 0.0737, Accuracy: 92/486 (18.9300%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   2, Avg loss: 0.0365, Accuracy: 217/486 (44.6502%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.7426, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   1, Avg loss: 0.0601, Accuracy: 264/1402 (18.8302%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   2, Avg loss: 0.0372, Accuracy: 413/1402 (29.4579%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.9732, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   1, Avg loss: 0.0594, Accuracy: 228/938 (24.3070%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   2, Avg loss: 0.0315, Accuracy: 369/938 (39.3390%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.5366, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  65, local model 81, internal_epoch   1, Avg loss: 0.0592, Accuracy: 264/774 (34.1085%)
_Train Local_ResNet_18, epoch  65, local model 81, internal_epoch   2, Avg loss: 0.0324, Accuracy: 328/774 (42.3773%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.1653, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0506, Accuracy: 318/712 (44.6629%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 457/712 (64.1854%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 9.4127, Accuracy: 75/10000 (0.7500%)
time spent on training: 267.16117000579834
[rfa agg] training data poison_ratio: 0.0  data num: [1581, 1129, 338, 1154, 1190, 486, 1402, 938, 774, 712]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [28, 37, 12, 15, 84, 30, 66, 73, 81, 11], weight: tensor([0.1629, 0.1163, 0.0348, 0.1189, 0.1226, 0.0501, 0.1445, 0.0967, 0.0798,
        0.0734])
[rfa agg] iter:  0, prev_obj_val: 44.1839485168457, obj_val: 52.55270004272461, abs dis: 8.368751525878906
[rfa agg] iter: 0, weight: tensor([0.0518, 0.1309, 0.0111, 0.0997, 0.1033, 0.0202, 0.0670, 0.3603, 0.0931,
        0.0626])
[rfa agg] iter:  1, prev_obj_val: 52.55270004272461, obj_val: 57.905216217041016, abs dis: 5.352516174316406
[rfa agg] iter: 1, weight: tensor([0.0451, 0.0806, 0.0148, 0.0681, 0.0704, 0.0290, 0.0541, 0.1963, 0.2975,
        0.1442])
[rfa agg] iter:  2, prev_obj_val: 57.905216217041016, obj_val: 61.0361213684082, abs dis: 3.1309051513671875
[rfa agg] iter: 2, weight: tensor([0.0376, 0.0601, 0.0155, 0.0523, 0.0540, 0.0320, 0.0438, 0.1090, 0.3173,
        0.2785])
[rfa agg] iter:  3, prev_obj_val: 61.0361213684082, obj_val: 68.11669921875, abs dis: 7.080577850341797
[rfa agg] iter: 3, weight: tensor([0.0358, 0.0548, 0.0166, 0.0482, 0.0498, 0.0357, 0.0413, 0.0905, 0.2033,
        0.4240])
[rfa agg] iter:  4, prev_obj_val: 68.11669921875, obj_val: 57.902591705322266, abs dis: 10.214107513427734
[rfa agg] iter: 4, weight: tensor([0.0516, 0.0731, 0.0308, 0.0655, 0.0677, 0.0733, 0.0582, 0.1061, 0.1694,
        0.3043])
[rfa agg] iter:  5, prev_obj_val: 57.902591705322266, obj_val: 61.02638626098633, abs dis: 3.1237945556640625
[rfa agg] iter: 5, weight: tensor([0.0373, 0.0597, 0.0154, 0.0519, 0.0537, 0.0318, 0.0435, 0.1079, 0.2868,
        0.3120])
[rfa agg] iter:  6, prev_obj_val: 61.02638626098633, obj_val: 68.11795806884766, abs dis: 7.091571807861328
[rfa agg] iter: 6, weight: tensor([0.0351, 0.0536, 0.0163, 0.0472, 0.0487, 0.0349, 0.0404, 0.0886, 0.1969,
        0.4384])
[rfa agg] iter:  7, prev_obj_val: 68.11795806884766, obj_val: 57.90262985229492, abs dis: 10.215328216552734
[rfa agg] iter: 7, weight: tensor([0.0515, 0.0730, 0.0308, 0.0655, 0.0676, 0.0733, 0.0582, 0.1060, 0.1691,
        0.3050])
[rfa agg] iter:  8, prev_obj_val: 57.90262985229492, obj_val: 61.0263557434082, abs dis: 3.1237258911132812
[rfa agg] iter: 8, weight: tensor([0.0373, 0.0597, 0.0154, 0.0519, 0.0537, 0.0318, 0.0435, 0.1079, 0.2867,
        0.3121])
[rfa agg] iter:  9, prev_obj_val: 61.0263557434082, obj_val: 68.11795806884766, abs dis: 7.091602325439453
[rfa agg] iter: 9, weight: tensor([0.0351, 0.0536, 0.0163, 0.0472, 0.0487, 0.0349, 0.0404, 0.0886, 0.1968,
        0.4384])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3360, Accuracy: 78/10000 (0.7800%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 4.3312, Accuracy: 4385/9950 (44.0704%)
saving model
Done in 380.55499148368835 sec.
Server Epoch:66 choose agents : [89, 62, 94, 18, 81, 93, 91, 73, 7, 71].
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   1, Avg loss: 0.0590, Accuracy: 342/896 (38.1696%)
_Train Local_ResNet_18, epoch  66, local model 89, internal_epoch   2, Avg loss: 0.0321, Accuracy: 462/896 (51.5625%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.2468, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   1, Avg loss: 0.0686, Accuracy: 158/568 (27.8169%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.2666, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   1, Avg loss: 0.0532, Accuracy: 421/1662 (25.3309%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   2, Avg loss: 0.0309, Accuracy: 679/1662 (40.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.4582, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0725, Accuracy: 133/530 (25.0943%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0377, Accuracy: 288/530 (54.3396%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.6578, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  66, local model 81, internal_epoch   1, Avg loss: 0.0582, Accuracy: 290/774 (37.4677%)
_Train Local_ResNet_18, epoch  66, local model 81, internal_epoch   2, Avg loss: 0.0329, Accuracy: 346/774 (44.7028%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.4543, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0532, Accuracy: 417/1742 (23.9380%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0294, Accuracy: 759/1742 (43.5706%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.4923, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  66, local model 91, internal_epoch   1, Avg loss: 0.0491, Accuracy: 417/1030 (40.4854%)
_Train Local_ResNet_18, epoch  66, local model 91, internal_epoch   2, Avg loss: 0.0221, Accuracy: 688/1030 (66.7961%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.2042, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   1, Avg loss: 0.0581, Accuracy: 244/938 (26.0128%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   2, Avg loss: 0.0315, Accuracy: 367/938 (39.1258%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.5569, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   1, Avg loss: 0.0520, Accuracy: 363/891 (40.7407%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   2, Avg loss: 0.0246, Accuracy: 443/891 (49.7194%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.8116, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0558, Accuracy: 262/818 (32.0293%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0265, Accuracy: 438/818 (53.5452%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 9.1147, Accuracy: 101/10000 (1.0100%)
time spent on training: 263.91897559165955
[rfa agg] training data poison_ratio: 0.0  data num: [896, 568, 1662, 530, 774, 1742, 1030, 938, 891, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 62, 94, 18, 81, 93, 91, 73, 7, 71], weight: tensor([0.0910, 0.0577, 0.1687, 0.0538, 0.0786, 0.1769, 0.1046, 0.0952, 0.0905,
        0.0831])
[rfa agg] iter:  0, prev_obj_val: 51.051578521728516, obj_val: 52.13360595703125, abs dis: 1.0820274353027344
[rfa agg] iter: 0, weight: tensor([0.1443, 0.0228, 0.0414, 0.0213, 0.0781, 0.0365, 0.1504, 0.2839, 0.1384,
        0.0829])
[rfa agg] iter:  1, prev_obj_val: 52.13360595703125, obj_val: 62.079010009765625, abs dis: 9.945404052734375
[rfa agg] iter: 1, weight: tensor([0.2627, 0.0201, 0.0246, 0.0188, 0.1132, 0.0221, 0.0583, 0.1450, 0.2138,
        0.1214])
[rfa agg] iter:  2, prev_obj_val: 62.079010009765625, obj_val: 65.40650939941406, abs dis: 3.3274993896484375
[rfa agg] iter: 2, weight: tensor([0.1321, 0.0570, 0.0362, 0.0531, 0.1950, 0.0332, 0.0616, 0.0933, 0.1288,
        0.2098])
[rfa agg] iter:  3, prev_obj_val: 65.40650939941406, obj_val: 62.05110549926758, abs dis: 3.3554039001464844
[rfa agg] iter: 3, weight: tensor([0.1254, 0.0803, 0.0412, 0.0750, 0.1720, 0.0380, 0.0664, 0.0948, 0.1233,
        0.1836])
[rfa agg] iter:  4, prev_obj_val: 62.05110549926758, obj_val: 65.40669250488281, abs dis: 3.3555870056152344
[rfa agg] iter: 4, weight: tensor([0.1296, 0.0565, 0.0358, 0.0528, 0.1985, 0.0329, 0.0611, 0.0922, 0.1266,
        0.2138])
[rfa agg] iter:  5, prev_obj_val: 65.40669250488281, obj_val: 62.05109786987305, abs dis: 3.3555946350097656
[rfa agg] iter: 5, weight: tensor([0.1254, 0.0803, 0.0412, 0.0750, 0.1721, 0.0380, 0.0664, 0.0947, 0.1233,
        0.1837])
[rfa agg] iter:  6, prev_obj_val: 62.05109786987305, obj_val: 65.40669250488281, abs dis: 3.3555946350097656
[rfa agg] iter: 6, weight: tensor([0.1296, 0.0565, 0.0358, 0.0528, 0.1985, 0.0329, 0.0611, 0.0922, 0.1266,
        0.2138])
[rfa agg] iter:  7, prev_obj_val: 65.40669250488281, obj_val: 62.05109786987305, abs dis: 3.3555946350097656
[rfa agg] iter: 7, weight: tensor([0.1254, 0.0803, 0.0412, 0.0750, 0.1721, 0.0380, 0.0664, 0.0947, 0.1233,
        0.1837])
[rfa agg] iter:  8, prev_obj_val: 62.05109786987305, obj_val: 65.40669250488281, abs dis: 3.3555946350097656
[rfa agg] iter: 8, weight: tensor([0.1296, 0.0565, 0.0358, 0.0528, 0.1985, 0.0329, 0.0611, 0.0922, 0.1266,
        0.2138])
[rfa agg] iter:  9, prev_obj_val: 65.40669250488281, obj_val: 62.05109786987305, abs dis: 3.3555946350097656
[rfa agg] iter: 9, weight: tensor([0.1254, 0.0803, 0.0412, 0.0750, 0.1721, 0.0380, 0.0664, 0.0947, 0.1233,
        0.1837])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3361, Accuracy: 82/10000 (0.8200%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 4.3110, Accuracy: 4519/9950 (45.4171%)
saving model
Done in 361.2354588508606 sec.
Server Epoch:67 choose agents : [44, 83, 96, 56, 6, 74, 64, 39, 14, 77].
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   1, Avg loss: 0.0563, Accuracy: 453/1750 (25.8857%)
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   2, Avg loss: 0.0335, Accuracy: 757/1750 (43.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.7202, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  67, local model 83, internal_epoch   1, Avg loss: 0.0532, Accuracy: 477/1953 (24.4240%)
_Train Local_ResNet_18, epoch  67, local model 83, internal_epoch   2, Avg loss: 0.0312, Accuracy: 894/1953 (45.7757%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.9623, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.0805, Accuracy: 14/311 (4.5016%)
_Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0520, Accuracy: 137/311 (44.0514%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.2889, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.0825, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0665, Accuracy: 69/186 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.4389, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   1, Avg loss: 0.0519, Accuracy: 443/1956 (22.6483%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   2, Avg loss: 0.0292, Accuracy: 759/1956 (38.8037%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.4790, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  67, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 567/1552 (36.5335%)
_Train Local_ResNet_18, epoch  67, local model 74, internal_epoch   2, Avg loss: 0.0195, Accuracy: 817/1552 (52.6418%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 11.8137, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   1, Avg loss: 0.0598, Accuracy: 203/953 (21.3012%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   2, Avg loss: 0.0353, Accuracy: 343/953 (35.9916%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.6684, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   1, Avg loss: 0.0499, Accuracy: 319/1013 (31.4906%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   2, Avg loss: 0.0244, Accuracy: 567/1013 (55.9724%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.9717, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   1, Avg loss: 0.0566, Accuracy: 280/1013 (27.6407%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   2, Avg loss: 0.0316, Accuracy: 407/1013 (40.1777%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.9507, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  67, local model 77, internal_epoch   1, Avg loss: 0.0485, Accuracy: 387/1340 (28.8806%)
_Train Local_ResNet_18, epoch  67, local model 77, internal_epoch   2, Avg loss: 0.0248, Accuracy: 629/1340 (46.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.2350, Accuracy: 97/10000 (0.9700%)
time spent on training: 300.9302134513855
[rfa agg] training data poison_ratio: 0.0  data num: [1750, 1953, 311, 186, 1956, 1552, 953, 1013, 1013, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 83, 96, 56, 6, 74, 64, 39, 14, 77], weight: tensor([0.1455, 0.1624, 0.0259, 0.0155, 0.1626, 0.1290, 0.0792, 0.0842, 0.0842,
        0.1114])
[rfa agg] iter:  0, prev_obj_val: 59.715755462646484, obj_val: 66.96865844726562, abs dis: 7.252902984619141
[rfa agg] iter: 0, weight: tensor([0.1044, 0.0781, 0.0066, 0.0035, 0.0782, 0.1798, 0.0491, 0.0606, 0.0607,
        0.3789])
[rfa agg] iter:  1, prev_obj_val: 66.96865844726562, obj_val: 66.95867919921875, abs dis: 0.009979248046875
[rfa agg] iter: 1, weight: tensor([0.0828, 0.0684, 0.0087, 0.0046, 0.0685, 0.1131, 0.0846, 0.1141, 0.1148,
        0.3405])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3344, Accuracy: 80/10000 (0.8000%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 4.3356, Accuracy: 4268/9950 (42.8945%)
saving model
Done in 401.4298770427704 sec.
Server Epoch:68 choose agents : [21, 24, 59, 44, 83, 9, 17, 87, 52, 63].
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   1, Avg loss: 0.0524, Accuracy: 426/1949 (21.8574%)
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   2, Avg loss: 0.0315, Accuracy: 680/1949 (34.8897%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2291, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   1, Avg loss: 0.0803, Accuracy: 27/312 (8.6538%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   2, Avg loss: 0.0413, Accuracy: 163/312 (52.2436%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.9431, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   1, Avg loss: 0.0491, Accuracy: 376/1089 (34.5271%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   2, Avg loss: 0.0259, Accuracy: 522/1089 (47.9339%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 13.6561, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0561, Accuracy: 431/1750 (24.6286%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0328, Accuracy: 763/1750 (43.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6606, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0532, Accuracy: 481/1953 (24.6288%)
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0312, Accuracy: 868/1953 (44.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6744, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0483, Accuracy: 395/1275 (30.9804%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0174, Accuracy: 787/1275 (61.7255%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.7259, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0498, Accuracy: 430/1574 (27.3189%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0252, Accuracy: 745/1574 (47.3316%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.5760, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0568, Accuracy: 305/1131 (26.9673%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0302, Accuracy: 413/1131 (36.5164%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3446, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0510, Accuracy: 308/636 (48.4277%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0263, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.4103, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   1, Avg loss: 0.0515, Accuracy: 302/888 (34.0090%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   2, Avg loss: 0.0239, Accuracy: 484/888 (54.5045%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.5527, Accuracy: 89/10000 (0.8900%)
time spent on training: 300.1779429912567
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 312, 1089, 1750, 1953, 1275, 1574, 1131, 636, 888]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 24, 59, 44, 83, 9, 17, 87, 52, 63], weight: tensor([0.1552, 0.0248, 0.0867, 0.1394, 0.1555, 0.1015, 0.1253, 0.0901, 0.0506,
        0.0707])
[rfa agg] iter:  0, prev_obj_val: 59.628746032714844, obj_val: 62.16770553588867, abs dis: 2.538959503173828
[rfa agg] iter: 0, weight: tensor([0.0765, 0.0071, 0.1107, 0.1001, 0.0766, 0.2807, 0.1646, 0.1188, 0.0207,
        0.0441])
[rfa agg] iter:  1, prev_obj_val: 62.16770553588867, obj_val: 67.00297546386719, abs dis: 4.835269927978516
[rfa agg] iter: 1, weight: tensor([0.0433, 0.0051, 0.1162, 0.0534, 0.0434, 0.4787, 0.0765, 0.1316, 0.0156,
        0.0361])
[rfa agg] iter:  2, prev_obj_val: 67.00297546386719, obj_val: 68.92764282226562, abs dis: 1.9246673583984375
[rfa agg] iter: 2, weight: tensor([0.0391, 0.0058, 0.2126, 0.0462, 0.0392, 0.2035, 0.0605, 0.3254, 0.0188,
        0.0490])
[rfa agg] iter:  3, prev_obj_val: 68.92764282226562, obj_val: 74.43878936767578, abs dis: 5.511146545410156
[rfa agg] iter: 3, weight: tensor([0.0309, 0.0050, 0.2248, 0.0361, 0.0310, 0.1230, 0.0462, 0.4415, 0.0164,
        0.0452])
[rfa agg] iter:  4, prev_obj_val: 74.43878936767578, obj_val: 71.5158920288086, abs dis: 2.9228973388671875
[rfa agg] iter: 4, weight: tensor([0.0427, 0.0080, 0.2389, 0.0488, 0.0428, 0.1256, 0.0602, 0.3169, 0.0278,
        0.0882])
[rfa agg] iter:  5, prev_obj_val: 71.5158920288086, obj_val: 74.43241119384766, abs dis: 2.9165191650390625
[rfa agg] iter: 5, weight: tensor([0.0355, 0.0061, 0.2474, 0.0409, 0.0356, 0.1191, 0.0514, 0.3819, 0.0208,
        0.0612])
[rfa agg] iter:  6, prev_obj_val: 74.43241119384766, obj_val: 71.5160903930664, abs dis: 2.91632080078125
[rfa agg] iter: 6, weight: tensor([0.0428, 0.0080, 0.2431, 0.0489, 0.0429, 0.1259, 0.0603, 0.3120, 0.0278,
        0.0884])
[rfa agg] iter:  7, prev_obj_val: 71.5160903930664, obj_val: 74.43233489990234, abs dis: 2.9162445068359375
[rfa agg] iter: 7, weight: tensor([0.0355, 0.0062, 0.2487, 0.0410, 0.0356, 0.1192, 0.0515, 0.3804, 0.0208,
        0.0612])
[rfa agg] iter:  8, prev_obj_val: 74.43233489990234, obj_val: 71.51610565185547, abs dis: 2.916229248046875
[rfa agg] iter: 8, weight: tensor([0.0428, 0.0080, 0.2433, 0.0489, 0.0429, 0.1259, 0.0603, 0.3118, 0.0278,
        0.0884])
[rfa agg] iter:  9, prev_obj_val: 71.51610565185547, obj_val: 74.43234252929688, abs dis: 2.9162368774414062
[rfa agg] iter: 9, weight: tensor([0.0355, 0.0062, 0.2487, 0.0410, 0.0356, 0.1192, 0.0515, 0.3803, 0.0208,
        0.0612])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3326, Accuracy: 89/10000 (0.8900%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 4.3764, Accuracy: 3901/9950 (39.2060%)
saving model
Done in 396.8264183998108 sec.
Server Epoch:69 choose agents : [21, 31, 44, 89, 70, 80, 83, 5, 69, 75].
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0520, Accuracy: 456/1949 (23.3966%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0316, Accuracy: 676/1949 (34.6845%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.4454, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   1, Avg loss: 0.0759, Accuracy: 83/460 (18.0435%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   2, Avg loss: 0.0330, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.9860, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   1, Avg loss: 0.0550, Accuracy: 490/1750 (28.0000%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   2, Avg loss: 0.0336, Accuracy: 752/1750 (42.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.6895, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  69, local model 89, internal_epoch   1, Avg loss: 0.0584, Accuracy: 338/896 (37.7232%)
_Train Local_ResNet_18, epoch  69, local model 89, internal_epoch   2, Avg loss: 0.0317, Accuracy: 444/896 (49.5536%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.1808, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0532, Accuracy: 497/1418 (35.0494%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0284, Accuracy: 728/1418 (51.3399%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.1792, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  69, local model 80, internal_epoch   1, Avg loss: 0.0646, Accuracy: 169/682 (24.7801%)
_Train Local_ResNet_18, epoch  69, local model 80, internal_epoch   2, Avg loss: 0.0359, Accuracy: 275/682 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.5011, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0527, Accuracy: 504/1953 (25.8065%)
_Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0308, Accuracy: 914/1953 (46.7998%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.7149, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   1, Avg loss: 0.0493, Accuracy: 432/1628 (26.5356%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   2, Avg loss: 0.0233, Accuracy: 901/1628 (55.3440%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.1178, Accuracy: 141/10000 (1.4100%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0514, Accuracy: 317/590 (53.7288%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0293, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 11.8819, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 75, internal_epoch   1, Avg loss: 0.0573, Accuracy: 298/776 (38.4021%)
_Train Local_ResNet_18, epoch  69, local model 75, internal_epoch   2, Avg loss: 0.0262, Accuracy: 432/776 (55.6701%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.1218, Accuracy: 92/10000 (0.9200%)
time spent on training: 321.79121136665344
[rfa agg] training data poison_ratio: 0.0  data num: [1949, 460, 1750, 896, 1418, 682, 1953, 1628, 590, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [21, 31, 44, 89, 70, 80, 83, 5, 69, 75], weight: tensor([0.1610, 0.0380, 0.1446, 0.0740, 0.1172, 0.0564, 0.1614, 0.1345, 0.0488,
        0.0641])
[rfa agg] iter:  0, prev_obj_val: 70.0171890258789, obj_val: 68.0802001953125, abs dis: 1.9369888305664062
[rfa agg] iter: 0, weight: tensor([0.0976, 0.0178, 0.1249, 0.0640, 0.3270, 0.0343, 0.0978, 0.1611, 0.0269,
        0.0486])
[rfa agg] iter:  1, prev_obj_val: 68.0802001953125, obj_val: 68.0774154663086, abs dis: 0.00278472900390625
[rfa agg] iter: 1, weight: tensor([0.0906, 0.0151, 0.1185, 0.0527, 0.3830, 0.0288, 0.0908, 0.1574, 0.0227,
        0.0403])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3274, Accuracy: 88/10000 (0.8800%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 4.4208, Accuracy: 3600/9950 (36.1809%)
saving model
Done in 417.152813911438 sec.
Server Epoch:70 choose agents : [7, 74, 76, 0, 16, 9, 19, 97, 48, 66].
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   1, Avg loss: 0.0512, Accuracy: 370/891 (41.5264%)
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   2, Avg loss: 0.0244, Accuracy: 459/891 (51.5152%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.0868, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   1, Avg loss: 0.0421, Accuracy: 577/1552 (37.1778%)
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   2, Avg loss: 0.0191, Accuracy: 862/1552 (55.5412%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 11.8082, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  70, local model 76, internal_epoch   1, Avg loss: 0.0791, Accuracy: 74/466 (15.8798%)
_Train Local_ResNet_18, epoch  70, local model 76, internal_epoch   2, Avg loss: 0.0431, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.8323, Accuracy: 56/10000 (0.5600%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  70, local model 0, internal_epoch   1, Avg loss: 0.0572, Accuracy: 340/1657 (20.5190%)
_Train Local_ResNet_18, epoch  70, local model 0, internal_epoch   2, Avg loss: 0.0330, Accuracy: 540/1657 (32.5890%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.0520, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   1, Avg loss: 0.0558, Accuracy: 298/708 (42.0904%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   2, Avg loss: 0.0344, Accuracy: 438/708 (61.8644%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.5203, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   1, Avg loss: 0.0475, Accuracy: 410/1275 (32.1569%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   2, Avg loss: 0.0173, Accuracy: 771/1275 (60.4706%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.6486, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0474, Accuracy: 413/1036 (39.8649%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0222, Accuracy: 721/1036 (69.5946%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 11.8455, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0504, Accuracy: 351/1213 (28.9365%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0263, Accuracy: 559/1213 (46.0841%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.1134, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0679, Accuracy: 155/631 (24.5642%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0385, Accuracy: 283/631 (44.8494%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.4340, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0590, Accuracy: 281/1402 (20.0428%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0369, Accuracy: 431/1402 (30.7418%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.8895, Accuracy: 73/10000 (0.7300%)
time spent on training: 303.16473507881165
[rfa agg] training data poison_ratio: 0.15298679715631058  data num: [891, 1552, 466, 1657, 708, 1275, 1036, 1213, 631, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.04780837411134706
[rfa agg] init. name: [7, 74, 76, 0, 16, 9, 19, 97, 48, 66], weight: tensor([0.0823, 0.1433, 0.0430, 0.1530, 0.0654, 0.1177, 0.0957, 0.1120, 0.0583,
        0.1294])
[rfa agg] iter:  0, prev_obj_val: 46.87471389770508, obj_val: 53.08271408081055, abs dis: 6.208000183105469
[rfa agg] iter: 0, weight: tensor([0.0787, 0.0527, 0.0141, 0.0500, 0.0384, 0.1120, 0.3985, 0.1554, 0.0246,
        0.0758])
[rfa agg] iter:  1, prev_obj_val: 53.08271408081055, obj_val: 53.05720901489258, abs dis: 0.02550506591796875
[rfa agg] iter: 1, weight: tensor([0.1943, 0.0600, 0.0228, 0.0580, 0.0735, 0.1027, 0.2425, 0.1251, 0.0421,
        0.0789])
[rfa agg] iter:  2, prev_obj_val: 53.05720901489258, obj_val: 55.30168151855469, abs dis: 2.2444725036621094
[rfa agg] iter: 2, weight: tensor([0.2005, 0.0600, 0.0228, 0.0579, 0.0736, 0.1027, 0.2366, 0.1249, 0.0421,
        0.0789])
[rfa agg] iter:  3, prev_obj_val: 55.30168151855469, obj_val: 57.59088134765625, abs dis: 2.2891998291015625
[rfa agg] iter: 3, weight: tensor([0.2744, 0.0569, 0.0244, 0.0552, 0.0853, 0.0925, 0.1824, 0.1096, 0.0462,
        0.0732])
[rfa agg] iter:  4, prev_obj_val: 57.59088134765625, obj_val: 60.013362884521484, abs dis: 2.4224815368652344
[rfa agg] iter: 4, weight: tensor([0.3838, 0.0488, 0.0237, 0.0476, 0.0916, 0.0759, 0.1329, 0.0880, 0.0462,
        0.0616])
[rfa agg] iter:  5, prev_obj_val: 60.013362884521484, obj_val: 62.77175521850586, abs dis: 2.758392333984375
[rfa agg] iter: 5, weight: tensor([0.5005, 0.0387, 0.0213, 0.0379, 0.0939, 0.0579, 0.0926, 0.0660, 0.0432,
        0.0480])
[rfa agg] iter:  6, prev_obj_val: 62.77175521850586, obj_val: 57.579307556152344, abs dis: 5.192447662353516
[rfa agg] iter: 6, weight: tensor([0.4330, 0.0416, 0.0260, 0.0408, 0.1360, 0.0601, 0.0894, 0.0673, 0.0551,
        0.0507])
[rfa agg] iter:  7, prev_obj_val: 57.579307556152344, obj_val: 60.0057373046875, abs dis: 2.4264297485351562
[rfa agg] iter: 7, weight: tensor([0.4188, 0.0461, 0.0224, 0.0450, 0.0867, 0.0717, 0.1244, 0.0830, 0.0437,
        0.0582])
[rfa agg] iter:  8, prev_obj_val: 60.0057373046875, obj_val: 62.77338409423828, abs dis: 2.7676467895507812
[rfa agg] iter: 8, weight: tensor([0.5153, 0.0376, 0.0207, 0.0368, 0.0911, 0.0562, 0.0898, 0.0640, 0.0419,
        0.0466])
[rfa agg] iter:  9, prev_obj_val: 62.77338409423828, obj_val: 57.57942199707031, abs dis: 5.193962097167969
[rfa agg] iter: 9, weight: tensor([0.4359, 0.0414, 0.0259, 0.0406, 0.1352, 0.0598, 0.0889, 0.0670, 0.0549,
        0.0505])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3273, Accuracy: 94/10000 (0.9400%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 4.4580, Accuracy: 2877/9950 (28.9146%)
saving model
Done in 400.09744811058044 sec.
Server Epoch:71 choose agents : [49, 6, 74, 90, 82, 24, 33, 78, 18, 84].
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0736, Accuracy: 93/440 (21.1364%)
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0447, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.8489, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   1, Avg loss: 0.0519, Accuracy: 448/1956 (22.9039%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   2, Avg loss: 0.0295, Accuracy: 732/1956 (37.4233%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.2956, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  71, local model 74, internal_epoch   1, Avg loss: 0.0424, Accuracy: 560/1552 (36.0825%)
_Train Local_ResNet_18, epoch  71, local model 74, internal_epoch   2, Avg loss: 0.0198, Accuracy: 831/1552 (53.5438%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 12.5047, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  71, local model 90, internal_epoch   1, Avg loss: 0.0533, Accuracy: 326/677 (48.1536%)
_Train Local_ResNet_18, epoch  71, local model 90, internal_epoch   2, Avg loss: 0.0212, Accuracy: 441/677 (65.1403%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.5170, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  71, local model 82, internal_epoch   1, Avg loss: 0.0747, Accuracy: 86/500 (17.2000%)
_Train Local_ResNet_18, epoch  71, local model 82, internal_epoch   2, Avg loss: 0.0463, Accuracy: 211/500 (42.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.5227, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   1, Avg loss: 0.0778, Accuracy: 42/312 (13.4615%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   2, Avg loss: 0.0397, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.9666, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   1, Avg loss: 0.0762, Accuracy: 97/515 (18.8350%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   2, Avg loss: 0.0472, Accuracy: 167/515 (32.4272%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.1101, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  71, local model 78, internal_epoch   1, Avg loss: 0.0753, Accuracy: 110/416 (26.4423%)
_Train Local_ResNet_18, epoch  71, local model 78, internal_epoch   2, Avg loss: 0.0411, Accuracy: 218/416 (52.4038%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.3784, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0723, Accuracy: 137/530 (25.8491%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0355, Accuracy: 287/530 (54.1509%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.0168, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  71, local model 84, internal_epoch   1, Avg loss: 0.0563, Accuracy: 336/1190 (28.2353%)
_Train Local_ResNet_18, epoch  71, local model 84, internal_epoch   2, Avg loss: 0.0284, Accuracy: 524/1190 (44.0336%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.1380, Accuracy: 112/10000 (1.1200%)
time spent on training: 250.15590596199036
[rfa agg] training data poison_ratio: 0.0  data num: [440, 1956, 1552, 677, 500, 312, 515, 416, 530, 1190]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [49, 6, 74, 90, 82, 24, 33, 78, 18, 84], weight: tensor([0.0544, 0.2418, 0.1919, 0.0837, 0.0618, 0.0386, 0.0637, 0.0514, 0.0655,
        0.1471])
[rfa agg] iter:  0, prev_obj_val: 81.48649597167969, obj_val: 83.61211395263672, abs dis: 2.1256179809570312
[rfa agg] iter: 0, weight: tensor([0.0460, 0.1121, 0.1447, 0.1327, 0.0592, 0.0264, 0.0702, 0.0434, 0.0723,
        0.2931])
[rfa agg] iter:  1, prev_obj_val: 83.61211395263672, obj_val: 85.0561752319336, abs dis: 1.444061279296875
[rfa agg] iter: 1, weight: tensor([0.0541, 0.0990, 0.1211, 0.1912, 0.0716, 0.0298, 0.0882, 0.0511, 0.0908,
        0.2031])
[rfa agg] iter:  2, prev_obj_val: 85.0561752319336, obj_val: 88.25260925292969, abs dis: 3.1964340209960938
[rfa agg] iter: 2, weight: tensor([0.0562, 0.0833, 0.0990, 0.2524, 0.0764, 0.0299, 0.0980, 0.0530, 0.1010,
        0.1509])
[rfa agg] iter:  3, prev_obj_val: 88.25260925292969, obj_val: 96.77079772949219, abs dis: 8.5181884765625
[rfa agg] iter: 3, weight: tensor([0.0386, 0.0344, 0.0389, 0.5447, 0.0581, 0.0183, 0.0878, 0.0363, 0.0909,
        0.0521])
[rfa agg] iter:  4, prev_obj_val: 96.77079772949219, obj_val: 99.32927703857422, abs dis: 2.5584793090820312
[rfa agg] iter: 4, weight: tensor([0.0841, 0.0258, 0.0278, 0.0799, 0.2162, 0.0263, 0.2033, 0.0775, 0.2257,
        0.0335])
[rfa agg] iter:  5, prev_obj_val: 99.32927703857422, obj_val: 99.3044204711914, abs dis: 0.0248565673828125
[rfa agg] iter: 5, weight: tensor([0.1107, 0.0223, 0.0239, 0.0584, 0.3752, 0.0271, 0.1239, 0.1003, 0.1298,
        0.0283])
[rfa agg] iter:  6, prev_obj_val: 99.3044204711914, obj_val: 102.38169860839844, abs dis: 3.0772781372070312
[rfa agg] iter: 6, weight: tensor([0.0991, 0.0199, 0.0213, 0.0521, 0.4455, 0.0243, 0.1086, 0.0904, 0.1136,
        0.0252])
[rfa agg] iter:  7, prev_obj_val: 102.38169860839844, obj_val: 105.70665740966797, abs dis: 3.3249588012695312
[rfa agg] iter: 7, weight: tensor([0.2127, 0.0233, 0.0248, 0.0537, 0.2544, 0.0348, 0.0914, 0.1809, 0.0949,
        0.0289])
[rfa agg] iter:  8, prev_obj_val: 105.70665740966797, obj_val: 113.68042755126953, abs dis: 7.9737701416015625
[rfa agg] iter: 8, weight: tensor([0.3937, 0.0182, 0.0192, 0.0374, 0.1069, 0.0345, 0.0557, 0.2548, 0.0577,
        0.0220])
[rfa agg] iter:  9, prev_obj_val: 113.68042755126953, obj_val: 109.60090637207031, abs dis: 4.079521179199219
[rfa agg] iter: 9, weight: tensor([0.2052, 0.0372, 0.0388, 0.0641, 0.1171, 0.1430, 0.0805, 0.1876, 0.0831,
        0.0434])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3263, Accuracy: 94/10000 (0.9400%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 4.4839, Accuracy: 2442/9950 (24.5427%)
saving model
Done in 353.2743139266968 sec.
Server Epoch:72 choose agents : [31, 17, 64, 91, 34, 99, 4, 63, 22, 19].
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   1, Avg loss: 0.0759, Accuracy: 92/460 (20.0000%)
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   2, Avg loss: 0.0340, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.9838, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   1, Avg loss: 0.0490, Accuracy: 486/1574 (30.8767%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   2, Avg loss: 0.0250, Accuracy: 740/1574 (47.0140%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.7101, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   1, Avg loss: 0.0593, Accuracy: 223/953 (23.3998%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   2, Avg loss: 0.0356, Accuracy: 327/953 (34.3127%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.0560, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0489, Accuracy: 479/1030 (46.5049%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0231, Accuracy: 701/1030 (68.0583%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.3677, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   1, Avg loss: 0.0550, Accuracy: 432/1427 (30.2733%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   2, Avg loss: 0.0317, Accuracy: 611/1427 (42.8171%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.9312, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0558, Accuracy: 280/773 (36.2225%)
_Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0274, Accuracy: 430/773 (55.6274%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.2481, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   1, Avg loss: 0.0583, Accuracy: 343/901 (38.0688%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   2, Avg loss: 0.0303, Accuracy: 392/901 (43.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.8730, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0516, Accuracy: 274/888 (30.8559%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0239, Accuracy: 488/888 (54.9550%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.1102, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0443, Accuracy: 608/1470 (41.3605%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0226, Accuracy: 906/1470 (61.6327%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.0459, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0461, Accuracy: 455/1036 (43.9189%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0231, Accuracy: 718/1036 (69.3050%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 11.9909, Accuracy: 80/10000 (0.8000%)
time spent on training: 319.30578112602234
[rfa agg] training data poison_ratio: 0.0  data num: [460, 1574, 953, 1030, 1427, 773, 901, 888, 1470, 1036]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [31, 17, 64, 91, 34, 99, 4, 63, 22, 19], weight: tensor([0.0438, 0.1497, 0.0907, 0.0980, 0.1357, 0.0735, 0.0857, 0.0845, 0.1398,
        0.0986])
[rfa agg] iter:  0, prev_obj_val: 40.452850341796875, obj_val: 48.04462814331055, abs dis: 7.591777801513672
[rfa agg] iter: 0, weight: tensor([0.0130, 0.0396, 0.1815, 0.1704, 0.0460, 0.0573, 0.1667, 0.0955, 0.0474,
        0.1826])
[rfa agg] iter:  1, prev_obj_val: 48.04462814331055, obj_val: 54.577213287353516, abs dis: 6.532585144042969
[rfa agg] iter: 1, weight: tensor([0.0161, 0.0301, 0.1742, 0.0695, 0.0333, 0.1370, 0.1570, 0.2776, 0.0343,
        0.0708])
[rfa agg] iter:  2, prev_obj_val: 54.577213287353516, obj_val: 54.53363800048828, abs dis: 0.043575286865234375
[rfa agg] iter: 2, weight: tensor([0.0226, 0.0324, 0.1136, 0.0621, 0.0352, 0.3360, 0.1049, 0.1940, 0.0363,
        0.0629])
[rfa agg] iter:  3, prev_obj_val: 54.53363800048828, obj_val: 62.31600570678711, abs dis: 7.782367706298828
[rfa agg] iter: 3, weight: tensor([0.0206, 0.0295, 0.1026, 0.0565, 0.0321, 0.4005, 0.0950, 0.1731, 0.0330,
        0.0571])
[rfa agg] iter:  4, prev_obj_val: 62.31600570678711, obj_val: 51.102935791015625, abs dis: 11.213069915771484
[rfa agg] iter: 4, weight: tensor([0.0430, 0.0456, 0.1172, 0.0763, 0.0488, 0.2715, 0.1098, 0.1605, 0.0503,
        0.0771])
[rfa agg] iter:  5, prev_obj_val: 51.102935791015625, obj_val: 54.54780960083008, abs dis: 3.444873809814453
[rfa agg] iter: 5, weight: tensor([0.0186, 0.0305, 0.1314, 0.0635, 0.0334, 0.2499, 0.1206, 0.2533, 0.0344,
        0.0644])
[rfa agg] iter:  6, prev_obj_val: 54.54780960083008, obj_val: 54.530662536621094, abs dis: 0.017147064208984375
[rfa agg] iter: 6, weight: tensor([0.0216, 0.0308, 0.1076, 0.0591, 0.0335, 0.3694, 0.0994, 0.1842, 0.0345,
        0.0598])
[rfa agg] iter:  7, prev_obj_val: 54.530662536621094, obj_val: 62.31761932373047, abs dis: 7.786956787109375
[rfa agg] iter: 7, weight: tensor([0.0202, 0.0289, 0.1004, 0.0553, 0.0314, 0.4133, 0.0930, 0.1690, 0.0324,
        0.0560])
[rfa agg] iter:  8, prev_obj_val: 62.31761932373047, obj_val: 51.102962493896484, abs dis: 11.214656829833984
[rfa agg] iter: 8, weight: tensor([0.0429, 0.0456, 0.1171, 0.0763, 0.0488, 0.2721, 0.1097, 0.1603, 0.0502,
        0.0770])
[rfa agg] iter:  9, prev_obj_val: 51.102962493896484, obj_val: 54.547794342041016, abs dis: 3.4448318481445312
[rfa agg] iter: 9, weight: tensor([0.0186, 0.0305, 0.1314, 0.0635, 0.0334, 0.2500, 0.1206, 0.2532, 0.0344,
        0.0644])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3270, Accuracy: 106/10000 (1.0600%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 4.4689, Accuracy: 2623/9950 (26.3618%)
saving model
Done in 416.0087056159973 sec.
Server Epoch:73 choose agents : [27, 0, 34, 96, 4, 72, 81, 12, 59, 88].
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   1, Avg loss: 0.0548, Accuracy: 429/1587 (27.0321%)
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   2, Avg loss: 0.0321, Accuracy: 645/1587 (40.6427%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.6221, Accuracy: 60/10000 (0.6000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  73, local model 0, internal_epoch   1, Avg loss: 0.0561, Accuracy: 359/1657 (21.6657%)
_Train Local_ResNet_18, epoch  73, local model 0, internal_epoch   2, Avg loss: 0.0325, Accuracy: 595/1657 (35.9083%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.8815, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   1, Avg loss: 0.0557, Accuracy: 417/1427 (29.2221%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   2, Avg loss: 0.0314, Accuracy: 628/1427 (44.0084%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.8511, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.0805, Accuracy: 20/311 (6.4309%)
_Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0530, Accuracy: 136/311 (43.7299%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.1954, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0577, Accuracy: 355/901 (39.4007%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0294, Accuracy: 395/901 (43.8402%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.6054, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   1, Avg loss: 0.0570, Accuracy: 308/1241 (24.8187%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   2, Avg loss: 0.0345, Accuracy: 489/1241 (39.4037%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.7762, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0579, Accuracy: 303/774 (39.1473%)
_Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0317, Accuracy: 337/774 (43.5401%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.6792, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   1, Avg loss: 0.0834, Accuracy: 46/338 (13.6095%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   2, Avg loss: 0.0430, Accuracy: 140/338 (41.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.8824, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   1, Avg loss: 0.0549, Accuracy: 380/1089 (34.8944%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   2, Avg loss: 0.0241, Accuracy: 559/1089 (51.3315%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.4693, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  73, local model 88, internal_epoch   1, Avg loss: 0.0684, Accuracy: 170/603 (28.1924%)
_Train Local_ResNet_18, epoch  73, local model 88, internal_epoch   2, Avg loss: 0.0433, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3480, Accuracy: 61/10000 (0.6100%)
time spent on training: 330.5905373096466
[rfa agg] training data poison_ratio: 0.1669016921837228  data num: [1587, 1657, 1427, 311, 901, 1241, 774, 338, 1089, 603]
[rfa agg] considering poison per batch poison_fraction: 0.05215677880741337
[rfa agg] init. name: [27, 0, 34, 96, 4, 72, 81, 12, 59, 88], weight: tensor([0.1599, 0.1669, 0.1437, 0.0313, 0.0908, 0.1250, 0.0780, 0.0340, 0.1097,
        0.0607])
[rfa agg] iter:  0, prev_obj_val: 52.857147216796875, obj_val: 56.35622024536133, abs dis: 3.499073028564453
[rfa agg] iter: 0, weight: tensor([0.0797, 0.0740, 0.0951, 0.0105, 0.1685, 0.1622, 0.0769, 0.0124, 0.2860,
        0.0347])
[rfa agg] iter:  1, prev_obj_val: 56.35622024536133, obj_val: 60.29240417480469, abs dis: 3.9361839294433594
[rfa agg] iter: 1, weight: tensor([0.0717, 0.0674, 0.0825, 0.0115, 0.2840, 0.1246, 0.1021, 0.0138, 0.2015,
        0.0408])
[rfa agg] iter:  2, prev_obj_val: 60.29240417480469, obj_val: 62.615692138671875, abs dis: 2.3232879638671875
[rfa agg] iter: 2, weight: tensor([0.0537, 0.0509, 0.0601, 0.0105, 0.4487, 0.0832, 0.1234, 0.0127, 0.1161,
        0.0407])
[rfa agg] iter:  3, prev_obj_val: 62.615692138671875, obj_val: 62.614105224609375, abs dis: 0.0015869140625
[rfa agg] iter: 3, weight: tensor([0.0517, 0.0492, 0.0572, 0.0112, 0.4349, 0.0765, 0.1592, 0.0136, 0.1009,
        0.0456])
[rfa agg] iter:  4, prev_obj_val: 62.614105224609375, obj_val: 65.19463348388672, abs dis: 2.5805282592773438
[rfa agg] iter: 4, weight: tensor([0.0518, 0.0493, 0.0573, 0.0112, 0.4328, 0.0766, 0.1607, 0.0136, 0.1009,
        0.0457])
[rfa agg] iter:  5, prev_obj_val: 65.19463348388672, obj_val: 65.17768859863281, abs dis: 0.01694488525390625
[rfa agg] iter: 5, weight: tensor([0.0560, 0.0536, 0.0614, 0.0134, 0.3123, 0.0798, 0.2474, 0.0164, 0.1014,
        0.0582])
[rfa agg] iter:  6, prev_obj_val: 65.17768859863281, obj_val: 67.83059692382812, abs dis: 2.6529083251953125
[rfa agg] iter: 6, weight: tensor([0.0562, 0.0538, 0.0616, 0.0135, 0.2993, 0.0801, 0.2589, 0.0165, 0.1018,
        0.0584])
[rfa agg] iter:  7, prev_obj_val: 67.83059692382812, obj_val: 67.81311798095703, abs dis: 0.01747894287109375
[rfa agg] iter: 7, weight: tensor([0.0520, 0.0499, 0.0565, 0.0138, 0.2092, 0.0716, 0.3772, 0.0170, 0.0883,
        0.0644])
[rfa agg] iter:  8, prev_obj_val: 67.81311798095703, obj_val: 67.81242370605469, abs dis: 0.00069427490234375
[rfa agg] iter: 8, weight: tensor([0.0502, 0.0482, 0.0545, 0.0133, 0.1975, 0.0691, 0.4036, 0.0164, 0.0851,
        0.0621])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3297, Accuracy: 101/10000 (1.0100%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 4.5034, Accuracy: 2116/9950 (21.2663%)
saving model
Done in 429.4867386817932 sec.
Server Epoch:74 choose agents : [9, 38, 0, 63, 50, 44, 1, 92, 93, 53].
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   1, Avg loss: 0.0468, Accuracy: 396/1275 (31.0588%)
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   2, Avg loss: 0.0172, Accuracy: 807/1275 (63.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 11.2869, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   1, Avg loss: 0.0556, Accuracy: 360/1131 (31.8302%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   2, Avg loss: 0.0270, Accuracy: 557/1131 (49.2485%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.1012, Accuracy: 104/10000 (1.0400%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0565, Accuracy: 370/1657 (22.3295%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0327, Accuracy: 558/1657 (33.6753%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.3932, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0486, Accuracy: 331/888 (37.2748%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0235, Accuracy: 479/888 (53.9414%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.5584, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0580, Accuracy: 231/809 (28.5538%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0242, Accuracy: 407/809 (50.3090%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.0614, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0550, Accuracy: 442/1750 (25.2571%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0331, Accuracy: 744/1750 (42.5143%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.4998, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   1, Avg loss: 0.0516, Accuracy: 373/928 (40.1940%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   2, Avg loss: 0.0206, Accuracy: 634/928 (68.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.3139, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0512, Accuracy: 503/1715 (29.3294%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0284, Accuracy: 844/1715 (49.2128%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.0056, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0532, Accuracy: 453/1742 (26.0046%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0290, Accuracy: 767/1742 (44.0299%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.1806, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   1, Avg loss: 0.0463, Accuracy: 318/813 (39.1144%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   2, Avg loss: 0.0180, Accuracy: 498/813 (61.2546%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 12.5268, Accuracy: 58/10000 (0.5800%)
time spent on training: 371.16488218307495
[rfa agg] training data poison_ratio: 0.13039030531948378  data num: [1275, 1131, 1657, 888, 809, 1750, 928, 1715, 1742, 813]
[rfa agg] considering poison per batch poison_fraction: 0.040746970412338684
[rfa agg] init. name: [9, 38, 0, 63, 50, 44, 1, 92, 93, 53], weight: tensor([0.1003, 0.0890, 0.1304, 0.0699, 0.0637, 0.1377, 0.0730, 0.1350, 0.1371,
        0.0640])
[rfa agg] iter:  0, prev_obj_val: 53.86436462402344, obj_val: 59.58940505981445, abs dis: 5.725040435791016
[rfa agg] iter: 0, weight: tensor([0.3867, 0.1883, 0.0716, 0.0454, 0.0351, 0.0580, 0.0574, 0.0644, 0.0578,
        0.0352])
[rfa agg] iter:  1, prev_obj_val: 59.58940505981445, obj_val: 63.52730941772461, abs dis: 3.9379043579101562
[rfa agg] iter: 1, weight: tensor([0.1453, 0.3714, 0.0564, 0.0725, 0.0517, 0.0483, 0.1022, 0.0523, 0.0481,
        0.0518])
[rfa agg] iter:  2, prev_obj_val: 63.52730941772461, obj_val: 70.04412078857422, abs dis: 6.516811370849609
[rfa agg] iter: 2, weight: tensor([0.1168, 0.2330, 0.0569, 0.1130, 0.0742, 0.0497, 0.1791, 0.0533, 0.0495,
        0.0744])
[rfa agg] iter:  3, prev_obj_val: 70.04412078857422, obj_val: 78.70106506347656, abs dis: 8.656944274902344
[rfa agg] iter: 3, weight: tensor([0.0630, 0.0921, 0.0375, 0.1920, 0.0956, 0.0335, 0.3220, 0.0356, 0.0334,
        0.0954])
[rfa agg] iter:  4, prev_obj_val: 78.70106506347656, obj_val: 82.20111846923828, abs dis: 3.5000534057617188
[rfa agg] iter: 4, weight: tensor([0.0423, 0.0539, 0.0287, 0.2624, 0.2083, 0.0262, 0.1250, 0.0275, 0.0261,
        0.1997])
[rfa agg] iter:  5, prev_obj_val: 82.20111846923828, obj_val: 82.1757583618164, abs dis: 0.025360107421875
[rfa agg] iter: 5, weight: tensor([0.0364, 0.0450, 0.0256, 0.1619, 0.2979, 0.0235, 0.0868, 0.0246, 0.0234,
        0.2748])
[rfa agg] iter:  6, prev_obj_val: 82.1757583618164, obj_val: 78.62754821777344, abs dis: 3.5482101440429688
[rfa agg] iter: 6, weight: tensor([0.0342, 0.0422, 0.0241, 0.1472, 0.3165, 0.0220, 0.0807, 0.0231, 0.0219,
        0.2880])
[rfa agg] iter:  7, prev_obj_val: 78.62754821777344, obj_val: 82.18910217285156, abs dis: 3.561553955078125
[rfa agg] iter: 7, weight: tensor([0.0393, 0.0499, 0.0267, 0.2380, 0.2376, 0.0243, 0.1080, 0.0256, 0.0242,
        0.2264])
[rfa agg] iter:  8, prev_obj_val: 82.18910217285156, obj_val: 82.17533111572266, abs dis: 0.01377105712890625
[rfa agg] iter: 8, weight: tensor([0.0356, 0.0440, 0.0251, 0.1571, 0.3040, 0.0229, 0.0846, 0.0241, 0.0228,
        0.2798])
[rfa agg] iter:  9, prev_obj_val: 82.17533111572266, obj_val: 78.62792205810547, abs dis: 3.5474090576171875
[rfa agg] iter: 9, weight: tensor([0.0341, 0.0420, 0.0240, 0.1464, 0.3177, 0.0219, 0.0803, 0.0230, 0.0219,
        0.2887])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3292, Accuracy: 106/10000 (1.0600%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 4.5419, Accuracy: 1766/9950 (17.7487%)
saving model
Done in 466.787481546402 sec.
Server Epoch:75 choose agents : [88, 65, 74, 85, 4, 55, 81, 12, 21, 64].
_Train Local_ResNet_18, epoch  75, local model 88, internal_epoch   1, Avg loss: 0.0685, Accuracy: 169/603 (28.0265%)
_Train Local_ResNet_18, epoch  75, local model 88, internal_epoch   2, Avg loss: 0.0415, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.5401, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0531, Accuracy: 441/1475 (29.8983%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0271, Accuracy: 757/1475 (51.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.6608, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0424, Accuracy: 547/1552 (35.2448%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0190, Accuracy: 853/1552 (54.9613%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.4656, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 480/1988 (24.1449%)
_Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0341, Accuracy: 731/1988 (36.7706%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.1532, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   1, Avg loss: 0.0537, Accuracy: 357/901 (39.6226%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   2, Avg loss: 0.0300, Accuracy: 413/901 (45.8380%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.7519, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   1, Avg loss: 0.0486, Accuracy: 401/1071 (37.4416%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   2, Avg loss: 0.0263, Accuracy: 559/1071 (52.1942%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.8766, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  75, local model 81, internal_epoch   1, Avg loss: 0.0526, Accuracy: 321/774 (41.4729%)
_Train Local_ResNet_18, epoch  75, local model 81, internal_epoch   2, Avg loss: 0.0317, Accuracy: 354/774 (45.7364%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.9292, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   1, Avg loss: 0.0840, Accuracy: 35/338 (10.3550%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   2, Avg loss: 0.0446, Accuracy: 137/338 (40.5325%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.8814, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   1, Avg loss: 0.0523, Accuracy: 436/1949 (22.3704%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   2, Avg loss: 0.0311, Accuracy: 674/1949 (34.5818%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.3418, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0591, Accuracy: 212/953 (22.2455%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0350, Accuracy: 346/953 (36.3064%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.8048, Accuracy: 74/10000 (0.7400%)
time spent on training: 341.93636775016785
[rfa agg] training data poison_ratio: 0.0  data num: [603, 1475, 1552, 1988, 901, 1071, 774, 338, 1949, 953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [88, 65, 74, 85, 4, 55, 81, 12, 21, 64], weight: tensor([0.0520, 0.1271, 0.1337, 0.1713, 0.0776, 0.0923, 0.0667, 0.0291, 0.1680,
        0.0821])
[rfa agg] iter:  0, prev_obj_val: 67.19097137451172, obj_val: 69.84942626953125, abs dis: 2.6584548950195312
[rfa agg] iter: 0, weight: tensor([0.0299, 0.2112, 0.1767, 0.0898, 0.0845, 0.1561, 0.0536, 0.0121, 0.0964,
        0.0897])
[rfa agg] iter:  1, prev_obj_val: 69.84942626953125, obj_val: 72.68869018554688, abs dis: 2.839263916015625
[rfa agg] iter: 1, weight: tensor([0.0327, 0.1421, 0.1255, 0.0746, 0.1081, 0.2472, 0.0627, 0.0127, 0.0792,
        0.1152])
[rfa agg] iter:  2, prev_obj_val: 72.68869018554688, obj_val: 77.06803894042969, abs dis: 4.3793487548828125
[rfa agg] iter: 2, weight: tensor([0.0261, 0.0730, 0.0670, 0.0445, 0.1123, 0.4445, 0.0553, 0.0096, 0.0469,
        0.1208])
[rfa agg] iter:  3, prev_obj_val: 77.06803894042969, obj_val: 81.0302734375, abs dis: 3.9622344970703125
[rfa agg] iter: 3, weight: tensor([0.0285, 0.0521, 0.0489, 0.0353, 0.2042, 0.2801, 0.0712, 0.0096, 0.0369,
        0.2330])
[rfa agg] iter:  4, prev_obj_val: 81.0302734375, obj_val: 89.92036437988281, abs dis: 8.890090942382812
[rfa agg] iter: 4, weight: tensor([0.0248, 0.0337, 0.0320, 0.0241, 0.2816, 0.1067, 0.0749, 0.0078, 0.0251,
        0.3892])
[rfa agg] iter:  5, prev_obj_val: 89.92036437988281, obj_val: 81.06291961669922, abs dis: 8.857444763183594
[rfa agg] iter: 5, weight: tensor([0.0564, 0.0462, 0.0445, 0.0355, 0.1844, 0.0992, 0.2799, 0.0149, 0.0367,
        0.2024])
[rfa agg] iter:  6, prev_obj_val: 81.06291961669922, obj_val: 86.7461929321289, abs dis: 5.6832733154296875
[rfa agg] iter: 6, weight: tensor([0.0256, 0.0348, 0.0330, 0.0249, 0.2811, 0.1077, 0.0795, 0.0080, 0.0260,
        0.3794])
[rfa agg] iter:  7, prev_obj_val: 86.7461929321289, obj_val: 86.72738647460938, abs dis: 0.01880645751953125
[rfa agg] iter: 7, weight: tensor([0.0451, 0.0442, 0.0424, 0.0332, 0.2330, 0.1048, 0.1857, 0.0127, 0.0345,
        0.2645])
[rfa agg] iter:  8, prev_obj_val: 86.72738647460938, obj_val: 83.7132339477539, abs dis: 3.0141525268554688
[rfa agg] iter: 8, weight: tensor([0.0451, 0.0442, 0.0424, 0.0332, 0.2295, 0.1049, 0.1952, 0.0127, 0.0345,
        0.2582])
[rfa agg] iter:  9, prev_obj_val: 83.7132339477539, obj_val: 86.736083984375, abs dis: 3.0228500366210938
[rfa agg] iter: 9, weight: tensor([0.0328, 0.0380, 0.0363, 0.0279, 0.2738, 0.1016, 0.1167, 0.0098, 0.0290,
        0.3342])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3317, Accuracy: 111/10000 (1.1100%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 4.4307, Accuracy: 2755/9950 (27.6884%)
saving model
Done in 445.86163544654846 sec.
Server Epoch:76 choose agents : [5, 72, 10, 55, 83, 39, 17, 88, 92, 35].
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0471, Accuracy: 487/1628 (29.9140%)
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0229, Accuracy: 930/1628 (57.1253%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.3497, Accuracy: 164/10000 (1.6400%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   1, Avg loss: 0.0579, Accuracy: 318/1241 (25.6245%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   2, Avg loss: 0.0345, Accuracy: 457/1241 (36.8251%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.9714, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   1, Avg loss: 0.0548, Accuracy: 278/861 (32.2880%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   2, Avg loss: 0.0187, Accuracy: 490/861 (56.9106%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.4475, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   1, Avg loss: 0.0477, Accuracy: 402/1071 (37.5350%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   2, Avg loss: 0.0261, Accuracy: 566/1071 (52.8478%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.2349, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  76, local model 83, internal_epoch   1, Avg loss: 0.0520, Accuracy: 509/1953 (26.0625%)
_Train Local_ResNet_18, epoch  76, local model 83, internal_epoch   2, Avg loss: 0.0310, Accuracy: 889/1953 (45.5197%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.0144, Accuracy: 149/10000 (1.4900%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   1, Avg loss: 0.0500, Accuracy: 348/1013 (34.3534%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   2, Avg loss: 0.0238, Accuracy: 562/1013 (55.4788%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.7306, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   1, Avg loss: 0.0487, Accuracy: 495/1574 (31.4485%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   2, Avg loss: 0.0245, Accuracy: 760/1574 (48.2846%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.6947, Accuracy: 147/10000 (1.4700%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0683, Accuracy: 167/603 (27.6949%)
_Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0424, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.6229, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0509, Accuracy: 493/1715 (28.7464%)
_Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0283, Accuracy: 830/1715 (48.3965%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.0947, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   1, Avg loss: 0.0863, Accuracy: 33/271 (12.1771%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   2, Avg loss: 0.0562, Accuracy: 119/271 (43.9114%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.3067, Accuracy: 54/10000 (0.5400%)
time spent on training: 358.87454175949097
[rfa agg] training data poison_ratio: 0.0  data num: [1628, 1241, 861, 1071, 1953, 1013, 1574, 603, 1715, 271]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 72, 10, 55, 83, 39, 17, 88, 92, 35], weight: tensor([0.1365, 0.1040, 0.0722, 0.0898, 0.1637, 0.0849, 0.1319, 0.0505, 0.1438,
        0.0227])
[rfa agg] iter:  0, prev_obj_val: 54.602787017822266, obj_val: 57.60932540893555, abs dis: 3.0065383911132812
[rfa agg] iter: 0, weight: tensor([0.1148, 0.3415, 0.0438, 0.0939, 0.0696, 0.0716, 0.1379, 0.0196, 0.1013,
        0.0061])
[rfa agg] iter:  1, prev_obj_val: 57.60932540893555, obj_val: 59.12808609008789, abs dis: 1.5187606811523438
[rfa agg] iter: 1, weight: tensor([0.0726, 0.4576, 0.0454, 0.1190, 0.0495, 0.0826, 0.0828, 0.0185, 0.0664,
        0.0055])
[rfa agg] iter:  2, prev_obj_val: 59.12808609008789, obj_val: 62.37661361694336, abs dis: 3.2485275268554688
[rfa agg] iter: 2, weight: tensor([0.0755, 0.3640, 0.0557, 0.1617, 0.0532, 0.1069, 0.0850, 0.0219, 0.0697,
        0.0063])
[rfa agg] iter:  3, prev_obj_val: 62.37661361694336, obj_val: 65.96153259277344, abs dis: 3.584918975830078
[rfa agg] iter: 3, weight: tensor([0.0677, 0.1997, 0.0708, 0.2827, 0.0502, 0.1585, 0.0748, 0.0252, 0.0635,
        0.0070])
[rfa agg] iter:  4, prev_obj_val: 65.96153259277344, obj_val: 68.1891860961914, abs dis: 2.2276535034179688
[rfa agg] iter: 4, weight: tensor([0.0458, 0.1022, 0.0708, 0.4167, 0.0354, 0.2083, 0.0498, 0.0219, 0.0435,
        0.0057])
[rfa agg] iter:  5, prev_obj_val: 68.1891860961914, obj_val: 65.93866729736328, abs dis: 2.250518798828125
[rfa agg] iter: 5, weight: tensor([0.0422, 0.0853, 0.0811, 0.3600, 0.0333, 0.2837, 0.0456, 0.0229, 0.0403,
        0.0058])
[rfa agg] iter:  6, prev_obj_val: 65.93866729736328, obj_val: 70.78717803955078, abs dis: 4.8485107421875
[rfa agg] iter: 6, weight: tensor([0.0440, 0.0975, 0.0680, 0.4324, 0.0341, 0.2079, 0.0479, 0.0210, 0.0418,
        0.0055])
[rfa agg] iter:  7, prev_obj_val: 70.78717803955078, obj_val: 70.70579528808594, abs dis: 0.08138275146484375
[rfa agg] iter: 7, weight: tensor([0.0430, 0.0804, 0.1056, 0.2511, 0.0344, 0.3651, 0.0461, 0.0265, 0.0412,
        0.0065])
[rfa agg] iter:  8, prev_obj_val: 70.70579528808594, obj_val: 70.69429016113281, abs dis: 0.011505126953125
[rfa agg] iter: 8, weight: tensor([0.0390, 0.0731, 0.0972, 0.2091, 0.0313, 0.4412, 0.0419, 0.0241, 0.0374,
        0.0059])
[rfa agg] iter:  9, prev_obj_val: 70.69429016113281, obj_val: 79.91375732421875, abs dis: 9.219467163085938
[rfa agg] iter: 9, weight: tensor([0.0368, 0.0690, 0.0918, 0.1923, 0.0295, 0.4773, 0.0396, 0.0227, 0.0353,
        0.0056])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3329, Accuracy: 104/10000 (1.0400%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 4.4741, Accuracy: 2156/9950 (21.6683%)
saving model
Done in 459.423410654068 sec.
Server Epoch:77 choose agents : [61, 17, 99, 31, 50, 89, 71, 60, 94, 28].
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1300, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1227, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3361, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   1, Avg loss: 0.0486, Accuracy: 486/1574 (30.8767%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   2, Avg loss: 0.0247, Accuracy: 739/1574 (46.9504%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.9895, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  77, local model 99, internal_epoch   1, Avg loss: 0.0551, Accuracy: 299/773 (38.6805%)
_Train Local_ResNet_18, epoch  77, local model 99, internal_epoch   2, Avg loss: 0.0262, Accuracy: 451/773 (58.3441%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.5686, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   1, Avg loss: 0.0764, Accuracy: 79/460 (17.1739%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   2, Avg loss: 0.0343, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.7267, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   1, Avg loss: 0.0557, Accuracy: 241/809 (29.7899%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   2, Avg loss: 0.0241, Accuracy: 419/809 (51.7923%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.7622, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  77, local model 89, internal_epoch   1, Avg loss: 0.0563, Accuracy: 345/896 (38.5045%)
_Train Local_ResNet_18, epoch  77, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 439/896 (48.9955%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.2869, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   1, Avg loss: 0.0548, Accuracy: 284/818 (34.7188%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   2, Avg loss: 0.0261, Accuracy: 429/818 (52.4450%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.2279, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 719/2227 (32.2856%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0262, Accuracy: 1077/2227 (48.3610%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.2751, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0535, Accuracy: 397/1662 (23.8869%)
_Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0306, Accuracy: 715/1662 (43.0205%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.6359, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   1, Avg loss: 0.0556, Accuracy: 409/1581 (25.8697%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   2, Avg loss: 0.0318, Accuracy: 666/1581 (42.1252%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.2207, Accuracy: 77/10000 (0.7700%)
time spent on training: 333.58217215538025
[rfa agg] training data poison_ratio: 0.0  data num: [85, 1574, 773, 460, 809, 896, 818, 2227, 1662, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 17, 99, 31, 50, 89, 71, 60, 94, 28], weight: tensor([0.0078, 0.1446, 0.0710, 0.0423, 0.0743, 0.0823, 0.0751, 0.2046, 0.1527,
        0.1452])
[rfa agg] iter:  0, prev_obj_val: 72.9825668334961, obj_val: 75.58778381347656, abs dis: 2.6052169799804688
[rfa agg] iter: 0, weight: tensor([0.0030, 0.1970, 0.0695, 0.0242, 0.0729, 0.0939, 0.0736, 0.0939, 0.1742,
        0.1977])
[rfa agg] iter:  1, prev_obj_val: 75.58778381347656, obj_val: 74.27811431884766, abs dis: 1.3096694946289062
[rfa agg] iter: 1, weight: tensor([0.0033, 0.1715, 0.0842, 0.0275, 0.0883, 0.1168, 0.0892, 0.0915, 0.1556,
        0.1722])
[rfa agg] iter:  2, prev_obj_val: 74.27811431884766, obj_val: 74.27778625488281, abs dis: 0.00032806396484375
[rfa agg] iter: 2, weight: tensor([0.0032, 0.1842, 0.0768, 0.0260, 0.0805, 0.1050, 0.0813, 0.0931, 0.1651,
        0.1849])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3290, Accuracy: 110/10000 (1.1000%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 4.4730, Accuracy: 2204/9950 (22.1508%)
saving model
Done in 434.4965269565582 sec.
Server Epoch:78 choose agents : [1, 64, 48, 76, 98, 36, 26, 89, 18, 92].
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   1, Avg loss: 0.0504, Accuracy: 378/928 (40.7328%)
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   2, Avg loss: 0.0217, Accuracy: 616/928 (66.3793%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.5457, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0581, Accuracy: 218/953 (22.8751%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0349, Accuracy: 340/953 (35.6768%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.8352, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   1, Avg loss: 0.0666, Accuracy: 190/631 (30.1109%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   2, Avg loss: 0.0389, Accuracy: 291/631 (46.1173%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.3800, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   1, Avg loss: 0.0794, Accuracy: 65/466 (13.9485%)
_Train Local_ResNet_18, epoch  78, local model 76, internal_epoch   2, Avg loss: 0.0420, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.4798, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  78, local model 98, internal_epoch   1, Avg loss: 0.0817, Accuracy: 28/373 (7.5067%)
_Train Local_ResNet_18, epoch  78, local model 98, internal_epoch   2, Avg loss: 0.0467, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.8582, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0834, Accuracy: 73/408 (17.8922%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0487, Accuracy: 152/408 (37.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.1650, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 361/1446 (24.9654%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   2, Avg loss: 0.0326, Accuracy: 552/1446 (38.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.5117, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  78, local model 89, internal_epoch   1, Avg loss: 0.0567, Accuracy: 349/896 (38.9509%)
_Train Local_ResNet_18, epoch  78, local model 89, internal_epoch   2, Avg loss: 0.0320, Accuracy: 434/896 (48.4375%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.3691, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0714, Accuracy: 139/530 (26.2264%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0366, Accuracy: 287/530 (54.1509%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.1190, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  78, local model 92, internal_epoch   1, Avg loss: 0.0510, Accuracy: 519/1715 (30.2624%)
_Train Local_ResNet_18, epoch  78, local model 92, internal_epoch   2, Avg loss: 0.0283, Accuracy: 830/1715 (48.3965%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.5522, Accuracy: 99/10000 (0.9900%)
time spent on training: 284.0874831676483
[rfa agg] training data poison_ratio: 0.0  data num: [928, 953, 631, 466, 373, 408, 1446, 896, 530, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [1, 64, 48, 76, 98, 36, 26, 89, 18, 92], weight: tensor([0.1112, 0.1142, 0.0756, 0.0558, 0.0447, 0.0489, 0.1733, 0.1074, 0.0635,
        0.2055])
[rfa agg] iter:  0, prev_obj_val: 55.073883056640625, obj_val: 60.8721923828125, abs dis: 5.798309326171875
[rfa agg] iter: 0, weight: tensor([0.2443, 0.2988, 0.0360, 0.0185, 0.0114, 0.0141, 0.0439, 0.2725, 0.0249,
        0.0356])
[rfa agg] iter:  1, prev_obj_val: 60.8721923828125, obj_val: 64.57821655273438, abs dis: 3.706024169921875
[rfa agg] iter: 1, weight: tensor([0.1638, 0.1718, 0.1129, 0.0474, 0.0264, 0.0341, 0.0632, 0.2567, 0.0691,
        0.0545])
[rfa agg] iter:  2, prev_obj_val: 64.57821655273438, obj_val: 70.49908447265625, abs dis: 5.920867919921875
[rfa agg] iter: 2, weight: tensor([0.1290, 0.1341, 0.1962, 0.0657, 0.0338, 0.0451, 0.0625, 0.1746, 0.1039,
        0.0552])
[rfa agg] iter:  3, prev_obj_val: 70.49908447265625, obj_val: 78.56962585449219, abs dis: 8.070541381835938
[rfa agg] iter: 3, weight: tensor([0.0613, 0.0633, 0.4177, 0.0756, 0.0310, 0.0452, 0.0371, 0.0741, 0.1609,
        0.0337])
[rfa agg] iter:  4, prev_obj_val: 78.56962585449219, obj_val: 85.23949432373047, abs dis: 6.669868469238281
[rfa agg] iter: 4, weight: tensor([0.0486, 0.0501, 0.1406, 0.2321, 0.0506, 0.0905, 0.0341, 0.0555, 0.2662,
        0.0318])
[rfa agg] iter:  5, prev_obj_val: 85.23949432373047, obj_val: 81.73851013183594, abs dis: 3.5009841918945312
[rfa agg] iter: 5, weight: tensor([0.0438, 0.0451, 0.0882, 0.2591, 0.0859, 0.2423, 0.0332, 0.0488, 0.1223,
        0.0313])
[rfa agg] iter:  6, prev_obj_val: 81.73851013183594, obj_val: 85.23709106445312, abs dis: 3.4985809326171875
[rfa agg] iter: 6, weight: tensor([0.0414, 0.0427, 0.0962, 0.3789, 0.0579, 0.1239, 0.0303, 0.0467, 0.1535,
        0.0284])
[rfa agg] iter:  7, prev_obj_val: 85.23709106445312, obj_val: 81.73670959472656, abs dis: 3.5003814697265625
[rfa agg] iter: 7, weight: tensor([0.0431, 0.0444, 0.0867, 0.2747, 0.0845, 0.2360, 0.0326, 0.0481, 0.1191,
        0.0308])
[rfa agg] iter:  8, prev_obj_val: 81.73670959472656, obj_val: 85.237548828125, abs dis: 3.5008392333984375
[rfa agg] iter: 8, weight: tensor([0.0411, 0.0424, 0.0955, 0.3841, 0.0574, 0.1227, 0.0301, 0.0464, 0.1522,
        0.0282])
[rfa agg] iter:  9, prev_obj_val: 85.237548828125, obj_val: 81.73663330078125, abs dis: 3.50091552734375
[rfa agg] iter: 9, weight: tensor([0.0431, 0.0444, 0.0867, 0.2753, 0.0844, 0.2356, 0.0326, 0.0480, 0.1190,
        0.0308])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3257, Accuracy: 112/10000 (1.1200%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 4.4815, Accuracy: 2175/9950 (21.8593%)
saving model
Done in 394.7810332775116 sec.
Server Epoch:79 choose agents : [70, 34, 15, 96, 95, 25, 53, 86, 18, 52].
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   1, Avg loss: 0.0513, Accuracy: 521/1418 (36.7419%)
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   2, Avg loss: 0.0284, Accuracy: 733/1418 (51.6925%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.2705, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   1, Avg loss: 0.0555, Accuracy: 442/1427 (30.9741%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   2, Avg loss: 0.0311, Accuracy: 632/1427 (44.2887%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.8711, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   1, Avg loss: 0.0565, Accuracy: 347/1154 (30.0693%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   2, Avg loss: 0.0253, Accuracy: 575/1154 (49.8267%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.2964, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  79, local model 96, internal_epoch   1, Avg loss: 0.0812, Accuracy: 24/311 (7.7170%)
_Train Local_ResNet_18, epoch  79, local model 96, internal_epoch   2, Avg loss: 0.0523, Accuracy: 137/311 (44.0514%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.1951, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0535, Accuracy: 325/599 (54.2571%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0296, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 11.8785, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   1, Avg loss: 0.0539, Accuracy: 298/690 (43.1884%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   2, Avg loss: 0.0226, Accuracy: 478/690 (69.2754%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.9252, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   1, Avg loss: 0.0431, Accuracy: 343/813 (42.1894%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   2, Avg loss: 0.0180, Accuracy: 493/813 (60.6396%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 12.7887, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  79, local model 86, internal_epoch   1, Avg loss: 0.0596, Accuracy: 339/1003 (33.7986%)
_Train Local_ResNet_18, epoch  79, local model 86, internal_epoch   2, Avg loss: 0.0316, Accuracy: 420/1003 (41.8744%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.3186, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0697, Accuracy: 137/530 (25.8491%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0381, Accuracy: 283/530 (53.3962%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.7918, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0529, Accuracy: 299/636 (47.0126%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0270, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.8179, Accuracy: 62/10000 (0.6200%)
time spent on training: 268.938218832016
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 1427, 1154, 311, 599, 690, 813, 1003, 530, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 34, 15, 96, 95, 25, 53, 86, 18, 52], weight: tensor([0.1652, 0.1663, 0.1345, 0.0362, 0.0698, 0.0804, 0.0947, 0.1169, 0.0618,
        0.0741])
[rfa agg] iter:  0, prev_obj_val: 49.16983413696289, obj_val: 50.92115783691406, abs dis: 1.7513236999511719
[rfa agg] iter: 0, weight: tensor([0.0660, 0.0665, 0.0959, 0.0145, 0.0624, 0.0952, 0.2857, 0.2037, 0.0443,
        0.0658])
[rfa agg] iter:  1, prev_obj_val: 50.92115783691406, obj_val: 55.558834075927734, abs dis: 4.637676239013672
[rfa agg] iter: 1, weight: tensor([0.0422, 0.0424, 0.0569, 0.0116, 0.0586, 0.0993, 0.4896, 0.0986, 0.0392,
        0.0616])
[rfa agg] iter:  2, prev_obj_val: 55.558834075927734, obj_val: 62.173702239990234, abs dis: 6.6148681640625
[rfa agg] iter: 2, weight: tensor([0.0404, 0.0407, 0.0502, 0.0157, 0.1211, 0.2925, 0.1734, 0.0727, 0.0680,
        0.1253])
[rfa agg] iter:  3, prev_obj_val: 62.173702239990234, obj_val: 65.33361053466797, abs dis: 3.1599082946777344
[rfa agg] iter: 3, weight: tensor([0.0264, 0.0266, 0.0310, 0.0150, 0.2893, 0.1551, 0.0645, 0.0404, 0.1160,
        0.2357])
[rfa agg] iter:  4, prev_obj_val: 65.33361053466797, obj_val: 68.91481018066406, abs dis: 3.5811996459960938
[rfa agg] iter: 4, weight: tensor([0.0279, 0.0281, 0.0322, 0.0183, 0.2417, 0.1167, 0.0607, 0.0409, 0.2127,
        0.2207])
[rfa agg] iter:  5, prev_obj_val: 68.91481018066406, obj_val: 65.34031677246094, abs dis: 3.574493408203125
[rfa agg] iter: 5, weight: tensor([0.0285, 0.0287, 0.0324, 0.0218, 0.1538, 0.0944, 0.0565, 0.0403, 0.3880,
        0.1555])
[rfa agg] iter:  6, prev_obj_val: 65.34031677246094, obj_val: 65.3272933959961, abs dis: 0.01302337646484375
[rfa agg] iter: 6, weight: tensor([0.0277, 0.0278, 0.0319, 0.0182, 0.2238, 0.1146, 0.0602, 0.0406, 0.2404,
        0.2148])
[rfa agg] iter:  7, prev_obj_val: 65.3272933959961, obj_val: 65.32715606689453, abs dis: 0.0001373291015625
[rfa agg] iter: 7, weight: tensor([0.0277, 0.0279, 0.0320, 0.0182, 0.2321, 0.1153, 0.0603, 0.0406, 0.2250,
        0.2208])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3239, Accuracy: 118/10000 (1.1800%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 4.5075, Accuracy: 2119/9950 (21.2965%)
saving model
Done in 372.96940326690674 sec.
Server Epoch:80 choose agents : [90, 47, 51, 91, 87, 77, 74, 61, 97, 76].
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0519, Accuracy: 323/677 (47.7105%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0205, Accuracy: 451/677 (66.6174%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.9415, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   1, Avg loss: 0.1187, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   2, Avg loss: 0.1054, Accuracy: 20/134 (14.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3690, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   1, Avg loss: 0.0534, Accuracy: 332/1049 (31.6492%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   2, Avg loss: 0.0259, Accuracy: 592/1049 (56.4347%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.7047, Accuracy: 144/10000 (1.4400%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0463, Accuracy: 458/1030 (44.4660%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0230, Accuracy: 666/1030 (64.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.5076, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  80, local model 87, internal_epoch   1, Avg loss: 0.0539, Accuracy: 319/1131 (28.2051%)
_Train Local_ResNet_18, epoch  80, local model 87, internal_epoch   2, Avg loss: 0.0292, Accuracy: 471/1131 (41.6446%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.4203, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   1, Avg loss: 0.0465, Accuracy: 408/1340 (30.4478%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   2, Avg loss: 0.0242, Accuracy: 669/1340 (49.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.9747, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 577/1552 (37.1778%)
_Train Local_ResNet_18, epoch  80, local model 74, internal_epoch   2, Avg loss: 0.0196, Accuracy: 836/1552 (53.8660%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 11.2076, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   1, Avg loss: 0.1318, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   2, Avg loss: 0.1229, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3234, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  80, local model 97, internal_epoch   1, Avg loss: 0.0498, Accuracy: 365/1213 (30.0907%)
_Train Local_ResNet_18, epoch  80, local model 97, internal_epoch   2, Avg loss: 0.0258, Accuracy: 566/1213 (46.6612%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.0485, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0760, Accuracy: 89/466 (19.0987%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0408, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.1899, Accuracy: 56/10000 (0.5600%)
time spent on training: 267.7365345954895
[rfa agg] training data poison_ratio: 0.0  data num: [677, 134, 1049, 1030, 1131, 1340, 1552, 85, 1213, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 47, 51, 91, 87, 77, 74, 61, 97, 76], weight: tensor([0.0780, 0.0154, 0.1209, 0.1187, 0.1303, 0.1544, 0.1789, 0.0098, 0.1398,
        0.0537])
[rfa agg] iter:  0, prev_obj_val: 41.155609130859375, obj_val: 43.882198333740234, abs dis: 2.7265892028808594
[rfa agg] iter: 0, weight: tensor([0.0438, 0.0034, 0.2405, 0.2446, 0.1769, 0.0860, 0.0560, 0.0020, 0.1280,
        0.0189])
[rfa agg] iter:  1, prev_obj_val: 43.882198333740234, obj_val: 43.88151550292969, abs dis: 0.000682830810546875
[rfa agg] iter: 1, weight: tensor([0.0568, 0.0041, 0.2309, 0.2314, 0.1680, 0.0915, 0.0621, 0.0024, 0.1291,
        0.0237])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3235, Accuracy: 106/10000 (1.0600%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 4.5427, Accuracy: 1762/9950 (17.7085%)
saving model
Done in 375.10630321502686 sec.
Server Epoch:81 choose agents : [60, 92, 18, 24, 50, 96, 61, 90, 54, 15].
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0484, Accuracy: 750/2227 (33.6776%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0264, Accuracy: 1080/2227 (48.4957%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.4642, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 487/1715 (28.3965%)
_Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   2, Avg loss: 0.0283, Accuracy: 822/1715 (47.9300%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.9220, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0685, Accuracy: 161/530 (30.3774%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0344, Accuracy: 295/530 (55.6604%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.8201, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   1, Avg loss: 0.0779, Accuracy: 50/312 (16.0256%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   2, Avg loss: 0.0398, Accuracy: 176/312 (56.4103%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.0090, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0546, Accuracy: 277/809 (34.2398%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0236, Accuracy: 434/809 (53.6465%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.9839, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   1, Avg loss: 0.0815, Accuracy: 15/311 (4.8232%)
_Train Local_ResNet_18, epoch  81, local model 96, internal_epoch   2, Avg loss: 0.0526, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.3041, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1313, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1225, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3302, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0533, Accuracy: 320/677 (47.2674%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 431/677 (63.6632%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.4363, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0530, Accuracy: 350/1130 (30.9735%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0276, Accuracy: 518/1130 (45.8407%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.6327, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 335/1154 (29.0295%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0263, Accuracy: 497/1154 (43.0676%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.0098, Accuracy: 85/10000 (0.8500%)
time spent on training: 292.9040446281433
[rfa agg] training data poison_ratio: 0.0  data num: [2227, 1715, 530, 312, 809, 311, 85, 677, 1130, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 92, 18, 24, 50, 96, 61, 90, 54, 15], weight: tensor([0.2488, 0.1916, 0.0592, 0.0349, 0.0904, 0.0347, 0.0095, 0.0756, 0.1263,
        0.1289])
[rfa agg] iter:  0, prev_obj_val: 77.84838104248047, obj_val: 78.82642364501953, abs dis: 0.9780426025390625
[rfa agg] iter: 0, weight: tensor([0.0611, 0.0967, 0.0214, 0.0092, 0.0527, 0.0091, 0.0021, 0.0338, 0.2810,
        0.4329])
[rfa agg] iter:  1, prev_obj_val: 78.82642364501953, obj_val: 83.24053955078125, abs dis: 4.414115905761719
[rfa agg] iter: 1, weight: tensor([0.0427, 0.0618, 0.0192, 0.0078, 0.0521, 0.0078, 0.0017, 0.0314, 0.4657,
        0.3099])
[rfa agg] iter:  2, prev_obj_val: 83.24053955078125, obj_val: 83.22342681884766, abs dis: 0.01711273193359375
[rfa agg] iter: 2, weight: tensor([0.0633, 0.0856, 0.0371, 0.0143, 0.1187, 0.0142, 0.0031, 0.0643, 0.3700,
        0.2295])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3210, Accuracy: 113/10000 (1.1300%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 4.5449, Accuracy: 1870/9950 (18.7940%)
saving model
Done in 393.0913121700287 sec.
Server Epoch:82 choose agents : [59, 83, 37, 80, 61, 21, 47, 81, 13, 31].
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 403/1089 (37.0064%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0250, Accuracy: 538/1089 (49.4031%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 12.6019, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  82, local model 83, internal_epoch   1, Avg loss: 0.0524, Accuracy: 477/1953 (24.4240%)
_Train Local_ResNet_18, epoch  82, local model 83, internal_epoch   2, Avg loss: 0.0309, Accuracy: 884/1953 (45.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.8225, Accuracy: 146/10000 (1.4600%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   1, Avg loss: 0.0474, Accuracy: 545/1129 (48.2728%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   2, Avg loss: 0.0209, Accuracy: 791/1129 (70.0620%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.8790, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0650, Accuracy: 164/682 (24.0469%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0365, Accuracy: 238/682 (34.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.3053, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   1, Avg loss: 0.1320, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   2, Avg loss: 0.1231, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3256, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   1, Avg loss: 0.0516, Accuracy: 446/1949 (22.8835%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   2, Avg loss: 0.0312, Accuracy: 679/1949 (34.8384%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.4777, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   1, Avg loss: 0.1181, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   2, Avg loss: 0.1032, Accuracy: 11/134 (8.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3665, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   1, Avg loss: 0.0541, Accuracy: 326/774 (42.1189%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   2, Avg loss: 0.0301, Accuracy: 385/774 (49.7416%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.2200, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   1, Avg loss: 0.0529, Accuracy: 427/1645 (25.9574%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   2, Avg loss: 0.0295, Accuracy: 746/1645 (45.3495%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.3059, Accuracy: 133/10000 (1.3300%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   1, Avg loss: 0.0746, Accuracy: 93/460 (20.2174%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   2, Avg loss: 0.0358, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.3145, Accuracy: 56/10000 (0.5600%)
time spent on training: 326.42686915397644
[rfa agg] training data poison_ratio: 0.0  data num: [1089, 1953, 1129, 682, 85, 1949, 134, 774, 1645, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [59, 83, 37, 80, 61, 21, 47, 81, 13, 31], weight: tensor([0.1100, 0.1973, 0.1140, 0.0689, 0.0086, 0.1969, 0.0135, 0.0782, 0.1662,
        0.0465])
[rfa agg] iter:  0, prev_obj_val: 70.16633605957031, obj_val: 71.34596252441406, abs dis: 1.17962646484375
[rfa agg] iter: 0, weight: tensor([0.2052, 0.1204, 0.2227, 0.0421, 0.0028, 0.1201, 0.0046, 0.0595, 0.2007,
        0.0219])
[rfa agg] iter:  1, prev_obj_val: 71.34596252441406, obj_val: 73.65373992919922, abs dis: 2.3077774047851562
[rfa agg] iter: 1, weight: tensor([0.2523, 0.0957, 0.2819, 0.0409, 0.0026, 0.0954, 0.0043, 0.0594, 0.1468,
        0.0207])
[rfa agg] iter:  2, prev_obj_val: 73.65373992919922, obj_val: 78.86517333984375, abs dis: 5.211433410644531
[rfa agg] iter: 2, weight: tensor([0.3032, 0.0538, 0.4152, 0.0313, 0.0018, 0.0536, 0.0030, 0.0480, 0.0751,
        0.0151])
[rfa agg] iter:  3, prev_obj_val: 78.86517333984375, obj_val: 81.21260070800781, abs dis: 2.3474273681640625
[rfa agg] iter: 3, weight: tensor([0.2967, 0.0561, 0.3699, 0.0454, 0.0023, 0.0559, 0.0039, 0.0762, 0.0731,
        0.0205])
[rfa agg] iter:  4, prev_obj_val: 81.21260070800781, obj_val: 78.86570739746094, abs dis: 2.346893310546875
[rfa agg] iter: 4, weight: tensor([0.2790, 0.0637, 0.3193, 0.0582, 0.0028, 0.0635, 0.0047, 0.1019, 0.0815,
        0.0255])
[rfa agg] iter:  5, prev_obj_val: 78.86570739746094, obj_val: 76.68926239013672, abs dis: 2.1764450073242188
[rfa agg] iter: 5, weight: tensor([0.2995, 0.0566, 0.3635, 0.0459, 0.0023, 0.0565, 0.0039, 0.0772, 0.0739,
        0.0207])
[rfa agg] iter:  6, prev_obj_val: 76.68926239013672, obj_val: 78.86555480957031, abs dis: 2.1762924194335938
[rfa agg] iter: 6, weight: tensor([0.3077, 0.0483, 0.4187, 0.0349, 0.0018, 0.0482, 0.0031, 0.0567, 0.0644,
        0.0162])
[rfa agg] iter:  7, prev_obj_val: 78.86555480957031, obj_val: 81.21261596679688, abs dis: 2.3470611572265625
[rfa agg] iter: 7, weight: tensor([0.2975, 0.0560, 0.3695, 0.0454, 0.0023, 0.0558, 0.0038, 0.0761, 0.0731,
        0.0205])
[rfa agg] iter:  8, prev_obj_val: 81.21261596679688, obj_val: 78.86570739746094, abs dis: 2.3469085693359375
[rfa agg] iter: 8, weight: tensor([0.2791, 0.0636, 0.3192, 0.0582, 0.0028, 0.0635, 0.0047, 0.1019, 0.0815,
        0.0255])
[rfa agg] iter:  9, prev_obj_val: 78.86570739746094, obj_val: 76.68927001953125, abs dis: 2.1764373779296875
[rfa agg] iter: 9, weight: tensor([0.2995, 0.0566, 0.3635, 0.0459, 0.0023, 0.0565, 0.0039, 0.0772, 0.0739,
        0.0207])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3235, Accuracy: 122/10000 (1.2200%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 4.5535, Accuracy: 1875/9950 (18.8442%)
saving model
Done in 434.06000900268555 sec.
Server Epoch:83 choose agents : [43, 65, 33, 2, 36, 57, 45, 75, 94, 79].
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0597, Accuracy: 295/946 (31.1839%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0330, Accuracy: 365/946 (38.5835%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.3381, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0525, Accuracy: 461/1475 (31.2542%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0285, Accuracy: 739/1475 (50.1017%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.8521, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.0772, Accuracy: 90/515 (17.4757%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0498, Accuracy: 156/515 (30.2913%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.9821, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   1, Avg loss: 0.0614, Accuracy: 252/605 (41.6529%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   2, Avg loss: 0.0377, Accuracy: 330/605 (54.5455%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.0062, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   1, Avg loss: 0.0807, Accuracy: 79/408 (19.3627%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   2, Avg loss: 0.0475, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.0034, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   1, Avg loss: 0.0522, Accuracy: 331/1154 (28.6828%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   2, Avg loss: 0.0246, Accuracy: 509/1154 (44.1075%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.3816, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   1, Avg loss: 0.0640, Accuracy: 239/669 (35.7250%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   2, Avg loss: 0.0360, Accuracy: 369/669 (55.1570%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.0445, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  83, local model 75, internal_epoch   1, Avg loss: 0.0589, Accuracy: 287/776 (36.9845%)
_Train Local_ResNet_18, epoch  83, local model 75, internal_epoch   2, Avg loss: 0.0279, Accuracy: 436/776 (56.1856%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.7939, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0533, Accuracy: 432/1662 (25.9928%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0302, Accuracy: 710/1662 (42.7196%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.5461, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  83, local model 79, internal_epoch   1, Avg loss: 0.1075, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  83, local model 79, internal_epoch   2, Avg loss: 0.0880, Accuracy: 51/197 (25.8883%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.5266, Accuracy: 50/10000 (0.5000%)
time spent on training: 309.19503259658813
[rfa agg] training data poison_ratio: 0.0  data num: [946, 1475, 515, 605, 408, 1154, 669, 776, 1662, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 65, 33, 2, 36, 57, 45, 75, 94, 79], weight: tensor([0.1125, 0.1754, 0.0613, 0.0720, 0.0485, 0.1373, 0.0796, 0.0923, 0.1977,
        0.0234])
[rfa agg] iter:  0, prev_obj_val: 55.95077133178711, obj_val: 59.34067916870117, abs dis: 3.3899078369140625
[rfa agg] iter: 0, weight: tensor([0.4550, 0.0697, 0.0319, 0.0442, 0.0194, 0.1295, 0.0593, 0.1203, 0.0638,
        0.0069])
[rfa agg] iter:  1, prev_obj_val: 59.34067916870117, obj_val: 62.26369857788086, abs dis: 2.9230194091796875
[rfa agg] iter: 1, weight: tensor([0.2363, 0.0542, 0.0440, 0.0659, 0.0243, 0.0805, 0.0990, 0.3362, 0.0515,
        0.0080])
[rfa agg] iter:  2, prev_obj_val: 62.26369857788086, obj_val: 64.13941955566406, abs dis: 1.8757209777832031
[rfa agg] iter: 2, weight: tensor([0.1340, 0.0465, 0.0529, 0.0854, 0.0269, 0.0640, 0.1472, 0.3899, 0.0448,
        0.0084])
[rfa agg] iter:  3, prev_obj_val: 64.13941955566406, obj_val: 66.09947967529297, abs dis: 1.9600601196289062
[rfa agg] iter: 3, weight: tensor([0.1211, 0.0482, 0.0665, 0.1136, 0.0320, 0.0644, 0.2205, 0.2773, 0.0467,
        0.0097])
[rfa agg] iter:  4, prev_obj_val: 66.09947967529297, obj_val: 68.21855926513672, abs dis: 2.11907958984375
[rfa agg] iter: 4, weight: tensor([0.0985, 0.0436, 0.0748, 0.1391, 0.0335, 0.0567, 0.3210, 0.1805, 0.0425,
        0.0097])
[rfa agg] iter:  5, prev_obj_val: 68.21855926513672, obj_val: 70.6978530883789, abs dis: 2.4792938232421875
[rfa agg] iter: 5, weight: tensor([0.0733, 0.0356, 0.0782, 0.1645, 0.0319, 0.0451, 0.4111, 0.1167, 0.0348,
        0.0088])
[rfa agg] iter:  6, prev_obj_val: 70.6978530883789, obj_val: 73.43817901611328, abs dis: 2.740325927734375
[rfa agg] iter: 6, weight: tensor([0.0667, 0.0350, 0.1034, 0.2527, 0.0372, 0.0434, 0.3211, 0.0964, 0.0344,
        0.0097])
[rfa agg] iter:  7, prev_obj_val: 73.43817901611328, obj_val: 76.50282287597656, abs dis: 3.0646438598632812
[rfa agg] iter: 7, weight: tensor([0.0586, 0.0329, 0.1430, 0.3759, 0.0422, 0.0399, 0.1857, 0.0790, 0.0325,
        0.0103])
[rfa agg] iter:  8, prev_obj_val: 76.50282287597656, obj_val: 83.48037719726562, abs dis: 6.9775543212890625
[rfa agg] iter: 8, weight: tensor([0.0566, 0.0337, 0.2470, 0.3153, 0.0535, 0.0401, 0.1363, 0.0722, 0.0334,
        0.0119])
[rfa agg] iter:  9, prev_obj_val: 83.48037719726562, obj_val: 79.8228530883789, abs dis: 3.6575241088867188
[rfa agg] iter: 9, weight: tensor([0.0613, 0.0402, 0.3356, 0.1646, 0.1116, 0.0464, 0.1095, 0.0722, 0.0402,
        0.0185])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3224, Accuracy: 123/10000 (1.2300%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 4.5642, Accuracy: 1685/9950 (16.9347%)
saving model
Done in 412.8495523929596 sec.
Server Epoch:84 choose agents : [98, 26, 54, 61, 56, 29, 38, 45, 2, 15].
_Train Local_ResNet_18, epoch  84, local model 98, internal_epoch   1, Avg loss: 0.0805, Accuracy: 41/373 (10.9920%)
_Train Local_ResNet_18, epoch  84, local model 98, internal_epoch   2, Avg loss: 0.0466, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.8195, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 343/1446 (23.7206%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   2, Avg loss: 0.0325, Accuracy: 570/1446 (39.4191%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.5847, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   1, Avg loss: 0.0517, Accuracy: 358/1130 (31.6814%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   2, Avg loss: 0.0274, Accuracy: 494/1130 (43.7168%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.1753, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1320, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1228, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3212, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   1, Avg loss: 0.0813, Accuracy: 3/186 (1.6129%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   2, Avg loss: 0.0649, Accuracy: 81/186 (43.5484%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.4281, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   1, Avg loss: 0.0499, Accuracy: 476/1440 (33.0556%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   2, Avg loss: 0.0259, Accuracy: 734/1440 (50.9722%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.9530, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0532, Accuracy: 396/1131 (35.0133%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0263, Accuracy: 597/1131 (52.7851%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.3731, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   1, Avg loss: 0.0600, Accuracy: 240/669 (35.8744%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   2, Avg loss: 0.0369, Accuracy: 371/669 (55.4559%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.9709, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0610, Accuracy: 257/605 (42.4793%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0368, Accuracy: 333/605 (55.0413%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.9834, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   1, Avg loss: 0.0546, Accuracy: 376/1154 (32.5823%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   2, Avg loss: 0.0292, Accuracy: 530/1154 (45.9272%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.8125, Accuracy: 111/10000 (1.1100%)
time spent on training: 313.1418378353119
[rfa agg] training data poison_ratio: 0.0  data num: [373, 1446, 1130, 85, 186, 1440, 1131, 669, 605, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [98, 26, 54, 61, 56, 29, 38, 45, 2, 15], weight: tensor([0.0454, 0.1759, 0.1375, 0.0103, 0.0226, 0.1752, 0.1376, 0.0814, 0.0736,
        0.1404])
[rfa agg] iter:  0, prev_obj_val: 49.230506896972656, obj_val: 46.90447998046875, abs dis: 2.3260269165039062
[rfa agg] iter: 0, weight: tensor([0.0208, 0.1018, 0.2311, 0.0033, 0.0079, 0.1012, 0.2286, 0.0780, 0.0581,
        0.1692])
[rfa agg] iter:  1, prev_obj_val: 46.90447998046875, obj_val: 46.90375518798828, abs dis: 0.00072479248046875
[rfa agg] iter: 1, weight: tensor([0.0174, 0.0960, 0.2518, 0.0028, 0.0067, 0.0953, 0.2484, 0.0620, 0.0469,
        0.1727])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3209, Accuracy: 134/10000 (1.3400%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 4.6013, Accuracy: 1315/9950 (13.2161%)
saving model
Done in 412.3286747932434 sec.
Server Epoch:85 choose agents : [83, 3, 85, 18, 96, 8, 88, 79, 23, 58].
_Train Local_ResNet_18, epoch  85, local model 83, internal_epoch   1, Avg loss: 0.0518, Accuracy: 538/1953 (27.5474%)
_Train Local_ResNet_18, epoch  85, local model 83, internal_epoch   2, Avg loss: 0.0305, Accuracy: 920/1953 (47.1070%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.2131, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   1, Avg loss: 0.0645, Accuracy: 151/781 (19.3342%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   2, Avg loss: 0.0333, Accuracy: 297/781 (38.0282%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.4435, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  85, local model 85, internal_epoch   1, Avg loss: 0.0532, Accuracy: 507/1988 (25.5030%)
_Train Local_ResNet_18, epoch  85, local model 85, internal_epoch   2, Avg loss: 0.0331, Accuracy: 750/1988 (37.7264%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.4267, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0671, Accuracy: 164/530 (30.9434%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0361, Accuracy: 281/530 (53.0189%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.8049, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  85, local model 96, internal_epoch   1, Avg loss: 0.0813, Accuracy: 13/311 (4.1801%)
_Train Local_ResNet_18, epoch  85, local model 96, internal_epoch   2, Avg loss: 0.0526, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.7290, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   1, Avg loss: 0.0560, Accuracy: 314/1513 (20.7535%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   2, Avg loss: 0.0341, Accuracy: 553/1513 (36.5499%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.9640, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  85, local model 88, internal_epoch   1, Avg loss: 0.0689, Accuracy: 166/603 (27.5290%)
_Train Local_ResNet_18, epoch  85, local model 88, internal_epoch   2, Avg loss: 0.0419, Accuracy: 291/603 (48.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.4603, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  85, local model 79, internal_epoch   1, Avg loss: 0.1058, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  85, local model 79, internal_epoch   2, Avg loss: 0.0840, Accuracy: 53/197 (26.9036%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.5022, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   1, Avg loss: 0.0602, Accuracy: 310/715 (43.3566%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   2, Avg loss: 0.0346, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.2490, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0606, Accuracy: 302/803 (37.6090%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0329, Accuracy: 394/803 (49.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.5291, Accuracy: 76/10000 (0.7600%)
time spent on training: 338.46374678611755
[rfa agg] training data poison_ratio: 0.0  data num: [1953, 781, 1988, 530, 311, 1513, 603, 197, 715, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [83, 3, 85, 18, 96, 8, 88, 79, 23, 58], weight: tensor([0.2079, 0.0831, 0.2116, 0.0564, 0.0331, 0.1611, 0.0642, 0.0210, 0.0761,
        0.0855])
[rfa agg] iter:  0, prev_obj_val: 84.67792510986328, obj_val: 86.81999206542969, abs dis: 2.1420669555664062
[rfa agg] iter: 0, weight: tensor([0.1481, 0.1045, 0.1386, 0.0440, 0.0187, 0.2892, 0.0554, 0.0111, 0.0829,
        0.1074])
[rfa agg] iter:  1, prev_obj_val: 86.81999206542969, obj_val: 88.26244354248047, abs dis: 1.4424514770507812
[rfa agg] iter: 1, weight: tensor([0.1307, 0.1353, 0.1235, 0.0513, 0.0208, 0.2185, 0.0656, 0.0123, 0.1031,
        0.1389])
[rfa agg] iter:  2, prev_obj_val: 88.26244354248047, obj_val: 89.71778106689453, abs dis: 1.4553375244140625
[rfa agg] iter: 2, weight: tensor([0.1148, 0.1595, 0.1090, 0.0545, 0.0213, 0.1772, 0.0708, 0.0125, 0.1166,
        0.1638])
[rfa agg] iter:  3, prev_obj_val: 89.71778106689453, obj_val: 91.19397735595703, abs dis: 1.4761962890625
[rfa agg] iter: 3, weight: tensor([0.0957, 0.1889, 0.0913, 0.0556, 0.0208, 0.1386, 0.0738, 0.0121, 0.1295,
        0.1938])
[rfa agg] iter:  4, prev_obj_val: 91.19397735595703, obj_val: 93.59896850585938, abs dis: 2.4049911499023438
[rfa agg] iter: 4, weight: tensor([0.0733, 0.2281, 0.0702, 0.0529, 0.0187, 0.1007, 0.0722, 0.0108, 0.1394,
        0.2337])
[rfa agg] iter:  5, prev_obj_val: 93.59896850585938, obj_val: 99.05720520019531, abs dis: 5.4582366943359375
[rfa agg] iter: 5, weight: tensor([0.0324, 0.3341, 0.0312, 0.0340, 0.0106, 0.0417, 0.0496, 0.0060, 0.1250,
        0.3354])
[rfa agg] iter:  6, prev_obj_val: 99.05720520019531, obj_val: 110.42545318603516, abs dis: 11.368247985839844
[rfa agg] iter: 6, weight: tensor([0.0314, 0.2220, 0.0304, 0.0532, 0.0136, 0.0385, 0.0895, 0.0075, 0.2870,
        0.2270])
[rfa agg] iter:  7, prev_obj_val: 110.42545318603516, obj_val: 113.71412658691406, abs dis: 3.2886734008789062
[rfa agg] iter: 7, weight: tensor([0.0306, 0.0846, 0.0297, 0.1580, 0.0204, 0.0355, 0.4306, 0.0108, 0.1129,
        0.0869])
[rfa agg] iter:  8, prev_obj_val: 113.71412658691406, obj_val: 117.27071380615234, abs dis: 3.5565872192382812
[rfa agg] iter: 8, weight: tensor([0.0306, 0.0742, 0.0297, 0.2709, 0.0232, 0.0351, 0.3551, 0.0120, 0.0930,
        0.0762])
[rfa agg] iter:  9, prev_obj_val: 117.27071380615234, obj_val: 121.10006713867188, abs dis: 3.8293533325195312
[rfa agg] iter: 9, weight: tensor([0.0293, 0.0638, 0.0285, 0.4746, 0.0256, 0.0332, 0.1896, 0.0130, 0.0768,
        0.0656])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3191, Accuracy: 132/10000 (1.3200%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 4.6318, Accuracy: 1177/9950 (11.8291%)
saving model
Done in 446.2725508213043 sec.
Server Epoch:86 choose agents : [57, 99, 60, 19, 35, 84, 81, 44, 41, 59].
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   1, Avg loss: 0.0521, Accuracy: 310/1154 (26.8631%)
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   2, Avg loss: 0.0244, Accuracy: 512/1154 (44.3674%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 11.6787, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0537, Accuracy: 295/773 (38.1630%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0254, Accuracy: 472/773 (61.0608%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.0593, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   1, Avg loss: 0.0473, Accuracy: 756/2227 (33.9470%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   2, Avg loss: 0.0261, Accuracy: 1097/2227 (49.2591%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.2188, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 469/1036 (45.2703%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0233, Accuracy: 697/1036 (67.2780%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 12.2316, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   1, Avg loss: 0.0866, Accuracy: 26/271 (9.5941%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   2, Avg loss: 0.0542, Accuracy: 121/271 (44.6494%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.3898, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   1, Avg loss: 0.0571, Accuracy: 326/1190 (27.3950%)
_Train Local_ResNet_18, epoch  86, local model 84, internal_epoch   2, Avg loss: 0.0285, Accuracy: 530/1190 (44.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.1111, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0539, Accuracy: 306/774 (39.5349%)
_Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0311, Accuracy: 356/774 (45.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.8417, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0547, Accuracy: 503/1750 (28.7429%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0326, Accuracy: 769/1750 (43.9429%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.3537, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   1, Avg loss: 0.0588, Accuracy: 308/719 (42.8373%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   2, Avg loss: 0.0307, Accuracy: 453/719 (63.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.2147, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0488, Accuracy: 442/1089 (40.5877%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0315, Accuracy: 547/1089 (50.2296%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 13.4947, Accuracy: 81/10000 (0.8100%)
time spent on training: 372.49545407295227
[rfa agg] training data poison_ratio: 0.0  data num: [1154, 773, 2227, 1036, 271, 1190, 774, 1750, 719, 1089]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [57, 99, 60, 19, 35, 84, 81, 44, 41, 59], weight: tensor([0.1051, 0.0704, 0.2028, 0.0943, 0.0247, 0.1083, 0.0705, 0.1593, 0.0655,
        0.0992])
[rfa agg] iter:  0, prev_obj_val: 61.67287063598633, obj_val: 67.23068237304688, abs dis: 5.557811737060547
[rfa agg] iter: 0, weight: tensor([0.2733, 0.0288, 0.0313, 0.1082, 0.0044, 0.2962, 0.0289, 0.0436, 0.0230,
        0.1625])
[rfa agg] iter:  1, prev_obj_val: 67.23068237304688, obj_val: 71.6384048461914, abs dis: 4.407722473144531
[rfa agg] iter: 1, weight: tensor([0.1271, 0.0625, 0.0348, 0.3142, 0.0068, 0.1316, 0.0627, 0.0439, 0.0457,
        0.1707])
[rfa agg] iter:  2, prev_obj_val: 71.6384048461914, obj_val: 76.37317657470703, abs dis: 4.734771728515625
[rfa agg] iter: 2, weight: tensor([0.1150, 0.1072, 0.0412, 0.2320, 0.0093, 0.1187, 0.1078, 0.0504, 0.0727,
        0.1456])
[rfa agg] iter:  3, prev_obj_val: 76.37317657470703, obj_val: 78.7909927368164, abs dis: 2.417816162109375
[rfa agg] iter: 3, weight: tensor([0.0931, 0.1738, 0.0402, 0.1487, 0.0106, 0.0961, 0.1761, 0.0479, 0.1031,
        0.1104])
[rfa agg] iter:  4, prev_obj_val: 78.7909927368164, obj_val: 84.09825134277344, abs dis: 5.307258605957031
[rfa agg] iter: 4, weight: tensor([0.0759, 0.2186, 0.0354, 0.1125, 0.0101, 0.0784, 0.2245, 0.0417, 0.1150,
        0.0878])
[rfa agg] iter:  5, prev_obj_val: 84.09825134277344, obj_val: 91.09257507324219, abs dis: 6.99432373046875
[rfa agg] iter: 5, weight: tensor([0.0430, 0.2888, 0.0229, 0.0577, 0.0077, 0.0444, 0.3214, 0.0264, 0.1397,
        0.0481])
[rfa agg] iter:  6, prev_obj_val: 91.09257507324219, obj_val: 95.05484008789062, abs dis: 3.9622650146484375
[rfa agg] iter: 6, weight: tensor([0.0458, 0.1876, 0.0272, 0.0575, 0.0109, 0.0473, 0.1948, 0.0307, 0.3484,
        0.0500])
[rfa agg] iter:  7, prev_obj_val: 95.05484008789062, obj_val: 81.33904266357422, abs dis: 13.715797424316406
[rfa agg] iter: 7, weight: tensor([0.0518, 0.1605, 0.0322, 0.0633, 0.0141, 0.0535, 0.1650, 0.0360, 0.3676,
        0.0560])
[rfa agg] iter:  8, prev_obj_val: 81.33904266357422, obj_val: 84.08101654052734, abs dis: 2.741973876953125
[rfa agg] iter: 8, weight: tensor([0.0570, 0.2556, 0.0286, 0.0797, 0.0088, 0.0589, 0.2865, 0.0333, 0.1273,
        0.0646])
[rfa agg] iter:  9, prev_obj_val: 84.08101654052734, obj_val: 91.09384155273438, abs dis: 7.012825012207031
[rfa agg] iter: 9, weight: tensor([0.0417, 0.2865, 0.0222, 0.0560, 0.0074, 0.0431, 0.3342, 0.0256, 0.1365,
        0.0467])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3207, Accuracy: 124/10000 (1.2400%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 4.6448, Accuracy: 968/9950 (9.7286%)
saving model
Done in 471.5436763763428 sec.
Server Epoch:87 choose agents : [85, 29, 54, 69, 86, 45, 26, 47, 33, 57].
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0546, Accuracy: 504/1988 (25.3521%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0335, Accuracy: 733/1988 (36.8712%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.0095, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   1, Avg loss: 0.0505, Accuracy: 470/1440 (32.6389%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   2, Avg loss: 0.0258, Accuracy: 748/1440 (51.9444%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.9126, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   1, Avg loss: 0.0491, Accuracy: 385/1130 (34.0708%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   2, Avg loss: 0.0269, Accuracy: 501/1130 (44.3363%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.1324, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0524, Accuracy: 310/590 (52.5424%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0320, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 11.1939, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0569, Accuracy: 347/1003 (34.5962%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0320, Accuracy: 423/1003 (42.1735%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.0441, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   1, Avg loss: 0.0606, Accuracy: 243/669 (36.3229%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   2, Avg loss: 0.0355, Accuracy: 372/669 (55.6054%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.5559, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 364/1446 (25.1729%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   2, Avg loss: 0.0324, Accuracy: 591/1446 (40.8714%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.5924, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1170, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1020, Accuracy: 19/134 (14.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3587, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   1, Avg loss: 0.0757, Accuracy: 119/515 (23.1068%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   2, Avg loss: 0.0501, Accuracy: 165/515 (32.0388%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.1410, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0526, Accuracy: 323/1154 (27.9896%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0240, Accuracy: 554/1154 (48.0069%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 11.5225, Accuracy: 60/10000 (0.6000%)
time spent on training: 341.07003951072693
[rfa agg] training data poison_ratio: 0.0  data num: [1988, 1440, 1130, 590, 1003, 669, 1446, 134, 515, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [85, 29, 54, 69, 86, 45, 26, 47, 33, 57], weight: tensor([0.1974, 0.1430, 0.1122, 0.0586, 0.0996, 0.0664, 0.1436, 0.0133, 0.0511,
        0.1146])
[rfa agg] iter:  0, prev_obj_val: 54.831321716308594, obj_val: 59.07355499267578, abs dis: 4.2422332763671875
[rfa agg] iter: 0, weight: tensor([0.0371, 0.0797, 0.3564, 0.0175, 0.0979, 0.0224, 0.0802, 0.0022, 0.0137,
        0.2928])
[rfa agg] iter:  1, prev_obj_val: 59.07355499267578, obj_val: 60.94090270996094, abs dis: 1.8673477172851562
[rfa agg] iter: 1, weight: tensor([0.0408, 0.0733, 0.3096, 0.0259, 0.2525, 0.0341, 0.0736, 0.0029, 0.0198,
        0.1676])
[rfa agg] iter:  2, prev_obj_val: 60.94090270996094, obj_val: 62.99310302734375, abs dis: 2.0522003173828125
[rfa agg] iter: 2, weight: tensor([0.0385, 0.0661, 0.2140, 0.0272, 0.3962, 0.0362, 0.0664, 0.0030, 0.0206,
        0.1319])
[rfa agg] iter:  3, prev_obj_val: 62.99310302734375, obj_val: 68.1802978515625, abs dis: 5.18719482421875
[rfa agg] iter: 3, weight: tensor([0.0313, 0.0516, 0.1366, 0.0248, 0.5557, 0.0334, 0.0519, 0.0026, 0.0185,
        0.0935])
[rfa agg] iter:  4, prev_obj_val: 68.1802978515625, obj_val: 65.48136901855469, abs dis: 2.6989288330078125
[rfa agg] iter: 4, weight: tensor([0.0476, 0.0729, 0.1495, 0.0478, 0.3881, 0.0667, 0.0733, 0.0045, 0.0348,
        0.1147])
[rfa agg] iter:  5, prev_obj_val: 65.48136901855469, obj_val: 68.16914367675781, abs dis: 2.687774658203125
[rfa agg] iter: 5, weight: tensor([0.0389, 0.0617, 0.1415, 0.0345, 0.4817, 0.0473, 0.0620, 0.0035, 0.0255,
        0.1034])
[rfa agg] iter:  6, prev_obj_val: 68.16914367675781, obj_val: 65.48194885253906, abs dis: 2.68719482421875
[rfa agg] iter: 6, weight: tensor([0.0479, 0.0734, 0.1507, 0.0481, 0.3839, 0.0672, 0.0737, 0.0046, 0.0350,
        0.1155])
[rfa agg] iter:  7, prev_obj_val: 65.48194885253906, obj_val: 68.1690444946289, abs dis: 2.6870956420898438
[rfa agg] iter: 7, weight: tensor([0.0389, 0.0618, 0.1417, 0.0346, 0.4810, 0.0474, 0.0621, 0.0035, 0.0255,
        0.1036])
[rfa agg] iter:  8, prev_obj_val: 68.1690444946289, obj_val: 65.48194885253906, abs dis: 2.6870956420898438
[rfa agg] iter: 8, weight: tensor([0.0479, 0.0734, 0.1507, 0.0481, 0.3839, 0.0672, 0.0737, 0.0046, 0.0350,
        0.1155])
[rfa agg] iter:  9, prev_obj_val: 65.48194885253906, obj_val: 68.1690444946289, abs dis: 2.6870956420898438
[rfa agg] iter: 9, weight: tensor([0.0389, 0.0618, 0.1417, 0.0346, 0.4810, 0.0474, 0.0621, 0.0035, 0.0255,
        0.1036])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3198, Accuracy: 127/10000 (1.2700%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 4.6755, Accuracy: 834/9950 (8.3819%)
saving model
Done in 441.4727852344513 sec.
Server Epoch:88 choose agents : [62, 82, 84, 18, 63, 67, 29, 37, 86, 79].
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0692, Accuracy: 147/568 (25.8803%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0389, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.2379, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  88, local model 82, internal_epoch   1, Avg loss: 0.0745, Accuracy: 84/500 (16.8000%)
_Train Local_ResNet_18, epoch  88, local model 82, internal_epoch   2, Avg loss: 0.0458, Accuracy: 227/500 (45.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.5364, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  88, local model 84, internal_epoch   1, Avg loss: 0.0559, Accuracy: 334/1190 (28.0672%)
_Train Local_ResNet_18, epoch  88, local model 84, internal_epoch   2, Avg loss: 0.0279, Accuracy: 569/1190 (47.8151%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0209, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0645, Accuracy: 211/530 (39.8113%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0363, Accuracy: 296/530 (55.8491%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.8739, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   1, Avg loss: 0.0493, Accuracy: 315/888 (35.4730%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   2, Avg loss: 0.0235, Accuracy: 501/888 (56.4189%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 10.8798, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   1, Avg loss: 0.0734, Accuracy: 83/426 (19.4836%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   2, Avg loss: 0.0375, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.4350, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   1, Avg loss: 0.0484, Accuracy: 469/1440 (32.5694%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   2, Avg loss: 0.0261, Accuracy: 747/1440 (51.8750%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.9434, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   1, Avg loss: 0.0451, Accuracy: 566/1129 (50.1329%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   2, Avg loss: 0.0208, Accuracy: 781/1129 (69.1763%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.7839, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0553, Accuracy: 367/1003 (36.5902%)
_Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0310, Accuracy: 425/1003 (42.3729%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.6514, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  88, local model 79, internal_epoch   1, Avg loss: 0.1061, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  88, local model 79, internal_epoch   2, Avg loss: 0.0892, Accuracy: 44/197 (22.3350%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.4778, Accuracy: 50/10000 (0.5000%)
time spent on training: 309.5502507686615
[rfa agg] training data poison_ratio: 0.0  data num: [568, 500, 1190, 530, 888, 426, 1440, 1129, 1003, 197]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [62, 82, 84, 18, 63, 67, 29, 37, 86, 79], weight: tensor([0.0722, 0.0635, 0.1512, 0.0673, 0.1128, 0.0541, 0.1830, 0.1434, 0.1274,
        0.0250])
[rfa agg] iter:  0, prev_obj_val: 45.175052642822266, obj_val: 50.458282470703125, abs dis: 5.283229827880859
[rfa agg] iter: 0, weight: tensor([0.0361, 0.0265, 0.0751, 0.0337, 0.5113, 0.0194, 0.0509, 0.0873, 0.1534,
        0.0063])
[rfa agg] iter:  1, prev_obj_val: 50.458282470703125, obj_val: 54.29143524169922, abs dis: 3.8331527709960938
[rfa agg] iter: 1, weight: tensor([0.0844, 0.0580, 0.0955, 0.0788, 0.3048, 0.0405, 0.0718, 0.1058, 0.1483,
        0.0122])
[rfa agg] iter:  2, prev_obj_val: 54.29143524169922, obj_val: 54.287105560302734, abs dis: 0.004329681396484375
[rfa agg] iter: 2, weight: tensor([0.1301, 0.0823, 0.0918, 0.1213, 0.2037, 0.0548, 0.0726, 0.0997, 0.1285,
        0.0153])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3198, Accuracy: 136/10000 (1.3600%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 4.7067, Accuracy: 679/9950 (6.8241%)
saving model
Done in 408.6944258213043 sec.
Server Epoch:89 choose agents : [43, 48, 27, 5, 45, 67, 95, 23, 39, 16].
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0607, Accuracy: 298/946 (31.5011%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0325, Accuracy: 363/946 (38.3721%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.3718, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   1, Avg loss: 0.0679, Accuracy: 185/631 (29.3185%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   2, Avg loss: 0.0392, Accuracy: 275/631 (43.5816%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.5510, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   1, Avg loss: 0.0543, Accuracy: 416/1587 (26.2130%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   2, Avg loss: 0.0317, Accuracy: 656/1587 (41.3359%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.6776, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   1, Avg loss: 0.0465, Accuracy: 546/1628 (33.5381%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   2, Avg loss: 0.0225, Accuracy: 923/1628 (56.6953%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.6017, Accuracy: 166/10000 (1.6600%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   1, Avg loss: 0.0599, Accuracy: 255/669 (38.1166%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   2, Avg loss: 0.0359, Accuracy: 367/669 (54.8580%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.9231, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0725, Accuracy: 86/426 (20.1878%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0361, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.3600, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  89, local model 95, internal_epoch   1, Avg loss: 0.0536, Accuracy: 329/599 (54.9249%)
_Train Local_ResNet_18, epoch  89, local model 95, internal_epoch   2, Avg loss: 0.0283, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 11.6451, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   1, Avg loss: 0.0599, Accuracy: 311/715 (43.4965%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   2, Avg loss: 0.0355, Accuracy: 440/715 (61.5385%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.3905, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0467, Accuracy: 391/1013 (38.5982%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0232, Accuracy: 575/1013 (56.7621%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.5894, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   1, Avg loss: 0.0586, Accuracy: 293/708 (41.3842%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   2, Avg loss: 0.0325, Accuracy: 443/708 (62.5706%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.5343, Accuracy: 86/10000 (0.8600%)
time spent on training: 346.54639291763306
[rfa agg] training data poison_ratio: 0.0  data num: [946, 631, 1587, 1628, 669, 426, 599, 715, 1013, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 48, 27, 5, 45, 67, 95, 23, 39, 16], weight: tensor([0.1060, 0.0707, 0.1779, 0.1825, 0.0750, 0.0477, 0.0671, 0.0801, 0.1135,
        0.0794])
[rfa agg] iter:  0, prev_obj_val: 53.47614669799805, obj_val: 56.997493743896484, abs dis: 3.5213470458984375
[rfa agg] iter: 0, weight: tensor([0.2826, 0.0556, 0.0511, 0.0480, 0.0773, 0.0216, 0.0526, 0.1196, 0.1713,
        0.1203])
[rfa agg] iter:  1, prev_obj_val: 56.997493743896484, obj_val: 63.59280014038086, abs dis: 6.595306396484375
[rfa agg] iter: 1, weight: tensor([0.0708, 0.0700, 0.0278, 0.0264, 0.1281, 0.0194, 0.0660, 0.2355, 0.0571,
        0.2988])
[rfa agg] iter:  2, prev_obj_val: 63.59280014038086, obj_val: 70.21481323242188, abs dis: 6.622013092041016
[rfa agg] iter: 2, weight: tensor([0.0496, 0.2124, 0.0261, 0.0250, 0.2093, 0.0289, 0.1912, 0.1062, 0.0437,
        0.1075])
[rfa agg] iter:  3, prev_obj_val: 70.21481323242188, obj_val: 74.12425231933594, abs dis: 3.9094390869140625
[rfa agg] iter: 3, weight: tensor([0.0488, 0.2733, 0.0292, 0.0281, 0.1196, 0.0482, 0.2505, 0.0790, 0.0443,
        0.0790])
[rfa agg] iter:  4, prev_obj_val: 74.12425231933594, obj_val: 70.20272827148438, abs dis: 3.9215240478515625
[rfa agg] iter: 4, weight: tensor([0.0595, 0.2243, 0.0376, 0.0363, 0.1213, 0.0799, 0.2100, 0.0881, 0.0547,
        0.0882])
[rfa agg] iter:  5, prev_obj_val: 70.20272827148438, obj_val: 74.12462615966797, abs dis: 3.9218978881835938
[rfa agg] iter: 5, weight: tensor([0.0481, 0.2785, 0.0287, 0.0277, 0.1162, 0.0476, 0.2543, 0.0775, 0.0436,
        0.0778])
[rfa agg] iter:  6, prev_obj_val: 74.12462615966797, obj_val: 70.20270538330078, abs dis: 3.9219207763671875
[rfa agg] iter: 6, weight: tensor([0.0595, 0.2244, 0.0376, 0.0363, 0.1212, 0.0799, 0.2101, 0.0881, 0.0547,
        0.0882])
[rfa agg] iter:  7, prev_obj_val: 70.20270538330078, obj_val: 74.1246337890625, abs dis: 3.9219284057617188
[rfa agg] iter: 7, weight: tensor([0.0481, 0.2785, 0.0287, 0.0277, 0.1162, 0.0476, 0.2543, 0.0775, 0.0436,
        0.0778])
[rfa agg] iter:  8, prev_obj_val: 74.1246337890625, obj_val: 70.20270538330078, abs dis: 3.9219284057617188
[rfa agg] iter: 8, weight: tensor([0.0595, 0.2244, 0.0376, 0.0363, 0.1212, 0.0799, 0.2101, 0.0881, 0.0547,
        0.0882])
[rfa agg] iter:  9, prev_obj_val: 70.20270538330078, obj_val: 74.1246337890625, abs dis: 3.9219284057617188
[rfa agg] iter: 9, weight: tensor([0.0481, 0.2785, 0.0287, 0.0277, 0.1162, 0.0476, 0.2543, 0.0775, 0.0436,
        0.0778])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3185, Accuracy: 143/10000 (1.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 4.7344, Accuracy: 570/9950 (5.7286%)
saving model
Done in 445.98745465278625 sec.
Server Epoch:90 choose agents : [25, 41, 39, 40, 34, 76, 29, 71, 8, 53].
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   1, Avg loss: 0.0555, Accuracy: 302/690 (43.7681%)
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   2, Avg loss: 0.0232, Accuracy: 465/690 (67.3913%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.2879, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0570, Accuracy: 310/719 (43.1154%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0317, Accuracy: 463/719 (64.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.8996, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0469, Accuracy: 372/1013 (36.7226%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0232, Accuracy: 580/1013 (57.2557%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.2339, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0555, Accuracy: 393/1573 (24.9841%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0333, Accuracy: 610/1573 (38.7794%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.7869, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   1, Avg loss: 0.0547, Accuracy: 418/1427 (29.2922%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   2, Avg loss: 0.0304, Accuracy: 655/1427 (45.9005%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.5862, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  90, local model 76, internal_epoch   1, Avg loss: 0.0791, Accuracy: 73/466 (15.6652%)
_Train Local_ResNet_18, epoch  90, local model 76, internal_epoch   2, Avg loss: 0.0414, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.3406, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 459/1440 (31.8750%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   2, Avg loss: 0.0258, Accuracy: 779/1440 (54.0972%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.7361, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0540, Accuracy: 291/818 (35.5746%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0256, Accuracy: 438/818 (53.5452%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.1676, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   1, Avg loss: 0.0556, Accuracy: 372/1513 (24.5869%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   2, Avg loss: 0.0335, Accuracy: 584/1513 (38.5988%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.0410, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0444, Accuracy: 351/813 (43.1734%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0180, Accuracy: 505/813 (62.1156%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 12.7709, Accuracy: 55/10000 (0.5500%)
time spent on training: 357.08021235466003
[rfa agg] training data poison_ratio: 0.0  data num: [690, 719, 1013, 1573, 1427, 466, 1440, 818, 1513, 813]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [25, 41, 39, 40, 34, 76, 29, 71, 8, 53], weight: tensor([0.0659, 0.0687, 0.0967, 0.1502, 0.1363, 0.0445, 0.1375, 0.0781, 0.1445,
        0.0776])
[rfa agg] iter:  0, prev_obj_val: 51.70553207397461, obj_val: 53.20647048950195, abs dis: 1.5009384155273438
[rfa agg] iter: 0, weight: tensor([0.0472, 0.0588, 0.3413, 0.0807, 0.0974, 0.0213, 0.0981, 0.0834, 0.0887,
        0.0830])
[rfa agg] iter:  1, prev_obj_val: 53.20647048950195, obj_val: 58.95115280151367, abs dis: 5.744682312011719
[rfa agg] iter: 1, weight: tensor([0.0372, 0.0481, 0.5453, 0.0472, 0.0550, 0.0158, 0.0554, 0.0726, 0.0511,
        0.0722])
[rfa agg] iter:  2, prev_obj_val: 58.95115280151367, obj_val: 62.348724365234375, abs dis: 3.397571563720703
[rfa agg] iter: 2, weight: tensor([0.0722, 0.1082, 0.1606, 0.0458, 0.0507, 0.0248, 0.0511, 0.2194, 0.0485,
        0.2186])
[rfa agg] iter:  3, prev_obj_val: 62.348724365234375, obj_val: 64.8651123046875, abs dis: 2.516387939453125
[rfa agg] iter: 3, weight: tensor([0.0646, 0.1196, 0.0646, 0.0255, 0.0277, 0.0181, 0.0280, 0.3125, 0.0268,
        0.3127])
[rfa agg] iter:  4, prev_obj_val: 64.8651123046875, obj_val: 71.10572814941406, abs dis: 6.2406158447265625
[rfa agg] iter: 4, weight: tensor([0.0919, 0.1988, 0.0612, 0.0270, 0.0292, 0.0221, 0.0294, 0.2574, 0.0283,
        0.2549])
[rfa agg] iter:  5, prev_obj_val: 71.10572814941406, obj_val: 74.63262176513672, abs dis: 3.5268936157226562
[rfa agg] iter: 5, weight: tensor([0.2395, 0.2606, 0.0594, 0.0310, 0.0330, 0.0351, 0.0333, 0.1385, 0.0322,
        0.1373])
[rfa agg] iter:  6, prev_obj_val: 74.63262176513672, obj_val: 78.4731216430664, abs dis: 3.8404998779296875
[rfa agg] iter: 6, weight: tensor([0.3863, 0.1754, 0.0548, 0.0306, 0.0324, 0.0418, 0.0326, 0.1077, 0.0317,
        0.1067])
[rfa agg] iter:  7, prev_obj_val: 78.4731216430664, obj_val: 82.47245788574219, abs dis: 3.9993362426757812
[rfa agg] iter: 7, weight: tensor([0.3650, 0.1498, 0.0611, 0.0362, 0.0381, 0.0613, 0.0384, 0.1068, 0.0374,
        0.1058])
[rfa agg] iter:  8, prev_obj_val: 82.47245788574219, obj_val: 67.8274917602539, abs dis: 14.644966125488281
[rfa agg] iter: 8, weight: tensor([0.2733, 0.1470, 0.0715, 0.0446, 0.0467, 0.0966, 0.0471, 0.1142, 0.0460,
        0.1132])
[rfa agg] iter:  9, prev_obj_val: 67.8274917602539, obj_val: 71.0835189819336, abs dis: 3.2560272216796875
[rfa agg] iter: 9, weight: tensor([0.1514, 0.2976, 0.0600, 0.0290, 0.0311, 0.0278, 0.0314, 0.1724, 0.0303,
        0.1690])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3172, Accuracy: 144/10000 (1.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 4.7633, Accuracy: 463/9950 (4.6533%)
saving model
Done in 460.05677318573 sec.
Server Epoch:91 choose agents : [36, 34, 71, 11, 72, 90, 63, 3, 50, 24].
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.0811, Accuracy: 74/408 (18.1373%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0456, Accuracy: 153/408 (37.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.1149, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0546, Accuracy: 439/1427 (30.7638%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0305, Accuracy: 651/1427 (45.6202%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.3988, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0526, Accuracy: 316/818 (38.6308%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0256, Accuracy: 440/818 (53.7897%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.2306, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   1, Avg loss: 0.0520, Accuracy: 308/712 (43.2584%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   2, Avg loss: 0.0235, Accuracy: 451/712 (63.3427%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.0920, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   1, Avg loss: 0.0562, Accuracy: 335/1241 (26.9944%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   2, Avg loss: 0.0342, Accuracy: 503/1241 (40.5318%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.7584, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  91, local model 90, internal_epoch   1, Avg loss: 0.0528, Accuracy: 318/677 (46.9719%)
_Train Local_ResNet_18, epoch  91, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.8604, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   1, Avg loss: 0.0482, Accuracy: 329/888 (37.0495%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   2, Avg loss: 0.0231, Accuracy: 512/888 (57.6577%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.0714, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   1, Avg loss: 0.0649, Accuracy: 162/781 (20.7426%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   2, Avg loss: 0.0316, Accuracy: 316/781 (40.4609%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.5087, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   1, Avg loss: 0.0557, Accuracy: 274/809 (33.8690%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   2, Avg loss: 0.0237, Accuracy: 432/809 (53.3993%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 10.0348, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0787, Accuracy: 38/312 (12.1795%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0397, Accuracy: 183/312 (58.6538%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.9707, Accuracy: 62/10000 (0.6200%)
time spent on training: 334.6012587547302
[rfa agg] training data poison_ratio: 0.0  data num: [408, 1427, 818, 712, 1241, 677, 888, 781, 809, 312]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 34, 71, 11, 72, 90, 63, 3, 50, 24], weight: tensor([0.0505, 0.1768, 0.1013, 0.0882, 0.1537, 0.0839, 0.1100, 0.0967, 0.1002,
        0.0386])
[rfa agg] iter:  0, prev_obj_val: 36.06050491333008, obj_val: 39.460243225097656, abs dis: 3.399738311767578
[rfa agg] iter: 0, weight: tensor([0.0104, 0.0218, 0.2132, 0.0955, 0.0271, 0.0507, 0.1197, 0.2423, 0.2134,
        0.0060])
[rfa agg] iter:  1, prev_obj_val: 39.460243225097656, obj_val: 48.43625259399414, abs dis: 8.976009368896484
[rfa agg] iter: 1, weight: tensor([0.0167, 0.0265, 0.1520, 0.2549, 0.0316, 0.1253, 0.0883, 0.1467, 0.1489,
        0.0091])
[rfa agg] iter:  2, prev_obj_val: 48.43625259399414, obj_val: 52.00830078125, abs dis: 3.5720481872558594
[rfa agg] iter: 2, weight: tensor([0.0373, 0.0366, 0.1033, 0.1463, 0.0419, 0.3355, 0.0807, 0.0985, 0.1018,
        0.0182])
[rfa agg] iter:  3, prev_obj_val: 52.00830078125, obj_val: 52.00665283203125, abs dis: 0.00164794921875
[rfa agg] iter: 3, weight: tensor([0.0554, 0.0450, 0.1104, 0.1421, 0.0508, 0.2657, 0.0904, 0.1054, 0.1090,
        0.0256])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3170, Accuracy: 138/10000 (1.3800%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 4.7874, Accuracy: 338/9950 (3.3970%)
saving model
Done in 435.41158986091614 sec.
Server Epoch:92 choose agents : [91, 89, 76, 1, 58, 42, 94, 14, 29, 30].
_Train Local_ResNet_18, epoch  92, local model 91, internal_epoch   1, Avg loss: 0.0446, Accuracy: 507/1030 (49.2233%)
_Train Local_ResNet_18, epoch  92, local model 91, internal_epoch   2, Avg loss: 0.0228, Accuracy: 684/1030 (66.4078%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.5397, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  92, local model 89, internal_epoch   1, Avg loss: 0.0580, Accuracy: 345/896 (38.5045%)
_Train Local_ResNet_18, epoch  92, local model 89, internal_epoch   2, Avg loss: 0.0321, Accuracy: 433/896 (48.3259%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.3019, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   1, Avg loss: 0.0776, Accuracy: 80/466 (17.1674%)
_Train Local_ResNet_18, epoch  92, local model 76, internal_epoch   2, Avg loss: 0.0391, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.6237, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   1, Avg loss: 0.0508, Accuracy: 386/928 (41.5948%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   2, Avg loss: 0.0207, Accuracy: 653/928 (70.3664%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.4009, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0602, Accuracy: 308/803 (38.3562%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 415/803 (51.6812%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.1510, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0528, Accuracy: 367/1372 (26.7493%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0293, Accuracy: 606/1372 (44.1691%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.8063, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  92, local model 94, internal_epoch   1, Avg loss: 0.0530, Accuracy: 444/1662 (26.7148%)
_Train Local_ResNet_18, epoch  92, local model 94, internal_epoch   2, Avg loss: 0.0301, Accuracy: 724/1662 (43.5620%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.8092, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   1, Avg loss: 0.0575, Accuracy: 255/1013 (25.1728%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   2, Avg loss: 0.0312, Accuracy: 439/1013 (43.3366%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.3570, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0488, Accuracy: 462/1440 (32.0833%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0259, Accuracy: 757/1440 (52.5694%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.5604, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   1, Avg loss: 0.0718, Accuracy: 109/486 (22.4280%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   2, Avg loss: 0.0366, Accuracy: 220/486 (45.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.5377, Accuracy: 63/10000 (0.6300%)
time spent on training: 388.17504382133484
[rfa agg] training data poison_ratio: 0.0  data num: [1030, 896, 466, 928, 803, 1372, 1662, 1013, 1440, 486]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 89, 76, 1, 58, 42, 94, 14, 29, 30], weight: tensor([0.1020, 0.0887, 0.0462, 0.0919, 0.0795, 0.1359, 0.1646, 0.1003, 0.1426,
        0.0481])
[rfa agg] iter:  0, prev_obj_val: 45.705177307128906, obj_val: 51.2199592590332, abs dis: 5.514781951904297
[rfa agg] iter: 0, weight: tensor([0.1322, 0.1266, 0.0143, 0.2132, 0.0725, 0.0485, 0.0365, 0.2973, 0.0441,
        0.0149])
[rfa agg] iter:  1, prev_obj_val: 51.2199592590332, obj_val: 60.095619201660156, abs dis: 8.875659942626953
[rfa agg] iter: 1, weight: tensor([0.0774, 0.3204, 0.0183, 0.1743, 0.1635, 0.0404, 0.0327, 0.1162, 0.0377,
        0.0191])
[rfa agg] iter:  2, prev_obj_val: 60.095619201660156, obj_val: 60.06327819824219, abs dis: 0.03234100341796875
[rfa agg] iter: 2, weight: tensor([0.0705, 0.1794, 0.0324, 0.1116, 0.3549, 0.0454, 0.0388, 0.0899, 0.0432,
        0.0339])
[rfa agg] iter:  3, prev_obj_val: 60.06327819824219, obj_val: 63.5943717956543, abs dis: 3.5310935974121094
[rfa agg] iter: 3, weight: tensor([0.0675, 0.1690, 0.0311, 0.1061, 0.3858, 0.0435, 0.0371, 0.0861, 0.0413,
        0.0325])
[rfa agg] iter:  4, prev_obj_val: 63.5943717956543, obj_val: 60.06692123413086, abs dis: 3.5274505615234375
[rfa agg] iter: 4, weight: tensor([0.0789, 0.1685, 0.0452, 0.1162, 0.2952, 0.0535, 0.0464, 0.0979, 0.0511,
        0.0472])
[rfa agg] iter:  5, prev_obj_val: 60.06692123413086, obj_val: 67.1666030883789, abs dis: 7.099681854248047
[rfa agg] iter: 5, weight: tensor([0.0684, 0.1708, 0.0315, 0.1076, 0.3781, 0.0440, 0.0376, 0.0873, 0.0418,
        0.0329])
[rfa agg] iter:  6, prev_obj_val: 67.1666030883789, obj_val: 60.073516845703125, abs dis: 7.093086242675781
[rfa agg] iter: 6, weight: tensor([0.0847, 0.1609, 0.0606, 0.1184, 0.2393, 0.0600, 0.0527, 0.1026, 0.0575,
        0.0633])
[rfa agg] iter:  7, prev_obj_val: 60.073516845703125, obj_val: 67.16598510742188, abs dis: 7.09246826171875
[rfa agg] iter: 7, weight: tensor([0.0692, 0.1725, 0.0319, 0.1089, 0.3710, 0.0446, 0.0380, 0.0883, 0.0423,
        0.0333])
[rfa agg] iter:  8, prev_obj_val: 67.16598510742188, obj_val: 60.07353973388672, abs dis: 7.092445373535156
[rfa agg] iter: 8, weight: tensor([0.0848, 0.1609, 0.0606, 0.1185, 0.2392, 0.0600, 0.0527, 0.1026, 0.0575,
        0.0633])
[rfa agg] iter:  9, prev_obj_val: 60.07353973388672, obj_val: 67.16598510742188, abs dis: 7.092445373535156
[rfa agg] iter: 9, weight: tensor([0.0692, 0.1725, 0.0319, 0.1089, 0.3709, 0.0446, 0.0380, 0.0883, 0.0423,
        0.0333])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3153, Accuracy: 144/10000 (1.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 4.8156, Accuracy: 291/9950 (2.9246%)
saving model
Done in 492.75570344924927 sec.
Server Epoch:93 choose agents : [75, 7, 35, 2, 93, 15, 46, 67, 55, 73].
_Train Local_ResNet_18, epoch  93, local model 75, internal_epoch   1, Avg loss: 0.0601, Accuracy: 277/776 (35.6959%)
_Train Local_ResNet_18, epoch  93, local model 75, internal_epoch   2, Avg loss: 0.0241, Accuracy: 443/776 (57.0876%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.3978, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   1, Avg loss: 0.0506, Accuracy: 374/891 (41.9753%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   2, Avg loss: 0.0242, Accuracy: 466/891 (52.3008%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.0352, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   1, Avg loss: 0.0875, Accuracy: 27/271 (9.9631%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   2, Avg loss: 0.0541, Accuracy: 114/271 (42.0664%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.4969, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 233/605 (38.5124%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   2, Avg loss: 0.0363, Accuracy: 332/605 (54.8760%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.9984, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  93, local model 93, internal_epoch   1, Avg loss: 0.0524, Accuracy: 494/1742 (28.3582%)
_Train Local_ResNet_18, epoch  93, local model 93, internal_epoch   2, Avg loss: 0.0285, Accuracy: 800/1742 (45.9242%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.4166, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0533, Accuracy: 415/1154 (35.9619%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0251, Accuracy: 554/1154 (48.0069%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.5016, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   1, Avg loss: 0.0543, Accuracy: 450/1904 (23.6345%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   2, Avg loss: 0.0287, Accuracy: 802/1904 (42.1218%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.0624, Accuracy: 161/10000 (1.6100%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   1, Avg loss: 0.0717, Accuracy: 79/426 (18.5446%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   2, Avg loss: 0.0364, Accuracy: 175/426 (41.0798%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.3199, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   1, Avg loss: 0.0482, Accuracy: 410/1071 (38.2820%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   2, Avg loss: 0.0263, Accuracy: 558/1071 (52.1008%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.8002, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   1, Avg loss: 0.0585, Accuracy: 232/938 (24.7335%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   2, Avg loss: 0.0307, Accuracy: 382/938 (40.7249%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.1794, Accuracy: 58/10000 (0.5800%)
time spent on training: 361.233074426651
[rfa agg] training data poison_ratio: 0.0  data num: [776, 891, 271, 605, 1742, 1154, 1904, 426, 1071, 938]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 7, 35, 2, 93, 15, 46, 67, 55, 73], weight: tensor([0.0794, 0.0911, 0.0277, 0.0619, 0.1782, 0.1180, 0.1947, 0.0436, 0.1095,
        0.0959])
[rfa agg] iter:  0, prev_obj_val: 61.2070198059082, obj_val: 63.478057861328125, abs dis: 2.271038055419922
[rfa agg] iter: 0, weight: tensor([0.0580, 0.0874, 0.0068, 0.0260, 0.0477, 0.1632, 0.0441, 0.0129, 0.4178,
        0.1360])
[rfa agg] iter:  1, prev_obj_val: 63.478057861328125, obj_val: 66.14030456542969, abs dis: 2.6622467041015625
[rfa agg] iter: 1, weight: tensor([0.0868, 0.1566, 0.0074, 0.0315, 0.0402, 0.0930, 0.0378, 0.0145, 0.1958,
        0.3363])
[rfa agg] iter:  2, prev_obj_val: 66.14030456542969, obj_val: 70.42803192138672, abs dis: 4.287727355957031
[rfa agg] iter: 2, weight: tensor([0.1160, 0.2718, 0.0069, 0.0322, 0.0311, 0.0611, 0.0296, 0.0137, 0.1000,
        0.3374])
[rfa agg] iter:  3, prev_obj_val: 70.42803192138672, obj_val: 79.27310180664062, abs dis: 8.845069885253906
[rfa agg] iter: 3, weight: tensor([0.2608, 0.3173, 0.0084, 0.0447, 0.0315, 0.0544, 0.0302, 0.0172, 0.0785,
        0.1571])
[rfa agg] iter:  4, prev_obj_val: 79.27310180664062, obj_val: 79.26055908203125, abs dis: 0.012542724609375
[rfa agg] iter: 4, weight: tensor([0.2845, 0.1774, 0.0159, 0.1190, 0.0446, 0.0672, 0.0434, 0.0349, 0.0870,
        0.1261])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3146, Accuracy: 150/10000 (1.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 4.7718, Accuracy: 440/9950 (4.4221%)
saving model
Done in 458.30466628074646 sec.
Server Epoch:94 choose agents : [54, 23, 95, 98, 28, 52, 48, 24, 5, 3].
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0486, Accuracy: 396/1130 (35.0442%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0263, Accuracy: 553/1130 (48.9381%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.2891, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0605, Accuracy: 308/715 (43.0769%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0346, Accuracy: 444/715 (62.0979%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.3111, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  94, local model 95, internal_epoch   1, Avg loss: 0.0499, Accuracy: 351/599 (58.5977%)
_Train Local_ResNet_18, epoch  94, local model 95, internal_epoch   2, Avg loss: 0.0299, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 11.5467, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 98, internal_epoch   1, Avg loss: 0.0803, Accuracy: 36/373 (9.6515%)
_Train Local_ResNet_18, epoch  94, local model 98, internal_epoch   2, Avg loss: 0.0462, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.9041, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   1, Avg loss: 0.0548, Accuracy: 429/1581 (27.1347%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   2, Avg loss: 0.0313, Accuracy: 676/1581 (42.7577%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.7449, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   1, Avg loss: 0.0520, Accuracy: 304/636 (47.7987%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   2, Avg loss: 0.0257, Accuracy: 432/636 (67.9245%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.5688, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   1, Avg loss: 0.0658, Accuracy: 202/631 (32.0127%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   2, Avg loss: 0.0382, Accuracy: 285/631 (45.1664%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.3726, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   1, Avg loss: 0.0786, Accuracy: 52/312 (16.6667%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 190/312 (60.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.0918, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0463, Accuracy: 505/1628 (31.0197%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0227, Accuracy: 942/1628 (57.8624%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 10.2054, Accuracy: 146/10000 (1.4600%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0648, Accuracy: 175/781 (22.4072%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0320, Accuracy: 295/781 (37.7721%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.6093, Accuracy: 104/10000 (1.0400%)
time spent on training: 299.3291871547699
[rfa agg] training data poison_ratio: 0.0  data num: [1130, 715, 599, 373, 1581, 636, 631, 312, 1628, 781]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 23, 95, 98, 28, 52, 48, 24, 5, 3], weight: tensor([0.1347, 0.0853, 0.0714, 0.0445, 0.1885, 0.0758, 0.0752, 0.0372, 0.1941,
        0.0931])
[rfa agg] iter:  0, prev_obj_val: 60.864715576171875, obj_val: 61.96464920043945, abs dis: 1.0999336242675781
[rfa agg] iter: 0, weight: tensor([0.2133, 0.1354, 0.0695, 0.0242, 0.0919, 0.0735, 0.0733, 0.0182, 0.0861,
        0.2146])
[rfa agg] iter:  1, prev_obj_val: 61.96464920043945, obj_val: 63.96258544921875, abs dis: 1.9979362487792969
[rfa agg] iter: 1, weight: tensor([0.0727, 0.1921, 0.0638, 0.0173, 0.0426, 0.0671, 0.0673, 0.0126, 0.0405,
        0.4239])
[rfa agg] iter:  2, prev_obj_val: 63.96258544921875, obj_val: 74.48783111572266, abs dis: 10.525245666503906
[rfa agg] iter: 2, weight: tensor([0.0585, 0.3297, 0.0907, 0.0194, 0.0380, 0.0942, 0.0958, 0.0139, 0.0363,
        0.2236])
[rfa agg] iter:  3, prev_obj_val: 74.48783111572266, obj_val: 77.9499740600586, abs dis: 3.4621429443359375
[rfa agg] iter: 3, weight: tensor([0.0377, 0.0797, 0.2318, 0.0301, 0.0290, 0.2275, 0.2540, 0.0197, 0.0280,
        0.0626])
[rfa agg] iter:  4, prev_obj_val: 77.9499740600586, obj_val: 77.9490966796875, abs dis: 0.00087738037109375
[rfa agg] iter: 4, weight: tensor([0.0473, 0.0879, 0.2070, 0.0467, 0.0373, 0.2107, 0.2245, 0.0294, 0.0362,
        0.0729])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3135, Accuracy: 144/10000 (1.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 4.7952, Accuracy: 375/9950 (3.7688%)
saving model
Done in 404.35046195983887 sec.
Server Epoch:95 choose agents : [79, 4, 1, 10, 41, 2, 58, 11, 29, 77].
_Train Local_ResNet_18, epoch  95, local model 79, internal_epoch   1, Avg loss: 0.1069, Accuracy: 2/197 (1.0152%)
_Train Local_ResNet_18, epoch  95, local model 79, internal_epoch   2, Avg loss: 0.0846, Accuracy: 53/197 (26.9036%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.5472, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   1, Avg loss: 0.0566, Accuracy: 361/901 (40.0666%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   2, Avg loss: 0.0284, Accuracy: 447/901 (49.6115%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.7664, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0505, Accuracy: 387/928 (41.7026%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0205, Accuracy: 644/928 (69.3966%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.4245, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0521, Accuracy: 301/861 (34.9593%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0176, Accuracy: 528/861 (61.3240%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.4998, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   1, Avg loss: 0.0563, Accuracy: 332/719 (46.1752%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   2, Avg loss: 0.0292, Accuracy: 464/719 (64.5341%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.4314, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   1, Avg loss: 0.0618, Accuracy: 238/605 (39.3388%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   2, Avg loss: 0.0361, Accuracy: 330/605 (54.5455%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.0341, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0574, Accuracy: 323/803 (40.2242%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0332, Accuracy: 385/803 (47.9452%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.3481, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   1, Avg loss: 0.0518, Accuracy: 322/712 (45.2247%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   2, Avg loss: 0.0236, Accuracy: 444/712 (62.3596%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 10.0374, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0482, Accuracy: 476/1440 (33.0556%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0257, Accuracy: 763/1440 (52.9861%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.0605, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  95, local model 77, internal_epoch   1, Avg loss: 0.0471, Accuracy: 416/1340 (31.0448%)
_Train Local_ResNet_18, epoch  95, local model 77, internal_epoch   2, Avg loss: 0.0239, Accuracy: 682/1340 (50.8955%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.3398, Accuracy: 104/10000 (1.0400%)
time spent on training: 301.07639145851135
[rfa agg] training data poison_ratio: 0.0  data num: [197, 901, 928, 861, 719, 605, 803, 712, 1440, 1340]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [79, 4, 1, 10, 41, 2, 58, 11, 29, 77], weight: tensor([0.0232, 0.1059, 0.1091, 0.1012, 0.0845, 0.0711, 0.0944, 0.0837, 0.1693,
        0.1575])
[rfa agg] iter:  0, prev_obj_val: 35.499855041503906, obj_val: 48.72911834716797, abs dis: 13.229263305664062
[rfa agg] iter: 0, weight: tensor([0.0043, 0.1633, 0.1535, 0.2692, 0.0743, 0.0329, 0.1511, 0.0745, 0.0351,
        0.0418])
[rfa agg] iter:  1, prev_obj_val: 48.72911834716797, obj_val: 48.667903900146484, abs dis: 0.061214447021484375
[rfa agg] iter: 1, weight: tensor([0.0090, 0.0714, 0.0732, 0.0908, 0.1884, 0.1672, 0.1243, 0.1942, 0.0385,
        0.0429])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3151, Accuracy: 137/10000 (1.3700%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 4.8221, Accuracy: 245/9950 (2.4623%)
saving model
Done in 404.055721282959 sec.
Server Epoch:96 choose agents : [77, 9, 2, 30, 42, 20, 61, 3, 15, 6].
_Train Local_ResNet_18, epoch  96, local model 77, internal_epoch   1, Avg loss: 0.0467, Accuracy: 416/1340 (31.0448%)
_Train Local_ResNet_18, epoch  96, local model 77, internal_epoch   2, Avg loss: 0.0241, Accuracy: 636/1340 (47.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.0730, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0464, Accuracy: 425/1275 (33.3333%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0168, Accuracy: 806/1275 (63.2157%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.6788, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0599, Accuracy: 245/605 (40.4959%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0371, Accuracy: 329/605 (54.3802%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.1844, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   1, Avg loss: 0.0720, Accuracy: 116/486 (23.8683%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   2, Avg loss: 0.0368, Accuracy: 219/486 (45.0617%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.4049, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   1, Avg loss: 0.0527, Accuracy: 343/1372 (25.0000%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   2, Avg loss: 0.0297, Accuracy: 556/1372 (40.5248%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.1501, Accuracy: 94/10000 (0.9400%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  96, local model 20, internal_epoch   1, Avg loss: 0.0589, Accuracy: 287/807 (35.5638%)
_Train Local_ResNet_18, epoch  96, local model 20, internal_epoch   2, Avg loss: 0.0298, Accuracy: 426/807 (52.7881%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.3448, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   1, Avg loss: 0.1296, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   2, Avg loss: 0.1207, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3178, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0635, Accuracy: 168/781 (21.5109%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0315, Accuracy: 303/781 (38.7964%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.5442, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   1, Avg loss: 0.0538, Accuracy: 381/1154 (33.0156%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   2, Avg loss: 0.0246, Accuracy: 597/1154 (51.7331%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 10.3348, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0519, Accuracy: 458/1956 (23.4151%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0294, Accuracy: 744/1956 (38.0368%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.3899, Accuracy: 143/10000 (1.4300%)
time spent on training: 344.45400857925415
[rfa agg] training data poison_ratio: 0.08183754183145725  data num: [1340, 1275, 605, 486, 1372, 807, 85, 781, 1154, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.02557423182233039
[rfa agg] init. name: [77, 9, 2, 30, 42, 20, 61, 3, 15, 6], weight: tensor([0.1359, 0.1293, 0.0614, 0.0493, 0.1391, 0.0818, 0.0086, 0.0792, 0.1170,
        0.1984])
[rfa agg] iter:  0, prev_obj_val: 51.41233825683594, obj_val: 54.89860916137695, abs dis: 3.4862709045410156
[rfa agg] iter: 0, weight: tensor([0.1510, 0.2211, 0.0209, 0.0136, 0.1125, 0.0428, 0.0015, 0.0415, 0.3491,
        0.0459])
[rfa agg] iter:  1, prev_obj_val: 54.89860916137695, obj_val: 58.70567321777344, abs dis: 3.8070640563964844
[rfa agg] iter: 1, weight: tensor([0.1497, 0.1950, 0.0322, 0.0205, 0.1202, 0.0708, 0.0022, 0.0688, 0.2827,
        0.0579])
[rfa agg] iter:  2, prev_obj_val: 58.70567321777344, obj_val: 60.63496017456055, abs dis: 1.9292869567871094
[rfa agg] iter: 2, weight: tensor([0.1414, 0.1713, 0.0447, 0.0275, 0.1189, 0.1086, 0.0028, 0.1059, 0.2141,
        0.0648])
[rfa agg] iter:  3, prev_obj_val: 60.63496017456055, obj_val: 56.78904342651367, abs dis: 3.845916748046875
[rfa agg] iter: 3, weight: tensor([0.1330, 0.1571, 0.0504, 0.0304, 0.1138, 0.1315, 0.0030, 0.1284, 0.1872,
        0.0653])
[rfa agg] iter:  4, prev_obj_val: 56.78904342651367, obj_val: 56.78458023071289, abs dis: 0.00446319580078125
[rfa agg] iter: 4, weight: tensor([0.1477, 0.1848, 0.0387, 0.0242, 0.1217, 0.0893, 0.0025, 0.0868, 0.2416,
        0.0625])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3136, Accuracy: 140/10000 (1.4000%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 4.8497, Accuracy: 212/9950 (2.1307%)
saving model
Done in 450.51380920410156 sec.
Server Epoch:97 choose agents : [38, 36, 83, 74, 84, 8, 27, 41, 26, 54].
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   1, Avg loss: 0.0525, Accuracy: 397/1131 (35.1017%)
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   2, Avg loss: 0.0266, Accuracy: 528/1131 (46.6844%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.0391, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   1, Avg loss: 0.0808, Accuracy: 70/408 (17.1569%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   2, Avg loss: 0.0465, Accuracy: 149/408 (36.5196%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.9901, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0520, Accuracy: 510/1953 (26.1137%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0301, Accuracy: 930/1953 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.7922, Accuracy: 137/10000 (1.3700%)
_Train Local_ResNet_18, epoch  97, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 584/1552 (37.6289%)
_Train Local_ResNet_18, epoch  97, local model 74, internal_epoch   2, Avg loss: 0.0193, Accuracy: 856/1552 (55.1546%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 11.8291, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   1, Avg loss: 0.0550, Accuracy: 359/1190 (30.1681%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   2, Avg loss: 0.0282, Accuracy: 538/1190 (45.2101%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.3104, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   1, Avg loss: 0.0551, Accuracy: 366/1513 (24.1904%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   2, Avg loss: 0.0335, Accuracy: 577/1513 (38.1362%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.9860, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   1, Avg loss: 0.0546, Accuracy: 440/1587 (27.7253%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   2, Avg loss: 0.0317, Accuracy: 662/1587 (41.7139%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.8952, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0536, Accuracy: 341/719 (47.4270%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0290, Accuracy: 450/719 (62.5869%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.4948, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0534, Accuracy: 387/1446 (26.7635%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0323, Accuracy: 576/1446 (39.8340%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.7233, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   1, Avg loss: 0.0495, Accuracy: 379/1130 (33.5398%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   2, Avg loss: 0.0268, Accuracy: 500/1130 (44.2478%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.3309, Accuracy: 74/10000 (0.7400%)
time spent on training: 403.5218708515167
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 408, 1953, 1552, 1190, 1513, 1587, 719, 1446, 1130]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 36, 83, 74, 84, 8, 27, 41, 26, 54], weight: tensor([0.0896, 0.0323, 0.1546, 0.1229, 0.0942, 0.1198, 0.1257, 0.0569, 0.1145,
        0.0895])
[rfa agg] iter:  0, prev_obj_val: 45.13886642456055, obj_val: 49.39702224731445, abs dis: 4.258155822753906
[rfa agg] iter: 0, weight: tensor([0.1224, 0.0086, 0.0528, 0.0960, 0.1940, 0.1199, 0.0992, 0.0240, 0.1587,
        0.1244])
[rfa agg] iter:  1, prev_obj_val: 49.39702224731445, obj_val: 56.862586975097656, abs dis: 7.465564727783203
[rfa agg] iter: 1, weight: tensor([0.1849, 0.0071, 0.0337, 0.0530, 0.3116, 0.0621, 0.0546, 0.0212, 0.0741,
        0.1979])
[rfa agg] iter:  2, prev_obj_val: 56.862586975097656, obj_val: 60.24353790283203, abs dis: 3.380950927734375
[rfa agg] iter: 2, weight: tensor([0.2730, 0.0085, 0.0314, 0.0446, 0.1580, 0.0502, 0.0458, 0.0282, 0.0567,
        0.3037])
[rfa agg] iter:  3, prev_obj_val: 60.24353790283203, obj_val: 60.24226760864258, abs dis: 0.001270294189453125
[rfa agg] iter: 3, weight: tensor([0.2572, 0.0112, 0.0383, 0.0528, 0.1517, 0.0590, 0.0543, 0.0391, 0.0657,
        0.2707])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3125, Accuracy: 148/10000 (1.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 4.8808, Accuracy: 157/9950 (1.5779%)
saving model
Done in 505.66771841049194 sec.
Server Epoch:98 choose agents : [70, 56, 62, 89, 72, 16, 25, 33, 22, 57].
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   1, Avg loss: 0.0502, Accuracy: 526/1418 (37.0945%)
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   2, Avg loss: 0.0275, Accuracy: 730/1418 (51.4810%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.2305, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 5/186 (2.6882%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0664, Accuracy: 73/186 (39.2473%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.4010, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0687, Accuracy: 164/568 (28.8732%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0381, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.3413, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   1, Avg loss: 0.0574, Accuracy: 341/896 (38.0580%)
_Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   2, Avg loss: 0.0312, Accuracy: 451/896 (50.3348%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.3045, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   1, Avg loss: 0.0574, Accuracy: 329/1241 (26.5109%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   2, Avg loss: 0.0336, Accuracy: 506/1241 (40.7736%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.7894, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0594, Accuracy: 292/708 (41.2429%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0300, Accuracy: 451/708 (63.7006%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.3085, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   1, Avg loss: 0.0527, Accuracy: 313/690 (45.3623%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   2, Avg loss: 0.0221, Accuracy: 477/690 (69.1304%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.2335, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   1, Avg loss: 0.0753, Accuracy: 118/515 (22.9126%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   2, Avg loss: 0.0493, Accuracy: 164/515 (31.8447%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.1073, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   1, Avg loss: 0.0445, Accuracy: 626/1470 (42.5850%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   2, Avg loss: 0.0224, Accuracy: 910/1470 (61.9048%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.2972, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   1, Avg loss: 0.0523, Accuracy: 323/1154 (27.9896%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   2, Avg loss: 0.0230, Accuracy: 572/1154 (49.5667%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 11.4812, Accuracy: 61/10000 (0.6100%)
time spent on training: 313.67583775520325
[rfa agg] training data poison_ratio: 0.0  data num: [1418, 186, 568, 896, 1241, 708, 690, 515, 1470, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 56, 62, 89, 72, 16, 25, 33, 22, 57], weight: tensor([0.1603, 0.0210, 0.0642, 0.1013, 0.1403, 0.0800, 0.0780, 0.0582, 0.1662,
        0.1305])
[rfa agg] iter:  0, prev_obj_val: 50.57841110229492, obj_val: 54.8790397644043, abs dis: 4.300628662109375
[rfa agg] iter: 0, weight: tensor([0.0668, 0.0065, 0.0414, 0.3989, 0.0902, 0.1100, 0.0781, 0.0375, 0.0692,
        0.1014])
[rfa agg] iter:  1, prev_obj_val: 54.8790397644043, obj_val: 61.00933074951172, abs dis: 6.130290985107422
[rfa agg] iter: 1, weight: tensor([0.0532, 0.0070, 0.0532, 0.3019, 0.0665, 0.2198, 0.1236, 0.0480, 0.0551,
        0.0717])
[rfa agg] iter:  2, prev_obj_val: 61.00933074951172, obj_val: 63.55142593383789, abs dis: 2.542095184326172
[rfa agg] iter: 2, weight: tensor([0.0389, 0.0069, 0.0707, 0.1104, 0.0460, 0.2918, 0.2831, 0.0635, 0.0403,
        0.0483])
[rfa agg] iter:  3, prev_obj_val: 63.55142593383789, obj_val: 66.50772094726562, abs dis: 2.9562950134277344
[rfa agg] iter: 3, weight: tensor([0.0335, 0.0066, 0.0785, 0.0824, 0.0391, 0.1806, 0.4326, 0.0710, 0.0348,
        0.0408])
[rfa agg] iter:  4, prev_obj_val: 66.50772094726562, obj_val: 69.65106964111328, abs dis: 3.1433486938476562
[rfa agg] iter: 4, weight: tensor([0.0374, 0.0082, 0.1186, 0.0826, 0.0431, 0.1456, 0.3734, 0.1077, 0.0388,
        0.0447])
[rfa agg] iter:  5, prev_obj_val: 69.65106964111328, obj_val: 69.64000701904297, abs dis: 0.0110626220703125
[rfa agg] iter: 5, weight: tensor([0.0406, 0.0099, 0.1915, 0.0820, 0.0462, 0.1265, 0.2403, 0.1735, 0.0420,
        0.0476])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3115, Accuracy: 146/10000 (1.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 4.9041, Accuracy: 110/9950 (1.1055%)
saving model
Done in 413.2695691585541 sec.
Server Epoch:99 choose agents : [24, 49, 35, 66, 25, 81, 38, 62, 92, 78].
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.0779, Accuracy: 38/312 (12.1795%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0384, Accuracy: 198/312 (63.4615%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.2084, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   1, Avg loss: 0.0729, Accuracy: 92/440 (20.9091%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   2, Avg loss: 0.0437, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.7167, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.0878, Accuracy: 33/271 (12.1771%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0536, Accuracy: 136/271 (50.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.2979, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0582, Accuracy: 307/1402 (21.8973%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0366, Accuracy: 431/1402 (30.7418%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.1639, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   1, Avg loss: 0.0499, Accuracy: 323/690 (46.8116%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   2, Avg loss: 0.0224, Accuracy: 476/690 (68.9855%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.3481, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  99, local model 81, internal_epoch   1, Avg loss: 0.0566, Accuracy: 307/774 (39.6641%)
_Train Local_ResNet_18, epoch  99, local model 81, internal_epoch   2, Avg loss: 0.0305, Accuracy: 362/774 (46.7700%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.2983, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   1, Avg loss: 0.0504, Accuracy: 409/1131 (36.1627%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   2, Avg loss: 0.0256, Accuracy: 561/1131 (49.6021%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.6719, Accuracy: 135/10000 (1.3500%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   1, Avg loss: 0.0672, Accuracy: 166/568 (29.2254%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   2, Avg loss: 0.0389, Accuracy: 262/568 (46.1268%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.3801, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  99, local model 92, internal_epoch   1, Avg loss: 0.0510, Accuracy: 493/1715 (28.7464%)
_Train Local_ResNet_18, epoch  99, local model 92, internal_epoch   2, Avg loss: 0.0279, Accuracy: 843/1715 (49.1545%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.1291, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  99, local model 78, internal_epoch   1, Avg loss: 0.0773, Accuracy: 87/416 (20.9135%)
_Train Local_ResNet_18, epoch  99, local model 78, internal_epoch   2, Avg loss: 0.0415, Accuracy: 228/416 (54.8077%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.1948, Accuracy: 87/10000 (0.8700%)
time spent on training: 274.705828666687
[rfa agg] training data poison_ratio: 0.0  data num: [312, 440, 271, 1402, 690, 774, 1131, 568, 1715, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 49, 35, 66, 25, 81, 38, 62, 92, 78], weight: tensor([0.0404, 0.0570, 0.0351, 0.1816, 0.0894, 0.1003, 0.1465, 0.0736, 0.2222,
        0.0539])
[rfa agg] iter:  0, prev_obj_val: 64.68084716796875, obj_val: 67.68120574951172, abs dis: 3.0003585815429688
[rfa agg] iter: 0, weight: tensor([0.0179, 0.0330, 0.0156, 0.0805, 0.1316, 0.4452, 0.1216, 0.0614, 0.0620,
        0.0312])
[rfa agg] iter:  1, prev_obj_val: 67.68120574951172, obj_val: 70.59423828125, abs dis: 2.9130325317382812
[rfa agg] iter: 1, weight: tensor([0.0202, 0.0397, 0.0175, 0.0634, 0.2755, 0.3250, 0.0848, 0.0847, 0.0517,
        0.0375])
[rfa agg] iter:  2, prev_obj_val: 70.59423828125, obj_val: 79.16277313232422, abs dis: 8.568534851074219
[rfa agg] iter: 2, weight: tensor([0.0178, 0.0374, 0.0154, 0.0435, 0.5358, 0.1287, 0.0550, 0.0945, 0.0366,
        0.0353])
[rfa agg] iter:  3, prev_obj_val: 79.16277313232422, obj_val: 84.45675659179688, abs dis: 5.293983459472656
[rfa agg] iter: 3, weight: tensor([0.0309, 0.0848, 0.0268, 0.0428, 0.1359, 0.0760, 0.0498, 0.4354, 0.0378,
        0.0799])
[rfa agg] iter:  4, prev_obj_val: 84.45675659179688, obj_val: 87.27420043945312, abs dis: 2.81744384765625
[rfa agg] iter: 4, weight: tensor([0.0466, 0.1858, 0.0404, 0.0450, 0.1018, 0.0690, 0.0507, 0.2472, 0.0405,
        0.1730])
[rfa agg] iter:  5, prev_obj_val: 87.27420043945312, obj_val: 93.84213256835938, abs dis: 6.56793212890625
[rfa agg] iter: 5, weight: tensor([0.0468, 0.2816, 0.0405, 0.0363, 0.0733, 0.0526, 0.0404, 0.1393, 0.0331,
        0.2561])
[rfa agg] iter:  6, prev_obj_val: 93.84213256835938, obj_val: 93.84114074707031, abs dis: 0.0009918212890625
[rfa agg] iter: 6, weight: tensor([0.0781, 0.2943, 0.0674, 0.0343, 0.0578, 0.0450, 0.0373, 0.0854, 0.0318,
        0.2685])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3104, Accuracy: 141/10000 (1.4100%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 4.9206, Accuracy: 75/9950 (0.7538%)
saving model
Done in 381.31305503845215 sec.
Server Epoch:100 choose agents : [47, 65, 85, 24, 39, 5, 1, 53, 87, 58].
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   1, Avg loss: 0.1190, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   2, Avg loss: 0.1053, Accuracy: 17/134 (12.6866%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3612, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   1, Avg loss: 0.0515, Accuracy: 458/1475 (31.0508%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   2, Avg loss: 0.0266, Accuracy: 775/1475 (52.5424%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.6678, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch 100, local model 85, internal_epoch   1, Avg loss: 0.0531, Accuracy: 512/1988 (25.7545%)
_Train Local_ResNet_18, epoch 100, local model 85, internal_epoch   2, Avg loss: 0.0339, Accuracy: 750/1988 (37.7264%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.0275, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   1, Avg loss: 0.0757, Accuracy: 54/312 (17.3077%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   2, Avg loss: 0.0376, Accuracy: 192/312 (61.5385%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.1266, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0469, Accuracy: 346/1013 (34.1560%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0233, Accuracy: 563/1013 (55.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.2901, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   1, Avg loss: 0.0464, Accuracy: 535/1628 (32.8624%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   2, Avg loss: 0.0222, Accuracy: 930/1628 (57.1253%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.1378, Accuracy: 158/10000 (1.5800%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   1, Avg loss: 0.0504, Accuracy: 381/928 (41.0560%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   2, Avg loss: 0.0199, Accuracy: 648/928 (69.8276%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.2291, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0440, Accuracy: 335/813 (41.2054%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0180, Accuracy: 514/813 (63.2226%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 12.8155, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch 100, local model 87, internal_epoch   1, Avg loss: 0.0537, Accuracy: 317/1131 (28.0283%)
_Train Local_ResNet_18, epoch 100, local model 87, internal_epoch   2, Avg loss: 0.0287, Accuracy: 472/1131 (41.7330%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.5765, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0564, Accuracy: 323/803 (40.2242%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0322, Accuracy: 417/803 (51.9303%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.3891, Accuracy: 70/10000 (0.7000%)
time spent on training: 360.9847204685211
[rfa agg] training data poison_ratio: 0.0  data num: [134, 1475, 1988, 312, 1013, 1628, 928, 813, 1131, 803]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [47, 65, 85, 24, 39, 5, 1, 53, 87, 58], weight: tensor([0.0131, 0.1443, 0.1944, 0.0305, 0.0991, 0.1592, 0.0908, 0.0795, 0.1106,
        0.0785])
[rfa agg] iter:  0, prev_obj_val: 60.67438888549805, obj_val: 63.706214904785156, abs dis: 3.0318260192871094
[rfa agg] iter: 0, weight: tensor([0.0034, 0.1169, 0.0614, 0.0090, 0.1326, 0.0929, 0.0915, 0.0542, 0.3847,
        0.0535])
[rfa agg] iter:  1, prev_obj_val: 63.706214904785156, obj_val: 68.71589660644531, abs dis: 5.009681701660156
[rfa agg] iter: 1, weight: tensor([0.0028, 0.0545, 0.0357, 0.0076, 0.3699, 0.0476, 0.1523, 0.0637, 0.2029,
        0.0630])
[rfa agg] iter:  2, prev_obj_val: 68.71589660644531, obj_val: 73.67678833007812, abs dis: 4.9608917236328125
[rfa agg] iter: 2, weight: tensor([0.0029, 0.0430, 0.0308, 0.0082, 0.2468, 0.0389, 0.3286, 0.1020, 0.0980,
        0.1008])
[rfa agg] iter:  3, prev_obj_val: 73.67678833007812, obj_val: 71.0619125366211, abs dis: 2.6148757934570312
[rfa agg] iter: 3, weight: tensor([0.0036, 0.0436, 0.0327, 0.0103, 0.1454, 0.0402, 0.2376, 0.2034, 0.0830,
        0.2003])
[rfa agg] iter:  4, prev_obj_val: 71.0619125366211, obj_val: 71.04698944091797, abs dis: 0.014923095703125
[rfa agg] iter: 4, weight: tensor([0.0033, 0.0440, 0.0323, 0.0093, 0.1790, 0.0401, 0.3123, 0.1455, 0.0905,
        0.1436])
[rfa agg] iter:  5, prev_obj_val: 71.04698944091797, obj_val: 71.0465316772461, abs dis: 0.000457763671875
[rfa agg] iter: 5, weight: tensor([0.0032, 0.0431, 0.0316, 0.0092, 0.1761, 0.0393, 0.3295, 0.1405, 0.0888,
        0.1386])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3103, Accuracy: 161/10000 (1.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 4.9254, Accuracy: 65/9950 (0.6533%)
saving model
Done in 461.04153203964233 sec.
Saving all the graphs.
This run has a label: Jun.27_07.37.31. Visdom environment: tiny
