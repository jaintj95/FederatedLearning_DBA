current path: saved_models/model_tiny_Jun.19_12.01.27
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [17]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [83, 85, 64, 95, 54, 55, 27, 92, 15, 78].
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 426/1953 (21.8126%)
_Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0344, Accuracy: 728/1953 (37.2760%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.1897, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 453/1988 (22.7867%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 650/1988 (32.6962%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.2099, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 164/953 (17.2088%)
_Train Local_ResNet_18, epoch   1, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 298/953 (31.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.2897, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   1, Avg loss: 0.0530, Accuracy: 320/599 (53.4224%)
_Train Local_ResNet_18, epoch   1, local model 95, internal_epoch   2, Avg loss: 0.0295, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7795, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 335/1130 (29.6460%)
_Train Local_ResNet_18, epoch   1, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 485/1130 (42.9204%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5451, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0567, Accuracy: 227/1071 (21.1951%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 480/1071 (44.8179%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7097, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 430/1587 (27.0951%)
_Train Local_ResNet_18, epoch   1, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 622/1587 (39.1934%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.3658, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 453/1715 (26.4140%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 702/1715 (40.9329%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5987, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   1, Avg loss: 0.0573, Accuracy: 315/1154 (27.2964%)
_Train Local_ResNet_18, epoch   1, local model 15, internal_epoch   2, Avg loss: 0.0307, Accuracy: 381/1154 (33.0156%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6840, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 34/416 (8.1731%)
_Train Local_ResNet_18, epoch   1, local model 78, internal_epoch   2, Avg loss: 0.0467, Accuracy: 166/416 (39.9038%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5653, Accuracy: 50/10000 (0.5000%)
time spent on training: 96.15830135345459
[foolsgold agg] training data poison_ratio: 0.0  data num: [1953, 1988, 953, 599, 1130, 1071, 1587, 1715, 1154, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3168, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6204, Accuracy: 0/9950 (0.0000%)
saving model
Done in 164.47349071502686 sec.
Server Epoch:2 choose agents : [64, 47, 43, 23, 24, 98, 84, 28, 6, 17].
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   1, Avg loss: 0.0654, Accuracy: 167/953 (17.5236%)
_Train Local_ResNet_18, epoch   2, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 322/953 (33.7880%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.5463, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   1, Avg loss: 0.1221, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch   2, local model 47, internal_epoch   2, Avg loss: 0.1141, Accuracy: 16/134 (11.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 307/946 (32.4524%)
_Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0364, Accuracy: 338/946 (35.7294%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.9753, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   1, Avg loss: 0.0610, Accuracy: 317/715 (44.3357%)
_Train Local_ResNet_18, epoch   2, local model 23, internal_epoch   2, Avg loss: 0.0384, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.7299, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 34/312 (10.8974%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 168/312 (53.8462%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3720, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   1, Avg loss: 0.0831, Accuracy: 9/373 (2.4129%)
_Train Local_ResNet_18, epoch   2, local model 98, internal_epoch   2, Avg loss: 0.0492, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.4481, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 310/1190 (26.0504%)
_Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0333, Accuracy: 425/1190 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9438, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0569, Accuracy: 376/1581 (23.7824%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 603/1581 (38.1404%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.4840, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   1, Avg loss: 0.0558, Accuracy: 367/1956 (18.7628%)
_Train Local_ResNet_18, epoch   2, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 647/1956 (33.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.5308, Accuracy: 91/10000 (0.9100%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 389/1574 (24.7141%)
_Train Local_ResNet_18, epoch   2, local model 17, internal_epoch   2, Avg loss: 0.0284, Accuracy: 617/1574 (39.1995%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.1005, Accuracy: 92/10000 (0.9200%)
time spent on training: 108.69258427619934
[foolsgold agg] training data poison_ratio: 0.1617012533388124  data num: [953, 134, 946, 715, 312, 373, 1190, 1581, 1956, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.05053164166837888
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3167, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6184, Accuracy: 0/9950 (0.0000%)
saving model
Done in 175.93055486679077 sec.
Server Epoch:3 choose agents : [75, 58, 7, 84, 94, 13, 3, 69, 93, 10].
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   1, Avg loss: 0.0630, Accuracy: 235/776 (30.2835%)
_Train Local_ResNet_18, epoch   3, local model 75, internal_epoch   2, Avg loss: 0.0286, Accuracy: 426/776 (54.8969%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8832, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   1, Avg loss: 0.0585, Accuracy: 348/803 (43.3375%)
_Train Local_ResNet_18, epoch   3, local model 58, internal_epoch   2, Avg loss: 0.0336, Accuracy: 410/803 (51.0585%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.9156, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 344/891 (38.6083%)
_Train Local_ResNet_18, epoch   3, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 464/891 (52.0763%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.0858, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   1, Avg loss: 0.0635, Accuracy: 307/1190 (25.7983%)
_Train Local_ResNet_18, epoch   3, local model 84, internal_epoch   2, Avg loss: 0.0330, Accuracy: 437/1190 (36.7227%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.9500, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   1, Avg loss: 0.0557, Accuracy: 326/1662 (19.6149%)
_Train Local_ResNet_18, epoch   3, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 583/1662 (35.0782%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7295, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0588, Accuracy: 294/1645 (17.8723%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 617/1645 (37.5076%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6835, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   1, Avg loss: 0.0761, Accuracy: 102/781 (13.0602%)
_Train Local_ResNet_18, epoch   3, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 238/781 (30.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.5694, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 276/590 (46.7797%)
_Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0313, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.8500, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 417/1742 (23.9380%)
_Train Local_ResNet_18, epoch   3, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 697/1742 (40.0115%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0592, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   1, Avg loss: 0.0574, Accuracy: 207/861 (24.0418%)
_Train Local_ResNet_18, epoch   3, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 448/861 (52.0325%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.9423, Accuracy: 52/10000 (0.5200%)
time spent on training: 92.39375805854797
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 803, 891, 1190, 1662, 1645, 781, 590, 1742, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3166, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6183, Accuracy: 0/9950 (0.0000%)
saving model
Done in 162.32550072669983 sec.
Server Epoch:4 choose agents : [20, 64, 31, 75, 6, 23, 40, 51, 12, 63].
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   1, Avg loss: 0.0563, Accuracy: 339/807 (42.0074%)
_Train Local_ResNet_18, epoch   4, local model 20, internal_epoch   2, Avg loss: 0.0317, Accuracy: 429/807 (53.1599%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.2237, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0655, Accuracy: 173/953 (18.1532%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 315/953 (33.0535%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.2795, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0825, Accuracy: 52/460 (11.3043%)
_Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7337, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 243/776 (31.3144%)
_Train Local_ResNet_18, epoch   4, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 405/776 (52.1907%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.9763, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   1, Avg loss: 0.0559, Accuracy: 399/1956 (20.3988%)
_Train Local_ResNet_18, epoch   4, local model 6, internal_epoch   2, Avg loss: 0.0333, Accuracy: 584/1956 (29.8569%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.2851, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   1, Avg loss: 0.0626, Accuracy: 317/715 (44.3357%)
_Train Local_ResNet_18, epoch   4, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.6965, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   1, Avg loss: 0.0556, Accuracy: 344/1573 (21.8690%)
_Train Local_ResNet_18, epoch   4, local model 40, internal_epoch   2, Avg loss: 0.0344, Accuracy: 586/1573 (37.2537%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.6676, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 220/1049 (20.9724%)
_Train Local_ResNet_18, epoch   4, local model 51, internal_epoch   2, Avg loss: 0.0309, Accuracy: 502/1049 (47.8551%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.3771, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   1, Avg loss: 0.0887, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch   4, local model 12, internal_epoch   2, Avg loss: 0.0489, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.4257, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   1, Avg loss: 0.0551, Accuracy: 256/888 (28.8288%)
_Train Local_ResNet_18, epoch   4, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 416/888 (46.8468%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.0736, Accuracy: 51/10000 (0.5100%)
time spent on training: 91.45373368263245
[foolsgold agg] training data poison_ratio: 0.0  data num: [807, 953, 460, 776, 1956, 715, 1573, 1049, 338, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3165, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6169, Accuracy: 0/9950 (0.0000%)
saving model
Done in 158.50437998771667 sec.
Server Epoch:5 choose agents : [61, 96, 54, 1, 51, 20, 46, 92, 90, 82].
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   1, Avg loss: 0.1250, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch   5, local model 61, internal_epoch   2, Avg loss: 0.1183, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3045, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   1, Avg loss: 0.0791, Accuracy: 42/311 (13.5048%)
_Train Local_ResNet_18, epoch   5, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3459, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   1, Avg loss: 0.0555, Accuracy: 329/1130 (29.1150%)
_Train Local_ResNet_18, epoch   5, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 478/1130 (42.3009%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.4412, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   1, Avg loss: 0.0579, Accuracy: 284/928 (30.6034%)
_Train Local_ResNet_18, epoch   5, local model 1, internal_epoch   2, Avg loss: 0.0246, Accuracy: 528/928 (56.8966%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8859, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   1, Avg loss: 0.0609, Accuracy: 219/1049 (20.8770%)
_Train Local_ResNet_18, epoch   5, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 550/1049 (52.4309%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.4368, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 343/807 (42.5031%)
_Train Local_ResNet_18, epoch   5, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 437/807 (54.1512%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.9461, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   1, Avg loss: 0.0560, Accuracy: 378/1904 (19.8529%)
_Train Local_ResNet_18, epoch   5, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 654/1904 (34.3487%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.7445, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 469/1715 (27.3469%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 703/1715 (40.9913%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5360, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   1, Avg loss: 0.0567, Accuracy: 308/677 (45.4948%)
_Train Local_ResNet_18, epoch   5, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 444/677 (65.5835%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.9956, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0771, Accuracy: 56/500 (11.2000%)
_Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.5967, Accuracy: 48/10000 (0.4800%)
time spent on training: 88.68909645080566
[foolsgold agg] training data poison_ratio: 0.0  data num: [85, 311, 1130, 928, 1049, 807, 1904, 1715, 677, 500]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3163, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.6166, Accuracy: 0/9950 (0.0000%)
saving model
Done in 154.97309803962708 sec.
Server Epoch:6 choose agents : [41, 84, 93, 94, 55, 85, 52, 32, 43, 95].
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   1, Avg loss: 0.0605, Accuracy: 327/719 (45.4798%)
_Train Local_ResNet_18, epoch   6, local model 41, internal_epoch   2, Avg loss: 0.0300, Accuracy: 464/719 (64.5341%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.2670, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 327/1190 (27.4790%)
_Train Local_ResNet_18, epoch   6, local model 84, internal_epoch   2, Avg loss: 0.0327, Accuracy: 451/1190 (37.8992%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.1093, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 417/1742 (23.9380%)
_Train Local_ResNet_18, epoch   6, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 690/1742 (39.6096%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6969, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 314/1662 (18.8929%)
_Train Local_ResNet_18, epoch   6, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 587/1662 (35.3189%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8260, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 240/1071 (22.4090%)
_Train Local_ResNet_18, epoch   6, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 503/1071 (46.9655%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.9728, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 442/1988 (22.2334%)
_Train Local_ResNet_18, epoch   6, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 668/1988 (33.6016%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8874, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0574, Accuracy: 275/636 (43.2390%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0310, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.1425, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   1, Avg loss: 0.0615, Accuracy: 196/735 (26.6667%)
_Train Local_ResNet_18, epoch   6, local model 32, internal_epoch   2, Avg loss: 0.0229, Accuracy: 346/735 (47.0748%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.4216, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   1, Avg loss: 0.0630, Accuracy: 293/946 (30.9725%)
_Train Local_ResNet_18, epoch   6, local model 43, internal_epoch   2, Avg loss: 0.0371, Accuracy: 323/946 (34.1438%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.1653, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 327/599 (54.5910%)
_Train Local_ResNet_18, epoch   6, local model 95, internal_epoch   2, Avg loss: 0.0299, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5795, Accuracy: 50/10000 (0.5000%)
time spent on training: 106.26580595970154
[foolsgold agg] training data poison_ratio: 0.0  data num: [719, 1190, 1742, 1662, 1071, 1988, 636, 735, 946, 599]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3162, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.6129, Accuracy: 0/9950 (0.0000%)
saving model
Done in 173.40909552574158 sec.
Server Epoch:7 choose agents : [54, 60, 32, 23, 69, 52, 79, 83, 9, 90].
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 338/1130 (29.9115%)
_Train Local_ResNet_18, epoch   7, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 460/1130 (40.7080%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8430, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0499, Accuracy: 583/2227 (26.1787%)
_Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1038/2227 (46.6098%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4660, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   1, Avg loss: 0.0611, Accuracy: 205/735 (27.8912%)
_Train Local_ResNet_18, epoch   7, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 360/735 (48.9796%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7375, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   1, Avg loss: 0.0597, Accuracy: 314/715 (43.9161%)
_Train Local_ResNet_18, epoch   7, local model 23, internal_epoch   2, Avg loss: 0.0399, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.7460, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   1, Avg loss: 0.0573, Accuracy: 282/590 (47.7966%)
_Train Local_ResNet_18, epoch   7, local model 69, internal_epoch   2, Avg loss: 0.0325, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.8730, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 275/636 (43.2390%)
_Train Local_ResNet_18, epoch   7, local model 52, internal_epoch   2, Avg loss: 0.0321, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.4713, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.0990, Accuracy: 14/197 (7.1066%)
_Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0843, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3241, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   1, Avg loss: 0.0551, Accuracy: 385/1953 (19.7133%)
_Train Local_ResNet_18, epoch   7, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 714/1953 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8781, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   1, Avg loss: 0.0503, Accuracy: 350/1275 (27.4510%)
_Train Local_ResNet_18, epoch   7, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 696/1275 (54.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.1948, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 314/677 (46.3811%)
_Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0241, Accuracy: 426/677 (62.9247%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.1626, Accuracy: 55/10000 (0.5500%)
time spent on training: 101.48468852043152
[foolsgold agg] training data poison_ratio: 0.0  data num: [1130, 2227, 735, 715, 590, 636, 197, 1953, 1275, 677]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 0. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3162, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.6080, Accuracy: 0/9950 (0.0000%)
saving model
Done in 169.19202828407288 sec.
Server Epoch:8 choose agents : [64, 23, 12, 0, 58, 28, 45, 16, 11, 62].
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 161/953 (16.8940%)
_Train Local_ResNet_18, epoch   8, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 284/953 (29.8006%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.3615, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   1, Avg loss: 0.0620, Accuracy: 311/715 (43.4965%)
_Train Local_ResNet_18, epoch   8, local model 23, internal_epoch   2, Avg loss: 0.0377, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.7203, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 15/338 (4.4379%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0470, Accuracy: 137/338 (40.5325%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.4357, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 353/1657 (21.3036%)
_Train Local_ResNet_18, epoch   8, local model 0, internal_epoch   2, Avg loss: 0.0352, Accuracy: 475/1657 (28.6663%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.5860, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   1, Avg loss: 0.0588, Accuracy: 342/803 (42.5903%)
_Train Local_ResNet_18, epoch   8, local model 58, internal_epoch   2, Avg loss: 0.0350, Accuracy: 362/803 (45.0809%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.9165, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 387/1581 (24.4782%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 578/1581 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.6027, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   1, Avg loss: 0.0688, Accuracy: 194/669 (28.9985%)
_Train Local_ResNet_18, epoch   8, local model 45, internal_epoch   2, Avg loss: 0.0408, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.8235, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0613, Accuracy: 281/708 (39.6893%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0379, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.7974, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   1, Avg loss: 0.0540, Accuracy: 342/712 (48.0337%)
_Train Local_ResNet_18, epoch   8, local model 11, internal_epoch   2, Avg loss: 0.0291, Accuracy: 422/712 (59.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.4857, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   1, Avg loss: 0.0695, Accuracy: 136/568 (23.9437%)
_Train Local_ResNet_18, epoch   8, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.6887, Accuracy: 48/10000 (0.4800%)
time spent on training: 101.24452137947083
[foolsgold agg] training data poison_ratio: 0.0  data num: [953, 715, 338, 1657, 803, 1581, 669, 708, 712, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         0.81463439 0.81463439 1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3161, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.6061, Accuracy: 0/9950 (0.0000%)
saving model
Done in 170.6955451965332 sec.
Server Epoch:9 choose agents : [37, 84, 60, 12, 87, 98, 51, 76, 36, 92].
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0522, Accuracy: 379/1129 (33.5695%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0255, Accuracy: 718/1129 (63.5961%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.3718, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0634, Accuracy: 309/1190 (25.9664%)
_Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0328, Accuracy: 423/1190 (35.5462%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.9357, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   1, Avg loss: 0.0502, Accuracy: 514/2227 (23.0804%)
_Train Local_ResNet_18, epoch   9, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1013/2227 (45.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.0468, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 18/338 (5.3254%)
_Train Local_ResNet_18, epoch   9, local model 12, internal_epoch   2, Avg loss: 0.0487, Accuracy: 143/338 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4358, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   1, Avg loss: 0.0588, Accuracy: 290/1131 (25.6410%)
_Train Local_ResNet_18, epoch   9, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 390/1131 (34.4828%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.6785, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   1, Avg loss: 0.0831, Accuracy: 12/373 (3.2172%)
_Train Local_ResNet_18, epoch   9, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4259, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 236/1049 (22.4976%)
_Train Local_ResNet_18, epoch   9, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 505/1049 (48.1411%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.8702, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   1, Avg loss: 0.0866, Accuracy: 35/466 (7.5107%)
_Train Local_ResNet_18, epoch   9, local model 76, internal_epoch   2, Avg loss: 0.0493, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.6334, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   1, Avg loss: 0.0876, Accuracy: 71/408 (17.4020%)
_Train Local_ResNet_18, epoch   9, local model 36, internal_epoch   2, Avg loss: 0.0559, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4829, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 448/1715 (26.1224%)
_Train Local_ResNet_18, epoch   9, local model 92, internal_epoch   2, Avg loss: 0.0315, Accuracy: 693/1715 (40.4082%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.6284, Accuracy: 83/10000 (0.8300%)
time spent on training: 101.04168725013733
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 1190, 2227, 338, 1131, 373, 1049, 466, 408, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3160, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.6049, Accuracy: 0/9950 (0.0000%)
saving model
Done in 168.88744163513184 sec.
Server Epoch:10 choose agents : [71, 14, 55, 43, 88, 30, 56, 96, 98, 5].
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   1, Avg loss: 0.0649, Accuracy: 137/818 (16.7482%)
_Train Local_ResNet_18, epoch  10, local model 71, internal_epoch   2, Avg loss: 0.0312, Accuracy: 330/818 (40.3423%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.0320, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 214/1013 (21.1254%)
_Train Local_ResNet_18, epoch  10, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 345/1013 (34.0573%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.4586, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   1, Avg loss: 0.0567, Accuracy: 249/1071 (23.2493%)
_Train Local_ResNet_18, epoch  10, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 521/1071 (48.6461%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.9042, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 309/946 (32.6638%)
_Train Local_ResNet_18, epoch  10, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 378/946 (39.9577%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.0202, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   1, Avg loss: 0.0744, Accuracy: 142/603 (23.5489%)
_Train Local_ResNet_18, epoch  10, local model 88, internal_epoch   2, Avg loss: 0.0474, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.9795, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   1, Avg loss: 0.0816, Accuracy: 67/486 (13.7860%)
_Train Local_ResNet_18, epoch  10, local model 30, internal_epoch   2, Avg loss: 0.0412, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.8518, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 62/186 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3123, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 52/311 (16.7203%)
_Train Local_ResNet_18, epoch  10, local model 96, internal_epoch   2, Avg loss: 0.0539, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3424, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   1, Avg loss: 0.0830, Accuracy: 12/373 (3.2172%)
_Train Local_ResNet_18, epoch  10, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.4184, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0514, Accuracy: 342/1628 (21.0074%)
_Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0260, Accuracy: 796/1628 (48.8943%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.4440, Accuracy: 130/10000 (1.3000%)
time spent on training: 93.23387455940247
[foolsgold agg] training data poison_ratio: 0.0  data num: [818, 1013, 1071, 946, 603, 486, 186, 311, 373, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3159, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.6051, Accuracy: 0/9950 (0.0000%)
saving model
Done in 159.83886671066284 sec.
Server Epoch:11 choose agents : [24, 78, 29, 5, 92, 11, 87, 10, 26, 13].
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0777, Accuracy: 21/312 (6.7308%)
_Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0419, Accuracy: 158/312 (50.6410%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3860, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   1, Avg loss: 0.0833, Accuracy: 43/416 (10.3365%)
_Train Local_ResNet_18, epoch  11, local model 78, internal_epoch   2, Avg loss: 0.0478, Accuracy: 163/416 (39.1827%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.5473, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 415/1440 (28.8194%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 633/1440 (43.9583%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.8254, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   1, Avg loss: 0.0520, Accuracy: 395/1628 (24.2629%)
_Train Local_ResNet_18, epoch  11, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 815/1628 (50.0614%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.0678, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 450/1715 (26.2391%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 700/1715 (40.8163%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6826, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0550, Accuracy: 346/712 (48.5955%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0285, Accuracy: 410/712 (57.5843%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.4408, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   1, Avg loss: 0.0577, Accuracy: 308/1131 (27.2325%)
_Train Local_ResNet_18, epoch  11, local model 87, internal_epoch   2, Avg loss: 0.0325, Accuracy: 400/1131 (35.3669%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.7801, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 201/861 (23.3449%)
_Train Local_ResNet_18, epoch  11, local model 10, internal_epoch   2, Avg loss: 0.0224, Accuracy: 424/861 (49.2451%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9923, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 328/1446 (22.6833%)
_Train Local_ResNet_18, epoch  11, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 506/1446 (34.9931%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.1092, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 308/1645 (18.7234%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 598/1645 (36.3526%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6783, Accuracy: 124/10000 (1.2400%)
time spent on training: 112.61476492881775
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 416, 1440, 1628, 1715, 712, 1131, 861, 1446, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3158, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.6043, Accuracy: 0/9950 (0.0000%)
saving model
Done in 179.70685124397278 sec.
Server Epoch:12 choose agents : [36, 80, 93, 31, 33, 86, 62, 98, 21, 13].
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   1, Avg loss: 0.0887, Accuracy: 65/408 (15.9314%)
_Train Local_ResNet_18, epoch  12, local model 36, internal_epoch   2, Avg loss: 0.0550, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.4668, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   1, Avg loss: 0.0711, Accuracy: 138/682 (20.2346%)
_Train Local_ResNet_18, epoch  12, local model 80, internal_epoch   2, Avg loss: 0.0386, Accuracy: 244/682 (35.7771%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.2390, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 419/1742 (24.0528%)
_Train Local_ResNet_18, epoch  12, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 697/1742 (40.0115%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8662, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   1, Avg loss: 0.0821, Accuracy: 57/460 (12.3913%)
_Train Local_ResNet_18, epoch  12, local model 31, internal_epoch   2, Avg loss: 0.0408, Accuracy: 185/460 (40.2174%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7759, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   1, Avg loss: 0.0798, Accuracy: 63/515 (12.2330%)
_Train Local_ResNet_18, epoch  12, local model 33, internal_epoch   2, Avg loss: 0.0521, Accuracy: 116/515 (22.5243%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7262, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   1, Avg loss: 0.0626, Accuracy: 351/1003 (34.9950%)
_Train Local_ResNet_18, epoch  12, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 349/1003 (34.7956%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.5907, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   1, Avg loss: 0.0692, Accuracy: 139/568 (24.4718%)
_Train Local_ResNet_18, epoch  12, local model 62, internal_epoch   2, Avg loss: 0.0407, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7174, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   1, Avg loss: 0.0825, Accuracy: 13/373 (3.4853%)
_Train Local_ResNet_18, epoch  12, local model 98, internal_epoch   2, Avg loss: 0.0491, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.4257, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 408/1949 (20.9338%)
_Train Local_ResNet_18, epoch  12, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 604/1949 (30.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.2599, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 325/1645 (19.7568%)
_Train Local_ResNet_18, epoch  12, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 608/1645 (36.9605%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.7765, Accuracy: 129/10000 (1.2900%)
time spent on training: 102.67555093765259
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 682, 1742, 460, 515, 1003, 568, 373, 1949, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3156, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.6036, Accuracy: 0/9950 (0.0000%)
saving model
Done in 170.94108247756958 sec.
Server Epoch:13 choose agents : [35, 75, 70, 14, 55, 6, 16, 50, 46, 23].
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0855, Accuracy: 38/271 (14.0221%)
_Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0558, Accuracy: 101/271 (37.2694%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3600, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   1, Avg loss: 0.0648, Accuracy: 251/776 (32.3454%)
_Train Local_ResNet_18, epoch  13, local model 75, internal_epoch   2, Avg loss: 0.0292, Accuracy: 429/776 (55.2835%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.9729, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0554, Accuracy: 367/1418 (25.8815%)
_Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 651/1418 (45.9097%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.5259, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   1, Avg loss: 0.0629, Accuracy: 224/1013 (22.1125%)
_Train Local_ResNet_18, epoch  13, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 315/1013 (31.0958%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.5382, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   1, Avg loss: 0.0556, Accuracy: 250/1071 (23.3427%)
_Train Local_ResNet_18, epoch  13, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 533/1071 (49.7666%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.8322, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   1, Avg loss: 0.0551, Accuracy: 401/1956 (20.5010%)
_Train Local_ResNet_18, epoch  13, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 639/1956 (32.6687%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.1618, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   1, Avg loss: 0.0665, Accuracy: 272/708 (38.4181%)
_Train Local_ResNet_18, epoch  13, local model 16, internal_epoch   2, Avg loss: 0.0343, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.0052, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   1, Avg loss: 0.0636, Accuracy: 142/809 (17.5525%)
_Train Local_ResNet_18, epoch  13, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 349/809 (43.1397%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.1681, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   1, Avg loss: 0.0548, Accuracy: 423/1904 (22.2164%)
_Train Local_ResNet_18, epoch  13, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 672/1904 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.5313, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0615, Accuracy: 312/715 (43.6364%)
_Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0390, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.6988, Accuracy: 50/10000 (0.5000%)
time spent on training: 108.62363743782043
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 776, 1418, 1013, 1071, 1956, 708, 809, 1904, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3154, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.6027, Accuracy: 0/9950 (0.0000%)
saving model
Done in 176.14129424095154 sec.
Server Epoch:14 choose agents : [69, 64, 65, 61, 33, 70, 82, 60, 83, 98].
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   1, Avg loss: 0.0566, Accuracy: 282/590 (47.7966%)
_Train Local_ResNet_18, epoch  14, local model 69, internal_epoch   2, Avg loss: 0.0292, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.5095, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   1, Avg loss: 0.0652, Accuracy: 162/953 (16.9990%)
_Train Local_ResNet_18, epoch  14, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 307/953 (32.2141%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.4256, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0567, Accuracy: 383/1475 (25.9661%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0309, Accuracy: 628/1475 (42.5763%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8639, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1264, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3042, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   1, Avg loss: 0.0776, Accuracy: 66/515 (12.8155%)
_Train Local_ResNet_18, epoch  14, local model 33, internal_epoch   2, Avg loss: 0.0523, Accuracy: 119/515 (23.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.8399, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 354/1418 (24.9647%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0314, Accuracy: 653/1418 (46.0508%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8231, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0768, Accuracy: 71/500 (14.2000%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0474, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.5813, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 594/2227 (26.6727%)
_Train Local_ResNet_18, epoch  14, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1019/2227 (45.7566%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.3807, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 405/1953 (20.7373%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 733/1953 (37.5320%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.0292, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0822, Accuracy: 18/373 (4.8257%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0478, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.4446, Accuracy: 50/10000 (0.5000%)
time spent on training: 148.36647820472717
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 953, 1475, 85, 515, 1418, 500, 2227, 1953, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3153, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.5983, Accuracy: 0/9950 (0.0000%)
saving model
Done in 677.6175107955933 sec.
Server Epoch:15 choose agents : [69, 62, 83, 78, 25, 41, 18, 65, 38, 94].
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   1, Avg loss: 0.0558, Accuracy: 286/590 (48.4746%)
_Train Local_ResNet_18, epoch  15, local model 69, internal_epoch   2, Avg loss: 0.0296, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.8954, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   1, Avg loss: 0.0696, Accuracy: 138/568 (24.2958%)
_Train Local_ResNet_18, epoch  15, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.7043, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 441/1953 (22.5806%)
_Train Local_ResNet_18, epoch  15, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 719/1953 (36.8152%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.0381, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0837, Accuracy: 39/416 (9.3750%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0466, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.5505, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 304/690 (44.0580%)
_Train Local_ResNet_18, epoch  15, local model 25, internal_epoch   2, Avg loss: 0.0282, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.5210, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   1, Avg loss: 0.0594, Accuracy: 326/719 (45.3408%)
_Train Local_ResNet_18, epoch  15, local model 41, internal_epoch   2, Avg loss: 0.0321, Accuracy: 462/719 (64.2559%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.3272, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0774, Accuracy: 115/530 (21.6981%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0392, Accuracy: 273/530 (51.5094%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.1081, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   1, Avg loss: 0.0562, Accuracy: 408/1475 (27.6610%)
_Train Local_ResNet_18, epoch  15, local model 65, internal_epoch   2, Avg loss: 0.0316, Accuracy: 647/1475 (43.8644%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.0476, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   1, Avg loss: 0.0619, Accuracy: 242/1131 (21.3970%)
_Train Local_ResNet_18, epoch  15, local model 38, internal_epoch   2, Avg loss: 0.0314, Accuracy: 468/1131 (41.3793%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.2594, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 327/1662 (19.6751%)
_Train Local_ResNet_18, epoch  15, local model 94, internal_epoch   2, Avg loss: 0.0336, Accuracy: 586/1662 (35.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5764, Accuracy: 109/10000 (1.0900%)
time spent on training: 1110.0751557350159
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 568, 1953, 416, 690, 719, 530, 1475, 1131, 1662]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3151, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.5964, Accuracy: 0/9950 (0.0000%)
saving model
Done in 1177.4059903621674 sec.
Server Epoch:16 choose agents : [23, 21, 70, 65, 79, 5, 63, 95, 58, 32].
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   1, Avg loss: 0.0585, Accuracy: 317/715 (44.3357%)
_Train Local_ResNet_18, epoch  16, local model 23, internal_epoch   2, Avg loss: 0.0409, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.7531, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 389/1949 (19.9590%)
_Train Local_ResNet_18, epoch  16, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 632/1949 (32.4269%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1945, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 336/1418 (23.6953%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0317, Accuracy: 599/1418 (42.2426%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.2133, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   1, Avg loss: 0.0558, Accuracy: 381/1475 (25.8305%)
_Train Local_ResNet_18, epoch  16, local model 65, internal_epoch   2, Avg loss: 0.0318, Accuracy: 711/1475 (48.2034%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.9366, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   1, Avg loss: 0.1030, Accuracy: 10/197 (5.0761%)
_Train Local_ResNet_18, epoch  16, local model 79, internal_epoch   2, Avg loss: 0.0842, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3217, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 344/1628 (21.1302%)
_Train Local_ResNet_18, epoch  16, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 791/1628 (48.5872%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.3294, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 255/888 (28.7162%)
_Train Local_ResNet_18, epoch  16, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 402/888 (45.2703%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.3598, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   1, Avg loss: 0.0526, Accuracy: 330/599 (55.0918%)
_Train Local_ResNet_18, epoch  16, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.8120, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 342/803 (42.5903%)
_Train Local_ResNet_18, epoch  16, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 406/803 (50.5604%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.9992, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0603, Accuracy: 196/735 (26.6667%)
_Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0234, Accuracy: 333/735 (45.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.3818, Accuracy: 65/10000 (0.6500%)
time spent on training: 158.4551010131836
[foolsgold agg] training data poison_ratio: 0.0  data num: [715, 1949, 1418, 1475, 197, 1628, 888, 599, 803, 735]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3150, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.5914, Accuracy: 0/9950 (0.0000%)
saving model
Done in 225.85224103927612 sec.
Server Epoch:17 choose agents : [35, 28, 27, 80, 54, 62, 32, 22, 4, 42].
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   1, Avg loss: 0.0861, Accuracy: 41/271 (15.1292%)
_Train Local_ResNet_18, epoch  17, local model 35, internal_epoch   2, Avg loss: 0.0563, Accuracy: 99/271 (36.5314%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3614, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0573, Accuracy: 377/1581 (23.8457%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 608/1581 (38.4567%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.5831, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0539, Accuracy: 435/1587 (27.4102%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0342, Accuracy: 597/1587 (37.6181%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.0956, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   1, Avg loss: 0.0702, Accuracy: 142/682 (20.8211%)
_Train Local_ResNet_18, epoch  17, local model 80, internal_epoch   2, Avg loss: 0.0378, Accuracy: 263/682 (38.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.5437, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 350/1130 (30.9735%)
_Train Local_ResNet_18, epoch  17, local model 54, internal_epoch   2, Avg loss: 0.0296, Accuracy: 466/1130 (41.2389%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.5213, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   1, Avg loss: 0.0688, Accuracy: 138/568 (24.2958%)
_Train Local_ResNet_18, epoch  17, local model 62, internal_epoch   2, Avg loss: 0.0411, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.7234, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 197/735 (26.8027%)
_Train Local_ResNet_18, epoch  17, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 364/735 (49.5238%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.6795, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 498/1470 (33.8776%)
_Train Local_ResNet_18, epoch  17, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 835/1470 (56.8027%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.2241, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   1, Avg loss: 0.0606, Accuracy: 325/901 (36.0710%)
_Train Local_ResNet_18, epoch  17, local model 4, internal_epoch   2, Avg loss: 0.0324, Accuracy: 420/901 (46.6149%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.8011, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 332/1372 (24.1983%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 537/1372 (39.1399%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.0340, Accuracy: 85/10000 (0.8500%)
time spent on training: 194.18095326423645
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 1581, 1587, 682, 1130, 568, 735, 1470, 901, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3149, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.5882, Accuracy: 0/9950 (0.0000%)
saving model
Done in 262.95349311828613 sec.
Server Epoch:18 choose agents : [76, 89, 2, 23, 1, 7, 78, 50, 72, 28].
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0867, Accuracy: 35/466 (7.5107%)
_Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0498, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.6604, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 329/896 (36.7188%)
_Train Local_ResNet_18, epoch  18, local model 89, internal_epoch   2, Avg loss: 0.0345, Accuracy: 445/896 (49.6652%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.2349, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 234/605 (38.6777%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0398, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.8225, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   1, Avg loss: 0.0609, Accuracy: 319/715 (44.6154%)
_Train Local_ResNet_18, epoch  18, local model 23, internal_epoch   2, Avg loss: 0.0375, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.7672, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   1, Avg loss: 0.0571, Accuracy: 290/928 (31.2500%)
_Train Local_ResNet_18, epoch  18, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 561/928 (60.4526%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.6716, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   1, Avg loss: 0.0540, Accuracy: 351/891 (39.3939%)
_Train Local_ResNet_18, epoch  18, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 423/891 (47.4747%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.0483, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0831, Accuracy: 37/416 (8.8942%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0474, Accuracy: 182/416 (43.7500%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.5712, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   1, Avg loss: 0.0634, Accuracy: 141/809 (17.4289%)
_Train Local_ResNet_18, epoch  18, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 340/809 (42.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.4908, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 259/1241 (20.8703%)
_Train Local_ResNet_18, epoch  18, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 427/1241 (34.4077%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.1805, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 384/1581 (24.2884%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0342, Accuracy: 580/1581 (36.6856%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5613, Accuracy: 84/10000 (0.8400%)
time spent on training: 115.84870743751526
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 896, 605, 715, 928, 891, 416, 809, 1241, 1581]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3148, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.5878, Accuracy: 0/9950 (0.0000%)
saving model
Done in 183.94004225730896 sec.
Server Epoch:19 choose agents : [6, 86, 35, 16, 89, 92, 20, 59, 10, 14].
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 412/1956 (21.0634%)
_Train Local_ResNet_18, epoch  19, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 639/1956 (32.6687%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1251, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   1, Avg loss: 0.0635, Accuracy: 352/1003 (35.0947%)
_Train Local_ResNet_18, epoch  19, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 371/1003 (36.9890%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.8040, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   1, Avg loss: 0.0847, Accuracy: 39/271 (14.3911%)
_Train Local_ResNet_18, epoch  19, local model 35, internal_epoch   2, Avg loss: 0.0556, Accuracy: 103/271 (38.0074%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3656, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   1, Avg loss: 0.0645, Accuracy: 274/708 (38.7006%)
_Train Local_ResNet_18, epoch  19, local model 16, internal_epoch   2, Avg loss: 0.0360, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.8567, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 327/896 (36.4955%)
_Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 449/896 (50.1116%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.1407, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   1, Avg loss: 0.0522, Accuracy: 453/1715 (26.4140%)
_Train Local_ResNet_18, epoch  19, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 719/1715 (41.9242%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.5688, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0576, Accuracy: 339/807 (42.0074%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 431/807 (53.4077%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.7697, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 318/1089 (29.2011%)
_Train Local_ResNet_18, epoch  19, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 459/1089 (42.1488%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.6913, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   1, Avg loss: 0.0570, Accuracy: 226/861 (26.2485%)
_Train Local_ResNet_18, epoch  19, local model 10, internal_epoch   2, Avg loss: 0.0213, Accuracy: 444/861 (51.5679%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.8756, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   1, Avg loss: 0.0622, Accuracy: 223/1013 (22.0138%)
_Train Local_ResNet_18, epoch  19, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 316/1013 (31.1945%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.4988, Accuracy: 60/10000 (0.6000%)
time spent on training: 130.6622724533081
[foolsgold agg] training data poison_ratio: 0.0  data num: [1956, 1003, 271, 708, 896, 1715, 807, 1089, 861, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3146, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.5871, Accuracy: 0/9950 (0.0000%)
saving model
Done in 196.88474822044373 sec.
Server Epoch:20 choose agents : [75, 13, 54, 6, 63, 49, 70, 51, 58, 9].
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 242/776 (31.1856%)
_Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0309, Accuracy: 406/776 (52.3196%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.9954, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 296/1645 (17.9939%)
_Train Local_ResNet_18, epoch  20, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 607/1645 (36.8997%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.7113, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   1, Avg loss: 0.0556, Accuracy: 341/1130 (30.1770%)
_Train Local_ResNet_18, epoch  20, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 482/1130 (42.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.5924, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 404/1956 (20.6544%)
_Train Local_ResNet_18, epoch  20, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 674/1956 (34.4581%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.4870, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch  20, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 428/888 (48.1982%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8110, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   1, Avg loss: 0.0811, Accuracy: 20/440 (4.5455%)
_Train Local_ResNet_18, epoch  20, local model 49, internal_epoch   2, Avg loss: 0.0496, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.4719, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0572, Accuracy: 330/1418 (23.2722%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 581/1418 (40.9732%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.7549, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 223/1049 (21.2583%)
_Train Local_ResNet_18, epoch  20, local model 51, internal_epoch   2, Avg loss: 0.0309, Accuracy: 494/1049 (47.0925%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.6153, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   1, Avg loss: 0.0577, Accuracy: 349/803 (43.4620%)
_Train Local_ResNet_18, epoch  20, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 385/803 (47.9452%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.9502, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   1, Avg loss: 0.0496, Accuracy: 364/1275 (28.5490%)
_Train Local_ResNet_18, epoch  20, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 717/1275 (56.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 9.6038, Accuracy: 90/10000 (0.9000%)
time spent on training: 158.8558156490326
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 1645, 1130, 1956, 888, 440, 1418, 1049, 803, 1275]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3145, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.5863, Accuracy: 0/9950 (0.0000%)
saving model
Done in 226.1841151714325 sec.
Server Epoch:21 choose agents : [16, 25, 46, 76, 98, 73, 93, 64, 21, 10].
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   1, Avg loss: 0.0668, Accuracy: 268/708 (37.8531%)
_Train Local_ResNet_18, epoch  21, local model 16, internal_epoch   2, Avg loss: 0.0348, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.8356, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   1, Avg loss: 0.0579, Accuracy: 297/690 (43.0435%)
_Train Local_ResNet_18, epoch  21, local model 25, internal_epoch   2, Avg loss: 0.0276, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.2807, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   1, Avg loss: 0.0553, Accuracy: 410/1904 (21.5336%)
_Train Local_ResNet_18, epoch  21, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 657/1904 (34.5063%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8390, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   1, Avg loss: 0.0864, Accuracy: 39/466 (8.3691%)
_Train Local_ResNet_18, epoch  21, local model 76, internal_epoch   2, Avg loss: 0.0498, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.6395, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   1, Avg loss: 0.0820, Accuracy: 13/373 (3.4853%)
_Train Local_ResNet_18, epoch  21, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.4445, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   1, Avg loss: 0.0666, Accuracy: 168/938 (17.9104%)
_Train Local_ResNet_18, epoch  21, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 326/938 (34.7548%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.1947, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 432/1742 (24.7991%)
_Train Local_ResNet_18, epoch  21, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 684/1742 (39.2652%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7262, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 164/953 (17.2088%)
_Train Local_ResNet_18, epoch  21, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 302/953 (31.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.4070, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0542, Accuracy: 357/1949 (18.3171%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 645/1949 (33.0939%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.3088, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 205/861 (23.8095%)
_Train Local_ResNet_18, epoch  21, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 433/861 (50.2904%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.9030, Accuracy: 50/10000 (0.5000%)
time spent on training: 131.8314666748047
[foolsgold agg] training data poison_ratio: 0.0  data num: [708, 690, 1904, 466, 373, 938, 1742, 953, 1949, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3144, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.5833, Accuracy: 0/9950 (0.0000%)
saving model
Done in 198.9139847755432 sec.
Server Epoch:22 choose agents : [21, 48, 18, 74, 1, 99, 7, 76, 53, 8].
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 397/1949 (20.3694%)
_Train Local_ResNet_18, epoch  22, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 630/1949 (32.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.1028, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   1, Avg loss: 0.0713, Accuracy: 100/631 (15.8479%)
_Train Local_ResNet_18, epoch  22, local model 48, internal_epoch   2, Avg loss: 0.0413, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.8278, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0769, Accuracy: 113/530 (21.3208%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0384, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.0495, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 481/1552 (30.9923%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 757/1552 (48.7758%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.2551, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   1, Avg loss: 0.0573, Accuracy: 279/928 (30.0647%)
_Train Local_ResNet_18, epoch  22, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 566/928 (60.9914%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4257, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   1, Avg loss: 0.0681, Accuracy: 177/773 (22.8978%)
_Train Local_ResNet_18, epoch  22, local model 99, internal_epoch   2, Avg loss: 0.0318, Accuracy: 393/773 (50.8409%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.3159, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   1, Avg loss: 0.0529, Accuracy: 361/891 (40.5163%)
_Train Local_ResNet_18, epoch  22, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 466/891 (52.3008%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.1015, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0859, Accuracy: 37/466 (7.9399%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0479, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.6352, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   1, Avg loss: 0.0498, Accuracy: 274/813 (33.7023%)
_Train Local_ResNet_18, epoch  22, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 445/813 (54.7355%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.6990, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0603, Accuracy: 252/1513 (16.6557%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 476/1513 (31.4607%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.1478, Accuracy: 108/10000 (1.0800%)
time spent on training: 140.18603086471558
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 631, 530, 1552, 928, 773, 891, 466, 813, 1513]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3143, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.5829, Accuracy: 0/9950 (0.0000%)
saving model
Done in 208.04834175109863 sec.
Server Epoch:23 choose agents : [52, 94, 1, 86, 21, 75, 2, 4, 62, 81].
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   1, Avg loss: 0.0566, Accuracy: 281/636 (44.1824%)
_Train Local_ResNet_18, epoch  23, local model 52, internal_epoch   2, Avg loss: 0.0314, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.2408, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 321/1662 (19.3141%)
_Train Local_ResNet_18, epoch  23, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 611/1662 (36.7629%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.8242, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   1, Avg loss: 0.0567, Accuracy: 282/928 (30.3879%)
_Train Local_ResNet_18, epoch  23, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 546/928 (58.8362%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.8753, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   1, Avg loss: 0.0627, Accuracy: 352/1003 (35.0947%)
_Train Local_ResNet_18, epoch  23, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 377/1003 (37.5872%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.5808, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 406/1949 (20.8312%)
_Train Local_ResNet_18, epoch  23, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 633/1949 (32.4782%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.4074, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   1, Avg loss: 0.0632, Accuracy: 243/776 (31.3144%)
_Train Local_ResNet_18, epoch  23, local model 75, internal_epoch   2, Avg loss: 0.0297, Accuracy: 402/776 (51.8041%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.0121, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 227/605 (37.5207%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.8443, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0627, Accuracy: 330/901 (36.6260%)
_Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0334, Accuracy: 400/901 (44.3951%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.8307, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 140/568 (24.6479%)
_Train Local_ResNet_18, epoch  23, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.7767, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   1, Avg loss: 0.0710, Accuracy: 236/774 (30.4910%)
_Train Local_ResNet_18, epoch  23, local model 81, internal_epoch   2, Avg loss: 0.0345, Accuracy: 304/774 (39.2765%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.3583, Accuracy: 82/10000 (0.8200%)
time spent on training: 123.15025353431702
[foolsgold agg] training data poison_ratio: 0.0  data num: [636, 1662, 928, 1003, 1949, 776, 605, 901, 568, 774]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3142, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.5825, Accuracy: 0/9950 (0.0000%)
saving model
Done in 191.28500509262085 sec.
Server Epoch:24 choose agents : [84, 82, 13, 67, 2, 10, 50, 70, 14, 69].
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0628, Accuracy: 321/1190 (26.9748%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 449/1190 (37.7311%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.8850, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   1, Avg loss: 0.0767, Accuracy: 62/500 (12.4000%)
_Train Local_ResNet_18, epoch  24, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.6196, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 322/1645 (19.5745%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0330, Accuracy: 588/1645 (35.7447%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.0043, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   1, Avg loss: 0.0787, Accuracy: 55/426 (12.9108%)
_Train Local_ResNet_18, epoch  24, local model 67, internal_epoch   2, Avg loss: 0.0418, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.5975, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 225/605 (37.1901%)
_Train Local_ResNet_18, epoch  24, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.7724, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 200/861 (23.2288%)
_Train Local_ResNet_18, epoch  24, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 446/861 (51.8002%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1362, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 154/809 (19.0358%)
_Train Local_ResNet_18, epoch  24, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 378/809 (46.7244%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.3802, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 359/1418 (25.3173%)
_Train Local_ResNet_18, epoch  24, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 663/1418 (46.7560%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.9430, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 225/1013 (22.2113%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 305/1013 (30.1086%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5961, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   1, Avg loss: 0.0553, Accuracy: 290/590 (49.1525%)
_Train Local_ResNet_18, epoch  24, local model 69, internal_epoch   2, Avg loss: 0.0326, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.8906, Accuracy: 50/10000 (0.5000%)
time spent on training: 142.36077904701233
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 500, 1645, 426, 605, 861, 809, 1418, 1013, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3141, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.5826, Accuracy: 0/9950 (0.0000%)
saving model
Done in 210.52431321144104 sec.
Server Epoch:25 choose agents : [44, 26, 53, 87, 15, 94, 31, 2, 81, 48].
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0600, Accuracy: 395/1750 (22.5714%)
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 658/1750 (37.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6171, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0556, Accuracy: 329/1446 (22.7524%)
_Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 520/1446 (35.9613%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.2258, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0498, Accuracy: 252/813 (30.9963%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 470/813 (57.8106%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.4821, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   1, Avg loss: 0.0580, Accuracy: 298/1131 (26.3484%)
_Train Local_ResNet_18, epoch  25, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 389/1131 (34.3943%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8963, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 319/1154 (27.6430%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0297, Accuracy: 423/1154 (36.6551%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9873, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 340/1662 (20.4573%)
_Train Local_ResNet_18, epoch  25, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 611/1662 (36.7629%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6872, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   1, Avg loss: 0.0814, Accuracy: 68/460 (14.7826%)
_Train Local_ResNet_18, epoch  25, local model 31, internal_epoch   2, Avg loss: 0.0377, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7384, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 235/605 (38.8430%)
_Train Local_ResNet_18, epoch  25, local model 2, internal_epoch   2, Avg loss: 0.0397, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.8925, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   1, Avg loss: 0.0675, Accuracy: 246/774 (31.7829%)
_Train Local_ResNet_18, epoch  25, local model 81, internal_epoch   2, Avg loss: 0.0366, Accuracy: 312/774 (40.3101%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.4233, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   1, Avg loss: 0.0709, Accuracy: 91/631 (14.4216%)
_Train Local_ResNet_18, epoch  25, local model 48, internal_epoch   2, Avg loss: 0.0412, Accuracy: 224/631 (35.4992%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.8926, Accuracy: 50/10000 (0.5000%)
time spent on training: 130.76309847831726
[foolsgold agg] training data poison_ratio: 0.0  data num: [1750, 1446, 813, 1131, 1154, 1662, 460, 605, 774, 631]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3140, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.5825, Accuracy: 0/9950 (0.0000%)
saving model
Done in 198.70488286018372 sec.
Server Epoch:26 choose agents : [80, 56, 73, 74, 45, 54, 42, 79, 7, 50].
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   1, Avg loss: 0.0704, Accuracy: 136/682 (19.9413%)
_Train Local_ResNet_18, epoch  26, local model 80, internal_epoch   2, Avg loss: 0.0386, Accuracy: 227/682 (33.2845%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.3460, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  26, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 68/186 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3118, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0663, Accuracy: 162/938 (17.2708%)
_Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0331, Accuracy: 341/938 (36.3539%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.0959, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 470/1552 (30.2835%)
_Train Local_ResNet_18, epoch  26, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 748/1552 (48.1959%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.6198, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   1, Avg loss: 0.0690, Accuracy: 190/669 (28.4006%)
_Train Local_ResNet_18, epoch  26, local model 45, internal_epoch   2, Avg loss: 0.0400, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.8970, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 343/1130 (30.3540%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 485/1130 (42.9204%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.6984, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 341/1372 (24.8542%)
_Train Local_ResNet_18, epoch  26, local model 42, internal_epoch   2, Avg loss: 0.0317, Accuracy: 493/1372 (35.9329%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.8726, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   1, Avg loss: 0.1026, Accuracy: 18/197 (9.1371%)
_Train Local_ResNet_18, epoch  26, local model 79, internal_epoch   2, Avg loss: 0.0905, Accuracy: 63/197 (31.9797%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3190, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   1, Avg loss: 0.0535, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch  26, local model 7, internal_epoch   2, Avg loss: 0.0267, Accuracy: 424/891 (47.5870%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.1115, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   1, Avg loss: 0.0636, Accuracy: 142/809 (17.5525%)
_Train Local_ResNet_18, epoch  26, local model 50, internal_epoch   2, Avg loss: 0.0277, Accuracy: 327/809 (40.4203%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.3613, Accuracy: 64/10000 (0.6400%)
time spent on training: 127.99128770828247
[foolsgold agg] training data poison_ratio: 0.0  data num: [682, 186, 938, 1552, 669, 1130, 1372, 197, 891, 809]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3139, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.5812, Accuracy: 0/9950 (0.0000%)
saving model
Done in 194.717782497406 sec.
Server Epoch:27 choose agents : [17, 84, 50, 25, 13, 95, 98, 42, 15, 54].
poison local model 17 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 427/1574 (27.1283%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0239, Accuracy: 835/1574 (53.0496%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   3, Avg loss: 0.0203, Accuracy: 932/1574 (59.2122%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   4, Avg loss: 0.0194, Accuracy: 946/1574 (60.1017%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   5, Avg loss: 0.0189, Accuracy: 978/1574 (62.1347%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   6, Avg loss: 0.0188, Accuracy: 993/1574 (63.0877%), train_poison_data_count: 500
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   7, Avg loss: 0.0182, Accuracy: 997/1574 (63.3418%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   8, Avg loss: 0.0179, Accuracy: 1012/1574 (64.2948%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch   9, Avg loss: 0.0174, Accuracy: 1033/1574 (65.6290%), train_poison_data_count: 500
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 17, internal_epoch  10, Avg loss: 0.0176, Accuracy: 1010/1574 (64.1677%), train_poison_data_count: 500
Global model norm: 112.05487460113014.
Norm before scaling: 112.03131101811448. Distance: 1.2415492019306018
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9405, Accuracy: 97/10000 (0.9700%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.1320, Accuracy: 9883/9950 (99.3266%)
Scaling by  100
Scaled Norm after poisoning: 165.19322256451684, distance: 124.15492857338567
Total norm for 1 adversaries is: 165.19322256451684. distance: 124.15492857338567
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   1, Avg loss: 0.0631, Accuracy: 311/1190 (26.1345%)
_Train Local_ResNet_18, epoch  27, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 457/1190 (38.4034%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.8757, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   1, Avg loss: 0.0631, Accuracy: 130/809 (16.0692%)
_Train Local_ResNet_18, epoch  27, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 325/809 (40.1731%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.1595, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 308/690 (44.6377%)
_Train Local_ResNet_18, epoch  27, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.3109, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 323/1645 (19.6353%)
_Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 648/1645 (39.3921%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8292, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0528, Accuracy: 330/599 (55.0918%)
_Train Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0272, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.4104, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0820, Accuracy: 19/373 (5.0938%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0483, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.4491, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 347/1372 (25.2915%)
_Train Local_ResNet_18, epoch  27, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 507/1372 (36.9534%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0055, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 324/1154 (28.0763%)
_Train Local_ResNet_18, epoch  27, local model 15, internal_epoch   2, Avg loss: 0.0293, Accuracy: 423/1154 (36.6551%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.9429, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   1, Avg loss: 0.0542, Accuracy: 339/1130 (30.0000%)
_Train Local_ResNet_18, epoch  27, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 471/1130 (41.6814%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.5624, Accuracy: 50/10000 (0.5000%)
time spent on training: 243.74075293540955
[foolsgold agg] training data poison_ratio: 0.1493925588458618  data num: [1574, 1190, 809, 690, 1645, 599, 373, 1372, 1154, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.04668517463933181
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3139, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.5777, Accuracy: 0/9950 (0.0000%)
saving model
Done in 311.02389430999756 sec.
Server Epoch:28 choose agents : [20, 92, 67, 48, 91, 85, 76, 6, 83, 17].
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   1, Avg loss: 0.0577, Accuracy: 337/807 (41.7596%)
_Train Local_ResNet_18, epoch  28, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 409/807 (50.6815%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.8396, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   1, Avg loss: 0.0513, Accuracy: 458/1715 (26.7055%)
_Train Local_ResNet_18, epoch  28, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 685/1715 (39.9417%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.5142, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   1, Avg loss: 0.0794, Accuracy: 46/426 (10.7981%)
_Train Local_ResNet_18, epoch  28, local model 67, internal_epoch   2, Avg loss: 0.0419, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.5741, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   1, Avg loss: 0.0711, Accuracy: 95/631 (15.0555%)
_Train Local_ResNet_18, epoch  28, local model 48, internal_epoch   2, Avg loss: 0.0416, Accuracy: 215/631 (34.0729%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.8112, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   1, Avg loss: 0.0523, Accuracy: 321/1030 (31.1650%)
_Train Local_ResNet_18, epoch  28, local model 91, internal_epoch   2, Avg loss: 0.0257, Accuracy: 623/1030 (60.4854%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.8395, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 437/1988 (21.9819%)
_Train Local_ResNet_18, epoch  28, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 674/1988 (33.9034%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.7349, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 40/466 (8.5837%)
_Train Local_ResNet_18, epoch  28, local model 76, internal_epoch   2, Avg loss: 0.0488, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.6727, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 398/1956 (20.3476%)
_Train Local_ResNet_18, epoch  28, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 633/1956 (32.3620%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.1053, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   1, Avg loss: 0.0549, Accuracy: 390/1953 (19.9693%)
_Train Local_ResNet_18, epoch  28, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 708/1953 (36.2519%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8282, Accuracy: 105/10000 (1.0500%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 406/1574 (25.7942%)
_Train Local_ResNet_18, epoch  28, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 669/1574 (42.5032%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.0835, Accuracy: 86/10000 (0.8600%)
time spent on training: 154.69851565361023
[foolsgold agg] training data poison_ratio: 0.12545831340666347  data num: [807, 1715, 426, 631, 1030, 1988, 466, 1956, 1953, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.039205722939582334
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3137, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.5776, Accuracy: 0/9950 (0.0000%)
saving model
Done in 222.2157154083252 sec.
Server Epoch:29 choose agents : [11, 58, 53, 87, 95, 62, 65, 60, 57, 69].
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0536, Accuracy: 343/712 (48.1742%)
_Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0270, Accuracy: 435/712 (61.0955%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.4450, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   1, Avg loss: 0.0558, Accuracy: 350/803 (43.5866%)
_Train Local_ResNet_18, epoch  29, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 409/803 (50.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.0278, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   1, Avg loss: 0.0500, Accuracy: 273/813 (33.5793%)
_Train Local_ResNet_18, epoch  29, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 473/813 (58.1796%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 9.0621, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   1, Avg loss: 0.0579, Accuracy: 299/1131 (26.4368%)
_Train Local_ResNet_18, epoch  29, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 426/1131 (37.6658%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.8494, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 332/599 (55.4257%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0291, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.7305, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 135/568 (23.7676%)
_Train Local_ResNet_18, epoch  29, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.6978, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 389/1475 (26.3729%)
_Train Local_ResNet_18, epoch  29, local model 65, internal_epoch   2, Avg loss: 0.0321, Accuracy: 699/1475 (47.3898%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.0165, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 575/2227 (25.8195%)
_Train Local_ResNet_18, epoch  29, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1023/2227 (45.9362%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.9350, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   1, Avg loss: 0.0547, Accuracy: 302/1154 (26.1698%)
_Train Local_ResNet_18, epoch  29, local model 57, internal_epoch   2, Avg loss: 0.0275, Accuracy: 480/1154 (41.5945%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.9387, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   1, Avg loss: 0.0543, Accuracy: 288/590 (48.8136%)
_Train Local_ResNet_18, epoch  29, local model 69, internal_epoch   2, Avg loss: 0.0323, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.9899, Accuracy: 50/10000 (0.5000%)
time spent on training: 156.736346244812
[foolsgold agg] training data poison_ratio: 0.0  data num: [712, 803, 813, 1131, 599, 568, 1475, 2227, 1154, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3136, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.5747, Accuracy: 0/9950 (0.0000%)
saving model
Done in 225.3443431854248 sec.
Server Epoch:30 choose agents : [48, 91, 66, 43, 23, 0, 13, 89, 99, 69].
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   1, Avg loss: 0.0714, Accuracy: 101/631 (16.0063%)
_Train Local_ResNet_18, epoch  30, local model 48, internal_epoch   2, Avg loss: 0.0414, Accuracy: 207/631 (32.8051%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.8080, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   1, Avg loss: 0.0535, Accuracy: 333/1030 (32.3301%)
_Train Local_ResNet_18, epoch  30, local model 91, internal_epoch   2, Avg loss: 0.0253, Accuracy: 605/1030 (58.7379%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.1127, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0625, Accuracy: 257/1402 (18.3310%)
_Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 351/1402 (25.0357%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.0406, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   1, Avg loss: 0.0606, Accuracy: 306/946 (32.3467%)
_Train Local_ResNet_18, epoch  30, local model 43, internal_epoch   2, Avg loss: 0.0369, Accuracy: 312/946 (32.9810%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.0618, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   1, Avg loss: 0.0595, Accuracy: 325/715 (45.4545%)
_Train Local_ResNet_18, epoch  30, local model 23, internal_epoch   2, Avg loss: 0.0402, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.8036, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0581, Accuracy: 352/1657 (21.2432%)
_Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 534/1657 (32.2269%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.5229, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 305/1645 (18.5410%)
_Train Local_ResNet_18, epoch  30, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 603/1645 (36.6565%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8810, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 334/896 (37.2768%)
_Train Local_ResNet_18, epoch  30, local model 89, internal_epoch   2, Avg loss: 0.0339, Accuracy: 444/896 (49.5536%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.2029, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   1, Avg loss: 0.0654, Accuracy: 193/773 (24.9677%)
_Train Local_ResNet_18, epoch  30, local model 99, internal_epoch   2, Avg loss: 0.0320, Accuracy: 392/773 (50.7115%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.0328, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0562, Accuracy: 284/590 (48.1356%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.7397, Accuracy: 50/10000 (0.5000%)
time spent on training: 138.16674900054932
[foolsgold agg] training data poison_ratio: 0.0  data num: [631, 1030, 1402, 946, 715, 1657, 1645, 896, 773, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3135, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.5752, Accuracy: 0/9950 (0.0000%)
saving model
Done in 206.81522011756897 sec.
Server Epoch:31 choose agents : [29, 31, 94, 0, 60, 21, 98, 67, 96, 30].
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 420/1440 (29.1667%)
_Train Local_ResNet_18, epoch  31, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 650/1440 (45.1389%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8473, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 51/460 (11.0870%)
_Train Local_ResNet_18, epoch  31, local model 31, internal_epoch   2, Avg loss: 0.0382, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.7357, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 315/1662 (18.9531%)
_Train Local_ResNet_18, epoch  31, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 608/1662 (36.5824%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.7603, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0581, Accuracy: 378/1657 (22.8123%)
_Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 522/1657 (31.5027%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5106, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 578/2227 (25.9542%)
_Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1051/2227 (47.1935%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.1069, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 431/1949 (22.1139%)
_Train Local_ResNet_18, epoch  31, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 608/1949 (31.1955%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.2874, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   1, Avg loss: 0.0816, Accuracy: 18/373 (4.8257%)
_Train Local_ResNet_18, epoch  31, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.4246, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0785, Accuracy: 49/426 (11.5023%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0417, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.5702, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   1, Avg loss: 0.0790, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch  31, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3445, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0811, Accuracy: 67/486 (13.7860%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0424, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.7656, Accuracy: 45/10000 (0.4500%)
time spent on training: 139.7907693386078
[foolsgold agg] training data poison_ratio: 0.0  data num: [1440, 460, 1662, 1657, 2227, 1949, 373, 426, 311, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3134, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.5730, Accuracy: 0/9950 (0.0000%)
saving model
Done in 207.34798455238342 sec.
Server Epoch:32 choose agents : [26, 45, 19, 17, 84, 8, 90, 80, 58, 48].
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0553, Accuracy: 322/1446 (22.2683%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 505/1446 (34.9239%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.3879, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   1, Avg loss: 0.0685, Accuracy: 202/669 (30.1943%)
_Train Local_ResNet_18, epoch  32, local model 45, internal_epoch   2, Avg loss: 0.0403, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.7434, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 425/1036 (41.0232%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 640/1036 (61.7761%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.1308, Accuracy: 56/10000 (0.5600%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 394/1574 (25.0318%)
_Train Local_ResNet_18, epoch  32, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 668/1574 (42.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.3410, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 316/1190 (26.5546%)
_Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 449/1190 (37.7311%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.9739, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   1, Avg loss: 0.0599, Accuracy: 237/1513 (15.6642%)
_Train Local_ResNet_18, epoch  32, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 486/1513 (32.1216%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.5237, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0564, Accuracy: 312/677 (46.0857%)
_Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.2588, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0704, Accuracy: 143/682 (20.9677%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0381, Accuracy: 240/682 (35.1906%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.3516, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 351/803 (43.7111%)
_Train Local_ResNet_18, epoch  32, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 409/803 (50.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.9400, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   1, Avg loss: 0.0709, Accuracy: 96/631 (15.2139%)
_Train Local_ResNet_18, epoch  32, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 216/631 (34.2314%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.8051, Accuracy: 50/10000 (0.5000%)
time spent on training: 150.45405077934265
[foolsgold agg] training data poison_ratio: 0.1539966735153116  data num: [1446, 669, 1036, 1574, 1190, 1513, 677, 682, 803, 631]
[foolsgold agg] considering poison per batch poison_fraction: 0.04812396047353487
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3133, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.5730, Accuracy: 0/9950 (0.0000%)
saving model
Done in 217.41892099380493 sec.
Server Epoch:33 choose agents : [12, 79, 69, 47, 77, 55, 36, 82, 45, 59].
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   1, Avg loss: 0.0870, Accuracy: 23/338 (6.8047%)
_Train Local_ResNet_18, epoch  33, local model 12, internal_epoch   2, Avg loss: 0.0475, Accuracy: 155/338 (45.8580%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.4535, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1008, Accuracy: 18/197 (9.1371%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0865, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3223, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   1, Avg loss: 0.0549, Accuracy: 291/590 (49.3220%)
_Train Local_ResNet_18, epoch  33, local model 69, internal_epoch   2, Avg loss: 0.0309, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.9457, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   1, Avg loss: 0.1243, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  33, local model 47, internal_epoch   2, Avg loss: 0.1125, Accuracy: 11/134 (8.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3101, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 327/1340 (24.4030%)
_Train Local_ResNet_18, epoch  33, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 524/1340 (39.1045%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.7435, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 249/1071 (23.2493%)
_Train Local_ResNet_18, epoch  33, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 505/1071 (47.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.6762, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   1, Avg loss: 0.0884, Accuracy: 75/408 (18.3824%)
_Train Local_ResNet_18, epoch  33, local model 36, internal_epoch   2, Avg loss: 0.0548, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.4667, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 73/500 (14.6000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.6230, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   1, Avg loss: 0.0674, Accuracy: 196/669 (29.2975%)
_Train Local_ResNet_18, epoch  33, local model 45, internal_epoch   2, Avg loss: 0.0418, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.7775, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0533, Accuracy: 301/1089 (27.6400%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 461/1089 (42.3324%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.7896, Accuracy: 78/10000 (0.7800%)
time spent on training: 179.6773636341095
[foolsgold agg] training data poison_ratio: 0.0  data num: [338, 197, 590, 134, 1340, 1071, 408, 500, 669, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3133, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.5735, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.83567476272583 sec.
Server Epoch:34 choose agents : [54, 11, 49, 71, 13, 24, 48, 30, 76, 55].
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0545, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 443/1130 (39.2035%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.4364, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   1, Avg loss: 0.0524, Accuracy: 350/712 (49.1573%)
_Train Local_ResNet_18, epoch  34, local model 11, internal_epoch   2, Avg loss: 0.0277, Accuracy: 431/712 (60.5337%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.4968, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   1, Avg loss: 0.0804, Accuracy: 25/440 (5.6818%)
_Train Local_ResNet_18, epoch  34, local model 49, internal_epoch   2, Avg loss: 0.0483, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.5015, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0644, Accuracy: 169/818 (20.6601%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 364/818 (44.4988%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.9549, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   1, Avg loss: 0.0571, Accuracy: 349/1645 (21.2158%)
_Train Local_ResNet_18, epoch  34, local model 13, internal_epoch   2, Avg loss: 0.0324, Accuracy: 646/1645 (39.2705%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.9220, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch  34, local model 24, internal_epoch   2, Avg loss: 0.0421, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3840, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0710, Accuracy: 90/631 (14.2631%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0413, Accuracy: 215/631 (34.0729%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.8161, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   1, Avg loss: 0.0791, Accuracy: 76/486 (15.6379%)
_Train Local_ResNet_18, epoch  34, local model 30, internal_epoch   2, Avg loss: 0.0407, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.8198, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 44/466 (9.4421%)
_Train Local_ResNet_18, epoch  34, local model 76, internal_epoch   2, Avg loss: 0.0471, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.6062, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 246/1071 (22.9692%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 480/1071 (44.8179%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.9055, Accuracy: 79/10000 (0.7900%)
time spent on training: 125.72241473197937
[foolsgold agg] training data poison_ratio: 0.0  data num: [1130, 712, 440, 818, 1645, 312, 631, 486, 466, 1071]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         0.93036528 1.         1.         0.93036528
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3132, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.5738, Accuracy: 0/9950 (0.0000%)
saving model
Done in 193.2912368774414 sec.
Server Epoch:35 choose agents : [58, 11, 1, 66, 48, 71, 33, 12, 41, 6].
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 354/803 (44.0847%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 397/803 (49.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.9056, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   1, Avg loss: 0.0539, Accuracy: 354/712 (49.7191%)
_Train Local_ResNet_18, epoch  35, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 423/712 (59.4101%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.6999, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   1, Avg loss: 0.0566, Accuracy: 282/928 (30.3879%)
_Train Local_ResNet_18, epoch  35, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 556/928 (59.9138%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.7071, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 276/1402 (19.6862%)
_Train Local_ResNet_18, epoch  35, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 383/1402 (27.3181%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.2780, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   1, Avg loss: 0.0711, Accuracy: 97/631 (15.3724%)
_Train Local_ResNet_18, epoch  35, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 219/631 (34.7068%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.8208, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   1, Avg loss: 0.0650, Accuracy: 150/818 (18.3374%)
_Train Local_ResNet_18, epoch  35, local model 71, internal_epoch   2, Avg loss: 0.0304, Accuracy: 352/818 (43.0318%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.1342, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   1, Avg loss: 0.0788, Accuracy: 72/515 (13.9806%)
_Train Local_ResNet_18, epoch  35, local model 33, internal_epoch   2, Avg loss: 0.0490, Accuracy: 126/515 (24.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.7238, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0871, Accuracy: 25/338 (7.3964%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0466, Accuracy: 150/338 (44.3787%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.4453, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   1, Avg loss: 0.0587, Accuracy: 330/719 (45.8971%)
_Train Local_ResNet_18, epoch  35, local model 41, internal_epoch   2, Avg loss: 0.0323, Accuracy: 441/719 (61.3352%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.3426, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 390/1956 (19.9387%)
_Train Local_ResNet_18, epoch  35, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 625/1956 (31.9530%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.2123, Accuracy: 109/10000 (1.0900%)
time spent on training: 136.41111779212952
[foolsgold agg] training data poison_ratio: 0.0  data num: [803, 712, 928, 1402, 631, 818, 515, 338, 719, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3131, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.5737, Accuracy: 0/9950 (0.0000%)
saving model
Done in 203.10751104354858 sec.
Server Epoch:36 choose agents : [11, 60, 43, 76, 42, 51, 33, 91, 70, 10].
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0554, Accuracy: 356/712 (50.0000%)
_Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0278, Accuracy: 401/712 (56.3202%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.4578, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 584/2227 (26.2236%)
_Train Local_ResNet_18, epoch  36, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1027/2227 (46.1159%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.0764, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   1, Avg loss: 0.0610, Accuracy: 306/946 (32.3467%)
_Train Local_ResNet_18, epoch  36, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 343/946 (36.2579%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.0559, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   1, Avg loss: 0.0858, Accuracy: 51/466 (10.9442%)
_Train Local_ResNet_18, epoch  36, local model 76, internal_epoch   2, Avg loss: 0.0475, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.6739, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 345/1372 (25.1458%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 511/1372 (37.2449%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.6950, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 234/1049 (22.3070%)
_Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 521/1049 (49.6663%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.3610, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   1, Avg loss: 0.0779, Accuracy: 62/515 (12.0388%)
_Train Local_ResNet_18, epoch  36, local model 33, internal_epoch   2, Avg loss: 0.0525, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.6595, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   1, Avg loss: 0.0512, Accuracy: 332/1030 (32.2330%)
_Train Local_ResNet_18, epoch  36, local model 91, internal_epoch   2, Avg loss: 0.0264, Accuracy: 642/1030 (62.3301%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.2944, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   1, Avg loss: 0.0567, Accuracy: 334/1418 (23.5543%)
_Train Local_ResNet_18, epoch  36, local model 70, internal_epoch   2, Avg loss: 0.0313, Accuracy: 663/1418 (46.7560%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.7169, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   1, Avg loss: 0.0567, Accuracy: 216/861 (25.0871%)
_Train Local_ResNet_18, epoch  36, local model 10, internal_epoch   2, Avg loss: 0.0225, Accuracy: 422/861 (49.0128%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9079, Accuracy: 50/10000 (0.5000%)
time spent on training: 139.88708114624023
[foolsgold agg] training data poison_ratio: 0.0  data num: [712, 2227, 946, 466, 1372, 1049, 515, 1030, 1418, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3130, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.5726, Accuracy: 0/9950 (0.0000%)
saving model
Done in 208.45531558990479 sec.
Server Epoch:37 choose agents : [32, 58, 94, 51, 24, 77, 25, 46, 0, 83].
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   1, Avg loss: 0.0597, Accuracy: 204/735 (27.7551%)
_Train Local_ResNet_18, epoch  37, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 362/735 (49.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.3517, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   1, Avg loss: 0.0575, Accuracy: 348/803 (43.3375%)
_Train Local_ResNet_18, epoch  37, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 409/803 (50.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.0378, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 341/1662 (20.5174%)
_Train Local_ResNet_18, epoch  37, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 607/1662 (36.5223%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.9338, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0597, Accuracy: 227/1049 (21.6397%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0295, Accuracy: 518/1049 (49.3804%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.2679, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 38/312 (12.1795%)
_Train Local_ResNet_18, epoch  37, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 161/312 (51.6026%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3829, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 338/1340 (25.2239%)
_Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 561/1340 (41.8657%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.6094, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0576, Accuracy: 300/690 (43.4783%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0276, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.4419, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 413/1904 (21.6912%)
_Train Local_ResNet_18, epoch  37, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 675/1904 (35.4517%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5724, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   1, Avg loss: 0.0580, Accuracy: 351/1657 (21.1829%)
_Train Local_ResNet_18, epoch  37, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 500/1657 (30.1750%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.6259, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 439/1953 (22.4782%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 771/1953 (39.4777%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1083, Accuracy: 105/10000 (1.0500%)
time spent on training: 158.85643100738525
[foolsgold agg] training data poison_ratio: 0.0  data num: [735, 803, 1662, 1049, 312, 1340, 690, 1904, 1657, 1953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3129, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.5693, Accuracy: 0/9950 (0.0000%)
saving model
Done in 226.83127808570862 sec.
Server Epoch:38 choose agents : [77, 3, 38, 41, 58, 72, 33, 17, 87, 42].
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 316/1340 (23.5821%)
_Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 536/1340 (40.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7734, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   1, Avg loss: 0.0745, Accuracy: 105/781 (13.4443%)
_Train Local_ResNet_18, epoch  38, local model 3, internal_epoch   2, Avg loss: 0.0359, Accuracy: 240/781 (30.7298%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.5747, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0615, Accuracy: 249/1131 (22.0159%)
_Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0301, Accuracy: 518/1131 (45.8002%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.3731, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   1, Avg loss: 0.0578, Accuracy: 326/719 (45.3408%)
_Train Local_ResNet_18, epoch  38, local model 41, internal_epoch   2, Avg loss: 0.0327, Accuracy: 467/719 (64.9513%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.3562, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   1, Avg loss: 0.0586, Accuracy: 353/803 (43.9601%)
_Train Local_ResNet_18, epoch  38, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 394/803 (49.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.9547, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 258/1241 (20.7897%)
_Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 410/1241 (33.0379%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.1983, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   1, Avg loss: 0.0785, Accuracy: 70/515 (13.5922%)
_Train Local_ResNet_18, epoch  38, local model 33, internal_epoch   2, Avg loss: 0.0494, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.6980, Accuracy: 48/10000 (0.4800%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 422/1574 (26.8107%)
_Train Local_ResNet_18, epoch  38, local model 17, internal_epoch   2, Avg loss: 0.0270, Accuracy: 693/1574 (44.0280%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0460, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   1, Avg loss: 0.0572, Accuracy: 296/1131 (26.1715%)
_Train Local_ResNet_18, epoch  38, local model 87, internal_epoch   2, Avg loss: 0.0310, Accuracy: 447/1131 (39.5225%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4930, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0528, Accuracy: 355/1372 (25.8746%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 511/1372 (37.2449%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0374, Accuracy: 73/10000 (0.7300%)
time spent on training: 167.75225114822388
[foolsgold agg] training data poison_ratio: 0.1483925709437164  data num: [1340, 781, 1131, 719, 803, 1241, 515, 1574, 1131, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.04637267841991138
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3129, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.5698, Accuracy: 0/9950 (0.0000%)
saving model
Done in 235.12985754013062 sec.
Server Epoch:39 choose agents : [7, 16, 26, 58, 43, 31, 91, 65, 70, 71].
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch  39, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 455/891 (51.0662%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.1344, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   1, Avg loss: 0.0590, Accuracy: 282/708 (39.8305%)
_Train Local_ResNet_18, epoch  39, local model 16, internal_epoch   2, Avg loss: 0.0376, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.9362, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 323/1446 (22.3375%)
_Train Local_ResNet_18, epoch  39, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 492/1446 (34.0249%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.4455, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 361/803 (44.9564%)
_Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 380/803 (47.3225%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.0343, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 293/946 (30.9725%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 350/946 (36.9979%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.0736, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   1, Avg loss: 0.0815, Accuracy: 58/460 (12.6087%)
_Train Local_ResNet_18, epoch  39, local model 31, internal_epoch   2, Avg loss: 0.0359, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.7577, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   1, Avg loss: 0.0523, Accuracy: 332/1030 (32.2330%)
_Train Local_ResNet_18, epoch  39, local model 91, internal_epoch   2, Avg loss: 0.0252, Accuracy: 629/1030 (61.0680%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.1666, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   1, Avg loss: 0.0557, Accuracy: 377/1475 (25.5593%)
_Train Local_ResNet_18, epoch  39, local model 65, internal_epoch   2, Avg loss: 0.0316, Accuracy: 618/1475 (41.8983%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.0058, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 349/1418 (24.6121%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0313, Accuracy: 636/1418 (44.8519%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6489, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   1, Avg loss: 0.0647, Accuracy: 152/818 (18.5819%)
_Train Local_ResNet_18, epoch  39, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 339/818 (41.4425%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.4037, Accuracy: 53/10000 (0.5300%)
time spent on training: 147.01995968818665
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 708, 1446, 803, 946, 460, 1030, 1475, 1418, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3127, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.5685, Accuracy: 0/9950 (0.0000%)
saving model
Done in 213.9117786884308 sec.
Server Epoch:40 choose agents : [91, 9, 78, 81, 54, 1, 63, 83, 43, 64].
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   1, Avg loss: 0.0518, Accuracy: 341/1030 (33.1068%)
_Train Local_ResNet_18, epoch  40, local model 91, internal_epoch   2, Avg loss: 0.0259, Accuracy: 639/1030 (62.0388%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.3939, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   1, Avg loss: 0.0496, Accuracy: 368/1275 (28.8627%)
_Train Local_ResNet_18, epoch  40, local model 9, internal_epoch   2, Avg loss: 0.0191, Accuracy: 712/1275 (55.8431%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.2362, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 35/416 (8.4135%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0474, Accuracy: 178/416 (42.7885%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.5545, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   1, Avg loss: 0.0656, Accuracy: 242/774 (31.2661%)
_Train Local_ResNet_18, epoch  40, local model 81, internal_epoch   2, Avg loss: 0.0363, Accuracy: 328/774 (42.3773%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.2024, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 345/1130 (30.5310%)
_Train Local_ResNet_18, epoch  40, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 454/1130 (40.1770%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.6009, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   1, Avg loss: 0.0573, Accuracy: 285/928 (30.7112%)
_Train Local_ResNet_18, epoch  40, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 551/928 (59.3750%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8244, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   1, Avg loss: 0.0538, Accuracy: 271/888 (30.5180%)
_Train Local_ResNet_18, epoch  40, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 449/888 (50.5631%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.0898, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0547, Accuracy: 388/1953 (19.8669%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 781/1953 (39.9898%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.1717, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 303/946 (32.0296%)
_Train Local_ResNet_18, epoch  40, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 337/946 (35.6237%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.0603, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0640, Accuracy: 185/953 (19.4124%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 323/953 (33.8930%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.6856, Accuracy: 57/10000 (0.5700%)
time spent on training: 147.0057065486908
[foolsgold agg] training data poison_ratio: 0.0  data num: [1030, 1275, 416, 774, 1130, 928, 888, 1953, 946, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3127, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.5671, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 213.94501209259033 sec.
Server Epoch:41 choose agents : [84, 24, 89, 37, 74, 44, 20, 50, 15, 3].
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   1, Avg loss: 0.0621, Accuracy: 329/1190 (27.6471%)
_Train Local_ResNet_18, epoch  41, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 461/1190 (38.7395%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.9038, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   1, Avg loss: 0.0763, Accuracy: 37/312 (11.8590%)
_Train Local_ResNet_18, epoch  41, local model 24, internal_epoch   2, Avg loss: 0.0410, Accuracy: 161/312 (51.6026%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3842, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   1, Avg loss: 0.0600, Accuracy: 328/896 (36.6071%)
_Train Local_ResNet_18, epoch  41, local model 89, internal_epoch   2, Avg loss: 0.0343, Accuracy: 437/896 (48.7723%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.3457, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   1, Avg loss: 0.0519, Accuracy: 448/1129 (39.6811%)
_Train Local_ResNet_18, epoch  41, local model 37, internal_epoch   2, Avg loss: 0.0252, Accuracy: 732/1129 (64.8361%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.3525, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   1, Avg loss: 0.0437, Accuracy: 468/1552 (30.1546%)
_Train Local_ResNet_18, epoch  41, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 785/1552 (50.5799%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 10.3043, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 406/1750 (23.2000%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 675/1750 (38.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.5189, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 349/807 (43.2466%)
_Train Local_ResNet_18, epoch  41, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 421/807 (52.1685%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.7192, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   1, Avg loss: 0.0626, Accuracy: 158/809 (19.5303%)
_Train Local_ResNet_18, epoch  41, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 342/809 (42.2744%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.1082, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   1, Avg loss: 0.0575, Accuracy: 335/1154 (29.0295%)
_Train Local_ResNet_18, epoch  41, local model 15, internal_epoch   2, Avg loss: 0.0295, Accuracy: 378/1154 (32.7556%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.2186, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   1, Avg loss: 0.0752, Accuracy: 117/781 (14.9808%)
_Train Local_ResNet_18, epoch  41, local model 3, internal_epoch   2, Avg loss: 0.0355, Accuracy: 227/781 (29.0653%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.5800, Accuracy: 65/10000 (0.6500%)
time spent on training: 156.47664070129395
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 312, 896, 1129, 1552, 1750, 807, 809, 1154, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3126, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.5673, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 224.81861019134521 sec.
Server Epoch:42 choose agents : [42, 66, 59, 31, 44, 93, 14, 37, 33, 29].
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 375/1372 (27.3324%)
_Train Local_ResNet_18, epoch  42, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 492/1372 (35.8601%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6333, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 275/1402 (19.6148%)
_Train Local_ResNet_18, epoch  42, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 397/1402 (28.3167%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.1608, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   1, Avg loss: 0.0599, Accuracy: 300/1089 (27.5482%)
_Train Local_ResNet_18, epoch  42, local model 59, internal_epoch   2, Avg loss: 0.0275, Accuracy: 453/1089 (41.5978%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.5364, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 64/460 (13.9130%)
_Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0380, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.7709, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   1, Avg loss: 0.0603, Accuracy: 381/1750 (21.7714%)
_Train Local_ResNet_18, epoch  42, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 664/1750 (37.9429%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6030, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 424/1742 (24.3398%)
_Train Local_ResNet_18, epoch  42, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 701/1742 (40.2411%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.7815, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 221/1013 (21.8164%)
_Train Local_ResNet_18, epoch  42, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 347/1013 (34.2547%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.7900, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 411/1129 (36.4039%)
_Train Local_ResNet_18, epoch  42, local model 37, internal_epoch   2, Avg loss: 0.0250, Accuracy: 738/1129 (65.3676%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.8265, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   1, Avg loss: 0.0798, Accuracy: 66/515 (12.8155%)
_Train Local_ResNet_18, epoch  42, local model 33, internal_epoch   2, Avg loss: 0.0538, Accuracy: 134/515 (26.0194%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.6536, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   1, Avg loss: 0.0488, Accuracy: 412/1440 (28.6111%)
_Train Local_ResNet_18, epoch  42, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 699/1440 (48.5417%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.8752, Accuracy: 55/10000 (0.5500%)
time spent on training: 175.72705578804016
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 1402, 1089, 460, 1750, 1742, 1013, 1129, 515, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3125, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.5676, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 243.72413444519043 sec.
Server Epoch:43 choose agents : [89, 77, 29, 75, 94, 3, 90, 39, 30, 20].
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 339/896 (37.8348%)
_Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 465/896 (51.8973%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.2382, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 334/1340 (24.9254%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 565/1340 (42.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.5904, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   1, Avg loss: 0.0496, Accuracy: 407/1440 (28.2639%)
_Train Local_ResNet_18, epoch  43, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 673/1440 (46.7361%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.8517, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   1, Avg loss: 0.0625, Accuracy: 254/776 (32.7320%)
_Train Local_ResNet_18, epoch  43, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 409/776 (52.7062%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.8528, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   1, Avg loss: 0.0544, Accuracy: 347/1662 (20.8785%)
_Train Local_ResNet_18, epoch  43, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 625/1662 (37.6053%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.8082, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   1, Avg loss: 0.0747, Accuracy: 106/781 (13.5723%)
_Train Local_ResNet_18, epoch  43, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 246/781 (31.4981%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.6555, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   1, Avg loss: 0.0575, Accuracy: 312/677 (46.0857%)
_Train Local_ResNet_18, epoch  43, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 434/677 (64.1064%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.3008, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 318/1013 (31.3919%)
_Train Local_ResNet_18, epoch  43, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 502/1013 (49.5558%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.5309, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0799, Accuracy: 74/486 (15.2263%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.7733, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   1, Avg loss: 0.0566, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch  43, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 421/807 (52.1685%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.1829, Accuracy: 50/10000 (0.5000%)
time spent on training: 149.70651578903198
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 1340, 1440, 776, 1662, 781, 677, 1013, 486, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3124, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.5673, Accuracy: 0/9950 (0.0000%)
saving model
Done in 217.96728372573853 sec.
Server Epoch:44 choose agents : [98, 51, 93, 3, 14, 31, 63, 57, 35, 56].
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   1, Avg loss: 0.0812, Accuracy: 21/373 (5.6300%)
_Train Local_ResNet_18, epoch  44, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.4431, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 232/1049 (22.1163%)
_Train Local_ResNet_18, epoch  44, local model 51, internal_epoch   2, Avg loss: 0.0297, Accuracy: 533/1049 (50.8103%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.5307, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   1, Avg loss: 0.0541, Accuracy: 393/1742 (22.5603%)
_Train Local_ResNet_18, epoch  44, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 720/1742 (41.3318%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.0096, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   1, Avg loss: 0.0739, Accuracy: 112/781 (14.3406%)
_Train Local_ResNet_18, epoch  44, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 240/781 (30.7298%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.6982, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 233/1013 (23.0010%)
_Train Local_ResNet_18, epoch  44, local model 14, internal_epoch   2, Avg loss: 0.0350, Accuracy: 361/1013 (35.6367%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.7125, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0808, Accuracy: 69/460 (15.0000%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.8813, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   1, Avg loss: 0.0537, Accuracy: 273/888 (30.7432%)
_Train Local_ResNet_18, epoch  44, local model 63, internal_epoch   2, Avg loss: 0.0252, Accuracy: 444/888 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.5247, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   1, Avg loss: 0.0547, Accuracy: 298/1154 (25.8232%)
_Train Local_ResNet_18, epoch  44, local model 57, internal_epoch   2, Avg loss: 0.0255, Accuracy: 499/1154 (43.2409%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.4004, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0848, Accuracy: 44/271 (16.2362%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0548, Accuracy: 106/271 (39.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3685, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 61/186 (32.7957%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
time spent on training: 135.04680967330933
[foolsgold agg] training data poison_ratio: 0.0  data num: [373, 1049, 1742, 781, 1013, 460, 888, 1154, 271, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3123, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.5675, Accuracy: 0/9950 (0.0000%)
saving model
Done in 201.95487236976624 sec.
Server Epoch:45 choose agents : [28, 80, 26, 1, 93, 55, 13, 98, 61, 75].
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 393/1581 (24.8577%)
_Train Local_ResNet_18, epoch  45, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 620/1581 (39.2157%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.5700, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   1, Avg loss: 0.0705, Accuracy: 135/682 (19.7947%)
_Train Local_ResNet_18, epoch  45, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 251/682 (36.8035%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.4524, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 343/1446 (23.7206%)
_Train Local_ResNet_18, epoch  45, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 523/1446 (36.1687%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.4026, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   1, Avg loss: 0.0564, Accuracy: 283/928 (30.4957%)
_Train Local_ResNet_18, epoch  45, local model 1, internal_epoch   2, Avg loss: 0.0238, Accuracy: 551/928 (59.3750%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.5898, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 407/1742 (23.3639%)
_Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 713/1742 (40.9300%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.7228, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Avg loss: 0.0561, Accuracy: 277/1071 (25.8637%)
_Train Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 519/1071 (48.4594%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.7926, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   1, Avg loss: 0.0573, Accuracy: 316/1645 (19.2097%)
_Train Local_ResNet_18, epoch  45, local model 13, internal_epoch   2, Avg loss: 0.0323, Accuracy: 638/1645 (38.7842%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.9862, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   1, Avg loss: 0.0815, Accuracy: 23/373 (6.1662%)
_Train Local_ResNet_18, epoch  45, local model 98, internal_epoch   2, Avg loss: 0.0474, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.4393, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   1, Avg loss: 0.1260, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 61, internal_epoch   2, Avg loss: 0.1186, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3042, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   1, Avg loss: 0.0634, Accuracy: 254/776 (32.7320%)
_Train Local_ResNet_18, epoch  45, local model 75, internal_epoch   2, Avg loss: 0.0312, Accuracy: 395/776 (50.9021%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.0638, Accuracy: 52/10000 (0.5200%)
time spent on training: 163.5981903076172
[foolsgold agg] training data poison_ratio: 0.0  data num: [1581, 682, 1446, 928, 1742, 1071, 1645, 373, 85, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3121, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.5670, Accuracy: 0/9950 (0.0000%)
saving model
Done in 229.47523665428162 sec.
Server Epoch:46 choose agents : [96, 53, 15, 74, 95, 89, 38, 49, 11, 16].
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   1, Avg loss: 0.0790, Accuracy: 51/311 (16.3987%)
_Train Local_ResNet_18, epoch  46, local model 96, internal_epoch   2, Avg loss: 0.0539, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3469, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   1, Avg loss: 0.0494, Accuracy: 284/813 (34.9323%)
_Train Local_ResNet_18, epoch  46, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 447/813 (54.9815%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.3173, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0575, Accuracy: 317/1154 (27.4697%)
_Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0285, Accuracy: 480/1154 (41.5945%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8277, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 516/1552 (33.2474%)
_Train Local_ResNet_18, epoch  46, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 781/1552 (50.3222%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 11.1151, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   1, Avg loss: 0.0542, Accuracy: 328/599 (54.7579%)
_Train Local_ResNet_18, epoch  46, local model 95, internal_epoch   2, Avg loss: 0.0286, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.4319, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0613, Accuracy: 330/896 (36.8304%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 436/896 (48.6607%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.2829, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   1, Avg loss: 0.0616, Accuracy: 252/1131 (22.2812%)
_Train Local_ResNet_18, epoch  46, local model 38, internal_epoch   2, Avg loss: 0.0308, Accuracy: 449/1131 (39.6994%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.7100, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   1, Avg loss: 0.0801, Accuracy: 25/440 (5.6818%)
_Train Local_ResNet_18, epoch  46, local model 49, internal_epoch   2, Avg loss: 0.0476, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.5086, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   1, Avg loss: 0.0563, Accuracy: 346/712 (48.5955%)
_Train Local_ResNet_18, epoch  46, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 419/712 (58.8483%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.5542, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0600, Accuracy: 275/708 (38.8418%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8540, Accuracy: 54/10000 (0.5400%)
time spent on training: 144.37075304985046
[foolsgold agg] training data poison_ratio: 0.0  data num: [311, 813, 1154, 1552, 599, 896, 1131, 440, 712, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         1.         0.80624273 0.80624273]
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3121, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.5670, Accuracy: 0/9950 (0.0000%)
saving model
Done in 212.18908405303955 sec.
Server Epoch:47 choose agents : [65, 76, 17, 71, 31, 74, 25, 82, 54, 12].
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   1, Avg loss: 0.0551, Accuracy: 395/1475 (26.7797%)
_Train Local_ResNet_18, epoch  47, local model 65, internal_epoch   2, Avg loss: 0.0316, Accuracy: 673/1475 (45.6271%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.0089, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0852, Accuracy: 49/466 (10.5150%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0482, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.6497, Accuracy: 50/10000 (0.5000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 411/1574 (26.1118%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 676/1574 (42.9479%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.2817, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   1, Avg loss: 0.0640, Accuracy: 150/818 (18.3374%)
_Train Local_ResNet_18, epoch  47, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 324/818 (39.6088%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.1193, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   1, Avg loss: 0.0810, Accuracy: 60/460 (13.0435%)
_Train Local_ResNet_18, epoch  47, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.7792, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 491/1552 (31.6366%)
_Train Local_ResNet_18, epoch  47, local model 74, internal_epoch   2, Avg loss: 0.0214, Accuracy: 771/1552 (49.6778%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 10.5145, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   1, Avg loss: 0.0560, Accuracy: 307/690 (44.4928%)
_Train Local_ResNet_18, epoch  47, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 454/690 (65.7971%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.4484, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   1, Avg loss: 0.0764, Accuracy: 69/500 (13.8000%)
_Train Local_ResNet_18, epoch  47, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.6490, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 350/1130 (30.9735%)
_Train Local_ResNet_18, epoch  47, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 456/1130 (40.3540%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.4827, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0875, Accuracy: 26/338 (7.6923%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0466, Accuracy: 132/338 (39.0533%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.4367, Accuracy: 50/10000 (0.5000%)
time spent on training: 156.51320052146912
[foolsgold agg] training data poison_ratio: 0.17483061201821615  data num: [1475, 466, 1574, 818, 460, 1552, 690, 500, 1130, 338]
[foolsgold agg] considering poison per batch poison_fraction: 0.054634566255692546
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3120, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.5659, Accuracy: 0/9950 (0.0000%)
saving model
Done in 223.12523245811462 sec.
Server Epoch:48 choose agents : [41, 89, 82, 3, 10, 19, 72, 60, 95, 38].
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   1, Avg loss: 0.0584, Accuracy: 336/719 (46.7316%)
_Train Local_ResNet_18, epoch  48, local model 41, internal_epoch   2, Avg loss: 0.0321, Accuracy: 455/719 (63.2823%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.3184, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 335/896 (37.3884%)
_Train Local_ResNet_18, epoch  48, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 449/896 (50.1116%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.3228, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 77/500 (15.4000%)
_Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.6128, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   1, Avg loss: 0.0743, Accuracy: 112/781 (14.3406%)
_Train Local_ResNet_18, epoch  48, local model 3, internal_epoch   2, Avg loss: 0.0352, Accuracy: 244/781 (31.2420%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.7350, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   1, Avg loss: 0.0566, Accuracy: 218/861 (25.3194%)
_Train Local_ResNet_18, epoch  48, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 449/861 (52.1487%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.7227, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0479, Accuracy: 393/1036 (37.9344%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0245, Accuracy: 657/1036 (63.4170%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.3666, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 251/1241 (20.2256%)
_Train Local_ResNet_18, epoch  48, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 373/1241 (30.0564%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.0204, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 631/2227 (28.3341%)
_Train Local_ResNet_18, epoch  48, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1025/2227 (46.0260%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.1475, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0541, Accuracy: 339/599 (56.5943%)
_Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0297, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.5686, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0618, Accuracy: 253/1131 (22.3696%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 488/1131 (43.1477%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.4635, Accuracy: 80/10000 (0.8000%)
time spent on training: 159.72450709342957
[foolsgold agg] training data poison_ratio: 0.0  data num: [719, 896, 500, 781, 861, 1036, 1241, 2227, 599, 1131]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3119, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.5645, Accuracy: 0/9950 (0.0000%)
saving model
Done in 228.2392418384552 sec.
Server Epoch:49 choose agents : [17, 1, 30, 40, 83, 97, 18, 68, 10, 21].
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 424/1574 (26.9377%)
_Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 698/1574 (44.3456%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.2158, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   1, Avg loss: 0.0557, Accuracy: 295/928 (31.7888%)
_Train Local_ResNet_18, epoch  49, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 576/928 (62.0690%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.6523, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   1, Avg loss: 0.0799, Accuracy: 70/486 (14.4033%)
_Train Local_ResNet_18, epoch  49, local model 30, internal_epoch   2, Avg loss: 0.0402, Accuracy: 208/486 (42.7984%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8217, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 353/1573 (22.4412%)
_Train Local_ResNet_18, epoch  49, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 525/1573 (33.3757%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.4731, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 440/1953 (22.5294%)
_Train Local_ResNet_18, epoch  49, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 757/1953 (38.7609%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.7920, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 354/1213 (29.1838%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 485/1213 (39.9835%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.6318, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0771, Accuracy: 115/530 (21.6981%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0393, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.1459, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   1, Avg loss: 0.0627, Accuracy: 364/1163 (31.2984%)
_Train Local_ResNet_18, epoch  49, local model 68, internal_epoch   2, Avg loss: 0.0364, Accuracy: 459/1163 (39.4669%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.8225, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   1, Avg loss: 0.0568, Accuracy: 214/861 (24.8548%)
_Train Local_ResNet_18, epoch  49, local model 10, internal_epoch   2, Avg loss: 0.0208, Accuracy: 476/861 (55.2846%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.7255, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 415/1949 (21.2930%)
_Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0324, Accuracy: 634/1949 (32.5295%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.3654, Accuracy: 87/10000 (0.8700%)
time spent on training: 212.0352966785431
[foolsgold agg] training data poison_ratio: 0.12869991823385118  data num: [1574, 928, 486, 1573, 1953, 1213, 530, 1163, 861, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.040218724448078495
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3119, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.5648, Accuracy: 0/9950 (0.0000%)
saving model
Done in 280.00066113471985 sec.
Server Epoch:50 choose agents : [39, 48, 81, 51, 63, 5, 60, 7, 70, 41].
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 317/1013 (31.2932%)
_Train Local_ResNet_18, epoch  50, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 490/1013 (48.3712%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.6379, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 102/631 (16.1648%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 222/631 (35.1823%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.8783, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0689, Accuracy: 243/774 (31.3953%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0342, Accuracy: 317/774 (40.9561%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.4340, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   1, Avg loss: 0.0594, Accuracy: 230/1049 (21.9256%)
_Train Local_ResNet_18, epoch  50, local model 51, internal_epoch   2, Avg loss: 0.0296, Accuracy: 533/1049 (50.8103%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.7194, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 256/888 (28.8288%)
_Train Local_ResNet_18, epoch  50, local model 63, internal_epoch   2, Avg loss: 0.0261, Accuracy: 420/888 (47.2973%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.3231, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 391/1628 (24.0172%)
_Train Local_ResNet_18, epoch  50, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 790/1628 (48.5258%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.2619, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 559/2227 (25.1010%)
_Train Local_ResNet_18, epoch  50, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1048/2227 (47.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.1319, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 357/891 (40.0673%)
_Train Local_ResNet_18, epoch  50, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 441/891 (49.4949%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.1128, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 363/1418 (25.5994%)
_Train Local_ResNet_18, epoch  50, local model 70, internal_epoch   2, Avg loss: 0.0302, Accuracy: 675/1418 (47.6023%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.6746, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   1, Avg loss: 0.0604, Accuracy: 333/719 (46.3143%)
_Train Local_ResNet_18, epoch  50, local model 41, internal_epoch   2, Avg loss: 0.0301, Accuracy: 455/719 (63.2823%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.3885, Accuracy: 55/10000 (0.5500%)
time spent on training: 189.32601881027222
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 631, 774, 1049, 888, 1628, 2227, 891, 1418, 719]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3118, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.5638, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 257.8984274864197 sec.
Server Epoch:51 choose agents : [4, 56, 21, 33, 59, 41, 11, 71, 6, 92].
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   1, Avg loss: 0.0607, Accuracy: 327/901 (36.2930%)
_Train Local_ResNet_18, epoch  51, local model 4, internal_epoch   2, Avg loss: 0.0358, Accuracy: 364/901 (40.3996%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.8157, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 69/186 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3113, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 415/1949 (21.2930%)
_Train Local_ResNet_18, epoch  51, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 624/1949 (32.0164%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.5070, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0812, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0502, Accuracy: 129/515 (25.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.7019, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0578, Accuracy: 304/1089 (27.9155%)
_Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 421/1089 (38.6593%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.7242, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   1, Avg loss: 0.0574, Accuracy: 336/719 (46.7316%)
_Train Local_ResNet_18, epoch  51, local model 41, internal_epoch   2, Avg loss: 0.0323, Accuracy: 463/719 (64.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.4051, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   1, Avg loss: 0.0545, Accuracy: 345/712 (48.4551%)
_Train Local_ResNet_18, epoch  51, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 442/712 (62.0787%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.6356, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0637, Accuracy: 188/818 (22.9829%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 371/818 (45.3545%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.0764, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 402/1956 (20.5521%)
_Train Local_ResNet_18, epoch  51, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 647/1956 (33.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.2141, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 446/1715 (26.0058%)
_Train Local_ResNet_18, epoch  51, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 715/1715 (41.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.5519, Accuracy: 76/10000 (0.7600%)
time spent on training: 171.99533104896545
[foolsgold agg] training data poison_ratio: 0.0  data num: [901, 186, 1949, 515, 1089, 719, 712, 818, 1956, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3117, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.5639, Accuracy: 0/9950 (0.0000%)
saving model
Done in 239.78607773780823 sec.
Server Epoch:52 choose agents : [89, 33, 83, 60, 57, 18, 41, 0, 31, 30].
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 331/896 (36.9420%)
_Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 435/896 (48.5491%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.3706, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   1, Avg loss: 0.0777, Accuracy: 67/515 (13.0097%)
_Train Local_ResNet_18, epoch  52, local model 33, internal_epoch   2, Avg loss: 0.0520, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.7914, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 425/1953 (21.7614%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 758/1953 (38.8121%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.9558, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 619/2227 (27.7952%)
_Train Local_ResNet_18, epoch  52, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1019/2227 (45.7566%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.2330, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   1, Avg loss: 0.0542, Accuracy: 310/1154 (26.8631%)
_Train Local_ResNet_18, epoch  52, local model 57, internal_epoch   2, Avg loss: 0.0241, Accuracy: 554/1154 (48.0069%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3789, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0762, Accuracy: 120/530 (22.6415%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0369, Accuracy: 263/530 (49.6226%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.9444, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   1, Avg loss: 0.0607, Accuracy: 331/719 (46.0362%)
_Train Local_ResNet_18, epoch  52, local model 41, internal_epoch   2, Avg loss: 0.0320, Accuracy: 446/719 (62.0306%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.1632, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   1, Avg loss: 0.0588, Accuracy: 345/1657 (20.8208%)
_Train Local_ResNet_18, epoch  52, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 534/1657 (32.2269%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.5271, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   1, Avg loss: 0.0806, Accuracy: 66/460 (14.3478%)
_Train Local_ResNet_18, epoch  52, local model 31, internal_epoch   2, Avg loss: 0.0356, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.7678, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   1, Avg loss: 0.0789, Accuracy: 75/486 (15.4321%)
_Train Local_ResNet_18, epoch  52, local model 30, internal_epoch   2, Avg loss: 0.0401, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.7805, Accuracy: 43/10000 (0.4300%)
time spent on training: 166.7672872543335
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 515, 1953, 2227, 1154, 530, 719, 1657, 460, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3116, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.5616, Accuracy: 0/9950 (0.0000%)
saving model
Done in 234.99237608909607 sec.
Server Epoch:53 choose agents : [43, 26, 61, 17, 27, 48, 39, 7, 15, 21].
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   1, Avg loss: 0.0610, Accuracy: 314/946 (33.1924%)
_Train Local_ResNet_18, epoch  53, local model 43, internal_epoch   2, Avg loss: 0.0355, Accuracy: 359/946 (37.9493%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.0392, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   1, Avg loss: 0.0544, Accuracy: 366/1446 (25.3112%)
_Train Local_ResNet_18, epoch  53, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 519/1446 (35.8921%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.2052, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   1, Avg loss: 0.1238, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  53, local model 61, internal_epoch   2, Avg loss: 0.1162, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3038, Accuracy: 50/10000 (0.5000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   1, Avg loss: 0.0508, Accuracy: 401/1574 (25.4765%)
_Train Local_ResNet_18, epoch  53, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 660/1574 (41.9314%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0287, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0541, Accuracy: 430/1587 (27.0951%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0344, Accuracy: 582/1587 (36.6730%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.1136, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 95/631 (15.0555%)
_Train Local_ResNet_18, epoch  53, local model 48, internal_epoch   2, Avg loss: 0.0403, Accuracy: 223/631 (35.3407%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.8308, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   1, Avg loss: 0.0541, Accuracy: 320/1013 (31.5893%)
_Train Local_ResNet_18, epoch  53, local model 39, internal_epoch   2, Avg loss: 0.0256, Accuracy: 502/1013 (49.5558%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.6903, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 352/891 (39.5062%)
_Train Local_ResNet_18, epoch  53, local model 7, internal_epoch   2, Avg loss: 0.0249, Accuracy: 464/891 (52.0763%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.9704, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   1, Avg loss: 0.0565, Accuracy: 334/1154 (28.9428%)
_Train Local_ResNet_18, epoch  53, local model 15, internal_epoch   2, Avg loss: 0.0289, Accuracy: 427/1154 (37.0017%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.9040, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 405/1949 (20.7799%)
_Train Local_ResNet_18, epoch  53, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 617/1949 (31.6573%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3907, Accuracy: 85/10000 (0.8500%)
time spent on training: 193.25174760818481
[foolsgold agg] training data poison_ratio: 0.13958850656261085  data num: [946, 1446, 85, 1574, 1587, 631, 1013, 891, 1154, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.043621408300815886
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3115, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.5620, Accuracy: 0/9950 (0.0000%)
saving model
Done in 260.52492213249207 sec.
Server Epoch:54 choose agents : [37, 68, 15, 88, 46, 83, 7, 6, 92, 53].
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   1, Avg loss: 0.0514, Accuracy: 431/1129 (38.1754%)
_Train Local_ResNet_18, epoch  54, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 745/1129 (65.9876%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.5796, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   1, Avg loss: 0.0625, Accuracy: 370/1163 (31.8143%)
_Train Local_ResNet_18, epoch  54, local model 68, internal_epoch   2, Avg loss: 0.0376, Accuracy: 398/1163 (34.2218%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.9190, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   1, Avg loss: 0.0585, Accuracy: 331/1154 (28.6828%)
_Train Local_ResNet_18, epoch  54, local model 15, internal_epoch   2, Avg loss: 0.0291, Accuracy: 433/1154 (37.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.1270, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   1, Avg loss: 0.0749, Accuracy: 148/603 (24.5439%)
_Train Local_ResNet_18, epoch  54, local model 88, internal_epoch   2, Avg loss: 0.0453, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.8920, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0546, Accuracy: 400/1904 (21.0084%)
_Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 714/1904 (37.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.7173, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 425/1953 (21.7614%)
_Train Local_ResNet_18, epoch  54, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 755/1953 (38.6585%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8296, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0525, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 465/891 (52.1886%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.9956, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 440/1956 (22.4949%)
_Train Local_ResNet_18, epoch  54, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 628/1956 (32.1063%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.0971, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   1, Avg loss: 0.0522, Accuracy: 456/1715 (26.5889%)
_Train Local_ResNet_18, epoch  54, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 713/1715 (41.5743%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.6378, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   1, Avg loss: 0.0488, Accuracy: 288/813 (35.4244%)
_Train Local_ResNet_18, epoch  54, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 478/813 (58.7946%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.4564, Accuracy: 53/10000 (0.5300%)
time spent on training: 207.04695892333984
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 1163, 1154, 603, 1904, 1953, 891, 1956, 1715, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3115, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.5626, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.5676362514496 sec.
Server Epoch:55 choose agents : [87, 76, 15, 54, 78, 12, 60, 11, 26, 97].
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   1, Avg loss: 0.0570, Accuracy: 299/1131 (26.4368%)
_Train Local_ResNet_18, epoch  55, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 422/1131 (37.3121%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.5893, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   1, Avg loss: 0.0848, Accuracy: 54/466 (11.5880%)
_Train Local_ResNet_18, epoch  55, local model 76, internal_epoch   2, Avg loss: 0.0499, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.6531, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   1, Avg loss: 0.0569, Accuracy: 327/1154 (28.3362%)
_Train Local_ResNet_18, epoch  55, local model 15, internal_epoch   2, Avg loss: 0.0291, Accuracy: 430/1154 (37.2617%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7241, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0545, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 507/1130 (44.8673%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.9970, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.0833, Accuracy: 37/416 (8.8942%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0461, Accuracy: 184/416 (44.2308%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.5715, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 28/338 (8.2840%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0464, Accuracy: 143/338 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.4610, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   1, Avg loss: 0.0490, Accuracy: 610/2227 (27.3911%)
_Train Local_ResNet_18, epoch  55, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1045/2227 (46.9241%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.1256, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   1, Avg loss: 0.0531, Accuracy: 356/712 (50.0000%)
_Train Local_ResNet_18, epoch  55, local model 11, internal_epoch   2, Avg loss: 0.0269, Accuracy: 453/712 (63.6236%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.6297, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 344/1446 (23.7898%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 504/1446 (34.8548%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.5526, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 357/1213 (29.4312%)
_Train Local_ResNet_18, epoch  55, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 501/1213 (41.3026%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.8040, Accuracy: 89/10000 (0.8900%)
time spent on training: 182.83332204818726
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 466, 1154, 1130, 416, 338, 2227, 712, 1446, 1213]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3114, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.5613, Accuracy: 0/9950 (0.0000%)
saving model
Done in 250.7836983203888 sec.
Server Epoch:56 choose agents : [40, 83, 46, 17, 88, 71, 44, 31, 25, 6].
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   1, Avg loss: 0.0552, Accuracy: 360/1573 (22.8862%)
_Train Local_ResNet_18, epoch  56, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 591/1573 (37.5715%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4149, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 405/1953 (20.7373%)
_Train Local_ResNet_18, epoch  56, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 741/1953 (37.9416%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.6416, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   1, Avg loss: 0.0546, Accuracy: 420/1904 (22.0588%)
_Train Local_ResNet_18, epoch  56, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 665/1904 (34.9265%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.6134, Accuracy: 95/10000 (0.9500%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 445/1574 (28.2719%)
_Train Local_ResNet_18, epoch  56, local model 17, internal_epoch   2, Avg loss: 0.0269, Accuracy: 679/1574 (43.1385%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.2570, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 139/603 (23.0514%)
_Train Local_ResNet_18, epoch  56, local model 88, internal_epoch   2, Avg loss: 0.0463, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.9661, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   1, Avg loss: 0.0638, Accuracy: 159/818 (19.4377%)
_Train Local_ResNet_18, epoch  56, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 360/818 (44.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.1620, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   1, Avg loss: 0.0584, Accuracy: 422/1750 (24.1143%)
_Train Local_ResNet_18, epoch  56, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 627/1750 (35.8286%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4724, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   1, Avg loss: 0.0810, Accuracy: 63/460 (13.6957%)
_Train Local_ResNet_18, epoch  56, local model 31, internal_epoch   2, Avg loss: 0.0367, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.7881, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0559, Accuracy: 313/690 (45.3623%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.4768, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 409/1956 (20.9100%)
_Train Local_ResNet_18, epoch  56, local model 6, internal_epoch   2, Avg loss: 0.0315, Accuracy: 680/1956 (34.7648%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.1452, Accuracy: 117/10000 (1.1700%)
time spent on training: 221.70028233528137
[foolsgold agg] training data poison_ratio: 0.11851517205029742  data num: [1573, 1953, 1904, 1574, 603, 818, 1750, 460, 690, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.037035991265717945
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3113, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.5614, Accuracy: 0/9950 (0.0000%)
saving model
Done in 289.81627345085144 sec.
Server Epoch:57 choose agents : [39, 55, 3, 31, 73, 74, 69, 87, 8, 34].
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   1, Avg loss: 0.0533, Accuracy: 322/1013 (31.7868%)
_Train Local_ResNet_18, epoch  57, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 516/1013 (50.9378%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.7703, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0556, Accuracy: 254/1071 (23.7162%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0284, Accuracy: 523/1071 (48.8329%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.2310, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   1, Avg loss: 0.0746, Accuracy: 107/781 (13.7004%)
_Train Local_ResNet_18, epoch  57, local model 3, internal_epoch   2, Avg loss: 0.0364, Accuracy: 232/781 (29.7055%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.7955, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   1, Avg loss: 0.0800, Accuracy: 62/460 (13.4783%)
_Train Local_ResNet_18, epoch  57, local model 31, internal_epoch   2, Avg loss: 0.0376, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.8671, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   1, Avg loss: 0.0656, Accuracy: 178/938 (18.9765%)
_Train Local_ResNet_18, epoch  57, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 315/938 (33.5821%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.6321, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   1, Avg loss: 0.0435, Accuracy: 490/1552 (31.5722%)
_Train Local_ResNet_18, epoch  57, local model 74, internal_epoch   2, Avg loss: 0.0213, Accuracy: 760/1552 (48.9691%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 10.9960, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   1, Avg loss: 0.0573, Accuracy: 294/590 (49.8305%)
_Train Local_ResNet_18, epoch  57, local model 69, internal_epoch   2, Avg loss: 0.0298, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.1535, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   1, Avg loss: 0.0573, Accuracy: 305/1131 (26.9673%)
_Train Local_ResNet_18, epoch  57, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 418/1131 (36.9584%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.8159, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   1, Avg loss: 0.0596, Accuracy: 259/1513 (17.1183%)
_Train Local_ResNet_18, epoch  57, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 502/1513 (33.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.5393, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   1, Avg loss: 0.0583, Accuracy: 361/1427 (25.2978%)
_Train Local_ResNet_18, epoch  57, local model 34, internal_epoch   2, Avg loss: 0.0337, Accuracy: 562/1427 (39.3833%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.8194, Accuracy: 57/10000 (0.5700%)
time spent on training: 184.3763289451599
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 1071, 781, 460, 938, 1552, 590, 1131, 1513, 1427]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3113, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.5609, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.14845871925354 sec.
Server Epoch:58 choose agents : [33, 30, 88, 34, 73, 19, 26, 23, 32, 22].
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0779, Accuracy: 66/515 (12.8155%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0552, Accuracy: 131/515 (25.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.7150, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   1, Avg loss: 0.0796, Accuracy: 78/486 (16.0494%)
_Train Local_ResNet_18, epoch  58, local model 30, internal_epoch   2, Avg loss: 0.0399, Accuracy: 214/486 (44.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8430, Accuracy: 39/10000 (0.3900%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 139/603 (23.0514%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0465, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8864, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0582, Accuracy: 394/1427 (27.6104%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 594/1427 (41.6258%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.7996, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   1, Avg loss: 0.0651, Accuracy: 168/938 (17.9104%)
_Train Local_ResNet_18, epoch  58, local model 73, internal_epoch   2, Avg loss: 0.0329, Accuracy: 368/938 (39.2324%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.5209, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 399/1036 (38.5135%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0235, Accuracy: 682/1036 (65.8301%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.0731, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 344/1446 (23.7898%)
_Train Local_ResNet_18, epoch  58, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 518/1446 (35.8230%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.2820, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0591, Accuracy: 325/715 (45.4545%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0403, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.7565, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   1, Avg loss: 0.0595, Accuracy: 197/735 (26.8027%)
_Train Local_ResNet_18, epoch  58, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 375/735 (51.0204%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.9867, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 537/1470 (36.5306%)
_Train Local_ResNet_18, epoch  58, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 840/1470 (57.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.1687, Accuracy: 72/10000 (0.7200%)
time spent on training: 164.97945499420166
[foolsgold agg] training data poison_ratio: 0.0  data num: [515, 486, 603, 1427, 938, 1036, 1446, 715, 735, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.5561, Accuracy: 0/9950 (0.0000%)
saving model
Done in 232.20861554145813 sec.
Server Epoch:59 choose agents : [68, 82, 5, 39, 20, 22, 96, 74, 52, 98].
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   1, Avg loss: 0.0630, Accuracy: 365/1163 (31.3844%)
_Train Local_ResNet_18, epoch  59, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 436/1163 (37.4893%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.6516, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0761, Accuracy: 75/500 (15.0000%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.6334, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   1, Avg loss: 0.0511, Accuracy: 397/1628 (24.3857%)
_Train Local_ResNet_18, epoch  59, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 838/1628 (51.4742%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1772, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 325/1013 (32.0829%)
_Train Local_ResNet_18, epoch  59, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 504/1013 (49.7532%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.0660, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0570, Accuracy: 337/807 (41.7596%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 418/807 (51.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.7250, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 540/1470 (36.7347%)
_Train Local_ResNet_18, epoch  59, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 836/1470 (56.8707%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.2152, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   1, Avg loss: 0.0786, Accuracy: 52/311 (16.7203%)
_Train Local_ResNet_18, epoch  59, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3485, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 490/1552 (31.5722%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 786/1552 (50.6443%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.5342, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 282/636 (44.3396%)
_Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.1845, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   1, Avg loss: 0.0806, Accuracy: 26/373 (6.9705%)
_Train Local_ResNet_18, epoch  59, local model 98, internal_epoch   2, Avg loss: 0.0478, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.4420, Accuracy: 50/10000 (0.5000%)
time spent on training: 171.59009099006653
[foolsgold agg] training data poison_ratio: 0.0  data num: [1163, 500, 1628, 1013, 807, 1470, 311, 1552, 636, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.5565, Accuracy: 0/9950 (0.0000%)
saving model
Done in 239.22372817993164 sec.
Server Epoch:60 choose agents : [50, 97, 52, 73, 41, 60, 11, 53, 69, 10].
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 160/809 (19.7775%)
_Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 365/809 (45.1174%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.3110, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0524, Accuracy: 362/1213 (29.8434%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 532/1213 (43.8582%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.6089, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0554, Accuracy: 292/636 (45.9119%)
_Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.4835, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   1, Avg loss: 0.0652, Accuracy: 168/938 (17.9104%)
_Train Local_ResNet_18, epoch  60, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 353/938 (37.6333%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.5891, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 333/719 (46.3143%)
_Train Local_ResNet_18, epoch  60, local model 41, internal_epoch   2, Avg loss: 0.0318, Accuracy: 459/719 (63.8387%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.2650, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 588/2227 (26.4032%)
_Train Local_ResNet_18, epoch  60, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1032/2227 (46.3404%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.0929, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0549, Accuracy: 355/712 (49.8596%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0256, Accuracy: 419/712 (58.8483%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.5080, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 309/813 (38.0074%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 470/813 (57.8106%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.4074, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   1, Avg loss: 0.0561, Accuracy: 298/590 (50.5085%)
_Train Local_ResNet_18, epoch  60, local model 69, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.9736, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0569, Accuracy: 216/861 (25.0871%)
_Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 451/861 (52.3810%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.8250, Accuracy: 51/10000 (0.5100%)
time spent on training: 186.6900646686554
[foolsgold agg] training data poison_ratio: 0.0  data num: [809, 1213, 636, 938, 719, 2227, 712, 813, 590, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.5548, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 252.8155870437622 sec.
Server Epoch:61 choose agents : [83, 17, 50, 24, 37, 5, 54, 52, 11, 68].
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 434/1953 (22.2222%)
_Train Local_ResNet_18, epoch  61, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 772/1953 (39.5289%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.0251, Accuracy: 98/10000 (0.9800%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   1, Avg loss: 0.0511, Accuracy: 400/1574 (25.4130%)
_Train Local_ResNet_18, epoch  61, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 690/1574 (43.8374%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1206, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 143/809 (17.6761%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 332/809 (41.0383%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.4086, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 34/312 (10.8974%)
_Train Local_ResNet_18, epoch  61, local model 24, internal_epoch   2, Avg loss: 0.0407, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3833, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   1, Avg loss: 0.0517, Accuracy: 402/1129 (35.6067%)
_Train Local_ResNet_18, epoch  61, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 738/1129 (65.3676%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.2446, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   1, Avg loss: 0.0507, Accuracy: 388/1628 (23.8329%)
_Train Local_ResNet_18, epoch  61, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 828/1628 (50.8600%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1591, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   1, Avg loss: 0.0541, Accuracy: 354/1130 (31.3274%)
_Train Local_ResNet_18, epoch  61, local model 54, internal_epoch   2, Avg loss: 0.0278, Accuracy: 518/1130 (45.8407%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.6465, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   1, Avg loss: 0.0558, Accuracy: 284/636 (44.6541%)
_Train Local_ResNet_18, epoch  61, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.2577, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   1, Avg loss: 0.0562, Accuracy: 352/712 (49.4382%)
_Train Local_ResNet_18, epoch  61, local model 11, internal_epoch   2, Avg loss: 0.0267, Accuracy: 412/712 (57.8652%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.5079, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   1, Avg loss: 0.0630, Accuracy: 368/1163 (31.6423%)
_Train Local_ResNet_18, epoch  61, local model 68, internal_epoch   2, Avg loss: 0.0375, Accuracy: 387/1163 (33.2760%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.5296, Accuracy: 69/10000 (0.6900%)
time spent on training: 213.9302635192871
[foolsgold agg] training data poison_ratio: 0.142495020822017  data num: [1953, 1574, 809, 312, 1129, 1628, 1130, 636, 712, 1163]
[foolsgold agg] considering poison per batch poison_fraction: 0.04452969400688032
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.5550, Accuracy: 0/9950 (0.0000%)
saving model
Done in 282.07903718948364 sec.
Server Epoch:62 choose agents : [82, 77, 23, 80, 3, 29, 92, 32, 68, 59].
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0759, Accuracy: 71/500 (14.2000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.6964, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 334/1340 (24.9254%)
_Train Local_ResNet_18, epoch  62, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 571/1340 (42.6119%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.6908, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   1, Avg loss: 0.0597, Accuracy: 320/715 (44.7552%)
_Train Local_ResNet_18, epoch  62, local model 23, internal_epoch   2, Avg loss: 0.0409, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.9506, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0694, Accuracy: 149/682 (21.8475%)
_Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 251/682 (36.8035%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.3683, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   1, Avg loss: 0.0732, Accuracy: 119/781 (15.2369%)
_Train Local_ResNet_18, epoch  62, local model 3, internal_epoch   2, Avg loss: 0.0362, Accuracy: 237/781 (30.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.7395, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 434/1440 (30.1389%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 674/1440 (46.8056%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.7594, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 450/1715 (26.2391%)
_Train Local_ResNet_18, epoch  62, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 759/1715 (44.2566%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.8334, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 199/735 (27.0748%)
_Train Local_ResNet_18, epoch  62, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 330/735 (44.8980%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.8256, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   1, Avg loss: 0.0628, Accuracy: 365/1163 (31.3844%)
_Train Local_ResNet_18, epoch  62, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 418/1163 (35.9415%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.6152, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 312/1089 (28.6501%)
_Train Local_ResNet_18, epoch  62, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 468/1089 (42.9752%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.5854, Accuracy: 72/10000 (0.7200%)
time spent on training: 190.13283610343933
[foolsgold agg] training data poison_ratio: 0.0  data num: [500, 1340, 715, 682, 781, 1440, 1715, 735, 1163, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3110, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.5520, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.1731834411621 sec.
Server Epoch:63 choose agents : [18, 63, 37, 93, 54, 89, 57, 58, 65, 75].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0757, Accuracy: 120/530 (22.6415%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0402, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.0864, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 259/888 (29.1667%)
_Train Local_ResNet_18, epoch  63, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 469/888 (52.8153%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.0626, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0515, Accuracy: 428/1129 (37.9097%)
_Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0241, Accuracy: 724/1129 (64.1275%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.7285, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   1, Avg loss: 0.0545, Accuracy: 427/1742 (24.5121%)
_Train Local_ResNet_18, epoch  63, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 673/1742 (38.6338%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.7202, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   1, Avg loss: 0.0545, Accuracy: 351/1130 (31.0619%)
_Train Local_ResNet_18, epoch  63, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 470/1130 (41.5929%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.7627, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 338/896 (37.7232%)
_Train Local_ResNet_18, epoch  63, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 422/896 (47.0982%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.2624, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0536, Accuracy: 310/1154 (26.8631%)
_Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0260, Accuracy: 505/1154 (43.7608%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.7241, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 345/803 (42.9639%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 389/803 (48.4433%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.0995, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   1, Avg loss: 0.0564, Accuracy: 411/1475 (27.8644%)
_Train Local_ResNet_18, epoch  63, local model 65, internal_epoch   2, Avg loss: 0.0317, Accuracy: 644/1475 (43.6610%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.4389, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   1, Avg loss: 0.0619, Accuracy: 256/776 (32.9897%)
_Train Local_ResNet_18, epoch  63, local model 75, internal_epoch   2, Avg loss: 0.0309, Accuracy: 413/776 (53.2216%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.8958, Accuracy: 50/10000 (0.5000%)
time spent on training: 191.64296317100525
[foolsgold agg] training data poison_ratio: 0.0  data num: [530, 888, 1129, 1742, 1130, 896, 1154, 803, 1475, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3109, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.5501, Accuracy: 0/9950 (0.0000%)
saving model
Done in 258.0648992061615 sec.
Server Epoch:64 choose agents : [76, 12, 56, 63, 47, 22, 70, 34, 31, 74].
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0489, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.7371, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 24/338 (7.1006%)
_Train Local_ResNet_18, epoch  64, local model 12, internal_epoch   2, Avg loss: 0.0468, Accuracy: 134/338 (39.6450%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.4432, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  64, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 71/186 (38.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 261/888 (29.3919%)
_Train Local_ResNet_18, epoch  64, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 438/888 (49.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.5183, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   1, Avg loss: 0.1231, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  64, local model 47, internal_epoch   2, Avg loss: 0.1045, Accuracy: 18/134 (13.4328%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3102, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 528/1470 (35.9184%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 857/1470 (58.2993%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.0581, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0548, Accuracy: 372/1418 (26.2341%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 678/1418 (47.8138%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.5451, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   1, Avg loss: 0.0583, Accuracy: 380/1427 (26.6293%)
_Train Local_ResNet_18, epoch  64, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 568/1427 (39.8038%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.0012, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   1, Avg loss: 0.0802, Accuracy: 72/460 (15.6522%)
_Train Local_ResNet_18, epoch  64, local model 31, internal_epoch   2, Avg loss: 0.0350, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.7886, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   1, Avg loss: 0.0424, Accuracy: 498/1552 (32.0876%)
_Train Local_ResNet_18, epoch  64, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 780/1552 (50.2577%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.1301, Accuracy: 76/10000 (0.7600%)
time spent on training: 173.79925847053528
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 338, 186, 888, 134, 1470, 1418, 1427, 460, 1552]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         0.83220466 1.
 1.         1.         0.83220466 1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3108, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.5503, Accuracy: 0/9950 (0.0000%)
saving model
Done in 240.72239565849304 sec.
Server Epoch:65 choose agents : [27, 36, 11, 14, 83, 29, 65, 72, 80, 10].
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 421/1587 (26.5280%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0332, Accuracy: 645/1587 (40.6427%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.2840, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   1, Avg loss: 0.0873, Accuracy: 74/408 (18.1373%)
_Train Local_ResNet_18, epoch  65, local model 36, internal_epoch   2, Avg loss: 0.0539, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.4812, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0550, Accuracy: 355/712 (49.8596%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0266, Accuracy: 438/712 (61.5169%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.5152, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   1, Avg loss: 0.0613, Accuracy: 230/1013 (22.7048%)
_Train Local_ResNet_18, epoch  65, local model 14, internal_epoch   2, Avg loss: 0.0356, Accuracy: 335/1013 (33.0701%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.7183, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0533, Accuracy: 439/1953 (22.4782%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 744/1953 (38.0952%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.8524, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   1, Avg loss: 0.0498, Accuracy: 404/1440 (28.0556%)
_Train Local_ResNet_18, epoch  65, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 624/1440 (43.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.8321, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   1, Avg loss: 0.0543, Accuracy: 398/1475 (26.9831%)
_Train Local_ResNet_18, epoch  65, local model 65, internal_epoch   2, Avg loss: 0.0320, Accuracy: 642/1475 (43.5254%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.8709, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 263/1241 (21.1926%)
_Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 425/1241 (34.2466%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.0575, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   1, Avg loss: 0.0696, Accuracy: 150/682 (21.9941%)
_Train Local_ResNet_18, epoch  65, local model 80, internal_epoch   2, Avg loss: 0.0376, Accuracy: 258/682 (37.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.3513, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   1, Avg loss: 0.0562, Accuracy: 217/861 (25.2033%)
_Train Local_ResNet_18, epoch  65, local model 10, internal_epoch   2, Avg loss: 0.0209, Accuracy: 453/861 (52.6132%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.9712, Accuracy: 50/10000 (0.5000%)
time spent on training: 220.3646535873413
[foolsgold agg] training data poison_ratio: 0.0  data num: [1587, 408, 712, 1013, 1953, 1440, 1475, 1241, 682, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3107, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.5489, Accuracy: 0/9950 (0.0000%)
saving model
Done in 289.7994508743286 sec.
Server Epoch:66 choose agents : [88, 61, 93, 18, 80, 92, 90, 72, 6, 70].
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0747, Accuracy: 147/603 (24.3781%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0458, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.0348, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   1, Avg loss: 0.1251, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  66, local model 61, internal_epoch   2, Avg loss: 0.1166, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3041, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0546, Accuracy: 423/1742 (24.2824%)
_Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 699/1742 (40.1263%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.5951, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0763, Accuracy: 128/530 (24.1509%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0388, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.1484, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   1, Avg loss: 0.0703, Accuracy: 136/682 (19.9413%)
_Train Local_ResNet_18, epoch  66, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 231/682 (33.8710%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.3114, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 474/1715 (27.6385%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 722/1715 (42.0991%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.6123, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   1, Avg loss: 0.0563, Accuracy: 322/677 (47.5628%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   2, Avg loss: 0.0237, Accuracy: 448/677 (66.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.5373, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   1, Avg loss: 0.0610, Accuracy: 252/1241 (20.3062%)
_Train Local_ResNet_18, epoch  66, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 408/1241 (32.8767%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.3219, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   1, Avg loss: 0.0543, Accuracy: 368/1956 (18.8139%)
_Train Local_ResNet_18, epoch  66, local model 6, internal_epoch   2, Avg loss: 0.0317, Accuracy: 653/1956 (33.3845%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.5079, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 376/1418 (26.5162%)
_Train Local_ResNet_18, epoch  66, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 603/1418 (42.5247%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.7730, Accuracy: 92/10000 (0.9200%)
time spent on training: 205.99991416931152
[foolsgold agg] training data poison_ratio: 0.0  data num: [603, 85, 1742, 530, 682, 1715, 677, 1241, 1956, 1418]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3106, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.5488, Accuracy: 0/9950 (0.0000%)
saving model
Done in 273.7164843082428 sec.
Server Epoch:67 choose agents : [43, 82, 95, 55, 5, 73, 63, 38, 13, 76].
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 307/946 (32.4524%)
_Train Local_ResNet_18, epoch  67, local model 43, internal_epoch   2, Avg loss: 0.0353, Accuracy: 368/946 (38.9006%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.1434, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   1, Avg loss: 0.0759, Accuracy: 73/500 (14.6000%)
_Train Local_ResNet_18, epoch  67, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.6516, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0522, Accuracy: 336/599 (56.0935%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0316, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.0352, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   1, Avg loss: 0.0560, Accuracy: 263/1071 (24.5565%)
_Train Local_ResNet_18, epoch  67, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 516/1071 (48.1793%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.1304, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 374/1628 (22.9730%)
_Train Local_ResNet_18, epoch  67, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 806/1628 (49.5086%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.5602, Accuracy: 142/10000 (1.4200%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0654, Accuracy: 175/938 (18.6567%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0331, Accuracy: 336/938 (35.8209%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.4916, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 263/888 (29.6171%)
_Train Local_ResNet_18, epoch  67, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 457/888 (51.4640%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.6609, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   1, Avg loss: 0.0613, Accuracy: 248/1131 (21.9275%)
_Train Local_ResNet_18, epoch  67, local model 38, internal_epoch   2, Avg loss: 0.0301, Accuracy: 476/1131 (42.0866%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.3968, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0569, Accuracy: 325/1645 (19.7568%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0324, Accuracy: 639/1645 (38.8450%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.1742, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   1, Avg loss: 0.0848, Accuracy: 53/466 (11.3734%)
_Train Local_ResNet_18, epoch  67, local model 76, internal_epoch   2, Avg loss: 0.0454, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.7266, Accuracy: 50/10000 (0.5000%)
time spent on training: 184.37316489219666
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 500, 599, 1071, 1628, 938, 888, 1131, 1645, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3106, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.5479, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.89642477035522 sec.
Server Epoch:68 choose agents : [20, 23, 58, 43, 82, 8, 16, 86, 51, 62].
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 346/807 (42.8748%)
_Train Local_ResNet_18, epoch  68, local model 20, internal_epoch   2, Avg loss: 0.0326, Accuracy: 409/807 (50.6815%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.9909, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   1, Avg loss: 0.0593, Accuracy: 325/715 (45.4545%)
_Train Local_ResNet_18, epoch  68, local model 23, internal_epoch   2, Avg loss: 0.0379, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.7997, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 353/803 (43.9601%)
_Train Local_ResNet_18, epoch  68, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 385/803 (47.9452%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.0664, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   1, Avg loss: 0.0613, Accuracy: 307/946 (32.4524%)
_Train Local_ResNet_18, epoch  68, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 322/946 (34.0381%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.1194, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 70/500 (14.0000%)
_Train Local_ResNet_18, epoch  68, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.6474, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 245/1513 (16.1930%)
_Train Local_ResNet_18, epoch  68, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 511/1513 (33.7740%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.8020, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   1, Avg loss: 0.0626, Accuracy: 283/708 (39.9718%)
_Train Local_ResNet_18, epoch  68, local model 16, internal_epoch   2, Avg loss: 0.0358, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.8997, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   1, Avg loss: 0.0622, Accuracy: 357/1003 (35.5932%)
_Train Local_ResNet_18, epoch  68, local model 86, internal_epoch   2, Avg loss: 0.0339, Accuracy: 410/1003 (40.8774%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.7910, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   1, Avg loss: 0.0590, Accuracy: 235/1049 (22.4023%)
_Train Local_ResNet_18, epoch  68, local model 51, internal_epoch   2, Avg loss: 0.0292, Accuracy: 544/1049 (51.8589%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6852, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   1, Avg loss: 0.0685, Accuracy: 144/568 (25.3521%)
_Train Local_ResNet_18, epoch  68, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.7673, Accuracy: 53/10000 (0.5300%)
time spent on training: 216.60657477378845
[foolsgold agg] training data poison_ratio: 0.0  data num: [807, 715, 803, 946, 500, 1513, 708, 1003, 1049, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.5476, Accuracy: 0/9950 (0.0000%)
saving model
Done in 283.4814887046814 sec.
Server Epoch:69 choose agents : [20, 30, 43, 88, 69, 79, 82, 4, 68, 74].
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 346/807 (42.8748%)
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 411/807 (50.9294%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.2869, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   1, Avg loss: 0.0784, Accuracy: 76/486 (15.6379%)
_Train Local_ResNet_18, epoch  69, local model 30, internal_epoch   2, Avg loss: 0.0408, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.7976, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   1, Avg loss: 0.0617, Accuracy: 312/946 (32.9810%)
_Train Local_ResNet_18, epoch  69, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 325/946 (34.3552%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.0611, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   1, Avg loss: 0.0738, Accuracy: 144/603 (23.8806%)
_Train Local_ResNet_18, epoch  69, local model 88, internal_epoch   2, Avg loss: 0.0459, Accuracy: 290/603 (48.0929%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.9677, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0551, Accuracy: 297/590 (50.3390%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0308, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.8324, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   1, Avg loss: 0.1001, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  69, local model 79, internal_epoch   2, Avg loss: 0.0827, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3213, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   1, Avg loss: 0.0761, Accuracy: 73/500 (14.6000%)
_Train Local_ResNet_18, epoch  69, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.6946, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   1, Avg loss: 0.0612, Accuracy: 339/901 (37.6249%)
_Train Local_ResNet_18, epoch  69, local model 4, internal_epoch   2, Avg loss: 0.0331, Accuracy: 372/901 (41.2875%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.9971, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   1, Avg loss: 0.0625, Accuracy: 370/1163 (31.8143%)
_Train Local_ResNet_18, epoch  69, local model 68, internal_epoch   2, Avg loss: 0.0364, Accuracy: 448/1163 (38.5211%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.0389, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 470/1552 (30.2835%)
_Train Local_ResNet_18, epoch  69, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 767/1552 (49.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.2989, Accuracy: 78/10000 (0.7800%)
time spent on training: 178.27230525016785
[foolsgold agg] training data poison_ratio: 0.0  data num: [807, 486, 946, 603, 590, 197, 500, 901, 1163, 1552]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.5482, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.46898770332336 sec.
Server Epoch:70 choose agents : [6, 73, 75, 99, 15, 8, 19, 96, 47, 65].
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0543, Accuracy: 376/1956 (19.2229%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 621/1956 (31.7485%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3724, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   1, Avg loss: 0.0652, Accuracy: 181/938 (19.2964%)
_Train Local_ResNet_18, epoch  70, local model 73, internal_epoch   2, Avg loss: 0.0331, Accuracy: 333/938 (35.5011%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.4058, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0612, Accuracy: 262/776 (33.7629%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 425/776 (54.7680%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.8037, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   1, Avg loss: 0.0656, Accuracy: 182/773 (23.5446%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   2, Avg loss: 0.0319, Accuracy: 390/773 (50.4528%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.3627, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   1, Avg loss: 0.0557, Accuracy: 345/1154 (29.8960%)
_Train Local_ResNet_18, epoch  70, local model 15, internal_epoch   2, Avg loss: 0.0274, Accuracy: 471/1154 (40.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.1509, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   1, Avg loss: 0.0596, Accuracy: 239/1513 (15.7964%)
_Train Local_ResNet_18, epoch  70, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 490/1513 (32.3860%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.3477, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0468, Accuracy: 415/1036 (40.0579%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0245, Accuracy: 649/1036 (62.6448%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.0320, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   1, Avg loss: 0.0793, Accuracy: 43/311 (13.8264%)
_Train Local_ResNet_18, epoch  70, local model 96, internal_epoch   2, Avg loss: 0.0539, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3472, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   1, Avg loss: 0.1241, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  70, local model 47, internal_epoch   2, Avg loss: 0.1040, Accuracy: 17/134 (12.6866%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3102, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   1, Avg loss: 0.0559, Accuracy: 395/1475 (26.7797%)
_Train Local_ResNet_18, epoch  70, local model 65, internal_epoch   2, Avg loss: 0.0297, Accuracy: 738/1475 (50.0339%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.9137, Accuracy: 95/10000 (0.9500%)
time spent on training: 200.50088667869568
[foolsgold agg] training data poison_ratio: 0.0  data num: [1956, 938, 776, 773, 1154, 1513, 1036, 311, 134, 1475]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3104, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.5459, Accuracy: 0/9950 (0.0000%)
saving model
Done in 267.4124174118042 sec.
Server Epoch:71 choose agents : [48, 5, 73, 89, 81, 23, 32, 77, 18, 83].
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   1, Avg loss: 0.0704, Accuracy: 105/631 (16.6403%)
_Train Local_ResNet_18, epoch  71, local model 48, internal_epoch   2, Avg loss: 0.0412, Accuracy: 228/631 (36.1331%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.9579, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   1, Avg loss: 0.0503, Accuracy: 389/1628 (23.8943%)
_Train Local_ResNet_18, epoch  71, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 867/1628 (53.2555%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.1329, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   1, Avg loss: 0.0639, Accuracy: 189/938 (20.1493%)
_Train Local_ResNet_18, epoch  71, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 345/938 (36.7804%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.3756, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0598, Accuracy: 335/896 (37.3884%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 434/896 (48.4375%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.4626, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1, Avg loss: 0.0688, Accuracy: 246/774 (31.7829%)
_Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2, Avg loss: 0.0363, Accuracy: 269/774 (34.7545%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.3543, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0594, Accuracy: 321/715 (44.8951%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0394, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.7664, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   1, Avg loss: 0.0593, Accuracy: 202/735 (27.4830%)
_Train Local_ResNet_18, epoch  71, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 319/735 (43.4014%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.2882, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0531, Accuracy: 349/1340 (26.0448%)
_Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 524/1340 (39.1045%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.7042, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0753, Accuracy: 124/530 (23.3962%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0373, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.1124, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   1, Avg loss: 0.0533, Accuracy: 467/1953 (23.9119%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 794/1953 (40.6554%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.8989, Accuracy: 110/10000 (1.1000%)
time spent on training: 203.26592302322388
[foolsgold agg] training data poison_ratio: 0.0  data num: [631, 1628, 938, 896, 774, 715, 735, 1340, 530, 1953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3104, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.5412, Accuracy: 0/9950 (0.0000%)
saving model
Done in 270.8306043148041 sec.
Server Epoch:72 choose agents : [30, 16, 63, 90, 33, 98, 3, 62, 21, 19].
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   1, Avg loss: 0.0783, Accuracy: 89/486 (18.3128%)
_Train Local_ResNet_18, epoch  72, local model 30, internal_epoch   2, Avg loss: 0.0414, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.8490, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   1, Avg loss: 0.0617, Accuracy: 278/708 (39.2655%)
_Train Local_ResNet_18, epoch  72, local model 16, internal_epoch   2, Avg loss: 0.0374, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.8612, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 260/888 (29.2793%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 430/888 (48.4234%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.4274, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   1, Avg loss: 0.0572, Accuracy: 318/677 (46.9719%)
_Train Local_ResNet_18, epoch  72, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 454/677 (67.0606%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.4169, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   1, Avg loss: 0.0783, Accuracy: 72/515 (13.9806%)
_Train Local_ResNet_18, epoch  72, local model 33, internal_epoch   2, Avg loss: 0.0526, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.7166, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   1, Avg loss: 0.0803, Accuracy: 34/373 (9.1153%)
_Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   2, Avg loss: 0.0470, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.4405, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   1, Avg loss: 0.0729, Accuracy: 115/781 (14.7247%)
_Train Local_ResNet_18, epoch  72, local model 3, internal_epoch   2, Avg loss: 0.0370, Accuracy: 249/781 (31.8822%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.6626, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   1, Avg loss: 0.0689, Accuracy: 145/568 (25.5282%)
_Train Local_ResNet_18, epoch  72, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.7548, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   1, Avg loss: 0.0541, Accuracy: 387/1949 (19.8563%)
_Train Local_ResNet_18, epoch  72, local model 21, internal_epoch   2, Avg loss: 0.0335, Accuracy: 592/1949 (30.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.0822, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0475, Accuracy: 442/1036 (42.6641%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0236, Accuracy: 686/1036 (66.2162%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.6518, Accuracy: 56/10000 (0.5600%)
time spent on training: 184.13374090194702
[foolsgold agg] training data poison_ratio: 0.0  data num: [486, 708, 888, 677, 515, 373, 781, 568, 1949, 1036]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3103, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.5417, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.51747584342957 sec.
Server Epoch:73 choose agents : [26, 99, 33, 95, 3, 71, 80, 11, 58, 87].
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0544, Accuracy: 370/1446 (25.5878%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 504/1446 (34.8548%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.2349, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   1, Avg loss: 0.0671, Accuracy: 196/773 (25.3558%)
_Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   2, Avg loss: 0.0296, Accuracy: 409/773 (52.9107%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.2383, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0785, Accuracy: 73/515 (14.1748%)
_Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0516, Accuracy: 121/515 (23.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.7682, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   1, Avg loss: 0.0507, Accuracy: 334/599 (55.7596%)
_Train Local_ResNet_18, epoch  73, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.1864, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   1, Avg loss: 0.0729, Accuracy: 123/781 (15.7490%)
_Train Local_ResNet_18, epoch  73, local model 3, internal_epoch   2, Avg loss: 0.0369, Accuracy: 243/781 (31.1140%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.8824, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0639, Accuracy: 174/818 (21.2714%)
_Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 361/818 (44.1320%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.9540, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   1, Avg loss: 0.0693, Accuracy: 149/682 (21.8475%)
_Train Local_ResNet_18, epoch  73, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 252/682 (36.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.4286, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   1, Avg loss: 0.0535, Accuracy: 350/712 (49.1573%)
_Train Local_ResNet_18, epoch  73, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 411/712 (57.7247%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.6027, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 353/803 (43.9601%)
_Train Local_ResNet_18, epoch  73, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 413/803 (51.4321%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.0549, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   1, Avg loss: 0.0575, Accuracy: 308/1131 (27.2325%)
_Train Local_ResNet_18, epoch  73, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 409/1131 (36.1627%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.6698, Accuracy: 50/10000 (0.5000%)
time spent on training: 197.54598832130432
[foolsgold agg] training data poison_ratio: 0.0  data num: [1446, 773, 515, 599, 781, 818, 682, 712, 803, 1131]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3102, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.5419, Accuracy: 0/9950 (0.0000%)
saving model
Done in 268.0137975215912 sec.
Server Epoch:74 choose agents : [8, 37, 99, 62, 49, 43, 0, 91, 92, 52].
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 253/1513 (16.7217%)
_Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 474/1513 (31.3285%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.3797, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0517, Accuracy: 449/1129 (39.7697%)
_Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0246, Accuracy: 746/1129 (66.0762%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.5497, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   1, Avg loss: 0.0664, Accuracy: 191/773 (24.7089%)
_Train Local_ResNet_18, epoch  74, local model 99, internal_epoch   2, Avg loss: 0.0321, Accuracy: 401/773 (51.8758%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.5450, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   1, Avg loss: 0.0681, Accuracy: 152/568 (26.7606%)
_Train Local_ResNet_18, epoch  74, local model 62, internal_epoch   2, Avg loss: 0.0404, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.7634, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   1, Avg loss: 0.0794, Accuracy: 29/440 (6.5909%)
_Train Local_ResNet_18, epoch  74, local model 49, internal_epoch   2, Avg loss: 0.0476, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.5055, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 312/946 (32.9810%)
_Train Local_ResNet_18, epoch  74, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 345/946 (36.4693%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.0433, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 370/1657 (22.3295%)
_Train Local_ResNet_18, epoch  74, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 541/1657 (32.6494%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.4638, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   1, Avg loss: 0.0505, Accuracy: 345/1030 (33.4951%)
_Train Local_ResNet_18, epoch  74, local model 91, internal_epoch   2, Avg loss: 0.0268, Accuracy: 647/1030 (62.8155%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.3407, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 455/1715 (26.5306%)
_Train Local_ResNet_18, epoch  74, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 731/1715 (42.6239%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6598, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   1, Avg loss: 0.0554, Accuracy: 287/636 (45.1258%)
_Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.3882, Accuracy: 50/10000 (0.5000%)
time spent on training: 207.65823221206665
[foolsgold agg] training data poison_ratio: 0.0  data num: [1513, 1129, 773, 568, 440, 946, 1657, 1030, 1715, 636]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3101, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.5418, Accuracy: 0/9950 (0.0000%)
saving model
Done in 274.5767364501953 sec.
Server Epoch:75 choose agents : [87, 64, 73, 84, 3, 54, 80, 11, 20, 63].
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   1, Avg loss: 0.0571, Accuracy: 310/1131 (27.4094%)
_Train Local_ResNet_18, epoch  75, local model 87, internal_epoch   2, Avg loss: 0.0310, Accuracy: 446/1131 (39.4341%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.4825, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0639, Accuracy: 175/953 (18.3631%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 307/953 (32.2141%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.5104, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   1, Avg loss: 0.0650, Accuracy: 167/938 (17.8038%)
_Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   2, Avg loss: 0.0330, Accuracy: 318/938 (33.9019%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.7608, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   1, Avg loss: 0.0623, Accuracy: 326/1190 (27.3950%)
_Train Local_ResNet_18, epoch  75, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 449/1190 (37.7311%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.0899, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   1, Avg loss: 0.0724, Accuracy: 125/781 (16.0051%)
_Train Local_ResNet_18, epoch  75, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 231/781 (29.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.0301, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   1, Avg loss: 0.0541, Accuracy: 359/1130 (31.7699%)
_Train Local_ResNet_18, epoch  75, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 478/1130 (42.3009%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.5968, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   1, Avg loss: 0.0696, Accuracy: 144/682 (21.1144%)
_Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   2, Avg loss: 0.0376, Accuracy: 243/682 (35.6305%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.3521, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0546, Accuracy: 361/712 (50.7022%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 414/712 (58.1461%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.7093, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   1, Avg loss: 0.0568, Accuracy: 352/807 (43.6183%)
_Train Local_ResNet_18, epoch  75, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 414/807 (51.3011%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.8321, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 270/888 (30.4054%)
_Train Local_ResNet_18, epoch  75, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 453/888 (51.0135%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.8696, Accuracy: 52/10000 (0.5200%)
time spent on training: 188.5180435180664
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 953, 938, 1190, 781, 1130, 682, 712, 807, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3101, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.5397, Accuracy: 0/9950 (0.0000%)
saving model
Done in 255.83128762245178 sec.
Server Epoch:76 choose agents : [4, 71, 9, 54, 82, 38, 16, 87, 91, 34].
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0630, Accuracy: 331/901 (36.7370%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 395/901 (43.8402%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.8181, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   1, Avg loss: 0.0636, Accuracy: 166/818 (20.2934%)
_Train Local_ResNet_18, epoch  76, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 342/818 (41.8093%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.0902, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   1, Avg loss: 0.0491, Accuracy: 379/1275 (29.7255%)
_Train Local_ResNet_18, epoch  76, local model 9, internal_epoch   2, Avg loss: 0.0196, Accuracy: 705/1275 (55.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.7624, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   1, Avg loss: 0.0542, Accuracy: 345/1130 (30.5310%)
_Train Local_ResNet_18, epoch  76, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 489/1130 (43.2743%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.5830, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 73/500 (14.6000%)
_Train Local_ResNet_18, epoch  76, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 181/500 (36.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.6334, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   1, Avg loss: 0.0606, Accuracy: 254/1131 (22.4580%)
_Train Local_ResNet_18, epoch  76, local model 38, internal_epoch   2, Avg loss: 0.0303, Accuracy: 478/1131 (42.2635%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.8853, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   1, Avg loss: 0.0617, Accuracy: 282/708 (39.8305%)
_Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   2, Avg loss: 0.0368, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.8176, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0580, Accuracy: 307/1131 (27.1441%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 393/1131 (34.7480%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.7891, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   1, Avg loss: 0.0503, Accuracy: 344/1030 (33.3981%)
_Train Local_ResNet_18, epoch  76, local model 91, internal_epoch   2, Avg loss: 0.0262, Accuracy: 654/1030 (63.4951%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.6402, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   1, Avg loss: 0.0568, Accuracy: 386/1427 (27.0498%)
_Train Local_ResNet_18, epoch  76, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 606/1427 (42.4667%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.8471, Accuracy: 55/10000 (0.5500%)
time spent on training: 210.28807592391968
[foolsgold agg] training data poison_ratio: 0.0  data num: [901, 818, 1275, 1130, 500, 1131, 708, 1131, 1030, 1427]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3101, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.5400, Accuracy: 0/9950 (0.0000%)
saving model
Done in 277.8821032047272 sec.
Server Epoch:77 choose agents : [60, 16, 98, 30, 49, 88, 70, 59, 93, 27].
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 584/2227 (26.2236%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1039/2227 (46.6547%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.9894, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   1, Avg loss: 0.0606, Accuracy: 291/708 (41.1017%)
_Train Local_ResNet_18, epoch  77, local model 16, internal_epoch   2, Avg loss: 0.0383, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.0354, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1, Avg loss: 0.0801, Accuracy: 29/373 (7.7748%)
_Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2, Avg loss: 0.0467, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.4458, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   1, Avg loss: 0.0779, Accuracy: 87/486 (17.9012%)
_Train Local_ResNet_18, epoch  77, local model 30, internal_epoch   2, Avg loss: 0.0425, Accuracy: 208/486 (42.7984%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.8536, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 36/440 (8.1818%)
_Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0470, Accuracy: 150/440 (34.0909%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.5308, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   1, Avg loss: 0.0741, Accuracy: 150/603 (24.8756%)
_Train Local_ResNet_18, epoch  77, local model 88, internal_epoch   2, Avg loss: 0.0464, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.9281, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   1, Avg loss: 0.0559, Accuracy: 363/1418 (25.5994%)
_Train Local_ResNet_18, epoch  77, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 631/1418 (44.4993%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.4729, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   1, Avg loss: 0.0532, Accuracy: 326/1089 (29.9357%)
_Train Local_ResNet_18, epoch  77, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 445/1089 (40.8632%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.6617, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   1, Avg loss: 0.0543, Accuracy: 424/1742 (24.3398%)
_Train Local_ResNet_18, epoch  77, local model 93, internal_epoch   2, Avg loss: 0.0312, Accuracy: 722/1742 (41.4466%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.8554, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   1, Avg loss: 0.0542, Accuracy: 456/1587 (28.7335%)
_Train Local_ResNet_18, epoch  77, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 611/1587 (38.5003%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.3387, Accuracy: 67/10000 (0.6700%)
time spent on training: 226.6542239189148
[foolsgold agg] training data poison_ratio: 0.0  data num: [2227, 708, 373, 486, 440, 603, 1418, 1089, 1742, 1587]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3100, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.5388, Accuracy: 0/9950 (0.0000%)
saving model
Done in 294.63021326065063 sec.
Server Epoch:78 choose agents : [0, 63, 47, 75, 97, 35, 25, 88, 18, 91].
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0575, Accuracy: 347/1657 (20.9415%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 526/1657 (31.7441%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.4745, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 262/888 (29.5045%)
_Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   2, Avg loss: 0.0252, Accuracy: 448/888 (50.4505%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4406, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   1, Avg loss: 0.1189, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  78, local model 47, internal_epoch   2, Avg loss: 0.1059, Accuracy: 22/134 (16.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3093, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   1, Avg loss: 0.0628, Accuracy: 268/776 (34.5361%)
_Train Local_ResNet_18, epoch  78, local model 75, internal_epoch   2, Avg loss: 0.0286, Accuracy: 426/776 (54.8969%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.0307, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   1, Avg loss: 0.0523, Accuracy: 356/1213 (29.3487%)
_Train Local_ResNet_18, epoch  78, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 486/1213 (40.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.7514, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   1, Avg loss: 0.0853, Accuracy: 47/271 (17.3432%)
_Train Local_ResNet_18, epoch  78, local model 35, internal_epoch   2, Avg loss: 0.0550, Accuracy: 109/271 (40.2214%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3726, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   1, Avg loss: 0.0559, Accuracy: 316/690 (45.7971%)
_Train Local_ResNet_18, epoch  78, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.6994, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   1, Avg loss: 0.0735, Accuracy: 145/603 (24.0464%)
_Train Local_ResNet_18, epoch  78, local model 88, internal_epoch   2, Avg loss: 0.0458, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.0316, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0755, Accuracy: 121/530 (22.8302%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0377, Accuracy: 276/530 (52.0755%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.1605, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   1, Avg loss: 0.0529, Accuracy: 341/1030 (33.1068%)
_Train Local_ResNet_18, epoch  78, local model 91, internal_epoch   2, Avg loss: 0.0253, Accuracy: 650/1030 (63.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.3465, Accuracy: 91/10000 (0.9100%)
time spent on training: 197.18901181221008
[foolsgold agg] training data poison_ratio: 0.0  data num: [1657, 888, 134, 776, 1213, 271, 690, 603, 530, 1030]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3100, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.5388, Accuracy: 0/9950 (0.0000%)
saving model
Done in 265.14901399612427 sec.
Server Epoch:79 choose agents : [69, 33, 14, 95, 94, 24, 52, 85, 18, 51].
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   1, Avg loss: 0.0554, Accuracy: 294/590 (49.8305%)
_Train Local_ResNet_18, epoch  79, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.0105, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0779, Accuracy: 74/515 (14.3689%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0504, Accuracy: 139/515 (26.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.8143, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   1, Avg loss: 0.0618, Accuracy: 229/1013 (22.6061%)
_Train Local_ResNet_18, epoch  79, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 316/1013 (31.1945%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.7795, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0515, Accuracy: 340/599 (56.7613%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0191, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   1, Avg loss: 0.0543, Accuracy: 357/1662 (21.4801%)
_Train Local_ResNet_18, epoch  79, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 612/1662 (36.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.8998, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   1, Avg loss: 0.0762, Accuracy: 42/312 (13.4615%)
_Train Local_ResNet_18, epoch  79, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3945, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0558, Accuracy: 291/636 (45.7547%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0317, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.4886, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0551, Accuracy: 442/1988 (22.2334%)
_Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 678/1988 (34.1046%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0534, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0748, Accuracy: 130/530 (24.5283%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0365, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.2644, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   1, Avg loss: 0.0597, Accuracy: 235/1049 (22.4023%)
_Train Local_ResNet_18, epoch  79, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 485/1049 (46.2345%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.9825, Accuracy: 74/10000 (0.7400%)
time spent on training: 186.13345170021057
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 515, 1013, 599, 1662, 312, 636, 1988, 530, 1049]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3099, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.5388, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.52127122879028 sec.
Server Epoch:80 choose agents : [89, 46, 50, 90, 86, 76, 73, 60, 96, 75].
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 339/896 (37.8348%)
_Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 437/896 (48.7723%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.3278, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0555, Accuracy: 404/1904 (21.2185%)
_Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 674/1904 (35.3992%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.3111, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   1, Avg loss: 0.0624, Accuracy: 158/809 (19.5303%)
_Train Local_ResNet_18, epoch  80, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 353/809 (43.6341%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.6150, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   1, Avg loss: 0.0577, Accuracy: 321/677 (47.4151%)
_Train Local_ResNet_18, epoch  80, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 452/677 (66.7651%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.3005, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   1, Avg loss: 0.0622, Accuracy: 369/1003 (36.7896%)
_Train Local_ResNet_18, epoch  80, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 388/1003 (38.6839%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.8037, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1, Avg loss: 0.0840, Accuracy: 56/466 (12.0172%)
_Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2, Avg loss: 0.0481, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.6824, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   1, Avg loss: 0.0643, Accuracy: 187/938 (19.9360%)
_Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 314/938 (33.4755%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.9477, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   1, Avg loss: 0.0490, Accuracy: 614/2227 (27.5707%)
_Train Local_ResNet_18, epoch  80, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1045/2227 (46.9241%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.0418, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   1, Avg loss: 0.0790, Accuracy: 51/311 (16.3987%)
_Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3462, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0637, Accuracy: 257/776 (33.1186%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0280, Accuracy: 416/776 (53.6082%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.8450, Accuracy: 53/10000 (0.5300%)
time spent on training: 187.63624143600464
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 1904, 809, 677, 1003, 466, 938, 2227, 311, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3098, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.5360, Accuracy: 0/9950 (0.0000%)
saving model
Done in 256.0675423145294 sec.
Server Epoch:81 choose agents : [59, 91, 18, 23, 49, 95, 60, 89, 53, 14].
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   1, Avg loss: 0.0587, Accuracy: 312/1089 (28.6501%)
_Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   2, Avg loss: 0.0289, Accuracy: 451/1089 (41.4141%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.0104, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   1, Avg loss: 0.0514, Accuracy: 352/1030 (34.1748%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   2, Avg loss: 0.0246, Accuracy: 664/1030 (64.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.5979, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0754, Accuracy: 122/530 (23.0189%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0402, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.0756, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   1, Avg loss: 0.0605, Accuracy: 327/715 (45.7343%)
_Train Local_ResNet_18, epoch  81, local model 23, internal_epoch   2, Avg loss: 0.0384, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.8489, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0793, Accuracy: 35/440 (7.9545%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0471, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.5086, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 333/599 (55.5927%)
_Train Local_ResNet_18, epoch  81, local model 95, internal_epoch   2, Avg loss: 0.0302, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.7702, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0488, Accuracy: 629/2227 (28.2443%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1025/2227 (46.0260%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.1527, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 342/896 (38.1696%)
_Train Local_ResNet_18, epoch  81, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 425/896 (47.4330%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.2909, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0495, Accuracy: 294/813 (36.1624%)
_Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 433/813 (53.2595%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.4892, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   1, Avg loss: 0.0610, Accuracy: 233/1013 (23.0010%)
_Train Local_ResNet_18, epoch  81, local model 14, internal_epoch   2, Avg loss: 0.0348, Accuracy: 366/1013 (36.1303%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.6698, Accuracy: 69/10000 (0.6900%)
time spent on training: 189.2616047859192
[foolsgold agg] training data poison_ratio: 0.0  data num: [1089, 1030, 530, 715, 440, 599, 2227, 896, 813, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3097, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.5345, Accuracy: 0/9950 (0.0000%)
saving model
Done in 254.34452939033508 sec.
Server Epoch:82 choose agents : [58, 82, 36, 79, 60, 20, 46, 80, 12, 30].
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 359/803 (44.7073%)
_Train Local_ResNet_18, epoch  82, local model 58, internal_epoch   2, Avg loss: 0.0348, Accuracy: 361/803 (44.9564%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.1002, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   1, Avg loss: 0.0756, Accuracy: 71/500 (14.2000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   2, Avg loss: 0.0476, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.6358, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   1, Avg loss: 0.0872, Accuracy: 71/408 (17.4020%)
_Train Local_ResNet_18, epoch  82, local model 36, internal_epoch   2, Avg loss: 0.0539, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.5158, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1037, Accuracy: 21/197 (10.6599%)
_Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.0849, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3189, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   1, Avg loss: 0.0490, Accuracy: 631/2227 (28.3341%)
_Train Local_ResNet_18, epoch  82, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1042/2227 (46.7894%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.7094, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   1, Avg loss: 0.0556, Accuracy: 351/807 (43.4944%)
_Train Local_ResNet_18, epoch  82, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 427/807 (52.9120%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.3172, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   1, Avg loss: 0.0545, Accuracy: 406/1904 (21.3235%)
_Train Local_ResNet_18, epoch  82, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 667/1904 (35.0315%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.0947, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 143/682 (20.9677%)
_Train Local_ResNet_18, epoch  82, local model 80, internal_epoch   2, Avg loss: 0.0373, Accuracy: 245/682 (35.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.3191, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   1, Avg loss: 0.0867, Accuracy: 20/338 (5.9172%)
_Train Local_ResNet_18, epoch  82, local model 12, internal_epoch   2, Avg loss: 0.0494, Accuracy: 160/338 (47.3373%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.4751, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   1, Avg loss: 0.0782, Accuracy: 87/486 (17.9012%)
_Train Local_ResNet_18, epoch  82, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.9377, Accuracy: 42/10000 (0.4200%)
time spent on training: 170.0082495212555
[foolsgold agg] training data poison_ratio: 0.0  data num: [803, 500, 408, 197, 2227, 807, 1904, 682, 338, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3097, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.5336, Accuracy: 0/9950 (0.0000%)
saving model
Done in 236.66161608695984 sec.
Server Epoch:83 choose agents : [42, 64, 32, 1, 35, 56, 44, 74, 93, 78].
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 348/1372 (25.3644%)
_Train Local_ResNet_18, epoch  83, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 502/1372 (36.5889%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.8561, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 170/953 (17.8384%)
_Train Local_ResNet_18, epoch  83, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 302/953 (31.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.4794, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   1, Avg loss: 0.0590, Accuracy: 207/735 (28.1633%)
_Train Local_ResNet_18, epoch  83, local model 32, internal_epoch   2, Avg loss: 0.0222, Accuracy: 361/735 (49.1156%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.9140, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   1, Avg loss: 0.0577, Accuracy: 291/928 (31.3578%)
_Train Local_ResNet_18, epoch  83, local model 1, internal_epoch   2, Avg loss: 0.0235, Accuracy: 563/928 (60.6681%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.7118, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   1, Avg loss: 0.0857, Accuracy: 38/271 (14.0221%)
_Train Local_ResNet_18, epoch  83, local model 35, internal_epoch   2, Avg loss: 0.0545, Accuracy: 111/271 (40.9594%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3708, Accuracy: 40/10000 (0.4000%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0671, Accuracy: 76/186 (40.8602%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3103, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 380/1750 (21.7143%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 666/1750 (38.0571%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.4712, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 523/1552 (33.6985%)
_Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 757/1552 (48.7758%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 11.5319, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 444/1742 (25.4879%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 743/1742 (42.6521%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.9518, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0829, Accuracy: 47/416 (11.2981%)
_Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0461, Accuracy: 186/416 (44.7115%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.5914, Accuracy: 50/10000 (0.5000%)
time spent on training: 197.98585891723633
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 953, 735, 928, 271, 186, 1750, 1552, 1742, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3096, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.5294, Accuracy: 0/9950 (0.0000%)
saving model
Done in 267.0057408809662 sec.
Server Epoch:84 choose agents : [97, 25, 53, 60, 55, 28, 37, 44, 1, 14].
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   1, Avg loss: 0.0518, Accuracy: 376/1213 (30.9975%)
_Train Local_ResNet_18, epoch  84, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 540/1213 (44.5177%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.9681, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   1, Avg loss: 0.0567, Accuracy: 310/690 (44.9275%)
_Train Local_ResNet_18, epoch  84, local model 25, internal_epoch   2, Avg loss: 0.0271, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.4969, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0483, Accuracy: 323/813 (39.7294%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0189, Accuracy: 442/813 (54.3665%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.1515, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   1, Avg loss: 0.0485, Accuracy: 614/2227 (27.5707%)
_Train Local_ResNet_18, epoch  84, local model 60, internal_epoch   2, Avg loss: 0.0276, Accuracy: 1052/2227 (47.2384%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.0144, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0552, Accuracy: 272/1071 (25.3968%)
_Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 521/1071 (48.6461%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.5729, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 363/1581 (22.9602%)
_Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 596/1581 (37.6977%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.6341, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   1, Avg loss: 0.0507, Accuracy: 443/1129 (39.2383%)
_Train Local_ResNet_18, epoch  84, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 756/1129 (66.9619%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.6847, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 383/1750 (21.8857%)
_Train Local_ResNet_18, epoch  84, local model 44, internal_epoch   2, Avg loss: 0.0348, Accuracy: 698/1750 (39.8857%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.8400, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 293/928 (31.5733%)
_Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 557/928 (60.0216%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.4932, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   1, Avg loss: 0.0619, Accuracy: 221/1013 (21.8164%)
_Train Local_ResNet_18, epoch  84, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 330/1013 (32.5765%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.7816, Accuracy: 72/10000 (0.7200%)
time spent on training: 233.28642797470093
[foolsgold agg] training data poison_ratio: 0.0  data num: [1213, 690, 813, 2227, 1071, 1581, 1129, 1750, 928, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3095, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.5285, Accuracy: 0/9950 (0.0000%)
saving model
Done in 301.7609803676605 sec.
Server Epoch:85 choose agents : [82, 2, 84, 18, 95, 7, 87, 78, 22, 57].
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   1, Avg loss: 0.0757, Accuracy: 75/500 (15.0000%)
_Train Local_ResNet_18, epoch  85, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.7258, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   1, Avg loss: 0.0653, Accuracy: 239/605 (39.5041%)
_Train Local_ResNet_18, epoch  85, local model 2, internal_epoch   2, Avg loss: 0.0379, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.8673, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   1, Avg loss: 0.0614, Accuracy: 331/1190 (27.8151%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 444/1190 (37.3109%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.1767, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0750, Accuracy: 117/530 (22.0755%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0378, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.0890, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   1, Avg loss: 0.0497, Accuracy: 338/599 (56.4274%)
_Train Local_ResNet_18, epoch  85, local model 95, internal_epoch   2, Avg loss: 0.0312, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.2046, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 359/891 (40.2918%)
_Train Local_ResNet_18, epoch  85, local model 7, internal_epoch   2, Avg loss: 0.0266, Accuracy: 398/891 (44.6689%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.4667, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   1, Avg loss: 0.0578, Accuracy: 301/1131 (26.6136%)
_Train Local_ResNet_18, epoch  85, local model 87, internal_epoch   2, Avg loss: 0.0315, Accuracy: 391/1131 (34.5712%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.7372, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   1, Avg loss: 0.0823, Accuracy: 46/416 (11.0577%)
_Train Local_ResNet_18, epoch  85, local model 78, internal_epoch   2, Avg loss: 0.0461, Accuracy: 176/416 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.5676, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   1, Avg loss: 0.0466, Accuracy: 487/1470 (33.1293%)
_Train Local_ResNet_18, epoch  85, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 857/1470 (58.2993%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.2021, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   1, Avg loss: 0.0542, Accuracy: 302/1154 (26.1698%)
_Train Local_ResNet_18, epoch  85, local model 57, internal_epoch   2, Avg loss: 0.0246, Accuracy: 540/1154 (46.7938%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.6509, Accuracy: 70/10000 (0.7000%)
time spent on training: 183.54326629638672
[foolsgold agg] training data poison_ratio: 0.0  data num: [500, 605, 1190, 530, 599, 891, 1131, 416, 1470, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3095, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.5290, Accuracy: 0/9950 (0.0000%)
saving model
Done in 252.6004490852356 sec.
Server Epoch:86 choose agents : [56, 98, 59, 19, 34, 83, 80, 43, 40, 58].
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  86, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 77/186 (41.3978%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3108, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   1, Avg loss: 0.0800, Accuracy: 28/373 (7.5067%)
_Train Local_ResNet_18, epoch  86, local model 98, internal_epoch   2, Avg loss: 0.0468, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.4540, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0533, Accuracy: 326/1089 (29.9357%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 486/1089 (44.6281%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.4396, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 400/1036 (38.6100%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0233, Accuracy: 652/1036 (62.9344%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.1358, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   1, Avg loss: 0.0584, Accuracy: 385/1427 (26.9797%)
_Train Local_ResNet_18, epoch  86, local model 34, internal_epoch   2, Avg loss: 0.0337, Accuracy: 571/1427 (40.0140%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.8420, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 448/1953 (22.9391%)
_Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   2, Avg loss: 0.0331, Accuracy: 814/1953 (41.6795%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.9228, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   1, Avg loss: 0.0694, Accuracy: 153/682 (22.4340%)
_Train Local_ResNet_18, epoch  86, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 257/682 (37.6833%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.5370, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   1, Avg loss: 0.0604, Accuracy: 313/946 (33.0867%)
_Train Local_ResNet_18, epoch  86, local model 43, internal_epoch   2, Avg loss: 0.0352, Accuracy: 377/946 (39.8520%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.1256, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 361/1573 (22.9498%)
_Train Local_ResNet_18, epoch  86, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 584/1573 (37.1265%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.1974, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   1, Avg loss: 0.0567, Accuracy: 353/803 (43.9601%)
_Train Local_ResNet_18, epoch  86, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 387/803 (48.1943%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.0857, Accuracy: 51/10000 (0.5100%)
time spent on training: 204.5857355594635
[foolsgold agg] training data poison_ratio: 0.0  data num: [186, 373, 1089, 1036, 1427, 1953, 682, 946, 1573, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3094, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.5287, Accuracy: 0/9950 (0.0000%)
saving model
Done in 272.2777888774872 sec.
Server Epoch:87 choose agents : [84, 28, 53, 68, 85, 44, 25, 46, 32, 56].
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 320/1190 (26.8908%)
_Train Local_ResNet_18, epoch  87, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 441/1190 (37.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.9876, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 397/1581 (25.1107%)
_Train Local_ResNet_18, epoch  87, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 641/1581 (40.5440%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.6544, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   1, Avg loss: 0.0486, Accuracy: 308/813 (37.8844%)
_Train Local_ResNet_18, epoch  87, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 484/813 (59.5326%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.2734, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0603, Accuracy: 383/1163 (32.9321%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 468/1163 (40.2408%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.7847, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 484/1988 (24.3461%)
_Train Local_ResNet_18, epoch  87, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 712/1988 (35.8149%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.8190, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 402/1750 (22.9714%)
_Train Local_ResNet_18, epoch  87, local model 44, internal_epoch   2, Avg loss: 0.0349, Accuracy: 674/1750 (38.5143%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4842, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   1, Avg loss: 0.0580, Accuracy: 308/690 (44.6377%)
_Train Local_ResNet_18, epoch  87, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.5041, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 448/1904 (23.5294%)
_Train Local_ResNet_18, epoch  87, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 674/1904 (35.3992%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.6368, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   1, Avg loss: 0.0586, Accuracy: 206/735 (28.0272%)
_Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   2, Avg loss: 0.0222, Accuracy: 371/735 (50.4762%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.7901, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 56, internal_epoch   2, Avg loss: 0.0670, Accuracy: 78/186 (41.9355%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
time spent on training: 227.01970601081848
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 1581, 813, 1163, 1988, 1750, 690, 1904, 735, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3093, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.5261, Accuracy: 0/9950 (0.0000%)
saving model
Done in 293.6100995540619 sec.
Server Epoch:88 choose agents : [61, 81, 83, 18, 62, 66, 28, 36, 85, 78].
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   1, Avg loss: 0.1246, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  88, local model 61, internal_epoch   2, Avg loss: 0.1172, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3040, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0671, Accuracy: 241/774 (31.1370%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0352, Accuracy: 310/774 (40.0517%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.2938, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   1, Avg loss: 0.0533, Accuracy: 450/1953 (23.0415%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 739/1953 (37.8392%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.5316, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0751, Accuracy: 124/530 (23.3962%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0368, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.0693, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0680, Accuracy: 151/568 (26.5845%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0401, Accuracy: 267/568 (47.0070%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.8069, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   1, Avg loss: 0.0615, Accuracy: 248/1402 (17.6890%)
_Train Local_ResNet_18, epoch  88, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 416/1402 (29.6719%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.2407, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0554, Accuracy: 399/1581 (25.2372%)
_Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 615/1581 (38.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.8332, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   1, Avg loss: 0.0867, Accuracy: 80/408 (19.6078%)
_Train Local_ResNet_18, epoch  88, local model 36, internal_epoch   2, Avg loss: 0.0525, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.5317, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   1, Avg loss: 0.0543, Accuracy: 453/1988 (22.7867%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   2, Avg loss: 0.0345, Accuracy: 692/1988 (34.8089%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0554, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   1, Avg loss: 0.0827, Accuracy: 49/416 (11.7788%)
_Train Local_ResNet_18, epoch  88, local model 78, internal_epoch   2, Avg loss: 0.0469, Accuracy: 188/416 (45.1923%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.5916, Accuracy: 50/10000 (0.5000%)
time spent on training: 194.8157742023468
[foolsgold agg] training data poison_ratio: 0.0  data num: [85, 774, 1953, 530, 568, 1402, 1581, 408, 1988, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3092, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.5262, Accuracy: 0/9950 (0.0000%)
saving model
Done in 261.40782499313354 sec.
Server Epoch:89 choose agents : [42, 47, 26, 4, 44, 66, 94, 22, 38, 15].
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0527, Accuracy: 360/1372 (26.2391%)
_Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 524/1372 (38.1924%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.8361, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   1, Avg loss: 0.1192, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  89, local model 47, internal_epoch   2, Avg loss: 0.1114, Accuracy: 21/134 (15.6716%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3098, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 347/1446 (23.9972%)
_Train Local_ResNet_18, epoch  89, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 492/1446 (34.0249%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.3245, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   1, Avg loss: 0.0611, Accuracy: 335/901 (37.1809%)
_Train Local_ResNet_18, epoch  89, local model 4, internal_epoch   2, Avg loss: 0.0329, Accuracy: 392/901 (43.5072%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.8484, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 395/1750 (22.5714%)
_Train Local_ResNet_18, epoch  89, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 671/1750 (38.3429%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.8869, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0616, Accuracy: 255/1402 (18.1883%)
_Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 430/1402 (30.6705%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.4831, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   1, Avg loss: 0.0546, Accuracy: 353/1662 (21.2395%)
_Train Local_ResNet_18, epoch  89, local model 94, internal_epoch   2, Avg loss: 0.0325, Accuracy: 635/1662 (38.2070%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.6335, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 546/1470 (37.1429%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 822/1470 (55.9184%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.4118, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   1, Avg loss: 0.0609, Accuracy: 258/1131 (22.8117%)
_Train Local_ResNet_18, epoch  89, local model 38, internal_epoch   2, Avg loss: 0.0301, Accuracy: 492/1131 (43.5013%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.5533, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   1, Avg loss: 0.0551, Accuracy: 329/1154 (28.5095%)
_Train Local_ResNet_18, epoch  89, local model 15, internal_epoch   2, Avg loss: 0.0280, Accuracy: 480/1154 (41.5945%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.9843, Accuracy: 51/10000 (0.5100%)
time spent on training: 231.70750164985657
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 134, 1446, 901, 1750, 1402, 1662, 1470, 1131, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3092, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.5264, Accuracy: 0/9950 (0.0000%)
saving model
Done in 297.94197249412537 sec.
Server Epoch:90 choose agents : [24, 40, 38, 39, 33, 75, 28, 70, 7, 52].
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   1, Avg loss: 0.0763, Accuracy: 45/312 (14.4231%)
_Train Local_ResNet_18, epoch  90, local model 24, internal_epoch   2, Avg loss: 0.0404, Accuracy: 163/312 (52.2436%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3921, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0555, Accuracy: 352/1573 (22.3776%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 602/1573 (38.2708%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.4532, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   1, Avg loss: 0.0607, Accuracy: 255/1131 (22.5464%)
_Train Local_ResNet_18, epoch  90, local model 38, internal_epoch   2, Avg loss: 0.0300, Accuracy: 497/1131 (43.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.4465, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 318/1013 (31.3919%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 514/1013 (50.7404%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.5820, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   1, Avg loss: 0.0778, Accuracy: 75/515 (14.5631%)
_Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   2, Avg loss: 0.0529, Accuracy: 131/515 (25.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.9975, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   1, Avg loss: 0.0640, Accuracy: 259/776 (33.3763%)
_Train Local_ResNet_18, epoch  90, local model 75, internal_epoch   2, Avg loss: 0.0283, Accuracy: 409/776 (52.7062%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.3810, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 405/1581 (25.6167%)
_Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2, Avg loss: 0.0330, Accuracy: 627/1581 (39.6584%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.6226, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0550, Accuracy: 349/1418 (24.6121%)
_Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 662/1418 (46.6855%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.5944, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch  90, local model 7, internal_epoch   2, Avg loss: 0.0250, Accuracy: 468/891 (52.5253%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.9990, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   1, Avg loss: 0.0555, Accuracy: 286/636 (44.9686%)
_Train Local_ResNet_18, epoch  90, local model 52, internal_epoch   2, Avg loss: 0.0301, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.3754, Accuracy: 50/10000 (0.5000%)
time spent on training: 197.84982776641846
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 1573, 1131, 1013, 515, 776, 1581, 1418, 891, 636]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3091, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.5268, Accuracy: 0/9950 (0.0000%)
saving model
Done in 264.64676904678345 sec.
Server Epoch:91 choose agents : [35, 33, 70, 10, 71, 89, 62, 2, 49, 23].
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   1, Avg loss: 0.0852, Accuracy: 38/271 (14.0221%)
_Train Local_ResNet_18, epoch  91, local model 35, internal_epoch   2, Avg loss: 0.0551, Accuracy: 121/271 (44.6494%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3737, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0775, Accuracy: 78/515 (15.1456%)
_Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0508, Accuracy: 126/515 (24.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.8480, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   1, Avg loss: 0.0544, Accuracy: 374/1418 (26.3752%)
_Train Local_ResNet_18, epoch  91, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 656/1418 (46.2623%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.9327, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   1, Avg loss: 0.0563, Accuracy: 218/861 (25.3194%)
_Train Local_ResNet_18, epoch  91, local model 10, internal_epoch   2, Avg loss: 0.0210, Accuracy: 448/861 (52.0325%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.1421, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0643, Accuracy: 159/818 (19.4377%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0311, Accuracy: 324/818 (39.6088%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.3461, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 337/896 (37.6116%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0341, Accuracy: 420/896 (46.8750%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.2411, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   1, Avg loss: 0.0679, Accuracy: 155/568 (27.2887%)
_Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   2, Avg loss: 0.0396, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.8129, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   1, Avg loss: 0.0631, Accuracy: 235/605 (38.8430%)
_Train Local_ResNet_18, epoch  91, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 325/605 (53.7190%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.9149, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   1, Avg loss: 0.0790, Accuracy: 34/440 (7.7273%)
_Train Local_ResNet_18, epoch  91, local model 49, internal_epoch   2, Avg loss: 0.0467, Accuracy: 150/440 (34.0909%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.5185, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   1, Avg loss: 0.0630, Accuracy: 324/715 (45.3147%)
_Train Local_ResNet_18, epoch  91, local model 23, internal_epoch   2, Avg loss: 0.0373, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.7765, Accuracy: 50/10000 (0.5000%)
time spent on training: 163.48564624786377
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 515, 1418, 861, 818, 896, 568, 605, 440, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3091, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.5269, Accuracy: 0/9950 (0.0000%)
saving model
Done in 229.76430773735046 sec.
Server Epoch:92 choose agents : [90, 88, 75, 0, 57, 41, 93, 13, 28, 29].
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   1, Avg loss: 0.0566, Accuracy: 324/677 (47.8582%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   2, Avg loss: 0.0225, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.4231, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   1, Avg loss: 0.0745, Accuracy: 148/603 (24.5439%)
_Train Local_ResNet_18, epoch  92, local model 88, internal_epoch   2, Avg loss: 0.0453, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.9271, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0619, Accuracy: 264/776 (34.0206%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0293, Accuracy: 416/776 (53.6082%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.0089, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   1, Avg loss: 0.0580, Accuracy: 345/1657 (20.8208%)
_Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 514/1657 (31.0199%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.6863, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   1, Avg loss: 0.0563, Accuracy: 306/1154 (26.5165%)
_Train Local_ResNet_18, epoch  92, local model 57, internal_epoch   2, Avg loss: 0.0250, Accuracy: 530/1154 (45.9272%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.3282, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   1, Avg loss: 0.0600, Accuracy: 339/719 (47.1488%)
_Train Local_ResNet_18, epoch  92, local model 41, internal_epoch   2, Avg loss: 0.0308, Accuracy: 460/719 (63.9777%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.4365, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 427/1742 (24.5121%)
_Train Local_ResNet_18, epoch  92, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 693/1742 (39.7819%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.5652, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0565, Accuracy: 345/1645 (20.9726%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0322, Accuracy: 644/1645 (39.1489%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.1650, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 402/1581 (25.4269%)
_Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   2, Avg loss: 0.0325, Accuracy: 630/1581 (39.8482%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.6655, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 402/1440 (27.9167%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 669/1440 (46.4583%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.9779, Accuracy: 74/10000 (0.7400%)
time spent on training: 230.52107310295105
[foolsgold agg] training data poison_ratio: 0.0  data num: [677, 603, 776, 1657, 1154, 719, 1742, 1645, 1581, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3090, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.5274, Accuracy: 0/9950 (0.0000%)
saving model
Done in 296.7940399646759 sec.
Server Epoch:93 choose agents : [74, 6, 34, 1, 92, 14, 45, 66, 54, 72].
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 482/1552 (31.0567%)
_Train Local_ResNet_18, epoch  93, local model 74, internal_epoch   2, Avg loss: 0.0206, Accuracy: 763/1552 (49.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.2924, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 411/1956 (21.0123%)
_Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 648/1956 (33.1288%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.1399, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   1, Avg loss: 0.0572, Accuracy: 382/1427 (26.7694%)
_Train Local_ResNet_18, epoch  93, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 583/1427 (40.8549%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.0469, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0557, Accuracy: 295/928 (31.7888%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0232, Accuracy: 575/928 (61.9612%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.6852, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   1, Avg loss: 0.0512, Accuracy: 479/1715 (27.9300%)
_Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 760/1715 (44.3149%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.4414, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   1, Avg loss: 0.0609, Accuracy: 230/1013 (22.7048%)
_Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   2, Avg loss: 0.0349, Accuracy: 345/1013 (34.0573%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.7489, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1, Avg loss: 0.0678, Accuracy: 204/669 (30.4933%)
_Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2, Avg loss: 0.0403, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.8008, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   1, Avg loss: 0.0614, Accuracy: 270/1402 (19.2582%)
_Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 422/1402 (30.0999%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.5956, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 347/1130 (30.7080%)
_Train Local_ResNet_18, epoch  93, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 459/1130 (40.6195%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.8260, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 270/1241 (21.7566%)
_Train Local_ResNet_18, epoch  93, local model 72, internal_epoch   2, Avg loss: 0.0359, Accuracy: 440/1241 (35.4553%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.2413, Accuracy: 55/10000 (0.5500%)
time spent on training: 246.07905793190002
[foolsgold agg] training data poison_ratio: 0.0  data num: [1552, 1956, 1427, 928, 1715, 1013, 669, 1402, 1130, 1241]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3090, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.5282, Accuracy: 0/9950 (0.0000%)
saving model
Done in 312.5036015510559 sec.
Server Epoch:94 choose agents : [53, 22, 94, 97, 27, 51, 47, 23, 4, 2].
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   1, Avg loss: 0.0483, Accuracy: 305/813 (37.5154%)
_Train Local_ResNet_18, epoch  94, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 463/813 (56.9496%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.6978, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 522/1470 (35.5102%)
_Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 858/1470 (58.3673%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.0302, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   1, Avg loss: 0.0543, Accuracy: 364/1662 (21.9013%)
_Train Local_ResNet_18, epoch  94, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 641/1662 (38.5680%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.7898, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 368/1213 (30.3380%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 486/1213 (40.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.5458, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   1, Avg loss: 0.0541, Accuracy: 449/1587 (28.2924%)
_Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 578/1587 (36.4209%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.3256, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0594, Accuracy: 242/1049 (23.0696%)
_Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0292, Accuracy: 537/1049 (51.1916%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.5479, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   1, Avg loss: 0.1241, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   2, Avg loss: 0.1066, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3093, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0612, Accuracy: 319/715 (44.6154%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0382, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.7406, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0614, Accuracy: 340/901 (37.7358%)
_Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0336, Accuracy: 393/901 (43.6182%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.5498, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0640, Accuracy: 227/605 (37.5207%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0394, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.8675, Accuracy: 69/10000 (0.6900%)
time spent on training: 208.09393572807312
[foolsgold agg] training data poison_ratio: 0.0  data num: [813, 1470, 1662, 1213, 1587, 1049, 134, 715, 901, 605]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.69687755 1.         1.         0.69687755]
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3090, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.5286, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.2117455005646 sec.
Server Epoch:95 choose agents : [78, 3, 0, 9, 40, 1, 57, 10, 28, 76].
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   1, Avg loss: 0.0823, Accuracy: 39/416 (9.3750%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   2, Avg loss: 0.0445, Accuracy: 181/416 (43.5096%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.5981, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   1, Avg loss: 0.0719, Accuracy: 117/781 (14.9808%)
_Train Local_ResNet_18, epoch  95, local model 3, internal_epoch   2, Avg loss: 0.0347, Accuracy: 226/781 (28.9373%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.2279, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 354/1657 (21.3639%)
_Train Local_ResNet_18, epoch  95, local model 0, internal_epoch   2, Avg loss: 0.0349, Accuracy: 505/1657 (30.4768%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.6449, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   1, Avg loss: 0.0487, Accuracy: 376/1275 (29.4902%)
_Train Local_ResNet_18, epoch  95, local model 9, internal_epoch   2, Avg loss: 0.0188, Accuracy: 729/1275 (57.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.5898, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   1, Avg loss: 0.0553, Accuracy: 348/1573 (22.1233%)
_Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   2, Avg loss: 0.0342, Accuracy: 601/1573 (38.2072%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.2365, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0560, Accuracy: 305/928 (32.8664%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 591/928 (63.6853%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.7917, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0532, Accuracy: 309/1154 (26.7764%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0260, Accuracy: 513/1154 (44.4541%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.5085, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 217/861 (25.2033%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0208, Accuracy: 481/861 (55.8653%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.3081, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0553, Accuracy: 419/1581 (26.5022%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 615/1581 (38.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.6751, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   1, Avg loss: 0.0840, Accuracy: 56/466 (12.0172%)
_Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   2, Avg loss: 0.0481, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.7361, Accuracy: 50/10000 (0.5000%)
time spent on training: 217.17702293395996
[foolsgold agg] training data poison_ratio: 0.0  data num: [416, 781, 1657, 1275, 1573, 928, 1154, 861, 1581, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3089, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.5290, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.20413398742676 sec.
Server Epoch:96 choose agents : [76, 8, 1, 29, 41, 17, 60, 2, 14, 5].
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   1, Avg loss: 0.0841, Accuracy: 48/466 (10.3004%)
_Train Local_ResNet_18, epoch  96, local model 76, internal_epoch   2, Avg loss: 0.0489, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.7285, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   1, Avg loss: 0.0586, Accuracy: 249/1513 (16.4574%)
_Train Local_ResNet_18, epoch  96, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 492/1513 (32.5182%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.4996, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0549, Accuracy: 304/928 (32.7586%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 564/928 (60.7759%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.8171, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 457/1440 (31.7361%)
_Train Local_ResNet_18, epoch  96, local model 29, internal_epoch   2, Avg loss: 0.0273, Accuracy: 706/1440 (49.0278%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.8798, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   1, Avg loss: 0.0579, Accuracy: 342/719 (47.5661%)
_Train Local_ResNet_18, epoch  96, local model 41, internal_epoch   2, Avg loss: 0.0309, Accuracy: 467/719 (64.9513%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.4870, Accuracy: 50/10000 (0.5000%)
poison local model 17 index 0 
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 409/1574 (25.9848%)
_Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 676/1574 (42.9479%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.9841, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   1, Avg loss: 0.0486, Accuracy: 627/2227 (28.1545%)
_Train Local_ResNet_18, epoch  96, local model 60, internal_epoch   2, Avg loss: 0.0273, Accuracy: 1058/2227 (47.5079%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.5647, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 236/605 (39.0083%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0401, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.9079, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   1, Avg loss: 0.0613, Accuracy: 228/1013 (22.5074%)
_Train Local_ResNet_18, epoch  96, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 323/1013 (31.8855%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.9026, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   1, Avg loss: 0.0501, Accuracy: 370/1628 (22.7273%)
_Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 833/1628 (51.1671%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.4194, Accuracy: 119/10000 (1.1900%)
time spent on training: 250.10355639457703
[foolsgold agg] training data poison_ratio: 0.12994303640716587  data num: [466, 1513, 928, 1440, 719, 1574, 2227, 605, 1013, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.040607198877239334
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3088, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.5284, Accuracy: 0/9950 (0.0000%)
saving model
Done in 316.78052139282227 sec.
Server Epoch:97 choose agents : [37, 35, 82, 73, 83, 7, 26, 40, 25, 53].
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   1, Avg loss: 0.0526, Accuracy: 380/1129 (33.6581%)
_Train Local_ResNet_18, epoch  97, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 703/1129 (62.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.3479, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0843, Accuracy: 46/271 (16.9742%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0542, Accuracy: 108/271 (39.8524%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3722, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   1, Avg loss: 0.0755, Accuracy: 76/500 (15.2000%)
_Train Local_ResNet_18, epoch  97, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.7275, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   1, Avg loss: 0.0645, Accuracy: 179/938 (19.0832%)
_Train Local_ResNet_18, epoch  97, local model 73, internal_epoch   2, Avg loss: 0.0329, Accuracy: 345/938 (36.7804%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.7193, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 446/1953 (22.8367%)
_Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2, Avg loss: 0.0328, Accuracy: 813/1953 (41.6283%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.9219, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 347/891 (38.9450%)
_Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 459/891 (51.5152%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.4238, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0543, Accuracy: 363/1446 (25.1037%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 517/1446 (35.7538%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.3730, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 381/1573 (24.2212%)
_Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 568/1573 (36.1093%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.4891, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   1, Avg loss: 0.0553, Accuracy: 317/690 (45.9420%)
_Train Local_ResNet_18, epoch  97, local model 25, internal_epoch   2, Avg loss: 0.0271, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.5484, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   1, Avg loss: 0.0489, Accuracy: 284/813 (34.9323%)
_Train Local_ResNet_18, epoch  97, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 453/813 (55.7196%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.6778, Accuracy: 50/10000 (0.5000%)
time spent on training: 212.52793145179749
[foolsgold agg] training data poison_ratio: 0.0  data num: [1129, 271, 500, 938, 1953, 891, 1446, 1573, 690, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         0.87982003 1.         1.         0.87982003 1.
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3088, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.5278, Accuracy: 0/9950 (0.0000%)
saving model
Done in 278.6521968841553 sec.
Server Epoch:98 choose agents : [69, 55, 61, 88, 71, 15, 24, 32, 21, 56].
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   1, Avg loss: 0.0556, Accuracy: 290/590 (49.1525%)
_Train Local_ResNet_18, epoch  98, local model 69, internal_epoch   2, Avg loss: 0.0291, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.1537, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   1, Avg loss: 0.0548, Accuracy: 264/1071 (24.6499%)
_Train Local_ResNet_18, epoch  98, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 525/1071 (49.0196%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.4753, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   1, Avg loss: 0.1264, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 61, internal_epoch   2, Avg loss: 0.1171, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3040, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   1, Avg loss: 0.0737, Accuracy: 146/603 (24.2123%)
_Train Local_ResNet_18, epoch  98, local model 88, internal_epoch   2, Avg loss: 0.0450, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.8804, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   1, Avg loss: 0.0637, Accuracy: 152/818 (18.5819%)
_Train Local_ResNet_18, epoch  98, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 341/818 (41.6870%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.5721, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   1, Avg loss: 0.0569, Accuracy: 334/1154 (28.9428%)
_Train Local_ResNet_18, epoch  98, local model 15, internal_epoch   2, Avg loss: 0.0303, Accuracy: 375/1154 (32.4957%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.9983, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.0760, Accuracy: 43/312 (13.7821%)
_Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0403, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.4063, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0590, Accuracy: 211/735 (28.7075%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 348/735 (47.3469%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.2279, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 416/1949 (21.3443%)
_Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 639/1949 (32.7860%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.6884, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 74/186 (39.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3108, Accuracy: 50/10000 (0.5000%)
time spent on training: 175.86006951332092
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 1071, 85, 603, 818, 1154, 312, 735, 1949, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3088, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.5248, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.25191926956177 sec.
Server Epoch:99 choose agents : [23, 48, 34, 65, 24, 80, 37, 61, 91, 77].
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0600, Accuracy: 329/715 (46.0140%)
_Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0389, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.8585, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   1, Avg loss: 0.0704, Accuracy: 110/631 (17.4326%)
_Train Local_ResNet_18, epoch  99, local model 48, internal_epoch   2, Avg loss: 0.0406, Accuracy: 228/631 (36.1331%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.9067, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   1, Avg loss: 0.0585, Accuracy: 406/1427 (28.4513%)
_Train Local_ResNet_18, epoch  99, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 601/1427 (42.1163%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.8724, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   1, Avg loss: 0.0547, Accuracy: 392/1475 (26.5763%)
_Train Local_ResNet_18, epoch  99, local model 65, internal_epoch   2, Avg loss: 0.0306, Accuracy: 700/1475 (47.4576%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.8235, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.0756, Accuracy: 51/312 (16.3462%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0397, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3979, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   1, Avg loss: 0.0688, Accuracy: 147/682 (21.5543%)
_Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   2, Avg loss: 0.0374, Accuracy: 258/682 (37.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.5411, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   1, Avg loss: 0.0512, Accuracy: 468/1129 (41.4526%)
_Train Local_ResNet_18, epoch  99, local model 37, internal_epoch   2, Avg loss: 0.0239, Accuracy: 748/1129 (66.2533%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.4504, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   1, Avg loss: 0.1245, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  99, local model 61, internal_epoch   2, Avg loss: 0.1172, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3035, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   1, Avg loss: 0.0522, Accuracy: 348/1030 (33.7864%)
_Train Local_ResNet_18, epoch  99, local model 91, internal_epoch   2, Avg loss: 0.0245, Accuracy: 632/1030 (61.3592%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.2524, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 325/1340 (24.2537%)
_Train Local_ResNet_18, epoch  99, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 581/1340 (43.3582%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.8043, Accuracy: 60/10000 (0.6000%)
time spent on training: 196.15704655647278
[foolsgold agg] training data poison_ratio: 0.0  data num: [715, 631, 1427, 1475, 312, 682, 1129, 85, 1030, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3087, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.5236, Accuracy: 0/9950 (0.0000%)
saving model
Done in 262.93727374076843 sec.
Server Epoch:100 choose agents : [46, 64, 84, 23, 38, 4, 0, 52, 86, 57].
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   1, Avg loss: 0.0545, Accuracy: 419/1904 (22.0063%)
_Train Local_ResNet_18, epoch 100, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 689/1904 (36.1870%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.0954, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   1, Avg loss: 0.0634, Accuracy: 191/953 (20.0420%)
_Train Local_ResNet_18, epoch 100, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 295/953 (30.9549%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.4666, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   1, Avg loss: 0.0621, Accuracy: 327/1190 (27.4790%)
_Train Local_ResNet_18, epoch 100, local model 84, internal_epoch   2, Avg loss: 0.0317, Accuracy: 458/1190 (38.4874%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.0023, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   1, Avg loss: 0.0587, Accuracy: 329/715 (46.0140%)
_Train Local_ResNet_18, epoch 100, local model 23, internal_epoch   2, Avg loss: 0.0404, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.9543, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   1, Avg loss: 0.0607, Accuracy: 272/1131 (24.0495%)
_Train Local_ResNet_18, epoch 100, local model 38, internal_epoch   2, Avg loss: 0.0297, Accuracy: 497/1131 (43.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.3703, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   1, Avg loss: 0.0617, Accuracy: 333/901 (36.9589%)
_Train Local_ResNet_18, epoch 100, local model 4, internal_epoch   2, Avg loss: 0.0319, Accuracy: 403/901 (44.7281%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.8462, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   1, Avg loss: 0.0574, Accuracy: 364/1657 (21.9674%)
_Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   2, Avg loss: 0.0343, Accuracy: 541/1657 (32.6494%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7139, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1, Avg loss: 0.0564, Accuracy: 289/636 (45.4403%)
_Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.3360, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0615, Accuracy: 361/1003 (35.9920%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 378/1003 (37.6869%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.9226, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0541, Accuracy: 313/1154 (27.1231%)
_Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0259, Accuracy: 512/1154 (44.3674%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.0439, Accuracy: 73/10000 (0.7300%)
time spent on training: 231.61066913604736
[foolsgold agg] training data poison_ratio: 0.0  data num: [1904, 953, 1190, 715, 1131, 901, 1657, 636, 1003, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3087, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.5234, Accuracy: 0/9950 (0.0000%)
saving model
Done in 297.7905788421631 sec.
Saving all the graphs.
This run has a label: Jun.19_12.01.27. Visdom environment: tiny
