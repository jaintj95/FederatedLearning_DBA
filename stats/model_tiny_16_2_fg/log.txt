current path: saved_models/model_tiny_Jun.17_22.23.59
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 5, 10, 15, 25, 30, 37, 44, 49, 55, 61, 65, 85]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [98, 0, 77, 44, 66, 67, 33, 25, 19, 92].
___Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   1, Avg loss: 0.0833, Accuracy: 12/373 (3.2172%)
___Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   2, Avg loss: 0.0497, Accuracy: 152/373 (40.7507%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.4296, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   1, Avg loss: 0.0586, Accuracy: 378/1657 (22.8123%)
___Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   2, Avg loss: 0.0354, Accuracy: 462/1657 (27.8817%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9061, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 316/1340 (23.5821%)
___Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 569/1340 (42.4627%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6844, Accuracy: 67/10000 (0.6700%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 377/1750 (21.5429%)
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 653/1750 (37.3143%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.8599, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 250/1402 (17.8317%)
___Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 353/1402 (25.1783%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.1342, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   1, Avg loss: 0.0794, Accuracy: 47/426 (11.0329%)
___Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   2, Avg loss: 0.0421, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5883, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   1, Avg loss: 0.0802, Accuracy: 57/515 (11.0680%)
___Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   2, Avg loss: 0.0544, Accuracy: 126/515 (24.4660%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.6484, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   1, Avg loss: 0.0576, Accuracy: 295/690 (42.7536%)
___Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.1385, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 387/1036 (37.3552%)
___Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   2, Avg loss: 0.0254, Accuracy: 635/1036 (61.2934%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 9.3428, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0513, Accuracy: 471/1715 (27.4636%)
___Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 716/1715 (41.7493%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.4549, Accuracy: 86/10000 (0.8600%)
time spent on training: 153.82746148109436
[foolsgold agg] training data poison_ratio: 0.37573367571533384  data num: [373, 1657, 1340, 1750, 1402, 426, 515, 690, 1036, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.11741677366104182
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3169, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6229, Accuracy: 0/9950 (0.0000%)
saving model
Done in 388.32573986053467 sec.
Server Epoch:2 choose agents : [77, 57, 52, 28, 29, 61, 99, 34, 8, 85].
___Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   1, Avg loss: 0.0536, Accuracy: 327/1340 (24.4030%)
___Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 538/1340 (40.1493%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6519, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   1, Avg loss: 0.0568, Accuracy: 299/1154 (25.9099%)
___Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   2, Avg loss: 0.0264, Accuracy: 474/1154 (41.0745%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.8208, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 278/636 (43.7107%)
___Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   2, Avg loss: 0.0321, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.2082, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0567, Accuracy: 380/1581 (24.0354%)
___Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0344, Accuracy: 531/1581 (33.5863%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.5937, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 431/1440 (29.9306%)
___Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0275, Accuracy: 677/1440 (47.0139%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6873, Accuracy: 69/10000 (0.6900%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   1, Avg loss: 0.1258, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   2, Avg loss: 0.1181, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3045, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0660, Accuracy: 168/773 (21.7335%)
___Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0316, Accuracy: 418/773 (54.0750%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8403, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   1, Avg loss: 0.0588, Accuracy: 373/1427 (26.1388%)
___Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 560/1427 (39.2432%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.9020, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   1, Avg loss: 0.0605, Accuracy: 226/1513 (14.9372%)
___Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 488/1513 (32.2538%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.1535, Accuracy: 93/10000 (0.9300%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0545, Accuracy: 456/1988 (22.9376%)
___Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 673/1988 (33.8531%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.0115, Accuracy: 89/10000 (0.8900%)
time spent on training: 132.74307680130005
[foolsgold agg] training data poison_ratio: 0.17366172405126917  data num: [1340, 1154, 636, 1581, 1440, 85, 773, 1427, 1513, 1988]
[foolsgold agg] considering poison per batch poison_fraction: 0.05426928876602162
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3168, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6232, Accuracy: 0/9950 (0.0000%)
saving model
Done in 363.9277126789093 sec.
Server Epoch:3 choose agents : [89, 70, 9, 99, 37, 17, 4, 82, 30, 13].
___Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   1, Avg loss: 0.0612, Accuracy: 328/896 (36.6071%)
___Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 436/896 (48.6607%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.1445, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 334/1418 (23.5543%)
___Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0320, Accuracy: 604/1418 (42.5952%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.4819, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   1, Avg loss: 0.0493, Accuracy: 360/1275 (28.2353%)
___Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   2, Avg loss: 0.0194, Accuracy: 716/1275 (56.1569%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 9.3834, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   1, Avg loss: 0.0672, Accuracy: 172/773 (22.2510%)
___Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   2, Avg loss: 0.0308, Accuracy: 403/773 (52.1345%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.2652, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   1, Avg loss: 0.0534, Accuracy: 381/1129 (33.7467%)
___Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   2, Avg loss: 0.0255, Accuracy: 695/1129 (61.5589%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1934, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 411/1574 (26.1118%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 676/1574 (42.9479%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.3753, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0640, Accuracy: 319/901 (35.4051%)
___Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0334, Accuracy: 394/901 (43.7292%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.5863, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   1, Avg loss: 0.0774, Accuracy: 63/500 (12.6000%)
___Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   2, Avg loss: 0.0494, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.6682, Accuracy: 48/10000 (0.4800%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   1, Avg loss: 0.0813, Accuracy: 68/486 (13.9918%)
___Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   2, Avg loss: 0.0422, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.7344, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 311/1645 (18.9058%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 619/1645 (37.6292%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.7820, Accuracy: 118/10000 (1.1800%)
time spent on training: 131.91535758972168
[foolsgold agg] training data poison_ratio: 0.1524016231008776  data num: [896, 1418, 1275, 773, 1129, 1574, 901, 500, 486, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.04762550721902425
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3166, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6221, Accuracy: 0/9950 (0.0000%)
saving model
Done in 370.3088300228119 sec.
Server Epoch:4 choose agents : [24, 77, 38, 89, 8, 28, 48, 62, 16, 76].
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 33/312 (10.5769%)
___Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3795, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 320/1340 (23.8806%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 555/1340 (41.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.5508, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   1, Avg loss: 0.0620, Accuracy: 245/1131 (21.6622%)
___Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 481/1131 (42.5287%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.3842, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 329/896 (36.7188%)
___Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 459/896 (51.2277%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.1869, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   1, Avg loss: 0.0602, Accuracy: 255/1513 (16.8539%)
___Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 506/1513 (33.4435%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.2914, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   1, Avg loss: 0.0568, Accuracy: 369/1581 (23.3397%)
___Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 610/1581 (38.5832%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.9504, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   1, Avg loss: 0.0714, Accuracy: 98/631 (15.5309%)
___Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   2, Avg loss: 0.0414, Accuracy: 206/631 (32.6466%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7972, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0693, Accuracy: 135/568 (23.7676%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0411, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7175, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   1, Avg loss: 0.0646, Accuracy: 266/708 (37.5706%)
___Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   2, Avg loss: 0.0363, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.8905, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0865, Accuracy: 41/466 (8.7983%)
___Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0492, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.6090, Accuracy: 50/10000 (0.5000%)
time spent on training: 112.71543216705322
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 1340, 1131, 896, 1513, 1581, 631, 568, 708, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3164, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6215, Accuracy: 0/9950 (0.0000%)
saving model
Done in 351.711537361145 sec.
Server Epoch:5 choose agents : [73, 49, 66, 2, 62, 24, 56, 25, 10, 97].
___Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   1, Avg loss: 0.0658, Accuracy: 170/938 (18.1237%)
___Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 310/938 (33.0490%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.0911, Accuracy: 52/10000 (0.5200%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   1, Avg loss: 0.0813, Accuracy: 15/440 (3.4091%)
___Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   2, Avg loss: 0.0488, Accuracy: 153/440 (34.7727%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.4832, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 254/1402 (18.1170%)
___Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 372/1402 (26.5335%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.2013, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0629, Accuracy: 231/605 (38.1818%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.8386, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0693, Accuracy: 139/568 (24.4718%)
___Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0414, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7315, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   1, Avg loss: 0.0771, Accuracy: 26/312 (8.3333%)
___Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 169/312 (54.1667%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3821, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0679, Accuracy: 60/186 (32.2581%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3124, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   1, Avg loss: 0.0586, Accuracy: 299/690 (43.3333%)
___Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   2, Avg loss: 0.0270, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.2540, Accuracy: 55/10000 (0.5500%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 199/861 (23.1127%)
___Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 433/861 (50.2904%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6499, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0531, Accuracy: 360/1213 (29.6785%)
___Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 483/1213 (39.8186%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5816, Accuracy: 79/10000 (0.7900%)
time spent on training: 141.61352825164795
[foolsgold agg] training data poison_ratio: 0.27595287595287593  data num: [938, 440, 1402, 605, 568, 312, 186, 690, 861, 1213]
[foolsgold agg] considering poison per batch poison_fraction: 0.08623527373527373
[foolsgold agg] wv: [1.         0.98221666 1.         1.         1.         0.98221666
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3163, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.6198, Accuracy: 0/9950 (0.0000%)
saving model
Done in 362.6617200374603 sec.
Server Epoch:6 choose agents : [50, 99, 30, 37, 67, 0, 63, 39, 52, 44].
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0633, Accuracy: 160/809 (19.7775%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0279, Accuracy: 367/809 (45.3646%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.0602, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   1, Avg loss: 0.0667, Accuracy: 170/773 (21.9922%)
___Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   2, Avg loss: 0.0329, Accuracy: 400/773 (51.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.9795, Accuracy: 52/10000 (0.5200%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   1, Avg loss: 0.0812, Accuracy: 68/486 (13.9918%)
___Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   2, Avg loss: 0.0419, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.7587, Accuracy: 46/10000 (0.4600%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   1, Avg loss: 0.0523, Accuracy: 396/1129 (35.0753%)
___Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   2, Avg loss: 0.0248, Accuracy: 739/1129 (65.4562%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5865, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   1, Avg loss: 0.0792, Accuracy: 41/426 (9.6244%)
___Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   2, Avg loss: 0.0435, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.5877, Accuracy: 51/10000 (0.5100%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 355/1657 (21.4243%)
___Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 493/1657 (29.7526%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6957, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 254/888 (28.6036%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 441/888 (49.6622%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.4516, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   1, Avg loss: 0.0546, Accuracy: 307/1013 (30.3060%)
___Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 451/1013 (44.5212%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5045, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0569, Accuracy: 275/636 (43.2390%)
___Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0316, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.1794, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0601, Accuracy: 389/1750 (22.2286%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 634/1750 (36.2286%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.6098, Accuracy: 114/10000 (1.1400%)
time spent on training: 173.34763526916504
[foolsgold agg] training data poison_ratio: 0.5249294449670743  data num: [809, 773, 486, 1129, 426, 1657, 888, 1013, 636, 1750]
[foolsgold agg] considering poison per batch poison_fraction: 0.1640404515522107
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3162, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.6195, Accuracy: 0/9950 (0.0000%)
saving model
Done in 408.0747580528259 sec.
Server Epoch:7 choose agents : [66, 72, 39, 28, 82, 63, 93, 98, 12, 10].
___Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 268/1402 (19.1155%)
___Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 394/1402 (28.1027%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.1780, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   1, Avg loss: 0.0633, Accuracy: 231/1241 (18.6140%)
___Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 405/1241 (32.6350%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.8971, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   1, Avg loss: 0.0539, Accuracy: 316/1013 (31.1945%)
___Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 511/1013 (50.4442%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7830, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   1, Avg loss: 0.0566, Accuracy: 385/1581 (24.3517%)
___Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 583/1581 (36.8754%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.5421, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0774, Accuracy: 60/500 (12.0000%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 167/500 (33.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6461, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   1, Avg loss: 0.0548, Accuracy: 249/888 (28.0405%)
___Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 458/888 (51.5766%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.9567, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 426/1742 (24.4546%)
___Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 706/1742 (40.5281%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.9693, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   1, Avg loss: 0.0825, Accuracy: 15/373 (4.0214%)
___Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   2, Avg loss: 0.0486, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.4376, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   1, Avg loss: 0.0878, Accuracy: 17/338 (5.0296%)
___Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   2, Avg loss: 0.0470, Accuracy: 141/338 (41.7160%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.4412, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0580, Accuracy: 203/861 (23.5772%)
___Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0220, Accuracy: 437/861 (50.7549%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7070, Accuracy: 50/10000 (0.5000%)
time spent on training: 147.29791927337646
[foolsgold agg] training data poison_ratio: 0.08662843344400845  data num: [1402, 1241, 1013, 1581, 500, 888, 1742, 373, 338, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.02707138545125264
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3161, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.6192, Accuracy: 0/9950 (0.0000%)
saving model
Done in 373.6562659740448 sec.
Server Epoch:8 choose agents : [77, 28, 16, 1, 70, 34, 54, 21, 14, 75].
___Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   1, Avg loss: 0.0534, Accuracy: 335/1340 (25.0000%)
___Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 590/1340 (44.0299%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.0060, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 366/1581 (23.1499%)
___Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0345, Accuracy: 533/1581 (33.7128%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.8926, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0623, Accuracy: 271/708 (38.2768%)
___Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0389, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.8420, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0568, Accuracy: 286/928 (30.8190%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0246, Accuracy: 533/928 (57.4353%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.9894, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 353/1418 (24.8942%)
___Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 654/1418 (46.1213%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.8427, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   1, Avg loss: 0.0578, Accuracy: 386/1427 (27.0498%)
___Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 592/1427 (41.4856%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.9275, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   1, Avg loss: 0.0558, Accuracy: 337/1130 (29.8230%)
___Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   2, Avg loss: 0.0294, Accuracy: 451/1130 (39.9115%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.3552, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0542, Accuracy: 378/1949 (19.3946%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0336, Accuracy: 591/1949 (30.3232%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.3950, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0623, Accuracy: 223/1013 (22.0138%)
___Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 323/1013 (31.8855%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.5579, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   1, Avg loss: 0.0666, Accuracy: 240/776 (30.9278%)
___Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   2, Avg loss: 0.0290, Accuracy: 399/776 (51.4175%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.8082, Accuracy: 50/10000 (0.5000%)
time spent on training: 124.9232919216156
[foolsgold agg] training data poison_ratio: 0.0  data num: [1340, 1581, 708, 928, 1418, 1427, 1130, 1949, 1013, 776]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3159, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.6184, Accuracy: 0/9950 (0.0000%)
saving model
Done in 347.6016523838043 sec.
Server Epoch:9 choose agents : [45, 99, 72, 16, 74, 61, 62, 90, 43, 25].
___Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   1, Avg loss: 0.0677, Accuracy: 190/669 (28.4006%)
___Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   2, Avg loss: 0.0413, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.8044, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0679, Accuracy: 176/773 (22.7684%)
___Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0330, Accuracy: 402/773 (52.0052%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.1716, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   1, Avg loss: 0.0623, Accuracy: 235/1241 (18.9363%)
___Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 426/1241 (34.3272%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.1216, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   1, Avg loss: 0.0613, Accuracy: 281/708 (39.6893%)
___Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   2, Avg loss: 0.0400, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.7665, Accuracy: 57/10000 (0.5700%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   1, Avg loss: 0.0438, Accuracy: 432/1552 (27.8351%)
___Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   2, Avg loss: 0.0215, Accuracy: 748/1552 (48.1959%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 9.9728, Accuracy: 85/10000 (0.8500%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1165, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3044, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   1, Avg loss: 0.0691, Accuracy: 145/568 (25.5282%)
___Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   2, Avg loss: 0.0414, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.8099, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0569, Accuracy: 318/677 (46.9719%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0235, Accuracy: 447/677 (66.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.1576, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 304/946 (32.1353%)
___Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 330/946 (34.8837%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.1040, Accuracy: 51/10000 (0.5100%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 301/690 (43.6232%)
___Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.4438, Accuracy: 61/10000 (0.6100%)
time spent on training: 150.1450388431549
[foolsgold agg] training data poison_ratio: 0.2942217726640536  data num: [669, 773, 1241, 708, 1552, 85, 568, 677, 946, 690]
[foolsgold agg] considering poison per batch poison_fraction: 0.09194430395751674
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3158, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.6181, Accuracy: 0/9950 (0.0000%)
saving model
Done in 375.2556767463684 sec.
Server Epoch:10 choose agents : [84, 18, 67, 52, 95, 36, 68, 49, 61, 7].
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0635, Accuracy: 313/1190 (26.3025%)
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 474/1190 (39.8319%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.1546, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   1, Avg loss: 0.0760, Accuracy: 110/530 (20.7547%)
___Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   2, Avg loss: 0.0398, Accuracy: 264/530 (49.8113%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.9825, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   1, Avg loss: 0.0788, Accuracy: 47/426 (11.0329%)
___Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   2, Avg loss: 0.0436, Accuracy: 171/426 (40.1408%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.5591, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   1, Avg loss: 0.0574, Accuracy: 274/636 (43.0818%)
___Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.1186, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0507, Accuracy: 331/599 (55.2588%)
___Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0325, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6299, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   1, Avg loss: 0.0877, Accuracy: 68/408 (16.6667%)
___Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   2, Avg loss: 0.0554, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.4730, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   1, Avg loss: 0.0622, Accuracy: 368/1163 (31.6423%)
___Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   2, Avg loss: 0.0371, Accuracy: 427/1163 (36.7154%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.5527, Accuracy: 62/10000 (0.6200%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   1, Avg loss: 0.0810, Accuracy: 13/440 (2.9545%)
___Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   2, Avg loss: 0.0489, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.4831, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1256, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1155, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3046, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   1, Avg loss: 0.0535, Accuracy: 349/891 (39.1695%)
___Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   2, Avg loss: 0.0263, Accuracy: 460/891 (51.6274%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.1329, Accuracy: 50/10000 (0.5000%)
time spent on training: 144.9191608428955
[foolsgold agg] training data poison_ratio: 0.1765075376884422  data num: [1190, 530, 426, 636, 599, 408, 1163, 440, 85, 891]
[foolsgold agg] considering poison per batch poison_fraction: 0.05515860552763819
[foolsgold agg] wv: [1.        0.9672098 0.9672098 1.        1.        1.        1.
 1.        1.        1.       ]
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3157, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.6185, Accuracy: 0/9950 (0.0000%)
saving model
Done in 379.68786430358887 sec.
Server Epoch:11 choose agents : [29, 92, 35, 7, 25, 14, 74, 13, 32, 17].
___Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 415/1440 (28.8194%)
___Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 685/1440 (47.5694%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6056, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 459/1715 (26.7638%)
___Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 730/1715 (42.5656%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.4593, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   1, Avg loss: 0.0855, Accuracy: 34/271 (12.5461%)
___Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   2, Avg loss: 0.0560, Accuracy: 99/271 (36.5314%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3640, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 339/891 (38.0471%)
___Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 453/891 (50.8418%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.8868, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0562, Accuracy: 305/690 (44.2029%)
___Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.5302, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0626, Accuracy: 219/1013 (21.6190%)
___Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 298/1013 (29.4176%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.6611, Accuracy: 56/10000 (0.5600%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 469/1552 (30.2191%)
___Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 777/1552 (50.0644%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 10.1996, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0577, Accuracy: 339/1645 (20.6079%)
___Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 629/1645 (38.2371%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6804, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0608, Accuracy: 207/735 (28.1633%)
___Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 341/735 (46.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.9290, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 413/1574 (26.2389%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 684/1574 (43.4562%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.2833, Accuracy: 86/10000 (0.8600%)
time spent on training: 155.99169826507568
[foolsgold agg] training data poison_ratio: 0.19451674475099776  data num: [1440, 1715, 271, 891, 690, 1013, 1552, 1645, 735, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.0607864827346868
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3155, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.6147, Accuracy: 0/9950 (0.0000%)
saving model
Done in 378.04950499534607 sec.
Server Epoch:12 choose agents : [43, 94, 30, 38, 40, 20, 75, 61, 26, 17].
___Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   1, Avg loss: 0.0613, Accuracy: 304/946 (32.1353%)
___Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 355/946 (37.5264%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.0289, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 342/1662 (20.5776%)
___Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 589/1662 (35.4392%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.5666, Accuracy: 98/10000 (0.9800%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0809, Accuracy: 64/486 (13.1687%)
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0412, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.8112, Accuracy: 39/10000 (0.3900%)
___Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   1, Avg loss: 0.0617, Accuracy: 252/1131 (22.2812%)
___Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 490/1131 (43.3245%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.1635, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   1, Avg loss: 0.0548, Accuracy: 342/1573 (21.7419%)
___Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 551/1573 (35.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.2813, Accuracy: 61/10000 (0.6100%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 350/807 (43.3705%)
___Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   2, Avg loss: 0.0328, Accuracy: 409/807 (50.6815%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.7998, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   1, Avg loss: 0.0652, Accuracy: 239/776 (30.7990%)
___Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   2, Avg loss: 0.0311, Accuracy: 379/776 (48.8402%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.1341, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   1, Avg loss: 0.1252, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   2, Avg loss: 0.1174, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3044, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 340/1446 (23.5131%)
___Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   2, Avg loss: 0.0350, Accuracy: 461/1446 (31.8811%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.2992, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 407/1574 (25.8577%)
___Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 667/1574 (42.3761%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.1805, Accuracy: 86/10000 (0.8600%)
time spent on training: 152.32928085327148
[foolsgold agg] training data poison_ratio: 0.1314133129887469  data num: [946, 1662, 486, 1131, 1573, 807, 776, 85, 1446, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.041066660308983406
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3155, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.6146, Accuracy: 0/9950 (0.0000%)
saving model
Done in 375.42612075805664 sec.
Server Epoch:13 choose agents : [42, 89, 83, 18, 67, 8, 21, 60, 56, 28].
___Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 355/1372 (25.8746%)
___Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 525/1372 (38.2653%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.8440, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   1, Avg loss: 0.0608, Accuracy: 319/896 (35.6027%)
___Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   2, Avg loss: 0.0340, Accuracy: 443/896 (49.4420%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.2580, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 448/1953 (22.9391%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 787/1953 (40.2970%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.0072, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0762, Accuracy: 117/530 (22.0755%)
___Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0397, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.9270, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   1, Avg loss: 0.0787, Accuracy: 43/426 (10.0939%)
___Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   2, Avg loss: 0.0421, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.5463, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   1, Avg loss: 0.0606, Accuracy: 209/1513 (13.8136%)
___Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 457/1513 (30.2049%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.4688, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   1, Avg loss: 0.0544, Accuracy: 384/1949 (19.7024%)
___Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 644/1949 (33.0426%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.0757, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 553/2227 (24.8316%)
___Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 1014/2227 (45.5321%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.3269, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0829, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 61/186 (32.7957%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3120, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 399/1581 (25.2372%)
___Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 575/1581 (36.3694%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.7287, Accuracy: 82/10000 (0.8200%)
time spent on training: 166.6442883014679
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 896, 1953, 530, 426, 1513, 1949, 2227, 186, 1581]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.95309139 0.95309139 1.
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3154, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.6128, Accuracy: 0/9950 (0.0000%)
saving model
Done in 393.5635163784027 sec.
Server Epoch:14 choose agents : [82, 77, 78, 73, 40, 83, 97, 72, 98, 61].
___Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0772, Accuracy: 52/500 (10.4000%)
___Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.6426, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 324/1340 (24.1791%)
___Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   2, Avg loss: 0.0273, Accuracy: 560/1340 (41.7910%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.6551, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   1, Avg loss: 0.0837, Accuracy: 35/416 (8.4135%)
___Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   2, Avg loss: 0.0472, Accuracy: 177/416 (42.5481%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.5317, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   1, Avg loss: 0.0660, Accuracy: 170/938 (18.1237%)
___Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 302/938 (32.1962%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.9851, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 357/1573 (22.6955%)
___Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 568/1573 (36.1093%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.4062, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 436/1953 (22.3246%)
___Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 751/1953 (38.4537%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.9436, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   1, Avg loss: 0.0524, Accuracy: 361/1213 (29.7609%)
___Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 479/1213 (39.4889%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.7977, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   1, Avg loss: 0.0621, Accuracy: 256/1241 (20.6285%)
___Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 417/1241 (33.6019%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.2113, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0824, Accuracy: 14/373 (3.7534%)
___Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0490, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.4206, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1246, Accuracy: 1/85 (1.1765%)
___Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3043, Accuracy: 44/10000 (0.4400%)
time spent on training: 147.81935024261475
[foolsgold agg] training data poison_ratio: 0.008824750830564785  data num: [500, 1340, 416, 938, 1573, 1953, 1213, 1241, 373, 85]
[foolsgold agg] considering poison per batch poison_fraction: 0.002757734634551495
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3152, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.6107, Accuracy: 0/9950 (0.0000%)
saving model
Done in 378.1132621765137 sec.
Server Epoch:15 choose agents : [82, 75, 98, 92, 31, 50, 22, 78, 46, 37].
___Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   1, Avg loss: 0.0768, Accuracy: 66/500 (13.2000%)
___Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.5859, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0652, Accuracy: 244/776 (31.4433%)
___Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0277, Accuracy: 432/776 (55.6701%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.9843, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   1, Avg loss: 0.0828, Accuracy: 15/373 (4.0214%)
___Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.4577, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0522, Accuracy: 461/1715 (26.8805%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 709/1715 (41.3411%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.4463, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   1, Avg loss: 0.0820, Accuracy: 59/460 (12.8261%)
___Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   2, Avg loss: 0.0385, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.7240, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 166/809 (20.5192%)
___Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 361/809 (44.6230%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.0434, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 521/1470 (35.4422%)
___Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   2, Avg loss: 0.0242, Accuracy: 815/1470 (55.4422%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.9406, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0840, Accuracy: 33/416 (7.9327%)
___Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0478, Accuracy: 160/416 (38.4615%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.5622, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   1, Avg loss: 0.0555, Accuracy: 410/1904 (21.5336%)
___Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 658/1904 (34.5588%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5157, Accuracy: 99/10000 (0.9900%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0518, Accuracy: 385/1129 (34.1010%)
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0252, Accuracy: 732/1129 (64.8361%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.6481, Accuracy: 104/10000 (1.0400%)
time spent on training: 147.88407254219055
[foolsgold agg] training data poison_ratio: 0.11819514237855946  data num: [500, 776, 373, 1715, 460, 809, 1470, 416, 1904, 1129]
[foolsgold agg] considering poison per batch poison_fraction: 0.03693598199329983
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3151, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.6104, Accuracy: 0/9950 (0.0000%)
saving model
Done in 376.1332960128784 sec.
Server Epoch:16 choose agents : [28, 26, 83, 78, 93, 7, 76, 44, 70, 39].
___Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 380/1581 (24.0354%)
___Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 553/1581 (34.9779%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.8259, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   1, Avg loss: 0.0543, Accuracy: 344/1446 (23.7898%)
___Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 493/1446 (34.0941%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.3326, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 397/1953 (20.3277%)
___Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 733/1953 (37.5320%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.0339, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   1, Avg loss: 0.0834, Accuracy: 41/416 (9.8558%)
___Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   2, Avg loss: 0.0455, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.5916, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 421/1742 (24.1676%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 709/1742 (40.7003%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.8073, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   1, Avg loss: 0.0540, Accuracy: 354/891 (39.7306%)
___Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 455/891 (51.0662%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.8850, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0861, Accuracy: 42/466 (9.0129%)
___Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0488, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.6290, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 366/1750 (20.9143%)
___Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 664/1750 (37.9429%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.6074, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 322/1418 (22.7080%)
___Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 621/1418 (43.7941%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.6254, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   1, Avg loss: 0.0551, Accuracy: 307/1013 (30.3060%)
___Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   2, Avg loss: 0.0262, Accuracy: 453/1013 (44.7187%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.3328, Accuracy: 50/10000 (0.5000%)
time spent on training: 157.7995045185089
[foolsgold agg] training data poison_ratio: 0.1380561691385295  data num: [1581, 1446, 1953, 416, 1742, 891, 466, 1750, 1418, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.04314255285579047
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3149, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.6095, Accuracy: 0/9950 (0.0000%)
saving model
Done in 386.5451612472534 sec.
Server Epoch:17 choose agents : [42, 34, 33, 94, 66, 75, 39, 27, 6, 51].
___Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 366/1372 (26.6764%)
___Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 524/1372 (38.1924%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.6920, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0583, Accuracy: 372/1427 (26.0687%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 574/1427 (40.2242%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.8358, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0790, Accuracy: 62/515 (12.0388%)
___Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0534, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.6782, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 326/1662 (19.6149%)
___Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   2, Avg loss: 0.0336, Accuracy: 597/1662 (35.9206%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.0142, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   1, Avg loss: 0.0629, Accuracy: 247/1402 (17.6177%)
___Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   2, Avg loss: 0.0391, Accuracy: 372/1402 (26.5335%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.0545, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   1, Avg loss: 0.0653, Accuracy: 250/776 (32.2165%)
___Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   2, Avg loss: 0.0279, Accuracy: 426/776 (54.8969%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.7543, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   1, Avg loss: 0.0539, Accuracy: 312/1013 (30.7996%)
___Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 506/1013 (49.9506%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.4517, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 431/1587 (27.1582%)
___Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 625/1587 (39.3825%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.0952, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   1, Avg loss: 0.0550, Accuracy: 391/1956 (19.9898%)
___Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 641/1956 (32.7710%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.2202, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   1, Avg loss: 0.0599, Accuracy: 224/1049 (21.3537%)
___Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 500/1049 (47.6644%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.2569, Accuracy: 68/10000 (0.6800%)
time spent on training: 154.85704112052917
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 1427, 515, 1662, 1402, 776, 1013, 1587, 1956, 1049]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3147, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.6089, Accuracy: 0/9950 (0.0000%)
saving model
Done in 375.38556480407715 sec.
Server Epoch:18 choose agents : [90, 5, 3, 28, 2, 9, 92, 60, 86, 34].
___Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0575, Accuracy: 314/677 (46.3811%)
___Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0223, Accuracy: 465/677 (68.6854%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.0237, Accuracy: 55/10000 (0.5500%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   1, Avg loss: 0.0510, Accuracy: 378/1628 (23.2187%)
___Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 792/1628 (48.6486%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.4246, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0752, Accuracy: 103/781 (13.1882%)
___Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 240/781 (30.7298%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.7463, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 401/1581 (25.3637%)
___Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 567/1581 (35.8634%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.6663, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0627, Accuracy: 225/605 (37.1901%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.7535, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0504, Accuracy: 344/1275 (26.9804%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0197, Accuracy: 694/1275 (54.4314%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.9883, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 451/1715 (26.2974%)
___Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 735/1715 (42.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5452, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 568/2227 (25.5052%)
___Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1045/2227 (46.9241%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.4500, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   1, Avg loss: 0.0633, Accuracy: 358/1003 (35.6929%)
___Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   2, Avg loss: 0.0352, Accuracy: 365/1003 (36.3908%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.6592, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 372/1427 (26.0687%)
___Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   2, Avg loss: 0.0328, Accuracy: 591/1427 (41.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.7074, Accuracy: 55/10000 (0.5500%)
time spent on training: 162.46442222595215
[foolsgold agg] training data poison_ratio: 0.12601594550661815  data num: [677, 1628, 781, 1581, 605, 1275, 1715, 2227, 1003, 1427]
[foolsgold agg] considering poison per batch poison_fraction: 0.03937998297081817
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3145, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.6070, Accuracy: 0/9950 (0.0000%)
saving model
Done in 379.5636103153229 sec.
Server Epoch:19 choose agents : [8, 20, 42, 21, 5, 25, 24, 71, 13, 18].
___Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   1, Avg loss: 0.0602, Accuracy: 231/1513 (15.2677%)
___Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 481/1513 (31.7911%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.8527, Accuracy: 93/10000 (0.9300%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0577, Accuracy: 339/807 (42.0074%)
___Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0324, Accuracy: 410/807 (50.8055%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.8897, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 335/1372 (24.4169%)
___Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   2, Avg loss: 0.0314, Accuracy: 497/1372 (36.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.7649, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 422/1949 (21.6521%)
___Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 630/1949 (32.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.6579, Accuracy: 97/10000 (0.9700%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   1, Avg loss: 0.0516, Accuracy: 356/1628 (21.8673%)
___Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 807/1628 (49.5700%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.7846, Accuracy: 125/10000 (1.2500%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   1, Avg loss: 0.0575, Accuracy: 297/690 (43.0435%)
___Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.2577, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   1, Avg loss: 0.0766, Accuracy: 26/312 (8.3333%)
___Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   2, Avg loss: 0.0395, Accuracy: 171/312 (54.8077%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3931, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   1, Avg loss: 0.0654, Accuracy: 136/818 (16.6259%)
___Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 352/818 (43.0318%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.9517, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   1, Avg loss: 0.0576, Accuracy: 315/1645 (19.1489%)
___Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 644/1645 (39.1489%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.7416, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0766, Accuracy: 113/530 (21.3208%)
___Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0391, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.8916, Accuracy: 62/10000 (0.6200%)
time spent on training: 204.38207268714905
[foolsgold agg] training data poison_ratio: 0.2774325284090909  data num: [1513, 807, 1372, 1949, 1628, 690, 312, 818, 1645, 530]
[foolsgold agg] considering poison per batch poison_fraction: 0.0866976651278409
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3143, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.6058, Accuracy: 0/9950 (0.0000%)
saving model
Done in 424.05069160461426 sec.
Server Epoch:20 choose agents : [89, 17, 66, 8, 76, 59, 83, 62, 70, 12].
___Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   1, Avg loss: 0.0603, Accuracy: 331/896 (36.9420%)
___Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   2, Avg loss: 0.0331, Accuracy: 468/896 (52.2321%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.2629, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 390/1574 (24.7776%)
___Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 651/1574 (41.3596%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.9182, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   1, Avg loss: 0.0622, Accuracy: 260/1402 (18.5449%)
___Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 372/1402 (26.5335%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.1278, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   1, Avg loss: 0.0600, Accuracy: 245/1513 (16.1930%)
___Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 484/1513 (31.9894%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.4322, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0860, Accuracy: 40/466 (8.5837%)
___Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.6496, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0535, Accuracy: 312/1089 (28.6501%)
___Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0288, Accuracy: 465/1089 (42.6997%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8731, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   1, Avg loss: 0.0546, Accuracy: 409/1953 (20.9421%)
___Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 701/1953 (35.8935%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.1111, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   1, Avg loss: 0.0695, Accuracy: 130/568 (22.8873%)
___Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   2, Avg loss: 0.0404, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.7020, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 322/1418 (22.7080%)
___Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0315, Accuracy: 590/1418 (41.6079%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.9100, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   1, Avg loss: 0.0877, Accuracy: 18/338 (5.3254%)
___Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   2, Avg loss: 0.0487, Accuracy: 123/338 (36.3905%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.4389, Accuracy: 50/10000 (0.5000%)
time spent on training: 147.49945330619812
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 1574, 1402, 1513, 466, 1089, 1953, 568, 1418, 338]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3141, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.6046, Accuracy: 0/9950 (0.0000%)
saving model
Done in 371.71712017059326 sec.
Server Epoch:21 choose agents : [0, 21, 31, 56, 90, 65, 87, 37, 77, 26].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0577, Accuracy: 378/1657 (22.8123%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0356, Accuracy: 530/1657 (31.9855%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0324, Accuracy: 574/1657 (34.6409%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0321, Accuracy: 588/1657 (35.4858%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0315, Accuracy: 604/1657 (36.4514%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0313, Accuracy: 617/1657 (37.2360%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0306, Accuracy: 633/1657 (38.2016%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0303, Accuracy: 640/1657 (38.6240%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0302, Accuracy: 672/1657 (40.5552%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0300, Accuracy: 662/1657 (39.9517%), train_poison_data_count: 520
Global model norm: 112.05521448710006.
Norm before scaling: 112.02828186444707. Distance: 1.1819704210320845
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7703, Accuracy: 68/10000 (0.6800%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 1.1417, Accuracy: 8460/9950 (85.0251%)
Scaling by  100
Scaled Norm after poisoning: 160.57383061422243, distance: 118.19704317632062
Total norm for 3 adversaries is: 160.57383061422243. distance: 118.19704317632062
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 412/1949 (21.1390%)
___Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 638/1949 (32.7347%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.3638, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   1, Avg loss: 0.0824, Accuracy: 53/460 (11.5217%)
___Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   2, Avg loss: 0.0379, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.7157, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   2, Avg loss: 0.0684, Accuracy: 65/186 (34.9462%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   1, Avg loss: 0.0569, Accuracy: 318/677 (46.9719%)
___Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 449/677 (66.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.2961, Accuracy: 55/10000 (0.5500%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0565, Accuracy: 364/1475 (24.6780%)
___Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0327, Accuracy: 671/1475 (45.4915%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.7879, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   1, Avg loss: 0.0583, Accuracy: 299/1131 (26.4368%)
___Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 414/1131 (36.6048%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.9278, Accuracy: 51/10000 (0.5100%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   1, Avg loss: 0.0526, Accuracy: 406/1129 (35.9610%)
___Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 730/1129 (64.6590%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.2651, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 314/1340 (23.4328%)
___Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 496/1340 (37.0149%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7126, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0555, Accuracy: 311/1446 (21.5076%)
___Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 484/1446 (33.4716%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.2476, Accuracy: 71/10000 (0.7100%)
time spent on training: 292.1692235469818
[foolsgold agg] training data poison_ratio: 0.3721397379912664  data num: [1657, 1949, 460, 186, 677, 1475, 1131, 1129, 1340, 1446]
[foolsgold agg] considering poison per batch poison_fraction: 0.11629366812227074
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3140, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.5994, Accuracy: 0/9950 (0.0000%)
saving model
Done in 518.3845114707947 sec.
Server Epoch:22 choose agents : [13, 26, 58, 22, 88, 2, 65, 9, 90, 64].
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 323/1645 (19.6353%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0333, Accuracy: 596/1645 (36.2310%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.6415, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 340/1446 (23.5131%)
___Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 456/1446 (31.5353%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.0620, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 353/803 (43.9601%)
___Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 394/803 (49.0660%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.9304, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 502/1470 (34.1497%)
___Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 831/1470 (56.5306%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.0195, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   1, Avg loss: 0.0740, Accuracy: 136/603 (22.5539%)
___Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   2, Avg loss: 0.0467, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.8104, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0626, Accuracy: 228/605 (37.6860%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.8709, Accuracy: 52/10000 (0.5200%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   1, Avg loss: 0.0573, Accuracy: 377/1475 (25.5593%)
___Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   2, Avg loss: 0.0319, Accuracy: 656/1475 (44.4746%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.0213, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   1, Avg loss: 0.0500, Accuracy: 350/1275 (27.4510%)
___Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 708/1275 (55.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.3745, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   1, Avg loss: 0.0558, Accuracy: 318/677 (46.9719%)
___Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 464/677 (68.5377%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4296, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   1, Avg loss: 0.0650, Accuracy: 153/953 (16.0546%)
___Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   2, Avg loss: 0.0383, Accuracy: 301/953 (31.5845%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.3921, Accuracy: 71/10000 (0.7100%)
time spent on training: 166.9733099937439
[foolsgold agg] training data poison_ratio: 0.13467859751643535  data num: [1645, 1446, 803, 1470, 603, 605, 1475, 1275, 677, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.04208706172388604
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3138, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.5954, Accuracy: 0/9950 (0.0000%)
saving model
Done in 390.3977313041687 sec.
Server Epoch:23 choose agents : [20, 11, 63, 44, 2, 74, 26, 89, 3, 6].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Average loss: 0.0604, Accuracy: 231/807 (28.6245%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Average loss: 0.0364, Accuracy: 319/807 (39.5291%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Average loss: 0.0303, Accuracy: 359/807 (44.4857%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Average loss: 0.0299, Accuracy: 341/807 (42.2553%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Average loss: 0.0297, Accuracy: 358/807 (44.3618%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Average loss: 0.0276, Accuracy: 379/807 (46.9641%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Average loss: 0.0273, Accuracy: 381/807 (47.2119%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Average loss: 0.0273, Accuracy: 385/807 (47.7076%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Average loss: 0.0266, Accuracy: 383/807 (47.4597%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Average loss: 0.0270, Accuracy: 381/807 (47.2119%), train_poison_data_count: 260
Global model norm: 112.05510554940145.
Norm before scaling: 112.04401949540859. Distance: 0.8409338330628714
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.2947, Accuracy: 79/10000 (0.7900%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.9673, Accuracy: 8519/9950 (85.6181%)
Scaling by  100
Scaled Norm after poisoning: 138.95680674448806, distance: 84.09338129332029
Total norm for 3 adversaries is: 138.95680674448806. distance: 84.09338129332029
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   1, Avg loss: 0.0533, Accuracy: 348/712 (48.8764%)
___Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 424/712 (59.5506%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.4845, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 262/888 (29.5045%)
___Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 444/888 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.2573, Accuracy: 51/10000 (0.5100%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   1, Avg loss: 0.0597, Accuracy: 394/1750 (22.5143%)
___Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 687/1750 (39.2571%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.2296, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0637, Accuracy: 223/605 (36.8595%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.7957, Accuracy: 55/10000 (0.5500%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 494/1552 (31.8299%)
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0205, Accuracy: 801/1552 (51.6108%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.4324, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 336/1446 (23.2365%)
___Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 501/1446 (34.6473%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.0515, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   1, Avg loss: 0.0612, Accuracy: 334/896 (37.2768%)
___Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 435/896 (48.5491%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.2280, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0754, Accuracy: 105/781 (13.4443%)
___Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 223/781 (28.5531%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.7798, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 398/1956 (20.3476%)
___Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 661/1956 (33.7935%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.1973, Accuracy: 120/10000 (1.2000%)
time spent on training: 266.317015171051
[foolsgold agg] training data poison_ratio: 0.3606600544193803  data num: [807, 712, 888, 1750, 605, 1552, 1446, 896, 781, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.11270626700605635
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3136, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.5923, Accuracy: 0/9950 (0.0000%)
saving model
Done in 481.2212588787079 sec.
Server Epoch:24 choose agents : [75, 96, 99, 97, 17, 80, 3, 13, 60, 83].
___Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   1, Avg loss: 0.0627, Accuracy: 247/776 (31.8299%)
___Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   2, Avg loss: 0.0292, Accuracy: 407/776 (52.4485%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.7564, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 45/311 (14.4695%)
___Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3452, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   1, Avg loss: 0.0688, Accuracy: 180/773 (23.2859%)
___Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   2, Avg loss: 0.0325, Accuracy: 422/773 (54.5925%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.8142, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   1, Avg loss: 0.0524, Accuracy: 356/1213 (29.3487%)
___Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 484/1213 (39.9011%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.6314, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 396/1574 (25.1588%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 655/1574 (41.6137%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.9651, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   1, Avg loss: 0.0712, Accuracy: 126/682 (18.4751%)
___Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   2, Avg loss: 0.0380, Accuracy: 249/682 (36.5103%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.2513, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0740, Accuracy: 119/781 (15.2369%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0355, Accuracy: 235/781 (30.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.7928, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 316/1645 (19.2097%)
___Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 621/1645 (37.7508%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.8324, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 602/2227 (27.0319%)
___Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1043/2227 (46.8343%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1920, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0541, Accuracy: 439/1953 (22.4782%)
___Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 787/1953 (40.2970%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1042, Accuracy: 95/10000 (0.9500%)
time spent on training: 200.08585047721863
[foolsgold agg] training data poison_ratio: 0.0  data num: [776, 311, 773, 1213, 1574, 682, 781, 1645, 2227, 1953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3134, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.5899, Accuracy: 0/9950 (0.0000%)
saving model
Done in 422.2110848426819 sec.
Server Epoch:25 choose agents : [74, 18, 82, 53, 32, 64, 95, 19, 44, 38].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Average loss: 0.0482, Accuracy: 371/1552 (23.9046%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Average loss: 0.0246, Accuracy: 624/1552 (40.2062%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Average loss: 0.0228, Accuracy: 667/1552 (42.9768%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Average loss: 0.0222, Accuracy: 743/1552 (47.8737%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Average loss: 0.0218, Accuracy: 765/1552 (49.2912%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Average loss: 0.0212, Accuracy: 767/1552 (49.4201%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Average loss: 0.0203, Accuracy: 840/1552 (54.1237%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Average loss: 0.0202, Accuracy: 854/1552 (55.0258%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Average loss: 0.0203, Accuracy: 858/1552 (55.2835%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Average loss: 0.0199, Accuracy: 870/1552 (56.0567%), train_poison_data_count: 496
Global model norm: 112.05499661159693.
Norm before scaling: 112.03111052989924. Distance: 1.2348947034573492
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.0035, Accuracy: 75/10000 (0.7500%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.9606, Accuracy: 7712/9950 (77.5075%)
Scaling by  100
Scaled Norm after poisoning: 164.6765413811269, distance: 123.489470863157
Total norm for 3 adversaries is: 164.6765413811269. distance: 123.489470863157
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   1, Avg loss: 0.0763, Accuracy: 113/530 (21.3208%)
___Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   2, Avg loss: 0.0374, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.1578, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   1, Avg loss: 0.0766, Accuracy: 65/500 (13.0000%)
___Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   2, Avg loss: 0.0498, Accuracy: 169/500 (33.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.6461, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0500, Accuracy: 282/813 (34.6863%)
___Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 466/813 (57.3186%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.0858, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 210/735 (28.5714%)
___Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 363/735 (49.3878%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8917, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 161/953 (16.8940%)
___Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 309/953 (32.4239%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.3376, Accuracy: 78/10000 (0.7800%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0535, Accuracy: 330/599 (55.0918%)
___Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0277, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.4332, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 406/1036 (39.1892%)
___Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   2, Avg loss: 0.0248, Accuracy: 663/1036 (63.9961%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.8273, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 387/1750 (22.1143%)
___Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 648/1750 (37.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.4171, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   1, Avg loss: 0.0621, Accuracy: 243/1131 (21.4854%)
___Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 511/1131 (45.1813%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.2276, Accuracy: 79/10000 (0.7900%)
time spent on training: 266.79680371284485
[foolsgold agg] training data poison_ratio: 0.40639649963537866  data num: [1552, 530, 500, 813, 735, 953, 599, 1036, 1750, 1131]
[foolsgold agg] considering poison per batch poison_fraction: 0.12699890613605583
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3133, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.5814, Accuracy: 0/9950 (0.0000%)
saving model
Done in 489.23979330062866 sec.
Server Epoch:26 choose agents : [19, 3, 96, 58, 94, 68, 87, 88, 54, 66].
___Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   1, Avg loss: 0.0464, Accuracy: 380/1036 (36.6795%)
___Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 640/1036 (61.7761%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 9.3406, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.0734, Accuracy: 111/781 (14.2125%)
___Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0361, Accuracy: 225/781 (28.8092%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.6513, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 44/311 (14.1479%)
___Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   2, Avg loss: 0.0536, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3447, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   1, Avg loss: 0.0565, Accuracy: 347/803 (43.2130%)
___Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.0030, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 337/1662 (20.2768%)
___Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 603/1662 (36.2816%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.5975, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0625, Accuracy: 370/1163 (31.8143%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0360, Accuracy: 475/1163 (40.8426%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.6362, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.0580, Accuracy: 302/1131 (26.7020%)
___Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 417/1131 (36.8700%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.7706, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   1, Avg loss: 0.0750, Accuracy: 141/603 (23.3831%)
___Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.8044, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 341/1130 (30.1770%)
___Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0280, Accuracy: 475/1130 (42.0354%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.5659, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   1, Avg loss: 0.0618, Accuracy: 264/1402 (18.8302%)
___Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 386/1402 (27.5321%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.9726, Accuracy: 72/10000 (0.7200%)
time spent on training: 175.15983152389526
[foolsgold agg] training data poison_ratio: 0.0  data num: [1036, 781, 311, 803, 1662, 1163, 1131, 603, 1130, 1402]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3133, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.5818, Accuracy: 0/9950 (0.0000%)
saving model
Done in 393.42848777770996 sec.
Server Epoch:27 choose agents : [95, 51, 93, 9, 60, 99, 31, 17, 49, 65].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Average loss: 0.0652, Accuracy: 183/599 (30.5509%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Average loss: 0.0272, Accuracy: 303/599 (50.5843%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Average loss: 0.0264, Accuracy: 305/599 (50.9182%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Average loss: 0.0245, Accuracy: 346/599 (57.7629%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Average loss: 0.0260, Accuracy: 337/599 (56.2604%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Average loss: 0.0240, Accuracy: 344/599 (57.4290%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Average loss: 0.0235, Accuracy: 370/599 (61.7696%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Average loss: 0.0223, Accuracy: 372/599 (62.1035%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Average loss: 0.0217, Accuracy: 379/599 (63.2721%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Average loss: 0.0211, Accuracy: 386/599 (64.4407%), train_poison_data_count: 200
Global model norm: 112.05487460113014.
Norm before scaling: 112.04716152696595. Distance: 0.7777534823558886
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.3765, Accuracy: 49/10000 (0.4900%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.6934, Accuracy: 5859/9950 (58.8844%)
Scaling by  100
Scaled Norm after poisoning: 135.54195326078934, distance: 77.77534567284964
Total norm for 3 adversaries is: 135.54195326078934. distance: 77.77534567284964
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0600, Accuracy: 227/1049 (21.6397%)
___Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0306, Accuracy: 506/1049 (48.2364%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.4551, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 420/1742 (24.1102%)
___Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 729/1742 (41.8485%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.6311, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Avg loss: 0.0499, Accuracy: 364/1275 (28.5490%)
___Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Avg loss: 0.0192, Accuracy: 731/1275 (57.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.3015, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 581/2227 (26.0889%)
___Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   2, Avg loss: 0.0283, Accuracy: 1015/2227 (45.5770%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.1681, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.0684, Accuracy: 188/773 (24.3208%)
___Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0290, Accuracy: 391/773 (50.5821%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.0984, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   1, Avg loss: 0.0820, Accuracy: 57/460 (12.3913%)
___Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   2, Avg loss: 0.0373, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.7517, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 387/1574 (24.5870%)
___Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 696/1574 (44.2186%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.1719, Accuracy: 101/10000 (1.0100%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   1, Avg loss: 0.0801, Accuracy: 23/440 (5.2273%)
___Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   2, Avg loss: 0.0484, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.4880, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   1, Avg loss: 0.0549, Accuracy: 400/1475 (27.1186%)
___Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   2, Avg loss: 0.0328, Accuracy: 650/1475 (44.0678%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.9219, Accuracy: 95/10000 (0.9500%)
time spent on training: 286.5848066806793
[foolsgold agg] training data poison_ratio: 0.2164628896159807  data num: [599, 1049, 1742, 1275, 2227, 773, 460, 1574, 440, 1475]
[foolsgold agg] considering poison per batch poison_fraction: 0.06764465300499398
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3131, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.5797, Accuracy: 0/9950 (0.0000%)
saving model
Done in 506.22940945625305 sec.
Server Epoch:28 choose agents : [51, 19, 66, 24, 25, 80, 58, 15, 0, 90].
___Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   1, Avg loss: 0.0601, Accuracy: 231/1049 (22.0210%)
___Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   2, Avg loss: 0.0301, Accuracy: 524/1049 (49.9523%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.6504, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   1, Avg loss: 0.0479, Accuracy: 385/1036 (37.1622%)
___Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   2, Avg loss: 0.0242, Accuracy: 675/1036 (65.1544%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.0516, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   1, Avg loss: 0.0615, Accuracy: 257/1402 (18.3310%)
___Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 368/1402 (26.2482%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.1903, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   1, Avg loss: 0.0764, Accuracy: 38/312 (12.1795%)
___Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   2, Avg loss: 0.0408, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3799, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 298/690 (43.1884%)
___Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   2, Avg loss: 0.0276, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.3414, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   1, Avg loss: 0.0701, Accuracy: 140/682 (20.5279%)
___Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   2, Avg loss: 0.0381, Accuracy: 246/682 (36.0704%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.1547, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 353/803 (43.9601%)
___Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   2, Avg loss: 0.0347, Accuracy: 370/803 (46.0772%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.9569, Accuracy: 49/10000 (0.4900%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   1, Avg loss: 0.0584, Accuracy: 316/1154 (27.3830%)
___Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   2, Avg loss: 0.0306, Accuracy: 378/1154 (32.7556%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9631, Accuracy: 51/10000 (0.5100%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   1, Avg loss: 0.0577, Accuracy: 377/1657 (22.7520%)
___Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 539/1657 (32.5287%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.7899, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   1, Avg loss: 0.0580, Accuracy: 313/677 (46.2334%)
___Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 440/677 (64.9926%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.0982, Accuracy: 53/10000 (0.5300%)
time spent on training: 182.3479721546173
[foolsgold agg] training data poison_ratio: 0.37000634115409003  data num: [1049, 1036, 1402, 312, 690, 682, 803, 1154, 1657, 677]
[foolsgold agg] considering poison per batch poison_fraction: 0.11562698161065313
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3130, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.5793, Accuracy: 0/9950 (0.0000%)
saving model
Done in 405.5084044933319 sec.
Server Epoch:29 choose agents : [5, 8, 98, 14, 70, 64, 74, 49, 75, 78].
poison local model 5 index 4 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   1, Average loss: 0.0532, Accuracy: 384/1628 (23.5872%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   2, Average loss: 0.0282, Accuracy: 636/1628 (39.0663%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   3, Average loss: 0.0264, Accuracy: 723/1628 (44.4103%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   4, Average loss: 0.0251, Accuracy: 848/1628 (52.0885%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   5, Average loss: 0.0243, Accuracy: 885/1628 (54.3612%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   6, Average loss: 0.0234, Accuracy: 924/1628 (56.7568%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   7, Average loss: 0.0224, Accuracy: 982/1628 (60.3194%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   8, Average loss: 0.0209, Accuracy: 1012/1628 (62.1622%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   9, Average loss: 0.0213, Accuracy: 1035/1628 (63.5749%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch  10, Average loss: 0.0210, Accuracy: 1048/1628 (64.3735%), train_poison_data_count: 520
Global model norm: 112.0547656631011.
Norm before scaling: 112.02908819392623. Distance: 1.2443414403278497
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.5497, Accuracy: 131/10000 (1.3100%)
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: 0.8217, Accuracy: 9157/9950 (92.0302%)
Scaling by  100
Scaled Norm after poisoning: 165.25725092828756, distance: 124.43414108977487
Total norm for 3 adversaries is: 165.25725092828756. distance: 124.43414108977487
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   1, Avg loss: 0.0600, Accuracy: 230/1513 (15.2016%)
___Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   2, Avg loss: 0.0373, Accuracy: 420/1513 (27.7594%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.3682, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   1, Avg loss: 0.0823, Accuracy: 13/373 (3.4853%)
___Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.4378, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 224/1013 (22.1125%)
___Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 337/1013 (33.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.6776, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 367/1418 (25.8815%)
___Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 645/1418 (45.4866%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.4677, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 176/953 (18.4680%)
___Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 309/953 (32.4239%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.4456, Accuracy: 70/10000 (0.7000%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 497/1552 (32.0232%)
___Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 750/1552 (48.3247%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 10.4618, Accuracy: 89/10000 (0.8900%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   1, Avg loss: 0.0799, Accuracy: 17/440 (3.8636%)
___Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   2, Avg loss: 0.0489, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.4975, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   1, Avg loss: 0.0649, Accuracy: 243/776 (31.3144%)
___Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   2, Avg loss: 0.0275, Accuracy: 430/776 (55.4124%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.7604, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.0837, Accuracy: 32/416 (7.6923%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.5450, Accuracy: 50/10000 (0.5000%)
time spent on training: 328.85416769981384
[foolsgold agg] training data poison_ratio: 0.3590557429081531  data num: [1628, 1513, 373, 1013, 1418, 953, 1552, 440, 776, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.11220491965879785
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3129, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.5745, Accuracy: 0/9950 (0.0000%)
saving model
Done in 548.5132648944855 sec.
Server Epoch:30 choose agents : [72, 69, 82, 58, 15, 79, 52, 28, 1, 17].
___Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   1, Avg loss: 0.0613, Accuracy: 278/1241 (22.4013%)
___Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   2, Avg loss: 0.0361, Accuracy: 425/1241 (34.2466%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.1578, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0572, Accuracy: 282/590 (47.7966%)
___Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0315, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.8964, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   1, Avg loss: 0.0764, Accuracy: 66/500 (13.2000%)
___Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.6209, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   1, Avg loss: 0.0558, Accuracy: 350/803 (43.5866%)
___Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   2, Avg loss: 0.0346, Accuracy: 399/803 (49.6887%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.9582, Accuracy: 60/10000 (0.6000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 324/1154 (28.0763%)
___Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0301, Accuracy: 375/1154 (32.4957%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.6198, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   1, Avg loss: 0.1031, Accuracy: 13/197 (6.5990%)
___Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   2, Avg loss: 0.0858, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3195, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.0565, Accuracy: 277/636 (43.5535%)
___Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.3041, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   1, Avg loss: 0.0570, Accuracy: 355/1581 (22.4541%)
___Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 587/1581 (37.1284%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.6006, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0579, Accuracy: 279/928 (30.0647%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 568/928 (61.2069%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.6301, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 403/1574 (25.6036%)
___Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 645/1574 (40.9784%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.2805, Accuracy: 97/10000 (0.9700%)
time spent on training: 159.37979578971863
[foolsgold agg] training data poison_ratio: 0.12538026944806605  data num: [1241, 590, 500, 803, 1154, 197, 636, 1581, 928, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.03918133420252064
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3129, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.5744, Accuracy: 0/9950 (0.0000%)
saving model
Done in 380.5906400680542 sec.
Server Epoch:31 choose agents : [10, 79, 5, 85, 82, 35, 38, 44, 1, 72].
poison local model 10 index 5 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   1, Average loss: 0.0614, Accuracy: 179/861 (20.7898%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   2, Average loss: 0.0281, Accuracy: 310/861 (36.0046%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   3, Average loss: 0.0231, Accuracy: 394/861 (45.7607%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   4, Average loss: 0.0230, Accuracy: 374/861 (43.4379%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   5, Average loss: 0.0223, Accuracy: 366/861 (42.5087%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   6, Average loss: 0.0222, Accuracy: 405/861 (47.0383%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   7, Average loss: 0.0219, Accuracy: 419/861 (48.6643%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   8, Average loss: 0.0216, Accuracy: 410/861 (47.6190%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   9, Average loss: 0.0217, Accuracy: 424/861 (49.2451%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch  10, Average loss: 0.0207, Accuracy: 439/861 (50.9872%), train_poison_data_count: 280
Global model norm: 112.05466544002084.
Norm before scaling: 112.04457731049504. Distance: 1.028396820960812
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.1188, Accuracy: 91/10000 (0.9100%)
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: 0.9664, Accuracy: 8605/9950 (86.4824%)
Scaling by  100
Scaled Norm after poisoning: 150.99920451984175, distance: 102.83967630947454
Total norm for 4 adversaries is: 150.99920451984175. distance: 102.83967630947454
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   1, Avg loss: 0.1041, Accuracy: 12/197 (6.0914%)
___Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   2, Avg loss: 0.0861, Accuracy: 58/197 (29.4416%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3197, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   1, Avg loss: 0.0508, Accuracy: 405/1628 (24.8771%)
___Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 787/1628 (48.3415%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.0068, Accuracy: 118/10000 (1.1800%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 436/1988 (21.9316%)
___Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   2, Avg loss: 0.0350, Accuracy: 690/1988 (34.7082%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.9302, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   1, Avg loss: 0.0764, Accuracy: 70/500 (14.0000%)
___Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.6360, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   1, Avg loss: 0.0851, Accuracy: 37/271 (13.6531%)
___Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   2, Avg loss: 0.0554, Accuracy: 101/271 (37.2694%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3687, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   1, Avg loss: 0.0616, Accuracy: 249/1131 (22.0159%)
___Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   2, Avg loss: 0.0300, Accuracy: 523/1131 (46.2423%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.3531, Accuracy: 85/10000 (0.8500%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 380/1750 (21.7143%)
___Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 667/1750 (38.1143%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.7321, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0568, Accuracy: 293/928 (31.5733%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0234, Accuracy: 566/928 (60.9914%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5854, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 240/1241 (19.3392%)
___Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 390/1241 (31.4263%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.1823, Accuracy: 62/10000 (0.6200%)
time spent on training: 309.1054005622864
[foolsgold agg] training data poison_ratio: 0.5933301572177228  data num: [861, 197, 1628, 1988, 500, 271, 1131, 1750, 928, 1241]
[foolsgold agg] considering poison per batch poison_fraction: 0.18541567413053836
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3127, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.5689, Accuracy: 0/9950 (0.0000%)
saving model
Done in 526.2930765151978 sec.
Server Epoch:32 choose agents : [72, 26, 61, 80, 49, 36, 32, 54, 23, 85].
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 272/1241 (21.9178%)
___Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 406/1241 (32.7156%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.1393, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 341/1446 (23.5823%)
___Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 478/1446 (33.0567%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.4008, Accuracy: 65/10000 (0.6500%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   1, Avg loss: 0.1254, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   2, Avg loss: 0.1164, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3038, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0711, Accuracy: 142/682 (20.8211%)
___Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 248/682 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.2568, Accuracy: 51/10000 (0.5100%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.0797, Accuracy: 25/440 (5.6818%)
___Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0483, Accuracy: 155/440 (35.2273%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.5005, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   1, Avg loss: 0.0864, Accuracy: 75/408 (18.3824%)
___Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   2, Avg loss: 0.0551, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.5028, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0604, Accuracy: 199/735 (27.0748%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 348/735 (47.3469%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.8410, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 345/1130 (30.5310%)
___Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 474/1130 (41.9469%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.7589, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.0601, Accuracy: 322/715 (45.0350%)
___Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0398, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.7419, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 450/1988 (22.6358%)
___Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0347, Accuracy: 690/1988 (34.7082%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.0035, Accuracy: 79/10000 (0.7900%)
time spent on training: 199.9273111820221
[foolsgold agg] training data poison_ratio: 0.28331454340473505  data num: [1241, 1446, 85, 682, 440, 408, 735, 1130, 715, 1988]
[foolsgold agg] considering poison per batch poison_fraction: 0.0885357948139797
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3126, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.5652, Accuracy: 0/9950 (0.0000%)
saving model
Done in 418.7956163883209 sec.
Server Epoch:33 choose agents : [15, 99, 11, 32, 10, 94, 70, 58, 16, 93].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Average loss: 0.0579, Accuracy: 247/1154 (21.4038%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Average loss: 0.0316, Accuracy: 369/1154 (31.9757%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Average loss: 0.0286, Accuracy: 371/1154 (32.1490%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Average loss: 0.0273, Accuracy: 412/1154 (35.7019%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Average loss: 0.0267, Accuracy: 453/1154 (39.2548%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Average loss: 0.0271, Accuracy: 468/1154 (40.5546%), train_poison_data_count: 362
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Average loss: 0.0261, Accuracy: 485/1154 (42.0277%), train_poison_data_count: 362
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Average loss: 0.0261, Accuracy: 476/1154 (41.2478%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Average loss: 0.0258, Accuracy: 491/1154 (42.5477%), train_poison_data_count: 362
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Average loss: 0.0254, Accuracy: 505/1154 (43.7608%), train_poison_data_count: 362
Global model norm: 112.05456085931978.
Norm before scaling: 112.03729934853169. Distance: 1.0964874887235359
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.8557, Accuracy: 72/10000 (0.7200%)
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: 0.8753, Accuracy: 8398/9950 (84.4020%)
Scaling by  100
Scaled Norm after poisoning: 155.15286690672204, distance: 109.64874226222342
Total norm for 2 adversaries is: 155.15286690672204. distance: 109.64874226222342
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   1, Avg loss: 0.0646, Accuracy: 184/773 (23.8034%)
___Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   2, Avg loss: 0.0321, Accuracy: 402/773 (52.0052%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.0016, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   1, Avg loss: 0.0573, Accuracy: 344/712 (48.3146%)
___Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   2, Avg loss: 0.0255, Accuracy: 437/712 (61.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.4991, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   1, Avg loss: 0.0610, Accuracy: 201/735 (27.3469%)
___Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 338/735 (45.9864%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.5496, Accuracy: 54/10000 (0.5400%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   1, Avg loss: 0.0573, Accuracy: 208/861 (24.1580%)
___Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 450/861 (52.2648%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.2025, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 343/1662 (20.6378%)
___Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 615/1662 (37.0036%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.8052, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 359/1418 (25.3173%)
___Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 631/1418 (44.4993%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.6808, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   1, Avg loss: 0.0581, Accuracy: 340/803 (42.3412%)
___Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 412/803 (51.3076%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.9949, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   1, Avg loss: 0.0597, Accuracy: 271/708 (38.2768%)
___Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   2, Avg loss: 0.0375, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.7730, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   1, Avg loss: 0.0553, Accuracy: 421/1742 (24.1676%)
___Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 703/1742 (40.3559%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.6845, Accuracy: 91/10000 (0.9100%)
time spent on training: 268.33074045181274
[foolsgold agg] training data poison_ratio: 0.19066994700984102  data num: [1154, 773, 712, 735, 861, 1662, 1418, 803, 708, 1742]
[foolsgold agg] considering poison per batch poison_fraction: 0.059584358440575316
[foolsgold agg] wv: [1.         1.         0.63063091 1.         1.         1.
 1.         1.         0.63063091 1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3125, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.5578, Accuracy: 0/9950 (0.0000%)
saving model
Done in 487.5170855522156 sec.
Server Epoch:34 choose agents : [82, 57, 91, 67, 43, 97, 54, 71, 66, 14].
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 75/500 (15.0000%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.6712, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   1, Avg loss: 0.0544, Accuracy: 300/1154 (25.9965%)
___Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   2, Avg loss: 0.0273, Accuracy: 418/1154 (36.2218%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.4465, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   1, Avg loss: 0.0537, Accuracy: 329/1030 (31.9417%)
___Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   2, Avg loss: 0.0269, Accuracy: 589/1030 (57.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.1580, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   1, Avg loss: 0.0786, Accuracy: 51/426 (11.9718%)
___Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   2, Avg loss: 0.0419, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.5804, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 306/946 (32.3467%)
___Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 342/946 (36.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.9783, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   1, Avg loss: 0.0524, Accuracy: 361/1213 (29.7609%)
___Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 483/1213 (39.8186%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.6186, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0542, Accuracy: 351/1130 (31.0619%)
___Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0291, Accuracy: 495/1130 (43.8053%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.8485, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0646, Accuracy: 177/818 (21.6381%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 367/818 (44.8655%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.0131, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 245/1402 (17.4750%)
___Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 375/1402 (26.7475%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.1050, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 225/1013 (22.2113%)
___Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 334/1013 (32.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.7603, Accuracy: 70/10000 (0.7000%)
time spent on training: 203.7077932357788
[foolsgold agg] training data poison_ratio: 0.0  data num: [500, 1154, 1030, 426, 946, 1213, 1130, 818, 1402, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3125, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.5586, Accuracy: 0/9950 (0.0000%)
saving model
Done in 421.13637137413025 sec.
Server Epoch:35 choose agents : [25, 59, 84, 17, 29, 58, 36, 90, 67, 70].
poison local model 25 index 7 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   1, Average loss: 0.0633, Accuracy: 191/690 (27.6812%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   2, Average loss: 0.0312, Accuracy: 306/690 (44.3478%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   3, Average loss: 0.0258, Accuracy: 335/690 (48.5507%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   4, Average loss: 0.0249, Accuracy: 345/690 (50.0000%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   5, Average loss: 0.0234, Accuracy: 341/690 (49.4203%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   6, Average loss: 0.0229, Accuracy: 358/690 (51.8841%), train_poison_data_count: 220
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   7, Average loss: 0.0216, Accuracy: 373/690 (54.0580%), train_poison_data_count: 220
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   8, Average loss: 0.0210, Accuracy: 381/690 (55.2174%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   9, Average loss: 0.0209, Accuracy: 366/690 (53.0435%), train_poison_data_count: 220
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch  10, Average loss: 0.0209, Accuracy: 385/690 (55.7971%), train_poison_data_count: 220
Global model norm: 112.05444756345015.
Norm before scaling: 112.04578880557047. Distance: 0.8271417358559313
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.2963, Accuracy: 64/10000 (0.6400%)
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: 0.9537, Accuracy: 5325/9950 (53.5176%)
Scaling by  100
Scaled Norm after poisoning: 138.33101152669997, distance: 82.71417807066845
Total norm for 1 adversaries is: 138.33101152669997. distance: 82.71417807066845
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0528, Accuracy: 298/1089 (27.3646%)
___Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 493/1089 (45.2709%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.5388, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   1, Avg loss: 0.0626, Accuracy: 325/1190 (27.3109%)
___Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 454/1190 (38.1513%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.9113, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 412/1574 (26.1753%)
___Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 686/1574 (43.5832%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.2121, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   1, Avg loss: 0.0500, Accuracy: 403/1440 (27.9861%)
___Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 676/1440 (46.9444%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.6801, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0572, Accuracy: 345/803 (42.9639%)
___Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 387/803 (48.1943%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.9924, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   1, Avg loss: 0.0872, Accuracy: 67/408 (16.4216%)
___Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   2, Avg loss: 0.0550, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.5026, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   1, Avg loss: 0.0564, Accuracy: 320/677 (47.2674%)
___Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 439/677 (64.8449%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.4567, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0782, Accuracy: 51/426 (11.9718%)
___Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0419, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.5741, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 338/1418 (23.8364%)
___Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 596/1418 (42.0310%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.9358, Accuracy: 74/10000 (0.7400%)
time spent on training: 250.8371982574463
[foolsgold agg] training data poison_ratio: 0.07102418939783839  data num: [690, 1089, 1190, 1574, 1440, 803, 408, 677, 426, 1418]
[foolsgold agg] considering poison per batch poison_fraction: 0.022195059186824496
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3124, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.5586, Accuracy: 0/9950 (0.0000%)
saving model
Done in 468.557763338089 sec.
Server Epoch:36 choose agents : [14, 2, 79, 58, 84, 40, 16, 50, 8, 72].
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 226/1013 (22.3100%)
___Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 343/1013 (33.8598%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.7555, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0637, Accuracy: 229/605 (37.8512%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0390, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.8168, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   1, Avg loss: 0.1023, Accuracy: 14/197 (7.1066%)
___Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   2, Avg loss: 0.0862, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3199, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   1, Avg loss: 0.0573, Accuracy: 351/803 (43.7111%)
___Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   2, Avg loss: 0.0330, Accuracy: 422/803 (52.5529%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.0890, Accuracy: 41/10000 (0.4100%)
___Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   1, Avg loss: 0.0635, Accuracy: 310/1190 (26.0504%)
___Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 440/1190 (36.9748%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.9920, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   1, Avg loss: 0.0552, Accuracy: 367/1573 (23.3312%)
___Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 566/1573 (35.9822%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.3392, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   1, Avg loss: 0.0629, Accuracy: 279/708 (39.4068%)
___Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   2, Avg loss: 0.0371, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.8799, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   1, Avg loss: 0.0630, Accuracy: 147/809 (18.1706%)
___Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   2, Avg loss: 0.0274, Accuracy: 355/809 (43.8813%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.3970, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 229/1513 (15.1355%)
___Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 483/1513 (31.9233%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.4515, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 266/1241 (21.4343%)
___Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 411/1241 (33.1185%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.0416, Accuracy: 77/10000 (0.7700%)
time spent on training: 172.15354919433594
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 605, 197, 803, 1190, 1573, 708, 809, 1513, 1241]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3123, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.5584, Accuracy: 0/9950 (0.0000%)
saving model
Done in 392.87470722198486 sec.
Server Epoch:37 choose agents : [30, 52, 90, 51, 62, 40, 15, 83, 13, 39].
poison local model 30 index 8 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   1, Average loss: 0.0810, Accuracy: 55/486 (11.3169%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   2, Average loss: 0.0441, Accuracy: 166/486 (34.1564%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   3, Average loss: 0.0355, Accuracy: 179/486 (36.8313%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   4, Average loss: 0.0359, Accuracy: 163/486 (33.5391%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   5, Average loss: 0.0354, Accuracy: 188/486 (38.6831%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   6, Average loss: 0.0321, Accuracy: 193/486 (39.7119%), train_poison_data_count: 160
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   7, Average loss: 0.0320, Accuracy: 195/486 (40.1235%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   8, Average loss: 0.0311, Accuracy: 208/486 (42.7984%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   9, Average loss: 0.0310, Accuracy: 213/486 (43.8272%), train_poison_data_count: 160
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch  10, Average loss: 0.0318, Accuracy: 196/486 (40.3292%), train_poison_data_count: 160
Global model norm: 112.05433426746598.
Norm before scaling: 112.04896129176076. Distance: 0.71833619354664
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.3958, Accuracy: 62/10000 (0.6200%)
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: 1.0134, Accuracy: 7037/9950 (70.7236%)
Scaling by  100
Scaled Norm after poisoning: 132.4542742444539, distance: 71.83361240459615
Total norm for 2 adversaries is: 132.4542742444539. distance: 71.83361240459615
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0566, Accuracy: 283/636 (44.4969%)
___Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.2193, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   1, Avg loss: 0.0561, Accuracy: 319/677 (47.1196%)
___Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 443/677 (65.4357%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.2781, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0601, Accuracy: 226/1049 (21.5443%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0300, Accuracy: 516/1049 (49.1897%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5566, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   1, Avg loss: 0.0684, Accuracy: 143/568 (25.1761%)
___Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   2, Avg loss: 0.0401, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.7440, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 353/1573 (22.4412%)
___Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 571/1573 (36.3001%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.2159, Accuracy: 53/10000 (0.5300%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   1, Avg loss: 0.0577, Accuracy: 329/1154 (28.5095%)
___Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   2, Avg loss: 0.0301, Accuracy: 396/1154 (34.3154%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.9644, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 431/1953 (22.0686%)
___Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0338, Accuracy: 772/1953 (39.5289%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.0045, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 338/1645 (20.5471%)
___Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 603/1645 (36.6565%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.8113, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   1, Avg loss: 0.0536, Accuracy: 316/1013 (31.1945%)
___Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 506/1013 (49.9506%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5821, Accuracy: 74/10000 (0.7400%)
time spent on training: 286.0949532985687
[foolsgold agg] training data poison_ratio: 0.15250139482983077  data num: [486, 636, 677, 1049, 568, 1573, 1154, 1953, 1645, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.04765668588432212
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3122, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.5576, Accuracy: 0/9950 (0.0000%)
saving model
Done in 507.61296677589417 sec.
Server Epoch:38 choose agents : [70, 37, 62, 29, 91, 31, 56, 1, 98, 4].
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0547, Accuracy: 378/1418 (26.6573%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0303, Accuracy: 655/1418 (46.1918%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7154, Accuracy: 79/10000 (0.7900%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0529, Accuracy: 397/1129 (35.1639%)
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 741/1129 (65.6333%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.5131, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   1, Avg loss: 0.0687, Accuracy: 143/568 (25.1761%)
___Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.7438, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 409/1440 (28.4028%)
___Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 671/1440 (46.5972%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7559, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   1, Avg loss: 0.0518, Accuracy: 335/1030 (32.5243%)
___Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   2, Avg loss: 0.0266, Accuracy: 609/1030 (59.1262%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.5203, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   1, Avg loss: 0.0824, Accuracy: 63/460 (13.6957%)
___Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.7109, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.0672, Accuracy: 61/186 (32.7957%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0568, Accuracy: 282/928 (30.3879%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 570/928 (61.4224%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.4601, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   1, Avg loss: 0.0819, Accuracy: 18/373 (4.8257%)
___Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   2, Avg loss: 0.0478, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.4420, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0630, Accuracy: 325/901 (36.0710%)
___Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0357, Accuracy: 384/901 (42.6193%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.8115, Accuracy: 50/10000 (0.5000%)
time spent on training: 182.6494882106781
[foolsgold agg] training data poison_ratio: 0.13387880943910827  data num: [1418, 1129, 568, 1440, 1030, 460, 186, 928, 373, 901]
[foolsgold agg] considering poison per batch poison_fraction: 0.04183712794972133
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3121, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.5577, Accuracy: 0/9950 (0.0000%)
saving model
Done in 404.218873500824 sec.
Server Epoch:39 choose agents : [37, 46, 50, 70, 86, 40, 74, 51, 9, 21].
poison local model 37 index 9 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   1, Average loss: 0.0559, Accuracy: 266/1129 (23.5607%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   2, Average loss: 0.0289, Accuracy: 494/1129 (43.7555%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   3, Average loss: 0.0247, Accuracy: 558/1129 (49.4243%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   4, Average loss: 0.0245, Accuracy: 548/1129 (48.5385%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   5, Average loss: 0.0245, Accuracy: 549/1129 (48.6271%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   6, Average loss: 0.0239, Accuracy: 540/1129 (47.8299%), train_poison_data_count: 360
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   7, Average loss: 0.0230, Accuracy: 583/1129 (51.6386%), train_poison_data_count: 360
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   8, Average loss: 0.0229, Accuracy: 555/1129 (49.1585%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   9, Average loss: 0.0226, Accuracy: 604/1129 (53.4987%), train_poison_data_count: 360
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch  10, Average loss: 0.0226, Accuracy: 569/1129 (50.3986%), train_poison_data_count: 360
Global model norm: 112.05422097136724.
Norm before scaling: 112.03749110928226. Distance: 1.0524322699095117
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2021, Accuracy: 103/10000 (1.0300%)
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: 1.0005, Accuracy: 6124/9950 (61.5477%)
Scaling by  100
Scaled Norm after poisoning: 152.1402005552773, distance: 105.24323111398898
Total norm for 2 adversaries is: 152.1402005552773. distance: 105.24323111398898
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0549, Accuracy: 416/1904 (21.8487%)
___Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0319, Accuracy: 657/1904 (34.5063%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6404, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   1, Avg loss: 0.0631, Accuracy: 147/809 (18.1706%)
___Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 352/809 (43.5105%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.0851, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 359/1418 (25.3173%)
___Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 655/1418 (46.1918%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.7151, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   1, Avg loss: 0.0629, Accuracy: 364/1003 (36.2911%)
___Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 396/1003 (39.4816%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.7182, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 375/1573 (23.8398%)
___Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 588/1573 (37.3808%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.3683, Accuracy: 81/10000 (0.8100%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 491/1552 (31.6366%)
___Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 772/1552 (49.7423%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 10.7353, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0601, Accuracy: 230/1049 (21.9256%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0300, Accuracy: 486/1049 (46.3298%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.4656, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0497, Accuracy: 368/1275 (28.8627%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0188, Accuracy: 751/1275 (58.9020%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.3948, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 409/1949 (20.9851%)
___Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 630/1949 (32.3243%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2994, Accuracy: 80/10000 (0.8000%)
time spent on training: 342.4545192718506
[foolsgold agg] training data poison_ratio: 0.19625210453114705  data num: [1129, 1904, 809, 1418, 1003, 1573, 1552, 1049, 1275, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.061328782665983454
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3120, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.5553, Accuracy: 0/9950 (0.0000%)
saving model
Done in 563.3769657611847 sec.
Server Epoch:40 choose agents : [32, 70, 52, 38, 15, 78, 83, 84, 12, 92].
___Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   1, Avg loss: 0.0596, Accuracy: 197/735 (26.8027%)
___Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 384/735 (52.2449%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8013, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 366/1418 (25.8110%)
___Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0302, Accuracy: 685/1418 (48.3075%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.6462, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   1, Avg loss: 0.0553, Accuracy: 290/636 (45.5975%)
___Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   2, Avg loss: 0.0318, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.5194, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   1, Avg loss: 0.0615, Accuracy: 253/1131 (22.3696%)
___Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   2, Avg loss: 0.0312, Accuracy: 461/1131 (40.7604%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.2495, Accuracy: 76/10000 (0.7600%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 321/1154 (27.8163%)
___Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   2, Avg loss: 0.0291, Accuracy: 459/1154 (39.7747%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.9837, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 32/416 (7.6923%)
___Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0471, Accuracy: 174/416 (41.8269%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.5623, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 425/1953 (21.7614%)
___Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 746/1953 (38.1976%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.0788, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 323/1190 (27.1429%)
___Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 441/1190 (37.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.0810, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   1, Avg loss: 0.0868, Accuracy: 22/338 (6.5089%)
___Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   2, Avg loss: 0.0469, Accuracy: 154/338 (45.5621%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.4406, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 459/1715 (26.7638%)
___Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 702/1715 (40.9329%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.6447, Accuracy: 82/10000 (0.8200%)
time spent on training: 198.68253207206726
[foolsgold agg] training data poison_ratio: 0.1079917649260715  data num: [735, 1418, 636, 1131, 1154, 416, 1953, 1190, 338, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.03374742653939734
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3119, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.5521, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 417.4696145057678 sec.
Server Epoch:41 choose agents : [44, 96, 66, 2, 76, 98, 52, 77, 99, 29].
poison local model 44 index 10 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Average loss: 0.0576, Accuracy: 453/1750 (25.8857%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Average loss: 0.0348, Accuracy: 667/1750 (38.1143%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   3, Average loss: 0.0303, Accuracy: 721/1750 (41.2000%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   4, Average loss: 0.0293, Accuracy: 824/1750 (47.0857%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   5, Average loss: 0.0285, Accuracy: 858/1750 (49.0286%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   6, Average loss: 0.0276, Accuracy: 866/1750 (49.4857%), train_poison_data_count: 560
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   7, Average loss: 0.0269, Accuracy: 919/1750 (52.5143%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   8, Average loss: 0.0262, Accuracy: 966/1750 (55.2000%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   9, Average loss: 0.0260, Accuracy: 963/1750 (55.0286%), train_poison_data_count: 560
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch  10, Average loss: 0.0256, Accuracy: 947/1750 (54.1143%), train_poison_data_count: 560
Global model norm: 112.05411639025137.
Norm before scaling: 112.02534851959845. Distance: 1.2573572602606289
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.3821, Accuracy: 113/10000 (1.1300%)
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: 0.7490, Accuracy: 9487/9950 (95.3467%)
Scaling by  100
Scaled Norm after poisoning: 166.02050654587825, distance: 125.73572934059952
Total norm for 1 adversaries is: 166.02050654587825. distance: 125.73572934059952
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.0790, Accuracy: 46/311 (14.7910%)
___Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3449, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0616, Accuracy: 266/1402 (18.9729%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 391/1402 (27.8887%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.2953, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 228/605 (37.6860%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0394, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.7590, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   1, Avg loss: 0.0851, Accuracy: 55/466 (11.8026%)
___Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   2, Avg loss: 0.0494, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.6474, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   1, Avg loss: 0.0818, Accuracy: 20/373 (5.3619%)
___Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   2, Avg loss: 0.0472, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.4316, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   1, Avg loss: 0.0560, Accuracy: 289/636 (45.4403%)
___Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.2893, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   1, Avg loss: 0.0540, Accuracy: 342/1340 (25.5224%)
___Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 519/1340 (38.7313%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.5967, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   1, Avg loss: 0.0670, Accuracy: 189/773 (24.4502%)
___Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   2, Avg loss: 0.0313, Accuracy: 411/773 (53.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.0023, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   1, Avg loss: 0.0485, Accuracy: 427/1440 (29.6528%)
___Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   2, Avg loss: 0.0279, Accuracy: 652/1440 (45.2778%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.7292, Accuracy: 66/10000 (0.6600%)
time spent on training: 274.84872126579285
[foolsgold agg] training data poison_ratio: 0.19239226033421283  data num: [1750, 311, 1402, 605, 466, 373, 636, 1340, 773, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.06012258135444151
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3118, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.5493, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 492.5068943500519 sec.
Server Epoch:42 choose agents : [5, 45, 88, 53, 24, 60, 19, 4, 51, 79].
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   1, Avg loss: 0.0510, Accuracy: 367/1628 (22.5430%)
___Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 794/1628 (48.7715%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.9892, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0680, Accuracy: 195/669 (29.1480%)
___Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0404, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.7494, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   1, Avg loss: 0.0762, Accuracy: 137/603 (22.7197%)
___Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.8085, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   1, Avg loss: 0.0501, Accuracy: 287/813 (35.3014%)
___Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 444/813 (54.6125%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.1309, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   1, Avg loss: 0.0760, Accuracy: 39/312 (12.5000%)
___Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   2, Avg loss: 0.0401, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3924, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 587/2227 (26.3583%)
___Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1039/2227 (46.6547%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.4408, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   1, Avg loss: 0.0463, Accuracy: 397/1036 (38.3205%)
___Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   2, Avg loss: 0.0256, Accuracy: 670/1036 (64.6718%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.1384, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0615, Accuracy: 328/901 (36.4040%)
___Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0332, Accuracy: 399/901 (44.2841%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.7077, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   1, Avg loss: 0.0603, Accuracy: 216/1049 (20.5910%)
___Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 503/1049 (47.9504%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.6266, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   1, Avg loss: 0.1015, Accuracy: 15/197 (7.6142%)
___Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   2, Avg loss: 0.0859, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3202, Accuracy: 50/10000 (0.5000%)
time spent on training: 186.8376657962799
[foolsgold agg] training data poison_ratio: 0.17254901960784313  data num: [1628, 669, 603, 813, 312, 2227, 1036, 901, 1049, 197]
[foolsgold agg] considering poison per batch poison_fraction: 0.05392156862745098
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 0. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3118, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.5480, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 408.3421149253845 sec.
Server Epoch:43 choose agents : [49, 71, 38, 53, 30, 18, 45, 40, 35, 5].
poison local model 49 index 11 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   1, Average loss: 0.0803, Accuracy: 28/440 (6.3636%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   2, Average loss: 0.0510, Accuracy: 140/440 (31.8182%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   3, Average loss: 0.0400, Accuracy: 140/440 (31.8182%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   4, Average loss: 0.0373, Accuracy: 140/440 (31.8182%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   5, Average loss: 0.0355, Accuracy: 150/440 (34.0909%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   6, Average loss: 0.0342, Accuracy: 161/440 (36.5909%), train_poison_data_count: 140
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   7, Average loss: 0.0336, Accuracy: 167/440 (37.9545%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   8, Average loss: 0.0343, Accuracy: 161/440 (36.5909%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   9, Average loss: 0.0328, Accuracy: 155/440 (35.2273%), train_poison_data_count: 140
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch  10, Average loss: 0.0317, Accuracy: 176/440 (40.0000%), train_poison_data_count: 140
Global model norm: 112.05400745148519.
Norm before scaling: 112.04981104959526. Distance: 0.6401790834748994
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.5378, Accuracy: 48/10000 (0.4800%)
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: 1.2133, Accuracy: 8003/9950 (80.4322%)
Scaling by  100
Scaled Norm after poisoning: 128.52798667751316, distance: 64.01790749836135
Total norm for 3 adversaries is: 128.52798667751316. distance: 64.01790749836135
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   1, Avg loss: 0.0645, Accuracy: 152/818 (18.5819%)
___Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   2, Avg loss: 0.0300, Accuracy: 365/818 (44.6210%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.9978, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   1, Avg loss: 0.0609, Accuracy: 252/1131 (22.2812%)
___Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 509/1131 (45.0044%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.7412, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   1, Avg loss: 0.0498, Accuracy: 286/813 (35.1784%)
___Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 460/813 (56.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 9.7693, Accuracy: 52/10000 (0.5200%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0797, Accuracy: 70/486 (14.4033%)
___Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.7481, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   1, Avg loss: 0.0754, Accuracy: 118/530 (22.2642%)
___Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   2, Avg loss: 0.0379, Accuracy: 272/530 (51.3208%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.0395, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0680, Accuracy: 190/669 (28.4006%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0400, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.8693, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 360/1573 (22.8862%)
___Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 501/1573 (31.8500%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.3680, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   1, Avg loss: 0.0855, Accuracy: 35/271 (12.9151%)
___Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   2, Avg loss: 0.0556, Accuracy: 102/271 (37.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3639, Accuracy: 51/10000 (0.5100%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 396/1628 (24.3243%)
___Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 807/1628 (49.5700%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.0720, Accuracy: 98/10000 (0.9800%)
time spent on training: 274.64450764656067
[foolsgold agg] training data poison_ratio: 0.30553894006460103  data num: [440, 818, 1131, 813, 486, 530, 669, 1573, 271, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.09548091877018783
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3118, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.5479, Accuracy: 0/9950 (0.0000%)
saving model
Done in 494.33686900138855 sec.
Server Epoch:44 choose agents : [91, 35, 89, 37, 4, 10, 47, 36, 24, 61].
___Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   1, Avg loss: 0.0508, Accuracy: 330/1030 (32.0388%)
___Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   2, Avg loss: 0.0247, Accuracy: 645/1030 (62.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.7514, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0850, Accuracy: 44/271 (16.2362%)
___Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0563, Accuracy: 97/271 (35.7934%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3638, Accuracy: 43/10000 (0.4300%)
___Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   1, Avg loss: 0.0614, Accuracy: 339/896 (37.8348%)
___Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   2, Avg loss: 0.0339, Accuracy: 439/896 (48.9955%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.1880, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   1, Avg loss: 0.0515, Accuracy: 408/1129 (36.1382%)
___Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 719/1129 (63.6847%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.9769, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0601, Accuracy: 336/901 (37.2919%)
___Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0335, Accuracy: 397/901 (44.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.3988, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   1, Avg loss: 0.0568, Accuracy: 212/861 (24.6225%)
___Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   2, Avg loss: 0.0213, Accuracy: 463/861 (53.7747%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.8503, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   1, Avg loss: 0.1252, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   2, Avg loss: 0.1099, Accuracy: 12/134 (8.9552%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3092, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.0864, Accuracy: 73/408 (17.8922%)
___Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0533, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.5008, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   1, Avg loss: 0.0758, Accuracy: 44/312 (14.1026%)
___Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   2, Avg loss: 0.0402, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3966, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   2, Avg loss: 0.1163, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3042, Accuracy: 48/10000 (0.4800%)
time spent on training: 215.25978660583496
[foolsgold agg] training data poison_ratio: 0.3442840550854488  data num: [1030, 271, 896, 1129, 901, 861, 134, 408, 312, 85]
[foolsgold agg] considering poison per batch poison_fraction: 0.10758876721420274
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.5474, Accuracy: 0/9950 (0.0000%)
saving model
Done in 431.7555031776428 sec.
Server Epoch:45 choose agents : [55, 62, 30, 4, 18, 38, 76, 69, 42, 68].
poison local model 55 index 12 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Average loss: 0.0589, Accuracy: 231/1071 (21.5686%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Average loss: 0.0303, Accuracy: 372/1071 (34.7339%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   3, Average loss: 0.0287, Accuracy: 400/1071 (37.3483%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   4, Average loss: 0.0277, Accuracy: 440/1071 (41.0831%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   5, Average loss: 0.0276, Accuracy: 463/1071 (43.2306%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   6, Average loss: 0.0268, Accuracy: 467/1071 (43.6041%), train_poison_data_count: 340
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   7, Average loss: 0.0267, Accuracy: 464/1071 (43.3240%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   8, Average loss: 0.0255, Accuracy: 474/1071 (44.2577%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   9, Average loss: 0.0261, Accuracy: 474/1071 (44.2577%), train_poison_data_count: 340
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch  10, Average loss: 0.0264, Accuracy: 488/1071 (45.5649%), train_poison_data_count: 340
Global model norm: 112.05389851261312.
Norm before scaling: 112.0387201135728. Distance: 1.0351564803213187
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.6279, Accuracy: 74/10000 (0.7400%)
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: 0.9626, Accuracy: 8620/9950 (86.6332%)
Scaling by  100
Scaled Norm after poisoning: 151.07759414660072, distance: 103.51564268867773
Total norm for 2 adversaries is: 151.07759414660072. distance: 103.51564268867773
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0686, Accuracy: 140/568 (24.6479%)
___Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0418, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.7899, Accuracy: 66/10000 (0.6600%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   1, Avg loss: 0.0795, Accuracy: 78/486 (16.0494%)
___Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   2, Avg loss: 0.0410, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.8573, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0616, Accuracy: 330/901 (36.6260%)
___Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0340, Accuracy: 366/901 (40.6215%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.0726, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   1, Avg loss: 0.0756, Accuracy: 119/530 (22.4528%)
___Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   2, Avg loss: 0.0388, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.1089, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0619, Accuracy: 249/1131 (22.0159%)
___Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 493/1131 (43.5897%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.4012, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0853, Accuracy: 49/466 (10.5150%)
___Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0475, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.6344, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   1, Avg loss: 0.0592, Accuracy: 291/590 (49.3220%)
___Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   2, Avg loss: 0.0303, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.8823, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 341/1372 (24.8542%)
___Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 502/1372 (36.5889%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.9183, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0625, Accuracy: 366/1163 (31.4703%)
___Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0373, Accuracy: 403/1163 (34.6518%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.7749, Accuracy: 62/10000 (0.6200%)
time spent on training: 274.79460549354553
[foolsgold agg] training data poison_ratio: 0.18808891036482242  data num: [1071, 568, 486, 901, 530, 1131, 466, 590, 1372, 1163]
[foolsgold agg] considering poison per batch poison_fraction: 0.05877778448900701
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.5478, Accuracy: 0/9950 (0.0000%)
saving model
Done in 492.3716471195221 sec.
Server Epoch:46 choose agents : [34, 94, 32, 2, 30, 67, 17, 61, 73, 89].
___Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   1, Avg loss: 0.0585, Accuracy: 394/1427 (27.6104%)
___Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 553/1427 (38.7526%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.9169, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 326/1662 (19.6149%)
___Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 607/1662 (36.5223%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.5711, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   1, Avg loss: 0.0596, Accuracy: 210/735 (28.5714%)
___Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 375/735 (51.0204%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8857, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0627, Accuracy: 232/605 (38.3471%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0397, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8835, Accuracy: 55/10000 (0.5500%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0792, Accuracy: 83/486 (17.0782%)
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0402, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.7486, Accuracy: 45/10000 (0.4500%)
___Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   1, Avg loss: 0.0782, Accuracy: 54/426 (12.6761%)
___Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   2, Avg loss: 0.0418, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.5573, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0508, Accuracy: 401/1574 (25.4765%)
___Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0280, Accuracy: 642/1574 (40.7878%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.2694, Accuracy: 85/10000 (0.8500%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   1, Avg loss: 0.1242, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   2, Avg loss: 0.1171, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3043, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   1, Avg loss: 0.0654, Accuracy: 171/938 (18.2303%)
___Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   2, Avg loss: 0.0340, Accuracy: 335/938 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.4824, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0605, Accuracy: 338/896 (37.7232%)
___Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.3755, Accuracy: 50/10000 (0.5000%)
time spent on training: 200.73052096366882
[foolsgold agg] training data poison_ratio: 0.06463663119764546  data num: [1427, 1662, 735, 605, 486, 426, 1574, 85, 938, 896]
[foolsgold agg] considering poison per batch poison_fraction: 0.020198947249264205
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3116, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.5424, Accuracy: 0/9950 (0.0000%)
saving model
Done in 418.28093814849854 sec.
Server Epoch:47 choose agents : [61, 49, 64, 19, 88, 44, 5, 46, 59, 14].
poison local model 61 index 13 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   1, Average loss: 0.1279, Accuracy: 0/85 (0.0000%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   2, Average loss: 0.1145, Accuracy: 1/85 (1.1765%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   3, Average loss: 0.0981, Accuracy: 35/85 (41.1765%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   4, Average loss: 0.0947, Accuracy: 41/85 (48.2353%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   5, Average loss: 0.0902, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   6, Average loss: 0.0877, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   7, Average loss: 0.0830, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   8, Average loss: 0.0778, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   9, Average loss: 0.0754, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch  10, Average loss: 0.0734, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Global model norm: 112.05378957363513.
Norm before scaling: 112.05303571300512. Distance: 0.20865878473638766
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3721, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: 3.3092, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 113.88663239846238, distance: 20.865878550765903
Total norm for 4 adversaries is: 113.88663239846238. distance: 20.865878550765903
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 32/440 (7.2727%)
___Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   2, Avg loss: 0.0474, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.5066, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   1, Avg loss: 0.0637, Accuracy: 181/953 (18.9927%)
___Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 286/953 (30.0105%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.6123, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 402/1036 (38.8031%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 672/1036 (64.8649%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.8804, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 149/603 (24.7098%)
___Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   2, Avg loss: 0.0459, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.9711, Accuracy: 51/10000 (0.5100%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   1, Avg loss: 0.0593, Accuracy: 396/1750 (22.6286%)
___Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   2, Avg loss: 0.0347, Accuracy: 672/1750 (38.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.4469, Accuracy: 116/10000 (1.1600%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   1, Avg loss: 0.0507, Accuracy: 402/1628 (24.6929%)
___Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   2, Avg loss: 0.0250, Accuracy: 831/1628 (51.0442%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.0725, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 425/1904 (22.3214%)
___Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 694/1904 (36.4496%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.8274, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   1, Avg loss: 0.0529, Accuracy: 310/1089 (28.4665%)
___Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 448/1089 (41.1387%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.3859, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   1, Avg loss: 0.0619, Accuracy: 222/1013 (21.9151%)
___Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 338/1013 (33.3662%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.6843, Accuracy: 65/10000 (0.6500%)
time spent on training: 355.0331537723541
[foolsgold agg] training data poison_ratio: 0.3716788877249786  data num: [85, 440, 953, 1036, 603, 1750, 1628, 1904, 1089, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.11614965241405581
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3115, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.5300, Accuracy: 0/9950 (0.0000%)
saving model
Done in 572.314779996872 sec.
Server Epoch:48 choose agents : [21, 78, 90, 85, 84, 38, 88, 31, 97, 66].
___Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 401/1949 (20.5747%)
___Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   2, Avg loss: 0.0326, Accuracy: 658/1949 (33.7609%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.4784, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 43/416 (10.3365%)
___Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   2, Avg loss: 0.0468, Accuracy: 169/416 (40.6250%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.5648, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0557, Accuracy: 326/677 (48.1536%)
___Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 449/677 (66.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.3096, Accuracy: 54/10000 (0.5400%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 491/1988 (24.6982%)
___Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 703/1988 (35.3622%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.8099, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   1, Avg loss: 0.0626, Accuracy: 316/1190 (26.5546%)
___Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 463/1190 (38.9076%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.9075, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0609, Accuracy: 254/1131 (22.4580%)
___Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 502/1131 (44.3855%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.3619, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0745, Accuracy: 146/603 (24.2123%)
___Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0455, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.8205, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   1, Avg loss: 0.0813, Accuracy: 78/460 (16.9565%)
___Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   2, Avg loss: 0.0385, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.7360, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 339/1213 (27.9472%)
___Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 452/1213 (37.2630%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.7108, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 268/1402 (19.1155%)
___Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   2, Avg loss: 0.0383, Accuracy: 403/1402 (28.7447%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.2990, Accuracy: 71/10000 (0.7100%)
time spent on training: 207.94265484809875
[foolsgold agg] training data poison_ratio: 0.18025206274367575  data num: [1949, 416, 677, 1988, 1190, 1131, 603, 460, 1213, 1402]
[foolsgold agg] considering poison per batch poison_fraction: 0.056328769607398674
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3115, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.5302, Accuracy: 0/9950 (0.0000%)
saving model
Done in 420.95432209968567 sec.
Server Epoch:49 choose agents : [65, 16, 50, 5, 97, 4, 13, 23, 86, 72].
poison local model 65 index 14 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Average loss: 0.0545, Accuracy: 372/1475 (25.2203%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Average loss: 0.0317, Accuracy: 577/1475 (39.1186%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   3, Average loss: 0.0285, Accuracy: 562/1475 (38.1017%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   4, Average loss: 0.0276, Accuracy: 596/1475 (40.4068%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   5, Average loss: 0.0265, Accuracy: 645/1475 (43.7288%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   6, Average loss: 0.0265, Accuracy: 662/1475 (44.8814%), train_poison_data_count: 463
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   7, Average loss: 0.0259, Accuracy: 681/1475 (46.1695%), train_poison_data_count: 463
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   8, Average loss: 0.0256, Accuracy: 677/1475 (45.8983%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   9, Average loss: 0.0251, Accuracy: 686/1475 (46.5085%), train_poison_data_count: 463
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch  10, Average loss: 0.0253, Accuracy: 681/1475 (46.1695%), train_poison_data_count: 463
Global model norm: 112.05368499211662.
Norm before scaling: 112.02938021452229. Distance: 1.1317782185725065
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.7589, Accuracy: 75/10000 (0.7500%)
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: 0.8593, Accuracy: 9476/9950 (95.2362%)
Scaling by  100
Scaled Norm after poisoning: 157.1399716912441, distance: 113.17781484653916
Total norm for 2 adversaries is: 157.1399716912441. distance: 113.17781484653916
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   1, Avg loss: 0.0652, Accuracy: 284/708 (40.1130%)
___Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   2, Avg loss: 0.0357, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8929, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   1, Avg loss: 0.0631, Accuracy: 156/809 (19.2831%)
___Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   2, Avg loss: 0.0270, Accuracy: 354/809 (43.7577%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.3332, Accuracy: 71/10000 (0.7100%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   1, Avg loss: 0.0507, Accuracy: 382/1628 (23.4644%)
___Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 770/1628 (47.2973%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1042, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0526, Accuracy: 350/1213 (28.8541%)
___Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 506/1213 (41.7148%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.6956, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0610, Accuracy: 333/901 (36.9589%)
___Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0330, Accuracy: 415/901 (46.0599%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.6865, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   1, Avg loss: 0.0572, Accuracy: 346/1645 (21.0334%)
___Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 650/1645 (39.5137%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1542, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   1, Avg loss: 0.0588, Accuracy: 319/715 (44.6154%)
___Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   2, Avg loss: 0.0395, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.7361, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   1, Avg loss: 0.0632, Accuracy: 354/1003 (35.2941%)
___Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   2, Avg loss: 0.0350, Accuracy: 366/1003 (36.4905%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.5550, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   1, Avg loss: 0.0612, Accuracy: 263/1241 (21.1926%)
___Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 396/1241 (31.9098%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.0550, Accuracy: 59/10000 (0.5900%)
time spent on training: 322.44708156585693
[foolsgold agg] training data poison_ratio: 0.2736814252954666  data num: [1475, 708, 809, 1628, 1213, 901, 1645, 715, 1003, 1241]
[foolsgold agg] considering poison per batch poison_fraction: 0.08552544540483331
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3114, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.5282, Accuracy: 0/9950 (0.0000%)
saving model
Done in 541.6150617599487 sec.
Server Epoch:50 choose agents : [44, 46, 85, 2, 36, 48, 98, 55, 22, 81].
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   1, Avg loss: 0.0584, Accuracy: 389/1750 (22.2286%)
___Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 679/1750 (38.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.6386, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0547, Accuracy: 423/1904 (22.2164%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 675/1904 (35.4517%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.8161, Accuracy: 102/10000 (1.0200%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   1, Avg loss: 0.0534, Accuracy: 470/1988 (23.6419%)
___Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   2, Avg loss: 0.0359, Accuracy: 691/1988 (34.7586%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.8922, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 231/605 (38.1818%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.8212, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   1, Avg loss: 0.0867, Accuracy: 73/408 (17.8922%)
___Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   2, Avg loss: 0.0556, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.5033, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0707, Accuracy: 104/631 (16.4818%)
___Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0418, Accuracy: 224/631 (35.4992%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.0058, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   1, Avg loss: 0.0813, Accuracy: 24/373 (6.4343%)
___Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   2, Avg loss: 0.0479, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.4499, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   1, Avg loss: 0.0560, Accuracy: 251/1071 (23.4360%)
___Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 487/1071 (45.4715%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.0671, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 513/1470 (34.8980%)
___Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 840/1470 (57.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.0896, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0695, Accuracy: 244/774 (31.5245%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0358, Accuracy: 301/774 (38.8889%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.4098, Accuracy: 64/10000 (0.6400%)
time spent on training: 273.16653203964233
[foolsgold agg] training data poison_ratio: 0.4382176052487698  data num: [1750, 1904, 1988, 605, 408, 631, 373, 1071, 1470, 774]
[foolsgold agg] considering poison per batch poison_fraction: 0.13694300164024056
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3113, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.5288, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 488.4997835159302 sec.
Server Epoch:51 choose agents : [85, 13, 26, 47, 58, 96, 62, 76, 7, 72].
poison local model 85 index 15 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   1, Average loss: 0.0529, Accuracy: 479/1988 (24.0946%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   2, Average loss: 0.0354, Accuracy: 644/1988 (32.3944%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   3, Average loss: 0.0322, Accuracy: 739/1988 (37.1730%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   4, Average loss: 0.0324, Accuracy: 708/1988 (35.6137%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   5, Average loss: 0.0320, Accuracy: 705/1988 (35.4628%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   6, Average loss: 0.0317, Accuracy: 746/1988 (37.5252%), train_poison_data_count: 624
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   7, Average loss: 0.0313, Accuracy: 742/1988 (37.3239%), train_poison_data_count: 624
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   8, Average loss: 0.0307, Accuracy: 776/1988 (39.0342%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   9, Average loss: 0.0307, Accuracy: 771/1988 (38.7827%), train_poison_data_count: 624
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch  10, Average loss: 0.0302, Accuracy: 792/1988 (39.8390%), train_poison_data_count: 624
Global model norm: 112.05356733779162.
Norm before scaling: 112.01922006540886. Distance: 1.2493358755163861
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9367, Accuracy: 69/10000 (0.6900%)
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: 0.9235, Accuracy: 9399/9950 (94.4623%)
Scaling by  100
Scaled Norm after poisoning: 165.04122354354382, distance: 124.93357610146282
Total norm for 1 adversaries is: 165.04122354354382. distance: 124.93357610146282
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 310/1645 (18.8450%)
___Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 603/1645 (36.6565%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.6595, Accuracy: 121/10000 (1.2100%)
___Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   1, Avg loss: 0.0547, Accuracy: 337/1446 (23.3057%)
___Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 503/1446 (34.7856%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.2549, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   1, Avg loss: 0.1221, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   2, Avg loss: 0.1052, Accuracy: 23/134 (17.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3103, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 348/803 (43.3375%)
___Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 398/803 (49.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.0523, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 55/311 (17.6849%)
___Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   2, Avg loss: 0.0547, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3484, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   1, Avg loss: 0.0684, Accuracy: 143/568 (25.1761%)
___Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   2, Avg loss: 0.0406, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.7901, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 44/466 (9.4421%)
___Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0483, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.6619, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 354/891 (39.7306%)
___Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 411/891 (46.1279%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.9174, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 253/1241 (20.3868%)
___Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 439/1241 (35.3747%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.1124, Accuracy: 60/10000 (0.6000%)
time spent on training: 287.9374248981476
[foolsgold agg] training data poison_ratio: 0.2094174655008954  data num: [1988, 1645, 1446, 134, 803, 311, 568, 466, 891, 1241]
[foolsgold agg] considering poison per batch poison_fraction: 0.06544295796902981
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3113, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.5254, Accuracy: 0/9950 (0.0000%)
saving model
Done in 508.45522356033325 sec.
Server Epoch:52 choose agents : [9, 47, 83, 58, 50, 6, 68, 26, 40, 71].
___Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   1, Avg loss: 0.0493, Accuracy: 361/1275 (28.3137%)
___Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   2, Avg loss: 0.0193, Accuracy: 709/1275 (55.6078%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.6591, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   1, Avg loss: 0.1225, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   2, Avg loss: 0.1097, Accuracy: 20/134 (14.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0537, Accuracy: 417/1953 (21.3518%)
___Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0331, Accuracy: 806/1953 (41.2698%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.0368, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0571, Accuracy: 347/803 (43.2130%)
___Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0341, Accuracy: 387/803 (48.1943%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.0408, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 160/809 (19.7775%)
___Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   2, Avg loss: 0.0267, Accuracy: 357/809 (44.1286%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.2155, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   1, Avg loss: 0.0549, Accuracy: 414/1956 (21.1656%)
___Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 659/1956 (33.6912%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.4160, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   1, Avg loss: 0.0627, Accuracy: 366/1163 (31.4703%)
___Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   2, Avg loss: 0.0363, Accuracy: 461/1163 (39.6389%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.5750, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   1, Avg loss: 0.0545, Accuracy: 357/1446 (24.6888%)
___Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 524/1446 (36.2379%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.3838, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   1, Avg loss: 0.0544, Accuracy: 340/1573 (21.6147%)
___Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 565/1573 (35.9186%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.5826, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   1, Avg loss: 0.0651, Accuracy: 139/818 (16.9927%)
___Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   2, Avg loss: 0.0313, Accuracy: 324/818 (39.6088%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.0833, Accuracy: 68/10000 (0.6800%)
time spent on training: 273.365216255188
[foolsgold agg] training data poison_ratio: 0.0  data num: [1275, 134, 1953, 803, 809, 1956, 1163, 1446, 1573, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3113, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.5262, Accuracy: 0/9950 (0.0000%)
saving model
Done in 491.87003207206726 sec.
Server Epoch:53 choose agents : [50, 14, 84, 8, 25, 5, 40, 98, 72, 69].
___Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 159/809 (19.6539%)
___Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 363/809 (44.8702%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.5843, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   1, Avg loss: 0.0619, Accuracy: 224/1013 (22.1125%)
___Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 294/1013 (29.0227%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.6426, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   1, Avg loss: 0.0618, Accuracy: 326/1190 (27.3950%)
___Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 464/1190 (38.9916%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.0171, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0600, Accuracy: 244/1513 (16.1269%)
___Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 480/1513 (31.7250%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.7099, Accuracy: 82/10000 (0.8200%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   1, Avg loss: 0.0572, Accuracy: 304/690 (44.0580%)
___Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.4839, Accuracy: 57/10000 (0.5700%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0508, Accuracy: 388/1628 (23.8329%)
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0251, Accuracy: 872/1628 (53.5627%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.1765, Accuracy: 128/10000 (1.2800%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0544, Accuracy: 382/1573 (24.2848%)
___Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 552/1573 (35.0922%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.6735, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   1, Avg loss: 0.0809, Accuracy: 27/373 (7.2386%)
___Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   2, Avg loss: 0.0483, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.4384, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   1, Avg loss: 0.0615, Accuracy: 254/1241 (20.4674%)
___Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   2, Avg loss: 0.0360, Accuracy: 411/1241 (33.1185%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.0776, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0567, Accuracy: 297/590 (50.3390%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0342, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.7456, Accuracy: 50/10000 (0.5000%)
time spent on training: 228.4018895626068
[foolsgold agg] training data poison_ratio: 0.21826741996233523  data num: [809, 1013, 1190, 1513, 690, 1628, 1573, 373, 1241, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.06820856873822975
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3112, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.5260, Accuracy: 0/9950 (0.0000%)
saving model
Done in 447.21842789649963 sec.
Server Epoch:54 choose agents : [72, 22, 50, 1, 38, 36, 52, 32, 73, 85].
___Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 252/1241 (20.3062%)
___Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 429/1241 (34.5689%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.2535, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 534/1470 (36.3265%)
___Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 874/1470 (59.4558%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.2372, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   1, Avg loss: 0.0625, Accuracy: 151/809 (18.6650%)
___Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 360/809 (44.4994%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.2036, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0567, Accuracy: 292/928 (31.4655%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 570/928 (61.4224%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.5574, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0614, Accuracy: 253/1131 (22.3696%)
___Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0301, Accuracy: 478/1131 (42.2635%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.2897, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   1, Avg loss: 0.0865, Accuracy: 76/408 (18.6275%)
___Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   2, Avg loss: 0.0542, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.4898, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0563, Accuracy: 281/636 (44.1824%)
___Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.3233, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   1, Avg loss: 0.0597, Accuracy: 210/735 (28.5714%)
___Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 356/735 (48.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.8265, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   1, Avg loss: 0.0648, Accuracy: 182/938 (19.4030%)
___Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 322/938 (34.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.5673, Accuracy: 55/10000 (0.5500%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 475/1988 (23.8934%)
___Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 663/1988 (33.3501%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.6284, Accuracy: 79/10000 (0.7900%)
time spent on training: 213.6496365070343
[foolsgold agg] training data poison_ratio: 0.19330999611046285  data num: [1241, 1470, 809, 928, 1131, 408, 636, 735, 938, 1988]
[foolsgold agg] considering poison per batch poison_fraction: 0.06040937378451964
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3111, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.5218, Accuracy: 0/9950 (0.0000%)
saving model
Done in 432.1298770904541 sec.
Server Epoch:55 choose agents : [33, 58, 47, 9, 19, 26, 45, 81, 95, 56].
___Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   1, Avg loss: 0.0799, Accuracy: 65/515 (12.6214%)
___Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   2, Avg loss: 0.0512, Accuracy: 109/515 (21.1650%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.7520, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 348/803 (43.3375%)
___Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0348, Accuracy: 367/803 (45.7036%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.0178, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   1, Avg loss: 0.1217, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   2, Avg loss: 0.1117, Accuracy: 17/134 (12.6866%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3103, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   1, Avg loss: 0.0495, Accuracy: 356/1275 (27.9216%)
___Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 696/1275 (54.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 9.1751, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 397/1036 (38.3205%)
___Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   2, Avg loss: 0.0240, Accuracy: 641/1036 (61.8726%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.8294, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 344/1446 (23.7898%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0343, Accuracy: 529/1446 (36.5837%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.2350, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   1, Avg loss: 0.0664, Accuracy: 205/669 (30.6428%)
___Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   2, Avg loss: 0.0411, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.8448, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   1, Avg loss: 0.0671, Accuracy: 244/774 (31.5245%)
___Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   2, Avg loss: 0.0347, Accuracy: 325/774 (41.9897%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.2811, Accuracy: 55/10000 (0.5500%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   1, Avg loss: 0.0539, Accuracy: 333/599 (55.5927%)
___Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   2, Avg loss: 0.0280, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.4259, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   1, Avg loss: 0.0822, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   2, Avg loss: 0.0669, Accuracy: 70/186 (37.6344%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3114, Accuracy: 50/10000 (0.5000%)
time spent on training: 159.71510910987854
[foolsgold agg] training data poison_ratio: 0.08054322979696114  data num: [515, 803, 134, 1275, 1036, 1446, 669, 774, 599, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.02516975931155036
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3110, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.5212, Accuracy: 0/9950 (0.0000%)
saving model
Done in 381.1384611129761 sec.
Server Epoch:56 choose agents : [98, 9, 8, 25, 64, 74, 90, 19, 66, 92].
___Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   1, Avg loss: 0.0805, Accuracy: 32/373 (8.5791%)
___Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   2, Avg loss: 0.0477, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.4475, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   1, Avg loss: 0.0494, Accuracy: 360/1275 (28.2353%)
___Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 703/1275 (55.1373%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.1841, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   1, Avg loss: 0.0595, Accuracy: 237/1513 (15.6642%)
___Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 462/1513 (30.5354%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.2147, Accuracy: 102/10000 (1.0200%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0565, Accuracy: 305/690 (44.2029%)
___Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0271, Accuracy: 464/690 (67.2464%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.4193, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 169/953 (17.7335%)
___Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   2, Avg loss: 0.0383, Accuracy: 302/953 (31.6894%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.4262, Accuracy: 53/10000 (0.5300%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 516/1552 (33.2474%)
___Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 738/1552 (47.5515%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.7095, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   1, Avg loss: 0.0562, Accuracy: 325/677 (48.0059%)
___Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 464/677 (68.5377%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.3759, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   1, Avg loss: 0.0468, Accuracy: 382/1036 (36.8726%)
___Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   2, Avg loss: 0.0234, Accuracy: 667/1036 (64.3822%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 9.0123, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 254/1402 (18.1170%)
___Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 400/1402 (28.5307%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.2702, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   1, Avg loss: 0.0522, Accuracy: 440/1715 (25.6560%)
___Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 741/1715 (43.2070%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.6061, Accuracy: 90/10000 (0.9000%)
time spent on training: 244.46071863174438
[foolsgold agg] training data poison_ratio: 0.20042910781333811  data num: [373, 1275, 1513, 690, 953, 1552, 677, 1036, 1402, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.06263409619166815
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3109, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.5193, Accuracy: 0/9950 (0.0000%)
saving model
Done in 465.7435655593872 sec.
Server Epoch:57 choose agents : [16, 72, 14, 32, 55, 48, 98, 56, 85, 95].
___Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   1, Avg loss: 0.0592, Accuracy: 284/708 (40.1130%)
___Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   2, Avg loss: 0.0381, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.8728, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 257/1241 (20.7091%)
___Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 406/1241 (32.7156%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.0956, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 230/1013 (22.7048%)
___Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 343/1013 (33.8598%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.7309, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0589, Accuracy: 216/735 (29.3878%)
___Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 364/735 (49.5238%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.1247, Accuracy: 49/10000 (0.4900%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 232/1071 (21.6620%)
___Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 505/1071 (47.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.8932, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.0708, Accuracy: 102/631 (16.1648%)
___Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 214/631 (33.9144%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.8810, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   1, Avg loss: 0.0806, Accuracy: 24/373 (6.4343%)
___Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   2, Avg loss: 0.0470, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.4584, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0666, Accuracy: 73/186 (39.2473%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 443/1988 (22.2837%)
___Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 637/1988 (32.0423%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.8131, Accuracy: 76/10000 (0.7600%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   1, Avg loss: 0.0531, Accuracy: 333/599 (55.5927%)
___Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   2, Avg loss: 0.0278, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.4529, Accuracy: 50/10000 (0.5000%)
time spent on training: 193.3832883834839
[foolsgold agg] training data poison_ratio: 0.4280866003510825  data num: [708, 1241, 1013, 735, 1071, 631, 373, 186, 1988, 599]
[foolsgold agg] considering poison per batch poison_fraction: 0.13377706260971328
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3109, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.5168, Accuracy: 0/9950 (0.0000%)
saving model
Done in 409.0206735134125 sec.
Server Epoch:58 choose agents : [84, 53, 38, 31, 8, 47, 67, 4, 87, 88].
___Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 325/1190 (27.3109%)
___Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 457/1190 (38.4034%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.9273, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 286/813 (35.1784%)
___Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 463/813 (56.9496%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.5300, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   1, Avg loss: 0.0607, Accuracy: 250/1131 (22.1043%)
___Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 521/1131 (46.0654%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.3380, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0817, Accuracy: 70/460 (15.2174%)
___Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0368, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8054, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   1, Avg loss: 0.0589, Accuracy: 250/1513 (16.5235%)
___Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   2, Avg loss: 0.0361, Accuracy: 488/1513 (32.2538%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.3412, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1228, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1073, Accuracy: 22/134 (16.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3098, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0777, Accuracy: 56/426 (13.1455%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0413, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.6359, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0627, Accuracy: 326/901 (36.1820%)
___Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0331, Accuracy: 384/901 (42.6193%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.0746, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   1, Avg loss: 0.0582, Accuracy: 308/1131 (27.2325%)
___Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 364/1131 (32.1839%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.8396, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0748, Accuracy: 140/603 (23.2172%)
___Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0446, Accuracy: 276/603 (45.7711%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.9243, Accuracy: 51/10000 (0.5100%)
time spent on training: 147.61695981025696
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 813, 1131, 460, 1513, 134, 426, 901, 1131, 603]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.86117636 1.         0.86117636
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3109, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.5180, Accuracy: 0/9950 (0.0000%)
saving model
Done in 359.84120893478394 sec.
Server Epoch:59 choose agents : [82, 74, 11, 41, 40, 36, 95, 87, 23, 32].
___Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0761, Accuracy: 66/500 (13.2000%)
___Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.6944, Accuracy: 42/10000 (0.4200%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0425, Accuracy: 549/1552 (35.3737%)
___Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 778/1552 (50.1289%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 10.8812, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   1, Avg loss: 0.0559, Accuracy: 350/712 (49.1573%)
___Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 388/712 (54.4944%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.9468, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   1, Avg loss: 0.0583, Accuracy: 336/719 (46.7316%)
___Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   2, Avg loss: 0.0320, Accuracy: 458/719 (63.6996%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.5691, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0544, Accuracy: 358/1573 (22.7591%)
___Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 559/1573 (35.5372%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.7328, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.0865, Accuracy: 77/408 (18.8725%)
___Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0553, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.5019, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   1, Avg loss: 0.0519, Accuracy: 339/599 (56.5943%)
___Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   2, Avg loss: 0.0313, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.7832, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   1, Avg loss: 0.0579, Accuracy: 305/1131 (26.9673%)
___Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 437/1131 (38.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1274, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0626, Accuracy: 322/715 (45.0350%)
___Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0371, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.7124, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   1, Avg loss: 0.0589, Accuracy: 203/735 (27.6190%)
___Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 359/735 (48.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1588, Accuracy: 52/10000 (0.5200%)
time spent on training: 189.39541292190552
[foolsgold agg] training data poison_ratio: 0.2488431281813975  data num: [500, 1552, 712, 719, 1573, 408, 599, 1131, 715, 735]
[foolsgold agg] considering poison per batch poison_fraction: 0.07776347755668672
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3109, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.5146, Accuracy: 0/9950 (0.0000%)
saving model
Done in 400.17081785202026 sec.
Server Epoch:60 choose agents : [28, 39, 27, 81, 97, 7, 47, 24, 49, 88].
___Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 392/1581 (24.7944%)
___Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 594/1581 (37.5712%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.4526, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   1, Avg loss: 0.0533, Accuracy: 321/1013 (31.6881%)
___Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 503/1013 (49.6545%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.7885, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   1, Avg loss: 0.0540, Accuracy: 445/1587 (28.0403%)
___Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   2, Avg loss: 0.0341, Accuracy: 578/1587 (36.4209%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.1691, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   1, Avg loss: 0.0669, Accuracy: 240/774 (31.0078%)
___Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   2, Avg loss: 0.0356, Accuracy: 305/774 (39.4057%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.2700, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 358/1213 (29.5136%)
___Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 498/1213 (41.0552%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.6406, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 355/891 (39.8429%)
___Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 449/891 (50.3928%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.9667, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   1, Avg loss: 0.1193, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   2, Avg loss: 0.1101, Accuracy: 24/134 (17.9104%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3098, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0755, Accuracy: 45/312 (14.4231%)
___Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0396, Accuracy: 173/312 (55.4487%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.4036, Accuracy: 50/10000 (0.5000%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 32/440 (7.2727%)
___Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   2, Avg loss: 0.0466, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.5423, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0744, Accuracy: 146/603 (24.2123%)
___Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0471, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.8560, Accuracy: 51/10000 (0.5100%)
time spent on training: 160.0945348739624
[foolsgold agg] training data poison_ratio: 0.05147402901263454  data num: [1581, 1013, 1587, 774, 1213, 891, 134, 312, 440, 603]
[foolsgold agg] considering poison per batch poison_fraction: 0.016085634066448293
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         0.99134702 0.99134702 1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3108, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.5147, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 368.7984220981598 sec.
Server Epoch:61 choose agents : [63, 97, 61, 60, 55, 87, 50, 72, 14, 64].
___Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 263/888 (29.6171%)
___Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 440/888 (49.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2838, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 361/1213 (29.7609%)
___Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 467/1213 (38.4996%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.6659, Accuracy: 91/10000 (0.9100%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   1, Avg loss: 0.1243, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   2, Avg loss: 0.1178, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3034, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   1, Avg loss: 0.0498, Accuracy: 587/2227 (26.3583%)
___Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1054/2227 (47.3282%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2301, Accuracy: 132/10000 (1.3200%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0564, Accuracy: 256/1071 (23.9029%)
___Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 511/1071 (47.7124%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.3969, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   1, Avg loss: 0.0580, Accuracy: 301/1131 (26.6136%)
___Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   2, Avg loss: 0.0322, Accuracy: 380/1131 (33.5986%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.0677, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0622, Accuracy: 148/809 (18.2942%)
___Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0266, Accuracy: 364/809 (44.9938%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.2330, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   1, Avg loss: 0.0613, Accuracy: 270/1241 (21.7566%)
___Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 431/1241 (34.7301%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.4241, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 226/1013 (22.3100%)
___Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   2, Avg loss: 0.0347, Accuracy: 389/1013 (38.4008%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.7014, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   1, Avg loss: 0.0640, Accuracy: 181/953 (18.9927%)
___Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   2, Avg loss: 0.0383, Accuracy: 304/953 (31.8993%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.6724, Accuracy: 61/10000 (0.6100%)
time spent on training: 218.53300762176514
[foolsgold agg] training data poison_ratio: 0.1087385946759477  data num: [888, 1213, 85, 2227, 1071, 1131, 809, 1241, 1013, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.03398081083623365
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3108, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.5124, Accuracy: 0/9950 (0.0000%)
saving model
Done in 430.2581741809845 sec.
Server Epoch:62 choose agents : [82, 13, 98, 85, 60, 29, 45, 7, 66, 63].
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0758, Accuracy: 75/500 (15.0000%)
___Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 169/500 (33.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.6973, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0574, Accuracy: 331/1645 (20.1216%)
___Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 637/1645 (38.7234%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.7001, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   1, Avg loss: 0.0802, Accuracy: 26/373 (6.9705%)
___Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.4582, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   1, Avg loss: 0.0527, Accuracy: 459/1988 (23.0885%)
___Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   2, Avg loss: 0.0349, Accuracy: 706/1988 (35.5131%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.8982, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0495, Accuracy: 592/2227 (26.5828%)
___Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1022/2227 (45.8913%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.1128, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 425/1440 (29.5139%)
___Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 701/1440 (48.6806%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.2868, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   1, Avg loss: 0.0664, Accuracy: 212/669 (31.6891%)
___Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   2, Avg loss: 0.0412, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.9160, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 350/891 (39.2817%)
___Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 427/891 (47.9237%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.2085, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   1, Avg loss: 0.0613, Accuracy: 269/1402 (19.1869%)
___Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 393/1402 (28.0314%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.1380, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0538, Accuracy: 269/888 (30.2928%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 424/888 (47.7477%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.2982, Accuracy: 51/10000 (0.5100%)
time spent on training: 197.3259837627411
[foolsgold agg] training data poison_ratio: 0.16534974631955418  data num: [500, 1645, 373, 1988, 2227, 1440, 669, 891, 1402, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.05167179572486068
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.92321058
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3107, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.5115, Accuracy: 0/9950 (0.0000%)
saving model
Done in 409.6704936027527 sec.
Server Epoch:63 choose agents : [14, 81, 97, 91, 28, 94, 4, 35, 25, 39].
___Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   1, Avg loss: 0.0614, Accuracy: 228/1013 (22.5074%)
___Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 338/1013 (33.3662%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.5334, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   1, Avg loss: 0.0662, Accuracy: 250/774 (32.2997%)
___Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   2, Avg loss: 0.0379, Accuracy: 289/774 (37.3385%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.3170, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 371/1213 (30.5853%)
___Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 495/1213 (40.8079%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.7129, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   1, Avg loss: 0.0543, Accuracy: 342/1030 (33.2039%)
___Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   2, Avg loss: 0.0247, Accuracy: 618/1030 (60.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.1115, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 395/1581 (24.9842%)
___Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 589/1581 (37.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.5845, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 356/1662 (21.4200%)
___Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 641/1662 (38.5680%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.9619, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0591, Accuracy: 335/901 (37.1809%)
___Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0322, Accuracy: 409/901 (45.3940%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.0095, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.0853, Accuracy: 39/271 (14.3911%)
___Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0537, Accuracy: 106/271 (39.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3694, Accuracy: 49/10000 (0.4900%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0572, Accuracy: 307/690 (44.4928%)
___Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0269, Accuracy: 463/690 (67.1014%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.3548, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   1, Avg loss: 0.0536, Accuracy: 322/1013 (31.7868%)
___Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 515/1013 (50.8391%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.5221, Accuracy: 61/10000 (0.6100%)
time spent on training: 211.54478979110718
[foolsgold agg] training data poison_ratio: 0.06799369333858889  data num: [1013, 774, 1213, 1030, 1581, 1662, 901, 271, 690, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.021248029168309028
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3107, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.5121, Accuracy: 0/9950 (0.0000%)
saving model
Done in 416.53449416160583 sec.
Server Epoch:64 choose agents : [81, 71, 22, 76, 45, 30, 66, 5, 69, 70].
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0673, Accuracy: 244/774 (31.5245%)
___Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0379, Accuracy: 297/774 (38.3721%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.2911, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0645, Accuracy: 172/818 (21.0269%)
___Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 342/818 (41.8093%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.1896, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 521/1470 (35.4422%)
___Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 870/1470 (59.1837%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.1348, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0847, Accuracy: 46/466 (9.8712%)
___Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0482, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.6862, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.0674, Accuracy: 209/669 (31.2407%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0398, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8013, Accuracy: 51/10000 (0.5100%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.0784, Accuracy: 84/486 (17.2840%)
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8019, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   1, Avg loss: 0.0615, Accuracy: 268/1402 (19.1155%)
___Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   2, Avg loss: 0.0380, Accuracy: 426/1402 (30.3852%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.4260, Accuracy: 66/10000 (0.6600%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   1, Avg loss: 0.0509, Accuracy: 377/1628 (23.1572%)
___Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   2, Avg loss: 0.0260, Accuracy: 789/1628 (48.4644%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.3284, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   1, Avg loss: 0.0570, Accuracy: 293/590 (49.6610%)
___Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.6521, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0553, Accuracy: 363/1418 (25.5994%)
___Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 668/1418 (47.1086%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.5097, Accuracy: 82/10000 (0.8200%)
time spent on training: 190.37209749221802
[foolsgold agg] training data poison_ratio: 0.21746733875115729  data num: [774, 818, 1470, 466, 669, 486, 1402, 1628, 590, 1418]
[foolsgold agg] considering poison per batch poison_fraction: 0.06795854335973665
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3106, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.5126, Accuracy: 0/9950 (0.0000%)
saving model
Done in 395.7835350036621 sec.
Server Epoch:65 choose agents : [78, 89, 90, 16, 68, 76, 57, 27, 83, 41].
___Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   1, Avg loss: 0.0832, Accuracy: 38/416 (9.1346%)
___Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   2, Avg loss: 0.0460, Accuracy: 177/416 (42.5481%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.5564, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   1, Avg loss: 0.0597, Accuracy: 341/896 (38.0580%)
___Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   2, Avg loss: 0.0339, Accuracy: 420/896 (46.8750%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.3463, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   1, Avg loss: 0.0558, Accuracy: 322/677 (47.5628%)
___Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 433/677 (63.9586%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.2949, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   1, Avg loss: 0.0639, Accuracy: 281/708 (39.6893%)
___Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.8829, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0620, Accuracy: 368/1163 (31.6423%)
___Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0368, Accuracy: 459/1163 (39.4669%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.6107, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0845, Accuracy: 51/466 (10.9442%)
___Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0485, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.6945, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0538, Accuracy: 302/1154 (26.1698%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0249, Accuracy: 507/1154 (43.9341%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.8110, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 434/1587 (27.3472%)
___Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 592/1587 (37.3031%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.1421, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 413/1953 (21.1470%)
___Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 774/1953 (39.6313%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.0813, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   1, Avg loss: 0.0589, Accuracy: 335/719 (46.5925%)
___Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   2, Avg loss: 0.0319, Accuracy: 471/719 (65.5076%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.4003, Accuracy: 53/10000 (0.5300%)
time spent on training: 208.88085532188416
[foolsgold agg] training data poison_ratio: 0.0  data num: [416, 896, 677, 708, 1163, 466, 1154, 1587, 1953, 719]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3105, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.5125, Accuracy: 0/9950 (0.0000%)
saving model
Done in 418.8862416744232 sec.
Server Epoch:66 choose agents : [38, 88, 33, 43, 14, 18, 98, 35, 78, 86].
___Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   1, Avg loss: 0.0612, Accuracy: 257/1131 (22.7233%)
___Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 452/1131 (39.9646%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.3689, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0735, Accuracy: 144/603 (23.8806%)
___Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0462, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.0099, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   1, Avg loss: 0.0794, Accuracy: 77/515 (14.9515%)
___Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   2, Avg loss: 0.0545, Accuracy: 134/515 (26.0194%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.7309, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 312/946 (32.9810%)
___Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 326/946 (34.4609%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.0874, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 226/1013 (22.3100%)
___Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 333/1013 (32.8727%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.7246, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0746, Accuracy: 123/530 (23.2075%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0381, Accuracy: 272/530 (51.3208%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.2332, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   1, Avg loss: 0.0801, Accuracy: 30/373 (8.0429%)
___Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   2, Avg loss: 0.0476, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.4815, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   1, Avg loss: 0.0852, Accuracy: 47/271 (17.3432%)
___Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   2, Avg loss: 0.0558, Accuracy: 107/271 (39.4834%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3673, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0830, Accuracy: 44/416 (10.5769%)
___Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0456, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.5817, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0622, Accuracy: 360/1003 (35.8923%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0349, Accuracy: 363/1003 (36.1914%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.7481, Accuracy: 50/10000 (0.5000%)
time spent on training: 141.3199336528778
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 603, 515, 946, 1013, 530, 373, 271, 416, 1003]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3104, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.5127, Accuracy: 0/9950 (0.0000%)
saving model
Done in 356.343266248703 sec.
Server Epoch:67 choose agents : [94, 13, 95, 73, 30, 22, 25, 10, 86, 8].
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0545, Accuracy: 335/1662 (20.1564%)
___Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 586/1662 (35.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.6066, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0572, Accuracy: 336/1645 (20.4255%)
___Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 618/1645 (37.5684%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.2574, Accuracy: 121/10000 (1.2100%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0520, Accuracy: 334/599 (55.7596%)
___Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0313, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.0098, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0646, Accuracy: 179/938 (19.0832%)
___Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0336, Accuracy: 305/938 (32.5160%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.1752, Accuracy: 52/10000 (0.5200%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   1, Avg loss: 0.0783, Accuracy: 86/486 (17.6955%)
___Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   2, Avg loss: 0.0404, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.8379, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   1, Avg loss: 0.0448, Accuracy: 565/1470 (38.4354%)
___Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 865/1470 (58.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.3475, Accuracy: 81/10000 (0.8100%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   1, Avg loss: 0.0563, Accuracy: 314/690 (45.5072%)
___Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.4098, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   1, Avg loss: 0.0569, Accuracy: 220/861 (25.5517%)
___Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 448/861 (52.0325%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.0950, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0629, Accuracy: 361/1003 (35.9920%)
___Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 381/1003 (37.9860%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.7150, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   1, Avg loss: 0.0593, Accuracy: 265/1513 (17.5149%)
___Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 489/1513 (32.3199%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.1531, Accuracy: 97/10000 (0.9700%)
time spent on training: 265.31235122680664
[foolsgold agg] training data poison_ratio: 0.24256924634213675  data num: [1662, 1645, 599, 938, 486, 1470, 690, 861, 1003, 1513]
[foolsgold agg] considering poison per batch poison_fraction: 0.07580288948191774
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3103, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.5112, Accuracy: 0/9950 (0.0000%)
saving model
Done in 471.65995264053345 sec.
Server Epoch:68 choose agents : [83, 52, 97, 44, 67, 7, 87, 76, 46, 17].
___Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 463/1953 (23.7071%)
___Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 778/1953 (39.8361%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.8836, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0564, Accuracy: 278/636 (43.7107%)
___Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.2943, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 363/1213 (29.9258%)
___Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 471/1213 (38.8293%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6047, Accuracy: 91/10000 (0.9100%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 424/1750 (24.2286%)
___Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0349, Accuracy: 677/1750 (38.6857%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6062, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   1, Avg loss: 0.0772, Accuracy: 53/426 (12.4413%)
___Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   2, Avg loss: 0.0413, Accuracy: 171/426 (40.1408%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.5870, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 354/891 (39.7306%)
___Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 449/891 (50.3928%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.0484, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0571, Accuracy: 308/1131 (27.2325%)
___Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 396/1131 (35.0133%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.7971, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   1, Avg loss: 0.0844, Accuracy: 52/466 (11.1588%)
___Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   2, Avg loss: 0.0493, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.6900, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   1, Avg loss: 0.0554, Accuracy: 416/1904 (21.8487%)
___Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 665/1904 (34.9265%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.0240, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 400/1574 (25.4130%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 669/1574 (42.5032%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.0713, Accuracy: 95/10000 (0.9500%)
time spent on training: 217.89190936088562
[foolsgold agg] training data poison_ratio: 0.14651707970529135  data num: [1953, 636, 1213, 1750, 426, 891, 1131, 466, 1904, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.04578658740790355
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3103, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.5118, Accuracy: 0/9950 (0.0000%)
saving model
Done in 425.39069724082947 sec.
Server Epoch:69 choose agents : [90, 24, 28, 70, 52, 97, 11, 21, 20, 62].
___Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   1, Avg loss: 0.0561, Accuracy: 324/677 (47.8582%)
___Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 433/677 (63.9586%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.1167, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   1, Avg loss: 0.0750, Accuracy: 48/312 (15.3846%)
___Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   2, Avg loss: 0.0400, Accuracy: 169/312 (54.1667%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.4035, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   1, Avg loss: 0.0557, Accuracy: 387/1581 (24.4782%)
___Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 600/1581 (37.9507%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.9006, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0551, Accuracy: 380/1418 (26.7983%)
___Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 668/1418 (47.1086%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8067, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   1, Avg loss: 0.0564, Accuracy: 282/636 (44.3396%)
___Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   2, Avg loss: 0.0311, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.2644, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   1, Avg loss: 0.0514, Accuracy: 366/1213 (30.1731%)
___Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 498/1213 (41.0552%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8332, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   1, Avg loss: 0.0554, Accuracy: 347/712 (48.7360%)
___Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 403/712 (56.6011%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.5449, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 381/1949 (19.5485%)
___Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0326, Accuracy: 642/1949 (32.9400%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.0722, Accuracy: 94/10000 (0.9400%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0569, Accuracy: 338/807 (41.8835%)
___Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 411/807 (50.9294%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.9519, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   1, Avg loss: 0.0677, Accuracy: 154/568 (27.1127%)
___Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   2, Avg loss: 0.0406, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.8479, Accuracy: 51/10000 (0.5100%)
time spent on training: 191.04337739944458
[foolsgold agg] training data poison_ratio: 0.08173807353388028  data num: [677, 312, 1581, 1418, 636, 1213, 712, 1949, 807, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.02554314797933759
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3102, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.5121, Accuracy: 0/9950 (0.0000%)
saving model
Done in 395.38836336135864 sec.
Server Epoch:70 choose agents : [75, 24, 36, 52, 95, 82, 93, 97, 6, 81].
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0627, Accuracy: 244/776 (31.4433%)
___Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0285, Accuracy: 407/776 (52.4485%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.8319, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   1, Avg loss: 0.0750, Accuracy: 53/312 (16.9872%)
___Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   2, Avg loss: 0.0397, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3910, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.0863, Accuracy: 73/408 (17.8922%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0544, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.4941, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   1, Avg loss: 0.0558, Accuracy: 294/636 (46.2264%)
___Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   2, Avg loss: 0.0306, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.3242, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   1, Avg loss: 0.0518, Accuracy: 334/599 (55.7596%)
___Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   2, Avg loss: 0.0275, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.8901, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   1, Avg loss: 0.0758, Accuracy: 70/500 (14.0000%)
___Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.7116, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   1, Avg loss: 0.0557, Accuracy: 420/1742 (24.1102%)
___Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   2, Avg loss: 0.0321, Accuracy: 697/1742 (40.0115%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.7658, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0520, Accuracy: 370/1213 (30.5029%)
___Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 498/1213 (41.0552%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.5935, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 419/1956 (21.4213%)
___Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 664/1956 (33.9468%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.1611, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   1, Avg loss: 0.0672, Accuracy: 241/774 (31.1370%)
___Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   2, Avg loss: 0.0372, Accuracy: 312/774 (40.3101%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.3793, Accuracy: 58/10000 (0.5800%)
time spent on training: 177.99746346473694
[foolsgold agg] training data poison_ratio: 0.06718259309107223  data num: [776, 312, 408, 636, 599, 500, 1742, 1213, 1956, 774]
[foolsgold agg] considering poison per batch poison_fraction: 0.02099456034096007
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3101, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.5119, Accuracy: 0/9950 (0.0000%)
saving model
Done in 388.5239362716675 sec.
Server Epoch:71 choose agents : [88, 8, 87, 89, 65, 19, 11, 23, 49, 57].
___Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   1, Avg loss: 0.0751, Accuracy: 141/603 (23.3831%)
___Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   2, Avg loss: 0.0449, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.0623, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   1, Avg loss: 0.0590, Accuracy: 246/1513 (16.2591%)
___Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 478/1513 (31.5929%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.3365, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   1, Avg loss: 0.0570, Accuracy: 314/1131 (27.7630%)
___Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 414/1131 (36.6048%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.5969, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0605, Accuracy: 327/896 (36.4955%)
___Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 449/896 (50.1116%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.2294, Accuracy: 52/10000 (0.5200%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   1, Avg loss: 0.0543, Accuracy: 398/1475 (26.9831%)
___Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   2, Avg loss: 0.0309, Accuracy: 695/1475 (47.1186%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.2023, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 407/1036 (39.2857%)
___Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   2, Avg loss: 0.0256, Accuracy: 627/1036 (60.5212%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.3650, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   1, Avg loss: 0.0548, Accuracy: 345/712 (48.4551%)
___Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 430/712 (60.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.4272, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0632, Accuracy: 324/715 (45.3147%)
___Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0376, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.7525, Accuracy: 50/10000 (0.5000%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0783, Accuracy: 32/440 (7.2727%)
___Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0464, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.5047, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   1, Avg loss: 0.0546, Accuracy: 319/1154 (27.6430%)
___Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   2, Avg loss: 0.0255, Accuracy: 446/1154 (38.6482%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.5845, Accuracy: 77/10000 (0.7700%)
time spent on training: 196.3246579170227
[foolsgold agg] training data poison_ratio: 0.1979328165374677  data num: [603, 1513, 1131, 896, 1475, 1036, 712, 715, 440, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.06185400516795865
[foolsgold agg] wv: [0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3101, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.5112, Accuracy: 0/9950 (0.0000%)
saving model
Done in 406.53633308410645 sec.
Server Epoch:72 choose agents : [78, 58, 7, 87, 5, 96, 28, 39, 91, 22].
___Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   1, Avg loss: 0.0829, Accuracy: 44/416 (10.5769%)
___Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   2, Avg loss: 0.0456, Accuracy: 171/416 (41.1058%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.5686, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   1, Avg loss: 0.0568, Accuracy: 354/803 (44.0847%)
___Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   2, Avg loss: 0.0332, Accuracy: 409/803 (50.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.9520, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 360/891 (40.4040%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 443/891 (49.7194%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.0371, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0573, Accuracy: 310/1131 (27.4094%)
___Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0315, Accuracy: 418/1131 (36.9584%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.0203, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   1, Avg loss: 0.0505, Accuracy: 390/1628 (23.9558%)
___Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 834/1628 (51.2285%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2009, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 52/311 (16.7203%)
___Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3486, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   1, Avg loss: 0.0554, Accuracy: 411/1581 (25.9962%)
___Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 577/1581 (36.4959%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.7801, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   1, Avg loss: 0.0536, Accuracy: 328/1013 (32.3791%)
___Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   2, Avg loss: 0.0256, Accuracy: 545/1013 (53.8006%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.6277, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0518, Accuracy: 324/1030 (31.4563%)
___Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0261, Accuracy: 630/1030 (61.1650%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2771, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 524/1470 (35.6463%)
___Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 871/1470 (59.2517%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.0533, Accuracy: 69/10000 (0.6900%)
time spent on training: 243.07403707504272
[foolsgold agg] training data poison_ratio: 0.15845824411134904  data num: [416, 803, 891, 1131, 1628, 311, 1581, 1013, 1030, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.04951820128479657
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3100, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.5110, Accuracy: 0/9950 (0.0000%)
saving model
Done in 450.3844540119171 sec.
Server Epoch:73 choose agents : [98, 36, 21, 76, 10, 40, 61, 4, 75, 26].
___Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   1, Avg loss: 0.0799, Accuracy: 30/373 (8.0429%)
___Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   2, Avg loss: 0.0472, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.4541, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.0866, Accuracy: 81/408 (19.8529%)
___Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0530, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.5313, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0531, Accuracy: 426/1949 (21.8574%)
___Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 660/1949 (33.8635%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.6118, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   1, Avg loss: 0.0843, Accuracy: 55/466 (11.8026%)
___Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   2, Avg loss: 0.0509, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.6341, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0569, Accuracy: 214/861 (24.8548%)
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0213, Accuracy: 447/861 (51.9164%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.3400, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   1, Avg loss: 0.0542, Accuracy: 380/1573 (24.1577%)
___Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   2, Avg loss: 0.0346, Accuracy: 602/1573 (38.2708%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.5274, Accuracy: 79/10000 (0.7900%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   1, Avg loss: 0.1256, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   2, Avg loss: 0.1169, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3035, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0620, Accuracy: 327/901 (36.2930%)
___Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0311, Accuracy: 405/901 (44.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3002, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   1, Avg loss: 0.0643, Accuracy: 256/776 (32.9897%)
___Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   2, Avg loss: 0.0284, Accuracy: 426/776 (54.8969%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.0740, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 348/1446 (24.0664%)
___Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 528/1446 (36.5145%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.3550, Accuracy: 63/10000 (0.6300%)
time spent on training: 190.22918963432312
[foolsgold agg] training data poison_ratio: 0.1070377913555103  data num: [373, 408, 1949, 466, 861, 1573, 85, 901, 776, 1446]
[foolsgold agg] considering poison per batch poison_fraction: 0.03344930979859697
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3099, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.5109, Accuracy: 0/9950 (0.0000%)
saving model
Done in 399.7325394153595 sec.
Server Epoch:74 choose agents : [23, 32, 65, 40, 44, 4, 84, 94, 14, 70].
___Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   1, Avg loss: 0.0607, Accuracy: 324/715 (45.3147%)
___Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   2, Avg loss: 0.0389, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.7010, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   1, Avg loss: 0.0589, Accuracy: 211/735 (28.7075%)
___Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   2, Avg loss: 0.0225, Accuracy: 345/735 (46.9388%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.9482, Accuracy: 57/10000 (0.5700%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 398/1475 (26.9831%)
___Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   2, Avg loss: 0.0307, Accuracy: 677/1475 (45.8983%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.0588, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 400/1573 (25.4291%)
___Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   2, Avg loss: 0.0341, Accuracy: 607/1573 (38.5887%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.9770, Accuracy: 60/10000 (0.6000%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0584, Accuracy: 425/1750 (24.2857%)
___Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 704/1750 (40.2286%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.5885, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0599, Accuracy: 339/901 (37.6249%)
___Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 419/901 (46.5039%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.7810, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   1, Avg loss: 0.0622, Accuracy: 319/1190 (26.8067%)
___Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   2, Avg loss: 0.0317, Accuracy: 456/1190 (38.3193%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.0565, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   1, Avg loss: 0.0543, Accuracy: 356/1662 (21.4200%)
___Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 645/1662 (38.8087%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.7659, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 228/1013 (22.5074%)
___Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 319/1013 (31.4906%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.7762, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   1, Avg loss: 0.0547, Accuracy: 379/1418 (26.7278%)
___Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 652/1418 (45.9803%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.8488, Accuracy: 77/10000 (0.7700%)
time spent on training: 273.1066608428955
[foolsgold agg] training data poison_ratio: 0.2594111969111969  data num: [715, 735, 1475, 1573, 1750, 901, 1190, 1662, 1013, 1418]
[foolsgold agg] considering poison per batch poison_fraction: 0.08106599903474904
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3099, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.5072, Accuracy: 0/9950 (0.0000%)
saving model
Done in 486.8385808467865 sec.
Server Epoch:75 choose agents : [74, 11, 45, 65, 75, 59, 52, 1, 15, 25].
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0423, Accuracy: 540/1552 (34.7938%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0201, Accuracy: 825/1552 (53.1572%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.2967, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0545, Accuracy: 346/712 (48.5955%)
___Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0258, Accuracy: 444/712 (62.3596%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.6620, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   1, Avg loss: 0.0668, Accuracy: 207/669 (30.9417%)
___Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   2, Avg loss: 0.0408, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.7894, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 14 
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0563, Accuracy: 396/1475 (26.8475%)
___Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0308, Accuracy: 710/1475 (48.1356%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.4625, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   1, Avg loss: 0.0654, Accuracy: 246/776 (31.7010%)
___Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   2, Avg loss: 0.0292, Accuracy: 406/776 (52.3196%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.1924, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   1, Avg loss: 0.0605, Accuracy: 289/1089 (26.5381%)
___Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   2, Avg loss: 0.0264, Accuracy: 473/1089 (43.4343%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.4536, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   1, Avg loss: 0.0558, Accuracy: 293/636 (46.0692%)
___Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   2, Avg loss: 0.0309, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.3434, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0566, Accuracy: 287/928 (30.9267%)
___Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0231, Accuracy: 573/928 (61.7457%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.4940, Accuracy: 81/10000 (0.8100%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   1, Avg loss: 0.0561, Accuracy: 326/1154 (28.2496%)
___Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   2, Avg loss: 0.0293, Accuracy: 417/1154 (36.1352%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.9007, Accuracy: 51/10000 (0.5100%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 311/690 (45.0725%)
___Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   2, Avg loss: 0.0276, Accuracy: 463/690 (67.1014%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.4157, Accuracy: 64/10000 (0.6400%)
time spent on training: 226.13500094413757
[foolsgold agg] training data poison_ratio: 0.5031505009813035  data num: [1552, 712, 669, 1475, 776, 1089, 636, 928, 1154, 690]
[foolsgold agg] considering poison per batch poison_fraction: 0.15723453155665734
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3097, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.5059, Accuracy: 0/9950 (0.0000%)
saving model
Done in 435.3716323375702 sec.
Server Epoch:76 choose agents : [63, 74, 77, 87, 99, 4, 66, 94, 14, 24].
___Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 270/888 (30.4054%)
___Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 462/888 (52.0270%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.3222, Accuracy: 63/10000 (0.6300%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 516/1552 (33.2474%)
___Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 758/1552 (48.8402%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.3914, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   1, Avg loss: 0.0531, Accuracy: 319/1340 (23.8060%)
___Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 567/1340 (42.3134%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.7025, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0578, Accuracy: 311/1131 (27.4978%)
___Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0318, Accuracy: 390/1131 (34.4828%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.9020, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   1, Avg loss: 0.0668, Accuracy: 183/773 (23.6740%)
___Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   2, Avg loss: 0.0297, Accuracy: 404/773 (52.2639%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.9793, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0591, Accuracy: 340/901 (37.7358%)
___Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 419/901 (46.5039%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.2192, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   1, Avg loss: 0.0611, Accuracy: 272/1402 (19.4009%)
___Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 405/1402 (28.8873%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.1756, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 361/1662 (21.7208%)
___Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   2, Avg loss: 0.0326, Accuracy: 657/1662 (39.5307%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.7205, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0607, Accuracy: 238/1013 (23.4946%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 335/1013 (33.0701%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.8545, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   1, Avg loss: 0.0748, Accuracy: 48/312 (15.3846%)
___Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.4061, Accuracy: 50/10000 (0.5000%)
time spent on training: 209.05605959892273
[foolsgold agg] training data poison_ratio: 0.14142518680517588  data num: [888, 1552, 1340, 1131, 773, 901, 1402, 1662, 1013, 312]
[foolsgold agg] considering poison per batch poison_fraction: 0.044195370876617464
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3097, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.5070, Accuracy: 0/9950 (0.0000%)
saving model
Done in 412.8628795146942 sec.
Server Epoch:77 choose agents : [76, 6, 84, 12, 66, 97, 46, 21, 74, 15].
___Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   1, Avg loss: 0.0844, Accuracy: 62/466 (13.3047%)
___Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   2, Avg loss: 0.0481, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.7317, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 417/1956 (21.3190%)
___Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 626/1956 (32.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.1941, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 327/1190 (27.4790%)
___Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 462/1190 (38.8235%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.9085, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 23/338 (6.8047%)
___Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   2, Avg loss: 0.0467, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.4610, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0613, Accuracy: 266/1402 (18.9729%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0382, Accuracy: 394/1402 (28.1027%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.1911, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   1, Avg loss: 0.0518, Accuracy: 371/1213 (30.5853%)
___Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 515/1213 (42.4567%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.6549, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   1, Avg loss: 0.0545, Accuracy: 424/1904 (22.2689%)
___Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   2, Avg loss: 0.0312, Accuracy: 692/1904 (36.3445%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.5660, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 400/1949 (20.5233%)
___Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 610/1949 (31.2981%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.3786, Accuracy: 87/10000 (0.8700%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 470/1552 (30.2835%)
___Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 761/1552 (49.0335%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.3330, Accuracy: 81/10000 (0.8100%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   1, Avg loss: 0.0583, Accuracy: 332/1154 (28.7695%)
___Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   2, Avg loss: 0.0294, Accuracy: 449/1154 (38.9081%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.9607, Accuracy: 55/10000 (0.5500%)
time spent on training: 265.28336548805237
[foolsgold agg] training data poison_ratio: 0.20618713806766228  data num: [466, 1956, 1190, 338, 1402, 1213, 1904, 1949, 1552, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.06443348064614446
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3096, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.5074, Accuracy: 0/9950 (0.0000%)
saving model
Done in 490.55020093917847 sec.
Server Epoch:78 choose agents : [41, 72, 21, 61, 36, 59, 95, 83, 71, 30].
___Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   1, Avg loss: 0.0587, Accuracy: 335/719 (46.5925%)
___Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   2, Avg loss: 0.0316, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.3319, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   1, Avg loss: 0.0609, Accuracy: 255/1241 (20.5479%)
___Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 424/1241 (34.1660%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.2019, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 401/1949 (20.5747%)
___Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 614/1949 (31.5033%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.1843, Accuracy: 81/10000 (0.8100%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   1, Avg loss: 0.1242, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   2, Avg loss: 0.1169, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3039, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0858, Accuracy: 81/408 (19.8529%)
___Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0542, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.4963, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   1, Avg loss: 0.0524, Accuracy: 300/1089 (27.5482%)
___Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 475/1089 (43.6180%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.5724, Accuracy: 79/10000 (0.7900%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   1, Avg loss: 0.0517, Accuracy: 341/599 (56.9282%)
___Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   2, Avg loss: 0.0294, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.5890, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 418/1953 (21.4030%)
___Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   2, Avg loss: 0.0339, Accuracy: 751/1953 (38.4537%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.7174, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   1, Avg loss: 0.0642, Accuracy: 157/818 (19.1932%)
___Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 317/818 (38.7531%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.2014, Accuracy: 59/10000 (0.5900%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0779, Accuracy: 87/486 (17.9012%)
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0405, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.7684, Accuracy: 42/10000 (0.4200%)
time spent on training: 222.04943013191223
[foolsgold agg] training data poison_ratio: 0.12517385257301808  data num: [719, 1241, 1949, 85, 408, 1089, 599, 1953, 818, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.03911682892906815
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3096, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.5071, Accuracy: 0/9950 (0.0000%)
saving model
Done in 435.7740683555603 sec.
Server Epoch:79 choose agents : [33, 1, 76, 57, 89, 55, 42, 31, 95, 22].
___Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0798, Accuracy: 71/515 (13.7864%)
___Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0489, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.7176, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0570, Accuracy: 285/928 (30.7112%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0240, Accuracy: 551/928 (59.3750%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.5673, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   1, Avg loss: 0.0841, Accuracy: 61/466 (13.0901%)
___Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   2, Avg loss: 0.0475, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.6540, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   1, Avg loss: 0.0530, Accuracy: 310/1154 (26.8631%)
___Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   2, Avg loss: 0.0250, Accuracy: 545/1154 (47.2270%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.2946, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 333/896 (37.1652%)
___Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   2, Avg loss: 0.0330, Accuracy: 420/896 (46.8750%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.2199, Accuracy: 52/10000 (0.5200%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   1, Avg loss: 0.0552, Accuracy: 283/1071 (26.4239%)
___Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 510/1071 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.1412, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 349/1372 (25.4373%)
___Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   2, Avg loss: 0.0306, Accuracy: 518/1372 (37.7551%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.9583, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   1, Avg loss: 0.0822, Accuracy: 63/460 (13.6957%)
___Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   2, Avg loss: 0.0366, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.8203, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0529, Accuracy: 338/599 (56.4274%)
___Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.6754, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 517/1470 (35.1701%)
___Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 838/1470 (57.0068%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0556, Accuracy: 70/10000 (0.7000%)
time spent on training: 250.68377470970154
[foolsgold agg] training data poison_ratio: 0.18698913895420446  data num: [515, 928, 466, 1154, 896, 1071, 1372, 460, 599, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.05843410592318889
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3095, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.5075, Accuracy: 0/9950 (0.0000%)
saving model
Done in 464.89574909210205 sec.
Server Epoch:80 choose agents : [15, 82, 40, 18, 44, 37, 29, 63, 0, 22].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   1, Avg loss: 0.0564, Accuracy: 339/1154 (29.3761%)
___Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   2, Avg loss: 0.0295, Accuracy: 375/1154 (32.4957%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.9680, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   1, Avg loss: 0.0753, Accuracy: 81/500 (16.2000%)
___Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   2, Avg loss: 0.0477, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.6873, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   1, Avg loss: 0.0540, Accuracy: 387/1573 (24.6027%)
___Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 565/1573 (35.9186%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.4501, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   1, Avg loss: 0.0760, Accuracy: 124/530 (23.3962%)
___Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   2, Avg loss: 0.0377, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.9660, Accuracy: 53/10000 (0.5300%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   1, Avg loss: 0.0585, Accuracy: 415/1750 (23.7143%)
___Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 678/1750 (38.7429%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.6467, Accuracy: 111/10000 (1.1100%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   1, Avg loss: 0.0520, Accuracy: 404/1129 (35.7839%)
___Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 737/1129 (65.2790%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.5099, Accuracy: 105/10000 (1.0500%)
___Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 438/1440 (30.4167%)
___Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 636/1440 (44.1667%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.0574, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 263/888 (29.6171%)
___Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 436/888 (49.0991%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.4902, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   1, Avg loss: 0.0578, Accuracy: 367/1657 (22.1485%)
___Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   2, Avg loss: 0.0343, Accuracy: 528/1657 (31.8648%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.6673, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   1, Avg loss: 0.0445, Accuracy: 551/1470 (37.4830%)
___Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 853/1470 (58.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.3249, Accuracy: 76/10000 (0.7600%)
time spent on training: 281.1355903148651
[foolsgold agg] training data poison_ratio: 0.47059796542883137  data num: [1154, 500, 1573, 530, 1750, 1129, 1440, 888, 1657, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.1470618641965098
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3095, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.5077, Accuracy: 0/9950 (0.0000%)
saving model
Done in 494.8383831977844 sec.
Server Epoch:81 choose agents : [62, 5, 56, 60, 10, 20, 90, 87, 72, 49].
___Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   1, Avg loss: 0.0678, Accuracy: 157/568 (27.6408%)
___Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.7456, Accuracy: 54/10000 (0.5400%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   1, Avg loss: 0.0499, Accuracy: 414/1628 (25.4300%)
___Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 843/1628 (51.7813%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.4305, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   1, Avg loss: 0.0825, Accuracy: 2/186 (1.0753%)
___Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   2, Avg loss: 0.0668, Accuracy: 71/186 (38.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0487, Accuracy: 652/2227 (29.2771%)
___Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0275, Accuracy: 1057/2227 (47.4630%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.1755, Accuracy: 125/10000 (1.2500%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   1, Avg loss: 0.0571, Accuracy: 213/861 (24.7387%)
___Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 440/861 (51.1034%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.1254, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
___Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   1, Avg loss: 0.0581, Accuracy: 339/807 (42.0074%)
___Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   2, Avg loss: 0.0311, Accuracy: 426/807 (52.7881%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.9923, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0567, Accuracy: 326/677 (48.1536%)
___Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0225, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.2756, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   1, Avg loss: 0.0578, Accuracy: 299/1131 (26.4368%)
___Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   2, Avg loss: 0.0318, Accuracy: 393/1131 (34.7480%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.7869, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 262/1241 (21.1120%)
___Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 379/1241 (30.5399%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.2273, Accuracy: 64/10000 (0.6400%)
poison local model 49 index 11 
___Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0783, Accuracy: 39/440 (8.8636%)
___Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0467, Accuracy: 150/440 (34.0909%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.5263, Accuracy: 50/10000 (0.5000%)
time spent on training: 264.2857689857483
[foolsgold agg] training data poison_ratio: 0.38255171001433547  data num: [568, 1628, 186, 2227, 861, 807, 677, 1131, 1241, 440]
[foolsgold agg] considering poison per batch poison_fraction: 0.11954740937947983
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3094, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.5067, Accuracy: 0/9950 (0.0000%)
saving model
Done in 478.70845794677734 sec.
Server Epoch:82 choose agents : [89, 71, 15, 22, 28, 59, 44, 72, 5, 64].
___Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   1, Avg loss: 0.0600, Accuracy: 335/896 (37.3884%)
___Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 453/896 (50.5580%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.2528, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   1, Avg loss: 0.0637, Accuracy: 164/818 (20.0489%)
___Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   2, Avg loss: 0.0301, Accuracy: 380/818 (46.4548%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.3485, Accuracy: 42/10000 (0.4200%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 334/1154 (28.9428%)
___Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 483/1154 (41.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.1146, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 546/1470 (37.1429%)
___Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 858/1470 (58.3673%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.1303, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0553, Accuracy: 408/1581 (25.8065%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 611/1581 (38.6464%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.8272, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0571, Accuracy: 324/1089 (29.7521%)
___Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0308, Accuracy: 430/1089 (39.4858%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.5921, Accuracy: 59/10000 (0.5900%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0587, Accuracy: 403/1750 (23.0286%)
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0344, Accuracy: 689/1750 (39.3714%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.3436, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0610, Accuracy: 254/1241 (20.4674%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 450/1241 (36.2611%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.0588, Accuracy: 56/10000 (0.5600%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   1, Avg loss: 0.0500, Accuracy: 410/1628 (25.1843%)
___Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   2, Avg loss: 0.0251, Accuracy: 850/1628 (52.2113%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.1986, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0640, Accuracy: 176/953 (18.4680%)
___Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 312/953 (32.7387%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.3736, Accuracy: 69/10000 (0.6900%)
time spent on training: 293.3529953956604
[foolsgold agg] training data poison_ratio: 0.3602543720190779  data num: [896, 818, 1154, 1470, 1581, 1089, 1750, 1241, 1628, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.11257949125596184
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3094, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.5059, Accuracy: 0/9950 (0.0000%)
saving model
Done in 506.8716070652008 sec.
Server Epoch:83 choose agents : [44, 18, 70, 97, 43, 93, 72, 24, 56, 94].
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0585, Accuracy: 405/1750 (23.1429%)
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 680/1750 (38.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.3410, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.0743, Accuracy: 124/530 (23.3962%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0390, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.1417, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 367/1418 (25.8815%)
___Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   2, Avg loss: 0.0302, Accuracy: 636/1418 (44.8519%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.4150, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   1, Avg loss: 0.0521, Accuracy: 366/1213 (30.1731%)
___Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 516/1213 (42.5392%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.7360, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0621, Accuracy: 304/946 (32.1353%)
___Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 367/946 (38.7949%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.0282, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0546, Accuracy: 420/1742 (24.1102%)
___Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 725/1742 (41.6188%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.6147, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   1, Avg loss: 0.0605, Accuracy: 257/1241 (20.7091%)
___Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 423/1241 (34.0854%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.2721, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   1, Avg loss: 0.0750, Accuracy: 47/312 (15.0641%)
___Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   2, Avg loss: 0.0395, Accuracy: 161/312 (51.6026%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3924, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 2/186 (1.0753%)
___Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0661, Accuracy: 81/186 (43.5484%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3111, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 384/1662 (23.1047%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0327, Accuracy: 609/1662 (36.6426%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.6053, Accuracy: 105/10000 (1.0500%)
time spent on training: 229.16302013397217
[foolsgold agg] training data poison_ratio: 0.1590909090909091  data num: [1750, 530, 1418, 1213, 946, 1742, 1241, 312, 186, 1662]
[foolsgold agg] considering poison per batch poison_fraction: 0.04971590909090909
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3093, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.5064, Accuracy: 0/9950 (0.0000%)
saving model
Done in 451.1636109352112 sec.
Server Epoch:84 choose agents : [16, 36, 51, 77, 39, 2, 42, 68, 53, 88].
___Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   1, Avg loss: 0.0634, Accuracy: 281/708 (39.6893%)
___Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   2, Avg loss: 0.0362, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.8394, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   1, Avg loss: 0.0872, Accuracy: 76/408 (18.6275%)
___Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   2, Avg loss: 0.0535, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.5043, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   1, Avg loss: 0.0595, Accuracy: 229/1049 (21.8303%)
___Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   2, Avg loss: 0.0292, Accuracy: 550/1049 (52.4309%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.4774, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   1, Avg loss: 0.0529, Accuracy: 338/1340 (25.2239%)
___Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   2, Avg loss: 0.0266, Accuracy: 598/1340 (44.6269%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.7165, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   1, Avg loss: 0.0544, Accuracy: 314/1013 (30.9970%)
___Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 468/1013 (46.1994%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.4988, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 238/605 (39.3388%)
___Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0401, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.8481, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   1, Avg loss: 0.0531, Accuracy: 351/1372 (25.5831%)
___Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 526/1372 (38.3382%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.7936, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   1, Avg loss: 0.0614, Accuracy: 375/1163 (32.2442%)
___Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   2, Avg loss: 0.0362, Accuracy: 481/1163 (41.3586%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.1221, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 287/813 (35.3014%)
___Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 452/813 (55.5966%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 9.6678, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 150/603 (24.8756%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0458, Accuracy: 289/603 (47.9270%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.8922, Accuracy: 53/10000 (0.5300%)
time spent on training: 231.16426157951355
[foolsgold agg] training data poison_ratio: 0.0  data num: [708, 408, 1049, 1340, 1013, 605, 1372, 1163, 813, 603]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3093, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.5071, Accuracy: 0/9950 (0.0000%)
saving model
Done in 448.03534054756165 sec.
Server Epoch:85 choose agents : [30, 92, 55, 31, 64, 72, 67, 34, 45, 53].
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0773, Accuracy: 93/486 (19.1358%)
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0387, Accuracy: 215/486 (44.2387%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.7801, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 465/1715 (27.1137%)
___Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 732/1715 (42.6822%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.6805, Accuracy: 76/10000 (0.7600%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   1, Avg loss: 0.0554, Accuracy: 271/1071 (25.3035%)
___Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 508/1071 (47.4323%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.0278, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0806, Accuracy: 74/460 (16.0870%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0386, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.8620, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0641, Accuracy: 188/953 (19.7272%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 283/953 (29.6957%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.4148, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 263/1241 (21.1926%)
___Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   2, Avg loss: 0.0368, Accuracy: 398/1241 (32.0709%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.2608, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   1, Avg loss: 0.0772, Accuracy: 61/426 (14.3192%)
___Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   2, Avg loss: 0.0419, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.5571, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   1, Avg loss: 0.0582, Accuracy: 411/1427 (28.8017%)
___Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 573/1427 (40.1542%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.9522, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   1, Avg loss: 0.0671, Accuracy: 204/669 (30.4933%)
___Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   2, Avg loss: 0.0400, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.8082, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   1, Avg loss: 0.0490, Accuracy: 286/813 (35.1784%)
___Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   2, Avg loss: 0.0186, Accuracy: 457/813 (56.2116%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.7876, Accuracy: 52/10000 (0.5200%)
time spent on training: 243.71504306793213
[foolsgold agg] training data poison_ratio: 0.16812439261418854  data num: [486, 1715, 1071, 460, 953, 1241, 426, 1427, 669, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.05253887269193392
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3092, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.5061, Accuracy: 0/9950 (0.0000%)
saving model
Done in 460.80120849609375 sec.
Server Epoch:86 choose agents : [2, 18, 97, 3, 99, 22, 44, 9, 74, 92].
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0626, Accuracy: 238/605 (39.3388%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0401, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.8119, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   1, Avg loss: 0.0752, Accuracy: 128/530 (24.1509%)
___Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   2, Avg loss: 0.0385, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.2115, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   1, Avg loss: 0.0516, Accuracy: 368/1213 (30.3380%)
___Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 514/1213 (42.3743%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.8567, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0727, Accuracy: 111/781 (14.2125%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 244/781 (31.2420%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.7664, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0655, Accuracy: 184/773 (23.8034%)
___Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0314, Accuracy: 386/773 (49.9353%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.6158, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 516/1470 (35.1020%)
___Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 805/1470 (54.7619%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.2765, Accuracy: 75/10000 (0.7500%)
poison local model 44 index 10 
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0588, Accuracy: 414/1750 (23.6571%)
___Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0348, Accuracy: 693/1750 (39.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.4738, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   1, Avg loss: 0.0489, Accuracy: 360/1275 (28.2353%)
___Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   2, Avg loss: 0.0192, Accuracy: 708/1275 (55.5294%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.7667, Accuracy: 95/10000 (0.9500%)
poison local model 74 index 2 
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 495/1552 (31.8943%)
___Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 809/1552 (52.1263%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 11.4752, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   1, Avg loss: 0.0511, Accuracy: 488/1715 (28.4548%)
___Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 706/1715 (41.1662%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.5299, Accuracy: 92/10000 (0.9200%)
time spent on training: 255.55908513069153
[foolsgold agg] training data poison_ratio: 0.28309327846364885  data num: [605, 530, 1213, 781, 773, 1470, 1750, 1275, 1552, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.08846664951989026
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3092, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.5065, Accuracy: 0/9950 (0.0000%)
saving model
Done in 477.4145083427429 sec.
Server Epoch:87 choose agents : [27, 69, 68, 61, 71, 23, 41, 98, 94, 52].
___Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   1, Avg loss: 0.0539, Accuracy: 444/1587 (27.9773%)
___Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 611/1587 (38.5003%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.0628, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0591, Accuracy: 294/590 (49.8305%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0329, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.8216, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0618, Accuracy: 380/1163 (32.6741%)
___Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0370, Accuracy: 435/1163 (37.4033%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.7333, Accuracy: 73/10000 (0.7300%)
poison local model 61 index 13 
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1260, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1158, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3035, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   1, Avg loss: 0.0633, Accuracy: 190/818 (23.2274%)
___Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 368/818 (44.9878%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.2620, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0630, Accuracy: 325/715 (45.4545%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0377, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.7480, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 330/719 (45.8971%)
___Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   2, Avg loss: 0.0321, Accuracy: 455/719 (63.2823%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.4304, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   1, Avg loss: 0.0794, Accuracy: 36/373 (9.6515%)
___Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   2, Avg loss: 0.0473, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.4501, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   1, Avg loss: 0.0542, Accuracy: 366/1662 (22.0217%)
___Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 597/1662 (35.9206%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.6230, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   1, Avg loss: 0.0547, Accuracy: 296/636 (46.5409%)
___Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.4999, Accuracy: 50/10000 (0.5000%)
time spent on training: 235.02532577514648
[foolsgold agg] training data poison_ratio: 0.010182079540009582  data num: [1587, 590, 1163, 85, 818, 715, 719, 373, 1662, 636]
[foolsgold agg] considering poison per batch poison_fraction: 0.0031818998562529945
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3091, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.5070, Accuracy: 0/9950 (0.0000%)
saving model
Done in 450.0290777683258 sec.
Server Epoch:88 choose agents : [48, 70, 99, 34, 64, 81, 0, 53, 31, 56].
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0707, Accuracy: 102/631 (16.1648%)
___Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 223/631 (35.3407%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.8561, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   1, Avg loss: 0.0559, Accuracy: 385/1418 (27.1509%)
___Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 660/1418 (46.5444%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.8635, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   1, Avg loss: 0.0633, Accuracy: 194/773 (25.0970%)
___Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   2, Avg loss: 0.0348, Accuracy: 414/773 (53.5576%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.3040, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0579, Accuracy: 384/1427 (26.9096%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0328, Accuracy: 600/1427 (42.0463%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.9725, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   1, Avg loss: 0.0636, Accuracy: 186/953 (19.5173%)
___Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   2, Avg loss: 0.0371, Accuracy: 323/953 (33.8930%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.6253, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0666, Accuracy: 244/774 (31.5245%)
___Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0378, Accuracy: 312/774 (40.3101%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.2662, Accuracy: 73/10000 (0.7300%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 366/1657 (22.0881%)
___Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   2, Avg loss: 0.0346, Accuracy: 515/1657 (31.0803%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0326, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   1, Avg loss: 0.0491, Accuracy: 285/813 (35.0554%)
___Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   2, Avg loss: 0.0181, Accuracy: 462/813 (56.8266%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.2123, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0807, Accuracy: 72/460 (15.6522%)
___Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.8038, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 2/186 (1.0753%)
___Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   2, Avg loss: 0.0667, Accuracy: 82/186 (44.0860%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3116, Accuracy: 50/10000 (0.5000%)
time spent on training: 216.23960208892822
[foolsgold agg] training data poison_ratio: 0.18224813022437308  data num: [631, 1418, 773, 1427, 953, 774, 1657, 813, 460, 186]
[foolsgold agg] considering poison per batch poison_fraction: 0.056952540695116585
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3091, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.5056, Accuracy: 0/9950 (0.0000%)
saving model
Done in 441.409455537796 sec.
Server Epoch:89 choose agents : [39, 68, 73, 96, 98, 22, 75, 79, 34, 43].
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 317/1013 (31.2932%)
___Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 480/1013 (47.3840%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.5962, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   1, Avg loss: 0.0615, Accuracy: 372/1163 (31.9862%)
___Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   2, Avg loss: 0.0359, Accuracy: 451/1163 (38.7790%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.9830, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   1, Avg loss: 0.0643, Accuracy: 175/938 (18.6567%)
___Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 324/938 (34.5416%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.4420, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   1, Avg loss: 0.0784, Accuracy: 52/311 (16.7203%)
___Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   2, Avg loss: 0.0524, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3496, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   1, Avg loss: 0.0795, Accuracy: 31/373 (8.3110%)
___Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   2, Avg loss: 0.0464, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.4563, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0452, Accuracy: 515/1470 (35.0340%)
___Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 856/1470 (58.2313%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.0974, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   1, Avg loss: 0.0641, Accuracy: 262/776 (33.7629%)
___Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   2, Avg loss: 0.0313, Accuracy: 413/776 (53.2216%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.8519, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   1, Avg loss: 0.1032, Accuracy: 14/197 (7.1066%)
___Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   2, Avg loss: 0.0801, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3191, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 394/1427 (27.6104%)
___Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 587/1427 (41.1352%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.9297, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0607, Accuracy: 311/946 (32.8753%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0356, Accuracy: 370/946 (39.1121%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.9509, Accuracy: 53/10000 (0.5300%)
time spent on training: 212.22752451896667
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 1163, 938, 311, 373, 1470, 776, 197, 1427, 946]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3090, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.5051, Accuracy: 0/9950 (0.0000%)
saving model
Done in 429.4043610095978 sec.
Server Epoch:90 choose agents : [0, 96, 92, 51, 57, 32, 6, 53, 79, 37].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   1, Avg loss: 0.0576, Accuracy: 364/1657 (21.9674%)
___Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 538/1657 (32.4683%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.7392, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 51/311 (16.3987%)
___Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3521, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 449/1715 (26.1808%)
___Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 738/1715 (43.0321%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.4484, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0590, Accuracy: 231/1049 (22.0210%)
___Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0294, Accuracy: 541/1049 (51.5729%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.5018, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   1, Avg loss: 0.0540, Accuracy: 314/1154 (27.2097%)
___Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   2, Avg loss: 0.0255, Accuracy: 476/1154 (41.2478%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.8321, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   1, Avg loss: 0.0584, Accuracy: 213/735 (28.9796%)
___Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   2, Avg loss: 0.0224, Accuracy: 382/735 (51.9728%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.0309, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 413/1956 (21.1145%)
___Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 666/1956 (34.0491%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.1849, Accuracy: 107/10000 (1.0700%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 290/813 (35.6704%)
___Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 455/813 (55.9656%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 9.3127, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   1, Avg loss: 0.1024, Accuracy: 14/197 (7.1066%)
___Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   2, Avg loss: 0.0842, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3193, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   1, Avg loss: 0.0513, Accuracy: 414/1129 (36.6696%)
___Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   2, Avg loss: 0.0237, Accuracy: 739/1129 (65.4562%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.4775, Accuracy: 94/10000 (0.9400%)
time spent on training: 291.9662764072418
[foolsgold agg] training data poison_ratio: 0.25998506905561775  data num: [1657, 311, 1715, 1049, 1154, 735, 1956, 813, 197, 1129]
[foolsgold agg] considering poison per batch poison_fraction: 0.08124533407988055
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3090, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.5026, Accuracy: 0/9950 (0.0000%)
saving model
Done in 509.0567910671234 sec.
Server Epoch:91 choose agents : [27, 46, 19, 29, 48, 47, 40, 89, 34, 83].
___Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 437/1587 (27.5362%)
___Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 634/1587 (39.9496%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.1967, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   1, Avg loss: 0.0543, Accuracy: 419/1904 (22.0063%)
___Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   2, Avg loss: 0.0311, Accuracy: 704/1904 (36.9748%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.6040, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   1, Avg loss: 0.0464, Accuracy: 428/1036 (41.3127%)
___Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   2, Avg loss: 0.0237, Accuracy: 692/1036 (66.7954%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 9.5062, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 414/1440 (28.7500%)
___Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   2, Avg loss: 0.0283, Accuracy: 662/1440 (45.9722%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.9194, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   1, Avg loss: 0.0700, Accuracy: 111/631 (17.5911%)
___Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 223/631 (35.3407%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.9325, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   1, Avg loss: 0.1236, Accuracy: 2/134 (1.4925%)
___Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   2, Avg loss: 0.1109, Accuracy: 19/134 (14.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 371/1573 (23.5855%)
___Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 544/1573 (34.5836%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.7121, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0599, Accuracy: 342/896 (38.1696%)
___Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 444/896 (49.5536%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.4427, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 403/1427 (28.2411%)
___Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 570/1427 (39.9439%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.8296, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   1, Avg loss: 0.0532, Accuracy: 452/1953 (23.1439%)
___Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 742/1953 (37.9928%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.8830, Accuracy: 107/10000 (1.0700%)
time spent on training: 254.6411542892456
[foolsgold agg] training data poison_ratio: 0.0  data num: [1587, 1904, 1036, 1440, 631, 134, 1573, 896, 1427, 1953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3089, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.5029, Accuracy: 0/9950 (0.0000%)
saving model
Done in 470.4834315776825 sec.
Server Epoch:92 choose agents : [9, 63, 42, 40, 83, 13, 84, 5, 75, 3].
___Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   1, Avg loss: 0.0485, Accuracy: 372/1275 (29.1765%)
___Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   2, Avg loss: 0.0187, Accuracy: 747/1275 (58.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 9.4138, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 270/888 (30.4054%)
___Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 417/888 (46.9595%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.3586, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0524, Accuracy: 352/1372 (25.6560%)
___Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 549/1372 (40.0146%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.2494, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 360/1573 (22.8862%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 534/1573 (33.9479%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.4801, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 442/1953 (22.6318%)
___Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   2, Avg loss: 0.0330, Accuracy: 813/1953 (41.6283%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.8045, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0560, Accuracy: 340/1645 (20.6687%)
___Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0322, Accuracy: 640/1645 (38.9058%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.8834, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   1, Avg loss: 0.0621, Accuracy: 318/1190 (26.7227%)
___Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 430/1190 (36.1345%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.3397, Accuracy: 56/10000 (0.5600%)
poison local model 5 index 4 
___Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   1, Avg loss: 0.0497, Accuracy: 422/1628 (25.9214%)
___Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   2, Avg loss: 0.0245, Accuracy: 873/1628 (53.6241%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.3248, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0620, Accuracy: 260/776 (33.5052%)
___Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0304, Accuracy: 400/776 (51.5464%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.1661, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0726, Accuracy: 122/781 (15.6210%)
___Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0353, Accuracy: 229/781 (29.3214%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.7977, Accuracy: 73/10000 (0.7300%)
time spent on training: 306.8157889842987
[foolsgold agg] training data poison_ratio: 0.1244553168717988  data num: [1275, 888, 1372, 1573, 1953, 1645, 1190, 1628, 776, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.038892286522437126
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3089, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.5032, Accuracy: 0/9950 (0.0000%)
saving model
Done in 529.1683173179626 sec.
Server Epoch:93 choose agents : [59, 28, 10, 95, 89, 1, 69, 50, 30, 17].
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 318/1089 (29.2011%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 461/1089 (42.3324%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.2541, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   1, Avg loss: 0.0552, Accuracy: 414/1581 (26.1860%)
___Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   2, Avg loss: 0.0330, Accuracy: 618/1581 (39.0892%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.6404, Accuracy: 99/10000 (0.9900%)
poison local model 10 index 5 
___Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   1, Avg loss: 0.0565, Accuracy: 216/861 (25.0871%)
___Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   2, Avg loss: 0.0208, Accuracy: 481/861 (55.8653%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.1767, Accuracy: 68/10000 (0.6800%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   1, Avg loss: 0.0521, Accuracy: 331/599 (55.2588%)
___Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   2, Avg loss: 0.0299, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.8070, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 329/896 (36.7188%)
___Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 446/896 (49.7768%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.3055, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0564, Accuracy: 290/928 (31.2500%)
___Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0229, Accuracy: 603/928 (64.9784%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.8113, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   1, Avg loss: 0.0549, Accuracy: 295/590 (50.0000%)
___Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   2, Avg loss: 0.0318, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.2939, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   1, Avg loss: 0.0622, Accuracy: 159/809 (19.6539%)
___Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 347/809 (42.8925%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.2723, Accuracy: 85/10000 (0.8500%)
poison local model 30 index 8 
___Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   1, Avg loss: 0.0776, Accuracy: 87/486 (17.9012%)
___Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   2, Avg loss: 0.0398, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.8527, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 411/1574 (26.1118%)
___Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 667/1574 (42.3761%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.3765, Accuracy: 97/10000 (0.9700%)
time spent on training: 278.9862153530121
[foolsgold agg] training data poison_ratio: 0.2067353659832147  data num: [1089, 1581, 861, 599, 896, 928, 590, 809, 486, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.06460480186975459
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3088, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.5033, Accuracy: 0/9950 (0.0000%)
saving model
Done in 495.78486800193787 sec.
Server Epoch:94 choose agents : [34, 35, 88, 8, 41, 2, 25, 18, 54, 79].
___Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   1, Avg loss: 0.0572, Accuracy: 410/1427 (28.7316%)
___Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 598/1427 (41.9061%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.8587, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.0859, Accuracy: 42/271 (15.4982%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0547, Accuracy: 104/271 (38.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3677, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   1, Avg loss: 0.0742, Accuracy: 146/603 (24.2123%)
___Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   2, Avg loss: 0.0442, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.0121, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   1, Avg loss: 0.0592, Accuracy: 250/1513 (16.5235%)
___Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   2, Avg loss: 0.0358, Accuracy: 502/1513 (33.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.3521, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   1, Avg loss: 0.0584, Accuracy: 338/719 (47.0097%)
___Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   2, Avg loss: 0.0314, Accuracy: 448/719 (62.3088%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.4055, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0620, Accuracy: 230/605 (38.0165%)
___Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0401, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.8702, Accuracy: 51/10000 (0.5100%)
poison local model 25 index 7 
___Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   1, Avg loss: 0.0553, Accuracy: 312/690 (45.2174%)
___Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 461/690 (66.8116%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.6130, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   1, Avg loss: 0.0739, Accuracy: 123/530 (23.2075%)
___Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   2, Avg loss: 0.0382, Accuracy: 261/530 (49.2453%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.1493, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 346/1130 (30.6195%)
___Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0290, Accuracy: 445/1130 (39.3805%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.5650, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   1, Avg loss: 0.1017, Accuracy: 8/197 (4.0609%)
___Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   2, Avg loss: 0.0843, Accuracy: 57/197 (28.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3203, Accuracy: 50/10000 (0.5000%)
time spent on training: 198.105318069458
[foolsgold agg] training data poison_ratio: 0.08978529603122967  data num: [1427, 271, 603, 1513, 719, 605, 690, 530, 1130, 197]
[foolsgold agg] considering poison per batch poison_fraction: 0.02805790500975927
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3088, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.5040, Accuracy: 0/9950 (0.0000%)
saving model
Done in 409.8026444911957 sec.
Server Epoch:95 choose agents : [66, 86, 64, 27, 37, 55, 33, 62, 57, 28].
___Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   1, Avg loss: 0.0612, Accuracy: 279/1402 (19.9001%)
___Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 399/1402 (28.4593%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.0833, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   1, Avg loss: 0.0616, Accuracy: 368/1003 (36.6899%)
___Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   2, Avg loss: 0.0348, Accuracy: 376/1003 (37.4875%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.8495, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   1, Avg loss: 0.0636, Accuracy: 183/953 (19.2025%)
___Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   2, Avg loss: 0.0373, Accuracy: 315/953 (33.0535%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.5618, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 468/1587 (29.4896%)
___Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 631/1587 (39.7606%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.1002, Accuracy: 73/10000 (0.7300%)
poison local model 37 index 9 
___Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   1, Avg loss: 0.0517, Accuracy: 413/1129 (36.5810%)
___Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   2, Avg loss: 0.0237, Accuracy: 757/1129 (67.0505%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.6152, Accuracy: 95/10000 (0.9500%)
poison local model 55 index 12 
___Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   1, Avg loss: 0.0551, Accuracy: 278/1071 (25.9570%)
___Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 543/1071 (50.7003%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.5173, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   1, Avg loss: 0.0785, Accuracy: 77/515 (14.9515%)
___Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   2, Avg loss: 0.0542, Accuracy: 119/515 (23.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.8210, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   1, Avg loss: 0.0675, Accuracy: 160/568 (28.1690%)
___Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   2, Avg loss: 0.0399, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.7775, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0539, Accuracy: 309/1154 (26.7764%)
___Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0264, Accuracy: 466/1154 (40.3813%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.1938, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 390/1581 (24.6679%)
___Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 624/1581 (39.4687%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.7988, Accuracy: 90/10000 (0.9000%)
time spent on training: 313.5323405265808
[foolsgold agg] training data poison_ratio: 0.2006749977196023  data num: [1402, 1003, 953, 1587, 1129, 1071, 515, 568, 1154, 1581]
[foolsgold agg] considering poison per batch poison_fraction: 0.06271093678737572
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3088, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.5030, Accuracy: 0/9950 (0.0000%)
saving model
Done in 528.3645145893097 sec.
Server Epoch:96 choose agents : [6, 3, 92, 4, 1, 12, 48, 2, 69, 13].
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 382/1956 (19.5297%)
___Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0312, Accuracy: 679/1956 (34.7137%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.6613, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0726, Accuracy: 107/781 (13.7004%)
___Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0354, Accuracy: 237/781 (30.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.6519, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 474/1715 (27.6385%)
___Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   2, Avg loss: 0.0301, Accuracy: 741/1715 (43.2070%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.4331, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0606, Accuracy: 339/901 (37.6249%)
___Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0317, Accuracy: 373/901 (41.3984%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.3501, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0560, Accuracy: 301/928 (32.4353%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0231, Accuracy: 577/928 (62.1767%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.7522, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0865, Accuracy: 28/338 (8.2840%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0450, Accuracy: 159/338 (47.0414%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.4641, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   1, Avg loss: 0.0700, Accuracy: 115/631 (18.2250%)
___Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   2, Avg loss: 0.0412, Accuracy: 226/631 (35.8162%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.9599, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0624, Accuracy: 238/605 (39.3388%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0397, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.8447, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   1, Avg loss: 0.0568, Accuracy: 295/590 (50.0000%)
___Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   2, Avg loss: 0.0311, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.7925, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   1, Avg loss: 0.0566, Accuracy: 336/1645 (20.4255%)
___Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 629/1645 (38.2371%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.7460, Accuracy: 132/10000 (1.3200%)
time spent on training: 246.09695029258728
[foolsgold agg] training data poison_ratio: 0.0  data num: [1956, 781, 1715, 901, 928, 338, 631, 605, 590, 1645]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3087, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.5032, Accuracy: 0/9950 (0.0000%)
saving model
Done in 463.2387113571167 sec.
Server Epoch:97 choose agents : [34, 90, 11, 2, 35, 50, 85, 72, 3, 18].
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0579, Accuracy: 388/1427 (27.1899%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0324, Accuracy: 609/1427 (42.6769%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.7859, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   1, Avg loss: 0.0558, Accuracy: 330/677 (48.7445%)
___Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   2, Avg loss: 0.0237, Accuracy: 445/677 (65.7312%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.3201, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   1, Avg loss: 0.0555, Accuracy: 349/712 (49.0169%)
___Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 407/712 (57.1629%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.6099, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0625, Accuracy: 229/605 (37.8512%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.8258, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0852, Accuracy: 48/271 (17.7122%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0535, Accuracy: 110/271 (40.5904%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3728, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   1, Avg loss: 0.0620, Accuracy: 161/809 (19.9011%)
___Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   2, Avg loss: 0.0265, Accuracy: 374/809 (46.2299%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.2869, Accuracy: 83/10000 (0.8300%)
poison local model 85 index 15 
___Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 472/1988 (23.7425%)
___Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 701/1988 (35.2616%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.8262, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0600, Accuracy: 269/1241 (21.6761%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 425/1241 (34.2466%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.9950, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0716, Accuracy: 129/781 (16.5173%)
___Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0360, Accuracy: 235/781 (30.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.7846, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   1, Avg loss: 0.0748, Accuracy: 121/530 (22.8302%)
___Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   2, Avg loss: 0.0371, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.1343, Accuracy: 62/10000 (0.6200%)
time spent on training: 222.40701460838318
[foolsgold agg] training data poison_ratio: 0.21988718062161267  data num: [1427, 677, 712, 605, 271, 809, 1988, 1241, 781, 530]
[foolsgold agg] considering poison per batch poison_fraction: 0.06871474394425396
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3087, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.5033, Accuracy: 0/9950 (0.0000%)
saving model
Done in 444.0647599697113 sec.
Server Epoch:98 choose agents : [7, 45, 42, 97, 87, 98, 9, 32, 48, 31].
___Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   1, Avg loss: 0.0528, Accuracy: 366/891 (41.0774%)
___Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 429/891 (48.1481%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.2470, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   1, Avg loss: 0.0671, Accuracy: 211/669 (31.5396%)
___Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   2, Avg loss: 0.0397, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.8228, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 351/1372 (25.5831%)
___Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 531/1372 (38.7026%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.8838, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   1, Avg loss: 0.0510, Accuracy: 354/1213 (29.1838%)
___Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   2, Avg loss: 0.0268, Accuracy: 525/1213 (43.2811%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.0249, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0582, Accuracy: 304/1131 (26.8789%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0319, Accuracy: 393/1131 (34.7480%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.0032, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   1, Avg loss: 0.0792, Accuracy: 36/373 (9.6515%)
___Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   2, Avg loss: 0.0464, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.4558, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   1, Avg loss: 0.0488, Accuracy: 375/1275 (29.4118%)
___Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   2, Avg loss: 0.0191, Accuracy: 738/1275 (57.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.5882, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0585, Accuracy: 219/735 (29.7959%)
___Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0221, Accuracy: 371/735 (50.4762%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.3638, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   1, Avg loss: 0.0699, Accuracy: 108/631 (17.1157%)
___Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 221/631 (35.0238%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.8693, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   1, Avg loss: 0.0807, Accuracy: 72/460 (15.6522%)
___Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.7737, Accuracy: 50/10000 (0.5000%)
time spent on training: 258.568567276001
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 669, 1372, 1213, 1131, 373, 1275, 735, 631, 460]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3087, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.5008, Accuracy: 0/9950 (0.0000%)
saving model
Done in 474.0599205493927 sec.
Server Epoch:99 choose agents : [64, 82, 67, 73, 95, 84, 19, 29, 39, 26].
___Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   1, Avg loss: 0.0631, Accuracy: 172/953 (18.0483%)
___Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 298/953 (31.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.6497, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1, Avg loss: 0.0754, Accuracy: 76/500 (15.2000%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.7291, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   1, Avg loss: 0.0768, Accuracy: 59/426 (13.8498%)
___Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   2, Avg loss: 0.0409, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.6388, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   1, Avg loss: 0.0646, Accuracy: 182/938 (19.4030%)
___Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   2, Avg loss: 0.0322, Accuracy: 355/938 (37.8465%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.3532, Accuracy: 56/10000 (0.5600%)
poison local model 95 index 3 
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0522, Accuracy: 337/599 (56.2604%)
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0273, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.8603, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   1, Avg loss: 0.0614, Accuracy: 333/1190 (27.9832%)
___Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   2, Avg loss: 0.0316, Accuracy: 469/1190 (39.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.1488, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 415/1036 (40.0579%)
___Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   2, Avg loss: 0.0240, Accuracy: 649/1036 (62.6448%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.0355, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 400/1440 (27.7778%)
___Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   2, Avg loss: 0.0274, Accuracy: 676/1440 (46.9444%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.8596, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   1, Avg loss: 0.0532, Accuracy: 322/1013 (31.7868%)
___Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 502/1013 (49.5558%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.6502, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 351/1446 (24.2739%)
___Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 466/1446 (32.2268%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.3916, Accuracy: 66/10000 (0.6600%)
time spent on training: 228.612802028656
[foolsgold agg] training data poison_ratio: 0.06278167906927995  data num: [953, 500, 426, 938, 599, 1190, 1036, 1440, 1013, 1446]
[foolsgold agg] considering poison per batch poison_fraction: 0.019619274709149984
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3086, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.4989, Accuracy: 0/9950 (0.0000%)
saving model
Done in 442.50582671165466 sec.
Server Epoch:100 choose agents : [68, 28, 58, 41, 78, 29, 94, 45, 73, 15].
___Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   1, Avg loss: 0.0611, Accuracy: 367/1163 (31.5563%)
___Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   2, Avg loss: 0.0367, Accuracy: 427/1163 (36.7154%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.7249, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   1, Avg loss: 0.0557, Accuracy: 386/1581 (24.4149%)
___Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 587/1581 (37.1284%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7936, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 351/803 (43.7111%)
___Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 404/803 (50.3113%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.2250, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   1, Avg loss: 0.0580, Accuracy: 335/719 (46.5925%)
___Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   2, Avg loss: 0.0314, Accuracy: 459/719 (63.8387%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.4205, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   1, Avg loss: 0.0830, Accuracy: 49/416 (11.7788%)
___Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   2, Avg loss: 0.0449, Accuracy: 187/416 (44.9519%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.5822, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   1, Avg loss: 0.0496, Accuracy: 415/1440 (28.8194%)
___Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 686/1440 (47.6389%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.9394, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   1, Avg loss: 0.0545, Accuracy: 340/1662 (20.4573%)
___Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   2, Avg loss: 0.0323, Accuracy: 644/1662 (38.7485%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.8081, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   1, Avg loss: 0.0673, Accuracy: 204/669 (30.4933%)
___Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   2, Avg loss: 0.0399, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.9347, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   1, Avg loss: 0.0649, Accuracy: 178/938 (18.9765%)
___Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   2, Avg loss: 0.0333, Accuracy: 331/938 (35.2878%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.4021, Accuracy: 47/10000 (0.4700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   1, Avg loss: 0.0552, Accuracy: 339/1154 (29.3761%)
___Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   2, Avg loss: 0.0283, Accuracy: 491/1154 (42.5477%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.9199, Accuracy: 50/10000 (0.5000%)
time spent on training: 300.22133469581604
[foolsgold agg] training data poison_ratio: 0.1094357515410147  data num: [1163, 1581, 803, 719, 416, 1440, 1662, 669, 938, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.034198672356567095
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3086, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.4979, Accuracy: 0/9950 (0.0000%)
saving model
Done in 517.1528782844543 sec.
Saving all the graphs.
This run has a label: Jun.17_22.23.59. Visdom environment: tiny
