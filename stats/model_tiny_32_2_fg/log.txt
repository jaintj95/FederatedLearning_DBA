current path: saved_models/model_tiny_Jun.18_07.29.14
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 3, 5, 9, 10, 12, 15, 18, 20, 24, 25, 30, 33, 36, 37, 42, 44, 48, 49, 54, 55, 60, 61, 65, 69, 72, 74, 78, 81, 84, 85, 95]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [37, 44, 94, 74, 82, 83, 41, 65, 26, 24].
poison local model 37 index 14 
___Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   1, Avg loss: 0.0529, Accuracy: 383/1129 (33.9238%)
___Train Local_ResNet_18, epoch   1, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 720/1129 (63.7733%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.1980, Accuracy: 103/10000 (1.0300%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 395/1750 (22.5714%)
___Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0356, Accuracy: 684/1750 (39.0857%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9298, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   1, Avg loss: 0.0556, Accuracy: 336/1662 (20.2166%)
___Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   2, Avg loss: 0.0338, Accuracy: 591/1662 (35.5596%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 8.1438, Accuracy: 111/10000 (1.1100%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 506/1552 (32.6031%)
___Train Local_ResNet_18, epoch   1, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 768/1552 (49.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 10.4852, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 56/500 (11.2000%)
___Train Local_ResNet_18, epoch   1, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5957, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   1, Avg loss: 0.0548, Accuracy: 406/1953 (20.7885%)
___Train Local_ResNet_18, epoch   1, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 781/1953 (39.9898%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.9235, Accuracy: 114/10000 (1.1400%)
___Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   1, Avg loss: 0.0630, Accuracy: 318/719 (44.2281%)
___Train Local_ResNet_18, epoch   1, local model 41, internal_epoch   2, Avg loss: 0.0307, Accuracy: 439/719 (61.0570%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.1057, Accuracy: 49/10000 (0.4900%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0574, Accuracy: 376/1475 (25.4915%)
___Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0307, Accuracy: 691/1475 (46.8475%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.7157, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 337/1446 (23.3057%)
___Train Local_ResNet_18, epoch   1, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 503/1446 (34.7856%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.2692, Accuracy: 52/10000 (0.5200%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   1, Avg loss: 0.0774, Accuracy: 27/312 (8.6538%)
___Train Local_ResNet_18, epoch   1, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 168/312 (53.8462%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3878, Accuracy: 50/10000 (0.5000%)
time spent on training: 201.22193217277527
[foolsgold agg] training data poison_ratio: 0.49751960313650184  data num: [1129, 1750, 1662, 1552, 500, 1953, 719, 1475, 1446, 312]
[foolsgold agg] considering poison per batch poison_fraction: 0.31094975196031366
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3169, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6215, Accuracy: 0/9950 (0.0000%)
saving model
Done in 613.0587332248688 sec.
Server Epoch:2 choose agents : [94, 71, 66, 35, 38, 84, 42, 43, 11, 95].
___Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 339/1662 (20.3971%)
___Train Local_ResNet_18, epoch   2, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 594/1662 (35.7401%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.6889, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   1, Avg loss: 0.0651, Accuracy: 150/818 (18.3374%)
___Train Local_ResNet_18, epoch   2, local model 71, internal_epoch   2, Avg loss: 0.0304, Accuracy: 386/818 (47.1883%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8945, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 258/1402 (18.4023%)
___Train Local_ResNet_18, epoch   2, local model 66, internal_epoch   2, Avg loss: 0.0389, Accuracy: 390/1402 (27.8174%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.0139, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   1, Avg loss: 0.0864, Accuracy: 39/271 (14.3911%)
___Train Local_ResNet_18, epoch   2, local model 35, internal_epoch   2, Avg loss: 0.0569, Accuracy: 97/271 (35.7934%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3617, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   1, Avg loss: 0.0625, Accuracy: 234/1131 (20.6897%)
___Train Local_ResNet_18, epoch   2, local model 38, internal_epoch   2, Avg loss: 0.0317, Accuracy: 446/1131 (39.4341%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.3322, Accuracy: 74/10000 (0.7400%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   1, Avg loss: 0.0636, Accuracy: 317/1190 (26.6387%)
___Train Local_ResNet_18, epoch   2, local model 84, internal_epoch   2, Avg loss: 0.0331, Accuracy: 437/1190 (36.7227%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8520, Accuracy: 57/10000 (0.5700%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 348/1372 (25.3644%)
___Train Local_ResNet_18, epoch   2, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 549/1372 (40.0146%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.7857, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 296/946 (31.2896%)
___Train Local_ResNet_18, epoch   2, local model 43, internal_epoch   2, Avg loss: 0.0363, Accuracy: 351/946 (37.1036%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.9270, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   1, Avg loss: 0.0576, Accuracy: 347/712 (48.7360%)
___Train Local_ResNet_18, epoch   2, local model 11, internal_epoch   2, Avg loss: 0.0253, Accuracy: 401/712 (56.3202%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.2797, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   1, Avg loss: 0.0518, Accuracy: 329/599 (54.9249%)
___Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   2, Avg loss: 0.0302, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.8678, Accuracy: 50/10000 (0.5000%)
time spent on training: 214.3451442718506
[foolsgold agg] training data poison_ratio: 0.3128773631594576  data num: [1662, 818, 1402, 271, 1131, 1190, 1372, 946, 712, 599]
[foolsgold agg] considering poison per batch poison_fraction: 0.19554835197466097
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3168, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6219, Accuracy: 0/9950 (0.0000%)
saving model
Done in 603.289966583252 sec.
Server Epoch:3 choose agents : [15, 88, 13, 42, 72, 22, 6, 0, 69, 17].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   1, Avg loss: 0.0567, Accuracy: 315/1154 (27.2964%)
___Train Local_ResNet_18, epoch   3, local model 15, internal_epoch   2, Avg loss: 0.0296, Accuracy: 389/1154 (33.7088%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5539, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   1, Avg loss: 0.0745, Accuracy: 135/603 (22.3881%)
___Train Local_ResNet_18, epoch   3, local model 88, internal_epoch   2, Avg loss: 0.0463, Accuracy: 289/603 (47.9270%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.8799, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0587, Accuracy: 303/1645 (18.4195%)
___Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 600/1645 (36.4742%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6507, Accuracy: 126/10000 (1.2600%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   1, Avg loss: 0.0536, Accuracy: 344/1372 (25.0729%)
___Train Local_ResNet_18, epoch   3, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 496/1372 (36.1516%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6922, Accuracy: 69/10000 (0.6900%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   1, Avg loss: 0.0625, Accuracy: 259/1241 (20.8703%)
___Train Local_ResNet_18, epoch   3, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 416/1241 (33.5214%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1264, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 528/1470 (35.9184%)
___Train Local_ResNet_18, epoch   3, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 858/1470 (58.3673%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.1237, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   1, Avg loss: 0.0551, Accuracy: 372/1956 (19.0184%)
___Train Local_ResNet_18, epoch   3, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 668/1956 (34.1513%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.4625, Accuracy: 110/10000 (1.1000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 358/1657 (21.6053%)
___Train Local_ResNet_18, epoch   3, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 537/1657 (32.4080%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5738, Accuracy: 58/10000 (0.5800%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   1, Avg loss: 0.0587, Accuracy: 274/590 (46.4407%)
___Train Local_ResNet_18, epoch   3, local model 69, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.5817, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 380/1574 (24.1423%)
___Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0282, Accuracy: 647/1574 (41.1055%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.3424, Accuracy: 94/10000 (0.9400%)
time spent on training: 196.10593128204346
[foolsgold agg] training data poison_ratio: 0.4534760971195898  data num: [1154, 603, 1645, 1372, 1241, 1470, 1956, 1657, 590, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.28342256069974364
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3167, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6220, Accuracy: 0/9950 (0.0000%)
saving model
Done in 592.9686141014099 sec.
Server Epoch:4 choose agents : [31, 94, 47, 15, 11, 35, 62, 77, 21, 93].
___Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   1, Avg loss: 0.0822, Accuracy: 52/460 (11.3043%)
___Train Local_ResNet_18, epoch   4, local model 31, internal_epoch   2, Avg loss: 0.0379, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.6891, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 344/1662 (20.6980%)
___Train Local_ResNet_18, epoch   4, local model 94, internal_epoch   2, Avg loss: 0.0336, Accuracy: 612/1662 (36.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.8921, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   1, Avg loss: 0.1248, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch   4, local model 47, internal_epoch   2, Avg loss: 0.1109, Accuracy: 11/134 (8.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3119, Accuracy: 50/10000 (0.5000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   1, Avg loss: 0.0576, Accuracy: 311/1154 (26.9497%)
___Train Local_ResNet_18, epoch   4, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 396/1154 (34.3154%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.6854, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   1, Avg loss: 0.0550, Accuracy: 341/712 (47.8933%)
___Train Local_ResNet_18, epoch   4, local model 11, internal_epoch   2, Avg loss: 0.0270, Accuracy: 409/712 (57.4438%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.2932, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   1, Avg loss: 0.0860, Accuracy: 35/271 (12.9151%)
___Train Local_ResNet_18, epoch   4, local model 35, internal_epoch   2, Avg loss: 0.0566, Accuracy: 100/271 (36.9004%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3591, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0693, Accuracy: 132/568 (23.2394%)
___Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0416, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.8001, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0542, Accuracy: 315/1340 (23.5075%)
___Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 566/1340 (42.2388%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.6456, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 396/1949 (20.3181%)
___Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 625/1949 (32.0677%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.2370, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   1, Avg loss: 0.0566, Accuracy: 416/1742 (23.8806%)
___Train Local_ResNet_18, epoch   4, local model 93, internal_epoch   2, Avg loss: 0.0323, Accuracy: 660/1742 (37.8875%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.0618, Accuracy: 88/10000 (0.8800%)
time spent on training: 127.32851362228394
[foolsgold agg] training data poison_ratio: 0.11549239391513211  data num: [460, 1662, 134, 1154, 712, 271, 568, 1340, 1949, 1742]
[foolsgold agg] considering poison per batch poison_fraction: 0.07218274619695757
[foolsgold agg] wv: [0.91898212 1.         0.91898212 1.         1.         1.
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3165, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6208, Accuracy: 0/9950 (0.0000%)
saving model
Done in 532.7262456417084 sec.
Server Epoch:5 choose agents : [91, 78, 82, 2, 77, 31, 70, 65, 60, 36].
___Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   1, Avg loss: 0.0538, Accuracy: 331/1030 (32.1359%)
___Train Local_ResNet_18, epoch   5, local model 91, internal_epoch   2, Avg loss: 0.0266, Accuracy: 633/1030 (61.4563%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.7877, Accuracy: 81/10000 (0.8100%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   1, Avg loss: 0.0845, Accuracy: 27/416 (6.4904%)
___Train Local_ResNet_18, epoch   5, local model 78, internal_epoch   2, Avg loss: 0.0469, Accuracy: 178/416 (42.7885%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.5370, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 62/500 (12.4000%)
___Train Local_ResNet_18, epoch   5, local model 82, internal_epoch   2, Avg loss: 0.0487, Accuracy: 167/500 (33.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.6302, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 225/605 (37.1901%)
___Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0387, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7981, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   1, Avg loss: 0.0542, Accuracy: 320/1340 (23.8806%)
___Train Local_ResNet_18, epoch   5, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 546/1340 (40.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.7192, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   1, Avg loss: 0.0818, Accuracy: 56/460 (12.1739%)
___Train Local_ResNet_18, epoch   5, local model 31, internal_epoch   2, Avg loss: 0.0387, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7154, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 317/1418 (22.3554%)
___Train Local_ResNet_18, epoch   5, local model 70, internal_epoch   2, Avg loss: 0.0316, Accuracy: 643/1418 (45.3456%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6134, Accuracy: 79/10000 (0.7900%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   1, Avg loss: 0.0552, Accuracy: 392/1475 (26.5763%)
___Train Local_ResNet_18, epoch   5, local model 65, internal_epoch   2, Avg loss: 0.0308, Accuracy: 665/1475 (45.0847%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.9295, Accuracy: 87/10000 (0.8700%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 580/2227 (26.0440%)
___Train Local_ResNet_18, epoch   5, local model 60, internal_epoch   2, Avg loss: 0.0285, Accuracy: 1023/2227 (45.9362%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.3946, Accuracy: 121/10000 (1.2100%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   1, Avg loss: 0.0880, Accuracy: 72/408 (17.6471%)
___Train Local_ResNet_18, epoch   5, local model 36, internal_epoch   2, Avg loss: 0.0559, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.4658, Accuracy: 50/10000 (0.5000%)
time spent on training: 180.35211515426636
[foolsgold agg] training data poison_ratio: 0.4581435367952222  data num: [1030, 416, 500, 605, 1340, 460, 1418, 1475, 2227, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.28633971049701384
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3163, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.6171, Accuracy: 0/9950 (0.0000%)
saving model
Done in 565.4284541606903 sec.
Server Epoch:6 choose agents : [63, 42, 69, 72, 83, 44, 79, 50, 66, 74].
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 260/888 (29.2793%)
___Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 415/888 (46.7342%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.2579, Accuracy: 50/10000 (0.5000%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 341/1372 (24.8542%)
___Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 515/1372 (37.5364%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.7624, Accuracy: 66/10000 (0.6600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   1, Avg loss: 0.0571, Accuracy: 281/590 (47.6271%)
___Train Local_ResNet_18, epoch   6, local model 69, internal_epoch   2, Avg loss: 0.0306, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.7382, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   1, Avg loss: 0.0621, Accuracy: 226/1241 (18.2111%)
___Train Local_ResNet_18, epoch   6, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 407/1241 (32.7961%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.1299, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   1, Avg loss: 0.0542, Accuracy: 458/1953 (23.4511%)
___Train Local_ResNet_18, epoch   6, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 783/1953 (40.0922%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.2295, Accuracy: 86/10000 (0.8600%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 360/1750 (20.5714%)
___Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0357, Accuracy: 640/1750 (36.5714%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8613, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   1, Avg loss: 0.1017, Accuracy: 12/197 (6.0914%)
___Train Local_ResNet_18, epoch   6, local model 79, internal_epoch   2, Avg loss: 0.0788, Accuracy: 57/197 (28.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3243, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0634, Accuracy: 146/809 (18.0470%)
___Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 355/809 (43.8813%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.0384, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 255/1402 (18.1883%)
___Train Local_ResNet_18, epoch   6, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 367/1402 (26.1769%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.1232, Accuracy: 71/10000 (0.7100%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 484/1552 (31.1856%)
___Train Local_ResNet_18, epoch   6, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 764/1552 (49.2268%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 10.8183, Accuracy: 94/10000 (0.9400%)
time spent on training: 199.02772450447083
[foolsgold agg] training data poison_ratio: 0.5534286200442402  data num: [888, 1372, 590, 1241, 1953, 1750, 197, 809, 1402, 1552]
[foolsgold agg] considering poison per batch poison_fraction: 0.34589288752765013
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3162, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.6170, Accuracy: 0/9950 (0.0000%)
saving model
Done in 588.9939641952515 sec.
Server Epoch:7 choose agents : [82, 90, 50, 35, 0, 79, 25, 37, 16, 60].
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0770, Accuracy: 65/500 (13.0000%)
___Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6592, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   1, Avg loss: 0.0583, Accuracy: 314/677 (46.3811%)
___Train Local_ResNet_18, epoch   7, local model 90, internal_epoch   2, Avg loss: 0.0225, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.0732, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   1, Avg loss: 0.0635, Accuracy: 132/809 (16.3164%)
___Train Local_ResNet_18, epoch   7, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 360/809 (44.4994%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.0316, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   1, Avg loss: 0.0851, Accuracy: 42/271 (15.4982%)
___Train Local_ResNet_18, epoch   7, local model 35, internal_epoch   2, Avg loss: 0.0557, Accuracy: 98/271 (36.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3646, Accuracy: 43/10000 (0.4300%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 356/1657 (21.4846%)
___Train Local_ResNet_18, epoch   7, local model 0, internal_epoch   2, Avg loss: 0.0353, Accuracy: 517/1657 (31.2010%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.5718, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   1, Avg loss: 0.1011, Accuracy: 15/197 (7.6142%)
___Train Local_ResNet_18, epoch   7, local model 79, internal_epoch   2, Avg loss: 0.0857, Accuracy: 63/197 (31.9797%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3225, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   1, Avg loss: 0.0571, Accuracy: 304/690 (44.0580%)
___Train Local_ResNet_18, epoch   7, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.4906, Accuracy: 66/10000 (0.6600%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 405/1129 (35.8725%)
___Train Local_ResNet_18, epoch   7, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 730/1129 (64.6590%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.4237, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   1, Avg loss: 0.0615, Accuracy: 269/708 (37.9944%)
___Train Local_ResNet_18, epoch   7, local model 16, internal_epoch   2, Avg loss: 0.0383, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.7872, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   1, Avg loss: 0.0500, Accuracy: 592/2227 (26.5828%)
___Train Local_ResNet_18, epoch   7, local model 60, internal_epoch   2, Avg loss: 0.0284, Accuracy: 1026/2227 (46.0709%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.8071, Accuracy: 120/10000 (1.2000%)
time spent on training: 219.06487917900085
[foolsgold agg] training data poison_ratio: 0.6433164128595601  data num: [500, 677, 809, 271, 1657, 197, 690, 1129, 708, 2227]
[foolsgold agg] considering poison per batch poison_fraction: 0.4020727580372251
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3161, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.6153, Accuracy: 0/9950 (0.0000%)
saving model
Done in 615.6821837425232 sec.
Server Epoch:8 choose agents : [94, 35, 21, 1, 88, 43, 68, 27, 19, 92].
___Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   1, Avg loss: 0.0550, Accuracy: 321/1662 (19.3141%)
___Train Local_ResNet_18, epoch   8, local model 94, internal_epoch   2, Avg loss: 0.0333, Accuracy: 590/1662 (35.4994%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.7869, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   1, Avg loss: 0.0854, Accuracy: 35/271 (12.9151%)
___Train Local_ResNet_18, epoch   8, local model 35, internal_epoch   2, Avg loss: 0.0540, Accuracy: 105/271 (38.7454%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3650, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 418/1949 (21.4469%)
___Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0334, Accuracy: 600/1949 (30.7850%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.4445, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0580, Accuracy: 276/928 (29.7414%)
___Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0242, Accuracy: 544/928 (58.6207%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.5084, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   1, Avg loss: 0.0748, Accuracy: 134/603 (22.2222%)
___Train Local_ResNet_18, epoch   8, local model 88, internal_epoch   2, Avg loss: 0.0463, Accuracy: 289/603 (47.9270%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.9094, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 308/946 (32.5581%)
___Train Local_ResNet_18, epoch   8, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 336/946 (35.5180%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.0173, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   1, Avg loss: 0.0626, Accuracy: 363/1163 (31.2124%)
___Train Local_ResNet_18, epoch   8, local model 68, internal_epoch   2, Avg loss: 0.0364, Accuracy: 428/1163 (36.8014%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.6154, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 407/1587 (25.6459%)
___Train Local_ResNet_18, epoch   8, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 619/1587 (39.0044%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.0740, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   1, Avg loss: 0.0475, Accuracy: 385/1036 (37.1622%)
___Train Local_ResNet_18, epoch   8, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 675/1036 (65.1544%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 9.2919, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   1, Avg loss: 0.0527, Accuracy: 428/1715 (24.9563%)
___Train Local_ResNet_18, epoch   8, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 696/1715 (40.5831%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.4076, Accuracy: 85/10000 (0.8500%)
time spent on training: 142.62839031219482
[foolsgold agg] training data poison_ratio: 0.0  data num: [1662, 271, 1949, 928, 603, 946, 1163, 1587, 1036, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3160, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.6153, Accuracy: 0/9950 (0.0000%)
saving model
Done in 539.1870174407959 sec.
Server Epoch:9 choose agents : [57, 42, 90, 21, 49, 84, 77, 18, 56, 65].
___Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   1, Avg loss: 0.0549, Accuracy: 297/1154 (25.7366%)
___Train Local_ResNet_18, epoch   9, local model 57, internal_epoch   2, Avg loss: 0.0262, Accuracy: 500/1154 (43.3276%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.2391, Accuracy: 79/10000 (0.7900%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 347/1372 (25.2915%)
___Train Local_ResNet_18, epoch   9, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 477/1372 (34.7668%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.1157, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0574, Accuracy: 313/677 (46.2334%)
___Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0235, Accuracy: 445/677 (65.7312%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.3431, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 387/1949 (19.8563%)
___Train Local_ResNet_18, epoch   9, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 619/1949 (31.7599%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 8.4865, Accuracy: 97/10000 (0.9700%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   1, Avg loss: 0.0811, Accuracy: 16/440 (3.6364%)
___Train Local_ResNet_18, epoch   9, local model 49, internal_epoch   2, Avg loss: 0.0484, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.4895, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 331/1190 (27.8151%)
___Train Local_ResNet_18, epoch   9, local model 84, internal_epoch   2, Avg loss: 0.0331, Accuracy: 436/1190 (36.6387%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.0060, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   1, Avg loss: 0.0541, Accuracy: 324/1340 (24.1791%)
___Train Local_ResNet_18, epoch   9, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 537/1340 (40.0746%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.5203, Accuracy: 60/10000 (0.6000%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   1, Avg loss: 0.0770, Accuracy: 112/530 (21.1321%)
___Train Local_ResNet_18, epoch   9, local model 18, internal_epoch   2, Avg loss: 0.0399, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.0252, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   1, Avg loss: 0.0833, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch   9, local model 56, internal_epoch   2, Avg loss: 0.0680, Accuracy: 54/186 (29.0323%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   1, Avg loss: 0.0568, Accuracy: 383/1475 (25.9661%)
___Train Local_ResNet_18, epoch   9, local model 65, internal_epoch   2, Avg loss: 0.0315, Accuracy: 655/1475 (44.4068%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.8988, Accuracy: 77/10000 (0.7700%)
time spent on training: 166.45094799995422
[foolsgold agg] training data poison_ratio: 0.48550373315233203  data num: [1154, 1372, 677, 1949, 440, 1190, 1340, 530, 186, 1475]
[foolsgold agg] considering poison per batch poison_fraction: 0.3034398332202075
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3159, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.6145, Accuracy: 0/9950 (0.0000%)
saving model
Done in 566.6475019454956 sec.
Server Epoch:10 choose agents : [5, 23, 83, 66, 54, 46, 86, 78, 84, 8].
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   1, Avg loss: 0.0513, Accuracy: 403/1628 (24.7543%)
___Train Local_ResNet_18, epoch  10, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 821/1628 (50.4300%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.0507, Accuracy: 115/10000 (1.1500%)
___Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   1, Avg loss: 0.0596, Accuracy: 314/715 (43.9161%)
___Train Local_ResNet_18, epoch  10, local model 23, internal_epoch   2, Avg loss: 0.0392, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.7698, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 425/1953 (21.7614%)
___Train Local_ResNet_18, epoch  10, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 755/1953 (38.6585%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.0356, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   1, Avg loss: 0.0621, Accuracy: 260/1402 (18.5449%)
___Train Local_ResNet_18, epoch  10, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 400/1402 (28.5307%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.0682, Accuracy: 76/10000 (0.7600%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   1, Avg loss: 0.0556, Accuracy: 328/1130 (29.0265%)
___Train Local_ResNet_18, epoch  10, local model 54, internal_epoch   2, Avg loss: 0.0289, Accuracy: 465/1130 (41.1504%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6933, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   1, Avg loss: 0.0556, Accuracy: 409/1904 (21.4811%)
___Train Local_ResNet_18, epoch  10, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 697/1904 (36.6071%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.7269, Accuracy: 109/10000 (1.0900%)
___Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   1, Avg loss: 0.0643, Accuracy: 347/1003 (34.5962%)
___Train Local_ResNet_18, epoch  10, local model 86, internal_epoch   2, Avg loss: 0.0356, Accuracy: 346/1003 (34.4965%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.7695, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   1, Avg loss: 0.0839, Accuracy: 30/416 (7.2115%)
___Train Local_ResNet_18, epoch  10, local model 78, internal_epoch   2, Avg loss: 0.0476, Accuracy: 174/416 (41.8269%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.5443, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 316/1190 (26.5546%)
___Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 439/1190 (36.8908%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.8407, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   1, Avg loss: 0.0604, Accuracy: 240/1513 (15.8625%)
___Train Local_ResNet_18, epoch  10, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 478/1513 (31.5929%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.5104, Accuracy: 87/10000 (0.8700%)
time spent on training: 236.3706796169281
[foolsgold agg] training data poison_ratio: 0.3395052123852497  data num: [1628, 715, 1953, 1402, 1130, 1904, 1003, 416, 1190, 1513]
[foolsgold agg] considering poison per batch poison_fraction: 0.21219075774078108
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3158, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.6149, Accuracy: 0/9950 (0.0000%)
saving model
Done in 634.4779102802277 sec.
Server Epoch:11 choose agents : [38, 24, 45, 8, 65, 19, 49, 17, 40, 22].
___Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   1, Avg loss: 0.0624, Accuracy: 245/1131 (21.6622%)
___Train Local_ResNet_18, epoch  11, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 467/1131 (41.2909%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.0980, Accuracy: 79/10000 (0.7900%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   1, Avg loss: 0.0770, Accuracy: 27/312 (8.6538%)
___Train Local_ResNet_18, epoch  11, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3855, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   1, Avg loss: 0.0687, Accuracy: 191/669 (28.5501%)
___Train Local_ResNet_18, epoch  11, local model 45, internal_epoch   2, Avg loss: 0.0411, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.7302, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   1, Avg loss: 0.0606, Accuracy: 240/1513 (15.8625%)
___Train Local_ResNet_18, epoch  11, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 447/1513 (29.5440%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.4681, Accuracy: 76/10000 (0.7600%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   1, Avg loss: 0.0569, Accuracy: 387/1475 (26.2373%)
___Train Local_ResNet_18, epoch  11, local model 65, internal_epoch   2, Avg loss: 0.0310, Accuracy: 688/1475 (46.6441%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.8718, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   1, Avg loss: 0.0471, Accuracy: 385/1036 (37.1622%)
___Train Local_ResNet_18, epoch  11, local model 19, internal_epoch   2, Avg loss: 0.0241, Accuracy: 660/1036 (63.7066%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 9.2302, Accuracy: 51/10000 (0.5100%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   1, Avg loss: 0.0806, Accuracy: 24/440 (5.4545%)
___Train Local_ResNet_18, epoch  11, local model 49, internal_epoch   2, Avg loss: 0.0482, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.4877, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 385/1574 (24.4600%)
___Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 680/1574 (43.2020%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.3489, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 348/1573 (22.1233%)
___Train Local_ResNet_18, epoch  11, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 564/1573 (35.8551%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.4532, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   1, Avg loss: 0.0466, Accuracy: 471/1470 (32.0408%)
___Train Local_ResNet_18, epoch  11, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 856/1470 (58.2313%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.0828, Accuracy: 69/10000 (0.6900%)
time spent on training: 224.0618133544922
[foolsgold agg] training data poison_ratio: 0.19896363798802824  data num: [1131, 312, 669, 1513, 1475, 1036, 440, 1574, 1573, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.12435227374251764
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3156, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.6134, Accuracy: 0/9950 (0.0000%)
saving model
Done in 610.1155605316162 sec.
Server Epoch:12 choose agents : [56, 30, 69, 47, 51, 48, 92, 84, 32, 22].
___Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 61/186 (32.7957%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3115, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0823, Accuracy: 59/486 (12.1399%)
___Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0414, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.8078, Accuracy: 46/10000 (0.4600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   1, Avg loss: 0.0562, Accuracy: 277/590 (46.9492%)
___Train Local_ResNet_18, epoch  12, local model 69, internal_epoch   2, Avg loss: 0.0310, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.7464, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   1, Avg loss: 0.1269, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  12, local model 47, internal_epoch   2, Avg loss: 0.1074, Accuracy: 5/134 (3.7313%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3108, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 221/1049 (21.0677%)
___Train Local_ResNet_18, epoch  12, local model 51, internal_epoch   2, Avg loss: 0.0309, Accuracy: 506/1049 (48.2364%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.3760, Accuracy: 77/10000 (0.7700%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   1, Avg loss: 0.0711, Accuracy: 96/631 (15.2139%)
___Train Local_ResNet_18, epoch  12, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 226/631 (35.8162%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.7629, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   1, Avg loss: 0.0522, Accuracy: 465/1715 (27.1137%)
___Train Local_ResNet_18, epoch  12, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 655/1715 (38.1924%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6444, Accuracy: 76/10000 (0.7600%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   1, Avg loss: 0.0621, Accuracy: 317/1190 (26.6387%)
___Train Local_ResNet_18, epoch  12, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 446/1190 (37.4790%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.8627, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0611, Accuracy: 192/735 (26.1224%)
___Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0226, Accuracy: 336/735 (45.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8166, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 546/1470 (37.1429%)
___Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 876/1470 (59.5918%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.3119, Accuracy: 56/10000 (0.5600%)
time spent on training: 166.05155086517334
[foolsgold agg] training data poison_ratio: 0.35389689714146105  data num: [186, 486, 590, 134, 1049, 631, 1715, 1190, 735, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.22118556071341317
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3156, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.6100, Accuracy: 0/9950 (0.0000%)
saving model
Done in 558.9672808647156 sec.
Server Epoch:13 choose agents : [53, 15, 3, 23, 83, 11, 27, 76, 70, 35].
___Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   1, Avg loss: 0.0499, Accuracy: 287/813 (35.3014%)
___Train Local_ResNet_18, epoch  13, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 471/813 (57.9336%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 9.2403, Accuracy: 52/10000 (0.5200%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0576, Accuracy: 310/1154 (26.8631%)
___Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0293, Accuracy: 444/1154 (38.4749%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.3868, Accuracy: 52/10000 (0.5200%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   1, Avg loss: 0.0752, Accuracy: 106/781 (13.5723%)
___Train Local_ResNet_18, epoch  13, local model 3, internal_epoch   2, Avg loss: 0.0367, Accuracy: 224/781 (28.6812%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.4764, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   1, Avg loss: 0.0602, Accuracy: 306/715 (42.7972%)
___Train Local_ResNet_18, epoch  13, local model 23, internal_epoch   2, Avg loss: 0.0387, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.7625, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 410/1953 (20.9933%)
___Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0341, Accuracy: 726/1953 (37.1736%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.7121, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   1, Avg loss: 0.0546, Accuracy: 349/712 (49.0169%)
___Train Local_ResNet_18, epoch  13, local model 11, internal_epoch   2, Avg loss: 0.0258, Accuracy: 437/712 (61.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.3815, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   1, Avg loss: 0.0537, Accuracy: 421/1587 (26.5280%)
___Train Local_ResNet_18, epoch  13, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 603/1587 (37.9962%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.9238, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   1, Avg loss: 0.0863, Accuracy: 38/466 (8.1545%)
___Train Local_ResNet_18, epoch  13, local model 76, internal_epoch   2, Avg loss: 0.0513, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.6633, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   1, Avg loss: 0.0558, Accuracy: 343/1418 (24.1890%)
___Train Local_ResNet_18, epoch  13, local model 70, internal_epoch   2, Avg loss: 0.0319, Accuracy: 616/1418 (43.4415%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.6547, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   1, Avg loss: 0.0847, Accuracy: 42/271 (15.4982%)
___Train Local_ResNet_18, epoch  13, local model 35, internal_epoch   2, Avg loss: 0.0577, Accuracy: 101/271 (37.2694%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3660, Accuracy: 49/10000 (0.4900%)
time spent on training: 145.6560935974121
[foolsgold agg] training data poison_ratio: 0.196048632218845  data num: [813, 1154, 781, 715, 1953, 712, 1587, 466, 1418, 271]
[foolsgold agg] considering poison per batch poison_fraction: 0.12253039513677813
[foolsgold agg] wv: [1.         1.         1.         1.         0.90452053 1.
 1.         1.         1.         0.90452053]
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3155, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.6102, Accuracy: 0/9950 (0.0000%)
saving model
Done in 529.4563403129578 sec.
Server Epoch:14 choose agents : [0, 94, 96, 91, 51, 3, 36, 90, 37, 84].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 356/1657 (21.4846%)
___Train Local_ResNet_18, epoch  14, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 495/1657 (29.8733%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.6264, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 341/1662 (20.5174%)
___Train Local_ResNet_18, epoch  14, local model 94, internal_epoch   2, Avg loss: 0.0334, Accuracy: 606/1662 (36.4621%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.8076, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   1, Avg loss: 0.0789, Accuracy: 45/311 (14.4695%)
___Train Local_ResNet_18, epoch  14, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3432, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   1, Avg loss: 0.0532, Accuracy: 331/1030 (32.1359%)
___Train Local_ResNet_18, epoch  14, local model 91, internal_epoch   2, Avg loss: 0.0257, Accuracy: 624/1030 (60.5825%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.2326, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   1, Avg loss: 0.0604, Accuracy: 225/1049 (21.4490%)
___Train Local_ResNet_18, epoch  14, local model 51, internal_epoch   2, Avg loss: 0.0315, Accuracy: 507/1049 (48.3317%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.3417, Accuracy: 68/10000 (0.6800%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   1, Avg loss: 0.0751, Accuracy: 105/781 (13.4443%)
___Train Local_ResNet_18, epoch  14, local model 3, internal_epoch   2, Avg loss: 0.0368, Accuracy: 237/781 (30.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.5121, Accuracy: 59/10000 (0.5900%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   1, Avg loss: 0.0877, Accuracy: 78/408 (19.1176%)
___Train Local_ResNet_18, epoch  14, local model 36, internal_epoch   2, Avg loss: 0.0550, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.4915, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   1, Avg loss: 0.0573, Accuracy: 307/677 (45.3471%)
___Train Local_ResNet_18, epoch  14, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.9780, Accuracy: 57/10000 (0.5700%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   1, Avg loss: 0.0524, Accuracy: 388/1129 (34.3667%)
___Train Local_ResNet_18, epoch  14, local model 37, internal_epoch   2, Avg loss: 0.0253, Accuracy: 705/1129 (62.4446%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.0969, Accuracy: 101/10000 (1.0100%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 321/1190 (26.9748%)
___Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 445/1190 (37.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.9185, Accuracy: 54/10000 (0.5400%)
time spent on training: 191.8871841430664
[foolsgold agg] training data poison_ratio: 0.5220335556903174  data num: [1657, 1662, 311, 1030, 1049, 781, 408, 677, 1129, 1190]
[foolsgold agg] considering poison per batch poison_fraction: 0.32627097230644836
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3153, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.6093, Accuracy: 0/9950 (0.0000%)
saving model
Done in 587.7222440242767 sec.
Server Epoch:15 choose agents : [0, 92, 37, 24, 39, 63, 28, 96, 58, 72].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   1, Avg loss: 0.0584, Accuracy: 373/1657 (22.5106%)
___Train Local_ResNet_18, epoch  15, local model 0, internal_epoch   2, Avg loss: 0.0351, Accuracy: 509/1657 (30.7182%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.4607, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 448/1715 (26.1224%)
___Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0311, Accuracy: 691/1715 (40.2915%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.4813, Accuracy: 82/10000 (0.8200%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0523, Accuracy: 401/1129 (35.5182%)
___Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0254, Accuracy: 732/1129 (64.8361%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5261, Accuracy: 109/10000 (1.0900%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   1, Avg loss: 0.0766, Accuracy: 34/312 (10.8974%)
___Train Local_ResNet_18, epoch  15, local model 24, internal_epoch   2, Avg loss: 0.0405, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3857, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 306/1013 (30.2073%)
___Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0263, Accuracy: 479/1013 (47.2853%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5551, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 261/888 (29.3919%)
___Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 428/888 (48.1982%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.2999, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   1, Avg loss: 0.0566, Accuracy: 396/1581 (25.0474%)
___Train Local_ResNet_18, epoch  15, local model 28, internal_epoch   2, Avg loss: 0.0337, Accuracy: 580/1581 (36.6856%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.6286, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   1, Avg loss: 0.0790, Accuracy: 41/311 (13.1833%)
___Train Local_ResNet_18, epoch  15, local model 96, internal_epoch   2, Avg loss: 0.0542, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3463, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   1, Avg loss: 0.0591, Accuracy: 341/803 (42.4658%)
___Train Local_ResNet_18, epoch  15, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 388/803 (48.3188%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.0116, Accuracy: 51/10000 (0.5100%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 233/1241 (18.7752%)
___Train Local_ResNet_18, epoch  15, local model 72, internal_epoch   2, Avg loss: 0.0369, Accuracy: 413/1241 (33.2796%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.1937, Accuracy: 53/10000 (0.5300%)
time spent on training: 277.18769693374634
[foolsgold agg] training data poison_ratio: 0.40741784037558687  data num: [1657, 1715, 1129, 312, 1013, 888, 1581, 311, 803, 1241]
[foolsgold agg] considering poison per batch poison_fraction: 0.2546361502347418
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3152, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.6090, Accuracy: 0/9950 (0.0000%)
saving model
Done in 669.661604642868 sec.
Server Epoch:16 choose agents : [35, 32, 3, 96, 25, 8, 93, 74, 88, 50].
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   1, Avg loss: 0.0843, Accuracy: 44/271 (16.2362%)
___Train Local_ResNet_18, epoch  16, local model 35, internal_epoch   2, Avg loss: 0.0561, Accuracy: 102/271 (37.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3623, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   1, Avg loss: 0.0608, Accuracy: 184/735 (25.0340%)
___Train Local_ResNet_18, epoch  16, local model 32, internal_epoch   2, Avg loss: 0.0233, Accuracy: 353/735 (48.0272%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.2074, Accuracy: 59/10000 (0.5900%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   1, Avg loss: 0.0750, Accuracy: 98/781 (12.5480%)
___Train Local_ResNet_18, epoch  16, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 238/781 (30.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.7288, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 51/311 (16.3987%)
___Train Local_ResNet_18, epoch  16, local model 96, internal_epoch   2, Avg loss: 0.0533, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3467, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   1, Avg loss: 0.0571, Accuracy: 298/690 (43.1884%)
___Train Local_ResNet_18, epoch  16, local model 25, internal_epoch   2, Avg loss: 0.0281, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.4253, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   1, Avg loss: 0.0605, Accuracy: 228/1513 (15.0694%)
___Train Local_ResNet_18, epoch  16, local model 8, internal_epoch   2, Avg loss: 0.0371, Accuracy: 494/1513 (32.6504%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.3559, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0555, Accuracy: 390/1742 (22.3881%)
___Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 734/1742 (42.1355%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.8277, Accuracy: 73/10000 (0.7300%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 456/1552 (29.3814%)
___Train Local_ResNet_18, epoch  16, local model 74, internal_epoch   2, Avg loss: 0.0207, Accuracy: 798/1552 (51.4175%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 10.0792, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   1, Avg loss: 0.0746, Accuracy: 134/603 (22.2222%)
___Train Local_ResNet_18, epoch  16, local model 88, internal_epoch   2, Avg loss: 0.0466, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.8764, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   1, Avg loss: 0.0634, Accuracy: 138/809 (17.0581%)
___Train Local_ResNet_18, epoch  16, local model 50, internal_epoch   2, Avg loss: 0.0276, Accuracy: 366/809 (45.2410%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.0420, Accuracy: 52/10000 (0.5200%)
time spent on training: 213.7732892036438
[foolsgold agg] training data poison_ratio: 0.3356278450094371  data num: [271, 735, 781, 311, 690, 1513, 1742, 1552, 603, 809]
[foolsgold agg] considering poison per batch poison_fraction: 0.2097674031308982
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3151, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.6051, Accuracy: 0/9950 (0.0000%)
saving model
Done in 609.4152581691742 sec.
Server Epoch:17 choose agents : [53, 43, 41, 30, 82, 92, 50, 34, 7, 64].
___Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   1, Avg loss: 0.0497, Accuracy: 282/813 (34.6863%)
___Train Local_ResNet_18, epoch  17, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 452/813 (55.5966%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 9.0753, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 308/946 (32.5581%)
___Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0367, Accuracy: 349/946 (36.8922%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.9343, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   1, Avg loss: 0.0589, Accuracy: 334/719 (46.4534%)
___Train Local_ResNet_18, epoch  17, local model 41, internal_epoch   2, Avg loss: 0.0313, Accuracy: 467/719 (64.9513%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.3333, Accuracy: 51/10000 (0.5100%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   1, Avg loss: 0.0810, Accuracy: 64/486 (13.1687%)
___Train Local_ResNet_18, epoch  17, local model 30, internal_epoch   2, Avg loss: 0.0417, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.7625, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   1, Avg loss: 0.0772, Accuracy: 60/500 (12.0000%)
___Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 171/500 (34.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.6274, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   1, Avg loss: 0.0520, Accuracy: 426/1715 (24.8397%)
___Train Local_ResNet_18, epoch  17, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 718/1715 (41.8659%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.5532, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   1, Avg loss: 0.0635, Accuracy: 163/809 (20.1483%)
___Train Local_ResNet_18, epoch  17, local model 50, internal_epoch   2, Avg loss: 0.0275, Accuracy: 335/809 (41.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.1160, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0587, Accuracy: 372/1427 (26.0687%)
___Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 602/1427 (42.1864%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.8069, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   1, Avg loss: 0.0537, Accuracy: 344/891 (38.6083%)
___Train Local_ResNet_18, epoch  17, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 451/891 (50.6173%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.1386, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 166/953 (17.4187%)
___Train Local_ResNet_18, epoch  17, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 313/953 (32.8437%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.4109, Accuracy: 61/10000 (0.6100%)
time spent on training: 129.9757890701294
[foolsgold agg] training data poison_ratio: 0.052489469705151746  data num: [813, 946, 719, 486, 500, 1715, 809, 1427, 891, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.03280591856571984
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3149, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.6032, Accuracy: 0/9950 (0.0000%)
saving model
Done in 517.29692029953 sec.
Server Epoch:18 choose agents : [18, 55, 4, 35, 2, 13, 24, 76, 9, 43].
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   1, Avg loss: 0.0772, Accuracy: 108/530 (20.3774%)
___Train Local_ResNet_18, epoch  18, local model 18, internal_epoch   2, Avg loss: 0.0390, Accuracy: 262/530 (49.4340%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.9717, Accuracy: 64/10000 (0.6400%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   1, Avg loss: 0.0569, Accuracy: 244/1071 (22.7824%)
___Train Local_ResNet_18, epoch  18, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 484/1071 (45.1914%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.0114, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   1, Avg loss: 0.0622, Accuracy: 323/901 (35.8491%)
___Train Local_ResNet_18, epoch  18, local model 4, internal_epoch   2, Avg loss: 0.0336, Accuracy: 406/901 (45.0610%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.9537, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   1, Avg loss: 0.0843, Accuracy: 42/271 (15.4982%)
___Train Local_ResNet_18, epoch  18, local model 35, internal_epoch   2, Avg loss: 0.0550, Accuracy: 99/271 (36.5314%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3633, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0634, Accuracy: 229/605 (37.8512%)
___Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0385, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.7757, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   1, Avg loss: 0.0580, Accuracy: 311/1645 (18.9058%)
___Train Local_ResNet_18, epoch  18, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 630/1645 (38.2979%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.1156, Accuracy: 126/10000 (1.2600%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 32/312 (10.2564%)
___Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0408, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3893, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   1, Avg loss: 0.0855, Accuracy: 46/466 (9.8712%)
___Train Local_ResNet_18, epoch  18, local model 76, internal_epoch   2, Avg loss: 0.0485, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.6715, Accuracy: 50/10000 (0.5000%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0502, Accuracy: 340/1275 (26.6667%)
___Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0201, Accuracy: 643/1275 (50.4314%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.1554, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   1, Avg loss: 0.0613, Accuracy: 310/946 (32.7696%)
___Train Local_ResNet_18, epoch  18, local model 43, internal_epoch   2, Avg loss: 0.0365, Accuracy: 326/946 (34.4609%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.0297, Accuracy: 49/10000 (0.4900%)
time spent on training: 160.6453082561493
[foolsgold agg] training data poison_ratio: 0.39740713039142356  data num: [530, 1071, 901, 271, 605, 1645, 312, 466, 1275, 946]
[foolsgold agg] considering poison per batch poison_fraction: 0.24837945649463972
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3147, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.6022, Accuracy: 0/9950 (0.0000%)
saving model
Done in 559.0048842430115 sec.
Server Epoch:19 choose agents : [11, 48, 53, 27, 55, 65, 31, 89, 17, 23].
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0533, Accuracy: 347/712 (48.7360%)
___Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0261, Accuracy: 432/712 (60.6742%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.5329, Accuracy: 49/10000 (0.4900%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   1, Avg loss: 0.0714, Accuracy: 97/631 (15.3724%)
___Train Local_ResNet_18, epoch  19, local model 48, internal_epoch   2, Avg loss: 0.0414, Accuracy: 223/631 (35.3407%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.7881, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   1, Avg loss: 0.0499, Accuracy: 277/813 (34.0713%)
___Train Local_ResNet_18, epoch  19, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 450/813 (55.3506%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.3586, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 436/1587 (27.4732%)
___Train Local_ResNet_18, epoch  19, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 611/1587 (38.5003%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.0743, Accuracy: 70/10000 (0.7000%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 263/1071 (24.5565%)
___Train Local_ResNet_18, epoch  19, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 481/1071 (44.9113%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.7806, Accuracy: 74/10000 (0.7400%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   1, Avg loss: 0.0551, Accuracy: 370/1475 (25.0847%)
___Train Local_ResNet_18, epoch  19, local model 65, internal_epoch   2, Avg loss: 0.0321, Accuracy: 662/1475 (44.8814%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.1354, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   1, Avg loss: 0.0818, Accuracy: 56/460 (12.1739%)
___Train Local_ResNet_18, epoch  19, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 185/460 (40.2174%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.7446, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 329/896 (36.7188%)
___Train Local_ResNet_18, epoch  19, local model 89, internal_epoch   2, Avg loss: 0.0342, Accuracy: 436/896 (48.6607%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.2860, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 401/1574 (25.4765%)
___Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 674/1574 (42.8208%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.4130, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   1, Avg loss: 0.0596, Accuracy: 318/715 (44.4755%)
___Train Local_ResNet_18, epoch  19, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.7596, Accuracy: 50/10000 (0.5000%)
time spent on training: 264.4098026752472
[foolsgold agg] training data poison_ratio: 0.3198107509563117  data num: [712, 631, 813, 1587, 1071, 1475, 460, 896, 1574, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.1998817193476948
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3146, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.6006, Accuracy: 0/9950 (0.0000%)
saving model
Done in 657.507729768753 sec.
Server Epoch:20 choose agents : [15, 22, 82, 11, 93, 75, 3, 77, 88, 16].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   1, Avg loss: 0.0583, Accuracy: 325/1154 (28.1629%)
___Train Local_ResNet_18, epoch  20, local model 15, internal_epoch   2, Avg loss: 0.0292, Accuracy: 381/1154 (33.0156%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.9876, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 506/1470 (34.4218%)
___Train Local_ResNet_18, epoch  20, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 841/1470 (57.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.1132, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   1, Avg loss: 0.0767, Accuracy: 63/500 (12.6000%)
___Train Local_ResNet_18, epoch  20, local model 82, internal_epoch   2, Avg loss: 0.0497, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.6513, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   1, Avg loss: 0.0544, Accuracy: 348/712 (48.8764%)
___Train Local_ResNet_18, epoch  20, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 434/712 (60.9551%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.5290, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 402/1742 (23.0769%)
___Train Local_ResNet_18, epoch  20, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 693/1742 (39.7819%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.5488, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   1, Avg loss: 0.0642, Accuracy: 240/776 (30.9278%)
___Train Local_ResNet_18, epoch  20, local model 75, internal_epoch   2, Avg loss: 0.0292, Accuracy: 408/776 (52.5773%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.1358, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   1, Avg loss: 0.0749, Accuracy: 106/781 (13.5723%)
___Train Local_ResNet_18, epoch  20, local model 3, internal_epoch   2, Avg loss: 0.0366, Accuracy: 236/781 (30.2177%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.7809, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   1, Avg loss: 0.0536, Accuracy: 331/1340 (24.7015%)
___Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 570/1340 (42.5373%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.9012, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   1, Avg loss: 0.0753, Accuracy: 134/603 (22.2222%)
___Train Local_ResNet_18, epoch  20, local model 88, internal_epoch   2, Avg loss: 0.0465, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.9362, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   1, Avg loss: 0.0634, Accuracy: 278/708 (39.2655%)
___Train Local_ResNet_18, epoch  20, local model 16, internal_epoch   2, Avg loss: 0.0370, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.8930, Accuracy: 56/10000 (0.5600%)
time spent on training: 164.70665097236633
[foolsgold agg] training data poison_ratio: 0.19773145309625997  data num: [1154, 1470, 500, 712, 1742, 776, 781, 1340, 603, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.12358215818516248
[foolsgold agg] wv: [1.         1.         1.         0.77839455 1.         1.
 1.         1.         1.         0.77839455]
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3145, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.6007, Accuracy: 0/9950 (0.0000%)
saving model
Done in 546.2316625118256 sec.
Server Epoch:21 choose agents : [0, 27, 39, 70, 20, 85, 12, 72, 94, 32].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Average loss: 0.0480, Accuracy: 854/1657 (51.5389%), train_poison_data_count: 1040
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Average loss: 0.0277, Accuracy: 1003/1657 (60.5311%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Average loss: 0.0248, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Average loss: 0.0237, Accuracy: 1039/1657 (62.7037%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Average loss: 0.0235, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Average loss: 0.0229, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Average loss: 0.0228, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Average loss: 0.0217, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Average loss: 0.0217, Accuracy: 1040/1657 (62.7640%), train_poison_data_count: 1040
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Average loss: 0.0212, Accuracy: 1042/1657 (62.8847%), train_poison_data_count: 1040
Global model norm: 112.0552188446058.
Norm before scaling: 112.02523955285702. Distance: 1.0227489339095148
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.3887, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.4575, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 149.1322033046518, distance: 102.27489573143059
Total norm for 5 adversaries is: 149.1322033046518. distance: 102.27489573143059
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 442/1587 (27.8513%)
___Train Local_ResNet_18, epoch  21, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 597/1587 (37.6181%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.0846, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   1, Avg loss: 0.0544, Accuracy: 310/1013 (30.6022%)
___Train Local_ResNet_18, epoch  21, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 493/1013 (48.6673%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.6915, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   1, Avg loss: 0.0566, Accuracy: 342/1418 (24.1185%)
___Train Local_ResNet_18, epoch  21, local model 70, internal_epoch   2, Avg loss: 0.0309, Accuracy: 614/1418 (43.3004%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.4257, Accuracy: 84/10000 (0.8400%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   1, Avg loss: 0.0554, Accuracy: 341/807 (42.2553%)
___Train Local_ResNet_18, epoch  21, local model 20, internal_epoch   2, Avg loss: 0.0331, Accuracy: 417/807 (51.6729%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.9683, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   1, Avg loss: 0.0548, Accuracy: 434/1988 (21.8310%)
___Train Local_ResNet_18, epoch  21, local model 85, internal_epoch   2, Avg loss: 0.0347, Accuracy: 689/1988 (34.6579%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8419, Accuracy: 77/10000 (0.7700%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   1, Avg loss: 0.0876, Accuracy: 16/338 (4.7337%)
___Train Local_ResNet_18, epoch  21, local model 12, internal_epoch   2, Avg loss: 0.0468, Accuracy: 140/338 (41.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.4407, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   1, Avg loss: 0.0623, Accuracy: 252/1241 (20.3062%)
___Train Local_ResNet_18, epoch  21, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 415/1241 (33.4408%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.2385, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 332/1662 (19.9759%)
___Train Local_ResNet_18, epoch  21, local model 94, internal_epoch   2, Avg loss: 0.0336, Accuracy: 621/1662 (37.3646%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8766, Accuracy: 120/10000 (1.2000%)
___Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   1, Avg loss: 0.0610, Accuracy: 187/735 (25.4422%)
___Train Local_ResNet_18, epoch  21, local model 32, internal_epoch   2, Avg loss: 0.0222, Accuracy: 358/735 (48.7075%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8356, Accuracy: 55/10000 (0.5500%)
time spent on training: 315.0453588962555
[foolsgold agg] training data poison_ratio: 0.48457335690181585  data num: [1657, 1587, 1013, 1418, 807, 1988, 338, 1241, 1662, 735]
[foolsgold agg] considering poison per batch poison_fraction: 0.30285834806363493
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3144, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.5925, Accuracy: 0/9950 (0.0000%)
saving model
Done in 700.5226466655731 sec.
Server Epoch:22 choose agents : [17, 32, 73, 28, 12, 2, 85, 13, 18, 80].
___Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 400/1574 (25.4130%)
___Train Local_ResNet_18, epoch  22, local model 17, internal_epoch   2, Avg loss: 0.0281, Accuracy: 664/1574 (42.1855%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.2608, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   1, Avg loss: 0.0599, Accuracy: 197/735 (26.8027%)
___Train Local_ResNet_18, epoch  22, local model 32, internal_epoch   2, Avg loss: 0.0232, Accuracy: 333/735 (45.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.7940, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   1, Avg loss: 0.0658, Accuracy: 181/938 (19.2964%)
___Train Local_ResNet_18, epoch  22, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 341/938 (36.3539%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.1555, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 394/1581 (24.9209%)
___Train Local_ResNet_18, epoch  22, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 584/1581 (36.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.6530, Accuracy: 90/10000 (0.9000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 19/338 (5.6213%)
___Train Local_ResNet_18, epoch  22, local model 12, internal_epoch   2, Avg loss: 0.0463, Accuracy: 143/338 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.4714, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0638, Accuracy: 229/605 (37.8512%)
___Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.7919, Accuracy: 54/10000 (0.5400%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 422/1988 (21.2274%)
___Train Local_ResNet_18, epoch  22, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 652/1988 (32.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.1776, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0578, Accuracy: 317/1645 (19.2705%)
___Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 626/1645 (38.0547%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.9645, Accuracy: 106/10000 (1.0600%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0769, Accuracy: 109/530 (20.5660%)
___Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0379, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.0966, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   1, Avg loss: 0.0708, Accuracy: 144/682 (21.1144%)
___Train Local_ResNet_18, epoch  22, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 258/682 (37.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.3590, Accuracy: 50/10000 (0.5000%)
time spent on training: 164.26579976081848
[foolsgold agg] training data poison_ratio: 0.2690278824415976  data num: [1574, 735, 938, 1581, 338, 605, 1988, 1645, 530, 682]
[foolsgold agg] considering poison per batch poison_fraction: 0.16814242652599848
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3143, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.5869, Accuracy: 0/9950 (0.0000%)
saving model
Done in 537.7630050182343 sec.
Server Epoch:23 choose agents : [3, 14, 79, 74, 2, 49, 32, 18, 4, 7].
poison local model 3 index 1 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Average loss: 0.0596, Accuracy: 335/781 (42.8937%), train_poison_data_count: 493
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Average loss: 0.0394, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   3, Average loss: 0.0275, Accuracy: 478/781 (61.2036%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   4, Average loss: 0.0253, Accuracy: 492/781 (62.9962%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   5, Average loss: 0.0245, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   6, Average loss: 0.0246, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   7, Average loss: 0.0242, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   8, Average loss: 0.0234, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch   9, Average loss: 0.0234, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  23, local model 3, internal_epoch  10, Average loss: 0.0234, Accuracy: 493/781 (63.1242%), train_poison_data_count: 493
Global model norm: 112.05511426442123.
Norm before scaling: 112.04240704555798. Distance: 0.7799993422701093
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.1885, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.4137, Accuracy: 9949/9950 (99.9899%)
Scaling by  100
Scaled Norm after poisoning: 135.2584115337194, distance: 77.99992800978248
Total norm for 4 adversaries is: 135.2584115337194. distance: 77.99992800978248
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 224/1013 (22.1125%)
___Train Local_ResNet_18, epoch  23, local model 14, internal_epoch   2, Avg loss: 0.0360, Accuracy: 328/1013 (32.3791%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.5758, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   1, Avg loss: 0.1007, Accuracy: 15/197 (7.6142%)
___Train Local_ResNet_18, epoch  23, local model 79, internal_epoch   2, Avg loss: 0.0831, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3220, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 439/1552 (28.2861%)
___Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 785/1552 (50.5799%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 10.0403, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0638, Accuracy: 230/605 (38.0165%)
___Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.8578, Accuracy: 50/10000 (0.5000%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   1, Avg loss: 0.0802, Accuracy: 23/440 (5.2273%)
___Train Local_ResNet_18, epoch  23, local model 49, internal_epoch   2, Avg loss: 0.0485, Accuracy: 150/440 (34.0909%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.4935, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   1, Avg loss: 0.0601, Accuracy: 193/735 (26.2585%)
___Train Local_ResNet_18, epoch  23, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 350/735 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.7391, Accuracy: 51/10000 (0.5100%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   1, Avg loss: 0.0753, Accuracy: 115/530 (21.6981%)
___Train Local_ResNet_18, epoch  23, local model 18, internal_epoch   2, Avg loss: 0.0419, Accuracy: 262/530 (49.4340%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.1651, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   1, Avg loss: 0.0635, Accuracy: 327/901 (36.2930%)
___Train Local_ResNet_18, epoch  23, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 389/901 (43.1743%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.4525, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   1, Avg loss: 0.0538, Accuracy: 351/891 (39.3939%)
___Train Local_ResNet_18, epoch  23, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 448/891 (50.2806%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.0860, Accuracy: 59/10000 (0.5900%)
time spent on training: 229.05548095703125
[foolsgold agg] training data poison_ratio: 0.43204708960104643  data num: [781, 1013, 197, 1552, 605, 440, 735, 530, 901, 891]
[foolsgold agg] considering poison per batch poison_fraction: 0.270029431000654
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3141, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.5776, Accuracy: 0/9950 (0.0000%)
saving model
Done in 609.7920541763306 sec.
Server Epoch:24 choose agents : [92, 33, 42, 36, 22, 98, 4, 17, 76, 3].
___Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   1, Avg loss: 0.0522, Accuracy: 426/1715 (24.8397%)
___Train Local_ResNet_18, epoch  24, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 715/1715 (41.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.8753, Accuracy: 91/10000 (0.9100%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   1, Avg loss: 0.0791, Accuracy: 65/515 (12.6214%)
___Train Local_ResNet_18, epoch  24, local model 33, internal_epoch   2, Avg loss: 0.0513, Accuracy: 119/515 (23.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.6561, Accuracy: 38/10000 (0.3800%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   1, Avg loss: 0.0528, Accuracy: 359/1372 (26.1662%)
___Train Local_ResNet_18, epoch  24, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 512/1372 (37.3178%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.9131, Accuracy: 77/10000 (0.7700%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   1, Avg loss: 0.0875, Accuracy: 70/408 (17.1569%)
___Train Local_ResNet_18, epoch  24, local model 36, internal_epoch   2, Avg loss: 0.0565, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.4726, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 514/1470 (34.9660%)
___Train Local_ResNet_18, epoch  24, local model 22, internal_epoch   2, Avg loss: 0.0241, Accuracy: 863/1470 (58.7075%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1374, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   1, Avg loss: 0.0831, Accuracy: 13/373 (3.4853%)
___Train Local_ResNet_18, epoch  24, local model 98, internal_epoch   2, Avg loss: 0.0481, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.4504, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   1, Avg loss: 0.0594, Accuracy: 326/901 (36.1820%)
___Train Local_ResNet_18, epoch  24, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 413/901 (45.8380%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.7811, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0515, Accuracy: 384/1574 (24.3964%)
___Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0282, Accuracy: 661/1574 (41.9949%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1099, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   1, Avg loss: 0.0863, Accuracy: 37/466 (7.9399%)
___Train Local_ResNet_18, epoch  24, local model 76, internal_epoch   2, Avg loss: 0.0489, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.6005, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0746, Accuracy: 110/781 (14.0845%)
___Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0365, Accuracy: 219/781 (28.0410%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5239, Accuracy: 60/10000 (0.6000%)
time spent on training: 162.2334520816803
[foolsgold agg] training data poison_ratio: 0.3212532637075718  data num: [1715, 515, 1372, 408, 1470, 373, 901, 1574, 466, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.20078328981723237
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3140, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.5777, Accuracy: 0/9950 (0.0000%)
saving model
Done in 532.1646554470062 sec.
Server Epoch:25 choose agents : [5, 23, 0, 67, 40, 80, 54, 26, 74, 47].
poison local model 5 index 2 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   1, Average loss: 0.0470, Accuracy: 865/1628 (53.1327%), train_poison_data_count: 1028
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   2, Average loss: 0.0228, Accuracy: 1021/1628 (62.7150%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   3, Average loss: 0.0206, Accuracy: 1028/1628 (63.1450%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   4, Average loss: 0.0198, Accuracy: 1028/1628 (63.1450%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   5, Average loss: 0.0193, Accuracy: 1027/1628 (63.0835%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   6, Average loss: 0.0188, Accuracy: 1029/1628 (63.2064%), train_poison_data_count: 1028
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   7, Average loss: 0.0184, Accuracy: 1028/1628 (63.1450%), train_poison_data_count: 1028
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   8, Average loss: 0.0176, Accuracy: 1029/1628 (63.2064%), train_poison_data_count: 1028
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch   9, Average loss: 0.0179, Accuracy: 1030/1628 (63.2678%), train_poison_data_count: 1028
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  25, local model 5, internal_epoch  10, Average loss: 0.0181, Accuracy: 1030/1628 (63.2678%), train_poison_data_count: 1028
Global model norm: 112.05500096911115.
Norm before scaling: 112.02614179428166. Distance: 1.087349008623386
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.0854, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.4251, Accuracy: 9934/9950 (99.8392%)
Scaling by  100
Scaled Norm after poisoning: 153.67107349180912, distance: 108.73489927485333
Total norm for 4 adversaries is: 153.67107349180912. distance: 108.73489927485333
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   1, Avg loss: 0.0639, Accuracy: 318/715 (44.4755%)
___Train Local_ResNet_18, epoch  25, local model 23, internal_epoch   2, Avg loss: 0.0372, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7951, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 343/1657 (20.7001%)
___Train Local_ResNet_18, epoch  25, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 523/1657 (31.5631%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6856, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   1, Avg loss: 0.0795, Accuracy: 36/426 (8.4507%)
___Train Local_ResNet_18, epoch  25, local model 67, internal_epoch   2, Avg loss: 0.0417, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.5697, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 349/1573 (22.1869%)
___Train Local_ResNet_18, epoch  25, local model 40, internal_epoch   2, Avg loss: 0.0351, Accuracy: 554/1573 (35.2193%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.2580, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   1, Avg loss: 0.0705, Accuracy: 142/682 (20.8211%)
___Train Local_ResNet_18, epoch  25, local model 80, internal_epoch   2, Avg loss: 0.0382, Accuracy: 254/682 (37.2434%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.1923, Accuracy: 48/10000 (0.4800%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0554, Accuracy: 345/1130 (30.5310%)
___Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0292, Accuracy: 474/1130 (41.9469%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.5687, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   1, Avg loss: 0.0553, Accuracy: 336/1446 (23.2365%)
___Train Local_ResNet_18, epoch  25, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 521/1446 (36.0304%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.2805, Accuracy: 63/10000 (0.6300%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0424, Accuracy: 504/1552 (32.4742%)
___Train Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 770/1552 (49.6134%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 11.4696, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   1, Avg loss: 0.1189, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  25, local model 47, internal_epoch   2, Avg loss: 0.1055, Accuracy: 22/134 (16.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3115, Accuracy: 50/10000 (0.5000%)
time spent on training: 262.6892488002777
[foolsgold agg] training data poison_ratio: 0.5452800877273143  data num: [1628, 715, 1657, 426, 1573, 682, 1130, 1446, 1552, 134]
[foolsgold agg] considering poison per batch poison_fraction: 0.34080005482957143
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3139, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.5741, Accuracy: 0/9950 (0.0000%)
saving model
Done in 649.7064919471741 sec.
Server Epoch:26 choose agents : [26, 4, 33, 73, 30, 86, 10, 12, 68, 82].
___Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   1, Avg loss: 0.0549, Accuracy: 341/1446 (23.5823%)
___Train Local_ResNet_18, epoch  26, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 492/1446 (34.0249%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.4408, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   1, Avg loss: 0.0631, Accuracy: 326/901 (36.1820%)
___Train Local_ResNet_18, epoch  26, local model 4, internal_epoch   2, Avg loss: 0.0339, Accuracy: 362/901 (40.1776%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.3723, Accuracy: 50/10000 (0.5000%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   1, Avg loss: 0.0770, Accuracy: 65/515 (12.6214%)
___Train Local_ResNet_18, epoch  26, local model 33, internal_epoch   2, Avg loss: 0.0533, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.7404, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   1, Avg loss: 0.0657, Accuracy: 171/938 (18.2303%)
___Train Local_ResNet_18, epoch  26, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 333/938 (35.5011%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.0612, Accuracy: 67/10000 (0.6700%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   1, Avg loss: 0.0803, Accuracy: 69/486 (14.1975%)
___Train Local_ResNet_18, epoch  26, local model 30, internal_epoch   2, Avg loss: 0.0417, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.7325, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   1, Avg loss: 0.0628, Accuracy: 355/1003 (35.3938%)
___Train Local_ResNet_18, epoch  26, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 392/1003 (39.0828%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.7411, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   1, Avg loss: 0.0577, Accuracy: 215/861 (24.9710%)
___Train Local_ResNet_18, epoch  26, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 446/861 (51.8002%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.9255, Accuracy: 50/10000 (0.5000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   1, Avg loss: 0.0887, Accuracy: 14/338 (4.1420%)
___Train Local_ResNet_18, epoch  26, local model 12, internal_epoch   2, Avg loss: 0.0503, Accuracy: 140/338 (41.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.4384, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0629, Accuracy: 364/1163 (31.2984%)
___Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0366, Accuracy: 443/1163 (38.0911%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.6480, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0768, Accuracy: 67/500 (13.4000%)
___Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0496, Accuracy: 168/500 (33.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.6078, Accuracy: 38/10000 (0.3800%)
time spent on training: 155.60410976409912
[foolsgold agg] training data poison_ratio: 0.2699055330634278  data num: [1446, 901, 515, 938, 486, 1003, 861, 338, 1163, 500]
[foolsgold agg] considering poison per batch poison_fraction: 0.16869095816464236
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3138, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.5730, Accuracy: 0/9950 (0.0000%)
saving model
Done in 555.1888844966888 sec.
Server Epoch:27 choose agents : [9, 64, 30, 13, 76, 44, 39, 22, 78, 85].
poison local model 9 index 3 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Average loss: 0.0495, Accuracy: 645/1275 (50.5882%), train_poison_data_count: 800
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Average loss: 0.0218, Accuracy: 732/1275 (57.4118%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   3, Average loss: 0.0190, Accuracy: 800/1275 (62.7451%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   4, Average loss: 0.0178, Accuracy: 800/1275 (62.7451%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   5, Average loss: 0.0176, Accuracy: 802/1275 (62.9020%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   6, Average loss: 0.0172, Accuracy: 803/1275 (62.9804%), train_poison_data_count: 800
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   7, Average loss: 0.0172, Accuracy: 803/1275 (62.9804%), train_poison_data_count: 800
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   8, Average loss: 0.0164, Accuracy: 805/1275 (63.1373%), train_poison_data_count: 800
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch   9, Average loss: 0.0162, Accuracy: 804/1275 (63.0588%), train_poison_data_count: 800
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  27, local model 9, internal_epoch  10, Average loss: 0.0166, Accuracy: 807/1275 (63.2941%), train_poison_data_count: 800
Global model norm: 112.05488767368651.
Norm before scaling: 112.03407423218394. Distance: 1.0011014237101576
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.5554, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.3645, Accuracy: 9949/9950 (99.9899%)
Scaling by  100
Scaled Norm after poisoning: 148.36357369651083, distance: 100.11013954171925
Total norm for 5 adversaries is: 148.36357369651083. distance: 100.11013954171925
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 179/953 (18.7828%)
___Train Local_ResNet_18, epoch  27, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 323/953 (33.8930%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.3523, Accuracy: 80/10000 (0.8000%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   1, Avg loss: 0.0806, Accuracy: 64/486 (13.1687%)
___Train Local_ResNet_18, epoch  27, local model 30, internal_epoch   2, Avg loss: 0.0407, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.8207, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 323/1645 (19.6353%)
___Train Local_ResNet_18, epoch  27, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 635/1645 (38.6018%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8593, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   1, Avg loss: 0.0854, Accuracy: 43/466 (9.2275%)
___Train Local_ResNet_18, epoch  27, local model 76, internal_epoch   2, Avg loss: 0.0492, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.6100, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 400/1750 (22.8571%)
___Train Local_ResNet_18, epoch  27, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 688/1750 (39.3143%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.8853, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   1, Avg loss: 0.0546, Accuracy: 311/1013 (30.7009%)
___Train Local_ResNet_18, epoch  27, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 496/1013 (48.9635%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.3738, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 526/1470 (35.7823%)
___Train Local_ResNet_18, epoch  27, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 898/1470 (61.0884%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.2802, Accuracy: 71/10000 (0.7100%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   1, Avg loss: 0.0842, Accuracy: 36/416 (8.6538%)
___Train Local_ResNet_18, epoch  27, local model 78, internal_epoch   2, Avg loss: 0.0471, Accuracy: 167/416 (40.1442%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.5355, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 434/1988 (21.8310%)
___Train Local_ResNet_18, epoch  27, local model 85, internal_epoch   2, Avg loss: 0.0356, Accuracy: 673/1988 (33.8531%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.7958, Accuracy: 81/10000 (0.8100%)
time spent on training: 268.63389682769775
[foolsgold agg] training data poison_ratio: 0.5160530448438317  data num: [1275, 953, 486, 1645, 466, 1750, 1013, 1470, 416, 1988]
[foolsgold agg] considering poison per batch poison_fraction: 0.3225331530273948
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3136, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.5665, Accuracy: 0/9950 (0.0000%)
saving model
Done in 665.9382560253143 sec.
Server Epoch:28 choose agents : [64, 26, 82, 31, 65, 98, 73, 61, 44, 18].
___Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   1, Avg loss: 0.0645, Accuracy: 165/953 (17.3137%)
___Train Local_ResNet_18, epoch  28, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 317/953 (33.2634%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.7526, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   1, Avg loss: 0.0556, Accuracy: 324/1446 (22.4066%)
___Train Local_ResNet_18, epoch  28, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 496/1446 (34.3015%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.0546, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   1, Avg loss: 0.0764, Accuracy: 59/500 (11.8000%)
___Train Local_ResNet_18, epoch  28, local model 82, internal_epoch   2, Avg loss: 0.0498, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.6568, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 51/460 (11.0870%)
___Train Local_ResNet_18, epoch  28, local model 31, internal_epoch   2, Avg loss: 0.0368, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.7639, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   1, Avg loss: 0.0562, Accuracy: 388/1475 (26.3051%)
___Train Local_ResNet_18, epoch  28, local model 65, internal_epoch   2, Avg loss: 0.0318, Accuracy: 621/1475 (42.1017%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.9865, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   1, Avg loss: 0.0823, Accuracy: 21/373 (5.6300%)
___Train Local_ResNet_18, epoch  28, local model 98, internal_epoch   2, Avg loss: 0.0493, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.4330, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   1, Avg loss: 0.0654, Accuracy: 166/938 (17.6972%)
___Train Local_ResNet_18, epoch  28, local model 73, internal_epoch   2, Avg loss: 0.0337, Accuracy: 311/938 (33.1557%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.9397, Accuracy: 64/10000 (0.6400%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  28, local model 61, internal_epoch   2, Avg loss: 0.1178, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3041, Accuracy: 55/10000 (0.5500%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 403/1750 (23.0286%)
___Train Local_ResNet_18, epoch  28, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 671/1750 (38.3429%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9195, Accuracy: 92/10000 (0.9200%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   1, Avg loss: 0.0763, Accuracy: 112/530 (21.1321%)
___Train Local_ResNet_18, epoch  28, local model 18, internal_epoch   2, Avg loss: 0.0391, Accuracy: 261/530 (49.2453%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.9554, Accuracy: 68/10000 (0.6800%)
time spent on training: 157.4132022857666
[foolsgold agg] training data poison_ratio: 0.4512338425381904  data num: [953, 1446, 500, 460, 1475, 373, 938, 85, 1750, 530]
[foolsgold agg] considering poison per batch poison_fraction: 0.282021151586369
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3136, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.5631, Accuracy: 0/9950 (0.0000%)
saving model
Done in 556.1573262214661 sec.
Server Epoch:29 choose agents : [10, 11, 42, 19, 88, 80, 54, 78, 92, 96].
poison local model 10 index 4 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   1, Average loss: 0.0534, Accuracy: 391/861 (45.4123%), train_poison_data_count: 549
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   2, Average loss: 0.0302, Accuracy: 509/861 (59.1173%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   3, Average loss: 0.0209, Accuracy: 530/861 (61.5563%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   4, Average loss: 0.0185, Accuracy: 547/861 (63.5308%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   5, Average loss: 0.0188, Accuracy: 549/861 (63.7631%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   6, Average loss: 0.0183, Accuracy: 549/861 (63.7631%), train_poison_data_count: 549
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   7, Average loss: 0.0183, Accuracy: 550/861 (63.8792%), train_poison_data_count: 549
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   8, Average loss: 0.0176, Accuracy: 549/861 (63.7631%), train_poison_data_count: 549
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch   9, Average loss: 0.0181, Accuracy: 549/861 (63.7631%), train_poison_data_count: 549
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  29, local model 10, internal_epoch  10, Average loss: 0.0170, Accuracy: 550/861 (63.8792%), train_poison_data_count: 549
Global model norm: 112.05478309319285.
Norm before scaling: 112.04169233063422. Distance: 0.8397276332337512
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.9435, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: 0.3897, Accuracy: 9949/9950 (99.9899%)
Scaling by  100
Scaled Norm after poisoning: 138.72247052343394, distance: 83.9727622785359
Total norm for 4 adversaries is: 138.72247052343394. distance: 83.9727622785359
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   1, Avg loss: 0.0535, Accuracy: 351/712 (49.2978%)
___Train Local_ResNet_18, epoch  29, local model 11, internal_epoch   2, Avg loss: 0.0277, Accuracy: 429/712 (60.2528%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.5639, Accuracy: 50/10000 (0.5000%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 368/1372 (26.8222%)
___Train Local_ResNet_18, epoch  29, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 492/1372 (35.8601%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.7104, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 401/1036 (38.7066%)
___Train Local_ResNet_18, epoch  29, local model 19, internal_epoch   2, Avg loss: 0.0249, Accuracy: 658/1036 (63.5135%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.9949, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   1, Avg loss: 0.0744, Accuracy: 138/603 (22.8856%)
___Train Local_ResNet_18, epoch  29, local model 88, internal_epoch   2, Avg loss: 0.0448, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.8835, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   1, Avg loss: 0.0706, Accuracy: 144/682 (21.1144%)
___Train Local_ResNet_18, epoch  29, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 240/682 (35.1906%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.2614, Accuracy: 47/10000 (0.4700%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 346/1130 (30.6195%)
___Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 481/1130 (42.5664%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.5499, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.0832, Accuracy: 41/416 (9.8558%)
___Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0473, Accuracy: 168/416 (40.3846%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.5467, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 486/1715 (28.3382%)
___Train Local_ResNet_18, epoch  29, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 735/1715 (42.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.4218, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   1, Avg loss: 0.0790, Accuracy: 46/311 (14.7910%)
___Train Local_ResNet_18, epoch  29, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3471, Accuracy: 50/10000 (0.5000%)
time spent on training: 237.94998049736023
[foolsgold agg] training data poison_ratio: 0.42758542656709664  data num: [861, 712, 1372, 1036, 603, 682, 1130, 416, 1715, 311]
[foolsgold agg] considering poison per batch poison_fraction: 0.2672408916044354
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3134, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.5557, Accuracy: 0/9950 (0.0000%)
saving model
Done in 636.0408639907837 sec.
Server Epoch:30 choose agents : [90, 87, 0, 73, 61, 97, 66, 35, 1, 22].
___Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 312/677 (46.0857%)
___Train Local_ResNet_18, epoch  30, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 482/677 (71.1965%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.0598, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   1, Avg loss: 0.0583, Accuracy: 294/1131 (25.9947%)
___Train Local_ResNet_18, epoch  30, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 416/1131 (36.7816%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7912, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   1, Avg loss: 0.0572, Accuracy: 380/1657 (22.9330%)
___Train Local_ResNet_18, epoch  30, local model 0, internal_epoch   2, Avg loss: 0.0342, Accuracy: 531/1657 (32.0459%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.6160, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   1, Avg loss: 0.0662, Accuracy: 173/938 (18.4435%)
___Train Local_ResNet_18, epoch  30, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 321/938 (34.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.5057, Accuracy: 46/10000 (0.4600%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   1, Avg loss: 0.1257, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   2, Avg loss: 0.1164, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3043, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 345/1213 (28.4419%)
___Train Local_ResNet_18, epoch  30, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 506/1213 (41.7148%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.4862, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   1, Avg loss: 0.0614, Accuracy: 259/1402 (18.4736%)
___Train Local_ResNet_18, epoch  30, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 398/1402 (28.3880%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.0840, Accuracy: 71/10000 (0.7100%)
___Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   1, Avg loss: 0.0847, Accuracy: 43/271 (15.8672%)
___Train Local_ResNet_18, epoch  30, local model 35, internal_epoch   2, Avg loss: 0.0561, Accuracy: 98/271 (36.1624%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3696, Accuracy: 38/10000 (0.3800%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0559, Accuracy: 294/928 (31.6810%)
___Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0231, Accuracy: 600/928 (64.6552%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.5389, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 517/1470 (35.1701%)
___Train Local_ResNet_18, epoch  30, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 859/1470 (58.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8317, Accuracy: 69/10000 (0.6900%)
time spent on training: 146.14705395698547
[foolsgold agg] training data poison_ratio: 0.17826442898076136  data num: [677, 1131, 1657, 938, 85, 1213, 1402, 271, 928, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.11141526811297585
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3133, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.5543, Accuracy: 0/9950 (0.0000%)
saving model
Done in 541.0898089408875 sec.
Server Epoch:31 choose agents : [12, 97, 60, 95, 0, 45, 47, 74, 1, 90].
poison local model 12 index 5 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   1, Average loss: 0.0816, Accuracy: 58/338 (17.1598%), train_poison_data_count: 218
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   2, Average loss: 0.0389, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   3, Average loss: 0.0405, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   4, Average loss: 0.0402, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   5, Average loss: 0.0377, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   6, Average loss: 0.0350, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   7, Average loss: 0.0308, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   8, Average loss: 0.0287, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch   9, Average loss: 0.0265, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  31, local model 12, internal_epoch  10, Average loss: 0.0275, Accuracy: 218/338 (64.4970%), train_poison_data_count: 218
Global model norm: 112.05467415507485.
Norm before scaling: 112.05052135504546. Distance: 0.5216452818236048
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.8082, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: 0.2787, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 123.11476004372912, distance: 52.1645229171309
Total norm for 5 adversaries is: 123.11476004372912. distance: 52.1645229171309
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0522, Accuracy: 360/1213 (29.6785%)
___Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 487/1213 (40.1484%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.6684, Accuracy: 84/10000 (0.8400%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 572/2227 (25.6848%)
___Train Local_ResNet_18, epoch  31, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1011/2227 (45.3974%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.9606, Accuracy: 103/10000 (1.0300%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   1, Avg loss: 0.0534, Accuracy: 322/599 (53.7563%)
___Train Local_ResNet_18, epoch  31, local model 95, internal_epoch   2, Avg loss: 0.0294, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5737, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   1, Avg loss: 0.0579, Accuracy: 370/1657 (22.3295%)
___Train Local_ResNet_18, epoch  31, local model 0, internal_epoch   2, Avg loss: 0.0350, Accuracy: 507/1657 (30.5975%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5571, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   1, Avg loss: 0.0684, Accuracy: 194/669 (28.9985%)
___Train Local_ResNet_18, epoch  31, local model 45, internal_epoch   2, Avg loss: 0.0404, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.8020, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   1, Avg loss: 0.1233, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  31, local model 47, internal_epoch   2, Avg loss: 0.1076, Accuracy: 14/134 (10.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 514/1552 (33.1186%)
___Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 769/1552 (49.5490%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.7531, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0568, Accuracy: 289/928 (31.1422%)
___Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0243, Accuracy: 557/928 (60.0216%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.5987, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   1, Avg loss: 0.0566, Accuracy: 320/677 (47.2674%)
___Train Local_ResNet_18, epoch  31, local model 90, internal_epoch   2, Avg loss: 0.0227, Accuracy: 457/677 (67.5037%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.9935, Accuracy: 53/10000 (0.5300%)
time spent on training: 249.30546236038208
[foolsgold agg] training data poison_ratio: 0.6376826095657394  data num: [338, 1213, 2227, 599, 1657, 669, 134, 1552, 928, 677]
[foolsgold agg] considering poison per batch poison_fraction: 0.39855163097858715
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3133, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.5603, Accuracy: 0/9950 (0.0000%)
saving model
Done in 649.9348537921906 sec.
Server Epoch:32 choose agents : [90, 32, 84, 98, 78, 46, 40, 68, 29, 95].
___Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 322/677 (47.5628%)
___Train Local_ResNet_18, epoch  32, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 449/677 (66.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.2765, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0595, Accuracy: 195/735 (26.5306%)
___Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0235, Accuracy: 341/735 (46.3946%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.5200, Accuracy: 54/10000 (0.5400%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   1, Avg loss: 0.0619, Accuracy: 326/1190 (27.3950%)
___Train Local_ResNet_18, epoch  32, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 453/1190 (38.0672%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.9576, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   1, Avg loss: 0.0826, Accuracy: 14/373 (3.7534%)
___Train Local_ResNet_18, epoch  32, local model 98, internal_epoch   2, Avg loss: 0.0491, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.4351, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   1, Avg loss: 0.0836, Accuracy: 38/416 (9.1346%)
___Train Local_ResNet_18, epoch  32, local model 78, internal_epoch   2, Avg loss: 0.0459, Accuracy: 175/416 (42.0673%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.5527, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0547, Accuracy: 429/1904 (22.5315%)
___Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 679/1904 (35.6618%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.8220, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   1, Avg loss: 0.0554, Accuracy: 356/1573 (22.6319%)
___Train Local_ResNet_18, epoch  32, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 527/1573 (33.5029%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.3885, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   1, Avg loss: 0.0628, Accuracy: 367/1163 (31.5563%)
___Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   2, Avg loss: 0.0372, Accuracy: 419/1163 (36.0275%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.7851, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 397/1440 (27.5694%)
___Train Local_ResNet_18, epoch  32, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 664/1440 (46.1111%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.7486, Accuracy: 66/10000 (0.6600%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0519, Accuracy: 333/599 (55.5927%)
___Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0286, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.7144, Accuracy: 50/10000 (0.5000%)
time spent on training: 161.17334985733032
[foolsgold agg] training data poison_ratio: 0.21896722939424032  data num: [677, 735, 1190, 373, 416, 1904, 1573, 1163, 1440, 599]
[foolsgold agg] considering poison per batch poison_fraction: 0.1368545183714002
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3132, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.5568, Accuracy: 0/9950 (0.0000%)
saving model
Done in 552.397513628006 sec.
Server Epoch:33 choose agents : [15, 44, 14, 40, 61, 33, 88, 73, 21, 30].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Average loss: 0.0512, Accuracy: 570/1154 (49.3934%), train_poison_data_count: 722
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Average loss: 0.0260, Accuracy: 669/1154 (57.9723%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Average loss: 0.0217, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Average loss: 0.0212, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Average loss: 0.0212, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Average loss: 0.0206, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Average loss: 0.0202, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Average loss: 0.0204, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Average loss: 0.0199, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Average loss: 0.0193, Accuracy: 722/1154 (62.5650%), train_poison_data_count: 722
Global model norm: 112.05456085931978.
Norm before scaling: 112.03440110631199. Distance: 0.8973079712922111
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.1592, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: 0.3891, Accuracy: 9945/9950 (99.9497%)
Scaling by  100
Scaled Norm after poisoning: 141.68861655934114, distance: 89.73079856402427
Total norm for 5 adversaries is: 141.68861655934114. distance: 89.73079856402427
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 410/1750 (23.4286%)
___Train Local_ResNet_18, epoch  33, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 673/1750 (38.4571%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.7021, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 221/1013 (21.8164%)
___Train Local_ResNet_18, epoch  33, local model 14, internal_epoch   2, Avg loss: 0.0354, Accuracy: 348/1013 (34.3534%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.7552, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 357/1573 (22.6955%)
___Train Local_ResNet_18, epoch  33, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 582/1573 (36.9994%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.3809, Accuracy: 65/10000 (0.6500%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   1, Avg loss: 0.1249, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  33, local model 61, internal_epoch   2, Avg loss: 0.1179, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3043, Accuracy: 45/10000 (0.4500%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   1, Avg loss: 0.0789, Accuracy: 66/515 (12.8155%)
___Train Local_ResNet_18, epoch  33, local model 33, internal_epoch   2, Avg loss: 0.0491, Accuracy: 120/515 (23.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.7806, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   1, Avg loss: 0.0745, Accuracy: 139/603 (23.0514%)
___Train Local_ResNet_18, epoch  33, local model 88, internal_epoch   2, Avg loss: 0.0448, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.9377, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   1, Avg loss: 0.0653, Accuracy: 181/938 (19.2964%)
___Train Local_ResNet_18, epoch  33, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 334/938 (35.6077%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.0242, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 418/1949 (21.4469%)
___Train Local_ResNet_18, epoch  33, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 618/1949 (31.7086%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.2234, Accuracy: 65/10000 (0.6500%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   1, Avg loss: 0.0803, Accuracy: 69/486 (14.1975%)
___Train Local_ResNet_18, epoch  33, local model 30, internal_epoch   2, Avg loss: 0.0400, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.7421, Accuracy: 45/10000 (0.4500%)
time spent on training: 269.9926915168762
[foolsgold agg] training data poison_ratio: 0.3963838664812239  data num: [1154, 1750, 1013, 1573, 85, 515, 603, 938, 1949, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.24773991655076494
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3131, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.5526, Accuracy: 0/9950 (0.0000%)
saving model
Done in 662.1860864162445 sec.
Server Epoch:34 choose agents : [0, 71, 20, 83, 56, 36, 68, 89, 82, 19].
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   1, Avg loss: 0.0576, Accuracy: 343/1657 (20.7001%)
___Train Local_ResNet_18, epoch  34, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 534/1657 (32.2269%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.7706, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0647, Accuracy: 169/818 (20.6601%)
___Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0309, Accuracy: 350/818 (42.7873%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.1197, Accuracy: 66/10000 (0.6600%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   1, Avg loss: 0.0562, Accuracy: 347/807 (42.9988%)
___Train Local_ResNet_18, epoch  34, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 433/807 (53.6555%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.9184, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 444/1953 (22.7343%)
___Train Local_ResNet_18, epoch  34, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 787/1953 (40.2970%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3946, Accuracy: 119/10000 (1.1900%)
___Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   2, Avg loss: 0.0677, Accuracy: 64/186 (34.4086%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   1, Avg loss: 0.0869, Accuracy: 69/408 (16.9118%)
___Train Local_ResNet_18, epoch  34, local model 36, internal_epoch   2, Avg loss: 0.0558, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.4901, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   1, Avg loss: 0.0630, Accuracy: 369/1163 (31.7283%)
___Train Local_ResNet_18, epoch  34, local model 68, internal_epoch   2, Avg loss: 0.0375, Accuracy: 425/1163 (36.5434%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.5790, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   1, Avg loss: 0.0614, Accuracy: 330/896 (36.8304%)
___Train Local_ResNet_18, epoch  34, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 446/896 (49.7768%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.3106, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.0760, Accuracy: 69/500 (13.8000%)
___Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.6232, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   1, Avg loss: 0.0461, Accuracy: 381/1036 (36.7761%)
___Train Local_ResNet_18, epoch  34, local model 19, internal_epoch   2, Avg loss: 0.0237, Accuracy: 686/1036 (66.2162%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.1031, Accuracy: 50/10000 (0.5000%)
time spent on training: 166.58498978614807
[foolsgold agg] training data poison_ratio: 0.30475382003395585  data num: [1657, 818, 807, 1953, 186, 408, 1163, 896, 500, 1036]
[foolsgold agg] considering poison per batch poison_fraction: 0.1904711375212224
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3129, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.5518, Accuracy: 0/9950 (0.0000%)
saving model
Done in 548.2483375072479 sec.
Server Epoch:35 choose agents : [18, 75, 5, 22, 38, 73, 46, 20, 83, 88].
poison local model 18 index 7 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   1, Average loss: 0.0657, Accuracy: 186/530 (35.0943%), train_poison_data_count: 338
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   2, Average loss: 0.0393, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   3, Average loss: 0.0308, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   4, Average loss: 0.0269, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   5, Average loss: 0.0261, Accuracy: 337/530 (63.5849%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   6, Average loss: 0.0251, Accuracy: 337/530 (63.5849%), train_poison_data_count: 338
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   7, Average loss: 0.0245, Accuracy: 337/530 (63.5849%), train_poison_data_count: 338
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   8, Average loss: 0.0227, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch   9, Average loss: 0.0239, Accuracy: 338/530 (63.7736%), train_poison_data_count: 338
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  35, local model 18, internal_epoch  10, Average loss: 0.0235, Accuracy: 339/530 (63.9623%), train_poison_data_count: 338
Global model norm: 112.05445627852112.
Norm before scaling: 112.04690877317857. Distance: 0.6686989880651864
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.7757, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: 0.3182, Accuracy: 9949/9950 (99.9899%)
Scaling by  100
Scaled Norm after poisoning: 129.669599668253, distance: 66.86989612533057
Total norm for 3 adversaries is: 129.669599668253. distance: 66.86989612533057
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   1, Avg loss: 0.0629, Accuracy: 245/776 (31.5722%)
___Train Local_ResNet_18, epoch  35, local model 75, internal_epoch   2, Avg loss: 0.0295, Accuracy: 419/776 (53.9948%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.7568, Accuracy: 51/10000 (0.5100%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 381/1628 (23.4029%)
___Train Local_ResNet_18, epoch  35, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 841/1628 (51.6585%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.1297, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 536/1470 (36.4626%)
___Train Local_ResNet_18, epoch  35, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 851/1470 (57.8912%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.9794, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   1, Avg loss: 0.0618, Accuracy: 247/1131 (21.8391%)
___Train Local_ResNet_18, epoch  35, local model 38, internal_epoch   2, Avg loss: 0.0315, Accuracy: 447/1131 (39.5225%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.2687, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   1, Avg loss: 0.0649, Accuracy: 180/938 (19.1898%)
___Train Local_ResNet_18, epoch  35, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 330/938 (35.1812%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.3531, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 400/1904 (21.0084%)
___Train Local_ResNet_18, epoch  35, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 699/1904 (36.7122%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.9094, Accuracy: 104/10000 (1.0400%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   1, Avg loss: 0.0580, Accuracy: 342/807 (42.3792%)
___Train Local_ResNet_18, epoch  35, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 421/807 (52.1685%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.5137, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 435/1953 (22.2734%)
___Train Local_ResNet_18, epoch  35, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 794/1953 (40.6554%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.2178, Accuracy: 104/10000 (1.0400%)
___Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 141/603 (23.3831%)
___Train Local_ResNet_18, epoch  35, local model 88, internal_epoch   2, Avg loss: 0.0453, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.7900, Accuracy: 57/10000 (0.5700%)
time spent on training: 252.74399423599243
[foolsgold agg] training data poison_ratio: 0.25255536626916525  data num: [530, 776, 1628, 1470, 1131, 938, 1904, 807, 1953, 603]
[foolsgold agg] considering poison per batch poison_fraction: 0.1578471039182283
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3128, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.5524, Accuracy: 0/9950 (0.0000%)
saving model
Done in 641.8392291069031 sec.
Server Epoch:36 choose agents : [19, 2, 97, 73, 5, 51, 21, 63, 11, 90].
___Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 393/1036 (37.9344%)
___Train Local_ResNet_18, epoch  36, local model 19, internal_epoch   2, Avg loss: 0.0251, Accuracy: 637/1036 (61.4865%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.9760, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 229/605 (37.8512%)
___Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0384, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.8520, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   1, Avg loss: 0.0524, Accuracy: 371/1213 (30.5853%)
___Train Local_ResNet_18, epoch  36, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 488/1213 (40.2308%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.5930, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   1, Avg loss: 0.0651, Accuracy: 181/938 (19.2964%)
___Train Local_ResNet_18, epoch  36, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 369/938 (39.3390%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.1736, Accuracy: 63/10000 (0.6300%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   1, Avg loss: 0.0508, Accuracy: 373/1628 (22.9115%)
___Train Local_ResNet_18, epoch  36, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 827/1628 (50.7985%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.0586, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   1, Avg loss: 0.0599, Accuracy: 230/1049 (21.9256%)
___Train Local_ResNet_18, epoch  36, local model 51, internal_epoch   2, Avg loss: 0.0309, Accuracy: 477/1049 (45.4719%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.4025, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   1, Avg loss: 0.0536, Accuracy: 403/1949 (20.6773%)
___Train Local_ResNet_18, epoch  36, local model 21, internal_epoch   2, Avg loss: 0.0334, Accuracy: 604/1949 (30.9903%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.4732, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 260/888 (29.2793%)
___Train Local_ResNet_18, epoch  36, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 408/888 (45.9459%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.1933, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   1, Avg loss: 0.0562, Accuracy: 350/712 (49.1573%)
___Train Local_ResNet_18, epoch  36, local model 11, internal_epoch   2, Avg loss: 0.0268, Accuracy: 426/712 (59.8315%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.6801, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   1, Avg loss: 0.0560, Accuracy: 325/677 (48.0059%)
___Train Local_ResNet_18, epoch  36, local model 90, internal_epoch   2, Avg loss: 0.0225, Accuracy: 447/677 (66.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.0530, Accuracy: 53/10000 (0.5300%)
time spent on training: 154.50741052627563
[foolsgold agg] training data poison_ratio: 0.1522206638616176  data num: [1036, 605, 1213, 938, 1628, 1049, 1949, 888, 712, 677]
[foolsgold agg] considering poison per batch poison_fraction: 0.09513791491351099
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3127, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.5512, Accuracy: 0/9950 (0.0000%)
saving model
Done in 545.3978197574615 sec.
Server Epoch:37 choose agents : [20, 66, 18, 64, 77, 51, 65, 3, 17, 50].
poison local model 20 index 8 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   1, Average loss: 0.0502, Accuracy: 369/807 (45.7249%), train_poison_data_count: 519
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   2, Average loss: 0.0311, Accuracy: 456/807 (56.5056%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   3, Average loss: 0.0245, Accuracy: 515/807 (63.8166%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   4, Average loss: 0.0234, Accuracy: 519/807 (64.3123%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   5, Average loss: 0.0231, Accuracy: 524/807 (64.9318%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   6, Average loss: 0.0224, Accuracy: 521/807 (64.5601%), train_poison_data_count: 519
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   7, Average loss: 0.0224, Accuracy: 518/807 (64.1884%), train_poison_data_count: 519
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   8, Average loss: 0.0217, Accuracy: 514/807 (63.6927%), train_poison_data_count: 519
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch   9, Average loss: 0.0208, Accuracy: 519/807 (64.3123%), train_poison_data_count: 519
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  37, local model 20, internal_epoch  10, Average loss: 0.0210, Accuracy: 521/807 (64.5601%), train_poison_data_count: 519
Global model norm: 112.05432990992584.
Norm before scaling: 112.04179692334687. Distance: 0.7417323272728884
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.6907, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: 0.3631, Accuracy: 9944/9950 (99.9397%)
Scaling by  100
Scaled Norm after poisoning: 133.12301201567294, distance: 74.17322946151124
Total norm for 4 adversaries is: 133.12301201567294. distance: 74.17322946151124
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   1, Avg loss: 0.0623, Accuracy: 256/1402 (18.2596%)
___Train Local_ResNet_18, epoch  37, local model 66, internal_epoch   2, Avg loss: 0.0391, Accuracy: 364/1402 (25.9629%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.1360, Accuracy: 73/10000 (0.7300%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   1, Avg loss: 0.0759, Accuracy: 116/530 (21.8868%)
___Train Local_ResNet_18, epoch  37, local model 18, internal_epoch   2, Avg loss: 0.0397, Accuracy: 271/530 (51.1321%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.1029, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 170/953 (17.8384%)
___Train Local_ResNet_18, epoch  37, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 301/953 (31.5845%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.4380, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   1, Avg loss: 0.0532, Accuracy: 319/1340 (23.8060%)
___Train Local_ResNet_18, epoch  37, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 554/1340 (41.3433%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.7418, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0602, Accuracy: 221/1049 (21.0677%)
___Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 521/1049 (49.6663%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.4863, Accuracy: 80/10000 (0.8000%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   1, Avg loss: 0.0568, Accuracy: 378/1475 (25.6271%)
___Train Local_ResNet_18, epoch  37, local model 65, internal_epoch   2, Avg loss: 0.0318, Accuracy: 637/1475 (43.1864%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.1602, Accuracy: 63/10000 (0.6300%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   1, Avg loss: 0.0739, Accuracy: 120/781 (15.3649%)
___Train Local_ResNet_18, epoch  37, local model 3, internal_epoch   2, Avg loss: 0.0363, Accuracy: 244/781 (31.2420%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.9543, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   1, Avg loss: 0.0511, Accuracy: 402/1574 (25.5400%)
___Train Local_ResNet_18, epoch  37, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 703/1574 (44.6633%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1423, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   1, Avg loss: 0.0629, Accuracy: 167/809 (20.6428%)
___Train Local_ResNet_18, epoch  37, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 356/809 (44.0049%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.2511, Accuracy: 71/10000 (0.7100%)
time spent on training: 268.3558008670807
[foolsgold agg] training data poison_ratio: 0.3351679104477612  data num: [807, 1402, 530, 953, 1340, 1049, 1475, 781, 1574, 809]
[foolsgold agg] considering poison per batch poison_fraction: 0.20947994402985073
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3126, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.5493, Accuracy: 0/9950 (0.0000%)
saving model
Done in 660.0227234363556 sec.
Server Epoch:38 choose agents : [88, 72, 77, 38, 20, 39, 70, 1, 37, 6].
___Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   1, Avg loss: 0.0744, Accuracy: 135/603 (22.3881%)
___Train Local_ResNet_18, epoch  38, local model 88, internal_epoch   2, Avg loss: 0.0452, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.0111, Accuracy: 48/10000 (0.4800%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 257/1241 (20.7091%)
___Train Local_ResNet_18, epoch  38, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 444/1241 (35.7776%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.1152, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   1, Avg loss: 0.0536, Accuracy: 340/1340 (25.3731%)
___Train Local_ResNet_18, epoch  38, local model 77, internal_epoch   2, Avg loss: 0.0278, Accuracy: 538/1340 (40.1493%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.9683, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   1, Avg loss: 0.0619, Accuracy: 246/1131 (21.7507%)
___Train Local_ResNet_18, epoch  38, local model 38, internal_epoch   2, Avg loss: 0.0310, Accuracy: 439/1131 (38.8152%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.3266, Accuracy: 84/10000 (0.8400%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   1, Avg loss: 0.0576, Accuracy: 348/807 (43.1227%)
___Train Local_ResNet_18, epoch  38, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 443/807 (54.8947%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.7797, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0541, Accuracy: 315/1013 (31.0958%)
___Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0263, Accuracy: 476/1013 (46.9891%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.5566, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 366/1418 (25.8110%)
___Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0297, Accuracy: 673/1418 (47.4612%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.5525, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0566, Accuracy: 296/928 (31.8966%)
___Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 554/928 (59.6983%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.0886, Accuracy: 81/10000 (0.8100%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0520, Accuracy: 407/1129 (36.0496%)
___Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0251, Accuracy: 739/1129 (65.4562%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.8232, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 406/1956 (20.7566%)
___Train Local_ResNet_18, epoch  38, local model 6, internal_epoch   2, Avg loss: 0.0328, Accuracy: 622/1956 (31.7996%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.1678, Accuracy: 87/10000 (0.8700%)
time spent on training: 188.29578113555908
[foolsgold agg] training data poison_ratio: 0.2746844198512883  data num: [603, 1241, 1340, 1131, 807, 1013, 1418, 928, 1129, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.17167776240705518
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3125, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.5499, Accuracy: 0/9950 (0.0000%)
saving model
Done in 581.5559506416321 sec.
Server Epoch:39 choose agents : [24, 58, 63, 88, 9, 51, 54, 64, 13, 27].
poison local model 24 index 9 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   1, Average loss: 0.0773, Accuracy: 45/312 (14.4231%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   2, Average loss: 0.0405, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   3, Average loss: 0.0327, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   4, Average loss: 0.0323, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   5, Average loss: 0.0312, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   6, Average loss: 0.0288, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   7, Average loss: 0.0261, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   8, Average loss: 0.0252, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch   9, Average loss: 0.0241, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  39, local model 24, internal_epoch  10, Average loss: 0.0247, Accuracy: 200/312 (64.1026%), train_poison_data_count: 200
Global model norm: 112.0542166138227.
Norm before scaling: 112.05144082351195. Distance: 0.4879066708982638
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.3568, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: 0.5692, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 121.86281589737494, distance: 48.790668133107175
Total norm for 3 adversaries is: 121.86281589737494. distance: 48.790668133107175
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 339/803 (42.2167%)
___Train Local_ResNet_18, epoch  39, local model 58, internal_epoch   2, Avg loss: 0.0340, Accuracy: 392/803 (48.8169%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.9406, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   1, Avg loss: 0.0540, Accuracy: 263/888 (29.6171%)
___Train Local_ResNet_18, epoch  39, local model 63, internal_epoch   2, Avg loss: 0.0255, Accuracy: 439/888 (49.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.9901, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   1, Avg loss: 0.0731, Accuracy: 140/603 (23.2172%)
___Train Local_ResNet_18, epoch  39, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 286/603 (47.4295%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.9489, Accuracy: 54/10000 (0.5400%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0494, Accuracy: 364/1275 (28.5490%)
___Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 692/1275 (54.2745%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.2569, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0599, Accuracy: 256/1049 (24.4042%)
___Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0303, Accuracy: 502/1049 (47.8551%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.5287, Accuracy: 84/10000 (0.8400%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 345/1130 (30.5310%)
___Train Local_ResNet_18, epoch  39, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 481/1130 (42.5664%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6752, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   1, Avg loss: 0.0639, Accuracy: 172/953 (18.0483%)
___Train Local_ResNet_18, epoch  39, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 299/953 (31.3746%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.4906, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   1, Avg loss: 0.0572, Accuracy: 330/1645 (20.0608%)
___Train Local_ResNet_18, epoch  39, local model 13, internal_epoch   2, Avg loss: 0.0323, Accuracy: 646/1645 (39.2705%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.9118, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0527, Accuracy: 485/1587 (30.5608%)
___Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 616/1587 (38.8154%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.1451, Accuracy: 65/10000 (0.6500%)
time spent on training: 247.53682804107666
[foolsgold agg] training data poison_ratio: 0.2652025378233285  data num: [312, 803, 888, 603, 1275, 1049, 1130, 953, 1645, 1587]
[foolsgold agg] considering poison per batch poison_fraction: 0.1657515861395803
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3125, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.5515, Accuracy: 0/9950 (0.0000%)
saving model
Done in 638.6640975475311 sec.
Server Epoch:40 choose agents : [40, 88, 66, 47, 61, 96, 3, 5, 16, 24].
___Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   1, Avg loss: 0.0544, Accuracy: 335/1573 (21.2969%)
___Train Local_ResNet_18, epoch  40, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 566/1573 (35.9822%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.4948, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   1, Avg loss: 0.0735, Accuracy: 146/603 (24.2123%)
___Train Local_ResNet_18, epoch  40, local model 88, internal_epoch   2, Avg loss: 0.0471, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.9278, Accuracy: 46/10000 (0.4600%)
___Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   1, Avg loss: 0.0615, Accuracy: 265/1402 (18.9016%)
___Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 380/1402 (27.1041%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.0448, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   1, Avg loss: 0.1227, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 47, internal_epoch   2, Avg loss: 0.1096, Accuracy: 18/134 (13.4328%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3091, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   1, Avg loss: 0.1259, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  40, local model 61, internal_epoch   2, Avg loss: 0.1158, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3046, Accuracy: 41/10000 (0.4100%)
___Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 50/311 (16.0772%)
___Train Local_ResNet_18, epoch  40, local model 96, internal_epoch   2, Avg loss: 0.0539, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3494, Accuracy: 50/10000 (0.5000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   1, Avg loss: 0.0740, Accuracy: 108/781 (13.8284%)
___Train Local_ResNet_18, epoch  40, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 242/781 (30.9859%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.5718, Accuracy: 67/10000 (0.6700%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   1, Avg loss: 0.0511, Accuracy: 385/1628 (23.6486%)
___Train Local_ResNet_18, epoch  40, local model 5, internal_epoch   2, Avg loss: 0.0254, Accuracy: 810/1628 (49.7543%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.1968, Accuracy: 124/10000 (1.2400%)
___Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   1, Avg loss: 0.0606, Accuracy: 284/708 (40.1130%)
___Train Local_ResNet_18, epoch  40, local model 16, internal_epoch   2, Avg loss: 0.0371, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.8621, Accuracy: 66/10000 (0.6600%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   1, Avg loss: 0.0763, Accuracy: 32/312 (10.2564%)
___Train Local_ResNet_18, epoch  40, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 165/312 (52.8846%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3850, Accuracy: 50/10000 (0.5000%)
time spent on training: 169.71667551994324
[foolsgold agg] training data poison_ratio: 0.372296669762505  data num: [1573, 603, 1402, 134, 85, 311, 781, 1628, 708, 312]
[foolsgold agg] considering poison per batch poison_fraction: 0.2326854186015656
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3124, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.5515, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 574.9511957168579 sec.
Server Epoch:41 choose agents : [25, 36, 82, 2, 93, 42, 66, 94, 44, 38].
poison local model 25 index 10 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Average loss: 0.0563, Accuracy: 292/690 (42.3188%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Average loss: 0.0292, Accuracy: 392/690 (56.8116%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   3, Average loss: 0.0240, Accuracy: 297/690 (43.0435%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   4, Average loss: 0.0221, Accuracy: 426/690 (61.7391%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   5, Average loss: 0.0225, Accuracy: 441/690 (63.9130%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   6, Average loss: 0.0198, Accuracy: 438/690 (63.4783%), train_poison_data_count: 440
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   7, Average loss: 0.0198, Accuracy: 438/690 (63.4783%), train_poison_data_count: 440
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   8, Average loss: 0.0190, Accuracy: 438/690 (63.4783%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch   9, Average loss: 0.0198, Accuracy: 440/690 (63.7681%), train_poison_data_count: 440
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  41, local model 25, internal_epoch  10, Average loss: 0.0189, Accuracy: 438/690 (63.4783%), train_poison_data_count: 440
Global model norm: 112.05411203270275.
Norm before scaling: 112.0444814362247. Distance: 0.7659862989290962
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.8628, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: 0.3592, Accuracy: 9848/9950 (98.9749%)
Scaling by  100
Scaled Norm after poisoning: 134.71865938874242, distance: 76.59862986800906
Total norm for 4 adversaries is: 134.71865938874242. distance: 76.59862986800906
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   1, Avg loss: 0.0874, Accuracy: 73/408 (17.8922%)
___Train Local_ResNet_18, epoch  41, local model 36, internal_epoch   2, Avg loss: 0.0551, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.4823, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   1, Avg loss: 0.0764, Accuracy: 67/500 (13.4000%)
___Train Local_ResNet_18, epoch  41, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 176/500 (35.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.6581, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0637, Accuracy: 233/605 (38.5124%)
___Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.8183, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   1, Avg loss: 0.0545, Accuracy: 439/1742 (25.2009%)
___Train Local_ResNet_18, epoch  41, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 684/1742 (39.2652%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.9120, Accuracy: 80/10000 (0.8000%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 356/1372 (25.9475%)
___Train Local_ResNet_18, epoch  41, local model 42, internal_epoch   2, Avg loss: 0.0309, Accuracy: 527/1372 (38.4111%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.8869, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 247/1402 (17.6177%)
___Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 417/1402 (29.7432%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.1254, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 331/1662 (19.9158%)
___Train Local_ResNet_18, epoch  41, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 630/1662 (37.9061%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.8889, Accuracy: 106/10000 (1.0600%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 396/1750 (22.6286%)
___Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 653/1750 (37.3143%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.6388, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0614, Accuracy: 251/1131 (22.1927%)
___Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 501/1131 (44.2971%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.3337, Accuracy: 75/10000 (0.7500%)
time spent on training: 266.0797519683838
[foolsgold agg] training data poison_ratio: 0.37471141893091814  data num: [690, 408, 500, 605, 1742, 1372, 1402, 1662, 1750, 1131]
[foolsgold agg] considering poison per batch poison_fraction: 0.23419463683182384
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3122, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.5495, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 671.9372589588165 sec.
Server Epoch:42 choose agents : [55, 57, 12, 67, 31, 76, 26, 6, 64, 97].
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 247/1071 (23.0626%)
___Train Local_ResNet_18, epoch  42, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 482/1071 (45.0047%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.0362, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   1, Avg loss: 0.0559, Accuracy: 302/1154 (26.1698%)
___Train Local_ResNet_18, epoch  42, local model 57, internal_epoch   2, Avg loss: 0.0257, Accuracy: 444/1154 (38.4749%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.0795, Accuracy: 55/10000 (0.5500%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   1, Avg loss: 0.0876, Accuracy: 25/338 (7.3964%)
___Train Local_ResNet_18, epoch  42, local model 12, internal_epoch   2, Avg loss: 0.0479, Accuracy: 143/338 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.4306, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0786, Accuracy: 52/426 (12.2066%)
___Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0421, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.5896, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   1, Avg loss: 0.0821, Accuracy: 56/460 (12.1739%)
___Train Local_ResNet_18, epoch  42, local model 31, internal_epoch   2, Avg loss: 0.0383, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.8102, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   1, Avg loss: 0.0855, Accuracy: 42/466 (9.0129%)
___Train Local_ResNet_18, epoch  42, local model 76, internal_epoch   2, Avg loss: 0.0487, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.6864, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 337/1446 (23.3057%)
___Train Local_ResNet_18, epoch  42, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 513/1446 (35.4772%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.1081, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   1, Avg loss: 0.0552, Accuracy: 402/1956 (20.5521%)
___Train Local_ResNet_18, epoch  42, local model 6, internal_epoch   2, Avg loss: 0.0327, Accuracy: 661/1956 (33.7935%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.2411, Accuracy: 97/10000 (0.9700%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   1, Avg loss: 0.0644, Accuracy: 164/953 (17.2088%)
___Train Local_ResNet_18, epoch  42, local model 64, internal_epoch   2, Avg loss: 0.0377, Accuracy: 304/953 (31.8993%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.4601, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   1, Avg loss: 0.0523, Accuracy: 352/1213 (29.0190%)
___Train Local_ResNet_18, epoch  42, local model 97, internal_epoch   2, Avg loss: 0.0273, Accuracy: 479/1213 (39.4889%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.4974, Accuracy: 78/10000 (0.7800%)
time spent on training: 171.15248227119446
[foolsgold agg] training data poison_ratio: 0.14858167246651904  data num: [1071, 1154, 338, 426, 460, 466, 1446, 1956, 953, 1213]
[foolsgold agg] considering poison per batch poison_fraction: 0.0928635452915744
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3122, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.5488, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 567.3432438373566 sec.
Server Epoch:43 choose agents : [30, 89, 47, 67, 72, 23, 57, 51, 45, 60].
poison local model 30 index 11 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Average loss: 0.0678, Accuracy: 168/486 (34.5679%), train_poison_data_count: 318
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Average loss: 0.0389, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   3, Average loss: 0.0363, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   4, Average loss: 0.0327, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   5, Average loss: 0.0296, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   6, Average loss: 0.0255, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   7, Average loss: 0.0239, Accuracy: 317/486 (65.2263%), train_poison_data_count: 318
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   8, Average loss: 0.0244, Accuracy: 318/486 (65.4321%), train_poison_data_count: 318
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch   9, Average loss: 0.0252, Accuracy: 316/486 (65.0206%), train_poison_data_count: 318
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  43, local model 30, internal_epoch  10, Average loss: 0.0223, Accuracy: 320/486 (65.8436%), train_poison_data_count: 318
Global model norm: 112.05400309393235.
Norm before scaling: 112.04753629877365. Distance: 0.6286569421055843
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.2180, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: 0.4502, Accuracy: 9904/9950 (99.5377%)
Scaling by  100
Scaled Norm after poisoning: 127.76494378105052, distance: 62.86569575790122
Total norm for 3 adversaries is: 127.76494378105052. distance: 62.86569575790122
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   1, Avg loss: 0.0617, Accuracy: 327/896 (36.4955%)
___Train Local_ResNet_18, epoch  43, local model 89, internal_epoch   2, Avg loss: 0.0322, Accuracy: 462/896 (51.5625%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.2279, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   1, Avg loss: 0.1242, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  43, local model 47, internal_epoch   2, Avg loss: 0.1065, Accuracy: 13/134 (9.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3102, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   1, Avg loss: 0.0785, Accuracy: 56/426 (13.1455%)
___Train Local_ResNet_18, epoch  43, local model 67, internal_epoch   2, Avg loss: 0.0422, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.5923, Accuracy: 51/10000 (0.5100%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 251/1241 (20.2256%)
___Train Local_ResNet_18, epoch  43, local model 72, internal_epoch   2, Avg loss: 0.0367, Accuracy: 396/1241 (31.9098%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.0130, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   1, Avg loss: 0.0610, Accuracy: 327/715 (45.7343%)
___Train Local_ResNet_18, epoch  43, local model 23, internal_epoch   2, Avg loss: 0.0379, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.8139, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   1, Avg loss: 0.0548, Accuracy: 315/1154 (27.2964%)
___Train Local_ResNet_18, epoch  43, local model 57, internal_epoch   2, Avg loss: 0.0267, Accuracy: 488/1154 (42.2877%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.7695, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   1, Avg loss: 0.0598, Accuracy: 232/1049 (22.1163%)
___Train Local_ResNet_18, epoch  43, local model 51, internal_epoch   2, Avg loss: 0.0295, Accuracy: 526/1049 (50.1430%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.3615, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0684, Accuracy: 201/669 (30.0448%)
___Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0410, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.7996, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 576/2227 (25.8644%)
___Train Local_ResNet_18, epoch  43, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1041/2227 (46.7445%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.3124, Accuracy: 131/10000 (1.3100%)
time spent on training: 248.71006298065186
[foolsgold agg] training data poison_ratio: 0.43947982660886964  data num: [486, 896, 134, 426, 1241, 715, 1154, 1049, 669, 2227]
[foolsgold agg] considering poison per batch poison_fraction: 0.27467489163054354
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3121, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.5531, Accuracy: 0/9950 (0.0000%)
saving model
Done in 639.7670118808746 sec.
Server Epoch:44 choose agents : [20, 45, 15, 72, 6, 60, 59, 46, 31, 84].
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 342/807 (42.3792%)
___Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 415/807 (51.4250%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.5970, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   1, Avg loss: 0.0681, Accuracy: 197/669 (29.4469%)
___Train Local_ResNet_18, epoch  44, local model 45, internal_epoch   2, Avg loss: 0.0393, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.8907, Accuracy: 50/10000 (0.5000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0584, Accuracy: 322/1154 (27.9029%)
___Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0312, Accuracy: 373/1154 (32.3224%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.3135, Accuracy: 52/10000 (0.5200%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   1, Avg loss: 0.0610, Accuracy: 255/1241 (20.5479%)
___Train Local_ResNet_18, epoch  44, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 399/1241 (32.1515%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.5648, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 413/1956 (21.1145%)
___Train Local_ResNet_18, epoch  44, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 654/1956 (33.4356%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.6108, Accuracy: 107/10000 (1.0700%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 566/2227 (25.4154%)
___Train Local_ResNet_18, epoch  44, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1042/2227 (46.7894%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.7162, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   1, Avg loss: 0.0533, Accuracy: 307/1089 (28.1910%)
___Train Local_ResNet_18, epoch  44, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 498/1089 (45.7300%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.0754, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   1, Avg loss: 0.0554, Accuracy: 423/1904 (22.2164%)
___Train Local_ResNet_18, epoch  44, local model 46, internal_epoch   2, Avg loss: 0.0318, Accuracy: 662/1904 (34.7689%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.5687, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0821, Accuracy: 71/460 (15.4348%)
___Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0369, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.7616, Accuracy: 50/10000 (0.5000%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   1, Avg loss: 0.0622, Accuracy: 326/1190 (27.3950%)
___Train Local_ResNet_18, epoch  44, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 450/1190 (37.8151%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.8810, Accuracy: 61/10000 (0.6100%)
time spent on training: 232.6127324104309
[foolsgold agg] training data poison_ratio: 0.521304245097267  data num: [807, 669, 1154, 1241, 1956, 2227, 1089, 1904, 460, 1190]
[foolsgold agg] considering poison per batch poison_fraction: 0.3258151531857919
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3121, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.5519, Accuracy: 0/9950 (0.0000%)
saving model
Done in 627.5940742492676 sec.
Server Epoch:45 choose agents : [33, 77, 72, 6, 23, 47, 93, 87, 53, 86].
poison local model 33 index 12 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   1, Average loss: 0.0653, Accuracy: 179/515 (34.7573%), train_poison_data_count: 323
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   2, Average loss: 0.0446, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   3, Average loss: 0.0392, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   4, Average loss: 0.0362, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   5, Average loss: 0.0331, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   6, Average loss: 0.0307, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   7, Average loss: 0.0290, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   8, Average loss: 0.0292, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch   9, Average loss: 0.0289, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  45, local model 33, internal_epoch  10, Average loss: 0.0285, Accuracy: 323/515 (62.7184%), train_poison_data_count: 323
Global model norm: 112.05388979749877.
Norm before scaling: 112.04605899333319. Distance: 0.5832360362471438
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.7410, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: 0.4446, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 125.4928020221678, distance: 58.32360642489669
Total norm for 2 adversaries is: 125.4928020221678. distance: 58.32360642489669
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   1, Avg loss: 0.0531, Accuracy: 350/1340 (26.1194%)
___Train Local_ResNet_18, epoch  45, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 556/1340 (41.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.6735, Accuracy: 55/10000 (0.5500%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   1, Avg loss: 0.0615, Accuracy: 243/1241 (19.5810%)
___Train Local_ResNet_18, epoch  45, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 409/1241 (32.9573%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.1943, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   1, Avg loss: 0.0550, Accuracy: 388/1956 (19.8364%)
___Train Local_ResNet_18, epoch  45, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 652/1956 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.6053, Accuracy: 132/10000 (1.3200%)
___Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   1, Avg loss: 0.0615, Accuracy: 319/715 (44.6154%)
___Train Local_ResNet_18, epoch  45, local model 23, internal_epoch   2, Avg loss: 0.0375, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.7639, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   1, Avg loss: 0.1221, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  45, local model 47, internal_epoch   2, Avg loss: 0.1097, Accuracy: 15/134 (11.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3102, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   1, Avg loss: 0.0559, Accuracy: 415/1742 (23.8232%)
___Train Local_ResNet_18, epoch  45, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 701/1742 (40.2411%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.7741, Accuracy: 84/10000 (0.8400%)
___Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   1, Avg loss: 0.0577, Accuracy: 304/1131 (26.8789%)
___Train Local_ResNet_18, epoch  45, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 397/1131 (35.1017%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.8999, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   1, Avg loss: 0.0493, Accuracy: 309/813 (38.0074%)
___Train Local_ResNet_18, epoch  45, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 431/813 (53.0135%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 9.2160, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   1, Avg loss: 0.0625, Accuracy: 360/1003 (35.8923%)
___Train Local_ResNet_18, epoch  45, local model 86, internal_epoch   2, Avg loss: 0.0336, Accuracy: 424/1003 (42.2732%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.7527, Accuracy: 50/10000 (0.5000%)
time spent on training: 253.55271363258362
[foolsgold agg] training data poison_ratio: 0.16581680830972614  data num: [515, 1340, 1241, 1956, 715, 134, 1742, 1131, 813, 1003]
[foolsgold agg] considering poison per batch poison_fraction: 0.10363550519357884
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3120, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.5574, Accuracy: 0/9950 (0.0000%)
saving model
Done in 644.1778981685638 sec.
Server Epoch:46 choose agents : [43, 30, 40, 2, 69, 83, 22, 84, 91, 15].
___Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 301/946 (31.8182%)
___Train Local_ResNet_18, epoch  46, local model 43, internal_epoch   2, Avg loss: 0.0356, Accuracy: 376/946 (39.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.0077, Accuracy: 50/10000 (0.5000%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0798, Accuracy: 74/486 (15.2263%)
___Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0395, Accuracy: 213/486 (43.8272%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.8021, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 359/1573 (22.8226%)
___Train Local_ResNet_18, epoch  46, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 550/1573 (34.9650%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.2217, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 229/605 (37.8512%)
___Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.7929, Accuracy: 56/10000 (0.5600%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   1, Avg loss: 0.0564, Accuracy: 286/590 (48.4746%)
___Train Local_ResNet_18, epoch  46, local model 69, internal_epoch   2, Avg loss: 0.0299, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.7456, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 414/1953 (21.1982%)
___Train Local_ResNet_18, epoch  46, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 771/1953 (39.4777%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.6379, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   1, Avg loss: 0.0457, Accuracy: 505/1470 (34.3537%)
___Train Local_ResNet_18, epoch  46, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 842/1470 (57.2789%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.2571, Accuracy: 74/10000 (0.7400%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   1, Avg loss: 0.0622, Accuracy: 326/1190 (27.3950%)
___Train Local_ResNet_18, epoch  46, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 439/1190 (36.8908%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.0446, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   1, Avg loss: 0.0528, Accuracy: 339/1030 (32.9126%)
___Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   2, Avg loss: 0.0255, Accuracy: 643/1030 (62.4272%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.4013, Accuracy: 88/10000 (0.8800%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   1, Avg loss: 0.0568, Accuracy: 327/1154 (28.3362%)
___Train Local_ResNet_18, epoch  46, local model 15, internal_epoch   2, Avg loss: 0.0292, Accuracy: 415/1154 (35.9619%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8930, Accuracy: 52/10000 (0.5200%)
time spent on training: 209.49112582206726
[foolsgold agg] training data poison_ratio: 0.3109939074292989  data num: [946, 486, 1573, 605, 590, 1953, 1470, 1190, 1030, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.1943711921433118
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3119, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.5574, Accuracy: 0/9950 (0.0000%)
saving model
Done in 601.4502053260803 sec.
Server Epoch:47 choose agents : [36, 81, 80, 26, 12, 78, 60, 58, 75, 19].
poison local model 36 index 13 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   1, Average loss: 0.0752, Accuracy: 113/408 (27.6961%), train_poison_data_count: 264
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   2, Average loss: 0.0401, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   3, Average loss: 0.0432, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   4, Average loss: 0.0417, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   5, Average loss: 0.0378, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   6, Average loss: 0.0356, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   7, Average loss: 0.0325, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   8, Average loss: 0.0294, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch   9, Average loss: 0.0279, Accuracy: 265/408 (64.9510%), train_poison_data_count: 264
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  47, local model 36, internal_epoch  10, Average loss: 0.0297, Accuracy: 264/408 (64.7059%), train_poison_data_count: 264
Global model norm: 112.05376778582682.
Norm before scaling: 112.04819868308905. Distance: 0.5487913071850336
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.0023, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: 0.3037, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 124.14915109959472, distance: 54.879132994984985
Total norm for 5 adversaries is: 124.14915109959472. distance: 54.879132994984985
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   1, Avg loss: 0.0681, Accuracy: 236/774 (30.4910%)
___Train Local_ResNet_18, epoch  47, local model 81, internal_epoch   2, Avg loss: 0.0374, Accuracy: 307/774 (39.6641%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.1501, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   1, Avg loss: 0.0700, Accuracy: 146/682 (21.4076%)
___Train Local_ResNet_18, epoch  47, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 247/682 (36.2170%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.4082, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0552, Accuracy: 319/1446 (22.0609%)
___Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 496/1446 (34.3015%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.4816, Accuracy: 52/10000 (0.5200%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 19/338 (5.6213%)
___Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0485, Accuracy: 140/338 (41.4201%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.4504, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   1, Avg loss: 0.0832, Accuracy: 44/416 (10.5769%)
___Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   2, Avg loss: 0.0467, Accuracy: 165/416 (39.6635%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.5596, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 640/2227 (28.7382%)
___Train Local_ResNet_18, epoch  47, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1047/2227 (47.0139%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.3703, Accuracy: 131/10000 (1.3100%)
___Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   1, Avg loss: 0.0578, Accuracy: 350/803 (43.5866%)
___Train Local_ResNet_18, epoch  47, local model 58, internal_epoch   2, Avg loss: 0.0338, Accuracy: 397/803 (49.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.9553, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   1, Avg loss: 0.0652, Accuracy: 250/776 (32.2165%)
___Train Local_ResNet_18, epoch  47, local model 75, internal_epoch   2, Avg loss: 0.0284, Accuracy: 414/776 (53.3505%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.9553, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0472, Accuracy: 410/1036 (39.5753%)
___Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0247, Accuracy: 642/1036 (61.9691%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.1011, Accuracy: 56/10000 (0.5600%)
time spent on training: 274.38329911231995
[foolsgold agg] training data poison_ratio: 0.46743768246126205  data num: [408, 774, 682, 1446, 338, 416, 2227, 803, 776, 1036]
[foolsgold agg] considering poison per batch poison_fraction: 0.2921485515382888
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3119, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.5644, Accuracy: 0/9950 (0.0000%)
saving model
Done in 666.280547618866 sec.
Server Epoch:48 choose agents : [27, 96, 18, 95, 5, 47, 12, 39, 36, 82].
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   1, Avg loss: 0.0537, Accuracy: 416/1587 (26.2130%)
___Train Local_ResNet_18, epoch  48, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 589/1587 (37.1141%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.2414, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 51/311 (16.3987%)
___Train Local_ResNet_18, epoch  48, local model 96, internal_epoch   2, Avg loss: 0.0530, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3477, Accuracy: 50/10000 (0.5000%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   1, Avg loss: 0.0752, Accuracy: 114/530 (21.5094%)
___Train Local_ResNet_18, epoch  48, local model 18, internal_epoch   2, Avg loss: 0.0399, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.9628, Accuracy: 60/10000 (0.6000%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   1, Avg loss: 0.0541, Accuracy: 325/599 (54.2571%)
___Train Local_ResNet_18, epoch  48, local model 95, internal_epoch   2, Avg loss: 0.0287, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.5040, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   1, Avg loss: 0.0509, Accuracy: 382/1628 (23.4644%)
___Train Local_ResNet_18, epoch  48, local model 5, internal_epoch   2, Avg loss: 0.0255, Accuracy: 830/1628 (50.9828%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.0710, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   1, Avg loss: 0.1260, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  48, local model 47, internal_epoch   2, Avg loss: 0.1049, Accuracy: 13/134 (9.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3105, Accuracy: 50/10000 (0.5000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   1, Avg loss: 0.0871, Accuracy: 21/338 (6.2130%)
___Train Local_ResNet_18, epoch  48, local model 12, internal_epoch   2, Avg loss: 0.0471, Accuracy: 134/338 (39.6450%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.4475, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 315/1013 (31.0958%)
___Train Local_ResNet_18, epoch  48, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 496/1013 (48.9635%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.3522, Accuracy: 70/10000 (0.7000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   1, Avg loss: 0.0868, Accuracy: 79/408 (19.3627%)
___Train Local_ResNet_18, epoch  48, local model 36, internal_epoch   2, Avg loss: 0.0544, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.5086, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   1, Avg loss: 0.0760, Accuracy: 76/500 (15.2000%)
___Train Local_ResNet_18, epoch  48, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 175/500 (35.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.6837, Accuracy: 41/10000 (0.4100%)
time spent on training: 189.3524832725525
[foolsgold agg] training data poison_ratio: 0.4970204313280363  data num: [1587, 311, 530, 599, 1628, 134, 338, 1013, 408, 500]
[foolsgold agg] considering poison per batch poison_fraction: 0.3106377695800227
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3118, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.5641, Accuracy: 0/9950 (0.0000%)
saving model
Done in 589.1989786624908 sec.
Server Epoch:49 choose agents : [37, 21, 63, 60, 36, 6, 17, 29, 9, 90].
poison local model 37 index 14 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   1, Average loss: 0.0498, Accuracy: 564/1129 (49.9557%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   2, Average loss: 0.0240, Accuracy: 683/1129 (60.4960%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   3, Average loss: 0.0216, Accuracy: 720/1129 (63.7733%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   4, Average loss: 0.0199, Accuracy: 725/1129 (64.2161%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   5, Average loss: 0.0192, Accuracy: 713/1129 (63.1532%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   6, Average loss: 0.0193, Accuracy: 713/1129 (63.1532%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   7, Average loss: 0.0186, Accuracy: 715/1129 (63.3304%), train_poison_data_count: 720
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   8, Average loss: 0.0187, Accuracy: 720/1129 (63.7733%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch   9, Average loss: 0.0190, Accuracy: 712/1129 (63.0647%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  49, local model 37, internal_epoch  10, Average loss: 0.0189, Accuracy: 712/1129 (63.0647%), train_poison_data_count: 720
Global model norm: 112.05365448915533.
Norm before scaling: 112.03448827258507. Distance: 0.8850714216130816
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.0557, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: 0.4089, Accuracy: 9904/9950 (99.5377%)
Scaling by  100
Scaled Norm after poisoning: 141.0029019537364, distance: 88.50714185960504
Total norm for 4 adversaries is: 141.0029019537364. distance: 88.50714185960504
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 374/1949 (19.1893%)
___Train Local_ResNet_18, epoch  49, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 639/1949 (32.7860%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.0695, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 258/888 (29.0541%)
___Train Local_ResNet_18, epoch  49, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 419/888 (47.1847%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.4538, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 644/2227 (28.9178%)
___Train Local_ResNet_18, epoch  49, local model 60, internal_epoch   2, Avg loss: 0.0278, Accuracy: 1072/2227 (48.1365%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.5494, Accuracy: 129/10000 (1.2900%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   1, Avg loss: 0.0860, Accuracy: 75/408 (18.3824%)
___Train Local_ResNet_18, epoch  49, local model 36, internal_epoch   2, Avg loss: 0.0538, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.4910, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 419/1956 (21.4213%)
___Train Local_ResNet_18, epoch  49, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 632/1956 (32.3108%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.0006, Accuracy: 106/10000 (1.0600%)
___Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   1, Avg loss: 0.0506, Accuracy: 425/1574 (27.0013%)
___Train Local_ResNet_18, epoch  49, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 702/1574 (44.5997%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.4012, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   1, Avg loss: 0.0490, Accuracy: 380/1440 (26.3889%)
___Train Local_ResNet_18, epoch  49, local model 29, internal_epoch   2, Avg loss: 0.0277, Accuracy: 676/1440 (46.9444%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.7354, Accuracy: 60/10000 (0.6000%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   1, Avg loss: 0.0496, Accuracy: 368/1275 (28.8627%)
___Train Local_ResNet_18, epoch  49, local model 9, internal_epoch   2, Avg loss: 0.0198, Accuracy: 692/1275 (54.2745%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.6029, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   1, Avg loss: 0.0569, Accuracy: 319/677 (47.1196%)
___Train Local_ResNet_18, epoch  49, local model 90, internal_epoch   2, Avg loss: 0.0235, Accuracy: 439/677 (64.8449%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.5104, Accuracy: 51/10000 (0.5100%)
time spent on training: 306.9282898902893
[foolsgold agg] training data poison_ratio: 0.3726244176588035  data num: [1129, 1949, 888, 2227, 408, 1956, 1574, 1440, 1275, 677]
[foolsgold agg] considering poison per batch poison_fraction: 0.2328902610367522
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.5620, Accuracy: 0/9950 (0.0000%)
saving model
Done in 720.7887930870056 sec.
Server Epoch:50 choose agents : [74, 58, 95, 2, 46, 62, 37, 81, 28, 99].
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 523/1552 (33.6985%)
___Train Local_ResNet_18, epoch  50, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 742/1552 (47.8093%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 11.2598, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   1, Avg loss: 0.0566, Accuracy: 355/803 (44.2092%)
___Train Local_ResNet_18, epoch  50, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 391/803 (48.6924%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.0455, Accuracy: 47/10000 (0.4700%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   1, Avg loss: 0.0519, Accuracy: 327/599 (54.5910%)
___Train Local_ResNet_18, epoch  50, local model 95, internal_epoch   2, Avg loss: 0.0290, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.6467, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.0629, Accuracy: 223/605 (36.8595%)
___Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0392, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.7928, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0547, Accuracy: 438/1904 (23.0042%)
___Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 700/1904 (36.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.4974, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   1, Avg loss: 0.0689, Accuracy: 143/568 (25.1761%)
___Train Local_ResNet_18, epoch  50, local model 62, internal_epoch   2, Avg loss: 0.0400, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.7530, Accuracy: 52/10000 (0.5200%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   1, Avg loss: 0.0525, Accuracy: 376/1129 (33.3038%)
___Train Local_ResNet_18, epoch  50, local model 37, internal_epoch   2, Avg loss: 0.0243, Accuracy: 740/1129 (65.5447%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.3344, Accuracy: 91/10000 (0.9100%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0671, Accuracy: 246/774 (31.7829%)
___Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0355, Accuracy: 304/774 (39.2765%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.2172, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 387/1581 (24.4782%)
___Train Local_ResNet_18, epoch  50, local model 28, internal_epoch   2, Avg loss: 0.0340, Accuracy: 565/1581 (35.7369%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.6512, Accuracy: 101/10000 (1.0100%)
___Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   1, Avg loss: 0.0663, Accuracy: 185/773 (23.9327%)
___Train Local_ResNet_18, epoch  50, local model 99, internal_epoch   2, Avg loss: 0.0305, Accuracy: 409/773 (52.9107%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.4066, Accuracy: 50/10000 (0.5000%)
time spent on training: 201.92120718955994
[foolsgold agg] training data poison_ratio: 0.3940513219284603  data num: [1552, 803, 599, 605, 1904, 568, 1129, 774, 1581, 773]
[foolsgold agg] considering poison per batch poison_fraction: 0.2462820762052877
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3116, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.5619, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 617.9588344097137 sec.
Server Epoch:51 choose agents : [42, 17, 32, 59, 73, 33, 77, 93, 8, 90].
poison local model 42 index 15 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Average loss: 0.0472, Accuracy: 722/1372 (52.6239%), train_poison_data_count: 868
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Average loss: 0.0243, Accuracy: 837/1372 (61.0058%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   3, Average loss: 0.0231, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   4, Average loss: 0.0225, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   5, Average loss: 0.0224, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   6, Average loss: 0.0222, Accuracy: 867/1372 (63.1924%), train_poison_data_count: 868
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   7, Average loss: 0.0217, Accuracy: 867/1372 (63.1924%), train_poison_data_count: 868
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   8, Average loss: 0.0219, Accuracy: 867/1372 (63.1924%), train_poison_data_count: 868
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch   9, Average loss: 0.0219, Accuracy: 868/1372 (63.2653%), train_poison_data_count: 868
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  51, local model 42, internal_epoch  10, Average loss: 0.0215, Accuracy: 867/1372 (63.1924%), train_poison_data_count: 868
Global model norm: 112.05354990751074.
Norm before scaling: 112.02971581934187. Distance: 0.9418749453741411
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.1895, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: 0.3982, Accuracy: 9941/9950 (99.9095%)
Scaling by  100
Scaled Norm after poisoning: 144.23905260668832, distance: 94.18749481585918
Total norm for 2 adversaries is: 144.23905260668832. distance: 94.18749481585918
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   1, Avg loss: 0.0509, Accuracy: 404/1574 (25.6671%)
___Train Local_ResNet_18, epoch  51, local model 17, internal_epoch   2, Avg loss: 0.0270, Accuracy: 675/1574 (42.8844%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.2360, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 203/735 (27.6190%)
___Train Local_ResNet_18, epoch  51, local model 32, internal_epoch   2, Avg loss: 0.0214, Accuracy: 372/735 (50.6122%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.2575, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   1, Avg loss: 0.0536, Accuracy: 326/1089 (29.9357%)
___Train Local_ResNet_18, epoch  51, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 465/1089 (42.6997%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.2609, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   1, Avg loss: 0.0648, Accuracy: 181/938 (19.2964%)
___Train Local_ResNet_18, epoch  51, local model 73, internal_epoch   2, Avg loss: 0.0338, Accuracy: 292/938 (31.1301%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.2087, Accuracy: 68/10000 (0.6800%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   1, Avg loss: 0.0782, Accuracy: 74/515 (14.3689%)
___Train Local_ResNet_18, epoch  51, local model 33, internal_epoch   2, Avg loss: 0.0526, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.6629, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   1, Avg loss: 0.0537, Accuracy: 324/1340 (24.1791%)
___Train Local_ResNet_18, epoch  51, local model 77, internal_epoch   2, Avg loss: 0.0269, Accuracy: 576/1340 (42.9851%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.7491, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 415/1742 (23.8232%)
___Train Local_ResNet_18, epoch  51, local model 93, internal_epoch   2, Avg loss: 0.0313, Accuracy: 724/1742 (41.5614%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.7841, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   1, Avg loss: 0.0598, Accuracy: 251/1513 (16.5896%)
___Train Local_ResNet_18, epoch  51, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 511/1513 (33.7740%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.4186, Accuracy: 98/10000 (0.9800%)
___Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   1, Avg loss: 0.0582, Accuracy: 314/677 (46.3811%)
___Train Local_ResNet_18, epoch  51, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 454/677 (67.0606%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.9822, Accuracy: 54/10000 (0.5400%)
time spent on training: 274.11672925949097
[foolsgold agg] training data poison_ratio: 0.16415832970856895  data num: [1372, 1574, 735, 1089, 938, 515, 1340, 1742, 1513, 677]
[foolsgold agg] considering poison per batch poison_fraction: 0.10259895606785559
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3115, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.5543, Accuracy: 0/9950 (0.0000%)
saving model
Done in 684.961980342865 sec.
Server Epoch:52 choose agents : [13, 59, 3, 73, 63, 7, 86, 32, 51, 89].
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   1, Avg loss: 0.0579, Accuracy: 313/1645 (19.0274%)
___Train Local_ResNet_18, epoch  52, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 628/1645 (38.1763%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.8702, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 311/1089 (28.5583%)
___Train Local_ResNet_18, epoch  52, local model 59, internal_epoch   2, Avg loss: 0.0285, Accuracy: 465/1089 (42.6997%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.3730, Accuracy: 70/10000 (0.7000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   1, Avg loss: 0.0741, Accuracy: 117/781 (14.9808%)
___Train Local_ResNet_18, epoch  52, local model 3, internal_epoch   2, Avg loss: 0.0350, Accuracy: 238/781 (30.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.7247, Accuracy: 65/10000 (0.6500%)
___Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   1, Avg loss: 0.0649, Accuracy: 172/938 (18.3369%)
___Train Local_ResNet_18, epoch  52, local model 73, internal_epoch   2, Avg loss: 0.0334, Accuracy: 318/938 (33.9019%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.3795, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   1, Avg loss: 0.0536, Accuracy: 267/888 (30.0676%)
___Train Local_ResNet_18, epoch  52, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 451/888 (50.7883%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.7801, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 355/891 (39.8429%)
___Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 423/891 (47.4747%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.2979, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   1, Avg loss: 0.0625, Accuracy: 359/1003 (35.7926%)
___Train Local_ResNet_18, epoch  52, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 385/1003 (38.3848%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.6649, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   1, Avg loss: 0.0603, Accuracy: 208/735 (28.2993%)
___Train Local_ResNet_18, epoch  52, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 337/735 (45.8503%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.0491, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   1, Avg loss: 0.0591, Accuracy: 245/1049 (23.3556%)
___Train Local_ResNet_18, epoch  52, local model 51, internal_epoch   2, Avg loss: 0.0297, Accuracy: 532/1049 (50.7150%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.5212, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   1, Avg loss: 0.0597, Accuracy: 347/896 (38.7277%)
___Train Local_ResNet_18, epoch  52, local model 89, internal_epoch   2, Avg loss: 0.0338, Accuracy: 434/896 (48.4375%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.3015, Accuracy: 50/10000 (0.5000%)
time spent on training: 168.5029480457306
[foolsgold agg] training data poison_ratio: 0.07876954109934443  data num: [1645, 1089, 781, 938, 888, 891, 1003, 735, 1049, 896]
[foolsgold agg] considering poison per batch poison_fraction: 0.04923096318709027
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3115, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.5499, Accuracy: 0/9950 (0.0000%)
saving model
Done in 586.1730859279633 sec.
Server Epoch:53 choose agents : [44, 63, 19, 5, 11, 69, 60, 51, 37, 90].
poison local model 44 index 16 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Average loss: 0.0482, Accuracy: 924/1750 (52.8000%), train_poison_data_count: 1102
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Average loss: 0.0266, Accuracy: 1096/1750 (62.6286%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   3, Average loss: 0.0242, Accuracy: 1102/1750 (62.9714%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   4, Average loss: 0.0237, Accuracy: 1102/1750 (62.9714%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   5, Average loss: 0.0227, Accuracy: 1102/1750 (62.9714%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   6, Average loss: 0.0228, Accuracy: 1102/1750 (62.9714%), train_poison_data_count: 1102
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   7, Average loss: 0.0219, Accuracy: 1106/1750 (63.2000%), train_poison_data_count: 1102
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   8, Average loss: 0.0219, Accuracy: 1104/1750 (63.0857%), train_poison_data_count: 1102
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch   9, Average loss: 0.0214, Accuracy: 1111/1750 (63.4857%), train_poison_data_count: 1102
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  53, local model 44, internal_epoch  10, Average loss: 0.0214, Accuracy: 1109/1750 (63.3714%), train_poison_data_count: 1102
Global model norm: 112.05342789546869.
Norm before scaling: 112.02116412061383. Distance: 1.060052633598226
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3660, Accuracy: 53/10000 (0.5300%)
_Test Local_ResNet_18 poisoned: True, epoch: 53, Avg loss: 0.4448, Accuracy: 9943/9950 (99.9296%)
Scaling by  100
Scaled Norm after poisoning: 151.5181829538125, distance: 106.00527422757087
Total norm for 5 adversaries is: 151.5181829538125. distance: 106.00527422757087
_Test Local_ResNet_18 poisoned: True, epoch: 53, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 262/888 (29.5045%)
___Train Local_ResNet_18, epoch  53, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 422/888 (47.5225%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3202, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   1, Avg loss: 0.0470, Accuracy: 390/1036 (37.6448%)
___Train Local_ResNet_18, epoch  53, local model 19, internal_epoch   2, Avg loss: 0.0260, Accuracy: 606/1036 (58.4942%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.9936, Accuracy: 50/10000 (0.5000%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0511, Accuracy: 374/1628 (22.9730%)
___Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0260, Accuracy: 815/1628 (50.0614%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.2616, Accuracy: 126/10000 (1.2600%)
___Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   1, Avg loss: 0.0535, Accuracy: 351/712 (49.2978%)
___Train Local_ResNet_18, epoch  53, local model 11, internal_epoch   2, Avg loss: 0.0262, Accuracy: 421/712 (59.1292%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.5372, Accuracy: 50/10000 (0.5000%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0552, Accuracy: 287/590 (48.6441%)
___Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0305, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.0797, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 583/2227 (26.1787%)
___Train Local_ResNet_18, epoch  53, local model 60, internal_epoch   2, Avg loss: 0.0276, Accuracy: 1032/2227 (46.3404%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3798, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   1, Avg loss: 0.0599, Accuracy: 233/1049 (22.2116%)
___Train Local_ResNet_18, epoch  53, local model 51, internal_epoch   2, Avg loss: 0.0299, Accuracy: 489/1049 (46.6158%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.5045, Accuracy: 81/10000 (0.8100%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   1, Avg loss: 0.0521, Accuracy: 419/1129 (37.1125%)
___Train Local_ResNet_18, epoch  53, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 744/1129 (65.8990%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.2728, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   1, Avg loss: 0.0572, Accuracy: 313/677 (46.2334%)
___Train Local_ResNet_18, epoch  53, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 446/677 (65.8789%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.0143, Accuracy: 55/10000 (0.5500%)
time spent on training: 315.23729252815247
[foolsgold agg] training data poison_ratio: 0.626732842717782  data num: [1750, 888, 1036, 1628, 712, 590, 2227, 1049, 1129, 677]
[foolsgold agg] considering poison per batch poison_fraction: 0.3917080266986137
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3114, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.5462, Accuracy: 0/9950 (0.0000%)
saving model
Done in 735.4325075149536 sec.
Server Epoch:54 choose agents : [87, 90, 28, 63, 1, 47, 46, 66, 40, 91].
___Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   1, Avg loss: 0.0583, Accuracy: 295/1131 (26.0831%)
___Train Local_ResNet_18, epoch  54, local model 87, internal_epoch   2, Avg loss: 0.0323, Accuracy: 385/1131 (34.0407%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.7766, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   1, Avg loss: 0.0558, Accuracy: 319/677 (47.1196%)
___Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   2, Avg loss: 0.0224, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.4369, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   1, Avg loss: 0.0559, Accuracy: 412/1581 (26.0595%)
___Train Local_ResNet_18, epoch  54, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 573/1581 (36.2429%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.7229, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   1, Avg loss: 0.0538, Accuracy: 264/888 (29.7297%)
___Train Local_ResNet_18, epoch  54, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 402/888 (45.2703%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.6544, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 280/928 (30.1724%)
___Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 561/928 (60.4526%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.4978, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1251, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1059, Accuracy: 11/134 (8.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3094, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   1, Avg loss: 0.0546, Accuracy: 415/1904 (21.7962%)
___Train Local_ResNet_18, epoch  54, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 708/1904 (37.1849%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.6616, Accuracy: 137/10000 (1.3700%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   1, Avg loss: 0.0615, Accuracy: 268/1402 (19.1155%)
___Train Local_ResNet_18, epoch  54, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 409/1402 (29.1726%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.3630, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   1, Avg loss: 0.0539, Accuracy: 363/1573 (23.0769%)
___Train Local_ResNet_18, epoch  54, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 602/1573 (38.2708%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.4054, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   1, Avg loss: 0.0531, Accuracy: 340/1030 (33.0097%)
___Train Local_ResNet_18, epoch  54, local model 91, internal_epoch   2, Avg loss: 0.0249, Accuracy: 635/1030 (61.6505%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.3843, Accuracy: 82/10000 (0.8200%)
time spent on training: 170.67821979522705
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 677, 1581, 888, 928, 134, 1904, 1402, 1573, 1030]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3114, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.5472, Accuracy: 0/9950 (0.0000%)
saving model
Done in 586.640162229538 sec.
Server Epoch:55 choose agents : [48, 41, 73, 59, 13, 26, 32, 57, 99, 55].
poison local model 48 index 17 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   1, Average loss: 0.0606, Accuracy: 250/631 (39.6197%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   2, Average loss: 0.0403, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   3, Average loss: 0.0299, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   4, Average loss: 0.0266, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   5, Average loss: 0.0265, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   6, Average loss: 0.0264, Accuracy: 401/631 (63.5499%), train_poison_data_count: 400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   7, Average loss: 0.0257, Accuracy: 399/631 (63.2330%), train_poison_data_count: 400
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   8, Average loss: 0.0261, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch   9, Average loss: 0.0247, Accuracy: 399/631 (63.2330%), train_poison_data_count: 400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  55, local model 48, internal_epoch  10, Average loss: 0.0247, Accuracy: 400/631 (63.3914%), train_poison_data_count: 400
Global model norm: 112.05331895603315.
Norm before scaling: 112.04452937337012. Distance: 0.6441069622508655
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.0511, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 55, Avg loss: 0.4256, Accuracy: 9941/9950 (99.9095%)
Scaling by  100
Scaled Norm after poisoning: 128.32044544323404, distance: 64.41069247172786
Total norm for 2 adversaries is: 128.32044544323404. distance: 64.41069247172786
_Test Local_ResNet_18 poisoned: True, epoch: 55, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   1, Avg loss: 0.0602, Accuracy: 325/719 (45.2017%)
___Train Local_ResNet_18, epoch  55, local model 41, internal_epoch   2, Avg loss: 0.0310, Accuracy: 448/719 (62.3088%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.3523, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   1, Avg loss: 0.0645, Accuracy: 170/938 (18.1237%)
___Train Local_ResNet_18, epoch  55, local model 73, internal_epoch   2, Avg loss: 0.0331, Accuracy: 344/938 (36.6738%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.1437, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   1, Avg loss: 0.0530, Accuracy: 296/1089 (27.1809%)
___Train Local_ResNet_18, epoch  55, local model 59, internal_epoch   2, Avg loss: 0.0275, Accuracy: 466/1089 (42.7916%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.5341, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 327/1645 (19.8784%)
___Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0326, Accuracy: 617/1645 (37.5076%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.6713, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 352/1446 (24.3430%)
___Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 490/1446 (33.8866%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.0409, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   1, Avg loss: 0.0593, Accuracy: 207/735 (28.1633%)
___Train Local_ResNet_18, epoch  55, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 349/735 (47.4830%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.3228, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   1, Avg loss: 0.0555, Accuracy: 299/1154 (25.9099%)
___Train Local_ResNet_18, epoch  55, local model 57, internal_epoch   2, Avg loss: 0.0255, Accuracy: 484/1154 (41.9411%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.4812, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   1, Avg loss: 0.0694, Accuracy: 172/773 (22.2510%)
___Train Local_ResNet_18, epoch  55, local model 99, internal_epoch   2, Avg loss: 0.0291, Accuracy: 410/773 (53.0401%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.3966, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0561, Accuracy: 253/1071 (23.6228%)
___Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0296, Accuracy: 483/1071 (45.0980%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.9143, Accuracy: 66/10000 (0.6600%)
time spent on training: 256.55934381484985
[foolsgold agg] training data poison_ratio: 0.16684638760905793  data num: [631, 719, 938, 1089, 1645, 1446, 735, 1154, 773, 1071]
[foolsgold agg] considering poison per batch poison_fraction: 0.1042789922556612
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3113, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.5455, Accuracy: 0/9950 (0.0000%)
saving model
Done in 674.9679234027863 sec.
Server Epoch:56 choose agents : [70, 37, 13, 11, 65, 80, 49, 18, 26, 82].
___Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   1, Avg loss: 0.0561, Accuracy: 326/1418 (22.9901%)
___Train Local_ResNet_18, epoch  56, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 647/1418 (45.6276%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.7333, Accuracy: 97/10000 (0.9700%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   1, Avg loss: 0.0514, Accuracy: 388/1129 (34.3667%)
___Train Local_ResNet_18, epoch  56, local model 37, internal_epoch   2, Avg loss: 0.0238, Accuracy: 736/1129 (65.1904%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.8579, Accuracy: 93/10000 (0.9300%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   1, Avg loss: 0.0570, Accuracy: 323/1645 (19.6353%)
___Train Local_ResNet_18, epoch  56, local model 13, internal_epoch   2, Avg loss: 0.0318, Accuracy: 697/1645 (42.3708%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.8039, Accuracy: 130/10000 (1.3000%)
___Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   1, Avg loss: 0.0552, Accuracy: 355/712 (49.8596%)
___Train Local_ResNet_18, epoch  56, local model 11, internal_epoch   2, Avg loss: 0.0264, Accuracy: 393/712 (55.1966%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.5862, Accuracy: 49/10000 (0.4900%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   1, Avg loss: 0.0559, Accuracy: 415/1475 (28.1356%)
___Train Local_ResNet_18, epoch  56, local model 65, internal_epoch   2, Avg loss: 0.0309, Accuracy: 677/1475 (45.8983%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.1072, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   1, Avg loss: 0.0701, Accuracy: 146/682 (21.4076%)
___Train Local_ResNet_18, epoch  56, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 256/682 (37.5367%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.4009, Accuracy: 66/10000 (0.6600%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   1, Avg loss: 0.0797, Accuracy: 32/440 (7.2727%)
___Train Local_ResNet_18, epoch  56, local model 49, internal_epoch   2, Avg loss: 0.0477, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.5028, Accuracy: 50/10000 (0.5000%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   1, Avg loss: 0.0760, Accuracy: 122/530 (23.0189%)
___Train Local_ResNet_18, epoch  56, local model 18, internal_epoch   2, Avg loss: 0.0382, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.1428, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 354/1446 (24.4813%)
___Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 484/1446 (33.4716%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.5124, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   1, Avg loss: 0.0759, Accuracy: 73/500 (14.6000%)
___Train Local_ResNet_18, epoch  56, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.6206, Accuracy: 51/10000 (0.5100%)
time spent on training: 209.4873650074005
[foolsgold agg] training data poison_ratio: 0.3582239150045104  data num: [1418, 1129, 1645, 712, 1475, 682, 440, 530, 1446, 500]
[foolsgold agg] considering poison per batch poison_fraction: 0.223889946877819
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3112, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.5449, Accuracy: 0/9950 (0.0000%)
saving model
Done in 616.9609158039093 sec.
Server Epoch:57 choose agents : [49, 24, 21, 90, 19, 40, 84, 62, 37, 70].
poison local model 49 index 18 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   1, Average loss: 0.0706, Accuracy: 132/440 (30.0000%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   2, Average loss: 0.0403, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   3, Average loss: 0.0430, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   4, Average loss: 0.0394, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   5, Average loss: 0.0359, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   6, Average loss: 0.0327, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   7, Average loss: 0.0304, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   8, Average loss: 0.0284, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch   9, Average loss: 0.0280, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  57, local model 49, internal_epoch  10, Average loss: 0.0278, Accuracy: 280/440 (63.6364%), train_poison_data_count: 280
Global model norm: 112.05321001649172.
Norm before scaling: 112.04770625301751. Distance: 0.532559435979425
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.6504, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 57, Avg loss: 0.4392, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 123.45210752175315, distance: 53.25594386207632
Total norm for 4 adversaries is: 123.45210752175315. distance: 53.25594386207632
_Test Local_ResNet_18 poisoned: True, epoch: 57, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   1, Avg loss: 0.0761, Accuracy: 40/312 (12.8205%)
___Train Local_ResNet_18, epoch  57, local model 24, internal_epoch   2, Avg loss: 0.0400, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3925, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 419/1949 (21.4982%)
___Train Local_ResNet_18, epoch  57, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 620/1949 (31.8112%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.2513, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   1, Avg loss: 0.0563, Accuracy: 323/677 (47.7105%)
___Train Local_ResNet_18, epoch  57, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 434/677 (64.1064%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2781, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   1, Avg loss: 0.0456, Accuracy: 395/1036 (38.1274%)
___Train Local_ResNet_18, epoch  57, local model 19, internal_epoch   2, Avg loss: 0.0240, Accuracy: 666/1036 (64.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.3462, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 396/1573 (25.1748%)
___Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 559/1573 (35.5372%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2161, Accuracy: 62/10000 (0.6200%)
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   1, Avg loss: 0.0616, Accuracy: 323/1190 (27.1429%)
___Train Local_ResNet_18, epoch  57, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 438/1190 (36.8067%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.1973, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   1, Avg loss: 0.0686, Accuracy: 145/568 (25.5282%)
___Train Local_ResNet_18, epoch  57, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.7930, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   1, Avg loss: 0.0521, Accuracy: 384/1129 (34.0124%)
___Train Local_ResNet_18, epoch  57, local model 37, internal_epoch   2, Avg loss: 0.0240, Accuracy: 735/1129 (65.1019%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.1511, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 359/1418 (25.3173%)
___Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 627/1418 (44.2172%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.8325, Accuracy: 85/10000 (0.8500%)
time spent on training: 279.82013988494873
[foolsgold agg] training data poison_ratio: 0.29838709677419356  data num: [440, 312, 1949, 677, 1036, 1573, 1190, 568, 1129, 1418]
[foolsgold agg] considering poison per batch poison_fraction: 0.18649193548387097
[foolsgold agg] wv: [0.9354723 0.9354723 1.        1.        1.        1.        1.
 1.        1.        1.       ]
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3111, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.5511, Accuracy: 0/9950 (0.0000%)
saving model
Done in 688.30592918396 sec.
Server Epoch:58 choose agents : [95, 54, 5, 67, 47, 39, 11, 59, 83, 6].
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   1, Avg loss: 0.0513, Accuracy: 329/599 (54.9249%)
___Train Local_ResNet_18, epoch  58, local model 95, internal_epoch   2, Avg loss: 0.0293, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.6585, Accuracy: 50/10000 (0.5000%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 352/1130 (31.1504%)
___Train Local_ResNet_18, epoch  58, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 479/1130 (42.3894%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.5071, Accuracy: 56/10000 (0.5600%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   1, Avg loss: 0.0503, Accuracy: 417/1628 (25.6143%)
___Train Local_ResNet_18, epoch  58, local model 5, internal_epoch   2, Avg loss: 0.0251, Accuracy: 853/1628 (52.3956%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.1945, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0778, Accuracy: 60/426 (14.0845%)
___Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0416, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.5999, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1234, Accuracy: 1/134 (0.7463%)
___Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1095, Accuracy: 15/134 (11.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3101, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   1, Avg loss: 0.0531, Accuracy: 319/1013 (31.4906%)
___Train Local_ResNet_18, epoch  58, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 505/1013 (49.8519%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.6597, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   1, Avg loss: 0.0540, Accuracy: 359/712 (50.4213%)
___Train Local_ResNet_18, epoch  58, local model 11, internal_epoch   2, Avg loss: 0.0285, Accuracy: 421/712 (59.1292%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.5227, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   1, Avg loss: 0.0528, Accuracy: 323/1089 (29.6602%)
___Train Local_ResNet_18, epoch  58, local model 59, internal_epoch   2, Avg loss: 0.0295, Accuracy: 434/1089 (39.8531%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.7878, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   1, Avg loss: 0.0534, Accuracy: 443/1953 (22.6831%)
___Train Local_ResNet_18, epoch  58, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 771/1953 (39.4777%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.7874, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   1, Avg loss: 0.0547, Accuracy: 399/1956 (20.3988%)
___Train Local_ResNet_18, epoch  58, local model 6, internal_epoch   2, Avg loss: 0.0314, Accuracy: 673/1956 (34.4070%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.4737, Accuracy: 108/10000 (1.0800%)
time spent on training: 207.55301117897034
[foolsgold agg] training data poison_ratio: 0.31550751879699246  data num: [599, 1130, 1628, 426, 134, 1013, 712, 1089, 1953, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.1971921992481203
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3110, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.5512, Accuracy: 0/9950 (0.0000%)
saving model
Done in 628.8273551464081 sec.
Server Epoch:59 choose agents : [54, 47, 10, 12, 0, 49, 14, 52, 51, 46].
poison local model 54 index 19 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   1, Average loss: 0.0500, Accuracy: 573/1130 (50.7080%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   2, Average loss: 0.0254, Accuracy: 655/1130 (57.9646%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   3, Average loss: 0.0220, Accuracy: 720/1130 (63.7168%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   4, Average loss: 0.0215, Accuracy: 720/1130 (63.7168%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   5, Average loss: 0.0205, Accuracy: 719/1130 (63.6283%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   6, Average loss: 0.0212, Accuracy: 720/1130 (63.7168%), train_poison_data_count: 720
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   7, Average loss: 0.0200, Accuracy: 721/1130 (63.8053%), train_poison_data_count: 720
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   8, Average loss: 0.0206, Accuracy: 719/1130 (63.6283%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch   9, Average loss: 0.0202, Accuracy: 718/1130 (63.5398%), train_poison_data_count: 720
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  59, local model 54, internal_epoch  10, Average loss: 0.0202, Accuracy: 723/1130 (63.9823%), train_poison_data_count: 720
Global model norm: 112.05309671925627.
Norm before scaling: 112.03418754865632. Distance: 0.886650150014974
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.0442, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 59, Avg loss: 0.4029, Accuracy: 9943/9950 (99.9296%)
Scaling by  100
Scaled Norm after poisoning: 141.12130475675883, distance: 88.66501212428722
Total norm for 5 adversaries is: 141.12130475675883. distance: 88.66501212428722
_Test Local_ResNet_18 poisoned: True, epoch: 59, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   1, Avg loss: 0.1219, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18, epoch  59, local model 47, internal_epoch   2, Avg loss: 0.1081, Accuracy: 23/134 (17.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 206/861 (23.9257%)
___Train Local_ResNet_18, epoch  59, local model 10, internal_epoch   2, Avg loss: 0.0215, Accuracy: 453/861 (52.6132%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.7879, Accuracy: 52/10000 (0.5200%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 26/338 (7.6923%)
___Train Local_ResNet_18, epoch  59, local model 12, internal_epoch   2, Avg loss: 0.0464, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.4733, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   1, Avg loss: 0.0571, Accuracy: 401/1657 (24.2004%)
___Train Local_ResNet_18, epoch  59, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 504/1657 (30.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.6886, Accuracy: 84/10000 (0.8400%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   1, Avg loss: 0.0797, Accuracy: 28/440 (6.3636%)
___Train Local_ResNet_18, epoch  59, local model 49, internal_epoch   2, Avg loss: 0.0484, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.5249, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   1, Avg loss: 0.0623, Accuracy: 230/1013 (22.7048%)
___Train Local_ResNet_18, epoch  59, local model 14, internal_epoch   2, Avg loss: 0.0358, Accuracy: 312/1013 (30.7996%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.7147, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   1, Avg loss: 0.0567, Accuracy: 286/636 (44.9686%)
___Train Local_ResNet_18, epoch  59, local model 52, internal_epoch   2, Avg loss: 0.0316, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.2987, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   1, Avg loss: 0.0590, Accuracy: 243/1049 (23.1649%)
___Train Local_ResNet_18, epoch  59, local model 51, internal_epoch   2, Avg loss: 0.0293, Accuracy: 532/1049 (50.7150%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.3987, Accuracy: 78/10000 (0.7800%)
___Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   1, Avg loss: 0.0547, Accuracy: 432/1904 (22.6891%)
___Train Local_ResNet_18, epoch  59, local model 46, internal_epoch   2, Avg loss: 0.0315, Accuracy: 699/1904 (36.7122%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.6944, Accuracy: 112/10000 (1.1200%)
time spent on training: 292.6286792755127
[foolsgold agg] training data poison_ratio: 0.48308229644182493  data num: [1130, 134, 861, 338, 1657, 440, 1013, 636, 1049, 1904]
[foolsgold agg] considering poison per batch poison_fraction: 0.3019264352761406
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3109, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.5487, Accuracy: 0/9950 (0.0000%)
saving model
Done in 707.7363109588623 sec.
Server Epoch:60 choose agents : [54, 52, 10, 29, 40, 35, 50, 34, 99, 36].
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0554, Accuracy: 348/1130 (30.7965%)
___Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 449/1130 (39.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.0581, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 286/636 (44.9686%)
___Train Local_ResNet_18, epoch  60, local model 52, internal_epoch   2, Avg loss: 0.0310, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.5712, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   1, Avg loss: 0.0574, Accuracy: 205/861 (23.8095%)
___Train Local_ResNet_18, epoch  60, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 440/861 (51.1034%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.1628, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   1, Avg loss: 0.0504, Accuracy: 412/1440 (28.6111%)
___Train Local_ResNet_18, epoch  60, local model 29, internal_epoch   2, Avg loss: 0.0272, Accuracy: 664/1440 (46.1111%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.7730, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   1, Avg loss: 0.0540, Accuracy: 392/1573 (24.9205%)
___Train Local_ResNet_18, epoch  60, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 574/1573 (36.4908%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.6805, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   1, Avg loss: 0.0845, Accuracy: 45/271 (16.6052%)
___Train Local_ResNet_18, epoch  60, local model 35, internal_epoch   2, Avg loss: 0.0535, Accuracy: 103/271 (38.0074%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3726, Accuracy: 39/10000 (0.3900%)
___Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   1, Avg loss: 0.0625, Accuracy: 167/809 (20.6428%)
___Train Local_ResNet_18, epoch  60, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 365/809 (45.1174%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.5095, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   1, Avg loss: 0.0580, Accuracy: 409/1427 (28.6615%)
___Train Local_ResNet_18, epoch  60, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 582/1427 (40.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.9194, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   1, Avg loss: 0.0674, Accuracy: 195/773 (25.2264%)
___Train Local_ResNet_18, epoch  60, local model 99, internal_epoch   2, Avg loss: 0.0299, Accuracy: 416/773 (53.8163%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.1431, Accuracy: 57/10000 (0.5700%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   1, Avg loss: 0.0868, Accuracy: 81/408 (19.8529%)
___Train Local_ResNet_18, epoch  60, local model 36, internal_epoch   2, Avg loss: 0.0535, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.5008, Accuracy: 50/10000 (0.5000%)
time spent on training: 194.352947473526
[foolsgold agg] training data poison_ratio: 0.2571826758147513  data num: [1130, 636, 861, 1440, 1573, 271, 809, 1427, 773, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.16073917238421956
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3109, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.5491, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 610.1307699680328 sec.
Server Epoch:61 choose agents : [55, 8, 59, 31, 34, 81, 12, 79, 36, 85].
poison local model 55 index 20 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Average loss: 0.0521, Accuracy: 536/1071 (50.0467%), train_poison_data_count: 680
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Average loss: 0.0259, Accuracy: 618/1071 (57.7031%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   3, Average loss: 0.0219, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   4, Average loss: 0.0212, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   5, Average loss: 0.0204, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   6, Average loss: 0.0202, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 680
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   7, Average loss: 0.0204, Accuracy: 680/1071 (63.4921%), train_poison_data_count: 680
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   8, Average loss: 0.0196, Accuracy: 681/1071 (63.5854%), train_poison_data_count: 680
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch   9, Average loss: 0.0195, Accuracy: 679/1071 (63.3987%), train_poison_data_count: 680
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  61, local model 55, internal_epoch  10, Average loss: 0.0199, Accuracy: 681/1071 (63.5854%), train_poison_data_count: 680
Global model norm: 112.05299649468327.
Norm before scaling: 112.0356214279637. Distance: 0.8971568392487544
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1075, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 61, Avg loss: 0.4190, Accuracy: 9940/9950 (99.8995%)
Scaling by  100
Scaled Norm after poisoning: 141.89846997501417, distance: 89.7156831807781
Total norm for 5 adversaries is: 141.89846997501417. distance: 89.7156831807781
_Test Local_ResNet_18 poisoned: True, epoch: 61, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   1, Avg loss: 0.0596, Accuracy: 251/1513 (16.5896%)
___Train Local_ResNet_18, epoch  61, local model 8, internal_epoch   2, Avg loss: 0.0369, Accuracy: 466/1513 (30.7997%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.2950, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 309/1089 (28.3747%)
___Train Local_ResNet_18, epoch  61, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 448/1089 (41.1387%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.5845, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   1, Avg loss: 0.0812, Accuracy: 66/460 (14.3478%)
___Train Local_ResNet_18, epoch  61, local model 31, internal_epoch   2, Avg loss: 0.0364, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.7695, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   1, Avg loss: 0.0585, Accuracy: 388/1427 (27.1899%)
___Train Local_ResNet_18, epoch  61, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 619/1427 (43.3777%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.8095, Accuracy: 56/10000 (0.5600%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   1, Avg loss: 0.0683, Accuracy: 241/774 (31.1370%)
___Train Local_ResNet_18, epoch  61, local model 81, internal_epoch   2, Avg loss: 0.0351, Accuracy: 306/774 (39.5349%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.3410, Accuracy: 62/10000 (0.6200%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0866, Accuracy: 27/338 (7.9882%)
___Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0478, Accuracy: 137/338 (40.5325%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.4558, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   1, Avg loss: 0.1020, Accuracy: 11/197 (5.5838%)
___Train Local_ResNet_18, epoch  61, local model 79, internal_epoch   2, Avg loss: 0.0871, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3218, Accuracy: 50/10000 (0.5000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   1, Avg loss: 0.0858, Accuracy: 84/408 (20.5882%)
___Train Local_ResNet_18, epoch  61, local model 36, internal_epoch   2, Avg loss: 0.0538, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.4905, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 438/1988 (22.0322%)
___Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   2, Avg loss: 0.0350, Accuracy: 637/1988 (32.0423%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.6778, Accuracy: 86/10000 (0.8600%)
time spent on training: 294.49056100845337
[foolsgold agg] training data poison_ratio: 0.494225580140313  data num: [1071, 1513, 1089, 460, 1427, 774, 338, 197, 408, 1988]
[foolsgold agg] considering poison per batch poison_fraction: 0.3088909875876956
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3108, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.5477, Accuracy: 0/9950 (0.0000%)
saving model
Done in 713.8760166168213 sec.
Server Epoch:62 choose agents : [76, 81, 79, 10, 63, 90, 19, 80, 0, 17].
___Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   1, Avg loss: 0.0849, Accuracy: 49/466 (10.5150%)
___Train Local_ResNet_18, epoch  62, local model 76, internal_epoch   2, Avg loss: 0.0464, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.6698, Accuracy: 50/10000 (0.5000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   1, Avg loss: 0.0644, Accuracy: 241/774 (31.1370%)
___Train Local_ResNet_18, epoch  62, local model 81, internal_epoch   2, Avg loss: 0.0365, Accuracy: 286/774 (36.9509%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.4039, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   1, Avg loss: 0.1054, Accuracy: 15/197 (7.6142%)
___Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   2, Avg loss: 0.0822, Accuracy: 57/197 (28.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3191, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   1, Avg loss: 0.0569, Accuracy: 200/861 (23.2288%)
___Train Local_ResNet_18, epoch  62, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 475/861 (55.1684%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.7954, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 263/888 (29.6171%)
___Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 401/888 (45.1577%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.2094, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   1, Avg loss: 0.0556, Accuracy: 326/677 (48.1536%)
___Train Local_ResNet_18, epoch  62, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 458/677 (67.6514%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.3763, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   1, Avg loss: 0.0472, Accuracy: 415/1036 (40.0579%)
___Train Local_ResNet_18, epoch  62, local model 19, internal_epoch   2, Avg loss: 0.0252, Accuracy: 692/1036 (66.7954%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.9921, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   1, Avg loss: 0.0692, Accuracy: 153/682 (22.4340%)
___Train Local_ResNet_18, epoch  62, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 259/682 (37.9765%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.4127, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   1, Avg loss: 0.0576, Accuracy: 365/1657 (22.0278%)
___Train Local_ResNet_18, epoch  62, local model 0, internal_epoch   2, Avg loss: 0.0342, Accuracy: 524/1657 (31.6234%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.4970, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   1, Avg loss: 0.0510, Accuracy: 404/1574 (25.6671%)
___Train Local_ResNet_18, epoch  62, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 691/1574 (43.9009%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.0430, Accuracy: 75/10000 (0.7500%)
time spent on training: 192.56856393814087
[foolsgold agg] training data poison_ratio: 0.37358147980027234  data num: [466, 774, 197, 861, 888, 677, 1036, 682, 1657, 1574]
[foolsgold agg] considering poison per batch poison_fraction: 0.23348842487517021
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3107, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.5476, Accuracy: 0/9950 (0.0000%)
saving model
Done in 602.0091314315796 sec.
Server Epoch:63 choose agents : [60, 37, 76, 38, 57, 8, 82, 79, 19, 99].
poison local model 60 index 21 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   1, Average loss: 0.0417, Accuracy: 1257/2227 (56.4436%), train_poison_data_count: 1400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   2, Average loss: 0.0226, Accuracy: 1427/2227 (64.0772%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   3, Average loss: 0.0206, Accuracy: 1428/2227 (64.1221%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   4, Average loss: 0.0209, Accuracy: 1427/2227 (64.0772%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   5, Average loss: 0.0203, Accuracy: 1434/2227 (64.3916%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   6, Average loss: 0.0201, Accuracy: 1424/2227 (63.9425%), train_poison_data_count: 1400
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   7, Average loss: 0.0197, Accuracy: 1430/2227 (64.2119%), train_poison_data_count: 1400
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   8, Average loss: 0.0193, Accuracy: 1429/2227 (64.1670%), train_poison_data_count: 1400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch   9, Average loss: 0.0196, Accuracy: 1429/2227 (64.1670%), train_poison_data_count: 1400
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  63, local model 60, internal_epoch  10, Average loss: 0.0197, Accuracy: 1425/2227 (63.9874%), train_poison_data_count: 1400
Global model norm: 112.05288319723192.
Norm before scaling: 112.01216713347483. Distance: 1.1666609162234323
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.3376, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 63, Avg loss: 0.3588, Accuracy: 9933/9950 (99.8291%)
Scaling by  100
Scaled Norm after poisoning: 158.48893395912535, distance: 116.66609839891365
Total norm for 2 adversaries is: 158.48893395912535. distance: 116.66609839891365
_Test Local_ResNet_18 poisoned: True, epoch: 63, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   1, Avg loss: 0.0527, Accuracy: 420/1129 (37.2011%)
___Train Local_ResNet_18, epoch  63, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 735/1129 (65.1019%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.6202, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   1, Avg loss: 0.0848, Accuracy: 51/466 (10.9442%)
___Train Local_ResNet_18, epoch  63, local model 76, internal_epoch   2, Avg loss: 0.0481, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.7132, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0608, Accuracy: 263/1131 (23.2538%)
___Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0299, Accuracy: 494/1131 (43.6782%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.4249, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   1, Avg loss: 0.0541, Accuracy: 314/1154 (27.2097%)
___Train Local_ResNet_18, epoch  63, local model 57, internal_epoch   2, Avg loss: 0.0247, Accuracy: 548/1154 (47.4870%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.3708, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 254/1513 (16.7878%)
___Train Local_ResNet_18, epoch  63, local model 8, internal_epoch   2, Avg loss: 0.0358, Accuracy: 515/1513 (34.0383%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.6899, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   1, Avg loss: 0.0756, Accuracy: 76/500 (15.2000%)
___Train Local_ResNet_18, epoch  63, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.6823, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   1, Avg loss: 0.1007, Accuracy: 19/197 (9.6447%)
___Train Local_ResNet_18, epoch  63, local model 79, internal_epoch   2, Avg loss: 0.0881, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3212, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   1, Avg loss: 0.0461, Accuracy: 416/1036 (40.1544%)
___Train Local_ResNet_18, epoch  63, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 679/1036 (65.5405%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.1922, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   1, Avg loss: 0.0643, Accuracy: 186/773 (24.0621%)
___Train Local_ResNet_18, epoch  63, local model 99, internal_epoch   2, Avg loss: 0.0338, Accuracy: 397/773 (51.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.4133, Accuracy: 50/10000 (0.5000%)
time spent on training: 283.0727310180664
[foolsgold agg] training data poison_ratio: 0.3314240568832708  data num: [2227, 1129, 466, 1131, 1154, 1513, 500, 197, 1036, 773]
[foolsgold agg] considering poison per batch poison_fraction: 0.20714003555204424
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3107, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.5442, Accuracy: 0/9950 (0.0000%)
saving model
Done in 709.3430271148682 sec.
Server Epoch:64 choose agents : [36, 20, 35, 30, 6, 45, 65, 50, 99, 89].
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   1, Avg loss: 0.0858, Accuracy: 81/408 (19.8529%)
___Train Local_ResNet_18, epoch  64, local model 36, internal_epoch   2, Avg loss: 0.0530, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.5089, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   1, Avg loss: 0.0579, Accuracy: 341/807 (42.2553%)
___Train Local_ResNet_18, epoch  64, local model 20, internal_epoch   2, Avg loss: 0.0315, Accuracy: 414/807 (51.3011%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.8412, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.0846, Accuracy: 45/271 (16.6052%)
___Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0554, Accuracy: 106/271 (39.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3714, Accuracy: 52/10000 (0.5200%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.0790, Accuracy: 76/486 (15.6379%)
___Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0416, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.9138, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   1, Avg loss: 0.0544, Accuracy: 399/1956 (20.3988%)
___Train Local_ResNet_18, epoch  64, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 665/1956 (33.9980%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.1947, Accuracy: 112/10000 (1.1200%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.0669, Accuracy: 200/669 (29.8954%)
___Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0416, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8022, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 393/1475 (26.6441%)
___Train Local_ResNet_18, epoch  64, local model 65, internal_epoch   2, Avg loss: 0.0308, Accuracy: 701/1475 (47.5254%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.7984, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   1, Avg loss: 0.0628, Accuracy: 149/809 (18.4178%)
___Train Local_ResNet_18, epoch  64, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 362/809 (44.7466%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.1853, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   1, Avg loss: 0.0656, Accuracy: 192/773 (24.8383%)
___Train Local_ResNet_18, epoch  64, local model 99, internal_epoch   2, Avg loss: 0.0317, Accuracy: 400/773 (51.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.0351, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 337/896 (37.6116%)
___Train Local_ResNet_18, epoch  64, local model 89, internal_epoch   2, Avg loss: 0.0328, Accuracy: 444/896 (49.5536%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.2300, Accuracy: 50/10000 (0.5000%)
time spent on training: 203.81631994247437
[foolsgold agg] training data poison_ratio: 0.37146198830409355  data num: [408, 807, 271, 486, 1956, 669, 1475, 809, 773, 896]
[foolsgold agg] considering poison per batch poison_fraction: 0.23216374269005846
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3106, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.5436, Accuracy: 0/9950 (0.0000%)
saving model
Done in 627.6893095970154 sec.
Server Epoch:65 choose agents : [61, 28, 93, 57, 72, 82, 55, 87, 88, 96].
poison local model 61 index 22 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   1, Average loss: 0.1258, Accuracy: 0/85 (0.0000%), train_poison_data_count: 61
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   2, Average loss: 0.1057, Accuracy: 16/85 (18.8235%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   3, Average loss: 0.0794, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   4, Average loss: 0.0741, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   5, Average loss: 0.0684, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   6, Average loss: 0.0629, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   7, Average loss: 0.0565, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   8, Average loss: 0.0515, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch   9, Average loss: 0.0480, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  65, local model 61, internal_epoch  10, Average loss: 0.0467, Accuracy: 61/85 (71.7647%), train_poison_data_count: 61
Global model norm: 112.0527611844639.
Norm before scaling: 112.05216854912938. Distance: 0.2535565829584516
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.4029, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 65, Avg loss: 2.6342, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 114.7991027158967, distance: 25.355658615546254
Total norm for 3 adversaries is: 114.7991027158967. distance: 25.355658615546254
_Test Local_ResNet_18 poisoned: True, epoch: 65, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0564, Accuracy: 387/1581 (24.4782%)
___Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0338, Accuracy: 604/1581 (38.2037%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.9354, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   1, Avg loss: 0.0551, Accuracy: 424/1742 (24.3398%)
___Train Local_ResNet_18, epoch  65, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 715/1742 (41.0448%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.8622, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0545, Accuracy: 297/1154 (25.7366%)
___Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0279, Accuracy: 427/1154 (37.0017%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.7385, Accuracy: 81/10000 (0.8100%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   1, Avg loss: 0.0610, Accuracy: 272/1241 (21.9178%)
___Train Local_ResNet_18, epoch  65, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 428/1241 (34.4883%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.2265, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0760, Accuracy: 77/500 (15.4000%)
___Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.6712, Accuracy: 55/10000 (0.5500%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 255/1071 (23.8095%)
___Train Local_ResNet_18, epoch  65, local model 55, internal_epoch   2, Avg loss: 0.0287, Accuracy: 528/1071 (49.2997%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.8791, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   1, Avg loss: 0.0587, Accuracy: 290/1131 (25.6410%)
___Train Local_ResNet_18, epoch  65, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 400/1131 (35.3669%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.5926, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   1, Avg loss: 0.0735, Accuracy: 147/603 (24.3781%)
___Train Local_ResNet_18, epoch  65, local model 88, internal_epoch   2, Avg loss: 0.0454, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.8554, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   1, Avg loss: 0.0788, Accuracy: 51/311 (16.3987%)
___Train Local_ResNet_18, epoch  65, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3480, Accuracy: 50/10000 (0.5000%)
time spent on training: 267.34670066833496
[foolsgold agg] training data poison_ratio: 0.254485614184096  data num: [85, 1581, 1742, 1154, 1241, 500, 1071, 1131, 603, 311]
[foolsgold agg] considering poison per batch poison_fraction: 0.15905350886505998
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3106, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.5304, Accuracy: 0/9950 (0.0000%)
saving model
Done in 688.1221969127655 sec.
Server Epoch:66 choose agents : [15, 18, 21, 86, 93, 71, 34, 3, 52, 47].
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   1, Avg loss: 0.0569, Accuracy: 329/1154 (28.5095%)
___Train Local_ResNet_18, epoch  66, local model 15, internal_epoch   2, Avg loss: 0.0282, Accuracy: 479/1154 (41.5078%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.0793, Accuracy: 51/10000 (0.5100%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0746, Accuracy: 122/530 (23.0189%)
___Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0372, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.1808, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   1, Avg loss: 0.0538, Accuracy: 381/1949 (19.5485%)
___Train Local_ResNet_18, epoch  66, local model 21, internal_epoch   2, Avg loss: 0.0326, Accuracy: 649/1949 (33.2991%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1898, Accuracy: 87/10000 (0.8700%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0627, Accuracy: 359/1003 (35.7926%)
___Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 368/1003 (36.6899%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.5956, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   1, Avg loss: 0.0543, Accuracy: 427/1742 (24.5121%)
___Train Local_ResNet_18, epoch  66, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 708/1742 (40.6429%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.9164, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0641, Accuracy: 159/818 (19.4377%)
___Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 357/818 (43.6430%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.1874, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   1, Avg loss: 0.0567, Accuracy: 400/1427 (28.0308%)
___Train Local_ResNet_18, epoch  66, local model 34, internal_epoch   2, Avg loss: 0.0327, Accuracy: 615/1427 (43.0974%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.8228, Accuracy: 51/10000 (0.5100%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   1, Avg loss: 0.0725, Accuracy: 108/781 (13.8284%)
___Train Local_ResNet_18, epoch  66, local model 3, internal_epoch   2, Avg loss: 0.0363, Accuracy: 223/781 (28.5531%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.8077, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   1, Avg loss: 0.0559, Accuracy: 293/636 (46.0692%)
___Train Local_ResNet_18, epoch  66, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.3774, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   1, Avg loss: 0.1198, Accuracy: 2/134 (1.4925%)
___Train Local_ResNet_18, epoch  66, local model 47, internal_epoch   2, Avg loss: 0.1070, Accuracy: 20/134 (14.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3097, Accuracy: 50/10000 (0.5000%)
time spent on training: 211.11963510513306
[foolsgold agg] training data poison_ratio: 0.24228425398073522  data num: [1154, 530, 1949, 1003, 1742, 818, 1427, 781, 636, 134]
[foolsgold agg] considering poison per batch poison_fraction: 0.15142765873795952
[foolsgold agg] wv: [1. 1. 0. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3105, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.5305, Accuracy: 0/9950 (0.0000%)
saving model
Done in 629.969429731369 sec.
Server Epoch:67 choose agents : [65, 12, 41, 56, 19, 23, 37, 45, 96, 9].
poison local model 65 index 23 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   1, Average loss: 0.0475, Accuracy: 806/1475 (54.6441%), train_poison_data_count: 923
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   2, Average loss: 0.0249, Accuracy: 897/1475 (60.8136%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   3, Average loss: 0.0211, Accuracy: 944/1475 (64.0000%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   4, Average loss: 0.0217, Accuracy: 938/1475 (63.5932%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   5, Average loss: 0.0212, Accuracy: 941/1475 (63.7966%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   6, Average loss: 0.0209, Accuracy: 947/1475 (64.2034%), train_poison_data_count: 923
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   7, Average loss: 0.0210, Accuracy: 935/1475 (63.3898%), train_poison_data_count: 923
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   8, Average loss: 0.0205, Accuracy: 946/1475 (64.1356%), train_poison_data_count: 923
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch   9, Average loss: 0.0202, Accuracy: 947/1475 (64.2034%), train_poison_data_count: 923
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  67, local model 65, internal_epoch  10, Average loss: 0.0206, Accuracy: 941/1475 (63.7966%), train_poison_data_count: 923
Global model norm: 112.05265224438018.
Norm before scaling: 112.02564490859895. Distance: 0.9755852043446945
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.8379, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 67, Avg loss: 0.4111, Accuracy: 9948/9950 (99.9799%)
Scaling by  100
Scaled Norm after poisoning: 146.19450736732554, distance: 97.55852109919718
Total norm for 4 adversaries is: 146.19450736732554. distance: 97.55852109919718
_Test Local_ResNet_18 poisoned: True, epoch: 67, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 27/338 (7.9882%)
___Train Local_ResNet_18, epoch  67, local model 12, internal_epoch   2, Avg loss: 0.0469, Accuracy: 135/338 (39.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.4457, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   1, Avg loss: 0.0581, Accuracy: 337/719 (46.8707%)
___Train Local_ResNet_18, epoch  67, local model 41, internal_epoch   2, Avg loss: 0.0331, Accuracy: 464/719 (64.5341%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.5326, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0670, Accuracy: 72/186 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3109, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   1, Avg loss: 0.0473, Accuracy: 413/1036 (39.8649%)
___Train Local_ResNet_18, epoch  67, local model 19, internal_epoch   2, Avg loss: 0.0244, Accuracy: 672/1036 (64.8649%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.1158, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   1, Avg loss: 0.0618, Accuracy: 318/715 (44.4755%)
___Train Local_ResNet_18, epoch  67, local model 23, internal_epoch   2, Avg loss: 0.0384, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.8375, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   1, Avg loss: 0.0515, Accuracy: 406/1129 (35.9610%)
___Train Local_ResNet_18, epoch  67, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 733/1129 (64.9247%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.4048, Accuracy: 108/10000 (1.0800%)
___Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   1, Avg loss: 0.0676, Accuracy: 198/669 (29.5964%)
___Train Local_ResNet_18, epoch  67, local model 45, internal_epoch   2, Avg loss: 0.0402, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.8035, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 49/311 (15.7556%)
___Train Local_ResNet_18, epoch  67, local model 96, internal_epoch   2, Avg loss: 0.0538, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3465, Accuracy: 50/10000 (0.5000%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   1, Avg loss: 0.0494, Accuracy: 357/1275 (28.0000%)
___Train Local_ResNet_18, epoch  67, local model 9, internal_epoch   2, Avg loss: 0.0191, Accuracy: 730/1275 (57.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.4510, Accuracy: 104/10000 (1.0400%)
time spent on training: 276.52634739875793
[foolsgold agg] training data poison_ratio: 0.5369922322679231  data num: [1475, 338, 719, 186, 1036, 715, 1129, 669, 311, 1275]
[foolsgold agg] considering poison per batch poison_fraction: 0.335620145167452
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3104, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.5270, Accuracy: 0/9950 (0.0000%)
saving model
Done in 690.4851081371307 sec.
Server Epoch:68 choose agents : [30, 17, 54, 91, 69, 28, 65, 60, 9, 11].
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   1, Avg loss: 0.0785, Accuracy: 78/486 (16.0494%)
___Train Local_ResNet_18, epoch  68, local model 30, internal_epoch   2, Avg loss: 0.0406, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.8219, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0506, Accuracy: 428/1574 (27.1919%)
___Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0272, Accuracy: 695/1574 (44.1550%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.9554, Accuracy: 95/10000 (0.9500%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 343/1130 (30.3540%)
___Train Local_ResNet_18, epoch  68, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 492/1130 (43.5398%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6900, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   1, Avg loss: 0.0521, Accuracy: 347/1030 (33.6893%)
___Train Local_ResNet_18, epoch  68, local model 91, internal_epoch   2, Avg loss: 0.0296, Accuracy: 565/1030 (54.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.8891, Accuracy: 71/10000 (0.7100%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   1, Avg loss: 0.0566, Accuracy: 287/590 (48.6441%)
___Train Local_ResNet_18, epoch  68, local model 69, internal_epoch   2, Avg loss: 0.0289, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.6163, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   1, Avg loss: 0.0556, Accuracy: 414/1581 (26.1860%)
___Train Local_ResNet_18, epoch  68, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 588/1581 (37.1917%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6413, Accuracy: 94/10000 (0.9400%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   1, Avg loss: 0.0553, Accuracy: 428/1475 (29.0169%)
___Train Local_ResNet_18, epoch  68, local model 65, internal_epoch   2, Avg loss: 0.0304, Accuracy: 696/1475 (47.1864%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.0367, Accuracy: 95/10000 (0.9500%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 599/2227 (26.8972%)
___Train Local_ResNet_18, epoch  68, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1013/2227 (45.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.4696, Accuracy: 128/10000 (1.2800%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0490, Accuracy: 373/1275 (29.2549%)
___Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0190, Accuracy: 757/1275 (59.3725%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.5629, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   1, Avg loss: 0.0534, Accuracy: 356/712 (50.0000%)
___Train Local_ResNet_18, epoch  68, local model 11, internal_epoch   2, Avg loss: 0.0263, Accuracy: 437/712 (61.3764%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.8110, Accuracy: 50/10000 (0.5000%)
time spent on training: 266.37392115592957
[foolsgold agg] training data poison_ratio: 0.5946192052980133  data num: [486, 1574, 1130, 1030, 590, 1581, 1475, 2227, 1275, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.37163700331125826
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3103, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.5245, Accuracy: 0/9950 (0.0000%)
saving model
Done in 686.1854636669159 sec.
Server Epoch:69 choose agents : [69, 3, 66, 36, 78, 83, 8, 10, 93, 58].
poison local model 69 index 24 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Average loss: 0.0583, Accuracy: 235/590 (39.8305%), train_poison_data_count: 374
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Average loss: 0.0267, Accuracy: 361/590 (61.1864%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   3, Average loss: 0.0258, Accuracy: 259/590 (43.8983%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   4, Average loss: 0.0200, Accuracy: 362/590 (61.3559%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   5, Average loss: 0.0227, Accuracy: 374/590 (63.3898%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   6, Average loss: 0.0216, Accuracy: 373/590 (63.2203%), train_poison_data_count: 374
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   7, Average loss: 0.0212, Accuracy: 372/590 (63.0508%), train_poison_data_count: 374
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   8, Average loss: 0.0196, Accuracy: 381/590 (64.5763%), train_poison_data_count: 374
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch   9, Average loss: 0.0206, Accuracy: 373/590 (63.2203%), train_poison_data_count: 374
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  69, local model 69, internal_epoch  10, Average loss: 0.0199, Accuracy: 369/590 (62.5424%), train_poison_data_count: 374
Global model norm: 112.05255201940963.
Norm before scaling: 112.04487364863017. Distance: 0.7813707639817086
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.5369, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 69, Avg loss: 0.3370, Accuracy: 9892/9950 (99.4171%)
Scaling by  100
Scaled Norm after poisoning: 135.74999280616925, distance: 78.13707094247103
Total norm for 5 adversaries is: 135.74999280616925. distance: 78.13707094247103
_Test Local_ResNet_18 poisoned: True, epoch: 69, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   1, Avg loss: 0.0729, Accuracy: 120/781 (15.3649%)
___Train Local_ResNet_18, epoch  69, local model 3, internal_epoch   2, Avg loss: 0.0349, Accuracy: 252/781 (32.2663%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.6765, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 255/1402 (18.1883%)
___Train Local_ResNet_18, epoch  69, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 372/1402 (26.5335%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.1170, Accuracy: 72/10000 (0.7200%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   1, Avg loss: 0.0855, Accuracy: 82/408 (20.0980%)
___Train Local_ResNet_18, epoch  69, local model 36, internal_epoch   2, Avg loss: 0.0526, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.5090, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   1, Avg loss: 0.0831, Accuracy: 48/416 (11.5385%)
___Train Local_ResNet_18, epoch  69, local model 78, internal_epoch   2, Avg loss: 0.0460, Accuracy: 181/416 (43.5096%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.5765, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 438/1953 (22.4270%)
___Train Local_ResNet_18, epoch  69, local model 83, internal_epoch   2, Avg loss: 0.0333, Accuracy: 799/1953 (40.9114%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8382, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   1, Avg loss: 0.0600, Accuracy: 241/1513 (15.9286%)
___Train Local_ResNet_18, epoch  69, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 498/1513 (32.9147%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.3522, Accuracy: 104/10000 (1.0400%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   1, Avg loss: 0.0570, Accuracy: 216/861 (25.0871%)
___Train Local_ResNet_18, epoch  69, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 448/861 (52.0325%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8727, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   1, Avg loss: 0.0549, Accuracy: 453/1742 (26.0046%)
___Train Local_ResNet_18, epoch  69, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 705/1742 (40.4707%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.0029, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   1, Avg loss: 0.0584, Accuracy: 345/803 (42.9639%)
___Train Local_ResNet_18, epoch  69, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 368/803 (45.8281%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.9572, Accuracy: 49/10000 (0.4900%)
time spent on training: 313.8721196651459
[foolsgold agg] training data poison_ratio: 0.29190944693858056  data num: [590, 781, 1402, 408, 416, 1953, 1513, 861, 1742, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.18244340433661285
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3102, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.5211, Accuracy: 0/9950 (0.0000%)
saving model
Done in 727.5226655006409 sec.
Server Epoch:70 choose agents : [22, 18, 31, 35, 88, 66, 36, 14, 27, 48].
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 535/1470 (36.3946%)
___Train Local_ResNet_18, epoch  70, local model 22, internal_epoch   2, Avg loss: 0.0235, Accuracy: 881/1470 (59.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.2316, Accuracy: 87/10000 (0.8700%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   1, Avg loss: 0.0755, Accuracy: 127/530 (23.9623%)
___Train Local_ResNet_18, epoch  70, local model 18, internal_epoch   2, Avg loss: 0.0370, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.1533, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   1, Avg loss: 0.0820, Accuracy: 62/460 (13.4783%)
___Train Local_ResNet_18, epoch  70, local model 31, internal_epoch   2, Avg loss: 0.0360, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.7572, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   1, Avg loss: 0.0852, Accuracy: 49/271 (18.0812%)
___Train Local_ResNet_18, epoch  70, local model 35, internal_epoch   2, Avg loss: 0.0560, Accuracy: 102/271 (37.6384%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3686, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   1, Avg loss: 0.0740, Accuracy: 151/603 (25.0415%)
___Train Local_ResNet_18, epoch  70, local model 88, internal_epoch   2, Avg loss: 0.0451, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.9532, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0611, Accuracy: 262/1402 (18.6876%)
___Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 404/1402 (28.8160%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.3097, Accuracy: 74/10000 (0.7400%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.0864, Accuracy: 82/408 (20.0980%)
___Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0531, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.4796, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 227/1013 (22.4087%)
___Train Local_ResNet_18, epoch  70, local model 14, internal_epoch   2, Avg loss: 0.0348, Accuracy: 352/1013 (34.7483%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.6390, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 438/1587 (27.5992%)
___Train Local_ResNet_18, epoch  70, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 605/1587 (38.1222%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.1832, Accuracy: 62/10000 (0.6200%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0707, Accuracy: 105/631 (16.6403%)
___Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 230/631 (36.4501%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.8395, Accuracy: 50/10000 (0.5000%)
time spent on training: 193.78795719146729
[foolsgold agg] training data poison_ratio: 0.18734328358208954  data num: [1470, 530, 460, 271, 603, 1402, 408, 1013, 1587, 631]
[foolsgold agg] considering poison per batch poison_fraction: 0.11708955223880596
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3102, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.5213, Accuracy: 0/9950 (0.0000%)
saving model
Done in 603.1614344120026 sec.
Server Epoch:71 choose agents : [72, 77, 92, 31, 46, 66, 54, 0, 25, 36].
poison local model 72 index 25 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   1, Average loss: 0.0513, Accuracy: 644/1241 (51.8936%), train_poison_data_count: 785
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   2, Average loss: 0.0269, Accuracy: 774/1241 (62.3691%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   3, Average loss: 0.0242, Accuracy: 785/1241 (63.2554%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   4, Average loss: 0.0241, Accuracy: 784/1241 (63.1749%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   5, Average loss: 0.0243, Accuracy: 784/1241 (63.1749%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   6, Average loss: 0.0238, Accuracy: 784/1241 (63.1749%), train_poison_data_count: 785
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   7, Average loss: 0.0235, Accuracy: 785/1241 (63.2554%), train_poison_data_count: 785
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   8, Average loss: 0.0235, Accuracy: 786/1241 (63.3360%), train_poison_data_count: 785
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch   9, Average loss: 0.0231, Accuracy: 786/1241 (63.3360%), train_poison_data_count: 785
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  71, local model 72, internal_epoch  10, Average loss: 0.0229, Accuracy: 785/1241 (63.2554%), train_poison_data_count: 785
Global model norm: 112.05243000628099.
Norm before scaling: 112.0306311001036. Distance: 0.8961916177480647
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.7552, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 71, Avg loss: 0.3931, Accuracy: 9948/9950 (99.9799%)
Scaling by  100
Scaled Norm after poisoning: 141.48615491011833, distance: 89.61916222706643
Total norm for 5 adversaries is: 141.48615491011833. distance: 89.61916222706643
_Test Local_ResNet_18 poisoned: True, epoch: 71, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 311/1340 (23.2090%)
___Train Local_ResNet_18, epoch  71, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 556/1340 (41.4925%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.8436, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 447/1715 (26.0641%)
___Train Local_ResNet_18, epoch  71, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 723/1715 (42.1574%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.6278, Accuracy: 99/10000 (0.9900%)
___Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   1, Avg loss: 0.0811, Accuracy: 58/460 (12.6087%)
___Train Local_ResNet_18, epoch  71, local model 31, internal_epoch   2, Avg loss: 0.0357, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.8214, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   1, Avg loss: 0.0544, Accuracy: 424/1904 (22.2689%)
___Train Local_ResNet_18, epoch  71, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 686/1904 (36.0294%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.9478, Accuracy: 103/10000 (1.0300%)
___Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   1, Avg loss: 0.0618, Accuracy: 266/1402 (18.9729%)
___Train Local_ResNet_18, epoch  71, local model 66, internal_epoch   2, Avg loss: 0.0391, Accuracy: 355/1402 (25.3210%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.2883, Accuracy: 71/10000 (0.7100%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   1, Avg loss: 0.0541, Accuracy: 348/1130 (30.7965%)
___Train Local_ResNet_18, epoch  71, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 501/1130 (44.3363%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.6007, Accuracy: 70/10000 (0.7000%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   1, Avg loss: 0.0569, Accuracy: 370/1657 (22.3295%)
___Train Local_ResNet_18, epoch  71, local model 0, internal_epoch   2, Avg loss: 0.0344, Accuracy: 522/1657 (31.5027%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.8201, Accuracy: 64/10000 (0.6400%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   1, Avg loss: 0.0565, Accuracy: 311/690 (45.0725%)
___Train Local_ResNet_18, epoch  71, local model 25, internal_epoch   2, Avg loss: 0.0272, Accuracy: 463/690 (67.1014%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.6201, Accuracy: 51/10000 (0.5100%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   1, Avg loss: 0.0849, Accuracy: 85/408 (20.8333%)
___Train Local_ResNet_18, epoch  71, local model 36, internal_epoch   2, Avg loss: 0.0538, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.5217, Accuracy: 50/10000 (0.5000%)
time spent on training: 333.95991587638855
[foolsgold agg] training data poison_ratio: 0.4290616891269775  data num: [1241, 1340, 1715, 460, 1904, 1402, 1130, 1657, 690, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.26816355570436096
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3101, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.5207, Accuracy: 0/9950 (0.0000%)
saving model
Done in 754.7426183223724 sec.
Server Epoch:72 choose agents : [7, 99, 12, 11, 10, 15, 85, 26, 14, 29].
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 348/891 (39.0572%)
___Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0261, Accuracy: 452/891 (50.7295%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.3109, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   1, Avg loss: 0.0641, Accuracy: 178/773 (23.0272%)
___Train Local_ResNet_18, epoch  72, local model 99, internal_epoch   2, Avg loss: 0.0349, Accuracy: 415/773 (53.6869%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.2343, Accuracy: 66/10000 (0.6600%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   1, Avg loss: 0.0862, Accuracy: 31/338 (9.1716%)
___Train Local_ResNet_18, epoch  72, local model 12, internal_epoch   2, Avg loss: 0.0469, Accuracy: 147/338 (43.4911%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.4602, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   1, Avg loss: 0.0522, Accuracy: 357/712 (50.1404%)
___Train Local_ResNet_18, epoch  72, local model 11, internal_epoch   2, Avg loss: 0.0276, Accuracy: 436/712 (61.2360%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.8398, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   1, Avg loss: 0.0571, Accuracy: 210/861 (24.3902%)
___Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   2, Avg loss: 0.0210, Accuracy: 456/861 (52.9617%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.8821, Accuracy: 55/10000 (0.5500%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   1, Avg loss: 0.0566, Accuracy: 342/1154 (29.6360%)
___Train Local_ResNet_18, epoch  72, local model 15, internal_epoch   2, Avg loss: 0.0285, Accuracy: 412/1154 (35.7019%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.0332, Accuracy: 52/10000 (0.5200%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 456/1988 (22.9376%)
___Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   2, Avg loss: 0.0349, Accuracy: 640/1988 (32.1932%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.8126, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   1, Avg loss: 0.0551, Accuracy: 364/1446 (25.1729%)
___Train Local_ResNet_18, epoch  72, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 490/1446 (33.8866%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.0333, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   1, Avg loss: 0.0616, Accuracy: 221/1013 (21.8164%)
___Train Local_ResNet_18, epoch  72, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 330/1013 (32.5765%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.7243, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 427/1440 (29.6528%)
___Train Local_ResNet_18, epoch  72, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 652/1440 (45.2778%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.7575, Accuracy: 76/10000 (0.7600%)
time spent on training: 234.88861560821533
[foolsgold agg] training data poison_ratio: 0.4089110776186888  data num: [891, 773, 338, 712, 861, 1154, 1988, 1446, 1013, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.2555694235116805
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3100, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.5213, Accuracy: 0/9950 (0.0000%)
saving model
Done in 653.4873504638672 sec.
Server Epoch:73 choose agents : [74, 81, 71, 96, 73, 8, 10, 55, 33, 35].
poison local model 74 index 26 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   1, Average loss: 0.0440, Accuracy: 824/1552 (53.0928%), train_poison_data_count: 976
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   2, Average loss: 0.0204, Accuracy: 951/1552 (61.2758%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   3, Average loss: 0.0187, Accuracy: 974/1552 (62.7577%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   4, Average loss: 0.0182, Accuracy: 976/1552 (62.8866%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   5, Average loss: 0.0182, Accuracy: 973/1552 (62.6933%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   6, Average loss: 0.0180, Accuracy: 975/1552 (62.8222%), train_poison_data_count: 976
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   7, Average loss: 0.0181, Accuracy: 975/1552 (62.8222%), train_poison_data_count: 976
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   8, Average loss: 0.0179, Accuracy: 974/1552 (62.7577%), train_poison_data_count: 976
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch   9, Average loss: 0.0174, Accuracy: 973/1552 (62.6933%), train_poison_data_count: 976
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  73, local model 74, internal_epoch  10, Average loss: 0.0175, Accuracy: 975/1552 (62.8222%), train_poison_data_count: 976
Global model norm: 112.05232978111165.
Norm before scaling: 112.02528749823631. Distance: 1.046096968129502
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.1110, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 73, Avg loss: 0.4445, Accuracy: 9924/9950 (99.7387%)
Scaling by  100
Scaled Norm after poisoning: 150.9419254009634, distance: 104.6097005689482
Total norm for 5 adversaries is: 150.9419254009634. distance: 104.6097005689482
_Test Local_ResNet_18 poisoned: True, epoch: 73, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1, Avg loss: 0.0651, Accuracy: 247/774 (31.9121%)
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2, Avg loss: 0.0393, Accuracy: 300/774 (38.7597%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.4139, Accuracy: 60/10000 (0.6000%)
___Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   1, Avg loss: 0.0643, Accuracy: 163/818 (19.9267%)
___Train Local_ResNet_18, epoch  73, local model 71, internal_epoch   2, Avg loss: 0.0313, Accuracy: 336/818 (41.0758%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.1462, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 55/311 (17.6849%)
___Train Local_ResNet_18, epoch  73, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3466, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   1, Avg loss: 0.0640, Accuracy: 179/938 (19.0832%)
___Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   2, Avg loss: 0.0330, Accuracy: 325/938 (34.6482%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.4081, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   1, Avg loss: 0.0588, Accuracy: 253/1513 (16.7217%)
___Train Local_ResNet_18, epoch  73, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 479/1513 (31.6590%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.4162, Accuracy: 93/10000 (0.9300%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0567, Accuracy: 207/861 (24.0418%)
___Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0208, Accuracy: 474/861 (55.0523%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.8789, Accuracy: 57/10000 (0.5700%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   1, Avg loss: 0.0554, Accuracy: 268/1071 (25.0233%)
___Train Local_ResNet_18, epoch  73, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 498/1071 (46.4986%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.4632, Accuracy: 51/10000 (0.5100%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   1, Avg loss: 0.0807, Accuracy: 67/515 (13.0097%)
___Train Local_ResNet_18, epoch  73, local model 33, internal_epoch   2, Avg loss: 0.0513, Accuracy: 124/515 (24.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.6955, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   1, Avg loss: 0.0852, Accuracy: 41/271 (15.1292%)
___Train Local_ResNet_18, epoch  73, local model 35, internal_epoch   2, Avg loss: 0.0566, Accuracy: 103/271 (38.0074%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3662, Accuracy: 50/10000 (0.5000%)
time spent on training: 302.01395773887634
[foolsgold agg] training data poison_ratio: 0.5534554730983302  data num: [1552, 774, 818, 311, 938, 1513, 861, 1071, 515, 271]
[foolsgold agg] considering poison per batch poison_fraction: 0.3459096706864564
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3100, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.5171, Accuracy: 0/9950 (0.0000%)
saving model
Done in 718.0790197849274 sec.
Server Epoch:74 choose agents : [50, 33, 10, 20, 28, 37, 46, 27, 93, 60].
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0624, Accuracy: 163/809 (20.1483%)
___Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0269, Accuracy: 382/809 (47.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.1771, Accuracy: 76/10000 (0.7600%)
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   1, Avg loss: 0.0792, Accuracy: 69/515 (13.3981%)
___Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   2, Avg loss: 0.0508, Accuracy: 122/515 (23.6893%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.7030, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   1, Avg loss: 0.0566, Accuracy: 214/861 (24.8548%)
___Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   2, Avg loss: 0.0207, Accuracy: 454/861 (52.7294%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.8817, Accuracy: 54/10000 (0.5400%)
poison local model 20 index 8 
___Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   1, Avg loss: 0.0566, Accuracy: 344/807 (42.6270%)
___Train Local_ResNet_18, epoch  74, local model 20, internal_epoch   2, Avg loss: 0.0316, Accuracy: 420/807 (52.0446%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.9622, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   1, Avg loss: 0.0566, Accuracy: 410/1581 (25.9330%)
___Train Local_ResNet_18, epoch  74, local model 28, internal_epoch   2, Avg loss: 0.0339, Accuracy: 582/1581 (36.8121%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.4962, Accuracy: 95/10000 (0.9500%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   1, Avg loss: 0.0517, Accuracy: 440/1129 (38.9725%)
___Train Local_ResNet_18, epoch  74, local model 37, internal_epoch   2, Avg loss: 0.0242, Accuracy: 757/1129 (67.0505%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.3072, Accuracy: 113/10000 (1.1300%)
___Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   1, Avg loss: 0.0543, Accuracy: 427/1904 (22.4265%)
___Train Local_ResNet_18, epoch  74, local model 46, internal_epoch   2, Avg loss: 0.0310, Accuracy: 703/1904 (36.9223%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.5437, Accuracy: 122/10000 (1.2200%)
___Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 454/1587 (28.6074%)
___Train Local_ResNet_18, epoch  74, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 625/1587 (39.3825%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.2053, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0541, Accuracy: 432/1742 (24.7991%)
___Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 693/1742 (39.7819%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6529, Accuracy: 84/10000 (0.8400%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   1, Avg loss: 0.0494, Accuracy: 586/2227 (26.3134%)
___Train Local_ResNet_18, epoch  74, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1031/2227 (46.2955%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.0521, Accuracy: 128/10000 (1.2800%)
time spent on training: 275.85985136032104
[foolsgold agg] training data poison_ratio: 0.4208327001975384  data num: [809, 515, 861, 807, 1581, 1129, 1904, 1587, 1742, 2227]
[foolsgold agg] considering poison per batch poison_fraction: 0.2630204376234615
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.5158, Accuracy: 0/9950 (0.0000%)
saving model
Done in 688.8433804512024 sec.
Server Epoch:75 choose agents : [78, 51, 85, 6, 92, 32, 29, 40, 95, 74].
poison local model 78 index 27 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   1, Average loss: 0.0713, Accuracy: 133/416 (31.9712%), train_poison_data_count: 272
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   2, Average loss: 0.0385, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   3, Average loss: 0.0412, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   4, Average loss: 0.0383, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   5, Average loss: 0.0353, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   6, Average loss: 0.0326, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   7, Average loss: 0.0278, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   8, Average loss: 0.0273, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch   9, Average loss: 0.0254, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  75, local model 78, internal_epoch  10, Average loss: 0.0265, Accuracy: 272/416 (65.3846%), train_poison_data_count: 272
Global model norm: 112.05223391347448.
Norm before scaling: 112.04683033223206. Distance: 0.5435292486446637
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.8494, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 75, Avg loss: 0.3378, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 123.93314257342546, distance: 54.35292520661262
Total norm for 4 adversaries is: 123.93314257342546. distance: 54.35292520661262
_Test Local_ResNet_18 poisoned: True, epoch: 75, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   1, Avg loss: 0.0591, Accuracy: 236/1049 (22.4976%)
___Train Local_ResNet_18, epoch  75, local model 51, internal_epoch   2, Avg loss: 0.0292, Accuracy: 528/1049 (50.3337%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.2709, Accuracy: 95/10000 (0.9500%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 464/1988 (23.3400%)
___Train Local_ResNet_18, epoch  75, local model 85, internal_epoch   2, Avg loss: 0.0347, Accuracy: 685/1988 (34.4567%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.9832, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 397/1956 (20.2965%)
___Train Local_ResNet_18, epoch  75, local model 6, internal_epoch   2, Avg loss: 0.0316, Accuracy: 663/1956 (33.8957%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.3125, Accuracy: 118/10000 (1.1800%)
___Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 477/1715 (27.8134%)
___Train Local_ResNet_18, epoch  75, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 701/1715 (40.8746%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.7407, Accuracy: 88/10000 (0.8800%)
___Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   1, Avg loss: 0.0593, Accuracy: 203/735 (27.6190%)
___Train Local_ResNet_18, epoch  75, local model 32, internal_epoch   2, Avg loss: 0.0222, Accuracy: 361/735 (49.1156%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.8445, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   1, Avg loss: 0.0488, Accuracy: 426/1440 (29.5833%)
___Train Local_ResNet_18, epoch  75, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 671/1440 (46.5972%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.9380, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   1, Avg loss: 0.0543, Accuracy: 382/1573 (24.2848%)
___Train Local_ResNet_18, epoch  75, local model 40, internal_epoch   2, Avg loss: 0.0350, Accuracy: 551/1573 (35.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.4544, Accuracy: 55/10000 (0.5500%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   1, Avg loss: 0.0524, Accuracy: 334/599 (55.7596%)
___Train Local_ResNet_18, epoch  75, local model 95, internal_epoch   2, Avg loss: 0.0292, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.8667, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0433, Accuracy: 507/1552 (32.6675%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0214, Accuracy: 762/1552 (49.0979%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.1985, Accuracy: 80/10000 (0.8000%)
time spent on training: 333.541565656662
[foolsgold agg] training data poison_ratio: 0.3497657989710512  data num: [416, 1049, 1988, 1956, 1715, 735, 1440, 1573, 599, 1552]
[foolsgold agg] considering poison per batch poison_fraction: 0.218603624356907
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3098, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.5205, Accuracy: 0/9950 (0.0000%)
saving model
Done in 749.8410491943359 sec.
Server Epoch:76 choose agents : [6, 5, 30, 19, 88, 49, 14, 57, 85, 92].
___Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   1, Avg loss: 0.0536, Accuracy: 413/1956 (21.1145%)
___Train Local_ResNet_18, epoch  76, local model 6, internal_epoch   2, Avg loss: 0.0314, Accuracy: 653/1956 (33.3845%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.5089, Accuracy: 120/10000 (1.2000%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0502, Accuracy: 384/1628 (23.5872%)
___Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 845/1628 (51.9042%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1794, Accuracy: 107/10000 (1.0700%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   1, Avg loss: 0.0785, Accuracy: 82/486 (16.8724%)
___Train Local_ResNet_18, epoch  76, local model 30, internal_epoch   2, Avg loss: 0.0407, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.8156, Accuracy: 43/10000 (0.4300%)
___Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   1, Avg loss: 0.0473, Accuracy: 425/1036 (41.0232%)
___Train Local_ResNet_18, epoch  76, local model 19, internal_epoch   2, Avg loss: 0.0238, Accuracy: 661/1036 (63.8031%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.7301, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   1, Avg loss: 0.0732, Accuracy: 143/603 (23.7148%)
___Train Local_ResNet_18, epoch  76, local model 88, internal_epoch   2, Avg loss: 0.0452, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.9684, Accuracy: 51/10000 (0.5100%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   1, Avg loss: 0.0794, Accuracy: 38/440 (8.6364%)
___Train Local_ResNet_18, epoch  76, local model 49, internal_epoch   2, Avg loss: 0.0474, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.5171, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0619, Accuracy: 227/1013 (22.4087%)
___Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0349, Accuracy: 337/1013 (33.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.9078, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   1, Avg loss: 0.0559, Accuracy: 304/1154 (26.3432%)
___Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   2, Avg loss: 0.0267, Accuracy: 439/1154 (38.0416%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.6333, Accuracy: 87/10000 (0.8700%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 420/1988 (21.1268%)
___Train Local_ResNet_18, epoch  76, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 685/1988 (34.4567%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2322, Accuracy: 81/10000 (0.8100%)
___Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 481/1715 (28.0466%)
___Train Local_ResNet_18, epoch  76, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 734/1715 (42.7988%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.7168, Accuracy: 101/10000 (1.0100%)
time spent on training: 256.1947412490845
[foolsgold agg] training data poison_ratio: 0.3779016557117897  data num: [1956, 1628, 486, 1036, 603, 440, 1013, 1154, 1988, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.23618853481986857
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3098, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.5212, Accuracy: 0/9950 (0.0000%)
saving model
Done in 679.9586672782898 sec.
Server Epoch:77 choose agents : [81, 75, 66, 1, 61, 65, 79, 49, 94, 10].
poison local model 81 index 28 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   1, Average loss: 0.0565, Accuracy: 341/774 (44.0568%), train_poison_data_count: 486
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   2, Average loss: 0.0343, Accuracy: 432/774 (55.8140%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   3, Average loss: 0.0261, Accuracy: 418/774 (54.0052%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   4, Average loss: 0.0244, Accuracy: 485/774 (62.6615%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   5, Average loss: 0.0236, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   6, Average loss: 0.0241, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   7, Average loss: 0.0233, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   8, Average loss: 0.0228, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch   9, Average loss: 0.0225, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  77, local model 81, internal_epoch  10, Average loss: 0.0227, Accuracy: 486/774 (62.7907%), train_poison_data_count: 486
Global model norm: 112.05212497287813.
Norm before scaling: 112.0392692387919. Distance: 0.7425460350973123
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.4784, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 77, Avg loss: 0.4146, Accuracy: 9946/9950 (99.9598%)
Scaling by  100
Scaled Norm after poisoning: 133.13990526885618, distance: 74.25459989434157
Total norm for 5 adversaries is: 133.13990526885618. distance: 74.25459989434157
_Test Local_ResNet_18 poisoned: True, epoch: 77, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   1, Avg loss: 0.0647, Accuracy: 254/776 (32.7320%)
___Train Local_ResNet_18, epoch  77, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 422/776 (54.3814%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.9264, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0612, Accuracy: 265/1402 (18.9016%)
___Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 406/1402 (28.9586%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.2418, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   1, Avg loss: 0.0553, Accuracy: 300/928 (32.3276%)
___Train Local_ResNet_18, epoch  77, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 556/928 (59.9138%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.8277, Accuracy: 89/10000 (0.8900%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1257, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1154, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3035, Accuracy: 44/10000 (0.4400%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   1, Avg loss: 0.0543, Accuracy: 408/1475 (27.6610%)
___Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   2, Avg loss: 0.0301, Accuracy: 696/1475 (47.1864%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 6.9534, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   1, Avg loss: 0.1019, Accuracy: 12/197 (6.0914%)
___Train Local_ResNet_18, epoch  77, local model 79, internal_epoch   2, Avg loss: 0.0871, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3180, Accuracy: 53/10000 (0.5300%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 35/440 (7.9545%)
___Train Local_ResNet_18, epoch  77, local model 49, internal_epoch   2, Avg loss: 0.0471, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.5235, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   1, Avg loss: 0.0549, Accuracy: 323/1662 (19.4344%)
___Train Local_ResNet_18, epoch  77, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 635/1662 (38.2070%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.6512, Accuracy: 112/10000 (1.1200%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   1, Avg loss: 0.0564, Accuracy: 217/861 (25.2033%)
___Train Local_ResNet_18, epoch  77, local model 10, internal_epoch   2, Avg loss: 0.0208, Accuracy: 458/861 (53.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.8901, Accuracy: 50/10000 (0.5000%)
time spent on training: 302.20273184776306
[foolsgold agg] training data poison_ratio: 0.42267441860465116  data num: [774, 776, 1402, 928, 85, 1475, 197, 440, 1662, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.264171511627907
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3097, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.5183, Accuracy: 0/9950 (0.0000%)
saving model
Done in 724.9753978252411 sec.
Server Epoch:78 choose agents : [42, 6, 82, 30, 19, 31, 93, 7, 5, 16].
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   1, Avg loss: 0.0523, Accuracy: 353/1372 (25.7289%)
___Train Local_ResNet_18, epoch  78, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 542/1372 (39.5044%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.7588, Accuracy: 91/10000 (0.9100%)
___Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   1, Avg loss: 0.0539, Accuracy: 388/1956 (19.8364%)
___Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   2, Avg loss: 0.0318, Accuracy: 675/1956 (34.5092%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.3425, Accuracy: 102/10000 (1.0200%)
___Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   1, Avg loss: 0.0755, Accuracy: 77/500 (15.4000%)
___Train Local_ResNet_18, epoch  78, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.7966, Accuracy: 42/10000 (0.4200%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0783, Accuracy: 83/486 (17.0782%)
___Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0407, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.8412, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 402/1036 (38.8031%)
___Train Local_ResNet_18, epoch  78, local model 19, internal_epoch   2, Avg loss: 0.0235, Accuracy: 664/1036 (64.0927%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.2040, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   1, Avg loss: 0.0810, Accuracy: 59/460 (12.8261%)
___Train Local_ResNet_18, epoch  78, local model 31, internal_epoch   2, Avg loss: 0.0361, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.7895, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   1, Avg loss: 0.0546, Accuracy: 425/1742 (24.3972%)
___Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 706/1742 (40.5281%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.7395, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   1, Avg loss: 0.0529, Accuracy: 366/891 (41.0774%)
___Train Local_ResNet_18, epoch  78, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 419/891 (47.0258%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.1649, Accuracy: 51/10000 (0.5100%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   1, Avg loss: 0.0500, Accuracy: 403/1628 (24.7543%)
___Train Local_ResNet_18, epoch  78, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 812/1628 (49.8771%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.2618, Accuracy: 129/10000 (1.2900%)
___Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   1, Avg loss: 0.0624, Accuracy: 289/708 (40.8192%)
___Train Local_ResNet_18, epoch  78, local model 16, internal_epoch   2, Avg loss: 0.0377, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.9050, Accuracy: 52/10000 (0.5200%)
time spent on training: 235.97094130516052
[foolsgold agg] training data poison_ratio: 0.32340662399109377  data num: [1372, 1956, 500, 486, 1036, 460, 1742, 891, 1628, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.2021291399944336
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3096, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.5182, Accuracy: 0/9950 (0.0000%)
saving model
Done in 651.3183221817017 sec.
Server Epoch:79 choose agents : [84, 82, 36, 58, 27, 49, 61, 52, 90, 85].
poison local model 84 index 29 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   1, Average loss: 0.0504, Accuracy: 623/1190 (52.3529%), train_poison_data_count: 758
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   2, Average loss: 0.0288, Accuracy: 690/1190 (57.9832%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   3, Average loss: 0.0249, Accuracy: 758/1190 (63.6975%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   4, Average loss: 0.0236, Accuracy: 757/1190 (63.6134%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   5, Average loss: 0.0234, Accuracy: 758/1190 (63.6975%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   6, Average loss: 0.0233, Accuracy: 756/1190 (63.5294%), train_poison_data_count: 758
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   7, Average loss: 0.0231, Accuracy: 759/1190 (63.7815%), train_poison_data_count: 758
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   8, Average loss: 0.0229, Accuracy: 759/1190 (63.7815%), train_poison_data_count: 758
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch   9, Average loss: 0.0227, Accuracy: 756/1190 (63.5294%), train_poison_data_count: 758
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  79, local model 84, internal_epoch  10, Average loss: 0.0221, Accuracy: 753/1190 (63.2773%), train_poison_data_count: 758
Global model norm: 112.05202474743595.
Norm before scaling: 112.03118462341189. Distance: 0.8750071184686202
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.4175, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 79, Avg loss: 0.3796, Accuracy: 9919/9950 (99.6884%)
Scaling by  100
Scaled Norm after poisoning: 140.24570375549834, distance: 87.50071149264302
Total norm for 5 adversaries is: 140.24570375549834. distance: 87.50071149264302
_Test Local_ResNet_18 poisoned: True, epoch: 79, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   1, Avg loss: 0.0758, Accuracy: 67/500 (13.4000%)
___Train Local_ResNet_18, epoch  79, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.8068, Accuracy: 48/10000 (0.4800%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   1, Avg loss: 0.0863, Accuracy: 83/408 (20.3431%)
___Train Local_ResNet_18, epoch  79, local model 36, internal_epoch   2, Avg loss: 0.0532, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.4977, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 354/803 (44.0847%)
___Train Local_ResNet_18, epoch  79, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 390/803 (48.5679%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.1105, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   1, Avg loss: 0.0535, Accuracy: 448/1587 (28.2294%)
___Train Local_ResNet_18, epoch  79, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 603/1587 (37.9962%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.1539, Accuracy: 70/10000 (0.7000%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   1, Avg loss: 0.0787, Accuracy: 38/440 (8.6364%)
___Train Local_ResNet_18, epoch  79, local model 49, internal_epoch   2, Avg loss: 0.0469, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.5237, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   1, Avg loss: 0.1238, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  79, local model 61, internal_epoch   2, Avg loss: 0.1179, Accuracy: 11/85 (12.9412%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3036, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0571, Accuracy: 285/636 (44.8113%)
___Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0320, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.3587, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   1, Avg loss: 0.0557, Accuracy: 327/677 (48.3013%)
___Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 430/677 (63.5155%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.5165, Accuracy: 58/10000 (0.5800%)
poison local model 85 index 30 
___Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 459/1988 (23.0885%)
___Train Local_ResNet_18, epoch  79, local model 85, internal_epoch   2, Avg loss: 0.0359, Accuracy: 692/1988 (34.8089%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.2005, Accuracy: 92/10000 (0.9200%)
time spent on training: 306.73407220840454
[foolsgold agg] training data poison_ratio: 0.49446716382006256  data num: [1190, 500, 408, 803, 1587, 440, 85, 636, 677, 1988]
[foolsgold agg] considering poison per batch poison_fraction: 0.3090419773875391
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3095, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.5153, Accuracy: 0/9950 (0.0000%)
saving model
Done in 720.766553401947 sec.
Server Epoch:80 choose agents : [46, 75, 54, 3, 89, 69, 41, 1, 93, 71].
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1, Avg loss: 0.0540, Accuracy: 427/1904 (22.4265%)
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2, Avg loss: 0.0308, Accuracy: 725/1904 (38.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.7536, Accuracy: 133/10000 (1.3300%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0643, Accuracy: 254/776 (32.7320%)
___Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0288, Accuracy: 434/776 (55.9278%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.8653, Accuracy: 53/10000 (0.5300%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   1, Avg loss: 0.0540, Accuracy: 364/1130 (32.2124%)
___Train Local_ResNet_18, epoch  80, local model 54, internal_epoch   2, Avg loss: 0.0279, Accuracy: 523/1130 (46.2832%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.7635, Accuracy: 52/10000 (0.5200%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   1, Avg loss: 0.0719, Accuracy: 115/781 (14.7247%)
___Train Local_ResNet_18, epoch  80, local model 3, internal_epoch   2, Avg loss: 0.0364, Accuracy: 241/781 (30.8579%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.7432, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   1, Avg loss: 0.0610, Accuracy: 341/896 (38.0580%)
___Train Local_ResNet_18, epoch  80, local model 89, internal_epoch   2, Avg loss: 0.0330, Accuracy: 446/896 (49.7768%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.2823, Accuracy: 50/10000 (0.5000%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   1, Avg loss: 0.0562, Accuracy: 290/590 (49.1525%)
___Train Local_ResNet_18, epoch  80, local model 69, internal_epoch   2, Avg loss: 0.0310, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.1652, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   1, Avg loss: 0.0585, Accuracy: 342/719 (47.5661%)
___Train Local_ResNet_18, epoch  80, local model 41, internal_epoch   2, Avg loss: 0.0332, Accuracy: 451/719 (62.7260%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.4340, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   1, Avg loss: 0.0557, Accuracy: 292/928 (31.4655%)
___Train Local_ResNet_18, epoch  80, local model 1, internal_epoch   2, Avg loss: 0.0226, Accuracy: 620/928 (66.8103%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.5846, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   1, Avg loss: 0.0545, Accuracy: 431/1742 (24.7417%)
___Train Local_ResNet_18, epoch  80, local model 93, internal_epoch   2, Avg loss: 0.0314, Accuracy: 722/1742 (41.4466%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.1462, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   1, Avg loss: 0.0642, Accuracy: 159/818 (19.4377%)
___Train Local_ResNet_18, epoch  80, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 345/818 (42.1760%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.3231, Accuracy: 70/10000 (0.7000%)
time spent on training: 231.73544192314148
[foolsgold agg] training data poison_ratio: 0.24319330999611047  data num: [1904, 776, 1130, 781, 896, 590, 719, 928, 1742, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.15199581874756904
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3095, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.5159, Accuracy: 0/9950 (0.0000%)
saving model
Done in 646.8882200717926 sec.
Server Epoch:81 choose agents : [85, 15, 81, 53, 39, 54, 28, 61, 0, 51].
poison local model 85 index 30 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   1, Average loss: 0.0440, Accuracy: 1087/1988 (54.6781%), train_poison_data_count: 1244
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   2, Average loss: 0.0258, Accuracy: 1238/1988 (62.2736%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   3, Average loss: 0.0244, Accuracy: 1240/1988 (62.3742%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   4, Average loss: 0.0245, Accuracy: 1246/1988 (62.6761%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   5, Average loss: 0.0239, Accuracy: 1243/1988 (62.5252%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   6, Average loss: 0.0238, Accuracy: 1242/1988 (62.4748%), train_poison_data_count: 1244
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   7, Average loss: 0.0233, Accuracy: 1244/1988 (62.5755%), train_poison_data_count: 1244
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   8, Average loss: 0.0231, Accuracy: 1243/1988 (62.5252%), train_poison_data_count: 1244
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch   9, Average loss: 0.0233, Accuracy: 1244/1988 (62.5755%), train_poison_data_count: 1244
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  81, local model 85, internal_epoch  10, Average loss: 0.0235, Accuracy: 1244/1988 (62.5755%), train_poison_data_count: 1244
Global model norm: 112.05190273373317.
Norm before scaling: 112.01463876152528. Distance: 1.0888196173570444
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.0223, Accuracy: 51/10000 (0.5100%)
_Test Local_ResNet_18 poisoned: True, epoch: 81, Avg loss: 0.3808, Accuracy: 9936/9950 (99.8593%)
Scaling by  100
Scaled Norm after poisoning: 153.15814054638102, distance: 108.88196465238171
Total norm for 6 adversaries is: 153.15814054638102. distance: 108.88196465238171
_Test Local_ResNet_18 poisoned: True, epoch: 81, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0569, Accuracy: 330/1154 (28.5962%)
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0281, Accuracy: 443/1154 (38.3882%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.0333, Accuracy: 50/10000 (0.5000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   1, Avg loss: 0.0667, Accuracy: 239/774 (30.8786%)
___Train Local_ResNet_18, epoch  81, local model 81, internal_epoch   2, Avg loss: 0.0361, Accuracy: 302/774 (39.0181%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.4282, Accuracy: 66/10000 (0.6600%)
___Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   1, Avg loss: 0.0498, Accuracy: 296/813 (36.4084%)
___Train Local_ResNet_18, epoch  81, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 490/813 (60.2706%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.8025, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 319/1013 (31.4906%)
___Train Local_ResNet_18, epoch  81, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 470/1013 (46.3968%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.7211, Accuracy: 58/10000 (0.5800%)
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0543, Accuracy: 363/1130 (32.1239%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 475/1130 (42.0354%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.4733, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 395/1581 (24.9842%)
___Train Local_ResNet_18, epoch  81, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 622/1581 (39.3422%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.5840, Accuracy: 100/10000 (1.0000%)
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1250, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1187, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3039, Accuracy: 48/10000 (0.4800%)
poison local model 0 index 0 
___Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   1, Avg loss: 0.0569, Accuracy: 373/1657 (22.5106%)
___Train Local_ResNet_18, epoch  81, local model 0, internal_epoch   2, Avg loss: 0.0341, Accuracy: 556/1657 (33.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.7471, Accuracy: 75/10000 (0.7500%)
___Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   1, Avg loss: 0.0591, Accuracy: 242/1049 (23.0696%)
___Train Local_ResNet_18, epoch  81, local model 51, internal_epoch   2, Avg loss: 0.0295, Accuracy: 533/1049 (50.8103%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.5850, Accuracy: 81/10000 (0.8100%)
time spent on training: 361.8052523136139
[foolsgold agg] training data poison_ratio: 0.6036997509782995  data num: [1988, 1154, 774, 813, 1013, 1130, 1581, 85, 1657, 1049]
[foolsgold agg] considering poison per batch poison_fraction: 0.37731234436143724
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3094, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.5131, Accuracy: 0/9950 (0.0000%)
saving model
Done in 778.013724565506 sec.
Server Epoch:82 choose agents : [23, 74, 72, 38, 79, 44, 28, 77, 55, 70].
___Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   1, Avg loss: 0.0620, Accuracy: 328/715 (45.8741%)
___Train Local_ResNet_18, epoch  82, local model 23, internal_epoch   2, Avg loss: 0.0389, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.8108, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 469/1552 (30.2191%)
___Train Local_ResNet_18, epoch  82, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 800/1552 (51.5464%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 11.0430, Accuracy: 70/10000 (0.7000%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 263/1241 (21.1926%)
___Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 400/1241 (32.2321%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.0842, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   1, Avg loss: 0.0604, Accuracy: 265/1131 (23.4306%)
___Train Local_ResNet_18, epoch  82, local model 38, internal_epoch   2, Avg loss: 0.0304, Accuracy: 497/1131 (43.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.2461, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1, Avg loss: 0.1024, Accuracy: 10/197 (5.0761%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2, Avg loss: 0.0871, Accuracy: 62/197 (31.4721%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3202, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0587, Accuracy: 392/1750 (22.4000%)
___Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0348, Accuracy: 679/1750 (38.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.3340, Accuracy: 117/10000 (1.1700%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0558, Accuracy: 361/1581 (22.8336%)
___Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 624/1581 (39.4687%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.8044, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   1, Avg loss: 0.0536, Accuracy: 333/1340 (24.8507%)
___Train Local_ResNet_18, epoch  82, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 547/1340 (40.8209%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.7472, Accuracy: 67/10000 (0.6700%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   1, Avg loss: 0.0557, Accuracy: 253/1071 (23.6228%)
___Train Local_ResNet_18, epoch  82, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 478/1071 (44.6312%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.1251, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 352/1418 (24.8237%)
___Train Local_ResNet_18, epoch  82, local model 70, internal_epoch   2, Avg loss: 0.0302, Accuracy: 677/1418 (47.7433%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.7826, Accuracy: 86/10000 (0.8600%)
time spent on training: 263.3099241256714
[foolsgold agg] training data poison_ratio: 0.4679893297765922  data num: [715, 1552, 1241, 1131, 197, 1750, 1581, 1340, 1071, 1418]
[foolsgold agg] considering poison per batch poison_fraction: 0.2924933311103701
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3094, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.5141, Accuracy: 0/9950 (0.0000%)
saving model
Done in 669.084755897522 sec.
Server Epoch:83 choose agents : [95, 76, 60, 48, 18, 10, 90, 78, 15, 89].
poison local model 95 index 31 
poison_now
Current lr: [0.001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   1, Average loss: 0.0557, Accuracy: 247/599 (41.2354%), train_poison_data_count: 383
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   2, Average loss: 0.0241, Accuracy: 354/599 (59.0985%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   3, Average loss: 0.0216, Accuracy: 277/599 (46.2437%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   4, Average loss: 0.0228, Accuracy: 374/599 (62.4374%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   5, Average loss: 0.0201, Accuracy: 382/599 (63.7730%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   6, Average loss: 0.0191, Accuracy: 381/599 (63.6060%), train_poison_data_count: 383
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   7, Average loss: 0.0192, Accuracy: 386/599 (64.4407%), train_poison_data_count: 383
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   8, Average loss: 0.0193, Accuracy: 382/599 (63.7730%), train_poison_data_count: 383
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch   9, Average loss: 0.0213, Accuracy: 385/599 (64.2738%), train_poison_data_count: 383
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18, epoch  83, local model 95, internal_epoch  10, Average loss: 0.0167, Accuracy: 385/599 (64.2738%), train_poison_data_count: 383
Global model norm: 112.0517894351759.
Norm before scaling: 112.04444657283332. Distance: 0.8024080824574235
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 10.6639, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 83, Avg loss: 0.3517, Accuracy: 9817/9950 (98.6633%)
Scaling by  100
Scaled Norm after poisoning: 136.9852937476319, distance: 80.24080579145813
Total norm for 7 adversaries is: 136.9852937476319. distance: 80.24080579145813
_Test Local_ResNet_18 poisoned: True, epoch: 83, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   1, Avg loss: 0.0839, Accuracy: 63/466 (13.5193%)
___Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   2, Avg loss: 0.0477, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.7023, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 599/2227 (26.8972%)
___Train Local_ResNet_18, epoch  83, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1025/2227 (46.0260%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1736, Accuracy: 129/10000 (1.2900%)
poison local model 48 index 17 
___Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   1, Avg loss: 0.0706, Accuracy: 104/631 (16.4818%)
___Train Local_ResNet_18, epoch  83, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 223/631 (35.3407%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.8639, Accuracy: 50/10000 (0.5000%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.0751, Accuracy: 125/530 (23.5849%)
___Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0374, Accuracy: 275/530 (51.8868%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.1463, Accuracy: 57/10000 (0.5700%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   1, Avg loss: 0.0566, Accuracy: 224/861 (26.0163%)
___Train Local_ResNet_18, epoch  83, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 436/861 (50.6388%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.6782, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   1, Avg loss: 0.0564, Accuracy: 322/677 (47.5628%)
___Train Local_ResNet_18, epoch  83, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 429/677 (63.3678%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.3448, Accuracy: 50/10000 (0.5000%)
poison local model 78 index 27 
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1, Avg loss: 0.0832, Accuracy: 48/416 (11.5385%)
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2, Avg loss: 0.0451, Accuracy: 183/416 (43.9904%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.5820, Accuracy: 50/10000 (0.5000%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   1, Avg loss: 0.0545, Accuracy: 358/1154 (31.0225%)
___Train Local_ResNet_18, epoch  83, local model 15, internal_epoch   2, Avg loss: 0.0270, Accuracy: 536/1154 (46.4471%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.0058, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   1, Avg loss: 0.0607, Accuracy: 335/896 (37.3884%)
___Train Local_ResNet_18, epoch  83, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 456/896 (50.8929%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.2360, Accuracy: 50/10000 (0.5000%)
time spent on training: 322.9107925891876
[foolsgold agg] training data poison_ratio: 0.7588979543573371  data num: [599, 466, 2227, 631, 530, 861, 677, 416, 1154, 896]
[foolsgold agg] considering poison per batch poison_fraction: 0.4743112214733357
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3094, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.5096, Accuracy: 0/9950 (0.0000%)
saving model
Done in 738.8594079017639 sec.
Server Epoch:84 choose agents : [61, 28, 35, 75, 74, 90, 55, 80, 23, 88].
poison local model 61 index 22 
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1243, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1163, Accuracy: 11/85 (12.9412%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3036, Accuracy: 42/10000 (0.4200%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1, Avg loss: 0.0558, Accuracy: 393/1581 (24.8577%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 566/1581 (35.8001%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.6485, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   1, Avg loss: 0.0844, Accuracy: 50/271 (18.4502%)
___Train Local_ResNet_18, epoch  84, local model 35, internal_epoch   2, Avg loss: 0.0542, Accuracy: 111/271 (40.9594%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3733, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   1, Avg loss: 0.0633, Accuracy: 256/776 (32.9897%)
___Train Local_ResNet_18, epoch  84, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 405/776 (52.1907%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.1848, Accuracy: 53/10000 (0.5300%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 473/1552 (30.4768%)
___Train Local_ResNet_18, epoch  84, local model 74, internal_epoch   2, Avg loss: 0.0209, Accuracy: 785/1552 (50.5799%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 10.7484, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   1, Avg loss: 0.0546, Accuracy: 330/677 (48.7445%)
___Train Local_ResNet_18, epoch  84, local model 90, internal_epoch   2, Avg loss: 0.0215, Accuracy: 476/677 (70.3102%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.3974, Accuracy: 51/10000 (0.5100%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   1, Avg loss: 0.0553, Accuracy: 253/1071 (23.6228%)
___Train Local_ResNet_18, epoch  84, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 484/1071 (45.1914%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.0294, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1, Avg loss: 0.0693, Accuracy: 157/682 (23.0205%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2, Avg loss: 0.0375, Accuracy: 248/682 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.2647, Accuracy: 56/10000 (0.5600%)
___Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   1, Avg loss: 0.0607, Accuracy: 329/715 (46.0140%)
___Train Local_ResNet_18, epoch  84, local model 23, internal_epoch   2, Avg loss: 0.0385, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.7511, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.0731, Accuracy: 150/603 (24.8756%)
___Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0446, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 6.0426, Accuracy: 50/10000 (0.5000%)
time spent on training: 206.7054088115692
[foolsgold agg] training data poison_ratio: 0.33795082990141023  data num: [85, 1581, 271, 776, 1552, 677, 1071, 682, 715, 603]
[foolsgold agg] considering poison per batch poison_fraction: 0.2112192686883814
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3093, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.5098, Accuracy: 0/9950 (0.0000%)
saving model
Done in 619.9941892623901 sec.
Server Epoch:85 choose agents : [36, 56, 25, 90, 31, 70, 30, 21, 46, 64].
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   1, Avg loss: 0.0849, Accuracy: 83/408 (20.3431%)
___Train Local_ResNet_18, epoch  85, local model 36, internal_epoch   2, Avg loss: 0.0527, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.5256, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  85, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 72/186 (38.7097%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3108, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 10 
___Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 317/690 (45.9420%)
___Train Local_ResNet_18, epoch  85, local model 25, internal_epoch   2, Avg loss: 0.0272, Accuracy: 454/690 (65.7971%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.6064, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   1, Avg loss: 0.0554, Accuracy: 324/677 (47.8582%)
___Train Local_ResNet_18, epoch  85, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 423/677 (62.4815%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.4330, Accuracy: 63/10000 (0.6300%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0808, Accuracy: 68/460 (14.7826%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0367, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.7971, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   1, Avg loss: 0.0549, Accuracy: 386/1418 (27.2214%)
___Train Local_ResNet_18, epoch  85, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 627/1418 (44.2172%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.1130, Accuracy: 82/10000 (0.8200%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0778, Accuracy: 91/486 (18.7243%)
___Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0405, Accuracy: 209/486 (43.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.8298, Accuracy: 48/10000 (0.4800%)
___Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   1, Avg loss: 0.0529, Accuracy: 417/1949 (21.3956%)
___Train Local_ResNet_18, epoch  85, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 624/1949 (32.0164%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.3255, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   1, Avg loss: 0.0541, Accuracy: 446/1904 (23.4244%)
___Train Local_ResNet_18, epoch  85, local model 46, internal_epoch   2, Avg loss: 0.0313, Accuracy: 694/1904 (36.4496%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.6052, Accuracy: 111/10000 (1.1100%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0636, Accuracy: 175/953 (18.3631%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 315/953 (33.0535%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.4834, Accuracy: 63/10000 (0.6300%)
time spent on training: 219.7431287765503
[foolsgold agg] training data poison_ratio: 0.17347497535866827  data num: [408, 186, 690, 677, 460, 1418, 486, 1949, 1904, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.10842185959916767
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3093, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.5090, Accuracy: 0/9950 (0.0000%)
saving model
Done in 636.5635788440704 sec.
Server Epoch:86 choose agents : [94, 50, 2, 53, 86, 67, 12, 69, 24, 81].
___Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   1, Avg loss: 0.0546, Accuracy: 344/1662 (20.6980%)
___Train Local_ResNet_18, epoch  86, local model 94, internal_epoch   2, Avg loss: 0.0325, Accuracy: 639/1662 (38.4477%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.8189, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   1, Avg loss: 0.0623, Accuracy: 160/809 (19.7775%)
___Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   2, Avg loss: 0.0267, Accuracy: 359/809 (44.3758%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.1040, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0618, Accuracy: 241/605 (39.8347%)
___Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0398, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.8696, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   1, Avg loss: 0.0496, Accuracy: 278/813 (34.1943%)
___Train Local_ResNet_18, epoch  86, local model 53, internal_epoch   2, Avg loss: 0.0193, Accuracy: 461/813 (56.7036%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.6381, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   1, Avg loss: 0.0628, Accuracy: 360/1003 (35.8923%)
___Train Local_ResNet_18, epoch  86, local model 86, internal_epoch   2, Avg loss: 0.0337, Accuracy: 392/1003 (39.0828%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.6671, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   1, Avg loss: 0.0778, Accuracy: 57/426 (13.3803%)
___Train Local_ResNet_18, epoch  86, local model 67, internal_epoch   2, Avg loss: 0.0415, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.6008, Accuracy: 54/10000 (0.5400%)
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   1, Avg loss: 0.0858, Accuracy: 27/338 (7.9882%)
___Train Local_ResNet_18, epoch  86, local model 12, internal_epoch   2, Avg loss: 0.0460, Accuracy: 150/338 (44.3787%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.4761, Accuracy: 50/10000 (0.5000%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   1, Avg loss: 0.0562, Accuracy: 294/590 (49.8305%)
___Train Local_ResNet_18, epoch  86, local model 69, internal_epoch   2, Avg loss: 0.0321, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.2333, Accuracy: 50/10000 (0.5000%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1, Avg loss: 0.0758, Accuracy: 56/312 (17.9487%)
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2, Avg loss: 0.0408, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.4050, Accuracy: 50/10000 (0.5000%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   1, Avg loss: 0.0640, Accuracy: 247/774 (31.9121%)
___Train Local_ResNet_18, epoch  86, local model 81, internal_epoch   2, Avg loss: 0.0370, Accuracy: 317/774 (40.9561%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.1829, Accuracy: 58/10000 (0.5800%)
time spent on training: 209.32846927642822
[foolsgold agg] training data poison_ratio: 0.2746863066012002  data num: [1662, 809, 605, 813, 1003, 426, 338, 590, 312, 774]
[foolsgold agg] considering poison per batch poison_fraction: 0.17167894162575012
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3093, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.5096, Accuracy: 0/9950 (0.0000%)
saving model
Done in 616.0183455944061 sec.
Server Epoch:87 choose agents : [39, 80, 90, 83, 43, 57, 67, 2, 23, 36].
___Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   1, Avg loss: 0.0532, Accuracy: 317/1013 (31.2932%)
___Train Local_ResNet_18, epoch  87, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 507/1013 (50.0494%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.5925, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   1, Avg loss: 0.0690, Accuracy: 153/682 (22.4340%)
___Train Local_ResNet_18, epoch  87, local model 80, internal_epoch   2, Avg loss: 0.0374, Accuracy: 258/682 (37.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.6037, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   1, Avg loss: 0.0549, Accuracy: 331/677 (48.8922%)
___Train Local_ResNet_18, epoch  87, local model 90, internal_epoch   2, Avg loss: 0.0238, Accuracy: 433/677 (63.9586%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.6005, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   1, Avg loss: 0.0539, Accuracy: 389/1953 (19.9181%)
___Train Local_ResNet_18, epoch  87, local model 83, internal_epoch   2, Avg loss: 0.0333, Accuracy: 779/1953 (39.8874%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.8150, Accuracy: 127/10000 (1.2700%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   1, Avg loss: 0.0606, Accuracy: 311/946 (32.8753%)
___Train Local_ResNet_18, epoch  87, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 344/946 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.1143, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0536, Accuracy: 321/1154 (27.8163%)
___Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0260, Accuracy: 474/1154 (41.0745%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.5595, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   1, Avg loss: 0.0775, Accuracy: 57/426 (13.3803%)
___Train Local_ResNet_18, epoch  87, local model 67, internal_epoch   2, Avg loss: 0.0405, Accuracy: 171/426 (40.1408%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.6179, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   1, Avg loss: 0.0636, Accuracy: 234/605 (38.6777%)
___Train Local_ResNet_18, epoch  87, local model 2, internal_epoch   2, Avg loss: 0.0388, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.8769, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0614, Accuracy: 325/715 (45.4545%)
___Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0386, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.7014, Accuracy: 50/10000 (0.5000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   1, Avg loss: 0.0851, Accuracy: 90/408 (22.0588%)
___Train Local_ResNet_18, epoch  87, local model 36, internal_epoch   2, Avg loss: 0.0543, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.5063, Accuracy: 50/10000 (0.5000%)
time spent on training: 191.14685654640198
[foolsgold agg] training data poison_ratio: 0.04755799044177643  data num: [1013, 682, 677, 1953, 946, 1154, 426, 605, 715, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.02972374402611027
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3092, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.5103, Accuracy: 0/9950 (0.0000%)
saving model
Done in 608.2842838764191 sec.
Server Epoch:88 choose agents : [4, 42, 28, 74, 13, 49, 24, 34, 87, 86].
___Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   1, Avg loss: 0.0587, Accuracy: 341/901 (37.8468%)
___Train Local_ResNet_18, epoch  88, local model 4, internal_epoch   2, Avg loss: 0.0330, Accuracy: 393/901 (43.6182%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.6135, Accuracy: 50/10000 (0.5000%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   1, Avg loss: 0.0522, Accuracy: 360/1372 (26.2391%)
___Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 523/1372 (38.1195%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0491, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   1, Avg loss: 0.0550, Accuracy: 400/1581 (25.3004%)
___Train Local_ResNet_18, epoch  88, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 610/1581 (38.5832%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.6860, Accuracy: 89/10000 (0.8900%)
poison local model 74 index 26 
___Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   1, Avg loss: 0.0427, Accuracy: 481/1552 (30.9923%)
___Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   2, Avg loss: 0.0203, Accuracy: 792/1552 (51.0309%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 11.1070, Accuracy: 80/10000 (0.8000%)
___Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   1, Avg loss: 0.0575, Accuracy: 305/1645 (18.5410%)
___Train Local_ResNet_18, epoch  88, local model 13, internal_epoch   2, Avg loss: 0.0325, Accuracy: 590/1645 (35.8663%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.7856, Accuracy: 121/10000 (1.2100%)
poison local model 49 index 18 
___Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   1, Avg loss: 0.0787, Accuracy: 33/440 (7.5000%)
___Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   2, Avg loss: 0.0470, Accuracy: 141/440 (32.0455%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.5609, Accuracy: 50/10000 (0.5000%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   1, Avg loss: 0.0755, Accuracy: 47/312 (15.0641%)
___Train Local_ResNet_18, epoch  88, local model 24, internal_epoch   2, Avg loss: 0.0393, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.4015, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0569, Accuracy: 395/1427 (27.6804%)
___Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 600/1427 (42.0463%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.8856, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   1, Avg loss: 0.0579, Accuracy: 297/1131 (26.2599%)
___Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 380/1131 (33.5986%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.9289, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   1, Avg loss: 0.0622, Accuracy: 362/1003 (36.0917%)
___Train Local_ResNet_18, epoch  88, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 379/1003 (37.7866%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.0040, Accuracy: 50/10000 (0.5000%)
time spent on training: 263.7893044948578
[foolsgold agg] training data poison_ratio: 0.3234776487152411  data num: [901, 1372, 1581, 1552, 1645, 440, 312, 1427, 1131, 1003]
[foolsgold agg] considering poison per batch poison_fraction: 0.20217353044702568
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.97786548
 0.97786548 1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3092, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.5104, Accuracy: 0/9950 (0.0000%)
saving model
Done in 678.4174869060516 sec.
Server Epoch:89 choose agents : [84, 89, 29, 52, 37, 30, 66, 62, 88, 42].
poison local model 84 index 29 
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 324/1190 (27.2269%)
___Train Local_ResNet_18, epoch  89, local model 84, internal_epoch   2, Avg loss: 0.0321, Accuracy: 438/1190 (36.8067%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.2565, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1, Avg loss: 0.0613, Accuracy: 338/896 (37.7232%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 438/896 (48.8839%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.3293, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   1, Avg loss: 0.0484, Accuracy: 427/1440 (29.6528%)
___Train Local_ResNet_18, epoch  89, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 673/1440 (46.7361%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.7482, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   1, Avg loss: 0.0562, Accuracy: 293/636 (46.0692%)
___Train Local_ResNet_18, epoch  89, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.2991, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   1, Avg loss: 0.0520, Accuracy: 391/1129 (34.6324%)
___Train Local_ResNet_18, epoch  89, local model 37, internal_epoch   2, Avg loss: 0.0238, Accuracy: 720/1129 (63.7733%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.4564, Accuracy: 112/10000 (1.1200%)
poison local model 30 index 11 
___Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   1, Avg loss: 0.0777, Accuracy: 90/486 (18.5185%)
___Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   2, Avg loss: 0.0402, Accuracy: 214/486 (44.0329%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.8278, Accuracy: 47/10000 (0.4700%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   1, Avg loss: 0.0610, Accuracy: 270/1402 (19.2582%)
___Train Local_ResNet_18, epoch  89, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 370/1402 (26.3909%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.1753, Accuracy: 67/10000 (0.6700%)
___Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   1, Avg loss: 0.0692, Accuracy: 145/568 (25.5282%)
___Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   2, Avg loss: 0.0397, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.7331, Accuracy: 49/10000 (0.4900%)
___Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   1, Avg loss: 0.0735, Accuracy: 150/603 (24.8756%)
___Train Local_ResNet_18, epoch  89, local model 88, internal_epoch   2, Avg loss: 0.0447, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.1314, Accuracy: 48/10000 (0.4800%)
poison local model 42 index 15 
___Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 357/1372 (26.0204%)
___Train Local_ResNet_18, epoch  89, local model 42, internal_epoch   2, Avg loss: 0.0308, Accuracy: 559/1372 (40.7434%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.6774, Accuracy: 76/10000 (0.7600%)
time spent on training: 240.66235303878784
[foolsgold agg] training data poison_ratio: 0.42964410615099774  data num: [1190, 896, 1440, 636, 1129, 486, 1402, 568, 603, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.2685275663443736
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3091, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.5109, Accuracy: 0/9950 (0.0000%)
saving model
Done in 643.0165872573853 sec.
Server Epoch:90 choose agents : [43, 80, 99, 44, 67, 39, 70, 50, 86, 91].
___Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   1, Avg loss: 0.0615, Accuracy: 312/946 (32.9810%)
___Train Local_ResNet_18, epoch  90, local model 43, internal_epoch   2, Avg loss: 0.0354, Accuracy: 331/946 (34.9894%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.0341, Accuracy: 58/10000 (0.5800%)
___Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   1, Avg loss: 0.0685, Accuracy: 151/682 (22.1408%)
___Train Local_ResNet_18, epoch  90, local model 80, internal_epoch   2, Avg loss: 0.0376, Accuracy: 248/682 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.3814, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   1, Avg loss: 0.0675, Accuracy: 198/773 (25.6145%)
___Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   2, Avg loss: 0.0306, Accuracy: 396/773 (51.2290%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.1667, Accuracy: 62/10000 (0.6200%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   1, Avg loss: 0.0580, Accuracy: 410/1750 (23.4286%)
___Train Local_ResNet_18, epoch  90, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 684/1750 (39.0857%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.0315, Accuracy: 110/10000 (1.1000%)
___Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   1, Avg loss: 0.0771, Accuracy: 63/426 (14.7887%)
___Train Local_ResNet_18, epoch  90, local model 67, internal_epoch   2, Avg loss: 0.0410, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.6000, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0533, Accuracy: 316/1013 (31.1945%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 513/1013 (50.6417%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.8617, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   1, Avg loss: 0.0547, Accuracy: 392/1418 (27.6446%)
___Train Local_ResNet_18, epoch  90, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 662/1418 (46.6855%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.6985, Accuracy: 100/10000 (1.0000%)
___Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   1, Avg loss: 0.0621, Accuracy: 172/809 (21.2608%)
___Train Local_ResNet_18, epoch  90, local model 50, internal_epoch   2, Avg loss: 0.0267, Accuracy: 365/809 (45.1174%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.2722, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   1, Avg loss: 0.0619, Accuracy: 366/1003 (36.4905%)
___Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   2, Avg loss: 0.0342, Accuracy: 382/1003 (38.0857%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.8125, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   1, Avg loss: 0.0510, Accuracy: 353/1030 (34.2718%)
___Train Local_ResNet_18, epoch  90, local model 91, internal_epoch   2, Avg loss: 0.0272, Accuracy: 649/1030 (63.0097%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.6432, Accuracy: 80/10000 (0.8000%)
time spent on training: 212.08647465705872
[foolsgold agg] training data poison_ratio: 0.17766497461928935  data num: [946, 682, 773, 1750, 426, 1013, 1418, 809, 1003, 1030]
[foolsgold agg] considering poison per batch poison_fraction: 0.11104060913705584
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3091, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.5114, Accuracy: 0/9950 (0.0000%)
saving model
Done in 627.604761838913 sec.
Server Epoch:91 choose agents : [33, 37, 28, 92, 97, 43, 56, 44, 24, 64].
poison local model 33 index 12 
___Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   1, Avg loss: 0.0769, Accuracy: 71/515 (13.7864%)
___Train Local_ResNet_18, epoch  91, local model 33, internal_epoch   2, Avg loss: 0.0507, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.8029, Accuracy: 56/10000 (0.5600%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   1, Avg loss: 0.0512, Accuracy: 423/1129 (37.4668%)
___Train Local_ResNet_18, epoch  91, local model 37, internal_epoch   2, Avg loss: 0.0244, Accuracy: 716/1129 (63.4190%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.8609, Accuracy: 90/10000 (0.9000%)
___Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   1, Avg loss: 0.0557, Accuracy: 406/1581 (25.6799%)
___Train Local_ResNet_18, epoch  91, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 575/1581 (36.3694%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.5972, Accuracy: 95/10000 (0.9500%)
___Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   1, Avg loss: 0.0511, Accuracy: 482/1715 (28.1050%)
___Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 745/1715 (43.4402%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.5968, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   1, Avg loss: 0.0520, Accuracy: 372/1213 (30.6678%)
___Train Local_ResNet_18, epoch  91, local model 97, internal_epoch   2, Avg loss: 0.0271, Accuracy: 501/1213 (41.3026%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.7495, Accuracy: 76/10000 (0.7600%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   1, Avg loss: 0.0617, Accuracy: 306/946 (32.3467%)
___Train Local_ResNet_18, epoch  91, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 354/946 (37.4207%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.1758, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 1/186 (0.5376%)
___Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   2, Avg loss: 0.0671, Accuracy: 77/186 (41.3978%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3104, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 16 
___Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 408/1750 (23.3143%)
___Train Local_ResNet_18, epoch  91, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 676/1750 (38.6286%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.4514, Accuracy: 117/10000 (1.1700%)
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0751, Accuracy: 50/312 (16.0256%)
___Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0395, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3993, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   1, Avg loss: 0.0638, Accuracy: 180/953 (18.8877%)
___Train Local_ResNet_18, epoch  91, local model 64, internal_epoch   2, Avg loss: 0.0380, Accuracy: 322/953 (33.7880%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.6508, Accuracy: 54/10000 (0.5400%)
time spent on training: 250.75497150421143
[foolsgold agg] training data poison_ratio: 0.3598058252427184  data num: [515, 1129, 1581, 1715, 1213, 946, 186, 1750, 312, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.224878640776699
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3090, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.5105, Accuracy: 0/9950 (0.0000%)
saving model
Done in 666.367024898529 sec.
Server Epoch:92 choose agents : [71, 40, 7, 67, 97, 72, 34, 58, 26, 38].
___Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   1, Avg loss: 0.0638, Accuracy: 179/818 (21.8826%)
___Train Local_ResNet_18, epoch  92, local model 71, internal_epoch   2, Avg loss: 0.0301, Accuracy: 368/818 (44.9878%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.2060, Accuracy: 64/10000 (0.6400%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0544, Accuracy: 378/1573 (24.0305%)
___Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0343, Accuracy: 625/1573 (39.7330%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.2703, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   1, Avg loss: 0.0523, Accuracy: 360/891 (40.4040%)
___Train Local_ResNet_18, epoch  92, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 418/891 (46.9136%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.2049, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   1, Avg loss: 0.0769, Accuracy: 62/426 (14.5540%)
___Train Local_ResNet_18, epoch  92, local model 67, internal_epoch   2, Avg loss: 0.0416, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.5983, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   1, Avg loss: 0.0526, Accuracy: 357/1213 (29.4312%)
___Train Local_ResNet_18, epoch  92, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 484/1213 (39.9011%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.6062, Accuracy: 77/10000 (0.7700%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   1, Avg loss: 0.0599, Accuracy: 284/1241 (22.8848%)
___Train Local_ResNet_18, epoch  92, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 404/1241 (32.5544%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.2433, Accuracy: 54/10000 (0.5400%)
___Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   1, Avg loss: 0.0569, Accuracy: 386/1427 (27.0498%)
___Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 603/1427 (42.2565%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.8851, Accuracy: 68/10000 (0.6800%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0585, Accuracy: 343/803 (42.7148%)
___Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.0673, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 362/1446 (25.0346%)
___Train Local_ResNet_18, epoch  92, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 491/1446 (33.9557%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.4471, Accuracy: 77/10000 (0.7700%)
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   1, Avg loss: 0.0604, Accuracy: 254/1131 (22.4580%)
___Train Local_ResNet_18, epoch  92, local model 38, internal_epoch   2, Avg loss: 0.0299, Accuracy: 516/1131 (45.6233%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.0641, Accuracy: 82/10000 (0.8200%)
time spent on training: 229.2333836555481
[foolsgold agg] training data poison_ratio: 0.11313702251800528  data num: [818, 1573, 891, 426, 1213, 1241, 1427, 803, 1446, 1131]
[foolsgold agg] considering poison per batch poison_fraction: 0.0707106390737533
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3090, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.5109, Accuracy: 0/9950 (0.0000%)
saving model
Done in 644.031932592392 sec.
Server Epoch:93 choose agents : [62, 58, 59, 51, 15, 43, 3, 13, 79, 53].
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   1, Avg loss: 0.0686, Accuracy: 153/568 (26.9366%)
___Train Local_ResNet_18, epoch  93, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.8445, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 352/803 (43.8356%)
___Train Local_ResNet_18, epoch  93, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 380/803 (47.3225%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.9685, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0528, Accuracy: 330/1089 (30.3030%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 464/1089 (42.6079%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.3263, Accuracy: 74/10000 (0.7400%)
___Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   1, Avg loss: 0.0584, Accuracy: 241/1049 (22.9743%)
___Train Local_ResNet_18, epoch  93, local model 51, internal_epoch   2, Avg loss: 0.0287, Accuracy: 537/1049 (51.1916%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.5400, Accuracy: 67/10000 (0.6700%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0587, Accuracy: 334/1154 (28.9428%)
___Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0284, Accuracy: 474/1154 (41.0745%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.7722, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   1, Avg loss: 0.0613, Accuracy: 304/946 (32.1353%)
___Train Local_ResNet_18, epoch  93, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 361/946 (38.1607%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.0368, Accuracy: 73/10000 (0.7300%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   1, Avg loss: 0.0725, Accuracy: 117/781 (14.9808%)
___Train Local_ResNet_18, epoch  93, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 243/781 (31.1140%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 6.6576, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   1, Avg loss: 0.0570, Accuracy: 327/1645 (19.8784%)
___Train Local_ResNet_18, epoch  93, local model 13, internal_epoch   2, Avg loss: 0.0328, Accuracy: 614/1645 (37.3252%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.6921, Accuracy: 139/10000 (1.3900%)
___Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   1, Avg loss: 0.1009, Accuracy: 15/197 (7.6142%)
___Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   2, Avg loss: 0.0817, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3226, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   1, Avg loss: 0.0492, Accuracy: 299/813 (36.7774%)
___Train Local_ResNet_18, epoch  93, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 410/813 (50.4305%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.4611, Accuracy: 50/10000 (0.5000%)
time spent on training: 218.49805283546448
[foolsgold agg] training data poison_ratio: 0.21393034825870647  data num: [568, 803, 1089, 1049, 1154, 946, 781, 1645, 197, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.13370646766169153
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3089, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.5116, Accuracy: 0/9950 (0.0000%)
saving model
Done in 622.132580280304 sec.
Server Epoch:94 choose agents : [51, 3, 17, 5, 55, 92, 4, 75, 35, 60].
___Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   1, Avg loss: 0.0584, Accuracy: 243/1049 (23.1649%)
___Train Local_ResNet_18, epoch  94, local model 51, internal_epoch   2, Avg loss: 0.0300, Accuracy: 528/1049 (50.3337%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.4922, Accuracy: 74/10000 (0.7400%)
poison local model 3 index 1 
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0715, Accuracy: 124/781 (15.8771%)
___Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0360, Accuracy: 230/781 (29.4494%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.9359, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   1, Avg loss: 0.0508, Accuracy: 435/1574 (27.6366%)
___Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 686/1574 (43.5832%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.3546, Accuracy: 85/10000 (0.8500%)
poison local model 5 index 2 
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0497, Accuracy: 400/1628 (24.5700%)
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0256, Accuracy: 813/1628 (49.9386%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.4107, Accuracy: 114/10000 (1.1400%)
poison local model 55 index 20 
___Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   1, Avg loss: 0.0553, Accuracy: 253/1071 (23.6228%)
___Train Local_ResNet_18, epoch  94, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 519/1071 (48.4594%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.1060, Accuracy: 61/10000 (0.6100%)
___Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   1, Avg loss: 0.0515, Accuracy: 489/1715 (28.5131%)
___Train Local_ResNet_18, epoch  94, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 743/1715 (43.3236%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.5979, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   1, Avg loss: 0.0606, Accuracy: 337/901 (37.4029%)
___Train Local_ResNet_18, epoch  94, local model 4, internal_epoch   2, Avg loss: 0.0319, Accuracy: 406/901 (45.0610%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.8602, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   1, Avg loss: 0.0628, Accuracy: 264/776 (34.0206%)
___Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   2, Avg loss: 0.0288, Accuracy: 422/776 (54.3814%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.7204, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.0850, Accuracy: 51/271 (18.8192%)
___Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0540, Accuracy: 125/271 (46.1255%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3704, Accuracy: 49/10000 (0.4900%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   1, Avg loss: 0.0486, Accuracy: 611/2227 (27.4360%)
___Train Local_ResNet_18, epoch  94, local model 60, internal_epoch   2, Avg loss: 0.0276, Accuracy: 1074/2227 (48.2263%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.5470, Accuracy: 126/10000 (1.2600%)
time spent on training: 281.18673062324524
[foolsgold agg] training data poison_ratio: 0.47586091886934045  data num: [1049, 781, 1574, 1628, 1071, 1715, 901, 776, 271, 2227]
[foolsgold agg] considering poison per batch poison_fraction: 0.2974130742933378
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3089, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.5114, Accuracy: 0/9950 (0.0000%)
saving model
Done in 691.8985698223114 sec.
Server Epoch:95 choose agents : [54, 15, 1, 87, 63, 69, 60, 22, 43, 45].
poison local model 54 index 19 
___Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   1, Avg loss: 0.0540, Accuracy: 351/1130 (31.0619%)
___Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   2, Avg loss: 0.0282, Accuracy: 484/1130 (42.8319%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.6017, Accuracy: 51/10000 (0.5100%)
poison local model 15 index 6 
___Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   1, Avg loss: 0.0549, Accuracy: 343/1154 (29.7227%)
___Train Local_ResNet_18, epoch  95, local model 15, internal_epoch   2, Avg loss: 0.0282, Accuracy: 475/1154 (41.1612%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.0431, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 295/928 (31.7888%)
___Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0233, Accuracy: 570/928 (61.4224%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.8840, Accuracy: 89/10000 (0.8900%)
___Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   1, Avg loss: 0.0571, Accuracy: 305/1131 (26.9673%)
___Train Local_ResNet_18, epoch  95, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 411/1131 (36.3395%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.7166, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   1, Avg loss: 0.0545, Accuracy: 258/888 (29.0541%)
___Train Local_ResNet_18, epoch  95, local model 63, internal_epoch   2, Avg loss: 0.0260, Accuracy: 380/888 (42.7928%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.2461, Accuracy: 50/10000 (0.5000%)
poison local model 69 index 24 
___Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   1, Avg loss: 0.0560, Accuracy: 285/590 (48.3051%)
___Train Local_ResNet_18, epoch  95, local model 69, internal_epoch   2, Avg loss: 0.0327, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.4886, Accuracy: 50/10000 (0.5000%)
poison local model 60 index 21 
___Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 606/2227 (27.2115%)
___Train Local_ResNet_18, epoch  95, local model 60, internal_epoch   2, Avg loss: 0.0275, Accuracy: 1063/2227 (47.7324%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.9749, Accuracy: 125/10000 (1.2500%)
___Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   1, Avg loss: 0.0451, Accuracy: 558/1470 (37.9592%)
___Train Local_ResNet_18, epoch  95, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 885/1470 (60.2041%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.2758, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 312/946 (32.9810%)
___Train Local_ResNet_18, epoch  95, local model 43, internal_epoch   2, Avg loss: 0.0359, Accuracy: 350/946 (36.9979%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.1303, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   1, Avg loss: 0.0662, Accuracy: 212/669 (31.6891%)
___Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   2, Avg loss: 0.0405, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.8773, Accuracy: 50/10000 (0.5000%)
time spent on training: 266.03522086143494
[foolsgold agg] training data poison_ratio: 0.4581873708793677  data num: [1130, 1154, 928, 1131, 888, 590, 2227, 1470, 946, 669]
[foolsgold agg] considering poison per batch poison_fraction: 0.2863671067996048
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3090, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.5109, Accuracy: 0/9950 (0.0000%)
saving model
Done in 662.7150917053223 sec.
Server Epoch:96 choose agents : [12, 11, 52, 2, 65, 23, 68, 97, 82, 9].
poison local model 12 index 5 
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0861, Accuracy: 31/338 (9.1716%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0474, Accuracy: 157/338 (46.4497%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.4777, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1, Avg loss: 0.0569, Accuracy: 347/712 (48.7360%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2, Avg loss: 0.0236, Accuracy: 460/712 (64.6067%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.8227, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   1, Avg loss: 0.0563, Accuracy: 290/636 (45.5975%)
___Train Local_ResNet_18, epoch  96, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.3133, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0624, Accuracy: 228/605 (37.6860%)
___Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0398, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.8394, Accuracy: 61/10000 (0.6100%)
poison local model 65 index 23 
___Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   1, Avg loss: 0.0549, Accuracy: 416/1475 (28.2034%)
___Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   2, Avg loss: 0.0329, Accuracy: 698/1475 (47.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.0258, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   1, Avg loss: 0.0602, Accuracy: 327/715 (45.7343%)
___Train Local_ResNet_18, epoch  96, local model 23, internal_epoch   2, Avg loss: 0.0394, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.7461, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   1, Avg loss: 0.0626, Accuracy: 366/1163 (31.4703%)
___Train Local_ResNet_18, epoch  96, local model 68, internal_epoch   2, Avg loss: 0.0367, Accuracy: 417/1163 (35.8555%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.6761, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   1, Avg loss: 0.0523, Accuracy: 363/1213 (29.9258%)
___Train Local_ResNet_18, epoch  96, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 502/1213 (41.3850%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.8377, Accuracy: 83/10000 (0.8300%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1, Avg loss: 0.0754, Accuracy: 82/500 (16.4000%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2, Avg loss: 0.0481, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.7515, Accuracy: 49/10000 (0.4900%)
poison local model 9 index 3 
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0488, Accuracy: 377/1275 (29.5686%)
___Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0188, Accuracy: 741/1275 (58.1176%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.5118, Accuracy: 85/10000 (0.8500%)
time spent on training: 221.46266794204712
[foolsgold agg] training data poison_ratio: 0.3577386468952734  data num: [338, 712, 636, 605, 1475, 715, 1163, 1213, 500, 1275]
[foolsgold agg] considering poison per batch poison_fraction: 0.22358665430954588
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3089, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.5105, Accuracy: 0/9950 (0.0000%)
saving model
Done in 625.8792607784271 sec.
Server Epoch:97 choose agents : [80, 34, 72, 81, 41, 77, 71, 35, 7, 4].
___Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   1, Avg loss: 0.0689, Accuracy: 155/682 (22.7273%)
___Train Local_ResNet_18, epoch  97, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 249/682 (36.5103%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.6412, Accuracy: 62/10000 (0.6200%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0572, Accuracy: 386/1427 (27.0498%)
___Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 584/1427 (40.9250%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.0697, Accuracy: 50/10000 (0.5000%)
poison local model 72 index 25 
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0607, Accuracy: 260/1241 (20.9508%)
___Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 430/1241 (34.6495%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.3283, Accuracy: 72/10000 (0.7200%)
poison local model 81 index 28 
___Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   1, Avg loss: 0.0680, Accuracy: 248/774 (32.0413%)
___Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   2, Avg loss: 0.0337, Accuracy: 323/774 (41.7313%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.3694, Accuracy: 72/10000 (0.7200%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0599, Accuracy: 334/719 (46.4534%)
___Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0317, Accuracy: 453/719 (63.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.4604, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   1, Avg loss: 0.0530, Accuracy: 345/1340 (25.7463%)
___Train Local_ResNet_18, epoch  97, local model 77, internal_epoch   2, Avg loss: 0.0272, Accuracy: 527/1340 (39.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.0458, Accuracy: 73/10000 (0.7300%)
___Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   1, Avg loss: 0.0636, Accuracy: 191/818 (23.3496%)
___Train Local_ResNet_18, epoch  97, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 323/818 (39.4866%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.3235, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0841, Accuracy: 42/271 (15.4982%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0540, Accuracy: 108/271 (39.8524%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3775, Accuracy: 44/10000 (0.4400%)
___Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   1, Avg loss: 0.0536, Accuracy: 356/891 (39.9551%)
___Train Local_ResNet_18, epoch  97, local model 7, internal_epoch   2, Avg loss: 0.0259, Accuracy: 446/891 (50.0561%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.9898, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   1, Avg loss: 0.0638, Accuracy: 330/901 (36.6260%)
___Train Local_ResNet_18, epoch  97, local model 4, internal_epoch   2, Avg loss: 0.0313, Accuracy: 400/901 (44.3951%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.7569, Accuracy: 51/10000 (0.5100%)
time spent on training: 216.63190913200378
[foolsgold agg] training data poison_ratio: 0.2223080317740512  data num: [682, 1427, 1241, 774, 719, 1340, 818, 271, 891, 901]
[foolsgold agg] considering poison per batch poison_fraction: 0.138942519858782
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3088, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.5108, Accuracy: 0/9950 (0.0000%)
saving model
Done in 624.8396182060242 sec.
Server Epoch:98 choose agents : [24, 6, 1, 16, 62, 2, 87, 17, 43, 18].
poison local model 24 index 9 
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1, Avg loss: 0.0754, Accuracy: 46/312 (14.7436%)
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2, Avg loss: 0.0393, Accuracy: 170/312 (54.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3980, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   1, Avg loss: 0.0540, Accuracy: 411/1956 (21.0123%)
___Train Local_ResNet_18, epoch  98, local model 6, internal_epoch   2, Avg loss: 0.0314, Accuracy: 661/1956 (33.7935%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.1119, Accuracy: 116/10000 (1.1600%)
___Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   1, Avg loss: 0.0556, Accuracy: 290/928 (31.2500%)
___Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   2, Avg loss: 0.0237, Accuracy: 591/928 (63.6853%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.7878, Accuracy: 86/10000 (0.8600%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0590, Accuracy: 294/708 (41.5254%)
___Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0392, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.0965, Accuracy: 57/10000 (0.5700%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0683, Accuracy: 157/568 (27.6408%)
___Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0406, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.8142, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   1, Avg loss: 0.0617, Accuracy: 228/605 (37.6860%)
___Train Local_ResNet_18, epoch  98, local model 2, internal_epoch   2, Avg loss: 0.0412, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.8623, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0570, Accuracy: 304/1131 (26.8789%)
___Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 439/1131 (38.8152%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.3059, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   1, Avg loss: 0.0505, Accuracy: 396/1574 (25.1588%)
___Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   2, Avg loss: 0.0268, Accuracy: 687/1574 (43.6468%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.0563, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   1, Avg loss: 0.0615, Accuracy: 309/946 (32.6638%)
___Train Local_ResNet_18, epoch  98, local model 43, internal_epoch   2, Avg loss: 0.0353, Accuracy: 353/946 (37.3150%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.1623, Accuracy: 62/10000 (0.6200%)
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   1, Avg loss: 0.0761, Accuracy: 129/530 (24.3396%)
___Train Local_ResNet_18, epoch  98, local model 18, internal_epoch   2, Avg loss: 0.0376, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.2416, Accuracy: 62/10000 (0.6200%)
time spent on training: 221.1196985244751
[foolsgold agg] training data poison_ratio: 0.09094836897818104  data num: [312, 1956, 928, 708, 568, 605, 1131, 1574, 946, 530]
[foolsgold agg] considering poison per batch poison_fraction: 0.05684273061136315
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3088, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.5109, Accuracy: 0/9950 (0.0000%)
saving model
Done in 624.9517920017242 sec.
Server Epoch:99 choose agents : [18, 14, 2, 45, 63, 95, 90, 4, 23, 8].
poison local model 18 index 7 
___Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   1, Avg loss: 0.0748, Accuracy: 131/530 (24.7170%)
___Train Local_ResNet_18, epoch  99, local model 18, internal_epoch   2, Avg loss: 0.0379, Accuracy: 272/530 (51.3208%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.2689, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   1, Avg loss: 0.0612, Accuracy: 226/1013 (22.3100%)
___Train Local_ResNet_18, epoch  99, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 352/1013 (34.7483%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.7873, Accuracy: 70/10000 (0.7000%)
___Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 238/605 (39.3388%)
___Train Local_ResNet_18, epoch  99, local model 2, internal_epoch   2, Avg loss: 0.0391, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.8681, Accuracy: 51/10000 (0.5100%)
___Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   1, Avg loss: 0.0668, Accuracy: 207/669 (30.9417%)
___Train Local_ResNet_18, epoch  99, local model 45, internal_epoch   2, Avg loss: 0.0395, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.9036, Accuracy: 53/10000 (0.5300%)
___Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   1, Avg loss: 0.0543, Accuracy: 273/888 (30.7432%)
___Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 421/888 (47.4099%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.4345, Accuracy: 55/10000 (0.5500%)
poison local model 95 index 31 
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0538, Accuracy: 331/599 (55.2588%)
___Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0285, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.8124, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   1, Avg loss: 0.0549, Accuracy: 328/677 (48.4490%)
___Train Local_ResNet_18, epoch  99, local model 90, internal_epoch   2, Avg loss: 0.0242, Accuracy: 402/677 (59.3796%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.3844, Accuracy: 55/10000 (0.5500%)
___Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   1, Avg loss: 0.0604, Accuracy: 336/901 (37.2919%)
___Train Local_ResNet_18, epoch  99, local model 4, internal_epoch   2, Avg loss: 0.0313, Accuracy: 409/901 (45.3940%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.7552, Accuracy: 52/10000 (0.5200%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   1, Avg loss: 0.0591, Accuracy: 327/715 (45.7343%)
___Train Local_ResNet_18, epoch  99, local model 23, internal_epoch   2, Avg loss: 0.0403, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.8489, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   1, Avg loss: 0.0591, Accuracy: 245/1513 (16.1930%)
___Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 471/1513 (31.1302%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.4579, Accuracy: 109/10000 (1.0900%)
time spent on training: 206.66302943229675
[foolsgold agg] training data poison_ratio: 0.13921085080147966  data num: [530, 1013, 605, 669, 888, 599, 677, 901, 715, 1513]
[foolsgold agg] considering poison per batch poison_fraction: 0.08700678175092479
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3088, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.5117, Accuracy: 0/9950 (0.0000%)
saving model
Done in 603.854085445404 sec.
Server Epoch:100 choose agents : [57, 53, 36, 10, 37, 13, 40, 62, 39, 80].
___Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   1, Avg loss: 0.0542, Accuracy: 307/1154 (26.6031%)
___Train Local_ResNet_18, epoch 100, local model 57, internal_epoch   2, Avg loss: 0.0264, Accuracy: 486/1154 (42.1144%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.2773, Accuracy: 79/10000 (0.7900%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0494, Accuracy: 284/813 (34.9323%)
___Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 466/813 (57.3186%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.7476, Accuracy: 50/10000 (0.5000%)
poison local model 36 index 13 
___Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   1, Avg loss: 0.0850, Accuracy: 89/408 (21.8137%)
___Train Local_ResNet_18, epoch 100, local model 36, internal_epoch   2, Avg loss: 0.0516, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.5099, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 4 
___Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   1, Avg loss: 0.0567, Accuracy: 215/861 (24.9710%)
___Train Local_ResNet_18, epoch 100, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 455/861 (52.8455%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.9010, Accuracy: 56/10000 (0.5600%)
poison local model 37 index 14 
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   1, Avg loss: 0.0509, Accuracy: 427/1129 (37.8211%)
___Train Local_ResNet_18, epoch 100, local model 37, internal_epoch   2, Avg loss: 0.0238, Accuracy: 754/1129 (66.7848%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.3462, Accuracy: 92/10000 (0.9200%)
___Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   1, Avg loss: 0.0572, Accuracy: 318/1645 (19.3313%)
___Train Local_ResNet_18, epoch 100, local model 13, internal_epoch   2, Avg loss: 0.0322, Accuracy: 650/1645 (39.5137%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.8506, Accuracy: 123/10000 (1.2300%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 333/1573 (21.1697%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2, Avg loss: 0.0343, Accuracy: 619/1573 (39.3516%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.4124, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   1, Avg loss: 0.0683, Accuracy: 154/568 (27.1127%)
___Train Local_ResNet_18, epoch 100, local model 62, internal_epoch   2, Avg loss: 0.0412, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.7994, Accuracy: 59/10000 (0.5900%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 315/1013 (31.0958%)
___Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 497/1013 (49.0622%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.4660, Accuracy: 85/10000 (0.8500%)
___Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   1, Avg loss: 0.0687, Accuracy: 153/682 (22.4340%)
___Train Local_ResNet_18, epoch 100, local model 80, internal_epoch   2, Avg loss: 0.0381, Accuracy: 232/682 (34.0176%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.4452, Accuracy: 52/10000 (0.5200%)
time spent on training: 241.53115916252136
[foolsgold agg] training data poison_ratio: 0.2435506804793825  data num: [1154, 813, 408, 861, 1129, 1645, 1573, 568, 1013, 682]
[foolsgold agg] considering poison per batch poison_fraction: 0.15221917529961407
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3087, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.5122, Accuracy: 0/9950 (0.0000%)
saving model
Done in 648.6078748703003 sec.
Saving all the graphs.
This run has a label: Jun.18_07.29.14. Visdom environment: tiny
