current path: saved_models/model_tiny_Jun.27_22.33.09
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95, 5, 10, 15, 25, 30, 37, 44, 49, 55, 61, 65, 85]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [98, 0, 77, 44, 66, 67, 33, 25, 19, 92].
_Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   1, Avg loss: 0.0833, Accuracy: 13/373 (3.4853%)
_Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   2, Avg loss: 0.0496, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.4303, Accuracy: 50/10000 (0.5000%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   1, Avg loss: 0.0586, Accuracy: 386/1657 (23.2951%)
_Train Local_ResNet_18, epoch   1, local model 0, internal_epoch   2, Avg loss: 0.0353, Accuracy: 479/1657 (28.9077%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5756, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   1, Avg loss: 0.0543, Accuracy: 308/1340 (22.9851%)
_Train Local_ResNet_18, epoch   1, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 581/1340 (43.3582%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7141, Accuracy: 77/10000 (0.7700%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   1, Avg loss: 0.0594, Accuracy: 376/1750 (21.4857%)
_Train Local_ResNet_18, epoch   1, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 647/1750 (36.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.8678, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   1, Avg loss: 0.0624, Accuracy: 248/1402 (17.6890%)
_Train Local_ResNet_18, epoch   1, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 360/1402 (25.6776%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.2832, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   1, Avg loss: 0.0794, Accuracy: 48/426 (11.2676%)
_Train Local_ResNet_18, epoch   1, local model 67, internal_epoch   2, Avg loss: 0.0421, Accuracy: 174/426 (40.8451%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.5961, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   1, Avg loss: 0.0802, Accuracy: 56/515 (10.8738%)
_Train Local_ResNet_18, epoch   1, local model 33, internal_epoch   2, Avg loss: 0.0542, Accuracy: 130/515 (25.2427%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.6849, Accuracy: 51/10000 (0.5100%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   1, Avg loss: 0.0576, Accuracy: 295/690 (42.7536%)
_Train Local_ResNet_18, epoch   1, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.2717, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 390/1036 (37.6448%)
_Train Local_ResNet_18, epoch   1, local model 19, internal_epoch   2, Avg loss: 0.0251, Accuracy: 650/1036 (62.7413%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 9.0152, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 471/1715 (27.4636%)
_Train Local_ResNet_18, epoch   1, local model 92, internal_epoch   2, Avg loss: 0.0307, Accuracy: 721/1715 (42.0408%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6826, Accuracy: 86/10000 (0.8600%)
time spent on training: 131.67643308639526
[rfa agg] training data poison_ratio: 0.37573367571533384  data num: [373, 1657, 1340, 1750, 1402, 426, 515, 690, 1036, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.11741677366104182
[rfa agg] init. name: [98, 0, 77, 44, 66, 67, 33, 25, 19, 92], weight: tensor([0.0342, 0.1520, 0.1229, 0.1605, 0.1286, 0.0391, 0.0472, 0.0633, 0.0950,
        0.1573])
[rfa agg] iter:  0, prev_obj_val: 60.820064544677734, obj_val: 62.746971130371094, abs dis: 1.9269065856933594
[rfa agg] iter: 0, weight: tensor([0.0129, 0.0951, 0.2188, 0.0796, 0.1692, 0.0160, 0.0235, 0.0397, 0.2585,
        0.0866])
[rfa agg] iter:  1, prev_obj_val: 62.746971130371094, obj_val: 62.73796081542969, abs dis: 0.00901031494140625
[rfa agg] iter: 1, weight: tensor([0.0128, 0.0851, 0.1790, 0.0722, 0.1423, 0.0159, 0.0236, 0.0405, 0.3506,
        0.0780])
[rfa agg] iter:  2, prev_obj_val: 62.73796081542969, obj_val: 62.73786163330078, abs dis: 9.918212890625e-05
[rfa agg] iter: 2, weight: tensor([0.0126, 0.0839, 0.1760, 0.0712, 0.1402, 0.0157, 0.0233, 0.0400, 0.3603,
        0.0769])
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3002, Accuracy: 38/10000 (0.3800%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.3452, Accuracy: 0/9950 (0.0000%)
saving model
Done in 382.05861830711365 sec.
Server Epoch:2 choose agents : [77, 57, 52, 28, 29, 61, 99, 34, 8, 85].
_Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   1, Avg loss: 0.0521, Accuracy: 344/1340 (25.6716%)
_Train Local_ResNet_18, epoch   2, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 546/1340 (40.7463%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.8497, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   1, Avg loss: 0.0570, Accuracy: 300/1154 (25.9965%)
_Train Local_ResNet_18, epoch   2, local model 57, internal_epoch   2, Avg loss: 0.0263, Accuracy: 480/1154 (41.5945%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.2649, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 279/636 (43.8679%)
_Train Local_ResNet_18, epoch   2, local model 52, internal_epoch   2, Avg loss: 0.0321, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.4165, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 381/1581 (24.0987%)
_Train Local_ResNet_18, epoch   2, local model 28, internal_epoch   2, Avg loss: 0.0338, Accuracy: 581/1581 (36.7489%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.4749, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0495, Accuracy: 412/1440 (28.6111%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 684/1440 (47.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 8.0495, Accuracy: 65/10000 (0.6500%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   1, Avg loss: 0.1258, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   2, local model 61, internal_epoch   2, Avg loss: 0.1183, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3064, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   1, Avg loss: 0.0656, Accuracy: 171/773 (22.1216%)
_Train Local_ResNet_18, epoch   2, local model 99, internal_epoch   2, Avg loss: 0.0317, Accuracy: 407/773 (52.6520%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.2513, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   1, Avg loss: 0.0589, Accuracy: 369/1427 (25.8584%)
_Train Local_ResNet_18, epoch   2, local model 34, internal_epoch   2, Avg loss: 0.0334, Accuracy: 574/1427 (40.2242%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.7911, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   1, Avg loss: 0.0605, Accuracy: 223/1513 (14.7389%)
_Train Local_ResNet_18, epoch   2, local model 8, internal_epoch   2, Avg loss: 0.0370, Accuracy: 508/1513 (33.5757%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.3593, Accuracy: 102/10000 (1.0200%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   1, Avg loss: 0.0547, Accuracy: 446/1988 (22.4346%)
_Train Local_ResNet_18, epoch   2, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 677/1988 (34.0543%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.8444, Accuracy: 80/10000 (0.8000%)
time spent on training: 155.70199584960938
[rfa agg] training data poison_ratio: 0.17366172405126917  data num: [1340, 1154, 636, 1581, 1440, 85, 773, 1427, 1513, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.05426928876602162
[rfa agg] init. name: [77, 57, 52, 28, 29, 61, 99, 34, 8, 85], weight: tensor([0.1123, 0.0967, 0.0533, 0.1324, 0.1206, 0.0071, 0.0648, 0.1195, 0.1267,
        0.1665])
[rfa agg] iter:  0, prev_obj_val: 45.710968017578125, obj_val: 47.905799865722656, abs dis: 2.1948318481445312
[rfa agg] iter: 0, weight: tensor([0.3028, 0.1595, 0.0149, 0.0849, 0.1329, 0.0011, 0.0253, 0.1324, 0.1036,
        0.0426])
[rfa agg] iter:  1, prev_obj_val: 47.905799865722656, obj_val: 50.38451385498047, abs dis: 2.4787139892578125
[rfa agg] iter: 1, weight: tensor([0.2762, 0.2228, 0.0164, 0.0802, 0.1180, 0.0012, 0.0284, 0.1184, 0.0956,
        0.0428])
[rfa agg] iter:  2, prev_obj_val: 50.38451385498047, obj_val: 56.019840240478516, abs dis: 5.635326385498047
[rfa agg] iter: 2, weight: tensor([0.2117, 0.3193, 0.0179, 0.0756, 0.1059, 0.0013, 0.0315, 0.1060, 0.0883,
        0.0425])
[rfa agg] iter:  3, prev_obj_val: 56.019840240478516, obj_val: 53.01998519897461, abs dis: 2.9998550415039062
[rfa agg] iter: 3, weight: tensor([0.1525, 0.3959, 0.0224, 0.0723, 0.0941, 0.0015, 0.0417, 0.0937, 0.0817,
        0.0442])
[rfa agg] iter:  4, prev_obj_val: 53.01998519897461, obj_val: 56.00653839111328, abs dis: 2.986553192138672
[rfa agg] iter: 4, weight: tensor([0.1505, 0.4496, 0.0175, 0.0645, 0.0868, 0.0012, 0.0316, 0.0865, 0.0739,
        0.0379])
[rfa agg] iter:  5, prev_obj_val: 56.00653839111328, obj_val: 53.014991760253906, abs dis: 2.991546630859375
[rfa agg] iter: 5, weight: tensor([0.1428, 0.4297, 0.0212, 0.0685, 0.0890, 0.0014, 0.0395, 0.0887, 0.0774,
        0.0419])
[rfa agg] iter:  6, prev_obj_val: 53.014991760253906, obj_val: 56.007591247558594, abs dis: 2.9925994873046875
[rfa agg] iter: 6, weight: tensor([0.1462, 0.4643, 0.0170, 0.0628, 0.0845, 0.0012, 0.0308, 0.0842, 0.0720,
        0.0369])
[rfa agg] iter:  7, prev_obj_val: 56.007591247558594, obj_val: 53.01454544067383, abs dis: 2.9930458068847656
[rfa agg] iter: 7, weight: tensor([0.1417, 0.4336, 0.0211, 0.0680, 0.0884, 0.0014, 0.0392, 0.0881, 0.0769,
        0.0417])
[rfa agg] iter:  8, prev_obj_val: 53.01454544067383, obj_val: 56.00775146484375, abs dis: 2.993206024169922
[rfa agg] iter: 8, weight: tensor([0.1456, 0.4660, 0.0170, 0.0626, 0.0842, 0.0012, 0.0307, 0.0839, 0.0718,
        0.0368])
[rfa agg] iter:  9, prev_obj_val: 56.00775146484375, obj_val: 53.014495849609375, abs dis: 2.993255615234375
[rfa agg] iter: 9, weight: tensor([0.1416, 0.4340, 0.0211, 0.0680, 0.0884, 0.0014, 0.0392, 0.0880, 0.0768,
        0.0416])
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.2999, Accuracy: 35/10000 (0.3500%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.3202, Accuracy: 0/9950 (0.0000%)
saving model
Done in 405.74508476257324 sec.
Server Epoch:3 choose agents : [89, 70, 9, 99, 37, 17, 4, 82, 30, 13].
_Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   1, Avg loss: 0.0611, Accuracy: 329/896 (36.7188%)
_Train Local_ResNet_18, epoch   3, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.2317, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0560, Accuracy: 339/1418 (23.9069%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0320, Accuracy: 573/1418 (40.4090%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0649, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   1, Avg loss: 0.0493, Accuracy: 357/1275 (28.0000%)
_Train Local_ResNet_18, epoch   3, local model 9, internal_epoch   2, Avg loss: 0.0192, Accuracy: 706/1275 (55.3725%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 9.3905, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   1, Avg loss: 0.0663, Accuracy: 175/773 (22.6391%)
_Train Local_ResNet_18, epoch   3, local model 99, internal_epoch   2, Avg loss: 0.0314, Accuracy: 405/773 (52.3933%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.4964, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   1, Avg loss: 0.0533, Accuracy: 378/1129 (33.4810%)
_Train Local_ResNet_18, epoch   3, local model 37, internal_epoch   2, Avg loss: 0.0256, Accuracy: 699/1129 (61.9132%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.4761, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 417/1574 (26.4930%)
_Train Local_ResNet_18, epoch   3, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 675/1574 (42.8844%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0083, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0639, Accuracy: 324/901 (35.9600%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0333, Accuracy: 400/901 (44.3951%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.1198, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   1, Avg loss: 0.0775, Accuracy: 66/500 (13.2000%)
_Train Local_ResNet_18, epoch   3, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 179/500 (35.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.6902, Accuracy: 56/10000 (0.5600%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   1, Avg loss: 0.0811, Accuracy: 66/486 (13.5802%)
_Train Local_ResNet_18, epoch   3, local model 30, internal_epoch   2, Avg loss: 0.0421, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.8195, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 304/1645 (18.4802%)
_Train Local_ResNet_18, epoch   3, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 626/1645 (38.0547%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 8.0918, Accuracy: 106/10000 (1.0600%)
time spent on training: 150.24593567848206
[rfa agg] training data poison_ratio: 0.1524016231008776  data num: [896, 1418, 1275, 773, 1129, 1574, 901, 500, 486, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.04762550721902425
[rfa agg] init. name: [89, 70, 9, 99, 37, 17, 4, 82, 30, 13], weight: tensor([0.0846, 0.1338, 0.1203, 0.0729, 0.1065, 0.1485, 0.0850, 0.0472, 0.0459,
        0.1552])
[rfa agg] iter:  0, prev_obj_val: 50.90766143798828, obj_val: 52.33733367919922, abs dis: 1.4296722412109375
[rfa agg] iter: 0, weight: tensor([0.1237, 0.0792, 0.1298, 0.0787, 0.2246, 0.0677, 0.1907, 0.0215, 0.0209,
        0.0632])
[rfa agg] iter:  1, prev_obj_val: 52.33733367919922, obj_val: 53.89966583251953, abs dis: 1.5623321533203125
[rfa agg] iter: 1, weight: tensor([0.1442, 0.0705, 0.1094, 0.0872, 0.1797, 0.0612, 0.2471, 0.0218, 0.0212,
        0.0575])
[rfa agg] iter:  2, prev_obj_val: 53.89966583251953, obj_val: 60.17036437988281, abs dis: 6.270698547363281
[rfa agg] iter: 2, weight: tensor([0.1641, 0.0592, 0.0878, 0.0929, 0.1326, 0.0522, 0.3207, 0.0209, 0.0204,
        0.0493])
[rfa agg] iter:  3, prev_obj_val: 60.17036437988281, obj_val: 60.10842514038086, abs dis: 0.061939239501953125
[rfa agg] iter: 3, weight: tensor([0.3044, 0.0447, 0.0600, 0.1712, 0.0779, 0.0408, 0.2155, 0.0235, 0.0229,
        0.0390])
[rfa agg] iter:  4, prev_obj_val: 60.10842514038086, obj_val: 69.249267578125, abs dis: 9.14084243774414
[rfa agg] iter: 4, weight: tensor([0.3500, 0.0421, 0.0565, 0.1662, 0.0731, 0.0384, 0.1933, 0.0222, 0.0216,
        0.0367])
[rfa agg] iter:  5, prev_obj_val: 69.249267578125, obj_val: 65.87518310546875, abs dis: 3.37408447265625
[rfa agg] iter: 5, weight: tensor([0.2032, 0.0497, 0.0624, 0.3121, 0.0744, 0.0465, 0.1272, 0.0403, 0.0393,
        0.0449])
[rfa agg] iter:  6, prev_obj_val: 65.87518310546875, obj_val: 72.71131134033203, abs dis: 6.836128234863281
[rfa agg] iter: 6, weight: tensor([0.2092, 0.0418, 0.0535, 0.3722, 0.0654, 0.0388, 0.1238, 0.0292, 0.0285,
        0.0374])
[rfa agg] iter:  7, prev_obj_val: 72.71131134033203, obj_val: 69.2071533203125, abs dis: 3.5041580200195312
[rfa agg] iter: 7, weight: tensor([0.1788, 0.0551, 0.0679, 0.2888, 0.0794, 0.0519, 0.1244, 0.0524, 0.0511,
        0.0503])
[rfa agg] iter:  8, prev_obj_val: 69.2071533203125, obj_val: 65.8721694946289, abs dis: 3.3349838256835938
[rfa agg] iter: 8, weight: tensor([0.1885, 0.0481, 0.0603, 0.3430, 0.0720, 0.0449, 0.1227, 0.0391, 0.0381,
        0.0435])
[rfa agg] iter:  9, prev_obj_val: 65.8721694946289, obj_val: 72.71265411376953, abs dis: 6.840484619140625
[rfa agg] iter: 9, weight: tensor([0.2040, 0.0412, 0.0527, 0.3841, 0.0644, 0.0382, 0.1218, 0.0288, 0.0280,
        0.0368])
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3013, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.3415, Accuracy: 0/9950 (0.0000%)
saving model
Done in 410.9588601589203 sec.
Server Epoch:4 choose agents : [24, 77, 38, 89, 8, 28, 48, 62, 16, 76].
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0772, Accuracy: 27/312 (8.6538%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0409, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.4438, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0519, Accuracy: 333/1340 (24.8507%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0265, Accuracy: 565/1340 (42.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.7641, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   1, Avg loss: 0.0621, Accuracy: 246/1131 (21.7507%)
_Train Local_ResNet_18, epoch   4, local model 38, internal_epoch   2, Avg loss: 0.0307, Accuracy: 496/1131 (43.8550%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.4168, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 339/896 (37.8348%)
_Train Local_ResNet_18, epoch   4, local model 89, internal_epoch   2, Avg loss: 0.0325, Accuracy: 467/896 (52.1205%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.3178, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   1, Avg loss: 0.0600, Accuracy: 253/1513 (16.7217%)
_Train Local_ResNet_18, epoch   4, local model 8, internal_epoch   2, Avg loss: 0.0366, Accuracy: 487/1513 (32.1877%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.4909, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   1, Avg loss: 0.0566, Accuracy: 384/1581 (24.2884%)
_Train Local_ResNet_18, epoch   4, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 602/1581 (38.0772%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.5738, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   1, Avg loss: 0.0716, Accuracy: 97/631 (15.3724%)
_Train Local_ResNet_18, epoch   4, local model 48, internal_epoch   2, Avg loss: 0.0413, Accuracy: 211/631 (33.4390%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.0541, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   1, Avg loss: 0.0696, Accuracy: 136/568 (23.9437%)
_Train Local_ResNet_18, epoch   4, local model 62, internal_epoch   2, Avg loss: 0.0414, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.8485, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   1, Avg loss: 0.0645, Accuracy: 277/708 (39.1243%)
_Train Local_ResNet_18, epoch   4, local model 16, internal_epoch   2, Avg loss: 0.0357, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.8921, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   1, Avg loss: 0.0853, Accuracy: 51/466 (10.9442%)
_Train Local_ResNet_18, epoch   4, local model 76, internal_epoch   2, Avg loss: 0.0480, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.7567, Accuracy: 50/10000 (0.5000%)
time spent on training: 127.32022309303284
[rfa agg] training data poison_ratio: 0.0  data num: [312, 1340, 1131, 896, 1513, 1581, 631, 568, 708, 466]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [24, 77, 38, 89, 8, 28, 48, 62, 16, 76], weight: tensor([0.0341, 0.1465, 0.1237, 0.0980, 0.1654, 0.1729, 0.0690, 0.0621, 0.0774,
        0.0510])
[rfa agg] iter:  0, prev_obj_val: 56.33534622192383, obj_val: 58.581050872802734, abs dis: 2.2457046508789062
[rfa agg] iter: 0, weight: tensor([0.0143, 0.1025, 0.1678, 0.3267, 0.0776, 0.0730, 0.0580, 0.0436, 0.1058,
        0.0307])
[rfa agg] iter:  1, prev_obj_val: 58.581050872802734, obj_val: 61.994991302490234, abs dis: 3.4139404296875
[rfa agg] iter: 1, weight: tensor([0.0114, 0.0634, 0.0923, 0.5104, 0.0502, 0.0478, 0.0518, 0.0375, 0.1096,
        0.0257])
[rfa agg] iter:  2, prev_obj_val: 61.994991302490234, obj_val: 63.847938537597656, abs dis: 1.8529472351074219
[rfa agg] iter: 2, weight: tensor([0.0154, 0.0667, 0.0892, 0.3306, 0.0549, 0.0527, 0.0819, 0.0559, 0.2159,
        0.0369])
[rfa agg] iter:  3, prev_obj_val: 63.847938537597656, obj_val: 68.17481231689453, abs dis: 4.326873779296875
[rfa agg] iter: 3, weight: tensor([0.0162, 0.0617, 0.0798, 0.2184, 0.0516, 0.0496, 0.0962, 0.0626, 0.3238,
        0.0402])
[rfa agg] iter:  4, prev_obj_val: 68.17481231689453, obj_val: 70.64921569824219, abs dis: 2.4744033813476562
[rfa agg] iter: 4, weight: tensor([0.0181, 0.0539, 0.0661, 0.1322, 0.0463, 0.0448, 0.1493, 0.0843, 0.3551,
        0.0499])
[rfa agg] iter:  5, prev_obj_val: 70.64921569824219, obj_val: 70.63903045654297, abs dis: 0.01018524169921875
[rfa agg] iter: 5, weight: tensor([0.0208, 0.0543, 0.0651, 0.1173, 0.0472, 0.0458, 0.2230, 0.1103, 0.2548,
        0.0614])
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3033, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.3493, Accuracy: 0/9950 (0.0000%)
saving model
Done in 389.24613857269287 sec.
Server Epoch:5 choose agents : [73, 49, 66, 2, 62, 24, 56, 25, 10, 97].
_Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   1, Avg loss: 0.0658, Accuracy: 175/938 (18.6567%)
_Train Local_ResNet_18, epoch   5, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 326/938 (34.7548%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.6316, Accuracy: 51/10000 (0.5100%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   1, Avg loss: 0.0804, Accuracy: 25/440 (5.6818%)
_Train Local_ResNet_18, epoch   5, local model 49, internal_epoch   2, Avg loss: 0.0482, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.6615, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   1, Avg loss: 0.0612, Accuracy: 258/1402 (18.4023%)
_Train Local_ResNet_18, epoch   5, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 381/1402 (27.1755%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.4745, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 234/605 (38.6777%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0399, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.9541, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0688, Accuracy: 151/568 (26.5845%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0409, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.8840, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   1, Avg loss: 0.0775, Accuracy: 32/312 (10.2564%)
_Train Local_ResNet_18, epoch   5, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.4679, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   1, Avg loss: 0.0827, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch   5, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 68/186 (36.5591%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3267, Accuracy: 50/10000 (0.5000%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   1, Avg loss: 0.0575, Accuracy: 304/690 (44.0580%)
_Train Local_ResNet_18, epoch   5, local model 25, internal_epoch   2, Avg loss: 0.0262, Accuracy: 465/690 (67.3913%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.6103, Accuracy: 55/10000 (0.5500%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   1, Avg loss: 0.0579, Accuracy: 203/861 (23.5772%)
_Train Local_ResNet_18, epoch   5, local model 10, internal_epoch   2, Avg loss: 0.0213, Accuracy: 436/861 (50.6388%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.2082, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   1, Avg loss: 0.0531, Accuracy: 365/1213 (30.0907%)
_Train Local_ResNet_18, epoch   5, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 496/1213 (40.8904%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.5116, Accuracy: 90/10000 (0.9000%)
time spent on training: 159.83977484703064
[rfa agg] training data poison_ratio: 0.27595287595287593  data num: [938, 440, 1402, 605, 568, 312, 186, 690, 861, 1213]
[rfa agg] considering poison per batch poison_fraction: 0.08623527373527373
[rfa agg] init. name: [73, 49, 66, 2, 62, 24, 56, 25, 10, 97], weight: tensor([0.1300, 0.0610, 0.1943, 0.0839, 0.0787, 0.0432, 0.0258, 0.0956, 0.1193,
        0.1681])
[rfa agg] iter:  0, prev_obj_val: 46.27713394165039, obj_val: 50.21907043457031, abs dis: 3.941936492919922
[rfa agg] iter: 0, weight: tensor([0.1346, 0.0389, 0.0622, 0.1289, 0.0829, 0.0197, 0.0090, 0.2677, 0.1795,
        0.0767])
[rfa agg] iter:  1, prev_obj_val: 50.21907043457031, obj_val: 54.634151458740234, abs dis: 4.415081024169922
[rfa agg] iter: 1, weight: tensor([0.0663, 0.0399, 0.0392, 0.2593, 0.1137, 0.0180, 0.0078, 0.3320, 0.0780,
        0.0458])
[rfa agg] iter:  2, prev_obj_val: 54.634151458740234, obj_val: 63.65861511230469, abs dis: 9.024463653564453
[rfa agg] iter: 2, weight: tensor([0.0572, 0.0579, 0.0379, 0.2993, 0.2576, 0.0230, 0.0094, 0.1505, 0.0640,
        0.0431])
[rfa agg] iter:  3, prev_obj_val: 63.65861511230469, obj_val: 63.636810302734375, abs dis: 0.0218048095703125
[rfa agg] iter: 3, weight: tensor([0.0651, 0.1872, 0.0489, 0.1447, 0.2539, 0.0487, 0.0173, 0.1108, 0.0696,
        0.0538])
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3052, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.3466, Accuracy: 0/9950 (0.0000%)
saving model
Done in 407.73152017593384 sec.
Server Epoch:6 choose agents : [50, 99, 30, 37, 67, 0, 63, 39, 52, 44].
_Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   1, Avg loss: 0.0626, Accuracy: 165/809 (20.3956%)
_Train Local_ResNet_18, epoch   6, local model 50, internal_epoch   2, Avg loss: 0.0280, Accuracy: 347/809 (42.8925%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.3681, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   1, Avg loss: 0.0612, Accuracy: 204/773 (26.3907%)
_Train Local_ResNet_18, epoch   6, local model 99, internal_epoch   2, Avg loss: 0.0322, Accuracy: 407/773 (52.6520%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.3735, Accuracy: 61/10000 (0.6100%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   1, Avg loss: 0.0809, Accuracy: 72/486 (14.8148%)
_Train Local_ResNet_18, epoch   6, local model 30, internal_epoch   2, Avg loss: 0.0413, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.2023, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   1, Avg loss: 0.0518, Accuracy: 422/1129 (37.3782%)
_Train Local_ResNet_18, epoch   6, local model 37, internal_epoch   2, Avg loss: 0.0247, Accuracy: 728/1129 (64.4818%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.4962, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   1, Avg loss: 0.0790, Accuracy: 50/426 (11.7371%)
_Train Local_ResNet_18, epoch   6, local model 67, internal_epoch   2, Avg loss: 0.0433, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.7940, Accuracy: 51/10000 (0.5100%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 370/1657 (22.3295%)
_Train Local_ResNet_18, epoch   6, local model 0, internal_epoch   2, Avg loss: 0.0348, Accuracy: 512/1657 (30.8992%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.7037, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 266/888 (29.9550%)
_Train Local_ResNet_18, epoch   6, local model 63, internal_epoch   2, Avg loss: 0.0253, Accuracy: 426/888 (47.9730%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 8.2061, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   1, Avg loss: 0.0547, Accuracy: 312/1013 (30.7996%)
_Train Local_ResNet_18, epoch   6, local model 39, internal_epoch   2, Avg loss: 0.0264, Accuracy: 457/1013 (45.1135%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.5716, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   1, Avg loss: 0.0568, Accuracy: 283/636 (44.4969%)
_Train Local_ResNet_18, epoch   6, local model 52, internal_epoch   2, Avg loss: 0.0308, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.5632, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0596, Accuracy: 418/1750 (23.8857%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 665/1750 (38.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.7941, Accuracy: 101/10000 (1.0100%)
time spent on training: 174.38296604156494
[rfa agg] training data poison_ratio: 0.5249294449670743  data num: [809, 773, 486, 1129, 426, 1657, 888, 1013, 636, 1750]
[rfa agg] considering poison per batch poison_fraction: 0.1640404515522107
[rfa agg] init. name: [50, 99, 30, 37, 67, 0, 63, 39, 52, 44], weight: tensor([0.0846, 0.0808, 0.0508, 0.1180, 0.0445, 0.1732, 0.0928, 0.1059, 0.0665,
        0.1829])
[rfa agg] iter:  0, prev_obj_val: 55.51337432861328, obj_val: 59.96836471557617, abs dis: 4.454990386962891
[rfa agg] iter: 0, weight: tensor([0.0742, 0.0713, 0.0188, 0.1991, 0.0147, 0.0572, 0.1123, 0.3706, 0.0320,
        0.0500])
[rfa agg] iter:  1, prev_obj_val: 59.96836471557617, obj_val: 66.91987609863281, abs dis: 6.951511383056641
[rfa agg] iter: 1, weight: tensor([0.2130, 0.2153, 0.0227, 0.0637, 0.0169, 0.0343, 0.2537, 0.1031, 0.0459,
        0.0313])
[rfa agg] iter:  2, prev_obj_val: 66.91987609863281, obj_val: 66.90816497802734, abs dis: 0.01171112060546875
[rfa agg] iter: 2, weight: tensor([0.2306, 0.2268, 0.0408, 0.0630, 0.0287, 0.0403, 0.1460, 0.0849, 0.1016,
        0.0373])
[rfa agg] iter:  3, prev_obj_val: 66.90816497802734, obj_val: 64.08929443359375, abs dis: 2.8188705444335938
[rfa agg] iter: 3, weight: tensor([0.2309, 0.2285, 0.0408, 0.0628, 0.0286, 0.0402, 0.1442, 0.0846, 0.1022,
        0.0372])
[rfa agg] iter:  4, prev_obj_val: 64.08929443359375, obj_val: 69.85785675048828, abs dis: 5.768562316894531
[rfa agg] iter: 4, weight: tensor([0.2667, 0.2757, 0.0289, 0.0543, 0.0207, 0.0331, 0.1475, 0.0764, 0.0663,
        0.0305])
[rfa agg] iter:  5, prev_obj_val: 69.85785675048828, obj_val: 72.83584594726562, abs dis: 2.9779891967773438
[rfa agg] iter: 5, weight: tensor([0.1955, 0.1900, 0.0534, 0.0670, 0.0365, 0.0447, 0.1351, 0.0870, 0.1493,
        0.0415])
[rfa agg] iter:  6, prev_obj_val: 72.83584594726562, obj_val: 66.92887878417969, abs dis: 5.9069671630859375
[rfa agg] iter: 6, weight: tensor([0.1588, 0.1539, 0.0656, 0.0660, 0.0434, 0.0457, 0.1201, 0.0831, 0.2208,
        0.0426])
[rfa agg] iter:  7, prev_obj_val: 66.92887878417969, obj_val: 66.90818786621094, abs dis: 0.02069091796875
[rfa agg] iter: 7, weight: tensor([0.2254, 0.2271, 0.0413, 0.0635, 0.0290, 0.0406, 0.1452, 0.0855, 0.1049,
        0.0376])
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3074, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.3621, Accuracy: 0/9950 (0.0000%)
saving model
Done in 428.7028307914734 sec.
Server Epoch:7 choose agents : [66, 72, 39, 28, 82, 63, 93, 98, 12, 10].
_Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   1, Avg loss: 0.0611, Accuracy: 271/1402 (19.3295%)
_Train Local_ResNet_18, epoch   7, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 396/1402 (28.2454%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.2073, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   1, Avg loss: 0.0630, Accuracy: 237/1241 (19.0975%)
_Train Local_ResNet_18, epoch   7, local model 72, internal_epoch   2, Avg loss: 0.0362, Accuracy: 412/1241 (33.1990%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.2939, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   1, Avg loss: 0.0535, Accuracy: 319/1013 (31.4906%)
_Train Local_ResNet_18, epoch   7, local model 39, internal_epoch   2, Avg loss: 0.0259, Accuracy: 500/1013 (49.3583%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.8639, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   1, Avg loss: 0.0562, Accuracy: 394/1581 (24.9209%)
_Train Local_ResNet_18, epoch   7, local model 28, internal_epoch   2, Avg loss: 0.0334, Accuracy: 596/1581 (37.6977%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.5576, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   1, Avg loss: 0.0771, Accuracy: 59/500 (11.8000%)
_Train Local_ResNet_18, epoch   7, local model 82, internal_epoch   2, Avg loss: 0.0484, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.9412, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   1, Avg loss: 0.0534, Accuracy: 278/888 (31.3063%)
_Train Local_ResNet_18, epoch   7, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 454/888 (51.1261%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.5621, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   1, Avg loss: 0.0546, Accuracy: 441/1742 (25.3157%)
_Train Local_ResNet_18, epoch   7, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 727/1742 (41.7336%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4558, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   1, Avg loss: 0.0821, Accuracy: 23/373 (6.1662%)
_Train Local_ResNet_18, epoch   7, local model 98, internal_epoch   2, Avg loss: 0.0477, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6204, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   1, Avg loss: 0.0840, Accuracy: 25/338 (7.3964%)
_Train Local_ResNet_18, epoch   7, local model 12, internal_epoch   2, Avg loss: 0.0451, Accuracy: 142/338 (42.0118%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.5622, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0579, Accuracy: 205/861 (23.8095%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0214, Accuracy: 454/861 (52.7294%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.4707, Accuracy: 50/10000 (0.5000%)
time spent on training: 151.76871347427368
[rfa agg] training data poison_ratio: 0.08662843344400845  data num: [1402, 1241, 1013, 1581, 500, 888, 1742, 373, 338, 861]
[rfa agg] considering poison per batch poison_fraction: 0.02707138545125264
[rfa agg] init. name: [66, 72, 39, 28, 82, 63, 93, 98, 12, 10], weight: tensor([0.1411, 0.1249, 0.1019, 0.1591, 0.0503, 0.0893, 0.1753, 0.0375, 0.0340,
        0.0866])
[rfa agg] iter:  0, prev_obj_val: 56.92926788330078, obj_val: 57.98927688598633, abs dis: 1.0600090026855469
[rfa agg] iter: 0, weight: tensor([0.0914, 0.1256, 0.3728, 0.0672, 0.0213, 0.1234, 0.0549, 0.0129, 0.0117,
        0.1189])
[rfa agg] iter:  1, prev_obj_val: 57.98927688598633, obj_val: 61.39799880981445, abs dis: 3.408721923828125
[rfa agg] iter: 1, weight: tensor([0.0652, 0.0860, 0.4906, 0.0493, 0.0176, 0.1177, 0.0409, 0.0105, 0.0095,
        0.1129])
[rfa agg] iter:  2, prev_obj_val: 61.39799880981445, obj_val: 63.29182815551758, abs dis: 1.893829345703125
[rfa agg] iter: 2, weight: tensor([0.0628, 0.0775, 0.2904, 0.0498, 0.0225, 0.2219, 0.0423, 0.0131, 0.0118,
        0.2078])
[rfa agg] iter:  3, prev_obj_val: 63.29182815551758, obj_val: 65.53453826904297, abs dis: 2.2427101135253906
[rfa agg] iter: 3, weight: tensor([0.0529, 0.0637, 0.1764, 0.0427, 0.0218, 0.3047, 0.0367, 0.0125, 0.0113,
        0.2774])
[rfa agg] iter:  4, prev_obj_val: 65.53453826904297, obj_val: 71.52803039550781, abs dis: 5.993492126464844
[rfa agg] iter: 4, weight: tensor([0.0430, 0.0508, 0.1170, 0.0354, 0.0205, 0.3638, 0.0307, 0.0115, 0.0104,
        0.3170])
[rfa agg] iter:  5, prev_obj_val: 71.52803039550781, obj_val: 68.36260986328125, abs dis: 3.1654205322265625
[rfa agg] iter: 5, weight: tensor([0.0596, 0.0678, 0.1254, 0.0506, 0.0381, 0.2972, 0.0446, 0.0204, 0.0184,
        0.2779])
[rfa agg] iter:  6, prev_obj_val: 68.36260986328125, obj_val: 65.5253677368164, abs dis: 2.8372421264648438
[rfa agg] iter: 6, weight: tensor([0.0489, 0.0566, 0.1151, 0.0409, 0.0269, 0.3379, 0.0358, 0.0148, 0.0134,
        0.3097])
[rfa agg] iter:  7, prev_obj_val: 65.5253677368164, obj_val: 71.52870178222656, abs dis: 6.003334045410156
[rfa agg] iter: 7, weight: tensor([0.0421, 0.0497, 0.1134, 0.0347, 0.0200, 0.3671, 0.0301, 0.0112, 0.0102,
        0.3215])
[rfa agg] iter:  8, prev_obj_val: 71.52870178222656, obj_val: 68.36259460449219, abs dis: 3.166107177734375
[rfa agg] iter: 8, weight: tensor([0.0596, 0.0678, 0.1253, 0.0505, 0.0380, 0.2972, 0.0446, 0.0203, 0.0184,
        0.2781])
[rfa agg] iter:  9, prev_obj_val: 68.36259460449219, obj_val: 65.5253677368164, abs dis: 2.8372268676757812
[rfa agg] iter: 9, weight: tensor([0.0489, 0.0566, 0.1151, 0.0409, 0.0269, 0.3378, 0.0358, 0.0148, 0.0134,
        0.3097])
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3099, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.3810, Accuracy: 0/9950 (0.0000%)
saving model
Done in 410.11998748779297 sec.
Server Epoch:8 choose agents : [77, 28, 16, 1, 70, 34, 54, 21, 14, 75].
_Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   1, Avg loss: 0.0504, Accuracy: 355/1340 (26.4925%)
_Train Local_ResNet_18, epoch   8, local model 77, internal_epoch   2, Avg loss: 0.0262, Accuracy: 603/1340 (45.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.1458, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   1, Avg loss: 0.0558, Accuracy: 388/1581 (24.5414%)
_Train Local_ResNet_18, epoch   8, local model 28, internal_epoch   2, Avg loss: 0.0336, Accuracy: 569/1581 (35.9899%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.6891, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   1, Avg loss: 0.0607, Accuracy: 290/708 (40.9605%)
_Train Local_ResNet_18, epoch   8, local model 16, internal_epoch   2, Avg loss: 0.0380, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.9455, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0574, Accuracy: 290/928 (31.2500%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0248, Accuracy: 512/928 (55.1724%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.3369, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 382/1418 (26.9394%)
_Train Local_ResNet_18, epoch   8, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 654/1418 (46.1213%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.7845, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   1, Avg loss: 0.0579, Accuracy: 386/1427 (27.0498%)
_Train Local_ResNet_18, epoch   8, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 601/1427 (42.1163%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.1018, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   1, Avg loss: 0.0555, Accuracy: 345/1130 (30.5310%)
_Train Local_ResNet_18, epoch   8, local model 54, internal_epoch   2, Avg loss: 0.0295, Accuracy: 438/1130 (38.7611%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.8457, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 406/1949 (20.8312%)
_Train Local_ResNet_18, epoch   8, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 611/1949 (31.3494%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.6099, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   1, Avg loss: 0.0623, Accuracy: 226/1013 (22.3100%)
_Train Local_ResNet_18, epoch   8, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 337/1013 (33.2675%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.8800, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   1, Avg loss: 0.0671, Accuracy: 249/776 (32.0876%)
_Train Local_ResNet_18, epoch   8, local model 75, internal_epoch   2, Avg loss: 0.0292, Accuracy: 405/776 (52.1907%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.0712, Accuracy: 50/10000 (0.5000%)
time spent on training: 149.88524627685547
[rfa agg] training data poison_ratio: 0.0  data num: [1340, 1581, 708, 928, 1418, 1427, 1130, 1949, 1013, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [77, 28, 16, 1, 70, 34, 54, 21, 14, 75], weight: tensor([0.1092, 0.1289, 0.0577, 0.0756, 0.1156, 0.1163, 0.0921, 0.1588, 0.0826,
        0.0632])
[rfa agg] iter:  0, prev_obj_val: 48.00701141357422, obj_val: 54.197750091552734, abs dis: 6.190738677978516
[rfa agg] iter: 0, weight: tensor([0.1823, 0.0775, 0.0300, 0.0676, 0.1024, 0.1034, 0.2532, 0.0482, 0.0972,
        0.0382])
[rfa agg] iter:  1, prev_obj_val: 54.197750091552734, obj_val: 60.983638763427734, abs dis: 6.785888671875
[rfa agg] iter: 1, weight: tensor([0.0910, 0.0544, 0.0388, 0.1184, 0.0646, 0.0651, 0.2554, 0.0384, 0.2210,
        0.0529])
[rfa agg] iter:  2, prev_obj_val: 60.983638763427734, obj_val: 63.76622009277344, abs dis: 2.782581329345703
[rfa agg] iter: 2, weight: tensor([0.0602, 0.0414, 0.0495, 0.2456, 0.0468, 0.0472, 0.1087, 0.0313, 0.2949,
        0.0745])
[rfa agg] iter:  3, prev_obj_val: 63.76622009277344, obj_val: 66.86515808105469, abs dis: 3.09893798828125
[rfa agg] iter: 3, weight: tensor([0.0553, 0.0394, 0.0573, 0.3327, 0.0440, 0.0443, 0.0907, 0.0304, 0.2143,
        0.0916])
[rfa agg] iter:  4, prev_obj_val: 66.86515808105469, obj_val: 60.95403289794922, abs dis: 5.911125183105469
[rfa agg] iter: 4, weight: tensor([0.0559, 0.0411, 0.0745, 0.3238, 0.0453, 0.0457, 0.0859, 0.0323, 0.1668,
        0.1287])
[rfa agg] iter:  5, prev_obj_val: 60.95403289794922, obj_val: 63.7559700012207, abs dis: 2.8019371032714844
[rfa agg] iter: 5, weight: tensor([0.0581, 0.0400, 0.0480, 0.2866, 0.0453, 0.0456, 0.1035, 0.0303, 0.2700,
        0.0726])
[rfa agg] iter:  6, prev_obj_val: 63.7559700012207, obj_val: 66.86499786376953, abs dis: 3.109027862548828
[rfa agg] iter: 6, weight: tensor([0.0543, 0.0387, 0.0564, 0.3470, 0.0432, 0.0436, 0.0891, 0.0299, 0.2078,
        0.0900])
[rfa agg] iter:  7, prev_obj_val: 66.86499786376953, obj_val: 63.74810791015625, abs dis: 3.1168899536132812
[rfa agg] iter: 7, weight: tensor([0.0557, 0.0409, 0.0742, 0.3269, 0.0452, 0.0455, 0.0856, 0.0321, 0.1658,
        0.1281])
[rfa agg] iter:  8, prev_obj_val: 63.74810791015625, obj_val: 66.86538696289062, abs dis: 3.117279052734375
[rfa agg] iter: 8, weight: tensor([0.0530, 0.0378, 0.0551, 0.3711, 0.0422, 0.0425, 0.0870, 0.0292, 0.1937,
        0.0885])
[rfa agg] iter:  9, prev_obj_val: 66.86538696289062, obj_val: 63.7476921081543, abs dis: 3.117694854736328
[rfa agg] iter: 9, weight: tensor([0.0553, 0.0406, 0.0737, 0.3323, 0.0449, 0.0452, 0.0850, 0.0319, 0.1639,
        0.1271])
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3124, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.3975, Accuracy: 0/9950 (0.0000%)
saving model
Done in 407.20771169662476 sec.
Server Epoch:9 choose agents : [45, 99, 72, 16, 74, 61, 62, 90, 43, 25].
_Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   1, Avg loss: 0.0654, Accuracy: 229/669 (34.2302%)
_Train Local_ResNet_18, epoch   9, local model 45, internal_epoch   2, Avg loss: 0.0403, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.0052, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   1, Avg loss: 0.0606, Accuracy: 218/773 (28.2018%)
_Train Local_ResNet_18, epoch   9, local model 99, internal_epoch   2, Avg loss: 0.0313, Accuracy: 417/773 (53.9457%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.6736, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   1, Avg loss: 0.0615, Accuracy: 231/1241 (18.6140%)
_Train Local_ResNet_18, epoch   9, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 424/1241 (34.1660%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.4403, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   1, Avg loss: 0.0592, Accuracy: 303/708 (42.7966%)
_Train Local_ResNet_18, epoch   9, local model 16, internal_epoch   2, Avg loss: 0.0383, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.1108, Accuracy: 71/10000 (0.7100%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   1, Avg loss: 0.0440, Accuracy: 454/1552 (29.2526%)
_Train Local_ResNet_18, epoch   9, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 789/1552 (50.8376%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 11.7269, Accuracy: 89/10000 (0.8900%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1267, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1167, Accuracy: 8/85 (9.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3254, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   1, Avg loss: 0.0671, Accuracy: 157/568 (27.6408%)
_Train Local_ResNet_18, epoch   9, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.1619, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 321/677 (47.4151%)
_Train Local_ResNet_18, epoch   9, local model 90, internal_epoch   2, Avg loss: 0.0235, Accuracy: 451/677 (66.6174%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.9114, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   1, Avg loss: 0.0618, Accuracy: 303/946 (32.0296%)
_Train Local_ResNet_18, epoch   9, local model 43, internal_epoch   2, Avg loss: 0.0362, Accuracy: 315/946 (33.2981%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.1709, Accuracy: 79/10000 (0.7900%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   1, Avg loss: 0.0552, Accuracy: 312/690 (45.2174%)
_Train Local_ResNet_18, epoch   9, local model 25, internal_epoch   2, Avg loss: 0.0266, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.9424, Accuracy: 73/10000 (0.7300%)
time spent on training: 160.04762315750122
[rfa agg] training data poison_ratio: 0.2942217726640536  data num: [669, 773, 1241, 708, 1552, 85, 568, 677, 946, 690]
[rfa agg] considering poison per batch poison_fraction: 0.09194430395751674
[rfa agg] init. name: [45, 99, 72, 16, 74, 61, 62, 90, 43, 25], weight: tensor([0.0846, 0.0977, 0.1569, 0.0895, 0.1962, 0.0107, 0.0718, 0.0856, 0.1196,
        0.0872])
[rfa agg] iter:  0, prev_obj_val: 43.32752990722656, obj_val: 58.09065628051758, abs dis: 14.763126373291016
[rfa agg] iter: 0, weight: tensor([0.0877, 0.3260, 0.0481, 0.1616, 0.0353, 0.0021, 0.0385, 0.0893, 0.1216,
        0.0898])
[rfa agg] iter:  1, prev_obj_val: 58.09065628051758, obj_val: 58.00354766845703, abs dis: 0.08710861206054688
[rfa agg] iter: 1, weight: tensor([0.1427, 0.0751, 0.0403, 0.0944, 0.0343, 0.0038, 0.2588, 0.1464, 0.0586,
        0.1457])
[rfa agg] iter:  2, prev_obj_val: 58.00354766845703, obj_val: 54.353759765625, abs dis: 3.6497879028320312
[rfa agg] iter: 2, weight: tensor([0.1383, 0.0711, 0.0385, 0.0900, 0.0327, 0.0036, 0.2879, 0.1411, 0.0558,
        0.1411])
[rfa agg] iter:  3, prev_obj_val: 54.353759765625, obj_val: 61.857666015625, abs dis: 7.50390625
[rfa agg] iter: 3, weight: tensor([0.1778, 0.0751, 0.0368, 0.1008, 0.0308, 0.0031, 0.1577, 0.1828, 0.0558,
        0.1794])
[rfa agg] iter:  4, prev_obj_val: 61.857666015625, obj_val: 61.81116485595703, abs dis: 0.04650115966796875
[rfa agg] iter: 4, weight: tensor([0.1078, 0.0633, 0.0373, 0.0767, 0.0321, 0.0039, 0.4064, 0.1098, 0.0519,
        0.1107])
[rfa agg] iter:  5, prev_obj_val: 61.81116485595703, obj_val: 58.022422790527344, abs dis: 3.7887420654296875
[rfa agg] iter: 5, weight: tensor([0.0920, 0.0542, 0.0319, 0.0657, 0.0275, 0.0034, 0.4932, 0.0934, 0.0445,
        0.0941])
[rfa agg] iter:  6, prev_obj_val: 58.022422790527344, obj_val: 65.98765563964844, abs dis: 7.965232849121094
[rfa agg] iter: 6, weight: tensor([0.1331, 0.0688, 0.0373, 0.0870, 0.0317, 0.0035, 0.3146, 0.1351, 0.0540,
        0.1350])
[rfa agg] iter:  7, prev_obj_val: 65.98765563964844, obj_val: 65.98542022705078, abs dis: 0.00223541259765625
[rfa agg] iter: 7, weight: tensor([0.1078, 0.0699, 0.0442, 0.0819, 0.0386, 0.0052, 0.3728, 0.1094, 0.0594,
        0.1107])
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3147, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.4124, Accuracy: 0/9950 (0.0000%)
saving model
Done in 416.03334879875183 sec.
Server Epoch:10 choose agents : [84, 18, 67, 52, 95, 36, 68, 49, 61, 7].
_Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   1, Avg loss: 0.0638, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  10, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 456/1190 (38.3193%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.5301, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   1, Avg loss: 0.0743, Accuracy: 132/530 (24.9057%)
_Train Local_ResNet_18, epoch  10, local model 18, internal_epoch   2, Avg loss: 0.0393, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.7158, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   1, Avg loss: 0.0785, Accuracy: 55/426 (12.9108%)
_Train Local_ResNet_18, epoch  10, local model 67, internal_epoch   2, Avg loss: 0.0431, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.9421, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 287/636 (45.1258%)
_Train Local_ResNet_18, epoch  10, local model 52, internal_epoch   2, Avg loss: 0.0304, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.7966, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   1, Avg loss: 0.0510, Accuracy: 337/599 (56.2604%)
_Train Local_ResNet_18, epoch  10, local model 95, internal_epoch   2, Avg loss: 0.0331, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 9.2157, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   1, Avg loss: 0.0878, Accuracy: 69/408 (16.9118%)
_Train Local_ResNet_18, epoch  10, local model 36, internal_epoch   2, Avg loss: 0.0538, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.6992, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   1, Avg loss: 0.0618, Accuracy: 378/1163 (32.5021%)
_Train Local_ResNet_18, epoch  10, local model 68, internal_epoch   2, Avg loss: 0.0373, Accuracy: 431/1163 (37.0593%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.8778, Accuracy: 69/10000 (0.6900%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   1, Avg loss: 0.0779, Accuracy: 35/440 (7.9545%)
_Train Local_ResNet_18, epoch  10, local model 49, internal_epoch   2, Avg loss: 0.0467, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.8081, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   1, Avg loss: 0.1259, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 61, internal_epoch   2, Avg loss: 0.1159, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3283, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   1, Avg loss: 0.0537, Accuracy: 359/891 (40.2918%)
_Train Local_ResNet_18, epoch  10, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 450/891 (50.5051%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.4884, Accuracy: 52/10000 (0.5200%)
time spent on training: 160.5678322315216
[rfa agg] training data poison_ratio: 0.1765075376884422  data num: [1190, 530, 426, 636, 599, 408, 1163, 440, 85, 891]
[rfa agg] considering poison per batch poison_fraction: 0.05515860552763819
[rfa agg] init. name: [84, 18, 67, 52, 95, 36, 68, 49, 61, 7], weight: tensor([0.1869, 0.0832, 0.0669, 0.0999, 0.0941, 0.0641, 0.1826, 0.0691, 0.0133,
        0.1399])
[rfa agg] iter:  0, prev_obj_val: 44.781524658203125, obj_val: 53.899383544921875, abs dis: 9.11785888671875
[rfa agg] iter: 0, weight: tensor([0.0402, 0.2132, 0.0534, 0.2288, 0.2519, 0.0514, 0.0393, 0.0553, 0.0036,
        0.0631])
[rfa agg] iter:  1, prev_obj_val: 53.899383544921875, obj_val: 60.64097213745117, abs dis: 6.741588592529297
[rfa agg] iter: 1, weight: tensor([0.0342, 0.1119, 0.1992, 0.0819, 0.0781, 0.1981, 0.0334, 0.2130, 0.0050,
        0.0452])
[rfa agg] iter:  2, prev_obj_val: 60.64097213745117, obj_val: 53.80659484863281, abs dis: 6.834377288818359
[rfa agg] iter: 2, weight: tensor([0.0321, 0.0704, 0.2293, 0.0601, 0.0572, 0.2274, 0.0313, 0.2460, 0.0062,
        0.0399])
[rfa agg] iter:  3, prev_obj_val: 53.80659484863281, obj_val: 60.63909912109375, abs dis: 6.8325042724609375
[rfa agg] iter: 3, weight: tensor([0.0314, 0.1023, 0.2100, 0.0743, 0.0714, 0.2085, 0.0307, 0.2253, 0.0046,
        0.0415])
[rfa agg] iter:  4, prev_obj_val: 60.63909912109375, obj_val: 53.80665969848633, abs dis: 6.832439422607422
[rfa agg] iter: 4, weight: tensor([0.0319, 0.0701, 0.2298, 0.0598, 0.0569, 0.2278, 0.0312, 0.2466, 0.0061,
        0.0397])
[rfa agg] iter:  5, prev_obj_val: 53.80665969848633, obj_val: 60.63908767700195, abs dis: 6.832427978515625
[rfa agg] iter: 5, weight: tensor([0.0314, 0.1023, 0.2100, 0.0743, 0.0714, 0.2085, 0.0307, 0.2253, 0.0046,
        0.0415])
[rfa agg] iter:  6, prev_obj_val: 60.63908767700195, obj_val: 53.80665969848633, abs dis: 6.832427978515625
[rfa agg] iter: 6, weight: tensor([0.0319, 0.0701, 0.2298, 0.0598, 0.0569, 0.2278, 0.0312, 0.2466, 0.0061,
        0.0397])
[rfa agg] iter:  7, prev_obj_val: 53.80665969848633, obj_val: 60.63908767700195, abs dis: 6.832427978515625
[rfa agg] iter: 7, weight: tensor([0.0314, 0.1023, 0.2100, 0.0743, 0.0714, 0.2085, 0.0307, 0.2253, 0.0046,
        0.0415])
[rfa agg] iter:  8, prev_obj_val: 60.63908767700195, obj_val: 53.80665969848633, abs dis: 6.832427978515625
[rfa agg] iter: 8, weight: tensor([0.0319, 0.0701, 0.2298, 0.0598, 0.0569, 0.2278, 0.0312, 0.2466, 0.0061,
        0.0397])
[rfa agg] iter:  9, prev_obj_val: 53.80665969848633, obj_val: 60.63908767700195, abs dis: 6.832427978515625
[rfa agg] iter: 9, weight: tensor([0.0314, 0.1023, 0.2100, 0.0743, 0.0714, 0.2085, 0.0307, 0.2253, 0.0046,
        0.0415])
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3169, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.4280, Accuracy: 0/9950 (0.0000%)
saving model
Done in 404.2354612350464 sec.
Server Epoch:11 choose agents : [29, 92, 35, 7, 25, 14, 74, 13, 32, 17].
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 416/1440 (28.8889%)
_Train Local_ResNet_18, epoch  11, local model 29, internal_epoch   2, Avg loss: 0.0275, Accuracy: 685/1440 (47.5694%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.4386, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   1, Avg loss: 0.0515, Accuracy: 485/1715 (28.2799%)
_Train Local_ResNet_18, epoch  11, local model 92, internal_epoch   2, Avg loss: 0.0303, Accuracy: 748/1715 (43.6152%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.6370, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   1, Avg loss: 0.0873, Accuracy: 39/271 (14.3911%)
_Train Local_ResNet_18, epoch  11, local model 35, internal_epoch   2, Avg loss: 0.0560, Accuracy: 109/271 (40.2214%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.5520, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   1, Avg loss: 0.0539, Accuracy: 349/891 (39.1695%)
_Train Local_ResNet_18, epoch  11, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 451/891 (50.6173%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.4529, Accuracy: 51/10000 (0.5100%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0536, Accuracy: 320/690 (46.3768%)
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0271, Accuracy: 464/690 (67.2464%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.1462, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0616, Accuracy: 230/1013 (22.7048%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 310/1013 (30.6022%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.0438, Accuracy: 66/10000 (0.6600%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 475/1552 (30.6057%)
_Train Local_ResNet_18, epoch  11, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 776/1552 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 11.2115, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   1, Avg loss: 0.0571, Accuracy: 361/1645 (21.9453%)
_Train Local_ResNet_18, epoch  11, local model 13, internal_epoch   2, Avg loss: 0.0329, Accuracy: 637/1645 (38.7234%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.8879, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   1, Avg loss: 0.0612, Accuracy: 210/735 (28.5714%)
_Train Local_ResNet_18, epoch  11, local model 32, internal_epoch   2, Avg loss: 0.0227, Accuracy: 333/735 (45.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 9.1560, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   1, Avg loss: 0.0514, Accuracy: 394/1574 (25.0318%)
_Train Local_ResNet_18, epoch  11, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 664/1574 (42.1855%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.6850, Accuracy: 106/10000 (1.0600%)
time spent on training: 170.01781940460205
[rfa agg] training data poison_ratio: 0.19451674475099776  data num: [1440, 1715, 271, 891, 690, 1013, 1552, 1645, 735, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.0607864827346868
[rfa agg] init. name: [29, 92, 35, 7, 25, 14, 74, 13, 32, 17], weight: tensor([0.1249, 0.1488, 0.0235, 0.0773, 0.0599, 0.0879, 0.1347, 0.1427, 0.0638,
        0.1366])
[rfa agg] iter:  0, prev_obj_val: 56.28194808959961, obj_val: 57.936561584472656, abs dis: 1.6546134948730469
[rfa agg] iter: 0, weight: tensor([0.1738, 0.1051, 0.0095, 0.0868, 0.0424, 0.1619, 0.1260, 0.1149, 0.0516,
        0.1280])
[rfa agg] iter:  1, prev_obj_val: 57.936561584472656, obj_val: 59.607582092285156, abs dis: 1.6710205078125
[rfa agg] iter: 1, weight: tensor([0.1561, 0.0993, 0.0099, 0.0965, 0.0454, 0.1937, 0.1169, 0.1076, 0.0557,
        0.1188])
[rfa agg] iter:  2, prev_obj_val: 59.607582092285156, obj_val: 59.60612106323242, abs dis: 0.001461029052734375
[rfa agg] iter: 2, weight: tensor([0.1380, 0.0919, 0.0101, 0.1060, 0.0476, 0.2337, 0.1065, 0.0989, 0.0591,
        0.1082])
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3198, Accuracy: 58/10000 (0.5800%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.4273, Accuracy: 0/9950 (0.0000%)
saving model
Done in 427.96424889564514 sec.
Server Epoch:12 choose agents : [43, 94, 30, 38, 40, 20, 75, 61, 26, 17].
_Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   1, Avg loss: 0.0608, Accuracy: 309/946 (32.6638%)
_Train Local_ResNet_18, epoch  12, local model 43, internal_epoch   2, Avg loss: 0.0351, Accuracy: 353/946 (37.3150%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.4357, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 341/1662 (20.5174%)
_Train Local_ResNet_18, epoch  12, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 625/1662 (37.6053%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.4801, Accuracy: 103/10000 (1.0300%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   1, Avg loss: 0.0790, Accuracy: 81/486 (16.6667%)
_Train Local_ResNet_18, epoch  12, local model 30, internal_epoch   2, Avg loss: 0.0402, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.4898, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   1, Avg loss: 0.0598, Accuracy: 273/1131 (24.1379%)
_Train Local_ResNet_18, epoch  12, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 503/1131 (44.4739%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.7470, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 349/1573 (22.1869%)
_Train Local_ResNet_18, epoch  12, local model 40, internal_epoch   2, Avg loss: 0.0352, Accuracy: 524/1573 (33.3121%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.5926, Accuracy: 63/10000 (0.6300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   1, Avg loss: 0.0576, Accuracy: 337/807 (41.7596%)
_Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 411/807 (50.9294%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.5438, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   1, Avg loss: 0.0636, Accuracy: 258/776 (33.2474%)
_Train Local_ResNet_18, epoch  12, local model 75, internal_epoch   2, Avg loss: 0.0304, Accuracy: 391/776 (50.3866%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.6215, Accuracy: 51/10000 (0.5100%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   1, Avg loss: 0.1254, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  12, local model 61, internal_epoch   2, Avg loss: 0.1174, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3344, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   1, Avg loss: 0.0550, Accuracy: 345/1446 (23.8589%)
_Train Local_ResNet_18, epoch  12, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 513/1446 (35.4772%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.3420, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   1, Avg loss: 0.0505, Accuracy: 404/1574 (25.6671%)
_Train Local_ResNet_18, epoch  12, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 665/1574 (42.2490%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.4216, Accuracy: 110/10000 (1.1000%)
time spent on training: 172.5514166355133
[rfa agg] training data poison_ratio: 0.1314133129887469  data num: [946, 1662, 486, 1131, 1573, 807, 776, 85, 1446, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.041066660308983406
[rfa agg] init. name: [43, 94, 30, 38, 40, 20, 75, 61, 26, 17], weight: tensor([0.0902, 0.1585, 0.0463, 0.1079, 0.1500, 0.0770, 0.0740, 0.0081, 0.1379,
        0.1501])
[rfa agg] iter:  0, prev_obj_val: 52.175594329833984, obj_val: 57.050071716308594, abs dis: 4.874477386474609
[rfa agg] iter: 0, weight: tensor([0.1084, 0.0736, 0.0173, 0.4268, 0.0794, 0.0568, 0.0546, 0.0019, 0.1016,
        0.0796])
[rfa agg] iter:  1, prev_obj_val: 57.050071716308594, obj_val: 57.01290512084961, abs dis: 0.037166595458984375
[rfa agg] iter: 1, weight: tensor([0.2184, 0.0694, 0.0227, 0.2786, 0.0732, 0.0890, 0.0854, 0.0023, 0.0877,
        0.0734])
[rfa agg] iter:  2, prev_obj_val: 57.01290512084961, obj_val: 58.85608673095703, abs dis: 1.8431816101074219
[rfa agg] iter: 2, weight: tensor([0.2273, 0.0695, 0.0227, 0.2679, 0.0733, 0.0895, 0.0861, 0.0023, 0.0879,
        0.0735])
[rfa agg] iter:  3, prev_obj_val: 58.85608673095703, obj_val: 60.754417419433594, abs dis: 1.8983306884765625
[rfa agg] iter: 3, weight: tensor([0.2982, 0.0638, 0.0233, 0.2032, 0.0670, 0.1000, 0.0961, 0.0023, 0.0789,
        0.0671])
[rfa agg] iter:  4, prev_obj_val: 60.754417419433594, obj_val: 67.87804412841797, abs dis: 7.123626708984375
[rfa agg] iter: 4, weight: tensor([0.3980, 0.0533, 0.0218, 0.1448, 0.0557, 0.1038, 0.1000, 0.0021, 0.0647,
        0.0558])
[rfa agg] iter:  5, prev_obj_val: 67.87804412841797, obj_val: 65.24340057373047, abs dis: 2.6346435546875
[rfa agg] iter: 5, weight: tensor([0.2773, 0.0459, 0.0268, 0.0916, 0.0473, 0.2061, 0.2022, 0.0023, 0.0531,
        0.0474])
[rfa agg] iter:  6, prev_obj_val: 65.24340057373047, obj_val: 65.22815704345703, abs dis: 0.0152435302734375
[rfa agg] iter: 6, weight: tensor([0.3712, 0.0462, 0.0239, 0.0997, 0.0478, 0.1559, 0.1511, 0.0022, 0.0542,
        0.0479])
[rfa agg] iter:  7, prev_obj_val: 65.22815704345703, obj_val: 67.85789489746094, abs dis: 2.6297378540039062
[rfa agg] iter: 7, weight: tensor([0.3935, 0.0449, 0.0232, 0.0970, 0.0465, 0.1489, 0.1448, 0.0021, 0.0527,
        0.0465])
[rfa agg] iter:  8, prev_obj_val: 67.85789489746094, obj_val: 65.24442291259766, abs dis: 2.6134719848632812
[rfa agg] iter: 8, weight: tensor([0.2746, 0.0455, 0.0265, 0.0905, 0.0469, 0.2086, 0.2054, 0.0023, 0.0526,
        0.0470])
[rfa agg] iter:  9, prev_obj_val: 65.24442291259766, obj_val: 65.22819519042969, abs dis: 0.01622772216796875
[rfa agg] iter: 9, weight: tensor([0.3705, 0.0462, 0.0239, 0.0998, 0.0478, 0.1562, 0.1513, 0.0022, 0.0542,
        0.0479])
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3230, Accuracy: 61/10000 (0.6100%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.4321, Accuracy: 0/9950 (0.0000%)
saving model
Done in 430.3600170612335 sec.
Server Epoch:13 choose agents : [42, 89, 83, 18, 67, 8, 21, 60, 56, 28].
_Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 342/1372 (24.9271%)
_Train Local_ResNet_18, epoch  13, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 505/1372 (36.8076%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.3104, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   1, Avg loss: 0.0591, Accuracy: 339/896 (37.8348%)
_Train Local_ResNet_18, epoch  13, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 441/896 (49.2188%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.4575, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   1, Avg loss: 0.0549, Accuracy: 454/1953 (23.2463%)
_Train Local_ResNet_18, epoch  13, local model 83, internal_epoch   2, Avg loss: 0.0332, Accuracy: 819/1953 (41.9355%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2601, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   1, Avg loss: 0.0738, Accuracy: 140/530 (26.4151%)
_Train Local_ResNet_18, epoch  13, local model 18, internal_epoch   2, Avg loss: 0.0394, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.2760, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   1, Avg loss: 0.0768, Accuracy: 62/426 (14.5540%)
_Train Local_ResNet_18, epoch  13, local model 67, internal_epoch   2, Avg loss: 0.0414, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 6.2353, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 256/1513 (16.9200%)
_Train Local_ResNet_18, epoch  13, local model 8, internal_epoch   2, Avg loss: 0.0357, Accuracy: 505/1513 (33.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.6036, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   1, Avg loss: 0.0541, Accuracy: 370/1949 (18.9841%)
_Train Local_ResNet_18, epoch  13, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 620/1949 (31.8112%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2332, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 593/2227 (26.6278%)
_Train Local_ResNet_18, epoch  13, local model 60, internal_epoch   2, Avg loss: 0.0282, Accuracy: 1022/2227 (45.8913%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.2483, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0833, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0676, Accuracy: 69/186 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3615, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   1, Avg loss: 0.0550, Accuracy: 426/1581 (26.9450%)
_Train Local_ResNet_18, epoch  13, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 606/1581 (38.3302%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.8931, Accuracy: 75/10000 (0.7500%)
time spent on training: 158.26082038879395
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 896, 1953, 530, 426, 1513, 1949, 2227, 186, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 89, 83, 18, 67, 8, 21, 60, 56, 28], weight: tensor([0.1086, 0.0709, 0.1546, 0.0420, 0.0337, 0.1198, 0.1543, 0.1763, 0.0147,
        0.1251])
[rfa agg] iter:  0, prev_obj_val: 65.1236572265625, obj_val: 67.03785705566406, abs dis: 1.9141998291015625
[rfa agg] iter: 0, weight: tensor([0.2690, 0.0276, 0.0676, 0.0105, 0.0074, 0.2992, 0.0673, 0.0516, 0.0026,
        0.1972])
[rfa agg] iter:  1, prev_obj_val: 67.03785705566406, obj_val: 71.90943145751953, abs dis: 4.871574401855469
[rfa agg] iter: 1, weight: tensor([0.3806, 0.0284, 0.0617, 0.0106, 0.0074, 0.2402, 0.0614, 0.0480, 0.0026,
        0.1591])
[rfa agg] iter:  2, prev_obj_val: 71.90943145751953, obj_val: 71.88806915283203, abs dis: 0.0213623046875
[rfa agg] iter: 2, weight: tensor([0.4718, 0.0353, 0.0607, 0.0126, 0.0087, 0.1697, 0.0605, 0.0489, 0.0030,
        0.1287])
[rfa agg] iter:  3, prev_obj_val: 71.88806915283203, obj_val: 71.88646697998047, abs dis: 0.0016021728515625
[rfa agg] iter: 3, weight: tensor([0.4997, 0.0336, 0.0578, 0.0120, 0.0083, 0.1597, 0.0576, 0.0465, 0.0028,
        0.1220])
[rfa agg] iter:  4, prev_obj_val: 71.88646697998047, obj_val: 69.246337890625, abs dis: 2.6401290893554688
[rfa agg] iter: 4, weight: tensor([0.5078, 0.0331, 0.0569, 0.0118, 0.0082, 0.1569, 0.0567, 0.0458, 0.0028,
        0.1200])
[rfa agg] iter:  5, prev_obj_val: 69.246337890625, obj_val: 71.888916015625, abs dis: 2.642578125
[rfa agg] iter: 5, weight: tensor([0.5578, 0.0251, 0.0486, 0.0092, 0.0064, 0.1526, 0.0484, 0.0385, 0.0022,
        0.1113])
[rfa agg] iter:  6, prev_obj_val: 71.888916015625, obj_val: 69.24344635009766, abs dis: 2.6454696655273438
[rfa agg] iter: 6, weight: tensor([0.5241, 0.0320, 0.0551, 0.0114, 0.0079, 0.1514, 0.0549, 0.0444, 0.0027,
        0.1159])
[rfa agg] iter:  7, prev_obj_val: 69.24344635009766, obj_val: 74.76397705078125, abs dis: 5.520530700683594
[rfa agg] iter: 7, weight: tensor([0.5664, 0.0246, 0.0477, 0.0090, 0.0063, 0.1495, 0.0475, 0.0378, 0.0022,
        0.1092])
[rfa agg] iter:  8, prev_obj_val: 74.76397705078125, obj_val: 67.01021575927734, abs dis: 7.753761291503906
[rfa agg] iter: 8, weight: tensor([0.4329, 0.0446, 0.0682, 0.0155, 0.0107, 0.1676, 0.0679, 0.0557, 0.0036,
        0.1334])
[rfa agg] iter:  9, prev_obj_val: 67.01021575927734, obj_val: 69.26824951171875, abs dis: 2.2580337524414062
[rfa agg] iter: 9, weight: tensor([0.4305, 0.0266, 0.0579, 0.0100, 0.0070, 0.2154, 0.0576, 0.0450, 0.0024,
        0.1475])
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3269, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.4283, Accuracy: 0/9950 (0.0000%)
saving model
Done in 409.4803457260132 sec.
Server Epoch:14 choose agents : [82, 77, 78, 73, 40, 83, 97, 72, 98, 61].
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   1, Avg loss: 0.0759, Accuracy: 72/500 (14.4000%)
_Train Local_ResNet_18, epoch  14, local model 82, internal_epoch   2, Avg loss: 0.0478, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.3504, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   1, Avg loss: 0.0502, Accuracy: 352/1340 (26.2687%)
_Train Local_ResNet_18, epoch  14, local model 77, internal_epoch   2, Avg loss: 0.0264, Accuracy: 583/1340 (43.5075%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.6177, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   1, Avg loss: 0.0834, Accuracy: 43/416 (10.3365%)
_Train Local_ResNet_18, epoch  14, local model 78, internal_epoch   2, Avg loss: 0.0462, Accuracy: 184/416 (44.2308%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.2547, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   1, Avg loss: 0.0660, Accuracy: 172/938 (18.3369%)
_Train Local_ResNet_18, epoch  14, local model 73, internal_epoch   2, Avg loss: 0.0333, Accuracy: 322/938 (34.3284%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.9880, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 369/1573 (23.4584%)
_Train Local_ResNet_18, epoch  14, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 596/1573 (37.8894%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.6552, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 454/1953 (23.2463%)
_Train Local_ResNet_18, epoch  14, local model 83, internal_epoch   2, Avg loss: 0.0325, Accuracy: 865/1953 (44.2908%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.1214, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   1, Avg loss: 0.0524, Accuracy: 366/1213 (30.1731%)
_Train Local_ResNet_18, epoch  14, local model 97, internal_epoch   2, Avg loss: 0.0270, Accuracy: 489/1213 (40.3133%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.5304, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 271/1241 (21.8372%)
_Train Local_ResNet_18, epoch  14, local model 72, internal_epoch   2, Avg loss: 0.0360, Accuracy: 433/1241 (34.8912%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.6038, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   1, Avg loss: 0.0801, Accuracy: 24/373 (6.4343%)
_Train Local_ResNet_18, epoch  14, local model 98, internal_epoch   2, Avg loss: 0.0479, Accuracy: 151/373 (40.4826%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.8850, Accuracy: 50/10000 (0.5000%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1265, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1172, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3406, Accuracy: 48/10000 (0.4800%)
time spent on training: 157.8665931224823
[rfa agg] training data poison_ratio: 0.008824750830564785  data num: [500, 1340, 416, 938, 1573, 1953, 1213, 1241, 373, 85]
[rfa agg] considering poison per batch poison_fraction: 0.002757734634551495
[rfa agg] init. name: [82, 77, 78, 73, 40, 83, 97, 72, 98, 61], weight: tensor([0.0519, 0.1391, 0.0432, 0.0974, 0.1633, 0.2028, 0.1259, 0.1288, 0.0387,
        0.0088])
[rfa agg] iter:  0, prev_obj_val: 58.9755744934082, obj_val: 58.86134338378906, abs dis: 0.11423110961914062
[rfa agg] iter: 0, weight: tensor([0.0188, 0.1608, 0.0143, 0.1141, 0.0843, 0.0566, 0.3186, 0.2189, 0.0117,
        0.0020])
[rfa agg] iter:  1, prev_obj_val: 58.86134338378906, obj_val: 58.86017608642578, abs dis: 0.00116729736328125
[rfa agg] iter: 1, weight: tensor([0.0182, 0.1550, 0.0137, 0.1097, 0.0812, 0.0545, 0.3420, 0.2126, 0.0113,
        0.0019])
[rfa agg] iter:  2, prev_obj_val: 58.86017608642578, obj_val: 56.791748046875, abs dis: 2.0684280395507812
[rfa agg] iter: 2, weight: tensor([0.0181, 0.1541, 0.0137, 0.1091, 0.0808, 0.0543, 0.3454, 0.2113, 0.0113,
        0.0019])
[rfa agg] iter:  3, prev_obj_val: 56.791748046875, obj_val: 61.06620788574219, abs dis: 4.2744598388671875
[rfa agg] iter: 3, weight: tensor([0.0143, 0.1505, 0.0109, 0.0785, 0.0722, 0.0469, 0.3925, 0.2237, 0.0090,
        0.0015])
[rfa agg] iter:  4, prev_obj_val: 61.06620788574219, obj_val: 61.04842758178711, abs dis: 0.017780303955078125
[rfa agg] iter: 4, weight: tensor([0.0218, 0.1530, 0.0164, 0.1467, 0.0865, 0.0599, 0.3023, 0.1976, 0.0135,
        0.0023])
[rfa agg] iter:  5, prev_obj_val: 61.04842758178711, obj_val: 61.048336029052734, abs dis: 9.1552734375e-05
[rfa agg] iter: 5, weight: tensor([0.0220, 0.1545, 0.0165, 0.1494, 0.0871, 0.0603, 0.2953, 0.1993, 0.0135,
        0.0023])
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3296, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.3903, Accuracy: 0/9950 (0.0000%)
saving model
Done in 408.3091778755188 sec.
Server Epoch:15 choose agents : [82, 75, 98, 92, 31, 50, 22, 78, 46, 37].
_Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   1, Avg loss: 0.0756, Accuracy: 76/500 (15.2000%)
_Train Local_ResNet_18, epoch  15, local model 82, internal_epoch   2, Avg loss: 0.0485, Accuracy: 182/500 (36.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.3547, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   1, Avg loss: 0.0632, Accuracy: 274/776 (35.3093%)
_Train Local_ResNet_18, epoch  15, local model 75, internal_epoch   2, Avg loss: 0.0276, Accuracy: 432/776 (55.6701%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5878, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   1, Avg loss: 0.0811, Accuracy: 27/373 (7.2386%)
_Train Local_ResNet_18, epoch  15, local model 98, internal_epoch   2, Avg loss: 0.0471, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.0936, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   1, Avg loss: 0.0517, Accuracy: 459/1715 (26.7638%)
_Train Local_ResNet_18, epoch  15, local model 92, internal_epoch   2, Avg loss: 0.0305, Accuracy: 703/1715 (40.9913%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.2179, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   1, Avg loss: 0.0832, Accuracy: 50/460 (10.8696%)
_Train Local_ResNet_18, epoch  15, local model 31, internal_epoch   2, Avg loss: 0.0388, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.5121, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   1, Avg loss: 0.0605, Accuracy: 169/809 (20.8900%)
_Train Local_ResNet_18, epoch  15, local model 50, internal_epoch   2, Avg loss: 0.0264, Accuracy: 381/809 (47.0952%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1456, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 534/1470 (36.3265%)
_Train Local_ResNet_18, epoch  15, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 848/1470 (57.6871%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 9.0263, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 43/416 (10.3365%)
_Train Local_ResNet_18, epoch  15, local model 78, internal_epoch   2, Avg loss: 0.0469, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.3428, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   1, Avg loss: 0.0551, Accuracy: 435/1904 (22.8466%)
_Train Local_ResNet_18, epoch  15, local model 46, internal_epoch   2, Avg loss: 0.0314, Accuracy: 671/1904 (35.2416%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.0675, Accuracy: 105/10000 (1.0500%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   1, Avg loss: 0.0506, Accuracy: 435/1129 (38.5297%)
_Train Local_ResNet_18, epoch  15, local model 37, internal_epoch   2, Avg loss: 0.0239, Accuracy: 756/1129 (66.9619%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.8134, Accuracy: 123/10000 (1.2300%)
time spent on training: 149.8224356174469
[rfa agg] training data poison_ratio: 0.11819514237855946  data num: [500, 776, 373, 1715, 460, 809, 1470, 416, 1904, 1129]
[rfa agg] considering poison per batch poison_fraction: 0.03693598199329983
[rfa agg] init. name: [82, 75, 98, 92, 31, 50, 22, 78, 46, 37], weight: tensor([0.0523, 0.0812, 0.0390, 0.1795, 0.0482, 0.0847, 0.1539, 0.0436, 0.1993,
        0.1182])
[rfa agg] iter:  0, prev_obj_val: 70.01212310791016, obj_val: 72.30150604248047, abs dis: 2.2893829345703125
[rfa agg] iter: 0, weight: tensor([0.0250, 0.0809, 0.0154, 0.0853, 0.0229, 0.0841, 0.1251, 0.0188, 0.0722,
        0.4702])
[rfa agg] iter:  1, prev_obj_val: 72.30150604248047, obj_val: 73.60846710205078, abs dis: 1.3069610595703125
[rfa agg] iter: 1, weight: tensor([0.0316, 0.1164, 0.0191, 0.0876, 0.0291, 0.1210, 0.1203, 0.0235, 0.0759,
        0.3756])
[rfa agg] iter:  2, prev_obj_val: 73.60846710205078, obj_val: 77.67875671386719, abs dis: 4.070289611816406
[rfa agg] iter: 2, weight: tensor([0.0357, 0.1439, 0.0213, 0.0889, 0.0328, 0.1495, 0.1190, 0.0264, 0.0778,
        0.3046])
[rfa agg] iter:  3, prev_obj_val: 77.67875671386719, obj_val: 80.55596923828125, abs dis: 2.8772125244140625
[rfa agg] iter: 3, weight: tensor([0.0394, 0.2414, 0.0225, 0.0703, 0.0362, 0.2485, 0.0883, 0.0284, 0.0631,
        0.1618])
[rfa agg] iter:  4, prev_obj_val: 80.55596923828125, obj_val: 84.68238830566406, abs dis: 4.1264190673828125
[rfa agg] iter: 4, weight: tensor([0.0307, 0.3438, 0.0169, 0.0431, 0.0282, 0.3408, 0.0523, 0.0217, 0.0392,
        0.0834])
[rfa agg] iter:  5, prev_obj_val: 84.68238830566406, obj_val: 82.31019592285156, abs dis: 2.3721923828125
[rfa agg] iter: 5, weight: tensor([0.0360, 0.3518, 0.0187, 0.0386, 0.0330, 0.3502, 0.0456, 0.0246, 0.0355,
        0.0660])
[rfa agg] iter:  6, prev_obj_val: 82.31019592285156, obj_val: 87.36534118652344, abs dis: 5.055145263671875
[rfa agg] iter: 6, weight: tensor([0.0257, 0.3905, 0.0137, 0.0316, 0.0235, 0.3734, 0.0378, 0.0178, 0.0289,
        0.0571])
[rfa agg] iter:  7, prev_obj_val: 87.36534118652344, obj_val: 92.91586303710938, abs dis: 5.5505218505859375
[rfa agg] iter: 7, weight: tensor([0.0533, 0.2990, 0.0266, 0.0491, 0.0487, 0.3051, 0.0573, 0.0356, 0.0455,
        0.0798])
[rfa agg] iter:  8, prev_obj_val: 92.91586303710938, obj_val: 87.36481475830078, abs dis: 5.551048278808594
[rfa agg] iter: 8, weight: tensor([0.0940, 0.2153, 0.0425, 0.0614, 0.0858, 0.2229, 0.0700, 0.0591, 0.0574,
        0.0915])
[rfa agg] iter:  9, prev_obj_val: 87.36481475830078, obj_val: 92.91520690917969, abs dis: 5.550392150878906
[rfa agg] iter: 9, weight: tensor([0.0544, 0.2970, 0.0272, 0.0500, 0.0498, 0.2993, 0.0583, 0.0363, 0.0463,
        0.0813])
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3323, Accuracy: 59/10000 (0.5900%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.4046, Accuracy: 0/9950 (0.0000%)
saving model
Done in 397.55682373046875 sec.
Server Epoch:16 choose agents : [28, 26, 83, 78, 93, 7, 76, 44, 70, 39].
_Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   1, Avg loss: 0.0542, Accuracy: 427/1581 (27.0082%)
_Train Local_ResNet_18, epoch  16, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 589/1581 (37.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1022, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   1, Avg loss: 0.0544, Accuracy: 359/1446 (24.8271%)
_Train Local_ResNet_18, epoch  16, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 491/1446 (33.9557%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.7791, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 426/1953 (21.8126%)
_Train Local_ResNet_18, epoch  16, local model 83, internal_epoch   2, Avg loss: 0.0330, Accuracy: 801/1953 (41.0138%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.0425, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   1, Avg loss: 0.0827, Accuracy: 53/416 (12.7404%)
_Train Local_ResNet_18, epoch  16, local model 78, internal_epoch   2, Avg loss: 0.0450, Accuracy: 176/416 (42.3077%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.2394, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 434/1742 (24.9139%)
_Train Local_ResNet_18, epoch  16, local model 93, internal_epoch   2, Avg loss: 0.0316, Accuracy: 723/1742 (41.5040%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.2270, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   1, Avg loss: 0.0535, Accuracy: 364/891 (40.8530%)
_Train Local_ResNet_18, epoch  16, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 441/891 (49.4949%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.7767, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   1, Avg loss: 0.0840, Accuracy: 59/466 (12.6609%)
_Train Local_ResNet_18, epoch  16, local model 76, internal_epoch   2, Avg loss: 0.0474, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.2818, Accuracy: 50/10000 (0.5000%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   1, Avg loss: 0.0590, Accuracy: 387/1750 (22.1143%)
_Train Local_ResNet_18, epoch  16, local model 44, internal_epoch   2, Avg loss: 0.0348, Accuracy: 659/1750 (37.6571%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.7012, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   1, Avg loss: 0.0551, Accuracy: 384/1418 (27.0804%)
_Train Local_ResNet_18, epoch  16, local model 70, internal_epoch   2, Avg loss: 0.0297, Accuracy: 661/1418 (46.6150%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.9414, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   1, Avg loss: 0.0542, Accuracy: 311/1013 (30.7009%)
_Train Local_ResNet_18, epoch  16, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 491/1013 (48.4699%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.8271, Accuracy: 55/10000 (0.5500%)
time spent on training: 169.32635235786438
[rfa agg] training data poison_ratio: 0.1380561691385295  data num: [1581, 1446, 1953, 416, 1742, 891, 466, 1750, 1418, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.04314255285579047
[rfa agg] init. name: [28, 26, 83, 78, 93, 7, 76, 44, 70, 39], weight: tensor([0.1247, 0.1141, 0.1541, 0.0328, 0.1374, 0.0703, 0.0368, 0.1381, 0.1119,
        0.0799])
[rfa agg] iter:  0, prev_obj_val: 56.740089416503906, obj_val: 54.30835723876953, abs dis: 2.431732177734375
[rfa agg] iter: 0, weight: tensor([0.1400, 0.2365, 0.0705, 0.0108, 0.0893, 0.0458, 0.0130, 0.0897, 0.2322,
        0.0724])
[rfa agg] iter:  1, prev_obj_val: 54.30835723876953, obj_val: 56.693763732910156, abs dis: 2.385406494140625
[rfa agg] iter: 1, weight: tensor([0.1366, 0.2632, 0.0637, 0.0089, 0.0824, 0.0367, 0.0107, 0.0828, 0.2582,
        0.0566])
[rfa agg] iter:  2, prev_obj_val: 56.693763732910156, obj_val: 56.692237854003906, abs dis: 0.00152587890625
[rfa agg] iter: 2, weight: tensor([0.1382, 0.2402, 0.0695, 0.0106, 0.0881, 0.0452, 0.0128, 0.0884, 0.2356,
        0.0713])
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3351, Accuracy: 52/10000 (0.5200%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.4130, Accuracy: 0/9950 (0.0000%)
saving model
Done in 411.1819221973419 sec.
Server Epoch:17 choose agents : [42, 34, 33, 94, 66, 75, 39, 27, 6, 51].
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   1, Avg loss: 0.0508, Accuracy: 378/1372 (27.5510%)
_Train Local_ResNet_18, epoch  17, local model 42, internal_epoch   2, Avg loss: 0.0303, Accuracy: 558/1372 (40.6706%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.7538, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   1, Avg loss: 0.0577, Accuracy: 381/1427 (26.6994%)
_Train Local_ResNet_18, epoch  17, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 596/1427 (41.7659%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.4557, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0799, Accuracy: 88/515 (17.0874%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0528, Accuracy: 133/515 (25.8252%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 6.3294, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   1, Avg loss: 0.0547, Accuracy: 340/1662 (20.4573%)
_Train Local_ResNet_18, epoch  17, local model 94, internal_epoch   2, Avg loss: 0.0330, Accuracy: 607/1662 (36.5223%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.6073, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   1, Avg loss: 0.0620, Accuracy: 256/1402 (18.2596%)
_Train Local_ResNet_18, epoch  17, local model 66, internal_epoch   2, Avg loss: 0.0387, Accuracy: 361/1402 (25.7489%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.1173, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   1, Avg loss: 0.0611, Accuracy: 281/776 (36.2113%)
_Train Local_ResNet_18, epoch  17, local model 75, internal_epoch   2, Avg loss: 0.0275, Accuracy: 431/776 (55.5412%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.6636, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   1, Avg loss: 0.0527, Accuracy: 321/1013 (31.6881%)
_Train Local_ResNet_18, epoch  17, local model 39, internal_epoch   2, Avg loss: 0.0253, Accuracy: 529/1013 (52.2211%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.4231, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   1, Avg loss: 0.0543, Accuracy: 431/1587 (27.1582%)
_Train Local_ResNet_18, epoch  17, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 592/1587 (37.3031%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7362, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 401/1956 (20.5010%)
_Train Local_ResNet_18, epoch  17, local model 6, internal_epoch   2, Avg loss: 0.0315, Accuracy: 661/1956 (33.7935%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.3034, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   1, Avg loss: 0.0588, Accuracy: 235/1049 (22.4023%)
_Train Local_ResNet_18, epoch  17, local model 51, internal_epoch   2, Avg loss: 0.0294, Accuracy: 528/1049 (50.3337%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.9676, Accuracy: 100/10000 (1.0000%)
time spent on training: 156.92448353767395
[rfa agg] training data poison_ratio: 0.0  data num: [1372, 1427, 515, 1662, 1402, 776, 1013, 1587, 1956, 1049]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 34, 33, 94, 66, 75, 39, 27, 6, 51], weight: tensor([0.1075, 0.1118, 0.0404, 0.1303, 0.1099, 0.0608, 0.0794, 0.1244, 0.1533,
        0.0822])
[rfa agg] iter:  0, prev_obj_val: 50.430686950683594, obj_val: 50.40009307861328, abs dis: 0.0305938720703125
[rfa agg] iter: 0, weight: tensor([0.1697, 0.1320, 0.0165, 0.0850, 0.1773, 0.0399, 0.0949, 0.0957, 0.0570,
        0.1321])
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3383, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.4201, Accuracy: 0/9950 (0.0000%)
saving model
Done in 399.0638527870178 sec.
Server Epoch:18 choose agents : [90, 5, 3, 28, 2, 9, 92, 60, 86, 34].
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   1, Avg loss: 0.0574, Accuracy: 317/677 (46.8242%)
_Train Local_ResNet_18, epoch  18, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 459/677 (67.7991%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.5514, Accuracy: 59/10000 (0.5900%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   1, Avg loss: 0.0505, Accuracy: 421/1628 (25.8600%)
_Train Local_ResNet_18, epoch  18, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 831/1628 (51.0442%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 9.1450, Accuracy: 143/10000 (1.4300%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0719, Accuracy: 126/781 (16.1332%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0347, Accuracy: 237/781 (30.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.3793, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   1, Avg loss: 0.0541, Accuracy: 434/1581 (27.4510%)
_Train Local_ResNet_18, epoch  18, local model 28, internal_epoch   2, Avg loss: 0.0328, Accuracy: 621/1581 (39.2789%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.7798, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0631, Accuracy: 215/605 (35.5372%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.5665, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   1, Avg loss: 0.0501, Accuracy: 374/1275 (29.3333%)
_Train Local_ResNet_18, epoch  18, local model 9, internal_epoch   2, Avg loss: 0.0191, Accuracy: 719/1275 (56.3922%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 10.1256, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   1, Avg loss: 0.0511, Accuracy: 459/1715 (26.7638%)
_Train Local_ResNet_18, epoch  18, local model 92, internal_epoch   2, Avg loss: 0.0300, Accuracy: 751/1715 (43.7901%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.9182, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   1, Avg loss: 0.0489, Accuracy: 597/2227 (26.8074%)
_Train Local_ResNet_18, epoch  18, local model 60, internal_epoch   2, Avg loss: 0.0273, Accuracy: 1050/2227 (47.1486%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.2506, Accuracy: 131/10000 (1.3100%)
_Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   1, Avg loss: 0.0633, Accuracy: 352/1003 (35.0947%)
_Train Local_ResNet_18, epoch  18, local model 86, internal_epoch   2, Avg loss: 0.0348, Accuracy: 364/1003 (36.2911%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.4781, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   1, Avg loss: 0.0571, Accuracy: 389/1427 (27.2600%)
_Train Local_ResNet_18, epoch  18, local model 34, internal_epoch   2, Avg loss: 0.0325, Accuracy: 607/1427 (42.5368%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.4235, Accuracy: 83/10000 (0.8300%)
time spent on training: 174.34065628051758
[rfa agg] training data poison_ratio: 0.12601594550661815  data num: [677, 1628, 781, 1581, 605, 1275, 1715, 2227, 1003, 1427]
[rfa agg] considering poison per batch poison_fraction: 0.03937998297081817
[rfa agg] init. name: [90, 5, 3, 28, 2, 9, 92, 60, 86, 34], weight: tensor([0.0524, 0.1260, 0.0605, 0.1224, 0.0468, 0.0987, 0.1328, 0.1724, 0.0776,
        0.1105])
[rfa agg] iter:  0, prev_obj_val: 58.25308609008789, obj_val: 62.926239013671875, abs dis: 4.673152923583984
[rfa agg] iter: 0, weight: tensor([0.0204, 0.1121, 0.0290, 0.1386, 0.0166, 0.2297, 0.0971, 0.0521, 0.0569,
        0.2476])
[rfa agg] iter:  1, prev_obj_val: 62.926239013671875, obj_val: 69.390625, abs dis: 6.464385986328125
[rfa agg] iter: 1, weight: tensor([0.0213, 0.0763, 0.0316, 0.0885, 0.0172, 0.4547, 0.0689, 0.0421, 0.0694,
        0.1299])
[rfa agg] iter:  2, prev_obj_val: 69.390625, obj_val: 69.36817169189453, abs dis: 0.02245330810546875
[rfa agg] iter: 2, weight: tensor([0.0349, 0.0836, 0.0547, 0.0935, 0.0276, 0.3101, 0.0778, 0.0523, 0.1453,
        0.1202])
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3404, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.4115, Accuracy: 0/9950 (0.0000%)
saving model
Done in 431.12306094169617 sec.
Server Epoch:19 choose agents : [8, 20, 42, 21, 5, 25, 24, 71, 13, 18].
_Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   1, Avg loss: 0.0583, Accuracy: 281/1513 (18.5724%)
_Train Local_ResNet_18, epoch  19, local model 8, internal_epoch   2, Avg loss: 0.0354, Accuracy: 519/1513 (34.3027%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.6794, Accuracy: 107/10000 (1.0700%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   1, Avg loss: 0.0585, Accuracy: 318/807 (39.4052%)
_Train Local_ResNet_18, epoch  19, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 405/807 (50.1859%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4692, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   1, Avg loss: 0.0504, Accuracy: 371/1372 (27.0408%)
_Train Local_ResNet_18, epoch  19, local model 42, internal_epoch   2, Avg loss: 0.0306, Accuracy: 519/1372 (37.8280%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5315, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0530, Accuracy: 428/1949 (21.9600%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 601/1949 (30.8363%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.2500, Accuracy: 79/10000 (0.7900%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 378/1628 (23.2187%)
_Train Local_ResNet_18, epoch  19, local model 5, internal_epoch   2, Avg loss: 0.0250, Accuracy: 846/1628 (51.9656%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 9.3179, Accuracy: 143/10000 (1.4300%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   1, Avg loss: 0.0550, Accuracy: 317/690 (45.9420%)
_Train Local_ResNet_18, epoch  19, local model 25, internal_epoch   2, Avg loss: 0.0256, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.7744, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   1, Avg loss: 0.0739, Accuracy: 51/312 (16.3462%)
_Train Local_ResNet_18, epoch  19, local model 24, internal_epoch   2, Avg loss: 0.0376, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.1104, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   1, Avg loss: 0.0652, Accuracy: 158/818 (19.3154%)
_Train Local_ResNet_18, epoch  19, local model 71, internal_epoch   2, Avg loss: 0.0301, Accuracy: 379/818 (46.3325%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.2166, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   1, Avg loss: 0.0565, Accuracy: 350/1645 (21.2766%)
_Train Local_ResNet_18, epoch  19, local model 13, internal_epoch   2, Avg loss: 0.0320, Accuracy: 671/1645 (40.7903%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5462, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   1, Avg loss: 0.0738, Accuracy: 130/530 (24.5283%)
_Train Local_ResNet_18, epoch  19, local model 18, internal_epoch   2, Avg loss: 0.0375, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.4576, Accuracy: 66/10000 (0.6600%)
time spent on training: 197.835999250412
[rfa agg] training data poison_ratio: 0.2774325284090909  data num: [1513, 807, 1372, 1949, 1628, 690, 312, 818, 1645, 530]
[rfa agg] considering poison per batch poison_fraction: 0.0866976651278409
[rfa agg] init. name: [8, 20, 42, 21, 5, 25, 24, 71, 13, 18], weight: tensor([0.1343, 0.0716, 0.1218, 0.1730, 0.1445, 0.0613, 0.0277, 0.0726, 0.1460,
        0.0471])
[rfa agg] iter:  0, prev_obj_val: 66.38976287841797, obj_val: 68.31005096435547, abs dis: 1.9202880859375
[rfa agg] iter: 0, weight: tensor([0.1663, 0.0743, 0.2449, 0.0903, 0.1285, 0.0480, 0.0124, 0.0756, 0.1300,
        0.0295])
[rfa agg] iter:  1, prev_obj_val: 68.31005096435547, obj_val: 66.37491607666016, abs dis: 1.9351348876953125
[rfa agg] iter: 1, weight: tensor([0.1593, 0.0850, 0.2245, 0.0911, 0.1261, 0.0537, 0.0135, 0.0866, 0.1276,
        0.0326])
[rfa agg] iter:  2, prev_obj_val: 66.37491607666016, obj_val: 68.31008911132812, abs dis: 1.9351730346679688
[rfa agg] iter: 2, weight: tensor([0.1661, 0.0742, 0.2465, 0.0901, 0.1282, 0.0479, 0.0124, 0.0755, 0.1297,
        0.0295])
[rfa agg] iter:  3, prev_obj_val: 68.31008911132812, obj_val: 66.37490844726562, abs dis: 1.9351806640625
[rfa agg] iter: 3, weight: tensor([0.1593, 0.0850, 0.2245, 0.0911, 0.1261, 0.0537, 0.0135, 0.0866, 0.1276,
        0.0326])
[rfa agg] iter:  4, prev_obj_val: 66.37490844726562, obj_val: 68.31008911132812, abs dis: 1.9351806640625
[rfa agg] iter: 4, weight: tensor([0.1661, 0.0742, 0.2465, 0.0901, 0.1282, 0.0479, 0.0124, 0.0755, 0.1297,
        0.0295])
[rfa agg] iter:  5, prev_obj_val: 68.31008911132812, obj_val: 66.37490844726562, abs dis: 1.9351806640625
[rfa agg] iter: 5, weight: tensor([0.1593, 0.0850, 0.2245, 0.0911, 0.1261, 0.0537, 0.0135, 0.0866, 0.1276,
        0.0326])
[rfa agg] iter:  6, prev_obj_val: 66.37490844726562, obj_val: 68.31008911132812, abs dis: 1.9351806640625
[rfa agg] iter: 6, weight: tensor([0.1661, 0.0742, 0.2465, 0.0901, 0.1282, 0.0479, 0.0124, 0.0755, 0.1297,
        0.0295])
[rfa agg] iter:  7, prev_obj_val: 68.31008911132812, obj_val: 66.37490844726562, abs dis: 1.9351806640625
[rfa agg] iter: 7, weight: tensor([0.1593, 0.0850, 0.2245, 0.0911, 0.1261, 0.0537, 0.0135, 0.0866, 0.1276,
        0.0326])
[rfa agg] iter:  8, prev_obj_val: 66.37490844726562, obj_val: 68.31008911132812, abs dis: 1.9351806640625
[rfa agg] iter: 8, weight: tensor([0.1661, 0.0742, 0.2465, 0.0901, 0.1282, 0.0479, 0.0124, 0.0755, 0.1297,
        0.0295])
[rfa agg] iter:  9, prev_obj_val: 68.31008911132812, obj_val: 66.37490844726562, abs dis: 1.9351806640625
[rfa agg] iter: 9, weight: tensor([0.1593, 0.0850, 0.2245, 0.0911, 0.1261, 0.0537, 0.0135, 0.0866, 0.1276,
        0.0326])
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3440, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.4280, Accuracy: 0/9950 (0.0000%)
saving model
Done in 451.4673111438751 sec.
Server Epoch:20 choose agents : [89, 17, 66, 8, 76, 59, 83, 62, 70, 12].
_Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   1, Avg loss: 0.0589, Accuracy: 346/896 (38.6161%)
_Train Local_ResNet_18, epoch  20, local model 89, internal_epoch   2, Avg loss: 0.0329, Accuracy: 463/896 (51.6741%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.6737, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   1, Avg loss: 0.0508, Accuracy: 399/1574 (25.3494%)
_Train Local_ResNet_18, epoch  20, local model 17, internal_epoch   2, Avg loss: 0.0268, Accuracy: 686/1574 (43.5832%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.5514, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   1, Avg loss: 0.0606, Accuracy: 270/1402 (19.2582%)
_Train Local_ResNet_18, epoch  20, local model 66, internal_epoch   2, Avg loss: 0.0383, Accuracy: 415/1402 (29.6006%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.5965, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   1, Avg loss: 0.0569, Accuracy: 313/1513 (20.6874%)
_Train Local_ResNet_18, epoch  20, local model 8, internal_epoch   2, Avg loss: 0.0354, Accuracy: 493/1513 (32.5843%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.7389, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   1, Avg loss: 0.0821, Accuracy: 67/466 (14.3777%)
_Train Local_ResNet_18, epoch  20, local model 76, internal_epoch   2, Avg loss: 0.0466, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.6238, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0539, Accuracy: 316/1089 (29.0174%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0286, Accuracy: 474/1089 (43.5262%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 10.7168, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 426/1953 (21.8126%)
_Train Local_ResNet_18, epoch  20, local model 83, internal_epoch   2, Avg loss: 0.0325, Accuracy: 790/1953 (40.4506%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.5072, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   1, Avg loss: 0.0653, Accuracy: 161/568 (28.3451%)
_Train Local_ResNet_18, epoch  20, local model 62, internal_epoch   2, Avg loss: 0.0382, Accuracy: 266/568 (46.8310%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.5738, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   1, Avg loss: 0.0538, Accuracy: 391/1418 (27.5740%)
_Train Local_ResNet_18, epoch  20, local model 70, internal_epoch   2, Avg loss: 0.0301, Accuracy: 649/1418 (45.7687%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 8.2945, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   1, Avg loss: 0.0853, Accuracy: 21/338 (6.2130%)
_Train Local_ResNet_18, epoch  20, local model 12, internal_epoch   2, Avg loss: 0.0476, Accuracy: 135/338 (39.9408%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.1643, Accuracy: 50/10000 (0.5000%)
time spent on training: 159.61942267417908
[rfa agg] training data poison_ratio: 0.0  data num: [896, 1574, 1402, 1513, 466, 1089, 1953, 568, 1418, 338]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 17, 66, 8, 76, 59, 83, 62, 70, 12], weight: tensor([0.0799, 0.1403, 0.1250, 0.1349, 0.0415, 0.0971, 0.1741, 0.0506, 0.1264,
        0.0301])
[rfa agg] iter:  0, prev_obj_val: 57.77118682861328, obj_val: 57.69475555419922, abs dis: 0.0764312744140625
[rfa agg] iter: 0, weight: tensor([0.0703, 0.1033, 0.1759, 0.1182, 0.0168, 0.2807, 0.0645, 0.0225, 0.1374,
        0.0103])
[rfa agg] iter:  1, prev_obj_val: 57.69475555419922, obj_val: 61.67815017700195, abs dis: 3.9833946228027344
[rfa agg] iter: 1, weight: tensor([0.0678, 0.0999, 0.1705, 0.1142, 0.0163, 0.3042, 0.0624, 0.0218, 0.1328,
        0.0100])
[rfa agg] iter:  2, prev_obj_val: 61.67815017700195, obj_val: 59.581825256347656, abs dis: 2.096324920654297
[rfa agg] iter: 2, weight: tensor([0.0784, 0.0802, 0.1221, 0.0893, 0.0167, 0.4266, 0.0538, 0.0226, 0.1001,
        0.0101])
[rfa agg] iter:  3, prev_obj_val: 59.581825256347656, obj_val: 61.63497543334961, abs dis: 2.053150177001953
[rfa agg] iter: 3, weight: tensor([0.0674, 0.0830, 0.1320, 0.0934, 0.0153, 0.4185, 0.0539, 0.0207, 0.1064,
        0.0094])
[rfa agg] iter:  4, prev_obj_val: 61.63497543334961, obj_val: 61.62504577636719, abs dis: 0.009929656982421875
[rfa agg] iter: 4, weight: tensor([0.0721, 0.0738, 0.1119, 0.0822, 0.0154, 0.4727, 0.0496, 0.0209, 0.0921,
        0.0093])
[rfa agg] iter:  5, prev_obj_val: 61.62504577636719, obj_val: 66.48711395263672, abs dis: 4.862068176269531
[rfa agg] iter: 5, weight: tensor([0.0686, 0.0703, 0.1062, 0.0782, 0.0147, 0.4984, 0.0473, 0.0199, 0.0876,
        0.0089])
[rfa agg] iter:  6, prev_obj_val: 66.48711395263672, obj_val: 61.64519500732422, abs dis: 4.8419189453125
[rfa agg] iter: 6, weight: tensor([0.1178, 0.0813, 0.1137, 0.0889, 0.0215, 0.3796, 0.0580, 0.0295, 0.0970,
        0.0128])
[rfa agg] iter:  7, prev_obj_val: 61.64519500732422, obj_val: 59.58454132080078, abs dis: 2.0606536865234375
[rfa agg] iter: 7, weight: tensor([0.0742, 0.0758, 0.1148, 0.0844, 0.0158, 0.4587, 0.0509, 0.0214, 0.0945,
        0.0096])
[rfa agg] iter:  8, prev_obj_val: 59.58454132080078, obj_val: 61.63277816772461, abs dis: 2.048236846923828
[rfa agg] iter: 8, weight: tensor([0.0663, 0.0816, 0.1297, 0.0919, 0.0151, 0.4283, 0.0531, 0.0203, 0.1046,
        0.0092])
[rfa agg] iter:  9, prev_obj_val: 61.63277816772461, obj_val: 61.62458801269531, abs dis: 0.008190155029296875
[rfa agg] iter: 9, weight: tensor([0.0715, 0.0732, 0.1109, 0.0815, 0.0153, 0.4770, 0.0492, 0.0207, 0.0913,
        0.0092])
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3460, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.4234, Accuracy: 0/9950 (0.0000%)
saving model
Done in 409.3316571712494 sec.
Server Epoch:21 choose agents : [0, 21, 31, 56, 90, 65, 87, 37, 77, 26].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0574, Accuracy: 359/1657 (21.6657%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0343, Accuracy: 555/1657 (33.4943%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0313, Accuracy: 634/1657 (38.2619%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0305, Accuracy: 657/1657 (39.6500%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0295, Accuracy: 687/1657 (41.4605%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0293, Accuracy: 711/1657 (42.9089%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0284, Accuracy: 749/1657 (45.2022%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0279, Accuracy: 763/1657 (46.0471%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0275, Accuracy: 790/1657 (47.6765%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0274, Accuracy: 762/1657 (45.9867%), train_poison_data_count: 520
Global model norm: 112.02738835743472.
Norm before scaling: 112.00075857723019. Distance: 1.1831621950714075
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.7733, Accuracy: 70/10000 (0.7000%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 1.0519, Accuracy: 8958/9950 (90.0302%)
Scaling by  100
Scaled Norm after poisoning: 160.6619364146343, distance: 118.31622253784559
Total norm for 3 adversaries is: 160.6619364146343. distance: 118.31622253784559
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   1, Avg loss: 0.0533, Accuracy: 405/1949 (20.7799%)
_Train Local_ResNet_18, epoch  21, local model 21, internal_epoch   2, Avg loss: 0.0323, Accuracy: 663/1949 (34.0174%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.2414, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   1, Avg loss: 0.0837, Accuracy: 56/460 (12.1739%)
_Train Local_ResNet_18, epoch  21, local model 31, internal_epoch   2, Avg loss: 0.0376, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.6167, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 4/186 (2.1505%)
_Train Local_ResNet_18, epoch  21, local model 56, internal_epoch   2, Avg loss: 0.0674, Accuracy: 69/186 (37.0968%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3967, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   1, Avg loss: 0.0563, Accuracy: 324/677 (47.8582%)
_Train Local_ResNet_18, epoch  21, local model 90, internal_epoch   2, Avg loss: 0.0224, Accuracy: 453/677 (66.9129%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.8589, Accuracy: 57/10000 (0.5700%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0559, Accuracy: 380/1475 (25.7627%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 701/1475 (47.5254%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.8137, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   1, Avg loss: 0.0583, Accuracy: 304/1131 (26.8789%)
_Train Local_ResNet_18, epoch  21, local model 87, internal_epoch   2, Avg loss: 0.0313, Accuracy: 424/1131 (37.4889%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.0977, Accuracy: 53/10000 (0.5300%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   1, Avg loss: 0.0504, Accuracy: 466/1129 (41.2755%)
_Train Local_ResNet_18, epoch  21, local model 37, internal_epoch   2, Avg loss: 0.0229, Accuracy: 754/1129 (66.7848%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.8089, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   1, Avg loss: 0.0499, Accuracy: 374/1340 (27.9104%)
_Train Local_ResNet_18, epoch  21, local model 77, internal_epoch   2, Avg loss: 0.0262, Accuracy: 560/1340 (41.7910%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.5986, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0544, Accuracy: 330/1446 (22.8216%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0339, Accuracy: 535/1446 (36.9986%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.5555, Accuracy: 63/10000 (0.6300%)
time spent on training: 309.342159986496
[rfa agg] training data poison_ratio: 0.3721397379912664  data num: [1657, 1949, 460, 186, 677, 1475, 1131, 1129, 1340, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.11629366812227074
[rfa agg] init. name: [0, 21, 31, 56, 90, 65, 87, 37, 77, 26], weight: tensor([0.1447, 0.1702, 0.0402, 0.0162, 0.0591, 0.1288, 0.0988, 0.0986, 0.1170,
        0.1263])
[rfa agg] iter:  0, prev_obj_val: 28721.119140625, obj_val: 19082.49609375, abs dis: 9638.623046875
[rfa agg] iter: 0, weight: tensor([0.0278, 0.1945, 0.0453, 0.0183, 0.0668, 0.1466, 0.1121, 0.1119, 0.1330,
        0.1437])
[rfa agg] iter:  1, prev_obj_val: 19082.49609375, obj_val: 17182.1484375, abs dis: 1900.34765625
[rfa agg] iter: 1, weight: tensor([0.0048, 0.2034, 0.0451, 0.0180, 0.0668, 0.1509, 0.1138, 0.1136, 0.1360,
        0.1476])
[rfa agg] iter:  2, prev_obj_val: 17182.1484375, obj_val: 16856.876953125, abs dis: 325.271484375
[rfa agg] iter: 2, weight: tensor([0.0008, 0.2338, 0.0379, 0.0144, 0.0582, 0.1554, 0.1079, 0.1077, 0.1342,
        0.1498])
[rfa agg] iter:  3, prev_obj_val: 16856.876953125, obj_val: 16843.984375, abs dis: 12.892578125
[rfa agg] iter: 3, weight: tensor([6.3785e-05, 5.4980e-01, 1.0678e-02, 3.5035e-03, 1.8261e-02, 1.3167e-01,
        4.8959e-02, 4.8849e-02, 7.8317e-02, 1.0989e-01])
[rfa agg] iter:  4, prev_obj_val: 16843.984375, obj_val: 16839.490234375, abs dis: 4.494140625
[rfa agg] iter: 4, weight: tensor([5.4979e-05, 1.5179e-01, 1.1303e-02, 3.5565e-03, 2.0062e-02, 3.3265e-01,
        6.4248e-02, 6.4057e-02, 1.2500e-01, 2.2728e-01])
[rfa agg] iter:  5, prev_obj_val: 16839.490234375, obj_val: 16843.8359375, abs dis: 4.345703125
[rfa agg] iter: 5, weight: tensor([3.5422e-05, 5.9664e-02, 9.1054e-03, 2.7143e-03, 1.7039e-02, 1.8912e-01,
        7.6222e-02, 7.5886e-02, 2.7689e-01, 2.9332e-01])
[rfa agg] iter:  6, prev_obj_val: 16843.8359375, obj_val: 16845.439453125, abs dis: 1.603515625
[rfa agg] iter: 6, weight: tensor([3.9721e-05, 5.4834e-02, 1.1911e-02, 3.4020e-03, 2.3337e-02, 1.1128e-01,
        1.5899e-01, 1.5667e-01, 3.3496e-01, 1.4458e-01])
[rfa agg] iter:  7, prev_obj_val: 16845.439453125, obj_val: 16849.083984375, abs dis: 3.64453125
[rfa agg] iter: 7, weight: tensor([4.0746e-05, 5.3831e-02, 1.2750e-02, 3.5958e-03, 2.5345e-02, 1.0184e-01,
        2.0936e-01, 2.0532e-01, 2.6097e-01, 1.2695e-01])
[rfa agg] iter:  8, prev_obj_val: 16849.083984375, obj_val: 16854.037109375, abs dis: 4.953125
[rfa agg] iter: 8, weight: tensor([3.4054e-05, 4.1425e-02, 1.1669e-02, 3.1992e-03, 2.3991e-02, 7.0252e-02,
        3.2268e-01, 3.0595e-01, 1.3712e-01, 8.3684e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3481, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.4202, Accuracy: 0/9950 (0.0000%)
saving model
Done in 568.519460439682 sec.
Server Epoch:22 choose agents : [13, 26, 58, 22, 88, 2, 65, 9, 90, 64].
_Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   1, Avg loss: 0.0556, Accuracy: 371/1645 (22.5532%)
_Train Local_ResNet_18, epoch  22, local model 13, internal_epoch   2, Avg loss: 0.0320, Accuracy: 647/1645 (39.3313%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.4142, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   1, Avg loss: 0.0541, Accuracy: 354/1446 (24.4813%)
_Train Local_ResNet_18, epoch  22, local model 26, internal_epoch   2, Avg loss: 0.0340, Accuracy: 513/1446 (35.4772%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.4813, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   1, Avg loss: 0.0587, Accuracy: 343/803 (42.7148%)
_Train Local_ResNet_18, epoch  22, local model 58, internal_epoch   2, Avg loss: 0.0339, Accuracy: 383/803 (47.6961%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.5924, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0456, Accuracy: 527/1470 (35.8503%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0234, Accuracy: 859/1470 (58.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.6956, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   1, Avg loss: 0.0731, Accuracy: 148/603 (24.5439%)
_Train Local_ResNet_18, epoch  22, local model 88, internal_epoch   2, Avg loss: 0.0452, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.1195, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0612, Accuracy: 249/605 (41.1570%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0383, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.5739, Accuracy: 69/10000 (0.6900%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   1, Avg loss: 0.0562, Accuracy: 408/1475 (27.6610%)
_Train Local_ResNet_18, epoch  22, local model 65, internal_epoch   2, Avg loss: 0.0312, Accuracy: 671/1475 (45.4915%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.2498, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   1, Avg loss: 0.0472, Accuracy: 362/1275 (28.3922%)
_Train Local_ResNet_18, epoch  22, local model 9, internal_epoch   2, Avg loss: 0.0181, Accuracy: 754/1275 (59.1373%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.2201, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   1, Avg loss: 0.0554, Accuracy: 319/677 (47.1196%)
_Train Local_ResNet_18, epoch  22, local model 90, internal_epoch   2, Avg loss: 0.0229, Accuracy: 465/677 (68.6854%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 9.1918, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   1, Avg loss: 0.0637, Accuracy: 182/953 (19.0976%)
_Train Local_ResNet_18, epoch  22, local model 64, internal_epoch   2, Avg loss: 0.0374, Accuracy: 330/953 (34.6275%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.1641, Accuracy: 74/10000 (0.7400%)
time spent on training: 179.50056219100952
[rfa agg] training data poison_ratio: 0.13467859751643535  data num: [1645, 1446, 803, 1470, 603, 605, 1475, 1275, 677, 953]
[rfa agg] considering poison per batch poison_fraction: 0.04208706172388604
[rfa agg] init. name: [13, 26, 58, 22, 88, 2, 65, 9, 90, 64], weight: tensor([0.1502, 0.1320, 0.0733, 0.1342, 0.0551, 0.0552, 0.1347, 0.1164, 0.0618,
        0.0870])
[rfa agg] iter:  0, prev_obj_val: 51.489654541015625, obj_val: 54.45033645629883, abs dis: 2.960681915283203
[rfa agg] iter: 0, weight: tensor([0.0862, 0.1162, 0.0791, 0.1181, 0.0359, 0.0360, 0.1004, 0.2174, 0.0465,
        0.1641])
[rfa agg] iter:  1, prev_obj_val: 54.45033645629883, obj_val: 57.530609130859375, abs dis: 3.080272674560547
[rfa agg] iter: 1, weight: tensor([0.0756, 0.0966, 0.0988, 0.0982, 0.0405, 0.0406, 0.0854, 0.1566, 0.0537,
        0.2540])
[rfa agg] iter:  2, prev_obj_val: 57.530609130859375, obj_val: 63.52518081665039, abs dis: 5.994571685791016
[rfa agg] iter: 2, weight: tensor([0.0538, 0.0660, 0.1070, 0.0670, 0.0375, 0.0377, 0.0593, 0.0963, 0.0515,
        0.4238])
[rfa agg] iter:  3, prev_obj_val: 63.52518081665039, obj_val: 63.505348205566406, abs dis: 0.019832611083984375
[rfa agg] iter: 3, weight: tensor([0.0477, 0.0557, 0.2311, 0.0566, 0.0518, 0.0521, 0.0511, 0.0734, 0.0774,
        0.3031])
[rfa agg] iter:  4, prev_obj_val: 63.505348205566406, obj_val: 65.81006622314453, abs dis: 2.304718017578125
[rfa agg] iter: 4, weight: tensor([0.0476, 0.0556, 0.2430, 0.0565, 0.0518, 0.0521, 0.0510, 0.0733, 0.0775,
        0.2917])
[rfa agg] iter:  5, prev_obj_val: 65.81006622314453, obj_val: 65.7950210571289, abs dis: 0.015045166015625
[rfa agg] iter: 5, weight: tensor([0.0431, 0.0498, 0.3517, 0.0506, 0.0556, 0.0560, 0.0459, 0.0639, 0.0873,
        0.1960])
[rfa agg] iter:  6, prev_obj_val: 65.7950210571289, obj_val: 65.7945785522461, abs dis: 0.0004425048828125
[rfa agg] iter: 6, weight: tensor([0.0418, 0.0483, 0.3746, 0.0491, 0.0540, 0.0543, 0.0445, 0.0620, 0.0848,
        0.1865])
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3506, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.3598, Accuracy: 0/9950 (0.0000%)
saving model
Done in 423.80380940437317 sec.
Server Epoch:23 choose agents : [20, 11, 63, 44, 2, 74, 26, 89, 3, 6].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0605, Accuracy: 219/807 (27.1375%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0364, Accuracy: 335/807 (41.5118%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0295, Accuracy: 384/807 (47.5836%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0296, Accuracy: 350/807 (43.3705%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0291, Accuracy: 367/807 (45.4771%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0274, Accuracy: 380/807 (47.0880%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0269, Accuracy: 384/807 (47.5836%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0270, Accuracy: 379/807 (46.9641%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0263, Accuracy: 382/807 (47.3358%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0265, Accuracy: 385/807 (47.7076%), train_poison_data_count: 260
Global model norm: 112.02451601100537.
Norm before scaling: 112.01340513388342. Distance: 0.8382797226976345
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.3497, Accuracy: 86/10000 (0.8600%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.9727, Accuracy: 8344/9950 (83.8593%)
Scaling by  100
Scaled Norm after poisoning: 138.77076139716897, distance: 83.82796918671447
Total norm for 3 adversaries is: 138.77076139716897. distance: 83.82796918671447
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   1, Avg loss: 0.0546, Accuracy: 320/712 (44.9438%)
_Train Local_ResNet_18, epoch  23, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 435/712 (61.0955%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.1554, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   1, Avg loss: 0.0519, Accuracy: 282/888 (31.7568%)
_Train Local_ResNet_18, epoch  23, local model 63, internal_epoch   2, Avg loss: 0.0249, Accuracy: 487/888 (54.8423%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.3921, Accuracy: 79/10000 (0.7900%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   1, Avg loss: 0.0587, Accuracy: 414/1750 (23.6571%)
_Train Local_ResNet_18, epoch  23, local model 44, internal_epoch   2, Avg loss: 0.0342, Accuracy: 703/1750 (40.1714%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.8334, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 230/605 (38.0165%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0377, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.5282, Accuracy: 77/10000 (0.7700%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 517/1552 (33.3119%)
_Train Local_ResNet_18, epoch  23, local model 74, internal_epoch   2, Avg loss: 0.0204, Accuracy: 785/1552 (50.5799%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 11.5304, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   1, Avg loss: 0.0534, Accuracy: 361/1446 (24.9654%)
_Train Local_ResNet_18, epoch  23, local model 26, internal_epoch   2, Avg loss: 0.0337, Accuracy: 532/1446 (36.7911%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.5296, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   1, Avg loss: 0.0596, Accuracy: 349/896 (38.9509%)
_Train Local_ResNet_18, epoch  23, local model 89, internal_epoch   2, Avg loss: 0.0330, Accuracy: 418/896 (46.6518%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.7304, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0714, Accuracy: 130/781 (16.6453%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0351, Accuracy: 223/781 (28.5531%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.5578, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   1, Avg loss: 0.0538, Accuracy: 415/1956 (21.2168%)
_Train Local_ResNet_18, epoch  23, local model 6, internal_epoch   2, Avg loss: 0.0309, Accuracy: 694/1956 (35.4806%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.3857, Accuracy: 121/10000 (1.2100%)
time spent on training: 298.9130232334137
[rfa agg] training data poison_ratio: 0.3606600544193803  data num: [807, 712, 888, 1750, 605, 1552, 1446, 896, 781, 1956]
[rfa agg] considering poison per batch poison_fraction: 0.11270626700605635
[rfa agg] init. name: [20, 11, 63, 44, 2, 74, 26, 89, 3, 6], weight: tensor([0.0708, 0.0625, 0.0779, 0.1536, 0.0531, 0.1362, 0.1269, 0.0786, 0.0686,
        0.1717])
[rfa agg] iter:  0, prev_obj_val: 7607.53173828125, obj_val: 4374.91748046875, abs dis: 3232.6142578125
[rfa agg] iter: 0, weight: tensor([0.0057, 0.0654, 0.0820, 0.1666, 0.0554, 0.1467, 0.1361, 0.0827, 0.0719,
        0.1874])
[rfa agg] iter:  1, prev_obj_val: 4374.91748046875, obj_val: 4158.4912109375, abs dis: 216.42626953125
[rfa agg] iter: 1, weight: tensor([0.0004, 0.0503, 0.0657, 0.1918, 0.0409, 0.1541, 0.1352, 0.0662, 0.0564,
        0.2390])
[rfa agg] iter:  2, prev_obj_val: 4158.4912109375, obj_val: 4164.58251953125, abs dis: 6.09130859375
[rfa agg] iter: 2, weight: tensor([3.8311e-05, 1.9862e-02, 3.0246e-02, 1.0606e-01, 1.4289e-02, 2.1581e-01,
        4.8453e-01, 3.0481e-02, 2.3941e-02, 7.4744e-02])
[rfa agg] iter:  3, prev_obj_val: 4164.58251953125, obj_val: 4163.1748046875, abs dis: 1.40771484375
[rfa agg] iter: 3, weight: tensor([6.7858e-05, 4.5438e-02, 7.3799e-02, 1.2589e-01, 3.1305e-02, 1.8416e-01,
        3.0771e-01, 7.4337e-02, 5.6382e-02, 1.0091e-01])
[rfa agg] iter:  4, prev_obj_val: 4163.1748046875, obj_val: 4167.36083984375, abs dis: 4.18603515625
[rfa agg] iter: 4, weight: tensor([6.2723e-05, 3.9717e-02, 6.3535e-02, 1.2472e-01, 2.7640e-02, 1.9083e-01,
        3.4258e-01, 6.4015e-02, 4.8939e-02, 9.7962e-02])
[rfa agg] iter:  5, prev_obj_val: 4167.36083984375, obj_val: 4170.1787109375, abs dis: 2.81787109375
[rfa agg] iter: 5, weight: tensor([7.5181e-05, 5.7048e-02, 9.6558e-02, 1.2349e-01, 3.8336e-02, 1.6822e-01,
        2.4479e-01, 9.7199e-02, 7.2022e-02, 1.0226e-01])
[rfa agg] iter:  6, prev_obj_val: 4170.1787109375, obj_val: 4168.76171875, abs dis: 1.4169921875
[rfa agg] iter: 6, weight: tensor([7.7602e-05, 6.7897e-02, 1.2154e-01, 1.1426e-01, 4.4214e-02, 1.4750e-01,
        1.9737e-01, 1.2223e-01, 8.7700e-02, 9.7207e-02])
[rfa agg] iter:  7, prev_obj_val: 4168.76171875, obj_val: 4167.353515625, abs dis: 1.408203125
[rfa agg] iter: 7, weight: tensor([7.7015e-05, 6.2632e-02, 1.0890e-01, 1.1962e-01, 4.1460e-02, 1.5830e-01,
        2.1902e-01, 1.0961e-01, 7.9924e-02, 1.0046e-01])
[rfa agg] iter:  8, prev_obj_val: 4167.353515625, obj_val: 4170.1787109375, abs dis: 2.8251953125
[rfa agg] iter: 8, weight: tensor([7.5259e-05, 5.7147e-02, 9.6850e-02, 1.2367e-01, 3.8389e-02, 1.6842e-01,
        2.4339e-01, 9.7510e-02, 7.2158e-02, 1.0239e-01])
[rfa agg] iter:  9, prev_obj_val: 4170.1787109375, obj_val: 4168.76171875, abs dis: 1.4169921875
[rfa agg] iter: 9, weight: tensor([7.7602e-05, 6.7898e-02, 1.2155e-01, 1.1426e-01, 4.4214e-02, 1.4750e-01,
        1.9736e-01, 1.2224e-01, 8.7700e-02, 9.7207e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3530, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.3773, Accuracy: 0/9950 (0.0000%)
saving model
Done in 543.6592311859131 sec.
Server Epoch:24 choose agents : [75, 96, 99, 97, 17, 80, 3, 13, 60, 83].
_Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   1, Avg loss: 0.0592, Accuracy: 286/776 (36.8557%)
_Train Local_ResNet_18, epoch  24, local model 75, internal_epoch   2, Avg loss: 0.0276, Accuracy: 424/776 (54.6392%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.6627, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   1, Avg loss: 0.0796, Accuracy: 44/311 (14.1479%)
_Train Local_ResNet_18, epoch  24, local model 96, internal_epoch   2, Avg loss: 0.0526, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.7278, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   1, Avg loss: 0.0620, Accuracy: 254/773 (32.8590%)
_Train Local_ResNet_18, epoch  24, local model 99, internal_epoch   2, Avg loss: 0.0309, Accuracy: 450/773 (58.2147%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.1479, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   1, Avg loss: 0.0514, Accuracy: 363/1213 (29.9258%)
_Train Local_ResNet_18, epoch  24, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 509/1213 (41.9621%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 9.5177, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   1, Avg loss: 0.0502, Accuracy: 414/1574 (26.3024%)
_Train Local_ResNet_18, epoch  24, local model 17, internal_epoch   2, Avg loss: 0.0264, Accuracy: 701/1574 (44.5362%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.9747, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   1, Avg loss: 0.0709, Accuracy: 133/682 (19.5015%)
_Train Local_ResNet_18, epoch  24, local model 80, internal_epoch   2, Avg loss: 0.0378, Accuracy: 260/682 (38.1232%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.7387, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0693, Accuracy: 150/781 (19.2061%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0342, Accuracy: 239/781 (30.6018%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.7883, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   1, Avg loss: 0.0553, Accuracy: 376/1645 (22.8571%)
_Train Local_ResNet_18, epoch  24, local model 13, internal_epoch   2, Avg loss: 0.0314, Accuracy: 665/1645 (40.4255%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.3079, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   1, Avg loss: 0.0488, Accuracy: 643/2227 (28.8729%)
_Train Local_ResNet_18, epoch  24, local model 60, internal_epoch   2, Avg loss: 0.0274, Accuracy: 1060/2227 (47.5977%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.0020, Accuracy: 136/10000 (1.3600%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0530, Accuracy: 482/1953 (24.6800%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0325, Accuracy: 846/1953 (43.3180%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.2534, Accuracy: 102/10000 (1.0200%)
time spent on training: 172.8829789161682
[rfa agg] training data poison_ratio: 0.0  data num: [776, 311, 773, 1213, 1574, 682, 781, 1645, 2227, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [75, 96, 99, 97, 17, 80, 3, 13, 60, 83], weight: tensor([0.0650, 0.0261, 0.0648, 0.1016, 0.1319, 0.0571, 0.0654, 0.1378, 0.1866,
        0.1636])
[rfa agg] iter:  0, prev_obj_val: 72.9806900024414, obj_val: 74.02684020996094, abs dis: 1.0461502075195312
[rfa agg] iter: 0, weight: tensor([0.0459, 0.0095, 0.0457, 0.2315, 0.2207, 0.0327, 0.0462, 0.1814, 0.0831,
        0.1032])
[rfa agg] iter:  1, prev_obj_val: 74.02684020996094, obj_val: 76.22465515136719, abs dis: 2.19781494140625
[rfa agg] iter: 1, weight: tensor([0.0480, 0.0097, 0.0479, 0.2828, 0.1922, 0.0339, 0.0484, 0.1616, 0.0789,
        0.0967])
[rfa agg] iter:  2, prev_obj_val: 76.22465515136719, obj_val: 77.35118103027344, abs dis: 1.12652587890625
[rfa agg] iter: 2, weight: tensor([0.0472, 0.0089, 0.0471, 0.4279, 0.1332, 0.0324, 0.0476, 0.1164, 0.0635,
        0.0758])
[rfa agg] iter:  3, prev_obj_val: 77.35118103027344, obj_val: 78.62962341308594, abs dis: 1.2784423828125
[rfa agg] iter: 3, weight: tensor([0.0402, 0.0073, 0.0401, 0.5581, 0.0958, 0.0271, 0.0405, 0.0850, 0.0486,
        0.0573])
[rfa agg] iter:  4, prev_obj_val: 78.62962341308594, obj_val: 84.27813720703125, abs dis: 5.6485137939453125
[rfa agg] iter: 4, weight: tensor([0.0304, 0.0053, 0.0303, 0.6947, 0.0615, 0.0202, 0.0307, 0.0553, 0.0330,
        0.0385])
[rfa agg] iter:  5, prev_obj_val: 84.27813720703125, obj_val: 80.39514923095703, abs dis: 3.8829879760742188
[rfa agg] iter: 5, weight: tensor([0.0804, 0.0118, 0.0802, 0.3778, 0.0988, 0.0495, 0.0813, 0.0913, 0.0604,
        0.0685])
[rfa agg] iter:  6, prev_obj_val: 80.39514923095703, obj_val: 80.36065673828125, abs dis: 0.03449249267578125
[rfa agg] iter: 6, weight: tensor([0.0485, 0.0080, 0.0483, 0.5558, 0.0831, 0.0314, 0.0489, 0.0755, 0.0467,
        0.0539])
[rfa agg] iter:  7, prev_obj_val: 80.36065673828125, obj_val: 82.28311920166016, abs dis: 1.9224624633789062
[rfa agg] iter: 7, weight: tensor([0.0442, 0.0073, 0.0441, 0.5942, 0.0759, 0.0287, 0.0446, 0.0689, 0.0427,
        0.0493])
[rfa agg] iter:  8, prev_obj_val: 82.28311920166016, obj_val: 86.18559265136719, abs dis: 3.9024734497070312
[rfa agg] iter: 8, weight: tensor([0.0631, 0.0099, 0.0630, 0.4686, 0.0918, 0.0400, 0.0638, 0.0842, 0.0539,
        0.0617])
[rfa agg] iter:  9, prev_obj_val: 86.18559265136719, obj_val: 84.21434020996094, abs dis: 1.97125244140625
[rfa agg] iter: 9, weight: tensor([0.0981, 0.0133, 0.0978, 0.3037, 0.1007, 0.0582, 0.0992, 0.0937, 0.0636,
        0.0717])
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3547, Accuracy: 54/10000 (0.5400%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.3785, Accuracy: 0/9950 (0.0000%)
saving model
Done in 426.556031703949 sec.
Server Epoch:25 choose agents : [74, 18, 82, 53, 32, 64, 95, 19, 44, 38].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0470, Accuracy: 404/1552 (26.0309%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0243, Accuracy: 602/1552 (38.7887%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Avg loss: 0.0229, Accuracy: 631/1552 (40.6572%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Avg loss: 0.0223, Accuracy: 701/1552 (45.1675%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Avg loss: 0.0221, Accuracy: 693/1552 (44.6521%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Avg loss: 0.0215, Accuracy: 736/1552 (47.4227%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Avg loss: 0.0209, Accuracy: 766/1552 (49.3557%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Avg loss: 0.0207, Accuracy: 803/1552 (51.7397%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Avg loss: 0.0208, Accuracy: 812/1552 (52.3196%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Avg loss: 0.0207, Accuracy: 799/1552 (51.4820%), train_poison_data_count: 496
Global model norm: 112.02111181463742.
Norm before scaling: 111.99692640174328. Distance: 1.1915320158069582
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.0080, Accuracy: 78/10000 (0.7800%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 1.0032, Accuracy: 6899/9950 (69.3367%)
Scaling by  100
Scaled Norm after poisoning: 161.4392481999808, distance: 119.15318888672263
Total norm for 3 adversaries is: 161.4392481999808. distance: 119.15318888672263
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   1, Avg loss: 0.0728, Accuracy: 134/530 (25.2830%)
_Train Local_ResNet_18, epoch  25, local model 18, internal_epoch   2, Avg loss: 0.0359, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.9077, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   1, Avg loss: 0.0760, Accuracy: 71/500 (14.2000%)
_Train Local_ResNet_18, epoch  25, local model 82, internal_epoch   2, Avg loss: 0.0492, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.8765, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   1, Avg loss: 0.0502, Accuracy: 294/813 (36.1624%)
_Train Local_ResNet_18, epoch  25, local model 53, internal_epoch   2, Avg loss: 0.0181, Accuracy: 516/813 (63.4686%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 11.4686, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0602, Accuracy: 206/735 (28.0272%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0221, Accuracy: 385/735 (52.3810%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.0571, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   1, Avg loss: 0.0617, Accuracy: 188/953 (19.7272%)
_Train Local_ResNet_18, epoch  25, local model 64, internal_epoch   2, Avg loss: 0.0373, Accuracy: 335/953 (35.1522%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.3029, Accuracy: 69/10000 (0.6900%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   1, Avg loss: 0.0548, Accuracy: 331/599 (55.2588%)
_Train Local_ResNet_18, epoch  25, local model 95, internal_epoch   2, Avg loss: 0.0280, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.5473, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   1, Avg loss: 0.0462, Accuracy: 422/1036 (40.7336%)
_Train Local_ResNet_18, epoch  25, local model 19, internal_epoch   2, Avg loss: 0.0244, Accuracy: 693/1036 (66.8919%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 10.5669, Accuracy: 79/10000 (0.7900%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   1, Avg loss: 0.0574, Accuracy: 418/1750 (23.8857%)
_Train Local_ResNet_18, epoch  25, local model 44, internal_epoch   2, Avg loss: 0.0338, Accuracy: 735/1750 (42.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.8321, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   1, Avg loss: 0.0593, Accuracy: 270/1131 (23.8727%)
_Train Local_ResNet_18, epoch  25, local model 38, internal_epoch   2, Avg loss: 0.0293, Accuracy: 528/1131 (46.6844%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.3408, Accuracy: 89/10000 (0.8900%)
time spent on training: 297.99779295921326
[rfa agg] training data poison_ratio: 0.40639649963537866  data num: [1552, 530, 500, 813, 735, 953, 599, 1036, 1750, 1131]
[rfa agg] considering poison per batch poison_fraction: 0.12699890613605583
[rfa agg] init. name: [74, 18, 82, 53, 32, 64, 95, 19, 44, 38], weight: tensor([0.1617, 0.0552, 0.0521, 0.0847, 0.0766, 0.0993, 0.0624, 0.1079, 0.1823,
        0.1178])
[rfa agg] iter:  0, prev_obj_val: 30252.66796875, obj_val: 20744.546875, abs dis: 9508.12109375
[rfa agg] iter: 0, weight: tensor([0.0358, 0.0633, 0.0596, 0.0972, 0.0879, 0.1141, 0.0715, 0.1241, 0.2109,
        0.1356])
[rfa agg] iter:  1, prev_obj_val: 20744.546875, obj_val: 18574.830078125, abs dis: 2169.716796875
[rfa agg] iter: 1, weight: tensor([0.0071, 0.0643, 0.0605, 0.0994, 0.0897, 0.1171, 0.0728, 0.1279, 0.2214,
        0.1399])
[rfa agg] iter:  2, prev_obj_val: 18574.830078125, obj_val: 18145.30859375, abs dis: 429.521484375
[rfa agg] iter: 2, weight: tensor([0.0013, 0.0599, 0.0559, 0.0960, 0.0858, 0.1151, 0.0685, 0.1280, 0.2480,
        0.1414])
[rfa agg] iter:  3, prev_obj_val: 18145.30859375, obj_val: 18101.826171875, abs dis: 43.482421875
[rfa agg] iter: 3, weight: tensor([1.5833e-04, 2.9303e-02, 2.6495e-02, 5.4393e-02, 4.6725e-02, 7.1236e-02,
        3.4620e-02, 8.7662e-02, 5.4684e-01, 1.0256e-01])
[rfa agg] iter:  4, prev_obj_val: 18101.826171875, obj_val: 18094.4453125, abs dis: 7.380859375
[rfa agg] iter: 4, weight: tensor([9.3185e-05, 3.3042e-02, 2.8785e-02, 7.5732e-02, 6.0978e-02, 1.1776e-01,
        4.0710e-02, 1.8674e-01, 1.8694e-01, 2.6921e-01])
[rfa agg] iter:  5, prev_obj_val: 18094.4453125, obj_val: 18100.109375, abs dis: 5.6640625
[rfa agg] iter: 5, weight: tensor([4.3247e-05, 2.6244e-02, 2.1700e-02, 9.1743e-02, 6.3124e-02, 2.6364e-01,
        3.4524e-02, 2.6396e-01, 5.0615e-02, 1.8440e-01])
[rfa agg] iter:  6, prev_obj_val: 18100.109375, obj_val: 18103.81640625, abs dis: 3.70703125
[rfa agg] iter: 6, weight: tensor([4.1219e-05, 3.8695e-02, 3.0021e-02, 3.1634e-01, 1.4841e-01, 1.9330e-01,
        5.5723e-02, 9.5687e-02, 3.9936e-02, 8.1850e-02])
[rfa agg] iter:  7, prev_obj_val: 18103.81640625, obj_val: 18108.90234375, abs dis: 5.0859375
[rfa agg] iter: 7, weight: tensor([3.5198e-05, 4.2266e-02, 3.1307e-02, 3.2742e-01, 2.7603e-01, 1.0382e-01,
        6.5891e-02, 6.3885e-02, 3.1916e-02, 5.7436e-02])
[rfa agg] iter:  8, prev_obj_val: 18108.90234375, obj_val: 18108.8828125, abs dis: 0.01953125
[rfa agg] iter: 8, weight: tensor([4.0938e-05, 6.7744e-02, 4.6653e-02, 1.7047e-01, 3.5315e-01, 8.7405e-02,
        1.2177e-01, 6.1155e-02, 3.4881e-02, 5.6731e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3544, Accuracy: 57/10000 (0.5700%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.1239, Accuracy: 0/9950 (0.0000%)
saving model
Done in 557.4032022953033 sec.
Server Epoch:26 choose agents : [19, 3, 96, 58, 94, 68, 87, 88, 54, 66].
_Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   1, Avg loss: 0.0450, Accuracy: 406/1036 (39.1892%)
_Train Local_ResNet_18, epoch  26, local model 19, internal_epoch   2, Avg loss: 0.0242, Accuracy: 640/1036 (61.7761%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 10.6255, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.0680, Accuracy: 142/781 (18.1818%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0345, Accuracy: 247/781 (31.6261%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.6604, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   1, Avg loss: 0.0793, Accuracy: 47/311 (15.1125%)
_Train Local_ResNet_18, epoch  26, local model 96, internal_epoch   2, Avg loss: 0.0523, Accuracy: 140/311 (45.0161%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.8515, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   1, Avg loss: 0.0555, Accuracy: 348/803 (43.3375%)
_Train Local_ResNet_18, epoch  26, local model 58, internal_epoch   2, Avg loss: 0.0329, Accuracy: 399/803 (49.6887%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.7280, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   1, Avg loss: 0.0539, Accuracy: 385/1662 (23.1649%)
_Train Local_ResNet_18, epoch  26, local model 94, internal_epoch   2, Avg loss: 0.0320, Accuracy: 647/1662 (38.9290%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.5106, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   1, Avg loss: 0.0622, Accuracy: 369/1163 (31.7283%)
_Train Local_ResNet_18, epoch  26, local model 68, internal_epoch   2, Avg loss: 0.0351, Accuracy: 499/1163 (42.9063%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.4939, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   1, Avg loss: 0.0557, Accuracy: 332/1131 (29.3546%)
_Train Local_ResNet_18, epoch  26, local model 87, internal_epoch   2, Avg loss: 0.0308, Accuracy: 405/1131 (35.8090%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.4288, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   1, Avg loss: 0.0736, Accuracy: 151/603 (25.0415%)
_Train Local_ResNet_18, epoch  26, local model 88, internal_epoch   2, Avg loss: 0.0442, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.9378, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   1, Avg loss: 0.0547, Accuracy: 343/1130 (30.3540%)
_Train Local_ResNet_18, epoch  26, local model 54, internal_epoch   2, Avg loss: 0.0279, Accuracy: 497/1130 (43.9823%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.9487, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   1, Avg loss: 0.0597, Accuracy: 291/1402 (20.7561%)
_Train Local_ResNet_18, epoch  26, local model 66, internal_epoch   2, Avg loss: 0.0378, Accuracy: 419/1402 (29.8859%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.9449, Accuracy: 73/10000 (0.7300%)
time spent on training: 173.56904768943787
[rfa agg] training data poison_ratio: 0.0  data num: [1036, 781, 311, 803, 1662, 1163, 1131, 603, 1130, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [19, 3, 96, 58, 94, 68, 87, 88, 54, 66], weight: tensor([0.1034, 0.0779, 0.0310, 0.0801, 0.1658, 0.1160, 0.1129, 0.0602, 0.1128,
        0.1399])
[rfa agg] iter:  0, prev_obj_val: 38.07221221923828, obj_val: 41.756534576416016, abs dis: 3.6843223571777344
[rfa agg] iter: 0, weight: tensor([0.3014, 0.0409, 0.0055, 0.0422, 0.0391, 0.1140, 0.1944, 0.0182, 0.1855,
        0.0589])
[rfa agg] iter:  1, prev_obj_val: 41.756534576416016, obj_val: 43.89656066894531, abs dis: 2.140026092529297
[rfa agg] iter: 1, weight: tensor([0.2683, 0.0747, 0.0083, 0.0772, 0.0489, 0.1099, 0.1584, 0.0295, 0.1566,
        0.0683])
[rfa agg] iter:  2, prev_obj_val: 43.89656066894531, obj_val: 46.084693908691406, abs dis: 2.1881332397460938
[rfa agg] iter: 2, weight: tensor([0.2182, 0.1016, 0.0100, 0.1052, 0.0533, 0.1090, 0.1474, 0.0368, 0.1462,
        0.0723])
[rfa agg] iter:  3, prev_obj_val: 46.084693908691406, obj_val: 50.58482360839844, abs dis: 4.500129699707031
[rfa agg] iter: 3, weight: tensor([0.1792, 0.1336, 0.0112, 0.1388, 0.0544, 0.1028, 0.1329, 0.0433, 0.1319,
        0.0719])
[rfa agg] iter:  4, prev_obj_val: 50.58482360839844, obj_val: 52.92579650878906, abs dis: 2.340972900390625
[rfa agg] iter: 4, weight: tensor([0.1140, 0.2200, 0.0116, 0.2336, 0.0466, 0.0774, 0.0940, 0.0503, 0.0936,
        0.0588])
[rfa agg] iter:  5, prev_obj_val: 52.92579650878906, obj_val: 58.76472091674805, abs dis: 5.838924407958984
[rfa agg] iter: 5, weight: tensor([0.0807, 0.2779, 0.0102, 0.3058, 0.0368, 0.0581, 0.0690, 0.0472, 0.0687,
        0.0456])
[rfa agg] iter:  6, prev_obj_val: 58.76472091674805, obj_val: 58.76350402832031, abs dis: 0.001216888427734375
[rfa agg] iter: 6, weight: tensor([0.0645, 0.2923, 0.0117, 0.3228, 0.0348, 0.0503, 0.0578, 0.0665, 0.0576,
        0.0417])
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3568, Accuracy: 64/10000 (0.6400%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.1384, Accuracy: 0/9950 (0.0000%)
saving model
Done in 420.0826539993286 sec.
Server Epoch:27 choose agents : [95, 51, 93, 9, 60, 99, 31, 17, 49, 65].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0628, Accuracy: 190/599 (31.7195%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0262, Accuracy: 308/599 (51.4190%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Avg loss: 0.0263, Accuracy: 325/599 (54.2571%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Avg loss: 0.0248, Accuracy: 351/599 (58.5977%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Avg loss: 0.0264, Accuracy: 340/599 (56.7613%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Avg loss: 0.0241, Accuracy: 353/599 (58.9316%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Avg loss: 0.0234, Accuracy: 374/599 (62.4374%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Avg loss: 0.0224, Accuracy: 365/599 (60.9349%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Avg loss: 0.0218, Accuracy: 387/599 (64.6077%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Avg loss: 0.0213, Accuracy: 378/599 (63.1052%), train_poison_data_count: 200
Global model norm: 112.01901519663971.
Norm before scaling: 112.0113694006104. Distance: 0.7664132245258751
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.5005, Accuracy: 55/10000 (0.5500%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.7564, Accuracy: 4536/9950 (45.5879%)
Scaling by  100
Scaled Norm after poisoning: 134.87806269692265, distance: 76.6413242195423
Total norm for 3 adversaries is: 134.87806269692265. distance: 76.6413242195423
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0579, Accuracy: 259/1049 (24.6902%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0286, Accuracy: 540/1049 (51.4776%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.3203, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   1, Avg loss: 0.0545, Accuracy: 426/1742 (24.4546%)
_Train Local_ResNet_18, epoch  27, local model 93, internal_epoch   2, Avg loss: 0.0311, Accuracy: 715/1742 (41.0448%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.4384, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   1, Avg loss: 0.0471, Accuracy: 406/1275 (31.8431%)
_Train Local_ResNet_18, epoch  27, local model 9, internal_epoch   2, Avg loss: 0.0185, Accuracy: 752/1275 (58.9804%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 10.6520, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   1, Avg loss: 0.0481, Accuracy: 686/2227 (30.8038%)
_Train Local_ResNet_18, epoch  27, local model 60, internal_epoch   2, Avg loss: 0.0271, Accuracy: 1043/2227 (46.8343%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.0755, Accuracy: 144/10000 (1.4400%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   1, Avg loss: 0.0611, Accuracy: 241/773 (31.1772%)
_Train Local_ResNet_18, epoch  27, local model 99, internal_epoch   2, Avg loss: 0.0271, Accuracy: 435/773 (56.2743%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.9215, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   1, Avg loss: 0.0826, Accuracy: 71/460 (15.4348%)
_Train Local_ResNet_18, epoch  27, local model 31, internal_epoch   2, Avg loss: 0.0367, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.0108, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   1, Avg loss: 0.0496, Accuracy: 453/1574 (28.7802%)
_Train Local_ResNet_18, epoch  27, local model 17, internal_epoch   2, Avg loss: 0.0262, Accuracy: 724/1574 (45.9975%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 8.7327, Accuracy: 109/10000 (1.0900%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   1, Avg loss: 0.0764, Accuracy: 49/440 (11.1364%)
_Train Local_ResNet_18, epoch  27, local model 49, internal_epoch   2, Avg loss: 0.0459, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.5329, Accuracy: 50/10000 (0.5000%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   1, Avg loss: 0.0531, Accuracy: 439/1475 (29.7627%)
_Train Local_ResNet_18, epoch  27, local model 65, internal_epoch   2, Avg loss: 0.0311, Accuracy: 713/1475 (48.3390%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.7215, Accuracy: 94/10000 (0.9400%)
time spent on training: 298.52330684661865
[rfa agg] training data poison_ratio: 0.2164628896159807  data num: [599, 1049, 1742, 1275, 2227, 773, 460, 1574, 440, 1475]
[rfa agg] considering poison per batch poison_fraction: 0.06764465300499398
[rfa agg] init. name: [95, 51, 93, 9, 60, 99, 31, 17, 49, 65], weight: tensor([0.0516, 0.0903, 0.1500, 0.1098, 0.1918, 0.0666, 0.0396, 0.1355, 0.0379,
        0.1270])
[rfa agg] iter:  0, prev_obj_val: 4335.990234375, obj_val: 2395.248779296875, abs dis: 1940.741455078125
[rfa agg] iter: 0, weight: tensor([0.0029, 0.0924, 0.1602, 0.1136, 0.2107, 0.0671, 0.0392, 0.1430, 0.0373,
        0.1335])
[rfa agg] iter:  1, prev_obj_val: 2395.248779296875, obj_val: 2362.178955078125, abs dis: 33.06982421875
[rfa agg] iter: 1, weight: tensor([5.3187e-05, 2.4300e-02, 9.5110e-02, 3.5073e-02, 6.9982e-01, 1.4805e-02,
        7.2399e-03, 6.2886e-02, 6.6869e-03, 5.4026e-02])
[rfa agg] iter:  2, prev_obj_val: 2362.178955078125, obj_val: 2350.49462890625, abs dis: 11.684326171875
[rfa agg] iter: 2, weight: tensor([5.4961e-05, 3.8096e-02, 4.0261e-01, 6.0742e-02, 1.8432e-01, 2.1315e-02,
        9.7482e-03, 1.5500e-01, 8.9110e-03, 1.1921e-01])
[rfa agg] iter:  3, prev_obj_val: 2350.49462890625, obj_val: 2353.990966796875, abs dis: 3.496337890625
[rfa agg] iter: 3, weight: tensor([3.0000e-05, 3.4469e-02, 1.2131e-01, 6.8955e-02, 5.2619e-02, 1.6691e-02,
        6.9396e-03, 3.7809e-01, 6.2610e-03, 3.1463e-01])
[rfa agg] iter:  4, prev_obj_val: 2353.990966796875, obj_val: 2355.308349609375, abs dis: 1.3173828125
[rfa agg] iter: 4, weight: tensor([4.3382e-05, 6.7347e-02, 1.1182e-01, 1.7177e-01, 6.3970e-02, 2.9189e-02,
        1.1419e-02, 2.2001e-01, 1.0224e-02, 3.1421e-01])
[rfa agg] iter:  5, prev_obj_val: 2355.308349609375, obj_val: 2358.1181640625, abs dis: 2.809814453125
[rfa agg] iter: 5, weight: tensor([4.6370e-05, 7.9071e-02, 1.1001e-01, 2.2679e-01, 6.5784e-02, 3.2930e-02,
        1.2644e-02, 1.9598e-01, 1.1295e-02, 2.6545e-01])
[rfa agg] iter:  6, prev_obj_val: 2358.1181640625, obj_val: 2358.0830078125, abs dis: 0.03515625
[rfa agg] iter: 6, weight: tensor([4.4662e-05, 9.4242e-02, 9.1260e-02, 3.7567e-01, 5.8879e-02, 3.5645e-02,
        1.3116e-02, 1.4343e-01, 1.1657e-02, 1.7606e-01])
[rfa agg] iter:  7, prev_obj_val: 2358.0830078125, obj_val: 2361.24560546875, abs dis: 3.16259765625
[rfa agg] iter: 7, weight: tensor([4.3478e-05, 9.1926e-02, 8.8792e-02, 3.9436e-01, 5.7311e-02, 3.4698e-02,
        1.2768e-02, 1.3922e-01, 1.1348e-02, 1.6953e-01])
[rfa agg] iter:  8, prev_obj_val: 2361.24560546875, obj_val: 2363.275146484375, abs dis: 2.029541015625
[rfa agg] iter: 8, weight: tensor([3.2328e-05, 8.9082e-02, 5.7950e-02, 5.8448e-01, 3.9797e-02, 2.9430e-02,
        1.0284e-02, 8.3442e-02, 9.0874e-03, 9.6420e-02])
[rfa agg] iter:  9, prev_obj_val: 2363.275146484375, obj_val: 2367.9775390625, abs dis: 4.702392578125
[rfa agg] iter: 9, weight: tensor([3.4106e-05, 1.0988e-01, 5.7539e-02, 5.6695e-01, 4.0627e-02, 3.3352e-02,
        1.1316e-02, 7.9976e-02, 9.9677e-03, 9.0366e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3608, Accuracy: 63/10000 (0.6300%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.1184, Accuracy: 0/9950 (0.0000%)
saving model
Done in 545.5714166164398 sec.
Server Epoch:28 choose agents : [51, 19, 66, 24, 25, 80, 58, 15, 0, 90].
_Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   1, Avg loss: 0.0576, Accuracy: 264/1049 (25.1668%)
_Train Local_ResNet_18, epoch  28, local model 51, internal_epoch   2, Avg loss: 0.0281, Accuracy: 558/1049 (53.1935%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9447, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   1, Avg loss: 0.0461, Accuracy: 440/1036 (42.4710%)
_Train Local_ResNet_18, epoch  28, local model 19, internal_epoch   2, Avg loss: 0.0232, Accuracy: 687/1036 (66.3127%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 11.0569, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   1, Avg loss: 0.0595, Accuracy: 275/1402 (19.6148%)
_Train Local_ResNet_18, epoch  28, local model 66, internal_epoch   2, Avg loss: 0.0379, Accuracy: 377/1402 (26.8902%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.5214, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   1, Avg loss: 0.0716, Accuracy: 94/312 (30.1282%)
_Train Local_ResNet_18, epoch  28, local model 24, internal_epoch   2, Avg loss: 0.0367, Accuracy: 196/312 (62.8205%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.5371, Accuracy: 64/10000 (0.6400%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   1, Avg loss: 0.0546, Accuracy: 312/690 (45.2174%)
_Train Local_ResNet_18, epoch  28, local model 25, internal_epoch   2, Avg loss: 0.0252, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.0898, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 147/682 (21.5543%)
_Train Local_ResNet_18, epoch  28, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 259/682 (37.9765%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.8423, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   1, Avg loss: 0.0543, Accuracy: 365/803 (45.4545%)
_Train Local_ResNet_18, epoch  28, local model 58, internal_epoch   2, Avg loss: 0.0327, Accuracy: 378/803 (47.0735%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.9838, Accuracy: 61/10000 (0.6100%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   1, Avg loss: 0.0589, Accuracy: 316/1154 (27.3830%)
_Train Local_ResNet_18, epoch  28, local model 15, internal_epoch   2, Avg loss: 0.0301, Accuracy: 385/1154 (33.3622%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.4266, Accuracy: 79/10000 (0.7900%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   1, Avg loss: 0.0573, Accuracy: 379/1657 (22.8727%)
_Train Local_ResNet_18, epoch  28, local model 0, internal_epoch   2, Avg loss: 0.0337, Accuracy: 561/1657 (33.8564%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.2461, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   1, Avg loss: 0.0573, Accuracy: 322/677 (47.5628%)
_Train Local_ResNet_18, epoch  28, local model 90, internal_epoch   2, Avg loss: 0.0226, Accuracy: 447/677 (66.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 9.0892, Accuracy: 64/10000 (0.6400%)
time spent on training: 202.61142230033875
[rfa agg] training data poison_ratio: 0.37000634115409003  data num: [1049, 1036, 1402, 312, 690, 682, 803, 1154, 1657, 677]
[rfa agg] considering poison per batch poison_fraction: 0.11562698161065313
[rfa agg] init. name: [51, 19, 66, 24, 25, 80, 58, 15, 0, 90], weight: tensor([0.1109, 0.1095, 0.1482, 0.0330, 0.0729, 0.0721, 0.0849, 0.1220, 0.1751,
        0.0715])
[rfa agg] iter:  0, prev_obj_val: 47.79512405395508, obj_val: 50.67299270629883, abs dis: 2.87786865234375
[rfa agg] iter: 0, weight: tensor([0.1857, 0.1939, 0.0796, 0.0125, 0.0682, 0.0675, 0.1524, 0.1131, 0.0601,
        0.0671])
[rfa agg] iter:  1, prev_obj_val: 50.67299270629883, obj_val: 58.13031005859375, abs dis: 7.457317352294922
[rfa agg] iter: 1, weight: tensor([0.1282, 0.1294, 0.0672, 0.0133, 0.0868, 0.0859, 0.2628, 0.0877, 0.0530,
        0.0856])
[rfa agg] iter:  2, prev_obj_val: 58.13031005859375, obj_val: 66.80704498291016, abs dis: 8.676734924316406
[rfa agg] iter: 2, weight: tensor([0.0607, 0.0605, 0.0413, 0.0131, 0.1763, 0.1755, 0.2105, 0.0484, 0.0349,
        0.1788])
[rfa agg] iter:  3, prev_obj_val: 66.80704498291016, obj_val: 63.18107604980469, abs dis: 3.6259689331054688
[rfa agg] iter: 3, weight: tensor([0.0399, 0.0397, 0.0305, 0.0142, 0.2415, 0.2403, 0.0788, 0.0339, 0.0268,
        0.2544])
[rfa agg] iter:  4, prev_obj_val: 63.18107604980469, obj_val: 70.79158782958984, abs dis: 7.610511779785156
[rfa agg] iter: 4, weight: tensor([0.0302, 0.0301, 0.0223, 0.0091, 0.2537, 0.2490, 0.0675, 0.0252, 0.0194,
        0.2934])
[rfa agg] iter:  5, prev_obj_val: 70.79158782958984, obj_val: 74.88097381591797, abs dis: 4.089385986328125
[rfa agg] iter: 5, weight: tensor([0.0522, 0.0519, 0.0411, 0.0220, 0.2199, 0.2165, 0.0925, 0.0450, 0.0365,
        0.2225])
[rfa agg] iter:  6, prev_obj_val: 74.88097381591797, obj_val: 58.110137939453125, abs dis: 16.770835876464844
[rfa agg] iter: 6, weight: tensor([0.0627, 0.0622, 0.0507, 0.0313, 0.1981, 0.1958, 0.1024, 0.0548, 0.0454,
        0.1969])
[rfa agg] iter:  7, prev_obj_val: 58.110137939453125, obj_val: 63.21392059326172, abs dis: 5.103782653808594
[rfa agg] iter: 7, weight: tensor([0.0600, 0.0599, 0.0409, 0.0130, 0.1807, 0.1790, 0.2018, 0.0479, 0.0346,
        0.1822])
[rfa agg] iter:  8, prev_obj_val: 63.21392059326172, obj_val: 63.17903137207031, abs dis: 0.03488922119140625
[rfa agg] iter: 8, weight: tensor([0.0318, 0.0317, 0.0235, 0.0096, 0.2500, 0.2499, 0.0718, 0.0265, 0.0204,
        0.2847])
[rfa agg] iter:  9, prev_obj_val: 63.17903137207031, obj_val: 74.88832092285156, abs dis: 11.70928955078125
[rfa agg] iter: 9, weight: tensor([0.0299, 0.0298, 0.0221, 0.0090, 0.2525, 0.2463, 0.0668, 0.0250, 0.0192,
        0.2994])
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3600, Accuracy: 64/10000 (0.6400%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.1278, Accuracy: 0/9950 (0.0000%)
saving model
Done in 450.229022026062 sec.
Server Epoch:29 choose agents : [5, 8, 98, 14, 70, 64, 74, 49, 75, 78].
poison local model 5 index 4 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   1, Avg loss: 0.0512, Accuracy: 418/1628 (25.6757%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   2, Avg loss: 0.0273, Accuracy: 652/1628 (40.0491%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   3, Avg loss: 0.0256, Accuracy: 715/1628 (43.9189%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   4, Avg loss: 0.0245, Accuracy: 842/1628 (51.7199%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   5, Avg loss: 0.0238, Accuracy: 860/1628 (52.8256%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   6, Avg loss: 0.0232, Accuracy: 904/1628 (55.5283%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   7, Avg loss: 0.0221, Accuracy: 946/1628 (58.1081%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   8, Avg loss: 0.0208, Accuracy: 975/1628 (59.8894%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch   9, Avg loss: 0.0212, Accuracy: 997/1628 (61.2408%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  29, local model 5, internal_epoch  10, Avg loss: 0.0210, Accuracy: 1007/1628 (61.8550%), train_poison_data_count: 520
Global model norm: 112.01633443247239.
Norm before scaling: 111.99068303183752. Distance: 1.203647202948079
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.5987, Accuracy: 124/10000 (1.2400%)
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: 0.7649, Accuracy: 9176/9950 (92.2211%)
Scaling by  100
Scaled Norm after poisoning: 162.2224131497402, distance: 120.36472080981619
Total norm for 3 adversaries is: 162.2224131497402. distance: 120.36472080981619
_Test Local_ResNet_18 poisoned: True, epoch: 29, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   1, Avg loss: 0.0566, Accuracy: 314/1513 (20.7535%)
_Train Local_ResNet_18, epoch  29, local model 8, internal_epoch   2, Avg loss: 0.0348, Accuracy: 521/1513 (34.4349%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.8342, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   1, Avg loss: 0.0812, Accuracy: 27/373 (7.2386%)
_Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   2, Avg loss: 0.0466, Accuracy: 156/373 (41.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.4095, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   1, Avg loss: 0.0601, Accuracy: 227/1013 (22.4087%)
_Train Local_ResNet_18, epoch  29, local model 14, internal_epoch   2, Avg loss: 0.0335, Accuracy: 373/1013 (36.8213%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.2382, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   1, Avg loss: 0.0536, Accuracy: 447/1418 (31.5233%)
_Train Local_ResNet_18, epoch  29, local model 70, internal_epoch   2, Avg loss: 0.0291, Accuracy: 684/1418 (48.2370%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.2190, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   1, Avg loss: 0.0617, Accuracy: 188/953 (19.7272%)
_Train Local_ResNet_18, epoch  29, local model 64, internal_epoch   2, Avg loss: 0.0366, Accuracy: 351/953 (36.8311%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.3334, Accuracy: 71/10000 (0.7100%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   1, Avg loss: 0.0418, Accuracy: 544/1552 (35.0515%)
_Train Local_ResNet_18, epoch  29, local model 74, internal_epoch   2, Avg loss: 0.0204, Accuracy: 783/1552 (50.4510%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 11.8640, Accuracy: 97/10000 (0.9700%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   1, Avg loss: 0.0766, Accuracy: 47/440 (10.6818%)
_Train Local_ResNet_18, epoch  29, local model 49, internal_epoch   2, Avg loss: 0.0458, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.7157, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   1, Avg loss: 0.0612, Accuracy: 274/776 (35.3093%)
_Train Local_ResNet_18, epoch  29, local model 75, internal_epoch   2, Avg loss: 0.0257, Accuracy: 432/776 (55.6701%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.8805, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   1, Avg loss: 0.0846, Accuracy: 41/416 (9.8558%)
_Train Local_ResNet_18, epoch  29, local model 78, internal_epoch   2, Avg loss: 0.0457, Accuracy: 193/416 (46.3942%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.5383, Accuracy: 55/10000 (0.5500%)
time spent on training: 305.7272574901581
[rfa agg] training data poison_ratio: 0.3590557429081531  data num: [1628, 1513, 373, 1013, 1418, 953, 1552, 440, 776, 416]
[rfa agg] considering poison per batch poison_fraction: 0.11220491965879785
[rfa agg] init. name: [5, 8, 98, 14, 70, 64, 74, 49, 75, 78], weight: tensor([0.1615, 0.1501, 0.0370, 0.1005, 0.1406, 0.0945, 0.1539, 0.0436, 0.0770,
        0.0413])
[rfa agg] iter:  0, prev_obj_val: 31430.681640625, obj_val: 21541.34765625, abs dis: 9889.333984375
[rfa agg] iter: 0, weight: tensor([0.0357, 0.1730, 0.0423, 0.1154, 0.1621, 0.1085, 0.1776, 0.0499, 0.0883,
        0.0472])
[rfa agg] iter:  1, prev_obj_val: 21541.34765625, obj_val: 19288.5625, abs dis: 2252.78515625
[rfa agg] iter: 1, weight: tensor([0.0070, 0.1798, 0.0426, 0.1183, 0.1682, 0.1111, 0.1849, 0.0504, 0.0900,
        0.0477])
[rfa agg] iter:  2, prev_obj_val: 19288.5625, obj_val: 18843.625, abs dis: 444.9375
[rfa agg] iter: 2, weight: tensor([0.0013, 0.1895, 0.0384, 0.1158, 0.1755, 0.1078, 0.1967, 0.0458, 0.0859,
        0.0433])
[rfa agg] iter:  3, prev_obj_val: 18843.625, obj_val: 18788.595703125, abs dis: 55.029296875
[rfa agg] iter: 3, weight: tensor([1.9644e-04, 2.3586e-01, 2.0838e-02, 8.7969e-02, 2.0105e-01, 7.8411e-02,
        2.6831e-01, 2.5491e-02, 5.7778e-02, 2.4100e-02])
[rfa agg] iter:  4, prev_obj_val: 18788.595703125, obj_val: 18790.330078125, abs dis: 1.734375
[rfa agg] iter: 4, weight: tensor([5.3892e-05, 2.4779e-01, 1.0330e-02, 7.8219e-02, 3.5184e-01, 6.2472e-02,
        1.8491e-01, 1.3024e-02, 3.9041e-02, 1.2312e-02])
[rfa agg] iter:  5, prev_obj_val: 18790.330078125, obj_val: 18793.107421875, abs dis: 2.77734375
[rfa agg] iter: 5, weight: tensor([6.6400e-05, 2.2344e-01, 1.3602e-02, 1.1685e-01, 2.8935e-01, 9.0626e-02,
        1.7815e-01, 1.7231e-02, 5.4395e-02, 1.6289e-02])
[rfa agg] iter:  6, prev_obj_val: 18793.107421875, obj_val: 18795.0, abs dis: 1.892578125
[rfa agg] iter: 6, weight: tensor([7.4228e-05, 1.7687e-01, 1.6962e-02, 1.9260e-01, 2.0624e-01, 1.3821e-01,
        1.5106e-01, 2.1672e-02, 7.5821e-02, 2.0485e-02])
[rfa agg] iter:  7, prev_obj_val: 18795.0, obj_val: 18795.962890625, abs dis: 0.962890625
[rfa agg] iter: 7, weight: tensor([6.9802e-05, 1.3894e-01, 1.7283e-02, 2.6538e-01, 1.5573e-01, 1.7175e-01,
        1.2219e-01, 2.2237e-02, 8.5402e-02, 2.1019e-02])
[rfa agg] iter:  8, prev_obj_val: 18795.962890625, obj_val: 18798.021484375, abs dis: 2.05859375
[rfa agg] iter: 8, weight: tensor([6.3840e-05, 1.1733e-01, 1.6496e-02, 3.1700e-01, 1.2958e-01, 1.8702e-01,
        1.0439e-01, 2.1310e-02, 8.6665e-02, 2.0141e-02])
[rfa agg] iter:  9, prev_obj_val: 18798.021484375, obj_val: 18800.939453125, abs dis: 2.91796875
[rfa agg] iter: 9, weight: tensor([4.4055e-05, 7.0301e-02, 1.2467e-02, 4.6635e-01, 7.5887e-02, 2.0336e-01,
        6.3676e-02, 1.6252e-02, 7.6304e-02, 1.5359e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3629, Accuracy: 67/10000 (0.6700%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.0735, Accuracy: 0/9950 (0.0000%)
saving model
Done in 553.9675934314728 sec.
Server Epoch:30 choose agents : [72, 69, 82, 58, 15, 79, 52, 28, 1, 17].
_Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   1, Avg loss: 0.0591, Accuracy: 288/1241 (23.2071%)
_Train Local_ResNet_18, epoch  30, local model 72, internal_epoch   2, Avg loss: 0.0349, Accuracy: 487/1241 (39.2425%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7308, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   1, Avg loss: 0.0591, Accuracy: 282/590 (47.7966%)
_Train Local_ResNet_18, epoch  30, local model 69, internal_epoch   2, Avg loss: 0.0322, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.7080, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 71/500 (14.2000%)
_Train Local_ResNet_18, epoch  30, local model 82, internal_epoch   2, Avg loss: 0.0480, Accuracy: 191/500 (38.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.8546, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   1, Avg loss: 0.0535, Accuracy: 363/803 (45.2055%)
_Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   2, Avg loss: 0.0327, Accuracy: 397/803 (49.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.1774, Accuracy: 71/10000 (0.7100%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   1, Avg loss: 0.0582, Accuracy: 325/1154 (28.1629%)
_Train Local_ResNet_18, epoch  30, local model 15, internal_epoch   2, Avg loss: 0.0293, Accuracy: 406/1154 (35.1820%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.1771, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   1, Avg loss: 0.1079, Accuracy: 3/197 (1.5228%)
_Train Local_ResNet_18, epoch  30, local model 79, internal_epoch   2, Avg loss: 0.0882, Accuracy: 57/197 (28.9340%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.4232, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   1, Avg loss: 0.0562, Accuracy: 277/636 (43.5535%)
_Train Local_ResNet_18, epoch  30, local model 52, internal_epoch   2, Avg loss: 0.0295, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.1925, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   1, Avg loss: 0.0551, Accuracy: 388/1581 (24.5414%)
_Train Local_ResNet_18, epoch  30, local model 28, internal_epoch   2, Avg loss: 0.0324, Accuracy: 635/1581 (40.1645%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.8148, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0548, Accuracy: 296/928 (31.8966%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0224, Accuracy: 615/928 (66.2716%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 9.3568, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   1, Avg loss: 0.0498, Accuracy: 443/1574 (28.1449%)
_Train Local_ResNet_18, epoch  30, local model 17, internal_epoch   2, Avg loss: 0.0261, Accuracy: 713/1574 (45.2986%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 8.6694, Accuracy: 91/10000 (0.9100%)
time spent on training: 171.0144636631012
[rfa agg] training data poison_ratio: 0.12538026944806605  data num: [1241, 590, 500, 803, 1154, 197, 636, 1581, 928, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.03918133420252064
[rfa agg] init. name: [72, 69, 82, 58, 15, 79, 52, 28, 1, 17], weight: tensor([0.1348, 0.0641, 0.0543, 0.0872, 0.1254, 0.0214, 0.0691, 0.1718, 0.1008,
        0.1710])
[rfa agg] iter:  0, prev_obj_val: 52.992313385009766, obj_val: 58.453155517578125, abs dis: 5.460842132568359
[rfa agg] iter: 0, weight: tensor([0.1308, 0.0421, 0.0268, 0.1125, 0.1597, 0.0070, 0.0453, 0.0751, 0.3259,
        0.0748])
[rfa agg] iter:  1, prev_obj_val: 58.453155517578125, obj_val: 60.285804748535156, abs dis: 1.8326492309570312
[rfa agg] iter: 1, weight: tensor([0.0784, 0.0557, 0.0317, 0.2579, 0.0873, 0.0075, 0.0599, 0.0548, 0.3122,
        0.0546])
[rfa agg] iter:  2, prev_obj_val: 60.285804748535156, obj_val: 62.261741638183594, abs dis: 1.9759368896484375
[rfa agg] iter: 2, weight: tensor([0.0678, 0.0595, 0.0324, 0.3896, 0.0743, 0.0074, 0.0639, 0.0491, 0.2072,
        0.0489])
[rfa agg] iter:  3, prev_obj_val: 62.261741638183594, obj_val: 64.63275146484375, abs dis: 2.3710098266601562
[rfa agg] iter: 3, weight: tensor([0.0508, 0.0558, 0.0287, 0.5411, 0.0550, 0.0063, 0.0597, 0.0379, 0.1269,
        0.0378])
[rfa agg] iter:  4, prev_obj_val: 64.63275146484375, obj_val: 64.62910461425781, abs dis: 0.0036468505859375
[rfa agg] iter: 4, weight: tensor([0.0563, 0.0788, 0.0378, 0.4669, 0.0604, 0.0079, 0.0841, 0.0432, 0.1215,
        0.0430])
[rfa agg] iter:  5, prev_obj_val: 64.62910461425781, obj_val: 67.18457794189453, abs dis: 2.5554733276367188
[rfa agg] iter: 5, weight: tensor([0.0573, 0.0804, 0.0385, 0.4569, 0.0614, 0.0081, 0.0859, 0.0440, 0.1238,
        0.0438])
[rfa agg] iter:  6, prev_obj_val: 67.18457794189453, obj_val: 69.76514434814453, abs dis: 2.58056640625
[rfa agg] iter: 6, weight: tensor([0.0656, 0.1210, 0.0527, 0.3213, 0.0697, 0.0105, 0.1287, 0.0516, 0.1276,
        0.0514])
[rfa agg] iter:  7, prev_obj_val: 69.76514434814453, obj_val: 69.76022338867188, abs dis: 0.00492095947265625
[rfa agg] iter: 7, weight: tensor([0.0649, 0.1665, 0.0631, 0.2294, 0.0683, 0.0117, 0.1759, 0.0522, 0.1160,
        0.0520])
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3628, Accuracy: 69/10000 (0.6900%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.0877, Accuracy: 0/9950 (0.0000%)
saving model
Done in 417.8380079269409 sec.
Server Epoch:31 choose agents : [10, 79, 5, 85, 82, 35, 38, 44, 1, 72].
poison local model 10 index 5 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   1, Avg loss: 0.0584, Accuracy: 220/861 (25.5517%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   2, Avg loss: 0.0266, Accuracy: 335/861 (38.9082%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   3, Avg loss: 0.0220, Accuracy: 404/861 (46.9222%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   4, Avg loss: 0.0219, Accuracy: 397/861 (46.1092%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   5, Avg loss: 0.0215, Accuracy: 378/861 (43.9024%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   6, Avg loss: 0.0214, Accuracy: 437/861 (50.7549%), train_poison_data_count: 280
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   7, Avg loss: 0.0210, Accuracy: 437/861 (50.7549%), train_poison_data_count: 280
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   8, Avg loss: 0.0207, Accuracy: 431/861 (50.0581%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch   9, Avg loss: 0.0208, Accuracy: 419/861 (48.6643%), train_poison_data_count: 280
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  31, local model 10, internal_epoch  10, Avg loss: 0.0199, Accuracy: 453/861 (52.6132%), train_poison_data_count: 280
Global model norm: 112.01391951031131.
Norm before scaling: 112.00388438437079. Distance: 0.992583698856057
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.0562, Accuracy: 97/10000 (0.9700%)
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: 0.9734, Accuracy: 8591/9950 (86.3417%)
Scaling by  100
Scaled Norm after poisoning: 148.58064150908086, distance: 99.25837299379333
Total norm for 4 adversaries is: 148.58064150908086. distance: 99.25837299379333
_Test Local_ResNet_18 poisoned: True, epoch: 31, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   1, Avg loss: 0.1084, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 79, internal_epoch   2, Avg loss: 0.0885, Accuracy: 56/197 (28.4264%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.4048, Accuracy: 53/10000 (0.5300%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   1, Avg loss: 0.0489, Accuracy: 423/1628 (25.9828%)
_Train Local_ResNet_18, epoch  31, local model 5, internal_epoch   2, Avg loss: 0.0242, Accuracy: 869/1628 (53.3784%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.0388, Accuracy: 140/10000 (1.4000%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   1, Avg loss: 0.0532, Accuracy: 446/1988 (22.4346%)
_Train Local_ResNet_18, epoch  31, local model 85, internal_epoch   2, Avg loss: 0.0346, Accuracy: 704/1988 (35.4125%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.2364, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   1, Avg loss: 0.0759, Accuracy: 74/500 (14.8000%)
_Train Local_ResNet_18, epoch  31, local model 82, internal_epoch   2, Avg loss: 0.0476, Accuracy: 188/500 (37.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 6.8944, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   1, Avg loss: 0.0884, Accuracy: 17/271 (6.2731%)
_Train Local_ResNet_18, epoch  31, local model 35, internal_epoch   2, Avg loss: 0.0557, Accuracy: 130/271 (47.9705%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.9001, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   1, Avg loss: 0.0588, Accuracy: 293/1131 (25.9063%)
_Train Local_ResNet_18, epoch  31, local model 38, internal_epoch   2, Avg loss: 0.0284, Accuracy: 550/1131 (48.6295%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.1590, Accuracy: 98/10000 (0.9800%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   1, Avg loss: 0.0571, Accuracy: 398/1750 (22.7429%)
_Train Local_ResNet_18, epoch  31, local model 44, internal_epoch   2, Avg loss: 0.0342, Accuracy: 720/1750 (41.1429%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.7686, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0533, Accuracy: 303/928 (32.6509%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0218, Accuracy: 608/928 (65.5172%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 9.7040, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   1, Avg loss: 0.0591, Accuracy: 280/1241 (22.5624%)
_Train Local_ResNet_18, epoch  31, local model 72, internal_epoch   2, Avg loss: 0.0353, Accuracy: 464/1241 (37.3892%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.7544, Accuracy: 73/10000 (0.7300%)
time spent on training: 320.17069458961487
[rfa agg] training data poison_ratio: 0.5933301572177228  data num: [861, 197, 1628, 1988, 500, 271, 1131, 1750, 928, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.18541567413053836
[rfa agg] init. name: [10, 79, 5, 85, 82, 35, 38, 44, 1, 72], weight: tensor([0.0820, 0.0188, 0.1551, 0.1894, 0.0476, 0.0258, 0.1078, 0.1667, 0.0884,
        0.1182])
[rfa agg] iter:  0, prev_obj_val: 9383.5498046875, obj_val: 5517.72412109375, abs dis: 3865.82568359375
[rfa agg] iter: 0, weight: tensor([0.0079, 0.0196, 0.1686, 0.2080, 0.0502, 0.0271, 0.1155, 0.1818, 0.0942,
        0.1271])
[rfa agg] iter:  1, prev_obj_val: 5517.72412109375, obj_val: 5172.21630859375, abs dis: 345.5078125
[rfa agg] iter: 1, weight: tensor([0.0007, 0.0148, 0.1759, 0.2440, 0.0397, 0.0206, 0.1054, 0.1970, 0.0822,
        0.1197])
[rfa agg] iter:  2, prev_obj_val: 5172.21630859375, obj_val: 5173.4267578125, abs dis: 1.21044921875
[rfa agg] iter: 2, weight: tensor([3.8373e-05, 2.7206e-03, 4.4079e-01, 1.1040e-01, 8.3965e-03, 3.9164e-03,
        4.1135e-02, 3.0880e-01, 2.5003e-02, 5.8807e-02])
[rfa agg] iter:  3, prev_obj_val: 5173.4267578125, obj_val: 5175.7939453125, abs dis: 2.3671875
[rfa agg] iter: 3, weight: tensor([5.3402e-05, 4.1556e-03, 4.2129e-01, 1.1301e-01, 1.3099e-02, 6.0092e-03,
        7.4294e-02, 2.0975e-01, 4.2022e-02, 1.1631e-01])
[rfa agg] iter:  4, prev_obj_val: 5175.7939453125, obj_val: 5177.4287109375, abs dis: 1.634765625
[rfa agg] iter: 4, weight: tensor([6.5626e-05, 5.5112e-03, 2.8048e-01, 1.1632e-01, 1.7710e-02, 8.0018e-03,
        1.1798e-01, 1.8272e-01, 6.1235e-02, 2.0998e-01])
[rfa agg] iter:  5, prev_obj_val: 5177.4287109375, obj_val: 5179.162109375, abs dis: 1.7333984375
[rfa agg] iter: 5, weight: tensor([6.3936e-05, 5.6690e-03, 2.0590e-01, 1.0226e-01, 1.8492e-02, 8.2567e-03,
        1.4312e-01, 1.4925e-01, 6.8119e-02, 2.9887e-01])
[rfa agg] iter:  6, prev_obj_val: 5179.162109375, obj_val: 5182.841796875, abs dis: 3.6796875
[rfa agg] iter: 6, weight: tensor([5.2409e-05, 4.9209e-03, 1.3576e-01, 7.6308e-02, 1.6325e-02, 7.1921e-03,
        1.5447e-01, 1.0514e-01, 6.4977e-02, 4.3485e-01])
[rfa agg] iter:  7, prev_obj_val: 5182.841796875, obj_val: 5186.69482421875, abs dis: 3.85302734375
[rfa agg] iter: 7, weight: tensor([3.8120e-05, 3.9259e-03, 7.6372e-02, 4.8905e-02, 1.3422e-02, 5.7728e-03,
        2.0533e-01, 6.3126e-02, 6.2421e-02, 5.2069e-01])
[rfa agg] iter:  8, prev_obj_val: 5186.69482421875, obj_val: 5188.72509765625, abs dis: 2.0302734375
[rfa agg] iter: 8, weight: tensor([4.2514e-05, 4.6801e-03, 7.3941e-02, 5.0527e-02, 1.6390e-02, 6.9148e-03,
        4.2328e-01, 6.3041e-02, 8.8166e-02, 2.7302e-01])
[rfa agg] iter:  9, prev_obj_val: 5188.72509765625, obj_val: 5191.24560546875, abs dis: 2.5205078125
[rfa agg] iter: 9, weight: tensor([3.4172e-05, 3.8963e-03, 5.5790e-02, 3.9181e-02, 1.3831e-02, 5.7719e-03,
        5.8880e-01, 4.8196e-02, 8.2314e-02, 1.6219e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3633, Accuracy: 71/10000 (0.7100%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.1210, Accuracy: 0/9950 (0.0000%)
saving model
Done in 565.2218296527863 sec.
Server Epoch:32 choose agents : [72, 26, 61, 80, 49, 36, 32, 54, 23, 85].
_Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   1, Avg loss: 0.0580, Accuracy: 294/1241 (23.6906%)
_Train Local_ResNet_18, epoch  32, local model 72, internal_epoch   2, Avg loss: 0.0350, Accuracy: 482/1241 (38.8396%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9781, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   1, Avg loss: 0.0523, Accuracy: 366/1446 (25.3112%)
_Train Local_ResNet_18, epoch  32, local model 26, internal_epoch   2, Avg loss: 0.0329, Accuracy: 536/1446 (37.0678%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.5819, Accuracy: 79/10000 (0.7900%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   1, Avg loss: 0.1272, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  32, local model 61, internal_epoch   2, Avg loss: 0.1181, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3667, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   1, Avg loss: 0.0682, Accuracy: 152/682 (22.2874%)
_Train Local_ResNet_18, epoch  32, local model 80, internal_epoch   2, Avg loss: 0.0362, Accuracy: 256/682 (37.5367%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.9271, Accuracy: 70/10000 (0.7000%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   1, Avg loss: 0.0765, Accuracy: 48/440 (10.9091%)
_Train Local_ResNet_18, epoch  32, local model 49, internal_epoch   2, Avg loss: 0.0455, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.7105, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   1, Avg loss: 0.0844, Accuracy: 65/408 (15.9314%)
_Train Local_ResNet_18, epoch  32, local model 36, internal_epoch   2, Avg loss: 0.0504, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.5219, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   1, Avg loss: 0.0566, Accuracy: 219/735 (29.7959%)
_Train Local_ResNet_18, epoch  32, local model 32, internal_epoch   2, Avg loss: 0.0212, Accuracy: 384/735 (52.2449%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 10.3670, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 351/1130 (31.0619%)
_Train Local_ResNet_18, epoch  32, local model 54, internal_epoch   2, Avg loss: 0.0284, Accuracy: 483/1130 (42.7434%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 10.0945, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   1, Avg loss: 0.0610, Accuracy: 315/715 (44.0559%)
_Train Local_ResNet_18, epoch  32, local model 23, internal_epoch   2, Avg loss: 0.0385, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.3322, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 472/1988 (23.7425%)
_Train Local_ResNet_18, epoch  32, local model 85, internal_epoch   2, Avg loss: 0.0338, Accuracy: 731/1988 (36.7706%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 8.3218, Accuracy: 94/10000 (0.9400%)
time spent on training: 197.59524774551392
[rfa agg] training data poison_ratio: 0.28331454340473505  data num: [1241, 1446, 85, 682, 440, 408, 735, 1130, 715, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.0885357948139797
[rfa agg] init. name: [72, 26, 61, 80, 49, 36, 32, 54, 23, 85], weight: tensor([0.1399, 0.1630, 0.0096, 0.0769, 0.0496, 0.0460, 0.0829, 0.1274, 0.0806,
        0.2241])
[rfa agg] iter:  0, prev_obj_val: 66.87977600097656, obj_val: 68.17179870605469, abs dis: 1.292022705078125
[rfa agg] iter: 0, weight: tensor([0.1825, 0.1160, 0.0031, 0.0646, 0.0243, 0.0225, 0.0849, 0.3528, 0.0822,
        0.0672])
[rfa agg] iter:  1, prev_obj_val: 68.17179870605469, obj_val: 69.53490447998047, abs dis: 1.3631057739257812
[rfa agg] iter: 1, weight: tensor([0.1727, 0.1158, 0.0034, 0.0764, 0.0276, 0.0255, 0.1024, 0.3072, 0.0989,
        0.0700])
[rfa agg] iter:  2, prev_obj_val: 69.53490447998047, obj_val: 72.295654296875, abs dis: 2.7607498168945312
[rfa agg] iter: 2, weight: tensor([0.1617, 0.1137, 0.0037, 0.0891, 0.0306, 0.0284, 0.1226, 0.2607, 0.1182,
        0.0713])
[rfa agg] iter:  3, prev_obj_val: 72.295654296875, obj_val: 73.68649291992188, abs dis: 1.390838623046875
[rfa agg] iter: 3, weight: tensor([0.1321, 0.0999, 0.0040, 0.1133, 0.0345, 0.0320, 0.1686, 0.1873, 0.1614,
        0.0669])
[rfa agg] iter:  4, prev_obj_val: 73.68649291992188, obj_val: 76.55330657958984, abs dis: 2.8668136596679688
[rfa agg] iter: 4, weight: tensor([0.1144, 0.0891, 0.0039, 0.1244, 0.0349, 0.0324, 0.1971, 0.1549, 0.1876,
        0.0614])
[rfa agg] iter:  5, prev_obj_val: 76.55330657958984, obj_val: 82.38494873046875, abs dis: 5.831642150878906
[rfa agg] iter: 5, weight: tensor([0.0745, 0.0609, 0.0033, 0.1390, 0.0309, 0.0286, 0.2746, 0.0945, 0.2496,
        0.0442])
[rfa agg] iter:  6, prev_obj_val: 82.38494873046875, obj_val: 88.51654052734375, abs dis: 6.131591796875
[rfa agg] iter: 6, weight: tensor([0.0404, 0.0348, 0.0025, 0.2560, 0.0270, 0.0250, 0.2939, 0.0479, 0.2458,
        0.0269])
[rfa agg] iter:  7, prev_obj_val: 88.51654052734375, obj_val: 85.22469329833984, abs dis: 3.2918472290039062
[rfa agg] iter: 7, weight: tensor([0.0496, 0.0439, 0.0038, 0.3745, 0.0474, 0.0439, 0.1783, 0.0570, 0.1664,
        0.0352])
[rfa agg] iter:  8, prev_obj_val: 85.22469329833984, obj_val: 88.4996566772461, abs dis: 3.27496337890625
[rfa agg] iter: 8, weight: tensor([0.0368, 0.0322, 0.0025, 0.4730, 0.0293, 0.0272, 0.1752, 0.0430, 0.1555,
        0.0253])
[rfa agg] iter:  9, prev_obj_val: 88.4996566772461, obj_val: 88.49729919433594, abs dis: 0.00235748291015625
[rfa agg] iter: 9, weight: tensor([0.0471, 0.0418, 0.0036, 0.4114, 0.0451, 0.0418, 0.1674, 0.0542, 0.1543,
        0.0334])
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3632, Accuracy: 74/10000 (0.7400%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.0073, Accuracy: 0/9950 (0.0000%)
saving model
Done in 457.15234780311584 sec.
Server Epoch:33 choose agents : [15, 99, 11, 32, 10, 94, 70, 58, 16, 93].
poison local model 15 index 6 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   1, Avg loss: 0.0566, Accuracy: 293/1154 (25.3899%), train_poison_data_count: 362
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   2, Avg loss: 0.0313, Accuracy: 384/1154 (33.2756%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   3, Avg loss: 0.0280, Accuracy: 398/1154 (34.4887%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   4, Avg loss: 0.0269, Accuracy: 440/1154 (38.1282%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   5, Avg loss: 0.0265, Accuracy: 463/1154 (40.1213%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   6, Avg loss: 0.0267, Accuracy: 469/1154 (40.6412%), train_poison_data_count: 362
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   7, Avg loss: 0.0256, Accuracy: 483/1154 (41.8544%), train_poison_data_count: 362
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   8, Avg loss: 0.0257, Accuracy: 504/1154 (43.6742%), train_poison_data_count: 362
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch   9, Avg loss: 0.0255, Accuracy: 516/1154 (44.7140%), train_poison_data_count: 362
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  33, local model 15, internal_epoch  10, Avg loss: 0.0252, Accuracy: 505/1154 (43.7608%), train_poison_data_count: 362
Global model norm: 112.01133888612573.
Norm before scaling: 111.99410995254394. Distance: 1.080067474147163
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.8457, Accuracy: 70/10000 (0.7000%)
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: 0.9764, Accuracy: 7487/9950 (75.2462%)
Scaling by  100
Scaled Norm after poisoning: 153.9788312358228, distance: 108.00673626272113
Total norm for 2 adversaries is: 153.9788312358228. distance: 108.00673626272113
_Test Local_ResNet_18 poisoned: True, epoch: 33, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   1, Avg loss: 0.0571, Accuracy: 260/773 (33.6352%)
_Train Local_ResNet_18, epoch  33, local model 99, internal_epoch   2, Avg loss: 0.0295, Accuracy: 445/773 (57.5679%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.8529, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   1, Avg loss: 0.0590, Accuracy: 307/712 (43.1180%)
_Train Local_ResNet_18, epoch  33, local model 11, internal_epoch   2, Avg loss: 0.0247, Accuracy: 439/712 (61.6573%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.9308, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   1, Avg loss: 0.0552, Accuracy: 217/735 (29.5238%)
_Train Local_ResNet_18, epoch  33, local model 32, internal_epoch   2, Avg loss: 0.0213, Accuracy: 356/735 (48.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 10.9725, Accuracy: 59/10000 (0.5900%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   1, Avg loss: 0.0551, Accuracy: 244/861 (28.3391%)
_Train Local_ResNet_18, epoch  33, local model 10, internal_epoch   2, Avg loss: 0.0198, Accuracy: 483/861 (56.0976%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 9.6164, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   1, Avg loss: 0.0539, Accuracy: 392/1662 (23.5860%)
_Train Local_ResNet_18, epoch  33, local model 94, internal_epoch   2, Avg loss: 0.0317, Accuracy: 650/1662 (39.1095%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.2546, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0539, Accuracy: 439/1418 (30.9591%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0287, Accuracy: 693/1418 (48.8717%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.1789, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   1, Avg loss: 0.0552, Accuracy: 359/803 (44.7073%)
_Train Local_ResNet_18, epoch  33, local model 58, internal_epoch   2, Avg loss: 0.0319, Accuracy: 419/803 (52.1793%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.1390, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   1, Avg loss: 0.0587, Accuracy: 289/708 (40.8192%)
_Train Local_ResNet_18, epoch  33, local model 16, internal_epoch   2, Avg loss: 0.0354, Accuracy: 430/708 (60.7345%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.0575, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   1, Avg loss: 0.0539, Accuracy: 411/1742 (23.5936%)
_Train Local_ResNet_18, epoch  33, local model 93, internal_epoch   2, Avg loss: 0.0304, Accuracy: 751/1742 (43.1114%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.1945, Accuracy: 91/10000 (0.9100%)
time spent on training: 307.8294937610626
[rfa agg] training data poison_ratio: 0.19066994700984102  data num: [1154, 773, 712, 735, 861, 1662, 1418, 803, 708, 1742]
[rfa agg] considering poison per batch poison_fraction: 0.059584358440575316
[rfa agg] init. name: [15, 99, 11, 32, 10, 94, 70, 58, 16, 93], weight: tensor([0.1092, 0.0731, 0.0674, 0.0695, 0.0815, 0.1573, 0.1342, 0.0760, 0.0670,
        0.1648])
[rfa agg] iter:  0, prev_obj_val: 16479.4375, obj_val: 10222.10546875, abs dis: 6257.33203125
[rfa agg] iter: 0, weight: tensor([0.0148, 0.0804, 0.0740, 0.0764, 0.0896, 0.1750, 0.1489, 0.0835, 0.0736,
        0.1838])
[rfa agg] iter:  1, prev_obj_val: 10222.10546875, obj_val: 9369.3330078125, abs dis: 852.7724609375
[rfa agg] iter: 1, weight: tensor([0.0018, 0.0781, 0.0715, 0.0738, 0.0876, 0.1846, 0.1540, 0.0811, 0.0710,
        0.1965])
[rfa agg] iter:  2, prev_obj_val: 9369.3330078125, obj_val: 9310.2958984375, abs dis: 59.037109375
[rfa agg] iter: 2, weight: tensor([1.6145e-04, 4.6509e-02, 4.0974e-02, 4.2303e-02, 5.4258e-02, 2.4348e-01,
        1.5608e-01, 4.8305e-02, 4.0746e-02, 3.2718e-01])
[rfa agg] iter:  3, prev_obj_val: 9310.2958984375, obj_val: 9312.345703125, abs dis: 2.0498046875
[rfa agg] iter: 3, weight: tensor([5.4295e-05, 3.8189e-02, 3.1659e-02, 3.2702e-02, 4.7745e-02, 1.8178e-01,
        4.6816e-01, 3.9640e-02, 3.1493e-02, 1.2858e-01])
[rfa agg] iter:  4, prev_obj_val: 9312.345703125, obj_val: 9314.6474609375, abs dis: 2.3017578125
[rfa agg] iter: 4, weight: tensor([7.6599e-05, 6.9095e-02, 5.5691e-02, 5.7566e-02, 8.9432e-02, 1.7251e-01,
        2.9259e-01, 7.1671e-02, 5.5404e-02, 1.3597e-01])
[rfa agg] iter:  5, prev_obj_val: 9314.6474609375, obj_val: 9317.6845703125, abs dis: 3.037109375
[rfa agg] iter: 5, weight: tensor([7.8960e-05, 9.9427e-02, 7.6396e-02, 7.9023e-02, 1.3720e-01, 1.3407e-01,
        1.8218e-01, 1.0305e-01, 7.6022e-02, 1.1256e-01])
[rfa agg] iter:  6, prev_obj_val: 9317.6845703125, obj_val: 9319.978515625, abs dis: 2.2939453125
[rfa agg] iter: 6, weight: tensor([5.4825e-05, 1.3520e-01, 8.9925e-02, 9.3320e-02, 2.3405e-01, 7.1090e-02,
        8.4710e-02, 1.3944e-01, 8.9564e-02, 6.2643e-02])
[rfa agg] iter:  7, prev_obj_val: 9319.978515625, obj_val: 9328.49609375, abs dis: 8.517578125
[rfa agg] iter: 7, weight: tensor([2.9280e-05, 1.5945e-01, 8.1363e-02, 8.5217e-02, 3.3108e-01, 3.3238e-02,
        3.7739e-02, 1.6095e-01, 8.1048e-02, 2.9888e-02])
[rfa agg] iter:  8, prev_obj_val: 9328.49609375, obj_val: 9328.3359375, abs dis: 0.16015625
[rfa agg] iter: 8, weight: tensor([2.2212e-05, 1.2062e-01, 1.9236e-01, 2.3490e-01, 7.5749e-02, 2.1628e-02,
        2.3459e-02, 1.2168e-01, 1.8972e-01, 1.9851e-02])
[rfa agg] iter:  9, prev_obj_val: 9328.3359375, obj_val: 9345.1630859375, abs dis: 16.8271484375
[rfa agg] iter: 9, weight: tensor([1.9590e-05, 1.0507e-01, 2.0029e-01, 2.5229e-01, 6.4799e-02, 1.9075e-02,
        2.0681e-02, 1.0830e-01, 2.1197e-01, 1.7507e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3639, Accuracy: 77/10000 (0.7700%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 4.8434, Accuracy: 14/9950 (0.1407%)
saving model
Done in 564.715963602066 sec.
Server Epoch:34 choose agents : [82, 57, 91, 67, 43, 97, 54, 71, 66, 14].
_Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 66/500 (13.2000%)
_Train Local_ResNet_18, epoch  34, local model 82, internal_epoch   2, Avg loss: 0.0476, Accuracy: 188/500 (37.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.9482, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   1, Avg loss: 0.0523, Accuracy: 328/1154 (28.4229%)
_Train Local_ResNet_18, epoch  34, local model 57, internal_epoch   2, Avg loss: 0.0266, Accuracy: 451/1154 (39.0815%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 11.5164, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   1, Avg loss: 0.0549, Accuracy: 315/1030 (30.5825%)
_Train Local_ResNet_18, epoch  34, local model 91, internal_epoch   2, Avg loss: 0.0259, Accuracy: 602/1030 (58.4466%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.4781, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   1, Avg loss: 0.0750, Accuracy: 62/426 (14.5540%)
_Train Local_ResNet_18, epoch  34, local model 67, internal_epoch   2, Avg loss: 0.0391, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.9948, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   1, Avg loss: 0.0609, Accuracy: 307/946 (32.4524%)
_Train Local_ResNet_18, epoch  34, local model 43, internal_epoch   2, Avg loss: 0.0345, Accuracy: 358/946 (37.8436%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 6.9536, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   1, Avg loss: 0.0497, Accuracy: 369/1213 (30.4204%)
_Train Local_ResNet_18, epoch  34, local model 97, internal_epoch   2, Avg loss: 0.0261, Accuracy: 558/1213 (46.0016%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.8024, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   1, Avg loss: 0.0533, Accuracy: 356/1130 (31.5044%)
_Train Local_ResNet_18, epoch  34, local model 54, internal_epoch   2, Avg loss: 0.0280, Accuracy: 485/1130 (42.9204%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 9.8622, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   1, Avg loss: 0.0647, Accuracy: 167/818 (20.4156%)
_Train Local_ResNet_18, epoch  34, local model 71, internal_epoch   2, Avg loss: 0.0298, Accuracy: 394/818 (48.1663%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.6002, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   1, Avg loss: 0.0600, Accuracy: 268/1402 (19.1155%)
_Train Local_ResNet_18, epoch  34, local model 66, internal_epoch   2, Avg loss: 0.0377, Accuracy: 410/1402 (29.2439%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.9988, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   1, Avg loss: 0.0572, Accuracy: 251/1013 (24.7779%)
_Train Local_ResNet_18, epoch  34, local model 14, internal_epoch   2, Avg loss: 0.0333, Accuracy: 388/1013 (38.3021%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.8501, Accuracy: 101/10000 (1.0100%)
time spent on training: 174.0623800754547
[rfa agg] training data poison_ratio: 0.0  data num: [500, 1154, 1030, 426, 946, 1213, 1130, 818, 1402, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [82, 57, 91, 67, 43, 97, 54, 71, 66, 14], weight: tensor([0.0519, 0.1198, 0.1069, 0.0442, 0.0982, 0.1259, 0.1173, 0.0849, 0.1456,
        0.1052])
[rfa agg] iter:  0, prev_obj_val: 38.43184280395508, obj_val: 38.39021301269531, abs dis: 0.041629791259765625
[rfa agg] iter: 0, weight: tensor([0.0250, 0.0686, 0.0987, 0.0183, 0.2343, 0.0722, 0.0838, 0.2029, 0.0525,
        0.1438])
[rfa agg] iter:  1, prev_obj_val: 38.39021301269531, obj_val: 41.22412872314453, abs dis: 2.8339157104492188
[rfa agg] iter: 1, weight: tensor([0.0246, 0.0674, 0.0970, 0.0180, 0.2395, 0.0710, 0.0823, 0.2062, 0.0516,
        0.1423])
[rfa agg] iter:  2, prev_obj_val: 41.22412872314453, obj_val: 44.21034240722656, abs dis: 2.9862136840820312
[rfa agg] iter: 2, weight: tensor([0.0276, 0.0632, 0.0865, 0.0199, 0.1782, 0.0665, 0.0755, 0.3135, 0.0499,
        0.1192])
[rfa agg] iter:  3, prev_obj_val: 44.21034240722656, obj_val: 47.52940368652344, abs dis: 3.319061279296875
[rfa agg] iter: 3, weight: tensor([0.0283, 0.0542, 0.0712, 0.0201, 0.1276, 0.0570, 0.0636, 0.4404, 0.0441,
        0.0936])
[rfa agg] iter:  4, prev_obj_val: 47.52940368652344, obj_val: 44.18898010253906, abs dis: 3.340423583984375
[rfa agg] iter: 4, weight: tensor([0.0366, 0.0584, 0.0741, 0.0256, 0.1204, 0.0615, 0.0675, 0.4130, 0.0487,
        0.0941])
[rfa agg] iter:  5, prev_obj_val: 44.18898010253906, obj_val: 47.53234100341797, abs dis: 3.3433609008789062
[rfa agg] iter: 5, weight: tensor([0.0262, 0.0501, 0.0658, 0.0186, 0.1169, 0.0528, 0.0588, 0.4835, 0.0408,
        0.0865])
[rfa agg] iter:  6, prev_obj_val: 47.53234100341797, obj_val: 47.528804779052734, abs dis: 0.003536224365234375
[rfa agg] iter: 6, weight: tensor([0.0361, 0.0576, 0.0731, 0.0252, 0.1186, 0.0607, 0.0666, 0.4210, 0.0481,
        0.0928])
[rfa agg] iter:  7, prev_obj_val: 47.528804779052734, obj_val: 44.18939208984375, abs dis: 3.3394126892089844
[rfa agg] iter: 7, weight: tensor([0.0368, 0.0587, 0.0745, 0.0257, 0.1210, 0.0618, 0.0679, 0.4100, 0.0490,
        0.0946])
[rfa agg] iter:  8, prev_obj_val: 44.18939208984375, obj_val: 47.53221893310547, abs dis: 3.3428268432617188
[rfa agg] iter: 8, weight: tensor([0.0263, 0.0502, 0.0659, 0.0187, 0.1172, 0.0529, 0.0590, 0.4822, 0.0409,
        0.0867])
[rfa agg] iter:  9, prev_obj_val: 47.53221893310547, obj_val: 47.52880096435547, abs dis: 0.00341796875
[rfa agg] iter: 9, weight: tensor([0.0362, 0.0577, 0.0732, 0.0253, 0.1187, 0.0607, 0.0666, 0.4208, 0.0481,
        0.0929])
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3631, Accuracy: 75/10000 (0.7500%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 4.8633, Accuracy: 14/9950 (0.1407%)
saving model
Done in 416.82487773895264 sec.
Server Epoch:35 choose agents : [25, 59, 84, 17, 29, 58, 36, 90, 67, 70].
poison local model 25 index 7 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   1, Avg loss: 0.0573, Accuracy: 206/690 (29.8551%), train_poison_data_count: 220
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   2, Avg loss: 0.0288, Accuracy: 325/690 (47.1014%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   3, Avg loss: 0.0233, Accuracy: 337/690 (48.8406%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   4, Avg loss: 0.0233, Accuracy: 350/690 (50.7246%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   5, Avg loss: 0.0216, Accuracy: 339/690 (49.1304%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   6, Avg loss: 0.0219, Accuracy: 362/690 (52.4638%), train_poison_data_count: 220
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   7, Avg loss: 0.0206, Accuracy: 371/690 (53.7681%), train_poison_data_count: 220
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   8, Avg loss: 0.0200, Accuracy: 385/690 (55.7971%), train_poison_data_count: 220
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch   9, Avg loss: 0.0202, Accuracy: 364/690 (52.7536%), train_poison_data_count: 220
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  35, local model 25, internal_epoch  10, Avg loss: 0.0201, Accuracy: 380/690 (55.0725%), train_poison_data_count: 220
Global model norm: 112.00920721083602.
Norm before scaling: 112.00099399670522. Distance: 0.7914953590228087
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4573, Accuracy: 92/10000 (0.9200%)
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: 0.9663, Accuracy: 5425/9950 (54.5226%)
Scaling by  100
Scaled Norm after poisoning: 136.2502508598608, distance: 79.14954139060914
Total norm for 1 adversaries is: 136.2502508598608. distance: 79.14954139060914
_Test Local_ResNet_18 poisoned: True, epoch: 35, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0511, Accuracy: 324/1089 (29.7521%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0265, Accuracy: 509/1089 (46.7401%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.9924, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 319/1190 (26.8067%)
_Train Local_ResNet_18, epoch  35, local model 84, internal_epoch   2, Avg loss: 0.0305, Accuracy: 487/1190 (40.9244%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.4251, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   1, Avg loss: 0.0494, Accuracy: 460/1574 (29.2249%)
_Train Local_ResNet_18, epoch  35, local model 17, internal_epoch   2, Avg loss: 0.0252, Accuracy: 729/1574 (46.3151%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.8127, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   1, Avg loss: 0.0505, Accuracy: 416/1440 (28.8889%)
_Train Local_ResNet_18, epoch  35, local model 29, internal_epoch   2, Avg loss: 0.0268, Accuracy: 702/1440 (48.7500%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.8488, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   1, Avg loss: 0.0543, Accuracy: 361/803 (44.9564%)
_Train Local_ResNet_18, epoch  35, local model 58, internal_epoch   2, Avg loss: 0.0320, Accuracy: 389/803 (48.4433%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.3477, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   1, Avg loss: 0.0845, Accuracy: 61/408 (14.9510%)
_Train Local_ResNet_18, epoch  35, local model 36, internal_epoch   2, Avg loss: 0.0495, Accuracy: 150/408 (36.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.5898, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   1, Avg loss: 0.0536, Accuracy: 334/677 (49.3353%)
_Train Local_ResNet_18, epoch  35, local model 90, internal_epoch   2, Avg loss: 0.0217, Accuracy: 449/677 (66.3220%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 10.0459, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0743, Accuracy: 66/426 (15.4930%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0388, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.3245, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   1, Avg loss: 0.0533, Accuracy: 471/1418 (33.2158%)
_Train Local_ResNet_18, epoch  35, local model 70, internal_epoch   2, Avg loss: 0.0291, Accuracy: 688/1418 (48.5190%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 8.2060, Accuracy: 112/10000 (1.1200%)
time spent on training: 272.8121564388275
[rfa agg] training data poison_ratio: 0.07102418939783839  data num: [690, 1089, 1190, 1574, 1440, 803, 408, 677, 426, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.022195059186824496
[rfa agg] init. name: [25, 59, 84, 17, 29, 58, 36, 90, 67, 70], weight: tensor([0.0710, 0.1121, 0.1225, 0.1620, 0.1482, 0.0827, 0.0420, 0.0697, 0.0438,
        0.1460])
[rfa agg] iter:  0, prev_obj_val: 6452.9326171875, obj_val: 3705.442138671875, abs dis: 2747.490478515625
[rfa agg] iter: 0, weight: tensor([0.0058, 0.1196, 0.1311, 0.1761, 0.1603, 0.0871, 0.0436, 0.0731, 0.0455,
        0.1578])
[rfa agg] iter:  1, prev_obj_val: 3705.442138671875, obj_val: 3521.807373046875, abs dis: 183.634765625
[rfa agg] iter: 1, weight: tensor([0.0004, 0.1128, 0.1275, 0.2126, 0.1790, 0.0713, 0.0309, 0.0569, 0.0323,
        0.1762])
[rfa agg] iter:  2, prev_obj_val: 3521.807373046875, obj_val: 3524.0048828125, abs dis: 2.197509765625
[rfa agg] iter: 2, weight: tensor([4.4336e-05, 1.6940e-01, 3.0850e-01, 1.0970e-01, 1.6383e-01, 4.0148e-02,
        1.1041e-02, 2.6420e-02, 1.1530e-02, 1.5939e-01])
[rfa agg] iter:  3, prev_obj_val: 3524.0048828125, obj_val: 3527.361328125, abs dis: 3.3564453125
[rfa agg] iter: 3, weight: tensor([3.6400e-05, 2.7667e-01, 3.8497e-01, 6.9422e-02, 9.1154e-02, 4.1746e-02,
        1.0247e-02, 2.5980e-02, 1.0698e-02, 8.9079e-02])
[rfa agg] iter:  4, prev_obj_val: 3527.361328125, obj_val: 3529.428955078125, abs dis: 2.067626953125
[rfa agg] iter: 4, weight: tensor([4.4329e-05, 3.6685e-01, 2.5349e-01, 7.3352e-02, 9.1066e-02, 6.1749e-02,
        1.3663e-02, 3.6418e-02, 1.4265e-02, 8.9099e-02])
[rfa agg] iter:  5, prev_obj_val: 3529.428955078125, obj_val: 3531.643798828125, abs dis: 2.21484375
[rfa agg] iter: 5, weight: tensor([5.1055e-05, 3.4924e-01, 2.2182e-01, 7.9297e-02, 9.6314e-02, 7.9744e-02,
        1.6518e-02, 4.5403e-02, 1.7251e-02, 9.4362e-02])
[rfa agg] iter:  6, prev_obj_val: 3531.643798828125, obj_val: 3533.903076171875, abs dis: 2.25927734375
[rfa agg] iter: 6, weight: tensor([5.8672e-05, 2.9992e-01, 2.0941e-01, 8.5861e-02, 1.0238e-01, 1.0426e-01,
        1.9981e-02, 5.6875e-02, 2.0868e-02, 1.0039e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3630, Accuracy: 71/10000 (0.7100%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 4.8715, Accuracy: 14/9950 (0.1407%)
saving model
Done in 520.6306810379028 sec.
Server Epoch:36 choose agents : [14, 2, 79, 58, 84, 40, 16, 50, 8, 72].
_Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   1, Avg loss: 0.0572, Accuracy: 245/1013 (24.1856%)
_Train Local_ResNet_18, epoch  36, local model 14, internal_epoch   2, Avg loss: 0.0331, Accuracy: 417/1013 (41.1649%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.1759, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   1, Avg loss: 0.0638, Accuracy: 235/605 (38.8430%)
_Train Local_ResNet_18, epoch  36, local model 2, internal_epoch   2, Avg loss: 0.0382, Accuracy: 329/605 (54.3802%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.2409, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   1, Avg loss: 0.1075, Accuracy: 1/197 (0.5076%)
_Train Local_ResNet_18, epoch  36, local model 79, internal_epoch   2, Avg loss: 0.0905, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.4420, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   1, Avg loss: 0.0538, Accuracy: 372/803 (46.3263%)
_Train Local_ResNet_18, epoch  36, local model 58, internal_epoch   2, Avg loss: 0.0306, Accuracy: 440/803 (54.7945%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.0189, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   1, Avg loss: 0.0614, Accuracy: 325/1190 (27.3109%)
_Train Local_ResNet_18, epoch  36, local model 84, internal_epoch   2, Avg loss: 0.0310, Accuracy: 463/1190 (38.9076%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.3606, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   1, Avg loss: 0.0549, Accuracy: 414/1573 (26.3191%)
_Train Local_ResNet_18, epoch  36, local model 40, internal_epoch   2, Avg loss: 0.0338, Accuracy: 613/1573 (38.9701%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.7597, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   1, Avg loss: 0.0604, Accuracy: 302/708 (42.6554%)
_Train Local_ResNet_18, epoch  36, local model 16, internal_epoch   2, Avg loss: 0.0347, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.0799, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   1, Avg loss: 0.0595, Accuracy: 214/809 (26.4524%)
_Train Local_ResNet_18, epoch  36, local model 50, internal_epoch   2, Avg loss: 0.0257, Accuracy: 392/809 (48.4549%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 9.8211, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   1, Avg loss: 0.0563, Accuracy: 309/1513 (20.4230%)
_Train Local_ResNet_18, epoch  36, local model 8, internal_epoch   2, Avg loss: 0.0346, Accuracy: 525/1513 (34.6993%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 8.0379, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   1, Avg loss: 0.0582, Accuracy: 318/1241 (25.6245%)
_Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   2, Avg loss: 0.0353, Accuracy: 461/1241 (37.1475%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.8962, Accuracy: 75/10000 (0.7500%)
time spent on training: 176.6384425163269
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 605, 197, 803, 1190, 1573, 708, 809, 1513, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [14, 2, 79, 58, 84, 40, 16, 50, 8, 72], weight: tensor([0.1050, 0.0627, 0.0204, 0.0832, 0.1233, 0.1630, 0.0734, 0.0838, 0.1568,
        0.1286])
[rfa agg] iter:  0, prev_obj_val: 45.15077590942383, obj_val: 48.74006652832031, abs dis: 3.5892906188964844
[rfa agg] iter: 0, weight: tensor([0.3754, 0.0305, 0.0052, 0.0747, 0.1479, 0.0607, 0.0513, 0.0743, 0.0660,
        0.1140])
[rfa agg] iter:  1, prev_obj_val: 48.74006652832031, obj_val: 55.76412582397461, abs dis: 7.024059295654297
[rfa agg] iter: 1, weight: tensor([0.3113, 0.0415, 0.0062, 0.1333, 0.1006, 0.0542, 0.0798, 0.1305, 0.0579,
        0.0848])
[rfa agg] iter:  2, prev_obj_val: 55.76412582397461, obj_val: 64.909912109375, abs dis: 9.14578628540039
[rfa agg] iter: 2, weight: tensor([0.0755, 0.0448, 0.0050, 0.3389, 0.0446, 0.0297, 0.1369, 0.2535, 0.0312,
        0.0400])
[rfa agg] iter:  3, prev_obj_val: 64.909912109375, obj_val: 64.87278747558594, abs dis: 0.0371246337890625
[rfa agg] iter: 3, weight: tensor([0.0717, 0.1195, 0.0085, 0.1669, 0.0508, 0.0375, 0.2988, 0.1605, 0.0390,
        0.0469])
[rfa agg] iter:  4, prev_obj_val: 64.87278747558594, obj_val: 68.52334594726562, abs dis: 3.6505584716796875
[rfa agg] iter: 4, weight: tensor([0.0693, 0.1170, 0.0082, 0.1595, 0.0492, 0.0363, 0.3255, 0.1519, 0.0377,
        0.0454])
[rfa agg] iter:  5, prev_obj_val: 68.52334594726562, obj_val: 61.42377471923828, abs dis: 7.099571228027344
[rfa agg] iter: 5, weight: tensor([0.0748, 0.1936, 0.0105, 0.1459, 0.0552, 0.0419, 0.2418, 0.1419, 0.0433,
        0.0513])
[rfa agg] iter:  6, prev_obj_val: 61.42377471923828, obj_val: 64.87432098388672, abs dis: 3.4505462646484375
[rfa agg] iter: 6, weight: tensor([0.0632, 0.0741, 0.0062, 0.1839, 0.0428, 0.0306, 0.3621, 0.1661, 0.0319,
        0.0391])
[rfa agg] iter:  7, prev_obj_val: 64.87432098388672, obj_val: 64.87222290039062, abs dis: 0.00209808349609375
[rfa agg] iter: 7, weight: tensor([0.0685, 0.1147, 0.0081, 0.1578, 0.0486, 0.0359, 0.3344, 0.1500, 0.0372,
        0.0449])
[rfa agg] iter:  8, prev_obj_val: 64.87222290039062, obj_val: 68.5238265991211, abs dis: 3.6516036987304688
[rfa agg] iter: 8, weight: tensor([0.0689, 0.1160, 0.0081, 0.1583, 0.0488, 0.0361, 0.3310, 0.1503, 0.0374,
        0.0451])
[rfa agg] iter:  9, prev_obj_val: 68.5238265991211, obj_val: 61.42371368408203, abs dis: 7.1001129150390625
[rfa agg] iter: 9, weight: tensor([0.0748, 0.1934, 0.0105, 0.1458, 0.0552, 0.0419, 0.2421, 0.1418, 0.0433,
        0.0512])
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3643, Accuracy: 70/10000 (0.7000%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 4.8887, Accuracy: 9/9950 (0.0905%)
saving model
Done in 421.42248368263245 sec.
Server Epoch:37 choose agents : [30, 52, 90, 51, 62, 40, 15, 83, 13, 39].
poison local model 30 index 8 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   1, Avg loss: 0.0760, Accuracy: 86/486 (17.6955%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   2, Avg loss: 0.0424, Accuracy: 151/486 (31.0700%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   3, Avg loss: 0.0340, Accuracy: 183/486 (37.6543%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   4, Avg loss: 0.0346, Accuracy: 175/486 (36.0082%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   5, Avg loss: 0.0343, Accuracy: 187/486 (38.4774%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   6, Avg loss: 0.0315, Accuracy: 191/486 (39.3004%), train_poison_data_count: 160
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   7, Avg loss: 0.0309, Accuracy: 195/486 (40.1235%), train_poison_data_count: 160
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   8, Avg loss: 0.0303, Accuracy: 210/486 (43.2099%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch   9, Avg loss: 0.0301, Accuracy: 222/486 (45.6790%), train_poison_data_count: 160
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  37, local model 30, internal_epoch  10, Avg loss: 0.0311, Accuracy: 194/486 (39.9177%), train_poison_data_count: 160
Global model norm: 112.00660904049367.
Norm before scaling: 112.00135148459147. Distance: 0.6823683081719966
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5357, Accuracy: 58/10000 (0.5800%)
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: 0.9836, Accuracy: 6867/9950 (69.0151%)
Scaling by  100
Scaled Norm after poisoning: 130.5268022045664, distance: 68.23683123298407
Total norm for 2 adversaries is: 130.5268022045664. distance: 68.23683123298407
_Test Local_ResNet_18 poisoned: True, epoch: 37, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0545, Accuracy: 285/636 (44.8113%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0289, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.0050, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   1, Avg loss: 0.0529, Accuracy: 334/677 (49.3353%)
_Train Local_ResNet_18, epoch  37, local model 90, internal_epoch   2, Avg loss: 0.0220, Accuracy: 451/677 (66.6174%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 9.7426, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   1, Avg loss: 0.0568, Accuracy: 257/1049 (24.4995%)
_Train Local_ResNet_18, epoch  37, local model 51, internal_epoch   2, Avg loss: 0.0278, Accuracy: 557/1049 (53.0982%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1173, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   1, Avg loss: 0.0667, Accuracy: 155/568 (27.2887%)
_Train Local_ResNet_18, epoch  37, local model 62, internal_epoch   2, Avg loss: 0.0380, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.0296, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 407/1573 (25.8741%)
_Train Local_ResNet_18, epoch  37, local model 40, internal_epoch   2, Avg loss: 0.0339, Accuracy: 624/1573 (39.6694%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5764, Accuracy: 83/10000 (0.8300%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   1, Avg loss: 0.0579, Accuracy: 332/1154 (28.7695%)
_Train Local_ResNet_18, epoch  37, local model 15, internal_epoch   2, Avg loss: 0.0293, Accuracy: 429/1154 (37.1750%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 10.4626, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 456/1953 (23.3487%)
_Train Local_ResNet_18, epoch  37, local model 83, internal_epoch   2, Avg loss: 0.0323, Accuracy: 853/1953 (43.6764%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.1351, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   1, Avg loss: 0.0537, Accuracy: 437/1645 (26.5653%)
_Train Local_ResNet_18, epoch  37, local model 13, internal_epoch   2, Avg loss: 0.0308, Accuracy: 705/1645 (42.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.3456, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   1, Avg loss: 0.0518, Accuracy: 316/1013 (31.1945%)
_Train Local_ResNet_18, epoch  37, local model 39, internal_epoch   2, Avg loss: 0.0249, Accuracy: 535/1013 (52.8134%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.7207, Accuracy: 92/10000 (0.9200%)
time spent on training: 298.2179231643677
[rfa agg] training data poison_ratio: 0.15250139482983077  data num: [486, 636, 677, 1049, 568, 1573, 1154, 1953, 1645, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.04765668588432212
[rfa agg] init. name: [30, 52, 90, 51, 62, 40, 15, 83, 13, 39], weight: tensor([0.0452, 0.0591, 0.0630, 0.0975, 0.0528, 0.1463, 0.1073, 0.1816, 0.1530,
        0.0942])
[rfa agg] iter:  0, prev_obj_val: 3055.35595703125, obj_val: 1674.46630859375, abs dis: 1380.8896484375
[rfa agg] iter: 0, weight: tensor([0.0022, 0.0581, 0.0621, 0.0994, 0.0516, 0.1560, 0.1106, 0.2005, 0.1640,
        0.0955])
[rfa agg] iter:  1, prev_obj_val: 1674.46630859375, obj_val: 1663.318359375, abs dis: 11.14794921875
[rfa agg] iter: 1, weight: tensor([5.3430e-05, 1.5419e-02, 1.7382e-02, 4.1482e-02, 1.3050e-02, 2.1823e-01,
        5.5576e-02, 2.7288e-01, 3.2913e-01, 3.6796e-02])
[rfa agg] iter:  2, prev_obj_val: 1663.318359375, obj_val: 1664.1153564453125, abs dis: 0.7969970703125
[rfa agg] iter: 2, weight: tensor([4.9595e-05, 1.9088e-02, 2.1949e-02, 6.4609e-02, 1.5881e-02, 3.6255e-01,
        1.0060e-01, 1.0499e-01, 2.5581e-01, 5.4484e-02])
[rfa agg] iter:  3, prev_obj_val: 1664.1153564453125, obj_val: 1666.0433349609375, abs dis: 1.927978515625
[rfa agg] iter: 3, weight: tensor([6.1159e-05, 2.7635e-02, 3.2218e-02, 1.1366e-01, 2.2718e-02, 2.2025e-01,
        2.0993e-01, 1.0232e-01, 1.8007e-01, 9.1141e-02])
[rfa agg] iter:  4, prev_obj_val: 1666.0433349609375, obj_val: 1670.8670654296875, abs dis: 4.82373046875
[rfa agg] iter: 4, weight: tensor([4.3113e-05, 2.4875e-02, 2.9796e-02, 1.6689e-01, 2.0023e-02, 9.1594e-02,
        4.1187e-01, 5.7279e-02, 8.2385e-02, 1.1525e-01])
[rfa agg] iter:  5, prev_obj_val: 1670.8670654296875, obj_val: 1677.2003173828125, abs dis: 6.333251953125
[rfa agg] iter: 5, weight: tensor([3.8255e-05, 2.8279e-02, 3.5120e-02, 3.4483e-01, 2.2183e-02, 6.1087e-02,
        1.6964e-01, 4.3606e-02, 5.6962e-02, 2.3826e-01])
[rfa agg] iter:  6, prev_obj_val: 1677.2003173828125, obj_val: 1677.1463623046875, abs dis: 0.053955078125
[rfa agg] iter: 6, weight: tensor([4.1025e-05, 3.8479e-02, 5.0042e-02, 2.1471e-01, 2.9244e-02, 5.5331e-02,
        1.0591e-01, 4.2280e-02, 5.2472e-02, 4.1149e-01])
[rfa agg] iter:  7, prev_obj_val: 1677.1463623046875, obj_val: 1679.92333984375, abs dis: 2.7769775390625
[rfa agg] iter: 7, weight: tensor([3.8312e-05, 3.5964e-02, 4.6795e-02, 1.9440e-01, 2.7321e-02, 5.1677e-02,
        9.8166e-02, 3.9490e-02, 4.9009e-02, 4.5714e-01])
[rfa agg] iter:  8, prev_obj_val: 1679.92333984375, obj_val: 1674.5965576171875, abs dis: 5.3267822265625
[rfa agg] iter: 8, weight: tensor([4.8747e-05, 5.0225e-02, 6.6797e-02, 1.9429e-01, 3.7627e-02, 6.2505e-02,
        1.1048e-01, 4.8688e-02, 5.9550e-02, 3.6979e-01])
[rfa agg] iter:  9, prev_obj_val: 1674.5965576171875, obj_val: 1674.567138671875, abs dis: 0.0294189453125
[rfa agg] iter: 9, weight: tensor([3.0947e-05, 2.6684e-02, 3.4103e-02, 2.0685e-01, 2.0510e-02, 4.4037e-02,
        9.1074e-02, 3.2956e-02, 4.1550e-02, 5.0220e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3630, Accuracy: 74/10000 (0.7400%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 4.9148, Accuracy: 10/9950 (0.1005%)
saving model
Done in 546.2446799278259 sec.
Server Epoch:38 choose agents : [70, 37, 62, 29, 91, 31, 56, 1, 98, 4].
_Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   1, Avg loss: 0.0517, Accuracy: 484/1418 (34.1326%)
_Train Local_ResNet_18, epoch  38, local model 70, internal_epoch   2, Avg loss: 0.0283, Accuracy: 736/1418 (51.9041%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.5473, Accuracy: 99/10000 (0.9900%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   1, Avg loss: 0.0486, Accuracy: 513/1129 (45.4384%)
_Train Local_ResNet_18, epoch  38, local model 37, internal_epoch   2, Avg loss: 0.0220, Accuracy: 781/1129 (69.1763%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.7294, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   1, Avg loss: 0.0674, Accuracy: 154/568 (27.1127%)
_Train Local_ResNet_18, epoch  38, local model 62, internal_epoch   2, Avg loss: 0.0392, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.9882, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 451/1440 (31.3194%)
_Train Local_ResNet_18, epoch  38, local model 29, internal_epoch   2, Avg loss: 0.0266, Accuracy: 703/1440 (48.8194%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 8.7401, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   1, Avg loss: 0.0525, Accuracy: 325/1030 (31.5534%)
_Train Local_ResNet_18, epoch  38, local model 91, internal_epoch   2, Avg loss: 0.0253, Accuracy: 655/1030 (63.5922%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.4911, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   1, Avg loss: 0.0831, Accuracy: 60/460 (13.0435%)
_Train Local_ResNet_18, epoch  38, local model 31, internal_epoch   2, Avg loss: 0.0374, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.3716, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   1, Avg loss: 0.0819, Accuracy: 4/186 (2.1505%)
_Train Local_ResNet_18, epoch  38, local model 56, internal_epoch   2, Avg loss: 0.0664, Accuracy: 75/186 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.4340, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0523, Accuracy: 310/928 (33.4052%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0222, Accuracy: 621/928 (66.9181%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.4671, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   1, Avg loss: 0.0803, Accuracy: 29/373 (7.7748%)
_Train Local_ResNet_18, epoch  38, local model 98, internal_epoch   2, Avg loss: 0.0462, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.5084, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0623, Accuracy: 325/901 (36.0710%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0352, Accuracy: 377/901 (41.8424%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 9.4787, Accuracy: 50/10000 (0.5000%)
time spent on training: 181.79059767723083
[rfa agg] training data poison_ratio: 0.13387880943910827  data num: [1418, 1129, 568, 1440, 1030, 460, 186, 928, 373, 901]
[rfa agg] considering poison per batch poison_fraction: 0.04183712794972133
[rfa agg] init. name: [70, 37, 62, 29, 91, 31, 56, 1, 98, 4], weight: tensor([0.1681, 0.1339, 0.0674, 0.1708, 0.1221, 0.0545, 0.0221, 0.1100, 0.0442,
        0.1068])
[rfa agg] iter:  0, prev_obj_val: 47.12611389160156, obj_val: 49.47135543823242, abs dis: 2.3452415466308594
[rfa agg] iter: 0, weight: tensor([0.0517, 0.0971, 0.0319, 0.0524, 0.1204, 0.0219, 0.0050, 0.3104, 0.0136,
        0.2954])
[rfa agg] iter:  1, prev_obj_val: 49.47135543823242, obj_val: 52.10139846801758, abs dis: 2.6300430297851562
[rfa agg] iter: 1, weight: tensor([0.0581, 0.1018, 0.0418, 0.0590, 0.1217, 0.0283, 0.0063, 0.2908, 0.0173,
        0.2751])
[rfa agg] iter:  2, prev_obj_val: 52.10139846801758, obj_val: 49.47252655029297, abs dis: 2.6288719177246094
[rfa agg] iter: 2, weight: tensor([0.0670, 0.1106, 0.0564, 0.0680, 0.1283, 0.0374, 0.0080, 0.2564, 0.0224,
        0.2455])
[rfa agg] iter:  3, prev_obj_val: 49.47252655029297, obj_val: 52.10120391845703, abs dis: 2.6286773681640625
[rfa agg] iter: 3, weight: tensor([0.0585, 0.1026, 0.0421, 0.0594, 0.1226, 0.0285, 0.0063, 0.2888, 0.0174,
        0.2738])
[rfa agg] iter:  4, prev_obj_val: 52.10120391845703, obj_val: 49.472530364990234, abs dis: 2.628673553466797
[rfa agg] iter: 4, weight: tensor([0.0670, 0.1107, 0.0564, 0.0680, 0.1283, 0.0374, 0.0080, 0.2564, 0.0224,
        0.2455])
[rfa agg] iter:  5, prev_obj_val: 49.472530364990234, obj_val: 52.10120391845703, abs dis: 2.628673553466797
[rfa agg] iter: 5, weight: tensor([0.0585, 0.1026, 0.0421, 0.0594, 0.1226, 0.0285, 0.0063, 0.2888, 0.0174,
        0.2738])
[rfa agg] iter:  6, prev_obj_val: 52.10120391845703, obj_val: 49.472530364990234, abs dis: 2.628673553466797
[rfa agg] iter: 6, weight: tensor([0.0670, 0.1107, 0.0564, 0.0680, 0.1283, 0.0374, 0.0080, 0.2564, 0.0224,
        0.2455])
[rfa agg] iter:  7, prev_obj_val: 49.472530364990234, obj_val: 52.10120391845703, abs dis: 2.628673553466797
[rfa agg] iter: 7, weight: tensor([0.0585, 0.1026, 0.0421, 0.0594, 0.1226, 0.0285, 0.0063, 0.2888, 0.0174,
        0.2738])
[rfa agg] iter:  8, prev_obj_val: 52.10120391845703, obj_val: 49.472530364990234, abs dis: 2.628673553466797
[rfa agg] iter: 8, weight: tensor([0.0670, 0.1107, 0.0564, 0.0680, 0.1283, 0.0374, 0.0080, 0.2564, 0.0224,
        0.2455])
[rfa agg] iter:  9, prev_obj_val: 49.472530364990234, obj_val: 52.10120391845703, abs dis: 2.628673553466797
[rfa agg] iter: 9, weight: tensor([0.0585, 0.1026, 0.0421, 0.0594, 0.1226, 0.0285, 0.0063, 0.2888, 0.0174,
        0.2738])
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3613, Accuracy: 72/10000 (0.7200%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 4.9286, Accuracy: 10/9950 (0.1005%)
saving model
Done in 423.68862295150757 sec.
Server Epoch:39 choose agents : [37, 46, 50, 70, 86, 40, 74, 51, 9, 21].
poison local model 37 index 9 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   1, Avg loss: 0.0509, Accuracy: 308/1129 (27.2808%), train_poison_data_count: 360
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   2, Avg loss: 0.0269, Accuracy: 551/1129 (48.8043%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   3, Avg loss: 0.0234, Accuracy: 559/1129 (49.5128%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   4, Avg loss: 0.0234, Accuracy: 562/1129 (49.7786%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   5, Avg loss: 0.0233, Accuracy: 540/1129 (47.8299%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   6, Avg loss: 0.0225, Accuracy: 567/1129 (50.2214%), train_poison_data_count: 360
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   7, Avg loss: 0.0217, Accuracy: 605/1129 (53.5872%), train_poison_data_count: 360
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   8, Avg loss: 0.0218, Accuracy: 583/1129 (51.6386%), train_poison_data_count: 360
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch   9, Avg loss: 0.0216, Accuracy: 604/1129 (53.4987%), train_poison_data_count: 360
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  39, local model 37, internal_epoch  10, Avg loss: 0.0217, Accuracy: 565/1129 (50.0443%), train_poison_data_count: 360
Global model norm: 112.00393669839244.
Norm before scaling: 111.9872690867136. Distance: 0.9783835559888537
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.1179, Accuracy: 118/10000 (1.1800%)
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: 0.9707, Accuracy: 6136/9950 (61.6683%)
Scaling by  100
Scaled Norm after poisoning: 147.1330445973983, distance: 97.83835021829374
Total norm for 2 adversaries is: 147.1330445973983. distance: 97.83835021829374
_Test Local_ResNet_18 poisoned: True, epoch: 39, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   1, Avg loss: 0.0544, Accuracy: 406/1904 (21.3235%)
_Train Local_ResNet_18, epoch  39, local model 46, internal_epoch   2, Avg loss: 0.0303, Accuracy: 740/1904 (38.8655%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.7689, Accuracy: 147/10000 (1.4700%)
_Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   1, Avg loss: 0.0588, Accuracy: 220/809 (27.1941%)
_Train Local_ResNet_18, epoch  39, local model 50, internal_epoch   2, Avg loss: 0.0256, Accuracy: 393/809 (48.5785%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 9.7728, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   1, Avg loss: 0.0521, Accuracy: 472/1418 (33.2863%)
_Train Local_ResNet_18, epoch  39, local model 70, internal_epoch   2, Avg loss: 0.0289, Accuracy: 703/1418 (49.5769%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.1904, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   1, Avg loss: 0.0597, Accuracy: 353/1003 (35.1944%)
_Train Local_ResNet_18, epoch  39, local model 86, internal_epoch   2, Avg loss: 0.0325, Accuracy: 411/1003 (40.9771%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.7047, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   1, Avg loss: 0.0544, Accuracy: 415/1573 (26.3827%)
_Train Local_ResNet_18, epoch  39, local model 40, internal_epoch   2, Avg loss: 0.0337, Accuracy: 605/1573 (38.4615%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6496, Accuracy: 100/10000 (1.0000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 551/1552 (35.5026%)
_Train Local_ResNet_18, epoch  39, local model 74, internal_epoch   2, Avg loss: 0.0200, Accuracy: 785/1552 (50.5799%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 11.1134, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   1, Avg loss: 0.0547, Accuracy: 293/1049 (27.9314%)
_Train Local_ResNet_18, epoch  39, local model 51, internal_epoch   2, Avg loss: 0.0271, Accuracy: 552/1049 (52.6215%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.3121, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   1, Avg loss: 0.0434, Accuracy: 469/1275 (36.7843%)
_Train Local_ResNet_18, epoch  39, local model 9, internal_epoch   2, Avg loss: 0.0169, Accuracy: 809/1275 (63.4510%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 10.3554, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   1, Avg loss: 0.0524, Accuracy: 438/1949 (22.4731%)
_Train Local_ResNet_18, epoch  39, local model 21, internal_epoch   2, Avg loss: 0.0317, Accuracy: 663/1949 (34.0174%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.9387, Accuracy: 100/10000 (1.0000%)
time spent on training: 329.6315059661865
[rfa agg] training data poison_ratio: 0.19625210453114705  data num: [1129, 1904, 809, 1418, 1003, 1573, 1552, 1049, 1275, 1949]
[rfa agg] considering poison per batch poison_fraction: 0.061328782665983454
[rfa agg] init. name: [37, 46, 50, 70, 86, 40, 74, 51, 9, 21], weight: tensor([0.0826, 0.1394, 0.0592, 0.1038, 0.0734, 0.1151, 0.1136, 0.0768, 0.0933,
        0.1427])
[rfa agg] iter:  0, prev_obj_val: 12151.435546875, obj_val: 7160.03955078125, abs dis: 4991.39599609375
[rfa agg] iter: 0, weight: tensor([0.0080, 0.1520, 0.0631, 0.1121, 0.0786, 0.1247, 0.1230, 0.0823, 0.1004,
        0.1558])
[rfa agg] iter:  1, prev_obj_val: 7160.03955078125, obj_val: 6680.7451171875, abs dis: 479.29443359375
[rfa agg] iter: 1, weight: tensor([0.0007, 0.1655, 0.0556, 0.1111, 0.0715, 0.1268, 0.1251, 0.0758, 0.0958,
        0.1721])
[rfa agg] iter:  2, prev_obj_val: 6680.7451171875, obj_val: 6675.11767578125, abs dis: 5.62744140625
[rfa agg] iter: 2, weight: tensor([4.0028e-05, 2.7395e-01, 1.7138e-02, 8.8806e-02, 2.6534e-02, 1.5750e-01,
        1.5877e-01, 3.0229e-02, 5.0439e-02, 1.9660e-01])
[rfa agg] iter:  3, prev_obj_val: 6675.11767578125, obj_val: 6678.8916015625, abs dis: 3.77392578125
[rfa agg] iter: 3, weight: tensor([2.4908e-05, 6.7770e-02, 1.3901e-02, 1.5800e-01, 2.3260e-02, 2.7541e-01,
        3.2049e-01, 2.7446e-02, 5.4986e-02, 5.8718e-02])
[rfa agg] iter:  4, prev_obj_val: 6678.8916015625, obj_val: 6685.71142578125, abs dis: 6.81982421875
[rfa agg] iter: 4, weight: tensor([3.2283e-05, 6.4525e-02, 2.1790e-02, 3.3823e-01, 3.9287e-02, 1.5264e-01,
        1.5408e-01, 4.8136e-02, 1.2293e-01, 5.8355e-02])
[rfa agg] iter:  5, prev_obj_val: 6685.71142578125, obj_val: 6692.4375, abs dis: 6.72607421875
[rfa agg] iter: 5, weight: tensor([3.5366e-05, 5.6041e-02, 3.0196e-02, 1.5372e-01, 6.1603e-02, 9.5770e-02,
        9.5417e-02, 8.1278e-02, 3.7400e-01, 5.1937e-02])
[rfa agg] iter:  6, prev_obj_val: 6692.4375, obj_val: 6692.4296875, abs dis: 0.0078125
[rfa agg] iter: 6, weight: tensor([3.8807e-05, 5.3181e-02, 4.1314e-02, 1.0693e-01, 9.9472e-02, 7.9594e-02,
        7.9047e-02, 1.4726e-01, 3.4322e-01, 4.9936e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3612, Accuracy: 81/10000 (0.8100%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 4.9478, Accuracy: 7/9950 (0.0704%)
saving model
Done in 577.9158477783203 sec.
Server Epoch:40 choose agents : [32, 70, 52, 38, 15, 78, 83, 84, 12, 92].
_Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   1, Avg loss: 0.0533, Accuracy: 257/735 (34.9660%)
_Train Local_ResNet_18, epoch  40, local model 32, internal_epoch   2, Avg loss: 0.0207, Accuracy: 388/735 (52.7891%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 11.0446, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   1, Avg loss: 0.0513, Accuracy: 490/1418 (34.5557%)
_Train Local_ResNet_18, epoch  40, local model 70, internal_epoch   2, Avg loss: 0.0284, Accuracy: 727/1418 (51.2694%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.2613, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   1, Avg loss: 0.0539, Accuracy: 300/636 (47.1698%)
_Train Local_ResNet_18, epoch  40, local model 52, internal_epoch   2, Avg loss: 0.0294, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.4660, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   1, Avg loss: 0.0544, Accuracy: 349/1131 (30.8576%)
_Train Local_ResNet_18, epoch  40, local model 38, internal_epoch   2, Avg loss: 0.0282, Accuracy: 528/1131 (46.6844%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.5170, Accuracy: 104/10000 (1.0400%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   1, Avg loss: 0.0566, Accuracy: 338/1154 (29.2894%)
_Train Local_ResNet_18, epoch  40, local model 15, internal_epoch   2, Avg loss: 0.0279, Accuracy: 516/1154 (44.7140%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 9.5538, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   1, Avg loss: 0.0856, Accuracy: 40/416 (9.6154%)
_Train Local_ResNet_18, epoch  40, local model 78, internal_epoch   2, Avg loss: 0.0463, Accuracy: 198/416 (47.5962%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.8854, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0535, Accuracy: 470/1953 (24.0655%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0321, Accuracy: 838/1953 (42.9083%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.9242, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   1, Avg loss: 0.0596, Accuracy: 324/1190 (27.2269%)
_Train Local_ResNet_18, epoch  40, local model 84, internal_epoch   2, Avg loss: 0.0301, Accuracy: 481/1190 (40.4202%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.4679, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   1, Avg loss: 0.0852, Accuracy: 27/338 (7.9882%)
_Train Local_ResNet_18, epoch  40, local model 12, internal_epoch   2, Avg loss: 0.0446, Accuracy: 147/338 (43.4911%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.4884, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   1, Avg loss: 0.0514, Accuracy: 484/1715 (28.2216%)
_Train Local_ResNet_18, epoch  40, local model 92, internal_epoch   2, Avg loss: 0.0293, Accuracy: 785/1715 (45.7726%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.2383, Accuracy: 103/10000 (1.0300%)
time spent on training: 212.59741258621216
[rfa agg] training data poison_ratio: 0.1079917649260715  data num: [735, 1418, 636, 1131, 1154, 416, 1953, 1190, 338, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.03374742653939734
[rfa agg] init. name: [32, 70, 52, 38, 15, 78, 83, 84, 12, 92], weight: tensor([0.0688, 0.1327, 0.0595, 0.1058, 0.1080, 0.0389, 0.1828, 0.1114, 0.0316,
        0.1605])
[rfa agg] iter:  0, prev_obj_val: 56.054664611816406, obj_val: 58.77820587158203, abs dis: 2.723541259765625
[rfa agg] iter: 0, weight: tensor([0.0233, 0.0772, 0.0157, 0.1980, 0.2708, 0.0077, 0.0363, 0.3175, 0.0058,
        0.0475])
[rfa agg] iter:  1, prev_obj_val: 58.77820587158203, obj_val: 65.99693298339844, abs dis: 7.218727111816406
[rfa agg] iter: 1, weight: tensor([0.0283, 0.0646, 0.0184, 0.3603, 0.2043, 0.0088, 0.0348, 0.2301, 0.0065,
        0.0440])
[rfa agg] iter:  2, prev_obj_val: 65.99693298339844, obj_val: 63.416229248046875, abs dis: 2.5807037353515625
[rfa agg] iter: 2, weight: tensor([0.0660, 0.0883, 0.0399, 0.2884, 0.1771, 0.0179, 0.0550, 0.1875, 0.0132,
        0.0666])
[rfa agg] iter:  3, prev_obj_val: 63.416229248046875, obj_val: 65.99021911621094, abs dis: 2.5739898681640625
[rfa agg] iter: 3, weight: tensor([0.0504, 0.0807, 0.0313, 0.3318, 0.1811, 0.0144, 0.0481, 0.1928, 0.0106,
        0.0590])
[rfa agg] iter:  4, prev_obj_val: 65.99021911621094, obj_val: 63.41629409790039, abs dis: 2.573925018310547
[rfa agg] iter: 4, weight: tensor([0.0662, 0.0885, 0.0399, 0.2879, 0.1773, 0.0179, 0.0551, 0.1872, 0.0132,
        0.0667])
[rfa agg] iter:  5, prev_obj_val: 63.41629409790039, obj_val: 65.9902114868164, abs dis: 2.5739173889160156
[rfa agg] iter: 5, weight: tensor([0.0504, 0.0807, 0.0313, 0.3317, 0.1811, 0.0144, 0.0481, 0.1928, 0.0106,
        0.0590])
[rfa agg] iter:  6, prev_obj_val: 65.9902114868164, obj_val: 63.41629409790039, abs dis: 2.5739173889160156
[rfa agg] iter: 6, weight: tensor([0.0662, 0.0885, 0.0399, 0.2879, 0.1773, 0.0179, 0.0551, 0.1872, 0.0132,
        0.0667])
[rfa agg] iter:  7, prev_obj_val: 63.41629409790039, obj_val: 65.9902114868164, abs dis: 2.5739173889160156
[rfa agg] iter: 7, weight: tensor([0.0504, 0.0807, 0.0313, 0.3317, 0.1811, 0.0144, 0.0481, 0.1928, 0.0106,
        0.0590])
[rfa agg] iter:  8, prev_obj_val: 65.9902114868164, obj_val: 63.41629409790039, abs dis: 2.5739173889160156
[rfa agg] iter: 8, weight: tensor([0.0662, 0.0885, 0.0399, 0.2879, 0.1773, 0.0179, 0.0551, 0.1872, 0.0132,
        0.0667])
[rfa agg] iter:  9, prev_obj_val: 63.41629409790039, obj_val: 65.9902114868164, abs dis: 2.5739173889160156
[rfa agg] iter: 9, weight: tensor([0.0504, 0.0807, 0.0313, 0.3317, 0.1811, 0.0144, 0.0481, 0.1928, 0.0106,
        0.0590])
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3603, Accuracy: 80/10000 (0.8000%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 4.9306, Accuracy: 5/9950 (0.0503%)
saving model
Saving model on epoch 40
Done in 459.7411606311798 sec.
Server Epoch:41 choose agents : [44, 96, 66, 2, 76, 98, 52, 77, 99, 29].
poison local model 44 index 10 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0553, Accuracy: 477/1750 (27.2571%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0343, Accuracy: 676/1750 (38.6286%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   3, Avg loss: 0.0304, Accuracy: 727/1750 (41.5429%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   4, Avg loss: 0.0294, Accuracy: 813/1750 (46.4571%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   5, Avg loss: 0.0286, Accuracy: 844/1750 (48.2286%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   6, Avg loss: 0.0277, Accuracy: 840/1750 (48.0000%), train_poison_data_count: 560
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   7, Avg loss: 0.0271, Accuracy: 900/1750 (51.4286%), train_poison_data_count: 560
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   8, Avg loss: 0.0265, Accuracy: 937/1750 (53.5429%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch   9, Avg loss: 0.0262, Accuracy: 949/1750 (54.2286%), train_poison_data_count: 560
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  41, local model 44, internal_epoch  10, Avg loss: 0.0259, Accuracy: 938/1750 (53.6000%), train_poison_data_count: 560
Global model norm: 112.00059291137704.
Norm before scaling: 111.97157580860645. Distance: 1.1981464276215992
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.3877, Accuracy: 131/10000 (1.3100%)
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: 0.8432, Accuracy: 9186/9950 (92.3216%)
Scaling by  100
Scaled Norm after poisoning: 161.57416543959, distance: 119.81463955444886
Total norm for 1 adversaries is: 161.57416543959. distance: 119.81463955444886
_Test Local_ResNet_18 poisoned: True, epoch: 41, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   1, Avg loss: 0.0823, Accuracy: 17/311 (5.4662%)
_Train Local_ResNet_18, epoch  41, local model 96, internal_epoch   2, Avg loss: 0.0542, Accuracy: 133/311 (42.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.9474, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   1, Avg loss: 0.0593, Accuracy: 289/1402 (20.6134%)
_Train Local_ResNet_18, epoch  41, local model 66, internal_epoch   2, Avg loss: 0.0372, Accuracy: 448/1402 (31.9544%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.2357, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   1, Avg loss: 0.0628, Accuracy: 233/605 (38.5124%)
_Train Local_ResNet_18, epoch  41, local model 2, internal_epoch   2, Avg loss: 0.0380, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.2409, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   1, Avg loss: 0.0799, Accuracy: 73/466 (15.6652%)
_Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   2, Avg loss: 0.0450, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.2476, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   1, Avg loss: 0.0805, Accuracy: 25/373 (6.7024%)
_Train Local_ResNet_18, epoch  41, local model 98, internal_epoch   2, Avg loss: 0.0460, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.4001, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   1, Avg loss: 0.0544, Accuracy: 292/636 (45.9119%)
_Train Local_ResNet_18, epoch  41, local model 52, internal_epoch   2, Avg loss: 0.0290, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.3924, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   1, Avg loss: 0.0503, Accuracy: 353/1340 (26.3433%)
_Train Local_ResNet_18, epoch  41, local model 77, internal_epoch   2, Avg loss: 0.0257, Accuracy: 585/1340 (43.6567%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.0785, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   1, Avg loss: 0.0592, Accuracy: 262/773 (33.8939%)
_Train Local_ResNet_18, epoch  41, local model 99, internal_epoch   2, Avg loss: 0.0295, Accuracy: 443/773 (57.3092%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.7345, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   1, Avg loss: 0.0485, Accuracy: 439/1440 (30.4861%)
_Train Local_ResNet_18, epoch  41, local model 29, internal_epoch   2, Avg loss: 0.0267, Accuracy: 731/1440 (50.7639%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 9.1756, Accuracy: 87/10000 (0.8700%)
time spent on training: 295.42138051986694
[rfa agg] training data poison_ratio: 0.19239226033421283  data num: [1750, 311, 1402, 605, 466, 373, 636, 1340, 773, 1440]
[rfa agg] considering poison per batch poison_fraction: 0.06012258135444151
[rfa agg] init. name: [44, 96, 66, 2, 76, 98, 52, 77, 99, 29], weight: tensor([0.1924, 0.0342, 0.1541, 0.0665, 0.0512, 0.0410, 0.0699, 0.1473, 0.0850,
        0.1583])
[rfa agg] iter:  0, prev_obj_val: 38854.5390625, obj_val: 28176.279296875, abs dis: 10678.259765625
[rfa agg] iter: 0, weight: tensor([0.0536, 0.0399, 0.1810, 0.0777, 0.0598, 0.0479, 0.0817, 0.1729, 0.0994,
        0.1859])
[rfa agg] iter:  1, prev_obj_val: 28176.279296875, obj_val: 25067.177734375, abs dis: 3109.1015625
[rfa agg] iter: 1, weight: tensor([0.0133, 0.0411, 0.1897, 0.0805, 0.0619, 0.0494, 0.0847, 0.1810, 0.1033,
        0.1951])
[rfa agg] iter:  2, prev_obj_val: 25067.177734375, obj_val: 24288.564453125, abs dis: 778.61328125
[rfa agg] iter: 2, weight: tensor([0.0031, 0.0396, 0.1958, 0.0791, 0.0603, 0.0478, 0.0832, 0.1861, 0.1027,
        0.2022])
[rfa agg] iter:  3, prev_obj_val: 24288.564453125, obj_val: 24110.130859375, abs dis: 178.43359375
[rfa agg] iter: 3, weight: tensor([0.0007, 0.0322, 0.2144, 0.0692, 0.0511, 0.0393, 0.0727, 0.1994, 0.0943,
        0.2266])
[rfa agg] iter:  4, prev_obj_val: 24110.130859375, obj_val: 24099.587890625, abs dis: 10.54296875
[rfa agg] iter: 4, weight: tensor([7.5195e-05, 9.3354e-03, 2.7210e-01, 2.4202e-02, 1.6452e-02, 1.1785e-02,
        2.5433e-02, 1.9732e-01, 3.8627e-02, 4.0466e-01])
[rfa agg] iter:  5, prev_obj_val: 24099.587890625, obj_val: 24102.001953125, abs dis: 2.4140625
[rfa agg] iter: 5, weight: tensor([5.0905e-05, 8.4253e-03, 2.6689e-01, 2.4540e-02, 1.5767e-02, 1.0825e-02,
        2.5778e-02, 4.1164e-01, 4.4638e-02, 1.9145e-01])
[rfa agg] iter:  6, prev_obj_val: 24102.001953125, obj_val: 24105.962890625, abs dis: 3.9609375
[rfa agg] iter: 6, weight: tensor([6.9447e-05, 1.2315e-02, 2.5084e-01, 3.7190e-02, 2.3462e-02, 1.5904e-02,
        3.9045e-02, 3.5464e-01, 7.0951e-02, 1.9559e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3601, Accuracy: 79/10000 (0.7900%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 4.9484, Accuracy: 6/9950 (0.0603%)
saving model
Saving model on epoch 41
Done in 539.5665817260742 sec.
Server Epoch:42 choose agents : [5, 45, 88, 53, 24, 60, 19, 4, 51, 79].
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   1, Avg loss: 0.0486, Accuracy: 408/1628 (25.0614%)
_Train Local_ResNet_18, epoch  42, local model 5, internal_epoch   2, Avg loss: 0.0236, Accuracy: 931/1628 (57.1867%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 9.4538, Accuracy: 151/10000 (1.5100%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0646, Accuracy: 218/669 (32.5859%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0377, Accuracy: 358/669 (53.5127%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.6418, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   1, Avg loss: 0.0750, Accuracy: 141/603 (23.3831%)
_Train Local_ResNet_18, epoch  42, local model 88, internal_epoch   2, Avg loss: 0.0434, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.5120, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   1, Avg loss: 0.0499, Accuracy: 312/813 (38.3764%)
_Train Local_ResNet_18, epoch  42, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 502/813 (61.7466%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 12.7146, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   1, Avg loss: 0.0705, Accuracy: 87/312 (27.8846%)
_Train Local_ResNet_18, epoch  42, local model 24, internal_epoch   2, Avg loss: 0.0354, Accuracy: 193/312 (61.8590%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.6956, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0484, Accuracy: 688/2227 (30.8936%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0268, Accuracy: 1091/2227 (48.9897%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.1816, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   1, Avg loss: 0.0457, Accuracy: 429/1036 (41.4093%)
_Train Local_ResNet_18, epoch  42, local model 19, internal_epoch   2, Avg loss: 0.0241, Accuracy: 710/1036 (68.5328%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 12.1158, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0596, Accuracy: 334/901 (37.0699%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 411/901 (45.6160%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.5586, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   1, Avg loss: 0.0544, Accuracy: 272/1049 (25.9295%)
_Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   2, Avg loss: 0.0271, Accuracy: 567/1049 (54.0515%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.0382, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   1, Avg loss: 0.1092, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  42, local model 79, internal_epoch   2, Avg loss: 0.0898, Accuracy: 48/197 (24.3655%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.4363, Accuracy: 50/10000 (0.5000%)
time spent on training: 212.20620775222778
[rfa agg] training data poison_ratio: 0.17254901960784313  data num: [1628, 669, 603, 813, 312, 2227, 1036, 901, 1049, 197]
[rfa agg] considering poison per batch poison_fraction: 0.05392156862745098
[rfa agg] init. name: [5, 45, 88, 53, 24, 60, 19, 4, 51, 79], weight: tensor([0.1725, 0.0709, 0.0639, 0.0862, 0.0331, 0.2360, 0.1098, 0.0955, 0.1112,
        0.0209])
[rfa agg] iter:  0, prev_obj_val: 73.01304626464844, obj_val: 74.8731460571289, abs dis: 1.8600997924804688
[rfa agg] iter: 0, weight: tensor([0.0781, 0.0368, 0.0290, 0.0623, 0.0093, 0.0506, 0.3171, 0.1121, 0.2992,
        0.0054])
[rfa agg] iter:  1, prev_obj_val: 74.8731460571289, obj_val: 79.80054473876953, abs dis: 4.927398681640625
[rfa agg] iter: 1, weight: tensor([0.0493, 0.0470, 0.0347, 0.1008, 0.0095, 0.0364, 0.2051, 0.3111, 0.2006,
        0.0055])
[rfa agg] iter:  2, prev_obj_val: 79.80054473876953, obj_val: 79.7789535522461, abs dis: 0.0215911865234375
[rfa agg] iter: 2, weight: tensor([0.0479, 0.0773, 0.0527, 0.2501, 0.0123, 0.0376, 0.1197, 0.2760, 0.1196,
        0.0070])
[rfa agg] iter:  3, prev_obj_val: 79.7789535522461, obj_val: 81.79170989990234, abs dis: 2.01275634765625
[rfa agg] iter: 3, weight: tensor([0.0474, 0.0766, 0.0522, 0.2583, 0.0122, 0.0372, 0.1182, 0.2734, 0.1176,
        0.0069])
[rfa agg] iter:  4, prev_obj_val: 81.79170989990234, obj_val: 81.77655792236328, abs dis: 0.0151519775390625
[rfa agg] iter: 4, weight: tensor([0.0426, 0.0851, 0.0555, 0.3901, 0.0120, 0.0339, 0.0953, 0.1836, 0.0952,
        0.0068])
[rfa agg] iter:  5, prev_obj_val: 81.77655792236328, obj_val: 81.77623748779297, abs dis: 0.0003204345703125
[rfa agg] iter: 5, weight: tensor([0.0412, 0.0825, 0.0538, 0.4119, 0.0117, 0.0329, 0.0923, 0.1751, 0.0921,
        0.0066])
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3574, Accuracy: 74/10000 (0.7400%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 4.9532, Accuracy: 12/9950 (0.1206%)
saving model
Saving model on epoch 42
Done in 456.56095838546753 sec.
Server Epoch:43 choose agents : [49, 71, 38, 53, 30, 18, 45, 40, 35, 5].
poison local model 49 index 11 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   1, Avg loss: 0.0744, Accuracy: 63/440 (14.3182%), train_poison_data_count: 140
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   2, Avg loss: 0.0472, Accuracy: 140/440 (31.8182%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   3, Avg loss: 0.0380, Accuracy: 140/440 (31.8182%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   4, Avg loss: 0.0354, Accuracy: 154/440 (35.0000%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   5, Avg loss: 0.0335, Accuracy: 164/440 (37.2727%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   6, Avg loss: 0.0328, Accuracy: 171/440 (38.8636%), train_poison_data_count: 140
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   7, Avg loss: 0.0324, Accuracy: 168/440 (38.1818%), train_poison_data_count: 140
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   8, Avg loss: 0.0327, Accuracy: 171/440 (38.8636%), train_poison_data_count: 140
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch   9, Avg loss: 0.0312, Accuracy: 183/440 (41.5909%), train_poison_data_count: 140
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  43, local model 49, internal_epoch  10, Avg loss: 0.0303, Accuracy: 182/440 (41.3636%), train_poison_data_count: 140
Global model norm: 111.99789862705015.
Norm before scaling: 111.99384835924025. Distance: 0.6000222390742295
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.7479, Accuracy: 67/10000 (0.6700%)
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: 1.1559, Accuracy: 8265/9950 (83.0653%)
Scaling by  100
Scaled Norm after poisoning: 126.55833712289562, distance: 60.00222570741647
Total norm for 3 adversaries is: 126.55833712289562. distance: 60.00222570741647
_Test Local_ResNet_18 poisoned: True, epoch: 43, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   1, Avg loss: 0.0603, Accuracy: 208/818 (25.4279%)
_Train Local_ResNet_18, epoch  43, local model 71, internal_epoch   2, Avg loss: 0.0271, Accuracy: 425/818 (51.9560%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.8292, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   1, Avg loss: 0.0520, Accuracy: 384/1131 (33.9523%)
_Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   2, Avg loss: 0.0271, Accuracy: 552/1131 (48.8064%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.6749, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   1, Avg loss: 0.0451, Accuracy: 329/813 (40.4674%)
_Train Local_ResNet_18, epoch  43, local model 53, internal_epoch   2, Avg loss: 0.0183, Accuracy: 498/813 (61.2546%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 12.7623, Accuracy: 56/10000 (0.5600%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0775, Accuracy: 80/486 (16.4609%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0389, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.2388, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   1, Avg loss: 0.0741, Accuracy: 131/530 (24.7170%)
_Train Local_ResNet_18, epoch  43, local model 18, internal_epoch   2, Avg loss: 0.0367, Accuracy: 280/530 (52.8302%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.3183, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   1, Avg loss: 0.0646, Accuracy: 217/669 (32.4365%)
_Train Local_ResNet_18, epoch  43, local model 45, internal_epoch   2, Avg loss: 0.0369, Accuracy: 364/669 (54.4096%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.7288, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0546, Accuracy: 413/1573 (26.2556%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0336, Accuracy: 593/1573 (37.6987%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.7142, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   1, Avg loss: 0.0889, Accuracy: 16/271 (5.9041%)
_Train Local_ResNet_18, epoch  43, local model 35, internal_epoch   2, Avg loss: 0.0554, Accuracy: 136/271 (50.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.1253, Accuracy: 68/10000 (0.6800%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   1, Avg loss: 0.0480, Accuracy: 480/1628 (29.4840%)
_Train Local_ResNet_18, epoch  43, local model 5, internal_epoch   2, Avg loss: 0.0237, Accuracy: 897/1628 (55.0983%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 10.1470, Accuracy: 145/10000 (1.4500%)
time spent on training: 298.2151138782501
[rfa agg] training data poison_ratio: 0.30553894006460103  data num: [440, 818, 1131, 813, 486, 530, 669, 1573, 271, 1628]
[rfa agg] considering poison per batch poison_fraction: 0.09548091877018783
[rfa agg] init. name: [49, 71, 38, 53, 30, 18, 45, 40, 35, 5], weight: tensor([0.0526, 0.0979, 0.1353, 0.0973, 0.0581, 0.0634, 0.0800, 0.1882, 0.0324,
        0.1948])
[rfa agg] iter:  0, prev_obj_val: 3086.51708984375, obj_val: 1711.07421875, abs dis: 1375.44287109375
[rfa agg] iter: 0, weight: tensor([0.0030, 0.1002, 0.1424, 0.0996, 0.0580, 0.0635, 0.0811, 0.2060, 0.0318,
        0.2144])
[rfa agg] iter:  1, prev_obj_val: 1711.07421875, obj_val: 1698.9434814453125, abs dis: 12.1307373046875
[rfa agg] iter: 1, weight: tensor([4.3323e-05, 2.0705e-02, 4.5292e-02, 2.0569e-02, 8.9820e-03, 1.0354e-02,
        1.4747e-02, 3.1721e-01, 4.3105e-03, 5.5779e-01])
[rfa agg] iter:  2, prev_obj_val: 1698.9434814453125, obj_val: 1695.5006103515625, abs dis: 3.44287109375
[rfa agg] iter: 2, weight: tensor([7.7991e-05, 5.2867e-02, 1.5049e-01, 5.2447e-02, 2.0632e-02, 2.4158e-02,
        3.5724e-02, 3.7026e-01, 9.5372e-03, 2.8380e-01])
[rfa agg] iter:  3, prev_obj_val: 1695.5006103515625, obj_val: 1694.98046875, abs dis: 0.5201416015625
[rfa agg] iter: 3, weight: tensor([7.8217e-05, 7.7436e-02, 3.9873e-01, 7.6746e-02, 2.6112e-02, 3.1176e-02,
        4.8460e-02, 1.7584e-01, 1.1556e-02, 1.5387e-01])
[rfa agg] iter:  4, prev_obj_val: 1694.98046875, obj_val: 1697.5001220703125, abs dis: 2.5196533203125
[rfa agg] iter: 4, weight: tensor([6.3027e-05, 1.0076e-01, 4.8598e-01, 9.9539e-02, 2.6897e-02, 3.2973e-02,
        5.5207e-02, 9.7556e-02, 1.1259e-02, 8.9763e-02])
[rfa agg] iter:  5, prev_obj_val: 1697.5001220703125, obj_val: 1699.6136474609375, abs dis: 2.113525390625
[rfa agg] iter: 5, weight: tensor([7.0427e-05, 2.1685e-01, 2.0771e-01, 2.1133e-01, 3.8612e-02, 4.9044e-02,
        9.1746e-02, 8.7354e-02, 1.5098e-02, 8.2195e-02])
[rfa agg] iter:  6, prev_obj_val: 1699.6136474609375, obj_val: 1704.8570556640625, abs dis: 5.243408203125
[rfa agg] iter: 6, weight: tensor([3.9549e-05, 3.6380e-01, 7.7777e-02, 3.1943e-01, 2.7585e-02, 3.6719e-02,
        8.1236e-02, 4.2749e-02, 9.9832e-03, 4.0685e-02])
[rfa agg] iter:  7, prev_obj_val: 1704.8570556640625, obj_val: 1704.8428955078125, abs dis: 0.01416015625
[rfa agg] iter: 7, weight: tensor([4.5270e-05, 2.6996e-01, 6.6987e-02, 2.5639e-01, 4.3229e-02, 6.2661e-02,
        2.0192e-01, 4.3326e-02, 1.3876e-02, 4.1611e-02])
[rfa agg] iter:  8, prev_obj_val: 1704.8428955078125, obj_val: 1707.2225341796875, abs dis: 2.379638671875
[rfa agg] iter: 8, weight: tensor([4.5173e-05, 2.6661e-01, 6.6856e-02, 2.5260e-01, 4.3143e-02, 6.2606e-02,
        2.0954e-01, 4.3231e-02, 1.3850e-02, 4.1523e-02])
[rfa agg] iter:  9, prev_obj_val: 1707.2225341796875, obj_val: 1709.745849609375, abs dis: 2.5233154296875
[rfa agg] iter: 9, weight: tensor([4.6415e-05, 1.9200e-01, 6.3510e-02, 1.8623e-01, 5.0535e-02, 7.6848e-02,
        3.3151e-01, 4.2788e-02, 1.5325e-02, 4.1207e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3565, Accuracy: 78/10000 (0.7800%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 4.9751, Accuracy: 12/9950 (0.1206%)
saving model
Done in 544.0537688732147 sec.
Server Epoch:44 choose agents : [91, 35, 89, 37, 4, 10, 47, 36, 24, 61].
_Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   1, Avg loss: 0.0504, Accuracy: 348/1030 (33.7864%)
_Train Local_ResNet_18, epoch  44, local model 91, internal_epoch   2, Avg loss: 0.0229, Accuracy: 695/1030 (67.4757%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.1188, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   1, Avg loss: 0.0883, Accuracy: 30/271 (11.0701%)
_Train Local_ResNet_18, epoch  44, local model 35, internal_epoch   2, Avg loss: 0.0555, Accuracy: 119/271 (43.9114%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.0778, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   1, Avg loss: 0.0592, Accuracy: 346/896 (38.6161%)
_Train Local_ResNet_18, epoch  44, local model 89, internal_epoch   2, Avg loss: 0.0327, Accuracy: 462/896 (51.5625%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.0132, Accuracy: 59/10000 (0.5900%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   1, Avg loss: 0.0473, Accuracy: 509/1129 (45.0841%)
_Train Local_ResNet_18, epoch  44, local model 37, internal_epoch   2, Avg loss: 0.0218, Accuracy: 775/1129 (68.6448%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.4510, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0573, Accuracy: 349/901 (38.7347%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0315, Accuracy: 407/901 (45.1720%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 9.4276, Accuracy: 50/10000 (0.5000%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   1, Avg loss: 0.0555, Accuracy: 245/861 (28.4553%)
_Train Local_ResNet_18, epoch  44, local model 10, internal_epoch   2, Avg loss: 0.0194, Accuracy: 488/861 (56.6783%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 10.0204, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   1, Avg loss: 0.1219, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  44, local model 47, internal_epoch   2, Avg loss: 0.1060, Accuracy: 25/134 (18.6567%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3733, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   1, Avg loss: 0.0835, Accuracy: 49/408 (12.0098%)
_Train Local_ResNet_18, epoch  44, local model 36, internal_epoch   2, Avg loss: 0.0473, Accuracy: 152/408 (37.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.9424, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   1, Avg loss: 0.0716, Accuracy: 84/312 (26.9231%)
_Train Local_ResNet_18, epoch  44, local model 24, internal_epoch   2, Avg loss: 0.0358, Accuracy: 186/312 (59.6154%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.7195, Accuracy: 56/10000 (0.5600%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   1, Avg loss: 0.1264, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  44, local model 61, internal_epoch   2, Avg loss: 0.1177, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3573, Accuracy: 68/10000 (0.6800%)
time spent on training: 203.47570252418518
[rfa agg] training data poison_ratio: 0.3442840550854488  data num: [1030, 271, 896, 1129, 901, 861, 134, 408, 312, 85]
[rfa agg] considering poison per batch poison_fraction: 0.10758876721420274
[rfa agg] init. name: [91, 35, 89, 37, 4, 10, 47, 36, 24, 61], weight: tensor([0.1709, 0.0450, 0.1487, 0.1873, 0.1495, 0.1429, 0.0222, 0.0677, 0.0518,
        0.0141])
[rfa agg] iter:  0, prev_obj_val: 42.2907829284668, obj_val: 37.125389099121094, abs dis: 5.165393829345703
[rfa agg] iter: 0, weight: tensor([0.1241, 0.0279, 0.2324, 0.1156, 0.1691, 0.2217, 0.0106, 0.0605, 0.0321,
        0.0060])
[rfa agg] iter:  1, prev_obj_val: 37.125389099121094, obj_val: 37.1223030090332, abs dis: 0.003086090087890625
[rfa agg] iter: 1, weight: tensor([0.1107, 0.0178, 0.2743, 0.1000, 0.1712, 0.2581, 0.0070, 0.0365, 0.0205,
        0.0040])
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3546, Accuracy: 81/10000 (0.8100%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 4.9897, Accuracy: 17/9950 (0.1709%)
saving model
Done in 447.57125449180603 sec.
Server Epoch:45 choose agents : [55, 62, 30, 4, 18, 38, 76, 69, 42, 68].
poison local model 55 index 12 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   1, Avg loss: 0.0581, Accuracy: 259/1071 (24.1830%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   2, Avg loss: 0.0294, Accuracy: 395/1071 (36.8814%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   3, Avg loss: 0.0278, Accuracy: 423/1071 (39.4958%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   4, Avg loss: 0.0268, Accuracy: 462/1071 (43.1373%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   5, Avg loss: 0.0268, Accuracy: 477/1071 (44.5378%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   6, Avg loss: 0.0263, Accuracy: 442/1071 (41.2698%), train_poison_data_count: 340
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   7, Avg loss: 0.0260, Accuracy: 468/1071 (43.6975%), train_poison_data_count: 340
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   8, Avg loss: 0.0247, Accuracy: 484/1071 (45.1914%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch   9, Avg loss: 0.0254, Accuracy: 494/1071 (46.1251%), train_poison_data_count: 340
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  45, local model 55, internal_epoch  10, Avg loss: 0.0257, Accuracy: 502/1071 (46.8721%), train_poison_data_count: 340
Global model norm: 111.99584517265585.
Norm before scaling: 111.98029262999808. Distance: 1.0014782350891909
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.5154, Accuracy: 78/10000 (0.7800%)
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: 0.9266, Accuracy: 8438/9950 (84.8040%)
Scaling by  100
Scaled Norm after poisoning: 148.74240395521042, distance: 100.14781555749232
Total norm for 2 adversaries is: 148.74240395521042. distance: 100.14781555749232
_Test Local_ResNet_18 poisoned: True, epoch: 45, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   1, Avg loss: 0.0679, Accuracy: 155/568 (27.2887%)
_Train Local_ResNet_18, epoch  45, local model 62, internal_epoch   2, Avg loss: 0.0397, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.1553, Accuracy: 68/10000 (0.6800%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   1, Avg loss: 0.0766, Accuracy: 95/486 (19.5473%)
_Train Local_ResNet_18, epoch  45, local model 30, internal_epoch   2, Avg loss: 0.0386, Accuracy: 211/486 (43.4156%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.6222, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   1, Avg loss: 0.0572, Accuracy: 352/901 (39.0677%)
_Train Local_ResNet_18, epoch  45, local model 4, internal_epoch   2, Avg loss: 0.0321, Accuracy: 373/901 (41.3984%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.0240, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   1, Avg loss: 0.0722, Accuracy: 139/530 (26.2264%)
_Train Local_ResNet_18, epoch  45, local model 18, internal_epoch   2, Avg loss: 0.0374, Accuracy: 281/530 (53.0189%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.3250, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   1, Avg loss: 0.0529, Accuracy: 367/1131 (32.4492%)
_Train Local_ResNet_18, epoch  45, local model 38, internal_epoch   2, Avg loss: 0.0271, Accuracy: 554/1131 (48.9832%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.1870, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   1, Avg loss: 0.0784, Accuracy: 75/466 (16.0944%)
_Train Local_ResNet_18, epoch  45, local model 76, internal_epoch   2, Avg loss: 0.0416, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.9571, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   1, Avg loss: 0.0599, Accuracy: 283/590 (47.9661%)
_Train Local_ResNet_18, epoch  45, local model 69, internal_epoch   2, Avg loss: 0.0300, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 10.3830, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   1, Avg loss: 0.0524, Accuracy: 378/1372 (27.5510%)
_Train Local_ResNet_18, epoch  45, local model 42, internal_epoch   2, Avg loss: 0.0300, Accuracy: 570/1372 (41.5452%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.5796, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   1, Avg loss: 0.0628, Accuracy: 355/1163 (30.5245%)
_Train Local_ResNet_18, epoch  45, local model 68, internal_epoch   2, Avg loss: 0.0365, Accuracy: 419/1163 (36.0275%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.6073, Accuracy: 69/10000 (0.6900%)
time spent on training: 302.6732585430145
[rfa agg] training data poison_ratio: 0.18808891036482242  data num: [1071, 568, 486, 901, 530, 1131, 466, 590, 1372, 1163]
[rfa agg] considering poison per batch poison_fraction: 0.05877778448900701
[rfa agg] init. name: [55, 62, 30, 4, 18, 38, 76, 69, 42, 68], weight: tensor([0.1294, 0.0686, 0.0587, 0.1088, 0.0640, 0.1366, 0.0563, 0.0713, 0.1657,
        0.1405])
[rfa agg] iter:  0, prev_obj_val: 17081.58984375, obj_val: 11021.4482421875, abs dis: 6060.1416015625
[rfa agg] iter: 0, weight: tensor([0.0216, 0.0767, 0.0655, 0.1223, 0.0715, 0.1539, 0.0629, 0.0797, 0.1874,
        0.1584])
[rfa agg] iter:  1, prev_obj_val: 11021.4482421875, obj_val: 9983.884765625, abs dis: 1037.5634765625
[rfa agg] iter: 1, weight: tensor([0.0032, 0.0759, 0.0646, 0.1244, 0.0708, 0.1587, 0.0619, 0.0793, 0.1970,
        0.1642])
[rfa agg] iter:  2, prev_obj_val: 9983.884765625, obj_val: 9853.955078125, abs dis: 129.9296875
[rfa agg] iter: 2, weight: tensor([0.0004, 0.0603, 0.0500, 0.1186, 0.0563, 0.1691, 0.0479, 0.0647, 0.2505,
        0.1822])
[rfa agg] iter:  3, prev_obj_val: 9853.955078125, obj_val: 9856.4345703125, abs dis: 2.4794921875
[rfa agg] iter: 3, weight: tensor([3.9601e-05, 1.9753e-02, 1.5222e-02, 9.0989e-02, 1.8430e-02, 4.2826e-01,
        1.4585e-02, 2.3068e-02, 1.0503e-01, 2.8462e-01])
[rfa agg] iter:  4, prev_obj_val: 9856.4345703125, obj_val: 9863.095703125, abs dis: 6.6611328125
[rfa agg] iter: 4, weight: tensor([5.5545e-05, 3.8249e-02, 2.8422e-02, 3.9534e-01, 3.5685e-02, 1.9372e-01,
        2.7221e-02, 4.6836e-02, 9.1519e-02, 1.4295e-01])
[rfa agg] iter:  5, prev_obj_val: 9863.095703125, obj_val: 9866.287109375, abs dis: 3.19140625
[rfa agg] iter: 5, weight: tensor([7.6239e-05, 8.4842e-02, 5.8391e-02, 2.6278e-01, 7.9132e-02, 1.3498e-01,
        5.5821e-02, 1.1669e-01, 9.1412e-02, 1.1588e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3525, Accuracy: 87/10000 (0.8700%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 4.9949, Accuracy: 13/9950 (0.1307%)
saving model
Done in 543.8220970630646 sec.
Server Epoch:46 choose agents : [34, 94, 32, 2, 30, 67, 17, 61, 73, 89].
_Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   1, Avg loss: 0.0575, Accuracy: 410/1427 (28.7316%)
_Train Local_ResNet_18, epoch  46, local model 34, internal_epoch   2, Avg loss: 0.0315, Accuracy: 608/1427 (42.6069%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.6878, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   1, Avg loss: 0.0545, Accuracy: 394/1662 (23.7064%)
_Train Local_ResNet_18, epoch  46, local model 94, internal_epoch   2, Avg loss: 0.0318, Accuracy: 658/1662 (39.5909%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.2571, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   1, Avg loss: 0.0538, Accuracy: 242/735 (32.9252%)
_Train Local_ResNet_18, epoch  46, local model 32, internal_epoch   2, Avg loss: 0.0208, Accuracy: 377/735 (51.2925%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 10.3992, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   1, Avg loss: 0.0620, Accuracy: 238/605 (39.3388%)
_Train Local_ResNet_18, epoch  46, local model 2, internal_epoch   2, Avg loss: 0.0384, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.2332, Accuracy: 87/10000 (0.8700%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   1, Avg loss: 0.0758, Accuracy: 92/486 (18.9300%)
_Train Local_ResNet_18, epoch  46, local model 30, internal_epoch   2, Avg loss: 0.0374, Accuracy: 219/486 (45.0617%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.8952, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   1, Avg loss: 0.0742, Accuracy: 82/426 (19.2488%)
_Train Local_ResNet_18, epoch  46, local model 67, internal_epoch   2, Avg loss: 0.0390, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.0500, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   1, Avg loss: 0.0478, Accuracy: 492/1574 (31.2579%)
_Train Local_ResNet_18, epoch  46, local model 17, internal_epoch   2, Avg loss: 0.0255, Accuracy: 698/1574 (44.3456%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.5919, Accuracy: 118/10000 (1.1800%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   1, Avg loss: 0.1258, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  46, local model 61, internal_epoch   2, Avg loss: 0.1171, Accuracy: 4/85 (4.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3535, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   1, Avg loss: 0.0630, Accuracy: 179/938 (19.0832%)
_Train Local_ResNet_18, epoch  46, local model 73, internal_epoch   2, Avg loss: 0.0326, Accuracy: 356/938 (37.9531%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 9.2775, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   1, Avg loss: 0.0571, Accuracy: 349/896 (38.9509%)
_Train Local_ResNet_18, epoch  46, local model 89, internal_epoch   2, Avg loss: 0.0320, Accuracy: 458/896 (51.1161%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.3891, Accuracy: 56/10000 (0.5600%)
time spent on training: 217.23681616783142
[rfa agg] training data poison_ratio: 0.06463663119764546  data num: [1427, 1662, 735, 605, 486, 426, 1574, 85, 938, 896]
[rfa agg] considering poison per batch poison_fraction: 0.020198947249264205
[rfa agg] init. name: [34, 94, 32, 2, 30, 67, 17, 61, 73, 89], weight: tensor([0.1615, 0.1881, 0.0832, 0.0685, 0.0550, 0.0482, 0.1782, 0.0096, 0.1062,
        0.1014])
[rfa agg] iter:  0, prev_obj_val: 60.691383361816406, obj_val: 63.604312896728516, abs dis: 2.9129295349121094
[rfa agg] iter: 0, weight: tensor([0.0718, 0.0600, 0.0789, 0.0416, 0.0246, 0.0190, 0.0627, 0.0024, 0.4369,
        0.2022])
[rfa agg] iter:  1, prev_obj_val: 63.604312896728516, obj_val: 67.37915802001953, abs dis: 3.7748451232910156
[rfa agg] iter: 1, weight: tensor([0.0474, 0.0415, 0.1061, 0.0450, 0.0242, 0.0182, 0.0428, 0.0021, 0.2623,
        0.4103])
[rfa agg] iter:  2, prev_obj_val: 67.37915802001953, obj_val: 69.46664428710938, abs dis: 2.0874862670898438
[rfa agg] iter: 2, weight: tensor([0.0531, 0.0477, 0.2384, 0.0741, 0.0362, 0.0265, 0.0488, 0.0029, 0.1692,
        0.3031])
[rfa agg] iter:  3, prev_obj_val: 69.46664428710938, obj_val: 71.69789123535156, abs dis: 2.2312469482421875
[rfa agg] iter: 3, weight: tensor([0.0480, 0.0436, 0.3828, 0.0841, 0.0381, 0.0274, 0.0445, 0.0029, 0.1297,
        0.1991])
[rfa agg] iter:  4, prev_obj_val: 71.69789123535156, obj_val: 77.17729949951172, abs dis: 5.479408264160156
[rfa agg] iter: 4, weight: tensor([0.0354, 0.0324, 0.5592, 0.0804, 0.0330, 0.0232, 0.0331, 0.0023, 0.0839,
        0.1170])
[rfa agg] iter:  5, prev_obj_val: 77.17729949951172, obj_val: 74.3507080078125, abs dis: 2.8265914916992188
[rfa agg] iter: 5, weight: tensor([0.0496, 0.0463, 0.2987, 0.2247, 0.0669, 0.0443, 0.0470, 0.0040, 0.0969,
        0.1217])
[rfa agg] iter:  6, prev_obj_val: 74.3507080078125, obj_val: 74.34249877929688, abs dis: 0.008209228515625
[rfa agg] iter: 6, weight: tensor([0.0448, 0.0415, 0.4221, 0.1410, 0.0500, 0.0342, 0.0422, 0.0032, 0.0958,
        0.1254])
[rfa agg] iter:  7, prev_obj_val: 74.34249877929688, obj_val: 74.34239196777344, abs dis: 0.0001068115234375
[rfa agg] iter: 7, weight: tensor([0.0438, 0.0405, 0.4377, 0.1362, 0.0487, 0.0333, 0.0411, 0.0032, 0.0934,
        0.1222])
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3532, Accuracy: 78/10000 (0.7800%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 4.6102, Accuracy: 706/9950 (7.0955%)
saving model
Done in 478.2970688343048 sec.
Server Epoch:47 choose agents : [61, 49, 64, 19, 88, 44, 5, 46, 59, 14].
poison local model 61 index 13 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   1, Avg loss: 0.1147, Accuracy: 3/85 (3.5294%), train_poison_data_count: 40
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   2, Avg loss: 0.1009, Accuracy: 33/85 (38.8235%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   3, Avg loss: 0.0853, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   4, Avg loss: 0.0821, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   5, Avg loss: 0.0792, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   6, Avg loss: 0.0760, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   7, Avg loss: 0.0717, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   8, Avg loss: 0.0671, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch   9, Avg loss: 0.0648, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  47, local model 61, internal_epoch  10, Avg loss: 0.0651, Accuracy: 40/85 (47.0588%), train_poison_data_count: 40
Global model norm: 111.99384835924025.
Norm before scaling: 111.99322925265393. Distance: 0.20257107694099763
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.5725, Accuracy: 50/10000 (0.5000%)
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: 1.4932, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 113.73297005073991, distance: 20.257107464592057
Total norm for 4 adversaries is: 113.73297005073991. distance: 20.257107464592057
_Test Local_ResNet_18 poisoned: True, epoch: 47, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   1, Avg loss: 0.0740, Accuracy: 73/440 (16.5909%)
_Train Local_ResNet_18, epoch  47, local model 49, internal_epoch   2, Avg loss: 0.0438, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 6.8001, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   1, Avg loss: 0.0601, Accuracy: 195/953 (20.4617%)
_Train Local_ResNet_18, epoch  47, local model 64, internal_epoch   2, Avg loss: 0.0363, Accuracy: 333/953 (34.9423%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.1623, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   1, Avg loss: 0.0462, Accuracy: 426/1036 (41.1197%)
_Train Local_ResNet_18, epoch  47, local model 19, internal_epoch   2, Avg loss: 0.0226, Accuracy: 708/1036 (68.3398%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 13.1822, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   1, Avg loss: 0.0730, Accuracy: 146/603 (24.2123%)
_Train Local_ResNet_18, epoch  47, local model 88, internal_epoch   2, Avg loss: 0.0444, Accuracy: 288/603 (47.7612%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.7287, Accuracy: 51/10000 (0.5100%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   1, Avg loss: 0.0576, Accuracy: 425/1750 (24.2857%)
_Train Local_ResNet_18, epoch  47, local model 44, internal_epoch   2, Avg loss: 0.0337, Accuracy: 719/1750 (41.0857%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.7915, Accuracy: 126/10000 (1.2600%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   1, Avg loss: 0.0479, Accuracy: 460/1628 (28.2555%)
_Train Local_ResNet_18, epoch  47, local model 5, internal_epoch   2, Avg loss: 0.0232, Accuracy: 916/1628 (56.2654%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.1260, Accuracy: 156/10000 (1.5600%)
_Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   1, Avg loss: 0.0545, Accuracy: 431/1904 (22.6366%)
_Train Local_ResNet_18, epoch  47, local model 46, internal_epoch   2, Avg loss: 0.0298, Accuracy: 758/1904 (39.8109%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.7851, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   1, Avg loss: 0.0500, Accuracy: 343/1089 (31.4968%)
_Train Local_ResNet_18, epoch  47, local model 59, internal_epoch   2, Avg loss: 0.0261, Accuracy: 536/1089 (49.2195%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 9.8436, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   1, Avg loss: 0.0572, Accuracy: 254/1013 (25.0740%)
_Train Local_ResNet_18, epoch  47, local model 14, internal_epoch   2, Avg loss: 0.0320, Accuracy: 445/1013 (43.9289%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.2988, Accuracy: 96/10000 (0.9600%)
time spent on training: 317.86727952957153
[rfa agg] training data poison_ratio: 0.3716788877249786  data num: [85, 440, 953, 1036, 603, 1750, 1628, 1904, 1089, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.11614965241405581
[rfa agg] init. name: [61, 49, 64, 19, 88, 44, 5, 46, 59, 14], weight: tensor([0.0081, 0.0419, 0.0908, 0.0987, 0.0574, 0.1667, 0.1550, 0.1813, 0.1037,
        0.0965])
[rfa agg] iter:  0, prev_obj_val: 133.92091369628906, obj_val: 129.40858459472656, abs dis: 4.5123291015625
[rfa agg] iter: 0, weight: tensor([2.4169e-05, 5.9406e-03, 2.1069e-02, 2.7227e-02, 9.5322e-03, 4.2776e-01,
        2.5430e-01, 1.9831e-01, 3.1500e-02, 2.4336e-02])
[rfa agg] iter:  1, prev_obj_val: 129.40858459472656, obj_val: 129.68093872070312, abs dis: 0.2723541259765625
[rfa agg] iter: 1, weight: tensor([4.0971e-05, 1.2182e-02, 4.9648e-02, 6.9091e-02, 2.0255e-02, 2.0319e-01,
        3.5468e-01, 1.4793e-01, 8.3641e-02, 5.9335e-02])
[rfa agg] iter:  2, prev_obj_val: 129.68093872070312, obj_val: 130.15951538085938, abs dis: 0.47857666015625
[rfa agg] iter: 2, weight: tensor([4.8892e-05, 1.6509e-02, 7.6158e-02, 1.1501e-01, 2.8254e-02, 1.6239e-01,
        2.2638e-01, 1.3329e-01, 1.4756e-01, 9.4393e-02])
[rfa agg] iter:  3, prev_obj_val: 130.15951538085938, obj_val: 132.18218994140625, abs dis: 2.022674560546875
[rfa agg] iter: 3, weight: tensor([4.2728e-05, 1.6680e-02, 9.2943e-02, 1.6496e-01, 2.9679e-02, 1.0717e-01,
        1.3279e-01, 9.3561e-02, 2.3899e-01, 1.2318e-01])
[rfa agg] iter:  4, prev_obj_val: 132.18218994140625, obj_val: 137.13560485839844, abs dis: 4.9534149169921875
[rfa agg] iter: 4, weight: tensor([2.2354e-05, 1.0827e-02, 9.4452e-02, 3.0810e-01, 2.0723e-02, 4.2923e-02,
        4.9301e-02, 3.9296e-02, 2.7456e-01, 1.5980e-01])
[rfa agg] iter:  5, prev_obj_val: 137.13560485839844, obj_val: 142.4436492919922, abs dis: 5.30804443359375
[rfa agg] iter: 5, weight: tensor([2.0425e-05, 1.1549e-02, 1.7756e-01, 2.1010e-01, 2.3637e-02, 3.4382e-02,
        3.8359e-02, 3.2109e-02, 1.1872e-01, 3.5356e-01])
[rfa agg] iter:  6, prev_obj_val: 142.4436492919922, obj_val: 139.53070068359375, abs dis: 2.9129486083984375
[rfa agg] iter: 6, weight: tensor([2.3148e-05, 1.4742e-02, 3.7466e-01, 1.3211e-01, 3.2140e-02, 3.6038e-02,
        3.9599e-02, 3.4018e-02, 9.2166e-02, 2.4451e-01])
[rfa agg] iter:  7, prev_obj_val: 139.53070068359375, obj_val: 149.08201599121094, abs dis: 9.551315307617188
[rfa agg] iter: 7, weight: tensor([2.0252e-05, 1.2135e-02, 3.1366e-01, 1.4557e-01, 2.5598e-02, 3.2769e-02,
        3.6257e-02, 3.0768e-02, 9.3961e-02, 3.0926e-01])
[rfa agg] iter:  8, prev_obj_val: 149.08201599121094, obj_val: 145.62890625, abs dis: 3.4531097412109375
[rfa agg] iter: 8, weight: tensor([3.4330e-05, 2.4998e-02, 3.3058e-01, 1.3389e-01, 5.9433e-02, 4.9705e-02,
        5.3917e-02, 4.7358e-02, 1.0486e-01, 1.9522e-01])
[rfa agg] iter:  9, prev_obj_val: 145.62890625, obj_val: 139.54263305664062, abs dis: 6.086273193359375
[rfa agg] iter: 9, weight: tensor([2.6815e-05, 1.8222e-02, 4.0640e-01, 1.2385e-01, 4.1374e-02, 4.0239e-02,
        4.3917e-02, 3.8164e-02, 9.2734e-02, 1.9507e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3529, Accuracy: 73/10000 (0.7300%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 4.4783, Accuracy: 1678/9950 (16.8643%)
saving model
Done in 569.0842831134796 sec.
Server Epoch:48 choose agents : [21, 78, 90, 85, 84, 38, 88, 31, 97, 66].
_Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   1, Avg loss: 0.0529, Accuracy: 439/1949 (22.5244%)
_Train Local_ResNet_18, epoch  48, local model 21, internal_epoch   2, Avg loss: 0.0317, Accuracy: 660/1949 (33.8635%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.3314, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   1, Avg loss: 0.0865, Accuracy: 32/416 (7.6923%)
_Train Local_ResNet_18, epoch  48, local model 78, internal_epoch   2, Avg loss: 0.0459, Accuracy: 214/416 (51.4423%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.9390, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   1, Avg loss: 0.0540, Accuracy: 326/677 (48.1536%)
_Train Local_ResNet_18, epoch  48, local model 90, internal_epoch   2, Avg loss: 0.0215, Accuracy: 452/677 (66.7651%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 10.5681, Accuracy: 62/10000 (0.6200%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   1, Avg loss: 0.0534, Accuracy: 476/1988 (23.9437%)
_Train Local_ResNet_18, epoch  48, local model 85, internal_epoch   2, Avg loss: 0.0342, Accuracy: 719/1988 (36.1670%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.2011, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   1, Avg loss: 0.0591, Accuracy: 329/1190 (27.6471%)
_Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   2, Avg loss: 0.0295, Accuracy: 517/1190 (43.4454%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.9373, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   1, Avg loss: 0.0515, Accuracy: 389/1131 (34.3943%)
_Train Local_ResNet_18, epoch  48, local model 38, internal_epoch   2, Avg loss: 0.0267, Accuracy: 559/1131 (49.4253%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.1427, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   1, Avg loss: 0.0730, Accuracy: 146/603 (24.2123%)
_Train Local_ResNet_18, epoch  48, local model 88, internal_epoch   2, Avg loss: 0.0441, Accuracy: 278/603 (46.1028%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.1046, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 61/460 (13.2609%)
_Train Local_ResNet_18, epoch  48, local model 31, internal_epoch   2, Avg loss: 0.0381, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.9682, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   1, Avg loss: 0.0512, Accuracy: 348/1213 (28.6892%)
_Train Local_ResNet_18, epoch  48, local model 97, internal_epoch   2, Avg loss: 0.0266, Accuracy: 516/1213 (42.5392%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.7519, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   1, Avg loss: 0.0585, Accuracy: 281/1402 (20.0428%)
_Train Local_ResNet_18, epoch  48, local model 66, internal_epoch   2, Avg loss: 0.0369, Accuracy: 437/1402 (31.1698%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.7373, Accuracy: 77/10000 (0.7700%)
time spent on training: 218.82550406455994
[rfa agg] training data poison_ratio: 0.18025206274367575  data num: [1949, 416, 677, 1988, 1190, 1131, 603, 460, 1213, 1402]
[rfa agg] considering poison per batch poison_fraction: 0.056328769607398674
[rfa agg] init. name: [21, 78, 90, 85, 84, 38, 88, 31, 97, 66], weight: tensor([0.1767, 0.0377, 0.0614, 0.1803, 0.1079, 0.1025, 0.0547, 0.0417, 0.1100,
        0.1271])
[rfa agg] iter:  0, prev_obj_val: 62.751678466796875, obj_val: 66.23055267333984, abs dis: 3.4788742065429688
[rfa agg] iter: 0, weight: tensor([0.0403, 0.0079, 0.0190, 0.0378, 0.2904, 0.1604, 0.0151, 0.0095, 0.2922,
        0.1273])
[rfa agg] iter:  1, prev_obj_val: 66.23055267333984, obj_val: 68.43130493164062, abs dis: 2.2007522583007812
[rfa agg] iter: 1, weight: tensor([0.0342, 0.0086, 0.0220, 0.0323, 0.2194, 0.3520, 0.0172, 0.0105, 0.2252,
        0.0785])
[rfa agg] iter:  2, prev_obj_val: 68.43130493164062, obj_val: 68.4260482788086, abs dis: 0.00525665283203125
[rfa agg] iter: 2, weight: tensor([0.0381, 0.0105, 0.0275, 0.0362, 0.1858, 0.3971, 0.0212, 0.0128, 0.1897,
        0.0811])
[rfa agg] iter:  3, prev_obj_val: 68.4260482788086, obj_val: 70.96110534667969, abs dis: 2.5350570678710938
[rfa agg] iter: 3, weight: tensor([0.0375, 0.0103, 0.0270, 0.0356, 0.1814, 0.4097, 0.0209, 0.0126, 0.1851,
        0.0798])
[rfa agg] iter:  4, prev_obj_val: 70.96110534667969, obj_val: 70.95707702636719, abs dis: 0.0040283203125
[rfa agg] iter: 4, weight: tensor([0.0470, 0.0140, 0.0380, 0.0447, 0.1859, 0.3412, 0.0290, 0.0172, 0.1896,
        0.0935])
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3537, Accuracy: 78/10000 (0.7800%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 4.5169, Accuracy: 811/9950 (8.1508%)
saving model
Done in 461.00881457328796 sec.
Server Epoch:49 choose agents : [65, 16, 50, 5, 97, 4, 13, 23, 86, 72].
poison local model 65 index 14 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   1, Avg loss: 0.0518, Accuracy: 436/1475 (29.5593%), train_poison_data_count: 463
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   2, Avg loss: 0.0302, Accuracy: 580/1475 (39.3220%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   3, Avg loss: 0.0275, Accuracy: 578/1475 (39.1864%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   4, Avg loss: 0.0264, Accuracy: 631/1475 (42.7797%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   5, Avg loss: 0.0254, Accuracy: 672/1475 (45.5593%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   6, Avg loss: 0.0255, Accuracy: 666/1475 (45.1525%), train_poison_data_count: 463
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   7, Avg loss: 0.0249, Accuracy: 698/1475 (47.3220%), train_poison_data_count: 463
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   8, Avg loss: 0.0246, Accuracy: 682/1475 (46.2373%), train_poison_data_count: 463
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch   9, Avg loss: 0.0239, Accuracy: 714/1475 (48.4068%), train_poison_data_count: 463
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  49, local model 65, internal_epoch  10, Avg loss: 0.0244, Accuracy: 677/1475 (45.8983%), train_poison_data_count: 463
Global model norm: 111.99092719250743.
Norm before scaling: 111.96654337764251. Distance: 1.09050766059532
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.8475, Accuracy: 92/10000 (0.9200%)
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: 0.8081, Accuracy: 9159/9950 (92.0503%)
Scaling by  100
Scaled Norm after poisoning: 154.17311571533799, distance: 109.05076494888745
Total norm for 2 adversaries is: 154.17311571533799. distance: 109.05076494888745
_Test Local_ResNet_18 poisoned: True, epoch: 49, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   1, Avg loss: 0.0610, Accuracy: 305/708 (43.0791%)
_Train Local_ResNet_18, epoch  49, local model 16, internal_epoch   2, Avg loss: 0.0330, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.7388, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   1, Avg loss: 0.0592, Accuracy: 180/809 (22.2497%)
_Train Local_ResNet_18, epoch  49, local model 50, internal_epoch   2, Avg loss: 0.0245, Accuracy: 400/809 (49.4438%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 10.8797, Accuracy: 112/10000 (1.1200%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   1, Avg loss: 0.0476, Accuracy: 462/1628 (28.3784%)
_Train Local_ResNet_18, epoch  49, local model 5, internal_epoch   2, Avg loss: 0.0232, Accuracy: 936/1628 (57.4939%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.5354, Accuracy: 155/10000 (1.5500%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   1, Avg loss: 0.0495, Accuracy: 374/1213 (30.8326%)
_Train Local_ResNet_18, epoch  49, local model 97, internal_epoch   2, Avg loss: 0.0256, Accuracy: 602/1213 (49.6290%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.4196, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   1, Avg loss: 0.0565, Accuracy: 356/901 (39.5117%)
_Train Local_ResNet_18, epoch  49, local model 4, internal_epoch   2, Avg loss: 0.0310, Accuracy: 448/901 (49.7225%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 9.7083, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   1, Avg loss: 0.0524, Accuracy: 481/1645 (29.2401%)
_Train Local_ResNet_18, epoch  49, local model 13, internal_epoch   2, Avg loss: 0.0305, Accuracy: 699/1645 (42.4924%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.6392, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   1, Avg loss: 0.0591, Accuracy: 297/715 (41.5385%)
_Train Local_ResNet_18, epoch  49, local model 23, internal_epoch   2, Avg loss: 0.0379, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.3790, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   1, Avg loss: 0.0596, Accuracy: 340/1003 (33.8983%)
_Train Local_ResNet_18, epoch  49, local model 86, internal_epoch   2, Avg loss: 0.0330, Accuracy: 383/1003 (38.1854%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 7.7546, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   1, Avg loss: 0.0583, Accuracy: 297/1241 (23.9323%)
_Train Local_ResNet_18, epoch  49, local model 72, internal_epoch   2, Avg loss: 0.0353, Accuracy: 463/1241 (37.3086%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.3625, Accuracy: 78/10000 (0.7800%)
time spent on training: 368.6878836154938
[rfa agg] training data poison_ratio: 0.2736814252954666  data num: [1475, 708, 809, 1628, 1213, 901, 1645, 715, 1003, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.08552544540483331
[rfa agg] init. name: [65, 16, 50, 5, 97, 4, 13, 23, 86, 72], weight: tensor([0.1301, 0.0624, 0.0714, 0.1436, 0.1070, 0.0795, 0.1451, 0.0631, 0.0885,
        0.1095])
[rfa agg] iter:  0, prev_obj_val: 24239.56640625, obj_val: 15656.775390625, abs dis: 8582.791015625
[rfa agg] iter: 0, weight: tensor([0.0218, 0.0699, 0.0799, 0.1622, 0.1203, 0.0891, 0.1638, 0.0706, 0.0993,
        0.1231])
[rfa agg] iter:  1, prev_obj_val: 15656.775390625, obj_val: 14187.765625, abs dis: 1469.009765625
[rfa agg] iter: 1, weight: tensor([0.0033, 0.0696, 0.0798, 0.1688, 0.1224, 0.0895, 0.1706, 0.0703, 0.1001,
        0.1257])
[rfa agg] iter:  2, prev_obj_val: 14187.765625, obj_val: 13982.0986328125, abs dis: 205.6669921875
[rfa agg] iter: 2, weight: tensor([0.0005, 0.0588, 0.0687, 0.1971, 0.1194, 0.0802, 0.1991, 0.0593, 0.0915,
        0.1255])
[rfa agg] iter:  3, prev_obj_val: 13982.0986328125, obj_val: 13978.4990234375, abs dis: 3.599609375
[rfa agg] iter: 3, weight: tensor([5.5747e-05, 2.9074e-02, 3.6541e-02, 2.3658e-01, 1.3505e-01, 5.0741e-02,
        2.3763e-01, 2.9343e-02, 6.4549e-02, 1.8043e-01])
[rfa agg] iter:  4, prev_obj_val: 13978.4990234375, obj_val: 13983.220703125, abs dis: 4.7216796875
[rfa agg] iter: 4, weight: tensor([3.2683e-05, 2.3389e-02, 3.0529e-02, 7.1352e-02, 2.5767e-01, 4.7195e-02,
        7.2018e-02, 2.3592e-02, 6.5474e-02, 4.0874e-01])
[rfa agg] iter:  5, prev_obj_val: 13983.220703125, obj_val: 13984.3916015625, abs dis: 1.1708984375
[rfa agg] iter: 5, weight: tensor([4.0272e-05, 4.5758e-02, 6.5182e-02, 5.8819e-02, 1.8756e-01, 1.3565e-01,
        5.9391e-02, 4.6090e-02, 2.6869e-01, 1.3282e-01])
[rfa agg] iter:  6, prev_obj_val: 13984.3916015625, obj_val: 13989.896484375, abs dis: 5.5048828125
[rfa agg] iter: 6, weight: tensor([3.3671e-05, 4.2492e-02, 6.2165e-02, 4.6633e-02, 1.2867e-01, 1.4929e-01,
        4.7077e-02, 4.2789e-02, 3.8645e-01, 9.4395e-02])
[rfa agg] iter:  7, prev_obj_val: 13989.896484375, obj_val: 13997.7900390625, abs dis: 7.8935546875
[rfa agg] iter: 7, weight: tensor([3.1262e-05, 5.8223e-02, 9.7378e-02, 3.7442e-02, 7.5935e-02, 3.3780e-01,
        3.7800e-02, 5.8362e-02, 2.3490e-01, 6.2125e-02])
[rfa agg] iter:  8, prev_obj_val: 13997.7900390625, obj_val: 14007.6259765625, abs dis: 9.8359375
[rfa agg] iter: 8, weight: tensor([3.5529e-05, 1.2217e-01, 2.8767e-01, 3.7486e-02, 6.3142e-02, 1.6396e-01,
        3.7849e-02, 1.1984e-01, 1.1326e-01, 5.4589e-02])
[rfa agg] iter:  9, prev_obj_val: 14007.6259765625, obj_val: 14011.6083984375, abs dis: 3.982421875
[rfa agg] iter: 9, weight: tensor([3.2821e-05, 2.7336e-01, 1.9225e-01, 3.0946e-02, 4.5998e-02, 7.8305e-02,
        3.1254e-02, 2.4061e-01, 6.6110e-02, 4.1133e-02])
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3530, Accuracy: 73/10000 (0.7300%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 4.5448, Accuracy: 528/9950 (5.3065%)
saving model
Done in 616.7298231124878 sec.
Server Epoch:50 choose agents : [44, 46, 85, 2, 36, 48, 98, 55, 22, 81].
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   1, Avg loss: 0.0567, Accuracy: 416/1750 (23.7714%)
_Train Local_ResNet_18, epoch  50, local model 44, internal_epoch   2, Avg loss: 0.0337, Accuracy: 741/1750 (42.3429%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.5597, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   1, Avg loss: 0.0535, Accuracy: 451/1904 (23.6870%)
_Train Local_ResNet_18, epoch  50, local model 46, internal_epoch   2, Avg loss: 0.0298, Accuracy: 769/1904 (40.3887%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.9321, Accuracy: 103/10000 (1.0300%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 483/1988 (24.2958%)
_Train Local_ResNet_18, epoch  50, local model 85, internal_epoch   2, Avg loss: 0.0346, Accuracy: 725/1988 (36.4688%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.9862, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 231/605 (38.1818%)
_Train Local_ResNet_18, epoch  50, local model 2, internal_epoch   2, Avg loss: 0.0371, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.0176, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   1, Avg loss: 0.0827, Accuracy: 50/408 (12.2549%)
_Train Local_ResNet_18, epoch  50, local model 36, internal_epoch   2, Avg loss: 0.0494, Accuracy: 154/408 (37.7451%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.3393, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   1, Avg loss: 0.0683, Accuracy: 156/631 (24.7227%)
_Train Local_ResNet_18, epoch  50, local model 48, internal_epoch   2, Avg loss: 0.0403, Accuracy: 268/631 (42.4723%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.8242, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   1, Avg loss: 0.0799, Accuracy: 26/373 (6.9705%)
_Train Local_ResNet_18, epoch  50, local model 98, internal_epoch   2, Avg loss: 0.0462, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.5588, Accuracy: 50/10000 (0.5000%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   1, Avg loss: 0.0570, Accuracy: 275/1071 (25.6769%)
_Train Local_ResNet_18, epoch  50, local model 55, internal_epoch   2, Avg loss: 0.0284, Accuracy: 527/1071 (49.2063%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 9.3434, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   1, Avg loss: 0.0465, Accuracy: 515/1470 (35.0340%)
_Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   2, Avg loss: 0.0228, Accuracy: 893/1470 (60.7483%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.9076, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   1, Avg loss: 0.0694, Accuracy: 227/774 (29.3282%)
_Train Local_ResNet_18, epoch  50, local model 81, internal_epoch   2, Avg loss: 0.0336, Accuracy: 329/774 (42.5065%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.8962, Accuracy: 75/10000 (0.7500%)
time spent on training: 249.98743844032288
[rfa agg] training data poison_ratio: 0.4382176052487698  data num: [1750, 1904, 1988, 605, 408, 631, 373, 1071, 1470, 774]
[rfa agg] considering poison per batch poison_fraction: 0.13694300164024056
[rfa agg] init. name: [44, 46, 85, 2, 36, 48, 98, 55, 22, 81], weight: tensor([0.1595, 0.1735, 0.1812, 0.0551, 0.0372, 0.0575, 0.0340, 0.0976, 0.1340,
        0.0705])
[rfa agg] iter:  0, prev_obj_val: 74.87554168701172, obj_val: 77.45751190185547, abs dis: 2.58197021484375
[rfa agg] iter: 0, weight: tensor([0.1342, 0.1156, 0.0998, 0.0333, 0.0175, 0.0348, 0.0149, 0.1734, 0.3171,
        0.0594])
[rfa agg] iter:  1, prev_obj_val: 77.45751190185547, obj_val: 78.77122497558594, abs dis: 1.3137130737304688
[rfa agg] iter: 1, weight: tensor([0.1223, 0.1080, 0.0947, 0.0380, 0.0195, 0.0396, 0.0165, 0.2456, 0.2451,
        0.0707])
[rfa agg] iter:  2, prev_obj_val: 78.77122497558594, obj_val: 80.09917449951172, abs dis: 1.3279495239257812
[rfa agg] iter: 2, weight: tensor([0.1128, 0.1006, 0.0889, 0.0391, 0.0198, 0.0408, 0.0167, 0.2969, 0.2096,
        0.0746])
[rfa agg] iter:  3, prev_obj_val: 80.09917449951172, obj_val: 81.44160461425781, abs dis: 1.3424301147460938
[rfa agg] iter: 3, weight: tensor([0.1003, 0.0903, 0.0803, 0.0389, 0.0194, 0.0405, 0.0163, 0.3626, 0.1752,
        0.0762])
[rfa agg] iter:  4, prev_obj_val: 81.44160461425781, obj_val: 84.37397766113281, abs dis: 2.932373046875
[rfa agg] iter: 4, weight: tensor([0.0837, 0.0760, 0.0680, 0.0362, 0.0178, 0.0378, 0.0149, 0.4532, 0.1388,
        0.0735])
[rfa agg] iter:  5, prev_obj_val: 84.37397766113281, obj_val: 86.30345153808594, abs dis: 1.929473876953125
[rfa agg] iter: 5, weight: tensor([0.0457, 0.0421, 0.0381, 0.0249, 0.0118, 0.0259, 0.0098, 0.6772, 0.0697,
        0.0548])
[rfa agg] iter:  6, prev_obj_val: 86.30345153808594, obj_val: 90.6510238647461, abs dis: 4.347572326660156
[rfa agg] iter: 6, weight: tensor([0.0502, 0.0466, 0.0424, 0.0307, 0.0142, 0.0320, 0.0117, 0.6274, 0.0738,
        0.0710])
[rfa agg] iter:  7, prev_obj_val: 90.6510238647461, obj_val: 84.40414428710938, abs dis: 6.246879577636719
[rfa agg] iter: 7, weight: tensor([0.0739, 0.0694, 0.0637, 0.0579, 0.0254, 0.0603, 0.0208, 0.3708, 0.1027,
        0.1552])
[rfa agg] iter:  8, prev_obj_val: 84.40414428710938, obj_val: 88.46699523925781, abs dis: 4.0628509521484375
[rfa agg] iter: 8, weight: tensor([0.0490, 0.0452, 0.0409, 0.0267, 0.0126, 0.0278, 0.0105, 0.6536, 0.0747,
        0.0589])
[rfa agg] iter:  9, prev_obj_val: 88.46699523925781, obj_val: 90.62336730957031, abs dis: 2.1563720703125
[rfa agg] iter: 9, weight: tensor([0.0667, 0.0623, 0.0569, 0.0460, 0.0208, 0.0480, 0.0171, 0.4732, 0.0952,
        0.1138])
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3470, Accuracy: 78/10000 (0.7800%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 4.5772, Accuracy: 529/9950 (5.3166%)
saving model
Saving model on epoch 50
Done in 494.6283061504364 sec.
Server Epoch:51 choose agents : [85, 13, 26, 47, 58, 96, 62, 76, 7, 72].
poison local model 85 index 15 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   1, Avg loss: 0.0515, Accuracy: 524/1988 (26.3581%), train_poison_data_count: 624
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   2, Avg loss: 0.0346, Accuracy: 677/1988 (34.0543%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   3, Avg loss: 0.0314, Accuracy: 736/1988 (37.0221%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   4, Avg loss: 0.0318, Accuracy: 705/1988 (35.4628%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   5, Avg loss: 0.0315, Accuracy: 693/1988 (34.8592%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   6, Avg loss: 0.0312, Accuracy: 758/1988 (38.1288%), train_poison_data_count: 624
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   7, Avg loss: 0.0310, Accuracy: 758/1988 (38.1288%), train_poison_data_count: 624
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   8, Avg loss: 0.0302, Accuracy: 778/1988 (39.1348%), train_poison_data_count: 624
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch   9, Avg loss: 0.0302, Accuracy: 791/1988 (39.7887%), train_poison_data_count: 624
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  51, local model 85, internal_epoch  10, Avg loss: 0.0298, Accuracy: 774/1988 (38.9336%), train_poison_data_count: 624
Global model norm: 111.98822831552431.
Norm before scaling: 111.95361239426354. Distance: 1.1866113951933968
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9966, Accuracy: 74/10000 (0.7400%)
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: 0.9781, Accuracy: 8996/9950 (90.4121%)
Scaling by  100
Scaled Norm after poisoning: 160.33081644875696, distance: 118.66114274215886
Total norm for 1 adversaries is: 160.33081644875696. distance: 118.66114274215886
_Test Local_ResNet_18 poisoned: True, epoch: 51, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   1, Avg loss: 0.0527, Accuracy: 440/1645 (26.7477%)
_Train Local_ResNet_18, epoch  51, local model 13, internal_epoch   2, Avg loss: 0.0302, Accuracy: 701/1645 (42.6140%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.3882, Accuracy: 171/10000 (1.7100%)
_Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   1, Avg loss: 0.0530, Accuracy: 357/1446 (24.6888%)
_Train Local_ResNet_18, epoch  51, local model 26, internal_epoch   2, Avg loss: 0.0325, Accuracy: 564/1446 (39.0041%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9049, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   1, Avg loss: 0.1191, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  51, local model 47, internal_epoch   2, Avg loss: 0.1009, Accuracy: 29/134 (21.6418%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3879, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   1, Avg loss: 0.0560, Accuracy: 336/803 (41.8431%)
_Train Local_ResNet_18, epoch  51, local model 58, internal_epoch   2, Avg loss: 0.0320, Accuracy: 401/803 (49.9377%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.5017, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   1, Avg loss: 0.0811, Accuracy: 19/311 (6.1093%)
_Train Local_ResNet_18, epoch  51, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.3010, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   1, Avg loss: 0.0667, Accuracy: 160/568 (28.1690%)
_Train Local_ResNet_18, epoch  51, local model 62, internal_epoch   2, Avg loss: 0.0381, Accuracy: 269/568 (47.3592%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.2848, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   1, Avg loss: 0.0782, Accuracy: 73/466 (15.6652%)
_Train Local_ResNet_18, epoch  51, local model 76, internal_epoch   2, Avg loss: 0.0423, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.4734, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   1, Avg loss: 0.0558, Accuracy: 335/891 (37.5982%)
_Train Local_ResNet_18, epoch  51, local model 7, internal_epoch   2, Avg loss: 0.0256, Accuracy: 441/891 (49.4949%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.8232, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   1, Avg loss: 0.0589, Accuracy: 306/1241 (24.6575%)
_Train Local_ResNet_18, epoch  51, local model 72, internal_epoch   2, Avg loss: 0.0347, Accuracy: 500/1241 (40.2901%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.9070, Accuracy: 80/10000 (0.8000%)
time spent on training: 317.2454342842102
[rfa agg] training data poison_ratio: 0.2094174655008954  data num: [1988, 1645, 1446, 134, 803, 311, 568, 466, 891, 1241]
[rfa agg] considering poison per batch poison_fraction: 0.06544295796902981
[rfa agg] init. name: [85, 13, 26, 47, 58, 96, 62, 76, 7, 72], weight: tensor([0.2094, 0.1733, 0.1523, 0.0141, 0.0846, 0.0328, 0.0598, 0.0491, 0.0939,
        0.1307])
[rfa agg] iter:  0, prev_obj_val: 47327.703125, obj_val: 35371.76171875, abs dis: 11955.94140625
[rfa agg] iter: 0, weight: tensor([0.0655, 0.2053, 0.1803, 0.0166, 0.0998, 0.0386, 0.0705, 0.0579, 0.1108,
        0.1546])
[rfa agg] iter:  1, prev_obj_val: 35371.76171875, obj_val: 31436.6875, abs dis: 3935.07421875
[rfa agg] iter: 1, weight: tensor([0.0182, 0.2169, 0.1901, 0.0173, 0.1046, 0.0402, 0.0737, 0.0604, 0.1161,
        0.1627])
[rfa agg] iter:  2, prev_obj_val: 31436.6875, obj_val: 30326.888671875, abs dis: 1109.798828125
[rfa agg] iter: 2, weight: tensor([0.0048, 0.2243, 0.1951, 0.0169, 0.1046, 0.0394, 0.0730, 0.0597, 0.1165,
        0.1657])
[rfa agg] iter:  3, prev_obj_val: 30326.888671875, obj_val: 30030.689453125, abs dis: 296.19921875
[rfa agg] iter: 3, weight: tensor([0.0012, 0.2433, 0.2047, 0.0148, 0.0995, 0.0350, 0.0670, 0.0543, 0.1118,
        0.1685])
[rfa agg] iter:  4, prev_obj_val: 30030.689453125, obj_val: 29973.62890625, abs dis: 57.060546875
[rfa agg] iter: 4, weight: tensor([2.5957e-04, 3.4181e-01, 2.3141e-01, 8.4632e-03, 7.2743e-02, 2.0909e-02,
        4.3841e-02, 3.4681e-02, 8.4369e-02, 1.6151e-01])
[rfa agg] iter:  5, prev_obj_val: 29973.62890625, obj_val: 29975.302734375, abs dis: 1.673828125
[rfa agg] iter: 5, weight: tensor([5.1623e-05, 1.6804e-01, 4.6539e-01, 2.9250e-03, 3.6902e-02, 7.5862e-03,
        1.8107e-02, 1.3793e-02, 4.5975e-02, 2.4122e-01])
[rfa agg] iter:  6, prev_obj_val: 29975.302734375, obj_val: 29977.58203125, abs dis: 2.279296875
[rfa agg] iter: 6, weight: tensor([4.3245e-05, 9.4097e-02, 1.6480e-01, 2.7381e-03, 3.9626e-02, 7.2002e-03,
        1.7913e-02, 1.3471e-02, 5.1030e-02, 6.0908e-01])
[rfa agg] iter:  7, prev_obj_val: 29977.58203125, obj_val: 29979.021484375, abs dis: 1.439453125
[rfa agg] iter: 7, weight: tensor([5.6612e-05, 1.0583e-01, 1.6070e-01, 3.8086e-03, 6.0335e-02, 1.0099e-02,
        2.5787e-02, 1.9234e-02, 7.9755e-02, 5.3439e-01])
[rfa agg] iter:  8, prev_obj_val: 29979.021484375, obj_val: 29977.580078125, abs dis: 1.44140625
[rfa agg] iter: 8, weight: tensor([6.8838e-05, 1.2035e-01, 1.7466e-01, 4.7809e-03, 7.9999e-02, 1.2736e-02,
        3.3010e-02, 2.4503e-02, 1.0759e-01, 4.4230e-01])
[rfa agg] iter:  9, prev_obj_val: 29977.580078125, obj_val: 29980.482421875, abs dis: 2.90234375
[rfa agg] iter: 9, weight: tensor([5.8004e-05, 1.0859e-01, 1.6504e-01, 3.9031e-03, 6.1951e-02, 1.0350e-02,
        2.6436e-02, 1.9715e-02, 8.2011e-02, 5.2194e-01])
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3468, Accuracy: 84/10000 (0.8400%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 4.6094, Accuracy: 488/9950 (4.9045%)
saving model
Done in 566.2259590625763 sec.
Server Epoch:52 choose agents : [9, 47, 83, 58, 50, 6, 68, 26, 40, 71].
_Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   1, Avg loss: 0.0418, Accuracy: 489/1275 (38.3529%)
_Train Local_ResNet_18, epoch  52, local model 9, internal_epoch   2, Avg loss: 0.0170, Accuracy: 791/1275 (62.0392%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.3391, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   1, Avg loss: 0.1190, Accuracy: 2/134 (1.4925%)
_Train Local_ResNet_18, epoch  52, local model 47, internal_epoch   2, Avg loss: 0.1059, Accuracy: 23/134 (17.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3799, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   1, Avg loss: 0.0536, Accuracy: 433/1953 (22.1710%)
_Train Local_ResNet_18, epoch  52, local model 83, internal_epoch   2, Avg loss: 0.0316, Accuracy: 883/1953 (45.2125%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.9422, Accuracy: 144/10000 (1.4400%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0556, Accuracy: 344/803 (42.8394%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0322, Accuracy: 393/803 (48.9415%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.2470, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   1, Avg loss: 0.0564, Accuracy: 242/809 (29.9135%)
_Train Local_ResNet_18, epoch  52, local model 50, internal_epoch   2, Avg loss: 0.0242, Accuracy: 419/809 (51.7923%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 10.5119, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   1, Avg loss: 0.0540, Accuracy: 401/1956 (20.5010%)
_Train Local_ResNet_18, epoch  52, local model 6, internal_epoch   2, Avg loss: 0.0301, Accuracy: 736/1956 (37.6278%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.3147, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   1, Avg loss: 0.0622, Accuracy: 353/1163 (30.3525%)
_Train Local_ResNet_18, epoch  52, local model 68, internal_epoch   2, Avg loss: 0.0347, Accuracy: 516/1163 (44.3680%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.3866, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   1, Avg loss: 0.0524, Accuracy: 380/1446 (26.2794%)
_Train Local_ResNet_18, epoch  52, local model 26, internal_epoch   2, Avg loss: 0.0327, Accuracy: 548/1446 (37.8976%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.5802, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   1, Avg loss: 0.0541, Accuracy: 411/1573 (26.1284%)
_Train Local_ResNet_18, epoch  52, local model 40, internal_epoch   2, Avg loss: 0.0332, Accuracy: 624/1573 (39.6694%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.6603, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   1, Avg loss: 0.0597, Accuracy: 206/818 (25.1834%)
_Train Local_ResNet_18, epoch  52, local model 71, internal_epoch   2, Avg loss: 0.0278, Accuracy: 416/818 (50.8557%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 9.4106, Accuracy: 100/10000 (1.0000%)
time spent on training: 266.32570576667786
[rfa agg] training data poison_ratio: 0.0  data num: [1275, 134, 1953, 803, 809, 1956, 1163, 1446, 1573, 818]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [9, 47, 83, 58, 50, 6, 68, 26, 40, 71], weight: tensor([0.1069, 0.0112, 0.1637, 0.0673, 0.0678, 0.1640, 0.0975, 0.1212, 0.1319,
        0.0686])
[rfa agg] iter:  0, prev_obj_val: 57.08488082885742, obj_val: 61.33778762817383, abs dis: 4.252906799316406
[rfa agg] iter: 0, weight: tensor([0.3557, 0.0022, 0.0524, 0.0302, 0.0304, 0.0526, 0.1922, 0.1563, 0.0973,
        0.0308])
[rfa agg] iter:  1, prev_obj_val: 61.33778762817383, obj_val: 68.33418273925781, abs dis: 6.996395111083984
[rfa agg] iter: 1, weight: tensor([0.2710, 0.0021, 0.0413, 0.0338, 0.0339, 0.0414, 0.3857, 0.0904, 0.0659,
        0.0345])
[rfa agg] iter:  2, prev_obj_val: 68.33418273925781, obj_val: 70.82218170166016, abs dis: 2.4879989624023438
[rfa agg] iter: 2, weight: tensor([0.1943, 0.0037, 0.0575, 0.0701, 0.0703, 0.0576, 0.2881, 0.1038, 0.0829,
        0.0717])
[rfa agg] iter:  3, prev_obj_val: 70.82218170166016, obj_val: 65.86088562011719, abs dis: 4.961296081542969
[rfa agg] iter: 3, weight: tensor([0.1796, 0.0042, 0.0609, 0.0866, 0.0866, 0.0610, 0.2423, 0.1047, 0.0856,
        0.0885])
[rfa agg] iter:  4, prev_obj_val: 65.86088562011719, obj_val: 65.85055541992188, abs dis: 0.0103302001953125
[rfa agg] iter: 4, weight: tensor([0.2072, 0.0031, 0.0526, 0.0559, 0.0561, 0.0527, 0.3368, 0.1004, 0.0783,
        0.0570])
[rfa agg] iter:  5, prev_obj_val: 65.85055541992188, obj_val: 63.45536422729492, abs dis: 2.395191192626953
[rfa agg] iter: 5, weight: tensor([0.2049, 0.0031, 0.0519, 0.0552, 0.0553, 0.0521, 0.3448, 0.0992, 0.0773,
        0.0563])
[rfa agg] iter:  6, prev_obj_val: 63.45536422729492, obj_val: 63.447967529296875, abs dis: 0.007396697998046875
[rfa agg] iter: 6, weight: tensor([0.2103, 0.0024, 0.0439, 0.0408, 0.0409, 0.0440, 0.4193, 0.0892, 0.0675,
        0.0416])
[rfa agg] iter:  7, prev_obj_val: 63.447967529296875, obj_val: 61.25709533691406, abs dis: 2.1908721923828125
[rfa agg] iter: 7, weight: tensor([0.2042, 0.0024, 0.0428, 0.0398, 0.0399, 0.0429, 0.4348, 0.0870, 0.0658,
        0.0406])
[rfa agg] iter:  8, prev_obj_val: 61.25709533691406, obj_val: 68.35154724121094, abs dis: 7.094451904296875
[rfa agg] iter: 8, weight: tensor([0.2146, 0.0018, 0.0357, 0.0293, 0.0294, 0.0358, 0.4884, 0.0781, 0.0571,
        0.0299])
[rfa agg] iter:  9, prev_obj_val: 68.35154724121094, obj_val: 68.3198471069336, abs dis: 0.03170013427734375
[rfa agg] iter: 9, weight: tensor([0.1917, 0.0037, 0.0573, 0.0698, 0.0699, 0.0574, 0.2931, 0.1033, 0.0826,
        0.0713])
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3449, Accuracy: 90/10000 (0.9000%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 4.6473, Accuracy: 449/9950 (4.5126%)
saving model
Done in 511.5104994773865 sec.
Server Epoch:53 choose agents : [50, 14, 84, 8, 25, 5, 40, 98, 72, 69].
_Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   1, Avg loss: 0.0563, Accuracy: 211/809 (26.0816%)
_Train Local_ResNet_18, epoch  53, local model 50, internal_epoch   2, Avg loss: 0.0243, Accuracy: 418/809 (51.6687%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.9161, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   1, Avg loss: 0.0569, Accuracy: 260/1013 (25.6663%)
_Train Local_ResNet_18, epoch  53, local model 14, internal_epoch   2, Avg loss: 0.0325, Accuracy: 391/1013 (38.5982%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.3208, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   1, Avg loss: 0.0569, Accuracy: 343/1190 (28.8235%)
_Train Local_ResNet_18, epoch  53, local model 84, internal_epoch   2, Avg loss: 0.0290, Accuracy: 516/1190 (43.3613%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.9262, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   1, Avg loss: 0.0571, Accuracy: 324/1513 (21.4144%)
_Train Local_ResNet_18, epoch  53, local model 8, internal_epoch   2, Avg loss: 0.0341, Accuracy: 555/1513 (36.6821%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.8747, Accuracy: 107/10000 (1.0700%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   1, Avg loss: 0.0551, Accuracy: 298/690 (43.1884%)
_Train Local_ResNet_18, epoch  53, local model 25, internal_epoch   2, Avg loss: 0.0243, Accuracy: 468/690 (67.8261%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.1355, Accuracy: 89/10000 (0.8900%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   1, Avg loss: 0.0478, Accuracy: 459/1628 (28.1941%)
_Train Local_ResNet_18, epoch  53, local model 5, internal_epoch   2, Avg loss: 0.0235, Accuracy: 914/1628 (56.1425%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 9.4169, Accuracy: 149/10000 (1.4900%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0535, Accuracy: 443/1573 (28.1627%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0336, Accuracy: 614/1573 (39.0337%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.6298, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   1, Avg loss: 0.0796, Accuracy: 34/373 (9.1153%)
_Train Local_ResNet_18, epoch  53, local model 98, internal_epoch   2, Avg loss: 0.0463, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 6.6153, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   1, Avg loss: 0.0557, Accuracy: 329/1241 (26.5109%)
_Train Local_ResNet_18, epoch  53, local model 72, internal_epoch   2, Avg loss: 0.0342, Accuracy: 500/1241 (40.2901%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.9048, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   1, Avg loss: 0.0567, Accuracy: 293/590 (49.6610%)
_Train Local_ResNet_18, epoch  53, local model 69, internal_epoch   2, Avg loss: 0.0341, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 12.5631, Accuracy: 50/10000 (0.5000%)
time spent on training: 254.6445288658142
[rfa agg] training data poison_ratio: 0.21826741996233523  data num: [809, 1013, 1190, 1513, 690, 1628, 1573, 373, 1241, 590]
[rfa agg] considering poison per batch poison_fraction: 0.06820856873822975
[rfa agg] init. name: [50, 14, 84, 8, 25, 5, 40, 98, 72, 69], weight: tensor([0.0762, 0.0954, 0.1121, 0.1425, 0.0650, 0.1533, 0.1481, 0.0351, 0.1169,
        0.0556])
[rfa agg] iter:  0, prev_obj_val: 51.71162414550781, obj_val: 57.15210723876953, abs dis: 5.440483093261719
[rfa agg] iter: 0, weight: tensor([0.0705, 0.3018, 0.1952, 0.0762, 0.0406, 0.0639, 0.0694, 0.0120, 0.1406,
        0.0298])
[rfa agg] iter:  1, prev_obj_val: 57.15210723876953, obj_val: 59.4543571472168, abs dis: 2.3022499084472656
[rfa agg] iter: 1, weight: tensor([0.1006, 0.4460, 0.1078, 0.0575, 0.0493, 0.0501, 0.0535, 0.0127, 0.0878,
        0.0346])
[rfa agg] iter:  2, prev_obj_val: 59.4543571472168, obj_val: 61.82332229614258, abs dis: 2.3689651489257812
[rfa agg] iter: 2, weight: tensor([0.1430, 0.3533, 0.1097, 0.0631, 0.0642, 0.0557, 0.0592, 0.0156, 0.0920,
        0.0442])
[rfa agg] iter:  3, prev_obj_val: 61.82332229614258, obj_val: 57.153289794921875, abs dis: 4.670032501220703
[rfa agg] iter: 3, weight: tensor([0.2011, 0.2645, 0.1069, 0.0652, 0.0798, 0.0580, 0.0614, 0.0180, 0.0915,
        0.0534])
[rfa agg] iter:  4, prev_obj_val: 57.153289794921875, obj_val: 59.45411682128906, abs dis: 2.3008270263671875
[rfa agg] iter: 4, weight: tensor([0.1020, 0.4443, 0.1076, 0.0576, 0.0494, 0.0502, 0.0536, 0.0128, 0.0878,
        0.0347])
[rfa agg] iter:  5, prev_obj_val: 59.45411682128906, obj_val: 61.82331085205078, abs dis: 2.3691940307617188
[rfa agg] iter: 5, weight: tensor([0.1430, 0.3532, 0.1098, 0.0631, 0.0642, 0.0557, 0.0592, 0.0156, 0.0920,
        0.0442])
[rfa agg] iter:  6, prev_obj_val: 61.82331085205078, obj_val: 57.153289794921875, abs dis: 4.670021057128906
[rfa agg] iter: 6, weight: tensor([0.2011, 0.2645, 0.1069, 0.0652, 0.0798, 0.0580, 0.0614, 0.0180, 0.0915,
        0.0535])
[rfa agg] iter:  7, prev_obj_val: 57.153289794921875, obj_val: 59.45411682128906, abs dis: 2.3008270263671875
[rfa agg] iter: 7, weight: tensor([0.1020, 0.4443, 0.1076, 0.0576, 0.0494, 0.0502, 0.0536, 0.0128, 0.0878,
        0.0347])
[rfa agg] iter:  8, prev_obj_val: 59.45411682128906, obj_val: 61.82331085205078, abs dis: 2.3691940307617188
[rfa agg] iter: 8, weight: tensor([0.1430, 0.3532, 0.1098, 0.0631, 0.0642, 0.0557, 0.0592, 0.0156, 0.0920,
        0.0442])
[rfa agg] iter:  9, prev_obj_val: 61.82331085205078, obj_val: 57.153289794921875, abs dis: 4.670021057128906
[rfa agg] iter: 9, weight: tensor([0.2011, 0.2645, 0.1069, 0.0652, 0.0798, 0.0580, 0.0614, 0.0180, 0.0915,
        0.0535])
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3449, Accuracy: 84/10000 (0.8400%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 4.6784, Accuracy: 367/9950 (3.6884%)
saving model
Done in 524.8930993080139 sec.
Server Epoch:54 choose agents : [72, 22, 50, 1, 38, 36, 52, 32, 73, 85].
_Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   1, Avg loss: 0.0556, Accuracy: 323/1241 (26.0274%)
_Train Local_ResNet_18, epoch  54, local model 72, internal_epoch   2, Avg loss: 0.0344, Accuracy: 477/1241 (38.4367%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.9602, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 547/1470 (37.2109%)
_Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   2, Avg loss: 0.0228, Accuracy: 921/1470 (62.6531%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.1230, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   1, Avg loss: 0.0540, Accuracy: 272/809 (33.6218%)
_Train Local_ResNet_18, epoch  54, local model 50, internal_epoch   2, Avg loss: 0.0240, Accuracy: 415/809 (51.2979%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.8098, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   1, Avg loss: 0.0512, Accuracy: 362/928 (39.0086%)
_Train Local_ResNet_18, epoch  54, local model 1, internal_epoch   2, Avg loss: 0.0211, Accuracy: 631/928 (67.9957%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.3005, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0509, Accuracy: 395/1131 (34.9248%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0264, Accuracy: 539/1131 (47.6569%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.0246, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   1, Avg loss: 0.0819, Accuracy: 72/408 (17.6471%)
_Train Local_ResNet_18, epoch  54, local model 36, internal_epoch   2, Avg loss: 0.0471, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 6.9478, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   1, Avg loss: 0.0551, Accuracy: 285/636 (44.8113%)
_Train Local_ResNet_18, epoch  54, local model 52, internal_epoch   2, Avg loss: 0.0282, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.5987, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   1, Avg loss: 0.0509, Accuracy: 252/735 (34.2857%)
_Train Local_ResNet_18, epoch  54, local model 32, internal_epoch   2, Avg loss: 0.0207, Accuracy: 394/735 (53.6054%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 11.3880, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   1, Avg loss: 0.0620, Accuracy: 200/938 (21.3220%)
_Train Local_ResNet_18, epoch  54, local model 73, internal_epoch   2, Avg loss: 0.0320, Accuracy: 359/938 (38.2729%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 9.9101, Accuracy: 60/10000 (0.6000%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   1, Avg loss: 0.0532, Accuracy: 500/1988 (25.1509%)
_Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   2, Avg loss: 0.0336, Accuracy: 742/1988 (37.3239%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.2702, Accuracy: 89/10000 (0.8900%)
time spent on training: 231.8438367843628
[rfa agg] training data poison_ratio: 0.19330999611046285  data num: [1241, 1470, 809, 928, 1131, 408, 636, 735, 938, 1988]
[rfa agg] considering poison per batch poison_fraction: 0.06040937378451964
[rfa agg] init. name: [72, 22, 50, 1, 38, 36, 52, 32, 73, 85], weight: tensor([0.1207, 0.1429, 0.0787, 0.0902, 0.1100, 0.0397, 0.0618, 0.0715, 0.0912,
        0.1933])
[rfa agg] iter:  0, prev_obj_val: 55.88623046875, obj_val: 60.131317138671875, abs dis: 4.245086669921875
[rfa agg] iter: 0, weight: tensor([0.1158, 0.0746, 0.0754, 0.1801, 0.2232, 0.0143, 0.0324, 0.0540, 0.1874,
        0.0427])
[rfa agg] iter:  1, prev_obj_val: 60.131317138671875, obj_val: 64.35061645507812, abs dis: 4.21929931640625
[rfa agg] iter: 1, weight: tensor([0.0567, 0.0435, 0.1237, 0.2674, 0.0803, 0.0138, 0.0354, 0.0728, 0.2777,
        0.0287])
[rfa agg] iter:  2, prev_obj_val: 64.35061645507812, obj_val: 66.70556640625, abs dis: 2.354949951171875
[rfa agg] iter: 2, weight: tensor([0.0538, 0.0437, 0.2777, 0.1598, 0.0702, 0.0178, 0.0506, 0.1312, 0.1648,
        0.0305])
[rfa agg] iter:  3, prev_obj_val: 66.70556640625, obj_val: 72.46136474609375, abs dis: 5.75579833984375
[rfa agg] iter: 3, weight: tensor([0.0445, 0.0369, 0.3789, 0.1092, 0.0563, 0.0171, 0.0522, 0.1655, 0.1130,
        0.0264])
[rfa agg] iter:  4, prev_obj_val: 72.46136474609375, obj_val: 75.74934387207031, abs dis: 3.2879791259765625
[rfa agg] iter: 4, weight: tensor([0.0415, 0.0358, 0.1973, 0.0802, 0.0502, 0.0219, 0.0807, 0.3834, 0.0822,
        0.0267])
[rfa agg] iter:  5, prev_obj_val: 75.74934387207031, obj_val: 82.84135437011719, abs dis: 7.092010498046875
[rfa agg] iter: 5, weight: tensor([0.0448, 0.0392, 0.1535, 0.0796, 0.0532, 0.0278, 0.1204, 0.3705, 0.0810,
        0.0298])
[rfa agg] iter:  6, prev_obj_val: 82.84135437011719, obj_val: 72.45381927490234, abs dis: 10.387535095214844
[rfa agg] iter: 6, weight: tensor([0.0496, 0.0447, 0.1193, 0.0774, 0.0571, 0.0442, 0.3118, 0.1820, 0.0785,
        0.0352])
[rfa agg] iter:  7, prev_obj_val: 72.45381927490234, obj_val: 75.74874877929688, abs dis: 3.2949295043945312
[rfa agg] iter: 7, weight: tensor([0.0397, 0.0342, 0.1707, 0.0767, 0.0480, 0.0209, 0.0796, 0.4263, 0.0782,
        0.0255])
[rfa agg] iter:  8, prev_obj_val: 75.74874877929688, obj_val: 79.26031494140625, abs dis: 3.511566162109375
[rfa agg] iter: 8, weight: tensor([0.0444, 0.0389, 0.1513, 0.0789, 0.0527, 0.0276, 0.1195, 0.3769, 0.0803,
        0.0296])
[rfa agg] iter:  9, prev_obj_val: 79.26031494140625, obj_val: 69.4476318359375, abs dis: 9.81268310546875
[rfa agg] iter: 9, weight: tensor([0.0509, 0.0452, 0.1423, 0.0842, 0.0594, 0.0376, 0.2023, 0.2575, 0.0856,
        0.0350])
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3467, Accuracy: 87/10000 (0.8700%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 4.4562, Accuracy: 1597/9950 (16.0503%)
saving model
Done in 497.8100526332855 sec.
Server Epoch:55 choose agents : [33, 58, 47, 9, 19, 26, 45, 81, 95, 56].
_Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   1, Avg loss: 0.0805, Accuracy: 66/515 (12.8155%)
_Train Local_ResNet_18, epoch  55, local model 33, internal_epoch   2, Avg loss: 0.0491, Accuracy: 163/515 (31.6505%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.6422, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   1, Avg loss: 0.0559, Accuracy: 340/803 (42.3412%)
_Train Local_ResNet_18, epoch  55, local model 58, internal_epoch   2, Avg loss: 0.0327, Accuracy: 360/803 (44.8319%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.3427, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   1, Avg loss: 0.1206, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 47, internal_epoch   2, Avg loss: 0.1065, Accuracy: 18/134 (13.4328%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3791, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   1, Avg loss: 0.0409, Accuracy: 482/1275 (37.8039%)
_Train Local_ResNet_18, epoch  55, local model 9, internal_epoch   2, Avg loss: 0.0168, Accuracy: 808/1275 (63.3725%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 10.3304, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   1, Avg loss: 0.0460, Accuracy: 445/1036 (42.9537%)
_Train Local_ResNet_18, epoch  55, local model 19, internal_epoch   2, Avg loss: 0.0229, Accuracy: 706/1036 (68.1467%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 11.8517, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   1, Avg loss: 0.0521, Accuracy: 371/1446 (25.6570%)
_Train Local_ResNet_18, epoch  55, local model 26, internal_epoch   2, Avg loss: 0.0322, Accuracy: 573/1446 (39.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7275, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   1, Avg loss: 0.0618, Accuracy: 228/669 (34.0807%)
_Train Local_ResNet_18, epoch  55, local model 45, internal_epoch   2, Avg loss: 0.0381, Accuracy: 366/669 (54.7085%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.7570, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   1, Avg loss: 0.0658, Accuracy: 233/774 (30.1034%)
_Train Local_ResNet_18, epoch  55, local model 81, internal_epoch   2, Avg loss: 0.0313, Accuracy: 357/774 (46.1240%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.8161, Accuracy: 82/10000 (0.8200%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   1, Avg loss: 0.0568, Accuracy: 303/599 (50.5843%)
_Train Local_ResNet_18, epoch  55, local model 95, internal_epoch   2, Avg loss: 0.0285, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 11.1068, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   1, Avg loss: 0.0804, Accuracy: 11/186 (5.9140%)
_Train Local_ResNet_18, epoch  55, local model 56, internal_epoch   2, Avg loss: 0.0640, Accuracy: 85/186 (45.6989%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.4523, Accuracy: 50/10000 (0.5000%)
time spent on training: 208.11551356315613
[rfa agg] training data poison_ratio: 0.08054322979696114  data num: [515, 803, 134, 1275, 1036, 1446, 669, 774, 599, 186]
[rfa agg] considering poison per batch poison_fraction: 0.02516975931155036
[rfa agg] init. name: [33, 58, 47, 9, 19, 26, 45, 81, 95, 56], weight: tensor([0.0692, 0.1080, 0.0180, 0.1714, 0.1393, 0.1944, 0.0900, 0.1041, 0.0805,
        0.0250])
[rfa agg] iter:  0, prev_obj_val: 46.057376861572266, obj_val: 49.72072982788086, abs dis: 3.6633529663085938
[rfa agg] iter: 0, weight: tensor([0.0431, 0.3180, 0.0042, 0.0502, 0.0673, 0.0407, 0.1231, 0.2782, 0.0693,
        0.0058])
[rfa agg] iter:  1, prev_obj_val: 49.72072982788086, obj_val: 51.819698333740234, abs dis: 2.098968505859375
[rfa agg] iter: 1, weight: tensor([0.0678, 0.1751, 0.0053, 0.0506, 0.0631, 0.0425, 0.2966, 0.1655, 0.1261,
        0.0074])
[rfa agg] iter:  2, prev_obj_val: 51.819698333740234, obj_val: 57.30135726928711, abs dis: 5.481658935546875
[rfa agg] iter: 2, weight: tensor([0.0706, 0.1113, 0.0048, 0.0402, 0.0488, 0.0343, 0.4266, 0.1057, 0.1512,
        0.0066])
[rfa agg] iter:  3, prev_obj_val: 57.30135726928711, obj_val: 57.21588897705078, abs dis: 0.08546829223632812
[rfa agg] iter: 3, weight: tensor([0.1406, 0.0833, 0.0060, 0.0402, 0.0464, 0.0351, 0.1988, 0.0796, 0.3615,
        0.0084])
[rfa agg] iter:  4, prev_obj_val: 57.21588897705078, obj_val: 60.50729751586914, abs dis: 3.2914085388183594
[rfa agg] iter: 4, weight: tensor([0.1266, 0.0723, 0.0052, 0.0349, 0.0403, 0.0304, 0.1628, 0.0689, 0.4513,
        0.0073])
[rfa agg] iter:  5, prev_obj_val: 60.50729751586914, obj_val: 64.0506820678711, abs dis: 3.543384552001953
[rfa agg] iter: 5, weight: tensor([0.2405, 0.0751, 0.0068, 0.0401, 0.0455, 0.0354, 0.1386, 0.0717, 0.3369,
        0.0095])
[rfa agg] iter:  6, prev_obj_val: 64.0506820678711, obj_val: 67.91291809082031, abs dis: 3.8622360229492188
[rfa agg] iter: 6, weight: tensor([0.4141, 0.0696, 0.0078, 0.0404, 0.0451, 0.0361, 0.1127, 0.0666, 0.1968,
        0.0108])
[rfa agg] iter:  7, prev_obj_val: 67.91291809082031, obj_val: 64.02775573730469, abs dis: 3.885162353515625
[rfa agg] iter: 7, weight: tensor([0.3823, 0.0793, 0.0109, 0.0495, 0.0543, 0.0445, 0.1166, 0.0760, 0.1714,
        0.0151])
[rfa agg] iter:  8, prev_obj_val: 64.02775573730469, obj_val: 64.0203628540039, abs dis: 0.00739288330078125
[rfa agg] iter: 8, weight: tensor([0.4649, 0.0643, 0.0072, 0.0373, 0.0416, 0.0333, 0.1038, 0.0616, 0.1760,
        0.0100])
[rfa agg] iter:  9, prev_obj_val: 64.0203628540039, obj_val: 60.525936126708984, abs dis: 3.494426727294922
[rfa agg] iter: 9, weight: tensor([0.5025, 0.0598, 0.0067, 0.0348, 0.0387, 0.0310, 0.0963, 0.0572, 0.1637,
        0.0093])
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3472, Accuracy: 92/10000 (0.9200%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 4.4997, Accuracy: 1396/9950 (14.0302%)
saving model
Done in 475.7539939880371 sec.
Server Epoch:56 choose agents : [98, 9, 8, 25, 64, 74, 90, 19, 66, 92].
_Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   1, Avg loss: 0.0787, Accuracy: 36/373 (9.6515%)
_Train Local_ResNet_18, epoch  56, local model 98, internal_epoch   2, Avg loss: 0.0459, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.8982, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   1, Avg loss: 0.0407, Accuracy: 485/1275 (38.0392%)
_Train Local_ResNet_18, epoch  56, local model 9, internal_epoch   2, Avg loss: 0.0168, Accuracy: 789/1275 (61.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.4751, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   1, Avg loss: 0.0564, Accuracy: 343/1513 (22.6702%)
_Train Local_ResNet_18, epoch  56, local model 8, internal_epoch   2, Avg loss: 0.0341, Accuracy: 546/1513 (36.0872%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.9894, Accuracy: 113/10000 (1.1300%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   1, Avg loss: 0.0540, Accuracy: 295/690 (42.7536%)
_Train Local_ResNet_18, epoch  56, local model 25, internal_epoch   2, Avg loss: 0.0240, Accuracy: 459/690 (66.5217%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.7723, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   1, Avg loss: 0.0595, Accuracy: 209/953 (21.9307%)
_Train Local_ResNet_18, epoch  56, local model 64, internal_epoch   2, Avg loss: 0.0357, Accuracy: 345/953 (36.2015%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.7062, Accuracy: 73/10000 (0.7300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 552/1552 (35.5670%)
_Train Local_ResNet_18, epoch  56, local model 74, internal_epoch   2, Avg loss: 0.0198, Accuracy: 798/1552 (51.4175%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 11.3341, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   1, Avg loss: 0.0550, Accuracy: 308/677 (45.4948%)
_Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   2, Avg loss: 0.0216, Accuracy: 462/677 (68.2422%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 10.6496, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   1, Avg loss: 0.0452, Accuracy: 417/1036 (40.2510%)
_Train Local_ResNet_18, epoch  56, local model 19, internal_epoch   2, Avg loss: 0.0219, Accuracy: 724/1036 (69.8842%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 12.1677, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   1, Avg loss: 0.0587, Accuracy: 266/1402 (18.9729%)
_Train Local_ResNet_18, epoch  56, local model 66, internal_epoch   2, Avg loss: 0.0367, Accuracy: 437/1402 (31.1698%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.8583, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 482/1715 (28.1050%)
_Train Local_ResNet_18, epoch  56, local model 92, internal_epoch   2, Avg loss: 0.0286, Accuracy: 836/1715 (48.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.2634, Accuracy: 107/10000 (1.0700%)
time spent on training: 286.7214024066925
[rfa agg] training data poison_ratio: 0.20042910781333811  data num: [373, 1275, 1513, 690, 953, 1552, 677, 1036, 1402, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.06263409619166815
[rfa agg] init. name: [98, 9, 8, 25, 64, 74, 90, 19, 66, 92], weight: tensor([0.0333, 0.1140, 0.1353, 0.0617, 0.0852, 0.1387, 0.0605, 0.0926, 0.1253,
        0.1533])
[rfa agg] iter:  0, prev_obj_val: 49.90757751464844, obj_val: 53.125572204589844, abs dis: 3.2179946899414062
[rfa agg] iter: 0, weight: tensor([0.0105, 0.1967, 0.0842, 0.0330, 0.1045, 0.0739, 0.0324, 0.2853, 0.1156,
        0.0638])
[rfa agg] iter:  1, prev_obj_val: 53.125572204589844, obj_val: 57.43440246582031, abs dis: 4.308830261230469
[rfa agg] iter: 1, weight: tensor([0.0090, 0.1084, 0.0568, 0.0302, 0.1198, 0.0508, 0.0297, 0.4771, 0.0732,
        0.0451])
[rfa agg] iter:  2, prev_obj_val: 57.43440246582031, obj_val: 65.08181762695312, abs dis: 7.6474151611328125
[rfa agg] iter: 2, weight: tensor([0.0120, 0.0997, 0.0604, 0.0439, 0.2538, 0.0550, 0.0432, 0.3078, 0.0743,
        0.0499])
[rfa agg] iter:  3, prev_obj_val: 65.08181762695312, obj_val: 65.0408706665039, abs dis: 0.04094696044921875
[rfa agg] iter: 3, weight: tensor([0.0147, 0.0767, 0.0532, 0.0649, 0.4328, 0.0493, 0.0642, 0.1358, 0.0623,
        0.0459])
[rfa agg] iter:  4, prev_obj_val: 65.0408706665039, obj_val: 62.179298400878906, abs dis: 2.861572265625
[rfa agg] iter: 4, weight: tensor([0.0138, 0.0718, 0.0498, 0.0609, 0.4707, 0.0462, 0.0600, 0.1254, 0.0584,
        0.0430])
[rfa agg] iter:  5, prev_obj_val: 62.179298400878906, obj_val: 74.21202087402344, abs dis: 12.032722473144531
[rfa agg] iter: 5, weight: tensor([0.0095, 0.0573, 0.0382, 0.0389, 0.5933, 0.0352, 0.0382, 0.1114, 0.0454,
        0.0325])
[rfa agg] iter:  6, prev_obj_val: 74.21202087402344, obj_val: 62.25349044799805, abs dis: 11.95853042602539
[rfa agg] iter: 6, weight: tensor([0.0247, 0.0839, 0.0637, 0.1517, 0.2192, 0.0599, 0.1499, 0.1183, 0.0721,
        0.0568])
[rfa agg] iter:  7, prev_obj_val: 62.25349044799805, obj_val: 59.72168731689453, abs dis: 2.5318031311035156
[rfa agg] iter: 7, weight: tensor([0.0116, 0.0702, 0.0468, 0.0477, 0.5012, 0.0431, 0.0469, 0.1371, 0.0556,
        0.0398])
[rfa agg] iter:  8, prev_obj_val: 59.72168731689453, obj_val: 62.18743896484375, abs dis: 2.4657516479492188
[rfa agg] iter: 8, weight: tensor([0.0112, 0.0791, 0.0505, 0.0433, 0.4458, 0.0463, 0.0425, 0.1779, 0.0610,
        0.0424])
[rfa agg] iter:  9, prev_obj_val: 62.18743896484375, obj_val: 71.13229370117188, abs dis: 8.944854736328125
[rfa agg] iter: 9, weight: tensor([0.0098, 0.0596, 0.0397, 0.0404, 0.5762, 0.0367, 0.0398, 0.1167, 0.0472,
        0.0338])
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3497, Accuracy: 79/10000 (0.7900%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 4.3056, Accuracy: 3293/9950 (33.0955%)
saving model
Done in 545.6921494007111 sec.
Server Epoch:57 choose agents : [16, 72, 14, 32, 55, 48, 98, 56, 85, 95].
_Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   1, Avg loss: 0.0551, Accuracy: 298/708 (42.0904%)
_Train Local_ResNet_18, epoch  57, local model 16, internal_epoch   2, Avg loss: 0.0337, Accuracy: 436/708 (61.5819%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.3430, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   1, Avg loss: 0.0555, Accuracy: 352/1241 (28.3642%)
_Train Local_ResNet_18, epoch  57, local model 72, internal_epoch   2, Avg loss: 0.0340, Accuracy: 484/1241 (39.0008%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.9304, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   1, Avg loss: 0.0550, Accuracy: 281/1013 (27.7394%)
_Train Local_ResNet_18, epoch  57, local model 14, internal_epoch   2, Avg loss: 0.0313, Accuracy: 445/1013 (43.9289%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0000, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0482, Accuracy: 269/735 (36.5986%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0200, Accuracy: 388/735 (52.7891%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.0459, Accuracy: 81/10000 (0.8100%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   1, Avg loss: 0.0533, Accuracy: 312/1071 (29.1317%)
_Train Local_ResNet_18, epoch  57, local model 55, internal_epoch   2, Avg loss: 0.0271, Accuracy: 560/1071 (52.2876%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.1697, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   1, Avg loss: 0.0659, Accuracy: 180/631 (28.5261%)
_Train Local_ResNet_18, epoch  57, local model 48, internal_epoch   2, Avg loss: 0.0391, Accuracy: 278/631 (44.0571%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.5100, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   1, Avg loss: 0.0791, Accuracy: 26/373 (6.9705%)
_Train Local_ResNet_18, epoch  57, local model 98, internal_epoch   2, Avg loss: 0.0450, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.7948, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.0776, Accuracy: 19/186 (10.2151%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0619, Accuracy: 94/186 (50.5376%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.4868, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   1, Avg loss: 0.0541, Accuracy: 482/1988 (24.2455%)
_Train Local_ResNet_18, epoch  57, local model 85, internal_epoch   2, Avg loss: 0.0341, Accuracy: 723/1988 (36.3682%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0125, Accuracy: 88/10000 (0.8800%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   1, Avg loss: 0.0544, Accuracy: 312/599 (52.0868%)
_Train Local_ResNet_18, epoch  57, local model 95, internal_epoch   2, Avg loss: 0.0278, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 11.4663, Accuracy: 50/10000 (0.5000%)
time spent on training: 266.14118695259094
[rfa agg] training data poison_ratio: 0.4280866003510825  data num: [708, 1241, 1013, 735, 1071, 631, 373, 186, 1988, 599]
[rfa agg] considering poison per batch poison_fraction: 0.13377706260971328
[rfa agg] init. name: [16, 72, 14, 32, 55, 48, 98, 56, 85, 95], weight: tensor([0.0829, 0.1452, 0.1185, 0.0860, 0.1253, 0.0738, 0.0437, 0.0218, 0.2327,
        0.0701])
[rfa agg] iter:  0, prev_obj_val: 61.74610137939453, obj_val: 65.78394317626953, abs dis: 4.037841796875
[rfa agg] iter: 0, weight: tensor([0.0690, 0.0941, 0.4103, 0.0716, 0.2181, 0.0394, 0.0135, 0.0051, 0.0415,
        0.0373])
[rfa agg] iter:  1, prev_obj_val: 65.78394317626953, obj_val: 69.56907653808594, abs dis: 3.7851333618164062
[rfa agg] iter: 1, weight: tensor([0.1900, 0.0825, 0.1738, 0.1966, 0.1308, 0.0774, 0.0216, 0.0077, 0.0467,
        0.0729])
[rfa agg] iter:  2, prev_obj_val: 69.56907653808594, obj_val: 74.28987121582031, abs dis: 4.720794677734375
[rfa agg] iter: 2, weight: tensor([0.3409, 0.0346, 0.0561, 0.3476, 0.0475, 0.0683, 0.0139, 0.0046, 0.0222,
        0.0642])
[rfa agg] iter:  3, prev_obj_val: 74.28987121582031, obj_val: 76.92308807373047, abs dis: 2.6332168579101562
[rfa agg] iter: 3, weight: tensor([0.2136, 0.0442, 0.0645, 0.2214, 0.0569, 0.1732, 0.0239, 0.0075, 0.0304,
        0.1644])
[rfa agg] iter:  4, prev_obj_val: 76.92308807373047, obj_val: 83.32362365722656, abs dis: 6.400535583496094
[rfa agg] iter: 4, weight: tensor([0.1374, 0.0395, 0.0554, 0.1423, 0.0496, 0.2676, 0.0250, 0.0075, 0.0280,
        0.2477])
[rfa agg] iter:  5, prev_obj_val: 83.32362365722656, obj_val: 83.31920623779297, abs dis: 0.00441741943359375
[rfa agg] iter: 5, weight: tensor([0.0926, 0.0393, 0.0517, 0.0960, 0.0473, 0.3131, 0.0353, 0.0095, 0.0294,
        0.2857])
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3505, Accuracy: 82/10000 (0.8200%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 4.2717, Accuracy: 3362/9950 (33.7889%)
saving model
Done in 527.6740093231201 sec.
Server Epoch:58 choose agents : [84, 53, 38, 31, 8, 47, 67, 4, 87, 88].
_Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   1, Avg loss: 0.0572, Accuracy: 330/1190 (27.7311%)
_Train Local_ResNet_18, epoch  58, local model 84, internal_epoch   2, Avg loss: 0.0289, Accuracy: 517/1190 (43.4454%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.0556, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   1, Avg loss: 0.0456, Accuracy: 315/813 (38.7454%)
_Train Local_ResNet_18, epoch  58, local model 53, internal_epoch   2, Avg loss: 0.0180, Accuracy: 489/813 (60.1476%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 12.6912, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   1, Avg loss: 0.0504, Accuracy: 406/1131 (35.8974%)
_Train Local_ResNet_18, epoch  58, local model 38, internal_epoch   2, Avg loss: 0.0269, Accuracy: 566/1131 (50.0442%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.1296, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0829, Accuracy: 45/460 (9.7826%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0356, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.8203, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   1, Avg loss: 0.0555, Accuracy: 319/1513 (21.0839%)
_Train Local_ResNet_18, epoch  58, local model 8, internal_epoch   2, Avg loss: 0.0341, Accuracy: 563/1513 (37.2108%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.2948, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   1, Avg loss: 0.1199, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  58, local model 47, internal_epoch   2, Avg loss: 0.1057, Accuracy: 19/134 (14.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3914, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   1, Avg loss: 0.0741, Accuracy: 70/426 (16.4319%)
_Train Local_ResNet_18, epoch  58, local model 67, internal_epoch   2, Avg loss: 0.0385, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.5386, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   1, Avg loss: 0.0590, Accuracy: 339/901 (37.6249%)
_Train Local_ResNet_18, epoch  58, local model 4, internal_epoch   2, Avg loss: 0.0320, Accuracy: 393/901 (43.6182%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.9697, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   1, Avg loss: 0.0560, Accuracy: 302/1131 (26.7020%)
_Train Local_ResNet_18, epoch  58, local model 87, internal_epoch   2, Avg loss: 0.0304, Accuracy: 419/1131 (37.0469%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.5929, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   1, Avg loss: 0.0743, Accuracy: 130/603 (21.5589%)
_Train Local_ResNet_18, epoch  58, local model 88, internal_epoch   2, Avg loss: 0.0434, Accuracy: 277/603 (45.9370%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 8.4665, Accuracy: 50/10000 (0.5000%)
time spent on training: 240.73743963241577
[rfa agg] training data poison_ratio: 0.0  data num: [1190, 813, 1131, 460, 1513, 134, 426, 901, 1131, 603]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 53, 38, 31, 8, 47, 67, 4, 87, 88], weight: tensor([0.1433, 0.0979, 0.1362, 0.0554, 0.1822, 0.0161, 0.0513, 0.1085, 0.1362,
        0.0726])
[rfa agg] iter:  0, prev_obj_val: 47.29978561401367, obj_val: 51.679595947265625, abs dis: 4.379810333251953
[rfa agg] iter: 0, weight: tensor([0.0783, 0.3695, 0.0908, 0.0305, 0.0526, 0.0047, 0.0239, 0.1964, 0.0910,
        0.0622])
[rfa agg] iter:  1, prev_obj_val: 51.679595947265625, obj_val: 57.005714416503906, abs dis: 5.326118469238281
[rfa agg] iter: 1, weight: tensor([0.0668, 0.4490, 0.0750, 0.0375, 0.0482, 0.0052, 0.0284, 0.1280, 0.0750,
        0.0869])
[rfa agg] iter:  2, prev_obj_val: 57.005714416503906, obj_val: 56.99256134033203, abs dis: 0.013153076171875
[rfa agg] iter: 2, weight: tensor([0.0779, 0.2604, 0.0854, 0.0645, 0.0596, 0.0078, 0.0466, 0.1244, 0.0854,
        0.1881])
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3488, Accuracy: 82/10000 (0.8200%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 4.3094, Accuracy: 2991/9950 (30.0603%)
saving model
Done in 510.80989599227905 sec.
Server Epoch:59 choose agents : [82, 74, 11, 41, 40, 36, 95, 87, 23, 32].
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   1, Avg loss: 0.0762, Accuracy: 82/500 (16.4000%)
_Train Local_ResNet_18, epoch  59, local model 82, internal_epoch   2, Avg loss: 0.0474, Accuracy: 228/500 (45.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.4568, Accuracy: 69/10000 (0.6900%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   1, Avg loss: 0.0426, Accuracy: 561/1552 (36.1469%)
_Train Local_ResNet_18, epoch  59, local model 74, internal_epoch   2, Avg loss: 0.0197, Accuracy: 825/1552 (53.1572%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 12.3036, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   1, Avg loss: 0.0560, Accuracy: 295/712 (41.4326%)
_Train Local_ResNet_18, epoch  59, local model 11, internal_epoch   2, Avg loss: 0.0239, Accuracy: 410/712 (57.5843%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.5353, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   1, Avg loss: 0.0598, Accuracy: 302/719 (42.0028%)
_Train Local_ResNet_18, epoch  59, local model 41, internal_epoch   2, Avg loss: 0.0318, Accuracy: 460/719 (63.9777%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.1561, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0537, Accuracy: 397/1573 (25.2384%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0334, Accuracy: 605/1573 (38.4615%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.7427, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   1, Avg loss: 0.0822, Accuracy: 47/408 (11.5196%)
_Train Local_ResNet_18, epoch  59, local model 36, internal_epoch   2, Avg loss: 0.0485, Accuracy: 158/408 (38.7255%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.9931, Accuracy: 60/10000 (0.6000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   1, Avg loss: 0.0500, Accuracy: 333/599 (55.5927%)
_Train Local_ResNet_18, epoch  59, local model 95, internal_epoch   2, Avg loss: 0.0310, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 11.6150, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   1, Avg loss: 0.0553, Accuracy: 304/1131 (26.8789%)
_Train Local_ResNet_18, epoch  59, local model 87, internal_epoch   2, Avg loss: 0.0296, Accuracy: 432/1131 (38.1963%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3709, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0616, Accuracy: 300/715 (41.9580%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0351, Accuracy: 437/715 (61.1189%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.2921, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   1, Avg loss: 0.0478, Accuracy: 282/735 (38.3673%)
_Train Local_ResNet_18, epoch  59, local model 32, internal_epoch   2, Avg loss: 0.0193, Accuracy: 409/735 (55.6463%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 11.1464, Accuracy: 66/10000 (0.6600%)
time spent on training: 263.1066081523895
[rfa agg] training data poison_ratio: 0.2488431281813975  data num: [500, 1552, 712, 719, 1573, 408, 599, 1131, 715, 735]
[rfa agg] considering poison per batch poison_fraction: 0.07776347755668672
[rfa agg] init. name: [82, 74, 11, 41, 40, 36, 95, 87, 23, 32], weight: tensor([0.0578, 0.1795, 0.0824, 0.0832, 0.1820, 0.0472, 0.0693, 0.1308, 0.0827,
        0.0850])
[rfa agg] iter:  0, prev_obj_val: 55.34297561645508, obj_val: 58.504024505615234, abs dis: 3.1610488891601562
[rfa agg] iter: 0, weight: tensor([0.0350, 0.0521, 0.1700, 0.1707, 0.0528, 0.0242, 0.0654, 0.0960, 0.1632,
        0.1705])
[rfa agg] iter:  1, prev_obj_val: 58.504024505615234, obj_val: 66.89904022216797, abs dis: 8.395015716552734
[rfa agg] iter: 1, weight: tensor([0.0306, 0.0247, 0.1991, 0.2050, 0.0251, 0.0195, 0.0816, 0.0373, 0.1793,
        0.1979])
[rfa agg] iter:  2, prev_obj_val: 66.89904022216797, obj_val: 70.15652465820312, abs dis: 3.2574844360351562
[rfa agg] iter: 2, weight: tensor([0.0741, 0.0314, 0.1037, 0.1052, 0.0318, 0.0409, 0.3606, 0.0428, 0.1027,
        0.1069])
[rfa agg] iter:  3, prev_obj_val: 70.15652465820312, obj_val: 73.6261215209961, abs dis: 3.4695968627929688
[rfa agg] iter: 3, weight: tensor([0.1099, 0.0342, 0.0944, 0.0955, 0.0346, 0.0552, 0.3401, 0.0453, 0.0936,
        0.0972])
[rfa agg] iter:  4, prev_obj_val: 73.6261215209961, obj_val: 73.62136840820312, abs dis: 0.00475311279296875
[rfa agg] iter: 4, weight: tensor([0.1871, 0.0389, 0.0932, 0.0943, 0.0394, 0.0806, 0.2276, 0.0503, 0.0927,
        0.0960])
[rfa agg] iter:  5, prev_obj_val: 73.62136840820312, obj_val: 70.16092681884766, abs dis: 3.4604415893554688
[rfa agg] iter: 5, weight: tensor([0.1898, 0.0389, 0.0933, 0.0944, 0.0394, 0.0808, 0.2241, 0.0503, 0.0929,
        0.0962])
[rfa agg] iter:  6, prev_obj_val: 70.16092681884766, obj_val: 73.62533569335938, abs dis: 3.4644088745117188
[rfa agg] iter: 6, weight: tensor([0.1129, 0.0347, 0.0960, 0.0971, 0.0352, 0.0562, 0.3275, 0.0461, 0.0953,
        0.0989])
[rfa agg] iter:  7, prev_obj_val: 73.62533569335938, obj_val: 73.62137603759766, abs dis: 0.00395965576171875
[rfa agg] iter: 7, weight: tensor([0.1872, 0.0389, 0.0932, 0.0943, 0.0394, 0.0806, 0.2272, 0.0503, 0.0928,
        0.0961])
[rfa agg] iter:  8, prev_obj_val: 73.62137603759766, obj_val: 70.16092681884766, abs dis: 3.46044921875
[rfa agg] iter: 8, weight: tensor([0.1898, 0.0389, 0.0933, 0.0944, 0.0394, 0.0808, 0.2240, 0.0503, 0.0929,
        0.0962])
[rfa agg] iter:  9, prev_obj_val: 70.16092681884766, obj_val: 73.62533569335938, abs dis: 3.4644088745117188
[rfa agg] iter: 9, weight: tensor([0.1129, 0.0347, 0.0960, 0.0971, 0.0352, 0.0562, 0.3275, 0.0461, 0.0953,
        0.0989])
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3478, Accuracy: 92/10000 (0.9200%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 4.2688, Accuracy: 3728/9950 (37.4673%)
saving model
Done in 525.1050369739532 sec.
Server Epoch:60 choose agents : [28, 39, 27, 81, 97, 7, 47, 24, 49, 88].
_Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   1, Avg loss: 0.0552, Accuracy: 393/1581 (24.8577%)
_Train Local_ResNet_18, epoch  60, local model 28, internal_epoch   2, Avg loss: 0.0319, Accuracy: 630/1581 (39.8482%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.8781, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   1, Avg loss: 0.0500, Accuracy: 322/1013 (31.7868%)
_Train Local_ResNet_18, epoch  60, local model 39, internal_epoch   2, Avg loss: 0.0241, Accuracy: 540/1013 (53.3070%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.2519, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   1, Avg loss: 0.0568, Accuracy: 391/1587 (24.6377%)
_Train Local_ResNet_18, epoch  60, local model 27, internal_epoch   2, Avg loss: 0.0331, Accuracy: 578/1587 (36.4209%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.8365, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   1, Avg loss: 0.0656, Accuracy: 228/774 (29.4574%)
_Train Local_ResNet_18, epoch  60, local model 81, internal_epoch   2, Avg loss: 0.0335, Accuracy: 334/774 (43.1525%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.9451, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   1, Avg loss: 0.0497, Accuracy: 372/1213 (30.6678%)
_Train Local_ResNet_18, epoch  60, local model 97, internal_epoch   2, Avg loss: 0.0261, Accuracy: 565/1213 (46.5787%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.2024, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   1, Avg loss: 0.0547, Accuracy: 330/891 (37.0370%)
_Train Local_ResNet_18, epoch  60, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 447/891 (50.1684%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.7649, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   1, Avg loss: 0.1175, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  60, local model 47, internal_epoch   2, Avg loss: 0.1063, Accuracy: 23/134 (17.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.4005, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   1, Avg loss: 0.0722, Accuracy: 61/312 (19.5513%)
_Train Local_ResNet_18, epoch  60, local model 24, internal_epoch   2, Avg loss: 0.0357, Accuracy: 206/312 (66.0256%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.0831, Accuracy: 71/10000 (0.7100%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   1, Avg loss: 0.0748, Accuracy: 53/440 (12.0455%)
_Train Local_ResNet_18, epoch  60, local model 49, internal_epoch   2, Avg loss: 0.0437, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.7257, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   1, Avg loss: 0.0729, Accuracy: 143/603 (23.7148%)
_Train Local_ResNet_18, epoch  60, local model 88, internal_epoch   2, Avg loss: 0.0452, Accuracy: 285/603 (47.2637%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 8.0498, Accuracy: 54/10000 (0.5400%)
time spent on training: 218.17151141166687
[rfa agg] training data poison_ratio: 0.05147402901263454  data num: [1581, 1013, 1587, 774, 1213, 891, 134, 312, 440, 603]
[rfa agg] considering poison per batch poison_fraction: 0.016085634066448293
[rfa agg] init. name: [28, 39, 27, 81, 97, 7, 47, 24, 49, 88], weight: tensor([0.1850, 0.1185, 0.1857, 0.0905, 0.1419, 0.1042, 0.0157, 0.0365, 0.0515,
        0.0705])
[rfa agg] iter:  0, prev_obj_val: 53.28395462036133, obj_val: 58.93929672241211, abs dis: 5.655342102050781
[rfa agg] iter: 0, weight: tensor([0.0582, 0.3983, 0.0584, 0.1048, 0.1193, 0.1904, 0.0038, 0.0104, 0.0181,
        0.0383])
[rfa agg] iter:  1, prev_obj_val: 58.93929672241211, obj_val: 58.79154586791992, abs dis: 0.1477508544921875
[rfa agg] iter: 1, weight: tensor([0.0433, 0.1254, 0.0435, 0.2817, 0.0691, 0.3461, 0.0040, 0.0116, 0.0213,
        0.0539])
[rfa agg] iter:  2, prev_obj_val: 58.79154586791992, obj_val: 66.46491241455078, abs dis: 7.673366546630859
[rfa agg] iter: 2, weight: tensor([0.0392, 0.1106, 0.0393, 0.3004, 0.0625, 0.3659, 0.0036, 0.0105, 0.0193,
        0.0488])
[rfa agg] iter:  3, prev_obj_val: 66.46491241455078, obj_val: 66.447265625, abs dis: 0.01764678955078125
[rfa agg] iter: 3, weight: tensor([0.0546, 0.1119, 0.0548, 0.3078, 0.0776, 0.1953, 0.0067, 0.0200, 0.0394,
        0.1317])
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3453, Accuracy: 84/10000 (0.8400%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 4.2999, Accuracy: 3438/9950 (34.5528%)
saving model
Saving model on epoch 60
Done in 480.6173415184021 sec.
Server Epoch:61 choose agents : [63, 97, 61, 60, 55, 87, 50, 72, 14, 64].
_Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   1, Avg loss: 0.0517, Accuracy: 273/888 (30.7432%)
_Train Local_ResNet_18, epoch  61, local model 63, internal_epoch   2, Avg loss: 0.0234, Accuracy: 515/888 (57.9955%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.8693, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   1, Avg loss: 0.0491, Accuracy: 385/1213 (31.7395%)
_Train Local_ResNet_18, epoch  61, local model 97, internal_epoch   2, Avg loss: 0.0258, Accuracy: 566/1213 (46.6612%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.9410, Accuracy: 97/10000 (0.9700%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   1, Avg loss: 0.1255, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  61, local model 61, internal_epoch   2, Avg loss: 0.1175, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3507, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   1, Avg loss: 0.0484, Accuracy: 726/2227 (32.5999%)
_Train Local_ResNet_18, epoch  61, local model 60, internal_epoch   2, Avg loss: 0.0263, Accuracy: 1109/2227 (49.7979%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.2182, Accuracy: 137/10000 (1.3700%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0535, Accuracy: 313/1071 (29.2250%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0272, Accuracy: 561/1071 (52.3810%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.4194, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   1, Avg loss: 0.0554, Accuracy: 305/1131 (26.9673%)
_Train Local_ResNet_18, epoch  61, local model 87, internal_epoch   2, Avg loss: 0.0306, Accuracy: 416/1131 (36.7816%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.6117, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   1, Avg loss: 0.0538, Accuracy: 242/809 (29.9135%)
_Train Local_ResNet_18, epoch  61, local model 50, internal_epoch   2, Avg loss: 0.0239, Accuracy: 405/809 (50.0618%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 10.2436, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   1, Avg loss: 0.0550, Accuracy: 328/1241 (26.4303%)
_Train Local_ResNet_18, epoch  61, local model 72, internal_epoch   2, Avg loss: 0.0341, Accuracy: 498/1241 (40.1289%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.0245, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   1, Avg loss: 0.0559, Accuracy: 268/1013 (26.4561%)
_Train Local_ResNet_18, epoch  61, local model 14, internal_epoch   2, Avg loss: 0.0312, Accuracy: 454/1013 (44.8174%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.5914, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   1, Avg loss: 0.0566, Accuracy: 252/953 (26.4428%)
_Train Local_ResNet_18, epoch  61, local model 64, internal_epoch   2, Avg loss: 0.0354, Accuracy: 337/953 (35.3620%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.6524, Accuracy: 83/10000 (0.8300%)
time spent on training: 262.6693503856659
[rfa agg] training data poison_ratio: 0.1087385946759477  data num: [888, 1213, 85, 2227, 1071, 1131, 809, 1241, 1013, 953]
[rfa agg] considering poison per batch poison_fraction: 0.03398081083623365
[rfa agg] init. name: [63, 97, 61, 60, 55, 87, 50, 72, 14, 64], weight: tensor([0.0835, 0.1141, 0.0080, 0.2095, 0.1007, 0.1064, 0.0761, 0.1167, 0.0953,
        0.0896])
[rfa agg] iter:  0, prev_obj_val: 49.04091262817383, obj_val: 54.254112243652344, abs dis: 5.213199615478516
[rfa agg] iter: 0, weight: tensor([0.0414, 0.1854, 0.0010, 0.0247, 0.1648, 0.2922, 0.0303, 0.1104, 0.0913,
        0.0586])
[rfa agg] iter:  1, prev_obj_val: 54.254112243652344, obj_val: 62.348838806152344, abs dis: 8.0947265625
[rfa agg] iter: 1, weight: tensor([0.1057, 0.0674, 0.0012, 0.0225, 0.1282, 0.0873, 0.0615, 0.0539, 0.2473,
        0.2250])
[rfa agg] iter:  2, prev_obj_val: 62.348838806152344, obj_val: 69.59801483154297, abs dis: 7.249176025390625
[rfa agg] iter: 2, weight: tensor([0.3062, 0.0525, 0.0015, 0.0232, 0.0762, 0.0609, 0.1467, 0.0449, 0.1073,
        0.1806])
[rfa agg] iter:  3, prev_obj_val: 69.59801483154297, obj_val: 73.67826843261719, abs dis: 4.080253601074219
[rfa agg] iter: 3, weight: tensor([0.2062, 0.0519, 0.0020, 0.0262, 0.0682, 0.0579, 0.3386, 0.0456, 0.0858,
        0.1177])
[rfa agg] iter:  4, prev_obj_val: 73.67826843261719, obj_val: 62.34382247924805, abs dis: 11.33444595336914
[rfa agg] iter: 4, weight: tensor([0.1689, 0.0565, 0.0025, 0.0302, 0.0716, 0.0622, 0.3584, 0.0503, 0.0871,
        0.1122])
[rfa agg] iter:  5, prev_obj_val: 62.34382247924805, obj_val: 65.77691650390625, abs dis: 3.433094024658203
[rfa agg] iter: 5, weight: tensor([0.3180, 0.0512, 0.0015, 0.0226, 0.0739, 0.0595, 0.1573, 0.0439, 0.1039,
        0.1681])
[rfa agg] iter:  6, prev_obj_val: 65.77691650390625, obj_val: 65.76948547363281, abs dis: 0.0074310302734375
[rfa agg] iter: 6, weight: tensor([0.2939, 0.0502, 0.0017, 0.0238, 0.0689, 0.0571, 0.2356, 0.0436, 0.0907,
        0.1345])
[rfa agg] iter:  7, prev_obj_val: 65.76948547363281, obj_val: 69.56936645507812, abs dis: 3.7998809814453125
[rfa agg] iter: 7, weight: tensor([0.2865, 0.0498, 0.0017, 0.0236, 0.0683, 0.0566, 0.2476, 0.0433, 0.0900,
        0.1325])
[rfa agg] iter:  8, prev_obj_val: 69.56936645507812, obj_val: 73.67778778076172, abs dis: 4.108421325683594
[rfa agg] iter: 8, weight: tensor([0.1964, 0.0497, 0.0019, 0.0251, 0.0652, 0.0555, 0.3684, 0.0437, 0.0821,
        0.1120])
[rfa agg] iter:  9, prev_obj_val: 73.67778778076172, obj_val: 65.7857437133789, abs dis: 7.8920440673828125
[rfa agg] iter: 9, weight: tensor([0.1673, 0.0561, 0.0025, 0.0300, 0.0711, 0.0618, 0.3636, 0.0499, 0.0865,
        0.1113])
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3498, Accuracy: 88/10000 (0.8800%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 4.2859, Accuracy: 3035/9950 (30.5025%)
saving model
Done in 522.8828091621399 sec.
Server Epoch:62 choose agents : [82, 13, 98, 85, 60, 29, 45, 7, 66, 63].
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0756, Accuracy: 78/500 (15.6000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0466, Accuracy: 221/500 (44.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.0906, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   1, Avg loss: 0.0525, Accuracy: 463/1645 (28.1459%)
_Train Local_ResNet_18, epoch  62, local model 13, internal_epoch   2, Avg loss: 0.0303, Accuracy: 757/1645 (46.0182%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.2840, Accuracy: 141/10000 (1.4100%)
_Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   1, Avg loss: 0.0791, Accuracy: 28/373 (7.5067%)
_Train Local_ResNet_18, epoch  62, local model 98, internal_epoch   2, Avg loss: 0.0458, Accuracy: 157/373 (42.0912%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.8609, Accuracy: 50/10000 (0.5000%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   1, Avg loss: 0.0530, Accuracy: 460/1988 (23.1388%)
_Train Local_ResNet_18, epoch  62, local model 85, internal_epoch   2, Avg loss: 0.0342, Accuracy: 758/1988 (38.1288%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.0526, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0486, Accuracy: 677/2227 (30.3996%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0264, Accuracy: 1074/2227 (48.2263%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.2034, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 421/1440 (29.2361%)
_Train Local_ResNet_18, epoch  62, local model 29, internal_epoch   2, Avg loss: 0.0259, Accuracy: 755/1440 (52.4306%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 9.6032, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   1, Avg loss: 0.0621, Accuracy: 218/669 (32.5859%)
_Train Local_ResNet_18, epoch  62, local model 45, internal_epoch   2, Avg loss: 0.0373, Accuracy: 367/669 (54.8580%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.5333, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   1, Avg loss: 0.0541, Accuracy: 337/891 (37.8227%)
_Train Local_ResNet_18, epoch  62, local model 7, internal_epoch   2, Avg loss: 0.0248, Accuracy: 463/891 (51.9641%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.8361, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   1, Avg loss: 0.0578, Accuracy: 269/1402 (19.1869%)
_Train Local_ResNet_18, epoch  62, local model 66, internal_epoch   2, Avg loss: 0.0367, Accuracy: 432/1402 (30.8131%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.8290, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   1, Avg loss: 0.0501, Accuracy: 281/888 (31.6441%)
_Train Local_ResNet_18, epoch  62, local model 63, internal_epoch   2, Avg loss: 0.0243, Accuracy: 467/888 (52.5901%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 10.3292, Accuracy: 91/10000 (0.9100%)
time spent on training: 324.0587079524994
[rfa agg] training data poison_ratio: 0.16534974631955418  data num: [500, 1645, 373, 1988, 2227, 1440, 669, 891, 1402, 888]
[rfa agg] considering poison per batch poison_fraction: 0.05167179572486068
[rfa agg] init. name: [82, 13, 98, 85, 60, 29, 45, 7, 66, 63], weight: tensor([0.0416, 0.1368, 0.0310, 0.1653, 0.1852, 0.1198, 0.0556, 0.0741, 0.1166,
        0.0739])
[rfa agg] iter:  0, prev_obj_val: 69.41459655761719, obj_val: 74.57268524169922, abs dis: 5.158088684082031
[rfa agg] iter: 0, weight: tensor([0.0085, 0.0954, 0.0055, 0.0471, 0.0407, 0.2525, 0.0144, 0.0264, 0.4832,
        0.0263])
[rfa agg] iter:  1, prev_obj_val: 74.57268524169922, obj_val: 74.56327819824219, abs dis: 0.00940704345703125
[rfa agg] iter: 1, weight: tensor([0.0162, 0.1192, 0.0104, 0.0698, 0.0621, 0.2214, 0.0285, 0.0551, 0.3623,
        0.0550])
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3494, Accuracy: 79/10000 (0.7900%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 4.3159, Accuracy: 2725/9950 (27.3869%)
saving model
Done in 583.6297814846039 sec.
Server Epoch:63 choose agents : [14, 81, 97, 91, 28, 94, 4, 35, 25, 39].
_Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   1, Avg loss: 0.0549, Accuracy: 291/1013 (28.7266%)
_Train Local_ResNet_18, epoch  63, local model 14, internal_epoch   2, Avg loss: 0.0313, Accuracy: 445/1013 (43.9289%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.5195, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   1, Avg loss: 0.0632, Accuracy: 244/774 (31.5245%)
_Train Local_ResNet_18, epoch  63, local model 81, internal_epoch   2, Avg loss: 0.0348, Accuracy: 333/774 (43.0233%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.3250, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   1, Avg loss: 0.0492, Accuracy: 370/1213 (30.5029%)
_Train Local_ResNet_18, epoch  63, local model 97, internal_epoch   2, Avg loss: 0.0259, Accuracy: 554/1213 (45.6719%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.8444, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   1, Avg loss: 0.0530, Accuracy: 368/1030 (35.7282%)
_Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   2, Avg loss: 0.0225, Accuracy: 684/1030 (66.4078%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.8610, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   1, Avg loss: 0.0554, Accuracy: 412/1581 (26.0595%)
_Train Local_ResNet_18, epoch  63, local model 28, internal_epoch   2, Avg loss: 0.0313, Accuracy: 691/1581 (43.7065%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.7109, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   1, Avg loss: 0.0543, Accuracy: 394/1662 (23.7064%)
_Train Local_ResNet_18, epoch  63, local model 94, internal_epoch   2, Avg loss: 0.0315, Accuracy: 662/1662 (39.8315%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.2735, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   1, Avg loss: 0.0549, Accuracy: 346/901 (38.4018%)
_Train Local_ResNet_18, epoch  63, local model 4, internal_epoch   2, Avg loss: 0.0303, Accuracy: 418/901 (46.3929%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.9810, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   1, Avg loss: 0.0884, Accuracy: 10/271 (3.6900%)
_Train Local_ResNet_18, epoch  63, local model 35, internal_epoch   2, Avg loss: 0.0524, Accuracy: 144/271 (53.1365%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.3027, Accuracy: 63/10000 (0.6300%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   1, Avg loss: 0.0551, Accuracy: 295/690 (42.7536%)
_Train Local_ResNet_18, epoch  63, local model 25, internal_epoch   2, Avg loss: 0.0237, Accuracy: 463/690 (67.1014%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.5240, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   1, Avg loss: 0.0501, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch  63, local model 39, internal_epoch   2, Avg loss: 0.0239, Accuracy: 553/1013 (54.5903%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 9.0586, Accuracy: 85/10000 (0.8500%)
time spent on training: 282.487428188324
[rfa agg] training data poison_ratio: 0.06799369333858889  data num: [1013, 774, 1213, 1030, 1581, 1662, 901, 271, 690, 1013]
[rfa agg] considering poison per batch poison_fraction: 0.021248029168309028
[rfa agg] init. name: [14, 81, 97, 91, 28, 94, 4, 35, 25, 39], weight: tensor([0.0998, 0.0763, 0.1195, 0.1015, 0.1558, 0.1638, 0.0888, 0.0267, 0.0680,
        0.0998])
[rfa agg] iter:  0, prev_obj_val: 41.872467041015625, obj_val: 50.85918045043945, abs dis: 8.986713409423828
[rfa agg] iter: 0, weight: tensor([0.2760, 0.0457, 0.0709, 0.1344, 0.0316, 0.0300, 0.1280, 0.0045, 0.0248,
        0.2541])
[rfa agg] iter:  1, prev_obj_val: 50.85918045043945, obj_val: 50.80563735961914, abs dis: 0.0535430908203125
[rfa agg] iter: 1, weight: tensor([0.1433, 0.1876, 0.0703, 0.0961, 0.0420, 0.0405, 0.2034, 0.0088, 0.0661,
        0.1419])
[rfa agg] iter:  2, prev_obj_val: 50.80563735961914, obj_val: 48.039974212646484, abs dis: 2.7656631469726562
[rfa agg] iter: 2, weight: tensor([0.1392, 0.1948, 0.0691, 0.0943, 0.0413, 0.0398, 0.2105, 0.0087, 0.0651,
        0.1373])
[rfa agg] iter:  3, prev_obj_val: 48.039974212646484, obj_val: 53.72689437866211, abs dis: 5.686920166015625
[rfa agg] iter: 3, weight: tensor([0.1589, 0.1237, 0.0679, 0.0983, 0.0383, 0.0368, 0.2638, 0.0073, 0.0497,
        0.1553])
[rfa agg] iter:  4, prev_obj_val: 53.72689437866211, obj_val: 56.75666809082031, abs dis: 3.029773712158203
[rfa agg] iter: 4, weight: tensor([0.1162, 0.2894, 0.0646, 0.0839, 0.0405, 0.0393, 0.1621, 0.0094, 0.0793,
        0.1152])
[rfa agg] iter:  5, prev_obj_val: 56.75666809082031, obj_val: 60.133941650390625, abs dis: 3.3772735595703125
[rfa agg] iter: 5, weight: tensor([0.0877, 0.4275, 0.0533, 0.0665, 0.0349, 0.0339, 0.1119, 0.0090, 0.0883,
        0.0870])
[rfa agg] iter:  6, prev_obj_val: 60.133941650390625, obj_val: 63.68788528442383, abs dis: 3.553943634033203
[rfa agg] iter: 6, weight: tensor([0.0870, 0.3769, 0.0567, 0.0685, 0.0386, 0.0376, 0.1049, 0.0110, 0.1322,
        0.0865])
[rfa agg] iter:  7, prev_obj_val: 63.68788528442383, obj_val: 60.13896179199219, abs dis: 3.5489234924316406
[rfa agg] iter: 7, weight: tensor([0.0902, 0.2588, 0.0622, 0.0730, 0.0438, 0.0428, 0.1047, 0.0140, 0.2208,
        0.0898])
[rfa agg] iter:  8, prev_obj_val: 60.13896179199219, obj_val: 56.740997314453125, abs dis: 3.3979644775390625
[rfa agg] iter: 8, weight: tensor([0.0900, 0.3536, 0.0586, 0.0708, 0.0399, 0.0389, 0.1084, 0.0114, 0.1389,
        0.0895])
[rfa agg] iter:  9, prev_obj_val: 56.740997314453125, obj_val: 63.70163345336914, abs dis: 6.960636138916016
[rfa agg] iter: 9, weight: tensor([0.0828, 0.4592, 0.0504, 0.0629, 0.0330, 0.0321, 0.1049, 0.0085, 0.0839,
        0.0822])
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3471, Accuracy: 86/10000 (0.8600%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 4.3467, Accuracy: 2521/9950 (25.3367%)
saving model
Done in 552.4864847660065 sec.
Server Epoch:64 choose agents : [81, 71, 22, 76, 45, 30, 66, 5, 69, 70].
_Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   1, Avg loss: 0.0601, Accuracy: 259/774 (33.4625%)
_Train Local_ResNet_18, epoch  64, local model 81, internal_epoch   2, Avg loss: 0.0334, Accuracy: 312/774 (40.3101%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.3994, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0588, Accuracy: 249/818 (30.4401%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0268, Accuracy: 430/818 (52.5672%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.8804, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   1, Avg loss: 0.0453, Accuracy: 576/1470 (39.1837%)
_Train Local_ResNet_18, epoch  64, local model 22, internal_epoch   2, Avg loss: 0.0226, Accuracy: 929/1470 (63.1973%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 9.5578, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0788, Accuracy: 57/466 (12.2318%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0420, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.0824, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   1, Avg loss: 0.0627, Accuracy: 227/669 (33.9312%)
_Train Local_ResNet_18, epoch  64, local model 45, internal_epoch   2, Avg loss: 0.0365, Accuracy: 364/669 (54.4096%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.6277, Accuracy: 88/10000 (0.8800%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   1, Avg loss: 0.0757, Accuracy: 85/486 (17.4897%)
_Train Local_ResNet_18, epoch  64, local model 30, internal_epoch   2, Avg loss: 0.0372, Accuracy: 222/486 (45.6790%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.3254, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   1, Avg loss: 0.0564, Accuracy: 297/1402 (21.1840%)
_Train Local_ResNet_18, epoch  64, local model 66, internal_epoch   2, Avg loss: 0.0360, Accuracy: 459/1402 (32.7389%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 7.9148, Accuracy: 75/10000 (0.7500%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   1, Avg loss: 0.0481, Accuracy: 467/1628 (28.6855%)
_Train Local_ResNet_18, epoch  64, local model 5, internal_epoch   2, Avg loss: 0.0233, Accuracy: 879/1628 (53.9926%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 10.0559, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   1, Avg loss: 0.0580, Accuracy: 267/590 (45.2542%)
_Train Local_ResNet_18, epoch  64, local model 69, internal_epoch   2, Avg loss: 0.0312, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 11.5160, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   1, Avg loss: 0.0508, Accuracy: 495/1418 (34.9083%)
_Train Local_ResNet_18, epoch  64, local model 70, internal_epoch   2, Avg loss: 0.0281, Accuracy: 727/1418 (51.2694%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.2195, Accuracy: 107/10000 (1.0700%)
time spent on training: 270.4122750759125
[rfa agg] training data poison_ratio: 0.21746733875115729  data num: [774, 818, 1470, 466, 669, 486, 1402, 1628, 590, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.06795854335973665
[rfa agg] init. name: [81, 71, 22, 76, 45, 30, 66, 5, 69, 70], weight: tensor([0.0796, 0.0841, 0.1512, 0.0479, 0.0688, 0.0500, 0.1442, 0.1675, 0.0607,
        0.1459])
[rfa agg] iter:  0, prev_obj_val: 59.44512939453125, obj_val: 61.40135192871094, abs dis: 1.9562225341796875
[rfa agg] iter: 0, weight: tensor([0.1505, 0.1599, 0.1248, 0.0347, 0.0793, 0.0362, 0.1387, 0.0971, 0.0586,
        0.1203])
[rfa agg] iter:  1, prev_obj_val: 61.40135192871094, obj_val: 63.422847747802734, abs dis: 2.021495819091797
[rfa agg] iter: 1, weight: tensor([0.1959, 0.2092, 0.0967, 0.0351, 0.0874, 0.0367, 0.1054, 0.0781, 0.0621,
        0.0933])
[rfa agg] iter:  2, prev_obj_val: 63.422847747802734, obj_val: 72.75031280517578, abs dis: 9.327465057373047
[rfa agg] iter: 2, weight: tensor([0.2631, 0.2872, 0.0635, 0.0302, 0.0853, 0.0315, 0.0681, 0.0528, 0.0571,
        0.0612])
[rfa agg] iter:  3, prev_obj_val: 72.75031280517578, obj_val: 81.36473846435547, abs dis: 8.614425659179688
[rfa agg] iter: 3, weight: tensor([0.1625, 0.1743, 0.0424, 0.0438, 0.2845, 0.0458, 0.0443, 0.0373, 0.1243,
        0.0409])
[rfa agg] iter:  4, prev_obj_val: 81.36473846435547, obj_val: 78.21261596679688, abs dis: 3.1521224975585938
[rfa agg] iter: 4, weight: tensor([0.0772, 0.0821, 0.0344, 0.0685, 0.1850, 0.0722, 0.0355, 0.0309, 0.3812,
        0.0331])
[rfa agg] iter:  5, prev_obj_val: 78.21261596679688, obj_val: 88.34291076660156, abs dis: 10.130294799804688
[rfa agg] iter: 5, weight: tensor([0.0901, 0.0956, 0.0351, 0.0544, 0.2726, 0.0572, 0.0363, 0.0313, 0.2935,
        0.0338])
[rfa agg] iter:  6, prev_obj_val: 88.34291076660156, obj_val: 91.94523620605469, abs dis: 3.602325439453125
[rfa agg] iter: 6, weight: tensor([0.0757, 0.0802, 0.0414, 0.1609, 0.1287, 0.1755, 0.0425, 0.0378, 0.2174,
        0.0400])
[rfa agg] iter:  7, prev_obj_val: 91.94523620605469, obj_val: 91.93563079833984, abs dis: 0.00960540771484375
[rfa agg] iter: 7, weight: tensor([0.0600, 0.0636, 0.0356, 0.2391, 0.0919, 0.2731, 0.0365, 0.0327, 0.1332,
        0.0343])
[rfa agg] iter:  8, prev_obj_val: 91.93563079833984, obj_val: 95.7204360961914, abs dis: 3.7848052978515625
[rfa agg] iter: 8, weight: tensor([0.0585, 0.0620, 0.0348, 0.2468, 0.0896, 0.2785, 0.0356, 0.0319, 0.1286,
        0.0335])
[rfa agg] iter:  9, prev_obj_val: 95.7204360961914, obj_val: 88.35013580322266, abs dis: 7.37030029296875
[rfa agg] iter: 9, weight: tensor([0.0402, 0.0426, 0.0256, 0.2983, 0.0573, 0.3866, 0.0262, 0.0236, 0.0750,
        0.0247])
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3441, Accuracy: 92/10000 (0.9200%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 4.3749, Accuracy: 2416/9950 (24.2814%)
saving model
Done in 538.5680317878723 sec.
Server Epoch:65 choose agents : [78, 89, 90, 16, 68, 76, 57, 27, 83, 41].
_Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   1, Avg loss: 0.0839, Accuracy: 41/416 (9.8558%)
_Train Local_ResNet_18, epoch  65, local model 78, internal_epoch   2, Avg loss: 0.0430, Accuracy: 236/416 (56.7308%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.2626, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   1, Avg loss: 0.0558, Accuracy: 348/896 (38.8393%)
_Train Local_ResNet_18, epoch  65, local model 89, internal_epoch   2, Avg loss: 0.0319, Accuracy: 454/896 (50.6696%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.4979, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   1, Avg loss: 0.0554, Accuracy: 300/677 (44.3131%)
_Train Local_ResNet_18, epoch  65, local model 90, internal_epoch   2, Avg loss: 0.0219, Accuracy: 432/677 (63.8109%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.3633, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   1, Avg loss: 0.0598, Accuracy: 290/708 (40.9605%)
_Train Local_ResNet_18, epoch  65, local model 16, internal_epoch   2, Avg loss: 0.0326, Accuracy: 436/708 (61.5819%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.0079, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   1, Avg loss: 0.0604, Accuracy: 350/1163 (30.0946%)
_Train Local_ResNet_18, epoch  65, local model 68, internal_epoch   2, Avg loss: 0.0350, Accuracy: 487/1163 (41.8745%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.7768, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   1, Avg loss: 0.0756, Accuracy: 75/466 (16.0944%)
_Train Local_ResNet_18, epoch  65, local model 76, internal_epoch   2, Avg loss: 0.0417, Accuracy: 182/466 (39.0558%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.5717, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   1, Avg loss: 0.0524, Accuracy: 317/1154 (27.4697%)
_Train Local_ResNet_18, epoch  65, local model 57, internal_epoch   2, Avg loss: 0.0242, Accuracy: 534/1154 (46.2738%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 10.7678, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   1, Avg loss: 0.0564, Accuracy: 409/1587 (25.7719%)
_Train Local_ResNet_18, epoch  65, local model 27, internal_epoch   2, Avg loss: 0.0322, Accuracy: 638/1587 (40.2016%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.6077, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   1, Avg loss: 0.0533, Accuracy: 460/1953 (23.5535%)
_Train Local_ResNet_18, epoch  65, local model 83, internal_epoch   2, Avg loss: 0.0316, Accuracy: 880/1953 (45.0589%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.2556, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   1, Avg loss: 0.0594, Accuracy: 303/719 (42.1419%)
_Train Local_ResNet_18, epoch  65, local model 41, internal_epoch   2, Avg loss: 0.0307, Accuracy: 475/719 (66.0640%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 8.4584, Accuracy: 66/10000 (0.6600%)
time spent on training: 261.14082312583923
[rfa agg] training data poison_ratio: 0.0  data num: [416, 896, 677, 708, 1163, 466, 1154, 1587, 1953, 719]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [78, 89, 90, 16, 68, 76, 57, 27, 83, 41], weight: tensor([0.0427, 0.0920, 0.0695, 0.0727, 0.1194, 0.0478, 0.1185, 0.1630, 0.2005,
        0.0738])
[rfa agg] iter:  0, prev_obj_val: 62.99760437011719, obj_val: 65.73088073730469, abs dis: 2.7332763671875
[rfa agg] iter: 0, weight: tensor([0.0211, 0.1650, 0.0592, 0.0753, 0.2141, 0.0264, 0.2080, 0.0897, 0.0650,
        0.0761])
[rfa agg] iter:  1, prev_obj_val: 65.73088073730469, obj_val: 69.36917114257812, abs dis: 3.6382904052734375
[rfa agg] iter: 1, weight: tensor([0.0225, 0.3085, 0.0727, 0.0999, 0.1239, 0.0287, 0.1221, 0.0684, 0.0528,
        0.1006])
[rfa agg] iter:  2, prev_obj_val: 69.36917114257812, obj_val: 72.94062042236328, abs dis: 3.5714492797851562
[rfa agg] iter: 2, weight: tensor([0.0206, 0.3711, 0.0859, 0.1399, 0.0677, 0.0272, 0.0668, 0.0445, 0.0361,
        0.1403])
[rfa agg] iter:  3, prev_obj_val: 72.94062042236328, obj_val: 87.68988800048828, abs dis: 14.749267578125
[rfa agg] iter: 3, weight: tensor([0.0218, 0.1629, 0.1235, 0.2449, 0.0513, 0.0297, 0.0506, 0.0366, 0.0305,
        0.2484])
[rfa agg] iter:  4, prev_obj_val: 87.68988800048828, obj_val: 80.66464233398438, abs dis: 7.025245666503906
[rfa agg] iter: 4, weight: tensor([0.0584, 0.0944, 0.2640, 0.1458, 0.0550, 0.0955, 0.0545, 0.0452, 0.0398,
        0.1475])
[rfa agg] iter:  5, prev_obj_val: 80.66464233398438, obj_val: 87.68212890625, abs dis: 7.017486572265625
[rfa agg] iter: 5, weight: tensor([0.0250, 0.0702, 0.4542, 0.1474, 0.0350, 0.0370, 0.0346, 0.0274, 0.0236,
        0.1457])
[rfa agg] iter:  6, prev_obj_val: 87.68212890625, obj_val: 77.651123046875, abs dis: 10.031005859375
[rfa agg] iter: 6, weight: tensor([0.0576, 0.0929, 0.2757, 0.1433, 0.0543, 0.0946, 0.0538, 0.0446, 0.0392,
        0.1441])
[rfa agg] iter:  7, prev_obj_val: 77.651123046875, obj_val: 80.66451263427734, abs dis: 3.0133895874023438
[rfa agg] iter: 7, weight: tensor([0.0231, 0.0863, 0.2773, 0.2295, 0.0387, 0.0331, 0.0383, 0.0294, 0.0251,
        0.2192])
[rfa agg] iter:  8, prev_obj_val: 80.66451263427734, obj_val: 87.68157196044922, abs dis: 7.017059326171875
[rfa agg] iter: 8, weight: tensor([0.0251, 0.0705, 0.4457, 0.1509, 0.0352, 0.0371, 0.0348, 0.0275, 0.0238,
        0.1493])
[rfa agg] iter:  9, prev_obj_val: 87.68157196044922, obj_val: 77.65110778808594, abs dis: 10.030464172363281
[rfa agg] iter: 9, weight: tensor([0.0576, 0.0929, 0.2754, 0.1433, 0.0543, 0.0946, 0.0538, 0.0446, 0.0392,
        0.1442])
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3409, Accuracy: 92/10000 (0.9200%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 4.4072, Accuracy: 2111/9950 (21.2161%)
saving model
Done in 522.25958776474 sec.
Server Epoch:66 choose agents : [38, 88, 33, 43, 14, 18, 98, 35, 78, 86].
_Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   1, Avg loss: 0.0510, Accuracy: 377/1131 (33.3333%)
_Train Local_ResNet_18, epoch  66, local model 38, internal_epoch   2, Avg loss: 0.0264, Accuracy: 551/1131 (48.7179%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.1014, Accuracy: 122/10000 (1.2200%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   1, Avg loss: 0.0706, Accuracy: 145/603 (24.0464%)
_Train Local_ResNet_18, epoch  66, local model 88, internal_epoch   2, Avg loss: 0.0442, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.7727, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   1, Avg loss: 0.0796, Accuracy: 81/515 (15.7282%)
_Train Local_ResNet_18, epoch  66, local model 33, internal_epoch   2, Avg loss: 0.0530, Accuracy: 174/515 (33.7864%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.1649, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 295/946 (31.1839%)
_Train Local_ResNet_18, epoch  66, local model 43, internal_epoch   2, Avg loss: 0.0343, Accuracy: 344/946 (36.3636%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.3535, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   1, Avg loss: 0.0552, Accuracy: 280/1013 (27.6407%)
_Train Local_ResNet_18, epoch  66, local model 14, internal_epoch   2, Avg loss: 0.0315, Accuracy: 419/1013 (41.3623%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.7095, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0722, Accuracy: 127/530 (23.9623%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0359, Accuracy: 283/530 (53.3962%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 8.7991, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   1, Avg loss: 0.0776, Accuracy: 45/373 (12.0643%)
_Train Local_ResNet_18, epoch  66, local model 98, internal_epoch   2, Avg loss: 0.0455, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.8352, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   1, Avg loss: 0.0864, Accuracy: 15/271 (5.5351%)
_Train Local_ResNet_18, epoch  66, local model 35, internal_epoch   2, Avg loss: 0.0551, Accuracy: 122/271 (45.0185%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.2770, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   1, Avg loss: 0.0834, Accuracy: 43/416 (10.3365%)
_Train Local_ResNet_18, epoch  66, local model 78, internal_epoch   2, Avg loss: 0.0428, Accuracy: 230/416 (55.2885%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.2897, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   1, Avg loss: 0.0595, Accuracy: 329/1003 (32.8016%)
_Train Local_ResNet_18, epoch  66, local model 86, internal_epoch   2, Avg loss: 0.0331, Accuracy: 370/1003 (36.8893%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.8054, Accuracy: 51/10000 (0.5100%)
time spent on training: 195.48358821868896
[rfa agg] training data poison_ratio: 0.0  data num: [1131, 603, 515, 946, 1013, 530, 373, 271, 416, 1003]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 88, 33, 43, 14, 18, 98, 35, 78, 86], weight: tensor([0.1663, 0.0887, 0.0757, 0.1391, 0.1489, 0.0779, 0.0548, 0.0398, 0.0612,
        0.1475])
[rfa agg] iter:  0, prev_obj_val: 41.494956970214844, obj_val: 50.714805603027344, abs dis: 9.2198486328125
[rfa agg] iter: 0, weight: tensor([0.0444, 0.4044, 0.1472, 0.0593, 0.0529, 0.1499, 0.0292, 0.0170, 0.0433,
        0.0523])
[rfa agg] iter:  1, prev_obj_val: 50.714805603027344, obj_val: 56.94403839111328, abs dis: 6.2292327880859375
[rfa agg] iter: 1, weight: tensor([0.0467, 0.1238, 0.1941, 0.0558, 0.0523, 0.2031, 0.0761, 0.0372, 0.1590,
        0.0517])
[rfa agg] iter:  2, prev_obj_val: 56.94403839111328, obj_val: 60.425804138183594, abs dis: 3.4817657470703125
[rfa agg] iter: 2, weight: tensor([0.0366, 0.0711, 0.0899, 0.0421, 0.0401, 0.0926, 0.1263, 0.0478, 0.4140,
        0.0396])
[rfa agg] iter:  3, prev_obj_val: 60.425804138183594, obj_val: 60.41993713378906, abs dis: 0.00586700439453125
[rfa agg] iter: 3, weight: tensor([0.0383, 0.0668, 0.0790, 0.0434, 0.0416, 0.0814, 0.2459, 0.0691, 0.2934,
        0.0411])
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3390, Accuracy: 90/10000 (0.9000%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 4.4321, Accuracy: 1976/9950 (19.8593%)
saving model
Done in 472.9757595062256 sec.
Server Epoch:67 choose agents : [94, 13, 95, 73, 30, 22, 25, 10, 86, 8].
_Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   1, Avg loss: 0.0540, Accuracy: 373/1662 (22.4428%)
_Train Local_ResNet_18, epoch  67, local model 94, internal_epoch   2, Avg loss: 0.0312, Accuracy: 653/1662 (39.2900%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.4226, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   1, Avg loss: 0.0518, Accuracy: 457/1645 (27.7812%)
_Train Local_ResNet_18, epoch  67, local model 13, internal_epoch   2, Avg loss: 0.0305, Accuracy: 686/1645 (41.7021%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.2668, Accuracy: 143/10000 (1.4300%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   1, Avg loss: 0.0482, Accuracy: 352/599 (58.7646%)
_Train Local_ResNet_18, epoch  67, local model 95, internal_epoch   2, Avg loss: 0.0302, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 11.7778, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   1, Avg loss: 0.0593, Accuracy: 227/938 (24.2004%)
_Train Local_ResNet_18, epoch  67, local model 73, internal_epoch   2, Avg loss: 0.0317, Accuracy: 348/938 (37.1002%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.7708, Accuracy: 59/10000 (0.5900%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   1, Avg loss: 0.0707, Accuracy: 108/486 (22.2222%)
_Train Local_ResNet_18, epoch  67, local model 30, internal_epoch   2, Avg loss: 0.0367, Accuracy: 225/486 (46.2963%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.5300, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   1, Avg loss: 0.0448, Accuracy: 600/1470 (40.8163%)
_Train Local_ResNet_18, epoch  67, local model 22, internal_epoch   2, Avg loss: 0.0226, Accuracy: 931/1470 (63.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.5528, Accuracy: 104/10000 (1.0400%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   1, Avg loss: 0.0535, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch  67, local model 25, internal_epoch   2, Avg loss: 0.0243, Accuracy: 470/690 (68.1159%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 9.2627, Accuracy: 86/10000 (0.8600%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   1, Avg loss: 0.0544, Accuracy: 253/861 (29.3844%)
_Train Local_ResNet_18, epoch  67, local model 10, internal_epoch   2, Avg loss: 0.0186, Accuracy: 517/861 (60.0465%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 10.0788, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   1, Avg loss: 0.0604, Accuracy: 335/1003 (33.3998%)
_Train Local_ResNet_18, epoch  67, local model 86, internal_epoch   2, Avg loss: 0.0326, Accuracy: 384/1003 (38.2851%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.8643, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   1, Avg loss: 0.0555, Accuracy: 374/1513 (24.7191%)
_Train Local_ResNet_18, epoch  67, local model 8, internal_epoch   2, Avg loss: 0.0338, Accuracy: 567/1513 (37.4752%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.7955, Accuracy: 117/10000 (1.1700%)
time spent on training: 324.73451232910156
[rfa agg] training data poison_ratio: 0.24256924634213675  data num: [1662, 1645, 599, 938, 486, 1470, 690, 861, 1003, 1513]
[rfa agg] considering poison per batch poison_fraction: 0.07580288948191774
[rfa agg] init. name: [94, 13, 95, 73, 30, 22, 25, 10, 86, 8], weight: tensor([0.1529, 0.1514, 0.0551, 0.0863, 0.0447, 0.1353, 0.0635, 0.0792, 0.0923,
        0.1392])
[rfa agg] iter:  0, prev_obj_val: 56.09571075439453, obj_val: 59.23173904418945, abs dis: 3.136028289794922
[rfa agg] iter: 0, weight: tensor([0.0712, 0.0704, 0.0330, 0.1716, 0.0209, 0.0940, 0.0443, 0.1082, 0.3030,
        0.0833])
[rfa agg] iter:  1, prev_obj_val: 59.23173904418945, obj_val: 63.06856918334961, abs dis: 3.8368301391601562
[rfa agg] iter: 1, weight: tensor([0.0391, 0.0387, 0.0269, 0.2996, 0.0160, 0.0483, 0.0376, 0.1274, 0.3224,
        0.0440])
[rfa agg] iter:  2, prev_obj_val: 63.06856918334961, obj_val: 68.19209289550781, abs dis: 5.123523712158203
[rfa agg] iter: 2, weight: tensor([0.0370, 0.0366, 0.0339, 0.3386, 0.0192, 0.0442, 0.0496, 0.2391, 0.1610,
        0.0408])
[rfa agg] iter:  3, prev_obj_val: 68.19209289550781, obj_val: 68.16236877441406, abs dis: 0.02972412109375
[rfa agg] iter: 3, weight: tensor([0.0427, 0.0423, 0.0545, 0.1914, 0.0284, 0.0496, 0.0859, 0.3344, 0.1245,
        0.0463])
[rfa agg] iter:  4, prev_obj_val: 68.16236877441406, obj_val: 65.42731475830078, abs dis: 2.7350540161132812
[rfa agg] iter: 4, weight: tensor([0.0413, 0.0408, 0.0527, 0.1799, 0.0274, 0.0480, 0.0832, 0.3625, 0.1195,
        0.0448])
[rfa agg] iter:  5, prev_obj_val: 65.42731475830078, obj_val: 74.05828857421875, abs dis: 8.630973815917969
[rfa agg] iter: 5, weight: tensor([0.0350, 0.0346, 0.0376, 0.2000, 0.0204, 0.0411, 0.0569, 0.4179, 0.1183,
        0.0382])
[rfa agg] iter:  6, prev_obj_val: 74.05828857421875, obj_val: 74.03157806396484, abs dis: 0.02671051025390625
[rfa agg] iter: 6, weight: tensor([0.0499, 0.0493, 0.0949, 0.1475, 0.0435, 0.0566, 0.1698, 0.2217, 0.1135,
        0.0533])
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3373, Accuracy: 94/10000 (0.9400%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 4.3831, Accuracy: 2762/9950 (27.7588%)
saving model
Done in 590.9385025501251 sec.
Server Epoch:68 choose agents : [83, 52, 97, 44, 67, 7, 87, 76, 46, 17].
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   1, Avg loss: 0.0528, Accuracy: 488/1953 (24.9872%)
_Train Local_ResNet_18, epoch  68, local model 83, internal_epoch   2, Avg loss: 0.0309, Accuracy: 915/1953 (46.8510%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.6634, Accuracy: 135/10000 (1.3500%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0548, Accuracy: 279/636 (43.8679%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0276, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.1243, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   1, Avg loss: 0.0492, Accuracy: 379/1213 (31.2448%)
_Train Local_ResNet_18, epoch  68, local model 97, internal_epoch   2, Avg loss: 0.0259, Accuracy: 566/1213 (46.6612%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.0543, Accuracy: 105/10000 (1.0500%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0567, Accuracy: 482/1750 (27.5429%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0331, Accuracy: 753/1750 (43.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.7301, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   1, Avg loss: 0.0746, Accuracy: 69/426 (16.1972%)
_Train Local_ResNet_18, epoch  68, local model 67, internal_epoch   2, Avg loss: 0.0390, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.5400, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   1, Avg loss: 0.0528, Accuracy: 347/891 (38.9450%)
_Train Local_ResNet_18, epoch  68, local model 7, internal_epoch   2, Avg loss: 0.0243, Accuracy: 480/891 (53.8721%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.0894, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   1, Avg loss: 0.0543, Accuracy: 317/1131 (28.0283%)
_Train Local_ResNet_18, epoch  68, local model 87, internal_epoch   2, Avg loss: 0.0301, Accuracy: 439/1131 (38.8152%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.7907, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   1, Avg loss: 0.0752, Accuracy: 84/466 (18.0258%)
_Train Local_ResNet_18, epoch  68, local model 76, internal_epoch   2, Avg loss: 0.0423, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.4227, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   1, Avg loss: 0.0536, Accuracy: 416/1904 (21.8487%)
_Train Local_ResNet_18, epoch  68, local model 46, internal_epoch   2, Avg loss: 0.0290, Accuracy: 787/1904 (41.3340%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.2081, Accuracy: 140/10000 (1.4000%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0492, Accuracy: 471/1574 (29.9238%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0250, Accuracy: 734/1574 (46.6328%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.6535, Accuracy: 114/10000 (1.1400%)
time spent on training: 327.7527210712433
[rfa agg] training data poison_ratio: 0.14651707970529135  data num: [1953, 636, 1213, 1750, 426, 891, 1131, 466, 1904, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.04578658740790355
[rfa agg] init. name: [83, 52, 97, 44, 67, 7, 87, 76, 46, 17], weight: tensor([0.1635, 0.0532, 0.1016, 0.1465, 0.0357, 0.0746, 0.0947, 0.0390, 0.1594,
        0.1318])
[rfa agg] iter:  0, prev_obj_val: 65.16584014892578, obj_val: 68.10738372802734, abs dis: 2.9415435791015625
[rfa agg] iter: 0, weight: tensor([0.0880, 0.0261, 0.2518, 0.1122, 0.0137, 0.0572, 0.1652, 0.0162, 0.0952,
        0.1743])
[rfa agg] iter:  1, prev_obj_val: 68.10738372802734, obj_val: 70.95044708251953, abs dis: 2.8430633544921875
[rfa agg] iter: 1, weight: tensor([0.0530, 0.0209, 0.4311, 0.0640, 0.0107, 0.0501, 0.2125, 0.0127, 0.0565,
        0.0887])
[rfa agg] iter:  2, prev_obj_val: 70.95044708251953, obj_val: 72.921875, abs dis: 1.9714279174804688
[rfa agg] iter: 2, weight: tensor([0.0394, 0.0189, 0.4077, 0.0463, 0.0094, 0.0492, 0.3156, 0.0112, 0.0417,
        0.0607])
[rfa agg] iter:  3, prev_obj_val: 72.921875, obj_val: 77.74833679199219, abs dis: 4.8264617919921875
[rfa agg] iter: 3, weight: tensor([0.0394, 0.0208, 0.2725, 0.0458, 0.0102, 0.0573, 0.4414, 0.0122, 0.0416,
        0.0587])
[rfa agg] iter:  4, prev_obj_val: 77.74833679199219, obj_val: 75.20736694335938, abs dis: 2.5409698486328125
[rfa agg] iter: 4, weight: tensor([0.0520, 0.0338, 0.2115, 0.0592, 0.0159, 0.1067, 0.3743, 0.0193, 0.0545,
        0.0730])
[rfa agg] iter:  5, prev_obj_val: 75.20736694335938, obj_val: 75.19975280761719, abs dis: 0.0076141357421875
[rfa agg] iter: 5, weight: tensor([0.0434, 0.0254, 0.2150, 0.0499, 0.0122, 0.0748, 0.4560, 0.0147, 0.0457,
        0.0628])
[rfa agg] iter:  6, prev_obj_val: 75.19975280761719, obj_val: 75.19937896728516, abs dis: 0.00037384033203125
[rfa agg] iter: 6, weight: tensor([0.0422, 0.0247, 0.2077, 0.0486, 0.0119, 0.0725, 0.4727, 0.0143, 0.0444,
        0.0610])
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3383, Accuracy: 99/10000 (0.9900%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 4.4342, Accuracy: 2053/9950 (20.6332%)
saving model
Done in 591.3889400959015 sec.
Server Epoch:69 choose agents : [90, 24, 28, 70, 52, 97, 11, 21, 20, 62].
_Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   1, Avg loss: 0.0533, Accuracy: 322/677 (47.5628%)
_Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   2, Avg loss: 0.0214, Accuracy: 447/677 (66.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 10.2385, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   1, Avg loss: 0.0742, Accuracy: 50/312 (16.0256%)
_Train Local_ResNet_18, epoch  69, local model 24, internal_epoch   2, Avg loss: 0.0372, Accuracy: 199/312 (63.7821%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.1012, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   1, Avg loss: 0.0542, Accuracy: 426/1581 (26.9450%)
_Train Local_ResNet_18, epoch  69, local model 28, internal_epoch   2, Avg loss: 0.0311, Accuracy: 697/1581 (44.0860%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.8530, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0513, Accuracy: 510/1418 (35.9661%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0284, Accuracy: 733/1418 (51.6925%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.0640, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   1, Avg loss: 0.0548, Accuracy: 282/636 (44.3396%)
_Train Local_ResNet_18, epoch  69, local model 52, internal_epoch   2, Avg loss: 0.0276, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.5557, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   1, Avg loss: 0.0473, Accuracy: 384/1213 (31.6570%)
_Train Local_ResNet_18, epoch  69, local model 97, internal_epoch   2, Avg loss: 0.0256, Accuracy: 590/1213 (48.6397%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.2043, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   1, Avg loss: 0.0556, Accuracy: 296/712 (41.5730%)
_Train Local_ResNet_18, epoch  69, local model 11, internal_epoch   2, Avg loss: 0.0242, Accuracy: 425/712 (59.6910%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 9.3973, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0530, Accuracy: 419/1949 (21.4982%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0314, Accuracy: 676/1949 (34.6845%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.3879, Accuracy: 107/10000 (1.0700%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   1, Avg loss: 0.0601, Accuracy: 276/807 (34.2007%)
_Train Local_ResNet_18, epoch  69, local model 20, internal_epoch   2, Avg loss: 0.0314, Accuracy: 405/807 (50.1859%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.4095, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   1, Avg loss: 0.0671, Accuracy: 162/568 (28.5211%)
_Train Local_ResNet_18, epoch  69, local model 62, internal_epoch   2, Avg loss: 0.0383, Accuracy: 263/568 (46.3028%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.4534, Accuracy: 59/10000 (0.5900%)
time spent on training: 250.90326046943665
[rfa agg] training data poison_ratio: 0.08173807353388028  data num: [677, 312, 1581, 1418, 636, 1213, 712, 1949, 807, 568]
[rfa agg] considering poison per batch poison_fraction: 0.02554314797933759
[rfa agg] init. name: [90, 24, 28, 70, 52, 97, 11, 21, 20, 62], weight: tensor([0.0686, 0.0316, 0.1601, 0.1436, 0.0644, 0.1229, 0.0721, 0.1974, 0.0817,
        0.0575])
[rfa agg] iter:  0, prev_obj_val: 65.78689575195312, obj_val: 68.94292449951172, abs dis: 3.1560287475585938
[rfa agg] iter: 0, weight: tensor([0.0445, 0.0111, 0.1037, 0.1295, 0.0366, 0.4478, 0.0545, 0.0691, 0.0740,
        0.0291])
[rfa agg] iter:  1, prev_obj_val: 68.94292449951172, obj_val: 71.13761901855469, abs dis: 2.1946945190429688
[rfa agg] iter: 1, weight: tensor([0.0712, 0.0158, 0.1077, 0.1261, 0.0566, 0.2778, 0.0911, 0.0780, 0.1316,
        0.0440])
[rfa agg] iter:  2, prev_obj_val: 71.13761901855469, obj_val: 74.52259826660156, abs dis: 3.384979248046875
[rfa agg] iter: 2, weight: tensor([0.0870, 0.0173, 0.0966, 0.1096, 0.0669, 0.1991, 0.1169, 0.0731, 0.1828,
        0.0508])
[rfa agg] iter:  3, prev_obj_val: 74.52259826660156, obj_val: 75.68431091308594, abs dis: 1.161712646484375
[rfa agg] iter: 3, weight: tensor([0.0996, 0.0155, 0.0642, 0.0704, 0.0704, 0.1078, 0.1537, 0.0513, 0.3164,
        0.0507])
[rfa agg] iter:  4, prev_obj_val: 75.68431091308594, obj_val: 80.76110076904297, abs dis: 5.076789855957031
[rfa agg] iter: 4, weight: tensor([0.0922, 0.0128, 0.0478, 0.0518, 0.0622, 0.0761, 0.1564, 0.0387, 0.4183,
        0.0437])
[rfa agg] iter:  5, prev_obj_val: 80.76110076904297, obj_val: 88.68317413330078, abs dis: 7.9220733642578125
[rfa agg] iter: 5, weight: tensor([0.1567, 0.0118, 0.0322, 0.0341, 0.0797, 0.0457, 0.3631, 0.0272, 0.2001,
        0.0495])
[rfa agg] iter:  6, prev_obj_val: 88.68317413330078, obj_val: 91.84268188476562, abs dis: 3.1595077514648438
[rfa agg] iter: 6, weight: tensor([0.2871, 0.0168, 0.0323, 0.0336, 0.2216, 0.0422, 0.1368, 0.0282, 0.0939,
        0.1074])
[rfa agg] iter:  7, prev_obj_val: 91.84268188476562, obj_val: 91.8228530883789, abs dis: 0.01982879638671875
[rfa agg] iter: 7, weight: tensor([0.1848, 0.0184, 0.0311, 0.0322, 0.3324, 0.0397, 0.1017, 0.0274, 0.0779,
        0.1545])
[rfa agg] iter:  8, prev_obj_val: 91.8228530883789, obj_val: 95.32881927490234, abs dis: 3.5059661865234375
[rfa agg] iter: 8, weight: tensor([0.1696, 0.0174, 0.0294, 0.0304, 0.3745, 0.0376, 0.0956, 0.0259, 0.0736,
        0.1459])
[rfa agg] iter:  9, prev_obj_val: 95.32881927490234, obj_val: 99.04425811767578, abs dis: 3.7154388427734375
[rfa agg] iter: 9, weight: tensor([0.1324, 0.0214, 0.0316, 0.0325, 0.2951, 0.0395, 0.0860, 0.0281, 0.0704,
        0.2629])
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3367, Accuracy: 98/10000 (0.9800%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 4.4636, Accuracy: 1869/9950 (18.7839%)
saving model
Done in 513.3188252449036 sec.
Server Epoch:70 choose agents : [75, 24, 36, 52, 95, 82, 93, 97, 6, 81].
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0597, Accuracy: 281/776 (36.2113%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0267, Accuracy: 422/776 (54.3814%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.1625, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   1, Avg loss: 0.0741, Accuracy: 57/312 (18.2692%)
_Train Local_ResNet_18, epoch  70, local model 24, internal_epoch   2, Avg loss: 0.0366, Accuracy: 196/312 (62.8205%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.3309, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   1, Avg loss: 0.0812, Accuracy: 46/408 (11.2745%)
_Train Local_ResNet_18, epoch  70, local model 36, internal_epoch   2, Avg loss: 0.0466, Accuracy: 154/408 (37.7451%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.1506, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   1, Avg loss: 0.0516, Accuracy: 305/636 (47.9560%)
_Train Local_ResNet_18, epoch  70, local model 52, internal_epoch   2, Avg loss: 0.0265, Accuracy: 428/636 (67.2956%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3400, Accuracy: 65/10000 (0.6500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   1, Avg loss: 0.0478, Accuracy: 360/599 (60.1002%)
_Train Local_ResNet_18, epoch  70, local model 95, internal_epoch   2, Avg loss: 0.0268, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 11.3671, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   1, Avg loss: 0.0745, Accuracy: 96/500 (19.2000%)
_Train Local_ResNet_18, epoch  70, local model 82, internal_epoch   2, Avg loss: 0.0470, Accuracy: 227/500 (45.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.5501, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   1, Avg loss: 0.0538, Accuracy: 445/1742 (25.5454%)
_Train Local_ResNet_18, epoch  70, local model 93, internal_epoch   2, Avg loss: 0.0300, Accuracy: 765/1742 (43.9150%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3213, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   1, Avg loss: 0.0477, Accuracy: 413/1213 (34.0478%)
_Train Local_ResNet_18, epoch  70, local model 97, internal_epoch   2, Avg loss: 0.0254, Accuracy: 589/1213 (48.5573%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.7628, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   1, Avg loss: 0.0531, Accuracy: 427/1956 (21.8303%)
_Train Local_ResNet_18, epoch  70, local model 6, internal_epoch   2, Avg loss: 0.0295, Accuracy: 724/1956 (37.0143%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.3306, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   1, Avg loss: 0.0614, Accuracy: 261/774 (33.7209%)
_Train Local_ResNet_18, epoch  70, local model 81, internal_epoch   2, Avg loss: 0.0332, Accuracy: 345/774 (44.5736%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.8126, Accuracy: 81/10000 (0.8100%)
time spent on training: 250.70331358909607
[rfa agg] training data poison_ratio: 0.06718259309107223  data num: [776, 312, 408, 636, 599, 500, 1742, 1213, 1956, 774]
[rfa agg] considering poison per batch poison_fraction: 0.02099456034096007
[rfa agg] init. name: [75, 24, 36, 52, 95, 82, 93, 97, 6, 81], weight: tensor([0.0870, 0.0350, 0.0458, 0.0713, 0.0672, 0.0561, 0.1954, 0.1360, 0.2194,
        0.0868])
[rfa agg] iter:  0, prev_obj_val: 76.78268432617188, obj_val: 78.10980224609375, abs dis: 1.327117919921875
[rfa agg] iter: 0, weight: tensor([0.1241, 0.0168, 0.0264, 0.0587, 0.0552, 0.0360, 0.1024, 0.3665, 0.0904,
        0.1234])
[rfa agg] iter:  1, prev_obj_val: 78.10980224609375, obj_val: 81.19842529296875, abs dis: 3.088623046875
[rfa agg] iter: 1, weight: tensor([0.1906, 0.0189, 0.0305, 0.0731, 0.0688, 0.0423, 0.0884, 0.2177, 0.0801,
        0.1897])
[rfa agg] iter:  2, prev_obj_val: 81.19842529296875, obj_val: 86.52545928955078, abs dis: 5.327033996582031
[rfa agg] iter: 2, weight: tensor([0.3634, 0.0109, 0.0190, 0.0583, 0.0549, 0.0279, 0.0325, 0.0564, 0.0305,
        0.3461])
[rfa agg] iter:  3, prev_obj_val: 86.52545928955078, obj_val: 88.51557922363281, abs dis: 1.9901199340820312
[rfa agg] iter: 3, weight: tensor([0.2058, 0.0201, 0.0379, 0.1629, 0.1558, 0.0594, 0.0443, 0.0676, 0.0421,
        0.2039])
[rfa agg] iter:  4, prev_obj_val: 88.51557922363281, obj_val: 90.60426330566406, abs dis: 2.08868408203125
[rfa agg] iter: 4, weight: tensor([0.1492, 0.0208, 0.0407, 0.2219, 0.2124, 0.0661, 0.0410, 0.0604, 0.0391,
        0.1485])
[rfa agg] iter:  5, prev_obj_val: 90.60426330566406, obj_val: 98.96985626220703, abs dis: 8.365592956542969
[rfa agg] iter: 5, weight: tensor([0.0993, 0.0187, 0.0382, 0.2890, 0.2800, 0.0650, 0.0328, 0.0468, 0.0314,
        0.0989])
[rfa agg] iter:  6, prev_obj_val: 98.96985626220703, obj_val: 98.96331787109375, abs dis: 0.00653839111328125
[rfa agg] iter: 6, weight: tensor([0.0756, 0.0307, 0.0790, 0.2252, 0.2138, 0.1816, 0.0361, 0.0477, 0.0350,
        0.0753])
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3359, Accuracy: 101/10000 (1.0100%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 4.4916, Accuracy: 1700/9950 (17.0854%)
saving model
Done in 515.7733173370361 sec.
Server Epoch:71 choose agents : [88, 8, 87, 89, 65, 19, 11, 23, 49, 57].
_Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   1, Avg loss: 0.0725, Accuracy: 144/603 (23.8806%)
_Train Local_ResNet_18, epoch  71, local model 88, internal_epoch   2, Avg loss: 0.0427, Accuracy: 281/603 (46.6003%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.6748, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   1, Avg loss: 0.0550, Accuracy: 365/1513 (24.1243%)
_Train Local_ResNet_18, epoch  71, local model 8, internal_epoch   2, Avg loss: 0.0338, Accuracy: 563/1513 (37.2108%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.1158, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   1, Avg loss: 0.0513, Accuracy: 346/1131 (30.5924%)
_Train Local_ResNet_18, epoch  71, local model 87, internal_epoch   2, Avg loss: 0.0291, Accuracy: 447/1131 (39.5225%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.3039, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   1, Avg loss: 0.0569, Accuracy: 341/896 (38.0580%)
_Train Local_ResNet_18, epoch  71, local model 89, internal_epoch   2, Avg loss: 0.0315, Accuracy: 461/896 (51.4509%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.2828, Accuracy: 55/10000 (0.5500%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   1, Avg loss: 0.0529, Accuracy: 429/1475 (29.0847%)
_Train Local_ResNet_18, epoch  71, local model 65, internal_epoch   2, Avg loss: 0.0274, Accuracy: 753/1475 (51.0508%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.8338, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   1, Avg loss: 0.0453, Accuracy: 452/1036 (43.6293%)
_Train Local_ResNet_18, epoch  71, local model 19, internal_epoch   2, Avg loss: 0.0243, Accuracy: 693/1036 (66.8919%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 12.2759, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   1, Avg loss: 0.0545, Accuracy: 297/712 (41.7135%)
_Train Local_ResNet_18, epoch  71, local model 11, internal_epoch   2, Avg loss: 0.0245, Accuracy: 429/712 (60.2528%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 9.7842, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   1, Avg loss: 0.0622, Accuracy: 303/715 (42.3776%)
_Train Local_ResNet_18, epoch  71, local model 23, internal_epoch   2, Avg loss: 0.0349, Accuracy: 440/715 (61.5385%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.3207, Accuracy: 83/10000 (0.8300%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0739, Accuracy: 74/440 (16.8182%)
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0432, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.8412, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   1, Avg loss: 0.0534, Accuracy: 333/1154 (28.8562%)
_Train Local_ResNet_18, epoch  71, local model 57, internal_epoch   2, Avg loss: 0.0244, Accuracy: 495/1154 (42.8943%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 10.8051, Accuracy: 80/10000 (0.8000%)
time spent on training: 297.280241727829
[rfa agg] training data poison_ratio: 0.1979328165374677  data num: [603, 1513, 1131, 896, 1475, 1036, 712, 715, 440, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.06185400516795865
[rfa agg] init. name: [88, 8, 87, 89, 65, 19, 11, 23, 49, 57], weight: tensor([0.0623, 0.1564, 0.1169, 0.0926, 0.1525, 0.1071, 0.0736, 0.0739, 0.0455,
        0.1193])
[rfa agg] iter:  0, prev_obj_val: 45.71685028076172, obj_val: 55.129669189453125, abs dis: 9.412818908691406
[rfa agg] iter: 0, weight: tensor([0.0422, 0.0588, 0.1299, 0.2597, 0.0574, 0.1701, 0.0821, 0.0809, 0.0193,
        0.0995])
[rfa agg] iter:  1, prev_obj_val: 55.129669189453125, obj_val: 60.695003509521484, abs dis: 5.565334320068359
[rfa agg] iter: 1, weight: tensor([0.0689, 0.0380, 0.0593, 0.1628, 0.0371, 0.0660, 0.2770, 0.2167, 0.0231,
        0.0511])
[rfa agg] iter:  2, prev_obj_val: 60.695003509521484, obj_val: 67.52168273925781, abs dis: 6.826679229736328
[rfa agg] iter: 2, weight: tensor([0.1109, 0.0346, 0.0497, 0.0997, 0.0337, 0.0535, 0.3038, 0.2423, 0.0279,
        0.0439])
[rfa agg] iter:  3, prev_obj_val: 67.52168273925781, obj_val: 74.98176574707031, abs dis: 7.4600830078125
[rfa agg] iter: 3, weight: tensor([0.3229, 0.0391, 0.0527, 0.0880, 0.0382, 0.0554, 0.1596, 0.1531, 0.0437,
        0.0473])
[rfa agg] iter:  4, prev_obj_val: 74.98176574707031, obj_val: 74.97819519042969, abs dis: 0.003570556640625
[rfa agg] iter: 4, weight: tensor([0.4033, 0.0408, 0.0521, 0.0773, 0.0398, 0.0539, 0.1095, 0.1080, 0.0680,
        0.0474])
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3346, Accuracy: 93/10000 (0.9300%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 4.5119, Accuracy: 1589/9950 (15.9698%)
saving model
Done in 552.6157329082489 sec.
Server Epoch:72 choose agents : [78, 58, 7, 87, 5, 96, 28, 39, 91, 22].
_Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   1, Avg loss: 0.0801, Accuracy: 60/416 (14.4231%)
_Train Local_ResNet_18, epoch  72, local model 78, internal_epoch   2, Avg loss: 0.0410, Accuracy: 237/416 (56.9712%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.2199, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   1, Avg loss: 0.0561, Accuracy: 329/803 (40.9714%)
_Train Local_ResNet_18, epoch  72, local model 58, internal_epoch   2, Avg loss: 0.0318, Accuracy: 410/803 (51.0585%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.7866, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   1, Avg loss: 0.0535, Accuracy: 335/891 (37.5982%)
_Train Local_ResNet_18, epoch  72, local model 7, internal_epoch   2, Avg loss: 0.0242, Accuracy: 457/891 (51.2907%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.9133, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   1, Avg loss: 0.0515, Accuracy: 340/1131 (30.0619%)
_Train Local_ResNet_18, epoch  72, local model 87, internal_epoch   2, Avg loss: 0.0289, Accuracy: 456/1131 (40.3183%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.4966, Accuracy: 69/10000 (0.6900%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   1, Avg loss: 0.0477, Accuracy: 502/1628 (30.8354%)
_Train Local_ResNet_18, epoch  72, local model 5, internal_epoch   2, Avg loss: 0.0227, Accuracy: 944/1628 (57.9853%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.3123, Accuracy: 172/10000 (1.7200%)
_Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   1, Avg loss: 0.0817, Accuracy: 13/311 (4.1801%)
_Train Local_ResNet_18, epoch  72, local model 96, internal_epoch   2, Avg loss: 0.0530, Accuracy: 137/311 (44.0514%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.2192, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   1, Avg loss: 0.0540, Accuracy: 438/1581 (27.7040%)
_Train Local_ResNet_18, epoch  72, local model 28, internal_epoch   2, Avg loss: 0.0312, Accuracy: 662/1581 (41.8722%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.8431, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   1, Avg loss: 0.0488, Accuracy: 348/1013 (34.3534%)
_Train Local_ResNet_18, epoch  72, local model 39, internal_epoch   2, Avg loss: 0.0235, Accuracy: 585/1013 (57.7493%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.9927, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   1, Avg loss: 0.0490, Accuracy: 419/1030 (40.6796%)
_Train Local_ResNet_18, epoch  72, local model 91, internal_epoch   2, Avg loss: 0.0233, Accuracy: 688/1030 (66.7961%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 10.4905, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0452, Accuracy: 567/1470 (38.5714%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0227, Accuracy: 925/1470 (62.9252%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.6997, Accuracy: 101/10000 (1.0100%)
time spent on training: 296.7814726829529
[rfa agg] training data poison_ratio: 0.15845824411134904  data num: [416, 803, 891, 1131, 1628, 311, 1581, 1013, 1030, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.04951820128479657
[rfa agg] init. name: [78, 58, 7, 87, 5, 96, 28, 39, 91, 22], weight: tensor([0.0405, 0.0782, 0.0867, 0.1101, 0.1585, 0.0303, 0.1539, 0.0986, 0.1003,
        0.1431])
[rfa agg] iter:  0, prev_obj_val: 46.881507873535156, obj_val: 51.61595916748047, abs dis: 4.7344512939453125
[rfa agg] iter: 0, weight: tensor([0.0104, 0.0496, 0.0718, 0.2420, 0.0450, 0.0065, 0.0492, 0.2042, 0.2605,
        0.0607])
[rfa agg] iter:  1, prev_obj_val: 51.61595916748047, obj_val: 53.85414123535156, abs dis: 2.2381820678710938
[rfa agg] iter: 1, weight: tensor([0.0132, 0.0835, 0.1412, 0.1196, 0.0417, 0.0080, 0.0448, 0.3318, 0.1636,
        0.0526])
[rfa agg] iter:  2, prev_obj_val: 53.85414123535156, obj_val: 58.84013748168945, abs dis: 4.985996246337891
[rfa agg] iter: 2, weight: tensor([0.0154, 0.1123, 0.2085, 0.1097, 0.0436, 0.0092, 0.0467, 0.2616, 0.1389,
        0.0540])
[rfa agg] iter:  3, prev_obj_val: 58.84013748168945, obj_val: 61.696014404296875, abs dis: 2.855876922607422
[rfa agg] iter: 3, weight: tensor([0.0166, 0.1883, 0.3570, 0.0783, 0.0378, 0.0097, 0.0401, 0.1351, 0.0917,
        0.0454])
[rfa agg] iter:  4, prev_obj_val: 61.696014404296875, obj_val: 64.90771484375, abs dis: 3.211700439453125
[rfa agg] iter: 4, weight: tensor([0.0173, 0.2825, 0.3270, 0.0675, 0.0352, 0.0099, 0.0372, 0.1048, 0.0768,
        0.0417])
[rfa agg] iter:  5, prev_obj_val: 64.90771484375, obj_val: 68.44808959960938, abs dis: 3.540374755859375
[rfa agg] iter: 5, weight: tensor([0.0190, 0.4267, 0.2132, 0.0617, 0.0343, 0.0107, 0.0361, 0.0896, 0.0686,
        0.0402])
[rfa agg] iter:  6, prev_obj_val: 68.44808959960938, obj_val: 61.703914642333984, abs dis: 6.744174957275391
[rfa agg] iter: 6, weight: tensor([0.0251, 0.4163, 0.1806, 0.0680, 0.0400, 0.0138, 0.0420, 0.0937, 0.0742,
        0.0464])
[rfa agg] iter:  7, prev_obj_val: 61.703914642333984, obj_val: 68.45640563964844, abs dis: 6.752490997314453
[rfa agg] iter: 7, weight: tensor([0.0171, 0.3349, 0.2798, 0.0668, 0.0348, 0.0098, 0.0367, 0.1032, 0.0756,
        0.0413])
[rfa agg] iter:  8, prev_obj_val: 68.45640563964844, obj_val: 58.83428955078125, abs dis: 9.622116088867188
[rfa agg] iter: 8, weight: tensor([0.0257, 0.3978, 0.1881, 0.0698, 0.0411, 0.0141, 0.0431, 0.0963, 0.0762,
        0.0476])
[rfa agg] iter:  9, prev_obj_val: 58.83428955078125, obj_val: 61.69367599487305, abs dis: 2.859386444091797
[rfa agg] iter: 9, weight: tensor([0.0162, 0.2029, 0.3568, 0.0766, 0.0370, 0.0094, 0.0392, 0.1285, 0.0888,
        0.0445])
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3355, Accuracy: 93/10000 (0.9300%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 4.5555, Accuracy: 1189/9950 (11.9497%)
saving model
Done in 562.881097316742 sec.
Server Epoch:73 choose agents : [98, 36, 21, 76, 10, 40, 61, 4, 75, 26].
_Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   1, Avg loss: 0.0755, Accuracy: 54/373 (14.4772%)
_Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   2, Avg loss: 0.0437, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.8381, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   1, Avg loss: 0.0812, Accuracy: 56/408 (13.7255%)
_Train Local_ResNet_18, epoch  73, local model 36, internal_epoch   2, Avg loss: 0.0452, Accuracy: 159/408 (38.9706%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.1101, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   1, Avg loss: 0.0530, Accuracy: 433/1949 (22.2165%)
_Train Local_ResNet_18, epoch  73, local model 21, internal_epoch   2, Avg loss: 0.0316, Accuracy: 680/1949 (34.8897%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.4498, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   1, Avg loss: 0.0761, Accuracy: 93/466 (19.9571%)
_Train Local_ResNet_18, epoch  73, local model 76, internal_epoch   2, Avg loss: 0.0439, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.2987, Accuracy: 57/10000 (0.5700%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   1, Avg loss: 0.0522, Accuracy: 259/861 (30.0813%)
_Train Local_ResNet_18, epoch  73, local model 10, internal_epoch   2, Avg loss: 0.0179, Accuracy: 520/861 (60.3949%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.9677, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   1, Avg loss: 0.0536, Accuracy: 413/1573 (26.2556%)
_Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   2, Avg loss: 0.0330, Accuracy: 661/1573 (42.0216%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 8.0065, Accuracy: 86/10000 (0.8600%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   1, Avg loss: 0.1251, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  73, local model 61, internal_epoch   2, Avg loss: 0.1179, Accuracy: 1/85 (1.1765%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3471, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0582, Accuracy: 345/901 (38.2908%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0294, Accuracy: 430/901 (47.7248%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.2284, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   1, Avg loss: 0.0611, Accuracy: 285/776 (36.7268%)
_Train Local_ResNet_18, epoch  73, local model 75, internal_epoch   2, Avg loss: 0.0269, Accuracy: 436/776 (56.1856%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 9.3593, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   1, Avg loss: 0.0534, Accuracy: 361/1446 (24.9654%)
_Train Local_ResNet_18, epoch  73, local model 26, internal_epoch   2, Avg loss: 0.0323, Accuracy: 573/1446 (39.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.4991, Accuracy: 67/10000 (0.6700%)
time spent on training: 295.06388306617737
[rfa agg] training data poison_ratio: 0.1070377913555103  data num: [373, 408, 1949, 466, 861, 1573, 85, 901, 776, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.03344930979859697
[rfa agg] init. name: [98, 36, 21, 76, 10, 40, 61, 4, 75, 26], weight: tensor([0.0422, 0.0462, 0.2205, 0.0527, 0.0974, 0.1780, 0.0096, 0.1019, 0.0878,
        0.1636])
[rfa agg] iter:  0, prev_obj_val: 70.42333984375, obj_val: 72.92168426513672, abs dis: 2.4983444213867188
[rfa agg] iter: 0, weight: tensor([0.0217, 0.0260, 0.0966, 0.0328, 0.1611, 0.1397, 0.0037, 0.2293, 0.1143,
        0.1747])
[rfa agg] iter:  1, prev_obj_val: 72.92168426513672, obj_val: 75.0947265625, abs dis: 2.1730422973632812
[rfa agg] iter: 1, weight: tensor([0.0156, 0.0191, 0.0500, 0.0247, 0.2070, 0.0657, 0.0025, 0.4192, 0.1196,
        0.0765])
[rfa agg] iter:  2, prev_obj_val: 75.0947265625, obj_val: 76.76998138427734, abs dis: 1.6752548217773438
[rfa agg] iter: 2, weight: tensor([0.0132, 0.0164, 0.0356, 0.0215, 0.2995, 0.0450, 0.0021, 0.3741, 0.1415,
        0.0511])
[rfa agg] iter:  3, prev_obj_val: 76.76998138427734, obj_val: 78.82955169677734, abs dis: 2.0595703125
[rfa agg] iter: 3, weight: tensor([0.0137, 0.0171, 0.0337, 0.0228, 0.4040, 0.0419, 0.0021, 0.2290, 0.1887,
        0.0471])
[rfa agg] iter:  4, prev_obj_val: 78.82955169677734, obj_val: 78.81444549560547, abs dis: 0.015106201171875
[rfa agg] iter: 4, weight: tensor([0.0150, 0.0189, 0.0336, 0.0255, 0.3657, 0.0412, 0.0022, 0.1635, 0.2883,
        0.0459])
[rfa agg] iter:  5, prev_obj_val: 78.81444549560547, obj_val: 78.81382751464844, abs dis: 0.00061798095703125
[rfa agg] iter: 5, weight: tensor([0.0148, 0.0187, 0.0332, 0.0252, 0.3523, 0.0407, 0.0022, 0.1594, 0.3082,
        0.0453])
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3362, Accuracy: 88/10000 (0.8800%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 4.5826, Accuracy: 758/9950 (7.6181%)
saving model
Done in 554.1891782283783 sec.
Server Epoch:74 choose agents : [23, 32, 65, 40, 44, 4, 84, 94, 14, 70].
_Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   1, Avg loss: 0.0590, Accuracy: 305/715 (42.6573%)
_Train Local_ResNet_18, epoch  74, local model 23, internal_epoch   2, Avg loss: 0.0361, Accuracy: 439/715 (61.3986%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 6.2896, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   1, Avg loss: 0.0494, Accuracy: 242/735 (32.9252%)
_Train Local_ResNet_18, epoch  74, local model 32, internal_epoch   2, Avg loss: 0.0196, Accuracy: 392/735 (53.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 11.3421, Accuracy: 70/10000 (0.7000%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   1, Avg loss: 0.0536, Accuracy: 449/1475 (30.4407%)
_Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   2, Avg loss: 0.0269, Accuracy: 773/1475 (52.4068%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.5188, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   1, Avg loss: 0.0539, Accuracy: 445/1573 (28.2899%)
_Train Local_ResNet_18, epoch  74, local model 40, internal_epoch   2, Avg loss: 0.0327, Accuracy: 635/1573 (40.3687%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.0535, Accuracy: 77/10000 (0.7700%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0558, Accuracy: 455/1750 (26.0000%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0334, Accuracy: 748/1750 (42.7429%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.5746, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   1, Avg loss: 0.0557, Accuracy: 349/901 (38.7347%)
_Train Local_ResNet_18, epoch  74, local model 4, internal_epoch   2, Avg loss: 0.0298, Accuracy: 433/901 (48.0577%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.8297, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   1, Avg loss: 0.0581, Accuracy: 326/1190 (27.3950%)
_Train Local_ResNet_18, epoch  74, local model 84, internal_epoch   2, Avg loss: 0.0286, Accuracy: 523/1190 (43.9496%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.2123, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   1, Avg loss: 0.0534, Accuracy: 445/1662 (26.7750%)
_Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   2, Avg loss: 0.0308, Accuracy: 712/1662 (42.8400%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.6641, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   1, Avg loss: 0.0553, Accuracy: 259/1013 (25.5676%)
_Train Local_ResNet_18, epoch  74, local model 14, internal_epoch   2, Avg loss: 0.0311, Accuracy: 432/1013 (42.6456%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.2126, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   1, Avg loss: 0.0509, Accuracy: 514/1418 (36.2482%)
_Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   2, Avg loss: 0.0284, Accuracy: 695/1418 (49.0127%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.1853, Accuracy: 111/10000 (1.1100%)
time spent on training: 350.4452531337738
[rfa agg] training data poison_ratio: 0.2594111969111969  data num: [715, 735, 1475, 1573, 1750, 901, 1190, 1662, 1013, 1418]
[rfa agg] considering poison per batch poison_fraction: 0.08106599903474904
[rfa agg] init. name: [23, 32, 65, 40, 44, 4, 84, 94, 14, 70], weight: tensor([0.0575, 0.0591, 0.1186, 0.1265, 0.1408, 0.0725, 0.0957, 0.1337, 0.0815,
        0.1141])
[rfa agg] iter:  0, prev_obj_val: 49.14970397949219, obj_val: 54.78850173950195, abs dis: 5.638797760009766
[rfa agg] iter: 0, weight: tensor([0.0283, 0.0291, 0.0805, 0.0722, 0.0538, 0.0615, 0.4214, 0.0656, 0.0916,
        0.0960])
[rfa agg] iter:  1, prev_obj_val: 54.78850173950195, obj_val: 54.759456634521484, abs dis: 0.02904510498046875
[rfa agg] iter: 1, weight: tensor([0.0426, 0.0440, 0.0742, 0.0689, 0.0550, 0.1128, 0.2496, 0.0644, 0.2043,
        0.0842])
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3342, Accuracy: 88/10000 (0.8800%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 4.5577, Accuracy: 1015/9950 (10.2010%)
saving model
Done in 604.1744978427887 sec.
Server Epoch:75 choose agents : [74, 11, 45, 65, 75, 59, 52, 1, 15, 25].
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1, Avg loss: 0.0431, Accuracy: 582/1552 (37.5000%)
_Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2, Avg loss: 0.0194, Accuracy: 843/1552 (54.3170%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 11.7811, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   1, Avg loss: 0.0538, Accuracy: 305/712 (42.8371%)
_Train Local_ResNet_18, epoch  75, local model 11, internal_epoch   2, Avg loss: 0.0239, Accuracy: 458/712 (64.3258%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.0095, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   1, Avg loss: 0.0629, Accuracy: 226/669 (33.7818%)
_Train Local_ResNet_18, epoch  75, local model 45, internal_epoch   2, Avg loss: 0.0367, Accuracy: 363/669 (54.2601%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.1245, Accuracy: 88/10000 (0.8800%)
poison local model 65 index 14 
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0540, Accuracy: 418/1475 (28.3390%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0277, Accuracy: 749/1475 (50.7797%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.8187, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   1, Avg loss: 0.0597, Accuracy: 295/776 (38.0155%)
_Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   2, Avg loss: 0.0265, Accuracy: 425/776 (54.7680%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2351, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   1, Avg loss: 0.0597, Accuracy: 329/1089 (30.2112%)
_Train Local_ResNet_18, epoch  75, local model 59, internal_epoch   2, Avg loss: 0.0241, Accuracy: 568/1089 (52.1579%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 10.1411, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   1, Avg loss: 0.0509, Accuracy: 313/636 (49.2138%)
_Train Local_ResNet_18, epoch  75, local model 52, internal_epoch   2, Avg loss: 0.0263, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.4250, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   1, Avg loss: 0.0522, Accuracy: 338/928 (36.4224%)
_Train Local_ResNet_18, epoch  75, local model 1, internal_epoch   2, Avg loss: 0.0205, Accuracy: 632/928 (68.1034%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.2737, Accuracy: 117/10000 (1.1700%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   1, Avg loss: 0.0560, Accuracy: 346/1154 (29.9827%)
_Train Local_ResNet_18, epoch  75, local model 15, internal_epoch   2, Avg loss: 0.0275, Accuracy: 504/1154 (43.6742%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.7199, Accuracy: 91/10000 (0.9100%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   1, Avg loss: 0.0531, Accuracy: 308/690 (44.6377%)
_Train Local_ResNet_18, epoch  75, local model 25, internal_epoch   2, Avg loss: 0.0234, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 9.3484, Accuracy: 90/10000 (0.9000%)
time spent on training: 325.4401512145996
[rfa agg] training data poison_ratio: 0.5031505009813035  data num: [1552, 712, 669, 1475, 776, 1089, 636, 928, 1154, 690]
[rfa agg] considering poison per batch poison_fraction: 0.15723453155665734
[rfa agg] init. name: [74, 11, 45, 65, 75, 59, 52, 1, 15, 25], weight: tensor([0.1603, 0.0735, 0.0691, 0.1524, 0.0802, 0.1125, 0.0657, 0.0959, 0.1192,
        0.0713])
[rfa agg] iter:  0, prev_obj_val: 45.836875915527344, obj_val: 49.86249923706055, abs dis: 4.025623321533203
[rfa agg] iter: 0, weight: tensor([0.0548, 0.0677, 0.0495, 0.0581, 0.1013, 0.1347, 0.0386, 0.3360, 0.1079,
        0.0512])
[rfa agg] iter:  1, prev_obj_val: 49.86249923706055, obj_val: 55.21126174926758, abs dis: 5.348762512207031
[rfa agg] iter: 1, weight: tensor([0.0394, 0.1301, 0.0757, 0.0410, 0.2842, 0.0690, 0.0522, 0.1691, 0.0607,
        0.0786])
[rfa agg] iter:  2, prev_obj_val: 55.21126174926758, obj_val: 64.1837387084961, abs dis: 8.972476959228516
[rfa agg] iter: 2, weight: tensor([0.0262, 0.3272, 0.1235, 0.0269, 0.1543, 0.0392, 0.0664, 0.0662, 0.0359,
        0.1343])
[rfa agg] iter:  3, prev_obj_val: 64.1837387084961, obj_val: 68.04391479492188, abs dis: 3.8601760864257812
[rfa agg] iter: 3, weight: tensor([0.0258, 0.1116, 0.2064, 0.0263, 0.0731, 0.0346, 0.1946, 0.0490, 0.0326,
        0.2461])
[rfa agg] iter:  4, prev_obj_val: 68.04391479492188, obj_val: 68.02526092529297, abs dis: 0.01865386962890625
[rfa agg] iter: 4, weight: tensor([0.0275, 0.0925, 0.1591, 0.0280, 0.0675, 0.0359, 0.3371, 0.0489, 0.0340,
        0.1693])
[rfa agg] iter:  5, prev_obj_val: 68.02526092529297, obj_val: 64.14627075195312, abs dis: 3.8789901733398438
[rfa agg] iter: 5, weight: tensor([0.0259, 0.0866, 0.1488, 0.0263, 0.0633, 0.0337, 0.3818, 0.0459, 0.0319,
        0.1556])
[rfa agg] iter:  6, prev_obj_val: 64.14627075195312, obj_val: 68.03719329833984, abs dis: 3.8909225463867188
[rfa agg] iter: 6, weight: tensor([0.0245, 0.1034, 0.2124, 0.0250, 0.0690, 0.0329, 0.2307, 0.0467, 0.0310,
        0.2243])
[rfa agg] iter:  7, prev_obj_val: 68.03719329833984, obj_val: 68.02454376220703, abs dis: 0.0126495361328125
[rfa agg] iter: 7, weight: tensor([0.0271, 0.0908, 0.1571, 0.0276, 0.0664, 0.0353, 0.3489, 0.0481, 0.0334,
        0.1654])
[rfa agg] iter:  8, prev_obj_val: 68.02454376220703, obj_val: 64.14727783203125, abs dis: 3.8772659301757812
[rfa agg] iter: 8, weight: tensor([0.0257, 0.0860, 0.1478, 0.0261, 0.0629, 0.0335, 0.3863, 0.0456, 0.0317,
        0.1543])
[rfa agg] iter:  9, prev_obj_val: 64.14727783203125, obj_val: 68.0370864868164, abs dis: 3.8898086547851562
[rfa agg] iter: 9, weight: tensor([0.0245, 0.1033, 0.2123, 0.0250, 0.0689, 0.0329, 0.2313, 0.0467, 0.0310,
        0.2240])
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3332, Accuracy: 89/10000 (0.8900%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 4.5816, Accuracy: 919/9950 (9.2362%)
saving model
Done in 593.443630695343 sec.
Server Epoch:76 choose agents : [63, 74, 77, 87, 99, 4, 66, 94, 14, 24].
_Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   1, Avg loss: 0.0510, Accuracy: 293/888 (32.9955%)
_Train Local_ResNet_18, epoch  76, local model 63, internal_epoch   2, Avg loss: 0.0235, Accuracy: 488/888 (54.9550%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 10.4759, Accuracy: 97/10000 (0.9700%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 576/1552 (37.1134%)
_Train Local_ResNet_18, epoch  76, local model 74, internal_epoch   2, Avg loss: 0.0197, Accuracy: 815/1552 (52.5129%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 11.5879, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   1, Avg loss: 0.0485, Accuracy: 378/1340 (28.2090%)
_Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   2, Avg loss: 0.0246, Accuracy: 650/1340 (48.5075%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.9525, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   1, Avg loss: 0.0516, Accuracy: 349/1131 (30.8576%)
_Train Local_ResNet_18, epoch  76, local model 87, internal_epoch   2, Avg loss: 0.0294, Accuracy: 426/1131 (37.6658%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.4954, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   1, Avg loss: 0.0594, Accuracy: 253/773 (32.7296%)
_Train Local_ResNet_18, epoch  76, local model 99, internal_epoch   2, Avg loss: 0.0260, Accuracy: 447/773 (57.8266%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.8003, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   1, Avg loss: 0.0540, Accuracy: 360/901 (39.9556%)
_Train Local_ResNet_18, epoch  76, local model 4, internal_epoch   2, Avg loss: 0.0300, Accuracy: 448/901 (49.7225%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 9.5514, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   1, Avg loss: 0.0572, Accuracy: 286/1402 (20.3994%)
_Train Local_ResNet_18, epoch  76, local model 66, internal_epoch   2, Avg loss: 0.0363, Accuracy: 466/1402 (33.2382%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1786, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   1, Avg loss: 0.0534, Accuracy: 439/1662 (26.4140%)
_Train Local_ResNet_18, epoch  76, local model 94, internal_epoch   2, Avg loss: 0.0306, Accuracy: 704/1662 (42.3586%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.2718, Accuracy: 134/10000 (1.3400%)
_Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   1, Avg loss: 0.0530, Accuracy: 307/1013 (30.3060%)
_Train Local_ResNet_18, epoch  76, local model 14, internal_epoch   2, Avg loss: 0.0309, Accuracy: 439/1013 (43.3366%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.4347, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   1, Avg loss: 0.0743, Accuracy: 54/312 (17.3077%)
_Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   2, Avg loss: 0.0375, Accuracy: 204/312 (65.3846%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.2299, Accuracy: 69/10000 (0.6900%)
time spent on training: 294.3089120388031
[rfa agg] training data poison_ratio: 0.14142518680517588  data num: [888, 1552, 1340, 1131, 773, 901, 1402, 1662, 1013, 312]
[rfa agg] considering poison per batch poison_fraction: 0.044195370876617464
[rfa agg] init. name: [63, 74, 77, 87, 99, 4, 66, 94, 14, 24], weight: tensor([0.0809, 0.1414, 0.1221, 0.1031, 0.0704, 0.0821, 0.1278, 0.1514, 0.0923,
        0.0284])
[rfa agg] iter:  0, prev_obj_val: 44.11553192138672, obj_val: 46.98590850830078, abs dis: 2.8703765869140625
[rfa agg] iter: 0, weight: tensor([0.0780, 0.0520, 0.0888, 0.2531, 0.0513, 0.1148, 0.0747, 0.0496, 0.2306,
        0.0070])
[rfa agg] iter:  1, prev_obj_val: 46.98590850830078, obj_val: 53.96806335449219, abs dis: 6.982154846191406
[rfa agg] iter: 1, weight: tensor([0.0892, 0.0362, 0.0559, 0.1150, 0.0528, 0.1599, 0.0488, 0.0349, 0.4012,
        0.0060])
[rfa agg] iter:  2, prev_obj_val: 53.96806335449219, obj_val: 67.92740631103516, abs dis: 13.959342956542969
[rfa agg] iter: 2, weight: tensor([0.2499, 0.0338, 0.0470, 0.0729, 0.1067, 0.2569, 0.0426, 0.0331, 0.1496,
        0.0075])
[rfa agg] iter:  3, prev_obj_val: 67.92740631103516, obj_val: 53.95528030395508, abs dis: 13.972126007080078
[rfa agg] iter: 3, weight: tensor([0.1925, 0.0426, 0.0540, 0.0702, 0.3143, 0.1209, 0.0506, 0.0423, 0.0982,
        0.0143])
[rfa agg] iter:  4, prev_obj_val: 53.95528030395508, obj_val: 63.97322082519531, abs dis: 10.017940521240234
[rfa agg] iter: 4, weight: tensor([0.2756, 0.0334, 0.0465, 0.0720, 0.1110, 0.2367, 0.0422, 0.0328, 0.1423,
        0.0075])
[rfa agg] iter:  5, prev_obj_val: 63.97322082519531, obj_val: 67.87911987304688, abs dis: 3.9058990478515625
[rfa agg] iter: 5, weight: tensor([0.2242, 0.0363, 0.0470, 0.0632, 0.3232, 0.1219, 0.0437, 0.0360, 0.0935,
        0.0110])
[rfa agg] iter:  6, prev_obj_val: 67.87911987304688, obj_val: 53.97443389892578, abs dis: 13.904685974121094
[rfa agg] iter: 6, weight: tensor([0.1818, 0.0402, 0.0510, 0.0662, 0.3545, 0.1126, 0.0478, 0.0399, 0.0926,
        0.0135])
[rfa agg] iter:  7, prev_obj_val: 53.97443389892578, obj_val: 63.9722900390625, abs dis: 9.997856140136719
[rfa agg] iter: 7, weight: tensor([0.2745, 0.0337, 0.0468, 0.0724, 0.1124, 0.2343, 0.0425, 0.0330, 0.1430,
        0.0075])
[rfa agg] iter:  8, prev_obj_val: 63.9722900390625, obj_val: 67.87909698486328, abs dis: 3.9068069458007812
[rfa agg] iter: 8, weight: tensor([0.2241, 0.0363, 0.0470, 0.0632, 0.3237, 0.1218, 0.0437, 0.0359, 0.0934,
        0.0110])
[rfa agg] iter:  9, prev_obj_val: 67.87909698486328, obj_val: 53.97447967529297, abs dis: 13.904617309570312
[rfa agg] iter: 9, weight: tensor([0.1818, 0.0402, 0.0510, 0.0662, 0.3546, 0.1126, 0.0477, 0.0399, 0.0926,
        0.0135])
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3331, Accuracy: 92/10000 (0.9200%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 4.6267, Accuracy: 671/9950 (6.7437%)
saving model
Done in 554.2503435611725 sec.
Server Epoch:77 choose agents : [76, 6, 84, 12, 66, 97, 46, 21, 74, 15].
_Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   1, Avg loss: 0.0764, Accuracy: 84/466 (18.0258%)
_Train Local_ResNet_18, epoch  77, local model 76, internal_epoch   2, Avg loss: 0.0414, Accuracy: 182/466 (39.0558%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.4801, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   1, Avg loss: 0.0530, Accuracy: 412/1956 (21.0634%)
_Train Local_ResNet_18, epoch  77, local model 6, internal_epoch   2, Avg loss: 0.0296, Accuracy: 712/1956 (36.4008%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.2612, Accuracy: 120/10000 (1.2000%)
_Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   1, Avg loss: 0.0562, Accuracy: 345/1190 (28.9916%)
_Train Local_ResNet_18, epoch  77, local model 84, internal_epoch   2, Avg loss: 0.0285, Accuracy: 525/1190 (44.1176%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.9638, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   1, Avg loss: 0.0854, Accuracy: 28/338 (8.2840%)
_Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   2, Avg loss: 0.0442, Accuracy: 136/338 (40.2367%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.0270, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   1, Avg loss: 0.0569, Accuracy: 278/1402 (19.8288%)
_Train Local_ResNet_18, epoch  77, local model 66, internal_epoch   2, Avg loss: 0.0362, Accuracy: 433/1402 (30.8845%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.2392, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   1, Avg loss: 0.0476, Accuracy: 386/1213 (31.8219%)
_Train Local_ResNet_18, epoch  77, local model 97, internal_epoch   2, Avg loss: 0.0249, Accuracy: 636/1213 (52.4320%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.9489, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   1, Avg loss: 0.0526, Accuracy: 476/1904 (25.0000%)
_Train Local_ResNet_18, epoch  77, local model 46, internal_epoch   2, Avg loss: 0.0286, Accuracy: 809/1904 (42.4895%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.2129, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   1, Avg loss: 0.0525, Accuracy: 430/1949 (22.0626%)
_Train Local_ResNet_18, epoch  77, local model 21, internal_epoch   2, Avg loss: 0.0313, Accuracy: 681/1949 (34.9410%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.3747, Accuracy: 95/10000 (0.9500%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 557/1552 (35.8892%)
_Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   2, Avg loss: 0.0197, Accuracy: 828/1552 (53.3505%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 10.8377, Accuracy: 101/10000 (1.0100%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   1, Avg loss: 0.0579, Accuracy: 357/1154 (30.9359%)
_Train Local_ResNet_18, epoch  77, local model 15, internal_epoch   2, Avg loss: 0.0278, Accuracy: 483/1154 (41.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 9.9524, Accuracy: 99/10000 (0.9900%)
time spent on training: 373.0406062602997
[rfa agg] training data poison_ratio: 0.20618713806766228  data num: [466, 1956, 1190, 338, 1402, 1213, 1904, 1949, 1552, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.06443348064614446
[rfa agg] init. name: [76, 6, 84, 12, 66, 97, 46, 21, 74, 15], weight: tensor([0.0355, 0.1490, 0.0907, 0.0258, 0.1068, 0.0924, 0.1451, 0.1485, 0.1183,
        0.0879])
[rfa agg] iter:  0, prev_obj_val: 54.219791412353516, obj_val: 55.304996490478516, abs dis: 1.085205078125
[rfa agg] iter: 0, weight: tensor([0.0076, 0.0497, 0.0877, 0.0049, 0.4576, 0.0906, 0.0542, 0.0496, 0.1141,
        0.0840])
[rfa agg] iter:  1, prev_obj_val: 55.304996490478516, obj_val: 61.95359420776367, abs dis: 6.648597717285156
[rfa agg] iter: 1, weight: tensor([0.0075, 0.0448, 0.0982, 0.0048, 0.4624, 0.1019, 0.0485, 0.0446, 0.0939,
        0.0935])
[rfa agg] iter:  2, prev_obj_val: 61.95359420776367, obj_val: 64.02435302734375, abs dis: 2.070758819580078
[rfa agg] iter: 2, weight: tensor([0.0081, 0.0339, 0.2371, 0.0050, 0.1104, 0.2756, 0.0360, 0.0338, 0.0556,
        0.2045])
[rfa agg] iter:  3, prev_obj_val: 64.02435302734375, obj_val: 70.66297912597656, abs dis: 6.6386260986328125
[rfa agg] iter: 3, weight: tensor([0.0066, 0.0252, 0.2520, 0.0040, 0.0704, 0.3472, 0.0267, 0.0252, 0.0397,
        0.2030])
[rfa agg] iter:  4, prev_obj_val: 70.66297912597656, obj_val: 64.02352142333984, abs dis: 6.639457702636719
[rfa agg] iter: 4, weight: tensor([0.0116, 0.0374, 0.2406, 0.0070, 0.0858, 0.2712, 0.0394, 0.0373, 0.0549,
        0.2147])
[rfa agg] iter:  5, prev_obj_val: 64.02352142333984, obj_val: 70.6627197265625, abs dis: 6.639198303222656
[rfa agg] iter: 5, weight: tensor([0.0066, 0.0252, 0.2519, 0.0040, 0.0703, 0.3450, 0.0267, 0.0252, 0.0397,
        0.2054])
[rfa agg] iter:  6, prev_obj_val: 70.6627197265625, obj_val: 64.02356719970703, abs dis: 6.639152526855469
[rfa agg] iter: 6, weight: tensor([0.0116, 0.0374, 0.2405, 0.0070, 0.0858, 0.2710, 0.0394, 0.0373, 0.0549,
        0.2150])
[rfa agg] iter:  7, prev_obj_val: 64.02356719970703, obj_val: 70.66270446777344, abs dis: 6.639137268066406
[rfa agg] iter: 7, weight: tensor([0.0066, 0.0252, 0.2518, 0.0040, 0.0703, 0.3449, 0.0267, 0.0252, 0.0397,
        0.2055])
[rfa agg] iter:  8, prev_obj_val: 70.66270446777344, obj_val: 64.02357482910156, abs dis: 6.639129638671875
[rfa agg] iter: 8, weight: tensor([0.0116, 0.0374, 0.2405, 0.0070, 0.0858, 0.2710, 0.0394, 0.0373, 0.0549,
        0.2150])
[rfa agg] iter:  9, prev_obj_val: 64.02357482910156, obj_val: 70.66270446777344, abs dis: 6.639129638671875
[rfa agg] iter: 9, weight: tensor([0.0066, 0.0252, 0.2518, 0.0040, 0.0703, 0.3449, 0.0267, 0.0252, 0.0397,
        0.2055])
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3316, Accuracy: 93/10000 (0.9300%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 4.6605, Accuracy: 548/9950 (5.5075%)
saving model
Done in 638.3700084686279 sec.
Server Epoch:78 choose agents : [41, 72, 21, 61, 36, 59, 95, 83, 71, 30].
_Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   1, Avg loss: 0.0579, Accuracy: 308/719 (42.8373%)
_Train Local_ResNet_18, epoch  78, local model 41, internal_epoch   2, Avg loss: 0.0302, Accuracy: 462/719 (64.2559%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.5691, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   1, Avg loss: 0.0560, Accuracy: 326/1241 (26.2691%)
_Train Local_ResNet_18, epoch  78, local model 72, internal_epoch   2, Avg loss: 0.0340, Accuracy: 508/1241 (40.9347%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.9849, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   1, Avg loss: 0.0522, Accuracy: 438/1949 (22.4731%)
_Train Local_ResNet_18, epoch  78, local model 21, internal_epoch   2, Avg loss: 0.0314, Accuracy: 681/1949 (34.9410%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4546, Accuracy: 94/10000 (0.9400%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   1, Avg loss: 0.1278, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  78, local model 61, internal_epoch   2, Avg loss: 0.1177, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3388, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0818, Accuracy: 47/408 (11.5196%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0461, Accuracy: 154/408 (37.7451%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.3538, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   1, Avg loss: 0.0510, Accuracy: 319/1089 (29.2929%)
_Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   2, Avg loss: 0.0254, Accuracy: 581/1089 (53.3517%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 10.0198, Accuracy: 98/10000 (0.9800%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   1, Avg loss: 0.0470, Accuracy: 371/599 (61.9366%)
_Train Local_ResNet_18, epoch  78, local model 95, internal_epoch   2, Avg loss: 0.0288, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 11.3533, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 448/1953 (22.9391%)
_Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   2, Avg loss: 0.0311, Accuracy: 906/1953 (46.3902%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.7593, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   1, Avg loss: 0.0572, Accuracy: 241/818 (29.4621%)
_Train Local_ResNet_18, epoch  78, local model 71, internal_epoch   2, Avg loss: 0.0262, Accuracy: 422/818 (51.5892%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 9.7149, Accuracy: 91/10000 (0.9100%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   1, Avg loss: 0.0703, Accuracy: 111/486 (22.8395%)
_Train Local_ResNet_18, epoch  78, local model 30, internal_epoch   2, Avg loss: 0.0364, Accuracy: 223/486 (45.8848%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 8.4455, Accuracy: 61/10000 (0.6100%)
time spent on training: 312.17722821235657
[rfa agg] training data poison_ratio: 0.12517385257301808  data num: [719, 1241, 1949, 85, 408, 1089, 599, 1953, 818, 486]
[rfa agg] considering poison per batch poison_fraction: 0.03911682892906815
[rfa agg] init. name: [41, 72, 21, 61, 36, 59, 95, 83, 71, 30], weight: tensor([0.0769, 0.1328, 0.2085, 0.0091, 0.0437, 0.1165, 0.0641, 0.2089, 0.0875,
        0.0520])
[rfa agg] iter:  0, prev_obj_val: 74.33151245117188, obj_val: 77.37207794189453, abs dis: 3.0405654907226562
[rfa agg] iter: 0, weight: tensor([0.0440, 0.3022, 0.0625, 0.0021, 0.0142, 0.4064, 0.0282, 0.0626, 0.0593,
        0.0186])
[rfa agg] iter:  1, prev_obj_val: 77.37207794189453, obj_val: 78.79768371582031, abs dis: 1.4256057739257812
[rfa agg] iter: 1, weight: tensor([0.0665, 0.1905, 0.0654, 0.0027, 0.0192, 0.4304, 0.0400, 0.0655, 0.0946,
        0.0254])
[rfa agg] iter:  2, prev_obj_val: 78.79768371582031, obj_val: 80.25015258789062, abs dis: 1.4524688720703125
[rfa agg] iter: 2, weight: tensor([0.0836, 0.1857, 0.0717, 0.0031, 0.0229, 0.3594, 0.0489, 0.0718, 0.1223,
        0.0305])
[rfa agg] iter:  3, prev_obj_val: 80.25015258789062, obj_val: 81.7189712524414, abs dis: 1.4688186645507812
[rfa agg] iter: 3, weight: tensor([0.1012, 0.1765, 0.0748, 0.0035, 0.0261, 0.2972, 0.0572, 0.0749, 0.1536,
        0.0350])
[rfa agg] iter:  4, prev_obj_val: 81.7189712524414, obj_val: 84.70596313476562, abs dis: 2.9869918823242188
[rfa agg] iter: 4, weight: tensor([0.1185, 0.1619, 0.0745, 0.0037, 0.0284, 0.2474, 0.0641, 0.0746, 0.1885,
        0.0384])
[rfa agg] iter:  5, prev_obj_val: 84.70596313476562, obj_val: 84.69322204589844, abs dis: 0.0127410888671875
[rfa agg] iter: 5, weight: tensor([0.1508, 0.1235, 0.0650, 0.0037, 0.0299, 0.1671, 0.0726, 0.0651, 0.2809,
        0.0411])
[rfa agg] iter:  6, prev_obj_val: 84.69322204589844, obj_val: 86.20954132080078, abs dis: 1.5163192749023438
[rfa agg] iter: 6, weight: tensor([0.1512, 0.1227, 0.0646, 0.0037, 0.0298, 0.1651, 0.0723, 0.0648, 0.2849,
        0.0409])
[rfa agg] iter:  7, prev_obj_val: 86.20954132080078, obj_val: 89.49517822265625, abs dis: 3.2856369018554688
[rfa agg] iter: 7, weight: tensor([0.1629, 0.0993, 0.0553, 0.0034, 0.0281, 0.1282, 0.0715, 0.0554, 0.3569,
        0.0390])
[rfa agg] iter:  8, prev_obj_val: 89.49517822265625, obj_val: 94.11669921875, abs dis: 4.62152099609375
[rfa agg] iter: 8, weight: tensor([0.1664, 0.0502, 0.0308, 0.0022, 0.0193, 0.0608, 0.0556, 0.0308, 0.5564,
        0.0276])
[rfa agg] iter:  9, prev_obj_val: 94.11669921875, obj_val: 91.62905883789062, abs dis: 2.487640380859375
[rfa agg] iter: 9, weight: tensor([0.3598, 0.0543, 0.0360, 0.0030, 0.0286, 0.0629, 0.1001, 0.0361, 0.2768,
        0.0425])
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3322, Accuracy: 88/10000 (0.8800%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 4.6817, Accuracy: 466/9950 (4.6834%)
saving model
Done in 572.5993146896362 sec.
Server Epoch:79 choose agents : [33, 1, 76, 57, 89, 55, 42, 31, 95, 22].
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   1, Avg loss: 0.0797, Accuracy: 88/515 (17.0874%)
_Train Local_ResNet_18, epoch  79, local model 33, internal_epoch   2, Avg loss: 0.0470, Accuracy: 180/515 (34.9515%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.1149, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1, Avg loss: 0.0526, Accuracy: 317/928 (34.1595%)
_Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2, Avg loss: 0.0214, Accuracy: 615/928 (66.2716%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.4506, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   1, Avg loss: 0.0765, Accuracy: 81/466 (17.3820%)
_Train Local_ResNet_18, epoch  79, local model 76, internal_epoch   2, Avg loss: 0.0405, Accuracy: 181/466 (38.8412%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.1947, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   1, Avg loss: 0.0515, Accuracy: 334/1154 (28.9428%)
_Train Local_ResNet_18, epoch  79, local model 57, internal_epoch   2, Avg loss: 0.0240, Accuracy: 575/1154 (49.8267%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 11.9149, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   1, Avg loss: 0.0576, Accuracy: 333/896 (37.1652%)
_Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   2, Avg loss: 0.0310, Accuracy: 450/896 (50.2232%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.4281, Accuracy: 63/10000 (0.6300%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   1, Avg loss: 0.0528, Accuracy: 332/1071 (30.9991%)
_Train Local_ResNet_18, epoch  79, local model 55, internal_epoch   2, Avg loss: 0.0269, Accuracy: 578/1071 (53.9683%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.1897, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   1, Avg loss: 0.0535, Accuracy: 342/1372 (24.9271%)
_Train Local_ResNet_18, epoch  79, local model 42, internal_epoch   2, Avg loss: 0.0294, Accuracy: 601/1372 (43.8047%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.0135, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   1, Avg loss: 0.0831, Accuracy: 44/460 (9.5652%)
_Train Local_ResNet_18, epoch  79, local model 31, internal_epoch   2, Avg loss: 0.0350, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.1383, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   1, Avg loss: 0.0475, Accuracy: 366/599 (61.1018%)
_Train Local_ResNet_18, epoch  79, local model 95, internal_epoch   2, Avg loss: 0.0280, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 11.1777, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   1, Avg loss: 0.0450, Accuracy: 590/1470 (40.1361%)
_Train Local_ResNet_18, epoch  79, local model 22, internal_epoch   2, Avg loss: 0.0224, Accuracy: 946/1470 (64.3537%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.8838, Accuracy: 117/10000 (1.1700%)
time spent on training: 252.6649944782257
[rfa agg] training data poison_ratio: 0.18698913895420446  data num: [515, 928, 466, 1154, 896, 1071, 1372, 460, 599, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.05843410592318889
[rfa agg] init. name: [33, 1, 76, 57, 89, 55, 42, 31, 95, 22], weight: tensor([0.0577, 0.1039, 0.0522, 0.1292, 0.1003, 0.1199, 0.1536, 0.0515, 0.0671,
        0.1646])
[rfa agg] iter:  0, prev_obj_val: 45.91621398925781, obj_val: 50.164432525634766, abs dis: 4.248218536376953
[rfa agg] iter: 0, weight: tensor([0.0300, 0.2028, 0.0227, 0.0667, 0.4125, 0.1017, 0.0500, 0.0224, 0.0434,
        0.0477])
[rfa agg] iter:  1, prev_obj_val: 50.164432525634766, obj_val: 54.90614318847656, abs dis: 4.741710662841797
[rfa agg] iter: 1, weight: tensor([0.0510, 0.1712, 0.0371, 0.0763, 0.3243, 0.1054, 0.0608, 0.0367, 0.0786,
        0.0587])
[rfa agg] iter:  2, prev_obj_val: 54.90614318847656, obj_val: 59.735233306884766, abs dis: 4.829090118408203
[rfa agg] iter: 2, weight: tensor([0.0818, 0.1441, 0.0559, 0.0793, 0.2102, 0.1026, 0.0662, 0.0553, 0.1401,
        0.0645])
[rfa agg] iter:  3, prev_obj_val: 59.735233306884766, obj_val: 59.726863861083984, abs dis: 0.00836944580078125
[rfa agg] iter: 3, weight: tensor([0.1144, 0.1040, 0.0702, 0.0658, 0.1346, 0.0813, 0.0571, 0.0695, 0.2470,
        0.0560])
[rfa agg] iter:  4, prev_obj_val: 59.726863861083984, obj_val: 57.306556701660156, abs dis: 2.420307159423828
[rfa agg] iter: 4, weight: tensor([0.1141, 0.1032, 0.0699, 0.0654, 0.1334, 0.0807, 0.0567, 0.0691, 0.2520,
        0.0557])
[rfa agg] iter:  5, prev_obj_val: 57.306556701660156, obj_val: 59.72935485839844, abs dis: 2.4227981567382812
[rfa agg] iter: 5, weight: tensor([0.0983, 0.1248, 0.0641, 0.0743, 0.1693, 0.0937, 0.0633, 0.0633, 0.1870,
        0.0619])
[rfa agg] iter:  6, prev_obj_val: 59.72935485839844, obj_val: 59.72685623168945, abs dis: 0.002498626708984375
[rfa agg] iter: 6, weight: tensor([0.1143, 0.1036, 0.0701, 0.0656, 0.1340, 0.0810, 0.0569, 0.0693, 0.2493,
        0.0559])
[rfa agg] iter:  7, prev_obj_val: 59.72685623168945, obj_val: 57.306556701660156, abs dis: 2.420299530029297
[rfa agg] iter: 7, weight: tensor([0.1140, 0.1032, 0.0699, 0.0653, 0.1334, 0.0807, 0.0567, 0.0691, 0.2521,
        0.0556])
[rfa agg] iter:  8, prev_obj_val: 57.306556701660156, obj_val: 59.72935485839844, abs dis: 2.4227981567382812
[rfa agg] iter: 8, weight: tensor([0.0983, 0.1248, 0.0641, 0.0743, 0.1693, 0.0937, 0.0633, 0.0633, 0.1870,
        0.0619])
[rfa agg] iter:  9, prev_obj_val: 59.72935485839844, obj_val: 59.72685623168945, abs dis: 0.002498626708984375
[rfa agg] iter: 9, weight: tensor([0.1143, 0.1036, 0.0701, 0.0656, 0.1340, 0.0810, 0.0569, 0.0693, 0.2493,
        0.0559])
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3308, Accuracy: 87/10000 (0.8700%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 4.7071, Accuracy: 395/9950 (3.9698%)
saving model
Done in 516.3077683448792 sec.
Server Epoch:80 choose agents : [15, 82, 40, 18, 44, 37, 29, 63, 0, 22].
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   1, Avg loss: 0.0553, Accuracy: 374/1154 (32.4090%)
_Train Local_ResNet_18, epoch  80, local model 15, internal_epoch   2, Avg loss: 0.0272, Accuracy: 463/1154 (40.1213%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.0109, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   1, Avg loss: 0.0733, Accuracy: 110/500 (22.0000%)
_Train Local_ResNet_18, epoch  80, local model 82, internal_epoch   2, Avg loss: 0.0454, Accuracy: 246/500 (49.2000%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.4849, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   1, Avg loss: 0.0535, Accuracy: 408/1573 (25.9377%)
_Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   2, Avg loss: 0.0330, Accuracy: 607/1573 (38.5887%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.0118, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   1, Avg loss: 0.0700, Accuracy: 149/530 (28.1132%)
_Train Local_ResNet_18, epoch  80, local model 18, internal_epoch   2, Avg loss: 0.0356, Accuracy: 286/530 (53.9623%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.4999, Accuracy: 71/10000 (0.7100%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   1, Avg loss: 0.0560, Accuracy: 482/1750 (27.5429%)
_Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   2, Avg loss: 0.0333, Accuracy: 734/1750 (41.9429%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.5677, Accuracy: 123/10000 (1.2300%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   1, Avg loss: 0.0472, Accuracy: 534/1129 (47.2985%)
_Train Local_ResNet_18, epoch  80, local model 37, internal_epoch   2, Avg loss: 0.0215, Accuracy: 775/1129 (68.6448%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.5650, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   1, Avg loss: 0.0492, Accuracy: 448/1440 (31.1111%)
_Train Local_ResNet_18, epoch  80, local model 29, internal_epoch   2, Avg loss: 0.0254, Accuracy: 762/1440 (52.9167%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.1485, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   1, Avg loss: 0.0499, Accuracy: 285/888 (32.0946%)
_Train Local_ResNet_18, epoch  80, local model 63, internal_epoch   2, Avg loss: 0.0232, Accuracy: 496/888 (55.8559%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 10.0243, Accuracy: 92/10000 (0.9200%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   1, Avg loss: 0.0581, Accuracy: 343/1657 (20.7001%)
_Train Local_ResNet_18, epoch  80, local model 0, internal_epoch   2, Avg loss: 0.0324, Accuracy: 588/1657 (35.4858%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.2090, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   1, Avg loss: 0.0440, Accuracy: 627/1470 (42.6531%)
_Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   2, Avg loss: 0.0224, Accuracy: 929/1470 (63.1973%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 9.2541, Accuracy: 116/10000 (1.1600%)
time spent on training: 324.2281165122986
[rfa agg] training data poison_ratio: 0.47059796542883137  data num: [1154, 500, 1573, 530, 1750, 1129, 1440, 888, 1657, 1470]
[rfa agg] considering poison per batch poison_fraction: 0.1470618641965098
[rfa agg] init. name: [15, 82, 40, 18, 44, 37, 29, 63, 0, 22], weight: tensor([0.0954, 0.0414, 0.1301, 0.0438, 0.1447, 0.0934, 0.1191, 0.0734, 0.1370,
        0.1216])
[rfa agg] iter:  0, prev_obj_val: 47.66053009033203, obj_val: 51.31618118286133, abs dis: 3.655651092529297
[rfa agg] iter: 0, weight: tensor([0.3153, 0.0122, 0.0794, 0.0141, 0.0575, 0.1779, 0.1124, 0.0450, 0.0711,
        0.1151])
[rfa agg] iter:  1, prev_obj_val: 51.31618118286133, obj_val: 59.21003341674805, abs dis: 7.893852233886719
[rfa agg] iter: 1, weight: tensor([0.3334, 0.0119, 0.0597, 0.0139, 0.0457, 0.2737, 0.0783, 0.0487, 0.0547,
        0.0801])
[rfa agg] iter:  2, prev_obj_val: 59.21003341674805, obj_val: 56.31657409667969, abs dis: 2.8934593200683594
[rfa agg] iter: 2, weight: tensor([0.1910, 0.0195, 0.0685, 0.0232, 0.0556, 0.3081, 0.0833, 0.1013, 0.0643,
        0.0851])
[rfa agg] iter:  3, prev_obj_val: 56.31657409667969, obj_val: 56.309326171875, abs dis: 0.0072479248046875
[rfa agg] iter: 3, weight: tensor([0.1977, 0.0155, 0.0613, 0.0183, 0.0489, 0.3737, 0.0761, 0.0735, 0.0571,
        0.0778])
[rfa agg] iter:  4, prev_obj_val: 56.309326171875, obj_val: 59.19334030151367, abs dis: 2.884014129638672
[rfa agg] iter: 4, weight: tensor([0.1923, 0.0151, 0.0600, 0.0179, 0.0478, 0.3885, 0.0745, 0.0718, 0.0559,
        0.0761])
[rfa agg] iter:  5, prev_obj_val: 59.19334030151367, obj_val: 59.18815994262695, abs dis: 0.00518035888671875
[rfa agg] iter: 5, weight: tensor([0.1824, 0.0191, 0.0673, 0.0228, 0.0547, 0.3256, 0.0818, 0.0995, 0.0632,
        0.0836])
[rfa agg] iter:  6, prev_obj_val: 59.18815994262695, obj_val: 56.31492233276367, abs dis: 2.8732376098632812
[rfa agg] iter: 6, weight: tensor([0.1845, 0.0193, 0.0679, 0.0230, 0.0551, 0.3190, 0.0825, 0.1006, 0.0637,
        0.0843])
[rfa agg] iter:  7, prev_obj_val: 56.31492233276367, obj_val: 56.309207916259766, abs dis: 0.00571441650390625
[rfa agg] iter: 7, weight: tensor([0.1964, 0.0154, 0.0611, 0.0183, 0.0487, 0.3766, 0.0759, 0.0732, 0.0569,
        0.0775])
[rfa agg] iter:  8, prev_obj_val: 56.309207916259766, obj_val: 56.308902740478516, abs dis: 0.00030517578125
[rfa agg] iter: 8, weight: tensor([0.1920, 0.0151, 0.0599, 0.0179, 0.0478, 0.3893, 0.0744, 0.0717, 0.0558,
        0.0760])
[rfa agg] iter:  9, prev_obj_val: 56.308902740478516, obj_val: 59.19392013549805, abs dis: 2.8850173950195312
[rfa agg] iter: 9, weight: tensor([0.1906, 0.0151, 0.0596, 0.0178, 0.0476, 0.3926, 0.0740, 0.0714, 0.0556,
        0.0757])
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3270, Accuracy: 93/10000 (0.9300%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 4.7413, Accuracy: 362/9950 (3.6382%)
saving model
Done in 572.6927280426025 sec.
Server Epoch:81 choose agents : [62, 5, 56, 60, 10, 20, 90, 87, 72, 49].
_Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   1, Avg loss: 0.0669, Accuracy: 162/568 (28.5211%)
_Train Local_ResNet_18, epoch  81, local model 62, internal_epoch   2, Avg loss: 0.0379, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.1622, Accuracy: 65/10000 (0.6500%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   1, Avg loss: 0.0474, Accuracy: 492/1628 (30.2211%)
_Train Local_ResNet_18, epoch  81, local model 5, internal_epoch   2, Avg loss: 0.0228, Accuracy: 908/1628 (55.7740%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 9.2003, Accuracy: 143/10000 (1.4300%)
_Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   1, Avg loss: 0.0801, Accuracy: 4/186 (2.1505%)
_Train Local_ResNet_18, epoch  81, local model 56, internal_epoch   2, Avg loss: 0.0636, Accuracy: 85/186 (45.6989%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.4681, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0477, Accuracy: 722/2227 (32.4203%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0258, Accuracy: 1124/2227 (50.4715%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.4804, Accuracy: 130/10000 (1.3000%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   1, Avg loss: 0.0502, Accuracy: 312/861 (36.2369%)
_Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   2, Avg loss: 0.0180, Accuracy: 515/861 (59.8142%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.8078, Accuracy: 103/10000 (1.0300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   1, Avg loss: 0.0613, Accuracy: 269/807 (33.3333%)
_Train Local_ResNet_18, epoch  81, local model 20, internal_epoch   2, Avg loss: 0.0305, Accuracy: 421/807 (52.1685%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.2013, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   1, Avg loss: 0.0538, Accuracy: 314/677 (46.3811%)
_Train Local_ResNet_18, epoch  81, local model 90, internal_epoch   2, Avg loss: 0.0214, Accuracy: 445/677 (65.7312%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 10.3780, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   1, Avg loss: 0.0519, Accuracy: 342/1131 (30.2387%)
_Train Local_ResNet_18, epoch  81, local model 87, internal_epoch   2, Avg loss: 0.0294, Accuracy: 433/1131 (38.2847%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.3001, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   1, Avg loss: 0.0553, Accuracy: 329/1241 (26.5109%)
_Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   2, Avg loss: 0.0345, Accuracy: 451/1241 (36.3417%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.7809, Accuracy: 76/10000 (0.7600%)
poison local model 49 index 11 
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   1, Avg loss: 0.0739, Accuracy: 78/440 (17.7273%)
_Train Local_ResNet_18, epoch  81, local model 49, internal_epoch   2, Avg loss: 0.0437, Accuracy: 143/440 (32.5000%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.8425, Accuracy: 51/10000 (0.5100%)
time spent on training: 296.7504360675812
[rfa agg] training data poison_ratio: 0.38255171001433547  data num: [568, 1628, 186, 2227, 861, 807, 677, 1131, 1241, 440]
[rfa agg] considering poison per batch poison_fraction: 0.11954740937947983
[rfa agg] init. name: [62, 5, 56, 60, 10, 20, 90, 87, 72, 49], weight: tensor([0.0582, 0.1667, 0.0190, 0.2280, 0.0882, 0.0826, 0.0693, 0.1158, 0.1271,
        0.0451])
[rfa agg] iter:  0, prev_obj_val: 72.02421569824219, obj_val: 74.6971664428711, abs dis: 2.6729507446289062
[rfa agg] iter: 0, weight: tensor([0.0202, 0.0822, 0.0041, 0.0495, 0.0606, 0.0476, 0.0300, 0.3241, 0.3687,
        0.0130])
[rfa agg] iter:  1, prev_obj_val: 74.6971664428711, obj_val: 77.09698486328125, abs dis: 2.3998184204101562
[rfa agg] iter: 1, weight: tensor([0.0294, 0.0747, 0.0055, 0.0513, 0.1151, 0.0824, 0.0466, 0.4073, 0.1694,
        0.0183])
[rfa agg] iter:  2, prev_obj_val: 77.09698486328125, obj_val: 79.5949478149414, abs dis: 2.4979629516601562
[rfa agg] iter: 2, weight: tensor([0.0389, 0.0780, 0.0069, 0.0563, 0.1937, 0.1262, 0.0647, 0.2647, 0.1472,
        0.0235])
[rfa agg] iter:  3, prev_obj_val: 79.5949478149414, obj_val: 82.38957214355469, abs dis: 2.7946243286132812
[rfa agg] iter: 3, weight: tensor([0.0408, 0.0638, 0.0067, 0.0481, 0.3111, 0.1666, 0.0726, 0.1601, 0.1064,
        0.0238])
[rfa agg] iter:  4, prev_obj_val: 82.38957214355469, obj_val: 86.43083190917969, abs dis: 4.041259765625
[rfa agg] iter: 4, weight: tensor([0.0332, 0.0397, 0.0050, 0.0311, 0.4612, 0.2038, 0.0654, 0.0819, 0.0603,
        0.0184])
[rfa agg] iter:  5, prev_obj_val: 86.43083190917969, obj_val: 88.86773681640625, abs dis: 2.4369049072265625
[rfa agg] iter: 5, weight: tensor([0.0425, 0.0377, 0.0056, 0.0305, 0.2391, 0.4033, 0.0986, 0.0675, 0.0532,
        0.0221])
[rfa agg] iter:  6, prev_obj_val: 88.86773681640625, obj_val: 88.86400604248047, abs dis: 0.00373077392578125
[rfa agg] iter: 6, weight: tensor([0.0528, 0.0395, 0.0064, 0.0325, 0.1746, 0.4060, 0.1408, 0.0670, 0.0541,
        0.0262])
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3264, Accuracy: 91/10000 (0.9100%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 4.7460, Accuracy: 316/9950 (3.1759%)
saving model
Done in 543.8628721237183 sec.
Server Epoch:82 choose agents : [89, 71, 15, 22, 28, 59, 44, 72, 5, 64].
_Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   1, Avg loss: 0.0561, Accuracy: 332/896 (37.0536%)
_Train Local_ResNet_18, epoch  82, local model 89, internal_epoch   2, Avg loss: 0.0315, Accuracy: 464/896 (51.7857%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.4961, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   1, Avg loss: 0.0546, Accuracy: 276/818 (33.7408%)
_Train Local_ResNet_18, epoch  82, local model 71, internal_epoch   2, Avg loss: 0.0253, Accuracy: 440/818 (53.7897%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.2545, Accuracy: 104/10000 (1.0400%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   1, Avg loss: 0.0542, Accuracy: 379/1154 (32.8423%)
_Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   2, Avg loss: 0.0265, Accuracy: 574/1154 (49.7400%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.9484, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   1, Avg loss: 0.0446, Accuracy: 644/1470 (43.8095%)
_Train Local_ResNet_18, epoch  82, local model 22, internal_epoch   2, Avg loss: 0.0223, Accuracy: 907/1470 (61.7007%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.9010, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   1, Avg loss: 0.0543, Accuracy: 427/1581 (27.0082%)
_Train Local_ResNet_18, epoch  82, local model 28, internal_epoch   2, Avg loss: 0.0311, Accuracy: 669/1581 (42.3150%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.9805, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0557, Accuracy: 352/1089 (32.3232%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0273, Accuracy: 506/1089 (46.4646%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 10.7895, Accuracy: 91/10000 (0.9100%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   1, Avg loss: 0.0560, Accuracy: 427/1750 (24.4000%)
_Train Local_ResNet_18, epoch  82, local model 44, internal_epoch   2, Avg loss: 0.0324, Accuracy: 774/1750 (44.2286%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.5512, Accuracy: 135/10000 (1.3500%)
_Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   1, Avg loss: 0.0551, Accuracy: 317/1241 (25.5439%)
_Train Local_ResNet_18, epoch  82, local model 72, internal_epoch   2, Avg loss: 0.0339, Accuracy: 509/1241 (41.0153%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.6572, Accuracy: 75/10000 (0.7500%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   1, Avg loss: 0.0468, Accuracy: 546/1628 (33.5381%)
_Train Local_ResNet_18, epoch  82, local model 5, internal_epoch   2, Avg loss: 0.0224, Accuracy: 972/1628 (59.7052%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 9.1829, Accuracy: 155/10000 (1.5500%)
_Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   1, Avg loss: 0.0582, Accuracy: 241/953 (25.2886%)
_Train Local_ResNet_18, epoch  82, local model 64, internal_epoch   2, Avg loss: 0.0345, Accuracy: 371/953 (38.9297%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.6588, Accuracy: 80/10000 (0.8000%)
time spent on training: 307.9795780181885
[rfa agg] training data poison_ratio: 0.3602543720190779  data num: [896, 818, 1154, 1470, 1581, 1089, 1750, 1241, 1628, 953]
[rfa agg] considering poison per batch poison_fraction: 0.11257949125596184
[rfa agg] init. name: [89, 71, 15, 22, 28, 59, 44, 72, 5, 64], weight: tensor([0.0712, 0.0650, 0.0917, 0.1169, 0.1257, 0.0866, 0.1391, 0.0986, 0.1294,
        0.0758])
[rfa agg] iter:  0, prev_obj_val: 44.48308181762695, obj_val: 50.90929412841797, abs dis: 6.426212310791016
[rfa agg] iter: 0, weight: tensor([0.0448, 0.0336, 0.2672, 0.0731, 0.0549, 0.2044, 0.0418, 0.1702, 0.0491,
        0.0609])
[rfa agg] iter:  1, prev_obj_val: 50.90929412841797, obj_val: 53.37623596191406, abs dis: 2.4669418334960938
[rfa agg] iter: 1, weight: tensor([0.0840, 0.0584, 0.1579, 0.0702, 0.0570, 0.2265, 0.0460, 0.1172, 0.0522,
        0.1306])
[rfa agg] iter:  2, prev_obj_val: 53.37623596191406, obj_val: 55.9144172668457, abs dis: 2.5381813049316406
[rfa agg] iter: 2, weight: tensor([0.1047, 0.0695, 0.1334, 0.0680, 0.0562, 0.1872, 0.0460, 0.1055, 0.0518,
        0.1777])
[rfa agg] iter:  3, prev_obj_val: 55.9144172668457, obj_val: 55.90795135498047, abs dis: 0.006465911865234375
[rfa agg] iter: 3, weight: tensor([0.1260, 0.0789, 0.1102, 0.0618, 0.0519, 0.1452, 0.0432, 0.0907, 0.0481,
        0.2441])
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3265, Accuracy: 95/10000 (0.9500%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 4.6692, Accuracy: 528/9950 (5.3065%)
saving model
Done in 554.611058473587 sec.
Server Epoch:83 choose agents : [44, 18, 70, 97, 43, 93, 72, 24, 56, 94].
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1, Avg loss: 0.0553, Accuracy: 479/1750 (27.3714%)
_Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2, Avg loss: 0.0334, Accuracy: 750/1750 (42.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.5017, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   1, Avg loss: 0.0681, Accuracy: 151/530 (28.4906%)
_Train Local_ResNet_18, epoch  83, local model 18, internal_epoch   2, Avg loss: 0.0365, Accuracy: 287/530 (54.1509%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.5055, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   1, Avg loss: 0.0524, Accuracy: 516/1418 (36.3893%)
_Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   2, Avg loss: 0.0277, Accuracy: 714/1418 (50.3526%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.8675, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   1, Avg loss: 0.0464, Accuracy: 411/1213 (33.8829%)
_Train Local_ResNet_18, epoch  83, local model 97, internal_epoch   2, Avg loss: 0.0252, Accuracy: 567/1213 (46.7436%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 9.4360, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0627, Accuracy: 283/946 (29.9154%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0328, Accuracy: 390/946 (41.2262%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.6786, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   1, Avg loss: 0.0535, Accuracy: 441/1742 (25.3157%)
_Train Local_ResNet_18, epoch  83, local model 93, internal_epoch   2, Avg loss: 0.0298, Accuracy: 775/1742 (44.4891%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.3699, Accuracy: 113/10000 (1.1300%)
_Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   1, Avg loss: 0.0544, Accuracy: 356/1241 (28.6865%)
_Train Local_ResNet_18, epoch  83, local model 72, internal_epoch   2, Avg loss: 0.0336, Accuracy: 499/1241 (40.2095%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.8925, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   1, Avg loss: 0.0757, Accuracy: 42/312 (13.4615%)
_Train Local_ResNet_18, epoch  83, local model 24, internal_epoch   2, Avg loss: 0.0377, Accuracy: 193/312 (61.8590%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 7.0794, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   1, Avg loss: 0.0788, Accuracy: 5/186 (2.6882%)
_Train Local_ResNet_18, epoch  83, local model 56, internal_epoch   2, Avg loss: 0.0622, Accuracy: 91/186 (48.9247%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.4719, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1, Avg loss: 0.0541, Accuracy: 442/1662 (26.5945%)
_Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2, Avg loss: 0.0303, Accuracy: 710/1662 (42.7196%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.1101, Accuracy: 121/10000 (1.2100%)
time spent on training: 259.69280791282654
[rfa agg] training data poison_ratio: 0.1590909090909091  data num: [1750, 530, 1418, 1213, 946, 1742, 1241, 312, 186, 1662]
[rfa agg] considering poison per batch poison_fraction: 0.04971590909090909
[rfa agg] init. name: [44, 18, 70, 97, 43, 93, 72, 24, 56, 94], weight: tensor([0.1591, 0.0482, 0.1289, 0.1103, 0.0860, 0.1584, 0.1128, 0.0284, 0.0169,
        0.1511])
[rfa agg] iter:  0, prev_obj_val: 55.28031539916992, obj_val: 57.60307693481445, abs dis: 2.3227615356445312
[rfa agg] iter: 0, weight: tensor([0.0502, 0.0137, 0.0903, 0.3994, 0.0604, 0.0500, 0.2659, 0.0058, 0.0030,
        0.0612])
[rfa agg] iter:  1, prev_obj_val: 57.60307693481445, obj_val: 60.32612609863281, abs dis: 2.7230491638183594
[rfa agg] iter: 1, weight: tensor([0.0506, 0.0154, 0.0857, 0.4443, 0.0730, 0.0504, 0.2100, 0.0064, 0.0033,
        0.0608])
[rfa agg] iter:  2, prev_obj_val: 60.32612609863281, obj_val: 55.122047424316406, abs dis: 5.204078674316406
[rfa agg] iter: 2, weight: tensor([0.0601, 0.0203, 0.0964, 0.3722, 0.1055, 0.0598, 0.2019, 0.0083, 0.0043,
        0.0712])
[rfa agg] iter:  3, prev_obj_val: 55.122047424316406, obj_val: 57.59758758544922, abs dis: 2.4755401611328125
[rfa agg] iter: 3, weight: tensor([0.0435, 0.0119, 0.0782, 0.4787, 0.0524, 0.0434, 0.2312, 0.0050, 0.0026,
        0.0530])
[rfa agg] iter:  4, prev_obj_val: 57.59758758544922, obj_val: 57.59638977050781, abs dis: 0.00119781494140625
[rfa agg] iter: 4, weight: tensor([0.0491, 0.0149, 0.0830, 0.4643, 0.0707, 0.0489, 0.2007, 0.0062, 0.0032,
        0.0590])
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3277, Accuracy: 92/10000 (0.9200%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 4.7111, Accuracy: 244/9950 (2.4523%)
saving model
Done in 501.82167410850525 sec.
Server Epoch:84 choose agents : [16, 36, 51, 77, 39, 2, 42, 68, 53, 88].
_Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   1, Avg loss: 0.0600, Accuracy: 284/708 (40.1130%)
_Train Local_ResNet_18, epoch  84, local model 16, internal_epoch   2, Avg loss: 0.0316, Accuracy: 442/708 (62.4294%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.6357, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   1, Avg loss: 0.0827, Accuracy: 43/408 (10.5392%)
_Train Local_ResNet_18, epoch  84, local model 36, internal_epoch   2, Avg loss: 0.0469, Accuracy: 155/408 (37.9902%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.0939, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   1, Avg loss: 0.0545, Accuracy: 280/1049 (26.6921%)
_Train Local_ResNet_18, epoch  84, local model 51, internal_epoch   2, Avg loss: 0.0252, Accuracy: 602/1049 (57.3880%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.5428, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   1, Avg loss: 0.0486, Accuracy: 381/1340 (28.4328%)
_Train Local_ResNet_18, epoch  84, local model 77, internal_epoch   2, Avg loss: 0.0238, Accuracy: 663/1340 (49.4776%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.9307, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   1, Avg loss: 0.0497, Accuracy: 328/1013 (32.3791%)
_Train Local_ResNet_18, epoch  84, local model 39, internal_epoch   2, Avg loss: 0.0239, Accuracy: 546/1013 (53.8993%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.5523, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0646, Accuracy: 211/605 (34.8760%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0389, Accuracy: 328/605 (54.2149%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.1518, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 352/1372 (25.6560%)
_Train Local_ResNet_18, epoch  84, local model 42, internal_epoch   2, Avg loss: 0.0290, Accuracy: 583/1372 (42.4927%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.4611, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   1, Avg loss: 0.0605, Accuracy: 357/1163 (30.6965%)
_Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   2, Avg loss: 0.0342, Accuracy: 537/1163 (46.1737%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.5854, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   1, Avg loss: 0.0461, Accuracy: 304/813 (37.3924%)
_Train Local_ResNet_18, epoch  84, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 502/813 (61.7466%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 12.4204, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   1, Avg loss: 0.0698, Accuracy: 154/603 (25.5390%)
_Train Local_ResNet_18, epoch  84, local model 88, internal_epoch   2, Avg loss: 0.0423, Accuracy: 295/603 (48.9221%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.4465, Accuracy: 50/10000 (0.5000%)
time spent on training: 253.18607926368713
[rfa agg] training data poison_ratio: 0.0  data num: [708, 408, 1049, 1340, 1013, 605, 1372, 1163, 813, 603]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [16, 36, 51, 77, 39, 2, 42, 68, 53, 88], weight: tensor([0.0780, 0.0450, 0.1156, 0.1477, 0.1116, 0.0667, 0.1512, 0.1282, 0.0896,
        0.0665])
[rfa agg] iter:  0, prev_obj_val: 42.7360725402832, obj_val: 44.25859069824219, abs dis: 1.5225181579589844
[rfa agg] iter: 0, weight: tensor([0.1383, 0.0197, 0.0913, 0.0561, 0.1233, 0.0539, 0.0507, 0.0660, 0.3468,
        0.0538])
[rfa agg] iter:  1, prev_obj_val: 44.25859069824219, obj_val: 54.10633087158203, abs dis: 9.847740173339844
[rfa agg] iter: 1, weight: tensor([0.1458, 0.0159, 0.0600, 0.0392, 0.0773, 0.0467, 0.0357, 0.0452, 0.4875,
        0.0467])
[rfa agg] iter:  2, prev_obj_val: 54.10633087158203, obj_val: 63.84553527832031, abs dis: 9.739204406738281
[rfa agg] iter: 2, weight: tensor([0.2079, 0.0340, 0.0579, 0.0449, 0.0673, 0.1785, 0.0418, 0.0486, 0.1350,
        0.1842])
[rfa agg] iter:  3, prev_obj_val: 63.84553527832031, obj_val: 63.8226203918457, abs dis: 0.022914886474609375
[rfa agg] iter: 3, weight: tensor([0.0871, 0.0504, 0.0435, 0.0364, 0.0485, 0.2858, 0.0343, 0.0382, 0.0721,
        0.3035])
[rfa agg] iter:  4, prev_obj_val: 63.8226203918457, obj_val: 67.81527709960938, abs dis: 3.992656707763672
[rfa agg] iter: 4, weight: tensor([0.0833, 0.0487, 0.0419, 0.0351, 0.0467, 0.2955, 0.0331, 0.0368, 0.0694,
        0.3095])
[rfa agg] iter:  5, prev_obj_val: 67.81527709960938, obj_val: 67.81244659423828, abs dis: 0.00283050537109375
[rfa agg] iter: 5, weight: tensor([0.0971, 0.0839, 0.0545, 0.0467, 0.0603, 0.2387, 0.0442, 0.0486, 0.0845,
        0.2415])
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3258, Accuracy: 88/10000 (0.8800%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 4.7388, Accuracy: 246/9950 (2.4724%)
saving model
Done in 498.13539934158325 sec.
Server Epoch:85 choose agents : [30, 92, 55, 31, 64, 72, 67, 34, 45, 53].
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   1, Avg loss: 0.0710, Accuracy: 117/486 (24.0741%)
_Train Local_ResNet_18, epoch  85, local model 30, internal_epoch   2, Avg loss: 0.0351, Accuracy: 231/486 (47.5309%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.3234, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 503/1715 (29.3294%)
_Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   2, Avg loss: 0.0280, Accuracy: 844/1715 (49.2128%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.1403, Accuracy: 105/10000 (1.0500%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   1, Avg loss: 0.0529, Accuracy: 341/1071 (31.8394%)
_Train Local_ResNet_18, epoch  85, local model 55, internal_epoch   2, Avg loss: 0.0270, Accuracy: 570/1071 (53.2213%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 9.1334, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1, Avg loss: 0.0827, Accuracy: 48/460 (10.4348%)
_Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2, Avg loss: 0.0379, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 8.3295, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1, Avg loss: 0.0569, Accuracy: 247/953 (25.9182%)
_Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2, Avg loss: 0.0346, Accuracy: 340/953 (35.6768%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.8689, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   1, Avg loss: 0.0540, Accuracy: 347/1241 (27.9613%)
_Train Local_ResNet_18, epoch  85, local model 72, internal_epoch   2, Avg loss: 0.0341, Accuracy: 470/1241 (37.8727%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.8453, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   1, Avg loss: 0.0725, Accuracy: 85/426 (19.9531%)
_Train Local_ResNet_18, epoch  85, local model 67, internal_epoch   2, Avg loss: 0.0384, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.3504, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   1, Avg loss: 0.0569, Accuracy: 433/1427 (30.3434%)
_Train Local_ResNet_18, epoch  85, local model 34, internal_epoch   2, Avg loss: 0.0307, Accuracy: 642/1427 (44.9895%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.9094, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   1, Avg loss: 0.0617, Accuracy: 231/669 (34.5291%)
_Train Local_ResNet_18, epoch  85, local model 45, internal_epoch   2, Avg loss: 0.0360, Accuracy: 364/669 (54.4096%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.6654, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   1, Avg loss: 0.0446, Accuracy: 319/813 (39.2374%)
_Train Local_ResNet_18, epoch  85, local model 53, internal_epoch   2, Avg loss: 0.0181, Accuracy: 501/813 (61.6236%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 12.8620, Accuracy: 65/10000 (0.6500%)
time spent on training: 259.24146604537964
[rfa agg] training data poison_ratio: 0.16812439261418854  data num: [486, 1715, 1071, 460, 953, 1241, 426, 1427, 669, 813]
[rfa agg] considering poison per batch poison_fraction: 0.05253887269193392
[rfa agg] init. name: [30, 92, 55, 31, 64, 72, 67, 34, 45, 53], weight: tensor([0.0525, 0.1852, 0.1156, 0.0497, 0.1029, 0.1340, 0.0460, 0.1541, 0.0722,
        0.0878])
[rfa agg] iter:  0, prev_obj_val: 52.688419342041016, obj_val: 56.741371154785156, abs dis: 4.052951812744141
[rfa agg] iter: 0, weight: tensor([0.0205, 0.0473, 0.2016, 0.0194, 0.4013, 0.0867, 0.0159, 0.0601, 0.0467,
        0.1005])
[rfa agg] iter:  1, prev_obj_val: 56.741371154785156, obj_val: 60.388553619384766, abs dis: 3.6471824645996094
[rfa agg] iter: 1, weight: tensor([0.0282, 0.0459, 0.1211, 0.0266, 0.3100, 0.0716, 0.0212, 0.0550, 0.0760,
        0.2444])
[rfa agg] iter:  2, prev_obj_val: 60.388553619384766, obj_val: 65.11712646484375, abs dis: 4.728572845458984
[rfa agg] iter: 2, weight: tensor([0.0281, 0.0355, 0.0763, 0.0266, 0.1354, 0.0512, 0.0206, 0.0413, 0.0929,
        0.4922])
[rfa agg] iter:  3, prev_obj_val: 65.11712646484375, obj_val: 70.29668426513672, abs dis: 5.179557800292969
[rfa agg] iter: 3, weight: tensor([0.0467, 0.0442, 0.0818, 0.0442, 0.1210, 0.0599, 0.0328, 0.0501, 0.2189,
        0.3004])
[rfa agg] iter:  4, prev_obj_val: 70.29668426513672, obj_val: 76.31702423095703, abs dis: 6.0203399658203125
[rfa agg] iter: 4, weight: tensor([0.0561, 0.0374, 0.0619, 0.0529, 0.0827, 0.0481, 0.0370, 0.0415, 0.4433,
        0.1390])
[rfa agg] iter:  5, prev_obj_val: 76.31702423095703, obj_val: 73.21873474121094, abs dis: 3.0982894897460938
[rfa agg] iter: 5, weight: tensor([0.1095, 0.0464, 0.0701, 0.1024, 0.0873, 0.0571, 0.0647, 0.0505, 0.2892,
        0.1228])
[rfa agg] iter:  6, prev_obj_val: 73.21873474121094, obj_val: 67.60926055908203, abs dis: 5.609474182128906
[rfa agg] iter: 6, weight: tensor([0.0766, 0.0413, 0.0651, 0.0721, 0.0838, 0.0519, 0.0482, 0.0454, 0.3889,
        0.1267])
[rfa agg] iter:  7, prev_obj_val: 67.60926055908203, obj_val: 70.25387573242188, abs dis: 2.6446151733398438
[rfa agg] iter: 7, weight: tensor([0.0501, 0.0401, 0.0700, 0.0472, 0.0978, 0.0529, 0.0342, 0.0449, 0.3779,
        0.1848])
[rfa agg] iter:  8, prev_obj_val: 70.25387573242188, obj_val: 76.3267593383789, abs dis: 6.072883605957031
[rfa agg] iter: 8, weight: tensor([0.0502, 0.0335, 0.0553, 0.0473, 0.0739, 0.0430, 0.0331, 0.0371, 0.5036,
        0.1231])
[rfa agg] iter:  9, prev_obj_val: 76.3267593383789, obj_val: 73.21843719482422, abs dis: 3.1083221435546875
[rfa agg] iter: 9, weight: tensor([0.1090, 0.0463, 0.0698, 0.1018, 0.0871, 0.0569, 0.0644, 0.0503, 0.2921,
        0.1223])
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3243, Accuracy: 92/10000 (0.9200%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 4.7271, Accuracy: 271/9950 (2.7236%)
saving model
Done in 509.60199332237244 sec.
Server Epoch:86 choose agents : [2, 18, 97, 3, 99, 22, 44, 9, 74, 92].
_Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   1, Avg loss: 0.0629, Accuracy: 211/605 (34.8760%)
_Train Local_ResNet_18, epoch  86, local model 2, internal_epoch   2, Avg loss: 0.0376, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.8698, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   1, Avg loss: 0.0675, Accuracy: 180/530 (33.9623%)
_Train Local_ResNet_18, epoch  86, local model 18, internal_epoch   2, Avg loss: 0.0358, Accuracy: 298/530 (56.2264%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.3525, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   1, Avg loss: 0.0436, Accuracy: 466/1213 (38.4171%)
_Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   2, Avg loss: 0.0238, Accuracy: 658/1213 (54.2457%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.9912, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1, Avg loss: 0.0635, Accuracy: 170/781 (21.7670%)
_Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2, Avg loss: 0.0323, Accuracy: 295/781 (37.7721%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.0418, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   1, Avg loss: 0.0552, Accuracy: 280/773 (36.2225%)
_Train Local_ResNet_18, epoch  86, local model 99, internal_epoch   2, Avg loss: 0.0260, Accuracy: 457/773 (59.1203%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.6438, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   1, Avg loss: 0.0438, Accuracy: 619/1470 (42.1088%)
_Train Local_ResNet_18, epoch  86, local model 22, internal_epoch   2, Avg loss: 0.0220, Accuracy: 926/1470 (62.9932%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.0133, Accuracy: 120/10000 (1.2000%)
poison local model 44 index 10 
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0552, Accuracy: 469/1750 (26.8000%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0327, Accuracy: 793/1750 (45.3143%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.8762, Accuracy: 132/10000 (1.3200%)
_Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   1, Avg loss: 0.0430, Accuracy: 460/1275 (36.0784%)
_Train Local_ResNet_18, epoch  86, local model 9, internal_epoch   2, Avg loss: 0.0168, Accuracy: 787/1275 (61.7255%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 10.6715, Accuracy: 123/10000 (1.2300%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   1, Avg loss: 0.0429, Accuracy: 565/1552 (36.4046%)
_Train Local_ResNet_18, epoch  86, local model 74, internal_epoch   2, Avg loss: 0.0194, Accuracy: 877/1552 (56.5077%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 11.5262, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 529/1715 (30.8455%)
_Train Local_ResNet_18, epoch  86, local model 92, internal_epoch   2, Avg loss: 0.0283, Accuracy: 792/1715 (46.1808%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.9965, Accuracy: 105/10000 (1.0500%)
time spent on training: 285.0803792476654
[rfa agg] training data poison_ratio: 0.28309327846364885  data num: [605, 530, 1213, 781, 773, 1470, 1750, 1275, 1552, 1715]
[rfa agg] considering poison per batch poison_fraction: 0.08846664951989026
[rfa agg] init. name: [2, 18, 97, 3, 99, 22, 44, 9, 74, 92], weight: tensor([0.0519, 0.0454, 0.1040, 0.0670, 0.0663, 0.1260, 0.1500, 0.1093, 0.1331,
        0.1470])
[rfa agg] iter:  0, prev_obj_val: 56.04765319824219, obj_val: 55.988731384277344, abs dis: 0.05892181396484375
[rfa agg] iter: 0, weight: tensor([0.0256, 0.0200, 0.3517, 0.0526, 0.0521, 0.0986, 0.0593, 0.2007, 0.0749,
        0.0645])
[rfa agg] iter:  1, prev_obj_val: 55.988731384277344, obj_val: 58.337745666503906, abs dis: 2.3490142822265625
[rfa agg] iter: 1, weight: tensor([0.0249, 0.0194, 0.3667, 0.0512, 0.0507, 0.0959, 0.0576, 0.1983, 0.0727,
        0.0626])
[rfa agg] iter:  2, prev_obj_val: 58.337745666503906, obj_val: 60.70656967163086, abs dis: 2.368824005126953
[rfa agg] iter: 2, weight: tensor([0.0313, 0.0243, 0.3028, 0.0668, 0.0662, 0.1029, 0.0647, 0.1909, 0.0801,
        0.0700])
[rfa agg] iter:  3, prev_obj_val: 60.70656967163086, obj_val: 58.33687973022461, abs dis: 2.36968994140625
[rfa agg] iter: 3, weight: tensor([0.0374, 0.0287, 0.2563, 0.0836, 0.0828, 0.1053, 0.0688, 0.1793, 0.0837,
        0.0741])
[rfa agg] iter:  4, prev_obj_val: 58.33687973022461, obj_val: 60.70648193359375, abs dis: 2.3696022033691406
[rfa agg] iter: 4, weight: tensor([0.0315, 0.0243, 0.3001, 0.0672, 0.0665, 0.1033, 0.0650, 0.1914, 0.0804,
        0.0703])
[rfa agg] iter:  5, prev_obj_val: 60.70648193359375, obj_val: 58.33687973022461, abs dis: 2.3696022033691406
[rfa agg] iter: 5, weight: tensor([0.0374, 0.0287, 0.2562, 0.0836, 0.0828, 0.1053, 0.0688, 0.1793, 0.0837,
        0.0741])
[rfa agg] iter:  6, prev_obj_val: 58.33687973022461, obj_val: 60.70648193359375, abs dis: 2.3696022033691406
[rfa agg] iter: 6, weight: tensor([0.0315, 0.0243, 0.3001, 0.0672, 0.0665, 0.1033, 0.0650, 0.1914, 0.0804,
        0.0703])
[rfa agg] iter:  7, prev_obj_val: 60.70648193359375, obj_val: 58.33687973022461, abs dis: 2.3696022033691406
[rfa agg] iter: 7, weight: tensor([0.0374, 0.0287, 0.2562, 0.0836, 0.0828, 0.1053, 0.0688, 0.1793, 0.0837,
        0.0741])
[rfa agg] iter:  8, prev_obj_val: 58.33687973022461, obj_val: 60.70648193359375, abs dis: 2.3696022033691406
[rfa agg] iter: 8, weight: tensor([0.0315, 0.0243, 0.3001, 0.0672, 0.0665, 0.1033, 0.0650, 0.1914, 0.0804,
        0.0703])
[rfa agg] iter:  9, prev_obj_val: 60.70648193359375, obj_val: 58.33687973022461, abs dis: 2.3696022033691406
[rfa agg] iter: 9, weight: tensor([0.0374, 0.0287, 0.2562, 0.0836, 0.0828, 0.1053, 0.0688, 0.1793, 0.0837,
        0.0741])
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3243, Accuracy: 88/10000 (0.8800%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 4.7643, Accuracy: 124/9950 (1.2462%)
saving model
Done in 531.9112854003906 sec.
Server Epoch:87 choose agents : [27, 69, 68, 61, 71, 23, 41, 98, 94, 52].
_Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   1, Avg loss: 0.0566, Accuracy: 405/1587 (25.5198%)
_Train Local_ResNet_18, epoch  87, local model 27, internal_epoch   2, Avg loss: 0.0316, Accuracy: 678/1587 (42.7221%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.8322, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0610, Accuracy: 268/590 (45.4237%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0332, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 11.2075, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   1, Avg loss: 0.0606, Accuracy: 358/1163 (30.7825%)
_Train Local_ResNet_18, epoch  87, local model 68, internal_epoch   2, Avg loss: 0.0345, Accuracy: 501/1163 (43.0782%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.8165, Accuracy: 83/10000 (0.8300%)
poison local model 61 index 13 
_Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   1, Avg loss: 0.1289, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 61, internal_epoch   2, Avg loss: 0.1198, Accuracy: 0/85 (0.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3321, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   1, Avg loss: 0.0549, Accuracy: 266/818 (32.5183%)
_Train Local_ResNet_18, epoch  87, local model 71, internal_epoch   2, Avg loss: 0.0259, Accuracy: 445/818 (54.4010%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 9.0409, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   1, Avg loss: 0.0606, Accuracy: 323/715 (45.1748%)
_Train Local_ResNet_18, epoch  87, local model 23, internal_epoch   2, Avg loss: 0.0338, Accuracy: 440/715 (61.5385%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.2681, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   1, Avg loss: 0.0555, Accuracy: 313/719 (43.5327%)
_Train Local_ResNet_18, epoch  87, local model 41, internal_epoch   2, Avg loss: 0.0293, Accuracy: 440/719 (61.1961%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.1746, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   1, Avg loss: 0.0759, Accuracy: 54/373 (14.4772%)
_Train Local_ResNet_18, epoch  87, local model 98, internal_epoch   2, Avg loss: 0.0442, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.1060, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   1, Avg loss: 0.0532, Accuracy: 433/1662 (26.0529%)
_Train Local_ResNet_18, epoch  87, local model 94, internal_epoch   2, Avg loss: 0.0304, Accuracy: 676/1662 (40.6739%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.1350, Accuracy: 133/10000 (1.3300%)
_Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   1, Avg loss: 0.0494, Accuracy: 317/636 (49.8428%)
_Train Local_ResNet_18, epoch  87, local model 52, internal_epoch   2, Avg loss: 0.0256, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.6645, Accuracy: 66/10000 (0.6600%)
time spent on training: 250.63448786735535
[rfa agg] training data poison_ratio: 0.010182079540009582  data num: [1587, 590, 1163, 85, 818, 715, 719, 373, 1662, 636]
[rfa agg] considering poison per batch poison_fraction: 0.0031818998562529945
[rfa agg] init. name: [27, 69, 68, 61, 71, 23, 41, 98, 94, 52], weight: tensor([0.1901, 0.0707, 0.1393, 0.0102, 0.0980, 0.0856, 0.0861, 0.0447, 0.1991,
        0.0762])
[rfa agg] iter:  0, prev_obj_val: 59.16281509399414, obj_val: 59.97453689575195, abs dis: 0.8117218017578125
[rfa agg] iter: 0, weight: tensor([0.1109, 0.0618, 0.2377, 0.0038, 0.1684, 0.1109, 0.1119, 0.0235, 0.1045,
        0.0665])
[rfa agg] iter:  1, prev_obj_val: 59.97453689575195, obj_val: 62.317726135253906, abs dis: 2.343189239501953
[rfa agg] iter: 1, weight: tensor([0.0780, 0.0673, 0.1324, 0.0035, 0.2624, 0.1428, 0.1440, 0.0227, 0.0745,
        0.0725])
[rfa agg] iter:  2, prev_obj_val: 62.317726135253906, obj_val: 68.55300903320312, abs dis: 6.235282897949219
[rfa agg] iter: 2, weight: tensor([0.0325, 0.0590, 0.0456, 0.0021, 0.2924, 0.2245, 0.2341, 0.0147, 0.0315,
        0.0636])
[rfa agg] iter:  3, prev_obj_val: 68.55300903320312, obj_val: 74.2138671875, abs dis: 5.660858154296875
[rfa agg] iter: 3, weight: tensor([0.0359, 0.1603, 0.0459, 0.0030, 0.1258, 0.1950, 0.1996, 0.0236, 0.0351,
        0.1758])
[rfa agg] iter:  4, prev_obj_val: 74.2138671875, obj_val: 77.74565124511719, abs dis: 3.5317840576171875
[rfa agg] iter: 4, weight: tensor([0.0276, 0.2962, 0.0336, 0.0028, 0.0697, 0.0896, 0.0904, 0.0242, 0.0271,
        0.3387])
[rfa agg] iter:  5, prev_obj_val: 77.74565124511719, obj_val: 77.74524688720703, abs dis: 0.00040435791015625
[rfa agg] iter: 5, weight: tensor([0.0332, 0.2839, 0.0397, 0.0037, 0.0746, 0.0900, 0.0905, 0.0345, 0.0327,
        0.3173])
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3232, Accuracy: 89/10000 (0.8900%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 4.7861, Accuracy: 125/9950 (1.2563%)
saving model
Done in 494.7105059623718 sec.
Server Epoch:88 choose agents : [48, 70, 99, 34, 64, 81, 0, 53, 31, 56].
_Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   1, Avg loss: 0.0660, Accuracy: 209/631 (33.1220%)
_Train Local_ResNet_18, epoch  88, local model 48, internal_epoch   2, Avg loss: 0.0382, Accuracy: 296/631 (46.9097%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.2444, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   1, Avg loss: 0.0521, Accuracy: 524/1418 (36.9535%)
_Train Local_ResNet_18, epoch  88, local model 70, internal_epoch   2, Avg loss: 0.0277, Accuracy: 722/1418 (50.9168%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0525, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   1, Avg loss: 0.0535, Accuracy: 290/773 (37.5162%)
_Train Local_ResNet_18, epoch  88, local model 99, internal_epoch   2, Avg loss: 0.0304, Accuracy: 450/773 (58.2147%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.2738, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   1, Avg loss: 0.0563, Accuracy: 415/1427 (29.0820%)
_Train Local_ResNet_18, epoch  88, local model 34, internal_epoch   2, Avg loss: 0.0305, Accuracy: 665/1427 (46.6013%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.8516, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   1, Avg loss: 0.0563, Accuracy: 249/953 (26.1280%)
_Train Local_ResNet_18, epoch  88, local model 64, internal_epoch   2, Avg loss: 0.0341, Accuracy: 368/953 (38.6149%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.5754, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   1, Avg loss: 0.0613, Accuracy: 247/774 (31.9121%)
_Train Local_ResNet_18, epoch  88, local model 81, internal_epoch   2, Avg loss: 0.0342, Accuracy: 350/774 (45.2196%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0690, Accuracy: 83/10000 (0.8300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   1, Avg loss: 0.0575, Accuracy: 357/1657 (21.5450%)
_Train Local_ResNet_18, epoch  88, local model 0, internal_epoch   2, Avg loss: 0.0326, Accuracy: 572/1657 (34.5202%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.1394, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   1, Avg loss: 0.0443, Accuracy: 339/813 (41.6974%)
_Train Local_ResNet_18, epoch  88, local model 53, internal_epoch   2, Avg loss: 0.0177, Accuracy: 497/813 (61.1316%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 12.7089, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   1, Avg loss: 0.0812, Accuracy: 46/460 (10.0000%)
_Train Local_ResNet_18, epoch  88, local model 31, internal_epoch   2, Avg loss: 0.0360, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.5838, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   1, Avg loss: 0.0797, Accuracy: 4/186 (2.1505%)
_Train Local_ResNet_18, epoch  88, local model 56, internal_epoch   2, Avg loss: 0.0633, Accuracy: 83/186 (44.6237%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.4643, Accuracy: 50/10000 (0.5000%)
time spent on training: 253.46913838386536
[rfa agg] training data poison_ratio: 0.18224813022437308  data num: [631, 1418, 773, 1427, 953, 774, 1657, 813, 460, 186]
[rfa agg] considering poison per batch poison_fraction: 0.056952540695116585
[rfa agg] init. name: [48, 70, 99, 34, 64, 81, 0, 53, 31, 56], weight: tensor([0.0694, 0.1560, 0.0850, 0.1570, 0.1048, 0.0851, 0.1822, 0.0894, 0.0506,
        0.0205])
[rfa agg] iter:  0, prev_obj_val: 53.99782180786133, obj_val: 58.593379974365234, abs dis: 4.595558166503906
[rfa agg] iter: 0, weight: tensor([0.0479, 0.1073, 0.1074, 0.1079, 0.2886, 0.1078, 0.0860, 0.1136, 0.0267,
        0.0068])
[rfa agg] iter:  1, prev_obj_val: 58.593379974365234, obj_val: 67.1067886352539, abs dis: 8.513408660888672
[rfa agg] iter: 1, weight: tensor([0.0392, 0.0267, 0.2184, 0.0269, 0.0872, 0.2515, 0.0240, 0.3053, 0.0173,
        0.0035])
[rfa agg] iter:  2, prev_obj_val: 67.1067886352539, obj_val: 60.99807357788086, abs dis: 6.108715057373047
[rfa agg] iter: 2, weight: tensor([0.1501, 0.0461, 0.1791, 0.0463, 0.1003, 0.1827, 0.0427, 0.1958, 0.0487,
        0.0082])
[rfa agg] iter:  3, prev_obj_val: 60.99807357788086, obj_val: 63.97876739501953, abs dis: 2.980693817138672
[rfa agg] iter: 3, weight: tensor([0.0569, 0.0307, 0.2265, 0.0309, 0.0844, 0.2425, 0.0280, 0.2725, 0.0232,
        0.0045])
[rfa agg] iter:  4, prev_obj_val: 63.97876739501953, obj_val: 70.27387237548828, abs dis: 6.29510498046875
[rfa agg] iter: 4, weight: tensor([0.0952, 0.0398, 0.2062, 0.0401, 0.0962, 0.2128, 0.0366, 0.2314, 0.0354,
        0.0064])
[rfa agg] iter:  5, prev_obj_val: 70.27387237548828, obj_val: 70.26514434814453, abs dis: 0.00872802734375
[rfa agg] iter: 5, weight: tensor([0.2332, 0.0476, 0.1497, 0.0479, 0.0951, 0.1512, 0.0445, 0.1602, 0.0612,
        0.0094])
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3230, Accuracy: 82/10000 (0.8200%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 4.7718, Accuracy: 83/9950 (0.8342%)
saving model
Done in 502.05637884140015 sec.
Server Epoch:89 choose agents : [39, 68, 73, 96, 98, 22, 75, 79, 34, 43].
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0493, Accuracy: 329/1013 (32.4778%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0233, Accuracy: 564/1013 (55.6762%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.7208, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   1, Avg loss: 0.0606, Accuracy: 355/1163 (30.5245%)
_Train Local_ResNet_18, epoch  89, local model 68, internal_epoch   2, Avg loss: 0.0336, Accuracy: 520/1163 (44.7120%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.5745, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   1, Avg loss: 0.0598, Accuracy: 202/938 (21.5352%)
_Train Local_ResNet_18, epoch  89, local model 73, internal_epoch   2, Avg loss: 0.0307, Accuracy: 383/938 (40.8316%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.7099, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   1, Avg loss: 0.0793, Accuracy: 10/311 (3.2154%)
_Train Local_ResNet_18, epoch  89, local model 96, internal_epoch   2, Avg loss: 0.0498, Accuracy: 138/311 (44.3730%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.3008, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   1, Avg loss: 0.0768, Accuracy: 47/373 (12.6005%)
_Train Local_ResNet_18, epoch  89, local model 98, internal_epoch   2, Avg loss: 0.0439, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.8630, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   1, Avg loss: 0.0435, Accuracy: 598/1470 (40.6803%)
_Train Local_ResNet_18, epoch  89, local model 22, internal_epoch   2, Avg loss: 0.0221, Accuracy: 915/1470 (62.2449%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 9.2736, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   1, Avg loss: 0.0587, Accuracy: 282/776 (36.3402%)
_Train Local_ResNet_18, epoch  89, local model 75, internal_epoch   2, Avg loss: 0.0275, Accuracy: 452/776 (58.2474%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.3800, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   1, Avg loss: 0.1114, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  89, local model 79, internal_epoch   2, Avg loss: 0.0858, Accuracy: 43/197 (21.8274%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.5469, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   1, Avg loss: 0.0566, Accuracy: 395/1427 (27.6804%)
_Train Local_ResNet_18, epoch  89, local model 34, internal_epoch   2, Avg loss: 0.0304, Accuracy: 650/1427 (45.5501%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.8640, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0614, Accuracy: 283/946 (29.9154%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0328, Accuracy: 393/946 (41.5433%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.1051, Accuracy: 83/10000 (0.8300%)
time spent on training: 224.592942237854
[rfa agg] training data poison_ratio: 0.0  data num: [1013, 1163, 938, 311, 373, 1470, 776, 197, 1427, 946]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 68, 73, 96, 98, 22, 75, 79, 34, 43], weight: tensor([0.1176, 0.1350, 0.1089, 0.0361, 0.0433, 0.1707, 0.0901, 0.0229, 0.1657,
        0.1098])
[rfa agg] iter:  0, prev_obj_val: 42.170066833496094, obj_val: 46.72284698486328, abs dis: 4.5527801513671875
[rfa agg] iter: 0, weight: tensor([0.1594, 0.0550, 0.3007, 0.0060, 0.0080, 0.0353, 0.0710, 0.0034, 0.0343,
        0.3269])
[rfa agg] iter:  1, prev_obj_val: 46.72284698486328, obj_val: 46.7073860168457, abs dis: 0.015460968017578125
[rfa agg] iter: 1, weight: tensor([0.1375, 0.0658, 0.2430, 0.0099, 0.0134, 0.0467, 0.1874, 0.0056, 0.0453,
        0.2452])
[rfa agg] iter:  2, prev_obj_val: 46.7073860168457, obj_val: 44.14976501464844, abs dis: 2.5576210021972656
[rfa agg] iter: 2, weight: tensor([0.1375, 0.0657, 0.2413, 0.0099, 0.0133, 0.0466, 0.1941, 0.0056, 0.0453,
        0.2405])
[rfa agg] iter:  3, prev_obj_val: 44.14976501464844, obj_val: 49.45866394042969, abs dis: 5.30889892578125
[rfa agg] iter: 3, weight: tensor([0.1388, 0.0573, 0.3018, 0.0074, 0.0099, 0.0388, 0.1095, 0.0042, 0.0377,
        0.2946])
[rfa agg] iter:  4, prev_obj_val: 49.45866394042969, obj_val: 52.32732009887695, abs dis: 2.8686561584472656
[rfa agg] iter: 4, weight: tensor([0.1226, 0.0656, 0.1874, 0.0115, 0.0156, 0.0484, 0.3074, 0.0065, 0.0470,
        0.1880])
[rfa agg] iter:  5, prev_obj_val: 52.32732009887695, obj_val: 55.596900939941406, abs dis: 3.269580841064453
[rfa agg] iter: 5, weight: tensor([0.0951, 0.0554, 0.1311, 0.0112, 0.0154, 0.0423, 0.4705, 0.0063, 0.0411,
        0.1314])
[rfa agg] iter:  6, prev_obj_val: 55.596900939941406, obj_val: 52.298248291015625, abs dis: 3.2986526489257812
[rfa agg] iter: 6, weight: tensor([0.0997, 0.0623, 0.1287, 0.0145, 0.0201, 0.0490, 0.4409, 0.0081, 0.0476,
        0.1289])
[rfa agg] iter:  7, prev_obj_val: 52.298248291015625, obj_val: 59.07863235473633, abs dis: 6.780384063720703
[rfa agg] iter: 7, weight: tensor([0.0856, 0.0499, 0.1176, 0.0101, 0.0138, 0.0381, 0.5245, 0.0057, 0.0370,
        0.1175])
[rfa agg] iter:  8, prev_obj_val: 59.07863235473633, obj_val: 55.60112380981445, abs dis: 3.477508544921875
[rfa agg] iter: 8, weight: tensor([0.1154, 0.0763, 0.1421, 0.0205, 0.0287, 0.0617, 0.3415, 0.0114, 0.0599,
        0.1426])
[rfa agg] iter:  9, prev_obj_val: 55.60112380981445, obj_val: 49.420650482177734, abs dis: 6.180473327636719
[rfa agg] iter: 9, weight: tensor([0.1036, 0.0647, 0.1337, 0.0151, 0.0209, 0.0509, 0.4189, 0.0084, 0.0494,
        0.1343])
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3225, Accuracy: 80/10000 (0.8000%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 4.7177, Accuracy: 178/9950 (1.7889%)
saving model
Done in 475.32443737983704 sec.
Server Epoch:90 choose agents : [0, 96, 92, 51, 57, 32, 6, 53, 79, 37].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   1, Avg loss: 0.0572, Accuracy: 362/1657 (21.8467%)
_Train Local_ResNet_18, epoch  90, local model 0, internal_epoch   2, Avg loss: 0.0325, Accuracy: 562/1657 (33.9167%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.0829, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   1, Avg loss: 0.0794, Accuracy: 15/311 (4.8232%)
_Train Local_ResNet_18, epoch  90, local model 96, internal_epoch   2, Avg loss: 0.0510, Accuracy: 132/311 (42.4437%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.3561, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   1, Avg loss: 0.0523, Accuracy: 496/1715 (28.9213%)
_Train Local_ResNet_18, epoch  90, local model 92, internal_epoch   2, Avg loss: 0.0279, Accuracy: 840/1715 (48.9796%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.0674, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   1, Avg loss: 0.0539, Accuracy: 312/1049 (29.7426%)
_Train Local_ResNet_18, epoch  90, local model 51, internal_epoch   2, Avg loss: 0.0256, Accuracy: 576/1049 (54.9094%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.3269, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   1, Avg loss: 0.0531, Accuracy: 325/1154 (28.1629%)
_Train Local_ResNet_18, epoch  90, local model 57, internal_epoch   2, Avg loss: 0.0246, Accuracy: 526/1154 (45.5806%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 11.0436, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   1, Avg loss: 0.0516, Accuracy: 251/735 (34.1497%)
_Train Local_ResNet_18, epoch  90, local model 32, internal_epoch   2, Avg loss: 0.0201, Accuracy: 418/735 (56.8707%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 11.2111, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   1, Avg loss: 0.0527, Accuracy: 418/1956 (21.3701%)
_Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   2, Avg loss: 0.0293, Accuracy: 743/1956 (37.9857%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.4062, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0423, Accuracy: 346/813 (42.5584%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0179, Accuracy: 514/813 (63.2226%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 12.7385, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   1, Avg loss: 0.1099, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  90, local model 79, internal_epoch   2, Avg loss: 0.0890, Accuracy: 31/197 (15.7360%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.4488, Accuracy: 50/10000 (0.5000%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   1, Avg loss: 0.0442, Accuracy: 564/1129 (49.9557%)
_Train Local_ResNet_18, epoch  90, local model 37, internal_epoch   2, Avg loss: 0.0204, Accuracy: 800/1129 (70.8592%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 8.8150, Accuracy: 114/10000 (1.1400%)
time spent on training: 308.2236998081207
[rfa agg] training data poison_ratio: 0.25998506905561775  data num: [1657, 311, 1715, 1049, 1154, 735, 1956, 813, 197, 1129]
[rfa agg] considering poison per batch poison_fraction: 0.08124533407988055
[rfa agg] init. name: [0, 96, 92, 51, 57, 32, 6, 53, 79, 37], weight: tensor([0.1546, 0.0290, 0.1600, 0.0979, 0.1077, 0.0686, 0.1825, 0.0759, 0.0184,
        0.1054])
[rfa agg] iter:  0, prev_obj_val: 59.05303955078125, obj_val: 61.368492126464844, abs dis: 2.3154525756835938
[rfa agg] iter: 0, weight: tensor([0.0837, 0.0071, 0.0752, 0.1301, 0.3552, 0.0323, 0.0561, 0.0411, 0.0042,
        0.2149])
[rfa agg] iter:  1, prev_obj_val: 61.368492126464844, obj_val: 64.93408966064453, abs dis: 3.5655975341796875
[rfa agg] iter: 1, weight: tensor([0.0523, 0.0061, 0.0482, 0.1932, 0.2377, 0.0309, 0.0382, 0.0408, 0.0036,
        0.3490])
[rfa agg] iter:  2, prev_obj_val: 64.93408966064453, obj_val: 69.80378723144531, abs dis: 4.869697570800781
[rfa agg] iter: 2, weight: tensor([0.0513, 0.0073, 0.0479, 0.3419, 0.1475, 0.0408, 0.0391, 0.0556, 0.0042,
        0.2644])
[rfa agg] iter:  3, prev_obj_val: 69.80378723144531, obj_val: 67.22599792480469, abs dis: 2.577789306640625
[rfa agg] iter: 3, weight: tensor([0.0612, 0.0105, 0.0576, 0.3208, 0.1353, 0.0671, 0.0483, 0.0964, 0.0061,
        0.1968])
[rfa agg] iter:  4, prev_obj_val: 67.22599792480469, obj_val: 69.80055236816406, abs dis: 2.574554443359375
[rfa agg] iter: 4, weight: tensor([0.0541, 0.0084, 0.0506, 0.3782, 0.1335, 0.0503, 0.0419, 0.0704, 0.0049,
        0.2076])
[rfa agg] iter:  5, prev_obj_val: 69.80055236816406, obj_val: 67.22535705566406, abs dis: 2.5751953125
[rfa agg] iter: 5, weight: tensor([0.0610, 0.0104, 0.0574, 0.3255, 0.1345, 0.0669, 0.0481, 0.0961, 0.0061,
        0.1941])
[rfa agg] iter:  6, prev_obj_val: 67.22535705566406, obj_val: 69.80069732666016, abs dis: 2.5753402709960938
[rfa agg] iter: 6, weight: tensor([0.0540, 0.0084, 0.0506, 0.3793, 0.1333, 0.0502, 0.0418, 0.0703, 0.0049,
        0.2072])
[rfa agg] iter:  7, prev_obj_val: 69.80069732666016, obj_val: 67.225341796875, abs dis: 2.5753555297851562
[rfa agg] iter: 7, weight: tensor([0.0609, 0.0104, 0.0574, 0.3257, 0.1345, 0.0669, 0.0481, 0.0961, 0.0061,
        0.1941])
[rfa agg] iter:  8, prev_obj_val: 67.225341796875, obj_val: 69.80070495605469, abs dis: 2.5753631591796875
[rfa agg] iter: 8, weight: tensor([0.0540, 0.0084, 0.0506, 0.3794, 0.1333, 0.0502, 0.0418, 0.0703, 0.0049,
        0.2071])
[rfa agg] iter:  9, prev_obj_val: 69.80070495605469, obj_val: 67.22532653808594, abs dis: 2.57537841796875
[rfa agg] iter: 9, weight: tensor([0.0609, 0.0104, 0.0574, 0.3257, 0.1345, 0.0669, 0.0481, 0.0961, 0.0061,
        0.1941])
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3209, Accuracy: 84/10000 (0.8400%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 4.6907, Accuracy: 280/9950 (2.8141%)
saving model
Done in 554.1412200927734 sec.
Server Epoch:91 choose agents : [27, 46, 19, 29, 48, 47, 40, 89, 34, 83].
_Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   1, Avg loss: 0.0566, Accuracy: 404/1587 (25.4568%)
_Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   2, Avg loss: 0.0321, Accuracy: 646/1587 (40.7057%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.4789, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   1, Avg loss: 0.0525, Accuracy: 454/1904 (23.8445%)
_Train Local_ResNet_18, epoch  91, local model 46, internal_epoch   2, Avg loss: 0.0282, Accuracy: 839/1904 (44.0651%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.1778, Accuracy: 160/10000 (1.6000%)
_Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   1, Avg loss: 0.0462, Accuracy: 470/1036 (45.3668%)
_Train Local_ResNet_18, epoch  91, local model 19, internal_epoch   2, Avg loss: 0.0225, Accuracy: 742/1036 (71.6216%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 12.8163, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 455/1440 (31.5972%)
_Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   2, Avg loss: 0.0256, Accuracy: 785/1440 (54.5139%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.6881, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   1, Avg loss: 0.0645, Accuracy: 231/631 (36.6086%)
_Train Local_ResNet_18, epoch  91, local model 48, internal_epoch   2, Avg loss: 0.0385, Accuracy: 290/631 (45.9588%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.2387, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   1, Avg loss: 0.1194, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   2, Avg loss: 0.1045, Accuracy: 18/134 (13.4328%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3773, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   1, Avg loss: 0.0544, Accuracy: 397/1573 (25.2384%)
_Train Local_ResNet_18, epoch  91, local model 40, internal_epoch   2, Avg loss: 0.0328, Accuracy: 627/1573 (39.8601%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.4381, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   1, Avg loss: 0.0561, Accuracy: 345/896 (38.5045%)
_Train Local_ResNet_18, epoch  91, local model 89, internal_epoch   2, Avg loss: 0.0312, Accuracy: 467/896 (52.1205%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.2384, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0551, Accuracy: 452/1427 (31.6748%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0304, Accuracy: 642/1427 (44.9895%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.0256, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   1, Avg loss: 0.0525, Accuracy: 500/1953 (25.6016%)
_Train Local_ResNet_18, epoch  91, local model 83, internal_epoch   2, Avg loss: 0.0306, Accuracy: 903/1953 (46.2366%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.2610, Accuracy: 122/10000 (1.2200%)
time spent on training: 303.2141263484955
[rfa agg] training data poison_ratio: 0.0  data num: [1587, 1904, 1036, 1440, 631, 134, 1573, 896, 1427, 1953]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [27, 46, 19, 29, 48, 47, 40, 89, 34, 83], weight: tensor([0.1261, 0.1513, 0.0823, 0.1145, 0.0502, 0.0107, 0.1250, 0.0712, 0.1134,
        0.1552])
[rfa agg] iter:  0, prev_obj_val: 49.08082962036133, obj_val: 51.38661193847656, abs dis: 2.3057823181152344
[rfa agg] iter: 0, weight: tensor([0.1251, 0.0579, 0.0502, 0.2764, 0.0129, 0.0017, 0.1232, 0.0273, 0.2725,
        0.0529])
[rfa agg] iter:  1, prev_obj_val: 51.38661193847656, obj_val: 53.83866882324219, abs dis: 2.452056884765625
[rfa agg] iter: 1, weight: tensor([0.1276, 0.0644, 0.0658, 0.2538, 0.0159, 0.0021, 0.1261, 0.0344, 0.2507,
        0.0592])
[rfa agg] iter:  2, prev_obj_val: 53.83866882324219, obj_val: 51.386775970458984, abs dis: 2.451892852783203
[rfa agg] iter: 2, weight: tensor([0.1303, 0.0706, 0.0856, 0.2287, 0.0192, 0.0025, 0.1289, 0.0427, 0.2262,
        0.0652])
[rfa agg] iter:  3, prev_obj_val: 51.386775970458984, obj_val: 53.83858871459961, abs dis: 2.451812744140625
[rfa agg] iter: 3, weight: tensor([0.1282, 0.0646, 0.0661, 0.2528, 0.0159, 0.0021, 0.1266, 0.0345, 0.2497,
        0.0594])
[rfa agg] iter:  4, prev_obj_val: 53.83858871459961, obj_val: 51.38677978515625, abs dis: 2.4518089294433594
[rfa agg] iter: 4, weight: tensor([0.1303, 0.0706, 0.0856, 0.2287, 0.0192, 0.0025, 0.1289, 0.0427, 0.2262,
        0.0652])
[rfa agg] iter:  5, prev_obj_val: 51.38677978515625, obj_val: 53.83858871459961, abs dis: 2.4518089294433594
[rfa agg] iter: 5, weight: tensor([0.1282, 0.0646, 0.0661, 0.2528, 0.0159, 0.0021, 0.1266, 0.0345, 0.2497,
        0.0594])
[rfa agg] iter:  6, prev_obj_val: 53.83858871459961, obj_val: 51.38677978515625, abs dis: 2.4518089294433594
[rfa agg] iter: 6, weight: tensor([0.1303, 0.0706, 0.0856, 0.2287, 0.0192, 0.0025, 0.1289, 0.0427, 0.2262,
        0.0652])
[rfa agg] iter:  7, prev_obj_val: 51.38677978515625, obj_val: 53.83858871459961, abs dis: 2.4518089294433594
[rfa agg] iter: 7, weight: tensor([0.1282, 0.0646, 0.0661, 0.2528, 0.0159, 0.0021, 0.1266, 0.0345, 0.2497,
        0.0594])
[rfa agg] iter:  8, prev_obj_val: 53.83858871459961, obj_val: 51.38677978515625, abs dis: 2.4518089294433594
[rfa agg] iter: 8, weight: tensor([0.1303, 0.0706, 0.0856, 0.2287, 0.0192, 0.0025, 0.1289, 0.0427, 0.2262,
        0.0652])
[rfa agg] iter:  9, prev_obj_val: 51.38677978515625, obj_val: 53.83858871459961, abs dis: 2.4518089294433594
[rfa agg] iter: 9, weight: tensor([0.1282, 0.0646, 0.0661, 0.2528, 0.0159, 0.0021, 0.1266, 0.0345, 0.2497,
        0.0594])
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3156, Accuracy: 82/10000 (0.8200%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 4.7268, Accuracy: 252/9950 (2.5327%)
saving model
Done in 550.6988110542297 sec.
Server Epoch:92 choose agents : [9, 63, 42, 40, 83, 13, 84, 5, 75, 3].
_Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   1, Avg loss: 0.0419, Accuracy: 481/1275 (37.7255%)
_Train Local_ResNet_18, epoch  92, local model 9, internal_epoch   2, Avg loss: 0.0161, Accuracy: 826/1275 (64.7843%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.6585, Accuracy: 127/10000 (1.2700%)
_Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   1, Avg loss: 0.0509, Accuracy: 284/888 (31.9820%)
_Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   2, Avg loss: 0.0231, Accuracy: 507/888 (57.0946%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.2418, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0527, Accuracy: 366/1372 (26.6764%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0295, Accuracy: 601/1372 (43.8047%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.5563, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   1, Avg loss: 0.0533, Accuracy: 413/1573 (26.2556%)
_Train Local_ResNet_18, epoch  92, local model 40, internal_epoch   2, Avg loss: 0.0326, Accuracy: 633/1573 (40.2416%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.4812, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   1, Avg loss: 0.0530, Accuracy: 486/1953 (24.8848%)
_Train Local_ResNet_18, epoch  92, local model 83, internal_epoch   2, Avg loss: 0.0304, Accuracy: 933/1953 (47.7727%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.8038, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   1, Avg loss: 0.0506, Accuracy: 459/1645 (27.9027%)
_Train Local_ResNet_18, epoch  92, local model 13, internal_epoch   2, Avg loss: 0.0295, Accuracy: 741/1645 (45.0456%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.3297, Accuracy: 146/10000 (1.4600%)
_Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   1, Avg loss: 0.0552, Accuracy: 346/1190 (29.0756%)
_Train Local_ResNet_18, epoch  92, local model 84, internal_epoch   2, Avg loss: 0.0287, Accuracy: 527/1190 (44.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.0451, Accuracy: 106/10000 (1.0600%)
poison local model 5 index 4 
_Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   1, Avg loss: 0.0465, Accuracy: 542/1628 (33.2924%)
_Train Local_ResNet_18, epoch  92, local model 5, internal_epoch   2, Avg loss: 0.0222, Accuracy: 987/1628 (60.6265%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 10.5534, Accuracy: 135/10000 (1.3500%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   1, Avg loss: 0.0537, Accuracy: 310/776 (39.9485%)
_Train Local_ResNet_18, epoch  92, local model 75, internal_epoch   2, Avg loss: 0.0259, Accuracy: 434/776 (55.9278%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.5974, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   1, Avg loss: 0.0630, Accuracy: 165/781 (21.1268%)
_Train Local_ResNet_18, epoch  92, local model 3, internal_epoch   2, Avg loss: 0.0321, Accuracy: 298/781 (38.1562%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.7339, Accuracy: 113/10000 (1.1300%)
time spent on training: 304.34104442596436
[rfa agg] training data poison_ratio: 0.1244553168717988  data num: [1275, 888, 1372, 1573, 1953, 1645, 1190, 1628, 776, 781]
[rfa agg] considering poison per batch poison_fraction: 0.038892286522437126
[rfa agg] init. name: [9, 63, 42, 40, 83, 13, 84, 5, 75, 3], weight: tensor([0.0975, 0.0679, 0.1049, 0.1203, 0.1493, 0.1258, 0.0910, 0.1245, 0.0593,
        0.0597])
[rfa agg] iter:  0, prev_obj_val: 48.72057342529297, obj_val: 54.921295166015625, abs dis: 6.200721740722656
[rfa agg] iter: 0, weight: tensor([0.3364, 0.0331, 0.1444, 0.0698, 0.0398, 0.0609, 0.2055, 0.0603, 0.0248,
        0.0250])
[rfa agg] iter:  1, prev_obj_val: 54.921295166015625, obj_val: 60.25392150878906, abs dis: 5.3326263427734375
[rfa agg] iter: 1, weight: tensor([0.2058, 0.0514, 0.1006, 0.0631, 0.0410, 0.0572, 0.3504, 0.0565, 0.0368,
        0.0371])
[rfa agg] iter:  2, prev_obj_val: 60.25392150878906, obj_val: 60.24631118774414, abs dis: 0.007610321044921875
[rfa agg] iter: 2, weight: tensor([0.1709, 0.0876, 0.1052, 0.0730, 0.0506, 0.0674, 0.2589, 0.0666, 0.0596,
        0.0601])
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3134, Accuracy: 81/10000 (0.8100%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 4.7624, Accuracy: 223/9950 (2.2412%)
saving model
Done in 553.6630320549011 sec.
Server Epoch:93 choose agents : [59, 28, 10, 95, 89, 1, 69, 50, 30, 17].
_Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1, Avg loss: 0.0506, Accuracy: 360/1089 (33.0579%)
_Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2, Avg loss: 0.0245, Accuracy: 594/1089 (54.5455%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.8589, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   1, Avg loss: 0.0539, Accuracy: 450/1581 (28.4630%)
_Train Local_ResNet_18, epoch  93, local model 28, internal_epoch   2, Avg loss: 0.0309, Accuracy: 694/1581 (43.8963%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.7673, Accuracy: 118/10000 (1.1800%)
poison local model 10 index 5 
_Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   1, Avg loss: 0.0504, Accuracy: 300/861 (34.8432%)
_Train Local_ResNet_18, epoch  93, local model 10, internal_epoch   2, Avg loss: 0.0173, Accuracy: 544/861 (63.1823%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.9340, Accuracy: 113/10000 (1.1300%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   1, Avg loss: 0.0473, Accuracy: 352/599 (58.7646%)
_Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   2, Avg loss: 0.0285, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 11.4037, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   1, Avg loss: 0.0569, Accuracy: 342/896 (38.1696%)
_Train Local_ResNet_18, epoch  93, local model 89, internal_epoch   2, Avg loss: 0.0311, Accuracy: 458/896 (51.1161%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.1743, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   1, Avg loss: 0.0508, Accuracy: 360/928 (38.7931%)
_Train Local_ResNet_18, epoch  93, local model 1, internal_epoch   2, Avg loss: 0.0201, Accuracy: 658/928 (70.9052%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 9.0729, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   1, Avg loss: 0.0545, Accuracy: 289/590 (48.9831%)
_Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   2, Avg loss: 0.0315, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.9555, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   1, Avg loss: 0.0556, Accuracy: 261/809 (32.2621%)
_Train Local_ResNet_18, epoch  93, local model 50, internal_epoch   2, Avg loss: 0.0233, Accuracy: 445/809 (55.0062%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 10.1811, Accuracy: 119/10000 (1.1900%)
poison local model 30 index 8 
_Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   1, Avg loss: 0.0701, Accuracy: 119/486 (24.4856%)
_Train Local_ResNet_18, epoch  93, local model 30, internal_epoch   2, Avg loss: 0.0352, Accuracy: 231/486 (47.5309%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.2801, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   1, Avg loss: 0.0496, Accuracy: 474/1574 (30.1144%)
_Train Local_ResNet_18, epoch  93, local model 17, internal_epoch   2, Avg loss: 0.0244, Accuracy: 754/1574 (47.9034%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.8065, Accuracy: 143/10000 (1.4300%)
time spent on training: 276.94741129875183
[rfa agg] training data poison_ratio: 0.2067353659832147  data num: [1089, 1581, 861, 599, 896, 928, 590, 809, 486, 1574]
[rfa agg] considering poison per batch poison_fraction: 0.06460480186975459
[rfa agg] init. name: [59, 28, 10, 95, 89, 1, 69, 50, 30, 17], weight: tensor([0.1157, 0.1680, 0.0915, 0.0636, 0.0952, 0.0986, 0.0627, 0.0859, 0.0516,
        0.1672])
[rfa agg] iter:  0, prev_obj_val: 46.67967224121094, obj_val: 51.51591491699219, abs dis: 4.83624267578125
[rfa agg] iter: 0, weight: tensor([0.0896, 0.0411, 0.1884, 0.0310, 0.1937, 0.2666, 0.0306, 0.1000, 0.0180,
        0.0409])
[rfa agg] iter:  1, prev_obj_val: 51.51591491699219, obj_val: 59.51165008544922, abs dis: 7.995735168457031
[rfa agg] iter: 1, weight: tensor([0.0524, 0.0323, 0.1816, 0.0482, 0.1826, 0.1066, 0.0475, 0.2931, 0.0237,
        0.0321])
[rfa agg] iter:  2, prev_obj_val: 59.51165008544922, obj_val: 62.35626220703125, abs dis: 2.8446121215820312
[rfa agg] iter: 2, weight: tensor([0.0605, 0.0428, 0.1226, 0.1382, 0.1273, 0.0938, 0.1350, 0.1870, 0.0502,
        0.0426])
[rfa agg] iter:  3, prev_obj_val: 62.35626220703125, obj_val: 68.42727661132812, abs dis: 6.071014404296875
[rfa agg] iter: 3, weight: tensor([0.0549, 0.0402, 0.1003, 0.1944, 0.1042, 0.0806, 0.1897, 0.1388, 0.0569,
        0.0400])
[rfa agg] iter:  4, prev_obj_val: 68.42727661132812, obj_val: 72.10160827636719, abs dis: 3.6743316650390625
[rfa agg] iter: 4, weight: tensor([0.0320, 0.0249, 0.0504, 0.3364, 0.0524, 0.0432, 0.3173, 0.0627, 0.0558,
        0.0248])
[rfa agg] iter:  5, prev_obj_val: 72.10160827636719, obj_val: 76.03682708740234, abs dis: 3.9352188110351562
[rfa agg] iter: 5, weight: tensor([0.0380, 0.0305, 0.0567, 0.2934, 0.0590, 0.0497, 0.2834, 0.0680, 0.0910,
        0.0303])
[rfa agg] iter:  6, prev_obj_val: 76.03682708740234, obj_val: 76.03033447265625, abs dis: 0.00649261474609375
[rfa agg] iter: 6, weight: tensor([0.0469, 0.0385, 0.0667, 0.2194, 0.0694, 0.0596, 0.2148, 0.0780, 0.1683,
        0.0384])
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3131, Accuracy: 92/10000 (0.9200%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 4.7792, Accuracy: 224/9950 (2.2513%)
saving model
Done in 527.1158215999603 sec.
Server Epoch:94 choose agents : [34, 35, 88, 8, 41, 2, 25, 18, 54, 79].
_Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   1, Avg loss: 0.0540, Accuracy: 473/1427 (33.1465%)
_Train Local_ResNet_18, epoch  94, local model 34, internal_epoch   2, Avg loss: 0.0300, Accuracy: 672/1427 (47.0918%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.7853, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   1, Avg loss: 0.0878, Accuracy: 16/271 (5.9041%)
_Train Local_ResNet_18, epoch  94, local model 35, internal_epoch   2, Avg loss: 0.0536, Accuracy: 145/271 (53.5055%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.3988, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   1, Avg loss: 0.0692, Accuracy: 157/603 (26.0365%)
_Train Local_ResNet_18, epoch  94, local model 88, internal_epoch   2, Avg loss: 0.0411, Accuracy: 278/603 (46.1028%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.1820, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   1, Avg loss: 0.0556, Accuracy: 365/1513 (24.1243%)
_Train Local_ResNet_18, epoch  94, local model 8, internal_epoch   2, Avg loss: 0.0335, Accuracy: 600/1513 (39.6563%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.7646, Accuracy: 136/10000 (1.3600%)
_Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   1, Avg loss: 0.0546, Accuracy: 320/719 (44.5063%)
_Train Local_ResNet_18, epoch  94, local model 41, internal_epoch   2, Avg loss: 0.0293, Accuracy: 437/719 (60.7789%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.2440, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   1, Avg loss: 0.0626, Accuracy: 214/605 (35.3719%)
_Train Local_ResNet_18, epoch  94, local model 2, internal_epoch   2, Avg loss: 0.0378, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.9117, Accuracy: 79/10000 (0.7900%)
poison local model 25 index 7 
_Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   1, Avg loss: 0.0515, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch  94, local model 25, internal_epoch   2, Avg loss: 0.0224, Accuracy: 470/690 (68.1159%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.2258, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   1, Avg loss: 0.0669, Accuracy: 179/530 (33.7736%)
_Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   2, Avg loss: 0.0349, Accuracy: 291/530 (54.9057%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.7947, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0553, Accuracy: 336/1130 (29.7345%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0272, Accuracy: 497/1130 (43.9823%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 9.2562, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   1, Avg loss: 0.1109, Accuracy: 0/197 (0.0000%)
_Train Local_ResNet_18, epoch  94, local model 79, internal_epoch   2, Avg loss: 0.0898, Accuracy: 40/197 (20.3046%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.4596, Accuracy: 50/10000 (0.5000%)
time spent on training: 259.49714827537537
[rfa agg] training data poison_ratio: 0.08978529603122967  data num: [1427, 271, 603, 1513, 719, 605, 690, 530, 1130, 197]
[rfa agg] considering poison per batch poison_fraction: 0.02805790500975927
[rfa agg] init. name: [34, 35, 88, 8, 41, 2, 25, 18, 54, 79], weight: tensor([0.1857, 0.0353, 0.0785, 0.1969, 0.0936, 0.0787, 0.0898, 0.0690, 0.1470,
        0.0256])
[rfa agg] iter:  0, prev_obj_val: 56.135841369628906, obj_val: 57.06772994995117, abs dis: 0.9318885803222656
[rfa agg] iter: 0, weight: tensor([0.0983, 0.0187, 0.0930, 0.0938, 0.2127, 0.0931, 0.1403, 0.0656, 0.1723,
        0.0122])
[rfa agg] iter:  1, prev_obj_val: 57.06772994995117, obj_val: 61.67661666870117, abs dis: 4.60888671875
[rfa agg] iter: 1, weight: tensor([0.0526, 0.0140, 0.0917, 0.0509, 0.3847, 0.0917, 0.1684, 0.0582, 0.0790,
        0.0090])
[rfa agg] iter:  2, prev_obj_val: 61.67661666870117, obj_val: 66.73312377929688, abs dis: 5.056507110595703
[rfa agg] iter: 2, weight: tensor([0.0294, 0.0127, 0.2137, 0.0289, 0.1197, 0.2090, 0.2540, 0.0860, 0.0387,
        0.0078])
[rfa agg] iter:  3, prev_obj_val: 66.73312377929688, obj_val: 73.77064514160156, abs dis: 7.0375213623046875
[rfa agg] iter: 3, weight: tensor([0.0281, 0.0160, 0.2491, 0.0277, 0.0745, 0.2446, 0.1177, 0.1977, 0.0352,
        0.0095])
[rfa agg] iter:  4, prev_obj_val: 73.77064514160156, obj_val: 73.75558471679688, abs dis: 0.0150604248046875
[rfa agg] iter: 4, weight: tensor([0.0396, 0.0311, 0.1574, 0.0393, 0.0815, 0.1571, 0.1090, 0.3195, 0.0478,
        0.0176])
[rfa agg] iter:  5, prev_obj_val: 73.75558471679688, obj_val: 70.04410552978516, abs dis: 3.7114791870117188
[rfa agg] iter: 5, weight: tensor([0.0387, 0.0304, 0.1523, 0.0384, 0.0798, 0.1518, 0.1065, 0.3381, 0.0467,
        0.0172])
[rfa agg] iter:  6, prev_obj_val: 70.04410552978516, obj_val: 66.739013671875, abs dis: 3.3050918579101562
[rfa agg] iter: 6, weight: tensor([0.0283, 0.0188, 0.1534, 0.0280, 0.0651, 0.1518, 0.0925, 0.4166, 0.0347,
        0.0109])
[rfa agg] iter:  7, prev_obj_val: 66.739013671875, obj_val: 70.06137084960938, abs dis: 3.322357177734375
[rfa agg] iter: 7, weight: tensor([0.0277, 0.0158, 0.2354, 0.0273, 0.0731, 0.2281, 0.1133, 0.2352, 0.0347,
        0.0094])
[rfa agg] iter:  8, prev_obj_val: 70.06137084960938, obj_val: 70.04167175292969, abs dis: 0.0196990966796875
[rfa agg] iter: 8, weight: tensor([0.0301, 0.0200, 0.1667, 0.0298, 0.0694, 0.1654, 0.0989, 0.3709, 0.0370,
        0.0116])
[rfa agg] iter:  9, prev_obj_val: 70.04167175292969, obj_val: 70.03898620605469, abs dis: 0.002685546875
[rfa agg] iter: 9, weight: tensor([0.0278, 0.0185, 0.1512, 0.0275, 0.0641, 0.1498, 0.0911, 0.4250, 0.0342,
        0.0108])
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3124, Accuracy: 101/10000 (1.0100%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 4.8024, Accuracy: 183/9950 (1.8392%)
saving model
Done in 503.2987504005432 sec.
Server Epoch:95 choose agents : [66, 86, 64, 27, 37, 55, 33, 62, 57, 28].
_Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   1, Avg loss: 0.0578, Accuracy: 312/1402 (22.2539%)
_Train Local_ResNet_18, epoch  95, local model 66, internal_epoch   2, Avg loss: 0.0360, Accuracy: 463/1402 (33.0243%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.0941, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   1, Avg loss: 0.0589, Accuracy: 326/1003 (32.5025%)
_Train Local_ResNet_18, epoch  95, local model 86, internal_epoch   2, Avg loss: 0.0328, Accuracy: 406/1003 (40.4786%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.0729, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   1, Avg loss: 0.0569, Accuracy: 260/953 (27.2823%)
_Train Local_ResNet_18, epoch  95, local model 64, internal_epoch   2, Avg loss: 0.0339, Accuracy: 367/953 (38.5100%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.8644, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   1, Avg loss: 0.0547, Accuracy: 440/1587 (27.7253%)
_Train Local_ResNet_18, epoch  95, local model 27, internal_epoch   2, Avg loss: 0.0316, Accuracy: 674/1587 (42.4701%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.2631, Accuracy: 69/10000 (0.6900%)
poison local model 37 index 9 
_Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   1, Avg loss: 0.0434, Accuracy: 598/1129 (52.9672%)
_Train Local_ResNet_18, epoch  95, local model 37, internal_epoch   2, Avg loss: 0.0200, Accuracy: 787/1129 (69.7077%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.2781, Accuracy: 113/10000 (1.1300%)
poison local model 55 index 12 
_Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   1, Avg loss: 0.0529, Accuracy: 338/1071 (31.5593%)
_Train Local_ResNet_18, epoch  95, local model 55, internal_epoch   2, Avg loss: 0.0274, Accuracy: 571/1071 (53.3147%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 9.5238, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   1, Avg loss: 0.0789, Accuracy: 80/515 (15.5340%)
_Train Local_ResNet_18, epoch  95, local model 33, internal_epoch   2, Avg loss: 0.0520, Accuracy: 184/515 (35.7282%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.2066, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   1, Avg loss: 0.0676, Accuracy: 153/568 (26.9366%)
_Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   2, Avg loss: 0.0379, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.2482, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   1, Avg loss: 0.0516, Accuracy: 335/1154 (29.0295%)
_Train Local_ResNet_18, epoch  95, local model 57, internal_epoch   2, Avg loss: 0.0248, Accuracy: 540/1154 (46.7938%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 11.9454, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   1, Avg loss: 0.0544, Accuracy: 408/1581 (25.8065%)
_Train Local_ResNet_18, epoch  95, local model 28, internal_epoch   2, Avg loss: 0.0307, Accuracy: 698/1581 (44.1493%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.7773, Accuracy: 110/10000 (1.1000%)
time spent on training: 288.38876485824585
[rfa agg] training data poison_ratio: 0.2006749977196023  data num: [1402, 1003, 953, 1587, 1129, 1071, 515, 568, 1154, 1581]
[rfa agg] considering poison per batch poison_fraction: 0.06271093678737572
[rfa agg] init. name: [66, 86, 64, 27, 37, 55, 33, 62, 57, 28], weight: tensor([0.1279, 0.0915, 0.0869, 0.1448, 0.1030, 0.0977, 0.0470, 0.0518, 0.1053,
        0.1442])
[rfa agg] iter:  0, prev_obj_val: 41.931732177734375, obj_val: 52.55928039550781, abs dis: 10.627548217773438
[rfa agg] iter: 0, weight: tensor([0.0533, 0.2456, 0.1253, 0.0391, 0.1346, 0.2415, 0.0144, 0.0159, 0.0912,
        0.0389])
[rfa agg] iter:  1, prev_obj_val: 52.55928039550781, obj_val: 52.51179885864258, abs dis: 0.047481536865234375
[rfa agg] iter: 1, weight: tensor([0.0521, 0.1730, 0.3632, 0.0421, 0.0874, 0.1152, 0.0260, 0.0288, 0.0703,
        0.0419])
[rfa agg] iter:  2, prev_obj_val: 52.51179885864258, obj_val: 55.98757553100586, abs dis: 3.4757766723632812
[rfa agg] iter: 2, weight: tensor([0.0492, 0.1626, 0.4007, 0.0398, 0.0823, 0.1078, 0.0246, 0.0272, 0.0663,
        0.0396])
[rfa agg] iter:  3, prev_obj_val: 55.98757553100586, obj_val: 52.51523971557617, abs dis: 3.4723358154296875
[rfa agg] iter: 3, weight: tensor([0.0603, 0.1647, 0.3096, 0.0496, 0.0948, 0.1190, 0.0353, 0.0391, 0.0783,
        0.0494])
[rfa agg] iter:  4, prev_obj_val: 52.51523971557617, obj_val: 52.51096725463867, abs dis: 0.0042724609375
[rfa agg] iter: 4, weight: tensor([0.0497, 0.1643, 0.3939, 0.0402, 0.0833, 0.1091, 0.0249, 0.0275, 0.0671,
        0.0400])
[rfa agg] iter:  5, prev_obj_val: 52.51096725463867, obj_val: 55.98789596557617, abs dis: 3.4769287109375
[rfa agg] iter: 5, weight: tensor([0.0488, 0.1612, 0.4051, 0.0395, 0.0817, 0.1070, 0.0244, 0.0270, 0.0659,
        0.0393])
[rfa agg] iter:  6, prev_obj_val: 55.98789596557617, obj_val: 52.515228271484375, abs dis: 3.472667694091797
[rfa agg] iter: 6, weight: tensor([0.0602, 0.1646, 0.3098, 0.0496, 0.0948, 0.1189, 0.0353, 0.0391, 0.0783,
        0.0494])
[rfa agg] iter:  7, prev_obj_val: 52.515228271484375, obj_val: 52.51096725463867, abs dis: 0.004261016845703125
[rfa agg] iter: 7, weight: tensor([0.0497, 0.1643, 0.3940, 0.0402, 0.0833, 0.1091, 0.0249, 0.0275, 0.0671,
        0.0400])
[rfa agg] iter:  8, prev_obj_val: 52.51096725463867, obj_val: 55.98789978027344, abs dis: 3.4769325256347656
[rfa agg] iter: 8, weight: tensor([0.0488, 0.1612, 0.4051, 0.0395, 0.0817, 0.1070, 0.0244, 0.0270, 0.0659,
        0.0393])
[rfa agg] iter:  9, prev_obj_val: 55.98789978027344, obj_val: 52.515228271484375, abs dis: 3.4726715087890625
[rfa agg] iter: 9, weight: tensor([0.0602, 0.1646, 0.3098, 0.0496, 0.0948, 0.1189, 0.0353, 0.0391, 0.0783,
        0.0494])
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3127, Accuracy: 95/10000 (0.9500%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 4.7097, Accuracy: 270/9950 (2.7136%)
saving model
Done in 533.575875043869 sec.
Server Epoch:96 choose agents : [6, 3, 92, 4, 1, 12, 48, 2, 69, 13].
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0525, Accuracy: 386/1956 (19.7342%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0290, Accuracy: 756/1956 (38.6503%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.3369, Accuracy: 139/10000 (1.3900%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0628, Accuracy: 165/781 (21.1268%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0316, Accuracy: 316/781 (40.4609%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.5048, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   1, Avg loss: 0.0512, Accuracy: 535/1715 (31.1953%)
_Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   2, Avg loss: 0.0276, Accuracy: 838/1715 (48.8630%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.7074, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   1, Avg loss: 0.0564, Accuracy: 347/901 (38.5128%)
_Train Local_ResNet_18, epoch  96, local model 4, internal_epoch   2, Avg loss: 0.0297, Accuracy: 410/901 (45.5050%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.9985, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1, Avg loss: 0.0510, Accuracy: 374/928 (40.3017%)
_Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2, Avg loss: 0.0205, Accuracy: 641/928 (69.0733%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.1527, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1, Avg loss: 0.0846, Accuracy: 26/338 (7.6923%)
_Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2, Avg loss: 0.0412, Accuracy: 172/338 (50.8876%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.8098, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   1, Avg loss: 0.0644, Accuracy: 245/631 (38.8273%)
_Train Local_ResNet_18, epoch  96, local model 48, internal_epoch   2, Avg loss: 0.0391, Accuracy: 301/631 (47.7021%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.6770, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0622, Accuracy: 217/605 (35.8678%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0371, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.0316, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   1, Avg loss: 0.0549, Accuracy: 300/590 (50.8475%)
_Train Local_ResNet_18, epoch  96, local model 69, internal_epoch   2, Avg loss: 0.0305, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 11.0673, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   1, Avg loss: 0.0508, Accuracy: 477/1645 (28.9970%)
_Train Local_ResNet_18, epoch  96, local model 13, internal_epoch   2, Avg loss: 0.0293, Accuracy: 783/1645 (47.5988%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.0557, Accuracy: 157/10000 (1.5700%)
time spent on training: 253.2371027469635
[rfa agg] training data poison_ratio: 0.0  data num: [1956, 781, 1715, 901, 928, 338, 631, 605, 590, 1645]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [6, 3, 92, 4, 1, 12, 48, 2, 69, 13], weight: tensor([0.1939, 0.0774, 0.1700, 0.0893, 0.0920, 0.0335, 0.0625, 0.0600, 0.0585,
        0.1630])
[rfa agg] iter:  0, prev_obj_val: 72.66069793701172, obj_val: 74.01170349121094, abs dis: 1.3510055541992188
[rfa agg] iter: 0, weight: tensor([0.1149, 0.0914, 0.1506, 0.1561, 0.1608, 0.0184, 0.0494, 0.0474, 0.0462,
        0.1649])
[rfa agg] iter:  1, prev_obj_val: 74.01170349121094, obj_val: 80.47561645507812, abs dis: 6.4639129638671875
[rfa agg] iter: 1, weight: tensor([0.0643, 0.1049, 0.0778, 0.2565, 0.2650, 0.0154, 0.0462, 0.0443, 0.0432,
        0.0824])
[rfa agg] iter:  2, prev_obj_val: 80.47561645507812, obj_val: 80.42755126953125, abs dis: 0.048065185546875
[rfa agg] iter: 2, weight: tensor([0.0373, 0.3185, 0.0423, 0.1831, 0.1884, 0.0150, 0.0593, 0.0569, 0.0555,
        0.0438])
[rfa agg] iter:  3, prev_obj_val: 80.42755126953125, obj_val: 78.62688446044922, abs dis: 1.8006668090820312
[rfa agg] iter: 3, weight: tensor([0.0354, 0.3579, 0.0402, 0.1716, 0.1755, 0.0143, 0.0565, 0.0541, 0.0528,
        0.0416])
[rfa agg] iter:  4, prev_obj_val: 78.62688446044922, obj_val: 80.44196319580078, abs dis: 1.8150787353515625
[rfa agg] iter: 4, weight: tensor([0.0376, 0.2334, 0.0431, 0.2375, 0.2416, 0.0138, 0.0512, 0.0491, 0.0478,
        0.0448])
[rfa agg] iter:  5, prev_obj_val: 80.44196319580078, obj_val: 80.4266357421875, abs dis: 0.01532745361328125
[rfa agg] iter: 5, weight: tensor([0.0362, 0.3389, 0.0412, 0.1776, 0.1818, 0.0146, 0.0577, 0.0554, 0.0540,
        0.0426])
[rfa agg] iter:  6, prev_obj_val: 80.4266357421875, obj_val: 78.62765502929688, abs dis: 1.798980712890625
[rfa agg] iter: 6, weight: tensor([0.0352, 0.3615, 0.0400, 0.1705, 0.1744, 0.0142, 0.0562, 0.0539, 0.0525,
        0.0414])
[rfa agg] iter:  7, prev_obj_val: 78.62765502929688, obj_val: 80.44189453125, abs dis: 1.814239501953125
[rfa agg] iter: 7, weight: tensor([0.0376, 0.2336, 0.0431, 0.2374, 0.2415, 0.0138, 0.0512, 0.0491, 0.0478,
        0.0448])
[rfa agg] iter:  8, prev_obj_val: 80.44189453125, obj_val: 80.4266357421875, abs dis: 0.0152587890625
[rfa agg] iter: 8, weight: tensor([0.0362, 0.3389, 0.0412, 0.1776, 0.1818, 0.0146, 0.0577, 0.0554, 0.0540,
        0.0426])
[rfa agg] iter:  9, prev_obj_val: 80.4266357421875, obj_val: 78.62765502929688, abs dis: 1.798980712890625
[rfa agg] iter: 9, weight: tensor([0.0352, 0.3615, 0.0400, 0.1705, 0.1744, 0.0142, 0.0562, 0.0539, 0.0525,
        0.0414])
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3129, Accuracy: 97/10000 (0.9700%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 4.7458, Accuracy: 192/9950 (1.9296%)
saving model
Done in 505.7728416919708 sec.
Server Epoch:97 choose agents : [34, 90, 11, 2, 35, 50, 85, 72, 3, 18].
_Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   1, Avg loss: 0.0546, Accuracy: 434/1427 (30.4135%)
_Train Local_ResNet_18, epoch  97, local model 34, internal_epoch   2, Avg loss: 0.0297, Accuracy: 645/1427 (45.1997%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.9396, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   1, Avg loss: 0.0537, Accuracy: 307/677 (45.3471%)
_Train Local_ResNet_18, epoch  97, local model 90, internal_epoch   2, Avg loss: 0.0222, Accuracy: 453/677 (66.9129%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 10.5073, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   1, Avg loss: 0.0558, Accuracy: 282/712 (39.6067%)
_Train Local_ResNet_18, epoch  97, local model 11, internal_epoch   2, Avg loss: 0.0234, Accuracy: 426/712 (59.8315%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.2229, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1, Avg loss: 0.0619, Accuracy: 213/605 (35.2066%)
_Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2, Avg loss: 0.0368, Accuracy: 332/605 (54.8760%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.0597, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1, Avg loss: 0.0885, Accuracy: 13/271 (4.7970%)
_Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2, Avg loss: 0.0528, Accuracy: 132/271 (48.7085%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.4117, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   1, Avg loss: 0.0553, Accuracy: 247/809 (30.5315%)
_Train Local_ResNet_18, epoch  97, local model 50, internal_epoch   2, Avg loss: 0.0234, Accuracy: 428/809 (52.9048%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 9.9590, Accuracy: 128/10000 (1.2800%)
poison local model 85 index 15 
_Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   1, Avg loss: 0.0546, Accuracy: 523/1988 (26.3078%)
_Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   2, Avg loss: 0.0336, Accuracy: 750/1988 (37.7264%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.9782, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   1, Avg loss: 0.0530, Accuracy: 377/1241 (30.3787%)
_Train Local_ResNet_18, epoch  97, local model 72, internal_epoch   2, Avg loss: 0.0334, Accuracy: 504/1241 (40.6124%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.0265, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   1, Avg loss: 0.0587, Accuracy: 212/781 (27.1447%)
_Train Local_ResNet_18, epoch  97, local model 3, internal_epoch   2, Avg loss: 0.0311, Accuracy: 313/781 (40.0768%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.4858, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   1, Avg loss: 0.0643, Accuracy: 201/530 (37.9245%)
_Train Local_ResNet_18, epoch  97, local model 18, internal_epoch   2, Avg loss: 0.0337, Accuracy: 306/530 (57.7358%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 8.6108, Accuracy: 75/10000 (0.7500%)
time spent on training: 284.4099931716919
[rfa agg] training data poison_ratio: 0.21988718062161267  data num: [1427, 677, 712, 605, 271, 809, 1988, 1241, 781, 530]
[rfa agg] considering poison per batch poison_fraction: 0.06871474394425396
[rfa agg] init. name: [34, 90, 11, 2, 35, 50, 85, 72, 3, 18], weight: tensor([0.1578, 0.0749, 0.0788, 0.0669, 0.0300, 0.0895, 0.2199, 0.1373, 0.0864,
        0.0586])
[rfa agg] iter:  0, prev_obj_val: 67.41658020019531, obj_val: 67.81864166259766, abs dis: 0.40206146240234375
[rfa agg] iter: 0, weight: tensor([0.1480, 0.0705, 0.0887, 0.0541, 0.0142, 0.1253, 0.0830, 0.2534, 0.1213,
        0.0415])
[rfa agg] iter:  1, prev_obj_val: 67.81864166259766, obj_val: 69.29188537597656, abs dis: 1.4732437133789062
[rfa agg] iter: 1, weight: tensor([0.1070, 0.0845, 0.1131, 0.0619, 0.0146, 0.1776, 0.0680, 0.1546, 0.1729,
        0.0460])
[rfa agg] iter:  2, prev_obj_val: 69.29188537597656, obj_val: 77.18354034423828, abs dis: 7.891654968261719
[rfa agg] iter: 2, weight: tensor([0.0295, 0.0683, 0.1264, 0.0413, 0.0070, 0.2964, 0.0217, 0.0366, 0.3454,
        0.0273])
[rfa agg] iter:  3, prev_obj_val: 77.18354034423828, obj_val: 83.15849304199219, abs dis: 5.974952697753906
[rfa agg] iter: 3, weight: tensor([0.0304, 0.3429, 0.1550, 0.1355, 0.0116, 0.1007, 0.0243, 0.0352, 0.0984,
        0.0660])
[rfa agg] iter:  4, prev_obj_val: 83.15849304199219, obj_val: 86.63542175292969, abs dis: 3.4769287109375
[rfa agg] iter: 4, weight: tensor([0.0296, 0.1741, 0.0926, 0.3573, 0.0146, 0.0712, 0.0244, 0.0334, 0.0692,
        0.1337])
[rfa agg] iter:  5, prev_obj_val: 86.63542175292969, obj_val: 94.42012786865234, abs dis: 7.784706115722656
[rfa agg] iter: 5, weight: tensor([0.0309, 0.1279, 0.0812, 0.2972, 0.0176, 0.0666, 0.0259, 0.0346, 0.0647,
        0.2533])
[rfa agg] iter:  6, prev_obj_val: 94.42012786865234, obj_val: 90.35047149658203, abs dis: 4.0696563720703125
[rfa agg] iter: 6, weight: tensor([0.0396, 0.1078, 0.0808, 0.1584, 0.0311, 0.0717, 0.0341, 0.0434, 0.0695,
        0.3637])
[rfa agg] iter:  7, prev_obj_val: 90.35047149658203, obj_val: 90.33792877197266, abs dis: 0.012542724609375
[rfa agg] iter: 7, weight: tensor([0.0260, 0.0849, 0.0596, 0.1429, 0.0173, 0.0511, 0.0221, 0.0288, 0.0495,
        0.5177])
[rfa agg] iter:  8, prev_obj_val: 90.33792877197266, obj_val: 90.33497619628906, abs dis: 0.00295257568359375
[rfa agg] iter: 8, weight: tensor([0.0223, 0.0727, 0.0510, 0.1218, 0.0148, 0.0437, 0.0189, 0.0247, 0.0424,
        0.5877])
[rfa agg] iter:  9, prev_obj_val: 90.33497619628906, obj_val: 90.33399200439453, abs dis: 0.00098419189453125
[rfa agg] iter: 9, weight: tensor([0.0203, 0.0661, 0.0464, 0.1102, 0.0135, 0.0398, 0.0172, 0.0225, 0.0386,
        0.6255])
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3149, Accuracy: 99/10000 (0.9900%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 4.7756, Accuracy: 93/9950 (0.9347%)
saving model
Done in 529.8935129642487 sec.
Server Epoch:98 choose agents : [7, 45, 42, 97, 87, 98, 9, 32, 48, 31].
_Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   1, Avg loss: 0.0522, Accuracy: 337/891 (37.8227%)
_Train Local_ResNet_18, epoch  98, local model 7, internal_epoch   2, Avg loss: 0.0241, Accuracy: 477/891 (53.5354%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.1035, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   1, Avg loss: 0.0600, Accuracy: 247/669 (36.9208%)
_Train Local_ResNet_18, epoch  98, local model 45, internal_epoch   2, Avg loss: 0.0354, Accuracy: 369/669 (55.1570%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.8550, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   1, Avg loss: 0.0528, Accuracy: 351/1372 (25.5831%)
_Train Local_ResNet_18, epoch  98, local model 42, internal_epoch   2, Avg loss: 0.0287, Accuracy: 624/1372 (45.4810%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.6197, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   1, Avg loss: 0.0419, Accuracy: 511/1213 (42.1270%)
_Train Local_ResNet_18, epoch  98, local model 97, internal_epoch   2, Avg loss: 0.0238, Accuracy: 653/1213 (53.8335%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 9.2711, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   1, Avg loss: 0.0536, Accuracy: 313/1131 (27.6746%)
_Train Local_ResNet_18, epoch  98, local model 87, internal_epoch   2, Avg loss: 0.0293, Accuracy: 446/1131 (39.4341%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.3593, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   1, Avg loss: 0.0760, Accuracy: 52/373 (13.9410%)
_Train Local_ResNet_18, epoch  98, local model 98, internal_epoch   2, Avg loss: 0.0441, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.7387, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   1, Avg loss: 0.0411, Accuracy: 473/1275 (37.0980%)
_Train Local_ResNet_18, epoch  98, local model 9, internal_epoch   2, Avg loss: 0.0160, Accuracy: 815/1275 (63.9216%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 10.5420, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   1, Avg loss: 0.0526, Accuracy: 237/735 (32.2449%)
_Train Local_ResNet_18, epoch  98, local model 32, internal_epoch   2, Avg loss: 0.0196, Accuracy: 417/735 (56.7347%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 11.3384, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   1, Avg loss: 0.0646, Accuracy: 226/631 (35.8162%)
_Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   2, Avg loss: 0.0379, Accuracy: 297/631 (47.0681%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.2897, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   1, Avg loss: 0.0811, Accuracy: 37/460 (8.0435%)
_Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   2, Avg loss: 0.0356, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.5887, Accuracy: 52/10000 (0.5200%)
time spent on training: 236.22224712371826
[rfa agg] training data poison_ratio: 0.0  data num: [891, 669, 1372, 1213, 1131, 373, 1275, 735, 631, 460]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [7, 45, 42, 97, 87, 98, 9, 32, 48, 31], weight: tensor([0.1018, 0.0765, 0.1568, 0.1386, 0.1293, 0.0426, 0.1457, 0.0840, 0.0721,
        0.0526])
[rfa agg] iter:  0, prev_obj_val: 45.5195198059082, obj_val: 50.96873092651367, abs dis: 5.449211120605469
[rfa agg] iter: 0, weight: tensor([0.2630, 0.1121, 0.0537, 0.0709, 0.0792, 0.0188, 0.0638, 0.2327, 0.0734,
        0.0323])
[rfa agg] iter:  1, prev_obj_val: 50.96873092651367, obj_val: 59.23261642456055, abs dis: 8.263885498046875
[rfa agg] iter: 1, weight: tensor([0.1001, 0.2292, 0.0374, 0.0462, 0.0497, 0.0194, 0.0427, 0.3229, 0.1151,
        0.0373])
[rfa agg] iter:  2, prev_obj_val: 59.23261642456055, obj_val: 62.59482955932617, abs dis: 3.362213134765625
[rfa agg] iter: 2, weight: tensor([0.0649, 0.1704, 0.0337, 0.0396, 0.0416, 0.0274, 0.0374, 0.1064, 0.4128,
        0.0659])
[rfa agg] iter:  3, prev_obj_val: 62.59482955932617, obj_val: 66.1669921875, abs dis: 3.572162628173828
[rfa agg] iter: 3, weight: tensor([0.0681, 0.1435, 0.0381, 0.0443, 0.0461, 0.0368, 0.0420, 0.1001, 0.3792,
        0.1019])
[rfa agg] iter:  4, prev_obj_val: 66.1669921875, obj_val: 69.77641296386719, abs dis: 3.6094207763671875
[rfa agg] iter: 4, weight: tensor([0.0751, 0.1356, 0.0448, 0.0514, 0.0532, 0.0523, 0.0490, 0.1026, 0.2569,
        0.1790])
[rfa agg] iter:  5, prev_obj_val: 69.77641296386719, obj_val: 73.47640991210938, abs dis: 3.6999969482421875
[rfa agg] iter: 5, weight: tensor([0.0685, 0.1105, 0.0432, 0.0491, 0.0505, 0.0627, 0.0470, 0.0885, 0.1744,
        0.3057])
[rfa agg] iter:  6, prev_obj_val: 73.47640991210938, obj_val: 73.46066284179688, abs dis: 0.0157470703125
[rfa agg] iter: 6, weight: tensor([0.0523, 0.0772, 0.0347, 0.0390, 0.0400, 0.0648, 0.0375, 0.0646, 0.1098,
        0.4803])
[rfa agg] iter:  7, prev_obj_val: 73.46066284179688, obj_val: 73.4574203491211, abs dis: 0.00324249267578125
[rfa agg] iter: 7, weight: tensor([0.0451, 0.0663, 0.0299, 0.0336, 0.0344, 0.0557, 0.0323, 0.0556, 0.0943,
        0.5526])
[rfa agg] iter:  8, prev_obj_val: 73.4574203491211, obj_val: 69.79048919677734, abs dis: 3.66693115234375
[rfa agg] iter: 8, weight: tensor([0.0414, 0.0608, 0.0274, 0.0309, 0.0316, 0.0511, 0.0297, 0.0511, 0.0865,
        0.5895])
[rfa agg] iter:  9, prev_obj_val: 69.79048919677734, obj_val: 69.7708969116211, abs dis: 0.01959228515625
[rfa agg] iter: 9, weight: tensor([0.0650, 0.1038, 0.0410, 0.0466, 0.0479, 0.0593, 0.0446, 0.0838, 0.1631,
        0.3449])
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3148, Accuracy: 100/10000 (1.0000%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 4.7324, Accuracy: 126/9950 (1.2663%)
saving model
Done in 482.13233494758606 sec.
Server Epoch:99 choose agents : [64, 82, 67, 73, 95, 84, 19, 29, 39, 26].
_Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   1, Avg loss: 0.0555, Accuracy: 235/953 (24.6590%)
_Train Local_ResNet_18, epoch  99, local model 64, internal_epoch   2, Avg loss: 0.0344, Accuracy: 341/953 (35.7817%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.7329, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1, Avg loss: 0.0744, Accuracy: 83/500 (16.6000%)
_Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2, Avg loss: 0.0460, Accuracy: 238/500 (47.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.5209, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   1, Avg loss: 0.0688, Accuracy: 95/426 (22.3005%)
_Train Local_ResNet_18, epoch  99, local model 67, internal_epoch   2, Avg loss: 0.0357, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.4072, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   1, Avg loss: 0.0595, Accuracy: 199/938 (21.2154%)
_Train Local_ResNet_18, epoch  99, local model 73, internal_epoch   2, Avg loss: 0.0302, Accuracy: 424/938 (45.2026%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.0236, Accuracy: 70/10000 (0.7000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   1, Avg loss: 0.0466, Accuracy: 351/599 (58.5977%)
_Train Local_ResNet_18, epoch  99, local model 95, internal_epoch   2, Avg loss: 0.0260, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 11.0592, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   1, Avg loss: 0.0529, Accuracy: 345/1190 (28.9916%)
_Train Local_ResNet_18, epoch  99, local model 84, internal_epoch   2, Avg loss: 0.0273, Accuracy: 567/1190 (47.6471%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.1450, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   1, Avg loss: 0.0462, Accuracy: 446/1036 (43.0502%)
_Train Local_ResNet_18, epoch  99, local model 19, internal_epoch   2, Avg loss: 0.0222, Accuracy: 739/1036 (71.3320%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 11.2001, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   1, Avg loss: 0.0483, Accuracy: 439/1440 (30.4861%)
_Train Local_ResNet_18, epoch  99, local model 29, internal_epoch   2, Avg loss: 0.0247, Accuracy: 784/1440 (54.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 9.0955, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   1, Avg loss: 0.0488, Accuracy: 335/1013 (33.0701%)
_Train Local_ResNet_18, epoch  99, local model 39, internal_epoch   2, Avg loss: 0.0232, Accuracy: 577/1013 (56.9595%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 8.8776, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   1, Avg loss: 0.0542, Accuracy: 352/1446 (24.3430%)
_Train Local_ResNet_18, epoch  99, local model 26, internal_epoch   2, Avg loss: 0.0324, Accuracy: 578/1446 (39.9723%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.7546, Accuracy: 80/10000 (0.8000%)
time spent on training: 266.90563321113586
[rfa agg] training data poison_ratio: 0.06278167906927995  data num: [953, 500, 426, 938, 599, 1190, 1036, 1440, 1013, 1446]
[rfa agg] considering poison per batch poison_fraction: 0.019619274709149984
[rfa agg] init. name: [64, 82, 67, 73, 95, 84, 19, 29, 39, 26], weight: tensor([0.0999, 0.0524, 0.0446, 0.0983, 0.0628, 0.1247, 0.1086, 0.1509, 0.1062,
        0.1516])
[rfa agg] iter:  0, prev_obj_val: 47.936920166015625, obj_val: 47.901546478271484, abs dis: 0.035373687744140625
[rfa agg] iter: 0, weight: tensor([0.2171, 0.0337, 0.0243, 0.2168, 0.0628, 0.0795, 0.1082, 0.0562, 0.1452,
        0.0564])
[rfa agg] iter:  1, prev_obj_val: 47.901546478271484, obj_val: 50.88036346435547, abs dis: 2.9788169860839844
[rfa agg] iter: 1, weight: tensor([0.2201, 0.0334, 0.0241, 0.2179, 0.0624, 0.0787, 0.1073, 0.0557, 0.1446,
        0.0558])
[rfa agg] iter:  2, prev_obj_val: 50.88036346435547, obj_val: 53.880287170410156, abs dis: 2.9999237060546875
[rfa agg] iter: 2, weight: tensor([0.1956, 0.0424, 0.0301, 0.1932, 0.0837, 0.0835, 0.1088, 0.0611, 0.1404,
        0.0613])
[rfa agg] iter:  3, prev_obj_val: 53.880287170410156, obj_val: 50.8802375793457, abs dis: 3.000049591064453
[rfa agg] iter: 3, weight: tensor([0.1747, 0.0519, 0.0362, 0.1724, 0.1103, 0.0852, 0.1070, 0.0642, 0.1336,
        0.0644])
[rfa agg] iter:  4, prev_obj_val: 50.8802375793457, obj_val: 53.880271911621094, abs dis: 3.0000343322753906
[rfa agg] iter: 4, weight: tensor([0.1953, 0.0424, 0.0301, 0.1928, 0.0839, 0.0835, 0.1089, 0.0611, 0.1406,
        0.0613])
[rfa agg] iter:  5, prev_obj_val: 53.880271911621094, obj_val: 50.8802375793457, abs dis: 3.0000343322753906
[rfa agg] iter: 5, weight: tensor([0.1747, 0.0519, 0.0362, 0.1724, 0.1103, 0.0852, 0.1070, 0.0642, 0.1336,
        0.0644])
[rfa agg] iter:  6, prev_obj_val: 50.8802375793457, obj_val: 53.880271911621094, abs dis: 3.0000343322753906
[rfa agg] iter: 6, weight: tensor([0.1953, 0.0424, 0.0301, 0.1928, 0.0839, 0.0835, 0.1089, 0.0611, 0.1406,
        0.0613])
[rfa agg] iter:  7, prev_obj_val: 53.880271911621094, obj_val: 50.8802375793457, abs dis: 3.0000343322753906
[rfa agg] iter: 7, weight: tensor([0.1747, 0.0519, 0.0362, 0.1724, 0.1103, 0.0852, 0.1070, 0.0642, 0.1336,
        0.0644])
[rfa agg] iter:  8, prev_obj_val: 50.8802375793457, obj_val: 53.880271911621094, abs dis: 3.0000343322753906
[rfa agg] iter: 8, weight: tensor([0.1953, 0.0424, 0.0301, 0.1928, 0.0839, 0.0835, 0.1089, 0.0611, 0.1406,
        0.0613])
[rfa agg] iter:  9, prev_obj_val: 53.880271911621094, obj_val: 50.8802375793457, abs dis: 3.0000343322753906
[rfa agg] iter: 9, weight: tensor([0.1747, 0.0519, 0.0362, 0.1724, 0.1103, 0.0852, 0.1070, 0.0642, 0.1336,
        0.0644])
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3162, Accuracy: 93/10000 (0.9300%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 4.5762, Accuracy: 395/9950 (3.9698%)
saving model
Done in 513.3406689167023 sec.
Server Epoch:100 choose agents : [68, 28, 58, 41, 78, 29, 94, 45, 73, 15].
_Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   1, Avg loss: 0.0600, Accuracy: 351/1163 (30.1806%)
_Train Local_ResNet_18, epoch 100, local model 68, internal_epoch   2, Avg loss: 0.0340, Accuracy: 506/1163 (43.5082%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.3075, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   1, Avg loss: 0.0539, Accuracy: 446/1581 (28.2100%)
_Train Local_ResNet_18, epoch 100, local model 28, internal_epoch   2, Avg loss: 0.0310, Accuracy: 691/1581 (43.7065%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.6195, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0590, Accuracy: 310/803 (38.6052%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0327, Accuracy: 411/803 (51.1831%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.5099, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   1, Avg loss: 0.0550, Accuracy: 304/719 (42.2809%)
_Train Local_ResNet_18, epoch 100, local model 41, internal_epoch   2, Avg loss: 0.0290, Accuracy: 452/719 (62.8651%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.4088, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   1, Avg loss: 0.0812, Accuracy: 55/416 (13.2212%)
_Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   2, Avg loss: 0.0411, Accuracy: 238/416 (57.2115%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.2641, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 484/1440 (33.6111%)
_Train Local_ResNet_18, epoch 100, local model 29, internal_epoch   2, Avg loss: 0.0251, Accuracy: 771/1440 (53.5417%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.9611, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   1, Avg loss: 0.0538, Accuracy: 427/1662 (25.6919%)
_Train Local_ResNet_18, epoch 100, local model 94, internal_epoch   2, Avg loss: 0.0303, Accuracy: 699/1662 (42.0578%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.2312, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   1, Avg loss: 0.0592, Accuracy: 254/669 (37.9671%)
_Train Local_ResNet_18, epoch 100, local model 45, internal_epoch   2, Avg loss: 0.0350, Accuracy: 373/669 (55.7549%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.8893, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   1, Avg loss: 0.0590, Accuracy: 213/938 (22.7079%)
_Train Local_ResNet_18, epoch 100, local model 73, internal_epoch   2, Avg loss: 0.0307, Accuracy: 380/938 (40.5117%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.0147, Accuracy: 62/10000 (0.6200%)
poison local model 15 index 6 
_Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   1, Avg loss: 0.0536, Accuracy: 357/1154 (30.9359%)
_Train Local_ResNet_18, epoch 100, local model 15, internal_epoch   2, Avg loss: 0.0256, Accuracy: 589/1154 (51.0399%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 10.6257, Accuracy: 83/10000 (0.8300%)
time spent on training: 307.6977400779724
[rfa agg] training data poison_ratio: 0.1094357515410147  data num: [1163, 1581, 803, 719, 416, 1440, 1662, 669, 938, 1154]
[rfa agg] considering poison per batch poison_fraction: 0.034198672356567095
[rfa agg] init. name: [68, 28, 58, 41, 78, 29, 94, 45, 73, 15], weight: tensor([0.1103, 0.1499, 0.0761, 0.0682, 0.0394, 0.1366, 0.1576, 0.0634, 0.0890,
        0.1094])
[rfa agg] iter:  0, prev_obj_val: 49.556583404541016, obj_val: 54.00277328491211, abs dis: 4.446189880371094
[rfa agg] iter: 0, weight: tensor([0.2102, 0.0743, 0.0752, 0.0537, 0.0157, 0.0898, 0.0694, 0.0418, 0.1682,
        0.2017])
[rfa agg] iter:  1, prev_obj_val: 54.00277328491211, obj_val: 57.68053436279297, abs dis: 3.6777610778808594
[rfa agg] iter: 1, weight: tensor([0.1071, 0.0541, 0.1023, 0.0655, 0.0159, 0.0622, 0.0514, 0.0478, 0.3885,
        0.1053])
[rfa agg] iter:  2, prev_obj_val: 57.68053436279297, obj_val: 62.235877990722656, abs dis: 4.5553436279296875
[rfa agg] iter: 2, weight: tensor([0.0752, 0.0441, 0.1478, 0.0809, 0.0162, 0.0495, 0.0423, 0.0549, 0.4149,
        0.0741])
[rfa agg] iter:  3, prev_obj_val: 62.235877990722656, obj_val: 62.178321838378906, abs dis: 0.05755615234375
[rfa agg] iter: 3, weight: tensor([0.0636, 0.0416, 0.3361, 0.1303, 0.0193, 0.0457, 0.0402, 0.0778, 0.1826,
        0.0628])
[rfa agg] iter:  4, prev_obj_val: 62.178321838378906, obj_val: 64.61449432373047, abs dis: 2.4361724853515625
[rfa agg] iter: 4, weight: tensor([0.0605, 0.0395, 0.3717, 0.1266, 0.0184, 0.0435, 0.0382, 0.0743, 0.1675,
        0.0598])
[rfa agg] iter:  5, prev_obj_val: 64.61449432373047, obj_val: 70.60598754882812, abs dis: 5.991493225097656
[rfa agg] iter: 5, weight: tensor([0.0427, 0.0292, 0.5079, 0.1332, 0.0153, 0.0318, 0.0283, 0.0699, 0.0995,
        0.0422])
[rfa agg] iter:  6, prev_obj_val: 70.60598754882812, obj_val: 77.60889434814453, abs dis: 7.002906799316406
[rfa agg] iter: 6, weight: tensor([0.0472, 0.0347, 0.2212, 0.3143, 0.0236, 0.0372, 0.0338, 0.1543, 0.0871,
        0.0467])
[rfa agg] iter:  7, prev_obj_val: 77.60889434814453, obj_val: 77.56465911865234, abs dis: 0.0442352294921875
[rfa agg] iter: 7, weight: tensor([0.0484, 0.0376, 0.1309, 0.2129, 0.0344, 0.0400, 0.0369, 0.3338, 0.0772,
        0.0479])
[rfa agg] iter:  8, prev_obj_val: 77.56465911865234, obj_val: 77.55941772460938, abs dis: 0.00524139404296875
[rfa agg] iter: 8, weight: tensor([0.0444, 0.0345, 0.1192, 0.1862, 0.0316, 0.0367, 0.0339, 0.3987, 0.0708,
        0.0439])
[rfa agg] iter:  9, prev_obj_val: 77.55941772460938, obj_val: 77.55847930908203, abs dis: 0.00093841552734375
[rfa agg] iter: 9, weight: tensor([0.0426, 0.0332, 0.1142, 0.1759, 0.0304, 0.0352, 0.0325, 0.4256, 0.0680,
        0.0422])
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3152, Accuracy: 93/10000 (0.9300%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 4.5738, Accuracy: 487/9950 (4.8945%)
saving model
Done in 553.487619638443 sec.
Saving all the graphs.
This run has a label: Jun.27_22.33.09. Visdom environment: tiny
