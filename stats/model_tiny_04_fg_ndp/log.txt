current path: saved_models/model_tiny_Jun.28_18.51.58
Loading data
Successfully loaded data from tiny-imagenet-200
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [0, 20, 74, 95]
We use following environment for graphs:  tiny
Server Epoch:1 choose agents : [85, 87, 65, 98, 55, 56, 28, 94, 16, 80].
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   1, Avg loss: 0.0546, Accuracy: 438/1988 (22.0322%)
_Train Local_ResNet_18, epoch   1, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 655/1988 (32.9477%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 9.0255, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   1, local model 87, internal_epoch   1, Avg loss: 0.0584, Accuracy: 291/1131 (25.7294%)
_Train Local_ResNet_18, epoch   1, local model 87, internal_epoch   2, Avg loss: 0.0321, Accuracy: 395/1131 (34.9248%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5141, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 390/1475 (26.4407%)
_Train Local_ResNet_18, epoch   1, local model 65, internal_epoch   2, Avg loss: 0.0325, Accuracy: 634/1475 (42.9831%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.3037, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   1, Avg loss: 0.0832, Accuracy: 6/373 (1.6086%)
_Train Local_ResNet_18, epoch   1, local model 98, internal_epoch   2, Avg loss: 0.0491, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.4296, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   1, Avg loss: 0.0572, Accuracy: 244/1071 (22.7824%)
_Train Local_ResNet_18, epoch   1, local model 55, internal_epoch   2, Avg loss: 0.0292, Accuracy: 485/1071 (45.2848%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.7153, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   1, Avg loss: 0.0834, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   1, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 60/186 (32.2581%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3122, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   1, Avg loss: 0.0570, Accuracy: 353/1581 (22.3276%)
_Train Local_ResNet_18, epoch   1, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 622/1581 (39.3422%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.5549, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   1, Avg loss: 0.0559, Accuracy: 325/1662 (19.5548%)
_Train Local_ResNet_18, epoch   1, local model 94, internal_epoch   2, Avg loss: 0.0339, Accuracy: 595/1662 (35.8002%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 7.6042, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   1, Avg loss: 0.0645, Accuracy: 267/708 (37.7119%)
_Train Local_ResNet_18, epoch   1, local model 16, internal_epoch   2, Avg loss: 0.0351, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.7276, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   1, local model 80, internal_epoch   1, Avg loss: 0.0708, Accuracy: 136/682 (19.9413%)
_Train Local_ResNet_18, epoch   1, local model 80, internal_epoch   2, Avg loss: 0.0386, Accuracy: 245/682 (35.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 1, Avg loss: 6.1649, Accuracy: 53/10000 (0.5300%)
time spent on training: 108.18455171585083
[foolsgold agg] training data poison_ratio: 0.0  data num: [1988, 1131, 1475, 373, 1071, 186, 1581, 1662, 708, 682]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 1, Avg loss: 5.3169, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 1, Avg loss: 5.6217, Accuracy: 0/9950 (0.0000%)
saving model
Done in 198.63838863372803 sec.
Server Epoch:2 choose agents : [65, 48, 44, 24, 25, 20, 86, 29, 7, 95].
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   1, Avg loss: 0.0555, Accuracy: 390/1475 (26.4407%)
_Train Local_ResNet_18, epoch   2, local model 65, internal_epoch   2, Avg loss: 0.0318, Accuracy: 663/1475 (44.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8575, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   1, Avg loss: 0.0716, Accuracy: 80/631 (12.6783%)
_Train Local_ResNet_18, epoch   2, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 212/631 (33.5975%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.8022, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   1, Avg loss: 0.0598, Accuracy: 395/1750 (22.5714%)
_Train Local_ResNet_18, epoch   2, local model 44, internal_epoch   2, Avg loss: 0.0355, Accuracy: 662/1750 (37.8286%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.7740, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   1, Avg loss: 0.0777, Accuracy: 19/312 (6.0897%)
_Train Local_ResNet_18, epoch   2, local model 24, internal_epoch   2, Avg loss: 0.0420, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3870, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   1, Avg loss: 0.0578, Accuracy: 303/690 (43.9130%)
_Train Local_ResNet_18, epoch   2, local model 25, internal_epoch   2, Avg loss: 0.0283, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.3135, Accuracy: 56/10000 (0.5600%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   1, Avg loss: 0.0572, Accuracy: 345/807 (42.7509%)
_Train Local_ResNet_18, epoch   2, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 428/807 (53.0359%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.8288, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 86, internal_epoch   1, Avg loss: 0.0645, Accuracy: 351/1003 (34.9950%)
_Train Local_ResNet_18, epoch   2, local model 86, internal_epoch   2, Avg loss: 0.0343, Accuracy: 386/1003 (38.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 6.6017, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   1, Avg loss: 0.0491, Accuracy: 422/1440 (29.3056%)
_Train Local_ResNet_18, epoch   2, local model 29, internal_epoch   2, Avg loss: 0.0282, Accuracy: 652/1440 (45.2778%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.7051, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   1, Avg loss: 0.0535, Accuracy: 345/891 (38.7205%)
_Train Local_ResNet_18, epoch   2, local model 7, internal_epoch   2, Avg loss: 0.0262, Accuracy: 437/891 (49.0460%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.1280, Accuracy: 55/10000 (0.5500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 326/599 (54.4240%)
_Train Local_ResNet_18, epoch   2, local model 95, internal_epoch   2, Avg loss: 0.0297, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 2, Avg loss: 7.5079, Accuracy: 50/10000 (0.5000%)
time spent on training: 170.85380339622498
[foolsgold agg] training data poison_ratio: 0.14648885184413418  data num: [1475, 631, 1750, 312, 690, 807, 1003, 1440, 891, 599]
[foolsgold agg] considering poison per batch poison_fraction: 0.04577776620129193
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 2, Avg loss: 5.3168, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 2, Avg loss: 5.6200, Accuracy: 0/9950 (0.0000%)
saving model
Done in 261.2288122177124 sec.
Server Epoch:3 choose agents : [77, 59, 8, 86, 97, 14, 4, 70, 96, 11].
_Train Local_ResNet_18, epoch   3, local model 77, internal_epoch   1, Avg loss: 0.0542, Accuracy: 311/1340 (23.2090%)
_Train Local_ResNet_18, epoch   3, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 592/1340 (44.1791%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.6456, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   1, Avg loss: 0.0535, Accuracy: 298/1089 (27.3646%)
_Train Local_ResNet_18, epoch   3, local model 59, internal_epoch   2, Avg loss: 0.0286, Accuracy: 412/1089 (37.8329%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.4261, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   1, Avg loss: 0.0605, Accuracy: 227/1513 (15.0033%)
_Train Local_ResNet_18, epoch   3, local model 8, internal_epoch   2, Avg loss: 0.0370, Accuracy: 472/1513 (31.1963%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.4091, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   3, local model 86, internal_epoch   1, Avg loss: 0.0641, Accuracy: 354/1003 (35.2941%)
_Train Local_ResNet_18, epoch   3, local model 86, internal_epoch   2, Avg loss: 0.0347, Accuracy: 383/1003 (38.1854%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.6516, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 97, internal_epoch   1, Avg loss: 0.0523, Accuracy: 348/1213 (28.6892%)
_Train Local_ResNet_18, epoch   3, local model 97, internal_epoch   2, Avg loss: 0.0269, Accuracy: 537/1213 (44.2704%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.5696, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   1, Avg loss: 0.0632, Accuracy: 212/1013 (20.9279%)
_Train Local_ResNet_18, epoch   3, local model 14, internal_epoch   2, Avg loss: 0.0362, Accuracy: 317/1013 (31.2932%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.6144, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   1, Avg loss: 0.0621, Accuracy: 324/901 (35.9600%)
_Train Local_ResNet_18, epoch   3, local model 4, internal_epoch   2, Avg loss: 0.0336, Accuracy: 422/901 (46.8368%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.7055, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 320/1418 (22.5670%)
_Train Local_ResNet_18, epoch   3, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 661/1418 (46.6150%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 7.8644, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch   3, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 46/311 (14.7910%)
_Train Local_ResNet_18, epoch   3, local model 96, internal_epoch   2, Avg loss: 0.0541, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3432, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   1, Avg loss: 0.0548, Accuracy: 343/712 (48.1742%)
_Train Local_ResNet_18, epoch   3, local model 11, internal_epoch   2, Avg loss: 0.0265, Accuracy: 433/712 (60.8146%)
_Test Local_ResNet_18 poisoned: False, epoch: 3, Avg loss: 6.3720, Accuracy: 50/10000 (0.5000%)
time spent on training: 173.54887294769287
[foolsgold agg] training data poison_ratio: 0.0  data num: [1340, 1089, 1513, 1003, 1213, 1013, 901, 1418, 311, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 3, Avg loss: 5.3167, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 3, Avg loss: 5.6202, Accuracy: 0/9950 (0.0000%)
saving model
Done in 261.2513747215271 sec.
Server Epoch:4 choose agents : [21, 65, 32, 77, 7, 24, 41, 52, 13, 64].
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 394/1949 (20.2155%)
_Train Local_ResNet_18, epoch   4, local model 21, internal_epoch   2, Avg loss: 0.0329, Accuracy: 650/1949 (33.3504%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 9.1547, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   1, Avg loss: 0.0580, Accuracy: 398/1475 (26.9831%)
_Train Local_ResNet_18, epoch   4, local model 65, internal_epoch   2, Avg loss: 0.0323, Accuracy: 598/1475 (40.5424%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.0103, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   1, Avg loss: 0.0607, Accuracy: 191/735 (25.9864%)
_Train Local_ResNet_18, epoch   4, local model 32, internal_epoch   2, Avg loss: 0.0236, Accuracy: 338/735 (45.9864%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 8.2651, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   1, Avg loss: 0.0544, Accuracy: 311/1340 (23.2090%)
_Train Local_ResNet_18, epoch   4, local model 77, internal_epoch   2, Avg loss: 0.0279, Accuracy: 534/1340 (39.8507%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.7752, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 354/891 (39.7306%)
_Train Local_ResNet_18, epoch   4, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 450/891 (50.5051%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.0660, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   1, Avg loss: 0.0772, Accuracy: 25/312 (8.0128%)
_Train Local_ResNet_18, epoch   4, local model 24, internal_epoch   2, Avg loss: 0.0408, Accuracy: 170/312 (54.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3842, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   1, Avg loss: 0.0630, Accuracy: 317/719 (44.0890%)
_Train Local_ResNet_18, epoch   4, local model 41, internal_epoch   2, Avg loss: 0.0300, Accuracy: 454/719 (63.1433%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.1095, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   1, Avg loss: 0.0579, Accuracy: 271/636 (42.6101%)
_Train Local_ResNet_18, epoch   4, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.1133, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   1, Avg loss: 0.0584, Accuracy: 331/1645 (20.1216%)
_Train Local_ResNet_18, epoch   4, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 606/1645 (36.8389%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 7.8346, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 169/953 (17.7335%)
_Train Local_ResNet_18, epoch   4, local model 64, internal_epoch   2, Avg loss: 0.0382, Accuracy: 323/953 (33.8930%)
_Test Local_ResNet_18 poisoned: False, epoch: 4, Avg loss: 6.3467, Accuracy: 77/10000 (0.7700%)
time spent on training: 156.84826493263245
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 1475, 735, 1340, 891, 312, 719, 636, 1645, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 4, Avg loss: 5.3166, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 4, Avg loss: 5.6136, Accuracy: 0/9950 (0.0000%)
saving model
Done in 245.9908745288849 sec.
Server Epoch:5 choose agents : [62, 99, 55, 2, 52, 21, 47, 94, 92, 84].
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   1, Avg loss: 0.0692, Accuracy: 139/568 (24.4718%)
_Train Local_ResNet_18, epoch   5, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.7555, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   1, Avg loss: 0.0697, Accuracy: 169/773 (21.8629%)
_Train Local_ResNet_18, epoch   5, local model 99, internal_epoch   2, Avg loss: 0.0305, Accuracy: 385/773 (49.8060%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.2459, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   1, Avg loss: 0.0571, Accuracy: 228/1071 (21.2885%)
_Train Local_ResNet_18, epoch   5, local model 55, internal_epoch   2, Avg loss: 0.0300, Accuracy: 484/1071 (45.1914%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.8583, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 229/605 (37.8512%)
_Train Local_ResNet_18, epoch   5, local model 2, internal_epoch   2, Avg loss: 0.0396, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.8283, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   1, Avg loss: 0.0570, Accuracy: 271/636 (42.6101%)
_Train Local_ResNet_18, epoch   5, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 6.1765, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 429/1949 (22.0113%)
_Train Local_ResNet_18, epoch   5, local model 21, internal_epoch   2, Avg loss: 0.0324, Accuracy: 654/1949 (33.5557%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 8.0836, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   1, Avg loss: 0.1239, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch   5, local model 47, internal_epoch   2, Avg loss: 0.1074, Accuracy: 23/134 (17.1642%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3114, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   5, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 338/1662 (20.3369%)
_Train Local_ResNet_18, epoch   5, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 598/1662 (35.9807%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.9112, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   1, Avg loss: 0.0521, Accuracy: 474/1715 (27.6385%)
_Train Local_ResNet_18, epoch   5, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 708/1715 (41.2828%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.5669, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch   5, local model 84, internal_epoch   1, Avg loss: 0.0629, Accuracy: 324/1190 (27.2269%)
_Train Local_ResNet_18, epoch   5, local model 84, internal_epoch   2, Avg loss: 0.0323, Accuracy: 447/1190 (37.5630%)
_Test Local_ResNet_18 poisoned: False, epoch: 5, Avg loss: 7.0280, Accuracy: 56/10000 (0.5600%)
time spent on training: 152.4700047969818
[foolsgold agg] training data poison_ratio: 0.0  data num: [568, 773, 1071, 605, 636, 1949, 134, 1662, 1715, 1190]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.        1.        1.        0.7260573 1.        1.        0.7260573
 1.        1.        1.       ]
_Test Target_ResNet_18 poisoned: False, epoch: 5, Avg loss: 5.3164, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 5, Avg loss: 5.6128, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.05221509933472 sec.
Server Epoch:6 choose agents : [42, 86, 96, 97, 56, 87, 53, 33, 44, 98].
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   1, Avg loss: 0.0534, Accuracy: 351/1372 (25.5831%)
_Train Local_ResNet_18, epoch   6, local model 42, internal_epoch   2, Avg loss: 0.0317, Accuracy: 487/1372 (35.4956%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.8668, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   1, Avg loss: 0.0625, Accuracy: 360/1003 (35.8923%)
_Train Local_ResNet_18, epoch   6, local model 86, internal_epoch   2, Avg loss: 0.0349, Accuracy: 369/1003 (36.7896%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 6.5447, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   1, Avg loss: 0.0790, Accuracy: 40/311 (12.8617%)
_Train Local_ResNet_18, epoch   6, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3477, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 97, internal_epoch   1, Avg loss: 0.0533, Accuracy: 358/1213 (29.5136%)
_Train Local_ResNet_18, epoch   6, local model 97, internal_epoch   2, Avg loss: 0.0277, Accuracy: 474/1213 (39.0767%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.4124, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   1, Avg loss: 0.0828, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch   6, local model 56, internal_epoch   2, Avg loss: 0.0677, Accuracy: 62/186 (33.3333%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3122, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 87, internal_epoch   1, Avg loss: 0.0583, Accuracy: 283/1131 (25.0221%)
_Train Local_ResNet_18, epoch   6, local model 87, internal_epoch   2, Avg loss: 0.0321, Accuracy: 405/1131 (35.8090%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.7706, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   1, Avg loss: 0.0499, Accuracy: 284/813 (34.9323%)
_Train Local_ResNet_18, epoch   6, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 430/813 (52.8905%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 9.0768, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   1, Avg loss: 0.0781, Accuracy: 66/515 (12.8155%)
_Train Local_ResNet_18, epoch   6, local model 33, internal_epoch   2, Avg loss: 0.0507, Accuracy: 138/515 (26.7961%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.8652, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 397/1750 (22.6857%)
_Train Local_ResNet_18, epoch   6, local model 44, internal_epoch   2, Avg loss: 0.0352, Accuracy: 647/1750 (36.9714%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 7.4718, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch   6, local model 98, internal_epoch   1, Avg loss: 0.0828, Accuracy: 14/373 (3.7534%)
_Train Local_ResNet_18, epoch   6, local model 98, internal_epoch   2, Avg loss: 0.0488, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.4234, Accuracy: 50/10000 (0.5000%)
time spent on training: 115.59443283081055
[foolsgold agg] training data poison_ratio: 0.0  data num: [1372, 1003, 311, 1213, 186, 1131, 813, 515, 1750, 373]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 6, Avg loss: 5.3164, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 6, Avg loss: 5.6131, Accuracy: 0/9950 (0.0000%)
saving model
Done in 205.25242257118225 sec.
Server Epoch:7 choose agents : [55, 61, 33, 24, 70, 53, 81, 85, 10, 92].
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 258/1071 (24.0896%)
_Train Local_ResNet_18, epoch   7, local model 55, internal_epoch   2, Avg loss: 0.0295, Accuracy: 500/1071 (46.6853%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.6658, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   1, Avg loss: 0.1279, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   7, local model 61, internal_epoch   2, Avg loss: 0.1183, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3046, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   1, Avg loss: 0.0774, Accuracy: 63/515 (12.2330%)
_Train Local_ResNet_18, epoch   7, local model 33, internal_epoch   2, Avg loss: 0.0507, Accuracy: 118/515 (22.9126%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.6940, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   1, Avg loss: 0.0767, Accuracy: 34/312 (10.8974%)
_Train Local_ResNet_18, epoch   7, local model 24, internal_epoch   2, Avg loss: 0.0415, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3869, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   1, Avg loss: 0.0570, Accuracy: 325/1418 (22.9196%)
_Train Local_ResNet_18, epoch   7, local model 70, internal_epoch   2, Avg loss: 0.0312, Accuracy: 603/1418 (42.5247%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.4758, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   1, Avg loss: 0.0501, Accuracy: 274/813 (33.7023%)
_Train Local_ResNet_18, epoch   7, local model 53, internal_epoch   2, Avg loss: 0.0190, Accuracy: 443/813 (54.4895%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 9.0612, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch   7, local model 81, internal_epoch   1, Avg loss: 0.0688, Accuracy: 230/774 (29.7158%)
_Train Local_ResNet_18, epoch   7, local model 81, internal_epoch   2, Avg loss: 0.0382, Accuracy: 276/774 (35.6589%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 6.2450, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   1, Avg loss: 0.0542, Accuracy: 423/1988 (21.2777%)
_Train Local_ResNet_18, epoch   7, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 663/1988 (33.3501%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.7345, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 197/861 (22.8804%)
_Train Local_ResNet_18, epoch   7, local model 10, internal_epoch   2, Avg loss: 0.0225, Accuracy: 436/861 (50.6388%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 8.1418, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   7, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 484/1715 (28.2216%)
_Train Local_ResNet_18, epoch   7, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 714/1715 (41.6327%)
_Test Local_ResNet_18 poisoned: False, epoch: 7, Avg loss: 7.3925, Accuracy: 91/10000 (0.9100%)
time spent on training: 139.80478477478027
[foolsgold agg] training data poison_ratio: 0.0  data num: [1071, 85, 515, 312, 1418, 813, 774, 1988, 861, 1715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 7, Avg loss: 5.3164, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 7, Avg loss: 5.6134, Accuracy: 0/9950 (0.0000%)
saving model
Done in 227.81469655036926 sec.
Server Epoch:8 choose agents : [65, 24, 13, 1, 59, 29, 46, 17, 12, 63].
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   1, Avg loss: 0.0548, Accuracy: 414/1475 (28.0678%)
_Train Local_ResNet_18, epoch   8, local model 65, internal_epoch   2, Avg loss: 0.0314, Accuracy: 681/1475 (46.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 6.8643, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   1, Avg loss: 0.0769, Accuracy: 39/312 (12.5000%)
_Train Local_ResNet_18, epoch   8, local model 24, internal_epoch   2, Avg loss: 0.0406, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3865, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   1, Avg loss: 0.0582, Accuracy: 307/1645 (18.6626%)
_Train Local_ResNet_18, epoch   8, local model 13, internal_epoch   2, Avg loss: 0.0332, Accuracy: 591/1645 (35.9271%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2078, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   1, Avg loss: 0.0565, Accuracy: 279/928 (30.0647%)
_Train Local_ResNet_18, epoch   8, local model 1, internal_epoch   2, Avg loss: 0.0239, Accuracy: 570/928 (61.4224%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.4013, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   1, Avg loss: 0.0525, Accuracy: 321/1089 (29.4766%)
_Train Local_ResNet_18, epoch   8, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 462/1089 (42.4242%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.3684, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   1, Avg loss: 0.0486, Accuracy: 428/1440 (29.7222%)
_Train Local_ResNet_18, epoch   8, local model 29, internal_epoch   2, Avg loss: 0.0280, Accuracy: 669/1440 (46.4583%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.6279, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   1, Avg loss: 0.0550, Accuracy: 431/1904 (22.6366%)
_Train Local_ResNet_18, epoch   8, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 680/1904 (35.7143%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 7.6519, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   1, Avg loss: 0.0511, Accuracy: 411/1574 (26.1118%)
_Train Local_ResNet_18, epoch   8, local model 17, internal_epoch   2, Avg loss: 0.0277, Accuracy: 665/1574 (42.2490%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2798, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   1, Avg loss: 0.0875, Accuracy: 16/338 (4.7337%)
_Train Local_ResNet_18, epoch   8, local model 12, internal_epoch   2, Avg loss: 0.0489, Accuracy: 146/338 (43.1953%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.4479, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   1, Avg loss: 0.0544, Accuracy: 252/888 (28.3784%)
_Train Local_ResNet_18, epoch   8, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 429/888 (48.3108%)
_Test Local_ResNet_18 poisoned: False, epoch: 8, Avg loss: 8.2886, Accuracy: 50/10000 (0.5000%)
time spent on training: 186.56325101852417
[foolsgold agg] training data poison_ratio: 0.0  data num: [1475, 312, 1645, 928, 1089, 1440, 1904, 1574, 338, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 8, Avg loss: 5.3162, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 8, Avg loss: 5.6119, Accuracy: 0/9950 (0.0000%)
saving model
Done in 273.8432517051697 sec.
Server Epoch:9 choose agents : [38, 86, 61, 13, 89, 20, 52, 78, 37, 94].
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   1, Avg loss: 0.0624, Accuracy: 248/1131 (21.9275%)
_Train Local_ResNet_18, epoch   9, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 483/1131 (42.7056%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.2664, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch   9, local model 86, internal_epoch   1, Avg loss: 0.0646, Accuracy: 355/1003 (35.3938%)
_Train Local_ResNet_18, epoch   9, local model 86, internal_epoch   2, Avg loss: 0.0351, Accuracy: 368/1003 (36.6899%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.7365, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   1, Avg loss: 0.1247, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch   9, local model 61, internal_epoch   2, Avg loss: 0.1170, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3046, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   1, Avg loss: 0.0581, Accuracy: 321/1645 (19.5137%)
_Train Local_ResNet_18, epoch   9, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 615/1645 (37.3860%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7124, Accuracy: 129/10000 (1.2900%)
_Train Local_ResNet_18, epoch   9, local model 89, internal_epoch   1, Avg loss: 0.0619, Accuracy: 322/896 (35.9375%)
_Train Local_ResNet_18, epoch   9, local model 89, internal_epoch   2, Avg loss: 0.0328, Accuracy: 443/896 (49.4420%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.1428, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch   9, local model 20, internal_epoch   1, Avg loss: 0.0564, Accuracy: 345/807 (42.7509%)
_Train Local_ResNet_18, epoch   9, local model 20, internal_epoch   2, Avg loss: 0.0319, Accuracy: 424/807 (52.5403%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.5274, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   1, Avg loss: 0.0561, Accuracy: 284/636 (44.6541%)
_Train Local_ResNet_18, epoch   9, local model 52, internal_epoch   2, Avg loss: 0.0315, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 6.4334, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 78, internal_epoch   1, Avg loss: 0.0842, Accuracy: 34/416 (8.1731%)
_Train Local_ResNet_18, epoch   9, local model 78, internal_epoch   2, Avg loss: 0.0469, Accuracy: 161/416 (38.7019%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.5775, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   1, Avg loss: 0.0531, Accuracy: 379/1129 (33.5695%)
_Train Local_ResNet_18, epoch   9, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 748/1129 (66.2533%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.3498, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch   9, local model 94, internal_epoch   1, Avg loss: 0.0553, Accuracy: 343/1662 (20.6378%)
_Train Local_ResNet_18, epoch   9, local model 94, internal_epoch   2, Avg loss: 0.0337, Accuracy: 586/1662 (35.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 9, Avg loss: 7.7770, Accuracy: 102/10000 (1.0200%)
time spent on training: 168.84640645980835
[foolsgold agg] training data poison_ratio: 0.08575982996811903  data num: [1131, 1003, 85, 1645, 896, 807, 636, 416, 1129, 1662]
[foolsgold agg] considering poison per batch poison_fraction: 0.026799946865037196
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 9, Avg loss: 5.3161, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 9, Avg loss: 5.6117, Accuracy: 0/9950 (0.0000%)
saving model
Done in 260.2644782066345 sec.
Server Epoch:10 choose agents : [72, 15, 56, 44, 90, 31, 57, 99, 20, 6].
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   1, Avg loss: 0.0624, Accuracy: 240/1241 (19.3392%)
_Train Local_ResNet_18, epoch  10, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 422/1241 (34.0048%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.0669, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   1, Avg loss: 0.0556, Accuracy: 324/1154 (28.0763%)
_Train Local_ResNet_18, epoch  10, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 506/1154 (43.8475%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6432, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  10, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3120, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   1, Avg loss: 0.0591, Accuracy: 384/1750 (21.9429%)
_Train Local_ResNet_18, epoch  10, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 664/1750 (37.9429%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.6248, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  10, local model 90, internal_epoch   1, Avg loss: 0.0584, Accuracy: 308/677 (45.4948%)
_Train Local_ResNet_18, epoch  10, local model 90, internal_epoch   2, Avg loss: 0.0244, Accuracy: 416/677 (61.4476%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.9592, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   1, Avg loss: 0.0822, Accuracy: 54/460 (11.7391%)
_Train Local_ResNet_18, epoch  10, local model 31, internal_epoch   2, Avg loss: 0.0383, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.6926, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   1, Avg loss: 0.0562, Accuracy: 289/1154 (25.0433%)
_Train Local_ResNet_18, epoch  10, local model 57, internal_epoch   2, Avg loss: 0.0248, Accuracy: 502/1154 (43.5009%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.5305, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   1, Avg loss: 0.0673, Accuracy: 178/773 (23.0272%)
_Train Local_ResNet_18, epoch  10, local model 99, internal_epoch   2, Avg loss: 0.0294, Accuracy: 409/773 (52.9107%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 7.1008, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  10, local model 20, internal_epoch   1, Avg loss: 0.0564, Accuracy: 350/807 (43.3705%)
_Train Local_ResNet_18, epoch  10, local model 20, internal_epoch   2, Avg loss: 0.0320, Accuracy: 415/807 (51.4250%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 6.6270, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   1, Avg loss: 0.0556, Accuracy: 396/1956 (20.2454%)
_Train Local_ResNet_18, epoch  10, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 661/1956 (33.7935%)
_Test Local_ResNet_18 poisoned: False, epoch: 10, Avg loss: 8.3712, Accuracy: 125/10000 (1.2500%)
time spent on training: 150.46851348876953
[foolsgold agg] training data poison_ratio: 0.07944477259303012  data num: [1241, 1154, 186, 1750, 677, 460, 1154, 773, 807, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.024826491435321913
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 10, Avg loss: 5.3160, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 10, Avg loss: 5.6113, Accuracy: 0/9950 (0.0000%)
saving model
Done in 238.25918626785278 sec.
Server Epoch:11 choose agents : [25, 80, 30, 6, 94, 12, 89, 11, 27, 14].
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   1, Avg loss: 0.0570, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch  11, local model 25, internal_epoch   2, Avg loss: 0.0284, Accuracy: 462/690 (66.9565%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.3852, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  11, local model 80, internal_epoch   1, Avg loss: 0.0706, Accuracy: 141/682 (20.6745%)
_Train Local_ResNet_18, epoch  11, local model 80, internal_epoch   2, Avg loss: 0.0381, Accuracy: 244/682 (35.7771%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.3137, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   1, Avg loss: 0.0811, Accuracy: 63/486 (12.9630%)
_Train Local_ResNet_18, epoch  11, local model 30, internal_epoch   2, Avg loss: 0.0422, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.7564, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   1, Avg loss: 0.0557, Accuracy: 415/1956 (21.2168%)
_Train Local_ResNet_18, epoch  11, local model 6, internal_epoch   2, Avg loss: 0.0322, Accuracy: 647/1956 (33.0777%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 8.1017, Accuracy: 111/10000 (1.1100%)
_Train Local_ResNet_18, epoch  11, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 315/1662 (18.9531%)
_Train Local_ResNet_18, epoch  11, local model 94, internal_epoch   2, Avg loss: 0.0335, Accuracy: 607/1662 (36.5223%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.8846, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   1, Avg loss: 0.0874, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch  11, local model 12, internal_epoch   2, Avg loss: 0.0480, Accuracy: 142/338 (42.0118%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.4359, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 89, internal_epoch   1, Avg loss: 0.0608, Accuracy: 323/896 (36.0491%)
_Train Local_ResNet_18, epoch  11, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 464/896 (51.7857%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.2472, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   1, Avg loss: 0.0563, Accuracy: 346/712 (48.5955%)
_Train Local_ResNet_18, epoch  11, local model 11, internal_epoch   2, Avg loss: 0.0279, Accuracy: 408/712 (57.3034%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.3723, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 447/1587 (28.1664%)
_Train Local_ResNet_18, epoch  11, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 623/1587 (39.2565%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 7.1249, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   1, Avg loss: 0.0628, Accuracy: 227/1013 (22.4087%)
_Train Local_ResNet_18, epoch  11, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 302/1013 (29.8124%)
_Test Local_ResNet_18 poisoned: False, epoch: 11, Avg loss: 6.6149, Accuracy: 67/10000 (0.6700%)
time spent on training: 134.59233045578003
[foolsgold agg] training data poison_ratio: 0.0  data num: [690, 682, 486, 1956, 1662, 338, 896, 712, 1587, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 11, Avg loss: 5.3157, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 11, Avg loss: 5.6102, Accuracy: 0/9950 (0.0000%)
saving model
Done in 224.64273142814636 sec.
Server Epoch:12 choose agents : [37, 82, 96, 32, 34, 88, 63, 20, 22, 14].
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   1, Avg loss: 0.0520, Accuracy: 425/1129 (37.6439%)
_Train Local_ResNet_18, epoch  12, local model 37, internal_epoch   2, Avg loss: 0.0252, Accuracy: 728/1129 (64.4818%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.7802, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  12, local model 82, internal_epoch   1, Avg loss: 0.0774, Accuracy: 64/500 (12.8000%)
_Train Local_ResNet_18, epoch  12, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.5872, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  12, local model 96, internal_epoch   1, Avg loss: 0.0785, Accuracy: 49/311 (15.7556%)
_Train Local_ResNet_18, epoch  12, local model 96, internal_epoch   2, Avg loss: 0.0535, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3477, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   1, Avg loss: 0.0608, Accuracy: 196/735 (26.6667%)
_Train Local_ResNet_18, epoch  12, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 330/735 (44.8980%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.0596, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   1, Avg loss: 0.0588, Accuracy: 389/1427 (27.2600%)
_Train Local_ResNet_18, epoch  12, local model 34, internal_epoch   2, Avg loss: 0.0338, Accuracy: 588/1427 (41.2053%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.9286, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  12, local model 88, internal_epoch   1, Avg loss: 0.0755, Accuracy: 134/603 (22.2222%)
_Train Local_ResNet_18, epoch  12, local model 88, internal_epoch   2, Avg loss: 0.0453, Accuracy: 282/603 (46.7662%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.9066, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 254/888 (28.6036%)
_Train Local_ResNet_18, epoch  12, local model 63, internal_epoch   2, Avg loss: 0.0254, Accuracy: 427/888 (48.0856%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 8.1526, Accuracy: 69/10000 (0.6900%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 350/807 (43.3705%)
_Train Local_ResNet_18, epoch  12, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 425/807 (52.6642%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.2051, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   1, Avg loss: 0.0467, Accuracy: 499/1470 (33.9456%)
_Train Local_ResNet_18, epoch  12, local model 22, internal_epoch   2, Avg loss: 0.0236, Accuracy: 822/1470 (55.9184%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 7.8061, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   1, Avg loss: 0.0619, Accuracy: 226/1013 (22.3100%)
_Train Local_ResNet_18, epoch  12, local model 14, internal_epoch   2, Avg loss: 0.0361, Accuracy: 319/1013 (31.4906%)
_Test Local_ResNet_18 poisoned: False, epoch: 12, Avg loss: 6.6730, Accuracy: 56/10000 (0.5600%)
time spent on training: 133.35126304626465
[foolsgold agg] training data poison_ratio: 0.09084768659236744  data num: [1129, 500, 311, 735, 1427, 603, 888, 807, 1470, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.028389902060114824
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 12, Avg loss: 5.3156, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 12, Avg loss: 5.6058, Accuracy: 0/9950 (0.0000%)
saving model
Done in 222.2448446750641 sec.
Server Epoch:13 choose agents : [36, 77, 71, 15, 56, 7, 17, 51, 47, 24].
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   1, Avg loss: 0.0871, Accuracy: 72/408 (17.6471%)
_Train Local_ResNet_18, epoch  13, local model 36, internal_epoch   2, Avg loss: 0.0560, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.4612, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 331/1340 (24.7015%)
_Train Local_ResNet_18, epoch  13, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 542/1340 (40.4478%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.7606, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   1, Avg loss: 0.0647, Accuracy: 162/818 (19.8044%)
_Train Local_ResNet_18, epoch  13, local model 71, internal_epoch   2, Avg loss: 0.0306, Accuracy: 374/818 (45.7213%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.0636, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   1, Avg loss: 0.0559, Accuracy: 319/1154 (27.6430%)
_Train Local_ResNet_18, epoch  13, local model 15, internal_epoch   2, Avg loss: 0.0287, Accuracy: 492/1154 (42.6343%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.9067, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   1, Avg loss: 0.0830, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 56, internal_epoch   2, Avg loss: 0.0675, Accuracy: 64/186 (34.4086%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   1, Avg loss: 0.0534, Accuracy: 352/891 (39.5062%)
_Train Local_ResNet_18, epoch  13, local model 7, internal_epoch   2, Avg loss: 0.0266, Accuracy: 460/891 (51.6274%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.1832, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 387/1574 (24.5870%)
_Train Local_ResNet_18, epoch  13, local model 17, internal_epoch   2, Avg loss: 0.0276, Accuracy: 671/1574 (42.6302%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 8.3864, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   1, Avg loss: 0.0612, Accuracy: 225/1049 (21.4490%)
_Train Local_ResNet_18, epoch  13, local model 51, internal_epoch   2, Avg loss: 0.0307, Accuracy: 493/1049 (46.9971%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 7.5981, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   1, Avg loss: 0.1238, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  13, local model 47, internal_epoch   2, Avg loss: 0.1085, Accuracy: 11/134 (8.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3115, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   1, Avg loss: 0.0765, Accuracy: 31/312 (9.9359%)
_Train Local_ResNet_18, epoch  13, local model 24, internal_epoch   2, Avg loss: 0.0404, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3789, Accuracy: 50/10000 (0.5000%)
time spent on training: 154.25713562965393
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 1340, 818, 1154, 186, 891, 1574, 1049, 134, 312]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 13, Avg loss: 5.3154, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 13, Avg loss: 5.6053, Accuracy: 0/9950 (0.0000%)
saving model
Done in 244.89143228530884 sec.
Server Epoch:14 choose agents : [70, 65, 66, 62, 34, 71, 84, 61, 85, 20].
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   1, Avg loss: 0.0557, Accuracy: 359/1418 (25.3173%)
_Train Local_ResNet_18, epoch  14, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 644/1418 (45.4161%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.7459, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   1, Avg loss: 0.0567, Accuracy: 373/1475 (25.2881%)
_Train Local_ResNet_18, epoch  14, local model 65, internal_epoch   2, Avg loss: 0.0307, Accuracy: 696/1475 (47.1864%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8867, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   1, Avg loss: 0.0625, Accuracy: 250/1402 (17.8317%)
_Train Local_ResNet_18, epoch  14, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 363/1402 (25.8916%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.4144, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   1, Avg loss: 0.0690, Accuracy: 144/568 (25.3521%)
_Train Local_ResNet_18, epoch  14, local model 62, internal_epoch   2, Avg loss: 0.0409, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.8002, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   1, Avg loss: 0.0586, Accuracy: 358/1427 (25.0876%)
_Train Local_ResNet_18, epoch  14, local model 34, internal_epoch   2, Avg loss: 0.0338, Accuracy: 568/1427 (39.8038%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8056, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   1, Avg loss: 0.0647, Accuracy: 148/818 (18.0929%)
_Train Local_ResNet_18, epoch  14, local model 71, internal_epoch   2, Avg loss: 0.0310, Accuracy: 330/818 (40.3423%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.0695, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   1, Avg loss: 0.0621, Accuracy: 315/1190 (26.4706%)
_Train Local_ResNet_18, epoch  14, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 471/1190 (39.5798%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 7.0970, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   1, Avg loss: 0.1259, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  14, local model 61, internal_epoch   2, Avg loss: 0.1169, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3044, Accuracy: 43/10000 (0.4300%)
_Train Local_ResNet_18, epoch  14, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 414/1988 (20.8249%)
_Train Local_ResNet_18, epoch  14, local model 85, internal_epoch   2, Avg loss: 0.0348, Accuracy: 671/1988 (33.7525%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 8.0918, Accuracy: 79/10000 (0.7900%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  14, local model 20, internal_epoch   1, Avg loss: 0.0560, Accuracy: 347/807 (42.9988%)
_Train Local_ResNet_18, epoch  14, local model 20, internal_epoch   2, Avg loss: 0.0323, Accuracy: 437/807 (54.1512%)
_Test Local_ResNet_18 poisoned: False, epoch: 14, Avg loss: 6.8450, Accuracy: 50/10000 (0.5000%)
time spent on training: 201.0845503807068
[foolsgold agg] training data poison_ratio: 0.07219538378958669  data num: [1418, 1475, 1402, 568, 1427, 818, 1190, 85, 1988, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.02256105743424584
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 14, Avg loss: 5.3153, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 14, Avg loss: 5.6042, Accuracy: 0/9950 (0.0000%)
saving model
Done in 293.23575091362 sec.
Server Epoch:15 choose agents : [70, 63, 85, 80, 26, 42, 18, 66, 39, 97].
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   1, Avg loss: 0.0564, Accuracy: 345/1418 (24.3300%)
_Train Local_ResNet_18, epoch  15, local model 70, internal_epoch   2, Avg loss: 0.0306, Accuracy: 673/1418 (47.4612%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1206, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   1, Avg loss: 0.0542, Accuracy: 258/888 (29.0541%)
_Train Local_ResNet_18, epoch  15, local model 63, internal_epoch   2, Avg loss: 0.0262, Accuracy: 439/888 (49.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.7456, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  15, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 426/1988 (21.4286%)
_Train Local_ResNet_18, epoch  15, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 650/1988 (32.6962%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.7406, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  15, local model 80, internal_epoch   1, Avg loss: 0.0701, Accuracy: 143/682 (20.9677%)
_Train Local_ResNet_18, epoch  15, local model 80, internal_epoch   2, Avg loss: 0.0377, Accuracy: 258/682 (37.8299%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 6.2593, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   1, Avg loss: 0.0548, Accuracy: 346/1446 (23.9281%)
_Train Local_ResNet_18, epoch  15, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 479/1446 (33.1259%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.3689, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   1, Avg loss: 0.0536, Accuracy: 327/1372 (23.8338%)
_Train Local_ResNet_18, epoch  15, local model 42, internal_epoch   2, Avg loss: 0.0318, Accuracy: 474/1372 (34.5481%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 8.1019, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   1, Avg loss: 0.0770, Accuracy: 111/530 (20.9434%)
_Train Local_ResNet_18, epoch  15, local model 18, internal_epoch   2, Avg loss: 0.0373, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.9760, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 271/1402 (19.3295%)
_Train Local_ResNet_18, epoch  15, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 434/1402 (30.9558%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.1014, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 311/1013 (30.7009%)
_Train Local_ResNet_18, epoch  15, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 512/1013 (50.5429%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.5457, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  15, local model 97, internal_epoch   1, Avg loss: 0.0529, Accuracy: 342/1213 (28.1946%)
_Train Local_ResNet_18, epoch  15, local model 97, internal_epoch   2, Avg loss: 0.0278, Accuracy: 462/1213 (38.0874%)
_Test Local_ResNet_18 poisoned: False, epoch: 15, Avg loss: 7.7807, Accuracy: 80/10000 (0.8000%)
time spent on training: 186.44001722335815
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 888, 1988, 682, 1446, 1372, 530, 1402, 1013, 1213]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 15, Avg loss: 5.3152, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 15, Avg loss: 5.6045, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.83642864227295 sec.
Server Epoch:16 choose agents : [24, 22, 71, 66, 81, 6, 64, 98, 59, 33].
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   1, Avg loss: 0.0766, Accuracy: 36/312 (11.5385%)
_Train Local_ResNet_18, epoch  16, local model 24, internal_epoch   2, Avg loss: 0.0408, Accuracy: 159/312 (50.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3780, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   1, Avg loss: 0.0459, Accuracy: 492/1470 (33.4694%)
_Train Local_ResNet_18, epoch  16, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 841/1470 (57.2109%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.1598, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   1, Avg loss: 0.0645, Accuracy: 166/818 (20.2934%)
_Train Local_ResNet_18, epoch  16, local model 71, internal_epoch   2, Avg loss: 0.0312, Accuracy: 324/818 (39.6088%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.1066, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   1, Avg loss: 0.0619, Accuracy: 261/1402 (18.6163%)
_Train Local_ResNet_18, epoch  16, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 382/1402 (27.2468%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.2007, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  16, local model 81, internal_epoch   1, Avg loss: 0.0689, Accuracy: 230/774 (29.7158%)
_Train Local_ResNet_18, epoch  16, local model 81, internal_epoch   2, Avg loss: 0.0356, Accuracy: 299/774 (38.6305%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.1544, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   1, Avg loss: 0.0548, Accuracy: 425/1956 (21.7280%)
_Train Local_ResNet_18, epoch  16, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 628/1956 (32.1063%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 8.2714, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 160/953 (16.7891%)
_Train Local_ResNet_18, epoch  16, local model 64, internal_epoch   2, Avg loss: 0.0385, Accuracy: 303/953 (31.7943%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 6.3671, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  16, local model 98, internal_epoch   1, Avg loss: 0.0829, Accuracy: 17/373 (4.5576%)
_Train Local_ResNet_18, epoch  16, local model 98, internal_epoch   2, Avg loss: 0.0484, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.4116, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   1, Avg loss: 0.0521, Accuracy: 304/1089 (27.9155%)
_Train Local_ResNet_18, epoch  16, local model 59, internal_epoch   2, Avg loss: 0.0358, Accuracy: 505/1089 (46.3728%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 7.5993, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   1, Avg loss: 0.0797, Accuracy: 55/515 (10.6796%)
_Train Local_ResNet_18, epoch  16, local model 33, internal_epoch   2, Avg loss: 0.0496, Accuracy: 117/515 (22.7184%)
_Test Local_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.6523, Accuracy: 44/10000 (0.4400%)
time spent on training: 138.3870542049408
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 1470, 818, 1402, 774, 1956, 953, 373, 1089, 515]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 16, Avg loss: 5.3151, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 16, Avg loss: 5.6035, Accuracy: 0/9950 (0.0000%)
saving model
Done in 230.7683265209198 sec.
Server Epoch:17 choose agents : [36, 29, 28, 82, 55, 63, 33, 23, 5, 43].
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   1, Avg loss: 0.0877, Accuracy: 71/408 (17.4020%)
_Train Local_ResNet_18, epoch  17, local model 36, internal_epoch   2, Avg loss: 0.0558, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.4684, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   1, Avg loss: 0.0488, Accuracy: 426/1440 (29.5833%)
_Train Local_ResNet_18, epoch  17, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 656/1440 (45.5556%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.0153, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   1, Avg loss: 0.0565, Accuracy: 390/1581 (24.6679%)
_Train Local_ResNet_18, epoch  17, local model 28, internal_epoch   2, Avg loss: 0.0342, Accuracy: 573/1581 (36.2429%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.7146, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   1, Avg loss: 0.0769, Accuracy: 61/500 (12.2000%)
_Train Local_ResNet_18, epoch  17, local model 82, internal_epoch   2, Avg loss: 0.0491, Accuracy: 172/500 (34.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.5793, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   1, Avg loss: 0.0565, Accuracy: 232/1071 (21.6620%)
_Train Local_ResNet_18, epoch  17, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 482/1071 (45.0047%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 7.9706, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   1, Avg loss: 0.0547, Accuracy: 256/888 (28.8288%)
_Train Local_ResNet_18, epoch  17, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 395/888 (44.4820%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.2567, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   1, Avg loss: 0.0776, Accuracy: 68/515 (13.2039%)
_Train Local_ResNet_18, epoch  17, local model 33, internal_epoch   2, Avg loss: 0.0542, Accuracy: 127/515 (24.6602%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.7804, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   1, Avg loss: 0.0624, Accuracy: 319/715 (44.6154%)
_Train Local_ResNet_18, epoch  17, local model 23, internal_epoch   2, Avg loss: 0.0388, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.7196, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   1, Avg loss: 0.0514, Accuracy: 395/1628 (24.2629%)
_Train Local_ResNet_18, epoch  17, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 832/1628 (51.1057%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 8.5073, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   1, Avg loss: 0.0631, Accuracy: 299/946 (31.6068%)
_Train Local_ResNet_18, epoch  17, local model 43, internal_epoch   2, Avg loss: 0.0368, Accuracy: 315/946 (33.2981%)
_Test Local_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.9783, Accuracy: 60/10000 (0.6000%)
time spent on training: 156.18331813812256
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 1440, 1581, 500, 1071, 888, 515, 715, 1628, 946]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 17, Avg loss: 5.3150, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 17, Avg loss: 5.6035, Accuracy: 0/9950 (0.0000%)
saving model
Done in 246.93154621124268 sec.
Server Epoch:18 choose agents : [78, 91, 3, 24, 2, 8, 80, 51, 73, 29].
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   1, Avg loss: 0.0839, Accuracy: 43/416 (10.3365%)
_Train Local_ResNet_18, epoch  18, local model 78, internal_epoch   2, Avg loss: 0.0458, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.5686, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 91, internal_epoch   1, Avg loss: 0.0522, Accuracy: 316/1030 (30.6796%)
_Train Local_ResNet_18, epoch  18, local model 91, internal_epoch   2, Avg loss: 0.0278, Accuracy: 639/1030 (62.0388%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.0889, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   1, Avg loss: 0.0751, Accuracy: 108/781 (13.8284%)
_Train Local_ResNet_18, epoch  18, local model 3, internal_epoch   2, Avg loss: 0.0357, Accuracy: 231/781 (29.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.4357, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   1, Avg loss: 0.0765, Accuracy: 28/312 (8.9744%)
_Train Local_ResNet_18, epoch  18, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 169/312 (54.1667%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3840, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   1, Avg loss: 0.0619, Accuracy: 230/605 (38.0165%)
_Train Local_ResNet_18, epoch  18, local model 2, internal_epoch   2, Avg loss: 0.0404, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.8697, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   1, Avg loss: 0.0602, Accuracy: 249/1513 (16.4574%)
_Train Local_ResNet_18, epoch  18, local model 8, internal_epoch   2, Avg loss: 0.0370, Accuracy: 429/1513 (28.3543%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.5352, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  18, local model 80, internal_epoch   1, Avg loss: 0.0700, Accuracy: 148/682 (21.7009%)
_Train Local_ResNet_18, epoch  18, local model 80, internal_epoch   2, Avg loss: 0.0378, Accuracy: 252/682 (36.9501%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 6.3626, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   1, Avg loss: 0.0607, Accuracy: 220/1049 (20.9724%)
_Train Local_ResNet_18, epoch  18, local model 51, internal_epoch   2, Avg loss: 0.0305, Accuracy: 513/1049 (48.9037%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.4652, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   1, Avg loss: 0.0660, Accuracy: 177/938 (18.8699%)
_Train Local_ResNet_18, epoch  18, local model 73, internal_epoch   2, Avg loss: 0.0340, Accuracy: 300/938 (31.9829%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 7.1951, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 397/1440 (27.5694%)
_Train Local_ResNet_18, epoch  18, local model 29, internal_epoch   2, Avg loss: 0.0284, Accuracy: 630/1440 (43.7500%)
_Test Local_ResNet_18 poisoned: False, epoch: 18, Avg loss: 8.3254, Accuracy: 69/10000 (0.6900%)
time spent on training: 184.39585876464844
[foolsgold agg] training data poison_ratio: 0.0  data num: [416, 1030, 781, 312, 605, 1513, 682, 1049, 938, 1440]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 18, Avg loss: 5.3149, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 18, Avg loss: 5.6020, Accuracy: 0/9950 (0.0000%)
saving model
Done in 272.6342556476593 sec.
Server Epoch:19 choose agents : [7, 88, 36, 17, 91, 94, 21, 60, 11, 15].
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   1, Avg loss: 0.0531, Accuracy: 353/891 (39.6184%)
_Train Local_ResNet_18, epoch  19, local model 7, internal_epoch   2, Avg loss: 0.0255, Accuracy: 443/891 (49.7194%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.1265, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  19, local model 88, internal_epoch   1, Avg loss: 0.0741, Accuracy: 140/603 (23.2172%)
_Train Local_ResNet_18, epoch  19, local model 88, internal_epoch   2, Avg loss: 0.0461, Accuracy: 279/603 (46.2687%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.9983, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   1, Avg loss: 0.0876, Accuracy: 70/408 (17.1569%)
_Train Local_ResNet_18, epoch  19, local model 36, internal_epoch   2, Avg loss: 0.0556, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.4713, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   1, Avg loss: 0.0516, Accuracy: 403/1574 (25.6036%)
_Train Local_ResNet_18, epoch  19, local model 17, internal_epoch   2, Avg loss: 0.0275, Accuracy: 692/1574 (43.9644%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.4024, Accuracy: 101/10000 (1.0100%)
_Train Local_ResNet_18, epoch  19, local model 91, internal_epoch   1, Avg loss: 0.0525, Accuracy: 323/1030 (31.3592%)
_Train Local_ResNet_18, epoch  19, local model 91, internal_epoch   2, Avg loss: 0.0303, Accuracy: 605/1030 (58.7379%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.7040, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  19, local model 94, internal_epoch   1, Avg loss: 0.0547, Accuracy: 357/1662 (21.4801%)
_Train Local_ResNet_18, epoch  19, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 612/1662 (36.8231%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.9719, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   1, Avg loss: 0.0539, Accuracy: 406/1949 (20.8312%)
_Train Local_ResNet_18, epoch  19, local model 21, internal_epoch   2, Avg loss: 0.0335, Accuracy: 616/1949 (31.6060%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.5316, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   1, Avg loss: 0.0492, Accuracy: 578/2227 (25.9542%)
_Train Local_ResNet_18, epoch  19, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1029/2227 (46.2057%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 8.1799, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   1, Avg loss: 0.0583, Accuracy: 346/712 (48.5955%)
_Train Local_ResNet_18, epoch  19, local model 11, internal_epoch   2, Avg loss: 0.0257, Accuracy: 392/712 (55.0562%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 6.3123, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   1, Avg loss: 0.0583, Accuracy: 325/1154 (28.1629%)
_Train Local_ResNet_18, epoch  19, local model 15, internal_epoch   2, Avg loss: 0.0292, Accuracy: 380/1154 (32.9289%)
_Test Local_ResNet_18 poisoned: False, epoch: 19, Avg loss: 7.5109, Accuracy: 52/10000 (0.5200%)
time spent on training: 198.10907888412476
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 603, 408, 1574, 1030, 1662, 1949, 2227, 712, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 19, Avg loss: 5.3148, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 19, Avg loss: 5.6004, Accuracy: 0/9950 (0.0000%)
saving model
Done in 287.59118390083313 sec.
Server Epoch:20 choose agents : [77, 14, 55, 7, 64, 50, 71, 52, 59, 10].
_Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   1, Avg loss: 0.0541, Accuracy: 325/1340 (24.2537%)
_Train Local_ResNet_18, epoch  20, local model 77, internal_epoch   2, Avg loss: 0.0274, Accuracy: 560/1340 (41.7910%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.7554, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   1, Avg loss: 0.0625, Accuracy: 219/1013 (21.6190%)
_Train Local_ResNet_18, epoch  20, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 320/1013 (31.5893%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.7915, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 238/1071 (22.2222%)
_Train Local_ResNet_18, epoch  20, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 512/1071 (47.8058%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8780, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   1, Avg loss: 0.0544, Accuracy: 349/891 (39.1695%)
_Train Local_ResNet_18, epoch  20, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 457/891 (51.2907%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.0201, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   1, Avg loss: 0.0647, Accuracy: 159/953 (16.6842%)
_Train Local_ResNet_18, epoch  20, local model 64, internal_epoch   2, Avg loss: 0.0383, Accuracy: 309/953 (32.4239%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.5282, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   1, Avg loss: 0.0632, Accuracy: 148/809 (18.2942%)
_Train Local_ResNet_18, epoch  20, local model 50, internal_epoch   2, Avg loss: 0.0278, Accuracy: 342/809 (42.2744%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.2290, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   1, Avg loss: 0.0640, Accuracy: 168/818 (20.5379%)
_Train Local_ResNet_18, epoch  20, local model 71, internal_epoch   2, Avg loss: 0.0303, Accuracy: 349/818 (42.6650%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.9869, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   1, Avg loss: 0.0566, Accuracy: 287/636 (45.1258%)
_Train Local_ResNet_18, epoch  20, local model 52, internal_epoch   2, Avg loss: 0.0313, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 6.1346, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   1, Avg loss: 0.0531, Accuracy: 309/1089 (28.3747%)
_Train Local_ResNet_18, epoch  20, local model 59, internal_epoch   2, Avg loss: 0.0286, Accuracy: 455/1089 (41.7815%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.9052, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   1, Avg loss: 0.0578, Accuracy: 207/861 (24.0418%)
_Train Local_ResNet_18, epoch  20, local model 10, internal_epoch   2, Avg loss: 0.0216, Accuracy: 437/861 (50.7549%)
_Test Local_ResNet_18 poisoned: False, epoch: 20, Avg loss: 7.8173, Accuracy: 50/10000 (0.5000%)
time spent on training: 164.59764552116394
[foolsgold agg] training data poison_ratio: 0.0  data num: [1340, 1013, 1071, 891, 953, 809, 818, 636, 1089, 861]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 20, Avg loss: 5.3147, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 20, Avg loss: 5.5989, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.98024678230286 sec.
Server Epoch:21 choose agents : [0, 17, 26, 47, 78, 74, 75, 96, 65, 22].
poison local model 0 index 0 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   1, Avg loss: 0.0566, Accuracy: 394/1657 (23.7779%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   2, Avg loss: 0.0343, Accuracy: 631/1657 (38.0809%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   3, Avg loss: 0.0285, Accuracy: 771/1657 (46.5299%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   4, Avg loss: 0.0274, Accuracy: 780/1657 (47.0730%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   5, Avg loss: 0.0270, Accuracy: 795/1657 (47.9783%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   6, Avg loss: 0.0264, Accuracy: 817/1657 (49.3060%), train_poison_data_count: 520
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   7, Avg loss: 0.0264, Accuracy: 799/1657 (48.2197%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   8, Avg loss: 0.0256, Accuracy: 844/1657 (50.9354%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch   9, Avg loss: 0.0253, Accuracy: 854/1657 (51.5389%), train_poison_data_count: 520
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  21, local model 0, internal_epoch  10, Avg loss: 0.0247, Accuracy: 869/1657 (52.4442%), train_poison_data_count: 520
Global model norm: 112.05520577208807.
Norm before scaling: 112.0290664013139. Distance: 1.2355059983290424
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.5382, Accuracy: 54/10000 (0.5400%)
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: 0.7430, Accuracy: 9640/9950 (96.8844%)
Scaling by  100
Scaled Norm after poisoning: 164.56823836368, distance: 123.55060482703028
Total norm for 2 adversaries is: 164.56823836368. distance: 123.55060482703028
_Test Local_ResNet_18 poisoned: True, epoch: 21, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   1, Avg loss: 0.0513, Accuracy: 392/1574 (24.9047%)
_Train Local_ResNet_18, epoch  21, local model 17, internal_epoch   2, Avg loss: 0.0279, Accuracy: 672/1574 (42.6938%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 8.2757, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 339/1446 (23.4440%)
_Train Local_ResNet_18, epoch  21, local model 26, internal_epoch   2, Avg loss: 0.0352, Accuracy: 508/1446 (35.1314%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.1123, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   1, Avg loss: 0.1257, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  21, local model 47, internal_epoch   2, Avg loss: 0.1095, Accuracy: 16/134 (11.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3109, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 78, internal_epoch   1, Avg loss: 0.0836, Accuracy: 39/416 (9.3750%)
_Train Local_ResNet_18, epoch  21, local model 78, internal_epoch   2, Avg loss: 0.0462, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.5502, Accuracy: 50/10000 (0.5000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   1, Avg loss: 0.0432, Accuracy: 470/1552 (30.2835%)
_Train Local_ResNet_18, epoch  21, local model 74, internal_epoch   2, Avg loss: 0.0210, Accuracy: 774/1552 (49.8711%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 10.4922, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  21, local model 75, internal_epoch   1, Avg loss: 0.0627, Accuracy: 247/776 (31.8299%)
_Train Local_ResNet_18, epoch  21, local model 75, internal_epoch   2, Avg loss: 0.0310, Accuracy: 401/776 (51.6753%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 6.8279, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 50/311 (16.0772%)
_Train Local_ResNet_18, epoch  21, local model 96, internal_epoch   2, Avg loss: 0.0528, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3454, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   1, Avg loss: 0.0569, Accuracy: 388/1475 (26.3051%)
_Train Local_ResNet_18, epoch  21, local model 65, internal_epoch   2, Avg loss: 0.0307, Accuracy: 692/1475 (46.9153%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.0805, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   1, Avg loss: 0.0458, Accuracy: 496/1470 (33.7415%)
_Train Local_ResNet_18, epoch  21, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 846/1470 (57.5510%)
_Test Local_ResNet_18 poisoned: False, epoch: 21, Avg loss: 7.8845, Accuracy: 73/10000 (0.7300%)
time spent on training: 290.8448338508606
[foolsgold agg] training data poison_ratio: 0.29682730552215336  data num: [1657, 1574, 1446, 134, 416, 1552, 776, 311, 1475, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.09275853297567292
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 21, Avg loss: 5.3145, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 21, Avg loss: 5.5927, Accuracy: 0/9950 (0.0000%)
saving model
Done in 378.2645628452301 sec.
Server Epoch:22 choose agents : [11, 22, 49, 18, 76, 2, 74, 8, 78, 54].
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   1, Avg loss: 0.0527, Accuracy: 356/712 (50.0000%)
_Train Local_ResNet_18, epoch  22, local model 11, internal_epoch   2, Avg loss: 0.0269, Accuracy: 442/712 (62.0787%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 6.5534, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 537/1470 (36.5306%)
_Train Local_ResNet_18, epoch  22, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 866/1470 (58.9116%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 8.2158, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   1, Avg loss: 0.0804, Accuracy: 25/440 (5.6818%)
_Train Local_ResNet_18, epoch  22, local model 49, internal_epoch   2, Avg loss: 0.0481, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.4839, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   1, Avg loss: 0.0765, Accuracy: 113/530 (21.3208%)
_Train Local_ResNet_18, epoch  22, local model 18, internal_epoch   2, Avg loss: 0.0397, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.9934, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   1, Avg loss: 0.0864, Accuracy: 42/466 (9.0129%)
_Train Local_ResNet_18, epoch  22, local model 76, internal_epoch   2, Avg loss: 0.0483, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.6352, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   1, Avg loss: 0.0640, Accuracy: 222/605 (36.6942%)
_Train Local_ResNet_18, epoch  22, local model 2, internal_epoch   2, Avg loss: 0.0401, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.8390, Accuracy: 59/10000 (0.5900%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   1, Avg loss: 0.0435, Accuracy: 459/1552 (29.5747%)
_Train Local_ResNet_18, epoch  22, local model 74, internal_epoch   2, Avg loss: 0.0211, Accuracy: 762/1552 (49.0979%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 10.3572, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   1, Avg loss: 0.0596, Accuracy: 226/1513 (14.9372%)
_Train Local_ResNet_18, epoch  22, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 453/1513 (29.9405%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.5441, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  22, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 34/416 (8.1731%)
_Train Local_ResNet_18, epoch  22, local model 78, internal_epoch   2, Avg loss: 0.0468, Accuracy: 171/416 (41.1058%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.5911, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   1, Avg loss: 0.0553, Accuracy: 347/1130 (30.7080%)
_Train Local_ResNet_18, epoch  22, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 437/1130 (38.6726%)
_Test Local_ResNet_18 poisoned: False, epoch: 22, Avg loss: 7.8104, Accuracy: 53/10000 (0.5300%)
time spent on training: 209.46410536766052
[foolsgold agg] training data poison_ratio: 0.17568485397328504  data num: [712, 1470, 440, 530, 466, 605, 1552, 1513, 416, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.054901516866651574
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 22, Avg loss: 5.3145, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 22, Avg loss: 5.5930, Accuracy: 0/9950 (0.0000%)
saving model
Done in 295.5878715515137 sec.
Server Epoch:23 choose agents : [20, 9, 53, 97, 2, 88, 22, 77, 3, 5].
poison local model 20 index 1 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   1, Avg loss: 0.0600, Accuracy: 224/807 (27.7571%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   2, Avg loss: 0.0359, Accuracy: 362/807 (44.8575%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   3, Avg loss: 0.0303, Accuracy: 436/807 (54.0273%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   4, Avg loss: 0.0280, Accuracy: 471/807 (58.3643%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   5, Avg loss: 0.0276, Accuracy: 459/807 (56.8773%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   6, Avg loss: 0.0248, Accuracy: 475/807 (58.8600%), train_poison_data_count: 260
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   7, Avg loss: 0.0247, Accuracy: 488/807 (60.4709%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   8, Avg loss: 0.0237, Accuracy: 504/807 (62.4535%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch   9, Avg loss: 0.0229, Accuracy: 508/807 (62.9492%), train_poison_data_count: 260
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  23, local model 20, internal_epoch  10, Avg loss: 0.0232, Accuracy: 507/807 (62.8253%), train_poison_data_count: 260
Global model norm: 112.05510554940145.
Norm before scaling: 112.0442853295071. Distance: 0.8618304113703572
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.2868, Accuracy: 66/10000 (0.6600%)
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: 0.7747, Accuracy: 9343/9950 (93.8995%)
Scaling by  100
Scaled Norm after poisoning: 140.23880302897626, distance: 86.18303276584521
Total norm for 1 adversaries is: 140.23880302897626. distance: 86.18303276584521
_Test Local_ResNet_18 poisoned: True, epoch: 23, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   1, Avg loss: 0.0497, Accuracy: 358/1275 (28.0784%)
_Train Local_ResNet_18, epoch  23, local model 9, internal_epoch   2, Avg loss: 0.0201, Accuracy: 646/1275 (50.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.1445, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   1, Avg loss: 0.0502, Accuracy: 278/813 (34.1943%)
_Train Local_ResNet_18, epoch  23, local model 53, internal_epoch   2, Avg loss: 0.0195, Accuracy: 408/813 (50.1845%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 9.7931, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 97, internal_epoch   1, Avg loss: 0.0527, Accuracy: 358/1213 (29.5136%)
_Train Local_ResNet_18, epoch  23, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 469/1213 (38.6645%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.5106, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   1, Avg loss: 0.0630, Accuracy: 237/605 (39.1736%)
_Train Local_ResNet_18, epoch  23, local model 2, internal_epoch   2, Avg loss: 0.0402, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.7573, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  23, local model 88, internal_epoch   1, Avg loss: 0.0752, Accuracy: 134/603 (22.2222%)
_Train Local_ResNet_18, epoch  23, local model 88, internal_epoch   2, Avg loss: 0.0465, Accuracy: 284/603 (47.0978%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.8716, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   1, Avg loss: 0.0464, Accuracy: 520/1470 (35.3741%)
_Train Local_ResNet_18, epoch  23, local model 22, internal_epoch   2, Avg loss: 0.0232, Accuracy: 884/1470 (60.1361%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.8831, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  23, local model 77, internal_epoch   1, Avg loss: 0.0538, Accuracy: 328/1340 (24.4776%)
_Train Local_ResNet_18, epoch  23, local model 77, internal_epoch   2, Avg loss: 0.0275, Accuracy: 534/1340 (39.8507%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 7.6971, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   1, Avg loss: 0.0755, Accuracy: 113/781 (14.4686%)
_Train Local_ResNet_18, epoch  23, local model 3, internal_epoch   2, Avg loss: 0.0371, Accuracy: 233/781 (29.8335%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 6.6801, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   1, Avg loss: 0.0511, Accuracy: 394/1628 (24.2015%)
_Train Local_ResNet_18, epoch  23, local model 5, internal_epoch   2, Avg loss: 0.0259, Accuracy: 779/1628 (47.8501%)
_Test Local_ResNet_18 poisoned: False, epoch: 23, Avg loss: 8.0311, Accuracy: 103/10000 (1.0300%)
time spent on training: 210.4447305202484
[foolsgold agg] training data poison_ratio: 0.07660180351210251  data num: [807, 1275, 813, 1213, 605, 603, 1470, 1340, 781, 1628]
[foolsgold agg] considering poison per batch poison_fraction: 0.023938063597532033
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 23, Avg loss: 5.3144, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 23, Avg loss: 5.5910, Accuracy: 0/9950 (0.0000%)
saving model
Done in 295.46065950393677 sec.
Server Epoch:24 choose agents : [63, 83, 86, 84, 14, 68, 3, 11, 51, 71].
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   1, Avg loss: 0.0549, Accuracy: 260/888 (29.2793%)
_Train Local_ResNet_18, epoch  24, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 378/888 (42.5676%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 8.6077, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   1, Avg loss: 0.0545, Accuracy: 424/1953 (21.7102%)
_Train Local_ResNet_18, epoch  24, local model 83, internal_epoch   2, Avg loss: 0.0336, Accuracy: 764/1953 (39.1193%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.7484, Accuracy: 117/10000 (1.1700%)
_Train Local_ResNet_18, epoch  24, local model 86, internal_epoch   1, Avg loss: 0.0626, Accuracy: 357/1003 (35.5932%)
_Train Local_ResNet_18, epoch  24, local model 86, internal_epoch   2, Avg loss: 0.0340, Accuracy: 406/1003 (40.4786%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5917, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   1, Avg loss: 0.0625, Accuracy: 317/1190 (26.6387%)
_Train Local_ResNet_18, epoch  24, local model 84, internal_epoch   2, Avg loss: 0.0324, Accuracy: 454/1190 (38.1513%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.1841, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 229/1013 (22.6061%)
_Train Local_ResNet_18, epoch  24, local model 14, internal_epoch   2, Avg loss: 0.0357, Accuracy: 311/1013 (30.7009%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.6552, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   1, Avg loss: 0.0621, Accuracy: 367/1163 (31.5563%)
_Train Local_ResNet_18, epoch  24, local model 68, internal_epoch   2, Avg loss: 0.0374, Accuracy: 425/1163 (36.5434%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.8084, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   1, Avg loss: 0.0749, Accuracy: 105/781 (13.4443%)
_Train Local_ResNet_18, epoch  24, local model 3, internal_epoch   2, Avg loss: 0.0358, Accuracy: 237/781 (30.3457%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.6882, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   1, Avg loss: 0.0550, Accuracy: 347/712 (48.7360%)
_Train Local_ResNet_18, epoch  24, local model 11, internal_epoch   2, Avg loss: 0.0258, Accuracy: 424/712 (59.5506%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 6.5463, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   1, Avg loss: 0.0605, Accuracy: 225/1049 (21.4490%)
_Train Local_ResNet_18, epoch  24, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 519/1049 (49.4757%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.3038, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   1, Avg loss: 0.0639, Accuracy: 165/818 (20.1711%)
_Train Local_ResNet_18, epoch  24, local model 71, internal_epoch   2, Avg loss: 0.0309, Accuracy: 351/818 (42.9095%)
_Test Local_ResNet_18 poisoned: False, epoch: 24, Avg loss: 7.1023, Accuracy: 58/10000 (0.5800%)
time spent on training: 129.4587070941925
[foolsgold agg] training data poison_ratio: 0.0  data num: [888, 1953, 1003, 1190, 1013, 1163, 781, 712, 1049, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 24, Avg loss: 5.3142, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 24, Avg loss: 5.5910, Accuracy: 0/9950 (0.0000%)
saving model
Done in 214.97048830986023 sec.
Server Epoch:25 choose agents : [74, 15, 70, 45, 27, 54, 89, 16, 97, 32].
poison local model 74 index 2 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   1, Avg loss: 0.0476, Accuracy: 415/1552 (26.7397%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 803/1552 (51.7397%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   3, Avg loss: 0.0182, Accuracy: 904/1552 (58.2474%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   4, Avg loss: 0.0173, Accuracy: 938/1552 (60.4381%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   5, Avg loss: 0.0170, Accuracy: 960/1552 (61.8557%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   6, Avg loss: 0.0164, Accuracy: 956/1552 (61.5979%), train_poison_data_count: 496
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   7, Avg loss: 0.0162, Accuracy: 994/1552 (64.0464%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   8, Avg loss: 0.0168, Accuracy: 975/1552 (62.8222%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch   9, Avg loss: 0.0159, Accuracy: 1001/1552 (64.4974%), train_poison_data_count: 496
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  25, local model 74, internal_epoch  10, Avg loss: 0.0161, Accuracy: 1001/1552 (64.4974%), train_poison_data_count: 496
Global model norm: 112.05499661159693.
Norm before scaling: 112.0316466171501. Distance: 1.2639950747243072
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 9.7070, Accuracy: 93/10000 (0.9300%)
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: 0.3253, Accuracy: 9208/9950 (92.5427%)
Scaling by  100
Scaled Norm after poisoning: 166.8837954142792, distance: 126.39950538248755
Total norm for 1 adversaries is: 166.8837954142792. distance: 126.39950538248755
_Test Local_ResNet_18 poisoned: True, epoch: 25, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   1, Avg loss: 0.0577, Accuracy: 320/1154 (27.7296%)
_Train Local_ResNet_18, epoch  25, local model 15, internal_epoch   2, Avg loss: 0.0296, Accuracy: 398/1154 (34.4887%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6304, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   1, Avg loss: 0.0552, Accuracy: 357/1418 (25.1763%)
_Train Local_ResNet_18, epoch  25, local model 70, internal_epoch   2, Avg loss: 0.0305, Accuracy: 658/1418 (46.4034%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.7819, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   1, Avg loss: 0.0679, Accuracy: 192/669 (28.6996%)
_Train Local_ResNet_18, epoch  25, local model 45, internal_epoch   2, Avg loss: 0.0412, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.7623, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   1, Avg loss: 0.0533, Accuracy: 450/1587 (28.3554%)
_Train Local_ResNet_18, epoch  25, local model 27, internal_epoch   2, Avg loss: 0.0334, Accuracy: 631/1587 (39.7606%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.1781, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   1, Avg loss: 0.0549, Accuracy: 352/1130 (31.1504%)
_Train Local_ResNet_18, epoch  25, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 497/1130 (43.9823%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6305, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  25, local model 89, internal_epoch   1, Avg loss: 0.0599, Accuracy: 330/896 (36.8304%)
_Train Local_ResNet_18, epoch  25, local model 89, internal_epoch   2, Avg loss: 0.0335, Accuracy: 463/896 (51.6741%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 6.2854, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   1, Avg loss: 0.0636, Accuracy: 274/708 (38.7006%)
_Train Local_ResNet_18, epoch  25, local model 16, internal_epoch   2, Avg loss: 0.0364, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.8444, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  25, local model 97, internal_epoch   1, Avg loss: 0.0528, Accuracy: 350/1213 (28.8541%)
_Train Local_ResNet_18, epoch  25, local model 97, internal_epoch   2, Avg loss: 0.0276, Accuracy: 482/1213 (39.7362%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 7.6730, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   1, Avg loss: 0.0601, Accuracy: 187/735 (25.4422%)
_Train Local_ResNet_18, epoch  25, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 355/735 (48.2993%)
_Test Local_ResNet_18 poisoned: False, epoch: 25, Avg loss: 8.0000, Accuracy: 54/10000 (0.5400%)
time spent on training: 248.1516251564026
[foolsgold agg] training data poison_ratio: 0.1403001265593925  data num: [1552, 1154, 1418, 669, 1587, 1130, 896, 708, 1213, 735]
[foolsgold agg] considering poison per batch poison_fraction: 0.04384378954981016
[foolsgold agg] wv: [1.         1.         1.         1.         0.91531942 1.
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 25, Avg loss: 5.3141, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 25, Avg loss: 5.5842, Accuracy: 0/9950 (0.0000%)
saving model
Done in 331.54289174079895 sec.
Server Epoch:26 choose agents : [16, 3, 83, 49, 82, 57, 75, 76, 46, 55].
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   1, Avg loss: 0.0597, Accuracy: 274/708 (38.7006%)
_Train Local_ResNet_18, epoch  26, local model 16, internal_epoch   2, Avg loss: 0.0403, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.7558, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   1, Avg loss: 0.0743, Accuracy: 108/781 (13.8284%)
_Train Local_ResNet_18, epoch  26, local model 3, internal_epoch   2, Avg loss: 0.0373, Accuracy: 219/781 (28.0410%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.5108, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  26, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 429/1953 (21.9662%)
_Train Local_ResNet_18, epoch  26, local model 83, internal_epoch   2, Avg loss: 0.0334, Accuracy: 793/1953 (40.6042%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.1844, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   1, Avg loss: 0.0801, Accuracy: 23/440 (5.2273%)
_Train Local_ResNet_18, epoch  26, local model 49, internal_epoch   2, Avg loss: 0.0483, Accuracy: 144/440 (32.7273%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.4926, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   1, Avg loss: 0.0771, Accuracy: 68/500 (13.6000%)
_Train Local_ResNet_18, epoch  26, local model 82, internal_epoch   2, Avg loss: 0.0490, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.6298, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   1, Avg loss: 0.0563, Accuracy: 297/1154 (25.7366%)
_Train Local_ResNet_18, epoch  26, local model 57, internal_epoch   2, Avg loss: 0.0274, Accuracy: 422/1154 (36.5685%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 8.3037, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   1, Avg loss: 0.0621, Accuracy: 252/776 (32.4742%)
_Train Local_ResNet_18, epoch  26, local model 75, internal_epoch   2, Avg loss: 0.0295, Accuracy: 412/776 (53.0928%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 6.8695, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 76, internal_epoch   1, Avg loss: 0.0858, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch  26, local model 76, internal_epoch   2, Avg loss: 0.0487, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.6379, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   1, Avg loss: 0.0550, Accuracy: 430/1904 (22.5840%)
_Train Local_ResNet_18, epoch  26, local model 46, internal_epoch   2, Avg loss: 0.0316, Accuracy: 672/1904 (35.2941%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.7843, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   1, Avg loss: 0.0566, Accuracy: 253/1071 (23.6228%)
_Train Local_ResNet_18, epoch  26, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 521/1071 (48.6461%)
_Test Local_ResNet_18 poisoned: False, epoch: 26, Avg loss: 7.8086, Accuracy: 74/10000 (0.7400%)
time spent on training: 136.5161509513855
[foolsgold agg] training data poison_ratio: 0.0  data num: [708, 781, 1953, 440, 500, 1154, 776, 466, 1904, 1071]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 26, Avg loss: 5.3140, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 26, Avg loss: 5.5842, Accuracy: 0/9950 (0.0000%)
saving model
Done in 218.56655025482178 sec.
Server Epoch:27 choose agents : [95, 43, 81, 8, 51, 86, 26, 14, 98, 20].
poison local model 95 index 3 
poison_now
Current lr: [0.001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   1, Avg loss: 0.0657, Accuracy: 179/599 (29.8831%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   2, Avg loss: 0.0244, Accuracy: 352/599 (58.7646%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   3, Avg loss: 0.0237, Accuracy: 398/599 (66.4441%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   4, Avg loss: 0.0247, Accuracy: 435/599 (72.6210%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   5, Avg loss: 0.0241, Accuracy: 435/599 (72.6210%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   6, Avg loss: 0.0219, Accuracy: 457/599 (76.2938%), train_poison_data_count: 200
Current lr: [0.0001]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   7, Avg loss: 0.0203, Accuracy: 473/599 (78.9649%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   8, Avg loss: 0.0208, Accuracy: 475/599 (79.2988%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch   9, Avg loss: 0.0182, Accuracy: 497/599 (82.9716%), train_poison_data_count: 200
Current lr: [1e-05]
_PoisonTrain Local_ResNet_18, epoch  27, local model 95, internal_epoch  10, Avg loss: 0.0208, Accuracy: 477/599 (79.6327%), train_poison_data_count: 200
Global model norm: 112.05488767368651.
Norm before scaling: 112.04740992237393. Distance: 0.8039308712880334
will scale.
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 9.4995, Accuracy: 52/10000 (0.5200%)
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: 0.5517, Accuracy: 7727/9950 (77.6583%)
Scaling by  100
Scaled Norm after poisoning: 137.0666894024584, distance: 80.3930863933196
Total norm for 2 adversaries is: 137.0666894024584. distance: 80.3930863933196
_Test Local_ResNet_18 poisoned: True, epoch: 27, Avg loss: nan, Accuracy: 0/9950 (0.0000%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   1, Avg loss: 0.0624, Accuracy: 305/946 (32.2410%)
_Train Local_ResNet_18, epoch  27, local model 43, internal_epoch   2, Avg loss: 0.0358, Accuracy: 371/946 (39.2178%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.0072, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  27, local model 81, internal_epoch   1, Avg loss: 0.0691, Accuracy: 242/774 (31.2661%)
_Train Local_ResNet_18, epoch  27, local model 81, internal_epoch   2, Avg loss: 0.0355, Accuracy: 286/774 (36.9509%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.3839, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   1, Avg loss: 0.0602, Accuracy: 259/1513 (17.1183%)
_Train Local_ResNet_18, epoch  27, local model 8, internal_epoch   2, Avg loss: 0.0368, Accuracy: 458/1513 (30.2710%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.3902, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   1, Avg loss: 0.0606, Accuracy: 224/1049 (21.3537%)
_Train Local_ResNet_18, epoch  27, local model 51, internal_epoch   2, Avg loss: 0.0302, Accuracy: 506/1049 (48.2364%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.4876, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  27, local model 86, internal_epoch   1, Avg loss: 0.0631, Accuracy: 361/1003 (35.9920%)
_Train Local_ResNet_18, epoch  27, local model 86, internal_epoch   2, Avg loss: 0.0352, Accuracy: 352/1003 (35.0947%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.7681, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 341/1446 (23.5823%)
_Train Local_ResNet_18, epoch  27, local model 26, internal_epoch   2, Avg loss: 0.0349, Accuracy: 529/1446 (36.5837%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 7.3049, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   1, Avg loss: 0.0617, Accuracy: 222/1013 (21.9151%)
_Train Local_ResNet_18, epoch  27, local model 14, internal_epoch   2, Avg loss: 0.0355, Accuracy: 328/1013 (32.3791%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.4943, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   1, Avg loss: 0.0822, Accuracy: 16/373 (4.2895%)
_Train Local_ResNet_18, epoch  27, local model 98, internal_epoch   2, Avg loss: 0.0483, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.4367, Accuracy: 50/10000 (0.5000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  27, local model 20, internal_epoch   1, Avg loss: 0.0564, Accuracy: 351/807 (43.4944%)
_Train Local_ResNet_18, epoch  27, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 428/807 (53.0359%)
_Test Local_ResNet_18 poisoned: False, epoch: 27, Avg loss: 6.7530, Accuracy: 50/10000 (0.5000%)
time spent on training: 218.00250339508057
[foolsgold agg] training data poison_ratio: 0.1476425496167174  data num: [599, 946, 774, 1513, 1049, 1003, 1446, 1013, 373, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.04613829675522419
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 27, Avg loss: 5.3139, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 27, Avg loss: 5.5848, Accuracy: 0/9950 (0.0000%)
saving model
Done in 299.72995352745056 sec.
Server Epoch:28 choose agents : [43, 16, 55, 21, 94, 68, 49, 93, 87, 78].
_Train Local_ResNet_18, epoch  28, local model 43, internal_epoch   1, Avg loss: 0.0615, Accuracy: 302/946 (31.9239%)
_Train Local_ResNet_18, epoch  28, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 351/946 (37.1036%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.9931, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  28, local model 16, internal_epoch   1, Avg loss: 0.0703, Accuracy: 277/708 (39.1243%)
_Train Local_ResNet_18, epoch  28, local model 16, internal_epoch   2, Avg loss: 0.0324, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.8083, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   1, Avg loss: 0.0559, Accuracy: 240/1071 (22.4090%)
_Train Local_ResNet_18, epoch  28, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 521/1071 (48.6461%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.1098, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 385/1949 (19.7537%)
_Train Local_ResNet_18, epoch  28, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 624/1949 (32.0164%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.1522, Accuracy: 95/10000 (0.9500%)
_Train Local_ResNet_18, epoch  28, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 328/1662 (19.7353%)
_Train Local_ResNet_18, epoch  28, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 624/1662 (37.5451%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9167, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   1, Avg loss: 0.0618, Accuracy: 373/1163 (32.0722%)
_Train Local_ResNet_18, epoch  28, local model 68, internal_epoch   2, Avg loss: 0.0370, Accuracy: 458/1163 (39.3809%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 6.6045, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   1, Avg loss: 0.0801, Accuracy: 26/440 (5.9091%)
_Train Local_ResNet_18, epoch  28, local model 49, internal_epoch   2, Avg loss: 0.0480, Accuracy: 151/440 (34.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.4954, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   1, Avg loss: 0.0554, Accuracy: 405/1742 (23.2491%)
_Train Local_ResNet_18, epoch  28, local model 93, internal_epoch   2, Avg loss: 0.0317, Accuracy: 714/1742 (40.9874%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 7.9452, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  28, local model 87, internal_epoch   1, Avg loss: 0.0575, Accuracy: 303/1131 (26.7905%)
_Train Local_ResNet_18, epoch  28, local model 87, internal_epoch   2, Avg loss: 0.0317, Accuracy: 406/1131 (35.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 8.0712, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  28, local model 78, internal_epoch   1, Avg loss: 0.0834, Accuracy: 38/416 (9.1346%)
_Train Local_ResNet_18, epoch  28, local model 78, internal_epoch   2, Avg loss: 0.0464, Accuracy: 182/416 (43.7500%)
_Test Local_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.5194, Accuracy: 50/10000 (0.5000%)
time spent on training: 140.78145289421082
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 708, 1071, 1949, 1662, 1163, 440, 1742, 1131, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 28, Avg loss: 5.3138, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 28, Avg loss: 5.5852, Accuracy: 0/9950 (0.0000%)
saving model
Done in 224.58939218521118 sec.
Server Epoch:29 choose agents : [7, 85, 95, 12, 59, 54, 89, 98, 63, 66].
_Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 363/891 (40.7407%)
_Train Local_ResNet_18, epoch  29, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 440/891 (49.3827%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.2092, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 85, internal_epoch   1, Avg loss: 0.0538, Accuracy: 444/1988 (22.3340%)
_Train Local_ResNet_18, epoch  29, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 654/1988 (32.8974%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.8445, Accuracy: 86/10000 (0.8600%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   1, Avg loss: 0.0532, Accuracy: 331/599 (55.2588%)
_Train Local_ResNet_18, epoch  29, local model 95, internal_epoch   2, Avg loss: 0.0299, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.6946, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   1, Avg loss: 0.0873, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch  29, local model 12, internal_epoch   2, Avg loss: 0.0477, Accuracy: 150/338 (44.3787%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.4460, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   1, Avg loss: 0.0532, Accuracy: 303/1089 (27.8237%)
_Train Local_ResNet_18, epoch  29, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 494/1089 (45.3627%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.7085, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 347/1130 (30.7080%)
_Train Local_ResNet_18, epoch  29, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 499/1130 (44.1593%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.3781, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 332/896 (37.0536%)
_Train Local_ResNet_18, epoch  29, local model 89, internal_epoch   2, Avg loss: 0.0337, Accuracy: 418/896 (46.6518%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 6.2271, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   1, Avg loss: 0.0819, Accuracy: 21/373 (5.6300%)
_Train Local_ResNet_18, epoch  29, local model 98, internal_epoch   2, Avg loss: 0.0490, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.4362, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   1, Avg loss: 0.0546, Accuracy: 264/888 (29.7297%)
_Train Local_ResNet_18, epoch  29, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 411/888 (46.2838%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 8.0683, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   1, Avg loss: 0.0615, Accuracy: 256/1402 (18.2596%)
_Train Local_ResNet_18, epoch  29, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 433/1402 (30.8845%)
_Test Local_ResNet_18 poisoned: False, epoch: 29, Avg loss: 7.1414, Accuracy: 76/10000 (0.7600%)
time spent on training: 145.54775261878967
[foolsgold agg] training data poison_ratio: 0.06243485511778195  data num: [891, 1988, 599, 338, 1089, 1130, 896, 373, 888, 1402]
[foolsgold agg] considering poison per batch poison_fraction: 0.01951089222430686
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 29, Avg loss: 5.3137, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 29, Avg loss: 5.5848, Accuracy: 0/9950 (0.0000%)
saving model
Done in 228.6479413509369 sec.
Server Epoch:30 choose agents : [61, 58, 70, 49, 93, 67, 44, 24, 1, 14].
_Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   1, Avg loss: 0.1253, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  30, local model 61, internal_epoch   2, Avg loss: 0.1189, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3039, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   1, Avg loss: 0.0582, Accuracy: 348/803 (43.3375%)
_Train Local_ResNet_18, epoch  30, local model 58, internal_epoch   2, Avg loss: 0.0342, Accuracy: 403/803 (50.1868%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.0037, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   1, Avg loss: 0.0553, Accuracy: 343/1418 (24.1890%)
_Train Local_ResNet_18, epoch  30, local model 70, internal_epoch   2, Avg loss: 0.0313, Accuracy: 615/1418 (43.3709%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.6307, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   1, Avg loss: 0.0799, Accuracy: 26/440 (5.9091%)
_Train Local_ResNet_18, epoch  30, local model 49, internal_epoch   2, Avg loss: 0.0478, Accuracy: 148/440 (33.6364%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.5168, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 433/1742 (24.8565%)
_Train Local_ResNet_18, epoch  30, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 696/1742 (39.9541%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.7500, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   1, Avg loss: 0.0789, Accuracy: 46/426 (10.7981%)
_Train Local_ResNet_18, epoch  30, local model 67, internal_epoch   2, Avg loss: 0.0424, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.5771, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 386/1750 (22.0571%)
_Train Local_ResNet_18, epoch  30, local model 44, internal_epoch   2, Avg loss: 0.0351, Accuracy: 679/1750 (38.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.6192, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   1, Avg loss: 0.0763, Accuracy: 33/312 (10.5769%)
_Train Local_ResNet_18, epoch  30, local model 24, internal_epoch   2, Avg loss: 0.0411, Accuracy: 167/312 (53.5256%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3896, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   1, Avg loss: 0.0574, Accuracy: 275/928 (29.6336%)
_Train Local_ResNet_18, epoch  30, local model 1, internal_epoch   2, Avg loss: 0.0245, Accuracy: 534/928 (57.5431%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 7.5885, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   1, Avg loss: 0.0621, Accuracy: 227/1013 (22.4087%)
_Train Local_ResNet_18, epoch  30, local model 14, internal_epoch   2, Avg loss: 0.0359, Accuracy: 308/1013 (30.4047%)
_Test Local_ResNet_18 poisoned: False, epoch: 30, Avg loss: 6.6507, Accuracy: 61/10000 (0.6100%)
time spent on training: 130.17840051651
[foolsgold agg] training data poison_ratio: 0.0  data num: [85, 803, 1418, 440, 1742, 426, 1750, 312, 928, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.99268882 1.         1.
 1.         0.99268882 1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 30, Avg loss: 5.3136, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 30, Avg loss: 5.5845, Accuracy: 0/9950 (0.0000%)
saving model
Done in 212.52369594573975 sec.
Server Epoch:31 choose agents : [67, 91, 74, 70, 30, 32, 97, 1, 61, 22].
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   1, Avg loss: 0.0787, Accuracy: 52/426 (12.2066%)
_Train Local_ResNet_18, epoch  31, local model 67, internal_epoch   2, Avg loss: 0.0427, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.5525, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  31, local model 91, internal_epoch   1, Avg loss: 0.0534, Accuracy: 325/1030 (31.5534%)
_Train Local_ResNet_18, epoch  31, local model 91, internal_epoch   2, Avg loss: 0.0258, Accuracy: 590/1030 (57.2816%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.2400, Accuracy: 70/10000 (0.7000%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   1, Avg loss: 0.0428, Accuracy: 486/1552 (31.3144%)
_Train Local_ResNet_18, epoch  31, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 768/1552 (49.4845%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 10.2973, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   1, Avg loss: 0.0547, Accuracy: 372/1418 (26.2341%)
_Train Local_ResNet_18, epoch  31, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 620/1418 (43.7236%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.6837, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   1, Avg loss: 0.0804, Accuracy: 72/486 (14.8148%)
_Train Local_ResNet_18, epoch  31, local model 30, internal_epoch   2, Avg loss: 0.0418, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.7692, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   1, Avg loss: 0.0595, Accuracy: 206/735 (28.0272%)
_Train Local_ResNet_18, epoch  31, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 323/735 (43.9456%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.7616, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   1, Avg loss: 0.0518, Accuracy: 357/1213 (29.4312%)
_Train Local_ResNet_18, epoch  31, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 511/1213 (42.1270%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.7511, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   1, Avg loss: 0.0570, Accuracy: 287/928 (30.9267%)
_Train Local_ResNet_18, epoch  31, local model 1, internal_epoch   2, Avg loss: 0.0244, Accuracy: 544/928 (58.6207%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 7.8045, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   1, Avg loss: 0.1254, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  31, local model 61, internal_epoch   2, Avg loss: 0.1168, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3040, Accuracy: 42/10000 (0.4200%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   1, Avg loss: 0.0451, Accuracy: 535/1470 (36.3946%)
_Train Local_ResNet_18, epoch  31, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 865/1470 (58.8435%)
_Test Local_ResNet_18 poisoned: False, epoch: 31, Avg loss: 8.0544, Accuracy: 65/10000 (0.6500%)
time spent on training: 141.5649290084839
[foolsgold agg] training data poison_ratio: 0.16611366798672803  data num: [426, 1030, 1552, 1418, 486, 735, 1213, 928, 85, 1470]
[foolsgold agg] considering poison per batch poison_fraction: 0.051910521245852506
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 31, Avg loss: 5.3135, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 31, Avg loss: 5.5810, Accuracy: 0/9950 (0.0000%)
saving model
Done in 225.0881233215332 sec.
Server Epoch:32 choose agents : [20, 68, 99, 31, 27, 46, 19, 95, 86, 9].
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   1, Avg loss: 0.0564, Accuracy: 352/807 (43.6183%)
_Train Local_ResNet_18, epoch  32, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 424/807 (52.5403%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 6.6849, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   1, Avg loss: 0.0615, Accuracy: 372/1163 (31.9862%)
_Train Local_ResNet_18, epoch  32, local model 68, internal_epoch   2, Avg loss: 0.0367, Accuracy: 472/1163 (40.5847%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.0184, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  32, local model 99, internal_epoch   1, Avg loss: 0.0650, Accuracy: 173/773 (22.3803%)
_Train Local_ResNet_18, epoch  32, local model 99, internal_epoch   2, Avg loss: 0.0307, Accuracy: 406/773 (52.5226%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.2312, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   1, Avg loss: 0.0823, Accuracy: 60/460 (13.0435%)
_Train Local_ResNet_18, epoch  32, local model 31, internal_epoch   2, Avg loss: 0.0366, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.8212, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   1, Avg loss: 0.0537, Accuracy: 438/1587 (27.5992%)
_Train Local_ResNet_18, epoch  32, local model 27, internal_epoch   2, Avg loss: 0.0338, Accuracy: 646/1587 (40.7057%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.1719, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   1, Avg loss: 0.0547, Accuracy: 436/1904 (22.8992%)
_Train Local_ResNet_18, epoch  32, local model 46, internal_epoch   2, Avg loss: 0.0311, Accuracy: 717/1904 (37.6576%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.5876, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   1, Avg loss: 0.0478, Accuracy: 403/1036 (38.8996%)
_Train Local_ResNet_18, epoch  32, local model 19, internal_epoch   2, Avg loss: 0.0236, Accuracy: 658/1036 (63.5135%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.4076, Accuracy: 60/10000 (0.6000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   1, Avg loss: 0.0524, Accuracy: 328/599 (54.7579%)
_Train Local_ResNet_18, epoch  32, local model 95, internal_epoch   2, Avg loss: 0.0288, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.8494, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 86, internal_epoch   1, Avg loss: 0.0623, Accuracy: 357/1003 (35.5932%)
_Train Local_ResNet_18, epoch  32, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 382/1003 (38.0857%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 7.0268, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   1, Avg loss: 0.0492, Accuracy: 359/1275 (28.1569%)
_Train Local_ResNet_18, epoch  32, local model 9, internal_epoch   2, Avg loss: 0.0197, Accuracy: 687/1275 (53.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 32, Avg loss: 9.8188, Accuracy: 78/10000 (0.7800%)
time spent on training: 168.70869278907776
[foolsgold agg] training data poison_ratio: 0.13255397379089282  data num: [807, 1163, 773, 460, 1587, 1904, 1036, 599, 1003, 1275]
[foolsgold agg] considering poison per batch poison_fraction: 0.041423116809654006
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 32, Avg loss: 5.3133, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 32, Avg loss: 5.5806, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.85155081748962 sec.
Server Epoch:33 choose agents : [27, 92, 82, 59, 49, 13, 81, 70, 48, 79].
_Train Local_ResNet_18, epoch  33, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 447/1587 (28.1664%)
_Train Local_ResNet_18, epoch  33, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 623/1587 (39.2565%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.3350, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  33, local model 92, internal_epoch   1, Avg loss: 0.0530, Accuracy: 426/1715 (24.8397%)
_Train Local_ResNet_18, epoch  33, local model 92, internal_epoch   2, Avg loss: 0.0309, Accuracy: 707/1715 (41.2245%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.5466, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   1, Avg loss: 0.0763, Accuracy: 65/500 (13.0000%)
_Train Local_ResNet_18, epoch  33, local model 82, internal_epoch   2, Avg loss: 0.0494, Accuracy: 169/500 (33.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.6671, Accuracy: 40/10000 (0.4000%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   1, Avg loss: 0.0528, Accuracy: 268/1089 (24.6097%)
_Train Local_ResNet_18, epoch  33, local model 59, internal_epoch   2, Avg loss: 0.0282, Accuracy: 469/1089 (43.0670%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.6468, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   1, Avg loss: 0.0798, Accuracy: 34/440 (7.7273%)
_Train Local_ResNet_18, epoch  33, local model 49, internal_epoch   2, Avg loss: 0.0482, Accuracy: 151/440 (34.3182%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.4980, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   1, Avg loss: 0.0577, Accuracy: 324/1645 (19.6960%)
_Train Local_ResNet_18, epoch  33, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 638/1645 (38.7842%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 7.9739, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  33, local model 81, internal_epoch   1, Avg loss: 0.0684, Accuracy: 239/774 (30.8786%)
_Train Local_ResNet_18, epoch  33, local model 81, internal_epoch   2, Avg loss: 0.0358, Accuracy: 296/774 (38.2429%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 6.3646, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   1, Avg loss: 0.0554, Accuracy: 343/1418 (24.1890%)
_Train Local_ResNet_18, epoch  33, local model 70, internal_epoch   2, Avg loss: 0.0308, Accuracy: 644/1418 (45.4161%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 8.1182, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   1, Avg loss: 0.0709, Accuracy: 103/631 (16.3233%)
_Train Local_ResNet_18, epoch  33, local model 48, internal_epoch   2, Avg loss: 0.0416, Accuracy: 210/631 (33.2805%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.7895, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   1, Avg loss: 0.1032, Accuracy: 16/197 (8.1218%)
_Train Local_ResNet_18, epoch  33, local model 79, internal_epoch   2, Avg loss: 0.0846, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3200, Accuracy: 50/10000 (0.5000%)
time spent on training: 146.6572244167328
[foolsgold agg] training data poison_ratio: 0.0  data num: [1587, 1715, 500, 1089, 440, 1645, 774, 1418, 631, 197]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 33, Avg loss: 5.3132, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 33, Avg loss: 5.5811, Accuracy: 0/9950 (0.0000%)
saving model
Done in 230.38463878631592 sec.
Server Epoch:34 choose agents : [56, 37, 48, 84, 46, 60, 55, 12, 50, 72].
_Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   1, Avg loss: 0.0831, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  34, local model 56, internal_epoch   2, Avg loss: 0.0669, Accuracy: 75/186 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3116, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 37, internal_epoch   1, Avg loss: 0.0522, Accuracy: 398/1129 (35.2524%)
_Train Local_ResNet_18, epoch  34, local model 37, internal_epoch   2, Avg loss: 0.0248, Accuracy: 734/1129 (65.0133%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.8477, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   1, Avg loss: 0.0709, Accuracy: 97/631 (15.3724%)
_Train Local_ResNet_18, epoch  34, local model 48, internal_epoch   2, Avg loss: 0.0407, Accuracy: 210/631 (33.2805%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.8608, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  34, local model 84, internal_epoch   1, Avg loss: 0.0630, Accuracy: 324/1190 (27.2269%)
_Train Local_ResNet_18, epoch  34, local model 84, internal_epoch   2, Avg loss: 0.0325, Accuracy: 435/1190 (36.5546%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.0422, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  34, local model 46, internal_epoch   1, Avg loss: 0.0548, Accuracy: 435/1904 (22.8466%)
_Train Local_ResNet_18, epoch  34, local model 46, internal_epoch   2, Avg loss: 0.0317, Accuracy: 669/1904 (35.1366%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.6179, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   1, Avg loss: 0.0501, Accuracy: 555/2227 (24.9214%)
_Train Local_ResNet_18, epoch  34, local model 60, internal_epoch   2, Avg loss: 0.0286, Accuracy: 1006/2227 (45.1729%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 8.3900, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   1, Avg loss: 0.0562, Accuracy: 267/1071 (24.9300%)
_Train Local_ResNet_18, epoch  34, local model 55, internal_epoch   2, Avg loss: 0.0289, Accuracy: 510/1071 (47.6190%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.8234, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  34, local model 12, internal_epoch   2, Avg loss: 0.0474, Accuracy: 156/338 (46.1538%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.4383, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   1, Avg loss: 0.0631, Accuracy: 150/809 (18.5414%)
_Train Local_ResNet_18, epoch  34, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 348/809 (43.0161%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.3446, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   1, Avg loss: 0.0625, Accuracy: 240/1241 (19.3392%)
_Train Local_ResNet_18, epoch  34, local model 72, internal_epoch   2, Avg loss: 0.0364, Accuracy: 409/1241 (32.9573%)
_Test Local_ResNet_18 poisoned: False, epoch: 34, Avg loss: 7.0170, Accuracy: 50/10000 (0.5000%)
time spent on training: 160.4441556930542
[foolsgold agg] training data poison_ratio: 0.0  data num: [186, 1129, 631, 1190, 1904, 2227, 1071, 338, 809, 1241]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 34, Avg loss: 5.3131, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 34, Avg loss: 5.5801, Accuracy: 0/9950 (0.0000%)
saving model
Done in 242.92070627212524 sec.
Server Epoch:35 choose agents : [14, 25, 49, 31, 78, 56, 59, 12, 2, 67].
_Train Local_ResNet_18, epoch  35, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 220/1013 (21.7177%)
_Train Local_ResNet_18, epoch  35, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 354/1013 (34.9457%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.7739, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  35, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 304/690 (44.0580%)
_Train Local_ResNet_18, epoch  35, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 6.4335, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   1, Avg loss: 0.0796, Accuracy: 27/440 (6.1364%)
_Train Local_ResNet_18, epoch  35, local model 49, internal_epoch   2, Avg loss: 0.0479, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.4921, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 31, internal_epoch   1, Avg loss: 0.0817, Accuracy: 61/460 (13.2609%)
_Train Local_ResNet_18, epoch  35, local model 31, internal_epoch   2, Avg loss: 0.0390, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.7777, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 78, internal_epoch   1, Avg loss: 0.0832, Accuracy: 38/416 (9.1346%)
_Train Local_ResNet_18, epoch  35, local model 78, internal_epoch   2, Avg loss: 0.0467, Accuracy: 171/416 (41.1058%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.5521, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   1, Avg loss: 0.0832, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  35, local model 56, internal_epoch   2, Avg loss: 0.0673, Accuracy: 66/186 (35.4839%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3118, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   1, Avg loss: 0.0539, Accuracy: 305/1089 (28.0073%)
_Train Local_ResNet_18, epoch  35, local model 59, internal_epoch   2, Avg loss: 0.0275, Accuracy: 477/1089 (43.8017%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 7.0553, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   1, Avg loss: 0.0872, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch  35, local model 12, internal_epoch   2, Avg loss: 0.0477, Accuracy: 139/338 (41.1243%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.4461, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   1, Avg loss: 0.0627, Accuracy: 233/605 (38.5124%)
_Train Local_ResNet_18, epoch  35, local model 2, internal_epoch   2, Avg loss: 0.0395, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.8030, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   1, Avg loss: 0.0793, Accuracy: 44/426 (10.3286%)
_Train Local_ResNet_18, epoch  35, local model 67, internal_epoch   2, Avg loss: 0.0410, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.5318, Accuracy: 50/10000 (0.5000%)
time spent on training: 119.59467720985413
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 690, 440, 460, 416, 186, 1089, 338, 605, 426]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 35, Avg loss: 5.3130, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 35, Avg loss: 5.5793, Accuracy: 0/9950 (0.0000%)
saving model
Done in 203.6970784664154 sec.
Server Epoch:36 choose agents : [49, 72, 34, 13, 42, 7, 12, 61, 44, 78].
_Train Local_ResNet_18, epoch  36, local model 49, internal_epoch   1, Avg loss: 0.0798, Accuracy: 32/440 (7.2727%)
_Train Local_ResNet_18, epoch  36, local model 49, internal_epoch   2, Avg loss: 0.0473, Accuracy: 150/440 (34.0909%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.5104, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 252/1241 (20.3062%)
_Train Local_ResNet_18, epoch  36, local model 72, internal_epoch   2, Avg loss: 0.0371, Accuracy: 386/1241 (31.1039%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.2154, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   1, Avg loss: 0.0573, Accuracy: 400/1427 (28.0308%)
_Train Local_ResNet_18, epoch  36, local model 34, internal_epoch   2, Avg loss: 0.0335, Accuracy: 585/1427 (40.9951%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 6.8959, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   1, Avg loss: 0.0581, Accuracy: 304/1645 (18.4802%)
_Train Local_ResNet_18, epoch  36, local model 13, internal_epoch   2, Avg loss: 0.0331, Accuracy: 598/1645 (36.3526%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9156, Accuracy: 130/10000 (1.3000%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 335/1372 (24.4169%)
_Train Local_ResNet_18, epoch  36, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 532/1372 (38.7755%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.9824, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   1, Avg loss: 0.0533, Accuracy: 355/891 (39.8429%)
_Train Local_ResNet_18, epoch  36, local model 7, internal_epoch   2, Avg loss: 0.0264, Accuracy: 443/891 (49.7194%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.0099, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   1, Avg loss: 0.0869, Accuracy: 19/338 (5.6213%)
_Train Local_ResNet_18, epoch  36, local model 12, internal_epoch   2, Avg loss: 0.0470, Accuracy: 152/338 (44.9704%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.4420, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   1, Avg loss: 0.1253, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  36, local model 61, internal_epoch   2, Avg loss: 0.1190, Accuracy: 5/85 (5.8824%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3045, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   1, Avg loss: 0.0588, Accuracy: 416/1750 (23.7714%)
_Train Local_ResNet_18, epoch  36, local model 44, internal_epoch   2, Avg loss: 0.0348, Accuracy: 683/1750 (39.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 7.6040, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  36, local model 78, internal_epoch   1, Avg loss: 0.0835, Accuracy: 38/416 (9.1346%)
_Train Local_ResNet_18, epoch  36, local model 78, internal_epoch   2, Avg loss: 0.0453, Accuracy: 173/416 (41.5865%)
_Test Local_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.5366, Accuracy: 50/10000 (0.5000%)
time spent on training: 152.32728147506714
[foolsgold agg] training data poison_ratio: 0.0  data num: [440, 1241, 1427, 1645, 1372, 891, 338, 85, 1750, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 36, Avg loss: 5.3129, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 36, Avg loss: 5.5797, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.26513743400574 sec.
Server Epoch:37 choose agents : [43, 52, 34, 93, 71, 11, 33, 59, 97, 25].
_Train Local_ResNet_18, epoch  37, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 304/946 (32.1353%)
_Train Local_ResNet_18, epoch  37, local model 43, internal_epoch   2, Avg loss: 0.0361, Accuracy: 331/946 (34.9894%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.9913, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   1, Avg loss: 0.0563, Accuracy: 290/636 (45.5975%)
_Train Local_ResNet_18, epoch  37, local model 52, internal_epoch   2, Avg loss: 0.0316, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.1732, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  37, local model 34, internal_epoch   1, Avg loss: 0.0574, Accuracy: 392/1427 (27.4702%)
_Train Local_ResNet_18, epoch  37, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 614/1427 (43.0273%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.9193, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  37, local model 93, internal_epoch   1, Avg loss: 0.0543, Accuracy: 418/1742 (23.9954%)
_Train Local_ResNet_18, epoch  37, local model 93, internal_epoch   2, Avg loss: 0.0323, Accuracy: 722/1742 (41.4466%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.0236, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  37, local model 71, internal_epoch   1, Avg loss: 0.0640, Accuracy: 167/818 (20.4156%)
_Train Local_ResNet_18, epoch  37, local model 71, internal_epoch   2, Avg loss: 0.0311, Accuracy: 332/818 (40.5868%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.3385, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   1, Avg loss: 0.0566, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  37, local model 11, internal_epoch   2, Avg loss: 0.0270, Accuracy: 418/712 (58.7079%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.3064, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   1, Avg loss: 0.0786, Accuracy: 64/515 (12.4272%)
_Train Local_ResNet_18, epoch  37, local model 33, internal_epoch   2, Avg loss: 0.0497, Accuracy: 119/515 (23.1068%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.7203, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 316/1089 (29.0174%)
_Train Local_ResNet_18, epoch  37, local model 59, internal_epoch   2, Avg loss: 0.0295, Accuracy: 431/1089 (39.5776%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 8.2098, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  37, local model 97, internal_epoch   1, Avg loss: 0.0527, Accuracy: 361/1213 (29.7609%)
_Train Local_ResNet_18, epoch  37, local model 97, internal_epoch   2, Avg loss: 0.0282, Accuracy: 456/1213 (37.5927%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 7.5718, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   1, Avg loss: 0.0568, Accuracy: 303/690 (43.9130%)
_Train Local_ResNet_18, epoch  37, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 37, Avg loss: 6.5101, Accuracy: 58/10000 (0.5800%)
time spent on training: 158.7903347015381
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 636, 1427, 1742, 818, 712, 515, 1089, 1213, 690]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 37, Avg loss: 5.3129, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 37, Avg loss: 5.5798, Accuracy: 0/9950 (0.0000%)
saving model
Done in 242.1544632911682 sec.
Server Epoch:38 choose agents : [79, 26, 47, 1, 85, 4, 39, 42, 59, 73].
_Train Local_ResNet_18, epoch  38, local model 79, internal_epoch   1, Avg loss: 0.1046, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch  38, local model 79, internal_epoch   2, Avg loss: 0.0839, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3220, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 351/1446 (24.2739%)
_Train Local_ResNet_18, epoch  38, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 494/1446 (34.1632%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.1514, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  38, local model 47, internal_epoch   1, Avg loss: 0.1200, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  38, local model 47, internal_epoch   2, Avg loss: 0.1125, Accuracy: 16/134 (11.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   1, Avg loss: 0.0572, Accuracy: 285/928 (30.7112%)
_Train Local_ResNet_18, epoch  38, local model 1, internal_epoch   2, Avg loss: 0.0238, Accuracy: 553/928 (59.5905%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.9028, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  38, local model 85, internal_epoch   1, Avg loss: 0.0537, Accuracy: 458/1988 (23.0382%)
_Train Local_ResNet_18, epoch  38, local model 85, internal_epoch   2, Avg loss: 0.0355, Accuracy: 676/1988 (34.0040%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.7755, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   1, Avg loss: 0.0609, Accuracy: 328/901 (36.4040%)
_Train Local_ResNet_18, epoch  38, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 386/901 (42.8413%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.8011, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   1, Avg loss: 0.0536, Accuracy: 310/1013 (30.6022%)
_Train Local_ResNet_18, epoch  38, local model 39, internal_epoch   2, Avg loss: 0.0265, Accuracy: 482/1013 (47.5814%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.6556, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 349/1372 (25.4373%)
_Train Local_ResNet_18, epoch  38, local model 42, internal_epoch   2, Avg loss: 0.0312, Accuracy: 499/1372 (36.3703%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.8213, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   1, Avg loss: 0.0519, Accuracy: 300/1089 (27.5482%)
_Train Local_ResNet_18, epoch  38, local model 59, internal_epoch   2, Avg loss: 0.0283, Accuracy: 437/1089 (40.1286%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 7.2770, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   1, Avg loss: 0.0660, Accuracy: 174/938 (18.5501%)
_Train Local_ResNet_18, epoch  38, local model 73, internal_epoch   2, Avg loss: 0.0335, Accuracy: 312/938 (33.2623%)
_Test Local_ResNet_18 poisoned: False, epoch: 38, Avg loss: 6.9370, Accuracy: 62/10000 (0.6200%)
time spent on training: 159.4270441532135
[foolsgold agg] training data poison_ratio: 0.0  data num: [197, 1446, 134, 928, 1988, 901, 1013, 1372, 1089, 938]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 38, Avg loss: 5.3128, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 38, Avg loss: 5.5783, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.94025254249573 sec.
Server Epoch:39 choose agents : [34, 95, 89, 43, 8, 17, 27, 59, 44, 32].
_Train Local_ResNet_18, epoch  39, local model 34, internal_epoch   1, Avg loss: 0.0582, Accuracy: 402/1427 (28.1710%)
_Train Local_ResNet_18, epoch  39, local model 34, internal_epoch   2, Avg loss: 0.0337, Accuracy: 574/1427 (40.2242%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.9401, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  39, local model 95, internal_epoch   1, Avg loss: 0.0531, Accuracy: 331/599 (55.2588%)
_Train Local_ResNet_18, epoch  39, local model 95, internal_epoch   2, Avg loss: 0.0294, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.5266, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 89, internal_epoch   1, Avg loss: 0.0616, Accuracy: 330/896 (36.8304%)
_Train Local_ResNet_18, epoch  39, local model 89, internal_epoch   2, Avg loss: 0.0339, Accuracy: 401/896 (44.7545%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.3004, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   1, Avg loss: 0.0623, Accuracy: 304/946 (32.1353%)
_Train Local_ResNet_18, epoch  39, local model 43, internal_epoch   2, Avg loss: 0.0366, Accuracy: 318/946 (33.6152%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 6.1101, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   1, Avg loss: 0.0599, Accuracy: 217/1513 (14.3424%)
_Train Local_ResNet_18, epoch  39, local model 8, internal_epoch   2, Avg loss: 0.0365, Accuracy: 453/1513 (29.9405%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6026, Accuracy: 102/10000 (1.0200%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   1, Avg loss: 0.0519, Accuracy: 414/1574 (26.3024%)
_Train Local_ResNet_18, epoch  39, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 674/1574 (42.8208%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 8.2092, Accuracy: 100/10000 (1.0000%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   1, Avg loss: 0.0536, Accuracy: 432/1587 (27.2212%)
_Train Local_ResNet_18, epoch  39, local model 27, internal_epoch   2, Avg loss: 0.0340, Accuracy: 628/1587 (39.5715%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.0961, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   1, Avg loss: 0.0523, Accuracy: 319/1089 (29.2929%)
_Train Local_ResNet_18, epoch  39, local model 59, internal_epoch   2, Avg loss: 0.0284, Accuracy: 463/1089 (42.5161%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.1532, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   1, Avg loss: 0.0595, Accuracy: 389/1750 (22.2286%)
_Train Local_ResNet_18, epoch  39, local model 44, internal_epoch   2, Avg loss: 0.0353, Accuracy: 680/1750 (38.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6089, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   1, Avg loss: 0.0598, Accuracy: 203/735 (27.6190%)
_Train Local_ResNet_18, epoch  39, local model 32, internal_epoch   2, Avg loss: 0.0228, Accuracy: 356/735 (48.4354%)
_Test Local_ResNet_18 poisoned: False, epoch: 39, Avg loss: 7.6050, Accuracy: 53/10000 (0.5300%)
time spent on training: 188.68309116363525
[foolsgold agg] training data poison_ratio: 0.049438758666226476  data num: [1427, 599, 896, 946, 1513, 1574, 1587, 1089, 1750, 735]
[foolsgold agg] considering poison per batch poison_fraction: 0.015449612083195775
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 39, Avg loss: 5.3126, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 39, Avg loss: 5.5737, Accuracy: 0/9950 (0.0000%)
saving model
Done in 271.32137274742126 sec.
Server Epoch:40 choose agents : [93, 66, 71, 72, 10, 80, 83, 55, 2, 64].
_Train Local_ResNet_18, epoch  40, local model 93, internal_epoch   1, Avg loss: 0.0548, Accuracy: 434/1742 (24.9139%)
_Train Local_ResNet_18, epoch  40, local model 93, internal_epoch   2, Avg loss: 0.0320, Accuracy: 702/1742 (40.2985%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8095, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 282/1402 (20.1141%)
_Train Local_ResNet_18, epoch  40, local model 66, internal_epoch   2, Avg loss: 0.0390, Accuracy: 382/1402 (27.2468%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.2217, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  40, local model 71, internal_epoch   1, Avg loss: 0.0638, Accuracy: 151/818 (18.4597%)
_Train Local_ResNet_18, epoch  40, local model 71, internal_epoch   2, Avg loss: 0.0305, Accuracy: 344/818 (42.0538%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.4193, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   1, Avg loss: 0.0618, Accuracy: 250/1241 (20.1450%)
_Train Local_ResNet_18, epoch  40, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 413/1241 (33.2796%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.1507, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   1, Avg loss: 0.0575, Accuracy: 225/861 (26.1324%)
_Train Local_ResNet_18, epoch  40, local model 10, internal_epoch   2, Avg loss: 0.0218, Accuracy: 430/861 (49.9419%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 8.1373, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  40, local model 80, internal_epoch   1, Avg loss: 0.0700, Accuracy: 147/682 (21.5543%)
_Train Local_ResNet_18, epoch  40, local model 80, internal_epoch   2, Avg loss: 0.0385, Accuracy: 245/682 (35.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.3672, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   1, Avg loss: 0.0540, Accuracy: 420/1953 (21.5054%)
_Train Local_ResNet_18, epoch  40, local model 83, internal_epoch   2, Avg loss: 0.0342, Accuracy: 797/1953 (40.8090%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.6928, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   1, Avg loss: 0.0554, Accuracy: 259/1071 (24.1830%)
_Train Local_ResNet_18, epoch  40, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 522/1071 (48.7395%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 7.8261, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   1, Avg loss: 0.0633, Accuracy: 232/605 (38.3471%)
_Train Local_ResNet_18, epoch  40, local model 2, internal_epoch   2, Avg loss: 0.0408, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.9204, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   1, Avg loss: 0.0642, Accuracy: 165/953 (17.3137%)
_Train Local_ResNet_18, epoch  40, local model 64, internal_epoch   2, Avg loss: 0.0384, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 40, Avg loss: 6.5456, Accuracy: 49/10000 (0.4900%)
time spent on training: 169.54555940628052
[foolsgold agg] training data poison_ratio: 0.0  data num: [1742, 1402, 818, 1241, 861, 682, 1953, 1071, 605, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 40, Avg loss: 5.3125, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 40, Avg loss: 5.5721, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 40
Done in 252.7573585510254 sec.
Server Epoch:41 choose agents : [85, 44, 65, 86, 25, 91, 38, 76, 45, 21].
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   1, Avg loss: 0.0540, Accuracy: 445/1988 (22.3843%)
_Train Local_ResNet_18, epoch  41, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 677/1988 (34.0543%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.7255, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   1, Avg loss: 0.0592, Accuracy: 403/1750 (23.0286%)
_Train Local_ResNet_18, epoch  41, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 674/1750 (38.5143%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.5764, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   1, Avg loss: 0.0541, Accuracy: 404/1475 (27.3898%)
_Train Local_ResNet_18, epoch  41, local model 65, internal_epoch   2, Avg loss: 0.0304, Accuracy: 716/1475 (48.5424%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.0825, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  41, local model 86, internal_epoch   1, Avg loss: 0.0621, Accuracy: 353/1003 (35.1944%)
_Train Local_ResNet_18, epoch  41, local model 86, internal_epoch   2, Avg loss: 0.0337, Accuracy: 389/1003 (38.7836%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.6943, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   1, Avg loss: 0.0569, Accuracy: 302/690 (43.7681%)
_Train Local_ResNet_18, epoch  41, local model 25, internal_epoch   2, Avg loss: 0.0279, Accuracy: 460/690 (66.6667%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 6.4543, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  41, local model 91, internal_epoch   1, Avg loss: 0.0513, Accuracy: 330/1030 (32.0388%)
_Train Local_ResNet_18, epoch  41, local model 91, internal_epoch   2, Avg loss: 0.0268, Accuracy: 625/1030 (60.6796%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.4029, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   1, Avg loss: 0.0618, Accuracy: 252/1131 (22.2812%)
_Train Local_ResNet_18, epoch  41, local model 38, internal_epoch   2, Avg loss: 0.0311, Accuracy: 457/1131 (40.4067%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 7.3065, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   1, Avg loss: 0.0853, Accuracy: 44/466 (9.4421%)
_Train Local_ResNet_18, epoch  41, local model 76, internal_epoch   2, Avg loss: 0.0490, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.6197, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   1, Avg loss: 0.0679, Accuracy: 198/669 (29.5964%)
_Train Local_ResNet_18, epoch  41, local model 45, internal_epoch   2, Avg loss: 0.0416, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.7761, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   1, Avg loss: 0.0535, Accuracy: 407/1949 (20.8825%)
_Train Local_ResNet_18, epoch  41, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 641/1949 (32.8887%)
_Test Local_ResNet_18 poisoned: False, epoch: 41, Avg loss: 8.3321, Accuracy: 75/10000 (0.7500%)
time spent on training: 179.68883299827576
[foolsgold agg] training data poison_ratio: 0.0  data num: [1988, 1750, 1475, 1003, 690, 1030, 1131, 466, 669, 1949]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 41, Avg loss: 5.3125, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 41, Avg loss: 5.5714, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 41
Done in 262.19842648506165 sec.
Server Epoch:42 choose agents : [51, 16, 4, 43, 67, 60, 32, 45, 96, 15].
_Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   1, Avg loss: 0.0593, Accuracy: 230/1049 (21.9256%)
_Train Local_ResNet_18, epoch  42, local model 51, internal_epoch   2, Avg loss: 0.0296, Accuracy: 532/1049 (50.7150%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.3026, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  42, local model 16, internal_epoch   1, Avg loss: 0.0599, Accuracy: 276/708 (38.9831%)
_Train Local_ResNet_18, epoch  42, local model 16, internal_epoch   2, Avg loss: 0.0374, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.8055, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   1, Avg loss: 0.0637, Accuracy: 320/901 (35.5161%)
_Train Local_ResNet_18, epoch  42, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 381/901 (42.2863%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.9029, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   1, Avg loss: 0.0612, Accuracy: 302/946 (31.9239%)
_Train Local_ResNet_18, epoch  42, local model 43, internal_epoch   2, Avg loss: 0.0357, Accuracy: 373/946 (39.4292%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 6.0064, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   1, Avg loss: 0.0788, Accuracy: 54/426 (12.6761%)
_Train Local_ResNet_18, epoch  42, local model 67, internal_epoch   2, Avg loss: 0.0424, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.5849, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 612/2227 (27.4809%)
_Train Local_ResNet_18, epoch  42, local model 60, internal_epoch   2, Avg loss: 0.0280, Accuracy: 1046/2227 (46.9690%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.6472, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   1, Avg loss: 0.0600, Accuracy: 196/735 (26.6667%)
_Train Local_ResNet_18, epoch  42, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 334/735 (45.4422%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 8.2575, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   1, Avg loss: 0.0680, Accuracy: 198/669 (29.5964%)
_Train Local_ResNet_18, epoch  42, local model 45, internal_epoch   2, Avg loss: 0.0409, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.7372, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  42, local model 96, internal_epoch   1, Avg loss: 0.0787, Accuracy: 45/311 (14.4695%)
_Train Local_ResNet_18, epoch  42, local model 96, internal_epoch   2, Avg loss: 0.0544, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3477, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   1, Avg loss: 0.0596, Accuracy: 329/1154 (28.5095%)
_Train Local_ResNet_18, epoch  42, local model 15, internal_epoch   2, Avg loss: 0.0281, Accuracy: 430/1154 (37.2617%)
_Test Local_ResNet_18 poisoned: False, epoch: 42, Avg loss: 7.5819, Accuracy: 50/10000 (0.5000%)
time spent on training: 149.18022179603577
[foolsgold agg] training data poison_ratio: 0.0  data num: [1049, 708, 901, 946, 426, 2227, 735, 669, 311, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 42, Avg loss: 5.3124, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 42, Avg loss: 5.5668, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 42
Done in 231.9548156261444 sec.
Server Epoch:43 choose agents : [38, 34, 30, 91, 79, 77, 97, 4, 92, 40].
_Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   1, Avg loss: 0.0614, Accuracy: 256/1131 (22.6348%)
_Train Local_ResNet_18, epoch  43, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 494/1131 (43.6782%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.3427, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  43, local model 34, internal_epoch   1, Avg loss: 0.0578, Accuracy: 411/1427 (28.8017%)
_Train Local_ResNet_18, epoch  43, local model 34, internal_epoch   2, Avg loss: 0.0326, Accuracy: 599/1427 (41.9762%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.9640, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   1, Avg loss: 0.0806, Accuracy: 69/486 (14.1975%)
_Train Local_ResNet_18, epoch  43, local model 30, internal_epoch   2, Avg loss: 0.0401, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.8115, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   1, Avg loss: 0.0540, Accuracy: 334/1030 (32.4272%)
_Train Local_ResNet_18, epoch  43, local model 91, internal_epoch   2, Avg loss: 0.0241, Accuracy: 658/1030 (63.8835%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 8.3026, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  43, local model 79, internal_epoch   1, Avg loss: 0.1019, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  43, local model 79, internal_epoch   2, Avg loss: 0.0879, Accuracy: 59/197 (29.9492%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3198, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   1, Avg loss: 0.0539, Accuracy: 333/1340 (24.8507%)
_Train Local_ResNet_18, epoch  43, local model 77, internal_epoch   2, Avg loss: 0.0268, Accuracy: 579/1340 (43.2090%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.8973, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  43, local model 97, internal_epoch   1, Avg loss: 0.0519, Accuracy: 355/1213 (29.2663%)
_Train Local_ResNet_18, epoch  43, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 475/1213 (39.1591%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.6636, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   1, Avg loss: 0.0603, Accuracy: 332/901 (36.8479%)
_Train Local_ResNet_18, epoch  43, local model 4, internal_epoch   2, Avg loss: 0.0336, Accuracy: 393/901 (43.6182%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 6.8423, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  43, local model 92, internal_epoch   1, Avg loss: 0.0511, Accuracy: 487/1715 (28.3965%)
_Train Local_ResNet_18, epoch  43, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 712/1715 (41.5160%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.6951, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   1, Avg loss: 0.0550, Accuracy: 374/1573 (23.7762%)
_Train Local_ResNet_18, epoch  43, local model 40, internal_epoch   2, Avg loss: 0.0349, Accuracy: 563/1573 (35.7915%)
_Test Local_ResNet_18 poisoned: False, epoch: 43, Avg loss: 7.4239, Accuracy: 74/10000 (0.7400%)
time spent on training: 174.05396008491516
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 1427, 486, 1030, 197, 1340, 1213, 901, 1715, 1573]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 43, Avg loss: 5.3124, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 43, Avg loss: 5.5674, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.3026032447815 sec.
Server Epoch:44 choose agents : [31, 21, 20, 52, 96, 4, 15, 32, 64, 58].
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   1, Avg loss: 0.0825, Accuracy: 59/460 (12.8261%)
_Train Local_ResNet_18, epoch  44, local model 31, internal_epoch   2, Avg loss: 0.0367, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.7354, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 366/1949 (18.7789%)
_Train Local_ResNet_18, epoch  44, local model 21, internal_epoch   2, Avg loss: 0.0327, Accuracy: 651/1949 (33.4017%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.4958, Accuracy: 93/10000 (0.9300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   1, Avg loss: 0.0565, Accuracy: 352/807 (43.6183%)
_Train Local_ResNet_18, epoch  44, local model 20, internal_epoch   2, Avg loss: 0.0321, Accuracy: 423/807 (52.4164%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.8084, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   1, Avg loss: 0.0560, Accuracy: 288/636 (45.2830%)
_Train Local_ResNet_18, epoch  44, local model 52, internal_epoch   2, Avg loss: 0.0304, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.1902, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 96, internal_epoch   1, Avg loss: 0.0782, Accuracy: 54/311 (17.3633%)
_Train Local_ResNet_18, epoch  44, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3512, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   1, Avg loss: 0.0606, Accuracy: 325/901 (36.0710%)
_Train Local_ResNet_18, epoch  44, local model 4, internal_epoch   2, Avg loss: 0.0339, Accuracy: 388/901 (43.0633%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.8543, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 336/1154 (29.1161%)
_Train Local_ResNet_18, epoch  44, local model 15, internal_epoch   2, Avg loss: 0.0328, Accuracy: 393/1154 (34.0555%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 7.9855, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   1, Avg loss: 0.0601, Accuracy: 200/735 (27.2109%)
_Train Local_ResNet_18, epoch  44, local model 32, internal_epoch   2, Avg loss: 0.0235, Accuracy: 333/735 (45.3061%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 8.2109, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   1, Avg loss: 0.0642, Accuracy: 174/953 (18.2581%)
_Train Local_ResNet_18, epoch  44, local model 64, internal_epoch   2, Avg loss: 0.0379, Accuracy: 305/953 (32.0042%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.4469, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   1, Avg loss: 0.0572, Accuracy: 345/803 (42.9639%)
_Train Local_ResNet_18, epoch  44, local model 58, internal_epoch   2, Avg loss: 0.0347, Accuracy: 397/803 (49.4396%)
_Test Local_ResNet_18 poisoned: False, epoch: 44, Avg loss: 6.0011, Accuracy: 50/10000 (0.5000%)
time spent on training: 157.4664032459259
[foolsgold agg] training data poison_ratio: 0.09266276265931794  data num: [460, 1949, 807, 636, 311, 901, 1154, 735, 953, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.028957113331036857
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 44, Avg loss: 5.3124, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 44, Avg loss: 5.5630, Accuracy: 0/9950 (0.0000%)
saving model
Done in 241.47753071784973 sec.
Server Epoch:45 choose agents : [36, 57, 29, 82, 27, 2, 96, 56, 14, 20].
_Train Local_ResNet_18, epoch  45, local model 36, internal_epoch   1, Avg loss: 0.0871, Accuracy: 74/408 (18.1373%)
_Train Local_ResNet_18, epoch  45, local model 36, internal_epoch   2, Avg loss: 0.0559, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.4761, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 57, internal_epoch   1, Avg loss: 0.0542, Accuracy: 312/1154 (27.0364%)
_Train Local_ResNet_18, epoch  45, local model 57, internal_epoch   2, Avg loss: 0.0254, Accuracy: 516/1154 (44.7140%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 8.6660, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   1, Avg loss: 0.0493, Accuracy: 406/1440 (28.1944%)
_Train Local_ResNet_18, epoch  45, local model 29, internal_epoch   2, Avg loss: 0.0278, Accuracy: 668/1440 (46.3889%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.9036, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  45, local model 82, internal_epoch   1, Avg loss: 0.0765, Accuracy: 64/500 (12.8000%)
_Train Local_ResNet_18, epoch  45, local model 82, internal_epoch   2, Avg loss: 0.0486, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.6324, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 438/1587 (27.5992%)
_Train Local_ResNet_18, epoch  45, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 604/1587 (38.0592%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.3418, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   1, Avg loss: 0.0632, Accuracy: 233/605 (38.5124%)
_Train Local_ResNet_18, epoch  45, local model 2, internal_epoch   2, Avg loss: 0.0393, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.7945, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  45, local model 96, internal_epoch   1, Avg loss: 0.0783, Accuracy: 47/311 (15.1125%)
_Train Local_ResNet_18, epoch  45, local model 96, internal_epoch   2, Avg loss: 0.0538, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3463, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   1, Avg loss: 0.0824, Accuracy: 1/186 (0.5376%)
_Train Local_ResNet_18, epoch  45, local model 56, internal_epoch   2, Avg loss: 0.0668, Accuracy: 75/186 (40.3226%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3112, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 232/1013 (22.9023%)
_Train Local_ResNet_18, epoch  45, local model 14, internal_epoch   2, Avg loss: 0.0353, Accuracy: 344/1013 (33.9585%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 6.6830, Accuracy: 63/10000 (0.6300%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  45, local model 20, internal_epoch   1, Avg loss: 0.0564, Accuracy: 344/807 (42.6270%)
_Train Local_ResNet_18, epoch  45, local model 20, internal_epoch   2, Avg loss: 0.0322, Accuracy: 419/807 (51.9207%)
_Test Local_ResNet_18 poisoned: False, epoch: 45, Avg loss: 7.0014, Accuracy: 50/10000 (0.5000%)
time spent on training: 153.1261990070343
[foolsgold agg] training data poison_ratio: 0.10073648732992135  data num: [408, 1154, 1440, 500, 1587, 605, 311, 186, 1013, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.03148015229060042
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 45, Avg loss: 5.3123, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 45, Avg loss: 5.5624, Accuracy: 0/9950 (0.0000%)
saving model
Done in 237.42933654785156 sec.
Server Epoch:46 choose agents : [14, 62, 77, 99, 54, 16, 76, 98, 91, 39].
_Train Local_ResNet_18, epoch  46, local model 14, internal_epoch   1, Avg loss: 0.0615, Accuracy: 224/1013 (22.1125%)
_Train Local_ResNet_18, epoch  46, local model 14, internal_epoch   2, Avg loss: 0.0351, Accuracy: 366/1013 (36.1303%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 6.7320, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  46, local model 62, internal_epoch   1, Avg loss: 0.0689, Accuracy: 143/568 (25.1761%)
_Train Local_ResNet_18, epoch  46, local model 62, internal_epoch   2, Avg loss: 0.0405, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.7445, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  46, local model 77, internal_epoch   1, Avg loss: 0.0532, Accuracy: 338/1340 (25.2239%)
_Train Local_ResNet_18, epoch  46, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 570/1340 (42.5373%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.9037, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  46, local model 99, internal_epoch   1, Avg loss: 0.0653, Accuracy: 188/773 (24.3208%)
_Train Local_ResNet_18, epoch  46, local model 99, internal_epoch   2, Avg loss: 0.0312, Accuracy: 400/773 (51.7464%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.3270, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   1, Avg loss: 0.0542, Accuracy: 353/1130 (31.2389%)
_Train Local_ResNet_18, epoch  46, local model 54, internal_epoch   2, Avg loss: 0.0293, Accuracy: 461/1130 (40.7965%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.7449, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   1, Avg loss: 0.0628, Accuracy: 281/708 (39.6893%)
_Train Local_ResNet_18, epoch  46, local model 16, internal_epoch   2, Avg loss: 0.0378, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.7175, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  46, local model 76, internal_epoch   1, Avg loss: 0.0857, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch  46, local model 76, internal_epoch   2, Avg loss: 0.0484, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.6483, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 98, internal_epoch   1, Avg loss: 0.0817, Accuracy: 21/373 (5.6300%)
_Train Local_ResNet_18, epoch  46, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.4510, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   1, Avg loss: 0.0527, Accuracy: 332/1030 (32.2330%)
_Train Local_ResNet_18, epoch  46, local model 91, internal_epoch   2, Avg loss: 0.0257, Accuracy: 621/1030 (60.2913%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 8.1057, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   1, Avg loss: 0.0540, Accuracy: 324/1013 (31.9842%)
_Train Local_ResNet_18, epoch  46, local model 39, internal_epoch   2, Avg loss: 0.0264, Accuracy: 463/1013 (45.7058%)
_Test Local_ResNet_18 poisoned: False, epoch: 46, Avg loss: 7.6685, Accuracy: 78/10000 (0.7800%)
time spent on training: 150.82607102394104
[foolsgold agg] training data poison_ratio: 0.0  data num: [1013, 568, 1340, 773, 1130, 708, 466, 373, 1030, 1013]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 46, Avg loss: 5.3122, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 46, Avg loss: 5.5625, Accuracy: 0/9950 (0.0000%)
saving model
Done in 235.11516857147217 sec.
Server Epoch:47 choose agents : [50, 12, 17, 66, 78, 95, 72, 32, 76, 26].
_Train Local_ResNet_18, epoch  47, local model 50, internal_epoch   1, Avg loss: 0.0629, Accuracy: 161/809 (19.9011%)
_Train Local_ResNet_18, epoch  47, local model 50, internal_epoch   2, Avg loss: 0.0276, Accuracy: 348/809 (43.0161%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.0697, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   1, Avg loss: 0.0867, Accuracy: 21/338 (6.2130%)
_Train Local_ResNet_18, epoch  47, local model 12, internal_epoch   2, Avg loss: 0.0465, Accuracy: 138/338 (40.8284%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.4564, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   1, Avg loss: 0.0512, Accuracy: 389/1574 (24.7141%)
_Train Local_ResNet_18, epoch  47, local model 17, internal_epoch   2, Avg loss: 0.0273, Accuracy: 706/1574 (44.8539%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 8.3719, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   1, Avg loss: 0.0617, Accuracy: 273/1402 (19.4722%)
_Train Local_ResNet_18, epoch  47, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 385/1402 (27.4608%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.3083, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   1, Avg loss: 0.0830, Accuracy: 37/416 (8.8942%)
_Train Local_ResNet_18, epoch  47, local model 78, internal_epoch   2, Avg loss: 0.0453, Accuracy: 175/416 (42.0673%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.5663, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   1, Avg loss: 0.0532, Accuracy: 331/599 (55.2588%)
_Train Local_ResNet_18, epoch  47, local model 95, internal_epoch   2, Avg loss: 0.0289, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.6607, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 258/1241 (20.7897%)
_Train Local_ResNet_18, epoch  47, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 414/1241 (33.3602%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.1674, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   1, Avg loss: 0.0596, Accuracy: 201/735 (27.3469%)
_Train Local_ResNet_18, epoch  47, local model 32, internal_epoch   2, Avg loss: 0.0230, Accuracy: 327/735 (44.4898%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.9206, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   1, Avg loss: 0.0854, Accuracy: 47/466 (10.0858%)
_Train Local_ResNet_18, epoch  47, local model 76, internal_epoch   2, Avg loss: 0.0487, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.6846, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   1, Avg loss: 0.0545, Accuracy: 341/1446 (23.5823%)
_Train Local_ResNet_18, epoch  47, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 494/1446 (34.1632%)
_Test Local_ResNet_18 poisoned: False, epoch: 47, Avg loss: 7.3652, Accuracy: 61/10000 (0.6100%)
time spent on training: 174.4633400440216
[foolsgold agg] training data poison_ratio: 0.0663638378019056  data num: [809, 338, 1574, 1402, 416, 599, 1241, 735, 466, 1446]
[foolsgold agg] considering poison per batch poison_fraction: 0.0207386993130955
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 47, Avg loss: 5.3121, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 47, Avg loss: 5.5591, Accuracy: 0/9950 (0.0000%)
saving model
Done in 259.1013877391815 sec.
Server Epoch:48 choose agents : [84, 55, 13, 42, 91, 4, 11, 19, 73, 61].
_Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   1, Avg loss: 0.0623, Accuracy: 327/1190 (27.4790%)
_Train Local_ResNet_18, epoch  48, local model 84, internal_epoch   2, Avg loss: 0.0318, Accuracy: 464/1190 (38.9916%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.0617, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   1, Avg loss: 0.0552, Accuracy: 253/1071 (23.6228%)
_Train Local_ResNet_18, epoch  48, local model 55, internal_epoch   2, Avg loss: 0.0290, Accuracy: 509/1071 (47.5257%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.2359, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  48, local model 13, internal_epoch   1, Avg loss: 0.0572, Accuracy: 354/1645 (21.5198%)
_Train Local_ResNet_18, epoch  48, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 612/1645 (37.2036%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.0956, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   1, Avg loss: 0.0536, Accuracy: 338/1372 (24.6356%)
_Train Local_ResNet_18, epoch  48, local model 42, internal_epoch   2, Avg loss: 0.0313, Accuracy: 472/1372 (34.4023%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.7840, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  48, local model 91, internal_epoch   1, Avg loss: 0.0507, Accuracy: 347/1030 (33.6893%)
_Train Local_ResNet_18, epoch  48, local model 91, internal_epoch   2, Avg loss: 0.0261, Accuracy: 640/1030 (62.1359%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 8.4123, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   1, Avg loss: 0.0630, Accuracy: 334/901 (37.0699%)
_Train Local_ResNet_18, epoch  48, local model 4, internal_epoch   2, Avg loss: 0.0333, Accuracy: 356/901 (39.5117%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.9888, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   1, Avg loss: 0.0537, Accuracy: 346/712 (48.5955%)
_Train Local_ResNet_18, epoch  48, local model 11, internal_epoch   2, Avg loss: 0.0285, Accuracy: 413/712 (58.0056%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 6.6960, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   1, Avg loss: 0.0467, Accuracy: 394/1036 (38.0309%)
_Train Local_ResNet_18, epoch  48, local model 19, internal_epoch   2, Avg loss: 0.0249, Accuracy: 668/1036 (64.4788%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 9.5736, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   1, Avg loss: 0.0667, Accuracy: 162/938 (17.2708%)
_Train Local_ResNet_18, epoch  48, local model 73, internal_epoch   2, Avg loss: 0.0332, Accuracy: 321/938 (34.2217%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 7.3116, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   1, Avg loss: 0.1255, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  48, local model 61, internal_epoch   2, Avg loss: 0.1181, Accuracy: 6/85 (7.0588%)
_Test Local_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3041, Accuracy: 45/10000 (0.4500%)
time spent on training: 168.9794204235077
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 1071, 1645, 1372, 1030, 901, 712, 1036, 938, 85]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 48, Avg loss: 5.3120, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 48, Avg loss: 5.5579, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.45724654197693 sec.
Server Epoch:49 choose agents : [98, 39, 95, 2, 31, 41, 85, 0, 18, 69].
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   1, Avg loss: 0.0816, Accuracy: 22/373 (5.8981%)
_Train Local_ResNet_18, epoch  49, local model 98, internal_epoch   2, Avg loss: 0.0479, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.4579, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 39, internal_epoch   1, Avg loss: 0.0530, Accuracy: 316/1013 (31.1945%)
_Train Local_ResNet_18, epoch  49, local model 39, internal_epoch   2, Avg loss: 0.0257, Accuracy: 501/1013 (49.4571%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1441, Accuracy: 75/10000 (0.7500%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  49, local model 95, internal_epoch   1, Avg loss: 0.0516, Accuracy: 332/599 (55.4257%)
_Train Local_ResNet_18, epoch  49, local model 95, internal_epoch   2, Avg loss: 0.0275, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.0064, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   1, Avg loss: 0.0627, Accuracy: 233/605 (38.5124%)
_Train Local_ResNet_18, epoch  49, local model 2, internal_epoch   2, Avg loss: 0.0400, Accuracy: 327/605 (54.0496%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.8150, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   1, Avg loss: 0.0816, Accuracy: 54/460 (11.7391%)
_Train Local_ResNet_18, epoch  49, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.7653, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   1, Avg loss: 0.0594, Accuracy: 329/719 (45.7580%)
_Train Local_ResNet_18, epoch  49, local model 41, internal_epoch   2, Avg loss: 0.0314, Accuracy: 455/719 (63.2823%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.3260, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  49, local model 85, internal_epoch   1, Avg loss: 0.0547, Accuracy: 498/1988 (25.0503%)
_Train Local_ResNet_18, epoch  49, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 700/1988 (35.2113%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.1321, Accuracy: 83/10000 (0.8300%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  49, local model 0, internal_epoch   1, Avg loss: 0.0583, Accuracy: 355/1657 (21.4243%)
_Train Local_ResNet_18, epoch  49, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 528/1657 (31.8648%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 8.0410, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   1, Avg loss: 0.0769, Accuracy: 117/530 (22.0755%)
_Train Local_ResNet_18, epoch  49, local model 18, internal_epoch   2, Avg loss: 0.0393, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.1630, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   1, Avg loss: 0.0570, Accuracy: 282/590 (47.7966%)
_Train Local_ResNet_18, epoch  49, local model 69, internal_epoch   2, Avg loss: 0.0334, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 49, Avg loss: 6.9570, Accuracy: 50/10000 (0.5000%)
time spent on training: 178.3955500125885
[foolsgold agg] training data poison_ratio: 0.2643543473166159  data num: [373, 1013, 599, 605, 460, 719, 1988, 1657, 530, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.08261073353644247
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 49, Avg loss: 5.3120, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 49, Avg loss: 5.5581, Accuracy: 0/9950 (0.0000%)
saving model
Done in 260.5395622253418 sec.
Server Epoch:50 choose agents : [11, 22, 40, 49, 83, 52, 64, 6, 61, 8].
_Train Local_ResNet_18, epoch  50, local model 11, internal_epoch   1, Avg loss: 0.0574, Accuracy: 348/712 (48.8764%)
_Train Local_ResNet_18, epoch  50, local model 11, internal_epoch   2, Avg loss: 0.0253, Accuracy: 398/712 (55.8989%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.5021, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   1, Avg loss: 0.0454, Accuracy: 505/1470 (34.3537%)
_Train Local_ResNet_18, epoch  50, local model 22, internal_epoch   2, Avg loss: 0.0239, Accuracy: 818/1470 (55.6463%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.1590, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   1, Avg loss: 0.0552, Accuracy: 373/1573 (23.7127%)
_Train Local_ResNet_18, epoch  50, local model 40, internal_epoch   2, Avg loss: 0.0351, Accuracy: 557/1573 (35.4100%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.3337, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   1, Avg loss: 0.0793, Accuracy: 31/440 (7.0455%)
_Train Local_ResNet_18, epoch  50, local model 49, internal_epoch   2, Avg loss: 0.0480, Accuracy: 146/440 (33.1818%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.5325, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 83, internal_epoch   1, Avg loss: 0.0544, Accuracy: 441/1953 (22.5806%)
_Train Local_ResNet_18, epoch  50, local model 83, internal_epoch   2, Avg loss: 0.0335, Accuracy: 765/1953 (39.1705%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.7295, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   1, Avg loss: 0.0562, Accuracy: 289/636 (45.4403%)
_Train Local_ResNet_18, epoch  50, local model 52, internal_epoch   2, Avg loss: 0.0304, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.1299, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   1, Avg loss: 0.0648, Accuracy: 163/953 (17.1039%)
_Train Local_ResNet_18, epoch  50, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 289/953 (30.3253%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 6.6015, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 397/1956 (20.2965%)
_Train Local_ResNet_18, epoch  50, local model 6, internal_epoch   2, Avg loss: 0.0320, Accuracy: 649/1956 (33.1800%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 8.0836, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   1, Avg loss: 0.1261, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  50, local model 61, internal_epoch   2, Avg loss: 0.1158, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3038, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   1, Avg loss: 0.0595, Accuracy: 245/1513 (16.1930%)
_Train Local_ResNet_18, epoch  50, local model 8, internal_epoch   2, Avg loss: 0.0367, Accuracy: 468/1513 (30.9319%)
_Test Local_ResNet_18 poisoned: False, epoch: 50, Avg loss: 7.4663, Accuracy: 84/10000 (0.8400%)
time spent on training: 185.53081631660461
[foolsgold agg] training data poison_ratio: 0.0  data num: [712, 1470, 1573, 440, 1953, 636, 953, 1956, 85, 1513]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 50, Avg loss: 5.3119, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 50, Avg loss: 5.5571, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 50
Done in 269.5517282485962 sec.
Server Epoch:51 choose agents : [40, 71, 49, 42, 5, 57, 22, 34, 60, 12].
_Train Local_ResNet_18, epoch  51, local model 40, internal_epoch   1, Avg loss: 0.0545, Accuracy: 365/1573 (23.2041%)
_Train Local_ResNet_18, epoch  51, local model 40, internal_epoch   2, Avg loss: 0.0348, Accuracy: 573/1573 (36.4272%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.7095, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   1, Avg loss: 0.0641, Accuracy: 155/818 (18.9487%)
_Train Local_ResNet_18, epoch  51, local model 71, internal_epoch   2, Avg loss: 0.0308, Accuracy: 346/818 (42.2983%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 7.0848, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  51, local model 49, internal_epoch   1, Avg loss: 0.0791, Accuracy: 32/440 (7.2727%)
_Train Local_ResNet_18, epoch  51, local model 49, internal_epoch   2, Avg loss: 0.0474, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.5146, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   1, Avg loss: 0.0533, Accuracy: 355/1372 (25.8746%)
_Train Local_ResNet_18, epoch  51, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 507/1372 (36.9534%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.0629, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   1, Avg loss: 0.0505, Accuracy: 412/1628 (25.3071%)
_Train Local_ResNet_18, epoch  51, local model 5, internal_epoch   2, Avg loss: 0.0253, Accuracy: 831/1628 (51.0442%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.1095, Accuracy: 116/10000 (1.1600%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   1, Avg loss: 0.0541, Accuracy: 302/1154 (26.1698%)
_Train Local_ResNet_18, epoch  51, local model 57, internal_epoch   2, Avg loss: 0.0256, Accuracy: 500/1154 (43.3276%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 9.0731, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   1, Avg loss: 0.0460, Accuracy: 501/1470 (34.0816%)
_Train Local_ResNet_18, epoch  51, local model 22, internal_epoch   2, Avg loss: 0.0237, Accuracy: 848/1470 (57.6871%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.0035, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   1, Avg loss: 0.0577, Accuracy: 409/1427 (28.6615%)
_Train Local_ResNet_18, epoch  51, local model 34, internal_epoch   2, Avg loss: 0.0336, Accuracy: 580/1427 (40.6447%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 6.9315, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 588/2227 (26.4032%)
_Train Local_ResNet_18, epoch  51, local model 60, internal_epoch   2, Avg loss: 0.0281, Accuracy: 1036/2227 (46.5200%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 8.2966, Accuracy: 124/10000 (1.2400%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   1, Avg loss: 0.0868, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  51, local model 12, internal_epoch   2, Avg loss: 0.0491, Accuracy: 144/338 (42.6036%)
_Test Local_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.4321, Accuracy: 51/10000 (0.5100%)
time spent on training: 205.6757457256317
[foolsgold agg] training data poison_ratio: 0.0  data num: [1573, 818, 440, 1372, 1628, 1154, 1470, 1427, 2227, 338]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 51, Avg loss: 5.3118, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 51, Avg loss: 5.5560, Accuracy: 0/9950 (0.0000%)
saving model
Done in 289.2784204483032 sec.
Server Epoch:52 choose agents : [72, 7, 94, 91, 34, 85, 61, 58, 18, 42].
_Train Local_ResNet_18, epoch  52, local model 72, internal_epoch   1, Avg loss: 0.0617, Accuracy: 260/1241 (20.9508%)
_Train Local_ResNet_18, epoch  52, local model 72, internal_epoch   2, Avg loss: 0.0363, Accuracy: 403/1241 (32.4738%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.2466, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   1, Avg loss: 0.0529, Accuracy: 352/891 (39.5062%)
_Train Local_ResNet_18, epoch  52, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 436/891 (48.9338%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.1684, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  52, local model 94, internal_epoch   1, Avg loss: 0.0555, Accuracy: 345/1662 (20.7581%)
_Train Local_ResNet_18, epoch  52, local model 94, internal_epoch   2, Avg loss: 0.0329, Accuracy: 647/1662 (38.9290%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.6147, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  52, local model 91, internal_epoch   1, Avg loss: 0.0518, Accuracy: 332/1030 (32.2330%)
_Train Local_ResNet_18, epoch  52, local model 91, internal_epoch   2, Avg loss: 0.0277, Accuracy: 639/1030 (62.0388%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 8.5499, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   1, Avg loss: 0.0571, Accuracy: 399/1427 (27.9608%)
_Train Local_ResNet_18, epoch  52, local model 34, internal_epoch   2, Avg loss: 0.0333, Accuracy: 574/1427 (40.2242%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.0296, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  52, local model 85, internal_epoch   1, Avg loss: 0.0533, Accuracy: 441/1988 (22.1831%)
_Train Local_ResNet_18, epoch  52, local model 85, internal_epoch   2, Avg loss: 0.0358, Accuracy: 695/1988 (34.9598%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.7011, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   1, Avg loss: 0.1256, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  52, local model 61, internal_epoch   2, Avg loss: 0.1166, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3040, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   1, Avg loss: 0.0588, Accuracy: 341/803 (42.4658%)
_Train Local_ResNet_18, epoch  52, local model 58, internal_epoch   2, Avg loss: 0.0332, Accuracy: 412/803 (51.3076%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.0640, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   1, Avg loss: 0.0758, Accuracy: 116/530 (21.8868%)
_Train Local_ResNet_18, epoch  52, local model 18, internal_epoch   2, Avg loss: 0.0391, Accuracy: 275/530 (51.8868%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 6.0767, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   1, Avg loss: 0.0530, Accuracy: 344/1372 (25.0729%)
_Train Local_ResNet_18, epoch  52, local model 42, internal_epoch   2, Avg loss: 0.0310, Accuracy: 529/1372 (38.5569%)
_Test Local_ResNet_18 poisoned: False, epoch: 52, Avg loss: 7.9400, Accuracy: 68/10000 (0.6800%)
time spent on training: 201.33822965621948
[foolsgold agg] training data poison_ratio: 0.0  data num: [1241, 891, 1662, 1030, 1427, 1988, 85, 803, 530, 1372]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 52, Avg loss: 5.3118, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 52, Avg loss: 5.5558, Accuracy: 0/9950 (0.0000%)
saving model
Done in 284.367395401001 sec.
Server Epoch:53 choose agents : [1, 32, 31, 44, 27, 62, 95, 28, 49, 40].
_Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   1, Avg loss: 0.0576, Accuracy: 282/928 (30.3879%)
_Train Local_ResNet_18, epoch  53, local model 1, internal_epoch   2, Avg loss: 0.0230, Accuracy: 571/928 (61.5302%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0595, Accuracy: 86/10000 (0.8600%)
_Train Local_ResNet_18, epoch  53, local model 32, internal_epoch   1, Avg loss: 0.0594, Accuracy: 199/735 (27.0748%)
_Train Local_ResNet_18, epoch  53, local model 32, internal_epoch   2, Avg loss: 0.0218, Accuracy: 369/735 (50.2041%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 8.0482, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  53, local model 31, internal_epoch   1, Avg loss: 0.0808, Accuracy: 71/460 (15.4348%)
_Train Local_ResNet_18, epoch  53, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.7538, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 396/1750 (22.6286%)
_Train Local_ResNet_18, epoch  53, local model 44, internal_epoch   2, Avg loss: 0.0350, Accuracy: 681/1750 (38.9143%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.6405, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 428/1587 (26.9691%)
_Train Local_ResNet_18, epoch  53, local model 27, internal_epoch   2, Avg loss: 0.0339, Accuracy: 629/1587 (39.6345%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.2351, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   1, Avg loss: 0.0684, Accuracy: 145/568 (25.5282%)
_Train Local_ResNet_18, epoch  53, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.7031, Accuracy: 49/10000 (0.4900%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  53, local model 95, internal_epoch   1, Avg loss: 0.0531, Accuracy: 334/599 (55.7596%)
_Train Local_ResNet_18, epoch  53, local model 95, internal_epoch   2, Avg loss: 0.0286, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.7419, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   1, Avg loss: 0.0563, Accuracy: 376/1581 (23.7824%)
_Train Local_ResNet_18, epoch  53, local model 28, internal_epoch   2, Avg loss: 0.0335, Accuracy: 599/1581 (37.8874%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.6446, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   1, Avg loss: 0.0789, Accuracy: 38/440 (8.6364%)
_Train Local_ResNet_18, epoch  53, local model 49, internal_epoch   2, Avg loss: 0.0468, Accuracy: 145/440 (32.9545%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.5114, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   1, Avg loss: 0.0548, Accuracy: 389/1573 (24.7298%)
_Train Local_ResNet_18, epoch  53, local model 40, internal_epoch   2, Avg loss: 0.0351, Accuracy: 569/1573 (36.1729%)
_Test Local_ResNet_18 poisoned: False, epoch: 53, Avg loss: 7.3265, Accuracy: 71/10000 (0.7100%)
time spent on training: 202.18404722213745
[foolsgold agg] training data poison_ratio: 0.05860483318657666  data num: [928, 735, 460, 1750, 1587, 568, 599, 1581, 440, 1573]
[foolsgold agg] considering poison per batch poison_fraction: 0.018314010370805205
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 53, Avg loss: 5.3117, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 53, Avg loss: 5.5523, Accuracy: 0/9950 (0.0000%)
saving model
Done in 283.73806381225586 sec.
Server Epoch:54 choose agents : [8, 16, 22, 38, 69, 90, 47, 85, 7, 94].
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 237/1513 (15.6642%)
_Train Local_ResNet_18, epoch  54, local model 8, internal_epoch   2, Avg loss: 0.0364, Accuracy: 481/1513 (31.7911%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.5693, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   1, Avg loss: 0.0610, Accuracy: 281/708 (39.6893%)
_Train Local_ResNet_18, epoch  54, local model 16, internal_epoch   2, Avg loss: 0.0351, Accuracy: 428/708 (60.4520%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.8655, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   1, Avg loss: 0.0455, Accuracy: 531/1470 (36.1224%)
_Train Local_ResNet_18, epoch  54, local model 22, internal_epoch   2, Avg loss: 0.0238, Accuracy: 825/1470 (56.1224%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.9101, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   1, Avg loss: 0.0611, Accuracy: 256/1131 (22.6348%)
_Train Local_ResNet_18, epoch  54, local model 38, internal_epoch   2, Avg loss: 0.0309, Accuracy: 494/1131 (43.6782%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.3332, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   1, Avg loss: 0.0550, Accuracy: 286/590 (48.4746%)
_Train Local_ResNet_18, epoch  54, local model 69, internal_epoch   2, Avg loss: 0.0317, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.0161, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   1, Avg loss: 0.0567, Accuracy: 314/677 (46.3811%)
_Train Local_ResNet_18, epoch  54, local model 90, internal_epoch   2, Avg loss: 0.0231, Accuracy: 450/677 (66.4697%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.3840, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   1, Avg loss: 0.1244, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  54, local model 47, internal_epoch   2, Avg loss: 0.1097, Accuracy: 13/134 (9.7015%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3102, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   1, Avg loss: 0.0547, Accuracy: 417/1988 (20.9759%)
_Train Local_ResNet_18, epoch  54, local model 85, internal_epoch   2, Avg loss: 0.0353, Accuracy: 666/1988 (33.5010%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 8.0319, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   1, Avg loss: 0.0530, Accuracy: 362/891 (40.6285%)
_Train Local_ResNet_18, epoch  54, local model 7, internal_epoch   2, Avg loss: 0.0260, Accuracy: 437/891 (49.0460%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.3252, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  54, local model 94, internal_epoch   1, Avg loss: 0.0545, Accuracy: 339/1662 (20.3971%)
_Train Local_ResNet_18, epoch  54, local model 94, internal_epoch   2, Avg loss: 0.0332, Accuracy: 615/1662 (37.0036%)
_Test Local_ResNet_18 poisoned: False, epoch: 54, Avg loss: 7.5371, Accuracy: 87/10000 (0.8700%)
time spent on training: 202.375736951828
[foolsgold agg] training data poison_ratio: 0.0  data num: [1513, 708, 1470, 1131, 590, 677, 134, 1988, 891, 1662]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 54, Avg loss: 5.3116, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 54, Avg loss: 5.5524, Accuracy: 0/9950 (0.0000%)
saving model
Done in 285.2966148853302 sec.
Server Epoch:55 choose agents : [54, 89, 78, 16, 55, 80, 13, 61, 12, 27].
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   1, Avg loss: 0.0553, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  55, local model 54, internal_epoch   2, Avg loss: 0.0285, Accuracy: 493/1130 (43.6283%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.7345, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   1, Avg loss: 0.0602, Accuracy: 344/896 (38.3929%)
_Train Local_ResNet_18, epoch  55, local model 89, internal_epoch   2, Avg loss: 0.0332, Accuracy: 446/896 (49.7768%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.3232, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   1, Avg loss: 0.0826, Accuracy: 43/416 (10.3365%)
_Train Local_ResNet_18, epoch  55, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 169/416 (40.6250%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.6064, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   1, Avg loss: 0.0620, Accuracy: 277/708 (39.1243%)
_Train Local_ResNet_18, epoch  55, local model 16, internal_epoch   2, Avg loss: 0.0393, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.7772, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   1, Avg loss: 0.0558, Accuracy: 257/1071 (23.9963%)
_Train Local_ResNet_18, epoch  55, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 493/1071 (46.0317%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 8.2390, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  55, local model 80, internal_epoch   1, Avg loss: 0.0699, Accuracy: 144/682 (21.1144%)
_Train Local_ResNet_18, epoch  55, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 245/682 (35.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 6.3918, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   1, Avg loss: 0.0574, Accuracy: 328/1645 (19.9392%)
_Train Local_ResNet_18, epoch  55, local model 13, internal_epoch   2, Avg loss: 0.0323, Accuracy: 654/1645 (39.7568%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.9524, Accuracy: 128/10000 (1.2800%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   1, Avg loss: 0.1246, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  55, local model 61, internal_epoch   2, Avg loss: 0.1163, Accuracy: 12/85 (14.1176%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3041, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   1, Avg loss: 0.0856, Accuracy: 27/338 (7.9882%)
_Train Local_ResNet_18, epoch  55, local model 12, internal_epoch   2, Avg loss: 0.0481, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.4416, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   1, Avg loss: 0.0532, Accuracy: 462/1587 (29.1115%)
_Train Local_ResNet_18, epoch  55, local model 27, internal_epoch   2, Avg loss: 0.0337, Accuracy: 608/1587 (38.3113%)
_Test Local_ResNet_18 poisoned: False, epoch: 55, Avg loss: 7.4721, Accuracy: 68/10000 (0.6800%)
time spent on training: 178.1816041469574
[foolsgold agg] training data poison_ratio: 0.0  data num: [1130, 896, 416, 708, 1071, 682, 1645, 85, 338, 1587]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 55, Avg loss: 5.3115, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 55, Avg loss: 5.5520, Accuracy: 0/9950 (0.0000%)
saving model
Done in 260.8602297306061 sec.
Server Epoch:56 choose agents : [0, 41, 85, 47, 95, 90, 72, 45, 32, 26].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  56, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 356/1657 (21.4846%)
_Train Local_ResNet_18, epoch  56, local model 0, internal_epoch   2, Avg loss: 0.0352, Accuracy: 485/1657 (29.2698%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.8468, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   1, Avg loss: 0.0593, Accuracy: 328/719 (45.6189%)
_Train Local_ResNet_18, epoch  56, local model 41, internal_epoch   2, Avg loss: 0.0323, Accuracy: 451/719 (62.7260%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 6.3363, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  56, local model 85, internal_epoch   1, Avg loss: 0.0528, Accuracy: 467/1988 (23.4909%)
_Train Local_ResNet_18, epoch  56, local model 85, internal_epoch   2, Avg loss: 0.0360, Accuracy: 653/1988 (32.8471%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.2317, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   1, Avg loss: 0.1205, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  56, local model 47, internal_epoch   2, Avg loss: 0.1092, Accuracy: 20/134 (14.9254%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3098, Accuracy: 50/10000 (0.5000%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  56, local model 95, internal_epoch   1, Avg loss: 0.0527, Accuracy: 332/599 (55.4257%)
_Train Local_ResNet_18, epoch  56, local model 95, internal_epoch   2, Avg loss: 0.0279, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4335, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   1, Avg loss: 0.0573, Accuracy: 314/677 (46.3811%)
_Train Local_ResNet_18, epoch  56, local model 90, internal_epoch   2, Avg loss: 0.0228, Accuracy: 447/677 (66.0266%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.1899, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   1, Avg loss: 0.0616, Accuracy: 262/1241 (21.1120%)
_Train Local_ResNet_18, epoch  56, local model 72, internal_epoch   2, Avg loss: 0.0365, Accuracy: 384/1241 (30.9428%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.4068, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   1, Avg loss: 0.0668, Accuracy: 196/669 (29.2975%)
_Train Local_ResNet_18, epoch  56, local model 45, internal_epoch   2, Avg loss: 0.0411, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.8217, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   1, Avg loss: 0.0594, Accuracy: 198/735 (26.9388%)
_Train Local_ResNet_18, epoch  56, local model 32, internal_epoch   2, Avg loss: 0.0235, Accuracy: 313/735 (42.5850%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 8.2953, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 355/1446 (24.5505%)
_Train Local_ResNet_18, epoch  56, local model 26, internal_epoch   2, Avg loss: 0.0346, Accuracy: 481/1446 (33.2642%)
_Test Local_ResNet_18 poisoned: False, epoch: 56, Avg loss: 7.1400, Accuracy: 61/10000 (0.6100%)
time spent on training: 208.9924943447113
[foolsgold agg] training data poison_ratio: 0.22868727825646223  data num: [1657, 719, 1988, 134, 599, 677, 1241, 669, 735, 1446]
[foolsgold agg] considering poison per batch poison_fraction: 0.07146477445514444
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 56, Avg loss: 5.3115, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 56, Avg loss: 5.5483, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.0035490989685 sec.
Server Epoch:57 choose agents : [7, 40, 56, 4, 32, 75, 76, 70, 89, 9].
_Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   1, Avg loss: 0.0527, Accuracy: 359/891 (40.2918%)
_Train Local_ResNet_18, epoch  57, local model 7, internal_epoch   2, Avg loss: 0.0265, Accuracy: 429/891 (48.1481%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.3480, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   1, Avg loss: 0.0548, Accuracy: 370/1573 (23.5219%)
_Train Local_ResNet_18, epoch  57, local model 40, internal_epoch   2, Avg loss: 0.0347, Accuracy: 584/1573 (37.1265%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.7650, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   1, Avg loss: 0.0826, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  57, local model 56, internal_epoch   2, Avg loss: 0.0669, Accuracy: 67/186 (36.0215%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3117, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   1, Avg loss: 0.0601, Accuracy: 330/901 (36.6260%)
_Train Local_ResNet_18, epoch  57, local model 4, internal_epoch   2, Avg loss: 0.0326, Accuracy: 380/901 (42.1754%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2736, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   1, Avg loss: 0.0593, Accuracy: 219/735 (29.7959%)
_Train Local_ResNet_18, epoch  57, local model 32, internal_epoch   2, Avg loss: 0.0223, Accuracy: 366/735 (49.7959%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 8.0299, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   1, Avg loss: 0.0643, Accuracy: 259/776 (33.3763%)
_Train Local_ResNet_18, epoch  57, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 411/776 (52.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.2044, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 76, internal_epoch   1, Avg loss: 0.0850, Accuracy: 48/466 (10.3004%)
_Train Local_ResNet_18, epoch  57, local model 76, internal_epoch   2, Avg loss: 0.0490, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.7077, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   1, Avg loss: 0.0563, Accuracy: 358/1418 (25.2468%)
_Train Local_ResNet_18, epoch  57, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 599/1418 (42.2426%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 7.7549, Accuracy: 92/10000 (0.9200%)
_Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   1, Avg loss: 0.0606, Accuracy: 336/896 (37.5000%)
_Train Local_ResNet_18, epoch  57, local model 89, internal_epoch   2, Avg loss: 0.0333, Accuracy: 433/896 (48.3259%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 6.3220, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   1, Avg loss: 0.0491, Accuracy: 386/1275 (30.2745%)
_Train Local_ResNet_18, epoch  57, local model 9, internal_epoch   2, Avg loss: 0.0188, Accuracy: 732/1275 (57.4118%)
_Test Local_ResNet_18 poisoned: False, epoch: 57, Avg loss: 9.6929, Accuracy: 97/10000 (0.9700%)
time spent on training: 172.90340280532837
[foolsgold agg] training data poison_ratio: 0.0  data num: [891, 1573, 186, 901, 735, 776, 466, 1418, 896, 1275]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 57, Avg loss: 5.3114, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 57, Avg loss: 5.5448, Accuracy: 0/9950 (0.0000%)
saving model
Done in 255.14006686210632 sec.
Server Epoch:58 choose agents : [35, 34, 31, 90, 75, 19, 27, 24, 33, 23].
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   1, Avg loss: 0.0856, Accuracy: 33/271 (12.1771%)
_Train Local_ResNet_18, epoch  58, local model 35, internal_epoch   2, Avg loss: 0.0565, Accuracy: 99/271 (36.5314%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3661, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   1, Avg loss: 0.0574, Accuracy: 403/1427 (28.2411%)
_Train Local_ResNet_18, epoch  58, local model 34, internal_epoch   2, Avg loss: 0.0330, Accuracy: 585/1427 (40.9951%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 6.9431, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   1, Avg loss: 0.0810, Accuracy: 57/460 (12.3913%)
_Train Local_ResNet_18, epoch  58, local model 31, internal_epoch   2, Avg loss: 0.0375, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8185, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 90, internal_epoch   1, Avg loss: 0.0578, Accuracy: 313/677 (46.2334%)
_Train Local_ResNet_18, epoch  58, local model 90, internal_epoch   2, Avg loss: 0.0233, Accuracy: 444/677 (65.5835%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.5134, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   1, Avg loss: 0.0645, Accuracy: 253/776 (32.6031%)
_Train Local_ResNet_18, epoch  58, local model 75, internal_epoch   2, Avg loss: 0.0284, Accuracy: 411/776 (52.9639%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.2977, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   1, Avg loss: 0.0479, Accuracy: 426/1036 (41.1197%)
_Train Local_ResNet_18, epoch  58, local model 19, internal_epoch   2, Avg loss: 0.0250, Accuracy: 669/1036 (64.5753%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 9.3681, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   1, Avg loss: 0.0534, Accuracy: 447/1587 (28.1664%)
_Train Local_ResNet_18, epoch  58, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 617/1587 (38.8784%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 7.1699, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   1, Avg loss: 0.0755, Accuracy: 44/312 (14.1026%)
_Train Local_ResNet_18, epoch  58, local model 24, internal_epoch   2, Avg loss: 0.0394, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3831, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   1, Avg loss: 0.0773, Accuracy: 65/515 (12.6214%)
_Train Local_ResNet_18, epoch  58, local model 33, internal_epoch   2, Avg loss: 0.0509, Accuracy: 128/515 (24.8544%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.8324, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   1, Avg loss: 0.0612, Accuracy: 322/715 (45.0350%)
_Train Local_ResNet_18, epoch  58, local model 23, internal_epoch   2, Avg loss: 0.0378, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.7260, Accuracy: 50/10000 (0.5000%)
time spent on training: 162.38668251037598
[foolsgold agg] training data poison_ratio: 0.0  data num: [271, 1427, 460, 677, 776, 1036, 1587, 312, 515, 715]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 58, Avg loss: 5.3113, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 58, Avg loss: 5.5448, Accuracy: 0/9950 (0.0000%)
saving model
Done in 244.03558993339539 sec.
Server Epoch:59 choose agents : [69, 84, 6, 40, 21, 23, 99, 76, 53, 20].
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   1, Avg loss: 0.0579, Accuracy: 288/590 (48.8136%)
_Train Local_ResNet_18, epoch  59, local model 69, internal_epoch   2, Avg loss: 0.0301, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.7757, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 324/1190 (27.2269%)
_Train Local_ResNet_18, epoch  59, local model 84, internal_epoch   2, Avg loss: 0.0326, Accuracy: 429/1190 (36.0504%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.9761, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   1, Avg loss: 0.0546, Accuracy: 410/1956 (20.9611%)
_Train Local_ResNet_18, epoch  59, local model 6, internal_epoch   2, Avg loss: 0.0321, Accuracy: 665/1956 (33.9980%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3066, Accuracy: 107/10000 (1.0700%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   1, Avg loss: 0.0547, Accuracy: 358/1573 (22.7591%)
_Train Local_ResNet_18, epoch  59, local model 40, internal_epoch   2, Avg loss: 0.0345, Accuracy: 594/1573 (37.7622%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.2567, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 397/1949 (20.3694%)
_Train Local_ResNet_18, epoch  59, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 649/1949 (33.2991%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 8.3160, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   1, Avg loss: 0.0605, Accuracy: 319/715 (44.6154%)
_Train Local_ResNet_18, epoch  59, local model 23, internal_epoch   2, Avg loss: 0.0397, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.7170, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   1, Avg loss: 0.0664, Accuracy: 182/773 (23.5446%)
_Train Local_ResNet_18, epoch  59, local model 99, internal_epoch   2, Avg loss: 0.0313, Accuracy: 380/773 (49.1591%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 7.1177, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  59, local model 76, internal_epoch   1, Avg loss: 0.0846, Accuracy: 45/466 (9.6567%)
_Train Local_ResNet_18, epoch  59, local model 76, internal_epoch   2, Avg loss: 0.0478, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.7087, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   1, Avg loss: 0.0493, Accuracy: 279/813 (34.3173%)
_Train Local_ResNet_18, epoch  59, local model 53, internal_epoch   2, Avg loss: 0.0188, Accuracy: 445/813 (54.7355%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 9.1905, Accuracy: 49/10000 (0.4900%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   1, Avg loss: 0.0567, Accuracy: 346/807 (42.8748%)
_Train Local_ResNet_18, epoch  59, local model 20, internal_epoch   2, Avg loss: 0.0316, Accuracy: 433/807 (53.6555%)
_Test Local_ResNet_18 poisoned: False, epoch: 59, Avg loss: 6.9252, Accuracy: 50/10000 (0.5000%)
time spent on training: 212.42924427986145
[foolsgold agg] training data poison_ratio: 0.07450147710487445  data num: [590, 1190, 1956, 1573, 1949, 715, 773, 466, 813, 807]
[foolsgold agg] considering poison per batch poison_fraction: 0.023281711595273265
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 59, Avg loss: 5.3113, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 59, Avg loss: 5.5456, Accuracy: 0/9950 (0.0000%)
saving model
Done in 296.140762090683 sec.
Server Epoch:60 choose agents : [51, 0, 53, 75, 42, 61, 12, 54, 70, 11].
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   1, Avg loss: 0.0597, Accuracy: 226/1049 (21.5443%)
_Train Local_ResNet_18, epoch  60, local model 51, internal_epoch   2, Avg loss: 0.0298, Accuracy: 518/1049 (49.3804%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.3177, Accuracy: 75/10000 (0.7500%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  60, local model 0, internal_epoch   1, Avg loss: 0.0586, Accuracy: 345/1657 (20.8208%)
_Train Local_ResNet_18, epoch  60, local model 0, internal_epoch   2, Avg loss: 0.0352, Accuracy: 492/1657 (29.6922%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.5821, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   1, Avg loss: 0.0488, Accuracy: 293/813 (36.0394%)
_Train Local_ResNet_18, epoch  60, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 473/813 (58.1796%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 9.4294, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  60, local model 75, internal_epoch   1, Avg loss: 0.0655, Accuracy: 248/776 (31.9588%)
_Train Local_ResNet_18, epoch  60, local model 75, internal_epoch   2, Avg loss: 0.0286, Accuracy: 421/776 (54.2526%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.9720, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   1, Avg loss: 0.0529, Accuracy: 344/1372 (25.0729%)
_Train Local_ResNet_18, epoch  60, local model 42, internal_epoch   2, Avg loss: 0.0311, Accuracy: 521/1372 (37.9738%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.9113, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   1, Avg loss: 0.1248, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  60, local model 61, internal_epoch   2, Avg loss: 0.1179, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3042, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   1, Avg loss: 0.0860, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  60, local model 12, internal_epoch   2, Avg loss: 0.0481, Accuracy: 131/338 (38.7574%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.4559, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   1, Avg loss: 0.0550, Accuracy: 351/1130 (31.0619%)
_Train Local_ResNet_18, epoch  60, local model 54, internal_epoch   2, Avg loss: 0.0294, Accuracy: 422/1130 (37.3451%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.8564, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   1, Avg loss: 0.0554, Accuracy: 384/1418 (27.0804%)
_Train Local_ResNet_18, epoch  60, local model 70, internal_epoch   2, Avg loss: 0.0310, Accuracy: 642/1418 (45.2750%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 7.7159, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   1, Avg loss: 0.0560, Accuracy: 350/712 (49.1573%)
_Train Local_ResNet_18, epoch  60, local model 11, internal_epoch   2, Avg loss: 0.0254, Accuracy: 421/712 (59.1292%)
_Test Local_ResNet_18 poisoned: False, epoch: 60, Avg loss: 6.7071, Accuracy: 50/10000 (0.5000%)
time spent on training: 196.4013476371765
[foolsgold agg] training data poison_ratio: 0.1772192513368984  data num: [1049, 1657, 813, 776, 1372, 85, 338, 1130, 1418, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.05538101604278075
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 60, Avg loss: 5.3112, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 60, Avg loss: 5.5460, Accuracy: 0/9950 (0.0000%)
saving model
Saving model on epoch 60
Done in 278.9144639968872 sec.
Server Epoch:61 choose agents : [85, 95, 51, 25, 38, 6, 55, 53, 12, 69].
_Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   1, Avg loss: 0.0536, Accuracy: 432/1988 (21.7304%)
_Train Local_ResNet_18, epoch  61, local model 85, internal_epoch   2, Avg loss: 0.0350, Accuracy: 684/1988 (34.4064%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.1185, Accuracy: 98/10000 (0.9800%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  61, local model 95, internal_epoch   1, Avg loss: 0.0526, Accuracy: 333/599 (55.5927%)
_Train Local_ResNet_18, epoch  61, local model 95, internal_epoch   2, Avg loss: 0.0280, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.5649, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   1, Avg loss: 0.0596, Accuracy: 225/1049 (21.4490%)
_Train Local_ResNet_18, epoch  61, local model 51, internal_epoch   2, Avg loss: 0.0310, Accuracy: 485/1049 (46.2345%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.5353, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   1, Avg loss: 0.0565, Accuracy: 307/690 (44.4928%)
_Train Local_ResNet_18, epoch  61, local model 25, internal_epoch   2, Avg loss: 0.0275, Accuracy: 458/690 (66.3768%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.5256, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   1, Avg loss: 0.0612, Accuracy: 259/1131 (22.9001%)
_Train Local_ResNet_18, epoch  61, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 484/1131 (42.7940%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.3720, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   1, Avg loss: 0.0545, Accuracy: 388/1956 (19.8364%)
_Train Local_ResNet_18, epoch  61, local model 6, internal_epoch   2, Avg loss: 0.0323, Accuracy: 640/1956 (32.7198%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 8.3544, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   1, Avg loss: 0.0563, Accuracy: 252/1071 (23.5294%)
_Train Local_ResNet_18, epoch  61, local model 55, internal_epoch   2, Avg loss: 0.0284, Accuracy: 516/1071 (48.1793%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 7.8421, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   1, Avg loss: 0.0488, Accuracy: 280/813 (34.4403%)
_Train Local_ResNet_18, epoch  61, local model 53, internal_epoch   2, Avg loss: 0.0184, Accuracy: 472/813 (58.0566%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 9.5710, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   1, Avg loss: 0.0855, Accuracy: 32/338 (9.4675%)
_Train Local_ResNet_18, epoch  61, local model 12, internal_epoch   2, Avg loss: 0.0466, Accuracy: 160/338 (47.3373%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.4623, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   1, Avg loss: 0.0559, Accuracy: 287/590 (48.6441%)
_Train Local_ResNet_18, epoch  61, local model 69, internal_epoch   2, Avg loss: 0.0335, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 61, Avg loss: 6.9954, Accuracy: 50/10000 (0.5000%)
time spent on training: 219.74437594413757
[foolsgold agg] training data poison_ratio: 0.05858190709046455  data num: [1988, 599, 1049, 690, 1131, 1956, 1071, 813, 338, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.01830684596577017
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 61, Avg loss: 5.3112, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 61, Avg loss: 5.5465, Accuracy: 0/9950 (0.0000%)
saving model
Done in 302.73201608657837 sec.
Server Epoch:62 choose agents : [84, 79, 24, 82, 4, 30, 94, 33, 69, 60].
_Train Local_ResNet_18, epoch  62, local model 84, internal_epoch   1, Avg loss: 0.0623, Accuracy: 320/1190 (26.8908%)
_Train Local_ResNet_18, epoch  62, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 463/1190 (38.9076%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.2023, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   1, Avg loss: 0.1019, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  62, local model 79, internal_epoch   2, Avg loss: 0.0887, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3237, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   1, Avg loss: 0.0754, Accuracy: 42/312 (13.4615%)
_Train Local_ResNet_18, epoch  62, local model 24, internal_epoch   2, Avg loss: 0.0393, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3940, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   1, Avg loss: 0.0763, Accuracy: 84/500 (16.8000%)
_Train Local_ResNet_18, epoch  62, local model 82, internal_epoch   2, Avg loss: 0.0482, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.7252, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   1, Avg loss: 0.0629, Accuracy: 328/901 (36.4040%)
_Train Local_ResNet_18, epoch  62, local model 4, internal_epoch   2, Avg loss: 0.0316, Accuracy: 373/901 (41.3984%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.0100, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   1, Avg loss: 0.0797, Accuracy: 82/486 (16.8724%)
_Train Local_ResNet_18, epoch  62, local model 30, internal_epoch   2, Avg loss: 0.0397, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.7559, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  62, local model 94, internal_epoch   1, Avg loss: 0.0551, Accuracy: 344/1662 (20.6980%)
_Train Local_ResNet_18, epoch  62, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 629/1662 (37.8460%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 7.7757, Accuracy: 109/10000 (1.0900%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   1, Avg loss: 0.0782, Accuracy: 68/515 (13.2039%)
_Train Local_ResNet_18, epoch  62, local model 33, internal_epoch   2, Avg loss: 0.0530, Accuracy: 131/515 (25.4369%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.7052, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   1, Avg loss: 0.0563, Accuracy: 286/590 (48.4746%)
_Train Local_ResNet_18, epoch  62, local model 69, internal_epoch   2, Avg loss: 0.0319, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 6.8727, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   1, Avg loss: 0.0497, Accuracy: 625/2227 (28.0647%)
_Train Local_ResNet_18, epoch  62, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1060/2227 (47.5977%)
_Test Local_ResNet_18 poisoned: False, epoch: 62, Avg loss: 8.3024, Accuracy: 123/10000 (1.2300%)
time spent on training: 174.3956344127655
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 197, 312, 500, 901, 486, 1662, 515, 590, 2227]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 62, Avg loss: 5.3111, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 62, Avg loss: 5.5450, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.6011037826538 sec.
Server Epoch:63 choose agents : [18, 64, 38, 96, 55, 91, 58, 59, 66, 77].
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   1, Avg loss: 0.0757, Accuracy: 114/530 (21.5094%)
_Train Local_ResNet_18, epoch  63, local model 18, internal_epoch   2, Avg loss: 0.0387, Accuracy: 270/530 (50.9434%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.0601, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   1, Avg loss: 0.0638, Accuracy: 180/953 (18.8877%)
_Train Local_ResNet_18, epoch  63, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 308/953 (32.3190%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.6538, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   1, Avg loss: 0.0609, Accuracy: 252/1131 (22.2812%)
_Train Local_ResNet_18, epoch  63, local model 38, internal_epoch   2, Avg loss: 0.0305, Accuracy: 510/1131 (45.0928%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.1363, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  63, local model 96, internal_epoch   1, Avg loss: 0.0779, Accuracy: 55/311 (17.6849%)
_Train Local_ResNet_18, epoch  63, local model 96, internal_epoch   2, Avg loss: 0.0532, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3494, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   1, Avg loss: 0.0548, Accuracy: 280/1071 (26.1438%)
_Train Local_ResNet_18, epoch  63, local model 55, internal_epoch   2, Avg loss: 0.0293, Accuracy: 477/1071 (44.5378%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.1039, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   1, Avg loss: 0.0523, Accuracy: 352/1030 (34.1748%)
_Train Local_ResNet_18, epoch  63, local model 91, internal_epoch   2, Avg loss: 0.0248, Accuracy: 641/1030 (62.2330%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 8.2887, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   1, Avg loss: 0.0572, Accuracy: 351/803 (43.7111%)
_Train Local_ResNet_18, epoch  63, local model 58, internal_epoch   2, Avg loss: 0.0343, Accuracy: 388/803 (48.3188%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 6.1096, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 313/1089 (28.7420%)
_Train Local_ResNet_18, epoch  63, local model 59, internal_epoch   2, Avg loss: 0.0281, Accuracy: 475/1089 (43.6180%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.1809, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   1, Avg loss: 0.0618, Accuracy: 251/1402 (17.9030%)
_Train Local_ResNet_18, epoch  63, local model 66, internal_epoch   2, Avg loss: 0.0386, Accuracy: 403/1402 (28.7447%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.2650, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  63, local model 77, internal_epoch   1, Avg loss: 0.0533, Accuracy: 325/1340 (24.2537%)
_Train Local_ResNet_18, epoch  63, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 582/1340 (43.4328%)
_Test Local_ResNet_18 poisoned: False, epoch: 63, Avg loss: 7.6918, Accuracy: 63/10000 (0.6300%)
time spent on training: 194.0456190109253
[foolsgold agg] training data poison_ratio: 0.0  data num: [530, 953, 1131, 311, 1071, 1030, 803, 1089, 1402, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 63, Avg loss: 5.3110, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 63, Avg loss: 5.5433, Accuracy: 0/9950 (0.0000%)
saving model
Done in 276.3160421848297 sec.
Server Epoch:64 choose agents : [78, 13, 57, 64, 48, 23, 71, 35, 32, 76].
_Train Local_ResNet_18, epoch  64, local model 78, internal_epoch   1, Avg loss: 0.0825, Accuracy: 46/416 (11.0577%)
_Train Local_ResNet_18, epoch  64, local model 78, internal_epoch   2, Avg loss: 0.0446, Accuracy: 193/416 (46.3942%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.5849, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   1, Avg loss: 0.0577, Accuracy: 307/1645 (18.6626%)
_Train Local_ResNet_18, epoch  64, local model 13, internal_epoch   2, Avg loss: 0.0327, Accuracy: 651/1645 (39.5745%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.0217, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   1, Avg loss: 0.0546, Accuracy: 299/1154 (25.9099%)
_Train Local_ResNet_18, epoch  64, local model 57, internal_epoch   2, Avg loss: 0.0267, Accuracy: 429/1154 (37.1750%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.0892, Accuracy: 84/10000 (0.8400%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   1, Avg loss: 0.0641, Accuracy: 170/953 (17.8384%)
_Train Local_ResNet_18, epoch  64, local model 64, internal_epoch   2, Avg loss: 0.0377, Accuracy: 321/953 (33.6831%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.4223, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   1, Avg loss: 0.0708, Accuracy: 104/631 (16.4818%)
_Train Local_ResNet_18, epoch  64, local model 48, internal_epoch   2, Avg loss: 0.0417, Accuracy: 218/631 (34.5483%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.8766, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   1, Avg loss: 0.0619, Accuracy: 325/715 (45.4545%)
_Train Local_ResNet_18, epoch  64, local model 23, internal_epoch   2, Avg loss: 0.0394, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.7378, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   1, Avg loss: 0.0634, Accuracy: 167/818 (20.4156%)
_Train Local_ResNet_18, epoch  64, local model 71, internal_epoch   2, Avg loss: 0.0304, Accuracy: 362/818 (44.2543%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 6.9825, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   1, Avg loss: 0.0862, Accuracy: 36/271 (13.2841%)
_Train Local_ResNet_18, epoch  64, local model 35, internal_epoch   2, Avg loss: 0.0564, Accuracy: 105/271 (38.7454%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3656, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   1, Avg loss: 0.0593, Accuracy: 211/735 (28.7075%)
_Train Local_ResNet_18, epoch  64, local model 32, internal_epoch   2, Avg loss: 0.0232, Accuracy: 331/735 (45.0340%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 8.4938, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   1, Avg loss: 0.0844, Accuracy: 56/466 (12.0172%)
_Train Local_ResNet_18, epoch  64, local model 76, internal_epoch   2, Avg loss: 0.0488, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.6468, Accuracy: 50/10000 (0.5000%)
time spent on training: 169.1794035434723
[foolsgold agg] training data poison_ratio: 0.0  data num: [416, 1645, 1154, 953, 631, 715, 818, 271, 735, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 64, Avg loss: 5.3110, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 64, Avg loss: 5.5391, Accuracy: 0/9950 (0.0000%)
saving model
Done in 251.8473722934723 sec.
Server Epoch:65 choose agents : [28, 37, 12, 15, 85, 30, 66, 73, 82, 11].
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   1, Avg loss: 0.0561, Accuracy: 394/1581 (24.9209%)
_Train Local_ResNet_18, epoch  65, local model 28, internal_epoch   2, Avg loss: 0.0332, Accuracy: 607/1581 (38.3934%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.8984, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   1, Avg loss: 0.0526, Accuracy: 394/1129 (34.8981%)
_Train Local_ResNet_18, epoch  65, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 731/1129 (64.7476%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.8725, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   1, Avg loss: 0.0853, Accuracy: 34/338 (10.0592%)
_Train Local_ResNet_18, epoch  65, local model 12, internal_epoch   2, Avg loss: 0.0456, Accuracy: 154/338 (45.5621%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.4603, Accuracy: 45/10000 (0.4500%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 344/1154 (29.8094%)
_Train Local_ResNet_18, epoch  65, local model 15, internal_epoch   2, Avg loss: 0.0284, Accuracy: 491/1154 (42.5477%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.8320, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  65, local model 85, internal_epoch   1, Avg loss: 0.0539, Accuracy: 484/1988 (24.3461%)
_Train Local_ResNet_18, epoch  65, local model 85, internal_epoch   2, Avg loss: 0.0354, Accuracy: 675/1988 (33.9537%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.7051, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   1, Avg loss: 0.0795, Accuracy: 81/486 (16.6667%)
_Train Local_ResNet_18, epoch  65, local model 30, internal_epoch   2, Avg loss: 0.0407, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.8151, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   1, Avg loss: 0.0614, Accuracy: 272/1402 (19.4009%)
_Train Local_ResNet_18, epoch  65, local model 66, internal_epoch   2, Avg loss: 0.0384, Accuracy: 413/1402 (29.4579%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.2701, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   1, Avg loss: 0.0653, Accuracy: 174/938 (18.5501%)
_Train Local_ResNet_18, epoch  65, local model 73, internal_epoch   2, Avg loss: 0.0333, Accuracy: 349/938 (37.2068%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 7.4160, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   1, Avg loss: 0.0757, Accuracy: 74/500 (14.8000%)
_Train Local_ResNet_18, epoch  65, local model 82, internal_epoch   2, Avg loss: 0.0479, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.7523, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   1, Avg loss: 0.0532, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  65, local model 11, internal_epoch   2, Avg loss: 0.0284, Accuracy: 417/712 (58.5674%)
_Test Local_ResNet_18 poisoned: False, epoch: 65, Avg loss: 6.7450, Accuracy: 50/10000 (0.5000%)
time spent on training: 206.73990631103516
[foolsgold agg] training data poison_ratio: 0.0  data num: [1581, 1129, 338, 1154, 1988, 486, 1402, 938, 500, 712]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 65, Avg loss: 5.3110, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 65, Avg loss: 5.5385, Accuracy: 0/9950 (0.0000%)
saving model
Done in 288.5875811576843 sec.
Server Epoch:66 choose agents : [90, 62, 96, 18, 82, 94, 92, 73, 7, 71].
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   1, Avg loss: 0.0562, Accuracy: 323/677 (47.7105%)
_Train Local_ResNet_18, epoch  66, local model 90, internal_epoch   2, Avg loss: 0.0235, Accuracy: 437/677 (64.5495%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.5356, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   1, Avg loss: 0.0683, Accuracy: 150/568 (26.4085%)
_Train Local_ResNet_18, epoch  66, local model 62, internal_epoch   2, Avg loss: 0.0408, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.7769, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 96, internal_epoch   1, Avg loss: 0.0780, Accuracy: 54/311 (17.3633%)
_Train Local_ResNet_18, epoch  66, local model 96, internal_epoch   2, Avg loss: 0.0540, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3509, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   1, Avg loss: 0.0758, Accuracy: 112/530 (21.1321%)
_Train Local_ResNet_18, epoch  66, local model 18, internal_epoch   2, Avg loss: 0.0396, Accuracy: 267/530 (50.3774%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 6.1012, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  66, local model 82, internal_epoch   1, Avg loss: 0.0759, Accuracy: 72/500 (14.4000%)
_Train Local_ResNet_18, epoch  66, local model 82, internal_epoch   2, Avg loss: 0.0483, Accuracy: 170/500 (34.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.6351, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   1, Avg loss: 0.0554, Accuracy: 325/1662 (19.5548%)
_Train Local_ResNet_18, epoch  66, local model 94, internal_epoch   2, Avg loss: 0.0331, Accuracy: 600/1662 (36.1011%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.9028, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   1, Avg loss: 0.0518, Accuracy: 445/1715 (25.9475%)
_Train Local_ResNet_18, epoch  66, local model 92, internal_epoch   2, Avg loss: 0.0306, Accuracy: 717/1715 (41.8076%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.6865, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   1, Avg loss: 0.0652, Accuracy: 167/938 (17.8038%)
_Train Local_ResNet_18, epoch  66, local model 73, internal_epoch   2, Avg loss: 0.0331, Accuracy: 337/938 (35.9275%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.3707, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   1, Avg loss: 0.0520, Accuracy: 363/891 (40.7407%)
_Train Local_ResNet_18, epoch  66, local model 7, internal_epoch   2, Avg loss: 0.0257, Accuracy: 459/891 (51.5152%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.3636, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   1, Avg loss: 0.0639, Accuracy: 163/818 (19.9267%)
_Train Local_ResNet_18, epoch  66, local model 71, internal_epoch   2, Avg loss: 0.0302, Accuracy: 357/818 (43.6430%)
_Test Local_ResNet_18 poisoned: False, epoch: 66, Avg loss: 7.1734, Accuracy: 66/10000 (0.6600%)
time spent on training: 175.18828558921814
[foolsgold agg] training data poison_ratio: 0.0  data num: [677, 568, 311, 530, 500, 1662, 1715, 938, 891, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 66, Avg loss: 5.3109, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 66, Avg loss: 5.5372, Accuracy: 0/9950 (0.0000%)
saving model
Done in 257.2451128959656 sec.
Server Epoch:67 choose agents : [44, 84, 98, 56, 6, 75, 64, 39, 14, 78].
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   1, Avg loss: 0.0585, Accuracy: 371/1750 (21.2000%)
_Train Local_ResNet_18, epoch  67, local model 44, internal_epoch   2, Avg loss: 0.0354, Accuracy: 666/1750 (38.0571%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.6713, Accuracy: 114/10000 (1.1400%)
_Train Local_ResNet_18, epoch  67, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 324/1190 (27.2269%)
_Train Local_ResNet_18, epoch  67, local model 84, internal_epoch   2, Avg loss: 0.0315, Accuracy: 455/1190 (38.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.0288, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  67, local model 98, internal_epoch   1, Avg loss: 0.0812, Accuracy: 23/373 (6.1662%)
_Train Local_ResNet_18, epoch  67, local model 98, internal_epoch   2, Avg loss: 0.0476, Accuracy: 155/373 (41.5550%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.4513, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   1, Avg loss: 0.0825, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  67, local model 56, internal_epoch   2, Avg loss: 0.0668, Accuracy: 74/186 (39.7849%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3113, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   1, Avg loss: 0.0543, Accuracy: 398/1956 (20.3476%)
_Train Local_ResNet_18, epoch  67, local model 6, internal_epoch   2, Avg loss: 0.0314, Accuracy: 685/1956 (35.0204%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 8.3030, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  67, local model 75, internal_epoch   1, Avg loss: 0.0642, Accuracy: 258/776 (33.2474%)
_Train Local_ResNet_18, epoch  67, local model 75, internal_epoch   2, Avg loss: 0.0298, Accuracy: 386/776 (49.7423%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.7763, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   1, Avg loss: 0.0640, Accuracy: 172/953 (18.0483%)
_Train Local_ResNet_18, epoch  67, local model 64, internal_epoch   2, Avg loss: 0.0376, Accuracy: 327/953 (34.3127%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.3807, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   1, Avg loss: 0.0537, Accuracy: 316/1013 (31.1945%)
_Train Local_ResNet_18, epoch  67, local model 39, internal_epoch   2, Avg loss: 0.0261, Accuracy: 511/1013 (50.4442%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 7.5964, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   1, Avg loss: 0.0620, Accuracy: 228/1013 (22.5074%)
_Train Local_ResNet_18, epoch  67, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 312/1013 (30.7996%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 6.7533, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   1, Avg loss: 0.0824, Accuracy: 38/416 (9.1346%)
_Train Local_ResNet_18, epoch  67, local model 78, internal_epoch   2, Avg loss: 0.0459, Accuracy: 187/416 (44.9519%)
_Test Local_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.5462, Accuracy: 50/10000 (0.5000%)
time spent on training: 201.96557593345642
[foolsgold agg] training data poison_ratio: 0.0  data num: [1750, 1190, 373, 186, 1956, 776, 953, 1013, 1013, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 67, Avg loss: 5.3109, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 67, Avg loss: 5.5366, Accuracy: 0/9950 (0.0000%)
saving model
Done in 286.44865703582764 sec.
Server Epoch:68 choose agents : [21, 24, 59, 44, 84, 9, 17, 88, 52, 63].
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 399/1949 (20.4720%)
_Train Local_ResNet_18, epoch  68, local model 21, internal_epoch   2, Avg loss: 0.0332, Accuracy: 624/1949 (32.0164%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.4229, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   1, Avg loss: 0.0752, Accuracy: 45/312 (14.4231%)
_Train Local_ResNet_18, epoch  68, local model 24, internal_epoch   2, Avg loss: 0.0412, Accuracy: 158/312 (50.6410%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3896, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   1, Avg loss: 0.0585, Accuracy: 304/1089 (27.9155%)
_Train Local_ResNet_18, epoch  68, local model 59, internal_epoch   2, Avg loss: 0.0276, Accuracy: 471/1089 (43.2507%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 10.7999, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 416/1750 (23.7714%)
_Train Local_ResNet_18, epoch  68, local model 44, internal_epoch   2, Avg loss: 0.0349, Accuracy: 680/1750 (38.8571%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 7.7213, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  68, local model 84, internal_epoch   1, Avg loss: 0.0627, Accuracy: 321/1190 (26.9748%)
_Train Local_ResNet_18, epoch  68, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 455/1190 (38.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.8938, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   1, Avg loss: 0.0497, Accuracy: 358/1275 (28.0784%)
_Train Local_ResNet_18, epoch  68, local model 9, internal_epoch   2, Avg loss: 0.0195, Accuracy: 703/1275 (55.1373%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 9.0994, Accuracy: 96/10000 (0.9600%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   1, Avg loss: 0.0506, Accuracy: 398/1574 (25.2859%)
_Train Local_ResNet_18, epoch  68, local model 17, internal_epoch   2, Avg loss: 0.0274, Accuracy: 678/1574 (43.0750%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.3239, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   1, Avg loss: 0.0753, Accuracy: 148/603 (24.5439%)
_Train Local_ResNet_18, epoch  68, local model 88, internal_epoch   2, Avg loss: 0.0462, Accuracy: 287/603 (47.5954%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.9691, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   1, Avg loss: 0.0565, Accuracy: 292/636 (45.9119%)
_Train Local_ResNet_18, epoch  68, local model 52, internal_epoch   2, Avg loss: 0.0307, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 6.3062, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   1, Avg loss: 0.0537, Accuracy: 267/888 (30.0676%)
_Train Local_ResNet_18, epoch  68, local model 63, internal_epoch   2, Avg loss: 0.0258, Accuracy: 418/888 (47.0721%)
_Test Local_ResNet_18 poisoned: False, epoch: 68, Avg loss: 8.4818, Accuracy: 50/10000 (0.5000%)
time spent on training: 223.4890332221985
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 312, 1089, 1750, 1190, 1275, 1574, 603, 636, 888]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 68, Avg loss: 5.3109, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 68, Avg loss: 5.5372, Accuracy: 0/9950 (0.0000%)
saving model
Done in 306.1166718006134 sec.
Server Epoch:69 choose agents : [21, 31, 44, 90, 70, 81, 84, 5, 69, 76].
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   1, Avg loss: 0.0537, Accuracy: 363/1949 (18.6249%)
_Train Local_ResNet_18, epoch  69, local model 21, internal_epoch   2, Avg loss: 0.0330, Accuracy: 648/1949 (33.2478%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.4654, Accuracy: 90/10000 (0.9000%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   1, Avg loss: 0.0810, Accuracy: 63/460 (13.6957%)
_Train Local_ResNet_18, epoch  69, local model 31, internal_epoch   2, Avg loss: 0.0372, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.7731, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   1, Avg loss: 0.0589, Accuracy: 401/1750 (22.9143%)
_Train Local_ResNet_18, epoch  69, local model 44, internal_epoch   2, Avg loss: 0.0349, Accuracy: 683/1750 (39.0286%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.6053, Accuracy: 108/10000 (1.0800%)
_Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   1, Avg loss: 0.0558, Accuracy: 319/677 (47.1196%)
_Train Local_ResNet_18, epoch  69, local model 90, internal_epoch   2, Avg loss: 0.0232, Accuracy: 461/677 (68.0945%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.1848, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   1, Avg loss: 0.0555, Accuracy: 345/1418 (24.3300%)
_Train Local_ResNet_18, epoch  69, local model 70, internal_epoch   2, Avg loss: 0.0307, Accuracy: 625/1418 (44.0762%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.5753, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  69, local model 81, internal_epoch   1, Avg loss: 0.0675, Accuracy: 236/774 (30.4910%)
_Train Local_ResNet_18, epoch  69, local model 81, internal_epoch   2, Avg loss: 0.0360, Accuracy: 290/774 (37.4677%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 6.1712, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  69, local model 84, internal_epoch   1, Avg loss: 0.0613, Accuracy: 332/1190 (27.8992%)
_Train Local_ResNet_18, epoch  69, local model 84, internal_epoch   2, Avg loss: 0.0320, Accuracy: 454/1190 (38.1513%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.1302, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   1, Avg loss: 0.0506, Accuracy: 401/1628 (24.6314%)
_Train Local_ResNet_18, epoch  69, local model 5, internal_epoch   2, Avg loss: 0.0257, Accuracy: 826/1628 (50.7371%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 8.2302, Accuracy: 112/10000 (1.1200%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   1, Avg loss: 0.0571, Accuracy: 292/590 (49.4915%)
_Train Local_ResNet_18, epoch  69, local model 69, internal_epoch   2, Avg loss: 0.0310, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 7.0075, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  69, local model 76, internal_epoch   1, Avg loss: 0.0851, Accuracy: 52/466 (11.1588%)
_Train Local_ResNet_18, epoch  69, local model 76, internal_epoch   2, Avg loss: 0.0482, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.6849, Accuracy: 50/10000 (0.5000%)
time spent on training: 235.03658604621887
[foolsgold agg] training data poison_ratio: 0.0  data num: [1949, 460, 1750, 677, 1418, 774, 1190, 1628, 590, 466]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 69, Avg loss: 5.3108, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 69, Avg loss: 5.5373, Accuracy: 0/9950 (0.0000%)
saving model
Done in 317.1241924762726 sec.
Server Epoch:70 choose agents : [7, 75, 77, 74, 16, 9, 19, 99, 48, 66].
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   1, Avg loss: 0.0526, Accuracy: 363/891 (40.7407%)
_Train Local_ResNet_18, epoch  70, local model 7, internal_epoch   2, Avg loss: 0.0258, Accuracy: 449/891 (50.3928%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.0810, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   1, Avg loss: 0.0644, Accuracy: 260/776 (33.5052%)
_Train Local_ResNet_18, epoch  70, local model 75, internal_epoch   2, Avg loss: 0.0299, Accuracy: 421/776 (54.2526%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 6.7711, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 77, internal_epoch   1, Avg loss: 0.0535, Accuracy: 337/1340 (25.1493%)
_Train Local_ResNet_18, epoch  70, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 522/1340 (38.9552%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.8229, Accuracy: 65/10000 (0.6500%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   1, Avg loss: 0.0437, Accuracy: 467/1552 (30.0902%)
_Train Local_ResNet_18, epoch  70, local model 74, internal_epoch   2, Avg loss: 0.0212, Accuracy: 769/1552 (49.5490%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 10.3673, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   1, Avg loss: 0.0637, Accuracy: 282/708 (39.8305%)
_Train Local_ResNet_18, epoch  70, local model 16, internal_epoch   2, Avg loss: 0.0355, Accuracy: 426/708 (60.1695%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.8437, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   1, Avg loss: 0.0489, Accuracy: 363/1275 (28.4706%)
_Train Local_ResNet_18, epoch  70, local model 9, internal_epoch   2, Avg loss: 0.0188, Accuracy: 726/1275 (56.9412%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 9.2503, Accuracy: 88/10000 (0.8800%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   1, Avg loss: 0.0475, Accuracy: 402/1036 (38.8031%)
_Train Local_ResNet_18, epoch  70, local model 19, internal_epoch   2, Avg loss: 0.0260, Accuracy: 613/1036 (59.1699%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 8.9467, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   1, Avg loss: 0.0656, Accuracy: 179/773 (23.1565%)
_Train Local_ResNet_18, epoch  70, local model 99, internal_epoch   2, Avg loss: 0.0326, Accuracy: 410/773 (53.0401%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.3842, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   1, Avg loss: 0.0705, Accuracy: 104/631 (16.4818%)
_Train Local_ResNet_18, epoch  70, local model 48, internal_epoch   2, Avg loss: 0.0408, Accuracy: 231/631 (36.6086%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.7978, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   1, Avg loss: 0.0616, Accuracy: 275/1402 (19.6148%)
_Train Local_ResNet_18, epoch  70, local model 66, internal_epoch   2, Avg loss: 0.0385, Accuracy: 378/1402 (26.9615%)
_Test Local_ResNet_18 poisoned: False, epoch: 70, Avg loss: 7.2831, Accuracy: 80/10000 (0.8000%)
time spent on training: 244.3659520149231
[foolsgold agg] training data poison_ratio: 0.14946070878274267  data num: [891, 776, 1340, 1552, 708, 1275, 1036, 773, 631, 1402]
[foolsgold agg] considering poison per batch poison_fraction: 0.046706471494607084
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 70, Avg loss: 5.3108, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 70, Avg loss: 5.5375, Accuracy: 0/9950 (0.0000%)
saving model
Done in 326.11061668395996 sec.
Server Epoch:71 choose agents : [49, 6, 75, 91, 83, 24, 33, 79, 18, 85].
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   1, Avg loss: 0.0787, Accuracy: 34/440 (7.7273%)
_Train Local_ResNet_18, epoch  71, local model 49, internal_epoch   2, Avg loss: 0.0480, Accuracy: 149/440 (33.8636%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.5111, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   1, Avg loss: 0.0542, Accuracy: 421/1956 (21.5235%)
_Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   2, Avg loss: 0.0319, Accuracy: 649/1956 (33.1800%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.1501, Accuracy: 133/10000 (1.3300%)
_Train Local_ResNet_18, epoch  71, local model 75, internal_epoch   1, Avg loss: 0.0619, Accuracy: 263/776 (33.8918%)
_Train Local_ResNet_18, epoch  71, local model 75, internal_epoch   2, Avg loss: 0.0291, Accuracy: 406/776 (52.3196%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 7.0921, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 91, internal_epoch   1, Avg loss: 0.0510, Accuracy: 347/1030 (33.6893%)
_Train Local_ResNet_18, epoch  71, local model 91, internal_epoch   2, Avg loss: 0.0264, Accuracy: 635/1030 (61.6505%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.3792, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   1, Avg loss: 0.0538, Accuracy: 457/1953 (23.3999%)
_Train Local_ResNet_18, epoch  71, local model 83, internal_epoch   2, Avg loss: 0.0340, Accuracy: 782/1953 (40.0410%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.3157, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   1, Avg loss: 0.0750, Accuracy: 44/312 (14.1026%)
_Train Local_ResNet_18, epoch  71, local model 24, internal_epoch   2, Avg loss: 0.0398, Accuracy: 170/312 (54.4872%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3984, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   1, Avg loss: 0.0765, Accuracy: 73/515 (14.1748%)
_Train Local_ResNet_18, epoch  71, local model 33, internal_epoch   2, Avg loss: 0.0543, Accuracy: 130/515 (25.2427%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.8295, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   1, Avg loss: 0.1014, Accuracy: 13/197 (6.5990%)
_Train Local_ResNet_18, epoch  71, local model 79, internal_epoch   2, Avg loss: 0.0859, Accuracy: 61/197 (30.9645%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3189, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1, Avg loss: 0.0755, Accuracy: 123/530 (23.2075%)
_Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2, Avg loss: 0.0387, Accuracy: 269/530 (50.7547%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 6.1064, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  71, local model 85, internal_epoch   1, Avg loss: 0.0535, Accuracy: 453/1988 (22.7867%)
_Train Local_ResNet_18, epoch  71, local model 85, internal_epoch   2, Avg loss: 0.0351, Accuracy: 676/1988 (34.0040%)
_Test Local_ResNet_18 poisoned: False, epoch: 71, Avg loss: 8.0498, Accuracy: 78/10000 (0.7800%)
time spent on training: 217.84275197982788
[foolsgold agg] training data poison_ratio: 0.0  data num: [440, 1956, 776, 1030, 1953, 312, 515, 197, 530, 1988]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 71, Avg loss: 5.3106, Accuracy: 43/10000 (0.4300%)
_Test Target_ResNet_18 poisoned: True, epoch: 71, Avg loss: 5.5372, Accuracy: 0/9950 (0.0000%)
saving model
Done in 300.3623332977295 sec.
Server Epoch:72 choose agents : [31, 17, 64, 92, 34, 20, 4, 63, 22, 19].
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   1, Avg loss: 0.0806, Accuracy: 63/460 (13.6957%)
_Train Local_ResNet_18, epoch  72, local model 31, internal_epoch   2, Avg loss: 0.0373, Accuracy: 187/460 (40.6522%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.7740, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   1, Avg loss: 0.0517, Accuracy: 411/1574 (26.1118%)
_Train Local_ResNet_18, epoch  72, local model 17, internal_epoch   2, Avg loss: 0.0270, Accuracy: 703/1574 (44.6633%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.0071, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   1, Avg loss: 0.0639, Accuracy: 169/953 (17.7335%)
_Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 298/953 (31.2697%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.3893, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  72, local model 92, internal_epoch   1, Avg loss: 0.0519, Accuracy: 436/1715 (25.4227%)
_Train Local_ResNet_18, epoch  72, local model 92, internal_epoch   2, Avg loss: 0.0304, Accuracy: 748/1715 (43.6152%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.8815, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   1, Avg loss: 0.0584, Accuracy: 383/1427 (26.8395%)
_Train Local_ResNet_18, epoch  72, local model 34, internal_epoch   2, Avg loss: 0.0343, Accuracy: 541/1427 (37.9117%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.9674, Accuracy: 60/10000 (0.6000%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  72, local model 20, internal_epoch   1, Avg loss: 0.0566, Accuracy: 344/807 (42.6270%)
_Train Local_ResNet_18, epoch  72, local model 20, internal_epoch   2, Avg loss: 0.0314, Accuracy: 418/807 (51.7968%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 7.0840, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   1, Avg loss: 0.0617, Accuracy: 336/901 (37.2919%)
_Train Local_ResNet_18, epoch  72, local model 4, internal_epoch   2, Avg loss: 0.0312, Accuracy: 395/901 (43.8402%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 6.7613, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   1, Avg loss: 0.0541, Accuracy: 266/888 (29.9550%)
_Train Local_ResNet_18, epoch  72, local model 63, internal_epoch   2, Avg loss: 0.0257, Accuracy: 410/888 (46.1712%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.6081, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   1, Avg loss: 0.0448, Accuracy: 534/1470 (36.3265%)
_Train Local_ResNet_18, epoch  72, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 817/1470 (55.5782%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 8.2240, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   1, Avg loss: 0.0472, Accuracy: 386/1036 (37.2587%)
_Train Local_ResNet_18, epoch  72, local model 19, internal_epoch   2, Avg loss: 0.0239, Accuracy: 672/1036 (64.8649%)
_Test Local_ResNet_18 poisoned: False, epoch: 72, Avg loss: 9.4012, Accuracy: 61/10000 (0.6100%)
time spent on training: 252.7617964744568
[foolsgold agg] training data poison_ratio: 0.07185468791737155  data num: [460, 1574, 953, 1715, 1427, 807, 901, 888, 1470, 1036]
[foolsgold agg] considering poison per batch poison_fraction: 0.02245458997417861
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 72, Avg loss: 5.3106, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 72, Avg loss: 5.5357, Accuracy: 0/9950 (0.0000%)
saving model
Done in 334.57435512542725 sec.
Server Epoch:73 choose agents : [27, 74, 34, 98, 4, 72, 82, 12, 59, 89].
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   1, Avg loss: 0.0538, Accuracy: 447/1587 (28.1664%)
_Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   2, Avg loss: 0.0336, Accuracy: 631/1587 (39.7606%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.2493, Accuracy: 78/10000 (0.7800%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  73, local model 74, internal_epoch   1, Avg loss: 0.0430, Accuracy: 508/1552 (32.7320%)
_Train Local_ResNet_18, epoch  73, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 765/1552 (49.2912%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 10.9715, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   1, Avg loss: 0.0577, Accuracy: 393/1427 (27.5403%)
_Train Local_ResNet_18, epoch  73, local model 34, internal_epoch   2, Avg loss: 0.0329, Accuracy: 596/1427 (41.7659%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.8930, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   1, Avg loss: 0.0812, Accuracy: 22/373 (5.8981%)
_Train Local_ResNet_18, epoch  73, local model 98, internal_epoch   2, Avg loss: 0.0482, Accuracy: 153/373 (41.0188%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.4493, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   1, Avg loss: 0.0604, Accuracy: 336/901 (37.2919%)
_Train Local_ResNet_18, epoch  73, local model 4, internal_epoch   2, Avg loss: 0.0323, Accuracy: 394/901 (43.7292%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.9883, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   1, Avg loss: 0.0606, Accuracy: 265/1241 (21.3537%)
_Train Local_ResNet_18, epoch  73, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 419/1241 (33.7631%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.1883, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  73, local model 82, internal_epoch   1, Avg loss: 0.0754, Accuracy: 78/500 (15.6000%)
_Train Local_ResNet_18, epoch  73, local model 82, internal_epoch   2, Avg loss: 0.0480, Accuracy: 177/500 (35.4000%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.7129, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   1, Avg loss: 0.0856, Accuracy: 33/338 (9.7633%)
_Train Local_ResNet_18, epoch  73, local model 12, internal_epoch   2, Avg loss: 0.0468, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.4528, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 306/1089 (28.0992%)
_Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   2, Avg loss: 0.0298, Accuracy: 466/1089 (42.7916%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 7.2927, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  73, local model 89, internal_epoch   1, Avg loss: 0.0609, Accuracy: 338/896 (37.7232%)
_Train Local_ResNet_18, epoch  73, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 455/896 (50.7812%)
_Test Local_ResNet_18 poisoned: False, epoch: 73, Avg loss: 6.2611, Accuracy: 50/10000 (0.5000%)
time spent on training: 227.8516297340393
[foolsgold agg] training data poison_ratio: 0.1567043618739903  data num: [1587, 1552, 1427, 373, 901, 1241, 500, 338, 1089, 896]
[foolsgold agg] considering poison per batch poison_fraction: 0.04897011308562197
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 73, Avg loss: 5.3105, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 73, Avg loss: 5.5359, Accuracy: 0/9950 (0.0000%)
saving model
Done in 311.8174171447754 sec.
Server Epoch:74 choose agents : [9, 38, 74, 63, 50, 44, 1, 93, 94, 53].
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   1, Avg loss: 0.0491, Accuracy: 371/1275 (29.0980%)
_Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   2, Avg loss: 0.0190, Accuracy: 730/1275 (57.2549%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.6292, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   1, Avg loss: 0.0611, Accuracy: 261/1131 (23.0769%)
_Train Local_ResNet_18, epoch  74, local model 38, internal_epoch   2, Avg loss: 0.0306, Accuracy: 460/1131 (40.6720%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.4805, Accuracy: 81/10000 (0.8100%)
poison local model 74 index 2 
_Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   1, Avg loss: 0.0434, Accuracy: 438/1552 (28.2216%)
_Train Local_ResNet_18, epoch  74, local model 74, internal_epoch   2, Avg loss: 0.0208, Accuracy: 785/1552 (50.5799%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 10.5382, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   1, Avg loss: 0.0540, Accuracy: 263/888 (29.6171%)
_Train Local_ResNet_18, epoch  74, local model 63, internal_epoch   2, Avg loss: 0.0256, Accuracy: 431/888 (48.5360%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.4666, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   1, Avg loss: 0.0627, Accuracy: 187/809 (23.1150%)
_Train Local_ResNet_18, epoch  74, local model 50, internal_epoch   2, Avg loss: 0.0273, Accuracy: 341/809 (42.1508%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.4137, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   1, Avg loss: 0.0588, Accuracy: 400/1750 (22.8571%)
_Train Local_ResNet_18, epoch  74, local model 44, internal_epoch   2, Avg loss: 0.0349, Accuracy: 716/1750 (40.9143%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.5526, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   1, Avg loss: 0.0566, Accuracy: 285/928 (30.7112%)
_Train Local_ResNet_18, epoch  74, local model 1, internal_epoch   2, Avg loss: 0.0238, Accuracy: 583/928 (62.8233%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.9622, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   1, Avg loss: 0.0550, Accuracy: 425/1742 (24.3972%)
_Train Local_ResNet_18, epoch  74, local model 93, internal_epoch   2, Avg loss: 0.0318, Accuracy: 679/1742 (38.9782%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 7.6134, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   1, Avg loss: 0.0548, Accuracy: 351/1662 (21.1191%)
_Train Local_ResNet_18, epoch  74, local model 94, internal_epoch   2, Avg loss: 0.0328, Accuracy: 609/1662 (36.6426%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 8.0076, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   1, Avg loss: 0.0491, Accuracy: 285/813 (35.0554%)
_Train Local_ResNet_18, epoch  74, local model 53, internal_epoch   2, Avg loss: 0.0182, Accuracy: 458/813 (56.3346%)
_Test Local_ResNet_18 poisoned: False, epoch: 74, Avg loss: 9.8411, Accuracy: 51/10000 (0.5100%)
time spent on training: 268.3464632034302
[foolsgold agg] training data poison_ratio: 0.12366533864541833  data num: [1275, 1131, 1552, 888, 809, 1750, 928, 1742, 1662, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.03864541832669323
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 74, Avg loss: 5.3105, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 74, Avg loss: 5.5364, Accuracy: 0/9950 (0.0000%)
saving model
Done in 351.50234627723694 sec.
Server Epoch:75 choose agents : [89, 65, 75, 86, 4, 55, 82, 12, 21, 64].
_Train Local_ResNet_18, epoch  75, local model 89, internal_epoch   1, Avg loss: 0.0599, Accuracy: 333/896 (37.1652%)
_Train Local_ResNet_18, epoch  75, local model 89, internal_epoch   2, Avg loss: 0.0326, Accuracy: 461/896 (51.4509%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.3337, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   1, Avg loss: 0.0558, Accuracy: 395/1475 (26.7797%)
_Train Local_ResNet_18, epoch  75, local model 65, internal_epoch   2, Avg loss: 0.0316, Accuracy: 692/1475 (46.9153%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.2234, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   1, Avg loss: 0.0636, Accuracy: 258/776 (33.2474%)
_Train Local_ResNet_18, epoch  75, local model 75, internal_epoch   2, Avg loss: 0.0294, Accuracy: 422/776 (54.3814%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.0113, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 86, internal_epoch   1, Avg loss: 0.0615, Accuracy: 364/1003 (36.2911%)
_Train Local_ResNet_18, epoch  75, local model 86, internal_epoch   2, Avg loss: 0.0344, Accuracy: 382/1003 (38.0857%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.6507, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   1, Avg loss: 0.0581, Accuracy: 333/901 (36.9589%)
_Train Local_ResNet_18, epoch  75, local model 4, internal_epoch   2, Avg loss: 0.0342, Accuracy: 414/901 (45.9489%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.8238, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   1, Avg loss: 0.0550, Accuracy: 261/1071 (24.3697%)
_Train Local_ResNet_18, epoch  75, local model 55, internal_epoch   2, Avg loss: 0.0291, Accuracy: 497/1071 (46.4052%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 7.9988, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  75, local model 82, internal_epoch   1, Avg loss: 0.0756, Accuracy: 75/500 (15.0000%)
_Train Local_ResNet_18, epoch  75, local model 82, internal_epoch   2, Avg loss: 0.0479, Accuracy: 169/500 (33.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.6645, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   1, Avg loss: 0.0855, Accuracy: 22/338 (6.5089%)
_Train Local_ResNet_18, epoch  75, local model 12, internal_epoch   2, Avg loss: 0.0464, Accuracy: 145/338 (42.8994%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.4406, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   1, Avg loss: 0.0534, Accuracy: 387/1949 (19.8563%)
_Train Local_ResNet_18, epoch  75, local model 21, internal_epoch   2, Avg loss: 0.0331, Accuracy: 612/1949 (31.4007%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 8.2002, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   1, Avg loss: 0.0643, Accuracy: 186/953 (19.5173%)
_Train Local_ResNet_18, epoch  75, local model 64, internal_epoch   2, Avg loss: 0.0378, Accuracy: 310/953 (32.5289%)
_Test Local_ResNet_18 poisoned: False, epoch: 75, Avg loss: 6.4814, Accuracy: 66/10000 (0.6600%)
time spent on training: 224.03135633468628
[foolsgold agg] training data poison_ratio: 0.0  data num: [896, 1475, 776, 1003, 901, 1071, 500, 338, 1949, 953]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 75, Avg loss: 5.3104, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 75, Avg loss: 5.5339, Accuracy: 0/9950 (0.0000%)
saving model
Done in 307.1259059906006 sec.
Server Epoch:76 choose agents : [5, 72, 10, 55, 84, 39, 17, 89, 93, 35].
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   1, Avg loss: 0.0503, Accuracy: 408/1628 (25.0614%)
_Train Local_ResNet_18, epoch  76, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 839/1628 (51.5356%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.3357, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   1, Avg loss: 0.0612, Accuracy: 255/1241 (20.5479%)
_Train Local_ResNet_18, epoch  76, local model 72, internal_epoch   2, Avg loss: 0.0366, Accuracy: 398/1241 (32.0709%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.1934, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   1, Avg loss: 0.0576, Accuracy: 217/861 (25.2033%)
_Train Local_ResNet_18, epoch  76, local model 10, internal_epoch   2, Avg loss: 0.0212, Accuracy: 449/861 (52.1487%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1004, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   1, Avg loss: 0.0545, Accuracy: 301/1071 (28.1046%)
_Train Local_ResNet_18, epoch  76, local model 55, internal_epoch   2, Avg loss: 0.0286, Accuracy: 519/1071 (48.4594%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.8954, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  76, local model 84, internal_epoch   1, Avg loss: 0.0617, Accuracy: 322/1190 (27.0588%)
_Train Local_ResNet_18, epoch  76, local model 84, internal_epoch   2, Avg loss: 0.0322, Accuracy: 445/1190 (37.3950%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.1363, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   1, Avg loss: 0.0534, Accuracy: 314/1013 (30.9970%)
_Train Local_ResNet_18, epoch  76, local model 39, internal_epoch   2, Avg loss: 0.0258, Accuracy: 532/1013 (52.5173%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.0345, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   1, Avg loss: 0.0518, Accuracy: 410/1574 (26.0483%)
_Train Local_ResNet_18, epoch  76, local model 17, internal_epoch   2, Avg loss: 0.0278, Accuracy: 675/1574 (42.8844%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 8.1256, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  76, local model 89, internal_epoch   1, Avg loss: 0.0604, Accuracy: 335/896 (37.3884%)
_Train Local_ResNet_18, epoch  76, local model 89, internal_epoch   2, Avg loss: 0.0336, Accuracy: 433/896 (48.3259%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 6.2975, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   1, Avg loss: 0.0546, Accuracy: 419/1742 (24.0528%)
_Train Local_ResNet_18, epoch  76, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 728/1742 (41.7910%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 7.9333, Accuracy: 85/10000 (0.8500%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   1, Avg loss: 0.0860, Accuracy: 42/271 (15.4982%)
_Train Local_ResNet_18, epoch  76, local model 35, internal_epoch   2, Avg loss: 0.0562, Accuracy: 96/271 (35.4244%)
_Test Local_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3641, Accuracy: 47/10000 (0.4700%)
time spent on training: 258.5873329639435
[foolsgold agg] training data poison_ratio: 0.0  data num: [1628, 1241, 861, 1071, 1190, 1013, 1574, 896, 1742, 271]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 76, Avg loss: 5.3103, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 76, Avg loss: 5.5342, Accuracy: 0/9950 (0.0000%)
saving model
Done in 344.1813793182373 sec.
Server Epoch:77 choose agents : [61, 17, 20, 31, 50, 90, 71, 60, 96, 28].
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1, Avg loss: 0.1247, Accuracy: 1/85 (1.1765%)
_Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2, Avg loss: 0.1177, Accuracy: 7/85 (8.2353%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3037, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   1, Avg loss: 0.0507, Accuracy: 409/1574 (25.9848%)
_Train Local_ResNet_18, epoch  77, local model 17, internal_epoch   2, Avg loss: 0.0269, Accuracy: 714/1574 (45.3621%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.3273, Accuracy: 88/10000 (0.8800%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  77, local model 20, internal_epoch   1, Avg loss: 0.0571, Accuracy: 350/807 (43.3705%)
_Train Local_ResNet_18, epoch  77, local model 20, internal_epoch   2, Avg loss: 0.0315, Accuracy: 424/807 (52.5403%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.2578, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   1, Avg loss: 0.0802, Accuracy: 60/460 (13.0435%)
_Train Local_ResNet_18, epoch  77, local model 31, internal_epoch   2, Avg loss: 0.0378, Accuracy: 186/460 (40.4348%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.8018, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   1, Avg loss: 0.0628, Accuracy: 152/809 (18.7886%)
_Train Local_ResNet_18, epoch  77, local model 50, internal_epoch   2, Avg loss: 0.0272, Accuracy: 368/809 (45.4883%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.0959, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  77, local model 90, internal_epoch   1, Avg loss: 0.0571, Accuracy: 321/677 (47.4151%)
_Train Local_ResNet_18, epoch  77, local model 90, internal_epoch   2, Avg loss: 0.0234, Accuracy: 435/677 (64.2541%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.2811, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   1, Avg loss: 0.0630, Accuracy: 179/818 (21.8826%)
_Train Local_ResNet_18, epoch  77, local model 71, internal_epoch   2, Avg loss: 0.0307, Accuracy: 356/818 (43.5208%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.0006, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   1, Avg loss: 0.0491, Accuracy: 607/2227 (27.2564%)
_Train Local_ResNet_18, epoch  77, local model 60, internal_epoch   2, Avg loss: 0.0279, Accuracy: 1003/2227 (45.0382%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 8.7804, Accuracy: 119/10000 (1.1900%)
_Train Local_ResNet_18, epoch  77, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 61/311 (19.6141%)
_Train Local_ResNet_18, epoch  77, local model 96, internal_epoch   2, Avg loss: 0.0537, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3490, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   1, Avg loss: 0.0560, Accuracy: 405/1581 (25.6167%)
_Train Local_ResNet_18, epoch  77, local model 28, internal_epoch   2, Avg loss: 0.0333, Accuracy: 630/1581 (39.8482%)
_Test Local_ResNet_18 poisoned: False, epoch: 77, Avg loss: 7.4813, Accuracy: 91/10000 (0.9100%)
time spent on training: 239.83952069282532
[foolsgold agg] training data poison_ratio: 0.08631939244839021  data num: [85, 1574, 807, 460, 809, 677, 818, 2227, 311, 1581]
[foolsgold agg] considering poison per batch poison_fraction: 0.02697481014012194
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 77, Avg loss: 5.3103, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 77, Avg loss: 5.5333, Accuracy: 0/9950 (0.0000%)
saving model
Done in 322.6770598888397 sec.
Server Epoch:78 choose agents : [1, 64, 48, 77, 0, 36, 26, 90, 18, 93].
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   1, Avg loss: 0.0573, Accuracy: 291/928 (31.3578%)
_Train Local_ResNet_18, epoch  78, local model 1, internal_epoch   2, Avg loss: 0.0236, Accuracy: 543/928 (58.5129%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.5021, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   1, Avg loss: 0.0635, Accuracy: 178/953 (18.6779%)
_Train Local_ResNet_18, epoch  78, local model 64, internal_epoch   2, Avg loss: 0.0381, Accuracy: 295/953 (30.9549%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.4215, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   1, Avg loss: 0.0704, Accuracy: 109/631 (17.2742%)
_Train Local_ResNet_18, epoch  78, local model 48, internal_epoch   2, Avg loss: 0.0411, Accuracy: 227/631 (35.9746%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.8380, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 77, internal_epoch   1, Avg loss: 0.0532, Accuracy: 339/1340 (25.2985%)
_Train Local_ResNet_18, epoch  78, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 564/1340 (42.0896%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.7077, Accuracy: 57/10000 (0.5700%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 335/1657 (20.2173%)
_Train Local_ResNet_18, epoch  78, local model 0, internal_epoch   2, Avg loss: 0.0343, Accuracy: 531/1657 (32.0459%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.6711, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   1, Avg loss: 0.0861, Accuracy: 72/408 (17.6471%)
_Train Local_ResNet_18, epoch  78, local model 36, internal_epoch   2, Avg loss: 0.0552, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.5130, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   1, Avg loss: 0.0545, Accuracy: 360/1446 (24.8963%)
_Train Local_ResNet_18, epoch  78, local model 26, internal_epoch   2, Avg loss: 0.0347, Accuracy: 505/1446 (34.9239%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.3391, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  78, local model 90, internal_epoch   1, Avg loss: 0.0580, Accuracy: 322/677 (47.5628%)
_Train Local_ResNet_18, epoch  78, local model 90, internal_epoch   2, Avg loss: 0.0230, Accuracy: 428/677 (63.2201%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.2079, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   1, Avg loss: 0.0751, Accuracy: 124/530 (23.3962%)
_Train Local_ResNet_18, epoch  78, local model 18, internal_epoch   2, Avg loss: 0.0380, Accuracy: 266/530 (50.1887%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 6.2661, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   1, Avg loss: 0.0552, Accuracy: 409/1742 (23.4788%)
_Train Local_ResNet_18, epoch  78, local model 93, internal_epoch   2, Avg loss: 0.0319, Accuracy: 703/1742 (40.3559%)
_Test Local_ResNet_18 poisoned: False, epoch: 78, Avg loss: 7.8098, Accuracy: 94/10000 (0.9400%)
time spent on training: 259.40118288993835
[foolsgold agg] training data poison_ratio: 0.1606865787432118  data num: [928, 953, 631, 1340, 1657, 408, 1446, 677, 530, 1742]
[foolsgold agg] considering poison per batch poison_fraction: 0.050214555857253686
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 78, Avg loss: 5.3103, Accuracy: 44/10000 (0.4400%)
_Test Target_ResNet_18 poisoned: True, epoch: 78, Avg loss: 5.5324, Accuracy: 0/9950 (0.0000%)
saving model
Done in 341.91384959220886 sec.
Server Epoch:79 choose agents : [70, 34, 15, 98, 97, 25, 53, 87, 18, 52].
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   1, Avg loss: 0.0550, Accuracy: 377/1418 (26.5867%)
_Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   2, Avg loss: 0.0304, Accuracy: 650/1418 (45.8392%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.4202, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   1, Avg loss: 0.0566, Accuracy: 403/1427 (28.2411%)
_Train Local_ResNet_18, epoch  79, local model 34, internal_epoch   2, Avg loss: 0.0328, Accuracy: 601/1427 (42.1163%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.8521, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   1, Avg loss: 0.0578, Accuracy: 338/1154 (29.2894%)
_Train Local_ResNet_18, epoch  79, local model 15, internal_epoch   2, Avg loss: 0.0298, Accuracy: 399/1154 (34.5754%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.7805, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   1, Avg loss: 0.0809, Accuracy: 27/373 (7.2386%)
_Train Local_ResNet_18, epoch  79, local model 98, internal_epoch   2, Avg loss: 0.0479, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.4523, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  79, local model 97, internal_epoch   1, Avg loss: 0.0519, Accuracy: 370/1213 (30.5029%)
_Train Local_ResNet_18, epoch  79, local model 97, internal_epoch   2, Avg loss: 0.0274, Accuracy: 499/1213 (41.1377%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 7.7371, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   1, Avg loss: 0.0559, Accuracy: 310/690 (44.9275%)
_Train Local_ResNet_18, epoch  79, local model 25, internal_epoch   2, Avg loss: 0.0277, Accuracy: 457/690 (66.2319%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.5053, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   1, Avg loss: 0.0491, Accuracy: 298/813 (36.6544%)
_Train Local_ResNet_18, epoch  79, local model 53, internal_epoch   2, Avg loss: 0.0191, Accuracy: 432/813 (53.1365%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 9.7114, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  79, local model 87, internal_epoch   1, Avg loss: 0.0572, Accuracy: 306/1131 (27.0557%)
_Train Local_ResNet_18, epoch  79, local model 87, internal_epoch   2, Avg loss: 0.0306, Accuracy: 448/1131 (39.6110%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 8.0498, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   1, Avg loss: 0.0755, Accuracy: 122/530 (23.0189%)
_Train Local_ResNet_18, epoch  79, local model 18, internal_epoch   2, Avg loss: 0.0375, Accuracy: 265/530 (50.0000%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.0722, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   1, Avg loss: 0.0567, Accuracy: 286/636 (44.9686%)
_Train Local_ResNet_18, epoch  79, local model 52, internal_epoch   2, Avg loss: 0.0297, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 79, Avg loss: 6.2522, Accuracy: 50/10000 (0.5000%)
time spent on training: 219.2077910900116
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 1427, 1154, 373, 1213, 690, 813, 1131, 530, 636]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 79, Avg loss: 5.3102, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 79, Avg loss: 5.5329, Accuracy: 0/9950 (0.0000%)
saving model
Done in 301.0652620792389 sec.
Server Epoch:80 choose agents : [91, 47, 51, 92, 88, 78, 75, 61, 99, 77].
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   1, Avg loss: 0.0530, Accuracy: 353/1030 (34.2718%)
_Train Local_ResNet_18, epoch  80, local model 91, internal_epoch   2, Avg loss: 0.0244, Accuracy: 675/1030 (65.5340%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 8.3834, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   1, Avg loss: 0.1245, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 47, internal_epoch   2, Avg loss: 0.1106, Accuracy: 9/134 (6.7164%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3095, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   1, Avg loss: 0.0595, Accuracy: 234/1049 (22.3070%)
_Train Local_ResNet_18, epoch  80, local model 51, internal_epoch   2, Avg loss: 0.0294, Accuracy: 525/1049 (50.0477%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.4346, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  80, local model 92, internal_epoch   1, Avg loss: 0.0519, Accuracy: 445/1715 (25.9475%)
_Train Local_ResNet_18, epoch  80, local model 92, internal_epoch   2, Avg loss: 0.0308, Accuracy: 683/1715 (39.8251%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.7152, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch  80, local model 88, internal_epoch   1, Avg loss: 0.0739, Accuracy: 147/603 (24.3781%)
_Train Local_ResNet_18, epoch  80, local model 88, internal_epoch   2, Avg loss: 0.0445, Accuracy: 289/603 (47.9270%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.0876, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 78, internal_epoch   1, Avg loss: 0.0821, Accuracy: 52/416 (12.5000%)
_Train Local_ResNet_18, epoch  80, local model 78, internal_epoch   2, Avg loss: 0.0465, Accuracy: 182/416 (43.7500%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.6005, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   1, Avg loss: 0.0621, Accuracy: 256/776 (32.9897%)
_Train Local_ResNet_18, epoch  80, local model 75, internal_epoch   2, Avg loss: 0.0287, Accuracy: 405/776 (52.1907%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 6.7512, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   1, Avg loss: 0.1262, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  80, local model 61, internal_epoch   2, Avg loss: 0.1180, Accuracy: 14/85 (16.4706%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3038, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  80, local model 99, internal_epoch   1, Avg loss: 0.0672, Accuracy: 186/773 (24.0621%)
_Train Local_ResNet_18, epoch  80, local model 99, internal_epoch   2, Avg loss: 0.0309, Accuracy: 382/773 (49.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.1150, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   1, Avg loss: 0.0536, Accuracy: 340/1340 (25.3731%)
_Train Local_ResNet_18, epoch  80, local model 77, internal_epoch   2, Avg loss: 0.0276, Accuracy: 518/1340 (38.6567%)
_Test Local_ResNet_18 poisoned: False, epoch: 80, Avg loss: 7.5904, Accuracy: 57/10000 (0.5700%)
time spent on training: 211.51414012908936
[foolsgold agg] training data poison_ratio: 0.0  data num: [1030, 134, 1049, 1715, 603, 416, 776, 85, 773, 1340]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 80, Avg loss: 5.3101, Accuracy: 45/10000 (0.4500%)
_Test Target_ResNet_18 poisoned: True, epoch: 80, Avg loss: 5.5329, Accuracy: 0/9950 (0.0000%)
saving model
Done in 292.88893461227417 sec.
Server Epoch:81 choose agents : [60, 93, 18, 24, 50, 98, 61, 91, 54, 15].
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   1, Avg loss: 0.0496, Accuracy: 591/2227 (26.5379%)
_Train Local_ResNet_18, epoch  81, local model 60, internal_epoch   2, Avg loss: 0.0275, Accuracy: 1050/2227 (47.1486%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.3731, Accuracy: 125/10000 (1.2500%)
_Train Local_ResNet_18, epoch  81, local model 93, internal_epoch   1, Avg loss: 0.0544, Accuracy: 431/1742 (24.7417%)
_Train Local_ResNet_18, epoch  81, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 711/1742 (40.8152%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.6784, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   1, Avg loss: 0.0757, Accuracy: 119/530 (22.4528%)
_Train Local_ResNet_18, epoch  81, local model 18, internal_epoch   2, Avg loss: 0.0380, Accuracy: 264/530 (49.8113%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 6.1921, Accuracy: 61/10000 (0.6100%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   1, Avg loss: 0.0751, Accuracy: 47/312 (15.0641%)
_Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   2, Avg loss: 0.0399, Accuracy: 160/312 (51.2821%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3999, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   1, Avg loss: 0.0628, Accuracy: 171/809 (21.1372%)
_Train Local_ResNet_18, epoch  81, local model 50, internal_epoch   2, Avg loss: 0.0268, Accuracy: 360/809 (44.4994%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.2713, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  81, local model 98, internal_epoch   1, Avg loss: 0.0808, Accuracy: 27/373 (7.2386%)
_Train Local_ResNet_18, epoch  81, local model 98, internal_epoch   2, Avg loss: 0.0483, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.4581, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   1, Avg loss: 0.1250, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  81, local model 61, internal_epoch   2, Avg loss: 0.1141, Accuracy: 10/85 (11.7647%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3036, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   1, Avg loss: 0.0514, Accuracy: 335/1030 (32.5243%)
_Train Local_ResNet_18, epoch  81, local model 91, internal_epoch   2, Avg loss: 0.0246, Accuracy: 635/1030 (61.6505%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.1951, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1, Avg loss: 0.0548, Accuracy: 346/1130 (30.6195%)
_Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2, Avg loss: 0.0287, Accuracy: 473/1130 (41.8584%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 7.5978, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1, Avg loss: 0.0572, Accuracy: 343/1154 (29.7227%)
_Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2, Avg loss: 0.0279, Accuracy: 445/1154 (38.5615%)
_Test Local_ResNet_18 poisoned: False, epoch: 81, Avg loss: 8.1419, Accuracy: 51/10000 (0.5100%)
time spent on training: 234.14642238616943
[foolsgold agg] training data poison_ratio: 0.0  data num: [2227, 1742, 530, 312, 809, 373, 85, 1030, 1130, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 81, Avg loss: 5.3101, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 81, Avg loss: 5.5321, Accuracy: 0/9950 (0.0000%)
saving model
Done in 316.15429306030273 sec.
Server Epoch:82 choose agents : [59, 84, 37, 81, 61, 21, 47, 82, 13, 31].
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   1, Avg loss: 0.0526, Accuracy: 326/1089 (29.9357%)
_Train Local_ResNet_18, epoch  82, local model 59, internal_epoch   2, Avg loss: 0.0272, Accuracy: 471/1089 (43.2507%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.4450, Accuracy: 78/10000 (0.7800%)
_Train Local_ResNet_18, epoch  82, local model 84, internal_epoch   1, Avg loss: 0.0618, Accuracy: 323/1190 (27.1429%)
_Train Local_ResNet_18, epoch  82, local model 84, internal_epoch   2, Avg loss: 0.0315, Accuracy: 482/1190 (40.5042%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.1642, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   1, Avg loss: 0.0510, Accuracy: 465/1129 (41.1869%)
_Train Local_ResNet_18, epoch  82, local model 37, internal_epoch   2, Avg loss: 0.0250, Accuracy: 744/1129 (65.8990%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.4364, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   1, Avg loss: 0.0671, Accuracy: 246/774 (31.7829%)
_Train Local_ResNet_18, epoch  82, local model 81, internal_epoch   2, Avg loss: 0.0354, Accuracy: 296/774 (38.2429%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 6.3244, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   1, Avg loss: 0.1242, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   2, Avg loss: 0.1152, Accuracy: 12/85 (14.1176%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3037, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   1, Avg loss: 0.0532, Accuracy: 431/1949 (22.1139%)
_Train Local_ResNet_18, epoch  82, local model 21, internal_epoch   2, Avg loss: 0.0328, Accuracy: 644/1949 (33.0426%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 8.5890, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   1, Avg loss: 0.1216, Accuracy: 1/134 (0.7463%)
_Train Local_ResNet_18, epoch  82, local model 47, internal_epoch   2, Avg loss: 0.1074, Accuracy: 16/134 (11.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3102, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   1, Avg loss: 0.0756, Accuracy: 74/500 (14.8000%)
_Train Local_ResNet_18, epoch  82, local model 82, internal_epoch   2, Avg loss: 0.0489, Accuracy: 178/500 (35.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.6864, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   1, Avg loss: 0.0567, Accuracy: 345/1645 (20.9726%)
_Train Local_ResNet_18, epoch  82, local model 13, internal_epoch   2, Avg loss: 0.0323, Accuracy: 656/1645 (39.8784%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 7.7957, Accuracy: 110/10000 (1.1000%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   1, Avg loss: 0.0806, Accuracy: 65/460 (14.1304%)
_Train Local_ResNet_18, epoch  82, local model 31, internal_epoch   2, Avg loss: 0.0355, Accuracy: 188/460 (40.8696%)
_Test Local_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.8105, Accuracy: 50/10000 (0.5000%)
time spent on training: 223.8509166240692
[foolsgold agg] training data poison_ratio: 0.0  data num: [1089, 1190, 1129, 774, 85, 1949, 134, 500, 1645, 460]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.84102646 1.         1.         0.84102646]
_Test Target_ResNet_18 poisoned: False, epoch: 82, Avg loss: 5.3101, Accuracy: 47/10000 (0.4700%)
_Test Target_ResNet_18 poisoned: True, epoch: 82, Avg loss: 5.5329, Accuracy: 0/9950 (0.0000%)
saving model
Done in 305.4408242702484 sec.
Server Epoch:83 choose agents : [43, 65, 33, 2, 36, 57, 45, 76, 96, 80].
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   1, Avg loss: 0.0619, Accuracy: 301/946 (31.8182%)
_Train Local_ResNet_18, epoch  83, local model 43, internal_epoch   2, Avg loss: 0.0364, Accuracy: 317/946 (33.5095%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.0171, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   1, Avg loss: 0.0554, Accuracy: 406/1475 (27.5254%)
_Train Local_ResNet_18, epoch  83, local model 65, internal_epoch   2, Avg loss: 0.0322, Accuracy: 659/1475 (44.6780%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.9621, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   1, Avg loss: 0.0766, Accuracy: 82/515 (15.9223%)
_Train Local_ResNet_18, epoch  83, local model 33, internal_epoch   2, Avg loss: 0.0513, Accuracy: 123/515 (23.8835%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.7563, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 235/605 (38.8430%)
_Train Local_ResNet_18, epoch  83, local model 2, internal_epoch   2, Avg loss: 0.0398, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.9351, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   1, Avg loss: 0.0864, Accuracy: 81/408 (19.8529%)
_Train Local_ResNet_18, epoch  83, local model 36, internal_epoch   2, Avg loss: 0.0546, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.5193, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   1, Avg loss: 0.0564, Accuracy: 304/1154 (26.3432%)
_Train Local_ResNet_18, epoch  83, local model 57, internal_epoch   2, Avg loss: 0.0243, Accuracy: 543/1154 (47.0537%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 8.7784, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   1, Avg loss: 0.0666, Accuracy: 205/669 (30.6428%)
_Train Local_ResNet_18, epoch  83, local model 45, internal_epoch   2, Avg loss: 0.0408, Accuracy: 354/669 (52.9148%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.7726, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   1, Avg loss: 0.0843, Accuracy: 52/466 (11.1588%)
_Train Local_ResNet_18, epoch  83, local model 76, internal_epoch   2, Avg loss: 0.0475, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.7096, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 96, internal_epoch   1, Avg loss: 0.0781, Accuracy: 61/311 (19.6141%)
_Train Local_ResNet_18, epoch  83, local model 96, internal_epoch   2, Avg loss: 0.0539, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3521, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  83, local model 80, internal_epoch   1, Avg loss: 0.0696, Accuracy: 151/682 (22.1408%)
_Train Local_ResNet_18, epoch  83, local model 80, internal_epoch   2, Avg loss: 0.0379, Accuracy: 256/682 (37.5367%)
_Test Local_ResNet_18 poisoned: False, epoch: 83, Avg loss: 6.4587, Accuracy: 54/10000 (0.5400%)
time spent on training: 198.67981481552124
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 1475, 515, 605, 408, 1154, 669, 466, 311, 682]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 83, Avg loss: 5.3100, Accuracy: 46/10000 (0.4600%)
_Test Target_ResNet_18 poisoned: True, epoch: 83, Avg loss: 5.5321, Accuracy: 0/9950 (0.0000%)
saving model
Done in 279.728360414505 sec.
Server Epoch:84 choose agents : [0, 26, 54, 61, 56, 29, 38, 45, 2, 15].
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 353/1657 (21.3036%)
_Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   2, Avg loss: 0.0345, Accuracy: 529/1657 (31.9252%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.6774, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   1, Avg loss: 0.0543, Accuracy: 346/1446 (23.9281%)
_Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   2, Avg loss: 0.0348, Accuracy: 500/1446 (34.5781%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.2241, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   1, Avg loss: 0.0544, Accuracy: 356/1130 (31.5044%)
_Train Local_ResNet_18, epoch  84, local model 54, internal_epoch   2, Avg loss: 0.0286, Accuracy: 472/1130 (41.7699%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.5899, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1, Avg loss: 0.1245, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2, Avg loss: 0.1175, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3035, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   1, Avg loss: 0.0821, Accuracy: 2/186 (1.0753%)
_Train Local_ResNet_18, epoch  84, local model 56, internal_epoch   2, Avg loss: 0.0667, Accuracy: 77/186 (41.3978%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3107, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 443/1440 (30.7639%)
_Train Local_ResNet_18, epoch  84, local model 29, internal_epoch   2, Avg loss: 0.0276, Accuracy: 700/1440 (48.6111%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.7253, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1, Avg loss: 0.0608, Accuracy: 256/1131 (22.6348%)
_Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2, Avg loss: 0.0302, Accuracy: 477/1131 (42.1751%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 7.3663, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   1, Avg loss: 0.0661, Accuracy: 201/669 (30.0448%)
_Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   2, Avg loss: 0.0416, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.8431, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   1, Avg loss: 0.0627, Accuracy: 237/605 (39.1736%)
_Train Local_ResNet_18, epoch  84, local model 2, internal_epoch   2, Avg loss: 0.0405, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.9139, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   1, Avg loss: 0.0573, Accuracy: 340/1154 (29.4627%)
_Train Local_ResNet_18, epoch  84, local model 15, internal_epoch   2, Avg loss: 0.0279, Accuracy: 497/1154 (43.0676%)
_Test Local_ResNet_18 poisoned: False, epoch: 84, Avg loss: 8.0259, Accuracy: 56/10000 (0.5600%)
time spent on training: 253.82582664489746
[foolsgold agg] training data poison_ratio: 0.1743659896874671  data num: [1657, 1446, 1130, 85, 186, 1440, 1131, 669, 605, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.05448937177733347
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 84, Avg loss: 5.3101, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 84, Avg loss: 5.5327, Accuracy: 0/9950 (0.0000%)
saving model
Done in 335.2663617134094 sec.
Server Epoch:85 choose agents : [84, 3, 86, 18, 98, 8, 89, 80, 23, 58].
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   1, Avg loss: 0.0614, Accuracy: 332/1190 (27.8992%)
_Train Local_ResNet_18, epoch  85, local model 84, internal_epoch   2, Avg loss: 0.0312, Accuracy: 468/1190 (39.3277%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.0007, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   1, Avg loss: 0.0736, Accuracy: 119/781 (15.2369%)
_Train Local_ResNet_18, epoch  85, local model 3, internal_epoch   2, Avg loss: 0.0367, Accuracy: 231/781 (29.5775%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.8049, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  85, local model 86, internal_epoch   1, Avg loss: 0.0619, Accuracy: 365/1003 (36.3908%)
_Train Local_ResNet_18, epoch  85, local model 86, internal_epoch   2, Avg loss: 0.0341, Accuracy: 372/1003 (37.0887%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.8279, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   1, Avg loss: 0.0756, Accuracy: 125/530 (23.5849%)
_Train Local_ResNet_18, epoch  85, local model 18, internal_epoch   2, Avg loss: 0.0377, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.2554, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  85, local model 98, internal_epoch   1, Avg loss: 0.0806, Accuracy: 26/373 (6.9705%)
_Train Local_ResNet_18, epoch  85, local model 98, internal_epoch   2, Avg loss: 0.0471, Accuracy: 154/373 (41.2869%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.4464, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   1, Avg loss: 0.0597, Accuracy: 280/1513 (18.5063%)
_Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   2, Avg loss: 0.0362, Accuracy: 462/1513 (30.5354%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 7.1411, Accuracy: 94/10000 (0.9400%)
_Train Local_ResNet_18, epoch  85, local model 89, internal_epoch   1, Avg loss: 0.0597, Accuracy: 345/896 (38.5045%)
_Train Local_ResNet_18, epoch  85, local model 89, internal_epoch   2, Avg loss: 0.0334, Accuracy: 440/896 (49.1071%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.2933, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 80, internal_epoch   1, Avg loss: 0.0695, Accuracy: 143/682 (20.9677%)
_Train Local_ResNet_18, epoch  85, local model 80, internal_epoch   2, Avg loss: 0.0381, Accuracy: 228/682 (33.4311%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.5348, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   1, Avg loss: 0.0607, Accuracy: 324/715 (45.3147%)
_Train Local_ResNet_18, epoch  85, local model 23, internal_epoch   2, Avg loss: 0.0393, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.8337, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   1, Avg loss: 0.0579, Accuracy: 345/803 (42.9639%)
_Train Local_ResNet_18, epoch  85, local model 58, internal_epoch   2, Avg loss: 0.0330, Accuracy: 434/803 (54.0473%)
_Test Local_ResNet_18 poisoned: False, epoch: 85, Avg loss: 6.0696, Accuracy: 52/10000 (0.5200%)
time spent on training: 212.3945870399475
[foolsgold agg] training data poison_ratio: 0.0  data num: [1190, 781, 1003, 530, 373, 1513, 896, 682, 715, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 85, Avg loss: 5.3100, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 85, Avg loss: 5.5326, Accuracy: 0/9950 (0.0000%)
saving model
Done in 295.69428849220276 sec.
Server Epoch:86 choose agents : [57, 20, 60, 19, 35, 85, 82, 44, 41, 59].
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   1, Avg loss: 0.0543, Accuracy: 311/1154 (26.9497%)
_Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   2, Avg loss: 0.0259, Accuracy: 467/1154 (40.4679%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.3574, Accuracy: 84/10000 (0.8400%)
poison local model 20 index 1 
_Train Local_ResNet_18, epoch  86, local model 20, internal_epoch   1, Avg loss: 0.0573, Accuracy: 351/807 (43.4944%)
_Train Local_ResNet_18, epoch  86, local model 20, internal_epoch   2, Avg loss: 0.0318, Accuracy: 424/807 (52.5403%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.4379, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   1, Avg loss: 0.0493, Accuracy: 639/2227 (28.6933%)
_Train Local_ResNet_18, epoch  86, local model 60, internal_epoch   2, Avg loss: 0.0277, Accuracy: 1042/2227 (46.7894%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.2178, Accuracy: 123/10000 (1.2300%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   1, Avg loss: 0.0476, Accuracy: 406/1036 (39.1892%)
_Train Local_ResNet_18, epoch  86, local model 19, internal_epoch   2, Avg loss: 0.0244, Accuracy: 652/1036 (62.9344%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 9.2588, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   1, Avg loss: 0.0852, Accuracy: 41/271 (15.1292%)
_Train Local_ResNet_18, epoch  86, local model 35, internal_epoch   2, Avg loss: 0.0551, Accuracy: 107/271 (39.4834%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3702, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 85, internal_epoch   1, Avg loss: 0.0529, Accuracy: 490/1988 (24.6479%)
_Train Local_ResNet_18, epoch  86, local model 85, internal_epoch   2, Avg loss: 0.0352, Accuracy: 650/1988 (32.6962%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.5933, Accuracy: 80/10000 (0.8000%)
_Train Local_ResNet_18, epoch  86, local model 82, internal_epoch   1, Avg loss: 0.0755, Accuracy: 79/500 (15.8000%)
_Train Local_ResNet_18, epoch  86, local model 82, internal_epoch   2, Avg loss: 0.0488, Accuracy: 174/500 (34.8000%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.6715, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   1, Avg loss: 0.0582, Accuracy: 434/1750 (24.8000%)
_Train Local_ResNet_18, epoch  86, local model 44, internal_epoch   2, Avg loss: 0.0349, Accuracy: 670/1750 (38.2857%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 7.3211, Accuracy: 126/10000 (1.2600%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   1, Avg loss: 0.0611, Accuracy: 330/719 (45.8971%)
_Train Local_ResNet_18, epoch  86, local model 41, internal_epoch   2, Avg loss: 0.0318, Accuracy: 418/719 (58.1363%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 6.5643, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   1, Avg loss: 0.0527, Accuracy: 295/1089 (27.0891%)
_Train Local_ResNet_18, epoch  86, local model 59, internal_epoch   2, Avg loss: 0.0296, Accuracy: 476/1089 (43.7098%)
_Test Local_ResNet_18 poisoned: False, epoch: 86, Avg loss: 8.8426, Accuracy: 58/10000 (0.5800%)
time spent on training: 280.46331095695496
[foolsgold agg] training data poison_ratio: 0.06992461658435144  data num: [1154, 807, 2227, 1036, 271, 1988, 500, 1750, 719, 1089]
[foolsgold agg] considering poison per batch poison_fraction: 0.021851442682609825
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 86, Avg loss: 5.3100, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 86, Avg loss: 5.5319, Accuracy: 0/9950 (0.0000%)
saving model
Done in 361.95461082458496 sec.
Server Epoch:87 choose agents : [86, 29, 54, 69, 87, 45, 26, 47, 33, 57].
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   1, Avg loss: 0.0614, Accuracy: 368/1003 (36.6899%)
_Train Local_ResNet_18, epoch  87, local model 86, internal_epoch   2, Avg loss: 0.0349, Accuracy: 351/1003 (34.9950%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.9049, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   1, Avg loss: 0.0478, Accuracy: 450/1440 (31.2500%)
_Train Local_ResNet_18, epoch  87, local model 29, internal_epoch   2, Avg loss: 0.0281, Accuracy: 661/1440 (45.9028%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.0625, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   1, Avg loss: 0.0543, Accuracy: 349/1130 (30.8850%)
_Train Local_ResNet_18, epoch  87, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 462/1130 (40.8850%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.3843, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1, Avg loss: 0.0586, Accuracy: 293/590 (49.6610%)
_Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2, Avg loss: 0.0299, Accuracy: 450/590 (76.2712%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 6.8854, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 87, internal_epoch   1, Avg loss: 0.0571, Accuracy: 308/1131 (27.2325%)
_Train Local_ResNet_18, epoch  87, local model 87, internal_epoch   2, Avg loss: 0.0314, Accuracy: 425/1131 (37.5774%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.8921, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   1, Avg loss: 0.0671, Accuracy: 206/669 (30.7922%)
_Train Local_ResNet_18, epoch  87, local model 45, internal_epoch   2, Avg loss: 0.0401, Accuracy: 355/669 (53.0643%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.8088, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   1, Avg loss: 0.0546, Accuracy: 355/1446 (24.5505%)
_Train Local_ResNet_18, epoch  87, local model 26, internal_epoch   2, Avg loss: 0.0345, Accuracy: 521/1446 (36.0304%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 7.4086, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1, Avg loss: 0.1214, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2, Avg loss: 0.1066, Accuracy: 22/134 (16.4179%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   1, Avg loss: 0.0779, Accuracy: 74/515 (14.3689%)
_Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   2, Avg loss: 0.0484, Accuracy: 120/515 (23.3010%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.8122, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   1, Avg loss: 0.0537, Accuracy: 300/1154 (25.9965%)
_Train Local_ResNet_18, epoch  87, local model 57, internal_epoch   2, Avg loss: 0.0244, Accuracy: 540/1154 (46.7938%)
_Test Local_ResNet_18 poisoned: False, epoch: 87, Avg loss: 8.6040, Accuracy: 81/10000 (0.8100%)
time spent on training: 232.61541938781738
[foolsgold agg] training data poison_ratio: 0.0  data num: [1003, 1440, 1130, 590, 1131, 669, 1446, 134, 515, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 87, Avg loss: 5.3100, Accuracy: 51/10000 (0.5100%)
_Test Target_ResNet_18 poisoned: True, epoch: 87, Avg loss: 5.5327, Accuracy: 0/9950 (0.0000%)
saving model
Done in 315.3266432285309 sec.
Server Epoch:88 choose agents : [62, 83, 85, 18, 63, 67, 29, 37, 87, 80].
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   1, Avg loss: 0.0678, Accuracy: 158/568 (27.8169%)
_Train Local_ResNet_18, epoch  88, local model 62, internal_epoch   2, Avg loss: 0.0399, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.7983, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   1, Avg loss: 0.0543, Accuracy: 434/1953 (22.2222%)
_Train Local_ResNet_18, epoch  88, local model 83, internal_epoch   2, Avg loss: 0.0337, Accuracy: 758/1953 (38.8121%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 8.0684, Accuracy: 99/10000 (0.9900%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   1, Avg loss: 0.0533, Accuracy: 487/1988 (24.4970%)
_Train Local_ResNet_18, epoch  88, local model 85, internal_epoch   2, Avg loss: 0.0360, Accuracy: 667/1988 (33.5513%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.7756, Accuracy: 82/10000 (0.8200%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   1, Avg loss: 0.0749, Accuracy: 121/530 (22.8302%)
_Train Local_ResNet_18, epoch  88, local model 18, internal_epoch   2, Avg loss: 0.0379, Accuracy: 268/530 (50.5660%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.1851, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   1, Avg loss: 0.0539, Accuracy: 269/888 (30.2928%)
_Train Local_ResNet_18, epoch  88, local model 63, internal_epoch   2, Avg loss: 0.0259, Accuracy: 407/888 (45.8333%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 9.3431, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   1, Avg loss: 0.0772, Accuracy: 63/426 (14.7887%)
_Train Local_ResNet_18, epoch  88, local model 67, internal_epoch   2, Avg loss: 0.0408, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.5666, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   1, Avg loss: 0.0487, Accuracy: 433/1440 (30.0694%)
_Train Local_ResNet_18, epoch  88, local model 29, internal_epoch   2, Avg loss: 0.0273, Accuracy: 680/1440 (47.2222%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.7638, Accuracy: 75/10000 (0.7500%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   1, Avg loss: 0.0517, Accuracy: 442/1129 (39.1497%)
_Train Local_ResNet_18, epoch  88, local model 37, internal_epoch   2, Avg loss: 0.0245, Accuracy: 731/1129 (64.7476%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.3629, Accuracy: 115/10000 (1.1500%)
_Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   1, Avg loss: 0.0573, Accuracy: 305/1131 (26.9673%)
_Train Local_ResNet_18, epoch  88, local model 87, internal_epoch   2, Avg loss: 0.0320, Accuracy: 431/1131 (38.1079%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 7.7015, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  88, local model 80, internal_epoch   1, Avg loss: 0.0690, Accuracy: 151/682 (22.1408%)
_Train Local_ResNet_18, epoch  88, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 261/682 (38.2698%)
_Test Local_ResNet_18 poisoned: False, epoch: 88, Avg loss: 6.6130, Accuracy: 54/10000 (0.5400%)
time spent on training: 264.0048439502716
[foolsgold agg] training data poison_ratio: 0.0  data num: [568, 1953, 1988, 530, 888, 426, 1440, 1129, 1131, 682]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.97281882 1.         0.97281882
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 88, Avg loss: 5.3100, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 88, Avg loss: 5.5333, Accuracy: 0/9950 (0.0000%)
saving model
Done in 348.86122465133667 sec.
Server Epoch:89 choose agents : [43, 48, 27, 5, 45, 67, 97, 23, 39, 16].
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1, Avg loss: 0.0616, Accuracy: 308/946 (32.5581%)
_Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2, Avg loss: 0.0360, Accuracy: 345/946 (36.4693%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 6.0594, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   1, Avg loss: 0.0706, Accuracy: 105/631 (16.6403%)
_Train Local_ResNet_18, epoch  89, local model 48, internal_epoch   2, Avg loss: 0.0409, Accuracy: 217/631 (34.3899%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.9949, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 436/1587 (27.4732%)
_Train Local_ResNet_18, epoch  89, local model 27, internal_epoch   2, Avg loss: 0.0333, Accuracy: 649/1587 (40.8948%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.2539, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   1, Avg loss: 0.0505, Accuracy: 379/1628 (23.2801%)
_Train Local_ResNet_18, epoch  89, local model 5, internal_epoch   2, Avg loss: 0.0252, Accuracy: 825/1628 (50.6757%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 8.3567, Accuracy: 121/10000 (1.2100%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   1, Avg loss: 0.0666, Accuracy: 210/669 (31.3901%)
_Train Local_ResNet_18, epoch  89, local model 45, internal_epoch   2, Avg loss: 0.0411, Accuracy: 353/669 (52.7653%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.8917, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   1, Avg loss: 0.0773, Accuracy: 61/426 (14.3192%)
_Train Local_ResNet_18, epoch  89, local model 67, internal_epoch   2, Avg loss: 0.0417, Accuracy: 173/426 (40.6103%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.6132, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  89, local model 97, internal_epoch   1, Avg loss: 0.0518, Accuracy: 365/1213 (30.0907%)
_Train Local_ResNet_18, epoch  89, local model 97, internal_epoch   2, Avg loss: 0.0280, Accuracy: 451/1213 (37.1805%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.9673, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   1, Avg loss: 0.0599, Accuracy: 322/715 (45.0350%)
_Train Local_ResNet_18, epoch  89, local model 23, internal_epoch   2, Avg loss: 0.0400, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.8075, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   1, Avg loss: 0.0526, Accuracy: 319/1013 (31.4906%)
_Train Local_ResNet_18, epoch  89, local model 39, internal_epoch   2, Avg loss: 0.0254, Accuracy: 525/1013 (51.8263%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 7.9063, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   1, Avg loss: 0.0628, Accuracy: 286/708 (40.3955%)
_Train Local_ResNet_18, epoch  89, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.8971, Accuracy: 55/10000 (0.5500%)
time spent on training: 238.5228407382965
[foolsgold agg] training data poison_ratio: 0.0  data num: [946, 631, 1587, 1628, 669, 426, 1213, 715, 1013, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 89, Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 89, Avg loss: 5.5338, Accuracy: 0/9950 (0.0000%)
saving model
Done in 323.79192543029785 sec.
Server Epoch:90 choose agents : [25, 41, 39, 40, 34, 77, 29, 71, 8, 53].
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   1, Avg loss: 0.0561, Accuracy: 314/690 (45.5072%)
_Train Local_ResNet_18, epoch  90, local model 25, internal_epoch   2, Avg loss: 0.0278, Accuracy: 456/690 (66.0870%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.5311, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   1, Avg loss: 0.0597, Accuracy: 338/719 (47.0097%)
_Train Local_ResNet_18, epoch  90, local model 41, internal_epoch   2, Avg loss: 0.0308, Accuracy: 461/719 (64.1168%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.4643, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1, Avg loss: 0.0532, Accuracy: 321/1013 (31.6881%)
_Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2, Avg loss: 0.0256, Accuracy: 513/1013 (50.6417%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.7003, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   1, Avg loss: 0.0543, Accuracy: 377/1573 (23.9669%)
_Train Local_ResNet_18, epoch  90, local model 40, internal_epoch   2, Avg loss: 0.0344, Accuracy: 623/1573 (39.6058%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.3740, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   1, Avg loss: 0.0571, Accuracy: 402/1427 (28.1710%)
_Train Local_ResNet_18, epoch  90, local model 34, internal_epoch   2, Avg loss: 0.0332, Accuracy: 593/1427 (41.5557%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 6.8605, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  90, local model 77, internal_epoch   1, Avg loss: 0.0532, Accuracy: 335/1340 (25.0000%)
_Train Local_ResNet_18, epoch  90, local model 77, internal_epoch   2, Avg loss: 0.0270, Accuracy: 562/1340 (41.9403%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.9200, Accuracy: 58/10000 (0.5800%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   1, Avg loss: 0.0489, Accuracy: 436/1440 (30.2778%)
_Train Local_ResNet_18, epoch  90, local model 29, internal_epoch   2, Avg loss: 0.0271, Accuracy: 712/1440 (49.4444%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.8770, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   1, Avg loss: 0.0635, Accuracy: 173/818 (21.1491%)
_Train Local_ResNet_18, epoch  90, local model 71, internal_epoch   2, Avg loss: 0.0299, Accuracy: 361/818 (44.1320%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.1643, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   1, Avg loss: 0.0594, Accuracy: 253/1513 (16.7217%)
_Train Local_ResNet_18, epoch  90, local model 8, internal_epoch   2, Avg loss: 0.0363, Accuracy: 504/1513 (33.3113%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 7.4793, Accuracy: 106/10000 (1.0600%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   1, Avg loss: 0.0485, Accuracy: 292/813 (35.9164%)
_Train Local_ResNet_18, epoch  90, local model 53, internal_epoch   2, Avg loss: 0.0185, Accuracy: 462/813 (56.8266%)
_Test Local_ResNet_18 poisoned: False, epoch: 90, Avg loss: 10.0250, Accuracy: 53/10000 (0.5300%)
time spent on training: 281.129191160202
[foolsgold agg] training data poison_ratio: 0.0  data num: [690, 719, 1013, 1573, 1427, 1340, 1440, 818, 1513, 813]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 90, Avg loss: 5.3099, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 90, Avg loss: 5.5341, Accuracy: 0/9950 (0.0000%)
saving model
Done in 364.28973746299744 sec.
Server Epoch:91 choose agents : [36, 34, 71, 11, 72, 91, 63, 3, 50, 24].
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   1, Avg loss: 0.0866, Accuracy: 73/408 (17.8922%)
_Train Local_ResNet_18, epoch  91, local model 36, internal_epoch   2, Avg loss: 0.0534, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.5098, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   1, Avg loss: 0.0566, Accuracy: 398/1427 (27.8907%)
_Train Local_ResNet_18, epoch  91, local model 34, internal_epoch   2, Avg loss: 0.0331, Accuracy: 593/1427 (41.5557%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.9333, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   1, Avg loss: 0.0624, Accuracy: 177/818 (21.6381%)
_Train Local_ResNet_18, epoch  91, local model 71, internal_epoch   2, Avg loss: 0.0298, Accuracy: 359/818 (43.8875%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.3478, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   1, Avg loss: 0.0545, Accuracy: 351/712 (49.2978%)
_Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   2, Avg loss: 0.0257, Accuracy: 421/712 (59.1292%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.7778, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   1, Avg loss: 0.0614, Accuracy: 255/1241 (20.5479%)
_Train Local_ResNet_18, epoch  91, local model 72, internal_epoch   2, Avg loss: 0.0370, Accuracy: 393/1241 (31.6680%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.1343, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  91, local model 91, internal_epoch   1, Avg loss: 0.0518, Accuracy: 349/1030 (33.8835%)
_Train Local_ResNet_18, epoch  91, local model 91, internal_epoch   2, Avg loss: 0.0250, Accuracy: 649/1030 (63.0097%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.3990, Accuracy: 77/10000 (0.7700%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   1, Avg loss: 0.0537, Accuracy: 273/888 (30.7432%)
_Train Local_ResNet_18, epoch  91, local model 63, internal_epoch   2, Avg loss: 0.0261, Accuracy: 412/888 (46.3964%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 8.2089, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   1, Avg loss: 0.0732, Accuracy: 116/781 (14.8528%)
_Train Local_ResNet_18, epoch  91, local model 3, internal_epoch   2, Avg loss: 0.0363, Accuracy: 233/781 (29.8335%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 6.7391, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   1, Avg loss: 0.0622, Accuracy: 168/809 (20.7664%)
_Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   2, Avg loss: 0.0271, Accuracy: 364/809 (44.9938%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 7.3134, Accuracy: 71/10000 (0.7100%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   1, Avg loss: 0.0748, Accuracy: 55/312 (17.6282%)
_Train Local_ResNet_18, epoch  91, local model 24, internal_epoch   2, Avg loss: 0.0391, Accuracy: 166/312 (53.2051%)
_Test Local_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3957, Accuracy: 50/10000 (0.5000%)
time spent on training: 230.9794557094574
[foolsgold agg] training data poison_ratio: 0.0  data num: [408, 1427, 818, 712, 1241, 1030, 888, 781, 809, 312]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 91, Avg loss: 5.3097, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 91, Avg loss: 5.5340, Accuracy: 0/9950 (0.0000%)
saving model
Done in 316.6899423599243 sec.
Server Epoch:92 choose agents : [92, 90, 77, 1, 58, 42, 96, 14, 29, 30].
_Train Local_ResNet_18, epoch  92, local model 92, internal_epoch   1, Avg loss: 0.0516, Accuracy: 467/1715 (27.2303%)
_Train Local_ResNet_18, epoch  92, local model 92, internal_epoch   2, Avg loss: 0.0310, Accuracy: 701/1715 (40.8746%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.1511, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   1, Avg loss: 0.0562, Accuracy: 326/677 (48.1536%)
_Train Local_ResNet_18, epoch  92, local model 90, internal_epoch   2, Avg loss: 0.0221, Accuracy: 463/677 (68.3900%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.2553, Accuracy: 54/10000 (0.5400%)
_Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   1, Avg loss: 0.0529, Accuracy: 331/1340 (24.7015%)
_Train Local_ResNet_18, epoch  92, local model 77, internal_epoch   2, Avg loss: 0.0271, Accuracy: 588/1340 (43.8806%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.9110, Accuracy: 69/10000 (0.6900%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   1, Avg loss: 0.0561, Accuracy: 297/928 (32.0043%)
_Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   2, Avg loss: 0.0238, Accuracy: 570/928 (61.4224%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.0211, Accuracy: 89/10000 (0.8900%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   1, Avg loss: 0.0576, Accuracy: 348/803 (43.3375%)
_Train Local_ResNet_18, epoch  92, local model 58, internal_epoch   2, Avg loss: 0.0337, Accuracy: 408/803 (50.8095%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.0853, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   1, Avg loss: 0.0536, Accuracy: 319/1372 (23.2507%)
_Train Local_ResNet_18, epoch  92, local model 42, internal_epoch   2, Avg loss: 0.0316, Accuracy: 486/1372 (35.4227%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 7.9036, Accuracy: 74/10000 (0.7400%)
_Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   1, Avg loss: 0.0782, Accuracy: 55/311 (17.6849%)
_Train Local_ResNet_18, epoch  92, local model 96, internal_epoch   2, Avg loss: 0.0524, Accuracy: 135/311 (43.4084%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3496, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   1, Avg loss: 0.0609, Accuracy: 237/1013 (23.3959%)
_Train Local_ResNet_18, epoch  92, local model 14, internal_epoch   2, Avg loss: 0.0352, Accuracy: 369/1013 (36.4265%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 6.8415, Accuracy: 64/10000 (0.6400%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   1, Avg loss: 0.0488, Accuracy: 443/1440 (30.7639%)
_Train Local_ResNet_18, epoch  92, local model 29, internal_epoch   2, Avg loss: 0.0273, Accuracy: 681/1440 (47.2917%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 8.2556, Accuracy: 66/10000 (0.6600%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   1, Avg loss: 0.0785, Accuracy: 89/486 (18.3128%)
_Train Local_ResNet_18, epoch  92, local model 30, internal_epoch   2, Avg loss: 0.0402, Accuracy: 212/486 (43.6214%)
_Test Local_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.8166, Accuracy: 42/10000 (0.4200%)
time spent on training: 255.2781765460968
[foolsgold agg] training data poison_ratio: 0.0  data num: [1715, 677, 1340, 928, 803, 1372, 311, 1013, 1440, 486]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 92, Avg loss: 5.3097, Accuracy: 49/10000 (0.4900%)
_Test Target_ResNet_18 poisoned: True, epoch: 92, Avg loss: 5.5343, Accuracy: 0/9950 (0.0000%)
saving model
Done in 339.6628589630127 sec.
Server Epoch:93 choose agents : [76, 7, 35, 2, 94, 15, 46, 67, 55, 73].
_Train Local_ResNet_18, epoch  93, local model 76, internal_epoch   1, Avg loss: 0.0835, Accuracy: 63/466 (13.5193%)
_Train Local_ResNet_18, epoch  93, local model 76, internal_epoch   2, Avg loss: 0.0477, Accuracy: 180/466 (38.6266%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.6905, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   1, Avg loss: 0.0526, Accuracy: 357/891 (40.0673%)
_Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   2, Avg loss: 0.0254, Accuracy: 456/891 (51.1785%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.0669, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   1, Avg loss: 0.0866, Accuracy: 36/271 (13.2841%)
_Train Local_ResNet_18, epoch  93, local model 35, internal_epoch   2, Avg loss: 0.0547, Accuracy: 99/271 (36.5314%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3670, Accuracy: 44/10000 (0.4400%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   1, Avg loss: 0.0635, Accuracy: 227/605 (37.5207%)
_Train Local_ResNet_18, epoch  93, local model 2, internal_epoch   2, Avg loss: 0.0390, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.8699, Accuracy: 62/10000 (0.6200%)
_Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   1, Avg loss: 0.0552, Accuracy: 347/1662 (20.8785%)
_Train Local_ResNet_18, epoch  93, local model 94, internal_epoch   2, Avg loss: 0.0326, Accuracy: 641/1662 (38.5680%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.6710, Accuracy: 103/10000 (1.0300%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   1, Avg loss: 0.0557, Accuracy: 342/1154 (29.6360%)
_Train Local_ResNet_18, epoch  93, local model 15, internal_epoch   2, Avg loss: 0.0278, Accuracy: 521/1154 (45.1473%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.7649, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   1, Avg loss: 0.0547, Accuracy: 430/1904 (22.5840%)
_Train Local_ResNet_18, epoch  93, local model 46, internal_epoch   2, Avg loss: 0.0311, Accuracy: 679/1904 (35.6618%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.7232, Accuracy: 93/10000 (0.9300%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   1, Avg loss: 0.0775, Accuracy: 66/426 (15.4930%)
_Train Local_ResNet_18, epoch  93, local model 67, internal_epoch   2, Avg loss: 0.0414, Accuracy: 172/426 (40.3756%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.6272, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   1, Avg loss: 0.0551, Accuracy: 261/1071 (24.3697%)
_Train Local_ResNet_18, epoch  93, local model 55, internal_epoch   2, Avg loss: 0.0288, Accuracy: 511/1071 (47.7124%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 8.3525, Accuracy: 59/10000 (0.5900%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   1, Avg loss: 0.0647, Accuracy: 175/938 (18.6567%)
_Train Local_ResNet_18, epoch  93, local model 73, internal_epoch   2, Avg loss: 0.0328, Accuracy: 362/938 (38.5928%)
_Test Local_ResNet_18 poisoned: False, epoch: 93, Avg loss: 7.2769, Accuracy: 63/10000 (0.6300%)
time spent on training: 260.43874311447144
[foolsgold agg] training data poison_ratio: 0.0  data num: [466, 891, 271, 605, 1662, 1154, 1904, 426, 1071, 938]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 93, Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 93, Avg loss: 5.5329, Accuracy: 0/9950 (0.0000%)
saving model
Done in 344.4234881401062 sec.
Server Epoch:94 choose agents : [54, 23, 97, 0, 28, 52, 48, 24, 5, 3].
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   1, Avg loss: 0.0542, Accuracy: 360/1130 (31.8584%)
_Train Local_ResNet_18, epoch  94, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 469/1130 (41.5044%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.7742, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   1, Avg loss: 0.0601, Accuracy: 320/715 (44.7552%)
_Train Local_ResNet_18, epoch  94, local model 23, internal_epoch   2, Avg loss: 0.0399, Accuracy: 438/715 (61.2587%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.7989, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   1, Avg loss: 0.0516, Accuracy: 364/1213 (30.0082%)
_Train Local_ResNet_18, epoch  94, local model 97, internal_epoch   2, Avg loss: 0.0272, Accuracy: 514/1213 (42.3743%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.8730, Accuracy: 72/10000 (0.7200%)
poison local model 0 index 0 
_Train Local_ResNet_18, epoch  94, local model 0, internal_epoch   1, Avg loss: 0.0582, Accuracy: 345/1657 (20.8208%)
_Train Local_ResNet_18, epoch  94, local model 0, internal_epoch   2, Avg loss: 0.0347, Accuracy: 494/1657 (29.8129%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.5980, Accuracy: 73/10000 (0.7300%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   1, Avg loss: 0.0552, Accuracy: 405/1581 (25.6167%)
_Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   2, Avg loss: 0.0331, Accuracy: 644/1581 (40.7337%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 7.6168, Accuracy: 91/10000 (0.9100%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   1, Avg loss: 0.0555, Accuracy: 290/636 (45.5975%)
_Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   2, Avg loss: 0.0312, Accuracy: 427/636 (67.1384%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.3956, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   1, Avg loss: 0.0704, Accuracy: 104/631 (16.4818%)
_Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   2, Avg loss: 0.0404, Accuracy: 235/631 (37.2425%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.9202, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   1, Avg loss: 0.0748, Accuracy: 50/312 (16.0256%)
_Train Local_ResNet_18, epoch  94, local model 24, internal_epoch   2, Avg loss: 0.0393, Accuracy: 162/312 (51.9231%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.4014, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1, Avg loss: 0.0501, Accuracy: 382/1628 (23.4644%)
_Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2, Avg loss: 0.0261, Accuracy: 789/1628 (48.4644%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 8.4383, Accuracy: 118/10000 (1.1800%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   1, Avg loss: 0.0731, Accuracy: 116/781 (14.8528%)
_Train Local_ResNet_18, epoch  94, local model 3, internal_epoch   2, Avg loss: 0.0360, Accuracy: 252/781 (32.2663%)
_Test Local_ResNet_18 poisoned: False, epoch: 94, Avg loss: 6.7617, Accuracy: 69/10000 (0.6900%)
time spent on training: 225.57494068145752
[foolsgold agg] training data poison_ratio: 0.16112407623492805  data num: [1130, 715, 1213, 1657, 1581, 636, 631, 312, 1628, 781]
[foolsgold agg] considering poison per batch poison_fraction: 0.05035127382341502
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 94, Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 94, Avg loss: 5.5338, Accuracy: 0/9950 (0.0000%)
saving model
Done in 307.1648244857788 sec.
Server Epoch:95 choose agents : [80, 4, 1, 10, 41, 2, 58, 11, 29, 78].
_Train Local_ResNet_18, epoch  95, local model 80, internal_epoch   1, Avg loss: 0.0689, Accuracy: 153/682 (22.4340%)
_Train Local_ResNet_18, epoch  95, local model 80, internal_epoch   2, Avg loss: 0.0383, Accuracy: 245/682 (35.9238%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.4287, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   1, Avg loss: 0.0615, Accuracy: 333/901 (36.9589%)
_Train Local_ResNet_18, epoch  95, local model 4, internal_epoch   2, Avg loss: 0.0335, Accuracy: 393/901 (43.6182%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.7963, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   1, Avg loss: 0.0555, Accuracy: 299/928 (32.2198%)
_Train Local_ResNet_18, epoch  95, local model 1, internal_epoch   2, Avg loss: 0.0241, Accuracy: 571/928 (61.5302%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 7.7010, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   1, Avg loss: 0.0572, Accuracy: 217/861 (25.2033%)
_Train Local_ResNet_18, epoch  95, local model 10, internal_epoch   2, Avg loss: 0.0211, Accuracy: 458/861 (53.1940%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.0275, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   1, Avg loss: 0.0590, Accuracy: 336/719 (46.7316%)
_Train Local_ResNet_18, epoch  95, local model 41, internal_epoch   2, Avg loss: 0.0317, Accuracy: 460/719 (63.9777%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.3213, Accuracy: 55/10000 (0.5500%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   1, Avg loss: 0.0629, Accuracy: 242/605 (40.0000%)
_Train Local_ResNet_18, epoch  95, local model 2, internal_epoch   2, Avg loss: 0.0386, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.8422, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   1, Avg loss: 0.0567, Accuracy: 347/803 (43.2130%)
_Train Local_ResNet_18, epoch  95, local model 58, internal_epoch   2, Avg loss: 0.0344, Accuracy: 401/803 (49.9377%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.1593, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   1, Avg loss: 0.0535, Accuracy: 353/712 (49.5787%)
_Train Local_ResNet_18, epoch  95, local model 11, internal_epoch   2, Avg loss: 0.0259, Accuracy: 429/712 (60.2528%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 6.7904, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   1, Avg loss: 0.0481, Accuracy: 427/1440 (29.6528%)
_Train Local_ResNet_18, epoch  95, local model 29, internal_epoch   2, Avg loss: 0.0272, Accuracy: 713/1440 (49.5139%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 8.2674, Accuracy: 72/10000 (0.7200%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   1, Avg loss: 0.0820, Accuracy: 41/416 (9.8558%)
_Train Local_ResNet_18, epoch  95, local model 78, internal_epoch   2, Avg loss: 0.0447, Accuracy: 185/416 (44.4712%)
_Test Local_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.5537, Accuracy: 50/10000 (0.5000%)
time spent on training: 181.14427638053894
[foolsgold agg] training data poison_ratio: 0.0  data num: [682, 901, 928, 861, 719, 605, 803, 712, 1440, 416]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 95, Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 95, Avg loss: 5.5338, Accuracy: 0/9950 (0.0000%)
saving model
Done in 263.95400881767273 sec.
Server Epoch:96 choose agents : [78, 9, 2, 30, 42, 95, 61, 3, 15, 6].
_Train Local_ResNet_18, epoch  96, local model 78, internal_epoch   1, Avg loss: 0.0817, Accuracy: 48/416 (11.5385%)
_Train Local_ResNet_18, epoch  96, local model 78, internal_epoch   2, Avg loss: 0.0455, Accuracy: 187/416 (44.9519%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.6065, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   1, Avg loss: 0.0478, Accuracy: 378/1275 (29.6471%)
_Train Local_ResNet_18, epoch  96, local model 9, internal_epoch   2, Avg loss: 0.0188, Accuracy: 723/1275 (56.7059%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 9.5222, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   1, Avg loss: 0.0623, Accuracy: 245/605 (40.4959%)
_Train Local_ResNet_18, epoch  96, local model 2, internal_epoch   2, Avg loss: 0.0402, Accuracy: 326/605 (53.8843%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.9692, Accuracy: 68/10000 (0.6800%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   1, Avg loss: 0.0786, Accuracy: 86/486 (17.6955%)
_Train Local_ResNet_18, epoch  96, local model 30, internal_epoch   2, Avg loss: 0.0421, Accuracy: 210/486 (43.2099%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.9548, Accuracy: 47/10000 (0.4700%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   1, Avg loss: 0.0532, Accuracy: 336/1372 (24.4898%)
_Train Local_ResNet_18, epoch  96, local model 42, internal_epoch   2, Avg loss: 0.0315, Accuracy: 494/1372 (36.0058%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.9887, Accuracy: 84/10000 (0.8400%)
poison local model 95 index 3 
_Train Local_ResNet_18, epoch  96, local model 95, internal_epoch   1, Avg loss: 0.0513, Accuracy: 339/599 (56.5943%)
_Train Local_ResNet_18, epoch  96, local model 95, internal_epoch   2, Avg loss: 0.0300, Accuracy: 490/599 (81.8030%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 7.8979, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   1, Avg loss: 0.1250, Accuracy: 0/85 (0.0000%)
_Train Local_ResNet_18, epoch  96, local model 61, internal_epoch   2, Avg loss: 0.1154, Accuracy: 9/85 (10.5882%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3037, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   1, Avg loss: 0.0732, Accuracy: 122/781 (15.6210%)
_Train Local_ResNet_18, epoch  96, local model 3, internal_epoch   2, Avg loss: 0.0351, Accuracy: 233/781 (29.8335%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 6.7499, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   1, Avg loss: 0.0543, Accuracy: 343/1154 (29.7227%)
_Train Local_ResNet_18, epoch  96, local model 15, internal_epoch   2, Avg loss: 0.0270, Accuracy: 518/1154 (44.8873%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.0878, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   1, Avg loss: 0.0538, Accuracy: 419/1956 (21.4213%)
_Train Local_ResNet_18, epoch  96, local model 6, internal_epoch   2, Avg loss: 0.0315, Accuracy: 676/1956 (34.5603%)
_Test Local_ResNet_18 poisoned: False, epoch: 96, Avg loss: 8.0555, Accuracy: 119/10000 (1.1900%)
time spent on training: 201.51066613197327
[foolsgold agg] training data poison_ratio: 0.06862183526177111  data num: [416, 1275, 605, 486, 1372, 599, 85, 781, 1154, 1956]
[foolsgold agg] considering poison per batch poison_fraction: 0.021444323519303473
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 96, Avg loss: 5.3095, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 96, Avg loss: 5.5341, Accuracy: 0/9950 (0.0000%)
saving model
Done in 285.39057636260986 sec.
Server Epoch:97 choose agents : [38, 36, 84, 75, 85, 8, 27, 41, 26, 54].
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   1, Avg loss: 0.0609, Accuracy: 253/1131 (22.3696%)
_Train Local_ResNet_18, epoch  97, local model 38, internal_epoch   2, Avg loss: 0.0297, Accuracy: 530/1131 (46.8612%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.4779, Accuracy: 83/10000 (0.8300%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   1, Avg loss: 0.0854, Accuracy: 81/408 (19.8529%)
_Train Local_ResNet_18, epoch  97, local model 36, internal_epoch   2, Avg loss: 0.0528, Accuracy: 151/408 (37.0098%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.5219, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   1, Avg loss: 0.0620, Accuracy: 329/1190 (27.6471%)
_Train Local_ResNet_18, epoch  97, local model 84, internal_epoch   2, Avg loss: 0.0319, Accuracy: 450/1190 (37.8151%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.1425, Accuracy: 60/10000 (0.6000%)
_Train Local_ResNet_18, epoch  97, local model 75, internal_epoch   1, Avg loss: 0.0643, Accuracy: 258/776 (33.2474%)
_Train Local_ResNet_18, epoch  97, local model 75, internal_epoch   2, Avg loss: 0.0295, Accuracy: 405/776 (52.1907%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.0420, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   1, Avg loss: 0.0533, Accuracy: 452/1988 (22.7364%)
_Train Local_ResNet_18, epoch  97, local model 85, internal_epoch   2, Avg loss: 0.0350, Accuracy: 681/1988 (34.2555%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.9918, Accuracy: 79/10000 (0.7900%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   1, Avg loss: 0.0595, Accuracy: 270/1513 (17.8453%)
_Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   2, Avg loss: 0.0360, Accuracy: 489/1513 (32.3199%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.3587, Accuracy: 104/10000 (1.0400%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   1, Avg loss: 0.0531, Accuracy: 431/1587 (27.1582%)
_Train Local_ResNet_18, epoch  97, local model 27, internal_epoch   2, Avg loss: 0.0335, Accuracy: 637/1587 (40.1386%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.1169, Accuracy: 67/10000 (0.6700%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   1, Avg loss: 0.0601, Accuracy: 335/719 (46.5925%)
_Train Local_ResNet_18, epoch  97, local model 41, internal_epoch   2, Avg loss: 0.0313, Accuracy: 452/719 (62.8651%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 6.5001, Accuracy: 57/10000 (0.5700%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1, Avg loss: 0.0545, Accuracy: 345/1446 (23.8589%)
_Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2, Avg loss: 0.0344, Accuracy: 492/1446 (34.0249%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.5106, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   1, Avg loss: 0.0538, Accuracy: 341/1130 (30.1770%)
_Train Local_ResNet_18, epoch  97, local model 54, internal_epoch   2, Avg loss: 0.0288, Accuracy: 492/1130 (43.5398%)
_Test Local_ResNet_18 poisoned: False, epoch: 97, Avg loss: 7.5963, Accuracy: 51/10000 (0.5100%)
time spent on training: 237.2041256427765
[foolsgold agg] training data poison_ratio: 0.0  data num: [1131, 408, 1190, 776, 1988, 1513, 1587, 719, 1446, 1130]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 97, Avg loss: 5.3095, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 97, Avg loss: 5.5345, Accuracy: 0/9950 (0.0000%)
saving model
Done in 320.99532413482666 sec.
Server Epoch:98 choose agents : [70, 56, 62, 90, 72, 16, 25, 33, 22, 57].
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   1, Avg loss: 0.0556, Accuracy: 374/1418 (26.3752%)
_Train Local_ResNet_18, epoch  98, local model 70, internal_epoch   2, Avg loss: 0.0302, Accuracy: 667/1418 (47.0381%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.6089, Accuracy: 97/10000 (0.9700%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   1, Avg loss: 0.0822, Accuracy: 0/186 (0.0000%)
_Train Local_ResNet_18, epoch  98, local model 56, internal_epoch   2, Avg loss: 0.0664, Accuracy: 80/186 (43.0108%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3109, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   1, Avg loss: 0.0681, Accuracy: 150/568 (26.4085%)
_Train Local_ResNet_18, epoch  98, local model 62, internal_epoch   2, Avg loss: 0.0396, Accuracy: 265/568 (46.6549%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.8071, Accuracy: 51/10000 (0.5100%)
_Train Local_ResNet_18, epoch  98, local model 90, internal_epoch   1, Avg loss: 0.0565, Accuracy: 325/677 (48.0059%)
_Train Local_ResNet_18, epoch  98, local model 90, internal_epoch   2, Avg loss: 0.0235, Accuracy: 436/677 (64.4018%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.6514, Accuracy: 53/10000 (0.5300%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   1, Avg loss: 0.0611, Accuracy: 240/1241 (19.3392%)
_Train Local_ResNet_18, epoch  98, local model 72, internal_epoch   2, Avg loss: 0.0360, Accuracy: 447/1241 (36.0193%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 7.1740, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   1, Avg loss: 0.0598, Accuracy: 291/708 (41.1017%)
_Train Local_ResNet_18, epoch  98, local model 16, internal_epoch   2, Avg loss: 0.0372, Accuracy: 427/708 (60.3107%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.8996, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   1, Avg loss: 0.0566, Accuracy: 305/690 (44.2029%)
_Train Local_ResNet_18, epoch  98, local model 25, internal_epoch   2, Avg loss: 0.0280, Accuracy: 455/690 (65.9420%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 6.3592, Accuracy: 52/10000 (0.5200%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   1, Avg loss: 0.0772, Accuracy: 75/515 (14.5631%)
_Train Local_ResNet_18, epoch  98, local model 33, internal_epoch   2, Avg loss: 0.0488, Accuracy: 129/515 (25.0485%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.7561, Accuracy: 63/10000 (0.6300%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   1, Avg loss: 0.0447, Accuracy: 534/1470 (36.3265%)
_Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   2, Avg loss: 0.0240, Accuracy: 825/1470 (56.1224%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.1244, Accuracy: 65/10000 (0.6500%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   1, Avg loss: 0.0532, Accuracy: 314/1154 (27.2097%)
_Train Local_ResNet_18, epoch  98, local model 57, internal_epoch   2, Avg loss: 0.0252, Accuracy: 508/1154 (44.0208%)
_Test Local_ResNet_18 poisoned: False, epoch: 98, Avg loss: 8.8667, Accuracy: 73/10000 (0.7300%)
time spent on training: 191.6590974330902
[foolsgold agg] training data poison_ratio: 0.0  data num: [1418, 186, 568, 677, 1241, 708, 690, 515, 1470, 1154]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 98, Avg loss: 5.3094, Accuracy: 50/10000 (0.5000%)
_Test Target_ResNet_18 poisoned: True, epoch: 98, Avg loss: 5.5349, Accuracy: 0/9950 (0.0000%)
saving model
Done in 275.5146791934967 sec.
Server Epoch:99 choose agents : [24, 49, 35, 66, 25, 82, 38, 62, 93, 79].
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   1, Avg loss: 0.0747, Accuracy: 47/312 (15.0641%)
_Train Local_ResNet_18, epoch  99, local model 24, internal_epoch   2, Avg loss: 0.0390, Accuracy: 164/312 (52.5641%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3976, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   1, Avg loss: 0.0780, Accuracy: 43/440 (9.7727%)
_Train Local_ResNet_18, epoch  99, local model 49, internal_epoch   2, Avg loss: 0.0467, Accuracy: 147/440 (33.4091%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.5608, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1, Avg loss: 0.0855, Accuracy: 45/271 (16.6052%)
_Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2, Avg loss: 0.0555, Accuracy: 108/271 (39.8524%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3720, Accuracy: 46/10000 (0.4600%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   1, Avg loss: 0.0618, Accuracy: 261/1402 (18.6163%)
_Train Local_ResNet_18, epoch  99, local model 66, internal_epoch   2, Avg loss: 0.0388, Accuracy: 398/1402 (28.3880%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.1635, Accuracy: 76/10000 (0.7600%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   1, Avg loss: 0.0567, Accuracy: 314/690 (45.5072%)
_Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   2, Avg loss: 0.0276, Accuracy: 467/690 (67.6812%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 6.5829, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1, Avg loss: 0.0751, Accuracy: 77/500 (15.4000%)
_Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2, Avg loss: 0.0493, Accuracy: 173/500 (34.6000%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.6843, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   1, Avg loss: 0.0605, Accuracy: 259/1131 (22.9001%)
_Train Local_ResNet_18, epoch  99, local model 38, internal_epoch   2, Avg loss: 0.0298, Accuracy: 499/1131 (44.1202%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.1639, Accuracy: 70/10000 (0.7000%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   1, Avg loss: 0.0675, Accuracy: 156/568 (27.4648%)
_Train Local_ResNet_18, epoch  99, local model 62, internal_epoch   2, Avg loss: 0.0403, Accuracy: 264/568 (46.4789%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.7470, Accuracy: 56/10000 (0.5600%)
_Train Local_ResNet_18, epoch  99, local model 93, internal_epoch   1, Avg loss: 0.0547, Accuracy: 410/1742 (23.5362%)
_Train Local_ResNet_18, epoch  99, local model 93, internal_epoch   2, Avg loss: 0.0315, Accuracy: 719/1742 (41.2744%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 7.7832, Accuracy: 98/10000 (0.9800%)
_Train Local_ResNet_18, epoch  99, local model 79, internal_epoch   1, Avg loss: 0.1022, Accuracy: 17/197 (8.6294%)
_Train Local_ResNet_18, epoch  99, local model 79, internal_epoch   2, Avg loss: 0.0837, Accuracy: 60/197 (30.4569%)
_Test Local_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3184, Accuracy: 50/10000 (0.5000%)
time spent on training: 171.92748641967773
[foolsgold agg] training data poison_ratio: 0.0  data num: [312, 440, 271, 1402, 690, 500, 1131, 568, 1742, 197]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.99475797 0.99475797 1.         1.         1.         1.
 1.         1.         1.         1.        ]
_Test Target_ResNet_18 poisoned: False, epoch: 99, Avg loss: 5.3094, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 99, Avg loss: 5.5350, Accuracy: 0/9950 (0.0000%)
saving model
Done in 253.59681129455566 sec.
Server Epoch:100 choose agents : [47, 65, 86, 24, 39, 5, 1, 53, 88, 58].
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   1, Avg loss: 0.1222, Accuracy: 0/134 (0.0000%)
_Train Local_ResNet_18, epoch 100, local model 47, internal_epoch   2, Avg loss: 0.1098, Accuracy: 18/134 (13.4328%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3096, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   1, Avg loss: 0.0539, Accuracy: 400/1475 (27.1186%)
_Train Local_ResNet_18, epoch 100, local model 65, internal_epoch   2, Avg loss: 0.0313, Accuracy: 699/1475 (47.3898%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.9227, Accuracy: 105/10000 (1.0500%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   1, Avg loss: 0.0614, Accuracy: 364/1003 (36.2911%)
_Train Local_ResNet_18, epoch 100, local model 86, internal_epoch   2, Avg loss: 0.0345, Accuracy: 381/1003 (37.9860%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.8235, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   1, Avg loss: 0.0744, Accuracy: 55/312 (17.6282%)
_Train Local_ResNet_18, epoch 100, local model 24, internal_epoch   2, Avg loss: 0.0403, Accuracy: 168/312 (53.8462%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.4034, Accuracy: 50/10000 (0.5000%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   1, Avg loss: 0.0526, Accuracy: 323/1013 (31.8855%)
_Train Local_ResNet_18, epoch 100, local model 39, internal_epoch   2, Avg loss: 0.0260, Accuracy: 499/1013 (49.2596%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7382, Accuracy: 81/10000 (0.8100%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   1, Avg loss: 0.0504, Accuracy: 392/1628 (24.0786%)
_Train Local_ResNet_18, epoch 100, local model 5, internal_epoch   2, Avg loss: 0.0253, Accuracy: 812/1628 (49.8771%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 8.5538, Accuracy: 141/10000 (1.4100%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   1, Avg loss: 0.0561, Accuracy: 294/928 (31.6810%)
_Train Local_ResNet_18, epoch 100, local model 1, internal_epoch   2, Avg loss: 0.0233, Accuracy: 591/928 (63.6853%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 7.7601, Accuracy: 87/10000 (0.8700%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   1, Avg loss: 0.0485, Accuracy: 300/813 (36.9004%)
_Train Local_ResNet_18, epoch 100, local model 53, internal_epoch   2, Avg loss: 0.0187, Accuracy: 442/813 (54.3665%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 9.8514, Accuracy: 48/10000 (0.4800%)
_Train Local_ResNet_18, epoch 100, local model 88, internal_epoch   1, Avg loss: 0.0739, Accuracy: 139/603 (23.0514%)
_Train Local_ResNet_18, epoch 100, local model 88, internal_epoch   2, Avg loss: 0.0456, Accuracy: 283/603 (46.9320%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.9913, Accuracy: 49/10000 (0.4900%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   1, Avg loss: 0.0569, Accuracy: 352/803 (43.8356%)
_Train Local_ResNet_18, epoch 100, local model 58, internal_epoch   2, Avg loss: 0.0334, Accuracy: 423/803 (52.6775%)
_Test Local_ResNet_18 poisoned: False, epoch: 100, Avg loss: 6.0843, Accuracy: 52/10000 (0.5200%)
time spent on training: 193.89697456359863
[foolsgold agg] training data poison_ratio: 0.0  data num: [134, 1475, 1003, 312, 1013, 1628, 928, 813, 603, 803]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
_Test Target_ResNet_18 poisoned: False, epoch: 100, Avg loss: 5.3094, Accuracy: 48/10000 (0.4800%)
_Test Target_ResNet_18 poisoned: True, epoch: 100, Avg loss: 5.5342, Accuracy: 0/9950 (0.0000%)
saving model
Done in 277.8950836658478 sec.
Saving all the graphs.
This run has a label: Jun.28_18.51.58. Visdom environment: tiny
